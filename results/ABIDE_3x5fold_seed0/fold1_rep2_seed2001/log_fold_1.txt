[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4925 mb_mean=0.4923 norm_overlap=1.0000 corr_cb=-0.0375 topkJ=0.0351
[TRAIN][ep=000] loss=0.6927 acc=51.54%
[TRAIN][ep=000] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0408
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4947 mb_mean=0.4925 norm_overlap=1.0000 corr_cb=0.0200 topkJ=0.0582
[TRAIN][ep=001] loss=0.6916 acc=51.95%
[TRAIN][ep=001] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0417
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4934 mb_mean=0.4912 norm_overlap=1.0000 corr_cb=-0.0761 topkJ=0.0212
[TRAIN][ep=002] loss=0.6915 acc=51.41%
[TRAIN][ep=002] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0335
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4946 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=0.0005 topkJ=0.0158
[TRAIN][ep=003] loss=0.6906 acc=55.44%
[TRAIN][ep=003] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0421
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4921 mb_mean=0.4935 norm_overlap=1.0000 corr_cb=0.0308 topkJ=0.0456
[TRAIN][ep=004] loss=0.6904 acc=55.03%
[TRAIN][ep=004] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0492
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4956 mb_mean=0.4905 norm_overlap=1.0000 corr_cb=-0.0217 topkJ=0.0255
[TRAIN][ep=005] loss=0.6886 acc=56.11%
[TRAIN][ep=005] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0414
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4955 mb_mean=0.4935 norm_overlap=1.0001 corr_cb=0.1792 topkJ=0.2987
[TRAIN][ep=006] loss=0.6877 acc=53.56%
[TRAIN][ep=006] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0439
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4934 mb_mean=0.4926 norm_overlap=1.0000 corr_cb=0.0730 topkJ=0.0188
[TRAIN][ep=007] loss=0.6873 acc=60.27%
[TRAIN][ep=007] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0419
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4941 mb_mean=0.4951 norm_overlap=1.0000 corr_cb=-0.0577 topkJ=0.0403
[TRAIN][ep=008] loss=0.6873 acc=55.57%
[TRAIN][ep=008] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0461
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4928 mb_mean=0.4945 norm_overlap=1.0001 corr_cb=0.2081 topkJ=0.0622
[TRAIN][ep=009] loss=0.6851 acc=58.39%
[TRAIN][ep=009] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0400
================= FIT START (fold=1) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4924 mb_mean=0.4908 norm_overlap=1.0000 corr_cb=-0.0313 topkJ=0.0382
[TRAIN][ep=000] loss=0.6841 acc=60.40%
[TRAIN][ep=000] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0416
[EPOCH 000/089] train: loss=0.6841 acc=60.40% | val: loss=0.6907 acc=55.42% f1=69.42% auc=51.45% val_score=34.8123 val_score_bestthr=59.9213 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.042) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 59.9213
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4945 mb_mean=0.4932 norm_overlap=1.0000 corr_cb=0.0532 topkJ=0.0351
[TRAIN][ep=001] loss=0.6820 acc=57.18%
[TRAIN][ep=001] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0445
[EPOCH 001/089] train: loss=0.6820 acc=57.18% | val: loss=0.6912 acc=56.63% f1=69.49% auc=51.92% val_score=32.5808 val_score_bestthr=57.7063 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.045) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 59.9213 -> 57.7063
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4957 mb_mean=0.4963 norm_overlap=1.0000 corr_cb=-0.0615 topkJ=0.0282
[TRAIN][ep=002] loss=0.6801 acc=63.89%
[TRAIN][ep=002] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0447
[EPOCH 002/089] train: loss=0.6801 acc=63.89% | val: loss=0.6900 acc=56.63% f1=70.00% auc=51.63% val_score=37.9169 val_score_bestthr=58.8632 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.045) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 59.9213 -> 58.8632
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4968 mb_mean=0.4929 norm_overlap=0.9999 corr_cb=-0.1262 topkJ=0.0038
[TRAIN][ep=003] loss=0.6772 acc=64.43%
[TRAIN][ep=003] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0468
[EPOCH 003/089] train: loss=0.6772 acc=64.43% | val: loss=0.6902 acc=56.63% f1=69.49% auc=52.09% val_score=57.8113 val_score_bestthr=59.2336 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.047) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 59.9213 -> 59.2336
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4915 mb_mean=0.4920 norm_overlap=1.0000 corr_cb=-0.0843 topkJ=0.0088
[TRAIN][ep=004] loss=0.6781 acc=59.33%
[TRAIN][ep=004] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0455
[EPOCH 004/089] train: loss=0.6781 acc=59.33% | val: loss=0.6898 acc=56.63% f1=69.49% auc=51.86% val_score=42.2643 val_score_bestthr=59.2336 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.046) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 59.9213 -> 59.2336
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4942 mb_mean=0.4946 norm_overlap=0.9999 corr_cb=-0.1495 topkJ=0.0119
[TRAIN][ep=005] loss=1.2579 acc=61.61%
[TRAIN][ep=005] mask_avg: mc_mean=0.3824 mb_mean=0.4928 norm_overlap=0.9990 corr_cb=-0.3753
[EPOCH 005/089] train: loss=1.2579 acc=61.61% | val: loss=0.6912 acc=57.83% f1=71.07% auc=52.15% val_score=39.4311 val_score_bestthr=61.8435 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.382, mb=0.493, no=0.999, corr=-0.375) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 59.9213 -> 61.8435
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2816 mb_mean=0.4960 norm_overlap=0.9962 corr_cb=-0.4919 topkJ=0.0027
[TRAIN][ep=006] loss=1.2525 acc=62.82%
[TRAIN][ep=006] mask_avg: mc_mean=0.2544 mb_mean=0.4928 norm_overlap=0.9972 corr_cb=-0.4129
[EPOCH 006/089] train: loss=1.2525 acc=62.82% | val: loss=0.6900 acc=57.83% f1=70.59% auc=51.28% val_score=42.0502 val_score_bestthr=59.0835 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.254, mb=0.493, no=0.997, corr=-0.413) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.8435 -> 59.0835
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.1804 mb_mean=0.4992 norm_overlap=0.9960 corr_cb=-0.4550 topkJ=0.0110
[TRAIN][ep=007] loss=1.2501 acc=62.95%
[TRAIN][ep=007] mask_avg: mc_mean=0.2033 mb_mean=0.4928 norm_overlap=0.9959 corr_cb=-0.4226
[EPOCH 007/089] train: loss=1.2501 acc=62.95% | val: loss=0.6901 acc=57.83% f1=70.59% auc=51.40% val_score=34.9236 val_score_bestthr=59.0835 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.203, mb=0.493, no=0.996, corr=-0.423) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.8435 -> 59.0835
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1896 mb_mean=0.4901 norm_overlap=0.9961 corr_cb=-0.4174 topkJ=0.0141
[TRAIN][ep=008] loss=1.2435 acc=62.28%
[TRAIN][ep=008] mask_avg: mc_mean=0.1735 mb_mean=0.4928 norm_overlap=0.9946 corr_cb=-0.4451
[EPOCH 008/089] train: loss=1.2435 acc=62.28% | val: loss=0.6975 acc=55.42% f1=68.38% auc=51.63% val_score=57.7987 val_score_bestthr=57.4222 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.173, mb=0.493, no=0.995, corr=-0.445) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.8435 -> 57.4222
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1402 mb_mean=0.4926 norm_overlap=0.9936 corr_cb=-0.4168 topkJ=0.0169
[TRAIN][ep=009] loss=1.2431 acc=60.94%
[TRAIN][ep=009] mask_avg: mc_mean=0.1529 mb_mean=0.4928 norm_overlap=0.9933 corr_cb=-0.4576
[EPOCH 009/089] train: loss=1.2431 acc=60.94% | val: loss=0.6928 acc=57.83% f1=70.09% auc=51.57% val_score=37.0285 val_score_bestthr=59.4548 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.153, mb=0.493, no=0.993, corr=-0.458) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.8435 -> 59.4548
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1315 mb_mean=0.4963 norm_overlap=0.9932 corr_cb=-0.4982 topkJ=0.0031
[TRAIN][ep=010] loss=1.2420 acc=63.09%
[TRAIN][ep=010] mask_avg: mc_mean=0.1389 mb_mean=0.4928 norm_overlap=0.9923 corr_cb=-0.4548
[EPOCH 010/089] train: loss=1.2420 acc=63.09% | val: loss=0.6908 acc=59.04% f1=70.69% auc=52.21% val_score=38.4697 val_score_bestthr=60.9502 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.139, mb=0.493, no=0.992, corr=-0.455) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.8435 -> 60.9502
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1178 mb_mean=0.4924 norm_overlap=0.9925 corr_cb=-0.4054 topkJ=0.0063
[TRAIN][ep=011] loss=0.9942 acc=65.91%
[TRAIN][ep=011] mask_avg: mc_mean=0.1309 mb_mean=0.4928 norm_overlap=0.9913 corr_cb=-0.4571
[EPOCH 011/089] train: loss=0.9942 acc=65.91% | val: loss=0.6925 acc=57.83% f1=70.59% auc=51.98% val_score=38.4697 val_score_bestthr=61.6332 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.131, mb=0.493, no=0.991, corr=-0.457) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.8435 -> 61.6332
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1168 mb_mean=0.4959 norm_overlap=0.9902 corr_cb=-0.4899 topkJ=0.0072
[TRAIN][ep=012] loss=0.7485 acc=66.31%
[TRAIN][ep=012] mask_avg: mc_mean=0.1264 mb_mean=0.4928 norm_overlap=0.9901 corr_cb=-0.4580
[EPOCH 012/089] train: loss=0.7485 acc=66.31% | val: loss=0.6939 acc=57.83% f1=70.09% auc=51.92% val_score=39.9660 val_score_bestthr=59.4548 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.126, mb=0.493, no=0.990, corr=-0.458) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.8435 -> 59.4548
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.0786 mb_mean=0.4973 norm_overlap=0.9870 corr_cb=-0.4379 topkJ=0.0043
[TRAIN][ep=013] loss=0.7022 acc=59.87%
[TRAIN][ep=013] mask_avg: mc_mean=0.1185 mb_mean=0.4928 norm_overlap=0.9890 corr_cb=-0.4466
[EPOCH 013/089] train: loss=0.7022 acc=59.87% | val: loss=0.7021 acc=57.83% f1=71.07% auc=52.21% val_score=38.6451 val_score_bestthr=63.1205 | dyn(w_pfs=0.090, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.119, mb=0.493, no=0.989, corr=-0.447) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 61.8435 -> 63.1205
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1157 mb_mean=0.4931 norm_overlap=0.9878 corr_cb=-0.5022 topkJ=0.0055
[TRAIN][ep=014] loss=0.7774 acc=66.71%
[TRAIN][ep=014] mask_avg: mc_mean=0.1307 mb_mean=0.4928 norm_overlap=0.9887 corr_cb=-0.4514
[EPOCH 014/089] train: loss=0.7774 acc=66.71% | val: loss=0.7264 acc=56.63% f1=70.49% auc=53.14% val_score=42.5078 val_score_bestthr=64.1779 | dyn(w_pfs=0.130, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.131, mb=0.493, no=0.989, corr=-0.451) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 63.1205 -> 64.1779
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1486 mb_mean=0.4915 norm_overlap=0.9916 corr_cb=-0.4075 topkJ=0.0130
[TRAIN][ep=015] loss=0.8723 acc=66.44%
[TRAIN][ep=015] mask_avg: mc_mean=0.1092 mb_mean=0.4928 norm_overlap=0.9871 corr_cb=-0.4247
[EPOCH 015/089] train: loss=0.8723 acc=66.44% | val: loss=0.6997 acc=57.83% f1=70.59% auc=51.74% val_score=39.7981 val_score_bestthr=61.6332 | dyn(w_pfs=0.170, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.109, mb=0.493, no=0.987, corr=-0.425) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1779 -> 61.6332
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1174 mb_mean=0.4960 norm_overlap=0.9847 corr_cb=-0.4623 topkJ=0.0012
[TRAIN][ep=016] loss=0.9620 acc=65.64%
[TRAIN][ep=016] mask_avg: mc_mean=0.1172 mb_mean=0.4928 norm_overlap=0.9869 corr_cb=-0.4338
[EPOCH 016/089] train: loss=0.9620 acc=65.64% | val: loss=0.6988 acc=57.83% f1=70.09% auc=52.79% val_score=39.5846 val_score_bestthr=61.1560 | dyn(w_pfs=0.210, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.117, mb=0.493, no=0.987, corr=-0.434) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1779 -> 61.1560
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1240 mb_mean=0.4935 norm_overlap=0.9867 corr_cb=-0.4594 topkJ=0.0048
[TRAIN][ep=017] loss=1.0539 acc=67.11%
[TRAIN][ep=017] mask_avg: mc_mean=0.1211 mb_mean=0.4928 norm_overlap=0.9867 corr_cb=-0.4323
[EPOCH 017/089] train: loss=1.0539 acc=67.11% | val: loss=0.7012 acc=57.83% f1=70.09% auc=52.85% val_score=42.8768 val_score_bestthr=61.1560 | dyn(w_pfs=0.250, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.121, mb=0.493, no=0.987, corr=-0.432) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1779 -> 61.1560
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1134 mb_mean=0.4913 norm_overlap=0.9894 corr_cb=-0.3581 topkJ=0.0083
[TRAIN][ep=018] loss=1.1420 acc=68.46%
[TRAIN][ep=018] mask_avg: mc_mean=0.1084 mb_mean=0.4928 norm_overlap=0.9856 corr_cb=-0.4201
[EPOCH 018/089] train: loss=1.1420 acc=68.46% | val: loss=0.7061 acc=57.83% f1=70.09% auc=52.91% val_score=49.1388 val_score_bestthr=61.1560 | dyn(w_pfs=0.290, w_sup=0.240, w_csuf=0.200, stage2=False) | mask(mc=0.108, mb=0.493, no=0.986, corr=-0.420) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1779 -> 61.1560
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1221 mb_mean=0.4941 norm_overlap=0.9891 corr_cb=-0.3731 topkJ=0.0117
[TRAIN][ep=019] loss=1.1710 acc=67.38%
[TRAIN][ep=019] mask_avg: mc_mean=0.1080 mb_mean=0.4928 norm_overlap=0.9852 corr_cb=-0.4172
[EPOCH 019/089] train: loss=1.1710 acc=67.38% | val: loss=0.7031 acc=57.83% f1=70.09% auc=53.43% val_score=41.0810 val_score_bestthr=61.1560 | dyn(w_pfs=0.190, w_sup=0.140, w_csuf=0.100, stage2=False) | mask(mc=0.108, mb=0.493, no=0.985, corr=-0.417) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1779 -> 61.1560
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1335 mb_mean=0.4898 norm_overlap=0.9884 corr_cb=-0.3889 topkJ=0.0027
[TRAIN][ep=020] loss=0.9291 acc=67.52%
[TRAIN][ep=020] mask_avg: mc_mean=0.1250 mb_mean=0.4928 norm_overlap=0.9857 corr_cb=-0.4292
[EPOCH 020/089] train: loss=0.9291 acc=67.52% | val: loss=0.7097 acc=57.83% f1=70.09% auc=53.90% val_score=47.1352 val_score_bestthr=61.1560 | dyn(w_pfs=0.090, w_sup=0.040, w_csuf=0.000, stage2=False) | mask(mc=0.125, mb=0.493, no=0.986, corr=-0.429) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1779 -> 61.1560
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.1348 mb_mean=0.4926 norm_overlap=0.9890 corr_cb=-0.4285 topkJ=0.0056
[TRAIN][ep=021] loss=0.6855 acc=67.11%
[TRAIN][ep=021] mask_avg: mc_mean=0.1463 mb_mean=0.4928 norm_overlap=0.9864 corr_cb=-0.4371
[EPOCH 021/089] train: loss=0.6855 acc=67.11% | val: loss=0.7083 acc=57.83% f1=70.09% auc=54.07% val_score=48.3657 val_score_bestthr=61.1560 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.146, mb=0.493, no=0.986, corr=-0.437) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1779 -> 61.1560
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1457 mb_mean=0.4906 norm_overlap=0.9855 corr_cb=-0.4466 topkJ=0.0004
[TRAIN][ep=022] loss=0.6377 acc=67.38%
[TRAIN][ep=022] mask_avg: mc_mean=0.1229 mb_mean=0.4928 norm_overlap=0.9853 corr_cb=-0.4192
[EPOCH 022/089] train: loss=0.6377 acc=67.38% | val: loss=0.7074 acc=57.83% f1=70.09% auc=54.01% val_score=40.4971 val_score_bestthr=61.1560 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.123, mb=0.493, no=0.985, corr=-0.419) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1779 -> 61.1560
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1196 mb_mean=0.4932 norm_overlap=0.9804 corr_cb=-0.4605 topkJ=0.0031
[TRAIN][ep=023] loss=0.6321 acc=67.92%
[TRAIN][ep=023] mask_avg: mc_mean=0.1225 mb_mean=0.4928 norm_overlap=0.9852 corr_cb=-0.4160
[EPOCH 023/089] train: loss=0.6321 acc=67.92% | val: loss=0.7142 acc=57.83% f1=70.59% auc=53.37% val_score=52.5523 val_score_bestthr=61.6332 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.123, mb=0.493, no=0.985, corr=-0.416) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1779 -> 61.6332
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1242 mb_mean=0.4927 norm_overlap=0.9864 corr_cb=-0.4253 topkJ=0.0056
[TRAIN][ep=024] loss=0.6305 acc=68.59%
[TRAIN][ep=024] mask_avg: mc_mean=0.1353 mb_mean=0.4928 norm_overlap=0.9855 corr_cb=-0.4226
[EPOCH 024/089] train: loss=0.6305 acc=68.59% | val: loss=0.7119 acc=59.04% f1=70.18% auc=53.90% val_score=52.5523 val_score_bestthr=62.5854 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.135, mb=0.493, no=0.986, corr=-0.423) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1779 -> 62.5854
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1102 mb_mean=0.4924 norm_overlap=0.9859 corr_cb=-0.4165 topkJ=0.0063
[TRAIN][ep=025] loss=0.6291 acc=68.59%
[TRAIN][ep=025] mask_avg: mc_mean=0.1209 mb_mean=0.4928 norm_overlap=0.9847 corr_cb=-0.4090
[EPOCH 025/089] train: loss=0.6291 acc=68.59% | val: loss=0.7150 acc=59.04% f1=70.18% auc=53.49% val_score=52.5523 val_score_bestthr=62.5854 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.121, mb=0.493, no=0.985, corr=-0.409) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1779 -> 62.5854
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1303 mb_mean=0.4922 norm_overlap=0.9906 corr_cb=-0.3166 topkJ=0.0077
[TRAIN][ep=026] loss=0.6268 acc=68.19%
[TRAIN][ep=026] mask_avg: mc_mean=0.1345 mb_mean=0.4928 norm_overlap=0.9853 corr_cb=-0.4129
[EPOCH 026/089] train: loss=0.6268 acc=68.19% | val: loss=0.7141 acc=59.04% f1=70.18% auc=53.78% val_score=52.5523 val_score_bestthr=62.5854 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.135, mb=0.493, no=0.985, corr=-0.413) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1779 -> 62.5854
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1499 mb_mean=0.4908 norm_overlap=0.9863 corr_cb=-0.3966 topkJ=0.0016
[TRAIN][ep=027] loss=0.6182 acc=70.47%
[TRAIN][ep=027] mask_avg: mc_mean=0.1253 mb_mean=0.4928 norm_overlap=0.9848 corr_cb=-0.4067
[EPOCH 027/089] train: loss=0.6182 acc=70.47% | val: loss=0.7156 acc=57.83% f1=70.09% auc=54.53% val_score=45.8129 val_score_bestthr=61.1560 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.125, mb=0.493, no=0.985, corr=-0.407) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1779 -> 61.1560
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1105 mb_mean=0.4955 norm_overlap=0.9820 corr_cb=-0.4497 topkJ=0.0016
[TRAIN][ep=028] loss=0.6206 acc=68.19%
[TRAIN][ep=028] mask_avg: mc_mean=0.1178 mb_mean=0.4928 norm_overlap=0.9844 corr_cb=-0.3964
[EPOCH 028/089] train: loss=0.6206 acc=68.19% | val: loss=0.7191 acc=57.83% f1=70.59% auc=54.24% val_score=45.5137 val_score_bestthr=61.6332 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.118, mb=0.493, no=0.984, corr=-0.396) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1779 -> 61.6332
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.1038 mb_mean=0.4953 norm_overlap=0.9815 corr_cb=-0.4227 topkJ=0.0035
[TRAIN][ep=029] loss=0.6125 acc=70.60%
[TRAIN][ep=029] mask_avg: mc_mean=0.1333 mb_mean=0.4928 norm_overlap=0.9850 corr_cb=-0.4081
[EPOCH 029/089] train: loss=0.6125 acc=70.60% | val: loss=0.7342 acc=60.24% f1=71.79% auc=53.95% val_score=47.0602 val_score_bestthr=64.2109 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.133, mb=0.493, no=0.985, corr=-0.408) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 64.1779 -> 64.2109
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.0915 mb_mean=0.4980 norm_overlap=0.9724 corr_cb=-0.5203 topkJ=0.0012
[TRAIN][ep=030] loss=0.7121 acc=68.59%
[TRAIN][ep=030] mask_avg: mc_mean=0.1163 mb_mean=0.4928 norm_overlap=0.9841 corr_cb=-0.3917
[EPOCH 030/089] train: loss=0.7121 acc=68.59% | val: loss=0.7145 acc=59.04% f1=70.18% auc=54.94% val_score=47.7807 val_score_bestthr=62.5854 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.116, mb=0.493, no=0.984, corr=-0.392) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2109 -> 62.5854
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.1178 mb_mean=0.4927 norm_overlap=0.9803 corr_cb=-0.4983 topkJ=0.0035
[TRAIN][ep=031] loss=0.8027 acc=68.19%
[TRAIN][ep=031] mask_avg: mc_mean=0.1130 mb_mean=0.4928 norm_overlap=0.9838 corr_cb=-0.3901
[EPOCH 031/089] train: loss=0.8027 acc=68.19% | val: loss=0.7167 acc=59.04% f1=70.18% auc=54.71% val_score=47.2643 val_score_bestthr=62.5854 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.113, mb=0.493, no=0.984, corr=-0.390) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2109 -> 62.5854
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1433 mb_mean=0.4887 norm_overlap=0.9902 corr_cb=-0.2506 topkJ=0.0126
[TRAIN][ep=032] loss=0.8865 acc=69.40%
[TRAIN][ep=032] mask_avg: mc_mean=0.1204 mb_mean=0.4928 norm_overlap=0.9842 corr_cb=-0.3934
[EPOCH 032/089] train: loss=0.8865 acc=69.40% | val: loss=0.7664 acc=57.83% f1=70.09% auc=55.06% val_score=42.3572 val_score_bestthr=61.1560 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.120, mb=0.493, no=0.984, corr=-0.393) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2109 -> 61.1560
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1173 mb_mean=0.4927 norm_overlap=0.9821 corr_cb=-0.3844 topkJ=0.0016
[TRAIN][ep=033] loss=0.9787 acc=72.35%
[TRAIN][ep=033] mask_avg: mc_mean=0.1150 mb_mean=0.4928 norm_overlap=0.9838 corr_cb=-0.3886
[EPOCH 033/089] train: loss=0.9787 acc=72.35% | val: loss=0.7213 acc=59.04% f1=71.19% auc=54.88% val_score=49.1559 val_score_bestthr=62.2793 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.115, mb=0.493, no=0.984, corr=-0.389) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2109 -> 62.2793
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1139 mb_mean=0.4908 norm_overlap=0.9883 corr_cb=-0.3133 topkJ=0.0091
[TRAIN][ep=034] loss=1.0650 acc=71.01%
[TRAIN][ep=034] mask_avg: mc_mean=0.1202 mb_mean=0.4928 norm_overlap=0.9842 corr_cb=-0.3917
[EPOCH 034/089] train: loss=1.0650 acc=71.01% | val: loss=0.7245 acc=59.04% f1=70.18% auc=55.06% val_score=46.8994 val_score_bestthr=62.5854 | dyn(w_pfs=0.100, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.120, mb=0.493, no=0.984, corr=-0.392) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2109 -> 62.5854
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.1267 mb_mean=0.4924 norm_overlap=0.9880 corr_cb=-0.3720 topkJ=0.0064
[TRAIN][ep=035] loss=0.8304 acc=70.74%
[TRAIN][ep=035] mask_avg: mc_mean=0.1281 mb_mean=0.4928 norm_overlap=0.9845 corr_cb=-0.3950
[EPOCH 035/089] train: loss=0.8304 acc=70.74% | val: loss=0.7215 acc=59.04% f1=70.18% auc=54.88% val_score=47.4072 val_score_bestthr=62.5854 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.128, mb=0.493, no=0.985, corr=-0.395) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2109 -> 62.5854
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.1264 mb_mean=0.4918 norm_overlap=0.9881 corr_cb=-0.2906 topkJ=0.0020
[TRAIN][ep=036] loss=0.5915 acc=72.48%
[TRAIN][ep=036] mask_avg: mc_mean=0.1257 mb_mean=0.4928 norm_overlap=0.9845 corr_cb=-0.3912
[EPOCH 036/089] train: loss=0.5915 acc=72.48% | val: loss=0.7290 acc=57.83% f1=70.09% auc=55.52% val_score=39.0083 val_score_bestthr=61.1560 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.126, mb=0.493, no=0.984, corr=-0.391) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2109 -> 61.1560
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1637 mb_mean=0.4913 norm_overlap=0.9827 corr_cb=-0.4279 topkJ=0.0016
[TRAIN][ep=037] loss=0.5922 acc=71.81%
[TRAIN][ep=037] mask_avg: mc_mean=0.1344 mb_mean=0.4928 norm_overlap=0.9847 corr_cb=-0.3979
[EPOCH 037/089] train: loss=0.5922 acc=71.81% | val: loss=0.7268 acc=59.04% f1=71.19% auc=55.64% val_score=45.9418 val_score_bestthr=62.2793 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.134, mb=0.493, no=0.985, corr=-0.398) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2109 -> 62.2793
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.1542 mb_mean=0.4918 norm_overlap=0.9850 corr_cb=-0.4052 topkJ=0.0044
[TRAIN][ep=038] loss=0.5858 acc=71.68%
[TRAIN][ep=038] mask_avg: mc_mean=0.1409 mb_mean=0.4928 norm_overlap=0.9850 corr_cb=-0.3994
[EPOCH 038/089] train: loss=0.5858 acc=71.68% | val: loss=0.7232 acc=60.24% f1=71.30% auc=55.47% val_score=47.7640 val_score_bestthr=62.5929 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.141, mb=0.493, no=0.985, corr=-0.399) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2109 -> 62.5929
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.1514 mb_mean=0.4933 norm_overlap=0.9799 corr_cb=-0.5010 topkJ=0.0020
[TRAIN][ep=039] loss=0.5804 acc=73.83%
[TRAIN][ep=039] mask_avg: mc_mean=0.1352 mb_mean=0.4928 norm_overlap=0.9846 corr_cb=-0.3948
[EPOCH 039/089] train: loss=0.5804 acc=73.83% | val: loss=0.7276 acc=59.04% f1=71.19% auc=55.47% val_score=39.9301 val_score_bestthr=62.2793 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.135, mb=0.493, no=0.985, corr=-0.395) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2109 -> 62.2793
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.1421 mb_mean=0.4926 norm_overlap=0.9830 corr_cb=-0.4338 topkJ=0.0067
[TRAIN][ep=040] loss=0.5749 acc=72.62%
[TRAIN][ep=040] mask_avg: mc_mean=0.1464 mb_mean=0.4928 norm_overlap=0.9853 corr_cb=-0.3971
[EPOCH 040/089] train: loss=0.5749 acc=72.62% | val: loss=0.7672 acc=57.83% f1=70.09% auc=55.47% val_score=39.3022 val_score_bestthr=61.1560 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.146, mb=0.493, no=0.985, corr=-0.397) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2109 -> 61.1560
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.1479 mb_mean=0.4934 norm_overlap=0.9881 corr_cb=-0.3348 topkJ=0.0024
[TRAIN][ep=041] loss=0.5742 acc=72.08%
[TRAIN][ep=041] mask_avg: mc_mean=0.1285 mb_mean=0.4928 norm_overlap=0.9844 corr_cb=-0.3867
[EPOCH 041/089] train: loss=0.5742 acc=72.08% | val: loss=0.7323 acc=59.04% f1=71.19% auc=55.29% val_score=40.2412 val_score_bestthr=62.2793 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.128, mb=0.493, no=0.984, corr=-0.387) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2109 -> 62.2793
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.1477 mb_mean=0.4932 norm_overlap=0.9838 corr_cb=-0.4258 topkJ=0.0024
[TRAIN][ep=042] loss=0.5681 acc=73.96%
[TRAIN][ep=042] mask_avg: mc_mean=0.1369 mb_mean=0.4928 norm_overlap=0.9847 corr_cb=-0.3904
[EPOCH 042/089] train: loss=0.5681 acc=73.96% | val: loss=0.7285 acc=60.24% f1=71.79% auc=55.58% val_score=47.1299 val_score_bestthr=64.2109 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.137, mb=0.493, no=0.985, corr=-0.390) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2109 -> 64.2109
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.1271 mb_mean=0.4932 norm_overlap=0.9813 corr_cb=-0.4164 topkJ=0.0008
[TRAIN][ep=043] loss=0.5617 acc=73.56%
[TRAIN][ep=043] mask_avg: mc_mean=0.1384 mb_mean=0.4928 norm_overlap=0.9848 corr_cb=-0.3899
[EPOCH 043/089] train: loss=0.5617 acc=73.56% | val: loss=0.7415 acc=59.04% f1=71.19% auc=55.70% val_score=40.0975 val_score_bestthr=62.2793 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.138, mb=0.493, no=0.985, corr=-0.390) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2109 -> 62.2793
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.1488 mb_mean=0.4931 norm_overlap=0.9859 corr_cb=-0.3760 topkJ=0.0040
[TRAIN][ep=044] loss=0.5651 acc=72.35%
[TRAIN][ep=044] mask_avg: mc_mean=0.1415 mb_mean=0.4928 norm_overlap=0.9849 corr_cb=-0.3899
[EPOCH 044/089] train: loss=0.5651 acc=72.35% | val: loss=0.7302 acc=60.24% f1=71.79% auc=55.12% val_score=45.0077 val_score_bestthr=64.2109 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.141, mb=0.493, no=0.985, corr=-0.390) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2109 -> 64.2109
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.1436 mb_mean=0.4935 norm_overlap=0.9872 corr_cb=-0.3811 topkJ=0.0036
[TRAIN][ep=045] loss=0.5582 acc=72.75%
[TRAIN][ep=045] mask_avg: mc_mean=0.1465 mb_mean=0.4928 norm_overlap=0.9851 corr_cb=-0.3897
[EPOCH 045/089] train: loss=0.5582 acc=72.75% | val: loss=0.7579 acc=60.24% f1=71.79% auc=55.23% val_score=53.1613 val_score_bestthr=64.2109 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.146, mb=0.493, no=0.985, corr=-0.390) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2109 -> 64.2109
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.1481 mb_mean=0.4928 norm_overlap=0.9827 corr_cb=-0.3932 topkJ=0.0031
[TRAIN][ep=046] loss=0.5571 acc=72.89%
[TRAIN][ep=046] mask_avg: mc_mean=0.1288 mb_mean=0.4928 norm_overlap=0.9842 corr_cb=-0.3803
[EPOCH 046/089] train: loss=0.5571 acc=72.89% | val: loss=0.7391 acc=60.24% f1=71.79% auc=55.47% val_score=47.2858 val_score_bestthr=64.2109 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.129, mb=0.493, no=0.984, corr=-0.380) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2109 -> 64.2109
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.1386 mb_mean=0.4929 norm_overlap=0.9835 corr_cb=-0.3863 topkJ=0.0027
[TRAIN][ep=047] loss=0.5547 acc=75.03%
[TRAIN][ep=047] mask_avg: mc_mean=0.1463 mb_mean=0.4928 norm_overlap=0.9850 corr_cb=-0.3898
[EPOCH 047/089] train: loss=0.5547 acc=75.03% | val: loss=0.7386 acc=60.24% f1=71.79% auc=55.00% val_score=43.0264 val_score_bestthr=64.2109 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.146, mb=0.493, no=0.985, corr=-0.390) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2109 -> 64.2109
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.1512 mb_mean=0.4913 norm_overlap=0.9881 corr_cb=-0.4044 topkJ=0.0044
[TRAIN][ep=048] loss=0.5556 acc=73.69%
[TRAIN][ep=048] mask_avg: mc_mean=0.1468 mb_mean=0.4928 norm_overlap=0.9851 corr_cb=-0.3858
[EPOCH 048/089] train: loss=0.5556 acc=73.69% | val: loss=0.7367 acc=60.24% f1=71.79% auc=55.99% val_score=45.0077 val_score_bestthr=64.2109 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.147, mb=0.493, no=0.985, corr=-0.386) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2109 -> 64.2109
[DBG][ep=049] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.1219 mb_mean=0.4987 norm_overlap=0.9783 corr_cb=-0.4947 topkJ=0.0004
[TRAIN][ep=049] loss=0.5409 acc=73.83%
[TRAIN][ep=049] mask_avg: mc_mean=0.1551 mb_mean=0.4928 norm_overlap=0.9855 corr_cb=-0.3891
[EPOCH 049/089] train: loss=0.5409 acc=73.83% | val: loss=0.7463 acc=60.24% f1=71.79% auc=57.03% val_score=36.1998 val_score_bestthr=64.2109 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.155, mb=0.493, no=0.985, corr=-0.389) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2109 -> 64.2109
[DBG][ep=050] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.1521 mb_mean=0.4892 norm_overlap=0.9911 corr_cb=-0.2651 topkJ=0.0101
[TRAIN][ep=050] loss=0.5302 acc=75.97%
[TRAIN][ep=050] mask_avg: mc_mean=0.1385 mb_mean=0.4928 norm_overlap=0.9848 corr_cb=-0.3785
[EPOCH 050/089] train: loss=0.5302 acc=75.97% | val: loss=0.7351 acc=60.24% f1=71.79% auc=56.10% val_score=43.0264 val_score_bestthr=64.2109 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.138, mb=0.493, no=0.985, corr=-0.378) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2109 -> 64.2109
[DBG][ep=051] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.1393 mb_mean=0.4934 norm_overlap=0.9858 corr_cb=-0.3486 topkJ=0.0096
[TRAIN][ep=051] loss=0.5314 acc=76.51%
[TRAIN][ep=051] mask_avg: mc_mean=0.1385 mb_mean=0.4928 norm_overlap=0.9847 corr_cb=-0.3798
[EPOCH 051/089] train: loss=0.5314 acc=76.51% | val: loss=0.7346 acc=60.24% f1=71.79% auc=56.40% val_score=44.1809 val_score_bestthr=64.2109 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.138, mb=0.493, no=0.985, corr=-0.380) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2109 -> 64.2109
[DBG][ep=052] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.1615 mb_mean=0.4942 norm_overlap=0.9805 corr_cb=-0.4423 topkJ=0.0044
[TRAIN][ep=052] loss=0.5310 acc=76.64%
[TRAIN][ep=052] mask_avg: mc_mean=0.1385 mb_mean=0.4928 norm_overlap=0.9848 corr_cb=-0.3778
[EPOCH 052/089] train: loss=0.5310 acc=76.64% | val: loss=0.7357 acc=60.24% f1=71.79% auc=56.28% val_score=43.9611 val_score_bestthr=64.2109 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.139, mb=0.493, no=0.985, corr=-0.378) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2109 -> 64.2109
[DBG][ep=053] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.1712 mb_mean=0.4891 norm_overlap=0.9884 corr_cb=-0.3738 topkJ=0.0059
[TRAIN][ep=053] loss=0.5334 acc=75.03%
[TRAIN][ep=053] mask_avg: mc_mean=0.1385 mb_mean=0.4928 norm_overlap=0.9847 corr_cb=-0.3793
[EPOCH 053/089] train: loss=0.5334 acc=75.03% | val: loss=0.7412 acc=60.24% f1=71.79% auc=56.98% val_score=38.9809 val_score_bestthr=64.2109 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.138, mb=0.493, no=0.985, corr=-0.379) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2109 -> 64.2109
[DBG][ep=054] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=054] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=054] mask(step0): mc_mean=0.1586 mb_mean=0.4947 norm_overlap=0.9812 corr_cb=-0.4559 topkJ=0.0008
[TRAIN][ep=054] loss=0.5314 acc=76.38%
[TRAIN][ep=054] mask_avg: mc_mean=0.1384 mb_mean=0.4928 norm_overlap=0.9848 corr_cb=-0.3795
[EPOCH 054/089] train: loss=0.5314 acc=76.38% | val: loss=0.7371 acc=60.24% f1=71.79% auc=56.16% val_score=43.9611 val_score_bestthr=64.2109 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.138, mb=0.493, no=0.985, corr=-0.379) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2109 -> 64.2109
[DBG][ep=055] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=055] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=055] mask(step0): mc_mean=0.1475 mb_mean=0.4973 norm_overlap=0.9786 corr_cb=-0.4808 topkJ=0.0008
[TRAIN][ep=055] loss=0.5278 acc=75.44%
[TRAIN][ep=055] mask_avg: mc_mean=0.1385 mb_mean=0.4928 norm_overlap=0.9846 corr_cb=-0.3800
[EPOCH 055/089] train: loss=0.5278 acc=75.44% | val: loss=0.7383 acc=60.24% f1=71.79% auc=56.28% val_score=46.3870 val_score_bestthr=64.2109 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.138, mb=0.493, no=0.985, corr=-0.380) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2109 -> 64.2109
[DBG][ep=056] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=056] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=056] mask(step0): mc_mean=0.1214 mb_mean=0.4947 norm_overlap=0.9813 corr_cb=-0.4570 topkJ=0.0020
[TRAIN][ep=056] loss=0.5243 acc=76.51%
[TRAIN][ep=056] mask_avg: mc_mean=0.1385 mb_mean=0.4928 norm_overlap=0.9846 corr_cb=-0.3815
[EPOCH 056/089] train: loss=0.5243 acc=76.51% | val: loss=0.7381 acc=60.24% f1=71.79% auc=56.28% val_score=43.9611 val_score_bestthr=64.2109 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.138, mb=0.493, no=0.985, corr=-0.382) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2109 -> 64.2109
[DBG][ep=057] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=057] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=057] mask(step0): mc_mean=0.1313 mb_mean=0.4919 norm_overlap=0.9796 corr_cb=-0.4730 topkJ=0.0024
[TRAIN][ep=057] loss=0.5264 acc=75.97%
[TRAIN][ep=057] mask_avg: mc_mean=0.1385 mb_mean=0.4928 norm_overlap=0.9848 corr_cb=-0.3785
[EPOCH 057/089] train: loss=0.5264 acc=75.97% | val: loss=0.7394 acc=60.24% f1=71.79% auc=56.28% val_score=46.3870 val_score_bestthr=64.2109 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.139, mb=0.493, no=0.985, corr=-0.379) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2109 -> 64.2109
[DBG][ep=058] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=058] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=058] mask(step0): mc_mean=0.1467 mb_mean=0.4906 norm_overlap=0.9856 corr_cb=-0.3035 topkJ=0.0008
[TRAIN][ep=058] loss=0.5287 acc=76.24%
[TRAIN][ep=058] mask_avg: mc_mean=0.1385 mb_mean=0.4928 norm_overlap=0.9848 corr_cb=-0.3787
[EPOCH 058/089] train: loss=0.5287 acc=76.24% | val: loss=0.7389 acc=60.24% f1=71.79% auc=56.34% val_score=43.9611 val_score_bestthr=64.2109 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.139, mb=0.493, no=0.985, corr=-0.379) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2109 -> 64.2109
[DBG][ep=059] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=059] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=059] mask(step0): mc_mean=0.1311 mb_mean=0.4954 norm_overlap=0.9818 corr_cb=-0.4588 topkJ=0.0004
[TRAIN][ep=059] loss=0.5283 acc=75.57%
[TRAIN][ep=059] mask_avg: mc_mean=0.1385 mb_mean=0.4928 norm_overlap=0.9847 corr_cb=-0.3802
[EPOCH 059/089] train: loss=0.5283 acc=75.57% | val: loss=0.7390 acc=60.24% f1=71.79% auc=56.40% val_score=43.2276 val_score_bestthr=64.2109 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.139, mb=0.493, no=0.985, corr=-0.380) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2109 -> 64.2109
[EARLY STOP] no improvement for 30 epochs. best_epoch=29
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
=============== FIT DONE ===============
[BEST] epoch=29 | val_acc=60.24% | val_f1=71.79% | val_auc=53.95% | val_score=47.0602 | val_score_bestthr=64.2109
[TEST@BEST] thr_used=0.520 | acc=60.39% f1=65.25% auc=63.04% | SP_sex=4.07% EO_sex=6.96% SP_age=10.29% EO_age=21.26%
[TIME] 1.52 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/summary_fold_1.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4925 mb_mean=0.4923 norm_overlap=1.0000 corr_cb=-0.0375 topkJ=0.0351
[TRAIN][ep=000] loss=0.6929 acc=50.74%
[TRAIN][ep=000] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0408
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4947 mb_mean=0.4925 norm_overlap=1.0000 corr_cb=0.0200 topkJ=0.0582
[TRAIN][ep=001] loss=0.6911 acc=52.89%
[TRAIN][ep=001] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0417
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4934 mb_mean=0.4912 norm_overlap=1.0000 corr_cb=-0.0761 topkJ=0.0212
[TRAIN][ep=002] loss=0.6913 acc=50.20%
[TRAIN][ep=002] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0335
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4946 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=0.0005 topkJ=0.0158
[TRAIN][ep=003] loss=0.6900 acc=56.51%
[TRAIN][ep=003] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0421
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4921 mb_mean=0.4935 norm_overlap=1.0000 corr_cb=0.0308 topkJ=0.0456
[TRAIN][ep=004] loss=0.6897 acc=56.11%
[TRAIN][ep=004] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0492
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4956 mb_mean=0.4905 norm_overlap=1.0000 corr_cb=-0.0217 topkJ=0.0255
[TRAIN][ep=005] loss=0.6869 acc=58.52%
[TRAIN][ep=005] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0414
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4955 mb_mean=0.4935 norm_overlap=1.0001 corr_cb=0.1792 topkJ=0.2987
[TRAIN][ep=006] loss=0.6849 acc=56.38%
[TRAIN][ep=006] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0439
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4934 mb_mean=0.4926 norm_overlap=1.0000 corr_cb=0.0730 topkJ=0.0188
[TRAIN][ep=007] loss=0.6841 acc=61.61%
[TRAIN][ep=007] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0419
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4941 mb_mean=0.4951 norm_overlap=1.0000 corr_cb=-0.0577 topkJ=0.0403
[TRAIN][ep=008] loss=0.6845 acc=57.05%
[TRAIN][ep=008] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0461
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4928 mb_mean=0.4945 norm_overlap=1.0001 corr_cb=0.2081 topkJ=0.0622
[TRAIN][ep=009] loss=0.6808 acc=59.06%
[TRAIN][ep=009] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0400
================= FIT START (fold=1) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4924 mb_mean=0.4908 norm_overlap=1.0000 corr_cb=-0.0313 topkJ=0.0382
[TRAIN][ep=000] loss=0.6781 acc=60.40%
[TRAIN][ep=000] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0416
[EPOCH 000/089] train: loss=0.6781 acc=60.40% | val: loss=0.6897 acc=57.83% f1=70.09% auc=51.80% val_score=36.4666 val_score_bestthr=59.4548 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.042) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 59.4548
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4945 mb_mean=0.4932 norm_overlap=1.0000 corr_cb=0.0532 topkJ=0.0351
[TRAIN][ep=001] loss=0.6737 acc=60.00%
[TRAIN][ep=001] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0445
[EPOCH 001/089] train: loss=0.6737 acc=60.00% | val: loss=0.6904 acc=56.63% f1=68.97% auc=52.85% val_score=44.5375 val_score_bestthr=56.3658 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.045) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 59.4548 -> 56.3658
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4957 mb_mean=0.4963 norm_overlap=1.0000 corr_cb=-0.0615 topkJ=0.0282
[TRAIN][ep=002] loss=0.6688 acc=64.16%
[TRAIN][ep=002] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0447
[EPOCH 002/089] train: loss=0.6688 acc=64.16% | val: loss=0.6906 acc=57.83% f1=70.09% auc=52.38% val_score=48.3492 val_score_bestthr=59.4548 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.045) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 59.4548 -> 59.4548
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4968 mb_mean=0.4929 norm_overlap=0.9999 corr_cb=-0.1262 topkJ=0.0038
[TRAIN][ep=003] loss=0.6632 acc=64.43%
[TRAIN][ep=003] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0468
[EPOCH 003/089] train: loss=0.6632 acc=64.43% | val: loss=0.6926 acc=56.63% f1=69.49% auc=53.08% val_score=50.6846 val_score_bestthr=57.5253 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.047) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 59.4548 -> 57.5253
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4915 mb_mean=0.4920 norm_overlap=1.0000 corr_cb=-0.0843 topkJ=0.0088
[TRAIN][ep=004] loss=0.6635 acc=59.33%
[TRAIN][ep=004] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0455
[EPOCH 004/089] train: loss=0.6635 acc=59.33% | val: loss=0.6921 acc=56.63% f1=67.86% auc=53.14% val_score=39.9178 val_score_bestthr=58.0319 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.046) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 59.4548 -> 58.0319
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4942 mb_mean=0.4946 norm_overlap=0.9999 corr_cb=-0.1495 topkJ=0.0119
[TRAIN][ep=005] loss=1.4270 acc=63.89%
[TRAIN][ep=005] mask_avg: mc_mean=0.3717 mb_mean=0.4928 norm_overlap=0.9988 corr_cb=-0.3748
[EPOCH 005/089] train: loss=1.4270 acc=63.89% | val: loss=0.6898 acc=57.83% f1=70.09% auc=52.97% val_score=45.1821 val_score_bestthr=59.4548 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.372, mb=0.493, no=0.999, corr=-0.375) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 59.4548 -> 59.4548
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2655 mb_mean=0.4960 norm_overlap=0.9957 corr_cb=-0.4926 topkJ=0.0031
[TRAIN][ep=006] loss=1.1939 acc=63.62%
[TRAIN][ep=006] mask_avg: mc_mean=0.2384 mb_mean=0.4928 norm_overlap=0.9967 corr_cb=-0.4223
[EPOCH 006/089] train: loss=1.1939 acc=63.62% | val: loss=0.6905 acc=59.04% f1=70.69% auc=52.44% val_score=41.5216 val_score_bestthr=60.9502 | dyn(w_pfs=0.240, w_sup=0.190, w_csuf=0.140, stage2=False) | mask(mc=0.238, mb=0.493, no=0.997, corr=-0.422) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 59.4548 -> 60.9502
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.1624 mb_mean=0.4992 norm_overlap=0.9952 corr_cb=-0.4701 topkJ=0.0083
[TRAIN][ep=007] loss=1.2754 acc=63.36%
[TRAIN][ep=007] mask_avg: mc_mean=0.1846 mb_mean=0.4928 norm_overlap=0.9953 corr_cb=-0.4267
[EPOCH 007/089] train: loss=1.2754 acc=63.36% | val: loss=0.6934 acc=56.63% f1=70.49% auc=53.37% val_score=36.2965 val_score_bestthr=61.6282 | dyn(w_pfs=0.280, w_sup=0.230, w_csuf=0.180, stage2=False) | mask(mc=0.185, mb=0.493, no=0.995, corr=-0.427) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 60.9502 -> 61.6282
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1658 mb_mean=0.4901 norm_overlap=0.9953 corr_cb=-0.4222 topkJ=0.0137
[TRAIN][ep=008] loss=1.3465 acc=65.91%
[TRAIN][ep=008] mask_avg: mc_mean=0.1440 mb_mean=0.4928 norm_overlap=0.9934 corr_cb=-0.4374
[EPOCH 008/089] train: loss=1.3465 acc=65.91% | val: loss=0.6937 acc=56.63% f1=67.86% auc=54.01% val_score=44.7080 val_score_bestthr=58.0319 | dyn(w_pfs=0.320, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.144, mb=0.493, no=0.993, corr=-0.437) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.6282 -> 58.0319
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1077 mb_mean=0.4926 norm_overlap=0.9921 corr_cb=-0.3965 topkJ=0.0173
[TRAIN][ep=009] loss=1.4023 acc=62.28%
[TRAIN][ep=009] mask_avg: mc_mean=0.1149 mb_mean=0.4928 norm_overlap=0.9916 corr_cb=-0.4346
[EPOCH 009/089] train: loss=1.4023 acc=62.28% | val: loss=0.6945 acc=56.63% f1=68.97% auc=53.66% val_score=42.2887 val_score_bestthr=58.9155 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.115, mb=0.493, no=0.992, corr=-0.435) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.6282 -> 58.9155
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.0878 mb_mean=0.4963 norm_overlap=0.9911 corr_cb=-0.4689 topkJ=0.0027
[TRAIN][ep=010] loss=1.4094 acc=63.22%
[TRAIN][ep=010] mask_avg: mc_mean=0.0954 mb_mean=0.4928 norm_overlap=0.9903 corr_cb=-0.4188
[EPOCH 010/089] train: loss=1.4094 acc=63.22% | val: loss=0.6950 acc=57.83% f1=70.09% auc=53.84% val_score=45.1492 val_score_bestthr=61.1560 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.095, mb=0.493, no=0.990, corr=-0.419) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.6282 -> 61.1560
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.0713 mb_mean=0.4924 norm_overlap=0.9906 corr_cb=-0.3494 topkJ=0.0095
[TRAIN][ep=011] loss=1.3929 acc=65.91%
[TRAIN][ep=011] mask_avg: mc_mean=0.0854 mb_mean=0.4928 norm_overlap=0.9892 corr_cb=-0.4154
[EPOCH 011/089] train: loss=1.3929 acc=65.91% | val: loss=0.6976 acc=57.83% f1=70.09% auc=53.95% val_score=45.9611 val_score_bestthr=61.1560 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.085, mb=0.493, no=0.989, corr=-0.415) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.6282 -> 61.1560
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.0735 mb_mean=0.4959 norm_overlap=0.9873 corr_cb=-0.4410 topkJ=0.0084
[TRAIN][ep=012] loss=1.3853 acc=68.46%
[TRAIN][ep=012] mask_avg: mc_mean=0.0780 mb_mean=0.4928 norm_overlap=0.9877 corr_cb=-0.4134
[EPOCH 012/089] train: loss=1.3853 acc=68.46% | val: loss=0.6994 acc=57.83% f1=70.09% auc=53.78% val_score=45.0888 val_score_bestthr=61.1560 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.078, mb=0.493, no=0.988, corr=-0.413) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.6282 -> 61.1560
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.0445 mb_mean=0.4973 norm_overlap=0.9840 corr_cb=-0.3947 topkJ=0.0020
[TRAIN][ep=013] loss=0.9748 acc=63.62%
[TRAIN][ep=013] mask_avg: mc_mean=0.0692 mb_mean=0.4928 norm_overlap=0.9863 corr_cb=-0.4006
[EPOCH 013/089] train: loss=0.9748 acc=63.62% | val: loss=0.7176 acc=57.83% f1=66.02% auc=54.19% val_score=38.6264 val_score_bestthr=61.3809 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.069, mb=0.493, no=0.986, corr=-0.401) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.6282 -> 61.3809
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.0563 mb_mean=0.4931 norm_overlap=0.9831 corr_cb=-0.4590 topkJ=0.0071
[TRAIN][ep=014] loss=0.8824 acc=68.99%
[TRAIN][ep=014] mask_avg: mc_mean=0.0697 mb_mean=0.4928 norm_overlap=0.9856 corr_cb=-0.4050
[EPOCH 014/089] train: loss=0.8824 acc=68.99% | val: loss=0.7297 acc=56.63% f1=69.49% auc=53.95% val_score=41.9710 val_score_bestthr=60.5105 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.070, mb=0.493, no=0.986, corr=-0.405) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.6282 -> 60.5105
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.0939 mb_mean=0.4915 norm_overlap=0.9904 corr_cb=-0.3833 topkJ=0.0126
[TRAIN][ep=015] loss=0.8828 acc=66.58%
[TRAIN][ep=015] mask_avg: mc_mean=0.0676 mb_mean=0.4928 norm_overlap=0.9846 corr_cb=-0.3979
[EPOCH 015/089] train: loss=0.8828 acc=66.58% | val: loss=0.7166 acc=59.04% f1=71.19% auc=52.91% val_score=47.0193 val_score_bestthr=62.2793 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.068, mb=0.493, no=0.985, corr=-0.398) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 61.6282 -> 62.2793
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.0720 mb_mean=0.4960 norm_overlap=0.9810 corr_cb=-0.4466 topkJ=0.0008
[TRAIN][ep=016] loss=0.8746 acc=67.11%
[TRAIN][ep=016] mask_avg: mc_mean=0.0769 mb_mean=0.4928 norm_overlap=0.9846 corr_cb=-0.4155
[EPOCH 016/089] train: loss=0.8746 acc=67.11% | val: loss=0.7077 acc=57.83% f1=70.09% auc=54.24% val_score=40.2756 val_score_bestthr=61.1560 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.077, mb=0.493, no=0.985, corr=-0.415) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.2793 -> 61.1560
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.0842 mb_mean=0.4935 norm_overlap=0.9840 corr_cb=-0.4598 topkJ=0.0060
[TRAIN][ep=017] loss=0.8748 acc=68.32%
[TRAIN][ep=017] mask_avg: mc_mean=0.0814 mb_mean=0.4928 norm_overlap=0.9843 corr_cb=-0.4177
[EPOCH 017/089] train: loss=0.8748 acc=68.32% | val: loss=0.7148 acc=57.83% f1=70.09% auc=53.43% val_score=52.4353 val_score_bestthr=61.1560 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.081, mb=0.493, no=0.984, corr=-0.418) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.2793 -> 61.1560
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.0709 mb_mean=0.4913 norm_overlap=0.9877 corr_cb=-0.3274 topkJ=0.0107
[TRAIN][ep=018] loss=0.9463 acc=71.28%
[TRAIN][ep=018] mask_avg: mc_mean=0.0701 mb_mean=0.4928 norm_overlap=0.9830 corr_cb=-0.4013
[EPOCH 018/089] train: loss=0.9463 acc=71.28% | val: loss=0.7143 acc=57.83% f1=70.09% auc=54.30% val_score=53.9340 val_score_bestthr=61.1560 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.070, mb=0.493, no=0.983, corr=-0.401) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.2793 -> 61.1560
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.0884 mb_mean=0.4941 norm_overlap=0.9877 corr_cb=-0.3629 topkJ=0.0112
[TRAIN][ep=019] loss=0.8623 acc=70.07%
[TRAIN][ep=019] mask_avg: mc_mean=0.0731 mb_mean=0.4928 norm_overlap=0.9826 corr_cb=-0.4055
[EPOCH 019/089] train: loss=0.8623 acc=70.07% | val: loss=0.7180 acc=57.83% f1=70.09% auc=54.24% val_score=42.3869 val_score_bestthr=61.1560 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.073, mb=0.493, no=0.983, corr=-0.405) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.2793 -> 61.1560
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.0952 mb_mean=0.4898 norm_overlap=0.9866 corr_cb=-0.3776 topkJ=0.0047
[TRAIN][ep=020] loss=0.8559 acc=70.20%
[TRAIN][ep=020] mask_avg: mc_mean=0.0850 mb_mean=0.4928 norm_overlap=0.9829 corr_cb=-0.4221
[EPOCH 020/089] train: loss=0.8559 acc=70.20% | val: loss=0.7258 acc=57.83% f1=70.09% auc=55.29% val_score=38.6181 val_score_bestthr=61.1560 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.085, mb=0.493, no=0.983, corr=-0.422) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.2793 -> 61.1560
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.0889 mb_mean=0.4926 norm_overlap=0.9863 corr_cb=-0.4399 topkJ=0.0044
[TRAIN][ep=021] loss=0.8442 acc=68.72%
[TRAIN][ep=021] mask_avg: mc_mean=0.1009 mb_mean=0.4928 norm_overlap=0.9836 corr_cb=-0.4365
[EPOCH 021/089] train: loss=0.8442 acc=68.72% | val: loss=0.7425 acc=57.83% f1=70.09% auc=55.35% val_score=37.1390 val_score_bestthr=61.1560 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.101, mb=0.493, no=0.984, corr=-0.436) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.2793 -> 61.1560
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1039 mb_mean=0.4906 norm_overlap=0.9834 corr_cb=-0.4332 topkJ=0.0004
[TRAIN][ep=022] loss=0.8466 acc=70.60%
[TRAIN][ep=022] mask_avg: mc_mean=0.0819 mb_mean=0.4928 norm_overlap=0.9822 corr_cb=-0.4122
[EPOCH 022/089] train: loss=0.8466 acc=70.60% | val: loss=0.7170 acc=61.45% f1=71.93% auc=55.06% val_score=49.2817 val_score_bestthr=65.6471 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.082, mb=0.493, no=0.982, corr=-0.412) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 62.2793 -> 65.6471
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.0787 mb_mean=0.4932 norm_overlap=0.9755 corr_cb=-0.4685 topkJ=0.0015
[TRAIN][ep=023] loss=0.9215 acc=70.74%
[TRAIN][ep=023] mask_avg: mc_mean=0.0803 mb_mean=0.4928 norm_overlap=0.9821 corr_cb=-0.4064
[EPOCH 023/089] train: loss=0.9215 acc=70.74% | val: loss=0.7177 acc=60.24% f1=71.30% auc=55.12% val_score=43.5062 val_score_bestthr=62.5929 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.080, mb=0.493, no=0.982, corr=-0.406) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6471 -> 62.5929
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.0821 mb_mean=0.4927 norm_overlap=0.9832 corr_cb=-0.4398 topkJ=0.0016
[TRAIN][ep=024] loss=1.0016 acc=74.09%
[TRAIN][ep=024] mask_avg: mc_mean=0.0949 mb_mean=0.4928 norm_overlap=0.9828 corr_cb=-0.4232
[EPOCH 024/089] train: loss=1.0016 acc=74.09% | val: loss=0.7139 acc=62.65% f1=73.04% auc=56.10% val_score=44.3065 val_score_bestthr=66.3367 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.095, mb=0.493, no=0.983, corr=-0.423) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 65.6471 -> 66.3367
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.0625 mb_mean=0.4924 norm_overlap=0.9833 corr_cb=-0.3799 topkJ=0.0063
[TRAIN][ep=025] loss=1.0823 acc=70.20%
[TRAIN][ep=025] mask_avg: mc_mean=0.0801 mb_mean=0.4928 norm_overlap=0.9816 corr_cb=-0.3994
[EPOCH 025/089] train: loss=1.0823 acc=70.20% | val: loss=0.7321 acc=62.65% f1=73.04% auc=55.81% val_score=49.0527 val_score_bestthr=66.3367 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.080, mb=0.493, no=0.982, corr=-0.399) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 66.3367
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.0907 mb_mean=0.4922 norm_overlap=0.9883 corr_cb=-0.3312 topkJ=0.0057
[TRAIN][ep=026] loss=1.1625 acc=72.08%
[TRAIN][ep=026] mask_avg: mc_mean=0.0992 mb_mean=0.4928 norm_overlap=0.9827 corr_cb=-0.4187
[EPOCH 026/089] train: loss=1.1625 acc=72.08% | val: loss=0.7264 acc=60.24% f1=71.30% auc=55.81% val_score=37.3543 val_score_bestthr=62.5929 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.099, mb=0.493, no=0.983, corr=-0.419) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 62.5929
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1200 mb_mean=0.4908 norm_overlap=0.9847 corr_cb=-0.3917 topkJ=0.0016
[TRAIN][ep=027] loss=1.2317 acc=73.69%
[TRAIN][ep=027] mask_avg: mc_mean=0.0931 mb_mean=0.4928 norm_overlap=0.9823 corr_cb=-0.4084
[EPOCH 027/089] train: loss=1.2317 acc=73.69% | val: loss=0.7237 acc=61.45% f1=71.93% auc=56.10% val_score=35.5223 val_score_bestthr=65.6471 | dyn(w_pfs=0.240, w_sup=0.240, w_csuf=0.200, stage2=False) | mask(mc=0.093, mb=0.493, no=0.982, corr=-0.408) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 65.6471
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.0764 mb_mean=0.4955 norm_overlap=0.9789 corr_cb=-0.4359 topkJ=0.0032
[TRAIN][ep=028] loss=1.2558 acc=71.54%
[TRAIN][ep=028] mask_avg: mc_mean=0.0842 mb_mean=0.4928 norm_overlap=0.9816 corr_cb=-0.3933
[EPOCH 028/089] train: loss=1.2558 acc=71.54% | val: loss=0.7249 acc=62.65% f1=73.04% auc=55.41% val_score=46.8212 val_score_bestthr=66.3367 | dyn(w_pfs=0.280, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.084, mb=0.493, no=0.982, corr=-0.393) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 66.3367
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.0691 mb_mean=0.4953 norm_overlap=0.9771 corr_cb=-0.4430 topkJ=0.0012
[TRAIN][ep=029] loss=1.2466 acc=75.44%
[TRAIN][ep=029] mask_avg: mc_mean=0.1080 mb_mean=0.4928 norm_overlap=0.9829 corr_cb=-0.4215
[EPOCH 029/089] train: loss=1.2466 acc=75.44% | val: loss=0.7283 acc=62.65% f1=73.04% auc=55.41% val_score=46.5975 val_score_bestthr=66.3367 | dyn(w_pfs=0.180, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.108, mb=0.493, no=0.983, corr=-0.421) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 66.3367
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.0713 mb_mean=0.4980 norm_overlap=0.9674 corr_cb=-0.5352 topkJ=0.0004
[TRAIN][ep=030] loss=1.0450 acc=71.14%
[TRAIN][ep=030] mask_avg: mc_mean=0.0959 mb_mean=0.4928 norm_overlap=0.9821 corr_cb=-0.4041
[EPOCH 030/089] train: loss=1.0450 acc=71.14% | val: loss=0.7254 acc=62.65% f1=73.04% auc=55.47% val_score=48.6173 val_score_bestthr=66.3367 | dyn(w_pfs=0.080, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.096, mb=0.493, no=0.982, corr=-0.404) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 66.3367
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.0940 mb_mean=0.4927 norm_overlap=0.9773 corr_cb=-0.5006 topkJ=0.0016
[TRAIN][ep=031] loss=0.8443 acc=72.21%
[TRAIN][ep=031] mask_avg: mc_mean=0.0884 mb_mean=0.4928 norm_overlap=0.9815 corr_cb=-0.3959
[EPOCH 031/089] train: loss=0.8443 acc=72.21% | val: loss=0.7321 acc=61.45% f1=71.93% auc=56.22% val_score=36.1150 val_score_bestthr=65.6471 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.088, mb=0.493, no=0.981, corr=-0.396) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 65.6471
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1128 mb_mean=0.4887 norm_overlap=0.9892 corr_cb=-0.2438 topkJ=0.0188
[TRAIN][ep=032] loss=0.7916 acc=73.83%
[TRAIN][ep=032] mask_avg: mc_mean=0.0989 mb_mean=0.4928 norm_overlap=0.9822 corr_cb=-0.4062
[EPOCH 032/089] train: loss=0.7916 acc=73.83% | val: loss=0.7415 acc=61.45% f1=71.93% auc=56.80% val_score=37.9771 val_score_bestthr=65.6471 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.099, mb=0.493, no=0.982, corr=-0.406) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 65.6471
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1024 mb_mean=0.4927 norm_overlap=0.9801 corr_cb=-0.4000 topkJ=0.0035
[TRAIN][ep=033] loss=0.7836 acc=75.17%
[TRAIN][ep=033] mask_avg: mc_mean=0.0982 mb_mean=0.4928 norm_overlap=0.9820 corr_cb=-0.4041
[EPOCH 033/089] train: loss=0.7836 acc=75.17% | val: loss=0.7323 acc=61.45% f1=71.93% auc=56.40% val_score=43.2839 val_score_bestthr=65.6471 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.098, mb=0.493, no=0.982, corr=-0.404) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 65.6471
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1029 mb_mean=0.4908 norm_overlap=0.9870 corr_cb=-0.3324 topkJ=0.0139
[TRAIN][ep=034] loss=0.7740 acc=75.57%
[TRAIN][ep=034] mask_avg: mc_mean=0.1103 mb_mean=0.4928 norm_overlap=0.9828 corr_cb=-0.4122
[EPOCH 034/089] train: loss=0.7740 acc=75.57% | val: loss=0.7457 acc=61.45% f1=71.93% auc=56.63% val_score=43.9611 val_score_bestthr=65.6471 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.110, mb=0.493, no=0.983, corr=-0.412) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 65.6471
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.1233 mb_mean=0.4924 norm_overlap=0.9869 corr_cb=-0.4125 topkJ=0.0052
[TRAIN][ep=035] loss=0.7799 acc=74.09%
[TRAIN][ep=035] mask_avg: mc_mean=0.1062 mb_mean=0.4928 norm_overlap=0.9825 corr_cb=-0.4063
[EPOCH 035/089] train: loss=0.7799 acc=74.09% | val: loss=0.7430 acc=61.45% f1=71.93% auc=56.86% val_score=45.8320 val_score_bestthr=65.6471 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.106, mb=0.493, no=0.982, corr=-0.406) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 65.6471
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.1069 mb_mean=0.4918 norm_overlap=0.9867 corr_cb=-0.3018 topkJ=0.0024
[TRAIN][ep=036] loss=0.7735 acc=74.23%
[TRAIN][ep=036] mask_avg: mc_mean=0.1091 mb_mean=0.4928 norm_overlap=0.9828 corr_cb=-0.4081
[EPOCH 036/089] train: loss=0.7735 acc=74.23% | val: loss=0.7443 acc=61.45% f1=71.93% auc=57.44% val_score=43.3323 val_score_bestthr=65.6471 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.109, mb=0.493, no=0.983, corr=-0.408) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 65.6471
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1451 mb_mean=0.4913 norm_overlap=0.9803 corr_cb=-0.4554 topkJ=0.0000
[TRAIN][ep=037] loss=0.7729 acc=73.69%
[TRAIN][ep=037] mask_avg: mc_mean=0.1172 mb_mean=0.4928 norm_overlap=0.9830 corr_cb=-0.4158
[EPOCH 037/089] train: loss=0.7729 acc=73.69% | val: loss=0.7612 acc=60.24% f1=70.80% auc=57.21% val_score=34.6082 val_score_bestthr=63.7365 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.117, mb=0.493, no=0.983, corr=-0.416) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 63.7365
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.1282 mb_mean=0.4918 norm_overlap=0.9829 corr_cb=-0.4191 topkJ=0.0044
[TRAIN][ep=038] loss=0.7592 acc=75.30%
[TRAIN][ep=038] mask_avg: mc_mean=0.1151 mb_mean=0.4928 norm_overlap=0.9829 corr_cb=-0.4097
[EPOCH 038/089] train: loss=0.7592 acc=75.30% | val: loss=0.7342 acc=62.65% f1=73.04% auc=56.74% val_score=44.3097 val_score_bestthr=66.3367 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.115, mb=0.493, no=0.983, corr=-0.410) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 66.3367
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.1323 mb_mean=0.4933 norm_overlap=0.9768 corr_cb=-0.5178 topkJ=0.0004
[TRAIN][ep=039] loss=0.7529 acc=76.91%
[TRAIN][ep=039] mask_avg: mc_mean=0.1252 mb_mean=0.4928 norm_overlap=0.9833 corr_cb=-0.4168
[EPOCH 039/089] train: loss=0.7529 acc=76.91% | val: loss=0.7669 acc=61.45% f1=71.93% auc=57.09% val_score=39.8457 val_score_bestthr=65.6471 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.125, mb=0.493, no=0.983, corr=-0.417) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 65.6471
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.1281 mb_mean=0.4926 norm_overlap=0.9806 corr_cb=-0.4618 topkJ=0.0051
[TRAIN][ep=040] loss=0.7407 acc=76.24%
[TRAIN][ep=040] mask_avg: mc_mean=0.1292 mb_mean=0.4928 norm_overlap=0.9837 corr_cb=-0.4140
[EPOCH 040/089] train: loss=0.7407 acc=76.24% | val: loss=0.7599 acc=61.45% f1=71.93% auc=57.27% val_score=41.0817 val_score_bestthr=65.6471 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.129, mb=0.493, no=0.984, corr=-0.414) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 65.6471
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.1350 mb_mean=0.4934 norm_overlap=0.9870 corr_cb=-0.3537 topkJ=0.0020
[TRAIN][ep=041] loss=0.7295 acc=78.79%
[TRAIN][ep=041] mask_avg: mc_mean=0.1201 mb_mean=0.4928 norm_overlap=0.9831 corr_cb=-0.4078
[EPOCH 041/089] train: loss=0.7295 acc=78.79% | val: loss=0.7631 acc=61.45% f1=71.93% auc=57.27% val_score=39.9588 val_score_bestthr=65.6471 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.120, mb=0.493, no=0.983, corr=-0.408) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 65.6471
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.1584 mb_mean=0.4932 norm_overlap=0.9827 corr_cb=-0.4850 topkJ=0.0008
[TRAIN][ep=042] loss=0.7371 acc=77.05%
[TRAIN][ep=042] mask_avg: mc_mean=0.1241 mb_mean=0.4928 norm_overlap=0.9833 corr_cb=-0.4081
[EPOCH 042/089] train: loss=0.7371 acc=77.05% | val: loss=0.7474 acc=60.24% f1=70.80% auc=57.44% val_score=41.9064 val_score_bestthr=63.7365 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.124, mb=0.493, no=0.983, corr=-0.408) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 63.7365
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.1191 mb_mean=0.4932 norm_overlap=0.9801 corr_cb=-0.4288 topkJ=0.0008
[TRAIN][ep=043] loss=0.7255 acc=77.72%
[TRAIN][ep=043] mask_avg: mc_mean=0.1295 mb_mean=0.4928 norm_overlap=0.9835 corr_cb=-0.4117
[EPOCH 043/089] train: loss=0.7255 acc=77.72% | val: loss=0.8078 acc=59.04% f1=70.69% auc=58.49% val_score=43.1348 val_score_bestthr=62.6514 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.129, mb=0.493, no=0.983, corr=-0.412) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 62.6514
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.1447 mb_mean=0.4931 norm_overlap=0.9847 corr_cb=-0.4214 topkJ=0.0032
[TRAIN][ep=044] loss=0.7395 acc=75.44%
[TRAIN][ep=044] mask_avg: mc_mean=0.1166 mb_mean=0.4928 norm_overlap=0.9827 corr_cb=-0.3990
[EPOCH 044/089] train: loss=0.7395 acc=75.44% | val: loss=0.7522 acc=61.45% f1=71.93% auc=57.56% val_score=42.2269 val_score_bestthr=65.6471 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.117, mb=0.493, no=0.983, corr=-0.399) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 65.6471
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.1084 mb_mean=0.4935 norm_overlap=0.9857 corr_cb=-0.3733 topkJ=0.0032
[TRAIN][ep=045] loss=0.7162 acc=76.11%
[TRAIN][ep=045] mask_avg: mc_mean=0.1267 mb_mean=0.4928 norm_overlap=0.9833 corr_cb=-0.4039
[EPOCH 045/089] train: loss=0.7162 acc=76.11% | val: loss=0.7884 acc=59.04% f1=71.19% auc=57.27% val_score=48.7056 val_score_bestthr=62.2793 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.127, mb=0.493, no=0.983, corr=-0.404) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 62.2793
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.1483 mb_mean=0.4928 norm_overlap=0.9818 corr_cb=-0.4266 topkJ=0.0047
[TRAIN][ep=046] loss=0.7150 acc=77.72%
[TRAIN][ep=046] mask_avg: mc_mean=0.1420 mb_mean=0.4928 norm_overlap=0.9840 corr_cb=-0.4157
[EPOCH 046/089] train: loss=0.7150 acc=77.72% | val: loss=0.7643 acc=59.04% f1=71.19% auc=58.72% val_score=39.4546 val_score_bestthr=62.2793 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.142, mb=0.493, no=0.984, corr=-0.416) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 62.2793
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.1154 mb_mean=0.4929 norm_overlap=0.9801 corr_cb=-0.4206 topkJ=0.0012
[TRAIN][ep=047] loss=0.7200 acc=76.11%
[TRAIN][ep=047] mask_avg: mc_mean=0.1318 mb_mean=0.4928 norm_overlap=0.9835 corr_cb=-0.4079
[EPOCH 047/089] train: loss=0.7200 acc=76.11% | val: loss=0.7803 acc=59.04% f1=71.19% auc=57.79% val_score=44.7107 val_score_bestthr=62.2793 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.132, mb=0.493, no=0.983, corr=-0.408) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 62.2793
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.1366 mb_mean=0.4913 norm_overlap=0.9877 corr_cb=-0.3964 topkJ=0.0056
[TRAIN][ep=048] loss=0.7171 acc=77.85%
[TRAIN][ep=048] mask_avg: mc_mean=0.1327 mb_mean=0.4928 norm_overlap=0.9837 corr_cb=-0.4045
[EPOCH 048/089] train: loss=0.7171 acc=77.85% | val: loss=0.7696 acc=60.24% f1=70.80% auc=58.20% val_score=51.2624 val_score_bestthr=63.7365 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.133, mb=0.493, no=0.984, corr=-0.405) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 63.7365
[DBG][ep=049] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.0922 mb_mean=0.4987 norm_overlap=0.9742 corr_cb=-0.5259 topkJ=0.0008
[TRAIN][ep=049] loss=0.6975 acc=78.93%
[TRAIN][ep=049] mask_avg: mc_mean=0.1397 mb_mean=0.4928 norm_overlap=0.9840 corr_cb=-0.4070
[EPOCH 049/089] train: loss=0.6975 acc=78.93% | val: loss=0.7981 acc=59.04% f1=71.19% auc=58.43% val_score=47.7475 val_score_bestthr=62.2793 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.140, mb=0.493, no=0.984, corr=-0.407) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 62.2793
[DBG][ep=050] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.1341 mb_mean=0.4892 norm_overlap=0.9905 corr_cb=-0.2675 topkJ=0.0192
[TRAIN][ep=050] loss=0.6777 acc=80.40%
[TRAIN][ep=050] mask_avg: mc_mean=0.1173 mb_mean=0.4928 norm_overlap=0.9830 corr_cb=-0.3887
[EPOCH 050/089] train: loss=0.6777 acc=80.40% | val: loss=0.7699 acc=60.24% f1=71.30% auc=58.31% val_score=40.1123 val_score_bestthr=63.2773 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.117, mb=0.493, no=0.983, corr=-0.389) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 63.2773
[DBG][ep=051] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.1194 mb_mean=0.4934 norm_overlap=0.9823 corr_cb=-0.4040 topkJ=0.0058
[TRAIN][ep=051] loss=0.6758 acc=80.81%
[TRAIN][ep=051] mask_avg: mc_mean=0.1174 mb_mean=0.4928 norm_overlap=0.9827 corr_cb=-0.3916
[EPOCH 051/089] train: loss=0.6758 acc=80.81% | val: loss=0.7721 acc=60.24% f1=71.30% auc=58.26% val_score=40.1123 val_score_bestthr=63.2773 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.117, mb=0.493, no=0.983, corr=-0.392) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 63.2773
[DBG][ep=052] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.1497 mb_mean=0.4942 norm_overlap=0.9773 corr_cb=-0.4802 topkJ=0.0040
[TRAIN][ep=052] loss=0.6765 acc=80.54%
[TRAIN][ep=052] mask_avg: mc_mean=0.1174 mb_mean=0.4928 norm_overlap=0.9830 corr_cb=-0.3879
[EPOCH 052/089] train: loss=0.6765 acc=80.54% | val: loss=0.7725 acc=59.04% f1=71.19% auc=58.26% val_score=41.0539 val_score_bestthr=62.2793 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.117, mb=0.493, no=0.983, corr=-0.388) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 62.2793
[DBG][ep=053] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.1546 mb_mean=0.4891 norm_overlap=0.9878 corr_cb=-0.3656 topkJ=0.0070
[TRAIN][ep=053] loss=0.6809 acc=79.73%
[TRAIN][ep=053] mask_avg: mc_mean=0.1174 mb_mean=0.4928 norm_overlap=0.9828 corr_cb=-0.3904
[EPOCH 053/089] train: loss=0.6809 acc=79.73% | val: loss=0.7809 acc=59.04% f1=71.19% auc=58.55% val_score=44.9505 val_score_bestthr=62.2793 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.117, mb=0.493, no=0.983, corr=-0.390) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 62.2793
[DBG][ep=054] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=054] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=054] mask(step0): mc_mean=0.1407 mb_mean=0.4947 norm_overlap=0.9783 corr_cb=-0.4836 topkJ=0.0004
[TRAIN][ep=054] loss=0.6807 acc=80.67%
[TRAIN][ep=054] mask_avg: mc_mean=0.1173 mb_mean=0.4928 norm_overlap=0.9829 corr_cb=-0.3901
[EPOCH 054/089] train: loss=0.6807 acc=80.67% | val: loss=0.7774 acc=59.04% f1=71.19% auc=57.97% val_score=42.0267 val_score_bestthr=62.2793 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.117, mb=0.493, no=0.983, corr=-0.390) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 62.2793
[EARLY STOP] no improvement for 30 epochs. best_epoch=24
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
=============== FIT DONE ===============
[BEST] epoch=24 | val_acc=62.65% | val_f1=73.04% | val_auc=56.10% | val_score=44.3065 | val_score_bestthr=66.3367
[TEST@BEST] thr_used=0.465 | acc=61.84% f1=66.67% auc=65.02% | SP_sex=3.89% EO_sex=6.37% SP_age=18.34% EO_age=17.82%
[TIME] 1.43 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/summary_fold_1.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4925 mb_mean=0.4923 norm_overlap=1.0000 corr_cb=-0.0375 topkJ=0.0351
[TRAIN][ep=000] loss=0.6929 acc=50.74%
[TRAIN][ep=000] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0408
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4947 mb_mean=0.4925 norm_overlap=1.0000 corr_cb=0.0200 topkJ=0.0582
[TRAIN][ep=001] loss=0.6911 acc=52.89%
[TRAIN][ep=001] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0417
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4934 mb_mean=0.4912 norm_overlap=1.0000 corr_cb=-0.0761 topkJ=0.0212
[TRAIN][ep=002] loss=0.6913 acc=50.20%
[TRAIN][ep=002] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0335
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4946 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=0.0005 topkJ=0.0158
[TRAIN][ep=003] loss=0.6900 acc=56.51%
[TRAIN][ep=003] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0421
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4921 mb_mean=0.4935 norm_overlap=1.0000 corr_cb=0.0308 topkJ=0.0456
[TRAIN][ep=004] loss=0.6897 acc=56.11%
[TRAIN][ep=004] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0492
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4956 mb_mean=0.4905 norm_overlap=1.0000 corr_cb=-0.0217 topkJ=0.0255
[TRAIN][ep=005] loss=0.6869 acc=58.52%
[TRAIN][ep=005] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0414
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4955 mb_mean=0.4935 norm_overlap=1.0001 corr_cb=0.1792 topkJ=0.2987
[TRAIN][ep=006] loss=0.6849 acc=56.38%
[TRAIN][ep=006] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0439
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4934 mb_mean=0.4926 norm_overlap=1.0000 corr_cb=0.0730 topkJ=0.0188
[TRAIN][ep=007] loss=0.6841 acc=61.61%
[TRAIN][ep=007] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0419
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4941 mb_mean=0.4951 norm_overlap=1.0000 corr_cb=-0.0577 topkJ=0.0403
[TRAIN][ep=008] loss=0.6845 acc=57.05%
[TRAIN][ep=008] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0461
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4928 mb_mean=0.4945 norm_overlap=1.0001 corr_cb=0.2081 topkJ=0.0622
[TRAIN][ep=009] loss=0.6808 acc=59.19%
[TRAIN][ep=009] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0400
================= FIT START (fold=1) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.45 select_by=val_score_bestthr | eval_thr_mode=fixed eval_thr_grid=coarse | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4924 mb_mean=0.4908 norm_overlap=1.0000 corr_cb=-0.0313 topkJ=0.0382
[TRAIN][ep=000] loss=0.6781 acc=60.40%
[TRAIN][ep=000] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0416
[EPOCH 000/089] train: loss=0.6781 acc=60.40% | val: loss=0.6897 acc=54.22% f1=69.35% auc=51.86% val_score=62.1876 val_score_bestthr=62.1876 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.042) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 62.1876
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4945 mb_mean=0.4932 norm_overlap=1.0000 corr_cb=0.0532 topkJ=0.0351
[TRAIN][ep=001] loss=0.6737 acc=60.00%
[TRAIN][ep=001] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0445
[EPOCH 001/089] train: loss=0.6737 acc=60.00% | val: loss=0.6904 acc=56.63% f1=67.86% auc=52.85% val_score=51.3854 val_score_bestthr=51.3854 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.045) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.1876 -> 51.3854
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4957 mb_mean=0.4963 norm_overlap=1.0000 corr_cb=-0.0615 topkJ=0.0282
[TRAIN][ep=002] loss=0.6688 acc=64.30%
[TRAIN][ep=002] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0447
[EPOCH 002/089] train: loss=0.6688 acc=64.30% | val: loss=0.6906 acc=53.01% f1=68.29% auc=52.38% val_score=58.0891 val_score_bestthr=58.0891 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.045) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.1876 -> 58.0891
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4968 mb_mean=0.4929 norm_overlap=0.9999 corr_cb=-0.1262 topkJ=0.0038
[TRAIN][ep=003] loss=0.6632 acc=64.43%
[TRAIN][ep=003] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0468
[EPOCH 003/089] train: loss=0.6632 acc=64.43% | val: loss=0.6926 acc=53.01% f1=68.29% auc=53.08% val_score=58.0891 val_score_bestthr=58.0891 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.047) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.1876 -> 58.0891
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4915 mb_mean=0.4920 norm_overlap=1.0000 corr_cb=-0.0843 topkJ=0.0088
[TRAIN][ep=004] loss=0.6635 acc=59.33%
[TRAIN][ep=004] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0455
[EPOCH 004/089] train: loss=0.6635 acc=59.33% | val: loss=0.6921 acc=53.01% f1=60.61% auc=53.14% val_score=43.0375 val_score_bestthr=43.0375 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.046) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.1876 -> 43.0375
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4942 mb_mean=0.4946 norm_overlap=0.9999 corr_cb=-0.1495 topkJ=0.0119
[TRAIN][ep=005] loss=1.4270 acc=63.76%
[TRAIN][ep=005] mask_avg: mc_mean=0.3717 mb_mean=0.4928 norm_overlap=0.9988 corr_cb=-0.3748
[EPOCH 005/089] train: loss=1.4270 acc=63.76% | val: loss=0.6898 acc=51.81% f1=62.96% auc=53.02% val_score=47.2373 val_score_bestthr=47.2373 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.372, mb=0.493, no=0.999, corr=-0.375) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.1876 -> 47.2373
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2655 mb_mean=0.4960 norm_overlap=0.9957 corr_cb=-0.4926 topkJ=0.0031
[TRAIN][ep=006] loss=1.1939 acc=63.62%
[TRAIN][ep=006] mask_avg: mc_mean=0.2384 mb_mean=0.4928 norm_overlap=0.9967 corr_cb=-0.4223
[EPOCH 006/089] train: loss=1.1939 acc=63.62% | val: loss=0.6905 acc=55.42% f1=66.67% auc=52.50% val_score=53.9141 val_score_bestthr=53.9141 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.238, mb=0.493, no=0.997, corr=-0.422) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.1876 -> 53.9141
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.1623 mb_mean=0.4992 norm_overlap=0.9952 corr_cb=-0.4702 topkJ=0.0083
[TRAIN][ep=007] loss=0.9734 acc=63.22%
[TRAIN][ep=007] mask_avg: mc_mean=0.1856 mb_mean=0.4928 norm_overlap=0.9953 corr_cb=-0.4291
[EPOCH 007/089] train: loss=0.9734 acc=63.22% | val: loss=0.6940 acc=53.01% f1=59.79% auc=53.31% val_score=41.5216 val_score_bestthr=41.5216 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.186, mb=0.493, no=0.995, corr=-0.429) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.1876 -> 41.5216
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1673 mb_mean=0.4901 norm_overlap=0.9952 corr_cb=-0.4270 topkJ=0.0129
[TRAIN][ep=008] loss=0.9153 acc=65.91%
[TRAIN][ep=008] mask_avg: mc_mean=0.1478 mb_mean=0.4928 norm_overlap=0.9933 corr_cb=-0.4429
[EPOCH 008/089] train: loss=0.9153 acc=65.91% | val: loss=0.6951 acc=51.81% f1=60.78% auc=53.08% val_score=42.2595 val_score_bestthr=42.2595 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.148, mb=0.493, no=0.993, corr=-0.443) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.1876 -> 42.2595
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1138 mb_mean=0.4926 norm_overlap=0.9920 corr_cb=-0.4034 topkJ=0.0148
[TRAIN][ep=009] loss=0.9198 acc=62.95%
[TRAIN][ep=009] mask_avg: mc_mean=0.1237 mb_mean=0.4928 norm_overlap=0.9916 corr_cb=-0.4442
[EPOCH 009/089] train: loss=0.9198 acc=62.95% | val: loss=0.6969 acc=53.01% f1=60.61% auc=53.43% val_score=40.0768 val_score_bestthr=40.0768 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.124, mb=0.493, no=0.992, corr=-0.444) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.1876 -> 40.0768
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.0972 mb_mean=0.4963 norm_overlap=0.9911 corr_cb=-0.4772 topkJ=0.0031
[TRAIN][ep=010] loss=0.9182 acc=63.49%
[TRAIN][ep=010] mask_avg: mc_mean=0.1076 mb_mean=0.4928 norm_overlap=0.9903 corr_cb=-0.4335
[EPOCH 010/089] train: loss=0.9182 acc=63.49% | val: loss=0.6983 acc=53.01% f1=64.22% auc=53.43% val_score=50.8559 val_score_bestthr=50.8559 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.108, mb=0.493, no=0.990, corr=-0.433) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.1876 -> 50.8559
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.0839 mb_mean=0.4924 norm_overlap=0.9904 corr_cb=-0.3753 topkJ=0.0087
[TRAIN][ep=011] loss=0.9039 acc=66.71%
[TRAIN][ep=011] mask_avg: mc_mean=0.1011 mb_mean=0.4928 norm_overlap=0.9894 corr_cb=-0.4324
[EPOCH 011/089] train: loss=0.9039 acc=66.71% | val: loss=0.7012 acc=53.01% f1=62.86% auc=53.43% val_score=44.5905 val_score_bestthr=44.5905 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.101, mb=0.493, no=0.989, corr=-0.432) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.1876 -> 44.5905
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.0879 mb_mean=0.4959 norm_overlap=0.9880 corr_cb=-0.4520 topkJ=0.0080
[TRAIN][ep=012] loss=0.8974 acc=68.19%
[TRAIN][ep=012] mask_avg: mc_mean=0.0921 mb_mean=0.4928 norm_overlap=0.9880 corr_cb=-0.4271
[EPOCH 012/089] train: loss=0.8974 acc=68.19% | val: loss=0.7035 acc=53.01% f1=61.39% auc=54.30% val_score=43.7545 val_score_bestthr=43.7545 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.092, mb=0.493, no=0.988, corr=-0.427) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.1876 -> 43.7545
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.0545 mb_mean=0.4973 norm_overlap=0.9845 corr_cb=-0.4029 topkJ=0.0027
[TRAIN][ep=013] loss=0.9157 acc=62.82%
[TRAIN][ep=013] mask_avg: mc_mean=0.0747 mb_mean=0.4928 norm_overlap=0.9863 corr_cb=-0.4035
[EPOCH 013/089] train: loss=0.9157 acc=62.82% | val: loss=0.7202 acc=50.60% f1=46.75% auc=54.19% val_score=30.3951 val_score_bestthr=30.3951 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.075, mb=0.493, no=0.986, corr=-0.403) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.1876 -> 30.3951
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.0583 mb_mean=0.4931 norm_overlap=0.9827 corr_cb=-0.4586 topkJ=0.0071
[TRAIN][ep=014] loss=0.8834 acc=69.40%
[TRAIN][ep=014] mask_avg: mc_mean=0.0722 mb_mean=0.4928 norm_overlap=0.9855 corr_cb=-0.4044
[EPOCH 014/089] train: loss=0.8834 acc=69.40% | val: loss=0.7318 acc=51.81% f1=47.37% auc=53.95% val_score=31.4922 val_score_bestthr=31.4922 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.072, mb=0.493, no=0.985, corr=-0.404) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.1876 -> 31.4922
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.0961 mb_mean=0.4915 norm_overlap=0.9902 corr_cb=-0.3816 topkJ=0.0130
[TRAIN][ep=015] loss=0.8842 acc=66.98%
[TRAIN][ep=015] mask_avg: mc_mean=0.0684 mb_mean=0.4928 norm_overlap=0.9844 corr_cb=-0.3954
[EPOCH 015/089] train: loss=0.8842 acc=66.98% | val: loss=0.7178 acc=56.63% f1=67.86% auc=52.85% val_score=53.8670 val_score_bestthr=53.8670 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.068, mb=0.493, no=0.984, corr=-0.395) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.1876 -> 53.8670
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.0718 mb_mean=0.4960 norm_overlap=0.9808 corr_cb=-0.4423 topkJ=0.0008
[TRAIN][ep=016] loss=0.8759 acc=66.98%
[TRAIN][ep=016] mask_avg: mc_mean=0.0756 mb_mean=0.4928 norm_overlap=0.9844 corr_cb=-0.4109
[EPOCH 016/089] train: loss=0.8759 acc=66.98% | val: loss=0.7083 acc=54.22% f1=61.22% auc=54.48% val_score=48.4796 val_score_bestthr=48.4796 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.076, mb=0.493, no=0.984, corr=-0.411) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.1876 -> 48.4796
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.0826 mb_mean=0.4935 norm_overlap=0.9837 corr_cb=-0.4580 topkJ=0.0056
[TRAIN][ep=017] loss=0.8757 acc=68.05%
[TRAIN][ep=017] mask_avg: mc_mean=0.0807 mb_mean=0.4928 norm_overlap=0.9842 corr_cb=-0.4155
[EPOCH 017/089] train: loss=0.8757 acc=68.05% | val: loss=0.7149 acc=53.01% f1=62.86% auc=53.84% val_score=47.3350 val_score_bestthr=47.3350 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.081, mb=0.493, no=0.984, corr=-0.416) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.1876 -> 47.3350
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.0704 mb_mean=0.4913 norm_overlap=0.9876 corr_cb=-0.3283 topkJ=0.0103
[TRAIN][ep=018] loss=0.8617 acc=70.87%
[TRAIN][ep=018] mask_avg: mc_mean=0.0705 mb_mean=0.4928 norm_overlap=0.9830 corr_cb=-0.4013
[EPOCH 018/089] train: loss=0.8617 acc=70.87% | val: loss=0.7162 acc=54.22% f1=63.46% auc=54.36% val_score=49.0527 val_score_bestthr=49.0527 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.071, mb=0.493, no=0.983, corr=-0.401) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.1876 -> 49.0527
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.0896 mb_mean=0.4941 norm_overlap=0.9878 corr_cb=-0.3589 topkJ=0.0117
[TRAIN][ep=019] loss=0.8635 acc=69.53%
[TRAIN][ep=019] mask_avg: mc_mean=0.0723 mb_mean=0.4928 norm_overlap=0.9826 corr_cb=-0.4042
[EPOCH 019/089] train: loss=0.8635 acc=69.53% | val: loss=0.7180 acc=56.63% f1=64.71% auc=54.48% val_score=50.6378 val_score_bestthr=50.6378 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.072, mb=0.493, no=0.983, corr=-0.404) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.1876 -> 50.6378
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.0926 mb_mean=0.4898 norm_overlap=0.9865 corr_cb=-0.3770 topkJ=0.0035
[TRAIN][ep=020] loss=0.8571 acc=70.07%
[TRAIN][ep=020] mask_avg: mc_mean=0.0832 mb_mean=0.4928 norm_overlap=0.9828 corr_cb=-0.4204
[EPOCH 020/089] train: loss=0.8571 acc=70.07% | val: loss=0.7254 acc=59.04% f1=61.36% auc=55.81% val_score=49.0862 val_score_bestthr=49.0862 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.083, mb=0.493, no=0.983, corr=-0.420) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.1876 -> 49.0862
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.0861 mb_mean=0.4926 norm_overlap=0.9862 corr_cb=-0.4391 topkJ=0.0040
[TRAIN][ep=021] loss=0.8457 acc=68.46%
[TRAIN][ep=021] mask_avg: mc_mean=0.0982 mb_mean=0.4928 norm_overlap=0.9835 corr_cb=-0.4351
[EPOCH 021/089] train: loss=0.8457 acc=68.46% | val: loss=0.7389 acc=48.19% f1=42.67% auc=55.17% val_score=37.0075 val_score_bestthr=37.0075 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.098, mb=0.493, no=0.984, corr=-0.435) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.1876 -> 37.0075
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1023 mb_mean=0.4906 norm_overlap=0.9834 corr_cb=-0.4314 topkJ=0.0004
[TRAIN][ep=022] loss=0.8477 acc=70.47%
[TRAIN][ep=022] mask_avg: mc_mean=0.0808 mb_mean=0.4928 norm_overlap=0.9822 corr_cb=-0.4123
[EPOCH 022/089] train: loss=0.8477 acc=70.47% | val: loss=0.7159 acc=55.42% f1=64.08% auc=55.76% val_score=50.1500 val_score_bestthr=50.1500 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.081, mb=0.493, no=0.982, corr=-0.412) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.1876 -> 50.1500
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.0770 mb_mean=0.4932 norm_overlap=0.9753 corr_cb=-0.4678 topkJ=0.0015
[TRAIN][ep=023] loss=0.8377 acc=70.87%
[TRAIN][ep=023] mask_avg: mc_mean=0.0791 mb_mean=0.4928 norm_overlap=0.9820 corr_cb=-0.4065
[EPOCH 023/089] train: loss=0.8377 acc=70.87% | val: loss=0.7181 acc=55.42% f1=61.05% auc=55.17% val_score=52.6697 val_score_bestthr=52.6697 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.079, mb=0.493, no=0.982, corr=-0.406) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.1876 -> 52.6697
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.0812 mb_mean=0.4927 norm_overlap=0.9832 corr_cb=-0.4390 topkJ=0.0016
[TRAIN][ep=024] loss=0.8329 acc=73.83%
[TRAIN][ep=024] mask_avg: mc_mean=0.0944 mb_mean=0.4928 norm_overlap=0.9828 corr_cb=-0.4248
[EPOCH 024/089] train: loss=0.8329 acc=73.83% | val: loss=0.7156 acc=54.22% f1=63.46% auc=56.40% val_score=49.0527 val_score_bestthr=49.0527 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.094, mb=0.493, no=0.983, corr=-0.425) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.1876 -> 49.0527
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.0626 mb_mean=0.4924 norm_overlap=0.9834 corr_cb=-0.3824 topkJ=0.0063
[TRAIN][ep=025] loss=0.8293 acc=70.34%
[TRAIN][ep=025] mask_avg: mc_mean=0.0808 mb_mean=0.4928 norm_overlap=0.9817 corr_cb=-0.4026
[EPOCH 025/089] train: loss=0.8293 acc=70.34% | val: loss=0.7357 acc=55.42% f1=65.42% auc=56.05% val_score=58.8931 val_score_bestthr=58.8931 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.081, mb=0.493, no=0.982, corr=-0.403) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.1876 -> 58.8931
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.0907 mb_mean=0.4922 norm_overlap=0.9884 corr_cb=-0.3331 topkJ=0.0057
[TRAIN][ep=026] loss=0.8263 acc=72.48%
[TRAIN][ep=026] mask_avg: mc_mean=0.0978 mb_mean=0.4928 norm_overlap=0.9827 corr_cb=-0.4196
[EPOCH 026/089] train: loss=0.8263 acc=72.48% | val: loss=0.7240 acc=54.22% f1=55.81% auc=55.81% val_score=44.6594 val_score_bestthr=44.6594 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.098, mb=0.493, no=0.983, corr=-0.420) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.1876 -> 44.6594
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1188 mb_mean=0.4908 norm_overlap=0.9847 corr_cb=-0.3924 topkJ=0.0016
[TRAIN][ep=027] loss=0.8156 acc=73.69%
[TRAIN][ep=027] mask_avg: mc_mean=0.0905 mb_mean=0.4928 norm_overlap=0.9821 corr_cb=-0.4086
[EPOCH 027/089] train: loss=0.8156 acc=73.69% | val: loss=0.7242 acc=55.42% f1=57.47% auc=56.16% val_score=49.5967 val_score_bestthr=49.5967 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.090, mb=0.493, no=0.982, corr=-0.409) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.1876 -> 49.5967
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.0735 mb_mean=0.4955 norm_overlap=0.9786 corr_cb=-0.4343 topkJ=0.0032
[TRAIN][ep=028] loss=0.8147 acc=71.81%
[TRAIN][ep=028] mask_avg: mc_mean=0.0833 mb_mean=0.4928 norm_overlap=0.9815 corr_cb=-0.3949
[EPOCH 028/089] train: loss=0.8147 acc=71.81% | val: loss=0.7290 acc=54.22% f1=60.42% auc=55.41% val_score=56.0355 val_score_bestthr=56.0355 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.083, mb=0.493, no=0.982, corr=-0.395) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.1876 -> 56.0355
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.0670 mb_mean=0.4953 norm_overlap=0.9771 corr_cb=-0.4405 topkJ=0.0012
[TRAIN][ep=029] loss=0.7976 acc=75.03%
[TRAIN][ep=029] mask_avg: mc_mean=0.1042 mb_mean=0.4928 norm_overlap=0.9827 corr_cb=-0.4211
[EPOCH 029/089] train: loss=0.7976 acc=75.03% | val: loss=0.7300 acc=50.60% f1=55.91% auc=55.58% val_score=46.9059 val_score_bestthr=46.9059 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.104, mb=0.493, no=0.983, corr=-0.421) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.1876 -> 46.9059
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.0679 mb_mean=0.4980 norm_overlap=0.9669 corr_cb=-0.5332 topkJ=0.0004
[TRAIN][ep=030] loss=0.8045 acc=71.41%
[TRAIN][ep=030] mask_avg: mc_mean=0.0907 mb_mean=0.4928 norm_overlap=0.9818 corr_cb=-0.4016
[EPOCH 030/089] train: loss=0.8045 acc=71.41% | val: loss=0.7257 acc=54.22% f1=64.15% auc=55.99% val_score=55.2905 val_score_bestthr=55.2905 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.091, mb=0.493, no=0.982, corr=-0.402) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.1876 -> 55.2905
[EARLY STOP] no improvement for 30 epochs. best_epoch=0
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
=============== FIT DONE ===============
[BEST] epoch=0 | val_acc=54.22% | val_f1=69.35% | val_auc=51.86% | val_score=62.1876 | val_score_bestthr=62.1876
[TEST@BEST] thr_used=0.450 | acc=50.72% f1=67.10% auc=60.23% | SP_sex=1.67% EO_sex=2.20% SP_age=2.13% EO_age=3.45%
[TIME] 0.71 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/summary_fold_1.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4925 mb_mean=0.4923 norm_overlap=1.0000 corr_cb=-0.0375 topkJ=0.0351
[TRAIN][ep=000] loss=0.6931 acc=51.01%
[TRAIN][ep=000] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0408
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4947 mb_mean=0.4925 norm_overlap=1.0000 corr_cb=0.0200 topkJ=0.0582
[TRAIN][ep=001] loss=0.6908 acc=53.02%
[TRAIN][ep=001] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0417
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4934 mb_mean=0.4912 norm_overlap=1.0000 corr_cb=-0.0761 topkJ=0.0212
[TRAIN][ep=002] loss=0.6911 acc=49.66%
[TRAIN][ep=002] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0335
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4946 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=0.0005 topkJ=0.0158
[TRAIN][ep=003] loss=0.6896 acc=55.97%
[TRAIN][ep=003] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0421
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4921 mb_mean=0.4935 norm_overlap=1.0000 corr_cb=0.0308 topkJ=0.0456
[TRAIN][ep=004] loss=0.6890 acc=56.78%
[TRAIN][ep=004] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0492
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4956 mb_mean=0.4905 norm_overlap=1.0000 corr_cb=-0.0217 topkJ=0.0255
[TRAIN][ep=005] loss=0.6854 acc=57.72%
[TRAIN][ep=005] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0414
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4955 mb_mean=0.4935 norm_overlap=1.0001 corr_cb=0.1792 topkJ=0.2987
[TRAIN][ep=006] loss=0.6823 acc=57.99%
[TRAIN][ep=006] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0439
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4934 mb_mean=0.4926 norm_overlap=1.0000 corr_cb=0.0730 topkJ=0.0188
[TRAIN][ep=007] loss=0.6802 acc=62.28%
[TRAIN][ep=007] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0419
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4941 mb_mean=0.4951 norm_overlap=1.0000 corr_cb=-0.0577 topkJ=0.0403
[TRAIN][ep=008] loss=0.6804 acc=57.32%
[TRAIN][ep=008] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0461
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4928 mb_mean=0.4945 norm_overlap=1.0001 corr_cb=0.2081 topkJ=0.0622
[TRAIN][ep=009] loss=0.6765 acc=61.21%
[TRAIN][ep=009] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0400
================= FIT START (fold=1) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4924 mb_mean=0.4908 norm_overlap=1.0000 corr_cb=-0.0313 topkJ=0.0382
[TRAIN][ep=000] loss=0.6711 acc=62.01%
[TRAIN][ep=000] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0416
[EPOCH 000/089] train: loss=0.6711 acc=62.01% | val: loss=0.6902 acc=57.83% f1=69.57% auc=53.02% val_score=42.9101 val_score_bestthr=56.8424 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.042) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 56.8424
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4945 mb_mean=0.4932 norm_overlap=1.0000 corr_cb=0.0532 topkJ=0.0351
[TRAIN][ep=001] loss=0.6648 acc=61.34%
[TRAIN][ep=001] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0445
[EPOCH 001/089] train: loss=0.6648 acc=61.34% | val: loss=0.6900 acc=55.42% f1=69.92% auc=52.09% val_score=43.0198 val_score_bestthr=62.6871 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.045) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 56.8424 -> 62.6871
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4957 mb_mean=0.4963 norm_overlap=1.0000 corr_cb=-0.0615 topkJ=0.0282
[TRAIN][ep=002] loss=0.6544 acc=65.23%
[TRAIN][ep=002] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0447
[EPOCH 002/089] train: loss=0.6544 acc=65.23% | val: loss=0.6914 acc=56.63% f1=69.49% auc=53.20% val_score=44.9705 val_score_bestthr=59.2265 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.045) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6871 -> 59.2265
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4968 mb_mean=0.4929 norm_overlap=0.9999 corr_cb=-0.1262 topkJ=0.0038
[TRAIN][ep=003] loss=0.6482 acc=64.30%
[TRAIN][ep=003] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0468
[EPOCH 003/089] train: loss=0.6482 acc=64.30% | val: loss=0.6942 acc=56.63% f1=68.97% auc=53.43% val_score=47.0193 val_score_bestthr=57.0488 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.047) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6871 -> 57.0488
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4915 mb_mean=0.4920 norm_overlap=1.0000 corr_cb=-0.0843 topkJ=0.0088
[TRAIN][ep=004] loss=0.6429 acc=63.36%
[TRAIN][ep=004] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0455
[EPOCH 004/089] train: loss=0.6429 acc=63.36% | val: loss=0.7003 acc=57.83% f1=68.47% auc=53.43% val_score=37.0298 val_score_bestthr=59.5284 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.046) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6871 -> 59.5284
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4942 mb_mean=0.4946 norm_overlap=0.9999 corr_cb=-0.1495 topkJ=0.0119
[TRAIN][ep=005] loss=1.3454 acc=64.03%
[TRAIN][ep=005] mask_avg: mc_mean=0.3711 mb_mean=0.4928 norm_overlap=0.9988 corr_cb=-0.3599
[EPOCH 005/089] train: loss=1.3454 acc=64.03% | val: loss=0.6942 acc=56.63% f1=70.49% auc=54.30% val_score=35.8021 val_score_bestthr=61.6282 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.371, mb=0.493, no=0.999, corr=-0.360) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6871 -> 61.6282
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2620 mb_mean=0.4960 norm_overlap=0.9957 corr_cb=-0.4899 topkJ=0.0031
[TRAIN][ep=006] loss=1.3275 acc=64.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.2314 mb_mean=0.4928 norm_overlap=0.9967 corr_cb=-0.4157
[EPOCH 006/089] train: loss=1.3275 acc=64.70% | val: loss=0.6938 acc=56.63% f1=70.00% auc=54.30% val_score=32.6091 val_score_bestthr=60.1401 | dyn(w_pfs=0.240, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.231, mb=0.493, no=0.997, corr=-0.416) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6871 -> 60.1401
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.1526 mb_mean=0.4992 norm_overlap=0.9951 corr_cb=-0.4570 topkJ=0.0110
[TRAIN][ep=007] loss=1.1419 acc=65.10%
[TRAIN][ep=007] mask_avg: mc_mean=0.1752 mb_mean=0.4928 norm_overlap=0.9952 corr_cb=-0.4154
[EPOCH 007/089] train: loss=1.1419 acc=65.10% | val: loss=0.7129 acc=56.63% f1=69.49% auc=53.72% val_score=38.5081 val_score_bestthr=58.9833 | dyn(w_pfs=0.140, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.175, mb=0.493, no=0.995, corr=-0.415) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6871 -> 58.9833
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1560 mb_mean=0.4901 norm_overlap=0.9953 corr_cb=-0.4104 topkJ=0.0141
[TRAIN][ep=008] loss=0.9405 acc=66.04%
[TRAIN][ep=008] mask_avg: mc_mean=0.1372 mb_mean=0.4928 norm_overlap=0.9935 corr_cb=-0.4290
[EPOCH 008/089] train: loss=0.9405 acc=66.04% | val: loss=0.7033 acc=57.83% f1=71.07% auc=54.13% val_score=39.9031 val_score_bestthr=63.1205 | dyn(w_pfs=0.180, w_sup=0.090, w_csuf=0.040, stage2=False) | mask(mc=0.137, mb=0.493, no=0.993, corr=-0.429) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 62.6871 -> 63.1205
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1011 mb_mean=0.4926 norm_overlap=0.9922 corr_cb=-0.3894 topkJ=0.0202
[TRAIN][ep=009] loss=1.0252 acc=63.62%
[TRAIN][ep=009] mask_avg: mc_mean=0.1050 mb_mean=0.4928 norm_overlap=0.9916 corr_cb=-0.4235
[EPOCH 009/089] train: loss=1.0252 acc=63.62% | val: loss=0.7078 acc=57.83% f1=66.02% auc=54.30% val_score=39.3150 val_score_bestthr=61.3809 | dyn(w_pfs=0.220, w_sup=0.130, w_csuf=0.080, stage2=False) | mask(mc=0.105, mb=0.493, no=0.992, corr=-0.424) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.1205 -> 61.3809
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.0766 mb_mean=0.4963 norm_overlap=0.9911 corr_cb=-0.4575 topkJ=0.0035
[TRAIN][ep=010] loss=1.0921 acc=65.64%
[TRAIN][ep=010] mask_avg: mc_mean=0.0818 mb_mean=0.4928 norm_overlap=0.9902 corr_cb=-0.4024
[EPOCH 010/089] train: loss=1.0921 acc=65.64% | val: loss=0.7019 acc=57.83% f1=70.59% auc=54.48% val_score=49.1388 val_score_bestthr=59.6647 | dyn(w_pfs=0.260, w_sup=0.170, w_csuf=0.120, stage2=False) | mask(mc=0.082, mb=0.493, no=0.990, corr=-0.402) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.1205 -> 59.6647
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.0583 mb_mean=0.4924 norm_overlap=0.9906 corr_cb=-0.3304 topkJ=0.0124
[TRAIN][ep=011] loss=1.1498 acc=66.85%
[TRAIN][ep=011] mask_avg: mc_mean=0.0674 mb_mean=0.4928 norm_overlap=0.9886 corr_cb=-0.3939
[EPOCH 011/089] train: loss=1.1498 acc=66.85% | val: loss=0.7016 acc=59.04% f1=70.69% auc=54.59% val_score=41.4230 val_score_bestthr=61.0958 | dyn(w_pfs=0.060, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.067, mb=0.493, no=0.989, corr=-0.394) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.1205 -> 61.0958
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.0559 mb_mean=0.4959 norm_overlap=0.9859 corr_cb=-0.4214 topkJ=0.0104
[TRAIN][ep=012] loss=0.8967 acc=69.80%
[TRAIN][ep=012] mask_avg: mc_mean=0.0612 mb_mean=0.4928 norm_overlap=0.9870 corr_cb=-0.3955
[EPOCH 012/089] train: loss=0.8967 acc=69.80% | val: loss=0.7058 acc=59.04% f1=70.69% auc=55.17% val_score=44.6594 val_score_bestthr=61.0958 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.061, mb=0.493, no=0.987, corr=-0.395) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.1205 -> 61.0958
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.0332 mb_mean=0.4973 norm_overlap=0.9830 corr_cb=-0.3852 topkJ=0.0016
[TRAIN][ep=013] loss=0.8926 acc=66.31%
[TRAIN][ep=013] mask_avg: mc_mean=0.0540 mb_mean=0.4928 norm_overlap=0.9854 corr_cb=-0.3847
[EPOCH 013/089] train: loss=0.8926 acc=66.31% | val: loss=0.7044 acc=60.24% f1=67.33% auc=55.58% val_score=42.0277 val_score_bestthr=65.0202 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.054, mb=0.493, no=0.985, corr=-0.385) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 63.1205 -> 65.0202
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.0432 mb_mean=0.4931 norm_overlap=0.9816 corr_cb=-0.4472 topkJ=0.0079
[TRAIN][ep=014] loss=0.8596 acc=70.47%
[TRAIN][ep=014] mask_avg: mc_mean=0.0544 mb_mean=0.4928 norm_overlap=0.9845 corr_cb=-0.3912
[EPOCH 014/089] train: loss=0.8596 acc=70.47% | val: loss=0.7287 acc=56.63% f1=70.49% auc=54.19% val_score=36.0552 val_score_bestthr=64.1779 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.054, mb=0.493, no=0.985, corr=-0.391) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.0202 -> 64.1779
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.0706 mb_mean=0.4915 norm_overlap=0.9896 corr_cb=-0.3699 topkJ=0.0122
[TRAIN][ep=015] loss=0.8631 acc=68.99%
[TRAIN][ep=015] mask_avg: mc_mean=0.0490 mb_mean=0.4928 norm_overlap=0.9828 corr_cb=-0.3769
[EPOCH 015/089] train: loss=0.8631 acc=68.99% | val: loss=0.7283 acc=61.45% f1=71.93% auc=54.24% val_score=47.3350 val_score_bestthr=65.6471 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.049, mb=0.493, no=0.983, corr=-0.377) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 65.0202 -> 65.6471
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.0520 mb_mean=0.4960 norm_overlap=0.9780 corr_cb=-0.4318 topkJ=0.0008
[TRAIN][ep=016] loss=0.8502 acc=70.07%
[TRAIN][ep=016] mask_avg: mc_mean=0.0605 mb_mean=0.4928 norm_overlap=0.9831 corr_cb=-0.4065
[EPOCH 016/089] train: loss=0.8502 acc=70.07% | val: loss=0.7149 acc=60.24% f1=71.79% auc=55.29% val_score=38.0694 val_score_bestthr=62.2198 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.061, mb=0.493, no=0.983, corr=-0.407) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6471 -> 62.2198
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.0653 mb_mean=0.4935 norm_overlap=0.9815 corr_cb=-0.4651 topkJ=0.0048
[TRAIN][ep=017] loss=0.8495 acc=69.53%
[TRAIN][ep=017] mask_avg: mc_mean=0.0619 mb_mean=0.4928 norm_overlap=0.9825 corr_cb=-0.4042
[EPOCH 017/089] train: loss=0.8495 acc=69.53% | val: loss=0.7297 acc=60.24% f1=71.79% auc=54.36% val_score=53.4880 val_score_bestthr=62.4506 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.062, mb=0.493, no=0.983, corr=-0.404) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6471 -> 62.4506
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.0536 mb_mean=0.4913 norm_overlap=0.9865 corr_cb=-0.3145 topkJ=0.0099
[TRAIN][ep=018] loss=0.8352 acc=71.81%
[TRAIN][ep=018] mask_avg: mc_mean=0.0562 mb_mean=0.4928 norm_overlap=0.9815 corr_cb=-0.3946
[EPOCH 018/089] train: loss=0.8352 acc=71.81% | val: loss=0.7180 acc=61.45% f1=71.93% auc=55.29% val_score=46.9059 val_score_bestthr=65.6471 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.056, mb=0.493, no=0.982, corr=-0.395) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6471 -> 65.6471
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.0789 mb_mean=0.4941 norm_overlap=0.9870 corr_cb=-0.3619 topkJ=0.0112
[TRAIN][ep=019] loss=0.8385 acc=70.60%
[TRAIN][ep=019] mask_avg: mc_mean=0.0667 mb_mean=0.4928 norm_overlap=0.9816 corr_cb=-0.4159
[EPOCH 019/089] train: loss=0.8385 acc=70.60% | val: loss=0.7317 acc=61.45% f1=71.93% auc=54.94% val_score=47.3763 val_score_bestthr=65.6471 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.067, mb=0.493, no=0.982, corr=-0.416) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6471 -> 65.6471
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.0926 mb_mean=0.4898 norm_overlap=0.9865 corr_cb=-0.3890 topkJ=0.0051
[TRAIN][ep=020] loss=0.8290 acc=73.15%
[TRAIN][ep=020] mask_avg: mc_mean=0.0763 mb_mean=0.4928 norm_overlap=0.9818 corr_cb=-0.4324
[EPOCH 020/089] train: loss=0.8290 acc=73.15% | val: loss=0.7470 acc=59.04% f1=70.69% auc=56.80% val_score=38.0330 val_score_bestthr=61.0958 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.076, mb=0.493, no=0.982, corr=-0.432) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6471 -> 61.0958
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.0722 mb_mean=0.4926 norm_overlap=0.9847 corr_cb=-0.4509 topkJ=0.0028
[TRAIN][ep=021] loss=0.8158 acc=72.08%
[TRAIN][ep=021] mask_avg: mc_mean=0.0863 mb_mean=0.4928 norm_overlap=0.9822 corr_cb=-0.4413
[EPOCH 021/089] train: loss=0.8158 acc=72.08% | val: loss=0.7888 acc=60.24% f1=71.30% auc=56.80% val_score=43.2431 val_score_bestthr=62.5929 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.086, mb=0.493, no=0.982, corr=-0.441) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6471 -> 62.5929
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.0986 mb_mean=0.4906 norm_overlap=0.9830 corr_cb=-0.4307 topkJ=0.0024
[TRAIN][ep=022] loss=0.8202 acc=71.41%
[TRAIN][ep=022] mask_avg: mc_mean=0.0787 mb_mean=0.4928 norm_overlap=0.9815 corr_cb=-0.4302
[EPOCH 022/089] train: loss=0.8202 acc=71.41% | val: loss=0.7303 acc=60.24% f1=71.30% auc=55.58% val_score=48.6157 val_score_bestthr=63.2773 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.079, mb=0.493, no=0.981, corr=-0.430) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6471 -> 63.2773
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.0712 mb_mean=0.4932 norm_overlap=0.9738 corr_cb=-0.4878 topkJ=0.0023
[TRAIN][ep=023] loss=0.8066 acc=72.21%
[TRAIN][ep=023] mask_avg: mc_mean=0.0808 mb_mean=0.4928 norm_overlap=0.9816 corr_cb=-0.4281
[EPOCH 023/089] train: loss=0.8066 acc=72.21% | val: loss=0.7229 acc=61.45% f1=71.93% auc=55.29% val_score=44.6594 val_score_bestthr=65.6471 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.081, mb=0.493, no=0.982, corr=-0.428) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6471 -> 65.6471
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.0812 mb_mean=0.4927 norm_overlap=0.9825 corr_cb=-0.4653 topkJ=0.0020
[TRAIN][ep=024] loss=0.7971 acc=73.69%
[TRAIN][ep=024] mask_avg: mc_mean=0.0996 mb_mean=0.4928 norm_overlap=0.9827 corr_cb=-0.4457
[EPOCH 024/089] train: loss=0.7971 acc=73.69% | val: loss=0.7139 acc=62.65% f1=73.04% auc=57.38% val_score=50.2239 val_score_bestthr=66.3367 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.100, mb=0.493, no=0.983, corr=-0.446) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 65.6471 -> 66.3367
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.0554 mb_mean=0.4924 norm_overlap=0.9827 corr_cb=-0.3782 topkJ=0.0051
[TRAIN][ep=025] loss=0.8663 acc=72.75%
[TRAIN][ep=025] mask_avg: mc_mean=0.0834 mb_mean=0.4928 norm_overlap=0.9814 corr_cb=-0.4203
[EPOCH 025/089] train: loss=0.8663 acc=72.75% | val: loss=0.7337 acc=61.45% f1=72.41% auc=56.98% val_score=48.5270 val_score_bestthr=63.7174 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.083, mb=0.493, no=0.981, corr=-0.420) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 63.7174
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.0940 mb_mean=0.4922 norm_overlap=0.9880 corr_cb=-0.3572 topkJ=0.0073
[TRAIN][ep=026] loss=0.9296 acc=74.23%
[TRAIN][ep=026] mask_avg: mc_mean=0.1108 mb_mean=0.4928 norm_overlap=0.9830 corr_cb=-0.4463
[EPOCH 026/089] train: loss=0.9296 acc=74.23% | val: loss=0.7590 acc=61.45% f1=71.93% auc=58.14% val_score=39.5193 val_score_bestthr=65.6471 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.111, mb=0.493, no=0.983, corr=-0.446) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 65.6471
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1399 mb_mean=0.4908 norm_overlap=0.9855 corr_cb=-0.4013 topkJ=0.0028
[TRAIN][ep=027] loss=0.9856 acc=75.57%
[TRAIN][ep=027] mask_avg: mc_mean=0.1054 mb_mean=0.4928 norm_overlap=0.9826 corr_cb=-0.4336
[EPOCH 027/089] train: loss=0.9856 acc=75.57% | val: loss=0.7385 acc=62.65% f1=73.04% auc=58.43% val_score=40.7238 val_score_bestthr=66.3367 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.105, mb=0.493, no=0.983, corr=-0.434) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 66.3367
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.0651 mb_mean=0.4955 norm_overlap=0.9776 corr_cb=-0.4170 topkJ=0.0032
[TRAIN][ep=028] loss=1.0591 acc=74.50%
[TRAIN][ep=028] mask_avg: mc_mean=0.0853 mb_mean=0.4928 norm_overlap=0.9811 corr_cb=-0.4055
[EPOCH 028/089] train: loss=1.0591 acc=74.50% | val: loss=0.7406 acc=60.24% f1=71.30% auc=57.56% val_score=41.0014 val_score_bestthr=63.2773 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.085, mb=0.493, no=0.981, corr=-0.405) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 63.2773
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.0814 mb_mean=0.4953 norm_overlap=0.9780 corr_cb=-0.5121 topkJ=0.0004
[TRAIN][ep=029] loss=1.1054 acc=76.51%
[TRAIN][ep=029] mask_avg: mc_mean=0.1227 mb_mean=0.4928 norm_overlap=0.9833 corr_cb=-0.4457
[EPOCH 029/089] train: loss=1.1054 acc=76.51% | val: loss=0.7403 acc=61.45% f1=71.93% auc=56.92% val_score=41.5181 val_score_bestthr=65.6471 | dyn(w_pfs=0.100, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.123, mb=0.493, no=0.983, corr=-0.446) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 65.6471
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.0671 mb_mean=0.4980 norm_overlap=0.9656 corr_cb=-0.5349 topkJ=0.0004
[TRAIN][ep=030] loss=0.9316 acc=74.23%
[TRAIN][ep=030] mask_avg: mc_mean=0.1003 mb_mean=0.4928 norm_overlap=0.9818 corr_cb=-0.4201
[EPOCH 030/089] train: loss=0.9316 acc=74.23% | val: loss=0.7383 acc=61.45% f1=71.93% auc=57.03% val_score=48.7783 val_score_bestthr=65.6471 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.100, mb=0.493, no=0.982, corr=-0.420) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 65.6471
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.1052 mb_mean=0.4927 norm_overlap=0.9776 corr_cb=-0.5140 topkJ=0.0020
[TRAIN][ep=031] loss=0.7668 acc=73.15%
[TRAIN][ep=031] mask_avg: mc_mean=0.0982 mb_mean=0.4928 norm_overlap=0.9817 corr_cb=-0.4179
[EPOCH 031/089] train: loss=0.7668 acc=73.15% | val: loss=0.7709 acc=60.24% f1=70.80% auc=58.78% val_score=42.8562 val_score_bestthr=61.4456 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.098, mb=0.493, no=0.982, corr=-0.418) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 61.4456
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1235 mb_mean=0.4887 norm_overlap=0.9885 corr_cb=-0.2746 topkJ=0.0225
[TRAIN][ep=032] loss=0.7464 acc=75.97%
[TRAIN][ep=032] mask_avg: mc_mean=0.1099 mb_mean=0.4928 norm_overlap=0.9826 corr_cb=-0.4245
[EPOCH 032/089] train: loss=0.7464 acc=75.97% | val: loss=0.7443 acc=60.24% f1=70.80% auc=58.55% val_score=49.2267 val_score_bestthr=61.4456 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.110, mb=0.493, no=0.983, corr=-0.424) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 61.4456
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1174 mb_mean=0.4927 norm_overlap=0.9793 corr_cb=-0.4473 topkJ=0.0039
[TRAIN][ep=033] loss=0.7309 acc=76.64%
[TRAIN][ep=033] mask_avg: mc_mean=0.1135 mb_mean=0.4928 norm_overlap=0.9826 corr_cb=-0.4272
[EPOCH 033/089] train: loss=0.7309 acc=76.64% | val: loss=0.7517 acc=60.24% f1=70.80% auc=58.02% val_score=44.0570 val_score_bestthr=61.4456 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.113, mb=0.493, no=0.983, corr=-0.427) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 61.4456
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1167 mb_mean=0.4908 norm_overlap=0.9869 corr_cb=-0.3540 topkJ=0.0139
[TRAIN][ep=034] loss=0.7225 acc=77.72%
[TRAIN][ep=034] mask_avg: mc_mean=0.1263 mb_mean=0.4928 norm_overlap=0.9835 corr_cb=-0.4312
[EPOCH 034/089] train: loss=0.7225 acc=77.72% | val: loss=0.7772 acc=61.45% f1=70.91% auc=58.31% val_score=50.0950 val_score_bestthr=61.8877 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.126, mb=0.493, no=0.983, corr=-0.431) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 61.8877
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.1344 mb_mean=0.4924 norm_overlap=0.9873 corr_cb=-0.4240 topkJ=0.0048
[TRAIN][ep=035] loss=0.7355 acc=77.18%
[TRAIN][ep=035] mask_avg: mc_mean=0.1133 mb_mean=0.4928 norm_overlap=0.9825 corr_cb=-0.4180
[EPOCH 035/089] train: loss=0.7355 acc=77.18% | val: loss=0.7800 acc=61.45% f1=71.43% auc=57.79% val_score=56.0375 val_score_bestthr=62.5452 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.113, mb=0.493, no=0.983, corr=-0.418) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 62.5452
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.1202 mb_mean=0.4918 norm_overlap=0.9870 corr_cb=-0.3181 topkJ=0.0032
[TRAIN][ep=036] loss=0.7248 acc=76.64%
[TRAIN][ep=036] mask_avg: mc_mean=0.1294 mb_mean=0.4928 norm_overlap=0.9834 corr_cb=-0.4284
[EPOCH 036/089] train: loss=0.7248 acc=76.64% | val: loss=0.7647 acc=60.24% f1=70.80% auc=58.72% val_score=43.0168 val_score_bestthr=61.4456 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.129, mb=0.493, no=0.983, corr=-0.428) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 61.4456
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1361 mb_mean=0.4913 norm_overlap=0.9783 corr_cb=-0.4722 topkJ=0.0000
[TRAIN][ep=037] loss=0.7213 acc=77.58%
[TRAIN][ep=037] mask_avg: mc_mean=0.1304 mb_mean=0.4928 norm_overlap=0.9835 corr_cb=-0.4277
[EPOCH 037/089] train: loss=0.7213 acc=77.58% | val: loss=0.8165 acc=56.63% f1=70.00% auc=59.42% val_score=44.4953 val_score_bestthr=62.1241 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.130, mb=0.493, no=0.983, corr=-0.428) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 62.1241
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.1449 mb_mean=0.4918 norm_overlap=0.9843 corr_cb=-0.4129 topkJ=0.0044
[TRAIN][ep=038] loss=0.7036 acc=77.99%
[TRAIN][ep=038] mask_avg: mc_mean=0.1228 mb_mean=0.4928 norm_overlap=0.9832 corr_cb=-0.4174
[EPOCH 038/089] train: loss=0.7036 acc=77.99% | val: loss=0.7692 acc=60.24% f1=69.16% auc=59.13% val_score=43.6154 val_score_bestthr=60.8074 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.123, mb=0.493, no=0.983, corr=-0.417) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 60.8074
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.1422 mb_mean=0.4933 norm_overlap=0.9767 corr_cb=-0.5317 topkJ=0.0000
[TRAIN][ep=039] loss=0.6968 acc=77.72%
[TRAIN][ep=039] mask_avg: mc_mean=0.1383 mb_mean=0.4928 norm_overlap=0.9838 corr_cb=-0.4281
[EPOCH 039/089] train: loss=0.6968 acc=77.72% | val: loss=0.8417 acc=57.83% f1=68.47% auc=59.88% val_score=48.7394 val_score_bestthr=61.4233 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.138, mb=0.493, no=0.984, corr=-0.428) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 61.4233
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.1349 mb_mean=0.4926 norm_overlap=0.9801 corr_cb=-0.4883 topkJ=0.0035
[TRAIN][ep=040] loss=0.6806 acc=80.54%
[TRAIN][ep=040] mask_avg: mc_mean=0.1423 mb_mean=0.4928 norm_overlap=0.9844 corr_cb=-0.4222
[EPOCH 040/089] train: loss=0.6806 acc=80.54% | val: loss=0.8177 acc=60.24% f1=69.72% auc=59.24% val_score=47.2272 val_score_bestthr=63.3103 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.142, mb=0.493, no=0.984, corr=-0.422) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 63.3103
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.1641 mb_mean=0.4934 norm_overlap=0.9876 corr_cb=-0.3841 topkJ=0.0024
[TRAIN][ep=041] loss=0.6677 acc=82.01%
[TRAIN][ep=041] mask_avg: mc_mean=0.1290 mb_mean=0.4928 norm_overlap=0.9834 corr_cb=-0.4158
[EPOCH 041/089] train: loss=0.6677 acc=82.01% | val: loss=0.8220 acc=56.63% f1=70.00% auc=60.17% val_score=50.6024 val_score_bestthr=62.1241 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.129, mb=0.493, no=0.983, corr=-0.416) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 62.1241
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.1961 mb_mean=0.4932 norm_overlap=0.9841 corr_cb=-0.5167 topkJ=0.0008
[TRAIN][ep=042] loss=0.6865 acc=79.33%
[TRAIN][ep=042] mask_avg: mc_mean=0.1268 mb_mean=0.4928 norm_overlap=0.9834 corr_cb=-0.4127
[EPOCH 042/089] train: loss=0.6865 acc=79.33% | val: loss=0.7955 acc=59.04% f1=68.52% auc=59.71% val_score=51.1190 val_score_bestthr=64.8531 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.127, mb=0.493, no=0.983, corr=-0.413) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 64.8531
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.1140 mb_mean=0.4932 norm_overlap=0.9791 corr_cb=-0.4350 topkJ=0.0016
[TRAIN][ep=043] loss=0.6649 acc=78.93%
[TRAIN][ep=043] mask_avg: mc_mean=0.1365 mb_mean=0.4928 norm_overlap=0.9838 corr_cb=-0.4200
[EPOCH 043/089] train: loss=0.6649 acc=78.93% | val: loss=0.9037 acc=59.04% f1=59.52% auc=60.00% val_score=45.9923 val_score_bestthr=56.1048 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.137, mb=0.493, no=0.984, corr=-0.420) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 56.1048
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.1512 mb_mean=0.4931 norm_overlap=0.9845 corr_cb=-0.4437 topkJ=0.0020
[TRAIN][ep=044] loss=0.6836 acc=79.87%
[TRAIN][ep=044] mask_avg: mc_mean=0.1150 mb_mean=0.4928 norm_overlap=0.9827 corr_cb=-0.3986
[EPOCH 044/089] train: loss=0.6836 acc=79.87% | val: loss=0.7976 acc=59.04% f1=68.52% auc=59.71% val_score=51.1251 val_score_bestthr=63.3088 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.115, mb=0.493, no=0.983, corr=-0.399) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 63.3088
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.1147 mb_mean=0.4935 norm_overlap=0.9872 corr_cb=-0.3625 topkJ=0.0036
[TRAIN][ep=045] loss=0.6466 acc=82.01%
[TRAIN][ep=045] mask_avg: mc_mean=0.1366 mb_mean=0.4928 norm_overlap=0.9841 corr_cb=-0.4085
[EPOCH 045/089] train: loss=0.6466 acc=82.01% | val: loss=0.8566 acc=59.04% f1=67.31% auc=59.30% val_score=50.1461 val_score_bestthr=60.0122 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.137, mb=0.493, no=0.984, corr=-0.408) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 60.0122
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.1766 mb_mean=0.4928 norm_overlap=0.9838 corr_cb=-0.4443 topkJ=0.0039
[TRAIN][ep=046] loss=0.6464 acc=80.27%
[TRAIN][ep=046] mask_avg: mc_mean=0.1616 mb_mean=0.4928 norm_overlap=0.9856 corr_cb=-0.4149
[EPOCH 046/089] train: loss=0.6464 acc=80.27% | val: loss=0.8164 acc=60.24% f1=69.72% auc=60.99% val_score=47.9652 val_score_bestthr=60.6347 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.162, mb=0.493, no=0.986, corr=-0.415) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 60.6347
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.1065 mb_mean=0.4929 norm_overlap=0.9780 corr_cb=-0.4421 topkJ=0.0012
[TRAIN][ep=047] loss=0.6591 acc=80.27%
[TRAIN][ep=047] mask_avg: mc_mean=0.1337 mb_mean=0.4928 norm_overlap=0.9839 corr_cb=-0.4065
[EPOCH 047/089] train: loss=0.6591 acc=80.27% | val: loss=0.8414 acc=57.83% f1=67.89% auc=60.12% val_score=49.5843 val_score_bestthr=62.9297 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.134, mb=0.493, no=0.984, corr=-0.406) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 62.9297
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.1540 mb_mean=0.4913 norm_overlap=0.9905 corr_cb=-0.3402 topkJ=0.0109
[TRAIN][ep=048] loss=0.6586 acc=81.07%
[TRAIN][ep=048] mask_avg: mc_mean=0.1347 mb_mean=0.4928 norm_overlap=0.9844 corr_cb=-0.3968
[EPOCH 048/089] train: loss=0.6586 acc=81.07% | val: loss=0.8232 acc=59.04% f1=68.52% auc=60.64% val_score=60.3426 val_score_bestthr=64.4288 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.135, mb=0.493, no=0.984, corr=-0.397) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 64.4288
[DBG][ep=049] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.0859 mb_mean=0.4987 norm_overlap=0.9743 corr_cb=-0.5338 topkJ=0.0019
[TRAIN][ep=049] loss=0.6275 acc=83.09%
[TRAIN][ep=049] mask_avg: mc_mean=0.1481 mb_mean=0.4928 norm_overlap=0.9850 corr_cb=-0.4039
[EPOCH 049/089] train: loss=0.6275 acc=83.09% | val: loss=0.8645 acc=60.24% f1=66.67% auc=60.58% val_score=46.0064 val_score_bestthr=63.0921 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.148, mb=0.493, no=0.985, corr=-0.404) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 63.0921
[DBG][ep=050] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.1468 mb_mean=0.4892 norm_overlap=0.9907 corr_cb=-0.2804 topkJ=0.0234
[TRAIN][ep=050] loss=0.5999 acc=86.04%
[TRAIN][ep=050] mask_avg: mc_mean=0.1199 mb_mean=0.4928 norm_overlap=0.9837 corr_cb=-0.3850
[EPOCH 050/089] train: loss=0.5999 acc=86.04% | val: loss=0.8370 acc=59.04% f1=69.09% auc=60.17% val_score=49.7252 val_score_bestthr=60.6548 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.120, mb=0.493, no=0.984, corr=-0.385) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 60.6548
[DBG][ep=051] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.1246 mb_mean=0.4934 norm_overlap=0.9813 corr_cb=-0.4392 topkJ=0.0037
[TRAIN][ep=051] loss=0.5967 acc=86.58%
[TRAIN][ep=051] mask_avg: mc_mean=0.1199 mb_mean=0.4928 norm_overlap=0.9834 corr_cb=-0.3895
[EPOCH 051/089] train: loss=0.5967 acc=86.58% | val: loss=0.8442 acc=57.83% f1=67.89% auc=60.12% val_score=49.7252 val_score_bestthr=62.9297 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.120, mb=0.493, no=0.983, corr=-0.389) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 62.9297
[DBG][ep=052] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.1558 mb_mean=0.4942 norm_overlap=0.9775 corr_cb=-0.4881 topkJ=0.0052
[TRAIN][ep=052] loss=0.5983 acc=84.97%
[TRAIN][ep=052] mask_avg: mc_mean=0.1199 mb_mean=0.4928 norm_overlap=0.9837 corr_cb=-0.3839
[EPOCH 052/089] train: loss=0.5983 acc=84.97% | val: loss=0.8506 acc=59.04% f1=69.09% auc=60.58% val_score=49.5843 val_score_bestthr=60.6548 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.120, mb=0.493, no=0.984, corr=-0.384) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 60.6548
[DBG][ep=053] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.1573 mb_mean=0.4891 norm_overlap=0.9886 corr_cb=-0.3532 topkJ=0.0094
[TRAIN][ep=053] loss=0.6013 acc=83.22%
[TRAIN][ep=053] mask_avg: mc_mean=0.1199 mb_mean=0.4928 norm_overlap=0.9836 corr_cb=-0.3866
[EPOCH 053/089] train: loss=0.6013 acc=83.22% | val: loss=0.8554 acc=60.24% f1=67.33% auc=60.87% val_score=49.4228 val_score_bestthr=62.5513 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.120, mb=0.493, no=0.984, corr=-0.387) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 62.5513
[DBG][ep=054] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=054] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=054] mask(step0): mc_mean=0.1410 mb_mean=0.4947 norm_overlap=0.9783 corr_cb=-0.4872 topkJ=0.0008
[TRAIN][ep=054] loss=0.6027 acc=84.03%
[TRAIN][ep=054] mask_avg: mc_mean=0.1198 mb_mean=0.4928 norm_overlap=0.9837 corr_cb=-0.3862
[EPOCH 054/089] train: loss=0.6027 acc=84.03% | val: loss=0.8617 acc=57.83% f1=68.47% auc=60.29% val_score=49.5843 val_score_bestthr=59.5567 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.120, mb=0.493, no=0.984, corr=-0.386) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 59.5567
[EARLY STOP] no improvement for 30 epochs. best_epoch=24
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
=============== FIT DONE ===============
[BEST] epoch=24 | val_acc=62.65% | val_f1=73.04% | val_auc=57.38% | val_score=50.2239 | val_score_bestthr=66.3367
[TEST@BEST] thr_used=0.475 | acc=62.80% f1=64.84% auc=66.82% | SP_sex=5.37% EO_sex=7.40% SP_age=13.96% EO_age=21.49%
[TIME] 1.35 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/summary_fold_1.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4925 mb_mean=0.4923 norm_overlap=1.0000 corr_cb=-0.0375 topkJ=0.0351
[TRAIN][ep=000] loss=0.6931 acc=51.01%
[TRAIN][ep=000] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0408
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4947 mb_mean=0.4925 norm_overlap=1.0000 corr_cb=0.0200 topkJ=0.0582
[TRAIN][ep=001] loss=0.6908 acc=53.02%
[TRAIN][ep=001] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0417
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4934 mb_mean=0.4912 norm_overlap=1.0000 corr_cb=-0.0761 topkJ=0.0212
[TRAIN][ep=002] loss=0.6911 acc=49.66%
[TRAIN][ep=002] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0335
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4946 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=0.0005 topkJ=0.0158
[TRAIN][ep=003] loss=0.6896 acc=55.97%
[TRAIN][ep=003] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0421
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4921 mb_mean=0.4935 norm_overlap=1.0000 corr_cb=0.0308 topkJ=0.0456
[TRAIN][ep=004] loss=0.6890 acc=56.78%
[TRAIN][ep=004] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0492
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4956 mb_mean=0.4905 norm_overlap=1.0000 corr_cb=-0.0217 topkJ=0.0255
[TRAIN][ep=005] loss=0.6854 acc=57.72%
[TRAIN][ep=005] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0414
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4955 mb_mean=0.4935 norm_overlap=1.0001 corr_cb=0.1792 topkJ=0.2987
[TRAIN][ep=006] loss=0.6823 acc=57.99%
[TRAIN][ep=006] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0439
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4934 mb_mean=0.4926 norm_overlap=1.0000 corr_cb=0.0730 topkJ=0.0188
[TRAIN][ep=007] loss=0.6802 acc=62.28%
[TRAIN][ep=007] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0419
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4941 mb_mean=0.4951 norm_overlap=1.0000 corr_cb=-0.0577 topkJ=0.0403
[TRAIN][ep=008] loss=0.6804 acc=57.32%
[TRAIN][ep=008] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0461
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4928 mb_mean=0.4945 norm_overlap=1.0001 corr_cb=0.2081 topkJ=0.0622
[TRAIN][ep=009] loss=0.6765 acc=61.34%
[TRAIN][ep=009] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0400
================= FIT START (fold=1) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4924 mb_mean=0.4908 norm_overlap=1.0000 corr_cb=-0.0313 topkJ=0.0382
[TRAIN][ep=000] loss=0.6711 acc=61.88%
[TRAIN][ep=000] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0416
[EPOCH 000/089] train: loss=0.6711 acc=61.88% | val: loss=0.6902 acc=57.83% f1=69.57% auc=53.02% val_score=42.9101 val_score_bestthr=56.8424 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.042) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 56.8424
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4945 mb_mean=0.4932 norm_overlap=1.0000 corr_cb=0.0532 topkJ=0.0351
[TRAIN][ep=001] loss=0.6648 acc=61.34%
[TRAIN][ep=001] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0445
[EPOCH 001/089] train: loss=0.6648 acc=61.34% | val: loss=0.6900 acc=55.42% f1=69.92% auc=52.09% val_score=43.0198 val_score_bestthr=62.6871 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.045) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 56.8424 -> 62.6871
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4957 mb_mean=0.4963 norm_overlap=1.0000 corr_cb=-0.0615 topkJ=0.0282
[TRAIN][ep=002] loss=0.6544 acc=65.10%
[TRAIN][ep=002] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0447
[EPOCH 002/089] train: loss=0.6544 acc=65.10% | val: loss=0.6914 acc=56.63% f1=69.49% auc=53.20% val_score=44.9705 val_score_bestthr=59.2265 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.045) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6871 -> 59.2265
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4968 mb_mean=0.4929 norm_overlap=0.9999 corr_cb=-0.1262 topkJ=0.0038
[TRAIN][ep=003] loss=0.6482 acc=64.30%
[TRAIN][ep=003] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0468
[EPOCH 003/089] train: loss=0.6482 acc=64.30% | val: loss=0.6943 acc=57.83% f1=69.57% auc=53.37% val_score=47.0193 val_score_bestthr=56.8424 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.047) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6871 -> 56.8424
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4915 mb_mean=0.4920 norm_overlap=1.0000 corr_cb=-0.0843 topkJ=0.0088
[TRAIN][ep=004] loss=0.6429 acc=63.49%
[TRAIN][ep=004] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0455
[EPOCH 004/089] train: loss=0.6429 acc=63.49% | val: loss=0.7003 acc=57.83% f1=68.47% auc=53.43% val_score=37.0298 val_score_bestthr=59.5284 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.046) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6871 -> 59.5284
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4942 mb_mean=0.4946 norm_overlap=0.9999 corr_cb=-0.1495 topkJ=0.0119
[TRAIN][ep=005] loss=1.5229 acc=63.49%
[TRAIN][ep=005] mask_avg: mc_mean=0.3753 mb_mean=0.4928 norm_overlap=0.9989 corr_cb=-0.3557
[EPOCH 005/089] train: loss=1.5229 acc=63.49% | val: loss=0.6939 acc=56.63% f1=70.00% auc=54.48% val_score=35.8021 val_score_bestthr=60.1401 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.375, mb=0.493, no=0.999, corr=-0.356) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6871 -> 60.1401
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2662 mb_mean=0.4960 norm_overlap=0.9958 corr_cb=-0.4905 topkJ=0.0031
[TRAIN][ep=006] loss=1.5028 acc=64.83%
[TRAIN][ep=006] mask_avg: mc_mean=0.2341 mb_mean=0.4928 norm_overlap=0.9967 corr_cb=-0.4150
[EPOCH 006/089] train: loss=1.5028 acc=64.83% | val: loss=0.6936 acc=57.83% f1=71.07% auc=54.19% val_score=32.6091 val_score_bestthr=63.1205 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.234, mb=0.493, no=0.997, corr=-0.415) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 62.6871 -> 63.1205
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.1544 mb_mean=0.4992 norm_overlap=0.9952 corr_cb=-0.4556 topkJ=0.0118
[TRAIN][ep=007] loss=1.5058 acc=64.30%
[TRAIN][ep=007] mask_avg: mc_mean=0.1754 mb_mean=0.4928 norm_overlap=0.9953 corr_cb=-0.4127
[EPOCH 007/089] train: loss=1.5058 acc=64.30% | val: loss=0.7120 acc=56.63% f1=69.49% auc=53.84% val_score=38.5081 val_score_bestthr=58.9833 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.175, mb=0.493, no=0.995, corr=-0.413) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.1205 -> 58.9833
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1553 mb_mean=0.4901 norm_overlap=0.9954 corr_cb=-0.4060 topkJ=0.0141
[TRAIN][ep=008] loss=1.4874 acc=65.77%
[TRAIN][ep=008] mask_avg: mc_mean=0.1346 mb_mean=0.4928 norm_overlap=0.9936 corr_cb=-0.4224
[EPOCH 008/089] train: loss=1.4874 acc=65.77% | val: loss=0.7020 acc=57.83% f1=71.07% auc=54.19% val_score=38.0640 val_score_bestthr=63.1205 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.135, mb=0.493, no=0.994, corr=-0.422) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.1205 -> 63.1205
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.0971 mb_mean=0.4926 norm_overlap=0.9923 corr_cb=-0.3827 topkJ=0.0210
[TRAIN][ep=009] loss=1.4998 acc=63.62%
[TRAIN][ep=009] mask_avg: mc_mean=0.1010 mb_mean=0.4928 norm_overlap=0.9917 corr_cb=-0.4164
[EPOCH 009/089] train: loss=1.4998 acc=63.62% | val: loss=0.7061 acc=56.63% f1=67.86% auc=54.13% val_score=39.3150 val_score_bestthr=58.0319 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.101, mb=0.493, no=0.992, corr=-0.416) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.1205 -> 58.0319
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.0747 mb_mean=0.4963 norm_overlap=0.9912 corr_cb=-0.4525 topkJ=0.0035
[TRAIN][ep=010] loss=1.4907 acc=65.23%
[TRAIN][ep=010] mask_avg: mc_mean=0.0799 mb_mean=0.4928 norm_overlap=0.9903 corr_cb=-0.3972
[EPOCH 010/089] train: loss=1.4907 acc=65.23% | val: loss=0.7006 acc=59.04% f1=70.69% auc=54.48% val_score=49.1388 val_score_bestthr=61.0958 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.080, mb=0.493, no=0.990, corr=-0.397) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.1205 -> 61.0958
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.0581 mb_mean=0.4924 norm_overlap=0.9911 corr_cb=-0.3237 topkJ=0.0132
[TRAIN][ep=011] loss=0.9655 acc=67.38%
[TRAIN][ep=011] mask_avg: mc_mean=0.0690 mb_mean=0.4928 norm_overlap=0.9890 corr_cb=-0.3947
[EPOCH 011/089] train: loss=0.9655 acc=67.38% | val: loss=0.7017 acc=59.04% f1=70.69% auc=54.48% val_score=41.4230 val_score_bestthr=61.0958 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.069, mb=0.493, no=0.989, corr=-0.395) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.1205 -> 61.0958
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.0602 mb_mean=0.4959 norm_overlap=0.9866 corr_cb=-0.4291 topkJ=0.0104
[TRAIN][ep=012] loss=0.8784 acc=70.34%
[TRAIN][ep=012] mask_avg: mc_mean=0.0640 mb_mean=0.4928 norm_overlap=0.9874 corr_cb=-0.3988
[EPOCH 012/089] train: loss=0.8784 acc=70.34% | val: loss=0.7062 acc=59.04% f1=70.69% auc=54.83% val_score=43.5062 val_score_bestthr=61.0958 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.064, mb=0.493, no=0.987, corr=-0.399) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.1205 -> 61.0958
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.0339 mb_mean=0.4973 norm_overlap=0.9833 corr_cb=-0.3880 topkJ=0.0016
[TRAIN][ep=013] loss=0.8924 acc=66.58%
[TRAIN][ep=013] mask_avg: mc_mean=0.0541 mb_mean=0.4928 norm_overlap=0.9856 corr_cb=-0.3837
[EPOCH 013/089] train: loss=0.8924 acc=66.58% | val: loss=0.7046 acc=60.24% f1=67.33% auc=55.58% val_score=42.0277 val_score_bestthr=65.0202 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.054, mb=0.493, no=0.986, corr=-0.384) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 63.1205 -> 65.0202
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.0428 mb_mean=0.4931 norm_overlap=0.9818 corr_cb=-0.4444 topkJ=0.0083
[TRAIN][ep=014] loss=0.8591 acc=70.87%
[TRAIN][ep=014] mask_avg: mc_mean=0.0537 mb_mean=0.4928 norm_overlap=0.9846 corr_cb=-0.3887
[EPOCH 014/089] train: loss=0.8591 acc=70.87% | val: loss=0.7288 acc=56.63% f1=70.49% auc=54.24% val_score=36.0552 val_score_bestthr=64.1779 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.054, mb=0.493, no=0.985, corr=-0.389) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.0202 -> 64.1779
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.0698 mb_mean=0.4915 norm_overlap=0.9897 corr_cb=-0.3665 topkJ=0.0126
[TRAIN][ep=015] loss=0.8624 acc=68.72%
[TRAIN][ep=015] mask_avg: mc_mean=0.0483 mb_mean=0.4928 norm_overlap=0.9829 corr_cb=-0.3744
[EPOCH 015/089] train: loss=0.8624 acc=68.72% | val: loss=0.7282 acc=60.24% f1=71.30% auc=54.07% val_score=47.3350 val_score_bestthr=63.2773 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.048, mb=0.493, no=0.983, corr=-0.374) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.0202 -> 63.2773
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.0508 mb_mean=0.4960 norm_overlap=0.9780 corr_cb=-0.4271 topkJ=0.0008
[TRAIN][ep=016] loss=0.8495 acc=69.93%
[TRAIN][ep=016] mask_avg: mc_mean=0.0592 mb_mean=0.4928 norm_overlap=0.9831 corr_cb=-0.4030
[EPOCH 016/089] train: loss=0.8495 acc=69.93% | val: loss=0.7153 acc=60.24% f1=71.79% auc=55.12% val_score=37.6109 val_score_bestthr=62.2198 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.059, mb=0.493, no=0.983, corr=-0.403) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.0202 -> 62.2198
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.0643 mb_mean=0.4935 norm_overlap=0.9816 corr_cb=-0.4624 topkJ=0.0044
[TRAIN][ep=017] loss=0.8489 acc=69.53%
[TRAIN][ep=017] mask_avg: mc_mean=0.0607 mb_mean=0.4928 norm_overlap=0.9825 corr_cb=-0.4009
[EPOCH 017/089] train: loss=0.8489 acc=69.53% | val: loss=0.7296 acc=60.24% f1=70.80% auc=54.19% val_score=53.4880 val_score_bestthr=61.4456 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.061, mb=0.493, no=0.983, corr=-0.401) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.0202 -> 61.4456
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.0524 mb_mean=0.4913 norm_overlap=0.9865 corr_cb=-0.3104 topkJ=0.0099
[TRAIN][ep=018] loss=0.8344 acc=71.68%
[TRAIN][ep=018] mask_avg: mc_mean=0.0553 mb_mean=0.4928 norm_overlap=0.9815 corr_cb=-0.3918
[EPOCH 018/089] train: loss=0.8344 acc=71.68% | val: loss=0.7188 acc=61.45% f1=71.93% auc=55.06% val_score=46.9059 val_score_bestthr=65.6471 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.055, mb=0.493, no=0.982, corr=-0.392) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 65.0202 -> 65.6471
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.0779 mb_mean=0.4941 norm_overlap=0.9869 corr_cb=-0.3628 topkJ=0.0108
[TRAIN][ep=019] loss=0.8374 acc=70.60%
[TRAIN][ep=019] mask_avg: mc_mean=0.0655 mb_mean=0.4928 norm_overlap=0.9816 corr_cb=-0.4128
[EPOCH 019/089] train: loss=0.8374 acc=70.60% | val: loss=0.7322 acc=61.45% f1=71.93% auc=54.65% val_score=47.3763 val_score_bestthr=65.6471 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.065, mb=0.493, no=0.982, corr=-0.413) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6471 -> 65.6471
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.0900 mb_mean=0.4898 norm_overlap=0.9863 corr_cb=-0.3868 topkJ=0.0054
[TRAIN][ep=020] loss=0.8280 acc=73.29%
[TRAIN][ep=020] mask_avg: mc_mean=0.0742 mb_mean=0.4928 norm_overlap=0.9817 corr_cb=-0.4277
[EPOCH 020/089] train: loss=0.8280 acc=73.29% | val: loss=0.7473 acc=59.04% f1=70.69% auc=56.69% val_score=38.0330 val_score_bestthr=61.0958 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.074, mb=0.493, no=0.982, corr=-0.428) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6471 -> 61.0958
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.0697 mb_mean=0.4926 norm_overlap=0.9846 corr_cb=-0.4448 topkJ=0.0028
[TRAIN][ep=021] loss=0.8145 acc=71.95%
[TRAIN][ep=021] mask_avg: mc_mean=0.0852 mb_mean=0.4928 norm_overlap=0.9822 corr_cb=-0.4387
[EPOCH 021/089] train: loss=0.8145 acc=71.95% | val: loss=0.7893 acc=60.24% f1=71.30% auc=56.34% val_score=43.2431 val_score_bestthr=62.5929 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.085, mb=0.493, no=0.982, corr=-0.439) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6471 -> 62.5929
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.0970 mb_mean=0.4906 norm_overlap=0.9829 corr_cb=-0.4303 topkJ=0.0020
[TRAIN][ep=022] loss=0.9211 acc=71.68%
[TRAIN][ep=022] mask_avg: mc_mean=0.0754 mb_mean=0.4928 norm_overlap=0.9812 corr_cb=-0.4244
[EPOCH 022/089] train: loss=0.9211 acc=71.68% | val: loss=0.7301 acc=60.24% f1=71.30% auc=55.64% val_score=48.6157 val_score_bestthr=63.2773 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.075, mb=0.493, no=0.981, corr=-0.424) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6471 -> 63.2773
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.0687 mb_mean=0.4932 norm_overlap=0.9734 corr_cb=-0.4831 topkJ=0.0023
[TRAIN][ep=023] loss=0.8057 acc=72.35%
[TRAIN][ep=023] mask_avg: mc_mean=0.0796 mb_mean=0.4928 norm_overlap=0.9816 corr_cb=-0.4256
[EPOCH 023/089] train: loss=0.8057 acc=72.35% | val: loss=0.7237 acc=61.45% f1=71.93% auc=55.06% val_score=45.7080 val_score_bestthr=65.6471 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.080, mb=0.493, no=0.982, corr=-0.426) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6471 -> 65.6471
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.0812 mb_mean=0.4927 norm_overlap=0.9825 corr_cb=-0.4639 topkJ=0.0020
[TRAIN][ep=024] loss=0.7962 acc=73.56%
[TRAIN][ep=024] mask_avg: mc_mean=0.0984 mb_mean=0.4928 norm_overlap=0.9826 corr_cb=-0.4436
[EPOCH 024/089] train: loss=0.7962 acc=73.56% | val: loss=0.7149 acc=62.65% f1=73.04% auc=56.98% val_score=50.2239 val_score_bestthr=66.3367 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.098, mb=0.493, no=0.983, corr=-0.444) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 65.6471 -> 66.3367
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.0557 mb_mean=0.4924 norm_overlap=0.9827 corr_cb=-0.3781 topkJ=0.0055
[TRAIN][ep=025] loss=0.8933 acc=72.89%
[TRAIN][ep=025] mask_avg: mc_mean=0.0836 mb_mean=0.4928 norm_overlap=0.9814 corr_cb=-0.4199
[EPOCH 025/089] train: loss=0.8933 acc=72.89% | val: loss=0.7353 acc=61.45% f1=72.41% auc=56.92% val_score=48.5270 val_score_bestthr=63.7174 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.084, mb=0.493, no=0.981, corr=-0.420) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 63.7174
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.0929 mb_mean=0.4922 norm_overlap=0.9879 corr_cb=-0.3549 topkJ=0.0069
[TRAIN][ep=026] loss=0.9850 acc=74.23%
[TRAIN][ep=026] mask_avg: mc_mean=0.1100 mb_mean=0.4928 norm_overlap=0.9830 corr_cb=-0.4447
[EPOCH 026/089] train: loss=0.9850 acc=74.23% | val: loss=0.7612 acc=61.45% f1=71.93% auc=57.56% val_score=39.5193 val_score_bestthr=65.6471 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.110, mb=0.493, no=0.983, corr=-0.445) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 65.6471
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1400 mb_mean=0.4908 norm_overlap=0.9854 corr_cb=-0.4034 topkJ=0.0024
[TRAIN][ep=027] loss=1.0687 acc=75.70%
[TRAIN][ep=027] mask_avg: mc_mean=0.1047 mb_mean=0.4928 norm_overlap=0.9826 corr_cb=-0.4322
[EPOCH 027/089] train: loss=1.0687 acc=75.70% | val: loss=0.7418 acc=62.65% f1=73.04% auc=58.08% val_score=40.7238 val_score_bestthr=66.3367 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.105, mb=0.493, no=0.983, corr=-0.432) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 66.3367
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.0645 mb_mean=0.4955 norm_overlap=0.9775 corr_cb=-0.4158 topkJ=0.0032
[TRAIN][ep=028] loss=1.1705 acc=74.23%
[TRAIN][ep=028] mask_avg: mc_mean=0.0838 mb_mean=0.4928 norm_overlap=0.9810 corr_cb=-0.4029
[EPOCH 028/089] train: loss=1.1705 acc=74.23% | val: loss=0.7434 acc=60.24% f1=71.30% auc=57.38% val_score=39.2230 val_score_bestthr=63.2773 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.084, mb=0.493, no=0.981, corr=-0.403) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 63.2773
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.0805 mb_mean=0.4953 norm_overlap=0.9779 corr_cb=-0.5078 topkJ=0.0004
[TRAIN][ep=029] loss=1.2449 acc=76.38%
[TRAIN][ep=029] mask_avg: mc_mean=0.1199 mb_mean=0.4928 norm_overlap=0.9832 corr_cb=-0.4427
[EPOCH 029/089] train: loss=1.2449 acc=76.38% | val: loss=0.7429 acc=61.45% f1=72.41% auc=56.92% val_score=41.5181 val_score_bestthr=63.7174 | dyn(w_pfs=0.100, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.120, mb=0.493, no=0.983, corr=-0.443) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 63.7174
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.0684 mb_mean=0.4980 norm_overlap=0.9660 corr_cb=-0.5380 topkJ=0.0004
[TRAIN][ep=030] loss=1.0018 acc=74.23%
[TRAIN][ep=030] mask_avg: mc_mean=0.1005 mb_mean=0.4928 norm_overlap=0.9819 corr_cb=-0.4196
[EPOCH 030/089] train: loss=1.0018 acc=74.23% | val: loss=0.7400 acc=61.45% f1=71.93% auc=56.98% val_score=50.7854 val_score_bestthr=65.6471 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.101, mb=0.493, no=0.982, corr=-0.420) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 65.6471
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.1032 mb_mean=0.4927 norm_overlap=0.9774 corr_cb=-0.5128 topkJ=0.0023
[TRAIN][ep=031] loss=0.7679 acc=72.89%
[TRAIN][ep=031] mask_avg: mc_mean=0.0974 mb_mean=0.4928 norm_overlap=0.9816 corr_cb=-0.4159
[EPOCH 031/089] train: loss=0.7679 acc=72.89% | val: loss=0.7742 acc=60.24% f1=70.80% auc=58.14% val_score=42.8562 val_score_bestthr=61.4456 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.097, mb=0.493, no=0.982, corr=-0.416) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 61.4456
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1216 mb_mean=0.4887 norm_overlap=0.9884 corr_cb=-0.2738 topkJ=0.0221
[TRAIN][ep=032] loss=0.7473 acc=76.11%
[TRAIN][ep=032] mask_avg: mc_mean=0.1074 mb_mean=0.4928 norm_overlap=0.9825 corr_cb=-0.4215
[EPOCH 032/089] train: loss=0.7473 acc=76.11% | val: loss=0.7459 acc=60.24% f1=70.80% auc=57.73% val_score=49.2267 val_score_bestthr=61.4456 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.107, mb=0.493, no=0.982, corr=-0.422) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 61.4456
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1146 mb_mean=0.4927 norm_overlap=0.9793 corr_cb=-0.4427 topkJ=0.0039
[TRAIN][ep=033] loss=0.7317 acc=77.05%
[TRAIN][ep=033] mask_avg: mc_mean=0.1123 mb_mean=0.4928 norm_overlap=0.9825 corr_cb=-0.4252
[EPOCH 033/089] train: loss=0.7317 acc=77.05% | val: loss=0.7536 acc=60.24% f1=70.80% auc=57.38% val_score=46.2484 val_score_bestthr=61.4456 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.112, mb=0.493, no=0.983, corr=-0.425) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 61.4456
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1144 mb_mean=0.4908 norm_overlap=0.9870 corr_cb=-0.3488 topkJ=0.0143
[TRAIN][ep=034] loss=0.7233 acc=77.85%
[TRAIN][ep=034] mask_avg: mc_mean=0.1244 mb_mean=0.4928 norm_overlap=0.9834 corr_cb=-0.4290
[EPOCH 034/089] train: loss=0.7233 acc=77.85% | val: loss=0.7793 acc=61.45% f1=70.91% auc=57.85% val_score=46.2955 val_score_bestthr=61.8877 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.124, mb=0.493, no=0.983, corr=-0.429) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 61.8877
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.1330 mb_mean=0.4924 norm_overlap=0.9873 corr_cb=-0.4213 topkJ=0.0040
[TRAIN][ep=035] loss=0.7368 acc=77.18%
[TRAIN][ep=035] mask_avg: mc_mean=0.1116 mb_mean=0.4928 norm_overlap=0.9825 corr_cb=-0.4154
[EPOCH 035/089] train: loss=0.7368 acc=77.18% | val: loss=0.7811 acc=61.45% f1=71.43% auc=57.44% val_score=51.1072 val_score_bestthr=62.5452 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.112, mb=0.493, no=0.983, corr=-0.415) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 62.5452
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.1177 mb_mean=0.4918 norm_overlap=0.9871 corr_cb=-0.3138 topkJ=0.0032
[TRAIN][ep=036] loss=0.7252 acc=76.78%
[TRAIN][ep=036] mask_avg: mc_mean=0.1264 mb_mean=0.4928 norm_overlap=0.9834 corr_cb=-0.4252
[EPOCH 036/089] train: loss=0.7252 acc=76.78% | val: loss=0.7666 acc=60.24% f1=70.80% auc=58.72% val_score=43.0168 val_score_bestthr=61.4456 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.126, mb=0.493, no=0.983, corr=-0.425) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 61.4456
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1347 mb_mean=0.4913 norm_overlap=0.9784 corr_cb=-0.4687 topkJ=0.0000
[TRAIN][ep=037] loss=0.7211 acc=77.45%
[TRAIN][ep=037] mask_avg: mc_mean=0.1293 mb_mean=0.4928 norm_overlap=0.9835 corr_cb=-0.4256
[EPOCH 037/089] train: loss=0.7211 acc=77.45% | val: loss=0.8181 acc=56.63% f1=70.00% auc=59.07% val_score=44.4953 val_score_bestthr=62.1241 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.129, mb=0.493, no=0.983, corr=-0.426) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 62.1241
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.1428 mb_mean=0.4918 norm_overlap=0.9843 corr_cb=-0.4094 topkJ=0.0049
[TRAIN][ep=038] loss=0.7042 acc=77.72%
[TRAIN][ep=038] mask_avg: mc_mean=0.1209 mb_mean=0.4928 norm_overlap=0.9832 corr_cb=-0.4145
[EPOCH 038/089] train: loss=0.7042 acc=77.72% | val: loss=0.7714 acc=60.24% f1=69.16% auc=58.84% val_score=43.6154 val_score_bestthr=61.0111 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.121, mb=0.493, no=0.983, corr=-0.415) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 61.0111
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.1399 mb_mean=0.4933 norm_overlap=0.9767 corr_cb=-0.5283 topkJ=0.0000
[TRAIN][ep=039] loss=0.6973 acc=77.45%
[TRAIN][ep=039] mask_avg: mc_mean=0.1367 mb_mean=0.4928 norm_overlap=0.9838 corr_cb=-0.4256
[EPOCH 039/089] train: loss=0.6973 acc=77.45% | val: loss=0.8457 acc=56.63% f1=69.49% auc=59.65% val_score=47.7707 val_score_bestthr=60.2928 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.137, mb=0.493, no=0.984, corr=-0.426) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 60.2928
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.1330 mb_mean=0.4926 norm_overlap=0.9802 corr_cb=-0.4841 topkJ=0.0039
[TRAIN][ep=040] loss=0.6814 acc=80.27%
[TRAIN][ep=040] mask_avg: mc_mean=0.1395 mb_mean=0.4928 norm_overlap=0.9843 corr_cb=-0.4193
[EPOCH 040/089] train: loss=0.6814 acc=80.27% | val: loss=0.8183 acc=60.24% f1=69.72% auc=58.84% val_score=47.2272 val_score_bestthr=63.3103 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.140, mb=0.493, no=0.984, corr=-0.419) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 63.3103
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.1623 mb_mean=0.4934 norm_overlap=0.9876 corr_cb=-0.3823 topkJ=0.0024
[TRAIN][ep=041] loss=0.6688 acc=81.74%
[TRAIN][ep=041] mask_avg: mc_mean=0.1279 mb_mean=0.4928 norm_overlap=0.9835 corr_cb=-0.4135
[EPOCH 041/089] train: loss=0.6688 acc=81.74% | val: loss=0.8218 acc=56.63% f1=70.00% auc=60.17% val_score=50.6024 val_score_bestthr=62.1241 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.128, mb=0.493, no=0.983, corr=-0.413) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 62.1241
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.1937 mb_mean=0.4932 norm_overlap=0.9841 corr_cb=-0.5122 topkJ=0.0008
[TRAIN][ep=042] loss=0.6870 acc=79.46%
[TRAIN][ep=042] mask_avg: mc_mean=0.1244 mb_mean=0.4928 norm_overlap=0.9833 corr_cb=-0.4094
[EPOCH 042/089] train: loss=0.6870 acc=79.46% | val: loss=0.7961 acc=59.04% f1=68.52% auc=59.53% val_score=51.1190 val_score_bestthr=64.8531 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.124, mb=0.493, no=0.983, corr=-0.409) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 64.8531
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.1137 mb_mean=0.4932 norm_overlap=0.9792 corr_cb=-0.4326 topkJ=0.0012
[TRAIN][ep=043] loss=0.6656 acc=79.33%
[TRAIN][ep=043] mask_avg: mc_mean=0.1357 mb_mean=0.4928 norm_overlap=0.9839 corr_cb=-0.4183
[EPOCH 043/089] train: loss=0.6656 acc=79.33% | val: loss=0.9056 acc=56.63% f1=67.27% auc=59.83% val_score=45.9923 val_score_bestthr=55.3945 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.136, mb=0.493, no=0.984, corr=-0.418) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 55.3945
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.1510 mb_mean=0.4931 norm_overlap=0.9845 corr_cb=-0.4442 topkJ=0.0016
[TRAIN][ep=044] loss=0.6842 acc=79.60%
[TRAIN][ep=044] mask_avg: mc_mean=0.1137 mb_mean=0.4928 norm_overlap=0.9827 corr_cb=-0.3966
[EPOCH 044/089] train: loss=0.6842 acc=79.60% | val: loss=0.7980 acc=59.04% f1=68.52% auc=59.36% val_score=49.4714 val_score_bestthr=63.3088 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.114, mb=0.493, no=0.983, corr=-0.397) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 63.3088
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.1126 mb_mean=0.4935 norm_overlap=0.9871 corr_cb=-0.3620 topkJ=0.0040
[TRAIN][ep=045] loss=0.6472 acc=81.07%
[TRAIN][ep=045] mask_avg: mc_mean=0.1349 mb_mean=0.4928 norm_overlap=0.9840 corr_cb=-0.4065
[EPOCH 045/089] train: loss=0.6472 acc=81.07% | val: loss=0.8578 acc=59.04% f1=67.31% auc=58.84% val_score=50.1461 val_score_bestthr=60.0122 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.135, mb=0.493, no=0.984, corr=-0.407) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 60.0122
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.1740 mb_mean=0.4928 norm_overlap=0.9836 corr_cb=-0.4438 topkJ=0.0039
[TRAIN][ep=046] loss=0.6473 acc=79.19%
[TRAIN][ep=046] mask_avg: mc_mean=0.1604 mb_mean=0.4928 norm_overlap=0.9855 corr_cb=-0.4140
[EPOCH 046/089] train: loss=0.6473 acc=79.19% | val: loss=0.8161 acc=60.24% f1=69.16% auc=60.64% val_score=47.9652 val_score_bestthr=60.8074 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.160, mb=0.493, no=0.986, corr=-0.414) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 60.8074
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.1049 mb_mean=0.4929 norm_overlap=0.9781 corr_cb=-0.4367 topkJ=0.0016
[TRAIN][ep=047] loss=0.6606 acc=80.00%
[TRAIN][ep=047] mask_avg: mc_mean=0.1310 mb_mean=0.4928 norm_overlap=0.9838 corr_cb=-0.4040
[EPOCH 047/089] train: loss=0.6606 acc=80.00% | val: loss=0.8415 acc=57.83% f1=67.89% auc=59.88% val_score=43.4493 val_score_bestthr=62.9297 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.131, mb=0.493, no=0.984, corr=-0.404) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 62.9297
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.1516 mb_mean=0.4913 norm_overlap=0.9903 corr_cb=-0.3439 topkJ=0.0101
[TRAIN][ep=048] loss=0.6594 acc=80.81%
[TRAIN][ep=048] mask_avg: mc_mean=0.1330 mb_mean=0.4928 norm_overlap=0.9844 corr_cb=-0.3955
[EPOCH 048/089] train: loss=0.6594 acc=80.81% | val: loss=0.8234 acc=59.04% f1=69.09% auc=60.35% val_score=60.3426 val_score_bestthr=60.6548 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.133, mb=0.493, no=0.984, corr=-0.396) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 60.6548
[DBG][ep=049] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.0848 mb_mean=0.4987 norm_overlap=0.9741 corr_cb=-0.5333 topkJ=0.0015
[TRAIN][ep=049] loss=0.6288 acc=82.68%
[TRAIN][ep=049] mask_avg: mc_mean=0.1475 mb_mean=0.4928 norm_overlap=0.9850 corr_cb=-0.4031
[EPOCH 049/089] train: loss=0.6288 acc=82.68% | val: loss=0.8642 acc=60.24% f1=66.67% auc=60.41% val_score=43.3919 val_score_bestthr=63.0921 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.147, mb=0.493, no=0.985, corr=-0.403) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 63.0921
[DBG][ep=050] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.1448 mb_mean=0.4892 norm_overlap=0.9907 corr_cb=-0.2772 topkJ=0.0230
[TRAIN][ep=050] loss=0.6014 acc=85.91%
[TRAIN][ep=050] mask_avg: mc_mean=0.1189 mb_mean=0.4928 norm_overlap=0.9837 corr_cb=-0.3836
[EPOCH 050/089] train: loss=0.6014 acc=85.91% | val: loss=0.8367 acc=59.04% f1=69.09% auc=60.12% val_score=50.1798 val_score_bestthr=60.6548 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.984, corr=-0.384) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 60.6548
[DBG][ep=051] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.1237 mb_mean=0.4934 norm_overlap=0.9814 corr_cb=-0.4367 topkJ=0.0037
[TRAIN][ep=051] loss=0.5981 acc=86.44%
[TRAIN][ep=051] mask_avg: mc_mean=0.1190 mb_mean=0.4928 norm_overlap=0.9834 corr_cb=-0.3881
[EPOCH 051/089] train: loss=0.5981 acc=86.44% | val: loss=0.8435 acc=59.04% f1=69.09% auc=59.94% val_score=49.7252 val_score_bestthr=60.6548 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.983, corr=-0.388) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 60.6548
[DBG][ep=052] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.1542 mb_mean=0.4942 norm_overlap=0.9774 corr_cb=-0.4875 topkJ=0.0048
[TRAIN][ep=052] loss=0.5997 acc=84.83%
[TRAIN][ep=052] mask_avg: mc_mean=0.1190 mb_mean=0.4928 norm_overlap=0.9837 corr_cb=-0.3825
[EPOCH 052/089] train: loss=0.5997 acc=84.83% | val: loss=0.8498 acc=57.83% f1=68.47% auc=60.29% val_score=49.5843 val_score_bestthr=59.5567 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.984, corr=-0.382) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 59.5567
[DBG][ep=053] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.1561 mb_mean=0.4891 norm_overlap=0.9885 corr_cb=-0.3526 topkJ=0.0094
[TRAIN][ep=053] loss=0.6027 acc=83.36%
[TRAIN][ep=053] mask_avg: mc_mean=0.1189 mb_mean=0.4928 norm_overlap=0.9836 corr_cb=-0.3852
[EPOCH 053/089] train: loss=0.6027 acc=83.36% | val: loss=0.8549 acc=60.24% f1=67.33% auc=60.52% val_score=51.6230 val_score_bestthr=62.5513 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.984, corr=-0.385) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 62.5513
[DBG][ep=054] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=054] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=054] mask(step0): mc_mean=0.1404 mb_mean=0.4947 norm_overlap=0.9782 corr_cb=-0.4881 topkJ=0.0008
[TRAIN][ep=054] loss=0.6045 acc=83.89%
[TRAIN][ep=054] mask_avg: mc_mean=0.1189 mb_mean=0.4928 norm_overlap=0.9837 corr_cb=-0.3848
[EPOCH 054/089] train: loss=0.6045 acc=83.89% | val: loss=0.8607 acc=57.83% f1=68.47% auc=60.17% val_score=49.5843 val_score_bestthr=59.5567 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.984, corr=-0.385) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 59.5567
[EARLY STOP] no improvement for 30 epochs. best_epoch=24
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
=============== FIT DONE ===============
[BEST] epoch=24 | val_acc=62.65% | val_f1=73.04% | val_auc=56.98% | val_score=50.2239 | val_score_bestthr=66.3367
[TEST@BEST] thr_used=0.465 | acc=62.32% f1=64.86% auc=66.63% | SP_sex=7.96% EO_sex=6.30% SP_age=16.09% EO_age=21.49%
[TIME] 1.31 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/summary_fold_1.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4925 mb_mean=0.4923 norm_overlap=1.0000 corr_cb=-0.0375 topkJ=0.0351
[TRAIN][ep=000] loss=0.6931 acc=51.01%
[TRAIN][ep=000] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0408
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4947 mb_mean=0.4925 norm_overlap=1.0000 corr_cb=0.0200 topkJ=0.0582
[TRAIN][ep=001] loss=0.6908 acc=53.02%
[TRAIN][ep=001] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0417
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4934 mb_mean=0.4912 norm_overlap=1.0000 corr_cb=-0.0761 topkJ=0.0212
[TRAIN][ep=002] loss=0.6911 acc=49.66%
[TRAIN][ep=002] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0335
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4946 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=0.0005 topkJ=0.0158
[TRAIN][ep=003] loss=0.6896 acc=55.97%
[TRAIN][ep=003] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0421
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4921 mb_mean=0.4935 norm_overlap=1.0000 corr_cb=0.0308 topkJ=0.0456
[TRAIN][ep=004] loss=0.6890 acc=56.78%
[TRAIN][ep=004] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0492
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4956 mb_mean=0.4905 norm_overlap=1.0000 corr_cb=-0.0217 topkJ=0.0255
[TRAIN][ep=005] loss=0.6854 acc=57.72%
[TRAIN][ep=005] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0414
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4955 mb_mean=0.4935 norm_overlap=1.0001 corr_cb=0.1792 topkJ=0.2987
[TRAIN][ep=006] loss=0.6823 acc=57.99%
[TRAIN][ep=006] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0439
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4934 mb_mean=0.4926 norm_overlap=1.0000 corr_cb=0.0730 topkJ=0.0188
[TRAIN][ep=007] loss=0.6802 acc=62.28%
[TRAIN][ep=007] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0419
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4941 mb_mean=0.4951 norm_overlap=1.0000 corr_cb=-0.0577 topkJ=0.0403
[TRAIN][ep=008] loss=0.6804 acc=57.32%
[TRAIN][ep=008] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0461
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4928 mb_mean=0.4945 norm_overlap=1.0001 corr_cb=0.2081 topkJ=0.0622
[TRAIN][ep=009] loss=0.6765 acc=61.21%
[TRAIN][ep=009] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0400
================= FIT START (fold=1) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4924 mb_mean=0.4908 norm_overlap=1.0000 corr_cb=-0.0313 topkJ=0.0382
[TRAIN][ep=000] loss=0.6711 acc=61.88%
[TRAIN][ep=000] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0416
[EPOCH 000/089] train: loss=0.6711 acc=61.88% | val: loss=0.6902 acc=57.83% f1=69.57% auc=53.02% val_score=42.9101 val_score_bestthr=56.8424 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.042) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 56.8424
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4945 mb_mean=0.4932 norm_overlap=1.0000 corr_cb=0.0532 topkJ=0.0351
[TRAIN][ep=001] loss=0.6648 acc=61.34%
[TRAIN][ep=001] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0445
[EPOCH 001/089] train: loss=0.6648 acc=61.34% | val: loss=0.6901 acc=55.42% f1=69.92% auc=52.09% val_score=43.0198 val_score_bestthr=62.6871 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.045) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 56.8424 -> 62.6871
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4957 mb_mean=0.4963 norm_overlap=1.0000 corr_cb=-0.0615 topkJ=0.0282
[TRAIN][ep=002] loss=0.6544 acc=65.10%
[TRAIN][ep=002] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0447
[EPOCH 002/089] train: loss=0.6544 acc=65.10% | val: loss=0.6914 acc=56.63% f1=69.49% auc=53.20% val_score=44.9705 val_score_bestthr=59.2265 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.045) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6871 -> 59.2265
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4968 mb_mean=0.4929 norm_overlap=0.9999 corr_cb=-0.1262 topkJ=0.0038
[TRAIN][ep=003] loss=0.6482 acc=64.30%
[TRAIN][ep=003] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0468
[EPOCH 003/089] train: loss=0.6482 acc=64.30% | val: loss=0.6942 acc=57.83% f1=69.57% auc=53.43% val_score=47.0193 val_score_bestthr=56.8424 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.047) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6871 -> 56.8424
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4915 mb_mean=0.4920 norm_overlap=1.0000 corr_cb=-0.0843 topkJ=0.0088
[TRAIN][ep=004] loss=0.6429 acc=63.49%
[TRAIN][ep=004] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0455
[EPOCH 004/089] train: loss=0.6429 acc=63.49% | val: loss=0.7003 acc=57.83% f1=68.47% auc=53.43% val_score=37.0298 val_score_bestthr=59.5284 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.046) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6871 -> 59.5284
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4942 mb_mean=0.4946 norm_overlap=0.9999 corr_cb=-0.1495 topkJ=0.0119
[TRAIN][ep=005] loss=1.4637 acc=63.49%
[TRAIN][ep=005] mask_avg: mc_mean=0.3740 mb_mean=0.4928 norm_overlap=0.9989 corr_cb=-0.3570
[EPOCH 005/089] train: loss=1.4637 acc=63.49% | val: loss=0.6941 acc=57.83% f1=71.07% auc=54.42% val_score=35.8021 val_score_bestthr=63.1205 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.374, mb=0.493, no=0.999, corr=-0.357) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 62.6871 -> 63.1205
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2649 mb_mean=0.4960 norm_overlap=0.9958 corr_cb=-0.4903 topkJ=0.0031
[TRAIN][ep=006] loss=1.4443 acc=64.83%
[TRAIN][ep=006] mask_avg: mc_mean=0.2333 mb_mean=0.4928 norm_overlap=0.9967 corr_cb=-0.4152
[EPOCH 006/089] train: loss=1.4443 acc=64.83% | val: loss=0.6937 acc=57.83% f1=71.07% auc=54.19% val_score=32.6091 val_score_bestthr=63.1205 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.233, mb=0.493, no=0.997, corr=-0.415) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.1205 -> 63.1205
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.1539 mb_mean=0.4992 norm_overlap=0.9951 corr_cb=-0.4563 topkJ=0.0118
[TRAIN][ep=007] loss=1.4475 acc=64.43%
[TRAIN][ep=007] mask_avg: mc_mean=0.1753 mb_mean=0.4928 norm_overlap=0.9952 corr_cb=-0.4131
[EPOCH 007/089] train: loss=1.4475 acc=64.43% | val: loss=0.7121 acc=56.63% f1=69.49% auc=53.84% val_score=38.5081 val_score_bestthr=58.9833 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.175, mb=0.493, no=0.995, corr=-0.413) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.1205 -> 58.9833
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1554 mb_mean=0.4901 norm_overlap=0.9953 corr_cb=-0.4064 topkJ=0.0141
[TRAIN][ep=008] loss=1.4292 acc=65.77%
[TRAIN][ep=008] mask_avg: mc_mean=0.1347 mb_mean=0.4928 norm_overlap=0.9935 corr_cb=-0.4228
[EPOCH 008/089] train: loss=1.4292 acc=65.77% | val: loss=0.7020 acc=57.83% f1=71.07% auc=54.13% val_score=38.0640 val_score_bestthr=63.1205 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.135, mb=0.493, no=0.994, corr=-0.423) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.1205 -> 63.1205
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.0973 mb_mean=0.4926 norm_overlap=0.9923 corr_cb=-0.3826 topkJ=0.0210
[TRAIN][ep=009] loss=1.4417 acc=63.62%
[TRAIN][ep=009] mask_avg: mc_mean=0.1009 mb_mean=0.4928 norm_overlap=0.9917 corr_cb=-0.4157
[EPOCH 009/089] train: loss=1.4417 acc=63.62% | val: loss=0.7058 acc=56.63% f1=67.86% auc=54.24% val_score=39.3150 val_score_bestthr=58.0319 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.101, mb=0.493, no=0.992, corr=-0.416) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.1205 -> 58.0319
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.0749 mb_mean=0.4963 norm_overlap=0.9913 corr_cb=-0.4524 topkJ=0.0035
[TRAIN][ep=010] loss=1.4327 acc=65.23%
[TRAIN][ep=010] mask_avg: mc_mean=0.0795 mb_mean=0.4928 norm_overlap=0.9904 corr_cb=-0.3960
[EPOCH 010/089] train: loss=1.4327 acc=65.23% | val: loss=0.7006 acc=57.83% f1=70.59% auc=54.42% val_score=49.1388 val_score_bestthr=59.6647 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.079, mb=0.493, no=0.990, corr=-0.396) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.1205 -> 59.6647
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.0577 mb_mean=0.4924 norm_overlap=0.9911 corr_cb=-0.3219 topkJ=0.0132
[TRAIN][ep=011] loss=0.9540 acc=67.25%
[TRAIN][ep=011] mask_avg: mc_mean=0.0687 mb_mean=0.4928 norm_overlap=0.9890 corr_cb=-0.3936
[EPOCH 011/089] train: loss=0.9540 acc=67.25% | val: loss=0.7017 acc=56.63% f1=69.49% auc=54.53% val_score=41.4230 val_score_bestthr=59.2265 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.069, mb=0.493, no=0.989, corr=-0.394) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.1205 -> 59.2265
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.0602 mb_mean=0.4959 norm_overlap=0.9866 corr_cb=-0.4289 topkJ=0.0104
[TRAIN][ep=012] loss=0.8784 acc=70.20%
[TRAIN][ep=012] mask_avg: mc_mean=0.0639 mb_mean=0.4928 norm_overlap=0.9874 corr_cb=-0.3984
[EPOCH 012/089] train: loss=0.8784 acc=70.20% | val: loss=0.7062 acc=59.04% f1=70.69% auc=54.83% val_score=43.5062 val_score_bestthr=61.0958 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.064, mb=0.493, no=0.987, corr=-0.398) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.1205 -> 61.0958
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.0338 mb_mean=0.4973 norm_overlap=0.9833 corr_cb=-0.3875 topkJ=0.0016
[TRAIN][ep=013] loss=0.8925 acc=66.71%
[TRAIN][ep=013] mask_avg: mc_mean=0.0538 mb_mean=0.4928 norm_overlap=0.9856 corr_cb=-0.3828
[EPOCH 013/089] train: loss=0.8925 acc=66.71% | val: loss=0.7045 acc=60.24% f1=67.33% auc=55.64% val_score=42.0277 val_score_bestthr=65.0202 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.054, mb=0.493, no=0.986, corr=-0.383) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 63.1205 -> 65.0202
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.0426 mb_mean=0.4931 norm_overlap=0.9818 corr_cb=-0.4433 topkJ=0.0083
[TRAIN][ep=014] loss=0.8592 acc=70.60%
[TRAIN][ep=014] mask_avg: mc_mean=0.0535 mb_mean=0.4928 norm_overlap=0.9846 corr_cb=-0.3880
[EPOCH 014/089] train: loss=0.8592 acc=70.60% | val: loss=0.7287 acc=59.04% f1=66.00% auc=54.30% val_score=36.0552 val_score_bestthr=60.6974 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.053, mb=0.493, no=0.985, corr=-0.388) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.0202 -> 60.6974
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.0696 mb_mean=0.4915 norm_overlap=0.9897 corr_cb=-0.3660 topkJ=0.0126
[TRAIN][ep=015] loss=0.8625 acc=68.86%
[TRAIN][ep=015] mask_avg: mc_mean=0.0483 mb_mean=0.4928 norm_overlap=0.9829 corr_cb=-0.3740
[EPOCH 015/089] train: loss=0.8625 acc=68.86% | val: loss=0.7279 acc=60.24% f1=71.30% auc=54.01% val_score=47.3350 val_score_bestthr=63.2773 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.048, mb=0.493, no=0.983, corr=-0.374) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.0202 -> 63.2773
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.0508 mb_mean=0.4960 norm_overlap=0.9780 corr_cb=-0.4268 topkJ=0.0008
[TRAIN][ep=016] loss=0.8496 acc=69.80%
[TRAIN][ep=016] mask_avg: mc_mean=0.0591 mb_mean=0.4928 norm_overlap=0.9831 corr_cb=-0.4026
[EPOCH 016/089] train: loss=0.8496 acc=69.80% | val: loss=0.7150 acc=60.24% f1=71.79% auc=55.17% val_score=38.0694 val_score_bestthr=62.2198 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.059, mb=0.493, no=0.983, corr=-0.403) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.0202 -> 62.2198
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.0641 mb_mean=0.4935 norm_overlap=0.9816 corr_cb=-0.4618 topkJ=0.0044
[TRAIN][ep=017] loss=0.8491 acc=69.53%
[TRAIN][ep=017] mask_avg: mc_mean=0.0606 mb_mean=0.4928 norm_overlap=0.9825 corr_cb=-0.4004
[EPOCH 017/089] train: loss=0.8491 acc=69.53% | val: loss=0.7292 acc=60.24% f1=70.80% auc=54.19% val_score=53.4880 val_score_bestthr=61.4456 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.061, mb=0.493, no=0.983, corr=-0.400) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.0202 -> 61.4456
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.0523 mb_mean=0.4913 norm_overlap=0.9865 corr_cb=-0.3102 topkJ=0.0099
[TRAIN][ep=018] loss=0.8345 acc=71.68%
[TRAIN][ep=018] mask_avg: mc_mean=0.0551 mb_mean=0.4928 norm_overlap=0.9815 corr_cb=-0.3913
[EPOCH 018/089] train: loss=0.8345 acc=71.68% | val: loss=0.7186 acc=61.45% f1=71.93% auc=55.12% val_score=46.9059 val_score_bestthr=65.6471 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.055, mb=0.493, no=0.982, corr=-0.391) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 65.0202 -> 65.6471
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.0777 mb_mean=0.4941 norm_overlap=0.9869 corr_cb=-0.3630 topkJ=0.0108
[TRAIN][ep=019] loss=0.8375 acc=70.47%
[TRAIN][ep=019] mask_avg: mc_mean=0.0652 mb_mean=0.4928 norm_overlap=0.9816 corr_cb=-0.4121
[EPOCH 019/089] train: loss=0.8375 acc=70.47% | val: loss=0.7320 acc=61.45% f1=71.93% auc=54.71% val_score=47.3763 val_score_bestthr=65.6471 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.065, mb=0.493, no=0.982, corr=-0.412) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6471 -> 65.6471
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.0892 mb_mean=0.4898 norm_overlap=0.9863 corr_cb=-0.3861 topkJ=0.0054
[TRAIN][ep=020] loss=0.8283 acc=73.29%
[TRAIN][ep=020] mask_avg: mc_mean=0.0735 mb_mean=0.4928 norm_overlap=0.9817 corr_cb=-0.4265
[EPOCH 020/089] train: loss=0.8283 acc=73.29% | val: loss=0.7470 acc=59.04% f1=70.69% auc=56.63% val_score=38.0330 val_score_bestthr=61.0958 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.074, mb=0.493, no=0.982, corr=-0.426) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6471 -> 61.0958
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.0693 mb_mean=0.4926 norm_overlap=0.9846 corr_cb=-0.4440 topkJ=0.0028
[TRAIN][ep=021] loss=0.8148 acc=72.08%
[TRAIN][ep=021] mask_avg: mc_mean=0.0846 mb_mean=0.4928 norm_overlap=0.9822 corr_cb=-0.4379
[EPOCH 021/089] train: loss=0.8148 acc=72.08% | val: loss=0.7888 acc=60.24% f1=71.30% auc=56.40% val_score=43.2431 val_score_bestthr=62.5929 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.085, mb=0.493, no=0.982, corr=-0.438) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6471 -> 62.5929
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.0961 mb_mean=0.4906 norm_overlap=0.9829 corr_cb=-0.4293 topkJ=0.0020
[TRAIN][ep=022] loss=0.9118 acc=71.95%
[TRAIN][ep=022] mask_avg: mc_mean=0.0749 mb_mean=0.4928 norm_overlap=0.9812 corr_cb=-0.4236
[EPOCH 022/089] train: loss=0.9118 acc=71.95% | val: loss=0.7299 acc=60.24% f1=71.30% auc=55.64% val_score=48.6157 val_score_bestthr=63.2773 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.075, mb=0.493, no=0.981, corr=-0.424) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6471 -> 63.2773
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.0681 mb_mean=0.4932 norm_overlap=0.9734 corr_cb=-0.4821 topkJ=0.0023
[TRAIN][ep=023] loss=0.8058 acc=72.21%
[TRAIN][ep=023] mask_avg: mc_mean=0.0790 mb_mean=0.4928 norm_overlap=0.9815 corr_cb=-0.4247
[EPOCH 023/089] train: loss=0.8058 acc=72.21% | val: loss=0.7234 acc=61.45% f1=71.93% auc=54.94% val_score=45.7080 val_score_bestthr=65.6471 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.079, mb=0.493, no=0.982, corr=-0.425) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6471 -> 65.6471
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.0806 mb_mean=0.4927 norm_overlap=0.9825 corr_cb=-0.4629 topkJ=0.0020
[TRAIN][ep=024] loss=0.7963 acc=73.56%
[TRAIN][ep=024] mask_avg: mc_mean=0.0978 mb_mean=0.4928 norm_overlap=0.9825 corr_cb=-0.4430
[EPOCH 024/089] train: loss=0.7963 acc=73.56% | val: loss=0.7147 acc=62.65% f1=73.04% auc=57.15% val_score=50.2239 val_score_bestthr=66.3367 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.098, mb=0.493, no=0.983, corr=-0.443) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 65.6471 -> 66.3367
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.0552 mb_mean=0.4924 norm_overlap=0.9827 corr_cb=-0.3773 topkJ=0.0055
[TRAIN][ep=025] loss=0.8841 acc=72.89%
[TRAIN][ep=025] mask_avg: mc_mean=0.0831 mb_mean=0.4928 norm_overlap=0.9814 corr_cb=-0.4192
[EPOCH 025/089] train: loss=0.8841 acc=72.89% | val: loss=0.7355 acc=61.45% f1=72.41% auc=56.92% val_score=47.1217 val_score_bestthr=63.7174 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.083, mb=0.493, no=0.981, corr=-0.419) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 63.7174
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.0931 mb_mean=0.4922 norm_overlap=0.9879 corr_cb=-0.3547 topkJ=0.0069
[TRAIN][ep=026] loss=0.9666 acc=74.63%
[TRAIN][ep=026] mask_avg: mc_mean=0.1094 mb_mean=0.4928 norm_overlap=0.9830 corr_cb=-0.4443
[EPOCH 026/089] train: loss=0.9666 acc=74.63% | val: loss=0.7612 acc=61.45% f1=71.93% auc=57.56% val_score=39.5193 val_score_bestthr=65.6471 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.109, mb=0.493, no=0.983, corr=-0.444) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 65.6471
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1385 mb_mean=0.4908 norm_overlap=0.9854 corr_cb=-0.4023 topkJ=0.0024
[TRAIN][ep=027] loss=1.0414 acc=75.84%
[TRAIN][ep=027] mask_avg: mc_mean=0.1040 mb_mean=0.4928 norm_overlap=0.9825 corr_cb=-0.4317
[EPOCH 027/089] train: loss=1.0414 acc=75.84% | val: loss=0.7412 acc=62.65% f1=73.04% auc=58.14% val_score=40.7238 val_score_bestthr=66.3367 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.104, mb=0.493, no=0.983, corr=-0.432) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 66.3367
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.0640 mb_mean=0.4955 norm_overlap=0.9775 corr_cb=-0.4147 topkJ=0.0032
[TRAIN][ep=028] loss=1.1340 acc=74.50%
[TRAIN][ep=028] mask_avg: mc_mean=0.0832 mb_mean=0.4928 norm_overlap=0.9810 corr_cb=-0.4023
[EPOCH 028/089] train: loss=1.1340 acc=74.50% | val: loss=0.7436 acc=60.24% f1=71.30% auc=57.44% val_score=39.2230 val_score_bestthr=63.2773 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.083, mb=0.493, no=0.981, corr=-0.402) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 63.2773
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.0792 mb_mean=0.4953 norm_overlap=0.9778 corr_cb=-0.5052 topkJ=0.0004
[TRAIN][ep=029] loss=1.1990 acc=76.38%
[TRAIN][ep=029] mask_avg: mc_mean=0.1191 mb_mean=0.4928 norm_overlap=0.9831 corr_cb=-0.4425
[EPOCH 029/089] train: loss=1.1990 acc=76.38% | val: loss=0.7433 acc=61.45% f1=72.41% auc=56.80% val_score=41.5181 val_score_bestthr=63.7174 | dyn(w_pfs=0.100, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.119, mb=0.493, no=0.983, corr=-0.442) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 63.7174
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.0683 mb_mean=0.4980 norm_overlap=0.9659 corr_cb=-0.5386 topkJ=0.0004
[TRAIN][ep=030] loss=0.9791 acc=74.50%
[TRAIN][ep=030] mask_avg: mc_mean=0.1001 mb_mean=0.4928 norm_overlap=0.9818 corr_cb=-0.4195
[EPOCH 030/089] train: loss=0.9791 acc=74.50% | val: loss=0.7399 acc=61.45% f1=71.93% auc=56.92% val_score=50.7854 val_score_bestthr=65.6471 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.100, mb=0.493, no=0.982, corr=-0.420) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 65.6471
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.1027 mb_mean=0.4927 norm_overlap=0.9774 corr_cb=-0.5127 topkJ=0.0023
[TRAIN][ep=031] loss=0.7681 acc=73.02%
[TRAIN][ep=031] mask_avg: mc_mean=0.0966 mb_mean=0.4928 norm_overlap=0.9816 corr_cb=-0.4153
[EPOCH 031/089] train: loss=0.7681 acc=73.02% | val: loss=0.7738 acc=60.24% f1=70.80% auc=57.97% val_score=42.8562 val_score_bestthr=61.4456 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.097, mb=0.493, no=0.982, corr=-0.415) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 61.4456
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1208 mb_mean=0.4887 norm_overlap=0.9884 corr_cb=-0.2729 topkJ=0.0221
[TRAIN][ep=032] loss=0.7476 acc=75.84%
[TRAIN][ep=032] mask_avg: mc_mean=0.1070 mb_mean=0.4928 norm_overlap=0.9824 corr_cb=-0.4215
[EPOCH 032/089] train: loss=0.7476 acc=75.84% | val: loss=0.7462 acc=60.24% f1=70.80% auc=57.56% val_score=49.2267 val_score_bestthr=61.4456 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.107, mb=0.493, no=0.982, corr=-0.421) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 61.4456
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1141 mb_mean=0.4927 norm_overlap=0.9792 corr_cb=-0.4423 topkJ=0.0039
[TRAIN][ep=033] loss=0.7320 acc=77.05%
[TRAIN][ep=033] mask_avg: mc_mean=0.1115 mb_mean=0.4928 norm_overlap=0.9825 corr_cb=-0.4249
[EPOCH 033/089] train: loss=0.7320 acc=77.05% | val: loss=0.7538 acc=60.24% f1=70.80% auc=57.44% val_score=46.2484 val_score_bestthr=61.4456 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.111, mb=0.493, no=0.982, corr=-0.425) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 61.4456
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1137 mb_mean=0.4908 norm_overlap=0.9869 corr_cb=-0.3489 topkJ=0.0143
[TRAIN][ep=034] loss=0.7235 acc=77.85%
[TRAIN][ep=034] mask_avg: mc_mean=0.1238 mb_mean=0.4928 norm_overlap=0.9834 corr_cb=-0.4289
[EPOCH 034/089] train: loss=0.7235 acc=77.85% | val: loss=0.7798 acc=61.45% f1=70.91% auc=57.91% val_score=46.2955 val_score_bestthr=61.8877 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.124, mb=0.493, no=0.983, corr=-0.429) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 61.8877
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.1335 mb_mean=0.4924 norm_overlap=0.9873 corr_cb=-0.4222 topkJ=0.0040
[TRAIN][ep=035] loss=0.7370 acc=77.18%
[TRAIN][ep=035] mask_avg: mc_mean=0.1112 mb_mean=0.4928 norm_overlap=0.9825 corr_cb=-0.4156
[EPOCH 035/089] train: loss=0.7370 acc=77.18% | val: loss=0.7813 acc=61.45% f1=71.43% auc=57.62% val_score=51.1072 val_score_bestthr=62.5452 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.111, mb=0.493, no=0.982, corr=-0.416) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 62.5452
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.1167 mb_mean=0.4918 norm_overlap=0.9870 corr_cb=-0.3132 topkJ=0.0036
[TRAIN][ep=036] loss=0.7256 acc=76.64%
[TRAIN][ep=036] mask_avg: mc_mean=0.1257 mb_mean=0.4928 norm_overlap=0.9833 corr_cb=-0.4252
[EPOCH 036/089] train: loss=0.7256 acc=76.64% | val: loss=0.7675 acc=60.24% f1=70.80% auc=58.55% val_score=43.0168 val_score_bestthr=61.4456 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.126, mb=0.493, no=0.983, corr=-0.425) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 61.4456
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1346 mb_mean=0.4913 norm_overlap=0.9784 corr_cb=-0.4687 topkJ=0.0000
[TRAIN][ep=037] loss=0.7217 acc=77.45%
[TRAIN][ep=037] mask_avg: mc_mean=0.1279 mb_mean=0.4928 norm_overlap=0.9834 corr_cb=-0.4255
[EPOCH 037/089] train: loss=0.7217 acc=77.45% | val: loss=0.8185 acc=56.63% f1=70.00% auc=59.01% val_score=44.4953 val_score_bestthr=62.1241 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.128, mb=0.493, no=0.983, corr=-0.425) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 62.1241
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.1418 mb_mean=0.4918 norm_overlap=0.9842 corr_cb=-0.4105 topkJ=0.0049
[TRAIN][ep=038] loss=0.7045 acc=77.85%
[TRAIN][ep=038] mask_avg: mc_mean=0.1206 mb_mean=0.4928 norm_overlap=0.9831 corr_cb=-0.4149
[EPOCH 038/089] train: loss=0.7045 acc=77.85% | val: loss=0.7713 acc=60.24% f1=69.16% auc=58.90% val_score=43.4493 val_score_bestthr=61.0111 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.121, mb=0.493, no=0.983, corr=-0.415) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 61.0111
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.1395 mb_mean=0.4933 norm_overlap=0.9766 corr_cb=-0.5282 topkJ=0.0000
[TRAIN][ep=039] loss=0.6976 acc=77.58%
[TRAIN][ep=039] mask_avg: mc_mean=0.1355 mb_mean=0.4928 norm_overlap=0.9837 corr_cb=-0.4254
[EPOCH 039/089] train: loss=0.6976 acc=77.58% | val: loss=0.8464 acc=56.63% f1=69.49% auc=59.48% val_score=47.7707 val_score_bestthr=60.2928 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.135, mb=0.493, no=0.984, corr=-0.425) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 60.2928
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.1319 mb_mean=0.4926 norm_overlap=0.9801 corr_cb=-0.4830 topkJ=0.0039
[TRAIN][ep=040] loss=0.6819 acc=80.13%
[TRAIN][ep=040] mask_avg: mc_mean=0.1382 mb_mean=0.4928 norm_overlap=0.9842 corr_cb=-0.4194
[EPOCH 040/089] train: loss=0.6819 acc=80.13% | val: loss=0.8188 acc=60.24% f1=69.72% auc=58.72% val_score=47.2272 val_score_bestthr=63.3103 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.138, mb=0.493, no=0.984, corr=-0.419) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 63.3103
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.1604 mb_mean=0.4934 norm_overlap=0.9875 corr_cb=-0.3816 topkJ=0.0024
[TRAIN][ep=041] loss=0.6690 acc=81.88%
[TRAIN][ep=041] mask_avg: mc_mean=0.1270 mb_mean=0.4928 norm_overlap=0.9834 corr_cb=-0.4135
[EPOCH 041/089] train: loss=0.6690 acc=81.88% | val: loss=0.8233 acc=56.63% f1=70.00% auc=60.23% val_score=50.6024 val_score_bestthr=62.1241 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.127, mb=0.493, no=0.983, corr=-0.414) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 62.1241
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.1933 mb_mean=0.4932 norm_overlap=0.9841 corr_cb=-0.5115 topkJ=0.0008
[TRAIN][ep=042] loss=0.6873 acc=79.33%
[TRAIN][ep=042] mask_avg: mc_mean=0.1236 mb_mean=0.4928 norm_overlap=0.9832 corr_cb=-0.4096
[EPOCH 042/089] train: loss=0.6873 acc=79.33% | val: loss=0.7972 acc=59.04% f1=68.52% auc=59.65% val_score=48.1095 val_score_bestthr=64.8531 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.124, mb=0.493, no=0.983, corr=-0.410) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 64.8531
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.1128 mb_mean=0.4932 norm_overlap=0.9791 corr_cb=-0.4316 topkJ=0.0012
[TRAIN][ep=043] loss=0.6660 acc=79.19%
[TRAIN][ep=043] mask_avg: mc_mean=0.1346 mb_mean=0.4928 norm_overlap=0.9837 corr_cb=-0.4185
[EPOCH 043/089] train: loss=0.6660 acc=79.19% | val: loss=0.9061 acc=56.63% f1=66.67% auc=59.83% val_score=45.9923 val_score_bestthr=56.3048 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.135, mb=0.493, no=0.984, corr=-0.419) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 56.3048
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.1491 mb_mean=0.4931 norm_overlap=0.9844 corr_cb=-0.4431 topkJ=0.0016
[TRAIN][ep=044] loss=0.6848 acc=79.60%
[TRAIN][ep=044] mask_avg: mc_mean=0.1129 mb_mean=0.4928 norm_overlap=0.9826 corr_cb=-0.3968
[EPOCH 044/089] train: loss=0.6848 acc=79.60% | val: loss=0.7985 acc=59.04% f1=68.52% auc=59.42% val_score=49.4714 val_score_bestthr=63.3088 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.113, mb=0.493, no=0.983, corr=-0.397) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 63.3088
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.1114 mb_mean=0.4935 norm_overlap=0.9869 corr_cb=-0.3624 topkJ=0.0040
[TRAIN][ep=045] loss=0.6478 acc=81.34%
[TRAIN][ep=045] mask_avg: mc_mean=0.1342 mb_mean=0.4928 norm_overlap=0.9839 corr_cb=-0.4070
[EPOCH 045/089] train: loss=0.6478 acc=81.34% | val: loss=0.8589 acc=59.04% f1=67.31% auc=58.84% val_score=52.1346 val_score_bestthr=60.0122 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.134, mb=0.493, no=0.984, corr=-0.407) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 60.0122
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.1734 mb_mean=0.4928 norm_overlap=0.9835 corr_cb=-0.4444 topkJ=0.0039
[TRAIN][ep=046] loss=0.6478 acc=79.19%
[TRAIN][ep=046] mask_avg: mc_mean=0.1594 mb_mean=0.4928 norm_overlap=0.9854 corr_cb=-0.4154
[EPOCH 046/089] train: loss=0.6478 acc=79.19% | val: loss=0.8165 acc=59.04% f1=67.92% auc=60.52% val_score=47.9652 val_score_bestthr=64.0499 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.159, mb=0.493, no=0.985, corr=-0.415) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 64.0499
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.1048 mb_mean=0.4929 norm_overlap=0.9781 corr_cb=-0.4361 topkJ=0.0012
[TRAIN][ep=047] loss=0.6607 acc=80.27%
[TRAIN][ep=047] mask_avg: mc_mean=0.1307 mb_mean=0.4928 norm_overlap=0.9837 corr_cb=-0.4048
[EPOCH 047/089] train: loss=0.6607 acc=80.27% | val: loss=0.8429 acc=57.83% f1=67.89% auc=59.88% val_score=43.4493 val_score_bestthr=62.9297 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.131, mb=0.493, no=0.984, corr=-0.405) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 62.9297
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.1511 mb_mean=0.4913 norm_overlap=0.9902 corr_cb=-0.3466 topkJ=0.0101
[TRAIN][ep=048] loss=0.6601 acc=80.94%
[TRAIN][ep=048] mask_avg: mc_mean=0.1324 mb_mean=0.4928 norm_overlap=0.9843 corr_cb=-0.3967
[EPOCH 048/089] train: loss=0.6601 acc=80.94% | val: loss=0.8247 acc=59.04% f1=69.09% auc=60.29% val_score=60.3426 val_score_bestthr=60.6548 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.132, mb=0.493, no=0.984, corr=-0.397) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 60.6548
[DBG][ep=049] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.0848 mb_mean=0.4987 norm_overlap=0.9740 corr_cb=-0.5340 topkJ=0.0015
[TRAIN][ep=049] loss=0.6292 acc=82.82%
[TRAIN][ep=049] mask_avg: mc_mean=0.1462 mb_mean=0.4928 norm_overlap=0.9849 corr_cb=-0.4039
[EPOCH 049/089] train: loss=0.6292 acc=82.82% | val: loss=0.8650 acc=60.24% f1=66.67% auc=60.35% val_score=53.5011 val_score_bestthr=63.0921 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.146, mb=0.493, no=0.985, corr=-0.404) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 63.0921
[DBG][ep=050] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.1431 mb_mean=0.4892 norm_overlap=0.9907 corr_cb=-0.2768 topkJ=0.0226
[TRAIN][ep=050] loss=0.6021 acc=85.91%
[TRAIN][ep=050] mask_avg: mc_mean=0.1179 mb_mean=0.4928 norm_overlap=0.9836 corr_cb=-0.3840
[EPOCH 050/089] train: loss=0.6021 acc=85.91% | val: loss=0.8376 acc=57.83% f1=67.89% auc=59.77% val_score=49.7252 val_score_bestthr=62.9297 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.118, mb=0.493, no=0.984, corr=-0.384) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 62.9297
[DBG][ep=051] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.1226 mb_mean=0.4934 norm_overlap=0.9812 corr_cb=-0.4377 topkJ=0.0037
[TRAIN][ep=051] loss=0.5988 acc=86.31%
[TRAIN][ep=051] mask_avg: mc_mean=0.1179 mb_mean=0.4928 norm_overlap=0.9833 corr_cb=-0.3885
[EPOCH 051/089] train: loss=0.5988 acc=86.31% | val: loss=0.8445 acc=57.83% f1=67.89% auc=59.83% val_score=49.7252 val_score_bestthr=62.9297 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.118, mb=0.493, no=0.983, corr=-0.388) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 62.9297
[DBG][ep=052] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.1532 mb_mean=0.4942 norm_overlap=0.9773 corr_cb=-0.4882 topkJ=0.0048
[TRAIN][ep=052] loss=0.6003 acc=84.83%
[TRAIN][ep=052] mask_avg: mc_mean=0.1179 mb_mean=0.4928 norm_overlap=0.9836 corr_cb=-0.3829
[EPOCH 052/089] train: loss=0.6003 acc=84.83% | val: loss=0.8510 acc=59.04% f1=69.09% auc=60.23% val_score=48.1986 val_score_bestthr=60.6548 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.118, mb=0.493, no=0.984, corr=-0.383) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 60.6548
[DBG][ep=053] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.1552 mb_mean=0.4891 norm_overlap=0.9885 corr_cb=-0.3532 topkJ=0.0094
[TRAIN][ep=053] loss=0.6033 acc=82.82%
[TRAIN][ep=053] mask_avg: mc_mean=0.1179 mb_mean=0.4928 norm_overlap=0.9835 corr_cb=-0.3856
[EPOCH 053/089] train: loss=0.6033 acc=82.82% | val: loss=0.8558 acc=57.83% f1=68.47% auc=60.35% val_score=49.4228 val_score_bestthr=59.5567 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.118, mb=0.493, no=0.983, corr=-0.386) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 59.5567
[DBG][ep=054] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=054] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=054] mask(step0): mc_mean=0.1399 mb_mean=0.4947 norm_overlap=0.9781 corr_cb=-0.4889 topkJ=0.0008
[TRAIN][ep=054] loss=0.6051 acc=83.89%
[TRAIN][ep=054] mask_avg: mc_mean=0.1179 mb_mean=0.4928 norm_overlap=0.9835 corr_cb=-0.3852
[EPOCH 054/089] train: loss=0.6051 acc=83.89% | val: loss=0.8616 acc=57.83% f1=68.47% auc=60.06% val_score=49.5843 val_score_bestthr=59.5567 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.118, mb=0.493, no=0.984, corr=-0.385) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 59.5567
[EARLY STOP] no improvement for 30 epochs. best_epoch=24
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
=============== FIT DONE ===============
[BEST] epoch=24 | val_acc=62.65% | val_f1=73.04% | val_auc=57.15% | val_score=50.2239 | val_score_bestthr=66.3367
[TEST@BEST] thr_used=0.475 | acc=62.32% f1=64.55% auc=66.68% | SP_sex=9.07% EO_sex=7.40% SP_age=13.96% EO_age=21.49%
[TIME] 1.45 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/summary_fold_1.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4925 mb_mean=0.4923 norm_overlap=1.0000 corr_cb=-0.0375 topkJ=0.0351
[TRAIN][ep=000] loss=0.6931 acc=51.01%
[TRAIN][ep=000] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0408
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4947 mb_mean=0.4925 norm_overlap=1.0000 corr_cb=0.0200 topkJ=0.0582
[TRAIN][ep=001] loss=0.6908 acc=53.02%
[TRAIN][ep=001] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0417
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4934 mb_mean=0.4912 norm_overlap=1.0000 corr_cb=-0.0761 topkJ=0.0212
[TRAIN][ep=002] loss=0.6911 acc=49.66%
[TRAIN][ep=002] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0335
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4946 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=0.0005 topkJ=0.0158
[TRAIN][ep=003] loss=0.6896 acc=55.97%
[TRAIN][ep=003] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0421
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4921 mb_mean=0.4935 norm_overlap=1.0000 corr_cb=0.0308 topkJ=0.0456
[TRAIN][ep=004] loss=0.6890 acc=56.78%
[TRAIN][ep=004] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0492
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4956 mb_mean=0.4905 norm_overlap=1.0000 corr_cb=-0.0217 topkJ=0.0255
[TRAIN][ep=005] loss=0.6854 acc=57.72%
[TRAIN][ep=005] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0414
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4955 mb_mean=0.4935 norm_overlap=1.0001 corr_cb=0.1792 topkJ=0.2987
[TRAIN][ep=006] loss=0.6823 acc=57.99%
[TRAIN][ep=006] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0439
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4934 mb_mean=0.4926 norm_overlap=1.0000 corr_cb=0.0730 topkJ=0.0188
[TRAIN][ep=007] loss=0.6802 acc=62.28%
[TRAIN][ep=007] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0419
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4941 mb_mean=0.4951 norm_overlap=1.0000 corr_cb=-0.0577 topkJ=0.0403
[TRAIN][ep=008] loss=0.6804 acc=57.32%
[TRAIN][ep=008] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0461
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4928 mb_mean=0.4945 norm_overlap=1.0001 corr_cb=0.2081 topkJ=0.0622
[TRAIN][ep=009] loss=0.6765 acc=61.21%
[TRAIN][ep=009] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0400
================= FIT START (fold=1) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4924 mb_mean=0.4908 norm_overlap=1.0000 corr_cb=-0.0313 topkJ=0.0382
[TRAIN][ep=000] loss=0.6711 acc=62.01%
[TRAIN][ep=000] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0416
[EPOCH 000/089] train: loss=0.6711 acc=62.01% | val: loss=0.6902 acc=57.83% f1=69.57% auc=53.02% val_score=42.9101 val_score_bestthr=56.8424 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.042) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 56.8424
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4945 mb_mean=0.4932 norm_overlap=1.0000 corr_cb=0.0532 topkJ=0.0351
[TRAIN][ep=001] loss=0.6648 acc=61.34%
[TRAIN][ep=001] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0445
[EPOCH 001/089] train: loss=0.6648 acc=61.34% | val: loss=0.6900 acc=55.42% f1=69.92% auc=52.09% val_score=43.0198 val_score_bestthr=62.6871 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.045) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 56.8424 -> 62.6871
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4957 mb_mean=0.4963 norm_overlap=1.0000 corr_cb=-0.0615 topkJ=0.0282
[TRAIN][ep=002] loss=0.6544 acc=65.10%
[TRAIN][ep=002] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0447
[EPOCH 002/089] train: loss=0.6544 acc=65.10% | val: loss=0.6914 acc=56.63% f1=69.49% auc=53.20% val_score=44.9705 val_score_bestthr=59.2265 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.045) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6871 -> 59.2265
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4968 mb_mean=0.4929 norm_overlap=0.9999 corr_cb=-0.1262 topkJ=0.0038
[TRAIN][ep=003] loss=0.6482 acc=64.30%
[TRAIN][ep=003] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0468
[EPOCH 003/089] train: loss=0.6482 acc=64.30% | val: loss=0.6943 acc=57.83% f1=69.57% auc=53.31% val_score=47.0193 val_score_bestthr=56.8424 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.047) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6871 -> 56.8424
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4915 mb_mean=0.4920 norm_overlap=1.0000 corr_cb=-0.0843 topkJ=0.0088
[TRAIN][ep=004] loss=0.6429 acc=63.36%
[TRAIN][ep=004] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0455
[EPOCH 004/089] train: loss=0.6429 acc=63.36% | val: loss=0.7002 acc=57.83% f1=68.47% auc=53.43% val_score=37.0298 val_score_bestthr=59.5284 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.046) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6871 -> 59.5284
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4942 mb_mean=0.4946 norm_overlap=0.9999 corr_cb=-0.1495 topkJ=0.0119
[TRAIN][ep=005] loss=1.2262 acc=64.03%
[TRAIN][ep=005] mask_avg: mc_mean=0.3719 mb_mean=0.4928 norm_overlap=0.9989 corr_cb=-0.3587
[EPOCH 005/089] train: loss=1.2262 acc=64.03% | val: loss=0.6936 acc=56.63% f1=70.49% auc=54.24% val_score=35.8021 val_score_bestthr=61.6282 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.372, mb=0.493, no=0.999, corr=-0.359) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6871 -> 61.6282
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2627 mb_mean=0.4960 norm_overlap=0.9957 corr_cb=-0.4893 topkJ=0.0031
[TRAIN][ep=006] loss=1.2121 acc=64.56%
[TRAIN][ep=006] mask_avg: mc_mean=0.2317 mb_mean=0.4928 norm_overlap=0.9967 corr_cb=-0.4148
[EPOCH 006/089] train: loss=1.2121 acc=64.56% | val: loss=0.6930 acc=56.63% f1=70.00% auc=54.30% val_score=32.6091 val_score_bestthr=60.1401 | dyn(w_pfs=0.240, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.232, mb=0.493, no=0.997, corr=-0.415) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6871 -> 60.1401
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.1531 mb_mean=0.4992 norm_overlap=0.9951 corr_cb=-0.4559 topkJ=0.0118
[TRAIN][ep=007] loss=1.0146 acc=64.83%
[TRAIN][ep=007] mask_avg: mc_mean=0.1756 mb_mean=0.4928 norm_overlap=0.9952 corr_cb=-0.4149
[EPOCH 007/089] train: loss=1.0146 acc=64.83% | val: loss=0.7123 acc=56.63% f1=69.49% auc=54.01% val_score=38.5081 val_score_bestthr=58.9833 | dyn(w_pfs=0.140, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.176, mb=0.493, no=0.995, corr=-0.415) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6871 -> 58.9833
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1564 mb_mean=0.4901 norm_overlap=0.9953 corr_cb=-0.4103 topkJ=0.0141
[TRAIN][ep=008] loss=0.8014 acc=65.91%
[TRAIN][ep=008] mask_avg: mc_mean=0.1378 mb_mean=0.4928 norm_overlap=0.9935 corr_cb=-0.4294
[EPOCH 008/089] train: loss=0.8014 acc=65.91% | val: loss=0.7026 acc=56.63% f1=70.49% auc=54.30% val_score=39.9031 val_score_bestthr=61.6282 | dyn(w_pfs=0.040, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.138, mb=0.493, no=0.993, corr=-0.429) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6871 -> 61.6282
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1013 mb_mean=0.4926 norm_overlap=0.9922 corr_cb=-0.3895 topkJ=0.0202
[TRAIN][ep=009] loss=0.7757 acc=63.09%
[TRAIN][ep=009] mask_avg: mc_mean=0.1063 mb_mean=0.4928 norm_overlap=0.9916 corr_cb=-0.4255
[EPOCH 009/089] train: loss=0.7757 acc=63.09% | val: loss=0.7074 acc=57.83% f1=66.02% auc=54.59% val_score=37.8324 val_score_bestthr=61.3809 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.106, mb=0.493, no=0.992, corr=-0.426) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6871 -> 61.3809
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.0781 mb_mean=0.4963 norm_overlap=0.9910 corr_cb=-0.4602 topkJ=0.0035
[TRAIN][ep=010] loss=0.7567 acc=65.23%
[TRAIN][ep=010] mask_avg: mc_mean=0.0860 mb_mean=0.4928 norm_overlap=0.9903 corr_cb=-0.4090
[EPOCH 010/089] train: loss=0.7567 acc=65.23% | val: loss=0.7015 acc=57.83% f1=70.59% auc=54.48% val_score=47.5452 val_score_bestthr=59.6647 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.086, mb=0.493, no=0.990, corr=-0.409) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6871 -> 59.6647
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.0635 mb_mean=0.4924 norm_overlap=0.9907 corr_cb=-0.3413 topkJ=0.0111
[TRAIN][ep=011] loss=0.7420 acc=66.17%
[TRAIN][ep=011] mask_avg: mc_mean=0.0738 mb_mean=0.4928 norm_overlap=0.9888 corr_cb=-0.4041
[EPOCH 011/089] train: loss=0.7420 acc=66.17% | val: loss=0.7035 acc=56.63% f1=69.49% auc=55.00% val_score=44.4311 val_score_bestthr=59.2265 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.074, mb=0.493, no=0.989, corr=-0.404) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6871 -> 59.2265
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.0633 mb_mean=0.4959 norm_overlap=0.9866 corr_cb=-0.4312 topkJ=0.0100
[TRAIN][ep=012] loss=0.7359 acc=69.66%
[TRAIN][ep=012] mask_avg: mc_mean=0.0655 mb_mean=0.4928 norm_overlap=0.9871 corr_cb=-0.4023
[EPOCH 012/089] train: loss=0.7359 acc=69.66% | val: loss=0.7066 acc=56.63% f1=69.49% auc=55.17% val_score=44.6594 val_score_bestthr=59.2265 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.066, mb=0.493, no=0.987, corr=-0.402) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6871 -> 59.2265
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.0346 mb_mean=0.4973 norm_overlap=0.9830 corr_cb=-0.3867 topkJ=0.0016
[TRAIN][ep=013] loss=0.7493 acc=66.44%
[TRAIN][ep=013] mask_avg: mc_mean=0.0542 mb_mean=0.4928 norm_overlap=0.9852 corr_cb=-0.3850
[EPOCH 013/089] train: loss=0.7493 acc=66.44% | val: loss=0.7055 acc=60.24% f1=67.33% auc=55.87% val_score=36.6028 val_score_bestthr=65.0202 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.054, mb=0.493, no=0.985, corr=-0.385) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 62.6871 -> 65.0202
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.0427 mb_mean=0.4931 norm_overlap=0.9813 corr_cb=-0.4460 topkJ=0.0075
[TRAIN][ep=014] loss=0.7176 acc=70.07%
[TRAIN][ep=014] mask_avg: mc_mean=0.0542 mb_mean=0.4928 norm_overlap=0.9843 corr_cb=-0.3915
[EPOCH 014/089] train: loss=0.7176 acc=70.07% | val: loss=0.7289 acc=56.63% f1=70.49% auc=54.65% val_score=36.0552 val_score_bestthr=64.1779 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.054, mb=0.493, no=0.984, corr=-0.392) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.0202 -> 64.1779
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.0695 mb_mean=0.4915 norm_overlap=0.9894 corr_cb=-0.3701 topkJ=0.0122
[TRAIN][ep=015] loss=0.7214 acc=68.19%
[TRAIN][ep=015] mask_avg: mc_mean=0.0488 mb_mean=0.4928 norm_overlap=0.9826 corr_cb=-0.3776
[EPOCH 015/089] train: loss=0.7214 acc=68.19% | val: loss=0.7288 acc=60.24% f1=70.80% auc=54.19% val_score=47.3350 val_score_bestthr=61.4456 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.049, mb=0.493, no=0.983, corr=-0.378) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.0202 -> 61.4456
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.0525 mb_mean=0.4960 norm_overlap=0.9779 corr_cb=-0.4337 topkJ=0.0008
[TRAIN][ep=016] loss=0.7089 acc=69.80%
[TRAIN][ep=016] mask_avg: mc_mean=0.0613 mb_mean=0.4928 norm_overlap=0.9829 corr_cb=-0.4099
[EPOCH 016/089] train: loss=0.7089 acc=69.80% | val: loss=0.7144 acc=60.24% f1=71.79% auc=55.41% val_score=37.6109 val_score_bestthr=62.2198 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.061, mb=0.493, no=0.983, corr=-0.410) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.0202 -> 62.2198
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.0643 mb_mean=0.4935 norm_overlap=0.9812 corr_cb=-0.4657 topkJ=0.0040
[TRAIN][ep=017] loss=0.7084 acc=69.53%
[TRAIN][ep=017] mask_avg: mc_mean=0.0612 mb_mean=0.4928 norm_overlap=0.9822 corr_cb=-0.4044
[EPOCH 017/089] train: loss=0.7084 acc=69.53% | val: loss=0.7297 acc=60.24% f1=71.79% auc=54.88% val_score=53.4880 val_score_bestthr=62.4506 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.061, mb=0.493, no=0.982, corr=-0.404) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.0202 -> 62.4506
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.0542 mb_mean=0.4913 norm_overlap=0.9864 corr_cb=-0.3167 topkJ=0.0099
[TRAIN][ep=018] loss=0.6938 acc=72.08%
[TRAIN][ep=018] mask_avg: mc_mean=0.0570 mb_mean=0.4928 norm_overlap=0.9814 corr_cb=-0.3982
[EPOCH 018/089] train: loss=0.6938 acc=72.08% | val: loss=0.7179 acc=61.45% f1=71.93% auc=55.41% val_score=48.6173 val_score_bestthr=65.6471 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.057, mb=0.493, no=0.981, corr=-0.398) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 65.0202 -> 65.6471
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.0801 mb_mean=0.4941 norm_overlap=0.9869 corr_cb=-0.3648 topkJ=0.0112
[TRAIN][ep=019] loss=0.6984 acc=70.60%
[TRAIN][ep=019] mask_avg: mc_mean=0.0674 mb_mean=0.4928 norm_overlap=0.9815 corr_cb=-0.4190
[EPOCH 019/089] train: loss=0.6984 acc=70.60% | val: loss=0.7304 acc=61.45% f1=71.93% auc=55.29% val_score=44.2360 val_score_bestthr=65.6471 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.067, mb=0.493, no=0.981, corr=-0.419) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6471 -> 65.6471
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.0937 mb_mean=0.4898 norm_overlap=0.9864 corr_cb=-0.3910 topkJ=0.0051
[TRAIN][ep=020] loss=0.6887 acc=73.02%
[TRAIN][ep=020] mask_avg: mc_mean=0.0771 mb_mean=0.4928 norm_overlap=0.9817 corr_cb=-0.4355
[EPOCH 020/089] train: loss=0.6887 acc=73.02% | val: loss=0.7457 acc=59.04% f1=70.69% auc=57.21% val_score=38.0330 val_score_bestthr=61.0958 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.077, mb=0.493, no=0.982, corr=-0.435) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6471 -> 61.0958
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.0727 mb_mean=0.4926 norm_overlap=0.9846 corr_cb=-0.4541 topkJ=0.0028
[TRAIN][ep=021] loss=0.6765 acc=72.35%
[TRAIN][ep=021] mask_avg: mc_mean=0.0873 mb_mean=0.4928 norm_overlap=0.9821 corr_cb=-0.4441
[EPOCH 021/089] train: loss=0.6765 acc=72.35% | val: loss=0.7896 acc=60.24% f1=71.30% auc=56.80% val_score=44.4595 val_score_bestthr=62.5929 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.087, mb=0.493, no=0.982, corr=-0.444) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6471 -> 62.5929
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1008 mb_mean=0.4906 norm_overlap=0.9829 corr_cb=-0.4335 topkJ=0.0024
[TRAIN][ep=022] loss=0.7625 acc=71.68%
[TRAIN][ep=022] mask_avg: mc_mean=0.0786 mb_mean=0.4928 norm_overlap=0.9813 corr_cb=-0.4314
[EPOCH 022/089] train: loss=0.7625 acc=71.68% | val: loss=0.7252 acc=60.24% f1=71.30% auc=55.93% val_score=51.9917 val_score_bestthr=63.2773 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.079, mb=0.493, no=0.981, corr=-0.431) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6471 -> 63.2773
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.0690 mb_mean=0.4932 norm_overlap=0.9732 corr_cb=-0.4858 topkJ=0.0027
[TRAIN][ep=023] loss=0.6689 acc=72.75%
[TRAIN][ep=023] mask_avg: mc_mean=0.0814 mb_mean=0.4928 norm_overlap=0.9815 corr_cb=-0.4293
[EPOCH 023/089] train: loss=0.6689 acc=72.75% | val: loss=0.7206 acc=61.45% f1=71.93% auc=55.99% val_score=44.6594 val_score_bestthr=65.6471 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.081, mb=0.493, no=0.981, corr=-0.429) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6471 -> 65.6471
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.0827 mb_mean=0.4927 norm_overlap=0.9823 corr_cb=-0.4688 topkJ=0.0016
[TRAIN][ep=024] loss=0.6609 acc=73.96%
[TRAIN][ep=024] mask_avg: mc_mean=0.1018 mb_mean=0.4928 norm_overlap=0.9826 corr_cb=-0.4482
[EPOCH 024/089] train: loss=0.6609 acc=73.96% | val: loss=0.7122 acc=62.65% f1=73.04% auc=57.38% val_score=50.2239 val_score_bestthr=66.3367 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.102, mb=0.493, no=0.983, corr=-0.448) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 65.6471 -> 66.3367
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.0561 mb_mean=0.4924 norm_overlap=0.9825 corr_cb=-0.3796 topkJ=0.0047
[TRAIN][ep=025] loss=0.7353 acc=72.62%
[TRAIN][ep=025] mask_avg: mc_mean=0.0845 mb_mean=0.4928 norm_overlap=0.9813 corr_cb=-0.4215
[EPOCH 025/089] train: loss=0.7353 acc=72.62% | val: loss=0.7323 acc=60.24% f1=71.30% auc=56.92% val_score=46.6077 val_score_bestthr=63.2773 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.084, mb=0.493, no=0.981, corr=-0.422) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 63.2773
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.0965 mb_mean=0.4922 norm_overlap=0.9879 corr_cb=-0.3597 topkJ=0.0073
[TRAIN][ep=026] loss=0.8049 acc=74.36%
[TRAIN][ep=026] mask_avg: mc_mean=0.1126 mb_mean=0.4928 norm_overlap=0.9830 corr_cb=-0.4472
[EPOCH 026/089] train: loss=0.8049 acc=74.36% | val: loss=0.7593 acc=61.45% f1=71.93% auc=58.43% val_score=36.9843 val_score_bestthr=65.6471 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.113, mb=0.493, no=0.983, corr=-0.447) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 65.6471
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1413 mb_mean=0.4908 norm_overlap=0.9855 corr_cb=-0.3995 topkJ=0.0024
[TRAIN][ep=027] loss=0.8660 acc=75.17%
[TRAIN][ep=027] mask_avg: mc_mean=0.1072 mb_mean=0.4928 norm_overlap=0.9826 corr_cb=-0.4344
[EPOCH 027/089] train: loss=0.8660 acc=75.17% | val: loss=0.7370 acc=62.65% f1=73.04% auc=58.55% val_score=40.7238 val_score_bestthr=66.3367 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.107, mb=0.493, no=0.983, corr=-0.434) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 66.3367
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.0644 mb_mean=0.4955 norm_overlap=0.9774 corr_cb=-0.4138 topkJ=0.0032
[TRAIN][ep=028] loss=0.9455 acc=74.50%
[TRAIN][ep=028] mask_avg: mc_mean=0.0861 mb_mean=0.4928 norm_overlap=0.9810 corr_cb=-0.4056
[EPOCH 028/089] train: loss=0.9455 acc=74.50% | val: loss=0.7398 acc=60.24% f1=71.30% auc=57.79% val_score=41.0014 val_score_bestthr=63.2773 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.086, mb=0.493, no=0.981, corr=-0.406) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 63.2773
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.0823 mb_mean=0.4953 norm_overlap=0.9779 corr_cb=-0.5148 topkJ=0.0004
[TRAIN][ep=029] loss=0.9973 acc=76.51%
[TRAIN][ep=029] mask_avg: mc_mean=0.1242 mb_mean=0.4928 norm_overlap=0.9833 corr_cb=-0.4460
[EPOCH 029/089] train: loss=0.9973 acc=76.51% | val: loss=0.7387 acc=61.45% f1=71.93% auc=57.03% val_score=40.7228 val_score_bestthr=65.6471 | dyn(w_pfs=0.100, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.124, mb=0.493, no=0.983, corr=-0.446) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 65.6471
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.0665 mb_mean=0.4980 norm_overlap=0.9652 corr_cb=-0.5321 topkJ=0.0004
[TRAIN][ep=030] loss=0.8113 acc=74.50%
[TRAIN][ep=030] mask_avg: mc_mean=0.1009 mb_mean=0.4928 norm_overlap=0.9817 corr_cb=-0.4197
[EPOCH 030/089] train: loss=0.8113 acc=74.50% | val: loss=0.7375 acc=61.45% f1=71.93% auc=57.56% val_score=48.7783 val_score_bestthr=65.6471 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.101, mb=0.493, no=0.982, corr=-0.420) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 65.6471
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.1065 mb_mean=0.4927 norm_overlap=0.9775 corr_cb=-0.5144 topkJ=0.0023
[TRAIN][ep=031] loss=0.6349 acc=73.29%
[TRAIN][ep=031] mask_avg: mc_mean=0.0990 mb_mean=0.4928 norm_overlap=0.9816 corr_cb=-0.4180
[EPOCH 031/089] train: loss=0.6349 acc=73.29% | val: loss=0.7699 acc=60.24% f1=70.80% auc=58.90% val_score=44.6384 val_score_bestthr=61.4456 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.099, mb=0.493, no=0.982, corr=-0.418) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 61.4456
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1258 mb_mean=0.4887 norm_overlap=0.9885 corr_cb=-0.2758 topkJ=0.0225
[TRAIN][ep=032] loss=0.6152 acc=76.11%
[TRAIN][ep=032] mask_avg: mc_mean=0.1113 mb_mean=0.4928 norm_overlap=0.9825 corr_cb=-0.4245
[EPOCH 032/089] train: loss=0.6152 acc=76.11% | val: loss=0.7438 acc=60.24% f1=70.80% auc=58.66% val_score=49.7672 val_score_bestthr=61.4456 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.111, mb=0.493, no=0.983, corr=-0.425) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 61.4456
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1185 mb_mean=0.4927 norm_overlap=0.9793 corr_cb=-0.4485 topkJ=0.0043
[TRAIN][ep=033] loss=0.5991 acc=77.32%
[TRAIN][ep=033] mask_avg: mc_mean=0.1154 mb_mean=0.4928 norm_overlap=0.9826 corr_cb=-0.4278
[EPOCH 033/089] train: loss=0.5991 acc=77.32% | val: loss=0.7518 acc=60.24% f1=70.80% auc=58.14% val_score=45.7591 val_score_bestthr=61.4456 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.115, mb=0.493, no=0.983, corr=-0.428) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 61.4456
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1197 mb_mean=0.4908 norm_overlap=0.9869 corr_cb=-0.3573 topkJ=0.0131
[TRAIN][ep=034] loss=0.5935 acc=77.85%
[TRAIN][ep=034] mask_avg: mc_mean=0.1275 mb_mean=0.4928 norm_overlap=0.9834 corr_cb=-0.4310
[EPOCH 034/089] train: loss=0.5935 acc=77.85% | val: loss=0.7774 acc=61.45% f1=71.43% auc=58.43% val_score=50.0950 val_score_bestthr=62.5452 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.127, mb=0.493, no=0.983, corr=-0.431) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 62.5452
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.1360 mb_mean=0.4924 norm_overlap=0.9873 corr_cb=-0.4238 topkJ=0.0048
[TRAIN][ep=035] loss=0.6068 acc=77.18%
[TRAIN][ep=035] mask_avg: mc_mean=0.1146 mb_mean=0.4928 norm_overlap=0.9825 corr_cb=-0.4184
[EPOCH 035/089] train: loss=0.6068 acc=77.18% | val: loss=0.7798 acc=61.45% f1=71.43% auc=57.97% val_score=51.1072 val_score_bestthr=62.5452 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.115, mb=0.493, no=0.983, corr=-0.418) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 62.5452
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.1211 mb_mean=0.4918 norm_overlap=0.9870 corr_cb=-0.3180 topkJ=0.0032
[TRAIN][ep=036] loss=0.5952 acc=76.51%
[TRAIN][ep=036] mask_avg: mc_mean=0.1305 mb_mean=0.4928 norm_overlap=0.9834 corr_cb=-0.4284
[EPOCH 036/089] train: loss=0.5952 acc=76.51% | val: loss=0.7633 acc=60.24% f1=70.80% auc=59.13% val_score=48.0194 val_score_bestthr=61.4456 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.131, mb=0.493, no=0.983, corr=-0.428) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 61.4456
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1373 mb_mean=0.4913 norm_overlap=0.9783 corr_cb=-0.4719 topkJ=0.0000
[TRAIN][ep=037] loss=0.5909 acc=77.45%
[TRAIN][ep=037] mask_avg: mc_mean=0.1305 mb_mean=0.4928 norm_overlap=0.9834 corr_cb=-0.4269
[EPOCH 037/089] train: loss=0.5909 acc=77.45% | val: loss=0.8138 acc=60.24% f1=68.57% auc=59.48% val_score=44.4953 val_score_bestthr=60.8641 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.131, mb=0.493, no=0.983, corr=-0.427) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 60.8641
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.1455 mb_mean=0.4918 norm_overlap=0.9841 corr_cb=-0.4132 topkJ=0.0044
[TRAIN][ep=038] loss=0.5762 acc=77.45%
[TRAIN][ep=038] mask_avg: mc_mean=0.1231 mb_mean=0.4928 norm_overlap=0.9831 corr_cb=-0.4168
[EPOCH 038/089] train: loss=0.5762 acc=77.45% | val: loss=0.7697 acc=61.45% f1=69.81% auc=59.36% val_score=45.7603 val_score_bestthr=61.9101 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.123, mb=0.493, no=0.983, corr=-0.417) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 61.9101
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.1428 mb_mean=0.4933 norm_overlap=0.9765 corr_cb=-0.5327 topkJ=0.0000
[TRAIN][ep=039] loss=0.5687 acc=77.58%
[TRAIN][ep=039] mask_avg: mc_mean=0.1380 mb_mean=0.4928 norm_overlap=0.9837 corr_cb=-0.4277
[EPOCH 039/089] train: loss=0.5687 acc=77.58% | val: loss=0.8460 acc=60.24% f1=69.16% auc=60.06% val_score=47.7707 val_score_bestthr=58.7711 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.138, mb=0.493, no=0.984, corr=-0.428) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 58.7711
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.1366 mb_mean=0.4926 norm_overlap=0.9800 corr_cb=-0.4905 topkJ=0.0035
[TRAIN][ep=040] loss=0.5548 acc=80.81%
[TRAIN][ep=040] mask_avg: mc_mean=0.1438 mb_mean=0.4928 norm_overlap=0.9844 corr_cb=-0.4227
[EPOCH 040/089] train: loss=0.5548 acc=80.81% | val: loss=0.8190 acc=60.24% f1=69.72% auc=59.36% val_score=42.2769 val_score_bestthr=63.3103 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.144, mb=0.493, no=0.984, corr=-0.423) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 63.3103
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.1639 mb_mean=0.4934 norm_overlap=0.9875 corr_cb=-0.3833 topkJ=0.0016
[TRAIN][ep=041] loss=0.5423 acc=81.88%
[TRAIN][ep=041] mask_avg: mc_mean=0.1288 mb_mean=0.4928 norm_overlap=0.9833 corr_cb=-0.4159
[EPOCH 041/089] train: loss=0.5423 acc=81.88% | val: loss=0.8188 acc=56.63% f1=70.00% auc=60.17% val_score=50.6024 val_score_bestthr=62.1241 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.129, mb=0.493, no=0.983, corr=-0.416) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 62.1241
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.1954 mb_mean=0.4932 norm_overlap=0.9839 corr_cb=-0.5190 topkJ=0.0008
[TRAIN][ep=042] loss=0.5608 acc=79.46%
[TRAIN][ep=042] mask_avg: mc_mean=0.1284 mb_mean=0.4928 norm_overlap=0.9833 corr_cb=-0.4136
[EPOCH 042/089] train: loss=0.5608 acc=79.46% | val: loss=0.7932 acc=60.24% f1=69.16% auc=59.83% val_score=51.1190 val_score_bestthr=65.2339 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.128, mb=0.493, no=0.983, corr=-0.414) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 65.2339
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.1144 mb_mean=0.4932 norm_overlap=0.9789 corr_cb=-0.4357 topkJ=0.0016
[TRAIN][ep=043] loss=0.5396 acc=79.46%
[TRAIN][ep=043] mask_avg: mc_mean=0.1363 mb_mean=0.4928 norm_overlap=0.9837 corr_cb=-0.4198
[EPOCH 043/089] train: loss=0.5396 acc=79.46% | val: loss=0.9056 acc=54.22% f1=66.67% auc=60.41% val_score=44.3663 val_score_bestthr=57.5933 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.136, mb=0.493, no=0.984, corr=-0.420) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 57.5933
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.1521 mb_mean=0.4931 norm_overlap=0.9845 corr_cb=-0.4420 topkJ=0.0020
[TRAIN][ep=044] loss=0.5560 acc=80.27%
[TRAIN][ep=044] mask_avg: mc_mean=0.1157 mb_mean=0.4928 norm_overlap=0.9827 corr_cb=-0.3988
[EPOCH 044/089] train: loss=0.5560 acc=80.27% | val: loss=0.7996 acc=60.24% f1=69.72% auc=60.17% val_score=51.1251 val_score_bestthr=60.6347 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.116, mb=0.493, no=0.983, corr=-0.399) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 60.6347
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.1176 mb_mean=0.4935 norm_overlap=0.9872 corr_cb=-0.3634 topkJ=0.0032
[TRAIN][ep=045] loss=0.5218 acc=81.61%
[TRAIN][ep=045] mask_avg: mc_mean=0.1385 mb_mean=0.4928 norm_overlap=0.9840 corr_cb=-0.4098
[EPOCH 045/089] train: loss=0.5218 acc=81.61% | val: loss=0.8587 acc=60.24% f1=67.96% auc=59.53% val_score=51.0146 val_score_bestthr=59.9950 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.138, mb=0.493, no=0.984, corr=-0.410) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 59.9950
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.1758 mb_mean=0.4928 norm_overlap=0.9837 corr_cb=-0.4432 topkJ=0.0039
[TRAIN][ep=046] loss=0.5228 acc=80.13%
[TRAIN][ep=046] mask_avg: mc_mean=0.1610 mb_mean=0.4928 norm_overlap=0.9854 corr_cb=-0.4150
[EPOCH 046/089] train: loss=0.5228 acc=80.13% | val: loss=0.8181 acc=61.45% f1=70.37% auc=61.22% val_score=47.9652 val_score_bestthr=63.2920 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.161, mb=0.493, no=0.985, corr=-0.415) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 63.2920
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.1077 mb_mean=0.4929 norm_overlap=0.9779 corr_cb=-0.4467 topkJ=0.0012
[TRAIN][ep=047] loss=0.5358 acc=79.73%
[TRAIN][ep=047] mask_avg: mc_mean=0.1344 mb_mean=0.4928 norm_overlap=0.9838 corr_cb=-0.4072
[EPOCH 047/089] train: loss=0.5358 acc=79.73% | val: loss=0.8399 acc=59.04% f1=69.09% auc=60.12% val_score=51.4002 val_score_bestthr=60.6548 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.134, mb=0.493, no=0.984, corr=-0.407) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 60.6548
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.1561 mb_mean=0.4913 norm_overlap=0.9906 corr_cb=-0.3396 topkJ=0.0109
[TRAIN][ep=048] loss=0.5336 acc=81.21%
[TRAIN][ep=048] mask_avg: mc_mean=0.1355 mb_mean=0.4928 norm_overlap=0.9844 corr_cb=-0.3977
[EPOCH 048/089] train: loss=0.5336 acc=81.21% | val: loss=0.8256 acc=61.45% f1=69.81% auc=60.76% val_score=59.4776 val_score_bestthr=67.5295 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.135, mb=0.493, no=0.984, corr=-0.398) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 66.3367 -> 67.5295
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=049] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.0871 mb_mean=0.4987 norm_overlap=0.9742 corr_cb=-0.5337 topkJ=0.0019
[TRAIN][ep=049] loss=0.5785 acc=82.82%
[TRAIN][ep=049] mask_avg: mc_mean=0.1469 mb_mean=0.4928 norm_overlap=0.9848 corr_cb=-0.4042
[EPOCH 049/089] train: loss=0.5785 acc=82.82% | val: loss=0.8576 acc=60.24% f1=66.67% auc=60.76% val_score=51.1033 val_score_bestthr=63.0921 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.147, mb=0.493, no=0.985, corr=-0.404) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 63.0921
[DBG][ep=050] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.1468 mb_mean=0.4892 norm_overlap=0.9905 corr_cb=-0.2831 topkJ=0.0230
[TRAIN][ep=050] loss=0.4948 acc=85.64%
[TRAIN][ep=050] mask_avg: mc_mean=0.1190 mb_mean=0.4928 norm_overlap=0.9835 corr_cb=-0.3854
[EPOCH 050/089] train: loss=0.4948 acc=85.64% | val: loss=0.8352 acc=60.24% f1=67.33% auc=60.35% val_score=49.7252 val_score_bestthr=62.5513 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.984, corr=-0.385) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 62.5513
[DBG][ep=051] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.1244 mb_mean=0.4934 norm_overlap=0.9812 corr_cb=-0.4375 topkJ=0.0045
[TRAIN][ep=051] loss=0.4747 acc=86.31%
[TRAIN][ep=051] mask_avg: mc_mean=0.1191 mb_mean=0.4928 norm_overlap=0.9832 corr_cb=-0.3899
[EPOCH 051/089] train: loss=0.4747 acc=86.31% | val: loss=0.8427 acc=60.24% f1=67.33% auc=60.52% val_score=49.7252 val_score_bestthr=62.5513 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.983, corr=-0.390) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 62.5513
[DBG][ep=052] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.1557 mb_mean=0.4942 norm_overlap=0.9772 corr_cb=-0.4894 topkJ=0.0048
[TRAIN][ep=052] loss=0.4762 acc=85.10%
[TRAIN][ep=052] mask_avg: mc_mean=0.1191 mb_mean=0.4928 norm_overlap=0.9835 corr_cb=-0.3842
[EPOCH 052/089] train: loss=0.4762 acc=85.10% | val: loss=0.8484 acc=61.45% f1=68.63% auc=60.41% val_score=49.5843 val_score_bestthr=61.0714 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.984, corr=-0.384) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 61.0714
[DBG][ep=053] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.1560 mb_mean=0.4891 norm_overlap=0.9884 corr_cb=-0.3538 topkJ=0.0086
[TRAIN][ep=053] loss=0.4788 acc=83.09%
[TRAIN][ep=053] mask_avg: mc_mean=0.1191 mb_mean=0.4928 norm_overlap=0.9834 corr_cb=-0.3870
[EPOCH 053/089] train: loss=0.4788 acc=83.09% | val: loss=0.8538 acc=61.45% f1=68.63% auc=60.47% val_score=49.4228 val_score_bestthr=61.0714 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.983, corr=-0.387) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 61.0714
[DBG][ep=054] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=054] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=054] mask(step0): mc_mean=0.1401 mb_mean=0.4947 norm_overlap=0.9781 corr_cb=-0.4860 topkJ=0.0008
[TRAIN][ep=054] loss=0.4813 acc=83.76%
[TRAIN][ep=054] mask_avg: mc_mean=0.1190 mb_mean=0.4928 norm_overlap=0.9835 corr_cb=-0.3865
[EPOCH 054/089] train: loss=0.4813 acc=83.76% | val: loss=0.8591 acc=59.04% f1=69.09% auc=60.00% val_score=49.4228 val_score_bestthr=60.6548 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.983, corr=-0.387) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 60.6548
[DBG][ep=055] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=055] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=055] mask(step0): mc_mean=0.1401 mb_mean=0.4973 norm_overlap=0.9753 corr_cb=-0.5114 topkJ=0.0028
[TRAIN][ep=055] loss=0.4737 acc=84.97%
[TRAIN][ep=055] mask_avg: mc_mean=0.1190 mb_mean=0.4928 norm_overlap=0.9833 corr_cb=-0.3895
[EPOCH 055/089] train: loss=0.4737 acc=84.97% | val: loss=0.8654 acc=59.04% f1=69.09% auc=60.06% val_score=49.4228 val_score_bestthr=60.6548 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.983, corr=-0.390) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 60.6548
[DBG][ep=056] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=056] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=056] mask(step0): mc_mean=0.0885 mb_mean=0.4947 norm_overlap=0.9786 corr_cb=-0.4693 topkJ=0.0047
[TRAIN][ep=056] loss=0.4649 acc=85.64%
[TRAIN][ep=056] mask_avg: mc_mean=0.1191 mb_mean=0.4928 norm_overlap=0.9833 corr_cb=-0.3902
[EPOCH 056/089] train: loss=0.4649 acc=85.64% | val: loss=0.8713 acc=57.83% f1=68.47% auc=60.12% val_score=49.4228 val_score_bestthr=59.5567 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.983, corr=-0.390) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 59.5567
[DBG][ep=057] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=057] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=057] mask(step0): mc_mean=0.1209 mb_mean=0.4919 norm_overlap=0.9771 corr_cb=-0.5215 topkJ=0.0024
[TRAIN][ep=057] loss=0.4673 acc=85.77%
[TRAIN][ep=057] mask_avg: mc_mean=0.1191 mb_mean=0.4928 norm_overlap=0.9835 corr_cb=-0.3868
[EPOCH 057/089] train: loss=0.4673 acc=85.77% | val: loss=0.8718 acc=59.04% f1=69.09% auc=59.88% val_score=49.4228 val_score_bestthr=60.6548 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.983, corr=-0.387) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 60.6548
[DBG][ep=058] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=058] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=058] mask(step0): mc_mean=0.1333 mb_mean=0.4906 norm_overlap=0.9845 corr_cb=-0.3151 topkJ=0.0060
[TRAIN][ep=058] loss=0.4691 acc=85.64%
[TRAIN][ep=058] mask_avg: mc_mean=0.1191 mb_mean=0.4928 norm_overlap=0.9835 corr_cb=-0.3873
[EPOCH 058/089] train: loss=0.4691 acc=85.64% | val: loss=0.8776 acc=59.04% f1=69.09% auc=60.12% val_score=49.4228 val_score_bestthr=60.6548 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.983, corr=-0.387) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 60.6548
[DBG][ep=059] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=059] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=059] mask(step0): mc_mean=0.1112 mb_mean=0.4954 norm_overlap=0.9824 corr_cb=-0.4394 topkJ=0.0039
[TRAIN][ep=059] loss=0.4708 acc=84.70%
[TRAIN][ep=059] mask_avg: mc_mean=0.1191 mb_mean=0.4928 norm_overlap=0.9834 corr_cb=-0.3879
[EPOCH 059/089] train: loss=0.4708 acc=84.70% | val: loss=0.8916 acc=57.83% f1=68.47% auc=60.29% val_score=43.2858 val_score_bestthr=59.5567 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.983, corr=-0.388) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 59.5567
[DBG][ep=060] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=060] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=060] mask(step0): mc_mean=0.1486 mb_mean=0.4903 norm_overlap=0.9880 corr_cb=-0.3275 topkJ=0.0146
[TRAIN][ep=060] loss=0.4641 acc=85.10%
[TRAIN][ep=060] mask_avg: mc_mean=0.1190 mb_mean=0.4928 norm_overlap=0.9834 corr_cb=-0.3884
[EPOCH 060/089] train: loss=0.4641 acc=85.10% | val: loss=0.8807 acc=57.83% f1=67.89% auc=59.83% val_score=50.7208 val_score_bestthr=62.9297 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.983, corr=-0.388) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 62.9297
[DBG][ep=061] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=061] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=061] mask(step0): mc_mean=0.1177 mb_mean=0.4946 norm_overlap=0.9830 corr_cb=-0.3325 topkJ=0.0122
[TRAIN][ep=061] loss=0.4638 acc=85.37%
[TRAIN][ep=061] mask_avg: mc_mean=0.1190 mb_mean=0.4928 norm_overlap=0.9836 corr_cb=-0.3860
[EPOCH 061/089] train: loss=0.4638 acc=85.37% | val: loss=0.9066 acc=57.83% f1=68.47% auc=60.58% val_score=43.2858 val_score_bestthr=59.5567 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.984, corr=-0.386) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 59.5567
[DBG][ep=062] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=062] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=062] mask(step0): mc_mean=0.0989 mb_mean=0.4954 norm_overlap=0.9814 corr_cb=-0.3944 topkJ=0.0039
[TRAIN][ep=062] loss=0.4601 acc=86.17%
[TRAIN][ep=062] mask_avg: mc_mean=0.1191 mb_mean=0.4928 norm_overlap=0.9835 corr_cb=-0.3861
[EPOCH 062/089] train: loss=0.4601 acc=86.17% | val: loss=0.8962 acc=57.83% f1=67.89% auc=60.23% val_score=50.2633 val_score_bestthr=62.9297 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.984, corr=-0.386) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 62.9297
[DBG][ep=063] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=063] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=063] mask(step0): mc_mean=0.1589 mb_mean=0.4933 norm_overlap=0.9860 corr_cb=-0.3757 topkJ=0.0031
[TRAIN][ep=063] loss=0.4616 acc=84.83%
[TRAIN][ep=063] mask_avg: mc_mean=0.1190 mb_mean=0.4928 norm_overlap=0.9836 corr_cb=-0.3834
[EPOCH 063/089] train: loss=0.4616 acc=84.83% | val: loss=0.8949 acc=59.04% f1=68.52% auc=60.29% val_score=50.2633 val_score_bestthr=64.4288 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.984, corr=-0.383) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 64.4288
[DBG][ep=064] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=064] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=064] mask(step0): mc_mean=0.1102 mb_mean=0.4912 norm_overlap=0.9884 corr_cb=-0.3014 topkJ=0.0185
[TRAIN][ep=064] loss=0.4637 acc=84.83%
[TRAIN][ep=064] mask_avg: mc_mean=0.1191 mb_mean=0.4928 norm_overlap=0.9835 corr_cb=-0.3850
[EPOCH 064/089] train: loss=0.4637 acc=84.83% | val: loss=0.9079 acc=57.83% f1=68.47% auc=60.41% val_score=43.2858 val_score_bestthr=59.5567 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.983, corr=-0.385) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 59.5567
[DBG][ep=065] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=065] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=065] mask(step0): mc_mean=0.1327 mb_mean=0.4916 norm_overlap=0.9858 corr_cb=-0.3382 topkJ=0.0047
[TRAIN][ep=065] loss=0.4545 acc=86.31%
[TRAIN][ep=065] mask_avg: mc_mean=0.1190 mb_mean=0.4928 norm_overlap=0.9834 corr_cb=-0.3871
[EPOCH 065/089] train: loss=0.4545 acc=86.31% | val: loss=0.8978 acc=57.83% f1=67.89% auc=60.00% val_score=49.4228 val_score_bestthr=62.9297 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.983, corr=-0.387) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 62.9297
[DBG][ep=066] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=066] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=066] mask(step0): mc_mean=0.0922 mb_mean=0.4938 norm_overlap=0.9887 corr_cb=-0.2640 topkJ=0.0125
[TRAIN][ep=066] loss=0.4558 acc=85.37%
[TRAIN][ep=066] mask_avg: mc_mean=0.1190 mb_mean=0.4928 norm_overlap=0.9834 corr_cb=-0.3865
[EPOCH 066/089] train: loss=0.4558 acc=85.37% | val: loss=0.9644 acc=60.24% f1=65.98% auc=60.99% val_score=50.5800 val_score_bestthr=59.4201 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.983, corr=-0.387) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 59.4201
[DBG][ep=067] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=067] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=067] mask(step0): mc_mean=0.0990 mb_mean=0.4953 norm_overlap=0.9802 corr_cb=-0.4532 topkJ=0.0024
[TRAIN][ep=067] loss=0.4612 acc=85.91%
[TRAIN][ep=067] mask_avg: mc_mean=0.1191 mb_mean=0.4928 norm_overlap=0.9834 corr_cb=-0.3876
[EPOCH 067/089] train: loss=0.4612 acc=85.91% | val: loss=0.9099 acc=57.83% f1=68.47% auc=60.41% val_score=49.4228 val_score_bestthr=59.5567 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.983, corr=-0.388) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 59.5567
[DBG][ep=068] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=068] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=068] mask(step0): mc_mean=0.1154 mb_mean=0.4925 norm_overlap=0.9811 corr_cb=-0.3937 topkJ=0.0229
[TRAIN][ep=068] loss=0.4527 acc=85.77%
[TRAIN][ep=068] mask_avg: mc_mean=0.1190 mb_mean=0.4928 norm_overlap=0.9833 corr_cb=-0.3885
[EPOCH 068/089] train: loss=0.4527 acc=85.77% | val: loss=0.9097 acc=59.04% f1=67.92% auc=60.29% val_score=49.4228 val_score_bestthr=60.4580 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.983, corr=-0.388) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 60.4580
[DBG][ep=069] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=069] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=069] mask(step0): mc_mean=0.1203 mb_mean=0.4924 norm_overlap=0.9801 corr_cb=-0.4279 topkJ=0.0036
[TRAIN][ep=069] loss=0.4506 acc=86.44%
[TRAIN][ep=069] mask_avg: mc_mean=0.1191 mb_mean=0.4928 norm_overlap=0.9834 corr_cb=-0.3883
[EPOCH 069/089] train: loss=0.4506 acc=86.44% | val: loss=0.9107 acc=57.83% f1=67.89% auc=60.23% val_score=48.1986 val_score_bestthr=62.9297 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.983, corr=-0.388) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 62.9297
[DBG][ep=070] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=070] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=070] mask(step0): mc_mean=0.0894 mb_mean=0.4930 norm_overlap=0.9854 corr_cb=-0.3536 topkJ=0.0092
[TRAIN][ep=070] loss=0.4494 acc=86.71%
[TRAIN][ep=070] mask_avg: mc_mean=0.1191 mb_mean=0.4928 norm_overlap=0.9836 corr_cb=-0.3825
[EPOCH 070/089] train: loss=0.4494 acc=86.71% | val: loss=0.9330 acc=60.24% f1=67.96% auc=60.76% val_score=43.2858 val_score_bestthr=60.6866 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.984, corr=-0.382) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 60.6866
[DBG][ep=071] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=071] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=071] mask(step0): mc_mean=0.0999 mb_mean=0.4937 norm_overlap=0.9851 corr_cb=-0.3656 topkJ=0.0068
[TRAIN][ep=071] loss=0.4542 acc=85.77%
[TRAIN][ep=071] mask_avg: mc_mean=0.1191 mb_mean=0.4928 norm_overlap=0.9836 corr_cb=-0.3838
[EPOCH 071/089] train: loss=0.4542 acc=85.77% | val: loss=0.9131 acc=60.24% f1=67.96% auc=60.23% val_score=52.6524 val_score_bestthr=60.6866 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.984, corr=-0.384) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 60.6866
[DBG][ep=072] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=072] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=072] mask(step0): mc_mean=0.0944 mb_mean=0.4946 norm_overlap=0.9887 corr_cb=-0.2761 topkJ=0.0263
[TRAIN][ep=072] loss=0.4494 acc=86.04%
[TRAIN][ep=072] mask_avg: mc_mean=0.1191 mb_mean=0.4928 norm_overlap=0.9836 corr_cb=-0.3842
[EPOCH 072/089] train: loss=0.4494 acc=86.04% | val: loss=0.9374 acc=60.24% f1=67.33% auc=60.99% val_score=46.4253 val_score_bestthr=61.6745 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.984, corr=-0.384) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 61.6745
[DBG][ep=073] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=073] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=073] mask(step0): mc_mean=0.0823 mb_mean=0.4932 norm_overlap=0.9837 corr_cb=-0.3765 topkJ=0.0075
[TRAIN][ep=073] loss=0.4493 acc=86.58%
[TRAIN][ep=073] mask_avg: mc_mean=0.1191 mb_mean=0.4928 norm_overlap=0.9836 corr_cb=-0.3832
[EPOCH 073/089] train: loss=0.4493 acc=86.58% | val: loss=0.9294 acc=60.24% f1=67.96% auc=60.93% val_score=49.4228 val_score_bestthr=60.6866 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.984, corr=-0.383) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 60.6866
[DBG][ep=074] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=074] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=074] mask(step0): mc_mean=0.1340 mb_mean=0.4920 norm_overlap=0.9856 corr_cb=-0.3774 topkJ=0.0135
[TRAIN][ep=074] loss=0.4489 acc=85.77%
[TRAIN][ep=074] mask_avg: mc_mean=0.1191 mb_mean=0.4928 norm_overlap=0.9835 corr_cb=-0.3864
[EPOCH 074/089] train: loss=0.4489 acc=85.77% | val: loss=0.9223 acc=60.24% f1=67.96% auc=60.76% val_score=49.4228 val_score_bestthr=60.6866 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.983, corr=-0.386) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 60.6866
[DBG][ep=075] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=075] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=075] mask(step0): mc_mean=0.0996 mb_mean=0.4940 norm_overlap=0.9854 corr_cb=-0.3596 topkJ=0.0075
[TRAIN][ep=075] loss=0.4462 acc=86.04%
[TRAIN][ep=075] mask_avg: mc_mean=0.1191 mb_mean=0.4928 norm_overlap=0.9834 corr_cb=-0.3867
[EPOCH 075/089] train: loss=0.4462 acc=86.04% | val: loss=0.9241 acc=57.83% f1=67.89% auc=60.52% val_score=52.6524 val_score_bestthr=62.9297 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.983, corr=-0.387) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 62.9297
[DBG][ep=076] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=076] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=076] mask(step0): mc_mean=0.1134 mb_mean=0.4945 norm_overlap=0.9833 corr_cb=-0.4071 topkJ=0.0032
[TRAIN][ep=076] loss=0.4440 acc=85.64%
[TRAIN][ep=076] mask_avg: mc_mean=0.1190 mb_mean=0.4928 norm_overlap=0.9833 corr_cb=-0.3882
[EPOCH 076/089] train: loss=0.4440 acc=85.64% | val: loss=0.9282 acc=57.83% f1=67.89% auc=60.76% val_score=50.1798 val_score_bestthr=62.9297 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.983, corr=-0.388) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 62.9297
[DBG][ep=077] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=077] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=077] mask(step0): mc_mean=0.1266 mb_mean=0.4921 norm_overlap=0.9784 corr_cb=-0.4831 topkJ=0.0024
[TRAIN][ep=077] loss=0.4418 acc=86.44%
[TRAIN][ep=077] mask_avg: mc_mean=0.1191 mb_mean=0.4928 norm_overlap=0.9834 corr_cb=-0.3866
[EPOCH 077/089] train: loss=0.4418 acc=86.44% | val: loss=0.9305 acc=57.83% f1=67.89% auc=60.81% val_score=52.6524 val_score_bestthr=62.9297 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.983, corr=-0.387) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 62.9297
[DBG][ep=078] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=078] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=078] mask(step0): mc_mean=0.1349 mb_mean=0.4889 norm_overlap=0.9836 corr_cb=-0.3966 topkJ=0.0050
[TRAIN][ep=078] loss=0.4430 acc=86.31%
[TRAIN][ep=078] mask_avg: mc_mean=0.1190 mb_mean=0.4928 norm_overlap=0.9834 corr_cb=-0.3868
[EPOCH 078/089] train: loss=0.4430 acc=86.31% | val: loss=0.9328 acc=57.83% f1=67.89% auc=60.76% val_score=51.9342 val_score_bestthr=62.9297 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.983, corr=-0.387) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 62.9297
[EARLY STOP] no improvement for 30 epochs. best_epoch=48
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
=============== FIT DONE ===============
[BEST] epoch=48 | val_acc=61.45% | val_f1=69.81% | val_auc=60.76% | val_score=59.4776 | val_score_bestthr=67.5295
[TEST@BEST] thr_used=0.290 | acc=60.87% f1=68.97% auc=69.62% | SP_sex=0.93% EO_sex=2.05% SP_age=12.99% EO_age=17.47%
[TIME] 1.93 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/summary_fold_1.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4925 mb_mean=0.4923 norm_overlap=1.0000 corr_cb=-0.0375 topkJ=0.0351
[TRAIN][ep=000] loss=0.6931 acc=51.01%
[TRAIN][ep=000] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0408
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4947 mb_mean=0.4925 norm_overlap=1.0000 corr_cb=0.0200 topkJ=0.0582
[TRAIN][ep=001] loss=0.6908 acc=53.02%
[TRAIN][ep=001] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0417
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4934 mb_mean=0.4912 norm_overlap=1.0000 corr_cb=-0.0761 topkJ=0.0212
[TRAIN][ep=002] loss=0.6911 acc=49.66%
[TRAIN][ep=002] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0335
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4946 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=0.0005 topkJ=0.0158
[TRAIN][ep=003] loss=0.6896 acc=55.97%
[TRAIN][ep=003] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0421
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4921 mb_mean=0.4935 norm_overlap=1.0000 corr_cb=0.0308 topkJ=0.0456
[TRAIN][ep=004] loss=0.6890 acc=57.05%
[TRAIN][ep=004] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0492
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4956 mb_mean=0.4905 norm_overlap=1.0000 corr_cb=-0.0217 topkJ=0.0255
[TRAIN][ep=005] loss=0.6854 acc=57.72%
[TRAIN][ep=005] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0414
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4955 mb_mean=0.4935 norm_overlap=1.0001 corr_cb=0.1792 topkJ=0.2987
[TRAIN][ep=006] loss=0.6823 acc=57.99%
[TRAIN][ep=006] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0439
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4934 mb_mean=0.4926 norm_overlap=1.0000 corr_cb=0.0730 topkJ=0.0188
[TRAIN][ep=007] loss=0.6802 acc=62.42%
[TRAIN][ep=007] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0419
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4941 mb_mean=0.4951 norm_overlap=1.0000 corr_cb=-0.0577 topkJ=0.0403
[TRAIN][ep=008] loss=0.6804 acc=57.32%
[TRAIN][ep=008] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0461
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4928 mb_mean=0.4945 norm_overlap=1.0001 corr_cb=0.2081 topkJ=0.0622
[TRAIN][ep=009] loss=0.6765 acc=61.21%
[TRAIN][ep=009] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0400
================= FIT START (fold=1) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4924 mb_mean=0.4908 norm_overlap=1.0000 corr_cb=-0.0313 topkJ=0.0382
[TRAIN][ep=000] loss=0.6711 acc=61.74%
[TRAIN][ep=000] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0416
[EPOCH 000/089] train: loss=0.6711 acc=61.74% | val: loss=0.6902 acc=57.83% f1=69.57% auc=52.97% val_score=42.9101 val_score_bestthr=56.8424 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.042) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 56.8424
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4945 mb_mean=0.4932 norm_overlap=1.0000 corr_cb=0.0532 topkJ=0.0351
[TRAIN][ep=001] loss=0.6648 acc=61.34%
[TRAIN][ep=001] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0445
[EPOCH 001/089] train: loss=0.6648 acc=61.34% | val: loss=0.6900 acc=55.42% f1=69.92% auc=52.09% val_score=43.0198 val_score_bestthr=62.6871 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.045) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 56.8424 -> 62.6871
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4957 mb_mean=0.4963 norm_overlap=1.0000 corr_cb=-0.0615 topkJ=0.0282
[TRAIN][ep=002] loss=0.6543 acc=65.23%
[TRAIN][ep=002] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0447
[EPOCH 002/089] train: loss=0.6543 acc=65.23% | val: loss=0.6914 acc=56.63% f1=69.49% auc=53.20% val_score=44.9705 val_score_bestthr=59.2265 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.045) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6871 -> 59.2265
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4968 mb_mean=0.4929 norm_overlap=0.9999 corr_cb=-0.1262 topkJ=0.0038
[TRAIN][ep=003] loss=0.6482 acc=64.30%
[TRAIN][ep=003] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0468
[EPOCH 003/089] train: loss=0.6482 acc=64.30% | val: loss=0.6942 acc=56.63% f1=68.97% auc=53.37% val_score=47.0193 val_score_bestthr=57.0488 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.047) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6871 -> 57.0488
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4915 mb_mean=0.4920 norm_overlap=1.0000 corr_cb=-0.0843 topkJ=0.0088
[TRAIN][ep=004] loss=0.6428 acc=63.36%
[TRAIN][ep=004] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0455
[EPOCH 004/089] train: loss=0.6428 acc=63.36% | val: loss=0.7003 acc=57.83% f1=68.47% auc=53.43% val_score=37.0298 val_score_bestthr=59.5284 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.046) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6871 -> 59.5284
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4942 mb_mean=0.4946 norm_overlap=0.9999 corr_cb=-0.1495 topkJ=0.0119
[TRAIN][ep=005] loss=1.2816 acc=63.89%
[TRAIN][ep=005] mask_avg: mc_mean=0.3719 mb_mean=0.4928 norm_overlap=0.9989 corr_cb=-0.3590
[EPOCH 005/089] train: loss=1.2816 acc=63.89% | val: loss=0.6940 acc=57.83% f1=71.07% auc=54.42% val_score=35.8021 val_score_bestthr=63.1205 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.372, mb=0.493, no=0.999, corr=-0.359) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 62.6871 -> 63.1205
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2629 mb_mean=0.4960 norm_overlap=0.9957 corr_cb=-0.4900 topkJ=0.0031
[TRAIN][ep=006] loss=1.2658 acc=64.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.2319 mb_mean=0.4928 norm_overlap=0.9967 corr_cb=-0.4157
[EPOCH 006/089] train: loss=1.2658 acc=64.70% | val: loss=0.6934 acc=56.63% f1=70.00% auc=54.30% val_score=32.6091 val_score_bestthr=60.1401 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.232, mb=0.493, no=0.997, corr=-0.416) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.1205 -> 60.1401
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.1532 mb_mean=0.4992 norm_overlap=0.9951 corr_cb=-0.4571 topkJ=0.0110
[TRAIN][ep=007] loss=1.2697 acc=64.56%
[TRAIN][ep=007] mask_avg: mc_mean=0.1746 mb_mean=0.4928 norm_overlap=0.9952 corr_cb=-0.4135
[EPOCH 007/089] train: loss=1.2697 acc=64.56% | val: loss=0.7125 acc=56.63% f1=69.49% auc=53.84% val_score=39.5968 val_score_bestthr=58.9833 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.175, mb=0.493, no=0.995, corr=-0.413) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.1205 -> 58.9833
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1547 mb_mean=0.4901 norm_overlap=0.9953 corr_cb=-0.4067 topkJ=0.0141
[TRAIN][ep=008] loss=1.2516 acc=65.64%
[TRAIN][ep=008] mask_avg: mc_mean=0.1345 mb_mean=0.4928 norm_overlap=0.9935 corr_cb=-0.4231
[EPOCH 008/089] train: loss=1.2516 acc=65.64% | val: loss=0.7014 acc=57.83% f1=71.07% auc=54.19% val_score=38.0640 val_score_bestthr=63.1205 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.135, mb=0.493, no=0.994, corr=-0.423) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.1205 -> 63.1205
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.0968 mb_mean=0.4926 norm_overlap=0.9922 corr_cb=-0.3824 topkJ=0.0210
[TRAIN][ep=009] loss=1.2642 acc=63.22%
[TRAIN][ep=009] mask_avg: mc_mean=0.1001 mb_mean=0.4928 norm_overlap=0.9916 corr_cb=-0.4153
[EPOCH 009/089] train: loss=1.2642 acc=63.22% | val: loss=0.7057 acc=56.63% f1=67.86% auc=54.53% val_score=39.3150 val_score_bestthr=58.0319 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.100, mb=0.493, no=0.992, corr=-0.415) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.1205 -> 58.0319
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.0740 mb_mean=0.4963 norm_overlap=0.9912 corr_cb=-0.4517 topkJ=0.0035
[TRAIN][ep=010] loss=1.2557 acc=65.37%
[TRAIN][ep=010] mask_avg: mc_mean=0.0789 mb_mean=0.4928 norm_overlap=0.9903 corr_cb=-0.3958
[EPOCH 010/089] train: loss=1.2557 acc=65.37% | val: loss=0.6998 acc=57.83% f1=70.59% auc=54.53% val_score=49.1388 val_score_bestthr=59.6647 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.079, mb=0.493, no=0.990, corr=-0.396) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.1205 -> 59.6647
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.0572 mb_mean=0.4924 norm_overlap=0.9910 corr_cb=-0.3220 topkJ=0.0132
[TRAIN][ep=011] loss=0.8468 acc=67.38%
[TRAIN][ep=011] mask_avg: mc_mean=0.0681 mb_mean=0.4928 norm_overlap=0.9889 corr_cb=-0.3932
[EPOCH 011/089] train: loss=0.8468 acc=67.38% | val: loss=0.7012 acc=56.63% f1=69.49% auc=54.77% val_score=41.4230 val_score_bestthr=59.2265 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.068, mb=0.493, no=0.989, corr=-0.393) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.1205 -> 59.2265
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.0600 mb_mean=0.4959 norm_overlap=0.9866 corr_cb=-0.4287 topkJ=0.0104
[TRAIN][ep=012] loss=0.7890 acc=70.20%
[TRAIN][ep=012] mask_avg: mc_mean=0.0638 mb_mean=0.4928 norm_overlap=0.9873 corr_cb=-0.3984
[EPOCH 012/089] train: loss=0.7890 acc=70.20% | val: loss=0.7054 acc=59.04% f1=70.69% auc=55.12% val_score=44.6594 val_score_bestthr=61.0958 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.064, mb=0.493, no=0.987, corr=-0.398) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.1205 -> 61.0958
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.0338 mb_mean=0.4973 norm_overlap=0.9832 corr_cb=-0.3876 topkJ=0.0016
[TRAIN][ep=013] loss=0.8032 acc=66.71%
[TRAIN][ep=013] mask_avg: mc_mean=0.0539 mb_mean=0.4928 norm_overlap=0.9855 corr_cb=-0.3833
[EPOCH 013/089] train: loss=0.8032 acc=66.71% | val: loss=0.7041 acc=60.24% f1=67.33% auc=55.58% val_score=42.0277 val_score_bestthr=65.0202 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.054, mb=0.493, no=0.986, corr=-0.383) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 63.1205 -> 65.0202
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.0425 mb_mean=0.4931 norm_overlap=0.9817 corr_cb=-0.4431 topkJ=0.0083
[TRAIN][ep=014] loss=0.7707 acc=70.34%
[TRAIN][ep=014] mask_avg: mc_mean=0.0539 mb_mean=0.4928 norm_overlap=0.9846 corr_cb=-0.3895
[EPOCH 014/089] train: loss=0.7707 acc=70.34% | val: loss=0.7279 acc=56.63% f1=70.49% auc=54.36% val_score=36.0552 val_score_bestthr=64.1779 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.054, mb=0.493, no=0.985, corr=-0.389) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.0202 -> 64.1779
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.0695 mb_mean=0.4915 norm_overlap=0.9896 corr_cb=-0.3667 topkJ=0.0126
[TRAIN][ep=015] loss=0.7747 acc=68.32%
[TRAIN][ep=015] mask_avg: mc_mean=0.0482 mb_mean=0.4928 norm_overlap=0.9828 corr_cb=-0.3743
[EPOCH 015/089] train: loss=0.7747 acc=68.32% | val: loss=0.7278 acc=60.24% f1=70.80% auc=54.24% val_score=47.3350 val_score_bestthr=61.4456 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.048, mb=0.493, no=0.983, corr=-0.374) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.0202 -> 61.4456
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.0511 mb_mean=0.4960 norm_overlap=0.9780 corr_cb=-0.4275 topkJ=0.0008
[TRAIN][ep=016] loss=0.7620 acc=69.80%
[TRAIN][ep=016] mask_avg: mc_mean=0.0597 mb_mean=0.4928 norm_overlap=0.9830 corr_cb=-0.4044
[EPOCH 016/089] train: loss=0.7620 acc=69.80% | val: loss=0.7142 acc=60.24% f1=71.79% auc=55.58% val_score=36.5697 val_score_bestthr=62.2198 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.060, mb=0.493, no=0.983, corr=-0.404) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.0202 -> 62.2198
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.0640 mb_mean=0.4935 norm_overlap=0.9815 corr_cb=-0.4622 topkJ=0.0044
[TRAIN][ep=017] loss=0.7619 acc=69.53%
[TRAIN][ep=017] mask_avg: mc_mean=0.0606 mb_mean=0.4928 norm_overlap=0.9824 corr_cb=-0.4009
[EPOCH 017/089] train: loss=0.7619 acc=69.53% | val: loss=0.7292 acc=60.24% f1=71.79% auc=54.36% val_score=50.2068 val_score_bestthr=62.4506 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.061, mb=0.493, no=0.982, corr=-0.401) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.0202 -> 62.4506
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.0529 mb_mean=0.4913 norm_overlap=0.9865 corr_cb=-0.3116 topkJ=0.0099
[TRAIN][ep=018] loss=0.7471 acc=71.95%
[TRAIN][ep=018] mask_avg: mc_mean=0.0559 mb_mean=0.4928 norm_overlap=0.9815 corr_cb=-0.3936
[EPOCH 018/089] train: loss=0.7471 acc=71.95% | val: loss=0.7178 acc=61.45% f1=71.93% auc=55.17% val_score=46.9059 val_score_bestthr=65.6471 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.056, mb=0.493, no=0.981, corr=-0.394) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 65.0202 -> 65.6471
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.0790 mb_mean=0.4941 norm_overlap=0.9869 corr_cb=-0.3651 topkJ=0.0108
[TRAIN][ep=019] loss=0.7519 acc=70.34%
[TRAIN][ep=019] mask_avg: mc_mean=0.0664 mb_mean=0.4928 norm_overlap=0.9816 corr_cb=-0.4149
[EPOCH 019/089] train: loss=0.7519 acc=70.34% | val: loss=0.7312 acc=61.45% f1=71.93% auc=55.12% val_score=47.3763 val_score_bestthr=65.6471 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.066, mb=0.493, no=0.982, corr=-0.415) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6471 -> 65.6471
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.0916 mb_mean=0.4898 norm_overlap=0.9863 corr_cb=-0.3885 topkJ=0.0054
[TRAIN][ep=020] loss=0.7421 acc=72.89%
[TRAIN][ep=020] mask_avg: mc_mean=0.0749 mb_mean=0.4928 norm_overlap=0.9817 corr_cb=-0.4293
[EPOCH 020/089] train: loss=0.7421 acc=72.89% | val: loss=0.7466 acc=59.04% f1=70.69% auc=56.80% val_score=38.0330 val_score_bestthr=61.0958 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.075, mb=0.493, no=0.982, corr=-0.429) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6471 -> 61.0958
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.0714 mb_mean=0.4926 norm_overlap=0.9847 corr_cb=-0.4475 topkJ=0.0028
[TRAIN][ep=021] loss=0.7298 acc=71.81%
[TRAIN][ep=021] mask_avg: mc_mean=0.0860 mb_mean=0.4928 norm_overlap=0.9822 corr_cb=-0.4401
[EPOCH 021/089] train: loss=0.7298 acc=71.81% | val: loss=0.7930 acc=60.24% f1=71.30% auc=56.51% val_score=44.8751 val_score_bestthr=62.5929 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.086, mb=0.493, no=0.982, corr=-0.440) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6471 -> 62.5929
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.0981 mb_mean=0.4906 norm_overlap=0.9829 corr_cb=-0.4316 topkJ=0.0020
[TRAIN][ep=022] loss=0.8141 acc=71.54%
[TRAIN][ep=022] mask_avg: mc_mean=0.0763 mb_mean=0.4928 norm_overlap=0.9813 corr_cb=-0.4260
[EPOCH 022/089] train: loss=0.8141 acc=71.54% | val: loss=0.7286 acc=60.24% f1=71.30% auc=55.93% val_score=51.9917 val_score_bestthr=63.2773 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.076, mb=0.493, no=0.981, corr=-0.426) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6471 -> 63.2773
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.0684 mb_mean=0.4932 norm_overlap=0.9733 corr_cb=-0.4829 topkJ=0.0023
[TRAIN][ep=023] loss=0.7223 acc=72.89%
[TRAIN][ep=023] mask_avg: mc_mean=0.0795 mb_mean=0.4928 norm_overlap=0.9815 corr_cb=-0.4254
[EPOCH 023/089] train: loss=0.7223 acc=72.89% | val: loss=0.7224 acc=61.45% f1=71.93% auc=55.52% val_score=45.7080 val_score_bestthr=65.6471 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.080, mb=0.493, no=0.981, corr=-0.425) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6471 -> 65.6471
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.0809 mb_mean=0.4927 norm_overlap=0.9824 corr_cb=-0.4641 topkJ=0.0020
[TRAIN][ep=024] loss=0.7142 acc=73.56%
[TRAIN][ep=024] mask_avg: mc_mean=0.0987 mb_mean=0.4928 norm_overlap=0.9825 corr_cb=-0.4440
[EPOCH 024/089] train: loss=0.7142 acc=73.56% | val: loss=0.7141 acc=61.45% f1=71.93% auc=57.09% val_score=50.2239 val_score_bestthr=65.6471 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.099, mb=0.493, no=0.983, corr=-0.444) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6471 -> 65.6471
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.0552 mb_mean=0.4924 norm_overlap=0.9826 corr_cb=-0.3773 topkJ=0.0055
[TRAIN][ep=025] loss=0.7092 acc=72.89%
[TRAIN][ep=025] mask_avg: mc_mean=0.0847 mb_mean=0.4928 norm_overlap=0.9814 corr_cb=-0.4210
[EPOCH 025/089] train: loss=0.7092 acc=72.89% | val: loss=0.7384 acc=60.24% f1=71.30% auc=56.98% val_score=46.6077 val_score_bestthr=63.2773 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.085, mb=0.493, no=0.981, corr=-0.421) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6471 -> 63.2773
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.0965 mb_mean=0.4922 norm_overlap=0.9880 corr_cb=-0.3575 topkJ=0.0069
[TRAIN][ep=026] loss=0.7023 acc=75.17%
[TRAIN][ep=026] mask_avg: mc_mean=0.1138 mb_mean=0.4928 norm_overlap=0.9832 corr_cb=-0.4479
[EPOCH 026/089] train: loss=0.7023 acc=75.17% | val: loss=0.7643 acc=61.45% f1=71.93% auc=57.67% val_score=39.5193 val_score_bestthr=65.6471 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.114, mb=0.493, no=0.983, corr=-0.448) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6471 -> 65.6471
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1418 mb_mean=0.4908 norm_overlap=0.9855 corr_cb=-0.4035 topkJ=0.0028
[TRAIN][ep=027] loss=0.6919 acc=75.70%
[TRAIN][ep=027] mask_avg: mc_mean=0.1042 mb_mean=0.4928 norm_overlap=0.9826 corr_cb=-0.4321
[EPOCH 027/089] train: loss=0.6919 acc=75.70% | val: loss=0.7379 acc=62.65% f1=73.04% auc=58.08% val_score=43.5795 val_score_bestthr=66.3367 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.104, mb=0.493, no=0.983, corr=-0.432) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 65.6471 -> 66.3367
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.0645 mb_mean=0.4955 norm_overlap=0.9775 corr_cb=-0.4154 topkJ=0.0032
[TRAIN][ep=028] loss=0.7701 acc=74.36%
[TRAIN][ep=028] mask_avg: mc_mean=0.0854 mb_mean=0.4928 norm_overlap=0.9811 corr_cb=-0.4048
[EPOCH 028/089] train: loss=0.7701 acc=74.36% | val: loss=0.7446 acc=60.24% f1=71.30% auc=57.38% val_score=38.9983 val_score_bestthr=63.2773 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.085, mb=0.493, no=0.981, corr=-0.405) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 63.2773
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.0793 mb_mean=0.4953 norm_overlap=0.9778 corr_cb=-0.5055 topkJ=0.0004
[TRAIN][ep=029] loss=0.8259 acc=76.78%
[TRAIN][ep=029] mask_avg: mc_mean=0.1178 mb_mean=0.4928 norm_overlap=0.9831 corr_cb=-0.4409
[EPOCH 029/089] train: loss=0.8259 acc=76.78% | val: loss=0.7404 acc=61.45% f1=71.93% auc=56.51% val_score=40.0996 val_score_bestthr=65.6471 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.118, mb=0.493, no=0.983, corr=-0.441) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 65.6471
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.0657 mb_mean=0.4980 norm_overlap=0.9653 corr_cb=-0.5330 topkJ=0.0004
[TRAIN][ep=030] loss=0.9060 acc=74.50%
[TRAIN][ep=030] mask_avg: mc_mean=0.0973 mb_mean=0.4928 norm_overlap=0.9816 corr_cb=-0.4159
[EPOCH 030/089] train: loss=0.9060 acc=74.50% | val: loss=0.7368 acc=61.45% f1=71.93% auc=57.09% val_score=48.7783 val_score_bestthr=65.6471 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.097, mb=0.493, no=0.982, corr=-0.416) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 65.6471
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.1003 mb_mean=0.4927 norm_overlap=0.9771 corr_cb=-0.5100 topkJ=0.0020
[TRAIN][ep=031] loss=0.9934 acc=72.75%
[TRAIN][ep=031] mask_avg: mc_mean=0.0932 mb_mean=0.4928 norm_overlap=0.9813 corr_cb=-0.4113
[EPOCH 031/089] train: loss=0.9934 acc=72.75% | val: loss=0.7713 acc=60.24% f1=70.80% auc=58.14% val_score=42.8562 val_score_bestthr=61.4456 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.093, mb=0.493, no=0.981, corr=-0.411) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 61.4456
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1146 mb_mean=0.4887 norm_overlap=0.9883 corr_cb=-0.2667 topkJ=0.0225
[TRAIN][ep=032] loss=1.0496 acc=75.44%
[TRAIN][ep=032] mask_avg: mc_mean=0.1019 mb_mean=0.4928 norm_overlap=0.9820 corr_cb=-0.4169
[EPOCH 032/089] train: loss=1.0496 acc=75.44% | val: loss=0.7409 acc=60.24% f1=70.80% auc=57.85% val_score=49.2267 val_score_bestthr=61.4456 | dyn(w_pfs=0.100, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.102, mb=0.493, no=0.982, corr=-0.417) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 61.4456
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1063 mb_mean=0.4927 norm_overlap=0.9787 corr_cb=-0.4345 topkJ=0.0039
[TRAIN][ep=033] loss=0.8413 acc=77.18%
[TRAIN][ep=033] mask_avg: mc_mean=0.1076 mb_mean=0.4928 norm_overlap=0.9821 corr_cb=-0.4225
[EPOCH 033/089] train: loss=0.8413 acc=77.18% | val: loss=0.7518 acc=60.24% f1=70.80% auc=58.02% val_score=43.7542 val_score_bestthr=61.4456 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.108, mb=0.493, no=0.982, corr=-0.423) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 61.4456
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1135 mb_mean=0.4908 norm_overlap=0.9867 corr_cb=-0.3526 topkJ=0.0139
[TRAIN][ep=034] loss=0.6474 acc=77.85%
[TRAIN][ep=034] mask_avg: mc_mean=0.1234 mb_mean=0.4928 norm_overlap=0.9832 corr_cb=-0.4296
[EPOCH 034/089] train: loss=0.6474 acc=77.85% | val: loss=0.7787 acc=61.45% f1=70.91% auc=58.14% val_score=46.2955 val_score_bestthr=61.8877 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.123, mb=0.493, no=0.983, corr=-0.430) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 61.8877
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.1331 mb_mean=0.4924 norm_overlap=0.9872 corr_cb=-0.4239 topkJ=0.0048
[TRAIN][ep=035] loss=0.6607 acc=77.18%
[TRAIN][ep=035] mask_avg: mc_mean=0.1111 mb_mean=0.4928 norm_overlap=0.9823 corr_cb=-0.4161
[EPOCH 035/089] train: loss=0.6607 acc=77.18% | val: loss=0.7824 acc=61.45% f1=71.43% auc=57.91% val_score=51.1072 val_score_bestthr=62.5452 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.111, mb=0.493, no=0.982, corr=-0.416) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 62.5452
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.1182 mb_mean=0.4918 norm_overlap=0.9869 corr_cb=-0.3153 topkJ=0.0032
[TRAIN][ep=036] loss=0.6496 acc=76.38%
[TRAIN][ep=036] mask_avg: mc_mean=0.1258 mb_mean=0.4928 norm_overlap=0.9832 corr_cb=-0.4264
[EPOCH 036/089] train: loss=0.6496 acc=76.38% | val: loss=0.7673 acc=60.24% f1=70.80% auc=58.49% val_score=48.0194 val_score_bestthr=61.4456 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.126, mb=0.493, no=0.983, corr=-0.426) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 61.4456
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1359 mb_mean=0.4913 norm_overlap=0.9784 corr_cb=-0.4698 topkJ=0.0000
[TRAIN][ep=037] loss=0.6450 acc=77.72%
[TRAIN][ep=037] mask_avg: mc_mean=0.1270 mb_mean=0.4928 norm_overlap=0.9832 corr_cb=-0.4260
[EPOCH 037/089] train: loss=0.6450 acc=77.72% | val: loss=0.8177 acc=59.04% f1=67.31% auc=59.01% val_score=44.4953 val_score_bestthr=60.0122 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.127, mb=0.493, no=0.983, corr=-0.426) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 60.0122
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.1396 mb_mean=0.4918 norm_overlap=0.9838 corr_cb=-0.4120 topkJ=0.0044
[TRAIN][ep=038] loss=0.6301 acc=77.58%
[TRAIN][ep=038] mask_avg: mc_mean=0.1204 mb_mean=0.4928 norm_overlap=0.9830 corr_cb=-0.4157
[EPOCH 038/089] train: loss=0.6301 acc=77.58% | val: loss=0.7727 acc=60.24% f1=69.16% auc=58.78% val_score=45.7603 val_score_bestthr=61.0111 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.120, mb=0.493, no=0.983, corr=-0.416) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 61.0111
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.1385 mb_mean=0.4933 norm_overlap=0.9763 corr_cb=-0.5291 topkJ=0.0000
[TRAIN][ep=039] loss=0.6228 acc=77.32%
[TRAIN][ep=039] mask_avg: mc_mean=0.1334 mb_mean=0.4928 norm_overlap=0.9835 corr_cb=-0.4257
[EPOCH 039/089] train: loss=0.6228 acc=77.32% | val: loss=0.8521 acc=59.04% f1=67.92% auc=59.65% val_score=47.7707 val_score_bestthr=60.4580 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.133, mb=0.493, no=0.983, corr=-0.426) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 60.4580
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.1341 mb_mean=0.4926 norm_overlap=0.9800 corr_cb=-0.4864 topkJ=0.0035
[TRAIN][ep=040] loss=0.6091 acc=80.54%
[TRAIN][ep=040] mask_avg: mc_mean=0.1378 mb_mean=0.4928 norm_overlap=0.9840 corr_cb=-0.4208
[EPOCH 040/089] train: loss=0.6091 acc=80.54% | val: loss=0.8224 acc=60.24% f1=69.72% auc=59.07% val_score=47.2272 val_score_bestthr=63.3103 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.138, mb=0.493, no=0.984, corr=-0.421) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 63.3103
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.1613 mb_mean=0.4934 norm_overlap=0.9875 corr_cb=-0.3829 topkJ=0.0024
[TRAIN][ep=041] loss=0.5965 acc=81.74%
[TRAIN][ep=041] mask_avg: mc_mean=0.1261 mb_mean=0.4928 norm_overlap=0.9832 corr_cb=-0.4146
[EPOCH 041/089] train: loss=0.5965 acc=81.74% | val: loss=0.8235 acc=56.63% f1=70.00% auc=59.59% val_score=49.4714 val_score_bestthr=62.1241 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.126, mb=0.493, no=0.983, corr=-0.415) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 62.1241
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.1907 mb_mean=0.4932 norm_overlap=0.9838 corr_cb=-0.5136 topkJ=0.0008
[TRAIN][ep=042] loss=0.6150 acc=79.46%
[TRAIN][ep=042] mask_avg: mc_mean=0.1239 mb_mean=0.4928 norm_overlap=0.9831 corr_cb=-0.4114
[EPOCH 042/089] train: loss=0.6150 acc=79.46% | val: loss=0.7986 acc=60.24% f1=69.16% auc=59.42% val_score=50.2633 val_score_bestthr=65.2339 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.124, mb=0.493, no=0.983, corr=-0.411) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 65.2339
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.1139 mb_mean=0.4932 norm_overlap=0.9790 corr_cb=-0.4343 topkJ=0.0012
[TRAIN][ep=043] loss=0.5938 acc=79.87%
[TRAIN][ep=043] mask_avg: mc_mean=0.1346 mb_mean=0.4928 norm_overlap=0.9836 corr_cb=-0.4202
[EPOCH 043/089] train: loss=0.5938 acc=79.87% | val: loss=0.9100 acc=54.22% f1=66.67% auc=59.77% val_score=45.9923 val_score_bestthr=57.5933 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.135, mb=0.493, no=0.984, corr=-0.420) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 57.5933
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.1477 mb_mean=0.4931 norm_overlap=0.9843 corr_cb=-0.4421 topkJ=0.0020
[TRAIN][ep=044] loss=0.6109 acc=80.13%
[TRAIN][ep=044] mask_avg: mc_mean=0.1123 mb_mean=0.4928 norm_overlap=0.9824 corr_cb=-0.3979
[EPOCH 044/089] train: loss=0.6109 acc=80.13% | val: loss=0.8035 acc=60.24% f1=69.72% auc=59.65% val_score=49.4714 val_score_bestthr=60.6347 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.112, mb=0.493, no=0.982, corr=-0.398) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 60.6347
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.1130 mb_mean=0.4935 norm_overlap=0.9869 corr_cb=-0.3653 topkJ=0.0036
[TRAIN][ep=045] loss=0.5761 acc=81.34%
[TRAIN][ep=045] mask_avg: mc_mean=0.1348 mb_mean=0.4928 norm_overlap=0.9838 corr_cb=-0.4096
[EPOCH 045/089] train: loss=0.5761 acc=81.34% | val: loss=0.8649 acc=59.04% f1=67.92% auc=58.90% val_score=52.1346 val_score_bestthr=62.0136 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.135, mb=0.493, no=0.984, corr=-0.410) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 62.0136
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.1728 mb_mean=0.4928 norm_overlap=0.9833 corr_cb=-0.4460 topkJ=0.0039
[TRAIN][ep=046] loss=0.5771 acc=79.87%
[TRAIN][ep=046] mask_avg: mc_mean=0.1579 mb_mean=0.4928 norm_overlap=0.9852 corr_cb=-0.4171
[EPOCH 046/089] train: loss=0.5771 acc=79.87% | val: loss=0.8206 acc=61.45% f1=70.37% auc=60.87% val_score=47.9652 val_score_bestthr=63.2920 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.158, mb=0.493, no=0.985, corr=-0.417) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 63.2920
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.1055 mb_mean=0.4929 norm_overlap=0.9779 corr_cb=-0.4405 topkJ=0.0012
[TRAIN][ep=047] loss=0.5906 acc=80.00%
[TRAIN][ep=047] mask_avg: mc_mean=0.1303 mb_mean=0.4928 norm_overlap=0.9836 corr_cb=-0.4066
[EPOCH 047/089] train: loss=0.5906 acc=80.00% | val: loss=0.8437 acc=57.83% f1=67.89% auc=59.83% val_score=48.4714 val_score_bestthr=62.9297 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.130, mb=0.493, no=0.984, corr=-0.407) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 62.9297
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.1512 mb_mean=0.4913 norm_overlap=0.9901 corr_cb=-0.3488 topkJ=0.0101
[TRAIN][ep=048] loss=0.5882 acc=81.48%
[TRAIN][ep=048] mask_avg: mc_mean=0.1320 mb_mean=0.4928 norm_overlap=0.9841 corr_cb=-0.3991
[EPOCH 048/089] train: loss=0.5882 acc=81.48% | val: loss=0.8310 acc=61.45% f1=69.81% auc=60.70% val_score=59.4776 val_score_bestthr=67.5295 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.132, mb=0.493, no=0.984, corr=-0.399) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 66.3367 -> 67.5295
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=049] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.0855 mb_mean=0.4987 norm_overlap=0.9738 corr_cb=-0.5363 topkJ=0.0015
[TRAIN][ep=049] loss=0.6327 acc=82.82%
[TRAIN][ep=049] mask_avg: mc_mean=0.1442 mb_mean=0.4928 norm_overlap=0.9846 corr_cb=-0.4057
[EPOCH 049/089] train: loss=0.6327 acc=82.82% | val: loss=0.8605 acc=60.24% f1=66.67% auc=60.29% val_score=48.4456 val_score_bestthr=63.0921 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.144, mb=0.493, no=0.985, corr=-0.406) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 63.0921
[DBG][ep=050] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.1406 mb_mean=0.4892 norm_overlap=0.9905 corr_cb=-0.2777 topkJ=0.0230
[TRAIN][ep=050] loss=0.5496 acc=85.50%
[TRAIN][ep=050] mask_avg: mc_mean=0.1153 mb_mean=0.4928 norm_overlap=0.9832 corr_cb=-0.3845
[EPOCH 050/089] train: loss=0.5496 acc=85.50% | val: loss=0.8390 acc=59.04% f1=66.00% auc=59.88% val_score=46.1498 val_score_bestthr=63.1073 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.115, mb=0.493, no=0.983, corr=-0.384) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 63.1073
[DBG][ep=051] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.1200 mb_mean=0.4934 norm_overlap=0.9809 corr_cb=-0.4377 topkJ=0.0041
[TRAIN][ep=051] loss=0.5295 acc=85.64%
[TRAIN][ep=051] mask_avg: mc_mean=0.1153 mb_mean=0.4928 norm_overlap=0.9830 corr_cb=-0.3890
[EPOCH 051/089] train: loss=0.5295 acc=85.64% | val: loss=0.8459 acc=59.04% f1=69.09% auc=59.65% val_score=45.0506 val_score_bestthr=60.6548 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.115, mb=0.493, no=0.983, corr=-0.389) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 60.6548
[DBG][ep=052] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.1511 mb_mean=0.4942 norm_overlap=0.9769 corr_cb=-0.4893 topkJ=0.0044
[TRAIN][ep=052] loss=0.5309 acc=84.97%
[TRAIN][ep=052] mask_avg: mc_mean=0.1153 mb_mean=0.4928 norm_overlap=0.9833 corr_cb=-0.3834
[EPOCH 052/089] train: loss=0.5309 acc=84.97% | val: loss=0.8522 acc=60.24% f1=67.33% auc=60.29% val_score=49.5843 val_score_bestthr=62.5513 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.115, mb=0.493, no=0.983, corr=-0.383) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 62.5513
[DBG][ep=053] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.1524 mb_mean=0.4891 norm_overlap=0.9883 corr_cb=-0.3538 topkJ=0.0086
[TRAIN][ep=053] loss=0.5336 acc=83.22%
[TRAIN][ep=053] mask_avg: mc_mean=0.1153 mb_mean=0.4928 norm_overlap=0.9831 corr_cb=-0.3861
[EPOCH 053/089] train: loss=0.5336 acc=83.22% | val: loss=0.8580 acc=60.24% f1=67.33% auc=60.17% val_score=49.4228 val_score_bestthr=62.5513 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.115, mb=0.493, no=0.983, corr=-0.386) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 62.5513
[DBG][ep=054] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=054] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=054] mask(step0): mc_mean=0.1376 mb_mean=0.4947 norm_overlap=0.9778 corr_cb=-0.4879 topkJ=0.0008
[TRAIN][ep=054] loss=0.5361 acc=83.62%
[TRAIN][ep=054] mask_avg: mc_mean=0.1152 mb_mean=0.4928 norm_overlap=0.9832 corr_cb=-0.3857
[EPOCH 054/089] train: loss=0.5361 acc=83.62% | val: loss=0.8630 acc=57.83% f1=67.89% auc=59.77% val_score=49.4228 val_score_bestthr=62.9297 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.115, mb=0.493, no=0.983, corr=-0.386) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 62.9297
[DBG][ep=055] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=055] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=055] mask(step0): mc_mean=0.1358 mb_mean=0.4973 norm_overlap=0.9749 corr_cb=-0.5121 topkJ=0.0028
[TRAIN][ep=055] loss=0.5287 acc=85.10%
[TRAIN][ep=055] mask_avg: mc_mean=0.1153 mb_mean=0.4928 norm_overlap=0.9830 corr_cb=-0.3885
[EPOCH 055/089] train: loss=0.5287 acc=85.10% | val: loss=0.8695 acc=57.83% f1=67.89% auc=59.88% val_score=49.4228 val_score_bestthr=62.9297 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.115, mb=0.493, no=0.983, corr=-0.388) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 62.9297
[DBG][ep=056] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=056] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=056] mask(step0): mc_mean=0.0864 mb_mean=0.4947 norm_overlap=0.9784 corr_cb=-0.4670 topkJ=0.0047
[TRAIN][ep=056] loss=0.5197 acc=85.77%
[TRAIN][ep=056] mask_avg: mc_mean=0.1153 mb_mean=0.4928 norm_overlap=0.9830 corr_cb=-0.3893
[EPOCH 056/089] train: loss=0.5197 acc=85.77% | val: loss=0.8752 acc=57.83% f1=68.47% auc=59.83% val_score=49.4228 val_score_bestthr=59.5567 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.115, mb=0.493, no=0.983, corr=-0.389) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 59.5567
[DBG][ep=057] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=057] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=057] mask(step0): mc_mean=0.1163 mb_mean=0.4919 norm_overlap=0.9768 corr_cb=-0.5161 topkJ=0.0024
[TRAIN][ep=057] loss=0.5222 acc=85.50%
[TRAIN][ep=057] mask_avg: mc_mean=0.1153 mb_mean=0.4928 norm_overlap=0.9832 corr_cb=-0.3858
[EPOCH 057/089] train: loss=0.5222 acc=85.50% | val: loss=0.8756 acc=57.83% f1=67.89% auc=59.71% val_score=49.5843 val_score_bestthr=62.9297 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.115, mb=0.493, no=0.983, corr=-0.386) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 62.9297
[DBG][ep=058] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=058] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=058] mask(step0): mc_mean=0.1292 mb_mean=0.4906 norm_overlap=0.9843 corr_cb=-0.3140 topkJ=0.0052
[TRAIN][ep=058] loss=0.5242 acc=85.10%
[TRAIN][ep=058] mask_avg: mc_mean=0.1153 mb_mean=0.4928 norm_overlap=0.9832 corr_cb=-0.3863
[EPOCH 058/089] train: loss=0.5242 acc=85.10% | val: loss=0.8816 acc=57.83% f1=68.47% auc=59.71% val_score=49.4228 val_score_bestthr=59.5567 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.115, mb=0.493, no=0.983, corr=-0.386) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 59.5567
[DBG][ep=059] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=059] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=059] mask(step0): mc_mean=0.1060 mb_mean=0.4954 norm_overlap=0.9817 corr_cb=-0.4439 topkJ=0.0031
[TRAIN][ep=059] loss=0.5256 acc=84.56%
[TRAIN][ep=059] mask_avg: mc_mean=0.1153 mb_mean=0.4928 norm_overlap=0.9831 corr_cb=-0.3871
[EPOCH 059/089] train: loss=0.5256 acc=84.56% | val: loss=0.8954 acc=57.83% f1=68.47% auc=60.12% val_score=49.4228 val_score_bestthr=59.5567 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.115, mb=0.493, no=0.983, corr=-0.387) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 59.5567
[DBG][ep=060] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=060] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=060] mask(step0): mc_mean=0.1452 mb_mean=0.4903 norm_overlap=0.9877 corr_cb=-0.3298 topkJ=0.0142
[TRAIN][ep=060] loss=0.5189 acc=84.97%
[TRAIN][ep=060] mask_avg: mc_mean=0.1153 mb_mean=0.4928 norm_overlap=0.9831 corr_cb=-0.3875
[EPOCH 060/089] train: loss=0.5189 acc=84.97% | val: loss=0.8846 acc=57.83% f1=68.47% auc=59.77% val_score=50.8286 val_score_bestthr=59.5567 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.115, mb=0.493, no=0.983, corr=-0.388) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 59.5567
[DBG][ep=061] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=061] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=061] mask(step0): mc_mean=0.1140 mb_mean=0.4946 norm_overlap=0.9827 corr_cb=-0.3311 topkJ=0.0126
[TRAIN][ep=061] loss=0.5186 acc=85.50%
[TRAIN][ep=061] mask_avg: mc_mean=0.1153 mb_mean=0.4928 norm_overlap=0.9833 corr_cb=-0.3852
[EPOCH 061/089] train: loss=0.5186 acc=85.50% | val: loss=0.9109 acc=57.83% f1=68.47% auc=60.29% val_score=44.3978 val_score_bestthr=59.5567 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.115, mb=0.493, no=0.983, corr=-0.385) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 59.5567
[DBG][ep=062] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=062] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=062] mask(step0): mc_mean=0.0952 mb_mean=0.4954 norm_overlap=0.9811 corr_cb=-0.3920 topkJ=0.0031
[TRAIN][ep=062] loss=0.5149 acc=85.91%
[TRAIN][ep=062] mask_avg: mc_mean=0.1153 mb_mean=0.4928 norm_overlap=0.9832 corr_cb=-0.3853
[EPOCH 062/089] train: loss=0.5149 acc=85.91% | val: loss=0.9005 acc=57.83% f1=67.89% auc=59.94% val_score=49.6189 val_score_bestthr=62.9297 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.115, mb=0.493, no=0.983, corr=-0.385) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 62.9297
[DBG][ep=063] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=063] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=063] mask(step0): mc_mean=0.1541 mb_mean=0.4933 norm_overlap=0.9857 corr_cb=-0.3767 topkJ=0.0031
[TRAIN][ep=063] loss=0.5166 acc=84.56%
[TRAIN][ep=063] mask_avg: mc_mean=0.1153 mb_mean=0.4928 norm_overlap=0.9833 corr_cb=-0.3826
[EPOCH 063/089] train: loss=0.5166 acc=84.56% | val: loss=0.8991 acc=59.04% f1=68.52% auc=59.77% val_score=49.6189 val_score_bestthr=64.4288 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.115, mb=0.493, no=0.983, corr=-0.383) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 64.4288
[DBG][ep=064] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=064] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=064] mask(step0): mc_mean=0.1049 mb_mean=0.4912 norm_overlap=0.9883 corr_cb=-0.2946 topkJ=0.0185
[TRAIN][ep=064] loss=0.5186 acc=85.23%
[TRAIN][ep=064] mask_avg: mc_mean=0.1153 mb_mean=0.4928 norm_overlap=0.9832 corr_cb=-0.3841
[EPOCH 064/089] train: loss=0.5186 acc=85.23% | val: loss=0.9122 acc=57.83% f1=68.47% auc=60.00% val_score=43.2858 val_score_bestthr=59.5567 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.115, mb=0.493, no=0.983, corr=-0.384) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 59.5567
[DBG][ep=065] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=065] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=065] mask(step0): mc_mean=0.1278 mb_mean=0.4916 norm_overlap=0.9854 corr_cb=-0.3412 topkJ=0.0047
[TRAIN][ep=065] loss=0.5095 acc=86.31%
[TRAIN][ep=065] mask_avg: mc_mean=0.1153 mb_mean=0.4928 norm_overlap=0.9831 corr_cb=-0.3862
[EPOCH 065/089] train: loss=0.5095 acc=86.31% | val: loss=0.9021 acc=57.83% f1=68.47% auc=59.83% val_score=49.4228 val_score_bestthr=59.5567 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.115, mb=0.493, no=0.983, corr=-0.386) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 59.5567
[DBG][ep=066] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=066] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=066] mask(step0): mc_mean=0.0893 mb_mean=0.4938 norm_overlap=0.9884 corr_cb=-0.2626 topkJ=0.0104
[TRAIN][ep=066] loss=0.5108 acc=85.64%
[TRAIN][ep=066] mask_avg: mc_mean=0.1152 mb_mean=0.4928 norm_overlap=0.9831 corr_cb=-0.3857
[EPOCH 066/089] train: loss=0.5108 acc=85.64% | val: loss=0.9692 acc=59.04% f1=65.31% auc=60.70% val_score=47.3347 val_score_bestthr=59.0343 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.115, mb=0.493, no=0.983, corr=-0.386) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 59.0343
[DBG][ep=067] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=067] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=067] mask(step0): mc_mean=0.0963 mb_mean=0.4953 norm_overlap=0.9799 corr_cb=-0.4515 topkJ=0.0016
[TRAIN][ep=067] loss=0.5161 acc=85.64%
[TRAIN][ep=067] mask_avg: mc_mean=0.1153 mb_mean=0.4928 norm_overlap=0.9831 corr_cb=-0.3868
[EPOCH 067/089] train: loss=0.5161 acc=85.64% | val: loss=0.9142 acc=57.83% f1=68.47% auc=60.17% val_score=49.4228 val_score_bestthr=59.5567 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.115, mb=0.493, no=0.983, corr=-0.387) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 59.5567
[DBG][ep=068] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=068] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=068] mask(step0): mc_mean=0.1128 mb_mean=0.4925 norm_overlap=0.9808 corr_cb=-0.3936 topkJ=0.0241
[TRAIN][ep=068] loss=0.5076 acc=85.91%
[TRAIN][ep=068] mask_avg: mc_mean=0.1152 mb_mean=0.4928 norm_overlap=0.9830 corr_cb=-0.3876
[EPOCH 068/089] train: loss=0.5076 acc=85.91% | val: loss=0.9138 acc=57.83% f1=68.47% auc=60.06% val_score=49.4228 val_score_bestthr=59.5567 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.115, mb=0.493, no=0.983, corr=-0.388) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 59.5567
[DBG][ep=069] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=069] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=069] mask(step0): mc_mean=0.1170 mb_mean=0.4924 norm_overlap=0.9798 corr_cb=-0.4267 topkJ=0.0028
[TRAIN][ep=069] loss=0.5057 acc=86.44%
[TRAIN][ep=069] mask_avg: mc_mean=0.1153 mb_mean=0.4928 norm_overlap=0.9831 corr_cb=-0.3876
[EPOCH 069/089] train: loss=0.5057 acc=86.44% | val: loss=0.9148 acc=57.83% f1=68.47% auc=59.83% val_score=48.1986 val_score_bestthr=59.5567 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.115, mb=0.493, no=0.983, corr=-0.388) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 59.5567
[DBG][ep=070] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=070] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=070] mask(step0): mc_mean=0.0856 mb_mean=0.4930 norm_overlap=0.9848 corr_cb=-0.3568 topkJ=0.0088
[TRAIN][ep=070] loss=0.5043 acc=86.58%
[TRAIN][ep=070] mask_avg: mc_mean=0.1153 mb_mean=0.4928 norm_overlap=0.9833 corr_cb=-0.3817
[EPOCH 070/089] train: loss=0.5043 acc=86.58% | val: loss=0.9382 acc=59.04% f1=66.67% auc=60.58% val_score=46.4253 val_score_bestthr=62.1674 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.115, mb=0.493, no=0.983, corr=-0.382) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 62.1674
[DBG][ep=071] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=071] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=071] mask(step0): mc_mean=0.0972 mb_mean=0.4937 norm_overlap=0.9849 corr_cb=-0.3630 topkJ=0.0056
[TRAIN][ep=071] loss=0.5094 acc=85.37%
[TRAIN][ep=071] mask_avg: mc_mean=0.1153 mb_mean=0.4928 norm_overlap=0.9833 corr_cb=-0.3831
[EPOCH 071/089] train: loss=0.5094 acc=85.37% | val: loss=0.9173 acc=57.83% f1=65.35% auc=59.77% val_score=48.1986 val_score_bestthr=62.9090 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.115, mb=0.493, no=0.983, corr=-0.383) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 62.9090
[DBG][ep=072] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=072] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=072] mask(step0): mc_mean=0.0912 mb_mean=0.4946 norm_overlap=0.9885 corr_cb=-0.2779 topkJ=0.0225
[TRAIN][ep=072] loss=0.5044 acc=86.31%
[TRAIN][ep=072] mask_avg: mc_mean=0.1154 mb_mean=0.4928 norm_overlap=0.9833 corr_cb=-0.3834
[EPOCH 072/089] train: loss=0.5044 acc=86.31% | val: loss=0.9418 acc=60.24% f1=67.33% auc=60.47% val_score=46.4253 val_score_bestthr=61.6745 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.115, mb=0.493, no=0.983, corr=-0.383) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 61.6745
[DBG][ep=073] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=073] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=073] mask(step0): mc_mean=0.0780 mb_mean=0.4932 norm_overlap=0.9836 corr_cb=-0.3681 topkJ=0.0071
[TRAIN][ep=073] loss=0.5043 acc=86.58%
[TRAIN][ep=073] mask_avg: mc_mean=0.1154 mb_mean=0.4928 norm_overlap=0.9834 corr_cb=-0.3823
[EPOCH 073/089] train: loss=0.5043 acc=86.58% | val: loss=0.9338 acc=59.04% f1=67.92% auc=60.29% val_score=49.4228 val_score_bestthr=60.4580 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.115, mb=0.493, no=0.983, corr=-0.382) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 60.4580
[DBG][ep=074] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=074] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=074] mask(step0): mc_mean=0.1284 mb_mean=0.4920 norm_overlap=0.9855 corr_cb=-0.3736 topkJ=0.0135
[TRAIN][ep=074] loss=0.5037 acc=86.04%
[TRAIN][ep=074] mask_avg: mc_mean=0.1153 mb_mean=0.4928 norm_overlap=0.9832 corr_cb=-0.3856
[EPOCH 074/089] train: loss=0.5037 acc=86.04% | val: loss=0.9270 acc=57.83% f1=67.89% auc=60.47% val_score=49.4228 val_score_bestthr=62.9297 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.115, mb=0.493, no=0.983, corr=-0.386) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 62.9297
[DBG][ep=075] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=075] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=075] mask(step0): mc_mean=0.0970 mb_mean=0.4940 norm_overlap=0.9852 corr_cb=-0.3570 topkJ=0.0075
[TRAIN][ep=075] loss=0.5011 acc=86.17%
[TRAIN][ep=075] mask_avg: mc_mean=0.1153 mb_mean=0.4928 norm_overlap=0.9831 corr_cb=-0.3860
[EPOCH 075/089] train: loss=0.5011 acc=86.17% | val: loss=0.9286 acc=57.83% f1=67.89% auc=60.35% val_score=48.1986 val_score_bestthr=62.9297 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.115, mb=0.493, no=0.983, corr=-0.386) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 62.9297
[DBG][ep=076] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=076] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=076] mask(step0): mc_mean=0.1084 mb_mean=0.4945 norm_overlap=0.9832 corr_cb=-0.3998 topkJ=0.0036
[TRAIN][ep=076] loss=0.4988 acc=85.37%
[TRAIN][ep=076] mask_avg: mc_mean=0.1152 mb_mean=0.4928 norm_overlap=0.9830 corr_cb=-0.3873
[EPOCH 076/089] train: loss=0.4988 acc=85.37% | val: loss=0.9324 acc=57.83% f1=67.89% auc=60.29% val_score=50.1798 val_score_bestthr=62.9297 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.115, mb=0.493, no=0.983, corr=-0.387) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 62.9297
[DBG][ep=077] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=077] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=077] mask(step0): mc_mean=0.1232 mb_mean=0.4921 norm_overlap=0.9780 corr_cb=-0.4825 topkJ=0.0020
[TRAIN][ep=077] loss=0.4967 acc=86.17%
[TRAIN][ep=077] mask_avg: mc_mean=0.1154 mb_mean=0.4928 norm_overlap=0.9831 corr_cb=-0.3858
[EPOCH 077/089] train: loss=0.4967 acc=86.17% | val: loss=0.9351 acc=57.83% f1=68.47% auc=60.12% val_score=48.1986 val_score_bestthr=59.5567 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.115, mb=0.493, no=0.983, corr=-0.386) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 59.5567
[DBG][ep=078] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=078] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=078] mask(step0): mc_mean=0.1298 mb_mean=0.4889 norm_overlap=0.9831 corr_cb=-0.3991 topkJ=0.0042
[TRAIN][ep=078] loss=0.4978 acc=86.44%
[TRAIN][ep=078] mask_avg: mc_mean=0.1152 mb_mean=0.4928 norm_overlap=0.9832 corr_cb=-0.3860
[EPOCH 078/089] train: loss=0.4978 acc=86.44% | val: loss=0.9372 acc=57.83% f1=67.89% auc=60.35% val_score=51.9342 val_score_bestthr=62.9297 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.115, mb=0.493, no=0.983, corr=-0.386) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 62.9297
[EARLY STOP] no improvement for 30 epochs. best_epoch=48
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
=============== FIT DONE ===============
[BEST] epoch=48 | val_acc=61.45% | val_f1=69.81% | val_auc=60.70% | val_score=59.4776 | val_score_bestthr=67.5295
[TEST@BEST] thr_used=0.125 | acc=58.45% f1=70.14% auc=69.31% | SP_sex=5.37% EO_sex=5.49% SP_age=10.73% EO_age=10.34%
[TIME] 1.99 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/summary_fold_1.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4925 mb_mean=0.4923 norm_overlap=1.0000 corr_cb=-0.0375 topkJ=0.0351
[TRAIN][ep=000] loss=0.6931 acc=51.01%
[TRAIN][ep=000] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0408
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4947 mb_mean=0.4925 norm_overlap=1.0000 corr_cb=0.0200 topkJ=0.0582
[TRAIN][ep=001] loss=0.6908 acc=53.02%
[TRAIN][ep=001] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0417
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4934 mb_mean=0.4912 norm_overlap=1.0000 corr_cb=-0.0761 topkJ=0.0212
[TRAIN][ep=002] loss=0.6911 acc=49.66%
[TRAIN][ep=002] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0335
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4946 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=0.0005 topkJ=0.0158
[TRAIN][ep=003] loss=0.6896 acc=55.97%
[TRAIN][ep=003] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0421
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4921 mb_mean=0.4935 norm_overlap=1.0000 corr_cb=0.0308 topkJ=0.0456
[TRAIN][ep=004] loss=0.6890 acc=56.78%
[TRAIN][ep=004] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0492
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4956 mb_mean=0.4905 norm_overlap=1.0000 corr_cb=-0.0217 topkJ=0.0255
[TRAIN][ep=005] loss=0.6854 acc=57.72%
[TRAIN][ep=005] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0414
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4955 mb_mean=0.4935 norm_overlap=1.0001 corr_cb=0.1792 topkJ=0.2987
[TRAIN][ep=006] loss=0.6823 acc=57.99%
[TRAIN][ep=006] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0439
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4934 mb_mean=0.4926 norm_overlap=1.0000 corr_cb=0.0730 topkJ=0.0188
[TRAIN][ep=007] loss=0.6802 acc=62.28%
[TRAIN][ep=007] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0419
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4941 mb_mean=0.4951 norm_overlap=1.0000 corr_cb=-0.0577 topkJ=0.0403
[TRAIN][ep=008] loss=0.6804 acc=57.32%
[TRAIN][ep=008] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0461
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4928 mb_mean=0.4945 norm_overlap=1.0001 corr_cb=0.2081 topkJ=0.0622
[TRAIN][ep=009] loss=0.6765 acc=61.21%
[TRAIN][ep=009] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0400
================= FIT START (fold=1) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4924 mb_mean=0.4908 norm_overlap=1.0000 corr_cb=-0.0313 topkJ=0.0382
[TRAIN][ep=000] loss=0.6711 acc=61.74%
[TRAIN][ep=000] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0416
[EPOCH 000/089] train: loss=0.6711 acc=61.74% | val: loss=0.6902 acc=57.83% f1=69.57% auc=52.97% val_score=42.9101 val_score_bestthr=56.8424 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.042) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 56.8424
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4945 mb_mean=0.4932 norm_overlap=1.0000 corr_cb=0.0532 topkJ=0.0351
[TRAIN][ep=001] loss=0.6648 acc=61.34%
[TRAIN][ep=001] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0445
[EPOCH 001/089] train: loss=0.6648 acc=61.34% | val: loss=0.6901 acc=55.42% f1=69.92% auc=52.09% val_score=43.0198 val_score_bestthr=62.6871 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.045) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 56.8424 -> 62.6871
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4957 mb_mean=0.4963 norm_overlap=1.0000 corr_cb=-0.0615 topkJ=0.0282
[TRAIN][ep=002] loss=0.6544 acc=65.10%
[TRAIN][ep=002] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0447
[EPOCH 002/089] train: loss=0.6544 acc=65.10% | val: loss=0.6914 acc=56.63% f1=69.49% auc=53.20% val_score=44.9705 val_score_bestthr=59.2265 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.045) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6871 -> 59.2265
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4968 mb_mean=0.4929 norm_overlap=0.9999 corr_cb=-0.1262 topkJ=0.0038
[TRAIN][ep=003] loss=0.6482 acc=64.30%
[TRAIN][ep=003] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0468
[EPOCH 003/089] train: loss=0.6482 acc=64.30% | val: loss=0.6943 acc=56.63% f1=68.97% auc=53.31% val_score=47.0193 val_score_bestthr=57.0488 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.047) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6871 -> 57.0488
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4915 mb_mean=0.4920 norm_overlap=1.0000 corr_cb=-0.0843 topkJ=0.0088
[TRAIN][ep=004] loss=0.6430 acc=63.49%
[TRAIN][ep=004] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0455
[EPOCH 004/089] train: loss=0.6430 acc=63.49% | val: loss=0.7004 acc=57.83% f1=68.47% auc=53.43% val_score=37.0298 val_score_bestthr=59.5284 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.046) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6871 -> 59.5284
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4942 mb_mean=0.4946 norm_overlap=0.9999 corr_cb=-0.1495 topkJ=0.0119
[TRAIN][ep=005] loss=1.4497 acc=64.03%
[TRAIN][ep=005] mask_avg: mc_mean=0.3719 mb_mean=0.4928 norm_overlap=0.9989 corr_cb=-0.3590
[EPOCH 005/089] train: loss=1.4497 acc=64.03% | val: loss=0.6942 acc=56.63% f1=70.00% auc=54.30% val_score=35.8021 val_score_bestthr=60.1401 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.372, mb=0.493, no=0.999, corr=-0.359) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6871 -> 60.1401
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2627 mb_mean=0.4960 norm_overlap=0.9957 corr_cb=-0.4899 topkJ=0.0031
[TRAIN][ep=006] loss=1.4295 acc=64.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.2316 mb_mean=0.4928 norm_overlap=0.9967 corr_cb=-0.4156
[EPOCH 006/089] train: loss=1.4295 acc=64.70% | val: loss=0.6938 acc=56.63% f1=70.00% auc=54.19% val_score=32.6091 val_score_bestthr=60.1401 | dyn(w_pfs=0.240, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.232, mb=0.493, no=0.997, corr=-0.416) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6871 -> 60.1401
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.1526 mb_mean=0.4992 norm_overlap=0.9951 corr_cb=-0.4570 topkJ=0.0110
[TRAIN][ep=007] loss=1.2320 acc=64.97%
[TRAIN][ep=007] mask_avg: mc_mean=0.1751 mb_mean=0.4928 norm_overlap=0.9952 corr_cb=-0.4153
[EPOCH 007/089] train: loss=1.2320 acc=64.97% | val: loss=0.7127 acc=56.63% f1=69.49% auc=53.72% val_score=38.5081 val_score_bestthr=58.9833 | dyn(w_pfs=0.140, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.175, mb=0.493, no=0.995, corr=-0.415) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6871 -> 58.9833
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1560 mb_mean=0.4901 norm_overlap=0.9953 corr_cb=-0.4104 topkJ=0.0141
[TRAIN][ep=008] loss=1.0187 acc=66.04%
[TRAIN][ep=008] mask_avg: mc_mean=0.1372 mb_mean=0.4928 norm_overlap=0.9935 corr_cb=-0.4290
[EPOCH 008/089] train: loss=1.0187 acc=66.04% | val: loss=0.7036 acc=57.83% f1=71.07% auc=54.36% val_score=38.9875 val_score_bestthr=63.1205 | dyn(w_pfs=0.180, w_sup=0.090, w_csuf=0.040, stage2=False) | mask(mc=0.137, mb=0.493, no=0.993, corr=-0.429) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 62.6871 -> 63.1205
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1010 mb_mean=0.4926 norm_overlap=0.9922 corr_cb=-0.3894 topkJ=0.0202
[TRAIN][ep=009] loss=1.1078 acc=63.89%
[TRAIN][ep=009] mask_avg: mc_mean=0.1053 mb_mean=0.4928 norm_overlap=0.9916 corr_cb=-0.4237
[EPOCH 009/089] train: loss=1.1078 acc=63.89% | val: loss=0.7080 acc=57.83% f1=66.02% auc=54.30% val_score=39.3150 val_score_bestthr=61.3809 | dyn(w_pfs=0.220, w_sup=0.130, w_csuf=0.080, stage2=False) | mask(mc=0.105, mb=0.493, no=0.992, corr=-0.424) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.1205 -> 61.3809
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.0773 mb_mean=0.4963 norm_overlap=0.9911 corr_cb=-0.4583 topkJ=0.0035
[TRAIN][ep=010] loss=1.1790 acc=65.50%
[TRAIN][ep=010] mask_avg: mc_mean=0.0824 mb_mean=0.4928 norm_overlap=0.9902 corr_cb=-0.4033
[EPOCH 010/089] train: loss=1.1790 acc=65.50% | val: loss=0.7024 acc=57.83% f1=70.59% auc=54.24% val_score=49.1388 val_score_bestthr=59.6647 | dyn(w_pfs=0.260, w_sup=0.170, w_csuf=0.120, stage2=False) | mask(mc=0.082, mb=0.493, no=0.990, corr=-0.403) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.1205 -> 59.6647
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.0591 mb_mean=0.4924 norm_overlap=0.9907 corr_cb=-0.3318 topkJ=0.0124
[TRAIN][ep=011] loss=1.2411 acc=66.58%
[TRAIN][ep=011] mask_avg: mc_mean=0.0683 mb_mean=0.4928 norm_overlap=0.9887 corr_cb=-0.3952
[EPOCH 011/089] train: loss=1.2411 acc=66.58% | val: loss=0.7020 acc=59.04% f1=70.69% auc=54.48% val_score=41.4230 val_score_bestthr=61.0958 | dyn(w_pfs=0.060, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.068, mb=0.493, no=0.989, corr=-0.395) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.1205 -> 61.0958
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.0567 mb_mean=0.4959 norm_overlap=0.9860 corr_cb=-0.4231 topkJ=0.0104
[TRAIN][ep=012] loss=0.9680 acc=69.93%
[TRAIN][ep=012] mask_avg: mc_mean=0.0617 mb_mean=0.4928 norm_overlap=0.9870 corr_cb=-0.3964
[EPOCH 012/089] train: loss=0.9680 acc=69.93% | val: loss=0.7064 acc=59.04% f1=70.69% auc=55.00% val_score=43.5062 val_score_bestthr=61.0958 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.062, mb=0.493, no=0.987, corr=-0.396) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.1205 -> 61.0958
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.0332 mb_mean=0.4973 norm_overlap=0.9830 corr_cb=-0.3861 topkJ=0.0016
[TRAIN][ep=013] loss=0.9636 acc=66.31%
[TRAIN][ep=013] mask_avg: mc_mean=0.0539 mb_mean=0.4928 norm_overlap=0.9855 corr_cb=-0.3846
[EPOCH 013/089] train: loss=0.9636 acc=66.31% | val: loss=0.7048 acc=60.24% f1=67.33% auc=55.47% val_score=44.5284 val_score_bestthr=65.0202 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.054, mb=0.493, no=0.985, corr=-0.385) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 63.1205 -> 65.0202
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.0432 mb_mean=0.4931 norm_overlap=0.9817 corr_cb=-0.4471 topkJ=0.0079
[TRAIN][ep=014] loss=0.9297 acc=70.60%
[TRAIN][ep=014] mask_avg: mc_mean=0.0541 mb_mean=0.4928 norm_overlap=0.9845 corr_cb=-0.3909
[EPOCH 014/089] train: loss=0.9297 acc=70.60% | val: loss=0.7292 acc=59.04% f1=66.00% auc=54.30% val_score=36.0552 val_score_bestthr=60.6974 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.054, mb=0.493, no=0.985, corr=-0.391) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.0202 -> 60.6974
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.0704 mb_mean=0.4915 norm_overlap=0.9896 corr_cb=-0.3695 topkJ=0.0122
[TRAIN][ep=015] loss=0.9323 acc=69.13%
[TRAIN][ep=015] mask_avg: mc_mean=0.0488 mb_mean=0.4928 norm_overlap=0.9828 corr_cb=-0.3766
[EPOCH 015/089] train: loss=0.9323 acc=69.13% | val: loss=0.7285 acc=60.24% f1=71.30% auc=54.07% val_score=47.3350 val_score_bestthr=63.2773 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.049, mb=0.493, no=0.983, corr=-0.377) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.0202 -> 63.2773
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.0516 mb_mean=0.4960 norm_overlap=0.9780 corr_cb=-0.4313 topkJ=0.0008
[TRAIN][ep=016] loss=0.9190 acc=69.93%
[TRAIN][ep=016] mask_avg: mc_mean=0.0603 mb_mean=0.4928 norm_overlap=0.9831 corr_cb=-0.4064
[EPOCH 016/089] train: loss=0.9190 acc=69.93% | val: loss=0.7156 acc=60.24% f1=71.79% auc=55.17% val_score=38.0694 val_score_bestthr=62.2198 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.060, mb=0.493, no=0.983, corr=-0.406) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.0202 -> 62.2198
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.0651 mb_mean=0.4935 norm_overlap=0.9815 corr_cb=-0.4655 topkJ=0.0044
[TRAIN][ep=017] loss=0.9173 acc=69.53%
[TRAIN][ep=017] mask_avg: mc_mean=0.0615 mb_mean=0.4928 norm_overlap=0.9825 corr_cb=-0.4038
[EPOCH 017/089] train: loss=0.9173 acc=69.53% | val: loss=0.7296 acc=60.24% f1=71.79% auc=54.24% val_score=53.4880 val_score_bestthr=62.4506 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.062, mb=0.493, no=0.983, corr=-0.404) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.0202 -> 62.4506
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.0530 mb_mean=0.4913 norm_overlap=0.9865 corr_cb=-0.3136 topkJ=0.0099
[TRAIN][ep=018] loss=0.9030 acc=71.68%
[TRAIN][ep=018] mask_avg: mc_mean=0.0556 mb_mean=0.4928 norm_overlap=0.9815 corr_cb=-0.3936
[EPOCH 018/089] train: loss=0.9030 acc=71.68% | val: loss=0.7191 acc=61.45% f1=71.93% auc=55.29% val_score=48.6173 val_score_bestthr=65.6471 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.056, mb=0.493, no=0.981, corr=-0.394) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 65.0202 -> 65.6471
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.0780 mb_mean=0.4941 norm_overlap=0.9870 corr_cb=-0.3612 topkJ=0.0112
[TRAIN][ep=019] loss=0.9047 acc=70.60%
[TRAIN][ep=019] mask_avg: mc_mean=0.0660 mb_mean=0.4928 norm_overlap=0.9816 corr_cb=-0.4150
[EPOCH 019/089] train: loss=0.9047 acc=70.60% | val: loss=0.7322 acc=61.45% f1=71.93% auc=54.77% val_score=45.4119 val_score_bestthr=65.6471 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.066, mb=0.493, no=0.982, corr=-0.415) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6471 -> 65.6471
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.0919 mb_mean=0.4898 norm_overlap=0.9865 corr_cb=-0.3887 topkJ=0.0051
[TRAIN][ep=020] loss=0.8945 acc=73.15%
[TRAIN][ep=020] mask_avg: mc_mean=0.0759 mb_mean=0.4928 norm_overlap=0.9818 corr_cb=-0.4321
[EPOCH 020/089] train: loss=0.8945 acc=73.15% | val: loss=0.7479 acc=59.04% f1=70.69% auc=56.92% val_score=38.0330 val_score_bestthr=61.0958 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.076, mb=0.493, no=0.982, corr=-0.432) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6471 -> 61.0958
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.0716 mb_mean=0.4926 norm_overlap=0.9847 corr_cb=-0.4504 topkJ=0.0028
[TRAIN][ep=021] loss=0.8807 acc=71.81%
[TRAIN][ep=021] mask_avg: mc_mean=0.0859 mb_mean=0.4928 norm_overlap=0.9822 corr_cb=-0.4411
[EPOCH 021/089] train: loss=0.8807 acc=71.81% | val: loss=0.7860 acc=60.24% f1=71.30% auc=56.69% val_score=43.2431 val_score_bestthr=62.5929 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.086, mb=0.493, no=0.982, corr=-0.441) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6471 -> 62.5929
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.0984 mb_mean=0.4906 norm_overlap=0.9830 corr_cb=-0.4307 topkJ=0.0024
[TRAIN][ep=022] loss=0.9622 acc=71.68%
[TRAIN][ep=022] mask_avg: mc_mean=0.0774 mb_mean=0.4928 norm_overlap=0.9814 corr_cb=-0.4287
[EPOCH 022/089] train: loss=0.9622 acc=71.68% | val: loss=0.7283 acc=60.24% f1=71.30% auc=55.81% val_score=48.6157 val_score_bestthr=63.2773 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.077, mb=0.493, no=0.981, corr=-0.429) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6471 -> 63.2773
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.0695 mb_mean=0.4932 norm_overlap=0.9735 corr_cb=-0.4859 topkJ=0.0027
[TRAIN][ep=023] loss=0.8693 acc=72.21%
[TRAIN][ep=023] mask_avg: mc_mean=0.0809 mb_mean=0.4928 norm_overlap=0.9816 corr_cb=-0.4284
[EPOCH 023/089] train: loss=0.8693 acc=72.21% | val: loss=0.7227 acc=61.45% f1=71.93% auc=55.64% val_score=45.7080 val_score_bestthr=65.6471 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.081, mb=0.493, no=0.982, corr=-0.428) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6471 -> 65.6471
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.0826 mb_mean=0.4927 norm_overlap=0.9825 corr_cb=-0.4673 topkJ=0.0020
[TRAIN][ep=024] loss=0.8593 acc=73.83%
[TRAIN][ep=024] mask_avg: mc_mean=0.1011 mb_mean=0.4928 norm_overlap=0.9827 corr_cb=-0.4471
[EPOCH 024/089] train: loss=0.8593 acc=73.83% | val: loss=0.7136 acc=62.65% f1=73.04% auc=57.38% val_score=49.5967 val_score_bestthr=66.3367 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.101, mb=0.493, no=0.983, corr=-0.447) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 65.6471 -> 66.3367
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.0557 mb_mean=0.4924 norm_overlap=0.9828 corr_cb=-0.3787 topkJ=0.0051
[TRAIN][ep=025] loss=0.9327 acc=72.62%
[TRAIN][ep=025] mask_avg: mc_mean=0.0843 mb_mean=0.4928 norm_overlap=0.9815 corr_cb=-0.4216
[EPOCH 025/089] train: loss=0.9327 acc=72.62% | val: loss=0.7338 acc=61.45% f1=72.41% auc=57.03% val_score=46.6077 val_score_bestthr=63.7174 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.084, mb=0.493, no=0.981, corr=-0.422) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 63.7174
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.0946 mb_mean=0.4922 norm_overlap=0.9880 corr_cb=-0.3580 topkJ=0.0073
[TRAIN][ep=026] loss=1.0004 acc=74.36%
[TRAIN][ep=026] mask_avg: mc_mean=0.1126 mb_mean=0.4928 norm_overlap=0.9832 corr_cb=-0.4477
[EPOCH 026/089] train: loss=1.0004 acc=74.36% | val: loss=0.7609 acc=61.45% f1=71.93% auc=57.97% val_score=39.5193 val_score_bestthr=65.6471 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.113, mb=0.493, no=0.983, corr=-0.448) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 65.6471
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1424 mb_mean=0.4908 norm_overlap=0.9856 corr_cb=-0.4032 topkJ=0.0028
[TRAIN][ep=027] loss=1.0622 acc=75.70%
[TRAIN][ep=027] mask_avg: mc_mean=0.1062 mb_mean=0.4928 norm_overlap=0.9827 corr_cb=-0.4340
[EPOCH 027/089] train: loss=1.0622 acc=75.70% | val: loss=0.7396 acc=62.65% f1=73.04% auc=58.43% val_score=40.7238 val_score_bestthr=66.3367 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.106, mb=0.493, no=0.983, corr=-0.434) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 66.3367
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.0651 mb_mean=0.4955 norm_overlap=0.9776 corr_cb=-0.4170 topkJ=0.0032
[TRAIN][ep=028] loss=1.1395 acc=74.36%
[TRAIN][ep=028] mask_avg: mc_mean=0.0854 mb_mean=0.4928 norm_overlap=0.9811 corr_cb=-0.4053
[EPOCH 028/089] train: loss=1.1395 acc=74.36% | val: loss=0.7420 acc=60.24% f1=71.30% auc=57.62% val_score=39.2230 val_score_bestthr=63.2773 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.085, mb=0.493, no=0.981, corr=-0.405) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 63.2773
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.0835 mb_mean=0.4953 norm_overlap=0.9783 corr_cb=-0.5160 topkJ=0.0004
[TRAIN][ep=029] loss=1.1904 acc=76.64%
[TRAIN][ep=029] mask_avg: mc_mean=0.1238 mb_mean=0.4928 norm_overlap=0.9834 corr_cb=-0.4458
[EPOCH 029/089] train: loss=1.1904 acc=76.64% | val: loss=0.7416 acc=61.45% f1=72.41% auc=57.03% val_score=41.5181 val_score_bestthr=63.7174 | dyn(w_pfs=0.100, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.124, mb=0.493, no=0.983, corr=-0.446) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 63.7174
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.0685 mb_mean=0.4980 norm_overlap=0.9661 corr_cb=-0.5365 topkJ=0.0004
[TRAIN][ep=030] loss=1.0044 acc=74.50%
[TRAIN][ep=030] mask_avg: mc_mean=0.1016 mb_mean=0.4928 norm_overlap=0.9819 corr_cb=-0.4209
[EPOCH 030/089] train: loss=1.0044 acc=74.50% | val: loss=0.7386 acc=61.45% f1=71.93% auc=57.21% val_score=50.7854 val_score_bestthr=65.6471 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.102, mb=0.493, no=0.982, corr=-0.421) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 65.6471
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.1055 mb_mean=0.4927 norm_overlap=0.9776 corr_cb=-0.5131 topkJ=0.0023
[TRAIN][ep=031] loss=0.8280 acc=73.02%
[TRAIN][ep=031] mask_avg: mc_mean=0.0994 mb_mean=0.4928 norm_overlap=0.9818 corr_cb=-0.4181
[EPOCH 031/089] train: loss=0.8280 acc=73.02% | val: loss=0.7723 acc=60.24% f1=70.80% auc=58.49% val_score=42.8562 val_score_bestthr=61.4456 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.099, mb=0.493, no=0.982, corr=-0.418) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 61.4456
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1233 mb_mean=0.4887 norm_overlap=0.9885 corr_cb=-0.2748 topkJ=0.0221
[TRAIN][ep=032] loss=0.8063 acc=76.38%
[TRAIN][ep=032] mask_avg: mc_mean=0.1098 mb_mean=0.4928 norm_overlap=0.9826 corr_cb=-0.4230
[EPOCH 032/089] train: loss=0.8063 acc=76.38% | val: loss=0.7447 acc=60.24% f1=70.80% auc=58.60% val_score=49.7672 val_score_bestthr=61.4456 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.110, mb=0.493, no=0.983, corr=-0.423) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 61.4456
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1180 mb_mean=0.4927 norm_overlap=0.9794 corr_cb=-0.4473 topkJ=0.0039
[TRAIN][ep=033] loss=0.7920 acc=76.51%
[TRAIN][ep=033] mask_avg: mc_mean=0.1142 mb_mean=0.4928 norm_overlap=0.9827 corr_cb=-0.4261
[EPOCH 033/089] train: loss=0.7920 acc=76.51% | val: loss=0.7509 acc=60.24% f1=70.80% auc=57.67% val_score=45.1517 val_score_bestthr=61.4456 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.114, mb=0.493, no=0.983, corr=-0.426) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 61.4456
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1166 mb_mean=0.4908 norm_overlap=0.9871 corr_cb=-0.3510 topkJ=0.0143
[TRAIN][ep=034] loss=0.7816 acc=77.99%
[TRAIN][ep=034] mask_avg: mc_mean=0.1269 mb_mean=0.4928 norm_overlap=0.9836 corr_cb=-0.4298
[EPOCH 034/089] train: loss=0.7816 acc=77.99% | val: loss=0.7770 acc=61.45% f1=70.91% auc=58.26% val_score=50.0950 val_score_bestthr=61.8877 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.127, mb=0.493, no=0.984, corr=-0.430) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 61.8877
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.1353 mb_mean=0.4924 norm_overlap=0.9874 corr_cb=-0.4229 topkJ=0.0040
[TRAIN][ep=035] loss=0.7942 acc=77.05%
[TRAIN][ep=035] mask_avg: mc_mean=0.1151 mb_mean=0.4928 norm_overlap=0.9828 corr_cb=-0.4177
[EPOCH 035/089] train: loss=0.7942 acc=77.05% | val: loss=0.7811 acc=61.45% f1=71.43% auc=57.67% val_score=56.0375 val_score_bestthr=62.5452 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.115, mb=0.493, no=0.983, corr=-0.418) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 62.5452
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.1204 mb_mean=0.4918 norm_overlap=0.9872 corr_cb=-0.3161 topkJ=0.0036
[TRAIN][ep=036] loss=0.7846 acc=76.91%
[TRAIN][ep=036] mask_avg: mc_mean=0.1291 mb_mean=0.4928 norm_overlap=0.9836 corr_cb=-0.4256
[EPOCH 036/089] train: loss=0.7846 acc=76.91% | val: loss=0.7659 acc=60.24% f1=69.72% auc=59.01% val_score=43.2487 val_score_bestthr=63.3103 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.129, mb=0.493, no=0.984, corr=-0.426) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 63.3103
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1359 mb_mean=0.4913 norm_overlap=0.9785 corr_cb=-0.4691 topkJ=0.0000
[TRAIN][ep=037] loss=0.7802 acc=77.45%
[TRAIN][ep=037] mask_avg: mc_mean=0.1333 mb_mean=0.4928 norm_overlap=0.9838 corr_cb=-0.4261
[EPOCH 037/089] train: loss=0.7802 acc=77.45% | val: loss=0.8168 acc=56.63% f1=70.00% auc=59.65% val_score=44.4953 val_score_bestthr=62.1241 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.133, mb=0.493, no=0.984, corr=-0.426) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 62.1241
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.1482 mb_mean=0.4918 norm_overlap=0.9847 corr_cb=-0.4091 topkJ=0.0053
[TRAIN][ep=038] loss=0.7617 acc=77.85%
[TRAIN][ep=038] mask_avg: mc_mean=0.1231 mb_mean=0.4928 norm_overlap=0.9834 corr_cb=-0.4147
[EPOCH 038/089] train: loss=0.7617 acc=77.85% | val: loss=0.7697 acc=60.24% f1=69.16% auc=59.42% val_score=43.6154 val_score_bestthr=60.8074 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.123, mb=0.493, no=0.983, corr=-0.415) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 60.8074
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.1427 mb_mean=0.4933 norm_overlap=0.9769 corr_cb=-0.5307 topkJ=0.0000
[TRAIN][ep=039] loss=0.7554 acc=77.32%
[TRAIN][ep=039] mask_avg: mc_mean=0.1404 mb_mean=0.4928 norm_overlap=0.9841 corr_cb=-0.4262
[EPOCH 039/089] train: loss=0.7554 acc=77.32% | val: loss=0.8433 acc=57.83% f1=68.47% auc=60.52% val_score=48.7394 val_score_bestthr=61.4233 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.140, mb=0.493, no=0.984, corr=-0.426) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 61.4233
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.1339 mb_mean=0.4926 norm_overlap=0.9802 corr_cb=-0.4856 topkJ=0.0039
[TRAIN][ep=040] loss=0.7378 acc=80.40%
[TRAIN][ep=040] mask_avg: mc_mean=0.1434 mb_mean=0.4928 norm_overlap=0.9847 corr_cb=-0.4192
[EPOCH 040/089] train: loss=0.7378 acc=80.40% | val: loss=0.8161 acc=60.24% f1=69.72% auc=59.19% val_score=47.2272 val_score_bestthr=63.3103 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.143, mb=0.493, no=0.985, corr=-0.419) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 63.3103
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.1648 mb_mean=0.4934 norm_overlap=0.9878 corr_cb=-0.3818 topkJ=0.0024
[TRAIN][ep=041] loss=0.7245 acc=82.01%
[TRAIN][ep=041] mask_avg: mc_mean=0.1308 mb_mean=0.4928 norm_overlap=0.9837 corr_cb=-0.4137
[EPOCH 041/089] train: loss=0.7245 acc=82.01% | val: loss=0.8218 acc=56.63% f1=70.00% auc=60.17% val_score=50.6024 val_score_bestthr=62.1241 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.131, mb=0.493, no=0.984, corr=-0.414) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 62.1241
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.1973 mb_mean=0.4932 norm_overlap=0.9843 corr_cb=-0.5162 topkJ=0.0012
[TRAIN][ep=042] loss=0.7434 acc=79.60%
[TRAIN][ep=042] mask_avg: mc_mean=0.1256 mb_mean=0.4928 norm_overlap=0.9835 corr_cb=-0.4086
[EPOCH 042/089] train: loss=0.7434 acc=79.60% | val: loss=0.7955 acc=60.24% f1=69.72% auc=60.00% val_score=50.8916 val_score_bestthr=63.3103 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.126, mb=0.493, no=0.983, corr=-0.409) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 63.3103
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.1135 mb_mean=0.4932 norm_overlap=0.9793 corr_cb=-0.4314 topkJ=0.0016
[TRAIN][ep=043] loss=0.7215 acc=79.19%
[TRAIN][ep=043] mask_avg: mc_mean=0.1374 mb_mean=0.4928 norm_overlap=0.9841 corr_cb=-0.4170
[EPOCH 043/089] train: loss=0.7215 acc=79.19% | val: loss=0.9045 acc=57.83% f1=67.29% auc=60.17% val_score=45.9923 val_score_bestthr=57.7409 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.137, mb=0.493, no=0.984, corr=-0.417) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 57.7409
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.1529 mb_mean=0.4931 norm_overlap=0.9847 corr_cb=-0.4435 topkJ=0.0016
[TRAIN][ep=044] loss=0.7395 acc=80.40%
[TRAIN][ep=044] mask_avg: mc_mean=0.1162 mb_mean=0.4928 norm_overlap=0.9830 corr_cb=-0.3963
[EPOCH 044/089] train: loss=0.7395 acc=80.40% | val: loss=0.7982 acc=59.04% f1=68.52% auc=59.83% val_score=51.1251 val_score_bestthr=63.3088 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.116, mb=0.493, no=0.983, corr=-0.396) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 63.3088
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.1168 mb_mean=0.4935 norm_overlap=0.9875 corr_cb=-0.3593 topkJ=0.0036
[TRAIN][ep=045] loss=0.7016 acc=81.88%
[TRAIN][ep=045] mask_avg: mc_mean=0.1374 mb_mean=0.4928 norm_overlap=0.9843 corr_cb=-0.4052
[EPOCH 045/089] train: loss=0.7016 acc=81.88% | val: loss=0.8556 acc=60.24% f1=67.96% auc=59.59% val_score=50.1461 val_score_bestthr=59.9950 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.137, mb=0.493, no=0.984, corr=-0.405) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 59.9950
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.1745 mb_mean=0.4928 norm_overlap=0.9839 corr_cb=-0.4410 topkJ=0.0039
[TRAIN][ep=046] loss=0.7016 acc=79.87%
[TRAIN][ep=046] mask_avg: mc_mean=0.1637 mb_mean=0.4928 norm_overlap=0.9859 corr_cb=-0.4107
[EPOCH 046/089] train: loss=0.7016 acc=79.87% | val: loss=0.8171 acc=61.45% f1=70.37% auc=61.05% val_score=49.4714 val_score_bestthr=63.2920 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.164, mb=0.493, no=0.986, corr=-0.411) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 63.2920
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.1064 mb_mean=0.4929 norm_overlap=0.9782 corr_cb=-0.4411 topkJ=0.0008
[TRAIN][ep=047] loss=0.7142 acc=80.27%
[TRAIN][ep=047] mask_avg: mc_mean=0.1345 mb_mean=0.4928 norm_overlap=0.9841 corr_cb=-0.4034
[EPOCH 047/089] train: loss=0.7142 acc=80.27% | val: loss=0.8428 acc=57.83% f1=67.89% auc=60.47% val_score=49.5843 val_score_bestthr=62.9297 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.135, mb=0.493, no=0.984, corr=-0.403) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 62.9297
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.1555 mb_mean=0.4913 norm_overlap=0.9908 corr_cb=-0.3333 topkJ=0.0113
[TRAIN][ep=048] loss=0.7138 acc=80.81%
[TRAIN][ep=048] mask_avg: mc_mean=0.1364 mb_mean=0.4928 norm_overlap=0.9848 corr_cb=-0.3930
[EPOCH 048/089] train: loss=0.7138 acc=80.81% | val: loss=0.8222 acc=60.24% f1=69.16% auc=60.52% val_score=60.3426 val_score_bestthr=64.8097 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.136, mb=0.493, no=0.985, corr=-0.393) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 64.8097
[DBG][ep=049] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.0861 mb_mean=0.4987 norm_overlap=0.9747 corr_cb=-0.5305 topkJ=0.0019
[TRAIN][ep=049] loss=0.6825 acc=83.09%
[TRAIN][ep=049] mask_avg: mc_mean=0.1490 mb_mean=0.4928 norm_overlap=0.9853 corr_cb=-0.3998
[EPOCH 049/089] train: loss=0.6825 acc=83.09% | val: loss=0.8654 acc=60.24% f1=66.67% auc=60.64% val_score=48.4480 val_score_bestthr=63.0921 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.149, mb=0.493, no=0.985, corr=-0.400) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 63.0921
[DBG][ep=050] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.1477 mb_mean=0.4892 norm_overlap=0.9908 corr_cb=-0.2772 topkJ=0.0238
[TRAIN][ep=050] loss=0.6537 acc=86.31%
[TRAIN][ep=050] mask_avg: mc_mean=0.1202 mb_mean=0.4928 norm_overlap=0.9840 corr_cb=-0.3818
[EPOCH 050/089] train: loss=0.6537 acc=86.31% | val: loss=0.8373 acc=57.83% f1=67.89% auc=60.47% val_score=53.0366 val_score_bestthr=62.9297 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.120, mb=0.493, no=0.984, corr=-0.382) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 62.9297
[DBG][ep=051] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.1251 mb_mean=0.4934 norm_overlap=0.9815 corr_cb=-0.4368 topkJ=0.0037
[TRAIN][ep=051] loss=0.6501 acc=86.44%
[TRAIN][ep=051] mask_avg: mc_mean=0.1202 mb_mean=0.4928 norm_overlap=0.9837 corr_cb=-0.3862
[EPOCH 051/089] train: loss=0.6501 acc=86.44% | val: loss=0.8444 acc=57.83% f1=67.89% auc=60.17% val_score=49.7252 val_score_bestthr=62.9297 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.120, mb=0.493, no=0.984, corr=-0.386) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 62.9297
[DBG][ep=052] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.1559 mb_mean=0.4942 norm_overlap=0.9777 corr_cb=-0.4857 topkJ=0.0056
[TRAIN][ep=052] loss=0.6520 acc=84.70%
[TRAIN][ep=052] mask_avg: mc_mean=0.1202 mb_mean=0.4928 norm_overlap=0.9840 corr_cb=-0.3805
[EPOCH 052/089] train: loss=0.6520 acc=84.70% | val: loss=0.8511 acc=57.83% f1=68.47% auc=60.64% val_score=49.5843 val_score_bestthr=59.5567 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.120, mb=0.493, no=0.984, corr=-0.381) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 59.5567
[DBG][ep=053] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.1572 mb_mean=0.4891 norm_overlap=0.9887 corr_cb=-0.3502 topkJ=0.0090
[TRAIN][ep=053] loss=0.6547 acc=83.36%
[TRAIN][ep=053] mask_avg: mc_mean=0.1202 mb_mean=0.4928 norm_overlap=0.9839 corr_cb=-0.3833
[EPOCH 053/089] train: loss=0.6547 acc=83.36% | val: loss=0.8560 acc=60.24% f1=67.33% auc=60.99% val_score=49.4228 val_score_bestthr=62.5513 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.120, mb=0.493, no=0.984, corr=-0.383) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 62.5513
[DBG][ep=054] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=054] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=054] mask(step0): mc_mean=0.1408 mb_mean=0.4947 norm_overlap=0.9785 corr_cb=-0.4852 topkJ=0.0012
[TRAIN][ep=054] loss=0.6560 acc=83.76%
[TRAIN][ep=054] mask_avg: mc_mean=0.1201 mb_mean=0.4928 norm_overlap=0.9839 corr_cb=-0.3829
[EPOCH 054/089] train: loss=0.6560 acc=83.76% | val: loss=0.8625 acc=57.83% f1=68.47% auc=60.47% val_score=49.4228 val_score_bestthr=59.5567 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.120, mb=0.493, no=0.984, corr=-0.383) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 59.5567
[EARLY STOP] no improvement for 30 epochs. best_epoch=24
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
=============== FIT DONE ===============
[BEST] epoch=24 | val_acc=62.65% | val_f1=73.04% | val_auc=57.38% | val_score=49.5967 | val_score_bestthr=66.3367
[TEST@BEST] thr_used=0.470 | acc=62.80% f1=64.84% auc=66.83% | SP_sex=5.37% EO_sex=7.40% SP_age=13.96% EO_age=21.49%
[TIME] 1.47 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/summary_fold_1.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4925 mb_mean=0.4923 norm_overlap=1.0000 corr_cb=-0.0375 topkJ=0.0351
[TRAIN][ep=000] loss=0.6931 acc=51.01%
[TRAIN][ep=000] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0408
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4947 mb_mean=0.4925 norm_overlap=1.0000 corr_cb=0.0200 topkJ=0.0582
[TRAIN][ep=001] loss=0.6908 acc=53.02%
[TRAIN][ep=001] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0417
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4934 mb_mean=0.4912 norm_overlap=1.0000 corr_cb=-0.0761 topkJ=0.0212
[TRAIN][ep=002] loss=0.6911 acc=49.66%
[TRAIN][ep=002] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0335
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4946 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=0.0005 topkJ=0.0158
[TRAIN][ep=003] loss=0.6896 acc=55.97%
[TRAIN][ep=003] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0421
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4921 mb_mean=0.4935 norm_overlap=1.0000 corr_cb=0.0308 topkJ=0.0456
[TRAIN][ep=004] loss=0.6890 acc=57.05%
[TRAIN][ep=004] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0492
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4956 mb_mean=0.4905 norm_overlap=1.0000 corr_cb=-0.0217 topkJ=0.0255
[TRAIN][ep=005] loss=0.6854 acc=57.72%
[TRAIN][ep=005] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0414
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4955 mb_mean=0.4935 norm_overlap=1.0001 corr_cb=0.1792 topkJ=0.2987
[TRAIN][ep=006] loss=0.6823 acc=57.99%
[TRAIN][ep=006] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0439
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4934 mb_mean=0.4926 norm_overlap=1.0000 corr_cb=0.0730 topkJ=0.0188
[TRAIN][ep=007] loss=0.6802 acc=62.28%
[TRAIN][ep=007] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0419
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4941 mb_mean=0.4951 norm_overlap=1.0000 corr_cb=-0.0577 topkJ=0.0403
[TRAIN][ep=008] loss=0.6804 acc=57.32%
[TRAIN][ep=008] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0461
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4928 mb_mean=0.4945 norm_overlap=1.0001 corr_cb=0.2081 topkJ=0.0622
[TRAIN][ep=009] loss=0.6765 acc=61.21%
[TRAIN][ep=009] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0400
================= FIT START (fold=1) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4924 mb_mean=0.4908 norm_overlap=1.0000 corr_cb=-0.0313 topkJ=0.0382
[TRAIN][ep=000] loss=0.6711 acc=61.88%
[TRAIN][ep=000] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0416
[EPOCH 000/089] train: loss=0.6711 acc=61.88% | val: loss=0.6902 acc=57.83% f1=69.57% auc=53.02% val_score=42.9101 val_score_bestthr=56.8424 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.042) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 56.8424
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4945 mb_mean=0.4932 norm_overlap=1.0000 corr_cb=0.0532 topkJ=0.0351
[TRAIN][ep=001] loss=0.6648 acc=61.34%
[TRAIN][ep=001] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0445
[EPOCH 001/089] train: loss=0.6648 acc=61.34% | val: loss=0.6900 acc=55.42% f1=69.92% auc=52.09% val_score=43.0198 val_score_bestthr=62.6871 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.045) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 56.8424 -> 62.6871
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4957 mb_mean=0.4963 norm_overlap=1.0000 corr_cb=-0.0615 topkJ=0.0282
[TRAIN][ep=002] loss=0.6544 acc=65.23%
[TRAIN][ep=002] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0447
[EPOCH 002/089] train: loss=0.6544 acc=65.23% | val: loss=0.6914 acc=56.63% f1=69.49% auc=53.20% val_score=44.9705 val_score_bestthr=59.2265 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.045) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6871 -> 59.2265
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4968 mb_mean=0.4929 norm_overlap=0.9999 corr_cb=-0.1262 topkJ=0.0038
[TRAIN][ep=003] loss=0.6482 acc=64.30%
[TRAIN][ep=003] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0468
[EPOCH 003/089] train: loss=0.6482 acc=64.30% | val: loss=0.6942 acc=57.83% f1=69.57% auc=53.37% val_score=47.0193 val_score_bestthr=56.8424 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.047) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6871 -> 56.8424
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4915 mb_mean=0.4920 norm_overlap=1.0000 corr_cb=-0.0843 topkJ=0.0088
[TRAIN][ep=004] loss=0.6429 acc=63.49%
[TRAIN][ep=004] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0455
[EPOCH 004/089] train: loss=0.6429 acc=63.49% | val: loss=0.7003 acc=57.83% f1=68.47% auc=53.43% val_score=37.0298 val_score_bestthr=59.5284 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.046) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6871 -> 59.5284
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4942 mb_mean=0.4946 norm_overlap=0.9999 corr_cb=-0.1495 topkJ=0.0119
[TRAIN][ep=005] loss=1.2445 acc=63.89%
[TRAIN][ep=005] mask_avg: mc_mean=0.3719 mb_mean=0.4928 norm_overlap=0.9989 corr_cb=-0.3588
[EPOCH 005/089] train: loss=1.2445 acc=63.89% | val: loss=0.6938 acc=56.63% f1=70.49% auc=54.24% val_score=35.8021 val_score_bestthr=61.6282 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.372, mb=0.493, no=0.999, corr=-0.359) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6871 -> 61.6282
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2628 mb_mean=0.4960 norm_overlap=0.9957 corr_cb=-0.4897 topkJ=0.0031
[TRAIN][ep=006] loss=1.2298 acc=64.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.2319 mb_mean=0.4928 norm_overlap=0.9967 corr_cb=-0.4153
[EPOCH 006/089] train: loss=1.2298 acc=64.70% | val: loss=0.6932 acc=56.63% f1=70.00% auc=54.19% val_score=32.6091 val_score_bestthr=60.1401 | dyn(w_pfs=0.240, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.232, mb=0.493, no=0.997, corr=-0.415) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6871 -> 60.1401
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.1530 mb_mean=0.4992 norm_overlap=0.9951 corr_cb=-0.4564 topkJ=0.0118
[TRAIN][ep=007] loss=1.0326 acc=64.97%
[TRAIN][ep=007] mask_avg: mc_mean=0.1757 mb_mean=0.4928 norm_overlap=0.9952 corr_cb=-0.4153
[EPOCH 007/089] train: loss=1.0326 acc=64.97% | val: loss=0.7123 acc=56.63% f1=69.49% auc=54.01% val_score=38.5081 val_score_bestthr=58.9833 | dyn(w_pfs=0.140, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.176, mb=0.493, no=0.995, corr=-0.415) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6871 -> 58.9833
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1566 mb_mean=0.4901 norm_overlap=0.9953 corr_cb=-0.4106 topkJ=0.0141
[TRAIN][ep=008] loss=0.8195 acc=66.04%
[TRAIN][ep=008] mask_avg: mc_mean=0.1378 mb_mean=0.4928 norm_overlap=0.9935 corr_cb=-0.4296
[EPOCH 008/089] train: loss=0.8195 acc=66.04% | val: loss=0.7028 acc=56.63% f1=70.49% auc=54.24% val_score=39.9031 val_score_bestthr=61.6282 | dyn(w_pfs=0.040, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.138, mb=0.493, no=0.993, corr=-0.430) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6871 -> 61.6282
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1013 mb_mean=0.4926 norm_overlap=0.9922 corr_cb=-0.3897 topkJ=0.0202
[TRAIN][ep=009] loss=0.7938 acc=62.82%
[TRAIN][ep=009] mask_avg: mc_mean=0.1068 mb_mean=0.4928 norm_overlap=0.9916 corr_cb=-0.4258
[EPOCH 009/089] train: loss=0.7938 acc=62.82% | val: loss=0.7074 acc=57.83% f1=66.02% auc=54.65% val_score=37.8324 val_score_bestthr=61.3809 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.107, mb=0.493, no=0.992, corr=-0.426) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6871 -> 61.3809
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.0789 mb_mean=0.4963 norm_overlap=0.9911 corr_cb=-0.4607 topkJ=0.0035
[TRAIN][ep=010] loss=0.7748 acc=65.23%
[TRAIN][ep=010] mask_avg: mc_mean=0.0864 mb_mean=0.4928 norm_overlap=0.9903 corr_cb=-0.4092
[EPOCH 010/089] train: loss=0.7748 acc=65.23% | val: loss=0.7020 acc=57.83% f1=70.59% auc=54.48% val_score=49.1388 val_score_bestthr=59.6647 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.086, mb=0.493, no=0.990, corr=-0.409) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6871 -> 59.6647
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.0637 mb_mean=0.4924 norm_overlap=0.9907 corr_cb=-0.3414 topkJ=0.0111
[TRAIN][ep=011] loss=0.7600 acc=66.17%
[TRAIN][ep=011] mask_avg: mc_mean=0.0742 mb_mean=0.4928 norm_overlap=0.9889 corr_cb=-0.4042
[EPOCH 011/089] train: loss=0.7600 acc=66.17% | val: loss=0.7036 acc=56.63% f1=69.49% auc=55.06% val_score=44.4311 val_score_bestthr=59.2265 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.074, mb=0.493, no=0.989, corr=-0.404) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6871 -> 59.2265
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.0634 mb_mean=0.4959 norm_overlap=0.9866 corr_cb=-0.4317 topkJ=0.0100
[TRAIN][ep=012] loss=0.7540 acc=69.53%
[TRAIN][ep=012] mask_avg: mc_mean=0.0656 mb_mean=0.4928 norm_overlap=0.9871 corr_cb=-0.4018
[EPOCH 012/089] train: loss=0.7540 acc=69.53% | val: loss=0.7066 acc=56.63% f1=69.49% auc=55.17% val_score=41.4230 val_score_bestthr=59.2265 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.066, mb=0.493, no=0.987, corr=-0.402) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6871 -> 59.2265
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.0344 mb_mean=0.4973 norm_overlap=0.9830 corr_cb=-0.3860 topkJ=0.0016
[TRAIN][ep=013] loss=0.7676 acc=66.44%
[TRAIN][ep=013] mask_avg: mc_mean=0.0541 mb_mean=0.4928 norm_overlap=0.9853 corr_cb=-0.3841
[EPOCH 013/089] train: loss=0.7676 acc=66.44% | val: loss=0.7052 acc=60.24% f1=67.33% auc=55.58% val_score=42.0277 val_score_bestthr=65.0202 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.054, mb=0.493, no=0.985, corr=-0.384) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 62.6871 -> 65.0202
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.0428 mb_mean=0.4931 norm_overlap=0.9814 corr_cb=-0.4456 topkJ=0.0075
[TRAIN][ep=014] loss=0.7356 acc=70.07%
[TRAIN][ep=014] mask_avg: mc_mean=0.0539 mb_mean=0.4928 norm_overlap=0.9843 corr_cb=-0.3902
[EPOCH 014/089] train: loss=0.7356 acc=70.07% | val: loss=0.7286 acc=56.63% f1=70.49% auc=54.48% val_score=36.0552 val_score_bestthr=64.1779 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.054, mb=0.493, no=0.984, corr=-0.390) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.0202 -> 64.1779
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.0697 mb_mean=0.4915 norm_overlap=0.9895 corr_cb=-0.3689 topkJ=0.0122
[TRAIN][ep=015] loss=0.7394 acc=68.19%
[TRAIN][ep=015] mask_avg: mc_mean=0.0486 mb_mean=0.4928 norm_overlap=0.9826 corr_cb=-0.3764
[EPOCH 015/089] train: loss=0.7394 acc=68.19% | val: loss=0.7285 acc=60.24% f1=70.80% auc=54.13% val_score=47.3350 val_score_bestthr=61.4456 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.049, mb=0.493, no=0.983, corr=-0.376) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.0202 -> 61.4456
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.0519 mb_mean=0.4960 norm_overlap=0.9779 corr_cb=-0.4317 topkJ=0.0008
[TRAIN][ep=016] loss=0.7269 acc=69.93%
[TRAIN][ep=016] mask_avg: mc_mean=0.0606 mb_mean=0.4928 norm_overlap=0.9829 corr_cb=-0.4079
[EPOCH 016/089] train: loss=0.7269 acc=69.93% | val: loss=0.7144 acc=60.24% f1=71.79% auc=55.41% val_score=37.6109 val_score_bestthr=62.2198 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.061, mb=0.493, no=0.983, corr=-0.408) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.0202 -> 62.2198
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.0644 mb_mean=0.4935 norm_overlap=0.9813 corr_cb=-0.4653 topkJ=0.0044
[TRAIN][ep=017] loss=0.7264 acc=69.53%
[TRAIN][ep=017] mask_avg: mc_mean=0.0612 mb_mean=0.4928 norm_overlap=0.9823 corr_cb=-0.4038
[EPOCH 017/089] train: loss=0.7264 acc=69.53% | val: loss=0.7295 acc=60.24% f1=71.79% auc=54.65% val_score=53.4880 val_score_bestthr=62.4506 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.061, mb=0.493, no=0.982, corr=-0.404) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.0202 -> 62.4506
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.0539 mb_mean=0.4913 norm_overlap=0.9865 corr_cb=-0.3157 topkJ=0.0095
[TRAIN][ep=018] loss=0.7118 acc=71.81%
[TRAIN][ep=018] mask_avg: mc_mean=0.0566 mb_mean=0.4928 norm_overlap=0.9814 corr_cb=-0.3968
[EPOCH 018/089] train: loss=0.7118 acc=71.81% | val: loss=0.7176 acc=61.45% f1=71.93% auc=55.41% val_score=46.9059 val_score_bestthr=65.6471 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.057, mb=0.493, no=0.981, corr=-0.397) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 65.0202 -> 65.6471
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.0797 mb_mean=0.4941 norm_overlap=0.9870 corr_cb=-0.3637 topkJ=0.0112
[TRAIN][ep=019] loss=0.7164 acc=70.47%
[TRAIN][ep=019] mask_avg: mc_mean=0.0672 mb_mean=0.4928 norm_overlap=0.9815 corr_cb=-0.4182
[EPOCH 019/089] train: loss=0.7164 acc=70.47% | val: loss=0.7306 acc=61.45% f1=71.93% auc=55.29% val_score=44.2360 val_score_bestthr=65.6471 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.067, mb=0.493, no=0.982, corr=-0.418) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6471 -> 65.6471
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.0933 mb_mean=0.4898 norm_overlap=0.9864 corr_cb=-0.3904 topkJ=0.0051
[TRAIN][ep=020] loss=0.7067 acc=73.02%
[TRAIN][ep=020] mask_avg: mc_mean=0.0769 mb_mean=0.4928 norm_overlap=0.9817 corr_cb=-0.4348
[EPOCH 020/089] train: loss=0.7067 acc=73.02% | val: loss=0.7455 acc=59.04% f1=70.69% auc=57.27% val_score=38.0330 val_score_bestthr=61.0958 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.077, mb=0.493, no=0.982, corr=-0.435) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6471 -> 61.0958
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.0723 mb_mean=0.4926 norm_overlap=0.9846 corr_cb=-0.4529 topkJ=0.0028
[TRAIN][ep=021] loss=0.6943 acc=72.21%
[TRAIN][ep=021] mask_avg: mc_mean=0.0868 mb_mean=0.4928 norm_overlap=0.9821 corr_cb=-0.4431
[EPOCH 021/089] train: loss=0.6943 acc=72.21% | val: loss=0.7903 acc=60.24% f1=71.30% auc=56.92% val_score=44.4595 val_score_bestthr=62.5929 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.087, mb=0.493, no=0.982, corr=-0.443) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6471 -> 62.5929
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1004 mb_mean=0.4906 norm_overlap=0.9830 corr_cb=-0.4333 topkJ=0.0024
[TRAIN][ep=022] loss=0.7803 acc=71.68%
[TRAIN][ep=022] mask_avg: mc_mean=0.0781 mb_mean=0.4928 norm_overlap=0.9813 corr_cb=-0.4304
[EPOCH 022/089] train: loss=0.7803 acc=71.68% | val: loss=0.7256 acc=60.24% f1=71.30% auc=55.87% val_score=51.9917 val_score_bestthr=63.2773 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.078, mb=0.493, no=0.981, corr=-0.430) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6471 -> 63.2773
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.0688 mb_mean=0.4932 norm_overlap=0.9733 corr_cb=-0.4853 topkJ=0.0027
[TRAIN][ep=023] loss=0.6868 acc=72.62%
[TRAIN][ep=023] mask_avg: mc_mean=0.0809 mb_mean=0.4928 norm_overlap=0.9815 corr_cb=-0.4285
[EPOCH 023/089] train: loss=0.6868 acc=72.62% | val: loss=0.7209 acc=61.45% f1=71.93% auc=55.93% val_score=44.6594 val_score_bestthr=65.6471 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.081, mb=0.493, no=0.981, corr=-0.428) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6471 -> 65.6471
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.0822 mb_mean=0.4927 norm_overlap=0.9823 corr_cb=-0.4677 topkJ=0.0016
[TRAIN][ep=024] loss=0.6786 acc=73.96%
[TRAIN][ep=024] mask_avg: mc_mean=0.1011 mb_mean=0.4928 norm_overlap=0.9826 corr_cb=-0.4475
[EPOCH 024/089] train: loss=0.6786 acc=73.96% | val: loss=0.7126 acc=62.65% f1=73.04% auc=57.21% val_score=50.2239 val_score_bestthr=66.3367 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.101, mb=0.493, no=0.983, corr=-0.448) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 65.6471 -> 66.3367
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.0559 mb_mean=0.4924 norm_overlap=0.9826 corr_cb=-0.3793 topkJ=0.0047
[TRAIN][ep=025] loss=0.7531 acc=72.62%
[TRAIN][ep=025] mask_avg: mc_mean=0.0841 mb_mean=0.4928 norm_overlap=0.9813 corr_cb=-0.4212
[EPOCH 025/089] train: loss=0.7531 acc=72.62% | val: loss=0.7327 acc=60.24% f1=71.30% auc=56.98% val_score=46.6077 val_score_bestthr=63.2773 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.084, mb=0.493, no=0.981, corr=-0.421) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 63.2773
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.0960 mb_mean=0.4922 norm_overlap=0.9879 corr_cb=-0.3591 topkJ=0.0073
[TRAIN][ep=026] loss=0.8227 acc=74.36%
[TRAIN][ep=026] mask_avg: mc_mean=0.1117 mb_mean=0.4928 norm_overlap=0.9830 corr_cb=-0.4465
[EPOCH 026/089] train: loss=0.8227 acc=74.36% | val: loss=0.7598 acc=61.45% f1=71.93% auc=58.31% val_score=36.9843 val_score_bestthr=65.6471 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.112, mb=0.493, no=0.983, corr=-0.447) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 65.6471
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1401 mb_mean=0.4908 norm_overlap=0.9854 corr_cb=-0.3995 topkJ=0.0024
[TRAIN][ep=027] loss=0.8837 acc=75.03%
[TRAIN][ep=027] mask_avg: mc_mean=0.1063 mb_mean=0.4928 norm_overlap=0.9825 corr_cb=-0.4337
[EPOCH 027/089] train: loss=0.8837 acc=75.03% | val: loss=0.7374 acc=62.65% f1=73.04% auc=58.49% val_score=40.7238 val_score_bestthr=66.3367 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.106, mb=0.493, no=0.983, corr=-0.434) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 66.3367
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.0642 mb_mean=0.4955 norm_overlap=0.9774 corr_cb=-0.4140 topkJ=0.0032
[TRAIN][ep=028] loss=0.9633 acc=74.36%
[TRAIN][ep=028] mask_avg: mc_mean=0.0857 mb_mean=0.4928 norm_overlap=0.9810 corr_cb=-0.4053
[EPOCH 028/089] train: loss=0.9633 acc=74.36% | val: loss=0.7403 acc=60.24% f1=71.30% auc=57.73% val_score=41.0014 val_score_bestthr=63.2773 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.086, mb=0.493, no=0.981, corr=-0.405) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 63.2773
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.0814 mb_mean=0.4953 norm_overlap=0.9779 corr_cb=-0.5128 topkJ=0.0004
[TRAIN][ep=029] loss=1.0151 acc=76.51%
[TRAIN][ep=029] mask_avg: mc_mean=0.1235 mb_mean=0.4928 norm_overlap=0.9833 corr_cb=-0.4456
[EPOCH 029/089] train: loss=1.0151 acc=76.51% | val: loss=0.7398 acc=61.45% f1=71.93% auc=57.09% val_score=40.7228 val_score_bestthr=65.6471 | dyn(w_pfs=0.100, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.124, mb=0.493, no=0.983, corr=-0.446) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 65.6471
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.0664 mb_mean=0.4980 norm_overlap=0.9653 corr_cb=-0.5325 topkJ=0.0004
[TRAIN][ep=030] loss=0.8290 acc=74.50%
[TRAIN][ep=030] mask_avg: mc_mean=0.1006 mb_mean=0.4928 norm_overlap=0.9817 corr_cb=-0.4194
[EPOCH 030/089] train: loss=0.8290 acc=74.50% | val: loss=0.7379 acc=61.45% f1=71.93% auc=57.50% val_score=48.7783 val_score_bestthr=65.6471 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.101, mb=0.493, no=0.982, corr=-0.419) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 65.6471
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.1062 mb_mean=0.4927 norm_overlap=0.9775 corr_cb=-0.5142 topkJ=0.0023
[TRAIN][ep=031] loss=0.6525 acc=73.02%
[TRAIN][ep=031] mask_avg: mc_mean=0.0990 mb_mean=0.4928 norm_overlap=0.9816 corr_cb=-0.4180
[EPOCH 031/089] train: loss=0.6525 acc=73.02% | val: loss=0.7708 acc=60.24% f1=70.80% auc=58.90% val_score=42.8562 val_score_bestthr=61.4456 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.099, mb=0.493, no=0.982, corr=-0.418) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 61.4456
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1250 mb_mean=0.4887 norm_overlap=0.9885 corr_cb=-0.2749 topkJ=0.0225
[TRAIN][ep=032] loss=0.6329 acc=76.11%
[TRAIN][ep=032] mask_avg: mc_mean=0.1111 mb_mean=0.4928 norm_overlap=0.9825 corr_cb=-0.4246
[EPOCH 032/089] train: loss=0.6329 acc=76.11% | val: loss=0.7446 acc=60.24% f1=70.80% auc=58.37% val_score=49.7672 val_score_bestthr=61.4456 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.111, mb=0.493, no=0.983, corr=-0.425) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 61.4456
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1186 mb_mean=0.4927 norm_overlap=0.9793 corr_cb=-0.4487 topkJ=0.0043
[TRAIN][ep=033] loss=0.6166 acc=77.32%
[TRAIN][ep=033] mask_avg: mc_mean=0.1151 mb_mean=0.4928 norm_overlap=0.9826 corr_cb=-0.4278
[EPOCH 033/089] train: loss=0.6166 acc=77.32% | val: loss=0.7524 acc=60.24% f1=70.80% auc=58.31% val_score=45.1517 val_score_bestthr=61.4456 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.115, mb=0.493, no=0.983, corr=-0.428) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 61.4456
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1190 mb_mean=0.4908 norm_overlap=0.9869 corr_cb=-0.3563 topkJ=0.0131
[TRAIN][ep=034] loss=0.6111 acc=77.72%
[TRAIN][ep=034] mask_avg: mc_mean=0.1272 mb_mean=0.4928 norm_overlap=0.9834 corr_cb=-0.4310
[EPOCH 034/089] train: loss=0.6111 acc=77.72% | val: loss=0.7786 acc=61.45% f1=71.43% auc=58.31% val_score=50.0950 val_score_bestthr=62.5452 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.127, mb=0.493, no=0.983, corr=-0.431) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 62.5452
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.1360 mb_mean=0.4924 norm_overlap=0.9873 corr_cb=-0.4237 topkJ=0.0048
[TRAIN][ep=035] loss=0.6246 acc=77.05%
[TRAIN][ep=035] mask_avg: mc_mean=0.1140 mb_mean=0.4928 norm_overlap=0.9825 corr_cb=-0.4180
[EPOCH 035/089] train: loss=0.6246 acc=77.05% | val: loss=0.7810 acc=61.45% f1=71.43% auc=57.91% val_score=51.1072 val_score_bestthr=62.5452 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.114, mb=0.493, no=0.982, corr=-0.418) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 62.5452
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.1214 mb_mean=0.4918 norm_overlap=0.9870 corr_cb=-0.3190 topkJ=0.0032
[TRAIN][ep=036] loss=0.6130 acc=76.51%
[TRAIN][ep=036] mask_avg: mc_mean=0.1302 mb_mean=0.4928 norm_overlap=0.9834 corr_cb=-0.4284
[EPOCH 036/089] train: loss=0.6130 acc=76.51% | val: loss=0.7637 acc=60.24% f1=69.72% auc=59.19% val_score=48.0194 val_score_bestthr=63.3103 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.130, mb=0.493, no=0.983, corr=-0.428) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 63.3103
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1360 mb_mean=0.4913 norm_overlap=0.9782 corr_cb=-0.4713 topkJ=0.0000
[TRAIN][ep=037] loss=0.6083 acc=77.32%
[TRAIN][ep=037] mask_avg: mc_mean=0.1299 mb_mean=0.4928 norm_overlap=0.9833 corr_cb=-0.4269
[EPOCH 037/089] train: loss=0.6083 acc=77.32% | val: loss=0.8153 acc=60.24% f1=68.57% auc=59.30% val_score=44.4953 val_score_bestthr=60.8641 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.130, mb=0.493, no=0.983, corr=-0.427) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 60.8641
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.1443 mb_mean=0.4918 norm_overlap=0.9841 corr_cb=-0.4126 topkJ=0.0044
[TRAIN][ep=038] loss=0.5938 acc=77.45%
[TRAIN][ep=038] mask_avg: mc_mean=0.1228 mb_mean=0.4928 norm_overlap=0.9831 corr_cb=-0.4170
[EPOCH 038/089] train: loss=0.5938 acc=77.45% | val: loss=0.7707 acc=61.45% f1=69.81% auc=59.53% val_score=45.7603 val_score_bestthr=61.9101 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.123, mb=0.493, no=0.983, corr=-0.417) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 61.9101
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.1423 mb_mean=0.4933 norm_overlap=0.9765 corr_cb=-0.5324 topkJ=0.0000
[TRAIN][ep=039] loss=0.5862 acc=77.72%
[TRAIN][ep=039] mask_avg: mc_mean=0.1377 mb_mean=0.4928 norm_overlap=0.9837 corr_cb=-0.4278
[EPOCH 039/089] train: loss=0.5862 acc=77.72% | val: loss=0.8483 acc=59.04% f1=67.92% auc=60.00% val_score=47.7707 val_score_bestthr=60.4580 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.138, mb=0.493, no=0.984, corr=-0.428) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 60.4580
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.1370 mb_mean=0.4926 norm_overlap=0.9801 corr_cb=-0.4909 topkJ=0.0035
[TRAIN][ep=040] loss=0.5723 acc=80.81%
[TRAIN][ep=040] mask_avg: mc_mean=0.1435 mb_mean=0.4928 norm_overlap=0.9843 corr_cb=-0.4229
[EPOCH 040/089] train: loss=0.5723 acc=80.81% | val: loss=0.8204 acc=60.24% f1=69.72% auc=59.24% val_score=47.2272 val_score_bestthr=63.3103 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.144, mb=0.493, no=0.984, corr=-0.423) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 63.3103
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.1645 mb_mean=0.4934 norm_overlap=0.9875 corr_cb=-0.3842 topkJ=0.0020
[TRAIN][ep=041] loss=0.5599 acc=81.88%
[TRAIN][ep=041] mask_avg: mc_mean=0.1288 mb_mean=0.4928 norm_overlap=0.9833 corr_cb=-0.4160
[EPOCH 041/089] train: loss=0.5599 acc=81.88% | val: loss=0.8197 acc=56.63% f1=70.00% auc=60.12% val_score=50.6024 val_score_bestthr=62.1241 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.129, mb=0.493, no=0.983, corr=-0.416) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 62.1241
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.1958 mb_mean=0.4932 norm_overlap=0.9840 corr_cb=-0.5181 topkJ=0.0008
[TRAIN][ep=042] loss=0.5785 acc=79.46%
[TRAIN][ep=042] mask_avg: mc_mean=0.1282 mb_mean=0.4928 norm_overlap=0.9833 corr_cb=-0.4138
[EPOCH 042/089] train: loss=0.5785 acc=79.46% | val: loss=0.7946 acc=59.04% f1=68.52% auc=59.88% val_score=52.6212 val_score_bestthr=64.8531 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.128, mb=0.493, no=0.983, corr=-0.414) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 64.8531
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.1148 mb_mean=0.4932 norm_overlap=0.9789 corr_cb=-0.4372 topkJ=0.0012
[TRAIN][ep=043] loss=0.5573 acc=79.60%
[TRAIN][ep=043] mask_avg: mc_mean=0.1369 mb_mean=0.4928 norm_overlap=0.9838 corr_cb=-0.4204
[EPOCH 043/089] train: loss=0.5573 acc=79.60% | val: loss=0.9064 acc=54.22% f1=66.67% auc=60.35% val_score=44.3663 val_score_bestthr=57.5933 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.137, mb=0.493, no=0.984, corr=-0.420) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 57.5933
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.1528 mb_mean=0.4931 norm_overlap=0.9845 corr_cb=-0.4432 topkJ=0.0020
[TRAIN][ep=044] loss=0.5737 acc=79.87%
[TRAIN][ep=044] mask_avg: mc_mean=0.1153 mb_mean=0.4928 norm_overlap=0.9827 corr_cb=-0.3988
[EPOCH 044/089] train: loss=0.5737 acc=79.87% | val: loss=0.8004 acc=60.24% f1=69.72% auc=59.83% val_score=51.1251 val_score_bestthr=60.6347 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.115, mb=0.493, no=0.983, corr=-0.399) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 60.6347
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.1176 mb_mean=0.4935 norm_overlap=0.9872 corr_cb=-0.3640 topkJ=0.0032
[TRAIN][ep=045] loss=0.5392 acc=81.48%
[TRAIN][ep=045] mask_avg: mc_mean=0.1386 mb_mean=0.4928 norm_overlap=0.9840 corr_cb=-0.4101
[EPOCH 045/089] train: loss=0.5392 acc=81.48% | val: loss=0.8593 acc=60.24% f1=67.96% auc=59.65% val_score=51.0146 val_score_bestthr=59.9950 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.139, mb=0.493, no=0.984, corr=-0.410) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 59.9950
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.1763 mb_mean=0.4928 norm_overlap=0.9837 corr_cb=-0.4438 topkJ=0.0039
[TRAIN][ep=046] loss=0.5402 acc=79.87%
[TRAIN][ep=046] mask_avg: mc_mean=0.1607 mb_mean=0.4928 norm_overlap=0.9854 corr_cb=-0.4151
[EPOCH 046/089] train: loss=0.5402 acc=79.87% | val: loss=0.8189 acc=61.45% f1=70.37% auc=61.10% val_score=49.4714 val_score_bestthr=63.2920 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.161, mb=0.493, no=0.985, corr=-0.415) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 63.2920
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.1072 mb_mean=0.4929 norm_overlap=0.9779 corr_cb=-0.4455 topkJ=0.0012
[TRAIN][ep=047] loss=0.5534 acc=79.87%
[TRAIN][ep=047] mask_avg: mc_mean=0.1341 mb_mean=0.4928 norm_overlap=0.9838 corr_cb=-0.4071
[EPOCH 047/089] train: loss=0.5534 acc=79.87% | val: loss=0.8402 acc=59.04% f1=69.09% auc=60.00% val_score=48.4714 val_score_bestthr=60.6548 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.134, mb=0.493, no=0.984, corr=-0.407) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 60.6548
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.1558 mb_mean=0.4913 norm_overlap=0.9906 corr_cb=-0.3400 topkJ=0.0109
[TRAIN][ep=048] loss=0.5514 acc=81.21%
[TRAIN][ep=048] mask_avg: mc_mean=0.1357 mb_mean=0.4928 norm_overlap=0.9844 corr_cb=-0.3979
[EPOCH 048/089] train: loss=0.5514 acc=81.21% | val: loss=0.8262 acc=61.45% f1=69.81% auc=60.70% val_score=60.3426 val_score_bestthr=67.5295 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.136, mb=0.493, no=0.984, corr=-0.398) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 66.3367 -> 67.5295
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=049] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.0866 mb_mean=0.4987 norm_overlap=0.9742 corr_cb=-0.5338 topkJ=0.0019
[TRAIN][ep=049] loss=0.5961 acc=82.68%
[TRAIN][ep=049] mask_avg: mc_mean=0.1470 mb_mean=0.4928 norm_overlap=0.9848 corr_cb=-0.4044
[EPOCH 049/089] train: loss=0.5961 acc=82.68% | val: loss=0.8586 acc=60.24% f1=66.67% auc=60.70% val_score=51.1033 val_score_bestthr=63.0921 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.147, mb=0.493, no=0.985, corr=-0.404) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 63.0921
[DBG][ep=050] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.1470 mb_mean=0.4892 norm_overlap=0.9906 corr_cb=-0.2829 topkJ=0.0230
[TRAIN][ep=050] loss=0.5123 acc=85.64%
[TRAIN][ep=050] mask_avg: mc_mean=0.1193 mb_mean=0.4928 norm_overlap=0.9836 corr_cb=-0.3856
[EPOCH 050/089] train: loss=0.5123 acc=85.64% | val: loss=0.8358 acc=59.04% f1=68.52% auc=60.23% val_score=49.7252 val_score_bestthr=63.3088 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.984, corr=-0.386) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 63.3088
[DBG][ep=051] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.1245 mb_mean=0.4934 norm_overlap=0.9812 corr_cb=-0.4382 topkJ=0.0037
[TRAIN][ep=051] loss=0.4922 acc=86.04%
[TRAIN][ep=051] mask_avg: mc_mean=0.1193 mb_mean=0.4928 norm_overlap=0.9833 corr_cb=-0.3901
[EPOCH 051/089] train: loss=0.4922 acc=86.04% | val: loss=0.8432 acc=60.24% f1=67.33% auc=60.23% val_score=49.7252 val_score_bestthr=61.6745 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.983, corr=-0.390) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 61.6745
[DBG][ep=052] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.1557 mb_mean=0.4942 norm_overlap=0.9773 corr_cb=-0.4894 topkJ=0.0048
[TRAIN][ep=052] loss=0.4938 acc=85.23%
[TRAIN][ep=052] mask_avg: mc_mean=0.1194 mb_mean=0.4928 norm_overlap=0.9836 corr_cb=-0.3845
[EPOCH 052/089] train: loss=0.4938 acc=85.23% | val: loss=0.8492 acc=61.45% f1=68.63% auc=60.47% val_score=49.5843 val_score_bestthr=61.0714 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.984, corr=-0.384) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 61.0714
[DBG][ep=053] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.1563 mb_mean=0.4891 norm_overlap=0.9884 corr_cb=-0.3542 topkJ=0.0086
[TRAIN][ep=053] loss=0.4964 acc=83.09%
[TRAIN][ep=053] mask_avg: mc_mean=0.1193 mb_mean=0.4928 norm_overlap=0.9834 corr_cb=-0.3872
[EPOCH 053/089] train: loss=0.4964 acc=83.09% | val: loss=0.8547 acc=61.45% f1=68.63% auc=60.76% val_score=49.4228 val_score_bestthr=61.0714 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.983, corr=-0.387) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 61.0714
[DBG][ep=054] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=054] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=054] mask(step0): mc_mean=0.1402 mb_mean=0.4947 norm_overlap=0.9781 corr_cb=-0.4865 topkJ=0.0008
[TRAIN][ep=054] loss=0.4987 acc=83.76%
[TRAIN][ep=054] mask_avg: mc_mean=0.1193 mb_mean=0.4928 norm_overlap=0.9835 corr_cb=-0.3868
[EPOCH 054/089] train: loss=0.4987 acc=83.76% | val: loss=0.8602 acc=57.83% f1=67.89% auc=60.06% val_score=49.4228 val_score_bestthr=62.9297 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.984, corr=-0.387) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 62.9297
[DBG][ep=055] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=055] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=055] mask(step0): mc_mean=0.1401 mb_mean=0.4973 norm_overlap=0.9753 corr_cb=-0.5115 topkJ=0.0028
[TRAIN][ep=055] loss=0.4913 acc=84.97%
[TRAIN][ep=055] mask_avg: mc_mean=0.1193 mb_mean=0.4928 norm_overlap=0.9833 corr_cb=-0.3897
[EPOCH 055/089] train: loss=0.4913 acc=84.97% | val: loss=0.8665 acc=57.83% f1=67.89% auc=59.88% val_score=49.4228 val_score_bestthr=62.9297 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.983, corr=-0.390) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 62.9297
[DBG][ep=056] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=056] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=056] mask(step0): mc_mean=0.0889 mb_mean=0.4947 norm_overlap=0.9787 corr_cb=-0.4697 topkJ=0.0047
[TRAIN][ep=056] loss=0.4825 acc=85.64%
[TRAIN][ep=056] mask_avg: mc_mean=0.1193 mb_mean=0.4928 norm_overlap=0.9833 corr_cb=-0.3904
[EPOCH 056/089] train: loss=0.4825 acc=85.64% | val: loss=0.8723 acc=57.83% f1=68.47% auc=59.88% val_score=49.4228 val_score_bestthr=59.5567 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.983, corr=-0.390) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 59.5567
[DBG][ep=057] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=057] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=057] mask(step0): mc_mean=0.1210 mb_mean=0.4919 norm_overlap=0.9771 corr_cb=-0.5217 topkJ=0.0024
[TRAIN][ep=057] loss=0.4848 acc=85.91%
[TRAIN][ep=057] mask_avg: mc_mean=0.1193 mb_mean=0.4928 norm_overlap=0.9835 corr_cb=-0.3870
[EPOCH 057/089] train: loss=0.4848 acc=85.91% | val: loss=0.8728 acc=57.83% f1=67.89% auc=59.94% val_score=49.5843 val_score_bestthr=62.9297 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.984, corr=-0.387) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 62.9297
[DBG][ep=058] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=058] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=058] mask(step0): mc_mean=0.1334 mb_mean=0.4906 norm_overlap=0.9845 corr_cb=-0.3153 topkJ=0.0060
[TRAIN][ep=058] loss=0.4867 acc=85.77%
[TRAIN][ep=058] mask_avg: mc_mean=0.1194 mb_mean=0.4928 norm_overlap=0.9835 corr_cb=-0.3875
[EPOCH 058/089] train: loss=0.4867 acc=85.77% | val: loss=0.8786 acc=57.83% f1=67.89% auc=60.12% val_score=49.4228 val_score_bestthr=62.9297 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.984, corr=-0.388) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 62.9297
[DBG][ep=059] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=059] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=059] mask(step0): mc_mean=0.1116 mb_mean=0.4954 norm_overlap=0.9824 corr_cb=-0.4402 topkJ=0.0039
[TRAIN][ep=059] loss=0.4883 acc=84.56%
[TRAIN][ep=059] mask_avg: mc_mean=0.1194 mb_mean=0.4928 norm_overlap=0.9834 corr_cb=-0.3882
[EPOCH 059/089] train: loss=0.4883 acc=84.56% | val: loss=0.8927 acc=57.83% f1=68.47% auc=60.29% val_score=49.4228 val_score_bestthr=59.5567 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.983, corr=-0.388) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 59.5567
[DBG][ep=060] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=060] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=060] mask(step0): mc_mean=0.1488 mb_mean=0.4903 norm_overlap=0.9880 corr_cb=-0.3284 topkJ=0.0150
[TRAIN][ep=060] loss=0.4816 acc=85.10%
[TRAIN][ep=060] mask_avg: mc_mean=0.1193 mb_mean=0.4928 norm_overlap=0.9834 corr_cb=-0.3886
[EPOCH 060/089] train: loss=0.4816 acc=85.10% | val: loss=0.8817 acc=57.83% f1=68.47% auc=59.88% val_score=50.8286 val_score_bestthr=59.5567 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.983, corr=-0.389) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 59.5567
[DBG][ep=061] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=061] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=061] mask(step0): mc_mean=0.1179 mb_mean=0.4946 norm_overlap=0.9830 corr_cb=-0.3325 topkJ=0.0122
[TRAIN][ep=061] loss=0.4813 acc=85.50%
[TRAIN][ep=061] mask_avg: mc_mean=0.1193 mb_mean=0.4928 norm_overlap=0.9836 corr_cb=-0.3863
[EPOCH 061/089] train: loss=0.4813 acc=85.50% | val: loss=0.9078 acc=57.83% f1=68.47% auc=60.35% val_score=43.2858 val_score_bestthr=59.5567 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.984, corr=-0.386) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 59.5567
[DBG][ep=062] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=062] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=062] mask(step0): mc_mean=0.0992 mb_mean=0.4954 norm_overlap=0.9814 corr_cb=-0.3953 topkJ=0.0035
[TRAIN][ep=062] loss=0.4776 acc=86.17%
[TRAIN][ep=062] mask_avg: mc_mean=0.1193 mb_mean=0.4928 norm_overlap=0.9836 corr_cb=-0.3864
[EPOCH 062/089] train: loss=0.4776 acc=86.17% | val: loss=0.8970 acc=57.83% f1=67.89% auc=60.06% val_score=50.2633 val_score_bestthr=62.9297 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.984, corr=-0.386) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 62.9297
[DBG][ep=063] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=063] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=063] mask(step0): mc_mean=0.1590 mb_mean=0.4933 norm_overlap=0.9860 corr_cb=-0.3758 topkJ=0.0031
[TRAIN][ep=063] loss=0.4791 acc=84.70%
[TRAIN][ep=063] mask_avg: mc_mean=0.1193 mb_mean=0.4928 norm_overlap=0.9836 corr_cb=-0.3836
[EPOCH 063/089] train: loss=0.4791 acc=84.70% | val: loss=0.8956 acc=59.04% f1=68.52% auc=60.17% val_score=50.2633 val_score_bestthr=64.4288 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.984, corr=-0.384) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 64.4288
[DBG][ep=064] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=064] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=064] mask(step0): mc_mean=0.1107 mb_mean=0.4912 norm_overlap=0.9884 corr_cb=-0.3027 topkJ=0.0185
[TRAIN][ep=064] loss=0.4812 acc=84.83%
[TRAIN][ep=064] mask_avg: mc_mean=0.1193 mb_mean=0.4928 norm_overlap=0.9835 corr_cb=-0.3852
[EPOCH 064/089] train: loss=0.4812 acc=84.83% | val: loss=0.9089 acc=57.83% f1=68.47% auc=60.41% val_score=43.2858 val_score_bestthr=59.5567 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.984, corr=-0.385) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 59.5567
[DBG][ep=065] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=065] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=065] mask(step0): mc_mean=0.1327 mb_mean=0.4916 norm_overlap=0.9858 corr_cb=-0.3391 topkJ=0.0047
[TRAIN][ep=065] loss=0.4720 acc=86.17%
[TRAIN][ep=065] mask_avg: mc_mean=0.1193 mb_mean=0.4928 norm_overlap=0.9834 corr_cb=-0.3873
[EPOCH 065/089] train: loss=0.4720 acc=86.17% | val: loss=0.8989 acc=57.83% f1=68.47% auc=60.06% val_score=49.4228 val_score_bestthr=59.5567 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.983, corr=-0.387) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 59.5567
[DBG][ep=066] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=066] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=066] mask(step0): mc_mean=0.0926 mb_mean=0.4938 norm_overlap=0.9887 corr_cb=-0.2647 topkJ=0.0117
[TRAIN][ep=066] loss=0.4733 acc=85.37%
[TRAIN][ep=066] mask_avg: mc_mean=0.1193 mb_mean=0.4928 norm_overlap=0.9834 corr_cb=-0.3868
[EPOCH 066/089] train: loss=0.4733 acc=85.37% | val: loss=0.9655 acc=60.24% f1=65.98% auc=60.93% val_score=47.5140 val_score_bestthr=59.4201 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.983, corr=-0.387) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 59.4201
[DBG][ep=067] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=067] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=067] mask(step0): mc_mean=0.0991 mb_mean=0.4953 norm_overlap=0.9802 corr_cb=-0.4536 topkJ=0.0024
[TRAIN][ep=067] loss=0.4786 acc=86.04%
[TRAIN][ep=067] mask_avg: mc_mean=0.1193 mb_mean=0.4928 norm_overlap=0.9834 corr_cb=-0.3879
[EPOCH 067/089] train: loss=0.4786 acc=86.04% | val: loss=0.9107 acc=59.04% f1=67.92% auc=60.52% val_score=49.4228 val_score_bestthr=60.4580 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.983, corr=-0.388) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 60.4580
[DBG][ep=068] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=068] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=068] mask(step0): mc_mean=0.1162 mb_mean=0.4925 norm_overlap=0.9811 corr_cb=-0.3947 topkJ=0.0229
[TRAIN][ep=068] loss=0.4702 acc=85.77%
[TRAIN][ep=068] mask_avg: mc_mean=0.1193 mb_mean=0.4928 norm_overlap=0.9833 corr_cb=-0.3887
[EPOCH 068/089] train: loss=0.4702 acc=85.77% | val: loss=0.9106 acc=57.83% f1=68.47% auc=60.35% val_score=49.4228 val_score_bestthr=59.5567 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.983, corr=-0.389) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 59.5567
[DBG][ep=069] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=069] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=069] mask(step0): mc_mean=0.1205 mb_mean=0.4924 norm_overlap=0.9801 corr_cb=-0.4281 topkJ=0.0036
[TRAIN][ep=069] loss=0.4681 acc=86.58%
[TRAIN][ep=069] mask_avg: mc_mean=0.1193 mb_mean=0.4928 norm_overlap=0.9834 corr_cb=-0.3886
[EPOCH 069/089] train: loss=0.4681 acc=86.58% | val: loss=0.9117 acc=57.83% f1=67.89% auc=60.35% val_score=48.1986 val_score_bestthr=62.9297 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.983, corr=-0.389) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 62.9297
[DBG][ep=070] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=070] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=070] mask(step0): mc_mean=0.0896 mb_mean=0.4930 norm_overlap=0.9854 corr_cb=-0.3544 topkJ=0.0092
[TRAIN][ep=070] loss=0.4669 acc=86.71%
[TRAIN][ep=070] mask_avg: mc_mean=0.1194 mb_mean=0.4928 norm_overlap=0.9836 corr_cb=-0.3828
[EPOCH 070/089] train: loss=0.4669 acc=86.71% | val: loss=0.9341 acc=60.24% f1=67.96% auc=60.81% val_score=43.2858 val_score_bestthr=60.6866 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.984, corr=-0.383) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 60.6866
[DBG][ep=071] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=071] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=071] mask(step0): mc_mean=0.1004 mb_mean=0.4937 norm_overlap=0.9851 corr_cb=-0.3659 topkJ=0.0068
[TRAIN][ep=071] loss=0.4718 acc=85.50%
[TRAIN][ep=071] mask_avg: mc_mean=0.1193 mb_mean=0.4928 norm_overlap=0.9836 corr_cb=-0.3841
[EPOCH 071/089] train: loss=0.4718 acc=85.50% | val: loss=0.9141 acc=60.24% f1=67.96% auc=60.35% val_score=48.1986 val_score_bestthr=60.6866 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.984, corr=-0.384) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 60.6866
[DBG][ep=072] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=072] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=072] mask(step0): mc_mean=0.0950 mb_mean=0.4946 norm_overlap=0.9888 corr_cb=-0.2756 topkJ=0.0263
[TRAIN][ep=072] loss=0.4669 acc=86.04%
[TRAIN][ep=072] mask_avg: mc_mean=0.1194 mb_mean=0.4928 norm_overlap=0.9836 corr_cb=-0.3845
[EPOCH 072/089] train: loss=0.4669 acc=86.04% | val: loss=0.9385 acc=60.24% f1=67.33% auc=60.99% val_score=45.3156 val_score_bestthr=61.6745 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.984, corr=-0.384) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 61.6745
[DBG][ep=073] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=073] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=073] mask(step0): mc_mean=0.0825 mb_mean=0.4932 norm_overlap=0.9838 corr_cb=-0.3762 topkJ=0.0075
[TRAIN][ep=073] loss=0.4668 acc=86.44%
[TRAIN][ep=073] mask_avg: mc_mean=0.1194 mb_mean=0.4928 norm_overlap=0.9837 corr_cb=-0.3834
[EPOCH 073/089] train: loss=0.4668 acc=86.44% | val: loss=0.9303 acc=59.04% f1=66.67% auc=60.99% val_score=49.4228 val_score_bestthr=61.2907 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.984, corr=-0.383) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 61.2907
[DBG][ep=074] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=074] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=074] mask(step0): mc_mean=0.1343 mb_mean=0.4920 norm_overlap=0.9857 corr_cb=-0.3776 topkJ=0.0135
[TRAIN][ep=074] loss=0.4663 acc=85.77%
[TRAIN][ep=074] mask_avg: mc_mean=0.1193 mb_mean=0.4928 norm_overlap=0.9835 corr_cb=-0.3866
[EPOCH 074/089] train: loss=0.4663 acc=85.77% | val: loss=0.9235 acc=60.24% f1=67.96% auc=60.99% val_score=49.4228 val_score_bestthr=60.6866 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.984, corr=-0.387) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 60.6866
[DBG][ep=075] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=075] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=075] mask(step0): mc_mean=0.1000 mb_mean=0.4940 norm_overlap=0.9854 corr_cb=-0.3600 topkJ=0.0071
[TRAIN][ep=075] loss=0.4637 acc=86.17%
[TRAIN][ep=075] mask_avg: mc_mean=0.1193 mb_mean=0.4928 norm_overlap=0.9834 corr_cb=-0.3870
[EPOCH 075/089] train: loss=0.4637 acc=86.17% | val: loss=0.9251 acc=57.83% f1=67.89% auc=60.64% val_score=48.1986 val_score_bestthr=62.9297 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.983, corr=-0.387) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 62.9297
[DBG][ep=076] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=076] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=076] mask(step0): mc_mean=0.1133 mb_mean=0.4945 norm_overlap=0.9833 corr_cb=-0.4068 topkJ=0.0036
[TRAIN][ep=076] loss=0.4614 acc=85.64%
[TRAIN][ep=076] mask_avg: mc_mean=0.1193 mb_mean=0.4928 norm_overlap=0.9833 corr_cb=-0.3884
[EPOCH 076/089] train: loss=0.4614 acc=85.64% | val: loss=0.9292 acc=57.83% f1=67.89% auc=60.58% val_score=51.7639 val_score_bestthr=62.9297 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.983, corr=-0.388) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 62.9297
[DBG][ep=077] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=077] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=077] mask(step0): mc_mean=0.1269 mb_mean=0.4921 norm_overlap=0.9784 corr_cb=-0.4828 topkJ=0.0024
[TRAIN][ep=077] loss=0.4592 acc=86.44%
[TRAIN][ep=077] mask_avg: mc_mean=0.1194 mb_mean=0.4928 norm_overlap=0.9835 corr_cb=-0.3869
[EPOCH 077/089] train: loss=0.4592 acc=86.44% | val: loss=0.9316 acc=57.83% f1=67.89% auc=60.70% val_score=54.1630 val_score_bestthr=62.9297 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.983, corr=-0.387) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 62.9297
[DBG][ep=078] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=078] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=078] mask(step0): mc_mean=0.1349 mb_mean=0.4889 norm_overlap=0.9836 corr_cb=-0.3968 topkJ=0.0050
[TRAIN][ep=078] loss=0.4605 acc=86.17%
[TRAIN][ep=078] mask_avg: mc_mean=0.1193 mb_mean=0.4928 norm_overlap=0.9835 corr_cb=-0.3871
[EPOCH 078/089] train: loss=0.4605 acc=86.17% | val: loss=0.9339 acc=57.83% f1=67.89% auc=60.81% val_score=51.9342 val_score_bestthr=62.9297 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.119, mb=0.493, no=0.983, corr=-0.387) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5295 -> 62.9297
[EARLY STOP] no improvement for 30 epochs. best_epoch=48
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
=============== FIT DONE ===============
[BEST] epoch=48 | val_acc=61.45% | val_f1=69.81% | val_auc=60.70% | val_score=60.3426 | val_score_bestthr=67.5295
[TEST@BEST] thr_used=0.290 | acc=60.87% f1=68.97% auc=69.51% | SP_sex=0.93% EO_sex=2.05% SP_age=12.99% EO_age=17.47%
[TIME] 1.79 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/summary_fold_1.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4925 mb_mean=0.4923 norm_overlap=1.0000 corr_cb=-0.0375 topkJ=0.0351
[TRAIN][ep=000] loss=0.6931 acc=51.01%
[TRAIN][ep=000] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0408
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4947 mb_mean=0.4925 norm_overlap=1.0000 corr_cb=0.0200 topkJ=0.0582
[TRAIN][ep=001] loss=0.6908 acc=53.02%
[TRAIN][ep=001] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0417
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4934 mb_mean=0.4912 norm_overlap=1.0000 corr_cb=-0.0761 topkJ=0.0212
[TRAIN][ep=002] loss=0.6911 acc=49.66%
[TRAIN][ep=002] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0335
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4946 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=0.0005 topkJ=0.0158
[TRAIN][ep=003] loss=0.6896 acc=55.97%
[TRAIN][ep=003] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0421
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4921 mb_mean=0.4935 norm_overlap=1.0000 corr_cb=0.0308 topkJ=0.0456
[TRAIN][ep=004] loss=0.6890 acc=56.78%
[TRAIN][ep=004] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0492
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4956 mb_mean=0.4905 norm_overlap=1.0000 corr_cb=-0.0217 topkJ=0.0255
[TRAIN][ep=005] loss=0.6854 acc=57.72%
[TRAIN][ep=005] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0414
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4955 mb_mean=0.4935 norm_overlap=1.0001 corr_cb=0.1792 topkJ=0.2987
[TRAIN][ep=006] loss=0.6823 acc=57.99%
[TRAIN][ep=006] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0439
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4934 mb_mean=0.4926 norm_overlap=1.0000 corr_cb=0.0730 topkJ=0.0188
[TRAIN][ep=007] loss=0.6802 acc=62.28%
[TRAIN][ep=007] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0419
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4941 mb_mean=0.4951 norm_overlap=1.0000 corr_cb=-0.0577 topkJ=0.0403
[TRAIN][ep=008] loss=0.6804 acc=57.32%
[TRAIN][ep=008] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0461
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4928 mb_mean=0.4945 norm_overlap=1.0001 corr_cb=0.2081 topkJ=0.0622
[TRAIN][ep=009] loss=0.6765 acc=61.21%
[TRAIN][ep=009] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0400
================= FIT START (fold=1) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4924 mb_mean=0.4908 norm_overlap=1.0000 corr_cb=-0.0313 topkJ=0.0382
[TRAIN][ep=000] loss=0.6711 acc=62.01%
[TRAIN][ep=000] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0416
[EPOCH 000/089] train: loss=0.6711 acc=62.01% | val: loss=0.6902 acc=57.83% f1=69.57% auc=53.02% val_score=42.9101 val_score_bestthr=56.8424 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.042) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 56.8424
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4945 mb_mean=0.4932 norm_overlap=1.0000 corr_cb=0.0532 topkJ=0.0351
[TRAIN][ep=001] loss=0.6648 acc=61.34%
[TRAIN][ep=001] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0445
[EPOCH 001/089] train: loss=0.6648 acc=61.34% | val: loss=0.6900 acc=55.42% f1=69.92% auc=52.09% val_score=43.0198 val_score_bestthr=62.6871 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.045) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 56.8424 -> 62.6871
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4957 mb_mean=0.4963 norm_overlap=1.0000 corr_cb=-0.0615 topkJ=0.0282
[TRAIN][ep=002] loss=0.6544 acc=65.10%
[TRAIN][ep=002] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0447
[EPOCH 002/089] train: loss=0.6544 acc=65.10% | val: loss=0.6915 acc=56.63% f1=69.49% auc=53.20% val_score=44.9705 val_score_bestthr=59.2265 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.045) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6871 -> 59.2265
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4968 mb_mean=0.4929 norm_overlap=0.9999 corr_cb=-0.1262 topkJ=0.0038
[TRAIN][ep=003] loss=0.6482 acc=64.30%
[TRAIN][ep=003] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0468
[EPOCH 003/089] train: loss=0.6482 acc=64.30% | val: loss=0.6942 acc=57.83% f1=69.57% auc=53.37% val_score=47.0193 val_score_bestthr=56.8424 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.047) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6871 -> 56.8424
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4915 mb_mean=0.4920 norm_overlap=1.0000 corr_cb=-0.0843 topkJ=0.0088
[TRAIN][ep=004] loss=0.6429 acc=63.49%
[TRAIN][ep=004] mask_avg: mc_mean=0.4939 mb_mean=0.4928 norm_overlap=1.0000 corr_cb=-0.0455
[EPOCH 004/089] train: loss=0.6429 acc=63.49% | val: loss=0.7002 acc=57.83% f1=68.47% auc=53.49% val_score=37.0298 val_score_bestthr=59.5284 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.494, mb=0.493, no=1.000, corr=-0.046) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6871 -> 59.5284
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4942 mb_mean=0.4946 norm_overlap=0.9999 corr_cb=-0.1495 topkJ=0.0119
[TRAIN][ep=005] loss=1.3602 acc=63.89%
[TRAIN][ep=005] mask_avg: mc_mean=0.3715 mb_mean=0.4928 norm_overlap=0.9989 corr_cb=-0.3595
[EPOCH 005/089] train: loss=1.3602 acc=63.89% | val: loss=0.6941 acc=56.63% f1=70.49% auc=54.24% val_score=35.8021 val_score_bestthr=61.6282 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.371, mb=0.493, no=0.999, corr=-0.359) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6871 -> 61.6282
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2624 mb_mean=0.4960 norm_overlap=0.9957 corr_cb=-0.4901 topkJ=0.0031
[TRAIN][ep=006] loss=1.3422 acc=64.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.2317 mb_mean=0.4928 norm_overlap=0.9967 corr_cb=-0.4158
[EPOCH 006/089] train: loss=1.3422 acc=64.70% | val: loss=0.6937 acc=56.63% f1=70.00% auc=54.36% val_score=32.6091 val_score_bestthr=60.1401 | dyn(w_pfs=0.240, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.232, mb=0.493, no=0.997, corr=-0.416) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6871 -> 60.1401
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.1529 mb_mean=0.4992 norm_overlap=0.9951 corr_cb=-0.4574 topkJ=0.0110
[TRAIN][ep=007] loss=1.1507 acc=64.97%
[TRAIN][ep=007] mask_avg: mc_mean=0.1755 mb_mean=0.4928 norm_overlap=0.9952 corr_cb=-0.4156
[EPOCH 007/089] train: loss=1.1507 acc=64.97% | val: loss=0.7127 acc=56.63% f1=69.49% auc=53.78% val_score=38.5081 val_score_bestthr=58.9833 | dyn(w_pfs=0.140, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.176, mb=0.493, no=0.995, corr=-0.416) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6871 -> 58.9833
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1563 mb_mean=0.4901 norm_overlap=0.9953 corr_cb=-0.4106 topkJ=0.0141
[TRAIN][ep=008] loss=0.9435 acc=66.04%
[TRAIN][ep=008] mask_avg: mc_mean=0.1376 mb_mean=0.4928 norm_overlap=0.9935 corr_cb=-0.4292
[EPOCH 008/089] train: loss=0.9435 acc=66.04% | val: loss=0.7033 acc=57.83% f1=71.07% auc=54.24% val_score=40.3760 val_score_bestthr=63.1205 | dyn(w_pfs=0.180, w_sup=0.090, w_csuf=0.040, stage2=False) | mask(mc=0.138, mb=0.493, no=0.993, corr=-0.429) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 62.6871 -> 63.1205
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1013 mb_mean=0.4926 norm_overlap=0.9922 corr_cb=-0.3897 topkJ=0.0202
[TRAIN][ep=009] loss=1.0305 acc=63.62%
[TRAIN][ep=009] mask_avg: mc_mean=0.1056 mb_mean=0.4928 norm_overlap=0.9916 corr_cb=-0.4241
[EPOCH 009/089] train: loss=1.0305 acc=63.62% | val: loss=0.7078 acc=57.83% f1=66.02% auc=54.30% val_score=39.3150 val_score_bestthr=61.3809 | dyn(w_pfs=0.220, w_sup=0.130, w_csuf=0.080, stage2=False) | mask(mc=0.106, mb=0.493, no=0.992, corr=-0.424) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.1205 -> 61.3809
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.0776 mb_mean=0.4963 norm_overlap=0.9911 corr_cb=-0.4588 topkJ=0.0035
[TRAIN][ep=010] loss=1.0996 acc=65.64%
[TRAIN][ep=010] mask_avg: mc_mean=0.0828 mb_mean=0.4928 norm_overlap=0.9902 corr_cb=-0.4037
[EPOCH 010/089] train: loss=1.0996 acc=65.64% | val: loss=0.7020 acc=57.83% f1=70.59% auc=54.42% val_score=49.1388 val_score_bestthr=59.6647 | dyn(w_pfs=0.260, w_sup=0.170, w_csuf=0.120, stage2=False) | mask(mc=0.083, mb=0.493, no=0.990, corr=-0.404) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.1205 -> 59.6647
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.0594 mb_mean=0.4924 norm_overlap=0.9907 corr_cb=-0.3324 topkJ=0.0124
[TRAIN][ep=011] loss=1.1599 acc=66.71%
[TRAIN][ep=011] mask_avg: mc_mean=0.0685 mb_mean=0.4928 norm_overlap=0.9887 corr_cb=-0.3954
[EPOCH 011/089] train: loss=1.1599 acc=66.71% | val: loss=0.7016 acc=59.04% f1=70.69% auc=54.53% val_score=41.4230 val_score_bestthr=61.0958 | dyn(w_pfs=0.060, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.069, mb=0.493, no=0.989, corr=-0.395) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.1205 -> 61.0958
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.0568 mb_mean=0.4959 norm_overlap=0.9860 corr_cb=-0.4228 topkJ=0.0104
[TRAIN][ep=012] loss=0.8969 acc=70.07%
[TRAIN][ep=012] mask_avg: mc_mean=0.0618 mb_mean=0.4928 norm_overlap=0.9870 corr_cb=-0.3963
[EPOCH 012/089] train: loss=0.8969 acc=70.07% | val: loss=0.7058 acc=59.04% f1=70.69% auc=55.17% val_score=44.6594 val_score_bestthr=61.0958 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.062, mb=0.493, no=0.987, corr=-0.396) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.1205 -> 61.0958
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.0332 mb_mean=0.4973 norm_overlap=0.9830 corr_cb=-0.3857 topkJ=0.0016
[TRAIN][ep=013] loss=0.8928 acc=66.44%
[TRAIN][ep=013] mask_avg: mc_mean=0.0540 mb_mean=0.4928 norm_overlap=0.9855 corr_cb=-0.3845
[EPOCH 013/089] train: loss=0.8928 acc=66.44% | val: loss=0.7045 acc=60.24% f1=67.33% auc=55.58% val_score=42.0277 val_score_bestthr=65.0202 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.054, mb=0.493, no=0.985, corr=-0.385) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 63.1205 -> 65.0202
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.0432 mb_mean=0.4931 norm_overlap=0.9817 corr_cb=-0.4468 topkJ=0.0079
[TRAIN][ep=014] loss=0.8598 acc=70.47%
[TRAIN][ep=014] mask_avg: mc_mean=0.0543 mb_mean=0.4928 norm_overlap=0.9845 corr_cb=-0.3908
[EPOCH 014/089] train: loss=0.8598 acc=70.47% | val: loss=0.7286 acc=59.04% f1=66.00% auc=54.30% val_score=36.0552 val_score_bestthr=60.6974 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.054, mb=0.493, no=0.985, corr=-0.391) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.0202 -> 60.6974
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.0706 mb_mean=0.4915 norm_overlap=0.9896 corr_cb=-0.3695 topkJ=0.0122
[TRAIN][ep=015] loss=0.8633 acc=68.59%
[TRAIN][ep=015] mask_avg: mc_mean=0.0489 mb_mean=0.4928 norm_overlap=0.9829 corr_cb=-0.3766
[EPOCH 015/089] train: loss=0.8633 acc=68.59% | val: loss=0.7282 acc=60.24% f1=71.30% auc=54.24% val_score=47.3350 val_score_bestthr=63.2773 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.049, mb=0.493, no=0.983, corr=-0.377) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.0202 -> 63.2773
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.0518 mb_mean=0.4960 norm_overlap=0.9780 corr_cb=-0.4314 topkJ=0.0008
[TRAIN][ep=016] loss=0.8504 acc=69.93%
[TRAIN][ep=016] mask_avg: mc_mean=0.0602 mb_mean=0.4928 norm_overlap=0.9831 corr_cb=-0.4059
[EPOCH 016/089] train: loss=0.8504 acc=69.93% | val: loss=0.7148 acc=60.24% f1=71.79% auc=55.29% val_score=38.0694 val_score_bestthr=62.2198 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.060, mb=0.493, no=0.983, corr=-0.406) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.0202 -> 62.2198
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.0651 mb_mean=0.4935 norm_overlap=0.9816 corr_cb=-0.4646 topkJ=0.0048
[TRAIN][ep=017] loss=0.8496 acc=69.53%
[TRAIN][ep=017] mask_avg: mc_mean=0.0617 mb_mean=0.4928 norm_overlap=0.9825 corr_cb=-0.4037
[EPOCH 017/089] train: loss=0.8496 acc=69.53% | val: loss=0.7296 acc=60.24% f1=71.79% auc=54.36% val_score=53.4880 val_score_bestthr=62.4506 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.062, mb=0.493, no=0.983, corr=-0.404) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.0202 -> 62.4506
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.0534 mb_mean=0.4913 norm_overlap=0.9865 corr_cb=-0.3142 topkJ=0.0099
[TRAIN][ep=018] loss=0.8354 acc=71.81%
[TRAIN][ep=018] mask_avg: mc_mean=0.0560 mb_mean=0.4928 norm_overlap=0.9815 corr_cb=-0.3940
[EPOCH 018/089] train: loss=0.8354 acc=71.81% | val: loss=0.7180 acc=61.45% f1=71.93% auc=55.35% val_score=46.9059 val_score_bestthr=65.6471 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.056, mb=0.493, no=0.982, corr=-0.394) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 65.0202 -> 65.6471
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.0786 mb_mean=0.4941 norm_overlap=0.9870 corr_cb=-0.3621 topkJ=0.0112
[TRAIN][ep=019] loss=0.8387 acc=70.74%
[TRAIN][ep=019] mask_avg: mc_mean=0.0664 mb_mean=0.4928 norm_overlap=0.9816 corr_cb=-0.4152
[EPOCH 019/089] train: loss=0.8387 acc=70.74% | val: loss=0.7315 acc=61.45% f1=71.93% auc=54.83% val_score=47.3763 val_score_bestthr=65.6471 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.066, mb=0.493, no=0.982, corr=-0.415) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6471 -> 65.6471
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.0918 mb_mean=0.4898 norm_overlap=0.9864 corr_cb=-0.3883 topkJ=0.0051
[TRAIN][ep=020] loss=0.8292 acc=73.15%
[TRAIN][ep=020] mask_avg: mc_mean=0.0757 mb_mean=0.4928 norm_overlap=0.9818 corr_cb=-0.4313
[EPOCH 020/089] train: loss=0.8292 acc=73.15% | val: loss=0.7469 acc=59.04% f1=70.69% auc=56.74% val_score=38.0330 val_score_bestthr=61.0958 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.076, mb=0.493, no=0.982, corr=-0.431) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6471 -> 61.0958
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.0718 mb_mean=0.4926 norm_overlap=0.9847 corr_cb=-0.4503 topkJ=0.0028
[TRAIN][ep=021] loss=0.8160 acc=71.95%
[TRAIN][ep=021] mask_avg: mc_mean=0.0862 mb_mean=0.4928 norm_overlap=0.9822 corr_cb=-0.4412
[EPOCH 021/089] train: loss=0.8160 acc=71.95% | val: loss=0.7883 acc=60.24% f1=71.30% auc=56.74% val_score=43.2431 val_score_bestthr=62.5929 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.086, mb=0.493, no=0.982, corr=-0.441) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6471 -> 62.5929
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.0985 mb_mean=0.4906 norm_overlap=0.9830 corr_cb=-0.4314 topkJ=0.0024
[TRAIN][ep=022] loss=0.8966 acc=71.68%
[TRAIN][ep=022] mask_avg: mc_mean=0.0772 mb_mean=0.4928 norm_overlap=0.9814 corr_cb=-0.4281
[EPOCH 022/089] train: loss=0.8966 acc=71.68% | val: loss=0.7283 acc=60.24% f1=71.30% auc=55.76% val_score=51.9917 val_score_bestthr=63.2773 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.077, mb=0.493, no=0.981, corr=-0.428) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6471 -> 63.2773
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.0694 mb_mean=0.4932 norm_overlap=0.9735 corr_cb=-0.4855 topkJ=0.0023
[TRAIN][ep=023] loss=0.8069 acc=72.35%
[TRAIN][ep=023] mask_avg: mc_mean=0.0803 mb_mean=0.4928 norm_overlap=0.9816 corr_cb=-0.4273
[EPOCH 023/089] train: loss=0.8069 acc=72.35% | val: loss=0.7224 acc=61.45% f1=71.93% auc=55.47% val_score=44.6594 val_score_bestthr=65.6471 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.080, mb=0.493, no=0.982, corr=-0.427) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6471 -> 65.6471
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.0819 mb_mean=0.4927 norm_overlap=0.9825 corr_cb=-0.4661 topkJ=0.0020
[TRAIN][ep=024] loss=0.7975 acc=73.69%
[TRAIN][ep=024] mask_avg: mc_mean=0.1001 mb_mean=0.4928 norm_overlap=0.9827 corr_cb=-0.4462
[EPOCH 024/089] train: loss=0.7975 acc=73.69% | val: loss=0.7137 acc=62.65% f1=73.04% auc=57.33% val_score=50.2239 val_score_bestthr=66.3367 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.100, mb=0.493, no=0.983, corr=-0.446) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 65.6471 -> 66.3367
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.0556 mb_mean=0.4924 norm_overlap=0.9827 corr_cb=-0.3790 topkJ=0.0055
[TRAIN][ep=025] loss=0.8684 acc=72.75%
[TRAIN][ep=025] mask_avg: mc_mean=0.0838 mb_mean=0.4928 norm_overlap=0.9814 corr_cb=-0.4208
[EPOCH 025/089] train: loss=0.8684 acc=72.75% | val: loss=0.7343 acc=61.45% f1=72.41% auc=56.92% val_score=46.6077 val_score_bestthr=63.7174 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.084, mb=0.493, no=0.981, corr=-0.421) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 63.7174
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.0944 mb_mean=0.4922 norm_overlap=0.9880 corr_cb=-0.3574 topkJ=0.0069
[TRAIN][ep=026] loss=0.9348 acc=74.50%
[TRAIN][ep=026] mask_avg: mc_mean=0.1117 mb_mean=0.4928 norm_overlap=0.9831 corr_cb=-0.4470
[EPOCH 026/089] train: loss=0.9348 acc=74.50% | val: loss=0.7600 acc=61.45% f1=71.93% auc=57.79% val_score=39.5193 val_score_bestthr=65.6471 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.112, mb=0.493, no=0.983, corr=-0.447) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 65.6471
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1404 mb_mean=0.4908 norm_overlap=0.9855 corr_cb=-0.4019 topkJ=0.0028
[TRAIN][ep=027] loss=0.9940 acc=75.57%
[TRAIN][ep=027] mask_avg: mc_mean=0.1051 mb_mean=0.4928 norm_overlap=0.9826 corr_cb=-0.4332
[EPOCH 027/089] train: loss=0.9940 acc=75.57% | val: loss=0.7386 acc=62.65% f1=73.04% auc=58.43% val_score=40.7238 val_score_bestthr=66.3367 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.105, mb=0.493, no=0.983, corr=-0.433) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 66.3367
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.0651 mb_mean=0.4955 norm_overlap=0.9776 corr_cb=-0.4169 topkJ=0.0032
[TRAIN][ep=028] loss=1.0701 acc=74.36%
[TRAIN][ep=028] mask_avg: mc_mean=0.0849 mb_mean=0.4928 norm_overlap=0.9811 corr_cb=-0.4049
[EPOCH 028/089] train: loss=1.0701 acc=74.36% | val: loss=0.7417 acc=60.24% f1=71.30% auc=57.67% val_score=39.2230 val_score_bestthr=63.2773 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.085, mb=0.493, no=0.981, corr=-0.405) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 63.2773
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.0820 mb_mean=0.4953 norm_overlap=0.9781 corr_cb=-0.5122 topkJ=0.0004
[TRAIN][ep=029] loss=1.1191 acc=76.51%
[TRAIN][ep=029] mask_avg: mc_mean=0.1228 mb_mean=0.4928 norm_overlap=0.9834 corr_cb=-0.4455
[EPOCH 029/089] train: loss=1.1191 acc=76.51% | val: loss=0.7414 acc=61.45% f1=71.93% auc=56.74% val_score=41.5181 val_score_bestthr=65.6471 | dyn(w_pfs=0.100, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.123, mb=0.493, no=0.983, corr=-0.446) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 65.6471
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.0678 mb_mean=0.4980 norm_overlap=0.9658 corr_cb=-0.5359 topkJ=0.0004
[TRAIN][ep=030] loss=0.9394 acc=74.36%
[TRAIN][ep=030] mask_avg: mc_mean=0.1007 mb_mean=0.4928 norm_overlap=0.9819 corr_cb=-0.4204
[EPOCH 030/089] train: loss=0.9394 acc=74.36% | val: loss=0.7390 acc=61.45% f1=71.93% auc=57.03% val_score=48.7783 val_score_bestthr=65.6471 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.101, mb=0.493, no=0.982, corr=-0.420) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 65.6471
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.1050 mb_mean=0.4927 norm_overlap=0.9776 corr_cb=-0.5136 topkJ=0.0020
[TRAIN][ep=031] loss=0.7683 acc=73.15%
[TRAIN][ep=031] mask_avg: mc_mean=0.0981 mb_mean=0.4928 norm_overlap=0.9817 corr_cb=-0.4174
[EPOCH 031/089] train: loss=0.7683 acc=73.15% | val: loss=0.7717 acc=60.24% f1=70.80% auc=58.55% val_score=42.8562 val_score_bestthr=61.4456 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.098, mb=0.493, no=0.982, corr=-0.417) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 61.4456
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1232 mb_mean=0.4887 norm_overlap=0.9885 corr_cb=-0.2740 topkJ=0.0225
[TRAIN][ep=032] loss=0.7479 acc=76.11%
[TRAIN][ep=032] mask_avg: mc_mean=0.1094 mb_mean=0.4928 norm_overlap=0.9826 corr_cb=-0.4237
[EPOCH 032/089] train: loss=0.7479 acc=76.11% | val: loss=0.7446 acc=60.24% f1=70.80% auc=58.43% val_score=44.9998 val_score_bestthr=61.4456 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.109, mb=0.493, no=0.983, corr=-0.424) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 61.4456
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1166 mb_mean=0.4927 norm_overlap=0.9794 corr_cb=-0.4454 topkJ=0.0039
[TRAIN][ep=033] loss=0.7322 acc=76.91%
[TRAIN][ep=033] mask_avg: mc_mean=0.1136 mb_mean=0.4928 norm_overlap=0.9826 corr_cb=-0.4269
[EPOCH 033/089] train: loss=0.7322 acc=76.91% | val: loss=0.7521 acc=60.24% f1=70.80% auc=57.91% val_score=44.0570 val_score_bestthr=61.4456 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.114, mb=0.493, no=0.983, corr=-0.427) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 61.4456
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1166 mb_mean=0.4908 norm_overlap=0.9870 corr_cb=-0.3531 topkJ=0.0143
[TRAIN][ep=034] loss=0.7241 acc=77.58%
[TRAIN][ep=034] mask_avg: mc_mean=0.1266 mb_mean=0.4928 norm_overlap=0.9835 corr_cb=-0.4310
[EPOCH 034/089] train: loss=0.7241 acc=77.58% | val: loss=0.7772 acc=61.45% f1=70.91% auc=58.08% val_score=50.0950 val_score_bestthr=61.8877 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.127, mb=0.493, no=0.984, corr=-0.431) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 61.8877
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.1350 mb_mean=0.4924 norm_overlap=0.9874 corr_cb=-0.4238 topkJ=0.0048
[TRAIN][ep=035] loss=0.7361 acc=77.18%
[TRAIN][ep=035] mask_avg: mc_mean=0.1144 mb_mean=0.4928 norm_overlap=0.9827 corr_cb=-0.4186
[EPOCH 035/089] train: loss=0.7361 acc=77.18% | val: loss=0.7810 acc=61.45% f1=71.43% auc=57.73% val_score=56.0375 val_score_bestthr=62.5452 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.114, mb=0.493, no=0.983, corr=-0.419) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 62.5452
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.1203 mb_mean=0.4918 norm_overlap=0.9871 corr_cb=-0.3175 topkJ=0.0032
[TRAIN][ep=036] loss=0.7256 acc=76.64%
[TRAIN][ep=036] mask_avg: mc_mean=0.1289 mb_mean=0.4928 norm_overlap=0.9835 corr_cb=-0.4277
[EPOCH 036/089] train: loss=0.7256 acc=76.64% | val: loss=0.7658 acc=60.24% f1=70.80% auc=58.66% val_score=43.0168 val_score_bestthr=61.4456 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.129, mb=0.493, no=0.983, corr=-0.428) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 61.4456
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1372 mb_mean=0.4913 norm_overlap=0.9785 corr_cb=-0.4722 topkJ=0.0000
[TRAIN][ep=037] loss=0.7221 acc=77.58%
[TRAIN][ep=037] mask_avg: mc_mean=0.1310 mb_mean=0.4928 norm_overlap=0.9836 corr_cb=-0.4277
[EPOCH 037/089] train: loss=0.7221 acc=77.58% | val: loss=0.8174 acc=56.63% f1=70.00% auc=59.36% val_score=44.4953 val_score_bestthr=62.1241 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.131, mb=0.493, no=0.984, corr=-0.428) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 62.1241
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.1456 mb_mean=0.4918 norm_overlap=0.9844 corr_cb=-0.4132 topkJ=0.0049
[TRAIN][ep=038] loss=0.7047 acc=77.72%
[TRAIN][ep=038] mask_avg: mc_mean=0.1224 mb_mean=0.4928 norm_overlap=0.9832 corr_cb=-0.4167
[EPOCH 038/089] train: loss=0.7047 acc=77.72% | val: loss=0.7692 acc=61.45% f1=69.81% auc=58.84% val_score=43.6154 val_score_bestthr=61.9101 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.122, mb=0.493, no=0.983, corr=-0.417) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 61.9101
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.1414 mb_mean=0.4933 norm_overlap=0.9767 corr_cb=-0.5308 topkJ=0.0000
[TRAIN][ep=039] loss=0.6977 acc=77.72%
[TRAIN][ep=039] mask_avg: mc_mean=0.1385 mb_mean=0.4928 norm_overlap=0.9839 corr_cb=-0.4278
[EPOCH 039/089] train: loss=0.6977 acc=77.72% | val: loss=0.8435 acc=57.83% f1=68.47% auc=59.83% val_score=47.7707 val_score_bestthr=61.4233 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.138, mb=0.493, no=0.984, corr=-0.428) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 61.4233
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.1353 mb_mean=0.4926 norm_overlap=0.9802 corr_cb=-0.4881 topkJ=0.0035
[TRAIN][ep=040] loss=0.6817 acc=80.40%
[TRAIN][ep=040] mask_avg: mc_mean=0.1422 mb_mean=0.4928 norm_overlap=0.9844 corr_cb=-0.4218
[EPOCH 040/089] train: loss=0.6817 acc=80.40% | val: loss=0.8177 acc=60.24% f1=69.72% auc=59.13% val_score=47.2272 val_score_bestthr=63.3103 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.142, mb=0.493, no=0.984, corr=-0.422) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 63.3103
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.1631 mb_mean=0.4934 norm_overlap=0.9876 corr_cb=-0.3827 topkJ=0.0024
[TRAIN][ep=041] loss=0.6688 acc=81.88%
[TRAIN][ep=041] mask_avg: mc_mean=0.1290 mb_mean=0.4928 norm_overlap=0.9835 corr_cb=-0.4154
[EPOCH 041/089] train: loss=0.6688 acc=81.88% | val: loss=0.8208 acc=56.63% f1=70.00% auc=60.06% val_score=50.6024 val_score_bestthr=62.1241 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.129, mb=0.493, no=0.983, corr=-0.415) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 62.1241
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.1937 mb_mean=0.4932 norm_overlap=0.9841 corr_cb=-0.5157 topkJ=0.0008
[TRAIN][ep=042] loss=0.6869 acc=79.33%
[TRAIN][ep=042] mask_avg: mc_mean=0.1263 mb_mean=0.4928 norm_overlap=0.9834 corr_cb=-0.4120
[EPOCH 042/089] train: loss=0.6869 acc=79.33% | val: loss=0.7957 acc=59.04% f1=68.52% auc=59.83% val_score=51.1190 val_score_bestthr=64.8531 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.126, mb=0.493, no=0.983, corr=-0.412) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 64.8531
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.1132 mb_mean=0.4932 norm_overlap=0.9791 corr_cb=-0.4334 topkJ=0.0016
[TRAIN][ep=043] loss=0.6659 acc=79.33%
[TRAIN][ep=043] mask_avg: mc_mean=0.1362 mb_mean=0.4928 norm_overlap=0.9839 corr_cb=-0.4193
[EPOCH 043/089] train: loss=0.6659 acc=79.33% | val: loss=0.9050 acc=56.63% f1=67.27% auc=60.17% val_score=45.9923 val_score_bestthr=55.3945 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.136, mb=0.493, no=0.984, corr=-0.419) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 55.3945
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.1508 mb_mean=0.4931 norm_overlap=0.9845 corr_cb=-0.4430 topkJ=0.0016
[TRAIN][ep=044] loss=0.6845 acc=80.00%
[TRAIN][ep=044] mask_avg: mc_mean=0.1151 mb_mean=0.4928 norm_overlap=0.9828 corr_cb=-0.3984
[EPOCH 044/089] train: loss=0.6845 acc=80.00% | val: loss=0.7982 acc=60.24% f1=69.72% auc=59.59% val_score=51.1251 val_score_bestthr=60.6347 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.115, mb=0.493, no=0.983, corr=-0.398) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 60.6347
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.1148 mb_mean=0.4935 norm_overlap=0.9872 corr_cb=-0.3627 topkJ=0.0036
[TRAIN][ep=045] loss=0.6476 acc=81.74%
[TRAIN][ep=045] mask_avg: mc_mean=0.1364 mb_mean=0.4928 norm_overlap=0.9841 corr_cb=-0.4082
[EPOCH 045/089] train: loss=0.6476 acc=81.74% | val: loss=0.8569 acc=59.04% f1=67.31% auc=58.90% val_score=47.4053 val_score_bestthr=60.0122 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.136, mb=0.493, no=0.984, corr=-0.408) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 60.0122
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.1759 mb_mean=0.4928 norm_overlap=0.9838 corr_cb=-0.4432 topkJ=0.0039
[TRAIN][ep=046] loss=0.6475 acc=79.87%
[TRAIN][ep=046] mask_avg: mc_mean=0.1618 mb_mean=0.4928 norm_overlap=0.9856 corr_cb=-0.4152
[EPOCH 046/089] train: loss=0.6475 acc=79.87% | val: loss=0.8175 acc=60.24% f1=69.16% auc=60.81% val_score=49.4714 val_score_bestthr=60.8074 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.162, mb=0.493, no=0.986, corr=-0.415) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 60.8074
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.1071 mb_mean=0.4929 norm_overlap=0.9782 corr_cb=-0.4419 topkJ=0.0012
[TRAIN][ep=047] loss=0.6602 acc=80.27%
[TRAIN][ep=047] mask_avg: mc_mean=0.1338 mb_mean=0.4928 norm_overlap=0.9839 corr_cb=-0.4064
[EPOCH 047/089] train: loss=0.6602 acc=80.27% | val: loss=0.8417 acc=57.83% f1=67.89% auc=59.94% val_score=49.5843 val_score_bestthr=62.9297 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.134, mb=0.493, no=0.984, corr=-0.406) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 62.9297
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.1533 mb_mean=0.4913 norm_overlap=0.9905 corr_cb=-0.3411 topkJ=0.0105
[TRAIN][ep=048] loss=0.6600 acc=80.81%
[TRAIN][ep=048] mask_avg: mc_mean=0.1346 mb_mean=0.4928 norm_overlap=0.9845 corr_cb=-0.3970
[EPOCH 048/089] train: loss=0.6600 acc=80.81% | val: loss=0.8237 acc=59.04% f1=68.52% auc=60.47% val_score=60.3426 val_score_bestthr=64.4288 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.135, mb=0.493, no=0.984, corr=-0.397) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 64.4288
[DBG][ep=049] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.0862 mb_mean=0.4987 norm_overlap=0.9744 corr_cb=-0.5343 topkJ=0.0019
[TRAIN][ep=049] loss=0.6285 acc=83.09%
[TRAIN][ep=049] mask_avg: mc_mean=0.1479 mb_mean=0.4928 norm_overlap=0.9851 corr_cb=-0.4038
[EPOCH 049/089] train: loss=0.6285 acc=83.09% | val: loss=0.8642 acc=60.24% f1=66.67% auc=60.41% val_score=51.1033 val_score_bestthr=63.0921 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.148, mb=0.493, no=0.985, corr=-0.404) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 63.0921
[DBG][ep=050] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.1466 mb_mean=0.4892 norm_overlap=0.9907 corr_cb=-0.2795 topkJ=0.0234
[TRAIN][ep=050] loss=0.6011 acc=85.77%
[TRAIN][ep=050] mask_avg: mc_mean=0.1199 mb_mean=0.4928 norm_overlap=0.9837 corr_cb=-0.3851
[EPOCH 050/089] train: loss=0.6011 acc=85.77% | val: loss=0.8374 acc=59.04% f1=66.00% auc=60.35% val_score=49.7252 val_score_bestthr=63.1073 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.120, mb=0.493, no=0.984, corr=-0.385) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 63.1073
[DBG][ep=051] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.1247 mb_mean=0.4934 norm_overlap=0.9814 corr_cb=-0.4392 topkJ=0.0037
[TRAIN][ep=051] loss=0.5979 acc=86.31%
[TRAIN][ep=051] mask_avg: mc_mean=0.1199 mb_mean=0.4928 norm_overlap=0.9835 corr_cb=-0.3895
[EPOCH 051/089] train: loss=0.5979 acc=86.31% | val: loss=0.8445 acc=59.04% f1=69.09% auc=60.12% val_score=49.7252 val_score_bestthr=60.6548 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.120, mb=0.493, no=0.983, corr=-0.389) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 60.6548
[DBG][ep=052] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.1557 mb_mean=0.4942 norm_overlap=0.9775 corr_cb=-0.4875 topkJ=0.0056
[TRAIN][ep=052] loss=0.5994 acc=84.97%
[TRAIN][ep=052] mask_avg: mc_mean=0.1199 mb_mean=0.4928 norm_overlap=0.9838 corr_cb=-0.3840
[EPOCH 052/089] train: loss=0.5994 acc=84.97% | val: loss=0.8510 acc=59.04% f1=66.00% auc=60.47% val_score=49.5843 val_score_bestthr=63.1073 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.120, mb=0.493, no=0.984, corr=-0.384) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 63.1073
[DBG][ep=053] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.1571 mb_mean=0.4891 norm_overlap=0.9886 corr_cb=-0.3533 topkJ=0.0090
[TRAIN][ep=053] loss=0.6024 acc=83.22%
[TRAIN][ep=053] mask_avg: mc_mean=0.1199 mb_mean=0.4928 norm_overlap=0.9836 corr_cb=-0.3866
[EPOCH 053/089] train: loss=0.6024 acc=83.22% | val: loss=0.8559 acc=60.24% f1=67.33% auc=60.81% val_score=49.4228 val_score_bestthr=62.5513 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.120, mb=0.493, no=0.984, corr=-0.387) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 62.5513
[DBG][ep=054] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=054] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=054] mask(step0): mc_mean=0.1412 mb_mean=0.4947 norm_overlap=0.9783 corr_cb=-0.4880 topkJ=0.0008
[TRAIN][ep=054] loss=0.6040 acc=84.03%
[TRAIN][ep=054] mask_avg: mc_mean=0.1198 mb_mean=0.4928 norm_overlap=0.9837 corr_cb=-0.3862
[EPOCH 054/089] train: loss=0.6040 acc=84.03% | val: loss=0.8618 acc=57.83% f1=68.47% auc=60.35% val_score=49.5843 val_score_bestthr=59.5567 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.120, mb=0.493, no=0.984, corr=-0.386) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3367 -> 59.5567
[EARLY STOP] no improvement for 30 epochs. best_epoch=24
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/ckpt_best_fold_1.pt
=============== FIT DONE ===============
[BEST] epoch=24 | val_acc=62.65% | val_f1=73.04% | val_auc=57.33% | val_score=50.2239 | val_score_bestthr=66.3367
[TEST@BEST] thr_used=0.470 | acc=62.32% f1=64.55% auc=66.70% | SP_sex=9.07% EO_sex=7.40% SP_age=13.96% EO_age=21.49%
[TIME] 1.29 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold1_rep2_seed2001/summary_fold_1.json
