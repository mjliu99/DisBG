[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4732 mb_mean=0.4739 norm_overlap=1.0003 corr_cb=0.4202 topkJ=0.1261
[TRAIN][ep=000] loss=0.6969 acc=49.40%
[TRAIN][ep=000] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3729
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4746 mb_mean=0.4736 norm_overlap=1.0001 corr_cb=0.2526 topkJ=0.1426
[TRAIN][ep=001] loss=0.6934 acc=50.34%
[TRAIN][ep=001] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3696
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4719 mb_mean=0.4692 norm_overlap=1.0002 corr_cb=0.4403 topkJ=0.2099
[TRAIN][ep=002] loss=0.6923 acc=54.09%
[TRAIN][ep=002] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3688
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4696 mb_mean=0.4711 norm_overlap=1.0003 corr_cb=0.4991 topkJ=0.2274
[TRAIN][ep=003] loss=0.6916 acc=53.02%
[TRAIN][ep=003] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3683
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4752 mb_mean=0.4728 norm_overlap=1.0003 corr_cb=0.4629 topkJ=0.1590
[TRAIN][ep=004] loss=0.6912 acc=51.95%
[TRAIN][ep=004] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3684
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4723 mb_mean=0.4722 norm_overlap=1.0002 corr_cb=0.3577 topkJ=0.1944
[TRAIN][ep=005] loss=0.6903 acc=53.02%
[TRAIN][ep=005] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3689
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4731 mb_mean=0.4733 norm_overlap=1.0004 corr_cb=0.5633 topkJ=0.1681
[TRAIN][ep=006] loss=0.6897 acc=53.69%
[TRAIN][ep=006] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3653
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4723 mb_mean=0.4718 norm_overlap=1.0002 corr_cb=0.4549 topkJ=0.1869
[TRAIN][ep=007] loss=0.6886 acc=57.99%
[TRAIN][ep=007] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3710
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4734 mb_mean=0.4747 norm_overlap=1.0002 corr_cb=0.3617 topkJ=0.1959
[TRAIN][ep=008] loss=0.6877 acc=58.79%
[TRAIN][ep=008] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3700
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4744 mb_mean=0.4729 norm_overlap=1.0001 corr_cb=0.3126 topkJ=0.0962
[TRAIN][ep=009] loss=0.6863 acc=57.85%
[TRAIN][ep=009] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3704
================= FIT START (fold=0) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4740 mb_mean=0.4722 norm_overlap=1.0002 corr_cb=0.3730 topkJ=0.1775
[TRAIN][ep=000] loss=0.6855 acc=55.44%
[TRAIN][ep=000] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3748
[EPOCH 000/089] train: loss=0.6855 acc=55.44% | val: loss=0.6872 acc=56.63% f1=66.67% auc=60.81% val_score=54.0132 val_score_bestthr=57.6367 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.375) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 57.6367
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4741 mb_mean=0.4758 norm_overlap=1.0000 corr_cb=0.0718 topkJ=0.1290
[TRAIN][ep=001] loss=0.6863 acc=55.03%
[TRAIN][ep=001] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3678
[EPOCH 001/089] train: loss=0.6863 acc=55.03% | val: loss=0.6851 acc=60.24% f1=68.57% auc=61.22% val_score=59.5949 val_score_bestthr=59.5949 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.368) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 57.6367 -> 59.5949
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4768 mb_mean=0.4754 norm_overlap=1.0002 corr_cb=0.3045 topkJ=0.2290
[TRAIN][ep=002] loss=0.6841 acc=56.64%
[TRAIN][ep=002] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3720
[EPOCH 002/089] train: loss=0.6841 acc=56.64% | val: loss=0.6839 acc=61.45% f1=68.63% auc=61.22% val_score=51.4357 val_score_bestthr=58.3520 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.372) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 59.5949 -> 58.3520
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4684 mb_mean=0.4694 norm_overlap=1.0003 corr_cb=0.5137 topkJ=0.2279
[TRAIN][ep=003] loss=0.6824 acc=58.12%
[TRAIN][ep=003] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3689
[EPOCH 003/089] train: loss=0.6824 acc=58.12% | val: loss=0.6862 acc=53.01% f1=67.23% auc=60.47% val_score=48.5763 val_score_bestthr=54.8425 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.369) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 59.5949 -> 54.8425
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4725 mb_mean=0.4704 norm_overlap=1.0002 corr_cb=0.4488 topkJ=0.1783
[TRAIN][ep=004] loss=0.6809 acc=60.27%
[TRAIN][ep=004] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3726
[EPOCH 004/089] train: loss=0.6809 acc=60.27% | val: loss=0.6887 acc=54.22% f1=68.33% auc=57.85% val_score=45.5410 val_score_bestthr=55.4717 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.373) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 59.5949 -> 55.4717
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4748 mb_mean=0.4735 norm_overlap=1.0001 corr_cb=0.2218 topkJ=0.0905
[TRAIN][ep=005] loss=1.2798 acc=57.32%
[TRAIN][ep=005] mask_avg: mc_mean=0.3955 mb_mean=0.4721 norm_overlap=1.0013 corr_cb=0.5318
[EPOCH 005/089] train: loss=1.2798 acc=57.32% | val: loss=0.6848 acc=61.45% f1=65.96% auc=60.64% val_score=57.8663 val_score_bestthr=57.8663 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.395, mb=0.472, no=1.001, corr=0.532) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 59.5949 -> 57.8663
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.3253 mb_mean=0.4730 norm_overlap=1.0014 corr_cb=0.3884 topkJ=0.2138
[TRAIN][ep=006] loss=1.2638 acc=60.00%
[TRAIN][ep=006] mask_avg: mc_mean=0.2991 mb_mean=0.4721 norm_overlap=1.0029 corr_cb=0.5160
[EPOCH 006/089] train: loss=1.2638 acc=60.00% | val: loss=0.6843 acc=62.65% f1=66.67% auc=60.35% val_score=59.3804 val_score_bestthr=59.3804 | dyn(w_pfs=0.240, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.299, mb=0.472, no=1.003, corr=0.516) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 59.5949 -> 59.3804
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2690 mb_mean=0.4707 norm_overlap=1.0060 corr_cb=0.6557 topkJ=0.2246
[TRAIN][ep=007] loss=1.0185 acc=61.88%
[TRAIN][ep=007] mask_avg: mc_mean=0.2712 mb_mean=0.4721 norm_overlap=1.0032 corr_cb=0.4728
[EPOCH 007/089] train: loss=1.0185 acc=61.88% | val: loss=0.6842 acc=61.45% f1=65.96% auc=60.47% val_score=47.8795 val_score_bestthr=56.6489 | dyn(w_pfs=0.140, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.271, mb=0.472, no=1.003, corr=0.473) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 59.5949 -> 56.6489
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2984 mb_mean=0.4760 norm_overlap=1.0018 corr_cb=0.3146 topkJ=0.2066
[TRAIN][ep=008] loss=0.7744 acc=61.21%
[TRAIN][ep=008] mask_avg: mc_mean=0.2654 mb_mean=0.4721 norm_overlap=1.0029 corr_cb=0.3900
[EPOCH 008/089] train: loss=0.7744 acc=61.21% | val: loss=0.6803 acc=62.65% f1=68.04% auc=61.92% val_score=48.8594 val_score_bestthr=61.2677 | dyn(w_pfs=0.180, w_sup=0.090, w_csuf=0.040, stage2=False) | mask(mc=0.265, mb=0.472, no=1.003, corr=0.390) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 59.5949 -> 61.2677
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2472 mb_mean=0.4697 norm_overlap=1.0044 corr_cb=0.4892 topkJ=0.1662
[TRAIN][ep=009] loss=0.8643 acc=61.34%
[TRAIN][ep=009] mask_avg: mc_mean=0.2571 mb_mean=0.4721 norm_overlap=1.0026 corr_cb=0.3207
[EPOCH 009/089] train: loss=0.8643 acc=61.34% | val: loss=0.7075 acc=51.81% f1=68.25% auc=53.78% val_score=48.1928 val_score_bestthr=62.0453 | dyn(w_pfs=0.220, w_sup=0.130, w_csuf=0.080, stage2=False) | mask(mc=0.257, mb=0.472, no=1.003, corr=0.321) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 61.2677 -> 62.0453
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.2623 mb_mean=0.4726 norm_overlap=1.0033 corr_cb=0.3861 topkJ=0.0959
[TRAIN][ep=010] loss=0.9668 acc=58.93%
[TRAIN][ep=010] mask_avg: mc_mean=0.2507 mb_mean=0.4721 norm_overlap=1.0023 corr_cb=0.2597
[EPOCH 010/089] train: loss=0.9668 acc=58.93% | val: loss=0.6785 acc=57.83% f1=67.29% auc=62.56% val_score=53.9439 val_score_bestthr=58.7321 | dyn(w_pfs=0.260, w_sup=0.170, w_csuf=0.120, stage2=False) | mask(mc=0.251, mb=0.472, no=1.002, corr=0.260) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 58.7321
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.2616 mb_mean=0.4757 norm_overlap=1.0014 corr_cb=0.2081 topkJ=0.0732
[TRAIN][ep=011] loss=1.0543 acc=62.28%
[TRAIN][ep=011] mask_avg: mc_mean=0.2396 mb_mean=0.4721 norm_overlap=1.0022 corr_cb=0.2130
[EPOCH 011/089] train: loss=1.0543 acc=62.28% | val: loss=0.6785 acc=62.65% f1=68.69% auc=63.84% val_score=48.8594 val_score_bestthr=58.8438 | dyn(w_pfs=0.300, w_sup=0.210, w_csuf=0.160, stage2=False) | mask(mc=0.240, mb=0.472, no=1.002, corr=0.213) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 58.8438
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.2252 mb_mean=0.4710 norm_overlap=1.0035 corr_cb=0.2988 topkJ=0.1317
[TRAIN][ep=012] loss=1.1469 acc=60.13%
[TRAIN][ep=012] mask_avg: mc_mean=0.2341 mb_mean=0.4721 norm_overlap=1.0017 corr_cb=0.1582
[EPOCH 012/089] train: loss=1.1469 acc=60.13% | val: loss=0.6890 acc=53.01% f1=68.29% auc=58.26% val_score=42.2595 val_score_bestthr=55.2584 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.234, mb=0.472, no=1.002, corr=0.158) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 55.2584
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.2634 mb_mean=0.4762 norm_overlap=1.0004 corr_cb=0.0547 topkJ=0.0716
[TRAIN][ep=013] loss=1.2402 acc=65.37%
[TRAIN][ep=013] mask_avg: mc_mean=0.2308 mb_mean=0.4721 norm_overlap=1.0013 corr_cb=0.1025
[EPOCH 013/089] train: loss=1.2402 acc=65.37% | val: loss=0.6773 acc=60.24% f1=65.98% auc=62.97% val_score=50.6354 val_score_bestthr=57.4027 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.231, mb=0.472, no=1.001, corr=0.102) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 57.4027
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.2609 mb_mean=0.4743 norm_overlap=1.0009 corr_cb=0.0916 topkJ=0.0954
[TRAIN][ep=014] loss=1.2342 acc=62.42%
[TRAIN][ep=014] mask_avg: mc_mean=0.2255 mb_mean=0.4721 norm_overlap=1.0007 corr_cb=0.0464
[EPOCH 014/089] train: loss=1.2342 acc=62.42% | val: loss=0.6898 acc=57.83% f1=63.16% auc=58.43% val_score=42.2595 val_score_bestthr=56.8889 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.225, mb=0.472, no=1.001, corr=0.046) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 56.8889
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1933 mb_mean=0.4689 norm_overlap=1.0014 corr_cb=0.0996 topkJ=0.0473
[TRAIN][ep=015] loss=0.9929 acc=66.31%
[TRAIN][ep=015] mask_avg: mc_mean=0.2094 mb_mean=0.4721 norm_overlap=1.0006 corr_cb=0.0350
[EPOCH 015/089] train: loss=0.9929 acc=66.31% | val: loss=0.6782 acc=54.22% f1=68.85% auc=61.69% val_score=40.1821 val_score_bestthr=56.3443 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.209, mb=0.472, no=1.001, corr=0.035) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 56.3443
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.2024 mb_mean=0.4714 norm_overlap=1.0034 corr_cb=0.2053 topkJ=0.0625
[TRAIN][ep=016] loss=0.7513 acc=63.62%
[TRAIN][ep=016] mask_avg: mc_mean=0.2101 mb_mean=0.4721 norm_overlap=1.0001 corr_cb=-0.0032
[EPOCH 016/089] train: loss=0.7513 acc=63.62% | val: loss=0.6701 acc=61.45% f1=66.67% auc=64.24% val_score=55.2720 val_score_bestthr=58.7686 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.210, mb=0.472, no=1.000, corr=-0.003) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 58.7686
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.2049 mb_mean=0.4756 norm_overlap=0.9992 corr_cb=-0.0541 topkJ=0.0457
[TRAIN][ep=017] loss=0.6899 acc=65.50%
[TRAIN][ep=017] mask_avg: mc_mean=0.2025 mb_mean=0.4721 norm_overlap=0.9996 corr_cb=-0.0265
[EPOCH 017/089] train: loss=0.6899 acc=65.50% | val: loss=0.6712 acc=63.86% f1=69.39% auc=66.05% val_score=51.4294 val_score_bestthr=56.7849 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.202, mb=0.472, no=1.000, corr=-0.027) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 56.7849
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.2130 mb_mean=0.4736 norm_overlap=0.9993 corr_cb=-0.0368 topkJ=0.0302
[TRAIN][ep=018] loss=0.6724 acc=65.10%
[TRAIN][ep=018] mask_avg: mc_mean=0.2106 mb_mean=0.4721 norm_overlap=0.9988 corr_cb=-0.0633
[EPOCH 018/089] train: loss=0.6724 acc=65.10% | val: loss=0.6995 acc=59.04% f1=64.58% auc=58.55% val_score=46.7684 val_score_bestthr=56.9212 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.211, mb=0.472, no=0.999, corr=-0.063) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 56.9212
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.2140 mb_mean=0.4748 norm_overlap=0.9948 corr_cb=-0.3023 topkJ=0.0112
[TRAIN][ep=019] loss=0.6736 acc=64.43%
[TRAIN][ep=019] mask_avg: mc_mean=0.2120 mb_mean=0.4721 norm_overlap=0.9983 corr_cb=-0.0898
[EPOCH 019/089] train: loss=0.6736 acc=64.43% | val: loss=0.6637 acc=65.06% f1=68.13% auc=65.23% val_score=54.1064 val_score_bestthr=58.2453 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.212, mb=0.472, no=0.998, corr=-0.090) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 58.2453
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1870 mb_mean=0.4736 norm_overlap=1.0000 corr_cb=0.0017 topkJ=0.0359
[TRAIN][ep=020] loss=0.6642 acc=67.11%
[TRAIN][ep=020] mask_avg: mc_mean=0.2029 mb_mean=0.4721 norm_overlap=0.9982 corr_cb=-0.0839
[EPOCH 020/089] train: loss=0.6642 acc=67.11% | val: loss=0.6732 acc=62.65% f1=67.37% auc=62.91% val_score=34.2781 val_score_bestthr=64.1100 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.203, mb=0.472, no=0.998, corr=-0.084) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 62.0453 -> 64.1100
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.1857 mb_mean=0.4700 norm_overlap=0.9977 corr_cb=-0.0998 topkJ=0.0294
[TRAIN][ep=021] loss=0.7549 acc=67.79%
[TRAIN][ep=021] mask_avg: mc_mean=0.2052 mb_mean=0.4721 norm_overlap=0.9978 corr_cb=-0.0961
[EPOCH 021/089] train: loss=0.7549 acc=67.79% | val: loss=0.6606 acc=66.27% f1=67.44% auc=66.69% val_score=54.1064 val_score_bestthr=57.0602 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.205, mb=0.472, no=0.998, corr=-0.096) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1100 -> 57.0602
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1840 mb_mean=0.4722 norm_overlap=0.9991 corr_cb=-0.0342 topkJ=0.0394
[TRAIN][ep=022] loss=0.8468 acc=66.98%
[TRAIN][ep=022] mask_avg: mc_mean=0.1989 mb_mean=0.4721 norm_overlap=0.9977 corr_cb=-0.0967
[EPOCH 022/089] train: loss=0.8468 acc=66.98% | val: loss=0.6603 acc=54.22% f1=69.35% auc=65.81% val_score=54.3150 val_score_bestthr=62.4643 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.199, mb=0.472, no=0.998, corr=-0.097) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1100 -> 62.4643
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1826 mb_mean=0.4728 norm_overlap=0.9971 corr_cb=-0.1110 topkJ=0.0372
[TRAIN][ep=023] loss=0.9320 acc=68.05%
[TRAIN][ep=023] mask_avg: mc_mean=0.1967 mb_mean=0.4721 norm_overlap=0.9975 corr_cb=-0.0984
[EPOCH 023/089] train: loss=0.9320 acc=68.05% | val: loss=0.6600 acc=54.22% f1=69.35% auc=66.74% val_score=51.3358 val_score_bestthr=62.4643 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.197, mb=0.472, no=0.998, corr=-0.098) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1100 -> 62.4643
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2350 mb_mean=0.4734 norm_overlap=0.9995 corr_cb=-0.0238 topkJ=0.0530
[TRAIN][ep=024] loss=1.0234 acc=70.87%
[TRAIN][ep=024] mask_avg: mc_mean=0.2078 mb_mean=0.4721 norm_overlap=0.9969 corr_cb=-0.1202
[EPOCH 024/089] train: loss=1.0234 acc=70.87% | val: loss=0.6544 acc=62.65% f1=69.90% auc=66.45% val_score=51.1572 val_score_bestthr=57.1596 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.208, mb=0.472, no=0.997, corr=-0.120) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1100 -> 57.1596
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2036 mb_mean=0.4715 norm_overlap=0.9993 corr_cb=-0.0222 topkJ=0.0390
[TRAIN][ep=025] loss=1.1121 acc=69.93%
[TRAIN][ep=025] mask_avg: mc_mean=0.1970 mb_mean=0.4721 norm_overlap=0.9970 corr_cb=-0.1076
[EPOCH 025/089] train: loss=1.1121 acc=69.93% | val: loss=0.6510 acc=62.65% f1=69.90% auc=67.38% val_score=51.1572 val_score_bestthr=57.1596 | dyn(w_pfs=0.100, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.197, mb=0.472, no=0.997, corr=-0.108) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1100 -> 57.1596
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2164 mb_mean=0.4765 norm_overlap=0.9963 corr_cb=-0.1687 topkJ=0.0362
[TRAIN][ep=026] loss=0.8695 acc=68.46%
[TRAIN][ep=026] mask_avg: mc_mean=0.2137 mb_mean=0.4721 norm_overlap=0.9964 corr_cb=-0.1349
[EPOCH 026/089] train: loss=0.8695 acc=68.46% | val: loss=0.6491 acc=59.04% f1=68.52% auc=68.31% val_score=54.7484 val_score_bestthr=57.6744 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.214, mb=0.472, no=0.996, corr=-0.135) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1100 -> 57.6744
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2523 mb_mean=0.4714 norm_overlap=0.9944 corr_cb=-0.2383 topkJ=0.0229
[TRAIN][ep=027] loss=0.6376 acc=68.05%
[TRAIN][ep=027] mask_avg: mc_mean=0.2188 mb_mean=0.4721 norm_overlap=0.9962 corr_cb=-0.1392
[EPOCH 027/089] train: loss=0.6376 acc=68.05% | val: loss=0.6490 acc=62.65% f1=69.31% auc=67.38% val_score=53.4869 val_score_bestthr=58.2562 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.219, mb=0.472, no=0.996, corr=-0.139) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1100 -> 58.2562
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1856 mb_mean=0.4701 norm_overlap=0.9985 corr_cb=-0.0408 topkJ=0.0303
[TRAIN][ep=028] loss=0.6219 acc=71.14%
[TRAIN][ep=028] mask_avg: mc_mean=0.2086 mb_mean=0.4721 norm_overlap=0.9964 corr_cb=-0.1262
[EPOCH 028/089] train: loss=0.6219 acc=71.14% | val: loss=0.6474 acc=61.45% f1=68.63% auc=67.73% val_score=46.7181 val_score_bestthr=55.9494 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.209, mb=0.472, no=0.996, corr=-0.126) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1100 -> 55.9494
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2048 mb_mean=0.4737 norm_overlap=0.9963 corr_cb=-0.1473 topkJ=0.0429
[TRAIN][ep=029] loss=0.6251 acc=69.80%
[TRAIN][ep=029] mask_avg: mc_mean=0.2168 mb_mean=0.4721 norm_overlap=0.9962 corr_cb=-0.1351
[EPOCH 029/089] train: loss=0.6251 acc=69.80% | val: loss=0.6512 acc=55.42% f1=69.92% auc=67.15% val_score=44.6565 val_score_bestthr=62.8660 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.217, mb=0.472, no=0.996, corr=-0.135) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1100 -> 62.8660
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2236 mb_mean=0.4712 norm_overlap=0.9962 corr_cb=-0.1193 topkJ=0.0589
[TRAIN][ep=030] loss=0.6151 acc=70.34%
[TRAIN][ep=030] mask_avg: mc_mean=0.2129 mb_mean=0.4721 norm_overlap=0.9961 corr_cb=-0.1334
[EPOCH 030/089] train: loss=0.6151 acc=70.34% | val: loss=0.6609 acc=56.63% f1=70.49% auc=66.34% val_score=49.4534 val_score_bestthr=62.8887 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.213, mb=0.472, no=0.996, corr=-0.133) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1100 -> 62.8887
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2240 mb_mean=0.4716 norm_overlap=0.9951 corr_cb=-0.1656 topkJ=0.0364
[TRAIN][ep=031] loss=0.6173 acc=68.32%
[TRAIN][ep=031] mask_avg: mc_mean=0.2216 mb_mean=0.4721 norm_overlap=0.9959 corr_cb=-0.1426
[EPOCH 031/089] train: loss=0.6173 acc=68.32% | val: loss=0.6407 acc=63.86% f1=70.59% auc=68.84% val_score=48.3336 val_score_bestthr=59.4672 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.222, mb=0.472, no=0.996, corr=-0.143) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1100 -> 59.4672
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2319 mb_mean=0.4736 norm_overlap=0.9952 corr_cb=-0.1847 topkJ=0.0305
[TRAIN][ep=032] loss=0.6084 acc=71.41%
[TRAIN][ep=032] mask_avg: mc_mean=0.2240 mb_mean=0.4721 norm_overlap=0.9958 corr_cb=-0.1496
[EPOCH 032/089] train: loss=0.6084 acc=71.41% | val: loss=0.6680 acc=63.86% f1=70.59% auc=70.52% val_score=53.1885 val_score_bestthr=61.7365 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.224, mb=0.472, no=0.996, corr=-0.150) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1100 -> 61.7365
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2158 mb_mean=0.4719 norm_overlap=0.9954 corr_cb=-0.1494 topkJ=0.0348
[TRAIN][ep=033] loss=0.6091 acc=70.74%
[TRAIN][ep=033] mask_avg: mc_mean=0.1931 mb_mean=0.4721 norm_overlap=0.9964 corr_cb=-0.1132
[EPOCH 033/089] train: loss=0.6091 acc=70.74% | val: loss=0.6648 acc=56.63% f1=70.49% auc=66.45% val_score=52.5149 val_score_bestthr=62.8887 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.193, mb=0.472, no=0.996, corr=-0.113) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1100 -> 62.8887
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1941 mb_mean=0.4724 norm_overlap=0.9976 corr_cb=-0.0725 topkJ=0.0603
[TRAIN][ep=034] loss=0.6011 acc=71.28%
[TRAIN][ep=034] mask_avg: mc_mean=0.2277 mb_mean=0.4721 norm_overlap=0.9957 corr_cb=-0.1491
[EPOCH 034/089] train: loss=0.6011 acc=71.28% | val: loss=0.6561 acc=56.63% f1=70.49% auc=67.15% val_score=49.1434 val_score_bestthr=62.8887 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.228, mb=0.472, no=0.996, corr=-0.149) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1100 -> 62.8887
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2231 mb_mean=0.4717 norm_overlap=1.0021 corr_cb=0.0644 topkJ=0.0523
[TRAIN][ep=035] loss=0.5948 acc=73.15%
[TRAIN][ep=035] mask_avg: mc_mean=0.2187 mb_mean=0.4721 norm_overlap=0.9958 corr_cb=-0.1425
[EPOCH 035/089] train: loss=0.5948 acc=73.15% | val: loss=0.6519 acc=56.63% f1=70.49% auc=67.91% val_score=49.1434 val_score_bestthr=62.8887 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.219, mb=0.472, no=0.996, corr=-0.142) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1100 -> 62.8887
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2258 mb_mean=0.4719 norm_overlap=0.9946 corr_cb=-0.1627 topkJ=0.0295
[TRAIN][ep=036] loss=0.6060 acc=70.74%
[TRAIN][ep=036] mask_avg: mc_mean=0.2043 mb_mean=0.4721 norm_overlap=0.9960 corr_cb=-0.1317
[EPOCH 036/089] train: loss=0.6060 acc=70.74% | val: loss=0.6323 acc=63.86% f1=70.59% auc=70.23% val_score=52.4569 val_score_bestthr=61.2172 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.204, mb=0.472, no=0.996, corr=-0.132) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1100 -> 61.2172
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1987 mb_mean=0.4646 norm_overlap=0.9951 corr_cb=-0.1476 topkJ=0.0374
[TRAIN][ep=037] loss=0.5978 acc=72.08%
[TRAIN][ep=037] mask_avg: mc_mean=0.2261 mb_mean=0.4721 norm_overlap=0.9954 corr_cb=-0.1574
[EPOCH 037/089] train: loss=0.5978 acc=72.08% | val: loss=0.6277 acc=62.65% f1=69.90% auc=69.30% val_score=48.2369 val_score_bestthr=59.8226 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.226, mb=0.472, no=0.995, corr=-0.157) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1100 -> 59.8226
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2294 mb_mean=0.4726 norm_overlap=0.9947 corr_cb=-0.1647 topkJ=0.0285
[TRAIN][ep=038] loss=0.5840 acc=72.62%
[TRAIN][ep=038] mask_avg: mc_mean=0.2160 mb_mean=0.4721 norm_overlap=0.9957 corr_cb=-0.1443
[EPOCH 038/089] train: loss=0.5840 acc=72.62% | val: loss=0.6260 acc=66.27% f1=56.25% auc=69.94% val_score=45.3261 val_score_bestthr=60.4302 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.216, mb=0.472, no=0.996, corr=-0.144) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1100 -> 60.4302
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2249 mb_mean=0.4731 norm_overlap=0.9931 corr_cb=-0.2336 topkJ=0.0258
[TRAIN][ep=039] loss=0.5820 acc=72.08%
[TRAIN][ep=039] mask_avg: mc_mean=0.2224 mb_mean=0.4721 norm_overlap=0.9955 corr_cb=-0.1519
[EPOCH 039/089] train: loss=0.5820 acc=72.08% | val: loss=0.6252 acc=66.27% f1=56.25% auc=70.47% val_score=38.3378 val_score_bestthr=60.4302 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.222, mb=0.472, no=0.995, corr=-0.152) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1100 -> 60.4302
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.2442 mb_mean=0.4759 norm_overlap=0.9934 corr_cb=-0.2428 topkJ=0.0192
[TRAIN][ep=040] loss=0.5773 acc=73.69%
[TRAIN][ep=040] mask_avg: mc_mean=0.2184 mb_mean=0.4721 norm_overlap=0.9956 corr_cb=-0.1465
[EPOCH 040/089] train: loss=0.5773 acc=73.69% | val: loss=0.6279 acc=61.45% f1=69.23% auc=71.05% val_score=49.4072 val_score_bestthr=59.5568 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.218, mb=0.472, no=0.996, corr=-0.147) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1100 -> 59.5568
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.2605 mb_mean=0.4749 norm_overlap=0.9950 corr_cb=-0.1903 topkJ=0.0318
[TRAIN][ep=041] loss=0.5800 acc=72.35%
[TRAIN][ep=041] mask_avg: mc_mean=0.2227 mb_mean=0.4721 norm_overlap=0.9954 corr_cb=-0.1538
[EPOCH 041/089] train: loss=0.5800 acc=72.35% | val: loss=0.6370 acc=66.27% f1=56.25% auc=69.42% val_score=41.5156 val_score_bestthr=60.4302 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.223, mb=0.472, no=0.995, corr=-0.154) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1100 -> 60.4302
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.2221 mb_mean=0.4719 norm_overlap=0.9969 corr_cb=-0.1201 topkJ=0.0310
[TRAIN][ep=042] loss=0.5753 acc=73.29%
[TRAIN][ep=042] mask_avg: mc_mean=0.2149 mb_mean=0.4721 norm_overlap=0.9957 corr_cb=-0.1391
[EPOCH 042/089] train: loss=0.5753 acc=73.29% | val: loss=0.6272 acc=66.27% f1=56.25% auc=70.17% val_score=39.8590 val_score_bestthr=60.4302 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.215, mb=0.472, no=0.996, corr=-0.139) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1100 -> 60.4302
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.2102 mb_mean=0.4726 norm_overlap=0.9931 corr_cb=-0.2163 topkJ=0.0182
[TRAIN][ep=043] loss=0.5827 acc=73.83%
[TRAIN][ep=043] mask_avg: mc_mean=0.2290 mb_mean=0.4721 norm_overlap=0.9952 corr_cb=-0.1620
[EPOCH 043/089] train: loss=0.5827 acc=73.83% | val: loss=0.6289 acc=66.27% f1=72.55% auc=72.62% val_score=54.9409 val_score_bestthr=65.4789 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.229, mb=0.472, no=0.995, corr=-0.162) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 64.1100 -> 65.4789
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2378 mb_mean=0.4690 norm_overlap=0.9953 corr_cb=-0.1586 topkJ=0.0341
[TRAIN][ep=044] loss=0.6639 acc=72.21%
[TRAIN][ep=044] mask_avg: mc_mean=0.2203 mb_mean=0.4721 norm_overlap=0.9954 corr_cb=-0.1511
[EPOCH 044/089] train: loss=0.6639 acc=72.21% | val: loss=0.6294 acc=65.06% f1=71.29% auc=72.73% val_score=54.9409 val_score_bestthr=62.8433 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.220, mb=0.472, no=0.995, corr=-0.151) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4789 -> 62.8433
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2071 mb_mean=0.4723 norm_overlap=0.9985 corr_cb=-0.0463 topkJ=0.0483
[TRAIN][ep=045] loss=0.7661 acc=71.54%
[TRAIN][ep=045] mask_avg: mc_mean=0.2055 mb_mean=0.4721 norm_overlap=0.9957 corr_cb=-0.1338
[EPOCH 045/089] train: loss=0.7661 acc=71.54% | val: loss=0.6181 acc=63.86% f1=70.59% auc=71.45% val_score=44.6504 val_score_bestthr=61.2172 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.205, mb=0.472, no=0.996, corr=-0.134) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4789 -> 61.2172
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.2327 mb_mean=0.4729 norm_overlap=0.9933 corr_cb=-0.2357 topkJ=0.0273
[TRAIN][ep=046] loss=0.8462 acc=74.23%
[TRAIN][ep=046] mask_avg: mc_mean=0.2318 mb_mean=0.4721 norm_overlap=0.9953 corr_cb=-0.1566
[EPOCH 046/089] train: loss=0.8462 acc=74.23% | val: loss=0.6189 acc=65.06% f1=71.84% auc=72.79% val_score=53.5053 val_score_bestthr=63.3061 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.232, mb=0.472, no=0.995, corr=-0.157) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4789 -> 63.3061
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.2038 mb_mean=0.4700 norm_overlap=0.9962 corr_cb=-0.1203 topkJ=0.0343
[TRAIN][ep=047] loss=0.9303 acc=74.77%
[TRAIN][ep=047] mask_avg: mc_mean=0.2118 mb_mean=0.4721 norm_overlap=0.9956 corr_cb=-0.1392
[EPOCH 047/089] train: loss=0.9303 acc=74.77% | val: loss=0.6162 acc=66.27% f1=70.83% auc=71.74% val_score=38.3378 val_score_bestthr=59.5988 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.212, mb=0.472, no=0.996, corr=-0.139) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4789 -> 59.5988
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.2540 mb_mean=0.4695 norm_overlap=0.9913 corr_cb=-0.3099 topkJ=0.0167
[TRAIN][ep=048] loss=1.0258 acc=73.02%
[TRAIN][ep=048] mask_avg: mc_mean=0.2288 mb_mean=0.4721 norm_overlap=0.9952 corr_cb=-0.1587
[EPOCH 048/089] train: loss=1.0258 acc=73.02% | val: loss=0.6296 acc=63.86% f1=51.61% auc=71.10% val_score=53.2487 val_score_bestthr=60.0200 | dyn(w_pfs=0.100, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.229, mb=0.472, no=0.995, corr=-0.159) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4789 -> 60.0200
[DBG][ep=049] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.1986 mb_mean=0.4735 norm_overlap=0.9942 corr_cb=-0.1721 topkJ=0.0324
[TRAIN][ep=049] loss=0.7802 acc=75.57%
[TRAIN][ep=049] mask_avg: mc_mean=0.2271 mb_mean=0.4721 norm_overlap=0.9951 corr_cb=-0.1584
[EPOCH 049/089] train: loss=0.7802 acc=75.57% | val: loss=0.6128 acc=65.06% f1=52.46% auc=72.21% val_score=43.8177 val_score_bestthr=59.1018 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.227, mb=0.472, no=0.995, corr=-0.158) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4789 -> 59.1018
[DBG][ep=050] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.2248 mb_mean=0.4713 norm_overlap=0.9933 corr_cb=-0.2112 topkJ=0.0238
[TRAIN][ep=050] loss=0.5379 acc=76.24%
[TRAIN][ep=050] mask_avg: mc_mean=0.2150 mb_mean=0.4721 norm_overlap=0.9954 corr_cb=-0.1462
[EPOCH 050/089] train: loss=0.5379 acc=76.24% | val: loss=0.6115 acc=63.86% f1=70.59% auc=72.21% val_score=41.0764 val_score_bestthr=61.2172 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.215, mb=0.472, no=0.995, corr=-0.146) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4789 -> 61.2172
[DBG][ep=051] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.2480 mb_mean=0.4781 norm_overlap=0.9938 corr_cb=-0.2205 topkJ=0.0202
[TRAIN][ep=051] loss=0.5344 acc=76.38%
[TRAIN][ep=051] mask_avg: mc_mean=0.2150 mb_mean=0.4721 norm_overlap=0.9954 corr_cb=-0.1454
[EPOCH 051/089] train: loss=0.5344 acc=76.38% | val: loss=0.6188 acc=65.06% f1=52.46% auc=72.15% val_score=46.8741 val_score_bestthr=59.1018 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.215, mb=0.472, no=0.995, corr=-0.145) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4789 -> 59.1018
[DBG][ep=052] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.2118 mb_mean=0.4697 norm_overlap=0.9975 corr_cb=-0.0707 topkJ=0.0445
[TRAIN][ep=052] loss=0.5365 acc=76.11%
[TRAIN][ep=052] mask_avg: mc_mean=0.2150 mb_mean=0.4721 norm_overlap=0.9954 corr_cb=-0.1426
[EPOCH 052/089] train: loss=0.5365 acc=76.11% | val: loss=0.6140 acc=65.06% f1=52.46% auc=72.09% val_score=45.3444 val_score_bestthr=59.1018 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.215, mb=0.472, no=0.995, corr=-0.143) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4789 -> 59.1018
[DBG][ep=053] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.1914 mb_mean=0.4687 norm_overlap=0.9943 corr_cb=-0.1820 topkJ=0.0324
[TRAIN][ep=053] loss=0.5351 acc=76.64%
[TRAIN][ep=053] mask_avg: mc_mean=0.2150 mb_mean=0.4721 norm_overlap=0.9954 corr_cb=-0.1420
[EPOCH 053/089] train: loss=0.5351 acc=76.64% | val: loss=0.6192 acc=65.06% f1=52.46% auc=71.86% val_score=49.6242 val_score_bestthr=59.1018 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.215, mb=0.472, no=0.995, corr=-0.142) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4789 -> 59.1018
[DBG][ep=054] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=054] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=054] mask(step0): mc_mean=0.2003 mb_mean=0.4716 norm_overlap=1.0038 corr_cb=0.1021 topkJ=0.0627
[TRAIN][ep=054] loss=0.5350 acc=75.17%
[TRAIN][ep=054] mask_avg: mc_mean=0.2149 mb_mean=0.4721 norm_overlap=0.9955 corr_cb=-0.1420
[EPOCH 054/089] train: loss=0.5350 acc=75.17% | val: loss=0.6136 acc=67.47% f1=71.58% auc=72.15% val_score=45.3444 val_score_bestthr=60.0604 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.215, mb=0.472, no=0.995, corr=-0.142) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4789 -> 60.0604
[DBG][ep=055] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=055] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=055] mask(step0): mc_mean=0.2385 mb_mean=0.4709 norm_overlap=0.9961 corr_cb=-0.1461 topkJ=0.0273
[TRAIN][ep=055] loss=0.5346 acc=75.70%
[TRAIN][ep=055] mask_avg: mc_mean=0.2149 mb_mean=0.4721 norm_overlap=0.9954 corr_cb=-0.1454
[EPOCH 055/089] train: loss=0.5346 acc=75.70% | val: loss=0.6165 acc=65.06% f1=52.46% auc=72.03% val_score=45.3444 val_score_bestthr=59.1018 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.215, mb=0.472, no=0.995, corr=-0.145) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4789 -> 59.1018
[DBG][ep=056] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=056] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=056] mask(step0): mc_mean=0.2374 mb_mean=0.4722 norm_overlap=0.9925 corr_cb=-0.2404 topkJ=0.0204
[TRAIN][ep=056] loss=0.5336 acc=75.70%
[TRAIN][ep=056] mask_avg: mc_mean=0.2150 mb_mean=0.4721 norm_overlap=0.9954 corr_cb=-0.1432
[EPOCH 056/089] train: loss=0.5336 acc=75.70% | val: loss=0.6124 acc=65.06% f1=52.46% auc=72.03% val_score=41.0764 val_score_bestthr=59.1018 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.215, mb=0.472, no=0.995, corr=-0.143) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4789 -> 59.1018
[DBG][ep=057] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=057] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=057] mask(step0): mc_mean=0.2291 mb_mean=0.4721 norm_overlap=0.9963 corr_cb=-0.1286 topkJ=0.0484
[TRAIN][ep=057] loss=0.5327 acc=76.78%
[TRAIN][ep=057] mask_avg: mc_mean=0.2149 mb_mean=0.4721 norm_overlap=0.9954 corr_cb=-0.1431
[EPOCH 057/089] train: loss=0.5327 acc=76.78% | val: loss=0.6126 acc=67.47% f1=72.16% auc=72.03% val_score=41.0764 val_score_bestthr=60.5565 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.215, mb=0.472, no=0.995, corr=-0.143) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4789 -> 60.5565
[DBG][ep=058] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=058] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=058] mask(step0): mc_mean=0.2633 mb_mean=0.4710 norm_overlap=0.9960 corr_cb=-0.1369 topkJ=0.0384
[TRAIN][ep=058] loss=0.5306 acc=76.64%
[TRAIN][ep=058] mask_avg: mc_mean=0.2150 mb_mean=0.4721 norm_overlap=0.9954 corr_cb=-0.1437
[EPOCH 058/089] train: loss=0.5306 acc=76.64% | val: loss=0.6167 acc=65.06% f1=52.46% auc=71.92% val_score=45.3444 val_score_bestthr=59.1018 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.215, mb=0.472, no=0.995, corr=-0.144) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4789 -> 59.1018
[DBG][ep=059] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=059] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=059] mask(step0): mc_mean=0.2030 mb_mean=0.4713 norm_overlap=0.9923 corr_cb=-0.2067 topkJ=0.0272
[TRAIN][ep=059] loss=0.5308 acc=76.51%
[TRAIN][ep=059] mask_avg: mc_mean=0.2149 mb_mean=0.4721 norm_overlap=0.9953 corr_cb=-0.1451
[EPOCH 059/089] train: loss=0.5308 acc=76.51% | val: loss=0.6206 acc=65.06% f1=52.46% auc=71.57% val_score=49.6242 val_score_bestthr=59.1018 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.215, mb=0.472, no=0.995, corr=-0.145) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4789 -> 59.1018
[DBG][ep=060] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=060] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=060] mask(step0): mc_mean=0.2127 mb_mean=0.4667 norm_overlap=0.9946 corr_cb=-0.1316 topkJ=0.0424
[TRAIN][ep=060] loss=0.5307 acc=77.05%
[TRAIN][ep=060] mask_avg: mc_mean=0.2150 mb_mean=0.4721 norm_overlap=0.9954 corr_cb=-0.1435
[EPOCH 060/089] train: loss=0.5307 acc=77.05% | val: loss=0.6118 acc=67.47% f1=72.16% auc=72.15% val_score=41.0764 val_score_bestthr=60.5565 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.215, mb=0.472, no=0.995, corr=-0.143) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4789 -> 60.5565
[DBG][ep=061] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=061] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=061] mask(step0): mc_mean=0.1993 mb_mean=0.4745 norm_overlap=0.9993 corr_cb=-0.0204 topkJ=0.0407
[TRAIN][ep=061] loss=0.5294 acc=77.45%
[TRAIN][ep=061] mask_avg: mc_mean=0.2150 mb_mean=0.4721 norm_overlap=0.9955 corr_cb=-0.1421
[EPOCH 061/089] train: loss=0.5294 acc=77.45% | val: loss=0.6260 acc=63.86% f1=70.00% auc=71.16% val_score=47.6711 val_score_bestthr=59.7840 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.215, mb=0.472, no=0.995, corr=-0.142) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4789 -> 59.7840
[DBG][ep=062] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=062] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=062] mask(step0): mc_mean=0.1729 mb_mean=0.4636 norm_overlap=0.9936 corr_cb=-0.1684 topkJ=0.0297
[TRAIN][ep=062] loss=0.5288 acc=76.78%
[TRAIN][ep=062] mask_avg: mc_mean=0.2149 mb_mean=0.4721 norm_overlap=0.9954 corr_cb=-0.1421
[EPOCH 062/089] train: loss=0.5288 acc=76.78% | val: loss=0.6151 acc=65.06% f1=52.46% auc=71.98% val_score=48.0915 val_score_bestthr=59.1018 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.215, mb=0.472, no=0.995, corr=-0.142) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4789 -> 59.1018
[DBG][ep=063] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=063] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=063] mask(step0): mc_mean=0.1998 mb_mean=0.4693 norm_overlap=0.9999 corr_cb=-0.0033 topkJ=0.0841
[TRAIN][ep=063] loss=0.5269 acc=76.11%
[TRAIN][ep=063] mask_avg: mc_mean=0.2149 mb_mean=0.4721 norm_overlap=0.9955 corr_cb=-0.1413
[EPOCH 063/089] train: loss=0.5269 acc=76.11% | val: loss=0.6146 acc=67.47% f1=72.16% auc=71.98% val_score=45.3444 val_score_bestthr=60.5565 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.215, mb=0.472, no=0.995, corr=-0.141) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4789 -> 60.5565
[DBG][ep=064] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=064] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=064] mask(step0): mc_mean=0.2055 mb_mean=0.4747 norm_overlap=0.9945 corr_cb=-0.1882 topkJ=0.0326
[TRAIN][ep=064] loss=0.5312 acc=75.57%
[TRAIN][ep=064] mask_avg: mc_mean=0.2149 mb_mean=0.4721 norm_overlap=0.9954 corr_cb=-0.1444
[EPOCH 064/089] train: loss=0.5312 acc=75.57% | val: loss=0.6088 acc=66.27% f1=71.43% auc=72.62% val_score=42.9517 val_score_bestthr=60.7883 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.215, mb=0.472, no=0.995, corr=-0.144) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4789 -> 60.7883
[DBG][ep=065] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=065] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=065] mask(step0): mc_mean=0.2288 mb_mean=0.4721 norm_overlap=0.9917 corr_cb=-0.2757 topkJ=0.0197
[TRAIN][ep=065] loss=0.5258 acc=77.32%
[TRAIN][ep=065] mask_avg: mc_mean=0.2150 mb_mean=0.4721 norm_overlap=0.9954 corr_cb=-0.1425
[EPOCH 065/089] train: loss=0.5258 acc=77.32% | val: loss=0.6165 acc=65.06% f1=70.71% auc=71.86% val_score=48.0915 val_score_bestthr=59.2724 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.215, mb=0.472, no=0.995, corr=-0.143) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4789 -> 59.2724
[DBG][ep=066] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=066] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=066] mask(step0): mc_mean=0.2322 mb_mean=0.4743 norm_overlap=0.9953 corr_cb=-0.1503 topkJ=0.0437
[TRAIN][ep=066] loss=0.5301 acc=75.97%
[TRAIN][ep=066] mask_avg: mc_mean=0.2149 mb_mean=0.4721 norm_overlap=0.9954 corr_cb=-0.1443
[EPOCH 066/089] train: loss=0.5301 acc=75.97% | val: loss=0.6112 acc=67.47% f1=72.16% auc=72.44% val_score=43.8177 val_score_bestthr=60.5565 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.215, mb=0.472, no=0.995, corr=-0.144) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4789 -> 60.5565
[DBG][ep=067] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=067] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=067] mask(step0): mc_mean=0.2248 mb_mean=0.4704 norm_overlap=0.9944 corr_cb=-0.1890 topkJ=0.0247
[TRAIN][ep=067] loss=0.5236 acc=76.38%
[TRAIN][ep=067] mask_avg: mc_mean=0.2150 mb_mean=0.4721 norm_overlap=0.9954 corr_cb=-0.1431
[EPOCH 067/089] train: loss=0.5236 acc=76.38% | val: loss=0.6093 acc=66.27% f1=71.43% auc=72.50% val_score=42.9517 val_score_bestthr=60.7883 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.215, mb=0.472, no=0.995, corr=-0.143) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4789 -> 60.7883
[DBG][ep=068] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=068] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=068] mask(step0): mc_mean=0.2279 mb_mean=0.4743 norm_overlap=0.9957 corr_cb=-0.1628 topkJ=0.0354
[TRAIN][ep=068] loss=0.5245 acc=76.91%
[TRAIN][ep=068] mask_avg: mc_mean=0.2150 mb_mean=0.4721 norm_overlap=0.9954 corr_cb=-0.1440
[EPOCH 068/089] train: loss=0.5245 acc=76.91% | val: loss=0.6099 acc=67.47% f1=72.16% auc=72.56% val_score=39.5552 val_score_bestthr=60.5565 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.215, mb=0.472, no=0.995, corr=-0.144) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4789 -> 60.5565
[DBG][ep=069] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=069] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=069] mask(step0): mc_mean=0.2013 mb_mean=0.4699 norm_overlap=0.9930 corr_cb=-0.1910 topkJ=0.0311
[TRAIN][ep=069] loss=0.5245 acc=77.99%
[TRAIN][ep=069] mask_avg: mc_mean=0.2149 mb_mean=0.4721 norm_overlap=0.9954 corr_cb=-0.1436
[EPOCH 069/089] train: loss=0.5245 acc=77.99% | val: loss=0.6089 acc=67.47% f1=72.16% auc=72.56% val_score=42.9517 val_score_bestthr=60.5565 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.215, mb=0.472, no=0.995, corr=-0.144) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4789 -> 60.5565
[DBG][ep=070] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=070] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=070] mask(step0): mc_mean=0.2292 mb_mean=0.4706 norm_overlap=0.9934 corr_cb=-0.1968 topkJ=0.0246
[TRAIN][ep=070] loss=0.5221 acc=77.18%
[TRAIN][ep=070] mask_avg: mc_mean=0.2150 mb_mean=0.4721 norm_overlap=0.9955 corr_cb=-0.1399
[EPOCH 070/089] train: loss=0.5221 acc=77.18% | val: loss=0.6113 acc=67.47% f1=72.16% auc=72.44% val_score=43.8177 val_score_bestthr=60.5565 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.215, mb=0.472, no=0.995, corr=-0.140) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4789 -> 60.5565
[DBG][ep=071] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=071] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=071] mask(step0): mc_mean=0.1976 mb_mean=0.4724 norm_overlap=0.9961 corr_cb=-0.1254 topkJ=0.0296
[TRAIN][ep=071] loss=0.5273 acc=76.51%
[TRAIN][ep=071] mask_avg: mc_mean=0.2150 mb_mean=0.4721 norm_overlap=0.9954 corr_cb=-0.1423
[EPOCH 071/089] train: loss=0.5273 acc=76.51% | val: loss=0.6143 acc=67.47% f1=72.16% auc=72.15% val_score=48.0915 val_score_bestthr=60.5565 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.215, mb=0.472, no=0.995, corr=-0.142) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4789 -> 60.5565
[DBG][ep=072] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=072] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=072] mask(step0): mc_mean=0.2384 mb_mean=0.4695 norm_overlap=0.9917 corr_cb=-0.2806 topkJ=0.0248
[TRAIN][ep=072] loss=0.5235 acc=77.45%
[TRAIN][ep=072] mask_avg: mc_mean=0.2150 mb_mean=0.4721 norm_overlap=0.9955 corr_cb=-0.1413
[EPOCH 072/089] train: loss=0.5235 acc=77.45% | val: loss=0.6108 acc=67.47% f1=72.16% auc=72.50% val_score=43.8177 val_score_bestthr=60.5565 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.215, mb=0.472, no=0.995, corr=-0.141) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4789 -> 60.5565
[DBG][ep=073] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=073] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=073] mask(step0): mc_mean=0.2087 mb_mean=0.4733 norm_overlap=0.9932 corr_cb=-0.1901 topkJ=0.0376
[TRAIN][ep=073] loss=0.5212 acc=76.91%
[TRAIN][ep=073] mask_avg: mc_mean=0.2150 mb_mean=0.4721 norm_overlap=0.9954 corr_cb=-0.1434
[EPOCH 073/089] train: loss=0.5212 acc=76.91% | val: loss=0.6112 acc=67.47% f1=72.16% auc=72.56% val_score=43.8177 val_score_bestthr=60.5565 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.215, mb=0.472, no=0.995, corr=-0.143) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4789 -> 60.5565
[EARLY STOP] no improvement for 30 epochs. best_epoch=43
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
=============== FIT DONE ===============
[BEST] epoch=43 | val_acc=66.27% | val_f1=72.55% | val_auc=72.62% | val_score=54.9409 | val_score_bestthr=65.4789
[TEST@BEST] thr_used=0.530 | acc=60.87% f1=65.82% auc=62.70% | SP_sex=9.80% EO_sex=6.53% SP_age=5.93% EO_age=15.14%
[TIME] 1.71 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/summary_fold_0.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4732 mb_mean=0.4739 norm_overlap=1.0003 corr_cb=0.4202 topkJ=0.1261
[TRAIN][ep=000] loss=0.6961 acc=50.60%
[TRAIN][ep=000] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3729
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4746 mb_mean=0.4736 norm_overlap=1.0001 corr_cb=0.2526 topkJ=0.1426
[TRAIN][ep=001] loss=0.6933 acc=49.93%
[TRAIN][ep=001] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3696
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4719 mb_mean=0.4692 norm_overlap=1.0002 corr_cb=0.4403 topkJ=0.2099
[TRAIN][ep=002] loss=0.6921 acc=52.08%
[TRAIN][ep=002] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3688
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4696 mb_mean=0.4711 norm_overlap=1.0003 corr_cb=0.4991 topkJ=0.2274
[TRAIN][ep=003] loss=0.6909 acc=55.03%
[TRAIN][ep=003] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3683
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4752 mb_mean=0.4728 norm_overlap=1.0003 corr_cb=0.4629 topkJ=0.1590
[TRAIN][ep=004] loss=0.6902 acc=51.54%
[TRAIN][ep=004] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3684
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4723 mb_mean=0.4722 norm_overlap=1.0002 corr_cb=0.3577 topkJ=0.1944
[TRAIN][ep=005] loss=0.6882 acc=52.89%
[TRAIN][ep=005] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3689
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4731 mb_mean=0.4733 norm_overlap=1.0004 corr_cb=0.5633 topkJ=0.1681
[TRAIN][ep=006] loss=0.6881 acc=56.38%
[TRAIN][ep=006] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3653
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4723 mb_mean=0.4718 norm_overlap=1.0002 corr_cb=0.4549 topkJ=0.1869
[TRAIN][ep=007] loss=0.6862 acc=58.93%
[TRAIN][ep=007] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3710
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4734 mb_mean=0.4747 norm_overlap=1.0002 corr_cb=0.3617 topkJ=0.1959
[TRAIN][ep=008] loss=0.6847 acc=60.13%
[TRAIN][ep=008] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3700
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4744 mb_mean=0.4729 norm_overlap=1.0001 corr_cb=0.3126 topkJ=0.0962
[TRAIN][ep=009] loss=0.6817 acc=58.52%
[TRAIN][ep=009] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3704
================= FIT START (fold=0) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4740 mb_mean=0.4722 norm_overlap=1.0002 corr_cb=0.3730 topkJ=0.1775
[TRAIN][ep=000] loss=0.6789 acc=59.87%
[TRAIN][ep=000] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3748
[EPOCH 000/089] train: loss=0.6789 acc=59.87% | val: loss=0.6865 acc=54.22% f1=68.33% auc=59.48% val_score=46.3336 val_score_bestthr=55.4717 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.375) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 55.4717
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4741 mb_mean=0.4758 norm_overlap=1.0000 corr_cb=0.0718 topkJ=0.1290
[TRAIN][ep=001] loss=0.6783 acc=58.26%
[TRAIN][ep=001] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3678
[EPOCH 001/089] train: loss=0.6783 acc=58.26% | val: loss=0.6842 acc=60.24% f1=64.52% auc=60.81% val_score=47.1923 val_score_bestthr=59.4427 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.368) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 55.4717 -> 59.4427
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4768 mb_mean=0.4754 norm_overlap=1.0002 corr_cb=0.3045 topkJ=0.2290
[TRAIN][ep=002] loss=0.6748 acc=57.32%
[TRAIN][ep=002] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3720
[EPOCH 002/089] train: loss=0.6748 acc=57.32% | val: loss=0.6785 acc=62.65% f1=68.04% auc=63.49% val_score=53.7443 val_score_bestthr=57.1873 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.372) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 59.4427 -> 57.1873
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4684 mb_mean=0.4694 norm_overlap=1.0003 corr_cb=0.5137 topkJ=0.2279
[TRAIN][ep=003] loss=0.6730 acc=62.68%
[TRAIN][ep=003] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3689
[EPOCH 003/089] train: loss=0.6730 acc=62.68% | val: loss=0.6781 acc=61.45% f1=65.22% auc=62.67% val_score=58.3379 val_score_bestthr=59.3651 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.369) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 59.4427 -> 59.3651
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4725 mb_mean=0.4704 norm_overlap=1.0002 corr_cb=0.4488 topkJ=0.1783
[TRAIN][ep=004] loss=0.6689 acc=61.74%
[TRAIN][ep=004] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3726
[EPOCH 004/089] train: loss=0.6689 acc=61.74% | val: loss=0.6913 acc=54.22% f1=68.85% auc=58.08% val_score=47.0410 val_score_bestthr=56.3443 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.373) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 59.4427 -> 56.3443
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4748 mb_mean=0.4735 norm_overlap=1.0001 corr_cb=0.2218 topkJ=0.0905
[TRAIN][ep=005] loss=1.4542 acc=58.66%
[TRAIN][ep=005] mask_avg: mc_mean=0.3915 mb_mean=0.4721 norm_overlap=1.0014 corr_cb=0.5347
[EPOCH 005/089] train: loss=1.4542 acc=58.66% | val: loss=0.6794 acc=63.86% f1=65.12% auc=62.85% val_score=46.0212 val_score_bestthr=60.5670 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.391, mb=0.472, no=1.001, corr=0.535) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 59.4427 -> 60.5670
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.3158 mb_mean=0.4730 norm_overlap=1.0014 corr_cb=0.3839 topkJ=0.2108
[TRAIN][ep=006] loss=1.4396 acc=62.68%
[TRAIN][ep=006] mask_avg: mc_mean=0.2904 mb_mean=0.4721 norm_overlap=1.0031 corr_cb=0.5080
[EPOCH 006/089] train: loss=1.4396 acc=62.68% | val: loss=0.6783 acc=63.86% f1=68.09% auc=63.31% val_score=48.5264 val_score_bestthr=60.9852 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.290, mb=0.472, no=1.003, corr=0.508) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 60.5670 -> 60.9852
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2598 mb_mean=0.4707 norm_overlap=1.0062 corr_cb=0.6458 topkJ=0.2188
[TRAIN][ep=007] loss=1.4366 acc=62.55%
[TRAIN][ep=007] mask_avg: mc_mean=0.2629 mb_mean=0.4721 norm_overlap=1.0034 corr_cb=0.4601
[EPOCH 007/089] train: loss=1.4366 acc=62.55% | val: loss=0.6744 acc=67.47% f1=69.66% auc=64.59% val_score=47.1564 val_score_bestthr=64.8810 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.263, mb=0.472, no=1.003, corr=0.460) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 60.9852 -> 64.8810
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2891 mb_mean=0.4760 norm_overlap=1.0018 corr_cb=0.2979 topkJ=0.1973
[TRAIN][ep=008] loss=1.4267 acc=63.89%
[TRAIN][ep=008] mask_avg: mc_mean=0.2505 mb_mean=0.4721 norm_overlap=1.0031 corr_cb=0.3730
[EPOCH 008/089] train: loss=1.4267 acc=63.89% | val: loss=0.6679 acc=67.47% f1=70.33% auc=66.45% val_score=59.0793 val_score_bestthr=62.7654 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.250, mb=0.472, no=1.003, corr=0.373) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.8810 -> 62.7654
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2297 mb_mean=0.4697 norm_overlap=1.0048 corr_cb=0.4711 topkJ=0.1615
[TRAIN][ep=009] loss=1.4158 acc=65.23%
[TRAIN][ep=009] mask_avg: mc_mean=0.2408 mb_mean=0.4721 norm_overlap=1.0029 corr_cb=0.3124
[EPOCH 009/089] train: loss=1.4158 acc=65.23% | val: loss=0.7020 acc=59.04% f1=64.58% auc=58.37% val_score=52.2235 val_score_bestthr=55.7183 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.241, mb=0.472, no=1.003, corr=0.312) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.8810 -> 55.7183
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.2456 mb_mean=0.4726 norm_overlap=1.0037 corr_cb=0.3837 topkJ=0.1020
[TRAIN][ep=010] loss=1.4246 acc=61.21%
[TRAIN][ep=010] mask_avg: mc_mean=0.2320 mb_mean=0.4721 norm_overlap=1.0026 corr_cb=0.2548
[EPOCH 010/089] train: loss=1.4246 acc=61.21% | val: loss=0.6627 acc=66.27% f1=70.21% auc=67.09% val_score=55.9868 val_score_bestthr=59.3281 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.232, mb=0.472, no=1.003, corr=0.255) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.8810 -> 59.3281
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.2429 mb_mean=0.4757 norm_overlap=1.0016 corr_cb=0.2017 topkJ=0.0714
[TRAIN][ep=011] loss=1.4093 acc=65.64%
[TRAIN][ep=011] mask_avg: mc_mean=0.2171 mb_mean=0.4721 norm_overlap=1.0025 corr_cb=0.2099
[EPOCH 011/089] train: loss=1.4093 acc=65.64% | val: loss=0.6645 acc=67.47% f1=72.73% auc=68.90% val_score=48.6120 val_score_bestthr=64.5160 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.217, mb=0.472, no=1.003, corr=0.210) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.8810 -> 64.5160
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.2098 mb_mean=0.4710 norm_overlap=1.0038 corr_cb=0.2817 topkJ=0.1302
[TRAIN][ep=012] loss=1.3975 acc=64.56%
[TRAIN][ep=012] mask_avg: mc_mean=0.2126 mb_mean=0.4721 norm_overlap=1.0019 corr_cb=0.1440
[EPOCH 012/089] train: loss=1.3975 acc=64.56% | val: loss=0.6570 acc=66.27% f1=69.57% auc=67.38% val_score=54.7484 val_score_bestthr=58.2757 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.213, mb=0.472, no=1.002, corr=0.144) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.8810 -> 58.2757
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.2405 mb_mean=0.4762 norm_overlap=1.0004 corr_cb=0.0363 topkJ=0.0688
[TRAIN][ep=013] loss=1.1802 acc=66.85%
[TRAIN][ep=013] mask_avg: mc_mean=0.2170 mb_mean=0.4721 norm_overlap=1.0010 corr_cb=0.0637
[EPOCH 013/089] train: loss=1.1802 acc=66.85% | val: loss=0.6544 acc=60.24% f1=68.57% auc=66.74% val_score=54.8863 val_score_bestthr=56.7060 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.217, mb=0.472, no=1.001, corr=0.064) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.8810 -> 56.7060
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.2335 mb_mean=0.4743 norm_overlap=1.0010 corr_cb=0.0776 topkJ=0.0820
[TRAIN][ep=014] loss=0.9552 acc=68.46%
[TRAIN][ep=014] mask_avg: mc_mean=0.2079 mb_mean=0.4721 norm_overlap=1.0003 corr_cb=0.0137
[EPOCH 014/089] train: loss=0.9552 acc=68.46% | val: loss=0.6625 acc=60.24% f1=67.33% auc=65.35% val_score=40.8386 val_score_bestthr=56.3567 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.208, mb=0.472, no=1.000, corr=0.014) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.8810 -> 56.3567
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1681 mb_mean=0.4689 norm_overlap=1.0013 corr_cb=0.0677 topkJ=0.0443
[TRAIN][ep=015] loss=0.9055 acc=70.34%
[TRAIN][ep=015] mask_avg: mc_mean=0.1900 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.0048
[EPOCH 015/089] train: loss=0.9055 acc=70.34% | val: loss=0.6821 acc=62.65% f1=66.67% auc=63.02% val_score=43.9698 val_score_bestthr=61.4424 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.472, no=1.000, corr=0.005) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.8810 -> 61.4424
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1935 mb_mean=0.4714 norm_overlap=1.0027 corr_cb=0.1379 topkJ=0.0563
[TRAIN][ep=016] loss=0.8860 acc=68.59%
[TRAIN][ep=016] mask_avg: mc_mean=0.1900 mb_mean=0.4721 norm_overlap=0.9997 corr_cb=-0.0228
[EPOCH 016/089] train: loss=0.8860 acc=68.59% | val: loss=0.6445 acc=54.22% f1=69.35% auc=67.97% val_score=55.2203 val_score_bestthr=62.4643 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.472, no=1.000, corr=-0.023) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.8810 -> 62.4643
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1946 mb_mean=0.4756 norm_overlap=0.9985 corr_cb=-0.0817 topkJ=0.0392
[TRAIN][ep=017] loss=0.8742 acc=68.86%
[TRAIN][ep=017] mask_avg: mc_mean=0.1888 mb_mean=0.4721 norm_overlap=0.9991 corr_cb=-0.0459
[EPOCH 017/089] train: loss=0.8742 acc=68.86% | val: loss=0.6413 acc=56.63% f1=70.49% auc=68.43% val_score=50.9978 val_score_bestthr=62.8887 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.189, mb=0.472, no=0.999, corr=-0.046) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.8810 -> 62.8887
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.2086 mb_mean=0.4736 norm_overlap=0.9984 corr_cb=-0.0812 topkJ=0.0251
[TRAIN][ep=018] loss=0.8713 acc=69.93%
[TRAIN][ep=018] mask_avg: mc_mean=0.2037 mb_mean=0.4721 norm_overlap=0.9981 corr_cb=-0.0857
[EPOCH 018/089] train: loss=0.8713 acc=69.93% | val: loss=0.6493 acc=57.83% f1=71.07% auc=66.80% val_score=40.5341 val_score_bestthr=63.8258 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.204, mb=0.472, no=0.998, corr=-0.086) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.8810 -> 63.8258
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1859 mb_mean=0.4748 norm_overlap=0.9936 corr_cb=-0.3070 topkJ=0.0112
[TRAIN][ep=019] loss=0.8668 acc=71.01%
[TRAIN][ep=019] mask_avg: mc_mean=0.1986 mb_mean=0.4721 norm_overlap=0.9979 corr_cb=-0.0988
[EPOCH 019/089] train: loss=0.8668 acc=71.01% | val: loss=0.6311 acc=67.47% f1=70.97% auc=69.59% val_score=55.1103 val_score_bestthr=59.0991 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.199, mb=0.472, no=0.998, corr=-0.099) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.8810 -> 59.0991
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1520 mb_mean=0.4736 norm_overlap=1.0004 corr_cb=0.0150 topkJ=0.0338
[TRAIN][ep=020] loss=0.8632 acc=70.47%
[TRAIN][ep=020] mask_avg: mc_mean=0.1906 mb_mean=0.4721 norm_overlap=0.9978 corr_cb=-0.0961
[EPOCH 020/089] train: loss=0.8632 acc=70.47% | val: loss=0.6626 acc=57.83% f1=71.07% auc=66.10% val_score=46.6283 val_score_bestthr=63.8258 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.191, mb=0.472, no=0.998, corr=-0.096) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.8810 -> 63.8258
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.1787 mb_mean=0.4700 norm_overlap=0.9972 corr_cb=-0.1131 topkJ=0.0319
[TRAIN][ep=021] loss=0.8598 acc=70.20%
[TRAIN][ep=021] mask_avg: mc_mean=0.2126 mb_mean=0.4721 norm_overlap=0.9970 corr_cb=-0.1305
[EPOCH 021/089] train: loss=0.8598 acc=70.20% | val: loss=0.6273 acc=66.27% f1=56.25% auc=69.83% val_score=49.3958 val_score_bestthr=60.4302 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.213, mb=0.472, no=0.997, corr=-0.131) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.8810 -> 60.4302
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1789 mb_mean=0.4722 norm_overlap=0.9986 corr_cb=-0.0504 topkJ=0.0368
[TRAIN][ep=022] loss=0.8488 acc=71.54%
[TRAIN][ep=022] mask_avg: mc_mean=0.1911 mb_mean=0.4721 norm_overlap=0.9974 corr_cb=-0.1069
[EPOCH 022/089] train: loss=0.8488 acc=71.54% | val: loss=0.6299 acc=65.06% f1=70.71% auc=69.13% val_score=48.1501 val_score_bestthr=58.7200 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.191, mb=0.472, no=0.997, corr=-0.107) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.8810 -> 58.7200
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1808 mb_mean=0.4728 norm_overlap=0.9967 corr_cb=-0.1229 topkJ=0.0346
[TRAIN][ep=023] loss=0.8413 acc=70.60%
[TRAIN][ep=023] mask_avg: mc_mean=0.1974 mb_mean=0.4721 norm_overlap=0.9970 corr_cb=-0.1187
[EPOCH 023/089] train: loss=0.8413 acc=70.60% | val: loss=0.6279 acc=66.27% f1=56.25% auc=70.58% val_score=52.7771 val_score_bestthr=60.4302 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.197, mb=0.472, no=0.997, corr=-0.119) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.8810 -> 60.4302
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2288 mb_mean=0.4734 norm_overlap=0.9988 corr_cb=-0.0496 topkJ=0.0490
[TRAIN][ep=024] loss=0.8317 acc=73.15%
[TRAIN][ep=024] mask_avg: mc_mean=0.2046 mb_mean=0.4721 norm_overlap=0.9964 corr_cb=-0.1388
[EPOCH 024/089] train: loss=0.8317 acc=73.15% | val: loss=0.6260 acc=66.27% f1=56.25% auc=69.88% val_score=45.5373 val_score_bestthr=60.4302 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.205, mb=0.472, no=0.996, corr=-0.139) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.8810 -> 60.4302
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1940 mb_mean=0.4715 norm_overlap=0.9993 corr_cb=-0.0239 topkJ=0.0386
[TRAIN][ep=025] loss=0.8260 acc=73.83%
[TRAIN][ep=025] mask_avg: mc_mean=0.1969 mb_mean=0.4721 norm_overlap=0.9966 corr_cb=-0.1259
[EPOCH 025/089] train: loss=0.8260 acc=73.83% | val: loss=0.6205 acc=65.06% f1=52.46% auc=70.12% val_score=38.6416 val_score_bestthr=59.1018 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.197, mb=0.472, no=0.997, corr=-0.126) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.8810 -> 59.1018
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1758 mb_mean=0.4765 norm_overlap=0.9964 corr_cb=-0.1449 topkJ=0.0410
[TRAIN][ep=026] loss=0.8220 acc=72.75%
[TRAIN][ep=026] mask_avg: mc_mean=0.1827 mb_mean=0.4721 norm_overlap=0.9969 corr_cb=-0.1124
[EPOCH 026/089] train: loss=0.8220 acc=72.75% | val: loss=0.6164 acc=65.06% f1=71.29% auc=71.16% val_score=44.1088 val_score_bestthr=60.5739 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.183, mb=0.472, no=0.997, corr=-0.112) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.8810 -> 60.5739
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2734 mb_mean=0.4714 norm_overlap=0.9933 corr_cb=-0.2979 topkJ=0.0209
[TRAIN][ep=027] loss=0.8344 acc=71.28%
[TRAIN][ep=027] mask_avg: mc_mean=0.2090 mb_mean=0.4721 norm_overlap=0.9962 corr_cb=-0.1437
[EPOCH 027/089] train: loss=0.8344 acc=71.28% | val: loss=0.6314 acc=57.83% f1=71.07% auc=70.00% val_score=54.0228 val_score_bestthr=63.8258 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.209, mb=0.472, no=0.996, corr=-0.144) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.8810 -> 63.8258
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1731 mb_mean=0.4701 norm_overlap=0.9981 corr_cb=-0.0501 topkJ=0.0294
[TRAIN][ep=028] loss=0.8109 acc=74.09%
[TRAIN][ep=028] mask_avg: mc_mean=0.2013 mb_mean=0.4721 norm_overlap=0.9963 corr_cb=-0.1334
[EPOCH 028/089] train: loss=0.8109 acc=74.09% | val: loss=0.6293 acc=57.83% f1=71.07% auc=70.35% val_score=54.0228 val_score_bestthr=63.8258 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.201, mb=0.472, no=0.996, corr=-0.133) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.8810 -> 63.8258
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.1979 mb_mean=0.4737 norm_overlap=0.9965 corr_cb=-0.1521 topkJ=0.0366
[TRAIN][ep=029] loss=0.8224 acc=72.75%
[TRAIN][ep=029] mask_avg: mc_mean=0.2052 mb_mean=0.4721 norm_overlap=0.9963 corr_cb=-0.1376
[EPOCH 029/089] train: loss=0.8224 acc=72.75% | val: loss=0.6271 acc=67.47% f1=59.70% auc=70.47% val_score=54.0228 val_score_bestthr=61.6725 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.205, mb=0.472, no=0.996, corr=-0.138) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.8810 -> 61.6725
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2184 mb_mean=0.4712 norm_overlap=0.9959 corr_cb=-0.1418 topkJ=0.0678
[TRAIN][ep=030] loss=0.8020 acc=75.03%
[TRAIN][ep=030] mask_avg: mc_mean=0.2096 mb_mean=0.4721 norm_overlap=0.9959 corr_cb=-0.1484
[EPOCH 030/089] train: loss=0.8020 acc=75.03% | val: loss=0.6534 acc=68.67% f1=60.61% auc=69.83% val_score=62.9260 val_score_bestthr=62.9260 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.210, mb=0.472, no=0.996, corr=-0.148) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.8810 -> 62.9260
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2223 mb_mean=0.4716 norm_overlap=0.9946 corr_cb=-0.1994 topkJ=0.0364
[TRAIN][ep=031] loss=0.7971 acc=73.69%
[TRAIN][ep=031] mask_avg: mc_mean=0.2015 mb_mean=0.4721 norm_overlap=0.9961 corr_cb=-0.1364
[EPOCH 031/089] train: loss=0.7971 acc=73.69% | val: loss=0.6034 acc=65.06% f1=71.29% auc=73.14% val_score=43.4330 val_score_bestthr=61.1210 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.202, mb=0.472, no=0.996, corr=-0.136) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.8810 -> 61.1210
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2053 mb_mean=0.4736 norm_overlap=0.9967 corr_cb=-0.1268 topkJ=0.0289
[TRAIN][ep=032] loss=0.7932 acc=74.36%
[TRAIN][ep=032] mask_avg: mc_mean=0.2153 mb_mean=0.4721 norm_overlap=0.9957 corr_cb=-0.1579
[EPOCH 032/089] train: loss=0.7932 acc=74.36% | val: loss=0.6282 acc=66.27% f1=73.08% auc=73.37% val_score=54.0797 val_score_bestthr=60.2038 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.215, mb=0.472, no=0.996, corr=-0.158) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.8810 -> 60.2038
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1732 mb_mean=0.4719 norm_overlap=0.9948 corr_cb=-0.1531 topkJ=0.0339
[TRAIN][ep=033] loss=0.7960 acc=72.75%
[TRAIN][ep=033] mask_avg: mc_mean=0.1791 mb_mean=0.4721 norm_overlap=0.9967 corr_cb=-0.1100
[EPOCH 033/089] train: loss=0.7960 acc=72.75% | val: loss=0.6111 acc=69.88% f1=62.69% auc=72.27% val_score=52.7923 val_score_bestthr=60.7698 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.179, mb=0.472, no=0.997, corr=-0.110) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.8810 -> 60.7698
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1869 mb_mean=0.4724 norm_overlap=0.9985 corr_cb=-0.0488 topkJ=0.0867
[TRAIN][ep=034] loss=0.7797 acc=73.69%
[TRAIN][ep=034] mask_avg: mc_mean=0.2035 mb_mean=0.4721 norm_overlap=0.9962 corr_cb=-0.1328
[EPOCH 034/089] train: loss=0.7797 acc=73.69% | val: loss=0.6026 acc=62.65% f1=70.48% auc=72.44% val_score=44.1270 val_score_bestthr=59.5282 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.203, mb=0.472, no=0.996, corr=-0.133) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.8810 -> 59.5282
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2095 mb_mean=0.4717 norm_overlap=1.0038 corr_cb=0.1125 topkJ=0.0584
[TRAIN][ep=035] loss=0.7796 acc=73.96%
[TRAIN][ep=035] mask_avg: mc_mean=0.2217 mb_mean=0.4721 norm_overlap=0.9956 corr_cb=-0.1618
[EPOCH 035/089] train: loss=0.7796 acc=73.96% | val: loss=0.6326 acc=69.88% f1=62.69% auc=71.92% val_score=58.3145 val_score_bestthr=60.7698 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.222, mb=0.472, no=0.996, corr=-0.162) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.8810 -> 60.7698
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2071 mb_mean=0.4719 norm_overlap=0.9951 corr_cb=-0.1476 topkJ=0.0324
[TRAIN][ep=036] loss=0.7868 acc=73.69%
[TRAIN][ep=036] mask_avg: mc_mean=0.1932 mb_mean=0.4721 norm_overlap=0.9965 corr_cb=-0.1217
[EPOCH 036/089] train: loss=0.7868 acc=73.69% | val: loss=0.6255 acc=65.06% f1=72.38% auc=74.88% val_score=53.9592 val_score_bestthr=59.0830 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.193, mb=0.472, no=0.996, corr=-0.122) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.8810 -> 59.0830
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1752 mb_mean=0.4646 norm_overlap=0.9963 corr_cb=-0.1152 topkJ=0.0566
[TRAIN][ep=037] loss=0.7787 acc=74.90%
[TRAIN][ep=037] mask_avg: mc_mean=0.2040 mb_mean=0.4721 norm_overlap=0.9961 corr_cb=-0.1402
[EPOCH 037/089] train: loss=0.7787 acc=74.90% | val: loss=0.5898 acc=66.27% f1=72.55% auc=74.13% val_score=44.1270 val_score_bestthr=63.5006 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.204, mb=0.472, no=0.996, corr=-0.140) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.8810 -> 63.5006
[EARLY STOP] no improvement for 30 epochs. best_epoch=7
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
=============== FIT DONE ===============
[BEST] epoch=7 | val_acc=67.47% | val_f1=69.66% | val_auc=64.59% | val_score=47.1564 | val_score_bestthr=64.8810
[TEST@BEST] thr_used=0.475 | acc=57.97% f1=62.98% auc=60.80% | SP_sex=4.09% EO_sex=1.69% SP_age=4.64% EO_age=16.45%
[TIME] 0.93 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/summary_fold_0.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4732 mb_mean=0.4739 norm_overlap=1.0003 corr_cb=0.4202 topkJ=0.1261
[TRAIN][ep=000] loss=0.6961 acc=50.60%
[TRAIN][ep=000] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3729
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4746 mb_mean=0.4736 norm_overlap=1.0001 corr_cb=0.2526 topkJ=0.1426
[TRAIN][ep=001] loss=0.6933 acc=49.93%
[TRAIN][ep=001] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3696
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4719 mb_mean=0.4692 norm_overlap=1.0002 corr_cb=0.4403 topkJ=0.2099
[TRAIN][ep=002] loss=0.6921 acc=52.08%
[TRAIN][ep=002] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3688
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4696 mb_mean=0.4711 norm_overlap=1.0003 corr_cb=0.4991 topkJ=0.2274
[TRAIN][ep=003] loss=0.6909 acc=55.03%
[TRAIN][ep=003] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3683
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4752 mb_mean=0.4728 norm_overlap=1.0003 corr_cb=0.4629 topkJ=0.1590
[TRAIN][ep=004] loss=0.6902 acc=51.54%
[TRAIN][ep=004] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3684
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4723 mb_mean=0.4722 norm_overlap=1.0002 corr_cb=0.3577 topkJ=0.1944
[TRAIN][ep=005] loss=0.6882 acc=52.89%
[TRAIN][ep=005] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3689
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4731 mb_mean=0.4733 norm_overlap=1.0004 corr_cb=0.5633 topkJ=0.1681
[TRAIN][ep=006] loss=0.6881 acc=56.38%
[TRAIN][ep=006] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3653
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4723 mb_mean=0.4718 norm_overlap=1.0002 corr_cb=0.4549 topkJ=0.1869
[TRAIN][ep=007] loss=0.6862 acc=58.93%
[TRAIN][ep=007] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3710
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4734 mb_mean=0.4747 norm_overlap=1.0002 corr_cb=0.3617 topkJ=0.1959
[TRAIN][ep=008] loss=0.6847 acc=60.13%
[TRAIN][ep=008] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3700
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4744 mb_mean=0.4729 norm_overlap=1.0001 corr_cb=0.3126 topkJ=0.0962
[TRAIN][ep=009] loss=0.6817 acc=58.52%
[TRAIN][ep=009] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3704
================= FIT START (fold=0) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.45 select_by=val_score_bestthr | eval_thr_mode=fixed eval_thr_grid=coarse | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4740 mb_mean=0.4722 norm_overlap=1.0002 corr_cb=0.3730 topkJ=0.1775
[TRAIN][ep=000] loss=0.6789 acc=59.87%
[TRAIN][ep=000] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3748
[EPOCH 000/089] train: loss=0.6789 acc=59.87% | val: loss=0.6865 acc=53.01% f1=67.23% auc=59.48% val_score=49.4065 val_score_bestthr=49.4065 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.375) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 49.4065
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4741 mb_mean=0.4758 norm_overlap=1.0000 corr_cb=0.0718 topkJ=0.1290
[TRAIN][ep=001] loss=0.6783 acc=58.26%
[TRAIN][ep=001] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3678
[EPOCH 001/089] train: loss=0.6783 acc=58.26% | val: loss=0.6842 acc=54.22% f1=68.33% auc=60.81% val_score=55.4717 val_score_bestthr=55.4717 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.368) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 49.4065 -> 55.4717
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4768 mb_mean=0.4754 norm_overlap=1.0002 corr_cb=0.3045 topkJ=0.2290
[TRAIN][ep=002] loss=0.6748 acc=57.32%
[TRAIN][ep=002] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3720
[EPOCH 002/089] train: loss=0.6748 acc=57.32% | val: loss=0.6785 acc=53.01% f1=68.80% auc=63.43% val_score=61.9118 val_score_bestthr=61.9118 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.372) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 55.4717 -> 61.9118
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4684 mb_mean=0.4694 norm_overlap=1.0003 corr_cb=0.5137 topkJ=0.2279
[TRAIN][ep=003] loss=0.6730 acc=62.68%
[TRAIN][ep=003] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3689
[EPOCH 003/089] train: loss=0.6730 acc=62.68% | val: loss=0.6781 acc=53.01% f1=67.77% auc=62.67% val_score=54.3851 val_score_bestthr=54.3851 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.369) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.9118 -> 54.3851
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4725 mb_mean=0.4704 norm_overlap=1.0002 corr_cb=0.4488 topkJ=0.1783
[TRAIN][ep=004] loss=0.6689 acc=61.74%
[TRAIN][ep=004] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3726
[EPOCH 004/089] train: loss=0.6689 acc=61.74% | val: loss=0.6913 acc=54.22% f1=56.82% auc=58.08% val_score=55.4114 val_score_bestthr=55.4114 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.373) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.9118 -> 55.4114
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4748 mb_mean=0.4735 norm_overlap=1.0001 corr_cb=0.2218 topkJ=0.0905
[TRAIN][ep=005] loss=1.4542 acc=58.79%
[TRAIN][ep=005] mask_avg: mc_mean=0.3915 mb_mean=0.4721 norm_overlap=1.0014 corr_cb=0.5347
[EPOCH 005/089] train: loss=1.4542 acc=58.79% | val: loss=0.6793 acc=51.81% f1=64.91% auc=62.91% val_score=48.5357 val_score_bestthr=48.5357 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.392, mb=0.472, no=1.001, corr=0.535) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.9118 -> 48.5357
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.3159 mb_mean=0.4730 norm_overlap=1.0014 corr_cb=0.3840 topkJ=0.2108
[TRAIN][ep=006] loss=1.4396 acc=62.82%
[TRAIN][ep=006] mask_avg: mc_mean=0.2904 mb_mean=0.4721 norm_overlap=1.0031 corr_cb=0.5081
[EPOCH 006/089] train: loss=1.4396 acc=62.82% | val: loss=0.6783 acc=54.22% f1=64.81% auc=63.26% val_score=55.0076 val_score_bestthr=55.0076 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.290, mb=0.472, no=1.003, corr=0.508) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.9118 -> 55.0076
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2599 mb_mean=0.4707 norm_overlap=1.0062 corr_cb=0.6458 topkJ=0.2188
[TRAIN][ep=007] loss=1.4366 acc=62.55%
[TRAIN][ep=007] mask_avg: mc_mean=0.2629 mb_mean=0.4721 norm_overlap=1.0034 corr_cb=0.4602
[EPOCH 007/089] train: loss=1.4366 acc=62.55% | val: loss=0.6744 acc=51.81% f1=64.29% auc=64.65% val_score=51.7961 val_score_bestthr=51.7961 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.263, mb=0.472, no=1.003, corr=0.460) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.9118 -> 51.7961
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2891 mb_mean=0.4760 norm_overlap=1.0018 corr_cb=0.2981 topkJ=0.1967
[TRAIN][ep=008] loss=1.2109 acc=64.30%
[TRAIN][ep=008] mask_avg: mc_mean=0.2514 mb_mean=0.4721 norm_overlap=1.0030 corr_cb=0.3694
[EPOCH 008/089] train: loss=1.2109 acc=64.30% | val: loss=0.6678 acc=54.22% f1=68.33% auc=65.99% val_score=55.3195 val_score_bestthr=55.3195 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.251, mb=0.472, no=1.003, corr=0.369) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.9118 -> 55.3195
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2306 mb_mean=0.4697 norm_overlap=1.0047 corr_cb=0.4637 topkJ=0.1594
[TRAIN][ep=009] loss=0.9860 acc=65.37%
[TRAIN][ep=009] mask_avg: mc_mean=0.2412 mb_mean=0.4721 norm_overlap=1.0028 corr_cb=0.2990
[EPOCH 009/089] train: loss=0.9860 acc=65.37% | val: loss=0.7033 acc=56.63% f1=45.45% auc=58.60% val_score=37.8990 val_score_bestthr=37.8990 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.241, mb=0.472, no=1.003, corr=0.299) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.9118 -> 37.8990
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.2456 mb_mean=0.4726 norm_overlap=1.0036 corr_cb=0.3653 topkJ=0.0997
[TRAIN][ep=010] loss=0.9475 acc=61.74%
[TRAIN][ep=010] mask_avg: mc_mean=0.2349 mb_mean=0.4721 norm_overlap=1.0024 corr_cb=0.2290
[EPOCH 010/089] train: loss=0.9475 acc=61.74% | val: loss=0.6629 acc=50.60% f1=64.96% auc=66.63% val_score=48.8594 val_score_bestthr=48.8594 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.235, mb=0.472, no=1.002, corr=0.229) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.9118 -> 48.8594
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.2449 mb_mean=0.4757 norm_overlap=1.0014 corr_cb=0.1697 topkJ=0.0669
[TRAIN][ep=011] loss=0.9210 acc=65.77%
[TRAIN][ep=011] mask_avg: mc_mean=0.2204 mb_mean=0.4721 norm_overlap=1.0022 corr_cb=0.1781
[EPOCH 011/089] train: loss=0.9210 acc=65.77% | val: loss=0.6656 acc=54.22% f1=68.33% auc=68.08% val_score=55.3195 val_score_bestthr=55.3195 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.220, mb=0.472, no=1.002, corr=0.178) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.9118 -> 55.3195
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.2128 mb_mean=0.4710 norm_overlap=1.0034 corr_cb=0.2475 topkJ=0.1262
[TRAIN][ep=012] loss=0.9092 acc=64.30%
[TRAIN][ep=012] mask_avg: mc_mean=0.2153 mb_mean=0.4721 norm_overlap=1.0016 corr_cb=0.1181
[EPOCH 012/089] train: loss=0.9092 acc=64.30% | val: loss=0.6587 acc=54.22% f1=66.67% auc=66.40% val_score=52.0056 val_score_bestthr=52.0056 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.215, mb=0.472, no=1.002, corr=0.118) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.9118 -> 52.0056
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.2435 mb_mean=0.4762 norm_overlap=1.0002 corr_cb=0.0195 topkJ=0.0642
[TRAIN][ep=013] loss=0.9066 acc=67.11%
[TRAIN][ep=013] mask_avg: mc_mean=0.2195 mb_mean=0.4721 norm_overlap=1.0007 corr_cb=0.0467
[EPOCH 013/089] train: loss=0.9066 acc=67.11% | val: loss=0.6565 acc=60.24% f1=68.57% auc=66.10% val_score=54.9560 val_score_bestthr=54.9560 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.220, mb=0.472, no=1.001, corr=0.047) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.9118 -> 54.9560
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.2376 mb_mean=0.4743 norm_overlap=1.0008 corr_cb=0.0638 topkJ=0.0810
[TRAIN][ep=014] loss=0.8972 acc=67.65%
[TRAIN][ep=014] mask_avg: mc_mean=0.2114 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.0034
[EPOCH 014/089] train: loss=0.8972 acc=67.65% | val: loss=0.6647 acc=61.45% f1=62.79% auc=64.42% val_score=51.9068 val_score_bestthr=51.9068 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.211, mb=0.472, no=1.000, corr=0.003) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.9118 -> 51.9068
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1709 mb_mean=0.4689 norm_overlap=1.0012 corr_cb=0.0621 topkJ=0.0448
[TRAIN][ep=015] loss=0.8922 acc=69.93%
[TRAIN][ep=015] mask_avg: mc_mean=0.1912 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.0036
[EPOCH 015/089] train: loss=0.8922 acc=69.93% | val: loss=0.6852 acc=56.63% f1=51.35% auc=62.50% val_score=39.3254 val_score_bestthr=39.3254 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.191, mb=0.472, no=1.000, corr=0.004) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.9118 -> 39.3254
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1944 mb_mean=0.4714 norm_overlap=1.0027 corr_cb=0.1418 topkJ=0.0567
[TRAIN][ep=016] loss=0.8878 acc=68.86%
[TRAIN][ep=016] mask_avg: mc_mean=0.1920 mb_mean=0.4721 norm_overlap=0.9997 corr_cb=-0.0232
[EPOCH 016/089] train: loss=0.8878 acc=68.86% | val: loss=0.6460 acc=61.45% f1=68.63% auc=67.56% val_score=54.1994 val_score_bestthr=54.1994 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.192, mb=0.472, no=1.000, corr=-0.023) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.9118 -> 54.1994
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1953 mb_mean=0.4756 norm_overlap=0.9985 corr_cb=-0.0794 topkJ=0.0405
[TRAIN][ep=017] loss=0.8759 acc=69.26%
[TRAIN][ep=017] mask_avg: mc_mean=0.1892 mb_mean=0.4721 norm_overlap=0.9992 corr_cb=-0.0436
[EPOCH 017/089] train: loss=0.8759 acc=69.26% | val: loss=0.6425 acc=60.24% f1=67.96% auc=68.37% val_score=53.0975 val_score_bestthr=53.0975 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.189, mb=0.472, no=0.999, corr=-0.044) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.9118 -> 53.0975
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.2086 mb_mean=0.4736 norm_overlap=0.9984 corr_cb=-0.0804 topkJ=0.0260
[TRAIN][ep=018] loss=0.8729 acc=69.93%
[TRAIN][ep=018] mask_avg: mc_mean=0.2037 mb_mean=0.4721 norm_overlap=0.9982 corr_cb=-0.0841
[EPOCH 018/089] train: loss=0.8729 acc=69.93% | val: loss=0.6504 acc=62.65% f1=63.53% auc=66.69% val_score=53.0195 val_score_bestthr=53.0195 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.204, mb=0.472, no=0.998, corr=-0.084) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.9118 -> 53.0195
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1896 mb_mean=0.4748 norm_overlap=0.9938 corr_cb=-0.3123 topkJ=0.0112
[TRAIN][ep=019] loss=0.8685 acc=71.14%
[TRAIN][ep=019] mask_avg: mc_mean=0.1994 mb_mean=0.4721 norm_overlap=0.9979 corr_cb=-0.0987
[EPOCH 019/089] train: loss=0.8685 acc=71.14% | val: loss=0.6325 acc=60.24% f1=67.96% auc=69.36% val_score=55.3947 val_score_bestthr=55.3947 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.199, mb=0.472, no=0.998, corr=-0.099) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.9118 -> 55.3947
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1540 mb_mean=0.4736 norm_overlap=1.0004 corr_cb=0.0165 topkJ=0.0342
[TRAIN][ep=020] loss=0.8646 acc=70.20%
[TRAIN][ep=020] mask_avg: mc_mean=0.1905 mb_mean=0.4721 norm_overlap=0.9978 corr_cb=-0.0952
[EPOCH 020/089] train: loss=0.8646 acc=70.20% | val: loss=0.6637 acc=59.04% f1=55.26% auc=66.10% val_score=38.5783 val_score_bestthr=38.5783 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.191, mb=0.472, no=0.998, corr=-0.095) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.9118 -> 38.5783
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.1782 mb_mean=0.4700 norm_overlap=0.9973 corr_cb=-0.1133 topkJ=0.0315
[TRAIN][ep=021] loss=0.8606 acc=70.34%
[TRAIN][ep=021] mask_avg: mc_mean=0.2109 mb_mean=0.4721 norm_overlap=0.9971 corr_cb=-0.1290
[EPOCH 021/089] train: loss=0.8606 acc=70.34% | val: loss=0.6280 acc=63.86% f1=68.75% auc=69.77% val_score=52.7771 val_score_bestthr=52.7771 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.211, mb=0.472, no=0.997, corr=-0.129) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.9118 -> 52.7771
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1786 mb_mean=0.4722 norm_overlap=0.9987 corr_cb=-0.0491 topkJ=0.0368
[TRAIN][ep=022] loss=0.8502 acc=71.01%
[TRAIN][ep=022] mask_avg: mc_mean=0.1906 mb_mean=0.4721 norm_overlap=0.9974 corr_cb=-0.1072
[EPOCH 022/089] train: loss=0.8502 acc=71.01% | val: loss=0.6309 acc=62.65% f1=66.67% auc=68.95% val_score=47.6090 val_score_bestthr=47.6090 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.191, mb=0.472, no=0.997, corr=-0.107) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.9118 -> 47.6090
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1797 mb_mean=0.4728 norm_overlap=0.9967 corr_cb=-0.1232 topkJ=0.0355
[TRAIN][ep=023] loss=0.8424 acc=70.20%
[TRAIN][ep=023] mask_avg: mc_mean=0.1961 mb_mean=0.4721 norm_overlap=0.9970 corr_cb=-0.1188
[EPOCH 023/089] train: loss=0.8424 acc=70.20% | val: loss=0.6283 acc=61.45% f1=69.23% auc=70.58% val_score=56.6039 val_score_bestthr=56.6039 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.196, mb=0.472, no=0.997, corr=-0.119) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.9118 -> 56.6039
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2286 mb_mean=0.4734 norm_overlap=0.9988 corr_cb=-0.0490 topkJ=0.0472
[TRAIN][ep=024] loss=0.8330 acc=73.29%
[TRAIN][ep=024] mask_avg: mc_mean=0.2029 mb_mean=0.4721 norm_overlap=0.9964 corr_cb=-0.1397
[EPOCH 024/089] train: loss=0.8330 acc=73.29% | val: loss=0.6268 acc=63.86% f1=65.12% auc=70.06% val_score=44.1088 val_score_bestthr=44.1088 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.203, mb=0.472, no=0.996, corr=-0.140) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.9118 -> 44.1088
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1924 mb_mean=0.4715 norm_overlap=0.9993 corr_cb=-0.0218 topkJ=0.0382
[TRAIN][ep=025] loss=0.8272 acc=73.83%
[TRAIN][ep=025] mask_avg: mc_mean=0.1952 mb_mean=0.4721 norm_overlap=0.9966 corr_cb=-0.1269
[EPOCH 025/089] train: loss=0.8272 acc=73.83% | val: loss=0.6209 acc=65.06% f1=67.42% auc=69.83% val_score=46.4825 val_score_bestthr=46.4825 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.195, mb=0.472, no=0.997, corr=-0.127) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.9118 -> 46.4825
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1783 mb_mean=0.4765 norm_overlap=0.9964 corr_cb=-0.1522 topkJ=0.0401
[TRAIN][ep=026] loss=0.8230 acc=72.75%
[TRAIN][ep=026] mask_avg: mc_mean=0.1844 mb_mean=0.4721 norm_overlap=0.9968 corr_cb=-0.1180
[EPOCH 026/089] train: loss=0.8230 acc=72.75% | val: loss=0.6165 acc=65.06% f1=68.82% auc=70.93% val_score=50.9978 val_score_bestthr=50.9978 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.184, mb=0.472, no=0.997, corr=-0.118) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.9118 -> 50.9978
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2695 mb_mean=0.4714 norm_overlap=0.9934 corr_cb=-0.3004 topkJ=0.0213
[TRAIN][ep=027] loss=0.8348 acc=71.28%
[TRAIN][ep=027] mask_avg: mc_mean=0.2092 mb_mean=0.4721 norm_overlap=0.9961 corr_cb=-0.1479
[EPOCH 027/089] train: loss=0.8348 acc=71.28% | val: loss=0.6301 acc=62.65% f1=61.73% auc=70.23% val_score=41.2783 val_score_bestthr=41.2783 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.209, mb=0.472, no=0.996, corr=-0.148) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.9118 -> 41.2783
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1717 mb_mean=0.4701 norm_overlap=0.9983 corr_cb=-0.0477 topkJ=0.0290
[TRAIN][ep=028] loss=0.8114 acc=73.96%
[TRAIN][ep=028] mask_avg: mc_mean=0.1998 mb_mean=0.4721 norm_overlap=0.9963 corr_cb=-0.1357
[EPOCH 028/089] train: loss=0.8114 acc=73.96% | val: loss=0.6292 acc=63.86% f1=63.41% auc=70.41% val_score=38.7730 val_score_bestthr=38.7730 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.200, mb=0.472, no=0.996, corr=-0.136) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.9118 -> 38.7730
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.1948 mb_mean=0.4737 norm_overlap=0.9965 corr_cb=-0.1542 topkJ=0.0370
[TRAIN][ep=029] loss=0.8226 acc=72.75%
[TRAIN][ep=029] mask_avg: mc_mean=0.2029 mb_mean=0.4721 norm_overlap=0.9963 corr_cb=-0.1393
[EPOCH 029/089] train: loss=0.8226 acc=72.75% | val: loss=0.6263 acc=66.27% f1=65.00% auc=70.52% val_score=44.2610 val_score_bestthr=44.2610 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.203, mb=0.472, no=0.996, corr=-0.139) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.9118 -> 44.2610
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2183 mb_mean=0.4712 norm_overlap=0.9959 corr_cb=-0.1471 topkJ=0.0653
[TRAIN][ep=030] loss=0.8025 acc=74.90%
[TRAIN][ep=030] mask_avg: mc_mean=0.2087 mb_mean=0.4721 norm_overlap=0.9959 corr_cb=-0.1525
[EPOCH 030/089] train: loss=0.8025 acc=74.90% | val: loss=0.6533 acc=66.27% f1=61.11% auc=70.12% val_score=54.0228 val_score_bestthr=54.0228 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.209, mb=0.472, no=0.996, corr=-0.153) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.9118 -> 54.0228
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2205 mb_mean=0.4716 norm_overlap=0.9946 corr_cb=-0.2034 topkJ=0.0369
[TRAIN][ep=031] loss=0.7976 acc=73.42%
[TRAIN][ep=031] mask_avg: mc_mean=0.1995 mb_mean=0.4721 norm_overlap=0.9961 corr_cb=-0.1391
[EPOCH 031/089] train: loss=0.7976 acc=73.42% | val: loss=0.6034 acc=63.86% f1=68.09% auc=72.91% val_score=51.6361 val_score_bestthr=51.6361 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.200, mb=0.472, no=0.996, corr=-0.139) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.9118 -> 51.6361
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2023 mb_mean=0.4736 norm_overlap=0.9967 corr_cb=-0.1271 topkJ=0.0301
[TRAIN][ep=032] loss=0.7933 acc=74.77%
[TRAIN][ep=032] mask_avg: mc_mean=0.2127 mb_mean=0.4721 norm_overlap=0.9957 corr_cb=-0.1602
[EPOCH 032/089] train: loss=0.7933 acc=74.77% | val: loss=0.6280 acc=66.27% f1=73.08% auc=73.31% val_score=60.2038 val_score_bestthr=60.2038 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.213, mb=0.472, no=0.996, corr=-0.160) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.9118 -> 60.2038
[EARLY STOP] no improvement for 30 epochs. best_epoch=2
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
=============== FIT DONE ===============
[BEST] epoch=2 | val_acc=53.01% | val_f1=68.80% | val_auc=63.43% | val_score=61.9118 | val_score_bestthr=61.9118
[TEST@BEST] thr_used=0.450 | acc=52.66% f1=68.39% auc=58.03% | SP_sex=5.13% EO_sex=0.00% SP_age=3.51% EO_age=0.00%
[TIME] 0.67 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/summary_fold_0.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4732 mb_mean=0.4739 norm_overlap=1.0003 corr_cb=0.4202 topkJ=0.1261
[TRAIN][ep=000] loss=0.6955 acc=51.54%
[TRAIN][ep=000] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3729
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4746 mb_mean=0.4736 norm_overlap=1.0001 corr_cb=0.2526 topkJ=0.1426
[TRAIN][ep=001] loss=0.6932 acc=50.74%
[TRAIN][ep=001] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3696
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4719 mb_mean=0.4692 norm_overlap=1.0002 corr_cb=0.4403 topkJ=0.2099
[TRAIN][ep=002] loss=0.6920 acc=50.60%
[TRAIN][ep=002] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3688
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4696 mb_mean=0.4711 norm_overlap=1.0003 corr_cb=0.4991 topkJ=0.2274
[TRAIN][ep=003] loss=0.6903 acc=55.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3683
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4752 mb_mean=0.4728 norm_overlap=1.0003 corr_cb=0.4629 topkJ=0.1590
[TRAIN][ep=004] loss=0.6892 acc=52.21%
[TRAIN][ep=004] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3684
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4723 mb_mean=0.4722 norm_overlap=1.0002 corr_cb=0.3577 topkJ=0.1944
[TRAIN][ep=005] loss=0.6859 acc=55.17%
[TRAIN][ep=005] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3689
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4731 mb_mean=0.4733 norm_overlap=1.0004 corr_cb=0.5633 topkJ=0.1681
[TRAIN][ep=006] loss=0.6864 acc=57.45%
[TRAIN][ep=006] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3653
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4723 mb_mean=0.4718 norm_overlap=1.0002 corr_cb=0.4549 topkJ=0.1869
[TRAIN][ep=007] loss=0.6834 acc=58.39%
[TRAIN][ep=007] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3710
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4734 mb_mean=0.4747 norm_overlap=1.0002 corr_cb=0.3617 topkJ=0.1959
[TRAIN][ep=008] loss=0.6814 acc=59.60%
[TRAIN][ep=008] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3700
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4744 mb_mean=0.4729 norm_overlap=1.0001 corr_cb=0.3126 topkJ=0.0962
[TRAIN][ep=009] loss=0.6766 acc=59.33%
[TRAIN][ep=009] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3704
================= FIT START (fold=0) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4740 mb_mean=0.4722 norm_overlap=1.0002 corr_cb=0.3730 topkJ=0.1775
[TRAIN][ep=000] loss=0.6722 acc=61.61%
[TRAIN][ep=000] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3748
[EPOCH 000/089] train: loss=0.6722 acc=61.61% | val: loss=0.6833 acc=60.24% f1=63.74% auc=60.58% val_score=37.0937 val_score_bestthr=61.8943 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.375) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 61.8943
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4741 mb_mean=0.4758 norm_overlap=1.0000 corr_cb=0.0718 topkJ=0.1290
[TRAIN][ep=001] loss=0.6662 acc=59.60%
[TRAIN][ep=001] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3678
[EPOCH 001/089] train: loss=0.6662 acc=59.60% | val: loss=0.6972 acc=59.04% f1=63.83% auc=58.43% val_score=54.9121 val_score_bestthr=59.1945 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.368) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.8943 -> 59.1945
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4768 mb_mean=0.4754 norm_overlap=1.0002 corr_cb=0.3045 topkJ=0.2290
[TRAIN][ep=002] loss=0.6649 acc=61.21%
[TRAIN][ep=002] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3720
[EPOCH 002/089] train: loss=0.6649 acc=61.21% | val: loss=0.6742 acc=60.24% f1=64.52% auc=63.78% val_score=56.8472 val_score_bestthr=59.4427 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.372) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.8943 -> 59.4427
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4684 mb_mean=0.4694 norm_overlap=1.0003 corr_cb=0.5137 topkJ=0.2279
[TRAIN][ep=003] loss=0.6625 acc=62.95%
[TRAIN][ep=003] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3689
[EPOCH 003/089] train: loss=0.6625 acc=62.95% | val: loss=0.6673 acc=63.86% f1=66.67% auc=65.17% val_score=55.0292 val_score_bestthr=62.2240 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.369) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 61.8943 -> 62.2240
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4725 mb_mean=0.4704 norm_overlap=1.0002 corr_cb=0.4488 topkJ=0.1783
[TRAIN][ep=004] loss=0.6562 acc=64.16%
[TRAIN][ep=004] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3726
[EPOCH 004/089] train: loss=0.6562 acc=64.16% | val: loss=0.6846 acc=60.24% f1=63.74% auc=60.76% val_score=40.1125 val_score_bestthr=58.9269 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.373) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.2240 -> 58.9269
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4748 mb_mean=0.4735 norm_overlap=1.0001 corr_cb=0.2218 topkJ=0.0905
[TRAIN][ep=005] loss=1.3716 acc=62.01%
[TRAIN][ep=005] mask_avg: mc_mean=0.3868 mb_mean=0.4721 norm_overlap=1.0015 corr_cb=0.5392
[EPOCH 005/089] train: loss=1.3716 acc=62.01% | val: loss=0.6672 acc=68.67% f1=71.11% auc=66.16% val_score=47.1564 val_score_bestthr=64.3671 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.387, mb=0.472, no=1.002, corr=0.539) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 62.2240 -> 64.3671
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.3076 mb_mean=0.4730 norm_overlap=1.0016 corr_cb=0.3853 topkJ=0.2132
[TRAIN][ep=006] loss=1.3545 acc=62.68%
[TRAIN][ep=006] mask_avg: mc_mean=0.2829 mb_mean=0.4721 norm_overlap=1.0032 corr_cb=0.5040
[EPOCH 006/089] train: loss=1.3545 acc=62.68% | val: loss=0.6901 acc=60.24% f1=65.26% auc=61.80% val_score=50.2325 val_score_bestthr=58.0251 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.283, mb=0.472, no=1.003, corr=0.504) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 58.0251
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2514 mb_mean=0.4707 norm_overlap=1.0066 corr_cb=0.6430 topkJ=0.2142
[TRAIN][ep=007] loss=1.3515 acc=62.28%
[TRAIN][ep=007] mask_avg: mc_mean=0.2554 mb_mean=0.4721 norm_overlap=1.0036 corr_cb=0.4665
[EPOCH 007/089] train: loss=1.3515 acc=62.28% | val: loss=0.6560 acc=67.47% f1=69.66% auc=68.31% val_score=61.7986 val_score_bestthr=64.3484 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.255, mb=0.472, no=1.004, corr=0.467) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 64.3484
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2820 mb_mean=0.4760 norm_overlap=1.0019 corr_cb=0.3001 topkJ=0.1938
[TRAIN][ep=008] loss=1.3352 acc=65.37%
[TRAIN][ep=008] mask_avg: mc_mean=0.2413 mb_mean=0.4721 norm_overlap=1.0033 corr_cb=0.3736
[EPOCH 008/089] train: loss=1.3352 acc=65.37% | val: loss=0.6589 acc=63.86% f1=65.91% auc=66.69% val_score=45.4438 val_score_bestthr=62.4905 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.241, mb=0.472, no=1.003, corr=0.374) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 62.4905
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2187 mb_mean=0.4697 norm_overlap=1.0051 corr_cb=0.4696 topkJ=0.1620
[TRAIN][ep=009] loss=1.3280 acc=66.44%
[TRAIN][ep=009] mask_avg: mc_mean=0.2318 mb_mean=0.4721 norm_overlap=1.0031 corr_cb=0.3205
[EPOCH 009/089] train: loss=1.3280 acc=66.44% | val: loss=0.6983 acc=61.45% f1=65.96% auc=61.69% val_score=54.9121 val_score_bestthr=60.3341 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.232, mb=0.472, no=1.003, corr=0.320) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 60.3341
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.2343 mb_mean=0.4726 norm_overlap=1.0041 corr_cb=0.3899 topkJ=0.1044
[TRAIN][ep=010] loss=1.3355 acc=64.16%
[TRAIN][ep=010] mask_avg: mc_mean=0.2251 mb_mean=0.4721 norm_overlap=1.0028 corr_cb=0.2637
[EPOCH 010/089] train: loss=1.3355 acc=64.16% | val: loss=0.6455 acc=56.63% f1=70.49% auc=70.64% val_score=51.8684 val_score_bestthr=63.9539 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.225, mb=0.472, no=1.003, corr=0.264) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 63.9539
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.2355 mb_mean=0.4757 norm_overlap=1.0018 corr_cb=0.2183 topkJ=0.0728
[TRAIN][ep=011] loss=1.1277 acc=65.37%
[TRAIN][ep=011] mask_avg: mc_mean=0.2071 mb_mean=0.4721 norm_overlap=1.0027 corr_cb=0.2166
[EPOCH 011/089] train: loss=1.1277 acc=65.37% | val: loss=0.6381 acc=63.86% f1=70.59% auc=69.77% val_score=57.0625 val_score_bestthr=59.4672 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.207, mb=0.472, no=1.003, corr=0.217) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 59.4672
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.2042 mb_mean=0.4710 norm_overlap=1.0038 corr_cb=0.2752 topkJ=0.1217
[TRAIN][ep=012] loss=0.9254 acc=68.86%
[TRAIN][ep=012] mask_avg: mc_mean=0.2037 mb_mean=0.4721 norm_overlap=1.0018 corr_cb=0.1260
[EPOCH 012/089] train: loss=0.9254 acc=68.86% | val: loss=0.6365 acc=61.45% f1=69.23% auc=69.13% val_score=55.1103 val_score_bestthr=56.6039 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.204, mb=0.472, no=1.002, corr=0.126) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 56.6039
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.2350 mb_mean=0.4762 norm_overlap=0.9999 corr_cb=-0.0079 topkJ=0.0606
[TRAIN][ep=013] loss=0.8910 acc=68.32%
[TRAIN][ep=013] mask_avg: mc_mean=0.2107 mb_mean=0.4721 norm_overlap=1.0005 corr_cb=0.0275
[EPOCH 013/089] train: loss=0.8910 acc=68.32% | val: loss=0.6304 acc=65.06% f1=70.71% auc=69.53% val_score=55.6749 val_score_bestthr=58.7200 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.211, mb=0.472, no=1.001, corr=0.028) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 58.7200
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.2203 mb_mean=0.4743 norm_overlap=1.0008 corr_cb=0.0503 topkJ=0.0778
[TRAIN][ep=014] loss=0.8664 acc=71.28%
[TRAIN][ep=014] mask_avg: mc_mean=0.1996 mb_mean=0.4721 norm_overlap=0.9998 corr_cb=-0.0174
[EPOCH 014/089] train: loss=0.8664 acc=71.28% | val: loss=0.6271 acc=59.04% f1=71.67% auc=70.00% val_score=55.6749 val_score_bestthr=63.6992 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.200, mb=0.472, no=1.000, corr=-0.017) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 63.6992
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1506 mb_mean=0.4689 norm_overlap=1.0013 corr_cb=0.0600 topkJ=0.0448
[TRAIN][ep=015] loss=0.8597 acc=71.01%
[TRAIN][ep=015] mask_avg: mc_mean=0.1733 mb_mean=0.4721 norm_overlap=0.9999 corr_cb=-0.0134
[EPOCH 015/089] train: loss=0.8597 acc=71.01% | val: loss=0.6617 acc=57.83% f1=71.07% auc=68.20% val_score=51.1388 val_score_bestthr=63.8258 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.173, mb=0.472, no=1.000, corr=-0.013) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 63.8258
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1872 mb_mean=0.4714 norm_overlap=1.0019 corr_cb=0.0983 topkJ=0.0484
[TRAIN][ep=016] loss=0.8541 acc=71.28%
[TRAIN][ep=016] mask_avg: mc_mean=0.1802 mb_mean=0.4721 norm_overlap=0.9991 corr_cb=-0.0467
[EPOCH 016/089] train: loss=0.8541 acc=71.28% | val: loss=0.6181 acc=65.06% f1=71.29% auc=70.35% val_score=53.9218 val_score_bestthr=58.8239 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.180, mb=0.472, no=0.999, corr=-0.047) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 58.8239
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1977 mb_mean=0.4756 norm_overlap=0.9979 corr_cb=-0.1119 topkJ=0.0329
[TRAIN][ep=017] loss=0.8411 acc=71.41%
[TRAIN][ep=017] mask_avg: mc_mean=0.1801 mb_mean=0.4721 norm_overlap=0.9985 corr_cb=-0.0673
[EPOCH 017/089] train: loss=0.8411 acc=71.41% | val: loss=0.6202 acc=66.27% f1=71.43% auc=70.87% val_score=39.2968 val_score_bestthr=59.8302 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.180, mb=0.472, no=0.999, corr=-0.067) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 59.8302
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.2119 mb_mean=0.4736 norm_overlap=0.9971 corr_cb=-0.1474 topkJ=0.0197
[TRAIN][ep=018] loss=0.8370 acc=72.75%
[TRAIN][ep=018] mask_avg: mc_mean=0.2120 mb_mean=0.4721 norm_overlap=0.9972 corr_cb=-0.1317
[EPOCH 018/089] train: loss=0.8370 acc=72.75% | val: loss=0.6182 acc=66.27% f1=71.43% auc=72.56% val_score=49.0581 val_score_bestthr=59.8302 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.212, mb=0.472, no=0.997, corr=-0.132) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 59.8302
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1687 mb_mean=0.4748 norm_overlap=0.9932 corr_cb=-0.3069 topkJ=0.0080
[TRAIN][ep=019] loss=0.8284 acc=73.96%
[TRAIN][ep=019] mask_avg: mc_mean=0.1909 mb_mean=0.4721 norm_overlap=0.9977 corr_cb=-0.1108
[EPOCH 019/089] train: loss=0.8284 acc=73.96% | val: loss=0.5970 acc=65.06% f1=68.82% auc=72.79% val_score=40.5170 val_score_bestthr=60.0963 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.191, mb=0.472, no=0.998, corr=-0.111) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 60.0963
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1055 mb_mean=0.4736 norm_overlap=1.0015 corr_cb=0.0401 topkJ=0.0342
[TRAIN][ep=020] loss=0.8284 acc=71.81%
[TRAIN][ep=020] mask_avg: mc_mean=0.1904 mb_mean=0.4721 norm_overlap=0.9974 corr_cb=-0.1166
[EPOCH 020/089] train: loss=0.8284 acc=71.81% | val: loss=0.6405 acc=66.27% f1=70.83% auc=70.81% val_score=56.2353 val_score_bestthr=60.9269 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.472, no=0.997, corr=-0.117) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 60.9269
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.1865 mb_mean=0.4700 norm_overlap=0.9969 corr_cb=-0.1314 topkJ=0.0358
[TRAIN][ep=021] loss=0.8306 acc=71.01%
[TRAIN][ep=021] mask_avg: mc_mean=0.2173 mb_mean=0.4721 norm_overlap=0.9967 corr_cb=-0.1454
[EPOCH 021/089] train: loss=0.8306 acc=71.01% | val: loss=0.6017 acc=67.47% f1=72.73% auc=73.72% val_score=50.1627 val_score_bestthr=62.7938 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.217, mb=0.472, no=0.997, corr=-0.145) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 62.7938
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1900 mb_mean=0.4722 norm_overlap=0.9980 corr_cb=-0.0740 topkJ=0.0355
[TRAIN][ep=022] loss=0.8106 acc=74.23%
[TRAIN][ep=022] mask_avg: mc_mean=0.1983 mb_mean=0.4721 norm_overlap=0.9972 corr_cb=-0.1211
[EPOCH 022/089] train: loss=0.8106 acc=74.23% | val: loss=0.6132 acc=66.27% f1=72.00% auc=71.92% val_score=52.9009 val_score_bestthr=61.6828 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.198, mb=0.472, no=0.997, corr=-0.121) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 61.6828
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1910 mb_mean=0.4728 norm_overlap=0.9965 corr_cb=-0.1374 topkJ=0.0380
[TRAIN][ep=023] loss=0.8054 acc=72.35%
[TRAIN][ep=023] mask_avg: mc_mean=0.2020 mb_mean=0.4721 norm_overlap=0.9967 corr_cb=-0.1307
[EPOCH 023/089] train: loss=0.8054 acc=72.35% | val: loss=0.5961 acc=67.47% f1=72.73% auc=75.06% val_score=55.7489 val_score_bestthr=63.3131 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.202, mb=0.472, no=0.997, corr=-0.131) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 63.3131
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2299 mb_mean=0.4734 norm_overlap=0.9983 corr_cb=-0.0688 topkJ=0.0441
[TRAIN][ep=024] loss=0.7943 acc=75.03%
[TRAIN][ep=024] mask_avg: mc_mean=0.2085 mb_mean=0.4721 norm_overlap=0.9960 corr_cb=-0.1579
[EPOCH 024/089] train: loss=0.7943 acc=75.03% | val: loss=0.6096 acc=67.47% f1=72.73% auc=72.91% val_score=50.5935 val_score_bestthr=62.7938 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.208, mb=0.472, no=0.996, corr=-0.158) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 62.7938
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1818 mb_mean=0.4715 norm_overlap=0.9997 corr_cb=-0.0078 topkJ=0.0386
[TRAIN][ep=025] loss=0.7844 acc=75.70%
[TRAIN][ep=025] mask_avg: mc_mean=0.2040 mb_mean=0.4721 norm_overlap=0.9963 corr_cb=-0.1402
[EPOCH 025/089] train: loss=0.7844 acc=75.70% | val: loss=0.5949 acc=66.27% f1=72.55% auc=74.01% val_score=55.5456 val_score_bestthr=63.5006 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.204, mb=0.472, no=0.996, corr=-0.140) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 63.5006
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1437 mb_mean=0.4765 norm_overlap=0.9969 corr_cb=-0.1162 topkJ=0.0449
[TRAIN][ep=026] loss=0.7803 acc=75.97%
[TRAIN][ep=026] mask_avg: mc_mean=0.1662 mb_mean=0.4721 norm_overlap=0.9975 corr_cb=-0.0935
[EPOCH 026/089] train: loss=0.7803 acc=75.97% | val: loss=0.5922 acc=57.83% f1=71.07% auc=73.84% val_score=44.1270 val_score_bestthr=63.8258 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.166, mb=0.472, no=0.997, corr=-0.093) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 63.8258
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.3208 mb_mean=0.4714 norm_overlap=0.9929 corr_cb=-0.3494 topkJ=0.0173
[TRAIN][ep=027] loss=0.7888 acc=74.77%
[TRAIN][ep=027] mask_avg: mc_mean=0.2086 mb_mean=0.4721 norm_overlap=0.9963 corr_cb=-0.1438
[EPOCH 027/089] train: loss=0.7888 acc=74.77% | val: loss=0.6186 acc=66.27% f1=72.00% auc=73.66% val_score=57.8015 val_score_bestthr=61.6828 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.209, mb=0.472, no=0.996, corr=-0.144) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 61.6828
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1691 mb_mean=0.4701 norm_overlap=0.9970 corr_cb=-0.0820 topkJ=0.0253
[TRAIN][ep=028] loss=0.7679 acc=75.30%
[TRAIN][ep=028] mask_avg: mc_mean=0.2058 mb_mean=0.4721 norm_overlap=0.9962 corr_cb=-0.1424
[EPOCH 028/089] train: loss=0.7679 acc=75.30% | val: loss=0.6408 acc=63.86% f1=71.15% auc=73.37% val_score=58.5426 val_score_bestthr=61.9239 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.206, mb=0.472, no=0.996, corr=-0.142) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 61.9239
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2113 mb_mean=0.4737 norm_overlap=0.9972 corr_cb=-0.1340 topkJ=0.0408
[TRAIN][ep=029] loss=0.7763 acc=74.77%
[TRAIN][ep=029] mask_avg: mc_mean=0.2122 mb_mean=0.4721 norm_overlap=0.9964 corr_cb=-0.1431
[EPOCH 029/089] train: loss=0.7763 acc=74.77% | val: loss=0.5833 acc=67.47% f1=72.73% auc=75.58% val_score=53.5782 val_score_bestthr=64.5305 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.212, mb=0.472, no=0.996, corr=-0.143) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 64.3671 -> 64.5305
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2165 mb_mean=0.4712 norm_overlap=0.9948 corr_cb=-0.1802 topkJ=0.0564
[TRAIN][ep=030] loss=0.8260 acc=76.24%
[TRAIN][ep=030] mask_avg: mc_mean=0.2049 mb_mean=0.4721 norm_overlap=0.9960 corr_cb=-0.1459
[EPOCH 030/089] train: loss=0.8260 acc=76.24% | val: loss=0.6139 acc=65.06% f1=71.84% auc=74.77% val_score=56.4907 val_score_bestthr=63.1539 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.205, mb=0.472, no=0.996, corr=-0.146) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.5305 -> 63.1539
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2044 mb_mean=0.4716 norm_overlap=0.9952 corr_cb=-0.1781 topkJ=0.0407
[TRAIN][ep=031] loss=0.8862 acc=77.45%
[TRAIN][ep=031] mask_avg: mc_mean=0.1896 mb_mean=0.4721 norm_overlap=0.9964 corr_cb=-0.1248
[EPOCH 031/089] train: loss=0.8862 acc=77.45% | val: loss=0.5901 acc=63.86% f1=72.73% auc=74.59% val_score=54.7092 val_score_bestthr=61.5939 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.190, mb=0.472, no=0.996, corr=-0.125) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.5305 -> 61.5939
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2219 mb_mean=0.4736 norm_overlap=0.9967 corr_cb=-0.1356 topkJ=0.0356
[TRAIN][ep=032] loss=0.9567 acc=75.70%
[TRAIN][ep=032] mask_avg: mc_mean=0.2103 mb_mean=0.4721 norm_overlap=0.9959 corr_cb=-0.1543
[EPOCH 032/089] train: loss=0.9567 acc=75.70% | val: loss=0.5967 acc=66.27% f1=72.00% auc=74.88% val_score=55.1934 val_score_bestthr=65.1695 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.210, mb=0.472, no=0.996, corr=-0.154) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 64.5305 -> 65.1695
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1399 mb_mean=0.4719 norm_overlap=0.9955 corr_cb=-0.1212 topkJ=0.0348
[TRAIN][ep=033] loss=1.0258 acc=75.57%
[TRAIN][ep=033] mask_avg: mc_mean=0.1938 mb_mean=0.4721 norm_overlap=0.9963 corr_cb=-0.1313
[EPOCH 033/089] train: loss=1.0258 acc=75.57% | val: loss=0.5858 acc=65.06% f1=72.38% auc=75.17% val_score=43.0532 val_score_bestthr=63.0938 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.194, mb=0.472, no=0.996, corr=-0.131) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1695 -> 63.0938
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1897 mb_mean=0.4724 norm_overlap=1.0008 corr_cb=0.0252 topkJ=0.1314
[TRAIN][ep=034] loss=1.0684 acc=78.52%
[TRAIN][ep=034] mask_avg: mc_mean=0.1911 mb_mean=0.4721 norm_overlap=0.9967 corr_cb=-0.1146
[EPOCH 034/089] train: loss=1.0684 acc=78.52% | val: loss=0.5875 acc=63.86% f1=72.22% auc=75.52% val_score=54.4975 val_score_bestthr=61.9263 | dyn(w_pfs=0.240, w_sup=0.240, w_csuf=0.200, stage2=False) | mask(mc=0.191, mb=0.472, no=0.997, corr=-0.115) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1695 -> 61.9263
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2459 mb_mean=0.4717 norm_overlap=1.0015 corr_cb=0.0490 topkJ=0.0545
[TRAIN][ep=035] loss=1.0746 acc=78.93%
[TRAIN][ep=035] mask_avg: mc_mean=0.2303 mb_mean=0.4721 norm_overlap=0.9955 corr_cb=-0.1691
[EPOCH 035/089] train: loss=1.0746 acc=78.93% | val: loss=0.6117 acc=66.27% f1=73.58% auc=75.58% val_score=59.7112 val_score_bestthr=64.1346 | dyn(w_pfs=0.280, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.230, mb=0.472, no=0.996, corr=-0.169) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1695 -> 64.1346
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.1984 mb_mean=0.4719 norm_overlap=0.9965 corr_cb=-0.1019 topkJ=0.0379
[TRAIN][ep=036] loss=1.0989 acc=77.45%
[TRAIN][ep=036] mask_avg: mc_mean=0.2068 mb_mean=0.4721 norm_overlap=0.9967 corr_cb=-0.1182
[EPOCH 036/089] train: loss=1.0989 acc=77.45% | val: loss=0.6040 acc=68.67% f1=72.92% auc=77.56% val_score=61.1965 val_score_bestthr=63.4236 | dyn(w_pfs=0.320, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.207, mb=0.472, no=0.997, corr=-0.118) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1695 -> 63.4236
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1901 mb_mean=0.4646 norm_overlap=0.9949 corr_cb=-0.1621 topkJ=0.0549
[TRAIN][ep=037] loss=1.0842 acc=78.66%
[TRAIN][ep=037] mask_avg: mc_mean=0.2003 mb_mean=0.4721 norm_overlap=0.9965 corr_cb=-0.1263
[EPOCH 037/089] train: loss=1.0842 acc=78.66% | val: loss=0.5940 acc=67.47% f1=75.23% auc=76.28% val_score=57.4262 val_score_bestthr=69.5180 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.200, mb=0.472, no=0.996, corr=-0.126) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 65.1695 -> 69.5180
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2216 mb_mean=0.4726 norm_overlap=0.9957 corr_cb=-0.1404 topkJ=0.0419
[TRAIN][ep=038] loss=1.0637 acc=79.87%
[TRAIN][ep=038] mask_avg: mc_mean=0.2132 mb_mean=0.4721 norm_overlap=0.9957 corr_cb=-0.1534
[EPOCH 038/089] train: loss=1.0637 acc=79.87% | val: loss=0.5939 acc=67.47% f1=75.23% auc=76.10% val_score=51.7490 val_score_bestthr=69.5180 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.213, mb=0.472, no=0.996, corr=-0.153) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.5180 -> 69.5180
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.1975 mb_mean=0.4731 norm_overlap=0.9931 corr_cb=-0.2382 topkJ=0.0288
[TRAIN][ep=039] loss=1.0584 acc=80.54%
[TRAIN][ep=039] mask_avg: mc_mean=0.2341 mb_mean=0.4721 norm_overlap=0.9953 corr_cb=-0.1773
[EPOCH 039/089] train: loss=1.0584 acc=80.54% | val: loss=0.6166 acc=63.86% f1=71.70% auc=75.64% val_score=54.7239 val_score_bestthr=64.4243 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.234, mb=0.472, no=0.995, corr=-0.177) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.5180 -> 64.4243
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.2400 mb_mean=0.4759 norm_overlap=0.9926 corr_cb=-0.2986 topkJ=0.0179
[TRAIN][ep=040] loss=1.0459 acc=81.34%
[TRAIN][ep=040] mask_avg: mc_mean=0.2053 mb_mean=0.4721 norm_overlap=0.9957 corr_cb=-0.1493
[EPOCH 040/089] train: loss=1.0459 acc=81.34% | val: loss=0.6148 acc=66.27% f1=74.55% auc=75.93% val_score=53.1811 val_score_bestthr=68.7758 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.205, mb=0.472, no=0.996, corr=-0.149) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.5180 -> 68.7758
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.2577 mb_mean=0.4749 norm_overlap=0.9955 corr_cb=-0.1823 topkJ=0.0381
[TRAIN][ep=041] loss=1.0539 acc=80.13%
[TRAIN][ep=041] mask_avg: mc_mean=0.2295 mb_mean=0.4721 norm_overlap=0.9950 corr_cb=-0.1859
[EPOCH 041/089] train: loss=1.0539 acc=80.13% | val: loss=0.6366 acc=67.47% f1=75.68% auc=74.42% val_score=54.8852 val_score_bestthr=70.3941 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.230, mb=0.472, no=0.995, corr=-0.186) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 69.5180 -> 70.3941
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.2318 mb_mean=0.4719 norm_overlap=0.9962 corr_cb=-0.1654 topkJ=0.0318
[TRAIN][ep=042] loss=1.0403 acc=82.15%
[TRAIN][ep=042] mask_avg: mc_mean=0.2021 mb_mean=0.4721 norm_overlap=0.9963 corr_cb=-0.1285
[EPOCH 042/089] train: loss=1.0403 acc=82.15% | val: loss=0.6709 acc=66.27% f1=75.00% auc=74.71% val_score=57.8015 val_score_bestthr=70.5083 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.202, mb=0.472, no=0.996, corr=-0.128) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 70.3941 -> 70.5083
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.1918 mb_mean=0.4726 norm_overlap=0.9935 corr_cb=-0.1974 topkJ=0.0336
[TRAIN][ep=043] loss=1.0124 acc=83.22%
[TRAIN][ep=043] mask_avg: mc_mean=0.2389 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1880
[EPOCH 043/089] train: loss=1.0124 acc=83.22% | val: loss=0.6116 acc=67.47% f1=73.79% auc=76.98% val_score=47.5061 val_score_bestthr=66.9679 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.239, mb=0.472, no=0.995, corr=-0.188) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5083 -> 66.9679
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2491 mb_mean=0.4690 norm_overlap=0.9943 corr_cb=-0.2174 topkJ=0.0282
[TRAIN][ep=044] loss=1.0263 acc=80.94%
[TRAIN][ep=044] mask_avg: mc_mean=0.2467 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1959
[EPOCH 044/089] train: loss=1.0263 acc=80.94% | val: loss=0.6497 acc=67.47% f1=74.77% auc=76.80% val_score=58.8690 val_score_bestthr=66.9240 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.247, mb=0.472, no=0.995, corr=-0.196) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5083 -> 66.9240
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2157 mb_mean=0.4723 norm_overlap=0.9964 corr_cb=-0.1312 topkJ=0.0600
[TRAIN][ep=045] loss=1.0070 acc=82.82%
[TRAIN][ep=045] mask_avg: mc_mean=0.2307 mb_mean=0.4721 norm_overlap=0.9954 corr_cb=-0.1683
[EPOCH 045/089] train: loss=1.0070 acc=82.82% | val: loss=0.7236 acc=65.06% f1=73.87% auc=73.37% val_score=53.5260 val_score_bestthr=68.8906 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.231, mb=0.472, no=0.995, corr=-0.168) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5083 -> 68.8906
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.2303 mb_mean=0.4729 norm_overlap=0.9935 corr_cb=-0.2432 topkJ=0.0161
[TRAIN][ep=046] loss=0.9920 acc=83.89%
[TRAIN][ep=046] mask_avg: mc_mean=0.2473 mb_mean=0.4721 norm_overlap=0.9955 corr_cb=-0.1734
[EPOCH 046/089] train: loss=0.9920 acc=83.89% | val: loss=0.6511 acc=66.27% f1=74.55% auc=75.17% val_score=48.7060 val_score_bestthr=70.2831 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.247, mb=0.472, no=0.996, corr=-0.173) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5083 -> 70.2831
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.2082 mb_mean=0.4700 norm_overlap=0.9956 corr_cb=-0.1617 topkJ=0.0427
[TRAIN][ep=047] loss=0.9858 acc=82.68%
[TRAIN][ep=047] mask_avg: mc_mean=0.2323 mb_mean=0.4721 norm_overlap=0.9952 corr_cb=-0.1714
[EPOCH 047/089] train: loss=0.9858 acc=82.68% | val: loss=0.6626 acc=67.47% f1=74.29% auc=75.81% val_score=57.4879 val_score_bestthr=69.4284 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.232, mb=0.472, no=0.995, corr=-0.171) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5083 -> 69.4284
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.3153 mb_mean=0.4695 norm_overlap=0.9915 corr_cb=-0.3880 topkJ=0.0099
[TRAIN][ep=048] loss=0.8258 acc=83.22%
[TRAIN][ep=048] mask_avg: mc_mean=0.2610 mb_mean=0.4721 norm_overlap=0.9946 corr_cb=-0.2075
[EPOCH 048/089] train: loss=0.8258 acc=83.22% | val: loss=0.6361 acc=68.67% f1=75.00% auc=75.81% val_score=53.9142 val_score_bestthr=70.5375 | dyn(w_pfs=0.290, w_sup=0.190, w_csuf=0.140, stage2=False) | mask(mc=0.261, mb=0.472, no=0.995, corr=-0.208) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 70.5083 -> 70.5375
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=049] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.2639 mb_mean=0.4735 norm_overlap=0.9956 corr_cb=-0.1807 topkJ=0.0226
[TRAIN][ep=049] loss=0.8650 acc=85.10%
[TRAIN][ep=049] mask_avg: mc_mean=0.2361 mb_mean=0.4721 norm_overlap=0.9954 corr_cb=-0.1661
[EPOCH 049/089] train: loss=0.8650 acc=85.10% | val: loss=0.6381 acc=68.67% f1=75.00% auc=76.16% val_score=52.9156 val_score_bestthr=70.5375 | dyn(w_pfs=0.330, w_sup=0.230, w_csuf=0.180, stage2=False) | mask(mc=0.236, mb=0.472, no=0.995, corr=-0.166) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5375 -> 70.5375
[DBG][ep=050] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.2474 mb_mean=0.4713 norm_overlap=0.9908 corr_cb=-0.3381 topkJ=0.0098
[TRAIN][ep=050] loss=0.6400 acc=85.50%
[TRAIN][ep=050] mask_avg: mc_mean=0.2368 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1874
[EPOCH 050/089] train: loss=0.6400 acc=85.50% | val: loss=0.6460 acc=68.67% f1=75.00% auc=76.10% val_score=49.4654 val_score_bestthr=70.5375 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.187) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5375 -> 70.5375
[DBG][ep=051] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.2399 mb_mean=0.4781 norm_overlap=0.9935 corr_cb=-0.2437 topkJ=0.0194
[TRAIN][ep=051] loss=0.5722 acc=86.04%
[TRAIN][ep=051] mask_avg: mc_mean=0.2367 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1854
[EPOCH 051/089] train: loss=0.5722 acc=86.04% | val: loss=0.6673 acc=68.67% f1=75.00% auc=76.10% val_score=52.0125 val_score_bestthr=70.5375 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.185) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5375 -> 70.5375
[DBG][ep=052] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.2467 mb_mean=0.4697 norm_overlap=0.9951 corr_cb=-0.1691 topkJ=0.0402
[TRAIN][ep=052] loss=0.5712 acc=85.64%
[TRAIN][ep=052] mask_avg: mc_mean=0.2368 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1812
[EPOCH 052/089] train: loss=0.5712 acc=85.64% | val: loss=0.6579 acc=66.27% f1=74.55% auc=75.99% val_score=49.2625 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.181) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5375 -> 70.2831
[DBG][ep=053] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.2013 mb_mean=0.4687 norm_overlap=0.9949 corr_cb=-0.1948 topkJ=0.0308
[TRAIN][ep=053] loss=0.5697 acc=86.58%
[TRAIN][ep=053] mask_avg: mc_mean=0.2368 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1856
[EPOCH 053/089] train: loss=0.5697 acc=86.58% | val: loss=0.6715 acc=66.27% f1=74.55% auc=75.81% val_score=49.2625 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.186) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5375 -> 70.2831
[DBG][ep=054] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=054] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=054] mask(step0): mc_mean=0.2349 mb_mean=0.4716 norm_overlap=0.9989 corr_cb=-0.0413 topkJ=0.0529
[TRAIN][ep=054] loss=0.5681 acc=87.38%
[TRAIN][ep=054] mask_avg: mc_mean=0.2368 mb_mean=0.4721 norm_overlap=0.9950 corr_cb=-0.1820
[EPOCH 054/089] train: loss=0.5681 acc=87.38% | val: loss=0.6747 acc=66.27% f1=74.55% auc=75.58% val_score=49.2625 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.182) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5375 -> 70.2831
[DBG][ep=055] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=055] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=055] mask(step0): mc_mean=0.2317 mb_mean=0.4709 norm_overlap=0.9961 corr_cb=-0.1533 topkJ=0.0313
[TRAIN][ep=055] loss=0.5655 acc=86.04%
[TRAIN][ep=055] mask_avg: mc_mean=0.2367 mb_mean=0.4721 norm_overlap=0.9950 corr_cb=-0.1805
[EPOCH 055/089] train: loss=0.5655 acc=86.04% | val: loss=0.6776 acc=66.27% f1=74.55% auc=75.41% val_score=49.2625 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.181) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5375 -> 70.2831
[DBG][ep=056] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=056] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=056] mask(step0): mc_mean=0.2633 mb_mean=0.4722 norm_overlap=0.9935 corr_cb=-0.2286 topkJ=0.0344
[TRAIN][ep=056] loss=0.5629 acc=86.17%
[TRAIN][ep=056] mask_avg: mc_mean=0.2367 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1816
[EPOCH 056/089] train: loss=0.5629 acc=86.17% | val: loss=0.6678 acc=66.27% f1=75.00% auc=75.52% val_score=48.4200 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.182) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 70.5375 -> 70.7981
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=057] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=057] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=057] mask(step0): mc_mean=0.2361 mb_mean=0.4721 norm_overlap=0.9964 corr_cb=-0.1400 topkJ=0.0575
[TRAIN][ep=057] loss=0.5646 acc=85.91%
[TRAIN][ep=057] mask_avg: mc_mean=0.2368 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1847
[EPOCH 057/089] train: loss=0.5646 acc=85.91% | val: loss=0.6794 acc=66.27% f1=74.55% auc=75.81% val_score=49.2625 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.185) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.2831
[DBG][ep=058] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=058] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=058] mask(step0): mc_mean=0.3068 mb_mean=0.4710 norm_overlap=0.9937 corr_cb=-0.2535 topkJ=0.0266
[TRAIN][ep=058] loss=0.5585 acc=87.11%
[TRAIN][ep=058] mask_avg: mc_mean=0.2368 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1846
[EPOCH 058/089] train: loss=0.5585 acc=87.11% | val: loss=0.6850 acc=66.27% f1=75.00% auc=75.70% val_score=49.2625 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.185) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.7981
[DBG][ep=059] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=059] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=059] mask(step0): mc_mean=0.2394 mb_mean=0.4713 norm_overlap=0.9930 corr_cb=-0.2226 topkJ=0.0288
[TRAIN][ep=059] loss=0.5576 acc=86.71%
[TRAIN][ep=059] mask_avg: mc_mean=0.2368 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1844
[EPOCH 059/089] train: loss=0.5576 acc=86.71% | val: loss=0.7007 acc=66.27% f1=74.55% auc=75.35% val_score=44.5298 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.184) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.2831
[DBG][ep=060] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=060] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=060] mask(step0): mc_mean=0.2780 mb_mean=0.4667 norm_overlap=0.9903 corr_cb=-0.2894 topkJ=0.0204
[TRAIN][ep=060] loss=0.5544 acc=86.58%
[TRAIN][ep=060] mask_avg: mc_mean=0.2368 mb_mean=0.4721 norm_overlap=0.9950 corr_cb=-0.1806
[EPOCH 060/089] train: loss=0.5544 acc=86.58% | val: loss=0.6771 acc=66.27% f1=75.00% auc=75.87% val_score=53.9142 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.181) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.7981
[DBG][ep=061] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=061] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=061] mask(step0): mc_mean=0.2069 mb_mean=0.4745 norm_overlap=0.9959 corr_cb=-0.1568 topkJ=0.0415
[TRAIN][ep=061] loss=0.5533 acc=87.11%
[TRAIN][ep=061] mask_avg: mc_mean=0.2367 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1815
[EPOCH 061/089] train: loss=0.5533 acc=87.11% | val: loss=0.7278 acc=66.27% f1=74.55% auc=75.06% val_score=50.3643 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.181) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.2831
[DBG][ep=062] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=062] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=062] mask(step0): mc_mean=0.2439 mb_mean=0.4636 norm_overlap=0.9948 corr_cb=-0.1936 topkJ=0.0514
[TRAIN][ep=062] loss=0.5580 acc=87.65%
[TRAIN][ep=062] mask_avg: mc_mean=0.2367 mb_mean=0.4721 norm_overlap=0.9950 corr_cb=-0.1798
[EPOCH 062/089] train: loss=0.5580 acc=87.65% | val: loss=0.7095 acc=66.27% f1=74.55% auc=75.23% val_score=44.5298 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.180) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.2831
[DBG][ep=063] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=063] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=063] mask(step0): mc_mean=0.2439 mb_mean=0.4693 norm_overlap=0.9970 corr_cb=-0.1199 topkJ=0.0639
[TRAIN][ep=063] loss=0.5516 acc=87.25%
[TRAIN][ep=063] mask_avg: mc_mean=0.2367 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1826
[EPOCH 063/089] train: loss=0.5516 acc=87.25% | val: loss=0.7190 acc=66.27% f1=74.55% auc=75.29% val_score=44.5298 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.183) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.2831
[DBG][ep=064] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=064] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=064] mask(step0): mc_mean=0.2427 mb_mean=0.4747 norm_overlap=0.9957 corr_cb=-0.1826 topkJ=0.0368
[TRAIN][ep=064] loss=0.5596 acc=85.64%
[TRAIN][ep=064] mask_avg: mc_mean=0.2368 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1849
[EPOCH 064/089] train: loss=0.5596 acc=85.64% | val: loss=0.6881 acc=66.27% f1=75.00% auc=75.52% val_score=53.9142 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.185) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.7981
[DBG][ep=065] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=065] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=065] mask(step0): mc_mean=0.2553 mb_mean=0.4721 norm_overlap=0.9929 corr_cb=-0.2620 topkJ=0.0180
[TRAIN][ep=065] loss=0.5522 acc=87.11%
[TRAIN][ep=065] mask_avg: mc_mean=0.2368 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1818
[EPOCH 065/089] train: loss=0.5522 acc=87.11% | val: loss=0.6976 acc=66.27% f1=75.00% auc=75.64% val_score=50.1335 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.182) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.7981
[DBG][ep=066] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=066] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=066] mask(step0): mc_mean=0.2132 mb_mean=0.4743 norm_overlap=0.9949 corr_cb=-0.1759 topkJ=0.0398
[TRAIN][ep=066] loss=0.5522 acc=86.85%
[TRAIN][ep=066] mask_avg: mc_mean=0.2368 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1823
[EPOCH 066/089] train: loss=0.5522 acc=86.85% | val: loss=0.7159 acc=66.27% f1=74.55% auc=75.35% val_score=44.5298 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.182) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.2831
[DBG][ep=067] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=067] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=067] mask(step0): mc_mean=0.2352 mb_mean=0.4704 norm_overlap=0.9939 corr_cb=-0.2394 topkJ=0.0268
[TRAIN][ep=067] loss=0.5450 acc=87.25%
[TRAIN][ep=067] mask_avg: mc_mean=0.2368 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1816
[EPOCH 067/089] train: loss=0.5450 acc=87.25% | val: loss=0.7022 acc=66.27% f1=75.00% auc=75.29% val_score=48.6024 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.182) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.7981
[DBG][ep=068] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=068] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=068] mask(step0): mc_mean=0.2163 mb_mean=0.4743 norm_overlap=0.9954 corr_cb=-0.1740 topkJ=0.0264
[TRAIN][ep=068] loss=0.5472 acc=87.11%
[TRAIN][ep=068] mask_avg: mc_mean=0.2368 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1818
[EPOCH 068/089] train: loss=0.5472 acc=87.11% | val: loss=0.7105 acc=66.27% f1=75.00% auc=75.47% val_score=49.2625 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.182) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.7981
[DBG][ep=069] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=069] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=069] mask(step0): mc_mean=0.2395 mb_mean=0.4699 norm_overlap=0.9913 corr_cb=-0.3243 topkJ=0.0229
[TRAIN][ep=069] loss=0.5423 acc=87.38%
[TRAIN][ep=069] mask_avg: mc_mean=0.2368 mb_mean=0.4721 norm_overlap=0.9950 corr_cb=-0.1812
[EPOCH 069/089] train: loss=0.5423 acc=87.38% | val: loss=0.7043 acc=66.27% f1=75.00% auc=75.47% val_score=48.6024 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.181) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.7981
[DBG][ep=070] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=070] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=070] mask(step0): mc_mean=0.2369 mb_mean=0.4706 norm_overlap=0.9926 corr_cb=-0.2388 topkJ=0.0305
[TRAIN][ep=070] loss=0.5421 acc=87.65%
[TRAIN][ep=070] mask_avg: mc_mean=0.2368 mb_mean=0.4721 norm_overlap=0.9950 corr_cb=-0.1793
[EPOCH 070/089] train: loss=0.5421 acc=87.65% | val: loss=0.7060 acc=66.27% f1=75.00% auc=75.47% val_score=48.6024 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.179) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.7981
[DBG][ep=071] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=071] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=071] mask(step0): mc_mean=0.2393 mb_mean=0.4724 norm_overlap=0.9917 corr_cb=-0.3153 topkJ=0.0226
[TRAIN][ep=071] loss=0.5443 acc=87.25%
[TRAIN][ep=071] mask_avg: mc_mean=0.2367 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1824
[EPOCH 071/089] train: loss=0.5443 acc=87.25% | val: loss=0.7758 acc=66.27% f1=74.55% auc=75.00% val_score=51.9109 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.182) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.2831
[DBG][ep=072] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=072] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=072] mask(step0): mc_mean=0.2731 mb_mean=0.4695 norm_overlap=0.9907 corr_cb=-0.3528 topkJ=0.0223
[TRAIN][ep=072] loss=0.5414 acc=87.38%
[TRAIN][ep=072] mask_avg: mc_mean=0.2368 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1814
[EPOCH 072/089] train: loss=0.5414 acc=87.38% | val: loss=0.7299 acc=66.27% f1=75.00% auc=75.35% val_score=46.6347 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.181) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.7981
[DBG][ep=073] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=073] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=073] mask(step0): mc_mean=0.2083 mb_mean=0.4733 norm_overlap=0.9938 corr_cb=-0.1846 topkJ=0.0414
[TRAIN][ep=073] loss=0.5404 acc=87.38%
[TRAIN][ep=073] mask_avg: mc_mean=0.2368 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1812
[EPOCH 073/089] train: loss=0.5404 acc=87.38% | val: loss=0.7282 acc=66.27% f1=75.00% auc=75.35% val_score=46.6347 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.181) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.7981
[DBG][ep=074] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=074] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=074] mask(step0): mc_mean=0.2449 mb_mean=0.4701 norm_overlap=0.9941 corr_cb=-0.1961 topkJ=0.0343
[TRAIN][ep=074] loss=0.5363 acc=87.11%
[TRAIN][ep=074] mask_avg: mc_mean=0.2367 mb_mean=0.4721 norm_overlap=0.9951 corr_cb=-0.1793
[EPOCH 074/089] train: loss=0.5363 acc=87.11% | val: loss=0.7131 acc=66.27% f1=75.00% auc=75.58% val_score=53.9142 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.179) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.7981
[DBG][ep=075] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=075] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=075] mask(step0): mc_mean=0.2436 mb_mean=0.4685 norm_overlap=0.9932 corr_cb=-0.2602 topkJ=0.0322
[TRAIN][ep=075] loss=0.5370 acc=87.65%
[TRAIN][ep=075] mask_avg: mc_mean=0.2368 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1833
[EPOCH 075/089] train: loss=0.5370 acc=87.65% | val: loss=0.7629 acc=66.27% f1=74.55% auc=75.06% val_score=44.5298 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.183) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.2831
[DBG][ep=076] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=076] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=076] mask(step0): mc_mean=0.2189 mb_mean=0.4755 norm_overlap=0.9958 corr_cb=-0.1466 topkJ=0.0397
[TRAIN][ep=076] loss=0.5371 acc=87.52%
[TRAIN][ep=076] mask_avg: mc_mean=0.2367 mb_mean=0.4721 norm_overlap=0.9950 corr_cb=-0.1816
[EPOCH 076/089] train: loss=0.5371 acc=87.52% | val: loss=0.7374 acc=66.27% f1=75.00% auc=75.35% val_score=46.6347 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.182) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.7981
[DBG][ep=077] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=077] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=077] mask(step0): mc_mean=0.2549 mb_mean=0.4711 norm_overlap=0.9918 corr_cb=-0.2935 topkJ=0.0191
[TRAIN][ep=077] loss=0.5293 acc=88.59%
[TRAIN][ep=077] mask_avg: mc_mean=0.2368 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1838
[EPOCH 077/089] train: loss=0.5293 acc=88.59% | val: loss=0.7211 acc=66.27% f1=75.00% auc=75.47% val_score=53.9142 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.184) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.7981
[DBG][ep=078] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=078] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=078] mask(step0): mc_mean=0.2062 mb_mean=0.4669 norm_overlap=0.9955 corr_cb=-0.1888 topkJ=0.0574
[TRAIN][ep=078] loss=0.5350 acc=87.65%
[TRAIN][ep=078] mask_avg: mc_mean=0.2368 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1844
[EPOCH 078/089] train: loss=0.5350 acc=87.65% | val: loss=0.7309 acc=66.27% f1=75.00% auc=75.41% val_score=48.6024 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.184) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.7981
[DBG][ep=079] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=079] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=079] mask(step0): mc_mean=0.2720 mb_mean=0.4680 norm_overlap=0.9939 corr_cb=-0.2063 topkJ=0.0242
[TRAIN][ep=079] loss=0.5295 acc=88.72%
[TRAIN][ep=079] mask_avg: mc_mean=0.2368 mb_mean=0.4721 norm_overlap=0.9950 corr_cb=-0.1786
[EPOCH 079/089] train: loss=0.5295 acc=88.72% | val: loss=0.7305 acc=66.27% f1=75.00% auc=75.47% val_score=49.4654 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.179) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.7981
[DBG][ep=080] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=080] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=080] mask(step0): mc_mean=0.2547 mb_mean=0.4747 norm_overlap=0.9935 corr_cb=-0.2434 topkJ=0.0168
[TRAIN][ep=080] loss=0.5309 acc=87.65%
[TRAIN][ep=080] mask_avg: mc_mean=0.2367 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1820
[EPOCH 080/089] train: loss=0.5309 acc=87.65% | val: loss=0.7352 acc=66.27% f1=75.00% auc=74.94% val_score=48.6024 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.182) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.7981
[DBG][ep=081] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=081] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=081] mask(step0): mc_mean=0.2302 mb_mean=0.4695 norm_overlap=0.9926 corr_cb=-0.2407 topkJ=0.0226
[TRAIN][ep=081] loss=0.5348 acc=87.92%
[TRAIN][ep=081] mask_avg: mc_mean=0.2368 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1848
[EPOCH 081/089] train: loss=0.5348 acc=87.92% | val: loss=0.7329 acc=66.27% f1=75.00% auc=75.70% val_score=61.2412 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.185) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.7981
[DBG][ep=082] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=082] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=082] mask(step0): mc_mean=0.2414 mb_mean=0.4682 norm_overlap=0.9952 corr_cb=-0.2023 topkJ=0.0483
[TRAIN][ep=082] loss=0.5375 acc=85.91%
[TRAIN][ep=082] mask_avg: mc_mean=0.2368 mb_mean=0.4721 norm_overlap=0.9950 corr_cb=-0.1815
[EPOCH 082/089] train: loss=0.5375 acc=85.91% | val: loss=0.7426 acc=66.27% f1=75.00% auc=75.06% val_score=48.6024 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.181) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.7981
[DBG][ep=083] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=083] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=083] mask(step0): mc_mean=0.2011 mb_mean=0.4737 norm_overlap=0.9946 corr_cb=-0.1987 topkJ=0.0239
[TRAIN][ep=083] loss=0.5277 acc=88.59%
[TRAIN][ep=083] mask_avg: mc_mean=0.2368 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1837
[EPOCH 083/089] train: loss=0.5277 acc=88.59% | val: loss=0.7638 acc=66.27% f1=75.00% auc=75.17% val_score=49.3828 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.184) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.7981
[DBG][ep=084] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=084] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=084] mask(step0): mc_mean=0.2471 mb_mean=0.4698 norm_overlap=0.9941 corr_cb=-0.2301 topkJ=0.0308
[TRAIN][ep=084] loss=0.5258 acc=88.72%
[TRAIN][ep=084] mask_avg: mc_mean=0.2368 mb_mean=0.4721 norm_overlap=0.9950 corr_cb=-0.1799
[EPOCH 084/089] train: loss=0.5258 acc=88.72% | val: loss=0.7532 acc=66.27% f1=75.00% auc=75.12% val_score=46.6347 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.180) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.7981
[DBG][ep=085] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=085] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=085] mask(step0): mc_mean=0.2287 mb_mean=0.4751 norm_overlap=0.9981 corr_cb=-0.0795 topkJ=0.0460
[TRAIN][ep=085] loss=0.5246 acc=88.99%
[TRAIN][ep=085] mask_avg: mc_mean=0.2368 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1826
[EPOCH 085/089] train: loss=0.5246 acc=88.99% | val: loss=0.7661 acc=66.27% f1=75.00% auc=75.00% val_score=46.6347 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.183) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.7981
[DBG][ep=086] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=086] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=086] mask(step0): mc_mean=0.2683 mb_mean=0.4732 norm_overlap=0.9966 corr_cb=-0.1173 topkJ=0.0298
[TRAIN][ep=086] loss=0.5217 acc=88.99%
[TRAIN][ep=086] mask_avg: mc_mean=0.2367 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1800
[EPOCH 086/089] train: loss=0.5217 acc=88.99% | val: loss=0.7490 acc=66.27% f1=75.00% auc=75.06% val_score=53.9142 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.180) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.7981
[EARLY STOP] no improvement for 30 epochs. best_epoch=56
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
=============== FIT DONE ===============
[BEST] epoch=56 | val_acc=66.27% | val_f1=75.00% | val_auc=75.52% | val_score=48.4200 | val_score_bestthr=70.7981
[TEST@BEST] thr_used=0.500 | acc=61.35% f1=65.81% auc=65.52% | SP_sex=1.23% EO_sex=1.27% SP_age=11.90% EO_age=12.35%
[TIME] 1.92 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/summary_fold_0.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4732 mb_mean=0.4739 norm_overlap=1.0003 corr_cb=0.4202 topkJ=0.1261
[TRAIN][ep=000] loss=0.6955 acc=51.54%
[TRAIN][ep=000] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3729
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4746 mb_mean=0.4736 norm_overlap=1.0001 corr_cb=0.2526 topkJ=0.1426
[TRAIN][ep=001] loss=0.6932 acc=50.74%
[TRAIN][ep=001] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3696
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4719 mb_mean=0.4692 norm_overlap=1.0002 corr_cb=0.4403 topkJ=0.2099
[TRAIN][ep=002] loss=0.6920 acc=50.60%
[TRAIN][ep=002] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3688
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4696 mb_mean=0.4711 norm_overlap=1.0003 corr_cb=0.4991 topkJ=0.2274
[TRAIN][ep=003] loss=0.6903 acc=55.57%
[TRAIN][ep=003] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3683
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4752 mb_mean=0.4728 norm_overlap=1.0003 corr_cb=0.4629 topkJ=0.1590
[TRAIN][ep=004] loss=0.6892 acc=52.21%
[TRAIN][ep=004] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3684
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4723 mb_mean=0.4722 norm_overlap=1.0002 corr_cb=0.3577 topkJ=0.1944
[TRAIN][ep=005] loss=0.6859 acc=55.17%
[TRAIN][ep=005] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3689
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4731 mb_mean=0.4733 norm_overlap=1.0004 corr_cb=0.5633 topkJ=0.1681
[TRAIN][ep=006] loss=0.6864 acc=57.45%
[TRAIN][ep=006] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3653
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4723 mb_mean=0.4718 norm_overlap=1.0002 corr_cb=0.4549 topkJ=0.1869
[TRAIN][ep=007] loss=0.6834 acc=58.39%
[TRAIN][ep=007] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3710
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4734 mb_mean=0.4747 norm_overlap=1.0002 corr_cb=0.3617 topkJ=0.1959
[TRAIN][ep=008] loss=0.6814 acc=59.60%
[TRAIN][ep=008] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3700
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4744 mb_mean=0.4729 norm_overlap=1.0001 corr_cb=0.3126 topkJ=0.0962
[TRAIN][ep=009] loss=0.6766 acc=59.33%
[TRAIN][ep=009] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3704
================= FIT START (fold=0) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4740 mb_mean=0.4722 norm_overlap=1.0002 corr_cb=0.3730 topkJ=0.1775
[TRAIN][ep=000] loss=0.6722 acc=61.61%
[TRAIN][ep=000] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3748
[EPOCH 000/089] train: loss=0.6722 acc=61.61% | val: loss=0.6833 acc=60.24% f1=63.74% auc=60.58% val_score=37.0937 val_score_bestthr=61.8943 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.375) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 61.8943
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4741 mb_mean=0.4758 norm_overlap=1.0000 corr_cb=0.0718 topkJ=0.1290
[TRAIN][ep=001] loss=0.6663 acc=59.60%
[TRAIN][ep=001] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3678
[EPOCH 001/089] train: loss=0.6663 acc=59.60% | val: loss=0.6969 acc=57.83% f1=63.16% auc=58.26% val_score=54.9121 val_score_bestthr=56.8889 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.368) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.8943 -> 56.8889
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4768 mb_mean=0.4754 norm_overlap=1.0002 corr_cb=0.3045 topkJ=0.2290
[TRAIN][ep=002] loss=0.6649 acc=61.21%
[TRAIN][ep=002] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3720
[EPOCH 002/089] train: loss=0.6649 acc=61.21% | val: loss=0.6742 acc=61.45% f1=65.96% auc=63.78% val_score=56.8472 val_score_bestthr=61.2333 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.372) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.8943 -> 61.2333
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4684 mb_mean=0.4694 norm_overlap=1.0003 corr_cb=0.5137 topkJ=0.2279
[TRAIN][ep=003] loss=0.6626 acc=62.95%
[TRAIN][ep=003] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3689
[EPOCH 003/089] train: loss=0.6626 acc=62.95% | val: loss=0.6674 acc=63.86% f1=66.67% auc=65.12% val_score=55.0292 val_score_bestthr=62.2240 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.369) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 61.8943 -> 62.2240
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4725 mb_mean=0.4704 norm_overlap=1.0002 corr_cb=0.4488 topkJ=0.1783
[TRAIN][ep=004] loss=0.6562 acc=64.30%
[TRAIN][ep=004] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3726
[EPOCH 004/089] train: loss=0.6562 acc=64.30% | val: loss=0.6846 acc=60.24% f1=63.74% auc=60.87% val_score=40.1125 val_score_bestthr=58.9269 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.373) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.2240 -> 58.9269
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4748 mb_mean=0.4735 norm_overlap=1.0001 corr_cb=0.2218 topkJ=0.0905
[TRAIN][ep=005] loss=1.5503 acc=62.15%
[TRAIN][ep=005] mask_avg: mc_mean=0.3920 mb_mean=0.4721 norm_overlap=1.0014 corr_cb=0.5388
[EPOCH 005/089] train: loss=1.5503 acc=62.15% | val: loss=0.6670 acc=67.47% f1=70.33% auc=66.74% val_score=47.1564 val_score_bestthr=64.7660 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.392, mb=0.472, no=1.001, corr=0.539) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 62.2240 -> 64.7660
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.3138 mb_mean=0.4730 norm_overlap=1.0015 corr_cb=0.3887 topkJ=0.2167
[TRAIN][ep=006] loss=1.5302 acc=62.95%
[TRAIN][ep=006] mask_avg: mc_mean=0.2862 mb_mean=0.4721 norm_overlap=1.0032 corr_cb=0.5071
[EPOCH 006/089] train: loss=1.5302 acc=62.95% | val: loss=0.6901 acc=59.04% f1=64.58% auc=61.63% val_score=50.2325 val_score_bestthr=56.9212 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.286, mb=0.472, no=1.003, corr=0.507) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.7660 -> 56.9212
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2528 mb_mean=0.4707 norm_overlap=1.0066 corr_cb=0.6461 topkJ=0.2165
[TRAIN][ep=007] loss=1.5272 acc=62.28%
[TRAIN][ep=007] mask_avg: mc_mean=0.2563 mb_mean=0.4721 norm_overlap=1.0036 corr_cb=0.4715
[EPOCH 007/089] train: loss=1.5272 acc=62.28% | val: loss=0.6563 acc=67.47% f1=69.66% auc=68.31% val_score=61.7986 val_score_bestthr=64.3484 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.256, mb=0.472, no=1.004, corr=0.472) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.7660 -> 64.3484
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2816 mb_mean=0.4760 norm_overlap=1.0020 corr_cb=0.3072 topkJ=0.1973
[TRAIN][ep=008] loss=1.5109 acc=65.23%
[TRAIN][ep=008] mask_avg: mc_mean=0.2414 mb_mean=0.4721 norm_overlap=1.0033 corr_cb=0.3820
[EPOCH 008/089] train: loss=1.5109 acc=65.23% | val: loss=0.6581 acc=66.27% f1=66.67% auc=66.92% val_score=45.6675 val_score_bestthr=62.2563 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.241, mb=0.472, no=1.003, corr=0.382) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.7660 -> 62.2563
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2198 mb_mean=0.4697 norm_overlap=1.0052 corr_cb=0.4771 topkJ=0.1641
[TRAIN][ep=009] loss=1.5029 acc=66.58%
[TRAIN][ep=009] mask_avg: mc_mean=0.2330 mb_mean=0.4721 norm_overlap=1.0031 corr_cb=0.3266
[EPOCH 009/089] train: loss=1.5029 acc=66.58% | val: loss=0.6981 acc=60.24% f1=65.26% auc=61.57% val_score=54.9121 val_score_bestthr=58.0251 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.233, mb=0.472, no=1.003, corr=0.327) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.7660 -> 58.0251
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.2355 mb_mean=0.4726 norm_overlap=1.0041 corr_cb=0.3959 topkJ=0.1049
[TRAIN][ep=010] loss=1.5111 acc=63.76%
[TRAIN][ep=010] mask_avg: mc_mean=0.2259 mb_mean=0.4721 norm_overlap=1.0028 corr_cb=0.2692
[EPOCH 010/089] train: loss=1.5111 acc=63.76% | val: loss=0.6460 acc=56.63% f1=70.49% auc=70.58% val_score=51.8684 val_score_bestthr=63.9539 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.226, mb=0.472, no=1.003, corr=0.269) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.7660 -> 63.9539
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.2365 mb_mean=0.4757 norm_overlap=1.0018 corr_cb=0.2234 topkJ=0.0728
[TRAIN][ep=011] loss=1.2332 acc=65.37%
[TRAIN][ep=011] mask_avg: mc_mean=0.2077 mb_mean=0.4721 norm_overlap=1.0027 corr_cb=0.2217
[EPOCH 011/089] train: loss=1.2332 acc=65.37% | val: loss=0.6387 acc=63.86% f1=70.59% auc=69.94% val_score=54.2493 val_score_bestthr=59.4672 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.208, mb=0.472, no=1.003, corr=0.222) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.7660 -> 59.4672
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.2029 mb_mean=0.4710 norm_overlap=1.0039 corr_cb=0.2840 topkJ=0.1237
[TRAIN][ep=012] loss=0.9613 acc=68.99%
[TRAIN][ep=012] mask_avg: mc_mean=0.2038 mb_mean=0.4721 norm_overlap=1.0019 corr_cb=0.1306
[EPOCH 012/089] train: loss=0.9613 acc=68.99% | val: loss=0.6370 acc=61.45% f1=69.23% auc=69.01% val_score=55.1103 val_score_bestthr=56.6039 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.204, mb=0.472, no=1.002, corr=0.131) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.7660 -> 56.6039
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.2351 mb_mean=0.4762 norm_overlap=0.9999 corr_cb=-0.0053 topkJ=0.0619
[TRAIN][ep=013] loss=0.8919 acc=68.19%
[TRAIN][ep=013] mask_avg: mc_mean=0.2100 mb_mean=0.4721 norm_overlap=1.0006 corr_cb=0.0307
[EPOCH 013/089] train: loss=0.8919 acc=68.19% | val: loss=0.6312 acc=63.86% f1=70.00% auc=69.36% val_score=55.6749 val_score_bestthr=57.6120 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.210, mb=0.472, no=1.001, corr=0.031) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.7660 -> 57.6120
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.2204 mb_mean=0.4743 norm_overlap=1.0008 corr_cb=0.0522 topkJ=0.0774
[TRAIN][ep=014] loss=0.8672 acc=71.28%
[TRAIN][ep=014] mask_avg: mc_mean=0.1991 mb_mean=0.4721 norm_overlap=0.9998 corr_cb=-0.0159
[EPOCH 014/089] train: loss=0.8672 acc=71.28% | val: loss=0.6279 acc=65.06% f1=70.71% auc=69.83% val_score=55.6749 val_score_bestthr=58.7200 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.199, mb=0.472, no=1.000, corr=-0.016) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.7660 -> 58.7200
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1500 mb_mean=0.4689 norm_overlap=1.0013 corr_cb=0.0593 topkJ=0.0448
[TRAIN][ep=015] loss=0.8607 acc=71.01%
[TRAIN][ep=015] mask_avg: mc_mean=0.1728 mb_mean=0.4721 norm_overlap=0.9999 corr_cb=-0.0125
[EPOCH 015/089] train: loss=0.8607 acc=71.01% | val: loss=0.6628 acc=57.83% f1=71.07% auc=67.97% val_score=51.1388 val_score_bestthr=63.8258 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.173, mb=0.472, no=1.000, corr=-0.013) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.7660 -> 63.8258
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1857 mb_mean=0.4714 norm_overlap=1.0020 corr_cb=0.1002 topkJ=0.0484
[TRAIN][ep=016] loss=0.8551 acc=71.54%
[TRAIN][ep=016] mask_avg: mc_mean=0.1791 mb_mean=0.4721 norm_overlap=0.9991 corr_cb=-0.0452
[EPOCH 016/089] train: loss=0.8551 acc=71.54% | val: loss=0.6190 acc=65.06% f1=71.29% auc=70.35% val_score=53.9218 val_score_bestthr=58.8239 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.179, mb=0.472, no=0.999, corr=-0.045) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.7660 -> 58.8239
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1972 mb_mean=0.4756 norm_overlap=0.9979 corr_cb=-0.1125 topkJ=0.0333
[TRAIN][ep=017] loss=0.8421 acc=71.41%
[TRAIN][ep=017] mask_avg: mc_mean=0.1794 mb_mean=0.4721 norm_overlap=0.9985 corr_cb=-0.0663
[EPOCH 017/089] train: loss=0.8421 acc=71.41% | val: loss=0.6213 acc=66.27% f1=71.43% auc=70.52% val_score=42.0368 val_score_bestthr=59.8302 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.179, mb=0.472, no=0.999, corr=-0.066) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.7660 -> 59.8302
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.2118 mb_mean=0.4736 norm_overlap=0.9971 corr_cb=-0.1457 topkJ=0.0197
[TRAIN][ep=018] loss=0.8379 acc=72.62%
[TRAIN][ep=018] mask_avg: mc_mean=0.2106 mb_mean=0.4721 norm_overlap=0.9972 corr_cb=-0.1291
[EPOCH 018/089] train: loss=0.8379 acc=72.62% | val: loss=0.6187 acc=66.27% f1=71.43% auc=72.21% val_score=49.0581 val_score_bestthr=59.8302 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.211, mb=0.472, no=0.997, corr=-0.129) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.7660 -> 59.8302
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1676 mb_mean=0.4748 norm_overlap=0.9931 corr_cb=-0.3078 topkJ=0.0084
[TRAIN][ep=019] loss=0.8296 acc=73.83%
[TRAIN][ep=019] mask_avg: mc_mean=0.1904 mb_mean=0.4721 norm_overlap=0.9977 corr_cb=-0.1102
[EPOCH 019/089] train: loss=0.8296 acc=73.83% | val: loss=0.5977 acc=65.06% f1=68.82% auc=72.79% val_score=42.0396 val_score_bestthr=60.0963 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.472, no=0.998, corr=-0.110) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.7660 -> 60.0963
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1051 mb_mean=0.4736 norm_overlap=1.0014 corr_cb=0.0394 topkJ=0.0338
[TRAIN][ep=020] loss=0.8297 acc=71.95%
[TRAIN][ep=020] mask_avg: mc_mean=0.1895 mb_mean=0.4721 norm_overlap=0.9974 corr_cb=-0.1148
[EPOCH 020/089] train: loss=0.8297 acc=71.95% | val: loss=0.6423 acc=66.27% f1=70.83% auc=70.58% val_score=56.2353 val_score_bestthr=60.9269 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.189, mb=0.472, no=0.997, corr=-0.115) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.7660 -> 60.9269
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.1855 mb_mean=0.4700 norm_overlap=0.9969 corr_cb=-0.1294 topkJ=0.0358
[TRAIN][ep=021] loss=0.8318 acc=71.14%
[TRAIN][ep=021] mask_avg: mc_mean=0.2160 mb_mean=0.4721 norm_overlap=0.9967 corr_cb=-0.1436
[EPOCH 021/089] train: loss=0.8318 acc=71.14% | val: loss=0.6028 acc=67.47% f1=72.73% auc=73.60% val_score=50.1627 val_score_bestthr=62.7938 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.216, mb=0.472, no=0.997, corr=-0.144) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.7660 -> 62.7938
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1892 mb_mean=0.4722 norm_overlap=0.9980 corr_cb=-0.0736 topkJ=0.0359
[TRAIN][ep=022] loss=0.8121 acc=74.50%
[TRAIN][ep=022] mask_avg: mc_mean=0.1987 mb_mean=0.4721 norm_overlap=0.9971 corr_cb=-0.1215
[EPOCH 022/089] train: loss=0.8121 acc=74.50% | val: loss=0.6133 acc=66.27% f1=72.00% auc=71.98% val_score=52.9009 val_score_bestthr=61.6828 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.199, mb=0.472, no=0.997, corr=-0.122) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.7660 -> 61.6828
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1901 mb_mean=0.4728 norm_overlap=0.9966 corr_cb=-0.1353 topkJ=0.0367
[TRAIN][ep=023] loss=0.8068 acc=72.21%
[TRAIN][ep=023] mask_avg: mc_mean=0.2015 mb_mean=0.4721 norm_overlap=0.9967 corr_cb=-0.1291
[EPOCH 023/089] train: loss=0.8068 acc=72.21% | val: loss=0.5964 acc=67.47% f1=72.73% auc=74.94% val_score=55.7489 val_score_bestthr=63.3131 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.202, mb=0.472, no=0.997, corr=-0.129) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.7660 -> 63.3131
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2296 mb_mean=0.4734 norm_overlap=0.9984 corr_cb=-0.0670 topkJ=0.0424
[TRAIN][ep=024] loss=0.7961 acc=74.77%
[TRAIN][ep=024] mask_avg: mc_mean=0.2084 mb_mean=0.4721 norm_overlap=0.9960 corr_cb=-0.1569
[EPOCH 024/089] train: loss=0.7961 acc=74.77% | val: loss=0.6092 acc=67.47% f1=72.73% auc=73.08% val_score=50.5935 val_score_bestthr=62.7938 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.208, mb=0.472, no=0.996, corr=-0.157) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.7660 -> 62.7938
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1782 mb_mean=0.4715 norm_overlap=1.0000 corr_cb=-0.0008 topkJ=0.0386
[TRAIN][ep=025] loss=0.7864 acc=75.44%
[TRAIN][ep=025] mask_avg: mc_mean=0.2023 mb_mean=0.4721 norm_overlap=0.9964 corr_cb=-0.1367
[EPOCH 025/089] train: loss=0.7864 acc=75.44% | val: loss=0.5951 acc=65.06% f1=71.29% auc=73.90% val_score=55.5456 val_score_bestthr=59.3565 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.202, mb=0.472, no=0.996, corr=-0.137) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.7660 -> 59.3565
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1452 mb_mean=0.4765 norm_overlap=0.9969 corr_cb=-0.1163 topkJ=0.0449
[TRAIN][ep=026] loss=0.7824 acc=75.70%
[TRAIN][ep=026] mask_avg: mc_mean=0.1652 mb_mean=0.4721 norm_overlap=0.9975 corr_cb=-0.0908
[EPOCH 026/089] train: loss=0.7824 acc=75.70% | val: loss=0.5914 acc=66.27% f1=73.08% auc=73.78% val_score=44.1270 val_score_bestthr=60.2255 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.165, mb=0.472, no=0.998, corr=-0.091) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.7660 -> 60.2255
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.3199 mb_mean=0.4714 norm_overlap=0.9929 corr_cb=-0.3478 topkJ=0.0169
[TRAIN][ep=027] loss=0.7909 acc=74.77%
[TRAIN][ep=027] mask_avg: mc_mean=0.2078 mb_mean=0.4721 norm_overlap=0.9964 corr_cb=-0.1412
[EPOCH 027/089] train: loss=0.7909 acc=74.77% | val: loss=0.6178 acc=67.47% f1=72.73% auc=73.66% val_score=57.8015 val_score_bestthr=62.7938 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.208, mb=0.472, no=0.996, corr=-0.141) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.7660 -> 62.7938
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1676 mb_mean=0.4701 norm_overlap=0.9972 corr_cb=-0.0774 topkJ=0.0257
[TRAIN][ep=028] loss=0.7706 acc=75.30%
[TRAIN][ep=028] mask_avg: mc_mean=0.2060 mb_mean=0.4721 norm_overlap=0.9963 corr_cb=-0.1405
[EPOCH 028/089] train: loss=0.7706 acc=75.30% | val: loss=0.6401 acc=63.86% f1=71.15% auc=73.31% val_score=58.5426 val_score_bestthr=61.9239 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.206, mb=0.472, no=0.996, corr=-0.140) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.7660 -> 61.9239
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2116 mb_mean=0.4737 norm_overlap=0.9971 corr_cb=-0.1341 topkJ=0.0408
[TRAIN][ep=029] loss=0.7791 acc=74.63%
[TRAIN][ep=029] mask_avg: mc_mean=0.2116 mb_mean=0.4721 norm_overlap=0.9964 corr_cb=-0.1402
[EPOCH 029/089] train: loss=0.7791 acc=74.63% | val: loss=0.5825 acc=67.47% f1=72.73% auc=75.64% val_score=53.5782 val_score_bestthr=64.5305 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.212, mb=0.472, no=0.996, corr=-0.140) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.7660 -> 64.5305
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2192 mb_mean=0.4712 norm_overlap=0.9948 corr_cb=-0.1816 topkJ=0.0568
[TRAIN][ep=030] loss=0.7521 acc=75.97%
[TRAIN][ep=030] mask_avg: mc_mean=0.2118 mb_mean=0.4721 norm_overlap=0.9960 corr_cb=-0.1506
[EPOCH 030/089] train: loss=0.7521 acc=75.97% | val: loss=0.6149 acc=65.06% f1=71.84% auc=74.77% val_score=56.4907 val_score_bestthr=63.1539 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.212, mb=0.472, no=0.996, corr=-0.151) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.7660 -> 63.1539
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2131 mb_mean=0.4716 norm_overlap=0.9952 corr_cb=-0.1843 topkJ=0.0398
[TRAIN][ep=031] loss=0.7427 acc=77.45%
[TRAIN][ep=031] mask_avg: mc_mean=0.1981 mb_mean=0.4721 norm_overlap=0.9964 corr_cb=-0.1292
[EPOCH 031/089] train: loss=0.7427 acc=77.45% | val: loss=0.5891 acc=63.86% f1=72.73% auc=74.77% val_score=56.3349 val_score_bestthr=61.5939 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.198, mb=0.472, no=0.996, corr=-0.129) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.7660 -> 61.5939
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2247 mb_mean=0.4736 norm_overlap=0.9969 corr_cb=-0.1285 topkJ=0.0373
[TRAIN][ep=032] loss=0.7442 acc=76.11%
[TRAIN][ep=032] mask_avg: mc_mean=0.2149 mb_mean=0.4721 norm_overlap=0.9960 corr_cb=-0.1503
[EPOCH 032/089] train: loss=0.7442 acc=76.11% | val: loss=0.5957 acc=66.27% f1=72.00% auc=75.29% val_score=55.1934 val_score_bestthr=65.1695 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.215, mb=0.472, no=0.996, corr=-0.150) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 64.7660 -> 65.1695
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1516 mb_mean=0.4719 norm_overlap=0.9956 corr_cb=-0.1238 topkJ=0.0335
[TRAIN][ep=033] loss=0.8529 acc=75.03%
[TRAIN][ep=033] mask_avg: mc_mean=0.1889 mb_mean=0.4721 norm_overlap=0.9967 corr_cb=-0.1159
[EPOCH 033/089] train: loss=0.8529 acc=75.03% | val: loss=0.5866 acc=65.06% f1=72.38% auc=75.17% val_score=51.4808 val_score_bestthr=63.0938 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.189, mb=0.472, no=0.997, corr=-0.116) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1695 -> 63.0938
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1872 mb_mean=0.4724 norm_overlap=1.0010 corr_cb=0.0323 topkJ=0.1309
[TRAIN][ep=034] loss=0.9264 acc=77.99%
[TRAIN][ep=034] mask_avg: mc_mean=0.1882 mb_mean=0.4721 norm_overlap=0.9969 corr_cb=-0.1074
[EPOCH 034/089] train: loss=0.9264 acc=77.99% | val: loss=0.5865 acc=63.86% f1=72.22% auc=75.17% val_score=51.7490 val_score_bestthr=60.7090 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.188, mb=0.472, no=0.997, corr=-0.107) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1695 -> 60.7090
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2299 mb_mean=0.4717 norm_overlap=1.0027 corr_cb=0.0824 topkJ=0.0536
[TRAIN][ep=035] loss=1.0209 acc=78.26%
[TRAIN][ep=035] mask_avg: mc_mean=0.2255 mb_mean=0.4721 norm_overlap=0.9957 corr_cb=-0.1616
[EPOCH 035/089] train: loss=1.0209 acc=78.26% | val: loss=0.6110 acc=65.06% f1=71.84% auc=75.47% val_score=59.7112 val_score_bestthr=64.2468 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.226, mb=0.472, no=0.996, corr=-0.162) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1695 -> 64.2468
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.1969 mb_mean=0.4719 norm_overlap=0.9966 corr_cb=-0.0985 topkJ=0.0383
[TRAIN][ep=036] loss=1.1294 acc=77.18%
[TRAIN][ep=036] mask_avg: mc_mean=0.2040 mb_mean=0.4721 norm_overlap=0.9967 corr_cb=-0.1154
[EPOCH 036/089] train: loss=1.1294 acc=77.18% | val: loss=0.6085 acc=66.27% f1=72.00% auc=77.27% val_score=61.1965 val_score_bestthr=64.6224 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.204, mb=0.472, no=0.997, corr=-0.115) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1695 -> 64.6224
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1845 mb_mean=0.4646 norm_overlap=0.9949 corr_cb=-0.1567 topkJ=0.0561
[TRAIN][ep=037] loss=1.2041 acc=78.79%
[TRAIN][ep=037] mask_avg: mc_mean=0.1969 mb_mean=0.4721 norm_overlap=0.9965 corr_cb=-0.1227
[EPOCH 037/089] train: loss=1.2041 acc=78.79% | val: loss=0.5942 acc=67.47% f1=75.23% auc=76.05% val_score=57.8049 val_score_bestthr=69.5180 | dyn(w_pfs=0.240, w_sup=0.240, w_csuf=0.200, stage2=False) | mask(mc=0.197, mb=0.472, no=0.997, corr=-0.123) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 65.1695 -> 69.5180
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2231 mb_mean=0.4726 norm_overlap=0.9955 corr_cb=-0.1466 topkJ=0.0419
[TRAIN][ep=038] loss=1.2157 acc=79.73%
[TRAIN][ep=038] mask_avg: mc_mean=0.2129 mb_mean=0.4721 norm_overlap=0.9957 corr_cb=-0.1531
[EPOCH 038/089] train: loss=1.2157 acc=79.73% | val: loss=0.5909 acc=67.47% f1=75.23% auc=75.47% val_score=51.7490 val_score_bestthr=69.5180 | dyn(w_pfs=0.280, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.213, mb=0.472, no=0.996, corr=-0.153) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.5180 -> 69.5180
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.1954 mb_mean=0.4731 norm_overlap=0.9930 corr_cb=-0.2365 topkJ=0.0288
[TRAIN][ep=039] loss=1.2260 acc=80.00%
[TRAIN][ep=039] mask_avg: mc_mean=0.2344 mb_mean=0.4721 norm_overlap=0.9953 corr_cb=-0.1777
[EPOCH 039/089] train: loss=1.2260 acc=80.00% | val: loss=0.6135 acc=63.86% f1=71.70% auc=75.47% val_score=54.7239 val_score_bestthr=64.4243 | dyn(w_pfs=0.320, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.234, mb=0.472, no=0.995, corr=-0.178) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.5180 -> 64.4243
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.2335 mb_mean=0.4759 norm_overlap=0.9925 corr_cb=-0.2940 topkJ=0.0183
[TRAIN][ep=040] loss=1.2223 acc=80.67%
[TRAIN][ep=040] mask_avg: mc_mean=0.2054 mb_mean=0.4721 norm_overlap=0.9957 corr_cb=-0.1473
[EPOCH 040/089] train: loss=1.2223 acc=80.67% | val: loss=0.6099 acc=66.27% f1=74.07% auc=75.52% val_score=53.1811 val_score_bestthr=68.7655 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.205, mb=0.472, no=0.996, corr=-0.147) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.5180 -> 68.7655
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.2595 mb_mean=0.4749 norm_overlap=0.9956 corr_cb=-0.1800 topkJ=0.0373
[TRAIN][ep=041] loss=1.2354 acc=80.13%
[TRAIN][ep=041] mask_avg: mc_mean=0.2333 mb_mean=0.4721 norm_overlap=0.9950 corr_cb=-0.1873
[EPOCH 041/089] train: loss=1.2354 acc=80.13% | val: loss=0.6276 acc=67.47% f1=75.68% auc=74.77% val_score=54.8852 val_score_bestthr=70.3941 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.233, mb=0.472, no=0.995, corr=-0.187) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 69.5180 -> 70.3941
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.2329 mb_mean=0.4719 norm_overlap=0.9962 corr_cb=-0.1661 topkJ=0.0331
[TRAIN][ep=042] loss=1.2229 acc=81.74%
[TRAIN][ep=042] mask_avg: mc_mean=0.2030 mb_mean=0.4721 norm_overlap=0.9964 corr_cb=-0.1261
[EPOCH 042/089] train: loss=1.2229 acc=81.74% | val: loss=0.6669 acc=66.27% f1=75.00% auc=74.83% val_score=60.5207 val_score_bestthr=70.5083 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.203, mb=0.472, no=0.996, corr=-0.126) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 70.3941 -> 70.5083
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.1924 mb_mean=0.4726 norm_overlap=0.9936 corr_cb=-0.1932 topkJ=0.0349
[TRAIN][ep=043] loss=1.1917 acc=83.49%
[TRAIN][ep=043] mask_avg: mc_mean=0.2421 mb_mean=0.4721 norm_overlap=0.9950 corr_cb=-0.1877
[EPOCH 043/089] train: loss=1.1917 acc=83.49% | val: loss=0.6046 acc=67.47% f1=73.79% auc=77.03% val_score=55.0140 val_score_bestthr=66.9679 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.242, mb=0.472, no=0.995, corr=-0.188) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5083 -> 66.9679
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2557 mb_mean=0.4690 norm_overlap=0.9942 corr_cb=-0.2231 topkJ=0.0282
[TRAIN][ep=044] loss=1.2051 acc=80.54%
[TRAIN][ep=044] mask_avg: mc_mean=0.2512 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1960
[EPOCH 044/089] train: loss=1.2051 acc=80.54% | val: loss=0.6389 acc=68.67% f1=75.47% auc=76.86% val_score=58.8690 val_score_bestthr=68.0317 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.251, mb=0.472, no=0.995, corr=-0.196) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5083 -> 68.0317
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2108 mb_mean=0.4723 norm_overlap=0.9967 corr_cb=-0.1175 topkJ=0.0600
[TRAIN][ep=045] loss=1.1853 acc=82.95%
[TRAIN][ep=045] mask_avg: mc_mean=0.2328 mb_mean=0.4721 norm_overlap=0.9955 corr_cb=-0.1653
[EPOCH 045/089] train: loss=1.1853 acc=82.95% | val: loss=0.7183 acc=65.06% f1=73.87% auc=73.60% val_score=53.5260 val_score_bestthr=68.8906 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.233, mb=0.472, no=0.996, corr=-0.165) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5083 -> 68.8906
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.2342 mb_mean=0.4729 norm_overlap=0.9936 corr_cb=-0.2413 topkJ=0.0165
[TRAIN][ep=046] loss=1.1694 acc=83.49%
[TRAIN][ep=046] mask_avg: mc_mean=0.2507 mb_mean=0.4721 norm_overlap=0.9955 corr_cb=-0.1723
[EPOCH 046/089] train: loss=1.1694 acc=83.49% | val: loss=0.6494 acc=65.06% f1=73.87% auc=75.47% val_score=47.1685 val_score_bestthr=68.8906 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.251, mb=0.472, no=0.996, corr=-0.172) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5083 -> 68.8906
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.2146 mb_mean=0.4700 norm_overlap=0.9954 corr_cb=-0.1691 topkJ=0.0423
[TRAIN][ep=047] loss=1.1629 acc=82.68%
[TRAIN][ep=047] mask_avg: mc_mean=0.2370 mb_mean=0.4721 norm_overlap=0.9953 corr_cb=-0.1697
[EPOCH 047/089] train: loss=1.1629 acc=82.68% | val: loss=0.6529 acc=67.47% f1=74.29% auc=75.93% val_score=48.7060 val_score_bestthr=69.4284 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.170) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5083 -> 69.4284
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.3174 mb_mean=0.4695 norm_overlap=0.9916 corr_cb=-0.3830 topkJ=0.0095
[TRAIN][ep=048] loss=0.9345 acc=83.49%
[TRAIN][ep=048] mask_avg: mc_mean=0.2669 mb_mean=0.4721 norm_overlap=0.9947 corr_cb=-0.2067
[EPOCH 048/089] train: loss=0.9345 acc=83.49% | val: loss=0.6306 acc=68.67% f1=75.00% auc=75.87% val_score=53.9142 val_score_bestthr=70.5375 | dyn(w_pfs=0.290, w_sup=0.190, w_csuf=0.140, stage2=False) | mask(mc=0.267, mb=0.472, no=0.995, corr=-0.207) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 70.5083 -> 70.5375
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=049] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.2656 mb_mean=0.4735 norm_overlap=0.9956 corr_cb=-0.1769 topkJ=0.0226
[TRAIN][ep=049] loss=0.9993 acc=84.97%
[TRAIN][ep=049] mask_avg: mc_mean=0.2411 mb_mean=0.4721 norm_overlap=0.9954 corr_cb=-0.1666
[EPOCH 049/089] train: loss=0.9993 acc=84.97% | val: loss=0.6333 acc=68.67% f1=75.00% auc=76.51% val_score=50.1193 val_score_bestthr=70.5375 | dyn(w_pfs=0.330, w_sup=0.230, w_csuf=0.180, stage2=False) | mask(mc=0.241, mb=0.472, no=0.995, corr=-0.167) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5375 -> 70.5375
[DBG][ep=050] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.2641 mb_mean=0.4713 norm_overlap=0.9908 corr_cb=-0.3484 topkJ=0.0090
[TRAIN][ep=050] loss=0.6447 acc=84.30%
[TRAIN][ep=050] mask_avg: mc_mean=0.2505 mb_mean=0.4721 norm_overlap=0.9947 corr_cb=-0.1964
[EPOCH 050/089] train: loss=0.6447 acc=84.30% | val: loss=0.6405 acc=68.67% f1=75.00% auc=76.10% val_score=49.4654 val_score_bestthr=70.5375 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.251, mb=0.472, no=0.995, corr=-0.196) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5375 -> 70.5375
[DBG][ep=051] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.2501 mb_mean=0.4781 norm_overlap=0.9936 corr_cb=-0.2441 topkJ=0.0198
[TRAIN][ep=051] loss=0.5759 acc=86.31%
[TRAIN][ep=051] mask_avg: mc_mean=0.2505 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1944
[EPOCH 051/089] train: loss=0.5759 acc=86.31% | val: loss=0.6605 acc=66.27% f1=74.55% auc=75.93% val_score=50.5954 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.472, no=0.995, corr=-0.194) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5375 -> 70.2831
[DBG][ep=052] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.2612 mb_mean=0.4697 norm_overlap=0.9948 corr_cb=-0.1829 topkJ=0.0389
[TRAIN][ep=052] loss=0.5754 acc=85.91%
[TRAIN][ep=052] mask_avg: mc_mean=0.2506 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1904
[EPOCH 052/089] train: loss=0.5754 acc=85.91% | val: loss=0.6512 acc=67.47% f1=74.29% auc=76.05% val_score=48.6024 val_score_bestthr=69.4284 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.251, mb=0.472, no=0.995, corr=-0.190) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5375 -> 69.4284
[DBG][ep=053] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.2154 mb_mean=0.4687 norm_overlap=0.9949 corr_cb=-0.2017 topkJ=0.0287
[TRAIN][ep=053] loss=0.5739 acc=86.44%
[TRAIN][ep=053] mask_avg: mc_mean=0.2505 mb_mean=0.4721 norm_overlap=0.9947 corr_cb=-0.1949
[EPOCH 053/089] train: loss=0.5739 acc=86.44% | val: loss=0.6639 acc=66.27% f1=74.55% auc=76.10% val_score=52.0125 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.251, mb=0.472, no=0.995, corr=-0.195) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5375 -> 70.2831
[DBG][ep=054] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=054] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=054] mask(step0): mc_mean=0.2498 mb_mean=0.4716 norm_overlap=0.9981 corr_cb=-0.0713 topkJ=0.0499
[TRAIN][ep=054] loss=0.5723 acc=86.85%
[TRAIN][ep=054] mask_avg: mc_mean=0.2505 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1913
[EPOCH 054/089] train: loss=0.5723 acc=86.85% | val: loss=0.6675 acc=66.27% f1=74.55% auc=75.99% val_score=52.0125 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.251, mb=0.472, no=0.995, corr=-0.191) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5375 -> 70.2831
[DBG][ep=055] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=055] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=055] mask(step0): mc_mean=0.2448 mb_mean=0.4709 norm_overlap=0.9959 corr_cb=-0.1652 topkJ=0.0309
[TRAIN][ep=055] loss=0.5695 acc=86.31%
[TRAIN][ep=055] mask_avg: mc_mean=0.2505 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1895
[EPOCH 055/089] train: loss=0.5695 acc=86.31% | val: loss=0.6701 acc=66.27% f1=74.55% auc=75.99% val_score=52.0125 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.472, no=0.995, corr=-0.190) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5375 -> 70.2831
[DBG][ep=056] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=056] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=056] mask(step0): mc_mean=0.2753 mb_mean=0.4722 norm_overlap=0.9935 corr_cb=-0.2362 topkJ=0.0323
[TRAIN][ep=056] loss=0.5666 acc=86.17%
[TRAIN][ep=056] mask_avg: mc_mean=0.2505 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1906
[EPOCH 056/089] train: loss=0.5666 acc=86.17% | val: loss=0.6605 acc=67.47% f1=75.68% auc=76.22% val_score=48.4200 val_score_bestthr=71.9014 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.472, no=0.995, corr=-0.191) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 70.5375 -> 71.9014
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=057] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=057] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=057] mask(step0): mc_mean=0.2479 mb_mean=0.4721 norm_overlap=0.9962 corr_cb=-0.1500 topkJ=0.0562
[TRAIN][ep=057] loss=0.5679 acc=84.97%
[TRAIN][ep=057] mask_avg: mc_mean=0.2505 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1940
[EPOCH 057/089] train: loss=0.5679 acc=84.97% | val: loss=0.6722 acc=66.27% f1=74.55% auc=75.93% val_score=50.1335 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.472, no=0.995, corr=-0.194) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.2831
[DBG][ep=058] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=058] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=058] mask(step0): mc_mean=0.3218 mb_mean=0.4710 norm_overlap=0.9936 corr_cb=-0.2628 topkJ=0.0266
[TRAIN][ep=058] loss=0.5626 acc=86.44%
[TRAIN][ep=058] mask_avg: mc_mean=0.2505 mb_mean=0.4721 norm_overlap=0.9947 corr_cb=-0.1939
[EPOCH 058/089] train: loss=0.5626 acc=86.44% | val: loss=0.6771 acc=67.47% f1=74.29% auc=75.93% val_score=50.1335 val_score_bestthr=69.4284 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.251, mb=0.472, no=0.995, corr=-0.194) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 69.4284
[DBG][ep=059] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=059] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=059] mask(step0): mc_mean=0.2529 mb_mean=0.4713 norm_overlap=0.9930 corr_cb=-0.2296 topkJ=0.0276
[TRAIN][ep=059] loss=0.5609 acc=86.31%
[TRAIN][ep=059] mask_avg: mc_mean=0.2506 mb_mean=0.4721 norm_overlap=0.9947 corr_cb=-0.1934
[EPOCH 059/089] train: loss=0.5609 acc=86.31% | val: loss=0.6934 acc=67.47% f1=75.23% auc=75.93% val_score=49.9234 val_score_bestthr=69.6376 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.251, mb=0.472, no=0.995, corr=-0.193) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 69.6376
[DBG][ep=060] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=060] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=060] mask(step0): mc_mean=0.2951 mb_mean=0.4667 norm_overlap=0.9903 corr_cb=-0.2981 topkJ=0.0187
[TRAIN][ep=060] loss=0.5578 acc=86.85%
[TRAIN][ep=060] mask_avg: mc_mean=0.2505 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1895
[EPOCH 060/089] train: loss=0.5578 acc=86.85% | val: loss=0.6694 acc=68.67% f1=75.00% auc=76.40% val_score=53.9142 val_score_bestthr=70.5375 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.251, mb=0.472, no=0.995, corr=-0.190) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.5375
[DBG][ep=061] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=061] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=061] mask(step0): mc_mean=0.2223 mb_mean=0.4745 norm_overlap=0.9954 corr_cb=-0.1811 topkJ=0.0402
[TRAIN][ep=061] loss=0.5570 acc=86.98%
[TRAIN][ep=061] mask_avg: mc_mean=0.2505 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1907
[EPOCH 061/089] train: loss=0.5570 acc=86.98% | val: loss=0.7197 acc=69.88% f1=76.19% auc=75.64% val_score=48.8217 val_score_bestthr=70.3588 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.472, no=0.995, corr=-0.191) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.3588
[DBG][ep=062] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=062] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=062] mask(step0): mc_mean=0.2638 mb_mean=0.4636 norm_overlap=0.9947 corr_cb=-0.2065 topkJ=0.0510
[TRAIN][ep=062] loss=0.5615 acc=87.11%
[TRAIN][ep=062] mask_avg: mc_mean=0.2504 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1891
[EPOCH 062/089] train: loss=0.5615 acc=87.11% | val: loss=0.7029 acc=67.47% f1=74.29% auc=75.99% val_score=51.4644 val_score_bestthr=69.4284 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.472, no=0.995, corr=-0.189) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 69.4284
[DBG][ep=063] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=063] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=063] mask(step0): mc_mean=0.2605 mb_mean=0.4693 norm_overlap=0.9967 corr_cb=-0.1386 topkJ=0.0613
[TRAIN][ep=063] loss=0.5553 acc=86.58%
[TRAIN][ep=063] mask_avg: mc_mean=0.2505 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1919
[EPOCH 063/089] train: loss=0.5553 acc=86.58% | val: loss=0.7097 acc=68.67% f1=75.00% auc=75.70% val_score=48.8217 val_score_bestthr=70.5375 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.472, no=0.995, corr=-0.192) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.5375
[DBG][ep=064] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=064] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=064] mask(step0): mc_mean=0.2578 mb_mean=0.4747 norm_overlap=0.9957 corr_cb=-0.1885 topkJ=0.0381
[TRAIN][ep=064] loss=0.5641 acc=85.10%
[TRAIN][ep=064] mask_avg: mc_mean=0.2505 mb_mean=0.4721 norm_overlap=0.9947 corr_cb=-0.1938
[EPOCH 064/089] train: loss=0.5641 acc=85.10% | val: loss=0.6790 acc=66.27% f1=75.00% auc=76.40% val_score=53.9142 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.251, mb=0.472, no=0.995, corr=-0.194) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.7981
[DBG][ep=065] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=065] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=065] mask(step0): mc_mean=0.2691 mb_mean=0.4721 norm_overlap=0.9931 corr_cb=-0.2657 topkJ=0.0172
[TRAIN][ep=065] loss=0.5552 acc=86.85%
[TRAIN][ep=065] mask_avg: mc_mean=0.2506 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1910
[EPOCH 065/089] train: loss=0.5552 acc=86.85% | val: loss=0.6893 acc=68.67% f1=75.00% auc=75.99% val_score=48.6024 val_score_bestthr=70.5375 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.251, mb=0.472, no=0.995, corr=-0.191) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.5375
[DBG][ep=066] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=066] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=066] mask(step0): mc_mean=0.2251 mb_mean=0.4743 norm_overlap=0.9949 corr_cb=-0.1790 topkJ=0.0398
[TRAIN][ep=066] loss=0.5558 acc=86.85%
[TRAIN][ep=066] mask_avg: mc_mean=0.2505 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1912
[EPOCH 066/089] train: loss=0.5558 acc=86.85% | val: loss=0.7073 acc=66.27% f1=74.55% auc=75.76% val_score=50.5954 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.251, mb=0.472, no=0.995, corr=-0.191) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.2831
[DBG][ep=067] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=067] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=067] mask(step0): mc_mean=0.2475 mb_mean=0.4704 norm_overlap=0.9939 corr_cb=-0.2436 topkJ=0.0264
[TRAIN][ep=067] loss=0.5484 acc=87.38%
[TRAIN][ep=067] mask_avg: mc_mean=0.2505 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1907
[EPOCH 067/089] train: loss=0.5484 acc=87.38% | val: loss=0.6935 acc=66.27% f1=75.00% auc=75.99% val_score=48.6024 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.251, mb=0.472, no=0.995, corr=-0.191) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.7981
[DBG][ep=068] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=068] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=068] mask(step0): mc_mean=0.2267 mb_mean=0.4743 norm_overlap=0.9954 corr_cb=-0.1805 topkJ=0.0264
[TRAIN][ep=068] loss=0.5510 acc=86.31%
[TRAIN][ep=068] mask_avg: mc_mean=0.2505 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1909
[EPOCH 068/089] train: loss=0.5510 acc=86.31% | val: loss=0.7027 acc=68.67% f1=75.00% auc=75.87% val_score=50.1335 val_score_bestthr=70.5375 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.251, mb=0.472, no=0.995, corr=-0.191) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.5375
[DBG][ep=069] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=069] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=069] mask(step0): mc_mean=0.2562 mb_mean=0.4699 norm_overlap=0.9912 corr_cb=-0.3409 topkJ=0.0221
[TRAIN][ep=069] loss=0.5461 acc=86.98%
[TRAIN][ep=069] mask_avg: mc_mean=0.2505 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1901
[EPOCH 069/089] train: loss=0.5461 acc=86.98% | val: loss=0.6965 acc=68.67% f1=75.47% auc=76.16% val_score=48.6024 val_score_bestthr=68.0462 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.251, mb=0.472, no=0.995, corr=-0.190) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 68.0462
[DBG][ep=070] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=070] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=070] mask(step0): mc_mean=0.2491 mb_mean=0.4706 norm_overlap=0.9927 corr_cb=-0.2430 topkJ=0.0288
[TRAIN][ep=070] loss=0.5453 acc=87.38%
[TRAIN][ep=070] mask_avg: mc_mean=0.2505 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1886
[EPOCH 070/089] train: loss=0.5453 acc=87.38% | val: loss=0.6971 acc=65.06% f1=73.87% auc=76.22% val_score=48.6024 val_score_bestthr=69.1804 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.251, mb=0.472, no=0.995, corr=-0.189) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 69.1804
[DBG][ep=071] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=071] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=071] mask(step0): mc_mean=0.2548 mb_mean=0.4724 norm_overlap=0.9915 corr_cb=-0.3322 topkJ=0.0217
[TRAIN][ep=071] loss=0.5475 acc=86.71%
[TRAIN][ep=071] mask_avg: mc_mean=0.2505 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1916
[EPOCH 071/089] train: loss=0.5475 acc=86.71% | val: loss=0.7663 acc=68.67% f1=75.00% auc=74.88% val_score=48.8217 val_score_bestthr=70.5375 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.472, no=0.995, corr=-0.192) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.5375
[DBG][ep=072] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=072] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=072] mask(step0): mc_mean=0.2851 mb_mean=0.4695 norm_overlap=0.9907 corr_cb=-0.3589 topkJ=0.0210
[TRAIN][ep=072] loss=0.5445 acc=87.11%
[TRAIN][ep=072] mask_avg: mc_mean=0.2506 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1908
[EPOCH 072/089] train: loss=0.5445 acc=87.11% | val: loss=0.7214 acc=68.67% f1=75.00% auc=75.58% val_score=45.2126 val_score_bestthr=70.5375 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.251, mb=0.472, no=0.995, corr=-0.191) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.5375
[DBG][ep=073] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=073] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=073] mask(step0): mc_mean=0.2196 mb_mean=0.4733 norm_overlap=0.9936 corr_cb=-0.1930 topkJ=0.0406
[TRAIN][ep=073] loss=0.5437 acc=87.38%
[TRAIN][ep=073] mask_avg: mc_mean=0.2505 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1903
[EPOCH 073/089] train: loss=0.5437 acc=87.38% | val: loss=0.7190 acc=68.67% f1=75.00% auc=75.70% val_score=50.1335 val_score_bestthr=70.5375 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.251, mb=0.472, no=0.995, corr=-0.190) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.5375
[DBG][ep=074] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=074] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=074] mask(step0): mc_mean=0.2570 mb_mean=0.4701 norm_overlap=0.9939 corr_cb=-0.2075 topkJ=0.0352
[TRAIN][ep=074] loss=0.5397 acc=86.98%
[TRAIN][ep=074] mask_avg: mc_mean=0.2504 mb_mean=0.4721 norm_overlap=0.9950 corr_cb=-0.1881
[EPOCH 074/089] train: loss=0.5397 acc=86.98% | val: loss=0.7049 acc=66.27% f1=75.00% auc=75.99% val_score=53.9142 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.472, no=0.995, corr=-0.188) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.7981
[DBG][ep=075] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=075] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=075] mask(step0): mc_mean=0.2595 mb_mean=0.4685 norm_overlap=0.9933 corr_cb=-0.2627 topkJ=0.0309
[TRAIN][ep=075] loss=0.5402 acc=86.98%
[TRAIN][ep=075] mask_avg: mc_mean=0.2505 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1924
[EPOCH 075/089] train: loss=0.5402 acc=86.98% | val: loss=0.7520 acc=68.67% f1=75.00% auc=75.17% val_score=46.0653 val_score_bestthr=70.5375 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.251, mb=0.472, no=0.995, corr=-0.192) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.5375
[DBG][ep=076] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=076] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=076] mask(step0): mc_mean=0.2291 mb_mean=0.4755 norm_overlap=0.9959 corr_cb=-0.1493 topkJ=0.0388
[TRAIN][ep=076] loss=0.5400 acc=87.79%
[TRAIN][ep=076] mask_avg: mc_mean=0.2505 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1907
[EPOCH 076/089] train: loss=0.5400 acc=87.79% | val: loss=0.7297 acc=68.67% f1=75.00% auc=75.29% val_score=45.9830 val_score_bestthr=70.5375 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.472, no=0.995, corr=-0.191) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.5375
[DBG][ep=077] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=077] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=077] mask(step0): mc_mean=0.2714 mb_mean=0.4711 norm_overlap=0.9919 corr_cb=-0.3021 topkJ=0.0182
[TRAIN][ep=077] loss=0.5326 acc=88.59%
[TRAIN][ep=077] mask_avg: mc_mean=0.2505 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1929
[EPOCH 077/089] train: loss=0.5326 acc=88.59% | val: loss=0.7123 acc=66.27% f1=75.00% auc=75.99% val_score=53.9142 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.251, mb=0.472, no=0.995, corr=-0.193) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.7981
[DBG][ep=078] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=078] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=078] mask(step0): mc_mean=0.2246 mb_mean=0.4669 norm_overlap=0.9951 corr_cb=-0.2133 topkJ=0.0548
[TRAIN][ep=078] loss=0.5381 acc=87.38%
[TRAIN][ep=078] mask_avg: mc_mean=0.2506 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1935
[EPOCH 078/089] train: loss=0.5381 acc=87.38% | val: loss=0.7229 acc=68.67% f1=75.47% auc=75.81% val_score=48.6024 val_score_bestthr=68.0462 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.251, mb=0.472, no=0.995, corr=-0.193) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 68.0462
[DBG][ep=079] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=079] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=079] mask(step0): mc_mean=0.2881 mb_mean=0.4680 norm_overlap=0.9939 corr_cb=-0.2141 topkJ=0.0229
[TRAIN][ep=079] loss=0.5324 acc=88.19%
[TRAIN][ep=079] mask_avg: mc_mean=0.2505 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1878
[EPOCH 079/089] train: loss=0.5324 acc=88.19% | val: loss=0.7217 acc=66.27% f1=75.00% auc=75.93% val_score=49.4654 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.472, no=0.995, corr=-0.188) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.7981
[DBG][ep=080] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=080] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=080] mask(step0): mc_mean=0.2669 mb_mean=0.4747 norm_overlap=0.9935 corr_cb=-0.2501 topkJ=0.0168
[TRAIN][ep=080] loss=0.5340 acc=88.05%
[TRAIN][ep=080] mask_avg: mc_mean=0.2505 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1914
[EPOCH 080/089] train: loss=0.5340 acc=88.05% | val: loss=0.7270 acc=66.27% f1=75.00% auc=75.47% val_score=48.6024 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.472, no=0.995, corr=-0.191) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.7981
[DBG][ep=081] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=081] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=081] mask(step0): mc_mean=0.2443 mb_mean=0.4695 norm_overlap=0.9925 corr_cb=-0.2520 topkJ=0.0226
[TRAIN][ep=081] loss=0.5380 acc=87.79%
[TRAIN][ep=081] mask_avg: mc_mean=0.2505 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1938
[EPOCH 081/089] train: loss=0.5380 acc=87.79% | val: loss=0.7236 acc=68.67% f1=75.47% auc=75.99% val_score=60.1205 val_score_bestthr=68.0462 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.251, mb=0.472, no=0.995, corr=-0.194) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 68.0462
[DBG][ep=082] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=082] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=082] mask(step0): mc_mean=0.2566 mb_mean=0.4682 norm_overlap=0.9951 corr_cb=-0.2134 topkJ=0.0483
[TRAIN][ep=082] loss=0.5413 acc=86.04%
[TRAIN][ep=082] mask_avg: mc_mean=0.2505 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1907
[EPOCH 082/089] train: loss=0.5413 acc=86.04% | val: loss=0.7338 acc=66.27% f1=75.00% auc=75.47% val_score=48.6024 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.472, no=0.995, corr=-0.191) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.7981
[DBG][ep=083] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=083] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=083] mask(step0): mc_mean=0.2145 mb_mean=0.4737 norm_overlap=0.9945 corr_cb=-0.2096 topkJ=0.0227
[TRAIN][ep=083] loss=0.5299 acc=88.72%
[TRAIN][ep=083] mask_avg: mc_mean=0.2505 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1927
[EPOCH 083/089] train: loss=0.5299 acc=88.72% | val: loss=0.7518 acc=68.67% f1=75.47% auc=75.23% val_score=46.6347 val_score_bestthr=68.0462 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.472, no=0.995, corr=-0.193) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 68.0462
[DBG][ep=084] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=084] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=084] mask(step0): mc_mean=0.2639 mb_mean=0.4698 norm_overlap=0.9939 corr_cb=-0.2458 topkJ=0.0308
[TRAIN][ep=084] loss=0.5287 acc=87.79%
[TRAIN][ep=084] mask_avg: mc_mean=0.2505 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1891
[EPOCH 084/089] train: loss=0.5287 acc=87.79% | val: loss=0.7450 acc=66.27% f1=75.00% auc=75.35% val_score=45.9830 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.251, mb=0.472, no=0.995, corr=-0.189) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.7981
[DBG][ep=085] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=085] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=085] mask(step0): mc_mean=0.2406 mb_mean=0.4751 norm_overlap=0.9981 corr_cb=-0.0797 topkJ=0.0451
[TRAIN][ep=085] loss=0.5275 acc=88.05%
[TRAIN][ep=085] mask_avg: mc_mean=0.2505 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1916
[EPOCH 085/089] train: loss=0.5275 acc=88.05% | val: loss=0.7557 acc=66.27% f1=75.00% auc=75.12% val_score=45.9830 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.251, mb=0.472, no=0.995, corr=-0.192) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.7981
[DBG][ep=086] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=086] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=086] mask(step0): mc_mean=0.2812 mb_mean=0.4732 norm_overlap=0.9964 corr_cb=-0.1256 topkJ=0.0281
[TRAIN][ep=086] loss=0.5245 acc=88.46%
[TRAIN][ep=086] mask_avg: mc_mean=0.2505 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1894
[EPOCH 086/089] train: loss=0.5245 acc=88.46% | val: loss=0.7398 acc=66.27% f1=75.00% auc=75.35% val_score=48.6024 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.472, no=0.995, corr=-0.189) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.7981
[EARLY STOP] no improvement for 30 epochs. best_epoch=56
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
=============== FIT DONE ===============
[BEST] epoch=56 | val_acc=67.47% | val_f1=75.68% | val_auc=76.22% | val_score=48.4200 | val_score_bestthr=71.9014
[TEST@BEST] thr_used=0.510 | acc=61.84% f1=66.09% auc=65.59% | SP_sex=1.63% EO_sex=1.27% SP_age=11.90% EO_age=12.35%
[TIME] 1.88 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/summary_fold_0.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4732 mb_mean=0.4739 norm_overlap=1.0003 corr_cb=0.4202 topkJ=0.1261
[TRAIN][ep=000] loss=0.6955 acc=51.54%
[TRAIN][ep=000] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3729
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4746 mb_mean=0.4736 norm_overlap=1.0001 corr_cb=0.2526 topkJ=0.1426
[TRAIN][ep=001] loss=0.6932 acc=50.74%
[TRAIN][ep=001] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3696
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4719 mb_mean=0.4692 norm_overlap=1.0002 corr_cb=0.4403 topkJ=0.2099
[TRAIN][ep=002] loss=0.6920 acc=50.60%
[TRAIN][ep=002] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3688
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4696 mb_mean=0.4711 norm_overlap=1.0003 corr_cb=0.4991 topkJ=0.2274
[TRAIN][ep=003] loss=0.6903 acc=55.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3683
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4752 mb_mean=0.4728 norm_overlap=1.0003 corr_cb=0.4629 topkJ=0.1590
[TRAIN][ep=004] loss=0.6892 acc=52.21%
[TRAIN][ep=004] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3684
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4723 mb_mean=0.4722 norm_overlap=1.0002 corr_cb=0.3577 topkJ=0.1944
[TRAIN][ep=005] loss=0.6859 acc=55.17%
[TRAIN][ep=005] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3689
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4731 mb_mean=0.4733 norm_overlap=1.0004 corr_cb=0.5633 topkJ=0.1681
[TRAIN][ep=006] loss=0.6864 acc=57.45%
[TRAIN][ep=006] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3653
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4723 mb_mean=0.4718 norm_overlap=1.0002 corr_cb=0.4549 topkJ=0.1869
[TRAIN][ep=007] loss=0.6834 acc=58.39%
[TRAIN][ep=007] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3710
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4734 mb_mean=0.4747 norm_overlap=1.0002 corr_cb=0.3617 topkJ=0.1959
[TRAIN][ep=008] loss=0.6814 acc=59.46%
[TRAIN][ep=008] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3700
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4744 mb_mean=0.4729 norm_overlap=1.0001 corr_cb=0.3126 topkJ=0.0962
[TRAIN][ep=009] loss=0.6766 acc=59.33%
[TRAIN][ep=009] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3704
================= FIT START (fold=0) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4740 mb_mean=0.4722 norm_overlap=1.0002 corr_cb=0.3730 topkJ=0.1775
[TRAIN][ep=000] loss=0.6722 acc=61.74%
[TRAIN][ep=000] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3748
[EPOCH 000/089] train: loss=0.6722 acc=61.74% | val: loss=0.6833 acc=60.24% f1=63.74% auc=60.52% val_score=37.0937 val_score_bestthr=61.8943 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.375) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 61.8943
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4741 mb_mean=0.4758 norm_overlap=1.0000 corr_cb=0.0718 topkJ=0.1290
[TRAIN][ep=001] loss=0.6663 acc=59.60%
[TRAIN][ep=001] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3678
[EPOCH 001/089] train: loss=0.6663 acc=59.60% | val: loss=0.6970 acc=59.04% f1=63.83% auc=58.37% val_score=54.9121 val_score_bestthr=59.1945 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.368) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.8943 -> 59.1945
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4768 mb_mean=0.4754 norm_overlap=1.0002 corr_cb=0.3045 topkJ=0.2290
[TRAIN][ep=002] loss=0.6649 acc=61.21%
[TRAIN][ep=002] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3720
[EPOCH 002/089] train: loss=0.6649 acc=61.21% | val: loss=0.6742 acc=60.24% f1=64.52% auc=63.78% val_score=56.8472 val_score_bestthr=59.4427 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.372) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.8943 -> 59.4427
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4684 mb_mean=0.4694 norm_overlap=1.0003 corr_cb=0.5137 topkJ=0.2279
[TRAIN][ep=003] loss=0.6625 acc=62.95%
[TRAIN][ep=003] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3689
[EPOCH 003/089] train: loss=0.6625 acc=62.95% | val: loss=0.6673 acc=63.86% f1=66.67% auc=65.17% val_score=55.0292 val_score_bestthr=62.2240 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.369) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 61.8943 -> 62.2240
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4725 mb_mean=0.4704 norm_overlap=1.0002 corr_cb=0.4488 topkJ=0.1783
[TRAIN][ep=004] loss=0.6562 acc=64.16%
[TRAIN][ep=004] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3726
[EPOCH 004/089] train: loss=0.6562 acc=64.16% | val: loss=0.6846 acc=60.24% f1=63.74% auc=60.81% val_score=40.1125 val_score_bestthr=58.9269 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.373) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.2240 -> 58.9269
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4748 mb_mean=0.4735 norm_overlap=1.0001 corr_cb=0.2218 topkJ=0.0905
[TRAIN][ep=005] loss=1.4907 acc=62.15%
[TRAIN][ep=005] mask_avg: mc_mean=0.3905 mb_mean=0.4721 norm_overlap=1.0014 corr_cb=0.5389
[EPOCH 005/089] train: loss=1.4907 acc=62.15% | val: loss=0.6669 acc=68.67% f1=71.11% auc=66.69% val_score=47.1564 val_score_bestthr=64.3671 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.391, mb=0.472, no=1.001, corr=0.539) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 62.2240 -> 64.3671
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.3119 mb_mean=0.4730 norm_overlap=1.0015 corr_cb=0.3873 topkJ=0.2155
[TRAIN][ep=006] loss=1.4717 acc=62.82%
[TRAIN][ep=006] mask_avg: mc_mean=0.2852 mb_mean=0.4721 norm_overlap=1.0032 corr_cb=0.5061
[EPOCH 006/089] train: loss=1.4717 acc=62.82% | val: loss=0.6902 acc=60.24% f1=65.26% auc=61.74% val_score=50.2325 val_score_bestthr=58.0251 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.285, mb=0.472, no=1.003, corr=0.506) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 58.0251
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2523 mb_mean=0.4707 norm_overlap=1.0066 corr_cb=0.6452 topkJ=0.2153
[TRAIN][ep=007] loss=1.4687 acc=62.28%
[TRAIN][ep=007] mask_avg: mc_mean=0.2561 mb_mean=0.4721 norm_overlap=1.0036 corr_cb=0.4703
[EPOCH 007/089] train: loss=1.4687 acc=62.28% | val: loss=0.6562 acc=67.47% f1=69.66% auc=68.31% val_score=61.7986 val_score_bestthr=64.3484 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.256, mb=0.472, no=1.004, corr=0.470) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 64.3484
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2817 mb_mean=0.4760 norm_overlap=1.0020 corr_cb=0.3053 topkJ=0.1967
[TRAIN][ep=008] loss=1.4523 acc=64.97%
[TRAIN][ep=008] mask_avg: mc_mean=0.2413 mb_mean=0.4721 norm_overlap=1.0033 corr_cb=0.3795
[EPOCH 008/089] train: loss=1.4523 acc=64.97% | val: loss=0.6583 acc=67.47% f1=68.97% auc=66.92% val_score=45.4438 val_score_bestthr=62.6423 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.241, mb=0.472, no=1.003, corr=0.380) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 62.6423
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2195 mb_mean=0.4697 norm_overlap=1.0052 corr_cb=0.4745 topkJ=0.1636
[TRAIN][ep=009] loss=1.4445 acc=66.17%
[TRAIN][ep=009] mask_avg: mc_mean=0.2326 mb_mean=0.4721 norm_overlap=1.0031 corr_cb=0.3243
[EPOCH 009/089] train: loss=1.4445 acc=66.17% | val: loss=0.6983 acc=60.24% f1=65.26% auc=61.69% val_score=54.9121 val_score_bestthr=58.0251 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.233, mb=0.472, no=1.003, corr=0.324) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 58.0251
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.2355 mb_mean=0.4726 norm_overlap=1.0041 corr_cb=0.3937 topkJ=0.1049
[TRAIN][ep=010] loss=1.4526 acc=63.89%
[TRAIN][ep=010] mask_avg: mc_mean=0.2255 mb_mean=0.4721 norm_overlap=1.0028 corr_cb=0.2675
[EPOCH 010/089] train: loss=1.4526 acc=63.89% | val: loss=0.6458 acc=56.63% f1=70.49% auc=70.52% val_score=51.8684 val_score_bestthr=63.9539 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.225, mb=0.472, no=1.003, corr=0.267) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 63.9539
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.2360 mb_mean=0.4757 norm_overlap=1.0018 corr_cb=0.2220 topkJ=0.0723
[TRAIN][ep=011] loss=1.1980 acc=65.50%
[TRAIN][ep=011] mask_avg: mc_mean=0.2076 mb_mean=0.4721 norm_overlap=1.0027 corr_cb=0.2198
[EPOCH 011/089] train: loss=1.1980 acc=65.50% | val: loss=0.6382 acc=62.65% f1=69.90% auc=69.94% val_score=56.5677 val_score_bestthr=57.1596 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.208, mb=0.472, no=1.003, corr=0.220) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 57.1596
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.2036 mb_mean=0.4710 norm_overlap=1.0039 corr_cb=0.2805 topkJ=0.1237
[TRAIN][ep=012] loss=0.9493 acc=68.99%
[TRAIN][ep=012] mask_avg: mc_mean=0.2041 mb_mean=0.4721 norm_overlap=1.0018 corr_cb=0.1280
[EPOCH 012/089] train: loss=0.9493 acc=68.99% | val: loss=0.6369 acc=61.45% f1=69.23% auc=69.07% val_score=55.1103 val_score_bestthr=56.6039 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.204, mb=0.472, no=1.002, corr=0.128) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 56.6039
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.2347 mb_mean=0.4762 norm_overlap=0.9999 corr_cb=-0.0059 topkJ=0.0615
[TRAIN][ep=013] loss=0.8915 acc=68.19%
[TRAIN][ep=013] mask_avg: mc_mean=0.2101 mb_mean=0.4721 norm_overlap=1.0005 corr_cb=0.0298
[EPOCH 013/089] train: loss=0.8915 acc=68.19% | val: loss=0.6310 acc=65.06% f1=70.71% auc=69.36% val_score=55.6749 val_score_bestthr=58.7200 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.210, mb=0.472, no=1.001, corr=0.030) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 58.7200
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.2201 mb_mean=0.4743 norm_overlap=1.0008 corr_cb=0.0518 topkJ=0.0774
[TRAIN][ep=014] loss=0.8669 acc=71.28%
[TRAIN][ep=014] mask_avg: mc_mean=0.1990 mb_mean=0.4721 norm_overlap=0.9998 corr_cb=-0.0160
[EPOCH 014/089] train: loss=0.8669 acc=71.28% | val: loss=0.6276 acc=57.83% f1=71.07% auc=69.94% val_score=55.6749 val_score_bestthr=63.8258 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.199, mb=0.472, no=1.000, corr=-0.016) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 63.8258
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1501 mb_mean=0.4689 norm_overlap=1.0013 corr_cb=0.0597 topkJ=0.0448
[TRAIN][ep=015] loss=0.8603 acc=71.01%
[TRAIN][ep=015] mask_avg: mc_mean=0.1729 mb_mean=0.4721 norm_overlap=0.9999 corr_cb=-0.0127
[EPOCH 015/089] train: loss=0.8603 acc=71.01% | val: loss=0.6642 acc=57.83% f1=71.07% auc=67.91% val_score=51.1388 val_score_bestthr=63.8258 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.173, mb=0.472, no=1.000, corr=-0.013) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 63.8258
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1862 mb_mean=0.4714 norm_overlap=1.0020 corr_cb=0.0996 topkJ=0.0488
[TRAIN][ep=016] loss=0.8547 acc=71.54%
[TRAIN][ep=016] mask_avg: mc_mean=0.1794 mb_mean=0.4721 norm_overlap=0.9991 corr_cb=-0.0455
[EPOCH 016/089] train: loss=0.8547 acc=71.54% | val: loss=0.6189 acc=65.06% f1=71.29% auc=70.35% val_score=53.9218 val_score_bestthr=58.8239 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.179, mb=0.472, no=0.999, corr=-0.045) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 58.8239
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1977 mb_mean=0.4756 norm_overlap=0.9979 corr_cb=-0.1128 topkJ=0.0333
[TRAIN][ep=017] loss=0.8417 acc=71.41%
[TRAIN][ep=017] mask_avg: mc_mean=0.1799 mb_mean=0.4721 norm_overlap=0.9985 corr_cb=-0.0669
[EPOCH 017/089] train: loss=0.8417 acc=71.41% | val: loss=0.6211 acc=66.27% f1=71.43% auc=70.52% val_score=42.0368 val_score_bestthr=59.8302 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.180, mb=0.472, no=0.999, corr=-0.067) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 59.8302
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.2115 mb_mean=0.4736 norm_overlap=0.9971 corr_cb=-0.1456 topkJ=0.0197
[TRAIN][ep=018] loss=0.8376 acc=72.62%
[TRAIN][ep=018] mask_avg: mc_mean=0.2113 mb_mean=0.4721 norm_overlap=0.9972 corr_cb=-0.1300
[EPOCH 018/089] train: loss=0.8376 acc=72.62% | val: loss=0.6183 acc=66.27% f1=71.43% auc=72.38% val_score=49.0581 val_score_bestthr=59.8302 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.211, mb=0.472, no=0.997, corr=-0.130) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 59.8302
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1682 mb_mean=0.4748 norm_overlap=0.9931 corr_cb=-0.3075 topkJ=0.0084
[TRAIN][ep=019] loss=0.8292 acc=73.96%
[TRAIN][ep=019] mask_avg: mc_mean=0.1904 mb_mean=0.4721 norm_overlap=0.9977 corr_cb=-0.1099
[EPOCH 019/089] train: loss=0.8292 acc=73.96% | val: loss=0.5975 acc=65.06% f1=68.82% auc=72.73% val_score=42.0396 val_score_bestthr=60.0963 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.472, no=0.998, corr=-0.110) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 60.0963
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1050 mb_mean=0.4736 norm_overlap=1.0015 corr_cb=0.0400 topkJ=0.0342
[TRAIN][ep=020] loss=0.8293 acc=71.95%
[TRAIN][ep=020] mask_avg: mc_mean=0.1897 mb_mean=0.4721 norm_overlap=0.9974 corr_cb=-0.1150
[EPOCH 020/089] train: loss=0.8293 acc=71.95% | val: loss=0.6419 acc=66.27% f1=70.83% auc=70.81% val_score=56.2353 val_score_bestthr=60.9269 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.472, no=0.997, corr=-0.115) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 60.9269
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.1856 mb_mean=0.4700 norm_overlap=0.9969 corr_cb=-0.1291 topkJ=0.0358
[TRAIN][ep=021] loss=0.8314 acc=71.01%
[TRAIN][ep=021] mask_avg: mc_mean=0.2163 mb_mean=0.4721 norm_overlap=0.9967 corr_cb=-0.1436
[EPOCH 021/089] train: loss=0.8314 acc=71.01% | val: loss=0.6024 acc=67.47% f1=72.73% auc=73.55% val_score=50.1627 val_score_bestthr=62.7938 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.216, mb=0.472, no=0.997, corr=-0.144) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 62.7938
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1899 mb_mean=0.4722 norm_overlap=0.9980 corr_cb=-0.0738 topkJ=0.0359
[TRAIN][ep=022] loss=0.8116 acc=74.36%
[TRAIN][ep=022] mask_avg: mc_mean=0.1989 mb_mean=0.4721 norm_overlap=0.9971 corr_cb=-0.1216
[EPOCH 022/089] train: loss=0.8116 acc=74.36% | val: loss=0.6132 acc=66.27% f1=72.00% auc=71.92% val_score=52.9009 val_score_bestthr=61.6828 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.199, mb=0.472, no=0.997, corr=-0.122) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 61.6828
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1900 mb_mean=0.4728 norm_overlap=0.9966 corr_cb=-0.1350 topkJ=0.0376
[TRAIN][ep=023] loss=0.8063 acc=72.21%
[TRAIN][ep=023] mask_avg: mc_mean=0.2017 mb_mean=0.4721 norm_overlap=0.9967 corr_cb=-0.1294
[EPOCH 023/089] train: loss=0.8063 acc=72.21% | val: loss=0.5964 acc=67.47% f1=72.73% auc=74.94% val_score=55.7489 val_score_bestthr=63.3131 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.202, mb=0.472, no=0.997, corr=-0.129) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 63.3131
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2299 mb_mean=0.4734 norm_overlap=0.9984 corr_cb=-0.0674 topkJ=0.0433
[TRAIN][ep=024] loss=0.7955 acc=74.77%
[TRAIN][ep=024] mask_avg: mc_mean=0.2087 mb_mean=0.4721 norm_overlap=0.9960 corr_cb=-0.1575
[EPOCH 024/089] train: loss=0.7955 acc=74.77% | val: loss=0.6097 acc=67.47% f1=72.73% auc=73.02% val_score=50.5935 val_score_bestthr=62.7938 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.209, mb=0.472, no=0.996, corr=-0.158) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 62.7938
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1793 mb_mean=0.4715 norm_overlap=0.9999 corr_cb=-0.0027 topkJ=0.0386
[TRAIN][ep=025] loss=0.7858 acc=75.44%
[TRAIN][ep=025] mask_avg: mc_mean=0.2028 mb_mean=0.4721 norm_overlap=0.9964 corr_cb=-0.1376
[EPOCH 025/089] train: loss=0.7858 acc=75.44% | val: loss=0.5950 acc=63.86% f1=71.15% auc=74.01% val_score=55.5456 val_score_bestthr=61.2513 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.203, mb=0.472, no=0.996, corr=-0.138) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 61.2513
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1454 mb_mean=0.4765 norm_overlap=0.9969 corr_cb=-0.1167 topkJ=0.0453
[TRAIN][ep=026] loss=0.7819 acc=75.84%
[TRAIN][ep=026] mask_avg: mc_mean=0.1658 mb_mean=0.4721 norm_overlap=0.9975 corr_cb=-0.0918
[EPOCH 026/089] train: loss=0.7819 acc=75.84% | val: loss=0.5917 acc=57.83% f1=71.07% auc=73.72% val_score=44.1270 val_score_bestthr=63.8258 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.166, mb=0.472, no=0.998, corr=-0.092) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 63.8258
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.3203 mb_mean=0.4714 norm_overlap=0.9929 corr_cb=-0.3485 topkJ=0.0173
[TRAIN][ep=027] loss=0.7904 acc=74.63%
[TRAIN][ep=027] mask_avg: mc_mean=0.2082 mb_mean=0.4721 norm_overlap=0.9964 corr_cb=-0.1419
[EPOCH 027/089] train: loss=0.7904 acc=74.63% | val: loss=0.6185 acc=67.47% f1=72.73% auc=73.66% val_score=57.8015 val_score_bestthr=62.7938 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.208, mb=0.472, no=0.996, corr=-0.142) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 62.7938
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1681 mb_mean=0.4701 norm_overlap=0.9971 corr_cb=-0.0790 topkJ=0.0253
[TRAIN][ep=028] loss=0.7699 acc=75.44%
[TRAIN][ep=028] mask_avg: mc_mean=0.2058 mb_mean=0.4721 norm_overlap=0.9963 corr_cb=-0.1407
[EPOCH 028/089] train: loss=0.7699 acc=75.44% | val: loss=0.6406 acc=63.86% f1=71.15% auc=73.37% val_score=58.5426 val_score_bestthr=61.9239 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.206, mb=0.472, no=0.996, corr=-0.141) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 61.9239
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2116 mb_mean=0.4737 norm_overlap=0.9971 corr_cb=-0.1343 topkJ=0.0408
[TRAIN][ep=029] loss=0.7784 acc=74.63%
[TRAIN][ep=029] mask_avg: mc_mean=0.2120 mb_mean=0.4721 norm_overlap=0.9964 corr_cb=-0.1412
[EPOCH 029/089] train: loss=0.7784 acc=74.63% | val: loss=0.5834 acc=67.47% f1=72.73% auc=75.64% val_score=53.5782 val_score_bestthr=64.5305 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.212, mb=0.472, no=0.996, corr=-0.141) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 64.3671 -> 64.5305
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2186 mb_mean=0.4712 norm_overlap=0.9948 corr_cb=-0.1813 topkJ=0.0568
[TRAIN][ep=030] loss=0.8489 acc=75.97%
[TRAIN][ep=030] mask_avg: mc_mean=0.2057 mb_mean=0.4721 norm_overlap=0.9961 corr_cb=-0.1446
[EPOCH 030/089] train: loss=0.8489 acc=75.97% | val: loss=0.6129 acc=65.06% f1=71.84% auc=74.77% val_score=56.4907 val_score_bestthr=63.1539 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.206, mb=0.472, no=0.996, corr=-0.145) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.5305 -> 63.1539
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2057 mb_mean=0.4716 norm_overlap=0.9952 corr_cb=-0.1776 topkJ=0.0402
[TRAIN][ep=031] loss=0.9280 acc=77.58%
[TRAIN][ep=031] mask_avg: mc_mean=0.1896 mb_mean=0.4721 norm_overlap=0.9964 corr_cb=-0.1230
[EPOCH 031/089] train: loss=0.9280 acc=77.58% | val: loss=0.5904 acc=63.86% f1=72.73% auc=74.48% val_score=56.3349 val_score_bestthr=61.5939 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.190, mb=0.472, no=0.996, corr=-0.123) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.5305 -> 61.5939
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2192 mb_mean=0.4736 norm_overlap=0.9968 corr_cb=-0.1305 topkJ=0.0360
[TRAIN][ep=032] loss=1.0173 acc=75.97%
[TRAIN][ep=032] mask_avg: mc_mean=0.2105 mb_mean=0.4721 norm_overlap=0.9959 corr_cb=-0.1530
[EPOCH 032/089] train: loss=1.0173 acc=75.97% | val: loss=0.5982 acc=66.27% f1=72.00% auc=74.88% val_score=55.1934 val_score_bestthr=65.1695 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.210, mb=0.472, no=0.996, corr=-0.153) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 64.5305 -> 65.1695
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1403 mb_mean=0.4719 norm_overlap=0.9956 corr_cb=-0.1191 topkJ=0.0348
[TRAIN][ep=033] loss=1.1036 acc=75.44%
[TRAIN][ep=033] mask_avg: mc_mean=0.1935 mb_mean=0.4721 norm_overlap=0.9964 corr_cb=-0.1293
[EPOCH 033/089] train: loss=1.1036 acc=75.44% | val: loss=0.5856 acc=65.06% f1=72.38% auc=75.17% val_score=43.0532 val_score_bestthr=63.0938 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.193, mb=0.472, no=0.996, corr=-0.129) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1695 -> 63.0938
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1897 mb_mean=0.4724 norm_overlap=1.0008 corr_cb=0.0267 topkJ=0.1309
[TRAIN][ep=034] loss=1.1655 acc=78.12%
[TRAIN][ep=034] mask_avg: mc_mean=0.1920 mb_mean=0.4721 norm_overlap=0.9967 corr_cb=-0.1139
[EPOCH 034/089] train: loss=1.1655 acc=78.12% | val: loss=0.5874 acc=65.06% f1=71.29% auc=75.52% val_score=51.7490 val_score_bestthr=62.8433 | dyn(w_pfs=0.240, w_sup=0.240, w_csuf=0.200, stage2=False) | mask(mc=0.192, mb=0.472, no=0.997, corr=-0.114) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1695 -> 62.8433
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2457 mb_mean=0.4717 norm_overlap=1.0016 corr_cb=0.0524 topkJ=0.0527
[TRAIN][ep=035] loss=1.1903 acc=78.39%
[TRAIN][ep=035] mask_avg: mc_mean=0.2310 mb_mean=0.4721 norm_overlap=0.9956 corr_cb=-0.1668
[EPOCH 035/089] train: loss=1.1903 acc=78.39% | val: loss=0.6100 acc=65.06% f1=71.84% auc=75.52% val_score=59.7112 val_score_bestthr=64.2468 | dyn(w_pfs=0.280, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.231, mb=0.472, no=0.996, corr=-0.167) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1695 -> 64.2468
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2017 mb_mean=0.4719 norm_overlap=0.9965 corr_cb=-0.1028 topkJ=0.0383
[TRAIN][ep=036] loss=1.2191 acc=77.45%
[TRAIN][ep=036] mask_avg: mc_mean=0.2095 mb_mean=0.4721 norm_overlap=0.9967 corr_cb=-0.1180
[EPOCH 036/089] train: loss=1.2191 acc=77.45% | val: loss=0.6061 acc=67.47% f1=72.73% auc=77.15% val_score=62.3089 val_score_bestthr=65.7334 | dyn(w_pfs=0.320, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.209, mb=0.472, no=0.997, corr=-0.118) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 65.1695 -> 65.7334
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1904 mb_mean=0.4646 norm_overlap=0.9949 corr_cb=-0.1611 topkJ=0.0553
[TRAIN][ep=037] loss=1.2040 acc=78.52%
[TRAIN][ep=037] mask_avg: mc_mean=0.2008 mb_mean=0.4721 norm_overlap=0.9965 corr_cb=-0.1235
[EPOCH 037/089] train: loss=1.2040 acc=78.52% | val: loss=0.5939 acc=67.47% f1=75.23% auc=76.34% val_score=59.2673 val_score_bestthr=69.5180 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.201, mb=0.472, no=0.997, corr=-0.123) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 65.7334 -> 69.5180
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2247 mb_mean=0.4726 norm_overlap=0.9956 corr_cb=-0.1435 topkJ=0.0410
[TRAIN][ep=038] loss=1.1837 acc=79.73%
[TRAIN][ep=038] mask_avg: mc_mean=0.2147 mb_mean=0.4721 norm_overlap=0.9958 corr_cb=-0.1515
[EPOCH 038/089] train: loss=1.1837 acc=79.73% | val: loss=0.5944 acc=67.47% f1=75.23% auc=75.81% val_score=51.7490 val_score_bestthr=69.5180 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.215, mb=0.472, no=0.996, corr=-0.152) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.5180 -> 69.5180
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2013 mb_mean=0.4731 norm_overlap=0.9931 corr_cb=-0.2372 topkJ=0.0288
[TRAIN][ep=039] loss=1.1783 acc=80.40%
[TRAIN][ep=039] mask_avg: mc_mean=0.2354 mb_mean=0.4721 norm_overlap=0.9954 corr_cb=-0.1748
[EPOCH 039/089] train: loss=1.1783 acc=80.40% | val: loss=0.6176 acc=63.86% f1=71.70% auc=75.17% val_score=50.2470 val_score_bestthr=64.4243 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.235, mb=0.472, no=0.995, corr=-0.175) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.5180 -> 64.4243
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.2408 mb_mean=0.4759 norm_overlap=0.9927 corr_cb=-0.2942 topkJ=0.0183
[TRAIN][ep=040] loss=1.1654 acc=80.81%
[TRAIN][ep=040] mask_avg: mc_mean=0.2066 mb_mean=0.4721 norm_overlap=0.9958 corr_cb=-0.1464
[EPOCH 040/089] train: loss=1.1654 acc=80.81% | val: loss=0.6142 acc=66.27% f1=74.55% auc=75.70% val_score=48.7060 val_score_bestthr=68.7758 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.207, mb=0.472, no=0.996, corr=-0.146) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.5180 -> 68.7758
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.2602 mb_mean=0.4749 norm_overlap=0.9956 corr_cb=-0.1790 topkJ=0.0377
[TRAIN][ep=041] loss=1.1721 acc=79.87%
[TRAIN][ep=041] mask_avg: mc_mean=0.2329 mb_mean=0.4721 norm_overlap=0.9951 corr_cb=-0.1842
[EPOCH 041/089] train: loss=1.1721 acc=79.87% | val: loss=0.6341 acc=67.47% f1=75.68% auc=74.59% val_score=54.8852 val_score_bestthr=70.3941 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.233, mb=0.472, no=0.995, corr=-0.184) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 69.5180 -> 70.3941
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.2322 mb_mean=0.4719 norm_overlap=0.9963 corr_cb=-0.1607 topkJ=0.0339
[TRAIN][ep=042] loss=1.1592 acc=82.15%
[TRAIN][ep=042] mask_avg: mc_mean=0.2016 mb_mean=0.4721 norm_overlap=0.9965 corr_cb=-0.1222
[EPOCH 042/089] train: loss=1.1592 acc=82.15% | val: loss=0.6735 acc=66.27% f1=75.00% auc=74.53% val_score=55.1523 val_score_bestthr=70.5083 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.202, mb=0.472, no=0.996, corr=-0.122) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 70.3941 -> 70.5083
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.1929 mb_mean=0.4726 norm_overlap=0.9937 corr_cb=-0.1920 topkJ=0.0366
[TRAIN][ep=043] loss=1.1281 acc=83.49%
[TRAIN][ep=043] mask_avg: mc_mean=0.2418 mb_mean=0.4721 norm_overlap=0.9950 corr_cb=-0.1851
[EPOCH 043/089] train: loss=1.1281 acc=83.49% | val: loss=0.6099 acc=66.27% f1=74.55% auc=76.80% val_score=49.7516 val_score_bestthr=69.6309 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.242, mb=0.472, no=0.995, corr=-0.185) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5083 -> 69.6309
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2563 mb_mean=0.4690 norm_overlap=0.9944 corr_cb=-0.2174 topkJ=0.0291
[TRAIN][ep=044] loss=1.1442 acc=80.94%
[TRAIN][ep=044] mask_avg: mc_mean=0.2503 mb_mean=0.4721 norm_overlap=0.9950 corr_cb=-0.1930
[EPOCH 044/089] train: loss=1.1442 acc=80.94% | val: loss=0.6467 acc=66.27% f1=74.55% auc=76.63% val_score=59.9792 val_score_bestthr=67.2307 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.250, mb=0.472, no=0.995, corr=-0.193) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5083 -> 67.2307
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2145 mb_mean=0.4723 norm_overlap=0.9967 corr_cb=-0.1190 topkJ=0.0614
[TRAIN][ep=045] loss=1.1232 acc=83.09%
[TRAIN][ep=045] mask_avg: mc_mean=0.2338 mb_mean=0.4721 norm_overlap=0.9955 corr_cb=-0.1650
[EPOCH 045/089] train: loss=1.1232 acc=83.09% | val: loss=0.7249 acc=65.06% f1=73.87% auc=73.66% val_score=53.5260 val_score_bestthr=68.8906 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.234, mb=0.472, no=0.996, corr=-0.165) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5083 -> 68.8906
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.2338 mb_mean=0.4729 norm_overlap=0.9937 corr_cb=-0.2387 topkJ=0.0173
[TRAIN][ep=046] loss=1.1063 acc=83.62%
[TRAIN][ep=046] mask_avg: mc_mean=0.2498 mb_mean=0.4721 norm_overlap=0.9956 corr_cb=-0.1684
[EPOCH 046/089] train: loss=1.1063 acc=83.62% | val: loss=0.6583 acc=67.47% f1=75.23% auc=75.29% val_score=48.7060 val_score_bestthr=71.0832 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.250, mb=0.472, no=0.996, corr=-0.168) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 70.5083 -> 71.0832
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.2099 mb_mean=0.4700 norm_overlap=0.9957 corr_cb=-0.1580 topkJ=0.0431
[TRAIN][ep=047] loss=1.1014 acc=82.82%
[TRAIN][ep=047] mask_avg: mc_mean=0.2334 mb_mean=0.4721 norm_overlap=0.9954 corr_cb=-0.1638
[EPOCH 047/089] train: loss=1.1014 acc=82.82% | val: loss=0.6651 acc=66.27% f1=74.55% auc=75.47% val_score=50.2470 val_score_bestthr=70.2831 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.233, mb=0.472, no=0.995, corr=-0.164) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.0832 -> 70.2831
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.3215 mb_mean=0.4695 norm_overlap=0.9916 corr_cb=-0.3844 topkJ=0.0095
[TRAIN][ep=048] loss=1.1053 acc=83.36%
[TRAIN][ep=048] mask_avg: mc_mean=0.2583 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1960
[EPOCH 048/089] train: loss=1.1053 acc=83.36% | val: loss=0.6399 acc=68.67% f1=75.00% auc=75.52% val_score=54.4067 val_score_bestthr=70.5375 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.258, mb=0.472, no=0.995, corr=-0.196) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.0832 -> 70.5375
[DBG][ep=049] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.2554 mb_mean=0.4735 norm_overlap=0.9958 corr_cb=-0.1675 topkJ=0.0234
[TRAIN][ep=049] loss=1.0760 acc=85.23%
[TRAIN][ep=049] mask_avg: mc_mean=0.2431 mb_mean=0.4721 norm_overlap=0.9955 corr_cb=-0.1660
[EPOCH 049/089] train: loss=1.0760 acc=85.23% | val: loss=0.6434 acc=68.67% f1=75.00% auc=75.93% val_score=50.1193 val_score_bestthr=70.5375 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.243, mb=0.472, no=0.996, corr=-0.166) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.0832 -> 70.5375
[DBG][ep=050] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.2627 mb_mean=0.4713 norm_overlap=0.9909 corr_cb=-0.3458 topkJ=0.0098
[TRAIN][ep=050] loss=0.6438 acc=85.64%
[TRAIN][ep=050] mask_avg: mc_mean=0.2500 mb_mean=0.4721 norm_overlap=0.9947 corr_cb=-0.1936
[EPOCH 050/089] train: loss=0.6438 acc=85.64% | val: loss=0.6508 acc=66.27% f1=74.55% auc=75.58% val_score=46.7184 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.472, no=0.995, corr=-0.194) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.0832 -> 70.2831
[DBG][ep=051] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.2492 mb_mean=0.4781 norm_overlap=0.9937 corr_cb=-0.2414 topkJ=0.0207
[TRAIN][ep=051] loss=0.5721 acc=86.44%
[TRAIN][ep=051] mask_avg: mc_mean=0.2499 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1917
[EPOCH 051/089] train: loss=0.5721 acc=86.44% | val: loss=0.6705 acc=67.47% f1=75.23% auc=75.35% val_score=52.0125 val_score_bestthr=71.0832 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.472, no=0.995, corr=-0.192) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.0832 -> 71.0832
[DBG][ep=052] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.2599 mb_mean=0.4697 norm_overlap=0.9949 corr_cb=-0.1790 topkJ=0.0398
[TRAIN][ep=052] loss=0.5711 acc=86.44%
[TRAIN][ep=052] mask_avg: mc_mean=0.2500 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1876
[EPOCH 052/089] train: loss=0.5711 acc=86.44% | val: loss=0.6612 acc=67.47% f1=75.23% auc=75.52% val_score=50.1335 val_score_bestthr=71.0832 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.472, no=0.995, corr=-0.188) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.0832 -> 71.0832
[DBG][ep=053] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.2143 mb_mean=0.4687 norm_overlap=0.9951 corr_cb=-0.1953 topkJ=0.0300
[TRAIN][ep=053] loss=0.5693 acc=86.31%
[TRAIN][ep=053] mask_avg: mc_mean=0.2500 mb_mean=0.4721 norm_overlap=0.9947 corr_cb=-0.1921
[EPOCH 053/089] train: loss=0.5693 acc=86.31% | val: loss=0.6762 acc=66.27% f1=74.55% auc=75.47% val_score=49.2625 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.472, no=0.995, corr=-0.192) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.0832 -> 70.2831
[DBG][ep=054] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=054] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=054] mask(step0): mc_mean=0.2498 mb_mean=0.4716 norm_overlap=0.9982 corr_cb=-0.0688 topkJ=0.0499
[TRAIN][ep=054] loss=0.5680 acc=87.38%
[TRAIN][ep=054] mask_avg: mc_mean=0.2500 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1885
[EPOCH 054/089] train: loss=0.5680 acc=87.38% | val: loss=0.6787 acc=67.47% f1=75.23% auc=75.58% val_score=49.2625 val_score_bestthr=71.0832 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.472, no=0.995, corr=-0.188) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.0832 -> 71.0832
[DBG][ep=055] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=055] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=055] mask(step0): mc_mean=0.2429 mb_mean=0.4709 norm_overlap=0.9960 corr_cb=-0.1613 topkJ=0.0322
[TRAIN][ep=055] loss=0.5652 acc=86.31%
[TRAIN][ep=055] mask_avg: mc_mean=0.2499 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1867
[EPOCH 055/089] train: loss=0.5652 acc=86.31% | val: loss=0.6808 acc=67.47% f1=75.23% auc=75.52% val_score=49.2625 val_score_bestthr=71.0832 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.472, no=0.995, corr=-0.187) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.0832 -> 71.0832
[DBG][ep=056] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=056] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=056] mask(step0): mc_mean=0.2756 mb_mean=0.4722 norm_overlap=0.9935 corr_cb=-0.2337 topkJ=0.0340
[TRAIN][ep=056] loss=0.5627 acc=86.31%
[TRAIN][ep=056] mask_avg: mc_mean=0.2499 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1878
[EPOCH 056/089] train: loss=0.5627 acc=86.31% | val: loss=0.6714 acc=67.47% f1=75.68% auc=75.64% val_score=47.3737 val_score_bestthr=71.9014 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.472, no=0.995, corr=-0.188) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 71.0832 -> 71.9014
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=057] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=057] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=057] mask(step0): mc_mean=0.2485 mb_mean=0.4721 norm_overlap=0.9964 corr_cb=-0.1443 topkJ=0.0562
[TRAIN][ep=057] loss=0.5637 acc=86.71%
[TRAIN][ep=057] mask_avg: mc_mean=0.2500 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1912
[EPOCH 057/089] train: loss=0.5637 acc=86.71% | val: loss=0.6837 acc=67.47% f1=75.23% auc=75.58% val_score=50.1335 val_score_bestthr=71.0832 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.472, no=0.995, corr=-0.191) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 71.0832
[DBG][ep=058] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=058] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=058] mask(step0): mc_mean=0.3224 mb_mean=0.4710 norm_overlap=0.9936 corr_cb=-0.2621 topkJ=0.0270
[TRAIN][ep=058] loss=0.5585 acc=87.11%
[TRAIN][ep=058] mask_avg: mc_mean=0.2500 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1912
[EPOCH 058/089] train: loss=0.5585 acc=87.11% | val: loss=0.6896 acc=67.47% f1=75.23% auc=75.35% val_score=50.1335 val_score_bestthr=71.0832 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.472, no=0.995, corr=-0.191) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 71.0832
[DBG][ep=059] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=059] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=059] mask(step0): mc_mean=0.2524 mb_mean=0.4713 norm_overlap=0.9930 corr_cb=-0.2291 topkJ=0.0288
[TRAIN][ep=059] loss=0.5571 acc=86.85%
[TRAIN][ep=059] mask_avg: mc_mean=0.2500 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1908
[EPOCH 059/089] train: loss=0.5571 acc=86.85% | val: loss=0.7060 acc=66.27% f1=74.55% auc=75.41% val_score=47.1685 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.472, no=0.995, corr=-0.191) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.2831
[DBG][ep=060] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=060] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=060] mask(step0): mc_mean=0.2953 mb_mean=0.4667 norm_overlap=0.9904 corr_cb=-0.2941 topkJ=0.0200
[TRAIN][ep=060] loss=0.5536 acc=86.98%
[TRAIN][ep=060] mask_avg: mc_mean=0.2500 mb_mean=0.4721 norm_overlap=0.9950 corr_cb=-0.1868
[EPOCH 060/089] train: loss=0.5536 acc=86.98% | val: loss=0.6815 acc=66.27% f1=75.00% auc=75.76% val_score=46.7184 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.472, no=0.995, corr=-0.187) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.7981
[DBG][ep=061] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=061] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=061] mask(step0): mc_mean=0.2207 mb_mean=0.4745 norm_overlap=0.9956 corr_cb=-0.1728 topkJ=0.0407
[TRAIN][ep=061] loss=0.5527 acc=87.11%
[TRAIN][ep=061] mask_avg: mc_mean=0.2499 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1879
[EPOCH 061/089] train: loss=0.5527 acc=87.11% | val: loss=0.7338 acc=66.27% f1=74.55% auc=74.88% val_score=48.8217 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.472, no=0.995, corr=-0.188) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.2831
[DBG][ep=062] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=062] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=062] mask(step0): mc_mean=0.2635 mb_mean=0.4636 norm_overlap=0.9948 corr_cb=-0.2003 topkJ=0.0535
[TRAIN][ep=062] loss=0.5571 acc=87.25%
[TRAIN][ep=062] mask_avg: mc_mean=0.2499 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1863
[EPOCH 062/089] train: loss=0.5571 acc=87.25% | val: loss=0.7171 acc=66.27% f1=74.55% auc=75.29% val_score=44.5298 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.472, no=0.995, corr=-0.186) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.2831
[DBG][ep=063] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=063] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=063] mask(step0): mc_mean=0.2603 mb_mean=0.4693 norm_overlap=0.9969 corr_cb=-0.1305 topkJ=0.0621
[TRAIN][ep=063] loss=0.5512 acc=87.65%
[TRAIN][ep=063] mask_avg: mc_mean=0.2499 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1892
[EPOCH 063/089] train: loss=0.5512 acc=87.65% | val: loss=0.7236 acc=66.27% f1=74.55% auc=75.17% val_score=44.5298 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.472, no=0.995, corr=-0.189) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.2831
[DBG][ep=064] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=064] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=064] mask(step0): mc_mean=0.2582 mb_mean=0.4747 norm_overlap=0.9958 corr_cb=-0.1875 topkJ=0.0390
[TRAIN][ep=064] loss=0.5591 acc=85.50%
[TRAIN][ep=064] mask_avg: mc_mean=0.2500 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1912
[EPOCH 064/089] train: loss=0.5591 acc=85.50% | val: loss=0.6926 acc=68.67% f1=75.00% auc=75.64% val_score=49.4654 val_score_bestthr=70.5375 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.472, no=0.995, corr=-0.191) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.5375
[DBG][ep=065] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=065] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=065] mask(step0): mc_mean=0.2674 mb_mean=0.4721 norm_overlap=0.9931 corr_cb=-0.2625 topkJ=0.0176
[TRAIN][ep=065] loss=0.5513 acc=87.65%
[TRAIN][ep=065] mask_avg: mc_mean=0.2500 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1881
[EPOCH 065/089] train: loss=0.5513 acc=87.65% | val: loss=0.7022 acc=68.67% f1=75.00% auc=75.52% val_score=48.6024 val_score_bestthr=70.5375 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.472, no=0.995, corr=-0.188) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.5375
[DBG][ep=066] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=066] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=066] mask(step0): mc_mean=0.2243 mb_mean=0.4743 norm_overlap=0.9950 corr_cb=-0.1764 topkJ=0.0403
[TRAIN][ep=066] loss=0.5514 acc=86.98%
[TRAIN][ep=066] mask_avg: mc_mean=0.2500 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1885
[EPOCH 066/089] train: loss=0.5514 acc=86.98% | val: loss=0.7213 acc=69.88% f1=76.19% auc=75.17% val_score=42.6671 val_score_bestthr=70.3588 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.472, no=0.995, corr=-0.189) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.3588
[DBG][ep=067] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=067] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=067] mask(step0): mc_mean=0.2472 mb_mean=0.4704 norm_overlap=0.9939 corr_cb=-0.2448 topkJ=0.0264
[TRAIN][ep=067] loss=0.5446 acc=87.38%
[TRAIN][ep=067] mask_avg: mc_mean=0.2500 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1878
[EPOCH 067/089] train: loss=0.5446 acc=87.38% | val: loss=0.7066 acc=68.67% f1=75.00% auc=75.41% val_score=48.6024 val_score_bestthr=70.5375 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.472, no=0.995, corr=-0.188) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.5375
[DBG][ep=068] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=068] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=068] mask(step0): mc_mean=0.2255 mb_mean=0.4743 norm_overlap=0.9955 corr_cb=-0.1756 topkJ=0.0260
[TRAIN][ep=068] loss=0.5465 acc=87.25%
[TRAIN][ep=068] mask_avg: mc_mean=0.2500 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1881
[EPOCH 068/089] train: loss=0.5465 acc=87.25% | val: loss=0.7168 acc=67.47% f1=75.23% auc=75.35% val_score=50.1335 val_score_bestthr=71.0832 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.472, no=0.995, corr=-0.188) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 71.0832
[DBG][ep=069] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=069] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=069] mask(step0): mc_mean=0.2566 mb_mean=0.4699 norm_overlap=0.9914 corr_cb=-0.3334 topkJ=0.0233
[TRAIN][ep=069] loss=0.5415 acc=87.92%
[TRAIN][ep=069] mask_avg: mc_mean=0.2500 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1873
[EPOCH 069/089] train: loss=0.5415 acc=87.92% | val: loss=0.7106 acc=66.27% f1=75.00% auc=75.64% val_score=48.6024 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.472, no=0.995, corr=-0.187) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.7981
[DBG][ep=070] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=070] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=070] mask(step0): mc_mean=0.2474 mb_mean=0.4706 norm_overlap=0.9927 corr_cb=-0.2396 topkJ=0.0296
[TRAIN][ep=070] loss=0.5410 acc=88.19%
[TRAIN][ep=070] mask_avg: mc_mean=0.2500 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1859
[EPOCH 070/089] train: loss=0.5410 acc=88.19% | val: loss=0.7125 acc=66.27% f1=74.55% auc=75.35% val_score=48.6024 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.472, no=0.995, corr=-0.186) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.2831
[DBG][ep=071] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=071] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=071] mask(step0): mc_mean=0.2542 mb_mean=0.4724 norm_overlap=0.9916 corr_cb=-0.3294 topkJ=0.0213
[TRAIN][ep=071] loss=0.5423 acc=87.11%
[TRAIN][ep=071] mask_avg: mc_mean=0.2499 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1890
[EPOCH 071/089] train: loss=0.5423 acc=87.11% | val: loss=0.7839 acc=68.67% f1=75.00% auc=74.88% val_score=49.1470 val_score_bestthr=70.5375 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.472, no=0.995, corr=-0.189) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.5375
[DBG][ep=072] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=072] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=072] mask(step0): mc_mean=0.2849 mb_mean=0.4695 norm_overlap=0.9908 corr_cb=-0.3559 topkJ=0.0214
[TRAIN][ep=072] loss=0.5403 acc=88.19%
[TRAIN][ep=072] mask_avg: mc_mean=0.2500 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1879
[EPOCH 072/089] train: loss=0.5403 acc=88.19% | val: loss=0.7370 acc=66.27% f1=74.55% auc=75.00% val_score=43.2045 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.472, no=0.995, corr=-0.188) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.2831
[DBG][ep=073] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=073] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=073] mask(step0): mc_mean=0.2190 mb_mean=0.4733 norm_overlap=0.9937 corr_cb=-0.1916 topkJ=0.0406
[TRAIN][ep=073] loss=0.5389 acc=86.85%
[TRAIN][ep=073] mask_avg: mc_mean=0.2500 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1875
[EPOCH 073/089] train: loss=0.5389 acc=86.85% | val: loss=0.7350 acc=68.67% f1=75.00% auc=75.12% val_score=47.5125 val_score_bestthr=70.5375 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.472, no=0.995, corr=-0.188) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.5375
[DBG][ep=074] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=074] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=074] mask(step0): mc_mean=0.2556 mb_mean=0.4701 norm_overlap=0.9941 corr_cb=-0.2020 topkJ=0.0356
[TRAIN][ep=074] loss=0.5353 acc=87.25%
[TRAIN][ep=074] mask_avg: mc_mean=0.2499 mb_mean=0.4721 norm_overlap=0.9950 corr_cb=-0.1852
[EPOCH 074/089] train: loss=0.5353 acc=87.25% | val: loss=0.7199 acc=67.47% f1=75.23% auc=75.52% val_score=49.4654 val_score_bestthr=71.0832 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.472, no=0.995, corr=-0.185) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 71.0832
[DBG][ep=075] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=075] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=075] mask(step0): mc_mean=0.2591 mb_mean=0.4685 norm_overlap=0.9933 corr_cb=-0.2620 topkJ=0.0313
[TRAIN][ep=075] loss=0.5360 acc=87.38%
[TRAIN][ep=075] mask_avg: mc_mean=0.2500 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1897
[EPOCH 075/089] train: loss=0.5360 acc=87.38% | val: loss=0.7698 acc=66.27% f1=74.55% auc=74.88% val_score=44.5298 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.472, no=0.995, corr=-0.190) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.2831
[DBG][ep=076] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=076] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=076] mask(step0): mc_mean=0.2294 mb_mean=0.4755 norm_overlap=0.9960 corr_cb=-0.1439 topkJ=0.0388
[TRAIN][ep=076] loss=0.5356 acc=88.05%
[TRAIN][ep=076] mask_avg: mc_mean=0.2499 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1879
[EPOCH 076/089] train: loss=0.5356 acc=88.05% | val: loss=0.7449 acc=66.27% f1=74.55% auc=75.12% val_score=44.0892 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.472, no=0.995, corr=-0.188) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.2831
[DBG][ep=077] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=077] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=077] mask(step0): mc_mean=0.2706 mb_mean=0.4711 norm_overlap=0.9918 corr_cb=-0.3031 topkJ=0.0187
[TRAIN][ep=077] loss=0.5278 acc=89.26%
[TRAIN][ep=077] mask_avg: mc_mean=0.2500 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1901
[EPOCH 077/089] train: loss=0.5278 acc=89.26% | val: loss=0.7278 acc=66.27% f1=75.00% auc=75.29% val_score=49.4654 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.472, no=0.995, corr=-0.190) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.7981
[DBG][ep=078] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=078] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=078] mask(step0): mc_mean=0.2241 mb_mean=0.4669 norm_overlap=0.9952 corr_cb=-0.2110 topkJ=0.0544
[TRAIN][ep=078] loss=0.5341 acc=87.52%
[TRAIN][ep=078] mask_avg: mc_mean=0.2500 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1906
[EPOCH 078/089] train: loss=0.5341 acc=87.52% | val: loss=0.7375 acc=68.67% f1=75.47% auc=75.29% val_score=48.6024 val_score_bestthr=68.0462 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.472, no=0.995, corr=-0.191) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 68.0462
[DBG][ep=079] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=079] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=079] mask(step0): mc_mean=0.2881 mb_mean=0.4680 norm_overlap=0.9938 corr_cb=-0.2140 topkJ=0.0233
[TRAIN][ep=079] loss=0.5283 acc=88.59%
[TRAIN][ep=079] mask_avg: mc_mean=0.2500 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1849
[EPOCH 079/089] train: loss=0.5283 acc=88.59% | val: loss=0.7383 acc=68.67% f1=75.00% auc=75.29% val_score=48.6024 val_score_bestthr=70.5375 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.472, no=0.995, corr=-0.185) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.5375
[DBG][ep=080] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=080] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=080] mask(step0): mc_mean=0.2667 mb_mean=0.4747 norm_overlap=0.9935 corr_cb=-0.2484 topkJ=0.0168
[TRAIN][ep=080] loss=0.5298 acc=88.05%
[TRAIN][ep=080] mask_avg: mc_mean=0.2499 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1886
[EPOCH 080/089] train: loss=0.5298 acc=88.05% | val: loss=0.7427 acc=66.27% f1=75.00% auc=75.12% val_score=48.6024 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.472, no=0.995, corr=-0.189) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.7981
[DBG][ep=081] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=081] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=081] mask(step0): mc_mean=0.2444 mb_mean=0.4695 norm_overlap=0.9924 corr_cb=-0.2552 topkJ=0.0222
[TRAIN][ep=081] loss=0.5339 acc=87.79%
[TRAIN][ep=081] mask_avg: mc_mean=0.2500 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1910
[EPOCH 081/089] train: loss=0.5339 acc=87.79% | val: loss=0.7392 acc=68.67% f1=75.47% auc=75.23% val_score=53.5638 val_score_bestthr=68.0462 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.472, no=0.995, corr=-0.191) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 68.0462
[DBG][ep=082] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=082] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=082] mask(step0): mc_mean=0.2557 mb_mean=0.4682 norm_overlap=0.9952 corr_cb=-0.2082 topkJ=0.0487
[TRAIN][ep=082] loss=0.5365 acc=85.91%
[TRAIN][ep=082] mask_avg: mc_mean=0.2500 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1879
[EPOCH 082/089] train: loss=0.5365 acc=85.91% | val: loss=0.7495 acc=66.27% f1=75.00% auc=75.17% val_score=48.6024 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.472, no=0.995, corr=-0.188) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.7981
[DBG][ep=083] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=083] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=083] mask(step0): mc_mean=0.2136 mb_mean=0.4737 norm_overlap=0.9946 corr_cb=-0.2025 topkJ=0.0227
[TRAIN][ep=083] loss=0.5261 acc=88.99%
[TRAIN][ep=083] mask_avg: mc_mean=0.2500 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1900
[EPOCH 083/089] train: loss=0.5261 acc=88.99% | val: loss=0.7742 acc=67.47% f1=74.77% auc=75.00% val_score=44.0892 val_score_bestthr=68.6885 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.472, no=0.995, corr=-0.190) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 68.6885
[DBG][ep=084] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=084] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=084] mask(step0): mc_mean=0.2627 mb_mean=0.4698 norm_overlap=0.9940 corr_cb=-0.2397 topkJ=0.0321
[TRAIN][ep=084] loss=0.5243 acc=88.46%
[TRAIN][ep=084] mask_avg: mc_mean=0.2500 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1863
[EPOCH 084/089] train: loss=0.5243 acc=88.46% | val: loss=0.7639 acc=66.27% f1=75.00% auc=75.12% val_score=45.9830 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.472, no=0.995, corr=-0.186) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.7981
[DBG][ep=085] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=085] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=085] mask(step0): mc_mean=0.2402 mb_mean=0.4751 norm_overlap=0.9982 corr_cb=-0.0772 topkJ=0.0469
[TRAIN][ep=085] loss=0.5230 acc=88.86%
[TRAIN][ep=085] mask_avg: mc_mean=0.2500 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1887
[EPOCH 085/089] train: loss=0.5230 acc=88.86% | val: loss=0.7744 acc=67.47% f1=74.77% auc=75.00% val_score=44.0892 val_score_bestthr=68.6885 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.472, no=0.995, corr=-0.189) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 68.6885
[DBG][ep=086] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=086] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=086] mask(step0): mc_mean=0.2810 mb_mean=0.4732 norm_overlap=0.9964 corr_cb=-0.1266 topkJ=0.0268
[TRAIN][ep=086] loss=0.5209 acc=88.99%
[TRAIN][ep=086] mask_avg: mc_mean=0.2499 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1866
[EPOCH 086/089] train: loss=0.5209 acc=88.99% | val: loss=0.7577 acc=66.27% f1=75.00% auc=75.06% val_score=48.6024 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.472, no=0.995, corr=-0.187) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.7981
[EARLY STOP] no improvement for 30 epochs. best_epoch=56
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
=============== FIT DONE ===============
[BEST] epoch=56 | val_acc=67.47% | val_f1=75.68% | val_auc=75.64% | val_score=47.3737 | val_score_bestthr=71.9014
[TEST@BEST] thr_used=0.310 | acc=61.84% f1=69.96% auc=65.46% | SP_sex=5.00% EO_sex=3.27% SP_age=9.70% EO_age=17.21%
[TIME] 2.08 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/summary_fold_0.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4732 mb_mean=0.4739 norm_overlap=1.0003 corr_cb=0.4202 topkJ=0.1261
[TRAIN][ep=000] loss=0.6955 acc=51.54%
[TRAIN][ep=000] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3729
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4746 mb_mean=0.4736 norm_overlap=1.0001 corr_cb=0.2526 topkJ=0.1426
[TRAIN][ep=001] loss=0.6932 acc=50.74%
[TRAIN][ep=001] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3696
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4719 mb_mean=0.4692 norm_overlap=1.0002 corr_cb=0.4403 topkJ=0.2099
[TRAIN][ep=002] loss=0.6920 acc=50.60%
[TRAIN][ep=002] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3688
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4696 mb_mean=0.4711 norm_overlap=1.0003 corr_cb=0.4991 topkJ=0.2274
[TRAIN][ep=003] loss=0.6903 acc=55.57%
[TRAIN][ep=003] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3683
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4752 mb_mean=0.4728 norm_overlap=1.0003 corr_cb=0.4629 topkJ=0.1590
[TRAIN][ep=004] loss=0.6892 acc=52.21%
[TRAIN][ep=004] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3684
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4723 mb_mean=0.4722 norm_overlap=1.0002 corr_cb=0.3577 topkJ=0.1944
[TRAIN][ep=005] loss=0.6859 acc=55.17%
[TRAIN][ep=005] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3689
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4731 mb_mean=0.4733 norm_overlap=1.0004 corr_cb=0.5633 topkJ=0.1681
[TRAIN][ep=006] loss=0.6864 acc=57.45%
[TRAIN][ep=006] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3653
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4723 mb_mean=0.4718 norm_overlap=1.0002 corr_cb=0.4549 topkJ=0.1869
[TRAIN][ep=007] loss=0.6834 acc=58.39%
[TRAIN][ep=007] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3710
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4734 mb_mean=0.4747 norm_overlap=1.0002 corr_cb=0.3617 topkJ=0.1959
[TRAIN][ep=008] loss=0.6814 acc=59.46%
[TRAIN][ep=008] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3700
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4744 mb_mean=0.4729 norm_overlap=1.0001 corr_cb=0.3126 topkJ=0.0962
[TRAIN][ep=009] loss=0.6766 acc=59.33%
[TRAIN][ep=009] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3704
================= FIT START (fold=0) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4740 mb_mean=0.4722 norm_overlap=1.0002 corr_cb=0.3730 topkJ=0.1775
[TRAIN][ep=000] loss=0.6722 acc=61.61%
[TRAIN][ep=000] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3748
[EPOCH 000/089] train: loss=0.6722 acc=61.61% | val: loss=0.6833 acc=60.24% f1=63.74% auc=60.52% val_score=37.0937 val_score_bestthr=61.8943 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.375) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 61.8943
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4741 mb_mean=0.4758 norm_overlap=1.0000 corr_cb=0.0718 topkJ=0.1290
[TRAIN][ep=001] loss=0.6663 acc=59.60%
[TRAIN][ep=001] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3678
[EPOCH 001/089] train: loss=0.6663 acc=59.60% | val: loss=0.6968 acc=57.83% f1=63.16% auc=58.26% val_score=54.9121 val_score_bestthr=56.8889 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.368) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.8943 -> 56.8889
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4768 mb_mean=0.4754 norm_overlap=1.0002 corr_cb=0.3045 topkJ=0.2290
[TRAIN][ep=002] loss=0.6649 acc=61.21%
[TRAIN][ep=002] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3720
[EPOCH 002/089] train: loss=0.6649 acc=61.21% | val: loss=0.6742 acc=61.45% f1=65.96% auc=63.84% val_score=56.8472 val_score_bestthr=61.2333 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.372) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.8943 -> 61.2333
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4684 mb_mean=0.4694 norm_overlap=1.0003 corr_cb=0.5137 topkJ=0.2279
[TRAIN][ep=003] loss=0.6626 acc=62.82%
[TRAIN][ep=003] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3689
[EPOCH 003/089] train: loss=0.6626 acc=62.82% | val: loss=0.6674 acc=63.86% f1=66.67% auc=65.12% val_score=55.0292 val_score_bestthr=62.2240 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.369) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 61.8943 -> 62.2240
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4725 mb_mean=0.4704 norm_overlap=1.0002 corr_cb=0.4488 topkJ=0.1783
[TRAIN][ep=004] loss=0.6563 acc=64.30%
[TRAIN][ep=004] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3726
[EPOCH 004/089] train: loss=0.6563 acc=64.30% | val: loss=0.6847 acc=60.24% f1=63.74% auc=60.87% val_score=40.1125 val_score_bestthr=58.9269 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.373) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.2240 -> 58.9269
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4748 mb_mean=0.4735 norm_overlap=1.0001 corr_cb=0.2218 topkJ=0.0905
[TRAIN][ep=005] loss=1.2510 acc=61.74%
[TRAIN][ep=005] mask_avg: mc_mean=0.3877 mb_mean=0.4721 norm_overlap=1.0015 corr_cb=0.5384
[EPOCH 005/089] train: loss=1.2510 acc=61.74% | val: loss=0.6670 acc=69.88% f1=71.91% auc=66.92% val_score=47.1564 val_score_bestthr=65.4888 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.388, mb=0.472, no=1.001, corr=0.538) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 62.2240 -> 65.4888
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.3084 mb_mean=0.4730 norm_overlap=1.0015 corr_cb=0.3851 topkJ=0.2132
[TRAIN][ep=006] loss=1.2393 acc=62.95%
[TRAIN][ep=006] mask_avg: mc_mean=0.2831 mb_mean=0.4721 norm_overlap=1.0032 corr_cb=0.5037
[EPOCH 006/089] train: loss=1.2393 acc=62.95% | val: loss=0.6889 acc=59.04% f1=64.58% auc=61.86% val_score=50.2325 val_score_bestthr=56.9212 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.283, mb=0.472, no=1.003, corr=0.504) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4888 -> 56.9212
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2514 mb_mean=0.4707 norm_overlap=1.0066 corr_cb=0.6425 topkJ=0.2148
[TRAIN][ep=007] loss=1.2366 acc=62.15%
[TRAIN][ep=007] mask_avg: mc_mean=0.2554 mb_mean=0.4721 norm_overlap=1.0036 corr_cb=0.4670
[EPOCH 007/089] train: loss=1.2366 acc=62.15% | val: loss=0.6560 acc=67.47% f1=69.66% auc=68.37% val_score=61.7986 val_score_bestthr=64.3484 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.255, mb=0.472, no=1.004, corr=0.467) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4888 -> 64.3484
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2813 mb_mean=0.4760 norm_overlap=1.0019 corr_cb=0.3003 topkJ=0.1955
[TRAIN][ep=008] loss=1.2205 acc=65.10%
[TRAIN][ep=008] mask_avg: mc_mean=0.2410 mb_mean=0.4721 norm_overlap=1.0033 corr_cb=0.3733
[EPOCH 008/089] train: loss=1.2205 acc=65.10% | val: loss=0.6568 acc=67.47% f1=68.97% auc=67.27% val_score=43.5647 val_score_bestthr=62.6423 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.241, mb=0.472, no=1.003, corr=0.373) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4888 -> 62.6423
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2186 mb_mean=0.4697 norm_overlap=1.0051 corr_cb=0.4697 topkJ=0.1604
[TRAIN][ep=009] loss=1.2127 acc=66.44%
[TRAIN][ep=009] mask_avg: mc_mean=0.2319 mb_mean=0.4721 norm_overlap=1.0031 corr_cb=0.3196
[EPOCH 009/089] train: loss=1.2127 acc=66.44% | val: loss=0.6978 acc=61.45% f1=65.96% auc=61.51% val_score=52.2235 val_score_bestthr=60.3341 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.232, mb=0.472, no=1.003, corr=0.320) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4888 -> 60.3341
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.2347 mb_mean=0.4726 norm_overlap=1.0041 corr_cb=0.3887 topkJ=0.1044
[TRAIN][ep=010] loss=1.2215 acc=63.76%
[TRAIN][ep=010] mask_avg: mc_mean=0.2251 mb_mean=0.4721 norm_overlap=1.0028 corr_cb=0.2629
[EPOCH 010/089] train: loss=1.2215 acc=63.76% | val: loss=0.6455 acc=56.63% f1=70.49% auc=70.70% val_score=51.8684 val_score_bestthr=63.9539 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.225, mb=0.472, no=1.003, corr=0.263) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4888 -> 63.9539
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.2354 mb_mean=0.4757 norm_overlap=1.0017 corr_cb=0.2175 topkJ=0.0719
[TRAIN][ep=011] loss=1.0018 acc=65.50%
[TRAIN][ep=011] mask_avg: mc_mean=0.2067 mb_mean=0.4721 norm_overlap=1.0027 corr_cb=0.2166
[EPOCH 011/089] train: loss=1.0018 acc=65.50% | val: loss=0.6384 acc=63.86% f1=70.59% auc=69.83% val_score=54.2493 val_score_bestthr=59.4672 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.207, mb=0.472, no=1.003, corr=0.217) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4888 -> 59.4672
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.2043 mb_mean=0.4710 norm_overlap=1.0038 corr_cb=0.2733 topkJ=0.1202
[TRAIN][ep=012] loss=0.7884 acc=68.99%
[TRAIN][ep=012] mask_avg: mc_mean=0.2030 mb_mean=0.4721 norm_overlap=1.0018 corr_cb=0.1252
[EPOCH 012/089] train: loss=0.7884 acc=68.99% | val: loss=0.6371 acc=61.45% f1=69.23% auc=69.13% val_score=53.9989 val_score_bestthr=56.6039 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.203, mb=0.472, no=1.002, corr=0.125) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4888 -> 56.6039
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.2348 mb_mean=0.4762 norm_overlap=0.9999 corr_cb=-0.0089 topkJ=0.0592
[TRAIN][ep=013] loss=0.7482 acc=68.19%
[TRAIN][ep=013] mask_avg: mc_mean=0.2103 mb_mean=0.4721 norm_overlap=1.0005 corr_cb=0.0266
[EPOCH 013/089] train: loss=0.7482 acc=68.19% | val: loss=0.6314 acc=63.86% f1=70.00% auc=69.24% val_score=57.2365 val_score_bestthr=57.6120 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.210, mb=0.472, no=1.000, corr=0.027) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4888 -> 57.6120
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.2199 mb_mean=0.4743 norm_overlap=1.0008 corr_cb=0.0501 topkJ=0.0769
[TRAIN][ep=014] loss=0.7238 acc=71.14%
[TRAIN][ep=014] mask_avg: mc_mean=0.1995 mb_mean=0.4721 norm_overlap=0.9998 corr_cb=-0.0186
[EPOCH 014/089] train: loss=0.7238 acc=71.14% | val: loss=0.6272 acc=65.06% f1=70.71% auc=70.06% val_score=55.6749 val_score_bestthr=58.7200 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.200, mb=0.472, no=1.000, corr=-0.019) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4888 -> 58.7200
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1490 mb_mean=0.4689 norm_overlap=1.0013 corr_cb=0.0594 topkJ=0.0448
[TRAIN][ep=015] loss=0.7176 acc=71.01%
[TRAIN][ep=015] mask_avg: mc_mean=0.1725 mb_mean=0.4721 norm_overlap=0.9999 corr_cb=-0.0134
[EPOCH 015/089] train: loss=0.7176 acc=71.01% | val: loss=0.6624 acc=57.83% f1=71.07% auc=67.85% val_score=51.1388 val_score_bestthr=63.8258 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.173, mb=0.472, no=1.000, corr=-0.013) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4888 -> 63.8258
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1864 mb_mean=0.4714 norm_overlap=1.0019 corr_cb=0.0980 topkJ=0.0488
[TRAIN][ep=016] loss=0.7122 acc=71.41%
[TRAIN][ep=016] mask_avg: mc_mean=0.1796 mb_mean=0.4721 norm_overlap=0.9991 corr_cb=-0.0469
[EPOCH 016/089] train: loss=0.7122 acc=71.41% | val: loss=0.6189 acc=63.86% f1=70.59% auc=70.41% val_score=54.7723 val_score_bestthr=59.4672 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.180, mb=0.472, no=0.999, corr=-0.047) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4888 -> 59.4672
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1968 mb_mean=0.4756 norm_overlap=0.9979 corr_cb=-0.1118 topkJ=0.0329
[TRAIN][ep=017] loss=0.6995 acc=71.41%
[TRAIN][ep=017] mask_avg: mc_mean=0.1799 mb_mean=0.4721 norm_overlap=0.9985 corr_cb=-0.0680
[EPOCH 017/089] train: loss=0.6995 acc=71.41% | val: loss=0.6215 acc=57.83% f1=71.07% auc=70.70% val_score=42.0368 val_score_bestthr=63.8258 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.180, mb=0.472, no=0.999, corr=-0.068) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4888 -> 63.8258
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.2101 mb_mean=0.4736 norm_overlap=0.9971 corr_cb=-0.1441 topkJ=0.0197
[TRAIN][ep=018] loss=0.6957 acc=72.48%
[TRAIN][ep=018] mask_avg: mc_mean=0.2113 mb_mean=0.4721 norm_overlap=0.9971 corr_cb=-0.1310
[EPOCH 018/089] train: loss=0.6957 acc=72.48% | val: loss=0.6189 acc=66.27% f1=71.43% auc=72.27% val_score=49.0581 val_score_bestthr=59.8302 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.211, mb=0.472, no=0.997, corr=-0.131) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4888 -> 59.8302
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1685 mb_mean=0.4748 norm_overlap=0.9931 corr_cb=-0.3087 topkJ=0.0084
[TRAIN][ep=019] loss=0.6877 acc=73.83%
[TRAIN][ep=019] mask_avg: mc_mean=0.1906 mb_mean=0.4721 norm_overlap=0.9977 corr_cb=-0.1113
[EPOCH 019/089] train: loss=0.6877 acc=73.83% | val: loss=0.5978 acc=65.06% f1=69.47% auc=72.73% val_score=42.0396 val_score_bestthr=60.2117 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.191, mb=0.472, no=0.998, corr=-0.111) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4888 -> 60.2117
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1056 mb_mean=0.4736 norm_overlap=1.0014 corr_cb=0.0388 topkJ=0.0342
[TRAIN][ep=020] loss=0.6879 acc=71.54%
[TRAIN][ep=020] mask_avg: mc_mean=0.1895 mb_mean=0.4721 norm_overlap=0.9974 corr_cb=-0.1162
[EPOCH 020/089] train: loss=0.6879 acc=71.54% | val: loss=0.6417 acc=66.27% f1=70.83% auc=70.58% val_score=56.2353 val_score_bestthr=60.9269 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.189, mb=0.472, no=0.997, corr=-0.116) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4888 -> 60.9269
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.1860 mb_mean=0.4700 norm_overlap=0.9968 corr_cb=-0.1322 topkJ=0.0358
[TRAIN][ep=021] loss=0.6903 acc=71.01%
[TRAIN][ep=021] mask_avg: mc_mean=0.2170 mb_mean=0.4721 norm_overlap=0.9966 corr_cb=-0.1465
[EPOCH 021/089] train: loss=0.6903 acc=71.01% | val: loss=0.6032 acc=67.47% f1=72.73% auc=73.66% val_score=47.4146 val_score_bestthr=62.7938 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.217, mb=0.472, no=0.997, corr=-0.147) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4888 -> 62.7938
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1869 mb_mean=0.4722 norm_overlap=0.9980 corr_cb=-0.0710 topkJ=0.0359
[TRAIN][ep=022] loss=0.6708 acc=74.09%
[TRAIN][ep=022] mask_avg: mc_mean=0.1976 mb_mean=0.4721 norm_overlap=0.9971 corr_cb=-0.1217
[EPOCH 022/089] train: loss=0.6708 acc=74.09% | val: loss=0.6136 acc=66.27% f1=72.00% auc=71.92% val_score=52.9009 val_score_bestthr=61.6828 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.198, mb=0.472, no=0.997, corr=-0.122) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4888 -> 61.6828
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1894 mb_mean=0.4728 norm_overlap=0.9965 corr_cb=-0.1371 topkJ=0.0363
[TRAIN][ep=023] loss=0.6651 acc=72.62%
[TRAIN][ep=023] mask_avg: mc_mean=0.2007 mb_mean=0.4721 norm_overlap=0.9967 corr_cb=-0.1304
[EPOCH 023/089] train: loss=0.6651 acc=72.62% | val: loss=0.5972 acc=67.47% f1=72.73% auc=74.94% val_score=55.7489 val_score_bestthr=63.3131 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.201, mb=0.472, no=0.997, corr=-0.130) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4888 -> 63.3131
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2286 mb_mean=0.4734 norm_overlap=0.9983 corr_cb=-0.0676 topkJ=0.0433
[TRAIN][ep=024] loss=0.6555 acc=74.77%
[TRAIN][ep=024] mask_avg: mc_mean=0.2076 mb_mean=0.4721 norm_overlap=0.9959 corr_cb=-0.1580
[EPOCH 024/089] train: loss=0.6555 acc=74.77% | val: loss=0.6106 acc=66.27% f1=71.43% auc=72.97% val_score=50.5935 val_score_bestthr=61.5802 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.208, mb=0.472, no=0.996, corr=-0.158) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4888 -> 61.5802
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1793 mb_mean=0.4715 norm_overlap=0.9998 corr_cb=-0.0053 topkJ=0.0386
[TRAIN][ep=025] loss=0.6464 acc=75.44%
[TRAIN][ep=025] mask_avg: mc_mean=0.2024 mb_mean=0.4721 norm_overlap=0.9963 corr_cb=-0.1393
[EPOCH 025/089] train: loss=0.6464 acc=75.44% | val: loss=0.5960 acc=65.06% f1=71.84% auc=73.90% val_score=55.5456 val_score_bestthr=63.1539 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.202, mb=0.472, no=0.996, corr=-0.139) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4888 -> 63.1539
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1445 mb_mean=0.4765 norm_overlap=0.9969 corr_cb=-0.1175 topkJ=0.0449
[TRAIN][ep=026] loss=0.6428 acc=75.84%
[TRAIN][ep=026] mask_avg: mc_mean=0.1642 mb_mean=0.4721 norm_overlap=0.9975 corr_cb=-0.0917
[EPOCH 026/089] train: loss=0.6428 acc=75.84% | val: loss=0.5931 acc=57.83% f1=71.07% auc=73.55% val_score=44.1270 val_score_bestthr=63.8258 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.164, mb=0.472, no=0.998, corr=-0.092) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4888 -> 63.8258
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.3192 mb_mean=0.4714 norm_overlap=0.9929 corr_cb=-0.3494 topkJ=0.0169
[TRAIN][ep=027] loss=0.6519 acc=74.63%
[TRAIN][ep=027] mask_avg: mc_mean=0.2082 mb_mean=0.4721 norm_overlap=0.9963 corr_cb=-0.1440
[EPOCH 027/089] train: loss=0.6519 acc=74.63% | val: loss=0.6197 acc=67.47% f1=72.73% auc=73.66% val_score=57.8015 val_score_bestthr=62.7938 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.208, mb=0.472, no=0.996, corr=-0.144) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4888 -> 62.7938
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1665 mb_mean=0.4701 norm_overlap=0.9972 corr_cb=-0.0766 topkJ=0.0257
[TRAIN][ep=028] loss=0.6328 acc=75.30%
[TRAIN][ep=028] mask_avg: mc_mean=0.2051 mb_mean=0.4721 norm_overlap=0.9962 corr_cb=-0.1418
[EPOCH 028/089] train: loss=0.6328 acc=75.30% | val: loss=0.6435 acc=63.86% f1=71.15% auc=73.02% val_score=58.5426 val_score_bestthr=61.9239 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.205, mb=0.472, no=0.996, corr=-0.142) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4888 -> 61.9239
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2103 mb_mean=0.4737 norm_overlap=0.9971 corr_cb=-0.1361 topkJ=0.0408
[TRAIN][ep=029] loss=0.6416 acc=74.77%
[TRAIN][ep=029] mask_avg: mc_mean=0.2111 mb_mean=0.4721 norm_overlap=0.9964 corr_cb=-0.1421
[EPOCH 029/089] train: loss=0.6416 acc=74.77% | val: loss=0.5855 acc=66.27% f1=72.55% auc=75.17% val_score=53.5782 val_score_bestthr=63.5006 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.211, mb=0.472, no=0.996, corr=-0.142) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4888 -> 63.5006
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2152 mb_mean=0.4712 norm_overlap=0.9948 corr_cb=-0.1786 topkJ=0.0572
[TRAIN][ep=030] loss=0.6152 acc=75.97%
[TRAIN][ep=030] mask_avg: mc_mean=0.2110 mb_mean=0.4721 norm_overlap=0.9959 corr_cb=-0.1521
[EPOCH 030/089] train: loss=0.6152 acc=75.97% | val: loss=0.6146 acc=66.27% f1=72.00% auc=74.65% val_score=57.8015 val_score_bestthr=61.6828 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.211, mb=0.472, no=0.996, corr=-0.152) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4888 -> 61.6828
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2104 mb_mean=0.4716 norm_overlap=0.9952 corr_cb=-0.1829 topkJ=0.0398
[TRAIN][ep=031] loss=0.6069 acc=77.58%
[TRAIN][ep=031] mask_avg: mc_mean=0.1972 mb_mean=0.4721 norm_overlap=0.9963 corr_cb=-0.1308
[EPOCH 031/089] train: loss=0.6069 acc=77.58% | val: loss=0.5919 acc=63.86% f1=72.73% auc=74.48% val_score=53.8399 val_score_bestthr=61.5939 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.197, mb=0.472, no=0.996, corr=-0.131) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4888 -> 61.5939
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2263 mb_mean=0.4736 norm_overlap=0.9968 corr_cb=-0.1347 topkJ=0.0369
[TRAIN][ep=032] loss=0.6086 acc=76.11%
[TRAIN][ep=032] mask_avg: mc_mean=0.2135 mb_mean=0.4721 norm_overlap=0.9960 corr_cb=-0.1516
[EPOCH 032/089] train: loss=0.6086 acc=76.11% | val: loss=0.5995 acc=65.06% f1=71.29% auc=74.83% val_score=55.1934 val_score_bestthr=62.8433 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.213, mb=0.472, no=0.996, corr=-0.152) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4888 -> 62.8433
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1515 mb_mean=0.4719 norm_overlap=0.9956 corr_cb=-0.1259 topkJ=0.0335
[TRAIN][ep=033] loss=0.6061 acc=75.30%
[TRAIN][ep=033] mask_avg: mc_mean=0.1968 mb_mean=0.4721 norm_overlap=0.9965 corr_cb=-0.1275
[EPOCH 033/089] train: loss=0.6061 acc=75.30% | val: loss=0.5905 acc=65.06% f1=71.29% auc=75.06% val_score=54.7956 val_score_bestthr=62.8433 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.197, mb=0.472, no=0.996, corr=-0.127) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4888 -> 62.8433
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1909 mb_mean=0.4724 norm_overlap=1.0008 corr_cb=0.0256 topkJ=0.1293
[TRAIN][ep=034] loss=0.5861 acc=77.32%
[TRAIN][ep=034] mask_avg: mc_mean=0.1940 mb_mean=0.4721 norm_overlap=0.9968 corr_cb=-0.1128
[EPOCH 034/089] train: loss=0.5861 acc=77.32% | val: loss=0.5891 acc=65.06% f1=71.29% auc=75.17% val_score=51.7490 val_score_bestthr=62.8433 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.194, mb=0.472, no=0.997, corr=-0.113) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4888 -> 62.8433
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2302 mb_mean=0.4717 norm_overlap=1.0027 corr_cb=0.0842 topkJ=0.0567
[TRAIN][ep=035] loss=0.5883 acc=78.79%
[TRAIN][ep=035] mask_avg: mc_mean=0.2323 mb_mean=0.4721 norm_overlap=0.9956 corr_cb=-0.1675
[EPOCH 035/089] train: loss=0.5883 acc=78.79% | val: loss=0.6192 acc=65.06% f1=72.38% auc=75.52% val_score=59.7112 val_score_bestthr=64.3112 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.232, mb=0.472, no=0.996, corr=-0.167) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.4888 -> 64.3112
[EARLY STOP] no improvement for 30 epochs. best_epoch=5
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
=============== FIT DONE ===============
[BEST] epoch=5 | val_acc=69.88% | val_f1=71.91% | val_auc=66.92% | val_score=47.1564 | val_score_bestthr=65.4888
[TEST@BEST] thr_used=0.490 | acc=57.00% f1=59.36% auc=61.20% | SP_sex=9.95% EO_sex=8.65% SP_age=3.97% EO_age=12.17%
[TIME] 0.96 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/summary_fold_0.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4732 mb_mean=0.4739 norm_overlap=1.0003 corr_cb=0.4202 topkJ=0.1261
[TRAIN][ep=000] loss=0.6955 acc=51.54%
[TRAIN][ep=000] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3729
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4746 mb_mean=0.4736 norm_overlap=1.0001 corr_cb=0.2526 topkJ=0.1426
[TRAIN][ep=001] loss=0.6932 acc=50.74%
[TRAIN][ep=001] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3696
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4719 mb_mean=0.4692 norm_overlap=1.0002 corr_cb=0.4403 topkJ=0.2099
[TRAIN][ep=002] loss=0.6920 acc=50.60%
[TRAIN][ep=002] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3688
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4696 mb_mean=0.4711 norm_overlap=1.0003 corr_cb=0.4991 topkJ=0.2274
[TRAIN][ep=003] loss=0.6903 acc=55.57%
[TRAIN][ep=003] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3683
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4752 mb_mean=0.4728 norm_overlap=1.0003 corr_cb=0.4629 topkJ=0.1590
[TRAIN][ep=004] loss=0.6892 acc=52.21%
[TRAIN][ep=004] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3684
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4723 mb_mean=0.4722 norm_overlap=1.0002 corr_cb=0.3577 topkJ=0.1944
[TRAIN][ep=005] loss=0.6859 acc=55.17%
[TRAIN][ep=005] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3689
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4731 mb_mean=0.4733 norm_overlap=1.0004 corr_cb=0.5633 topkJ=0.1681
[TRAIN][ep=006] loss=0.6864 acc=57.32%
[TRAIN][ep=006] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3653
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4723 mb_mean=0.4718 norm_overlap=1.0002 corr_cb=0.4549 topkJ=0.1869
[TRAIN][ep=007] loss=0.6834 acc=58.39%
[TRAIN][ep=007] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3710
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4734 mb_mean=0.4747 norm_overlap=1.0002 corr_cb=0.3617 topkJ=0.1959
[TRAIN][ep=008] loss=0.6814 acc=59.46%
[TRAIN][ep=008] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3700
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4744 mb_mean=0.4729 norm_overlap=1.0001 corr_cb=0.3126 topkJ=0.0962
[TRAIN][ep=009] loss=0.6766 acc=59.33%
[TRAIN][ep=009] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3704
================= FIT START (fold=0) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4740 mb_mean=0.4722 norm_overlap=1.0002 corr_cb=0.3730 topkJ=0.1775
[TRAIN][ep=000] loss=0.6722 acc=61.61%
[TRAIN][ep=000] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3748
[EPOCH 000/089] train: loss=0.6722 acc=61.61% | val: loss=0.6833 acc=60.24% f1=63.74% auc=60.58% val_score=37.0937 val_score_bestthr=61.8943 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.375) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 61.8943
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4741 mb_mean=0.4758 norm_overlap=1.0000 corr_cb=0.0718 topkJ=0.1290
[TRAIN][ep=001] loss=0.6663 acc=59.60%
[TRAIN][ep=001] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3678
[EPOCH 001/089] train: loss=0.6663 acc=59.60% | val: loss=0.6969 acc=59.04% f1=63.83% auc=58.31% val_score=54.9121 val_score_bestthr=59.1945 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.368) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.8943 -> 59.1945
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4768 mb_mean=0.4754 norm_overlap=1.0002 corr_cb=0.3045 topkJ=0.2290
[TRAIN][ep=002] loss=0.6649 acc=61.21%
[TRAIN][ep=002] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3720
[EPOCH 002/089] train: loss=0.6649 acc=61.21% | val: loss=0.6742 acc=60.24% f1=64.52% auc=63.78% val_score=56.8472 val_score_bestthr=59.4427 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.372) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.8943 -> 59.4427
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4684 mb_mean=0.4694 norm_overlap=1.0003 corr_cb=0.5137 topkJ=0.2279
[TRAIN][ep=003] loss=0.6626 acc=62.95%
[TRAIN][ep=003] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3689
[EPOCH 003/089] train: loss=0.6626 acc=62.95% | val: loss=0.6673 acc=63.86% f1=66.67% auc=65.12% val_score=55.0292 val_score_bestthr=62.2240 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.369) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 61.8943 -> 62.2240
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4725 mb_mean=0.4704 norm_overlap=1.0002 corr_cb=0.4488 topkJ=0.1783
[TRAIN][ep=004] loss=0.6562 acc=64.16%
[TRAIN][ep=004] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3726
[EPOCH 004/089] train: loss=0.6562 acc=64.16% | val: loss=0.6846 acc=60.24% f1=63.74% auc=60.87% val_score=40.1125 val_score_bestthr=58.9269 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.373) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.2240 -> 58.9269
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4748 mb_mean=0.4735 norm_overlap=1.0001 corr_cb=0.2218 topkJ=0.0905
[TRAIN][ep=005] loss=1.3070 acc=62.15%
[TRAIN][ep=005] mask_avg: mc_mean=0.3878 mb_mean=0.4721 norm_overlap=1.0015 corr_cb=0.5391
[EPOCH 005/089] train: loss=1.3070 acc=62.15% | val: loss=0.6669 acc=68.67% f1=71.11% auc=66.51% val_score=47.1564 val_score_bestthr=64.3671 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.388, mb=0.472, no=1.001, corr=0.539) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 62.2240 -> 64.3671
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.3087 mb_mean=0.4730 norm_overlap=1.0015 corr_cb=0.3859 topkJ=0.2138
[TRAIN][ep=006] loss=1.2933 acc=62.68%
[TRAIN][ep=006] mask_avg: mc_mean=0.2835 mb_mean=0.4721 norm_overlap=1.0032 corr_cb=0.5046
[EPOCH 006/089] train: loss=1.2933 acc=62.68% | val: loss=0.6898 acc=60.24% f1=65.26% auc=61.98% val_score=50.2325 val_score_bestthr=58.0251 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.283, mb=0.472, no=1.003, corr=0.505) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 58.0251
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2518 mb_mean=0.4707 norm_overlap=1.0066 corr_cb=0.6438 topkJ=0.2148
[TRAIN][ep=007] loss=1.2907 acc=62.28%
[TRAIN][ep=007] mask_avg: mc_mean=0.2557 mb_mean=0.4721 norm_overlap=1.0036 corr_cb=0.4680
[EPOCH 007/089] train: loss=1.2907 acc=62.28% | val: loss=0.6559 acc=67.47% f1=69.66% auc=68.55% val_score=61.7986 val_score_bestthr=64.3484 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.256, mb=0.472, no=1.004, corr=0.468) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 64.3484
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2821 mb_mean=0.4760 norm_overlap=1.0019 corr_cb=0.3014 topkJ=0.1944
[TRAIN][ep=008] loss=1.2745 acc=65.37%
[TRAIN][ep=008] mask_avg: mc_mean=0.2415 mb_mean=0.4721 norm_overlap=1.0033 corr_cb=0.3750
[EPOCH 008/089] train: loss=1.2745 acc=65.37% | val: loss=0.6575 acc=66.27% f1=68.18% auc=66.92% val_score=43.3431 val_score_bestthr=61.1171 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.241, mb=0.472, no=1.003, corr=0.375) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 61.1171
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2192 mb_mean=0.4697 norm_overlap=1.0051 corr_cb=0.4704 topkJ=0.1625
[TRAIN][ep=009] loss=1.2669 acc=66.31%
[TRAIN][ep=009] mask_avg: mc_mean=0.2323 mb_mean=0.4721 norm_overlap=1.0031 corr_cb=0.3207
[EPOCH 009/089] train: loss=1.2669 acc=66.31% | val: loss=0.6984 acc=61.45% f1=65.96% auc=61.51% val_score=54.9121 val_score_bestthr=60.3341 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.232, mb=0.472, no=1.003, corr=0.321) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 60.3341
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.2346 mb_mean=0.4726 norm_overlap=1.0041 corr_cb=0.3909 topkJ=0.1049
[TRAIN][ep=010] loss=1.2754 acc=63.89%
[TRAIN][ep=010] mask_avg: mc_mean=0.2251 mb_mean=0.4721 norm_overlap=1.0028 corr_cb=0.2648
[EPOCH 010/089] train: loss=1.2754 acc=63.89% | val: loss=0.6455 acc=68.67% f1=71.11% auc=70.76% val_score=51.8684 val_score_bestthr=60.1201 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.225, mb=0.472, no=1.003, corr=0.265) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 60.1201
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.2356 mb_mean=0.4757 norm_overlap=1.0018 corr_cb=0.2193 topkJ=0.0723
[TRAIN][ep=011] loss=1.0558 acc=65.50%
[TRAIN][ep=011] mask_avg: mc_mean=0.2074 mb_mean=0.4721 norm_overlap=1.0027 corr_cb=0.2175
[EPOCH 011/089] train: loss=1.0558 acc=65.50% | val: loss=0.6380 acc=63.86% f1=70.59% auc=69.94% val_score=56.5677 val_score_bestthr=59.4672 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.207, mb=0.472, no=1.003, corr=0.217) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 59.4672
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.2041 mb_mean=0.4710 norm_overlap=1.0038 corr_cb=0.2762 topkJ=0.1217
[TRAIN][ep=012] loss=0.8422 acc=68.86%
[TRAIN][ep=012] mask_avg: mc_mean=0.2036 mb_mean=0.4721 norm_overlap=1.0018 corr_cb=0.1270
[EPOCH 012/089] train: loss=0.8422 acc=68.86% | val: loss=0.6368 acc=66.27% f1=69.57% auc=69.19% val_score=55.1103 val_score_bestthr=59.4604 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.204, mb=0.472, no=1.002, corr=0.127) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 59.4604
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.2342 mb_mean=0.4762 norm_overlap=0.9999 corr_cb=-0.0057 topkJ=0.0615
[TRAIN][ep=013] loss=0.8021 acc=68.05%
[TRAIN][ep=013] mask_avg: mc_mean=0.2108 mb_mean=0.4721 norm_overlap=1.0005 corr_cb=0.0285
[EPOCH 013/089] train: loss=0.8021 acc=68.05% | val: loss=0.6308 acc=65.06% f1=70.71% auc=69.42% val_score=56.1210 val_score_bestthr=58.7200 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.211, mb=0.472, no=1.001, corr=0.028) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 58.7200
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.2205 mb_mean=0.4743 norm_overlap=1.0008 corr_cb=0.0514 topkJ=0.0783
[TRAIN][ep=014] loss=0.7778 acc=71.14%
[TRAIN][ep=014] mask_avg: mc_mean=0.1994 mb_mean=0.4721 norm_overlap=0.9998 corr_cb=-0.0158
[EPOCH 014/089] train: loss=0.7778 acc=71.14% | val: loss=0.6271 acc=65.06% f1=70.71% auc=70.12% val_score=55.6749 val_score_bestthr=58.7200 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.199, mb=0.472, no=1.000, corr=-0.016) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 58.7200
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1502 mb_mean=0.4689 norm_overlap=1.0013 corr_cb=0.0611 topkJ=0.0448
[TRAIN][ep=015] loss=0.7715 acc=71.01%
[TRAIN][ep=015] mask_avg: mc_mean=0.1731 mb_mean=0.4721 norm_overlap=0.9999 corr_cb=-0.0120
[EPOCH 015/089] train: loss=0.7715 acc=71.01% | val: loss=0.6624 acc=57.83% f1=71.07% auc=67.73% val_score=51.1388 val_score_bestthr=63.8258 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.173, mb=0.472, no=1.000, corr=-0.012) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 63.8258
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1869 mb_mean=0.4714 norm_overlap=1.0019 corr_cb=0.0999 topkJ=0.0484
[TRAIN][ep=016] loss=0.7659 acc=71.54%
[TRAIN][ep=016] mask_avg: mc_mean=0.1798 mb_mean=0.4721 norm_overlap=0.9991 corr_cb=-0.0452
[EPOCH 016/089] train: loss=0.7659 acc=71.54% | val: loss=0.6186 acc=65.06% f1=71.29% auc=70.41% val_score=53.9218 val_score_bestthr=58.8239 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.180, mb=0.472, no=0.999, corr=-0.045) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 58.8239
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1975 mb_mean=0.4756 norm_overlap=0.9979 corr_cb=-0.1110 topkJ=0.0333
[TRAIN][ep=017] loss=0.7532 acc=71.54%
[TRAIN][ep=017] mask_avg: mc_mean=0.1799 mb_mean=0.4721 norm_overlap=0.9986 corr_cb=-0.0663
[EPOCH 017/089] train: loss=0.7532 acc=71.54% | val: loss=0.6210 acc=57.83% f1=71.07% auc=70.70% val_score=42.0368 val_score_bestthr=63.8258 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.180, mb=0.472, no=0.999, corr=-0.066) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 63.8258
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.2112 mb_mean=0.4736 norm_overlap=0.9971 corr_cb=-0.1447 topkJ=0.0197
[TRAIN][ep=018] loss=0.7494 acc=72.48%
[TRAIN][ep=018] mask_avg: mc_mean=0.2110 mb_mean=0.4721 norm_overlap=0.9972 corr_cb=-0.1293
[EPOCH 018/089] train: loss=0.7494 acc=72.48% | val: loss=0.6184 acc=59.04% f1=71.67% auc=72.33% val_score=49.0581 val_score_bestthr=63.6992 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.211, mb=0.472, no=0.997, corr=-0.129) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 63.6992
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1680 mb_mean=0.4748 norm_overlap=0.9932 corr_cb=-0.3060 topkJ=0.0084
[TRAIN][ep=019] loss=0.7413 acc=73.83%
[TRAIN][ep=019] mask_avg: mc_mean=0.1905 mb_mean=0.4721 norm_overlap=0.9977 corr_cb=-0.1097
[EPOCH 019/089] train: loss=0.7413 acc=73.83% | val: loss=0.5974 acc=65.06% f1=69.47% auc=72.85% val_score=42.0396 val_score_bestthr=60.2117 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.472, no=0.998, corr=-0.110) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 60.2117
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1057 mb_mean=0.4736 norm_overlap=1.0015 corr_cb=0.0404 topkJ=0.0338
[TRAIN][ep=020] loss=0.7414 acc=71.54%
[TRAIN][ep=020] mask_avg: mc_mean=0.1897 mb_mean=0.4721 norm_overlap=0.9974 corr_cb=-0.1151
[EPOCH 020/089] train: loss=0.7414 acc=71.54% | val: loss=0.6411 acc=66.27% f1=70.83% auc=70.70% val_score=56.2353 val_score_bestthr=60.9269 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.472, no=0.997, corr=-0.115) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 60.9269
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.1866 mb_mean=0.4700 norm_overlap=0.9969 corr_cb=-0.1301 topkJ=0.0358
[TRAIN][ep=021] loss=0.7438 acc=71.01%
[TRAIN][ep=021] mask_avg: mc_mean=0.2166 mb_mean=0.4721 norm_overlap=0.9967 corr_cb=-0.1442
[EPOCH 021/089] train: loss=0.7438 acc=71.01% | val: loss=0.6025 acc=67.47% f1=72.73% auc=73.60% val_score=47.4146 val_score_bestthr=62.7938 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.217, mb=0.472, no=0.997, corr=-0.144) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 62.7938
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1894 mb_mean=0.4722 norm_overlap=0.9980 corr_cb=-0.0728 topkJ=0.0355
[TRAIN][ep=022] loss=0.7243 acc=74.23%
[TRAIN][ep=022] mask_avg: mc_mean=0.1983 mb_mean=0.4721 norm_overlap=0.9972 corr_cb=-0.1210
[EPOCH 022/089] train: loss=0.7243 acc=74.23% | val: loss=0.6132 acc=66.27% f1=72.00% auc=71.92% val_score=52.9009 val_score_bestthr=61.6828 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.198, mb=0.472, no=0.997, corr=-0.121) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 61.6828
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1897 mb_mean=0.4728 norm_overlap=0.9966 corr_cb=-0.1354 topkJ=0.0372
[TRAIN][ep=023] loss=0.7187 acc=72.75%
[TRAIN][ep=023] mask_avg: mc_mean=0.2016 mb_mean=0.4721 norm_overlap=0.9967 corr_cb=-0.1300
[EPOCH 023/089] train: loss=0.7187 acc=72.75% | val: loss=0.5968 acc=67.47% f1=72.73% auc=75.06% val_score=55.7489 val_score_bestthr=63.3131 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.202, mb=0.472, no=0.997, corr=-0.130) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 63.3131
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2294 mb_mean=0.4734 norm_overlap=0.9984 corr_cb=-0.0674 topkJ=0.0437
[TRAIN][ep=024] loss=0.7089 acc=74.77%
[TRAIN][ep=024] mask_avg: mc_mean=0.2081 mb_mean=0.4721 norm_overlap=0.9960 corr_cb=-0.1575
[EPOCH 024/089] train: loss=0.7089 acc=74.77% | val: loss=0.6100 acc=67.47% f1=72.73% auc=72.91% val_score=50.5935 val_score_bestthr=62.7938 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.208, mb=0.472, no=0.996, corr=-0.158) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 62.7938
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1795 mb_mean=0.4715 norm_overlap=0.9999 corr_cb=-0.0034 topkJ=0.0390
[TRAIN][ep=025] loss=0.6996 acc=75.84%
[TRAIN][ep=025] mask_avg: mc_mean=0.2029 mb_mean=0.4721 norm_overlap=0.9963 corr_cb=-0.1386
[EPOCH 025/089] train: loss=0.6996 acc=75.84% | val: loss=0.5953 acc=66.27% f1=72.55% auc=74.01% val_score=55.5456 val_score_bestthr=63.5006 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.203, mb=0.472, no=0.996, corr=-0.139) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 63.5006
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1455 mb_mean=0.4765 norm_overlap=0.9969 corr_cb=-0.1186 topkJ=0.0444
[TRAIN][ep=026] loss=0.6958 acc=75.84%
[TRAIN][ep=026] mask_avg: mc_mean=0.1661 mb_mean=0.4721 norm_overlap=0.9975 corr_cb=-0.0931
[EPOCH 026/089] train: loss=0.6958 acc=75.84% | val: loss=0.5925 acc=57.83% f1=71.07% auc=73.66% val_score=44.1270 val_score_bestthr=63.8258 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.166, mb=0.472, no=0.997, corr=-0.093) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 63.8258
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.3204 mb_mean=0.4714 norm_overlap=0.9929 corr_cb=-0.3501 topkJ=0.0173
[TRAIN][ep=027] loss=0.7049 acc=74.77%
[TRAIN][ep=027] mask_avg: mc_mean=0.2088 mb_mean=0.4721 norm_overlap=0.9963 corr_cb=-0.1436
[EPOCH 027/089] train: loss=0.7049 acc=74.77% | val: loss=0.6189 acc=66.27% f1=72.00% auc=73.60% val_score=57.8015 val_score_bestthr=61.6828 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.209, mb=0.472, no=0.996, corr=-0.144) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 61.6828
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1667 mb_mean=0.4701 norm_overlap=0.9972 corr_cb=-0.0774 topkJ=0.0253
[TRAIN][ep=028] loss=0.6861 acc=75.17%
[TRAIN][ep=028] mask_avg: mc_mean=0.2058 mb_mean=0.4721 norm_overlap=0.9962 corr_cb=-0.1417
[EPOCH 028/089] train: loss=0.6861 acc=75.17% | val: loss=0.6432 acc=63.86% f1=71.15% auc=73.02% val_score=58.5426 val_score_bestthr=61.9239 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.206, mb=0.472, no=0.996, corr=-0.142) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 61.9239
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2117 mb_mean=0.4737 norm_overlap=0.9971 corr_cb=-0.1346 topkJ=0.0408
[TRAIN][ep=029] loss=0.6947 acc=74.90%
[TRAIN][ep=029] mask_avg: mc_mean=0.2114 mb_mean=0.4721 norm_overlap=0.9964 corr_cb=-0.1417
[EPOCH 029/089] train: loss=0.6947 acc=74.90% | val: loss=0.5849 acc=66.27% f1=72.55% auc=75.23% val_score=53.5782 val_score_bestthr=63.5006 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.211, mb=0.472, no=0.996, corr=-0.142) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 63.5006
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2172 mb_mean=0.4712 norm_overlap=0.9947 corr_cb=-0.1820 topkJ=0.0564
[TRAIN][ep=030] loss=0.6684 acc=75.84%
[TRAIN][ep=030] mask_avg: mc_mean=0.2115 mb_mean=0.4721 norm_overlap=0.9959 corr_cb=-0.1521
[EPOCH 030/089] train: loss=0.6684 acc=75.84% | val: loss=0.6136 acc=65.06% f1=71.84% auc=74.77% val_score=57.8015 val_score_bestthr=63.1539 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.211, mb=0.472, no=0.996, corr=-0.152) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 63.1539
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2117 mb_mean=0.4716 norm_overlap=0.9952 corr_cb=-0.1847 topkJ=0.0407
[TRAIN][ep=031] loss=0.6600 acc=77.32%
[TRAIN][ep=031] mask_avg: mc_mean=0.1981 mb_mean=0.4721 norm_overlap=0.9963 corr_cb=-0.1314
[EPOCH 031/089] train: loss=0.6600 acc=77.32% | val: loss=0.5920 acc=63.86% f1=72.73% auc=74.53% val_score=56.3349 val_score_bestthr=61.5939 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.198, mb=0.472, no=0.996, corr=-0.131) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 61.5939
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2286 mb_mean=0.4736 norm_overlap=0.9967 corr_cb=-0.1372 topkJ=0.0369
[TRAIN][ep=032] loss=0.6618 acc=75.97%
[TRAIN][ep=032] mask_avg: mc_mean=0.2144 mb_mean=0.4721 norm_overlap=0.9960 corr_cb=-0.1525
[EPOCH 032/089] train: loss=0.6618 acc=75.97% | val: loss=0.5995 acc=65.06% f1=71.29% auc=74.94% val_score=55.1934 val_score_bestthr=62.8433 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.214, mb=0.472, no=0.996, corr=-0.152) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 62.8433
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1528 mb_mean=0.4719 norm_overlap=0.9956 corr_cb=-0.1277 topkJ=0.0335
[TRAIN][ep=033] loss=0.6590 acc=75.57%
[TRAIN][ep=033] mask_avg: mc_mean=0.1973 mb_mean=0.4721 norm_overlap=0.9965 corr_cb=-0.1278
[EPOCH 033/089] train: loss=0.6590 acc=75.57% | val: loss=0.5905 acc=65.06% f1=71.29% auc=75.06% val_score=53.8249 val_score_bestthr=62.8433 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.197, mb=0.472, no=0.996, corr=-0.128) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 62.8433
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1913 mb_mean=0.4724 norm_overlap=1.0008 corr_cb=0.0278 topkJ=0.1293
[TRAIN][ep=034] loss=0.6389 acc=77.32%
[TRAIN][ep=034] mask_avg: mc_mean=0.1948 mb_mean=0.4721 norm_overlap=0.9968 corr_cb=-0.1133
[EPOCH 034/089] train: loss=0.6389 acc=77.32% | val: loss=0.5894 acc=65.06% f1=71.29% auc=75.17% val_score=49.0034 val_score_bestthr=62.8433 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.195, mb=0.472, no=0.997, corr=-0.113) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 62.8433
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2315 mb_mean=0.4717 norm_overlap=1.0026 corr_cb=0.0808 topkJ=0.0571
[TRAIN][ep=035] loss=0.6410 acc=78.93%
[TRAIN][ep=035] mask_avg: mc_mean=0.2323 mb_mean=0.4721 norm_overlap=0.9957 corr_cb=-0.1673
[EPOCH 035/089] train: loss=0.6410 acc=78.93% | val: loss=0.6195 acc=65.06% f1=72.38% auc=75.41% val_score=59.7112 val_score_bestthr=64.3112 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.232, mb=0.472, no=0.996, corr=-0.167) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 64.3112
[EARLY STOP] no improvement for 30 epochs. best_epoch=5
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
=============== FIT DONE ===============
[BEST] epoch=5 | val_acc=68.67% | val_f1=71.11% | val_auc=66.51% | val_score=47.1564 | val_score_bestthr=64.3671
[TEST@BEST] thr_used=0.460 | acc=56.52% f1=64.29% auc=60.92% | SP_sex=4.52% EO_sex=3.33% SP_age=7.05% EO_age=12.02%
[TIME] 1.04 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/summary_fold_0.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4732 mb_mean=0.4739 norm_overlap=1.0003 corr_cb=0.4202 topkJ=0.1261
[TRAIN][ep=000] loss=0.6955 acc=51.54%
[TRAIN][ep=000] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3729
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4746 mb_mean=0.4736 norm_overlap=1.0001 corr_cb=0.2526 topkJ=0.1426
[TRAIN][ep=001] loss=0.6932 acc=50.74%
[TRAIN][ep=001] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3696
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4719 mb_mean=0.4692 norm_overlap=1.0002 corr_cb=0.4403 topkJ=0.2099
[TRAIN][ep=002] loss=0.6920 acc=50.60%
[TRAIN][ep=002] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3688
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4696 mb_mean=0.4711 norm_overlap=1.0003 corr_cb=0.4991 topkJ=0.2274
[TRAIN][ep=003] loss=0.6903 acc=55.57%
[TRAIN][ep=003] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3683
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4752 mb_mean=0.4728 norm_overlap=1.0003 corr_cb=0.4629 topkJ=0.1590
[TRAIN][ep=004] loss=0.6892 acc=52.21%
[TRAIN][ep=004] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3684
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4723 mb_mean=0.4722 norm_overlap=1.0002 corr_cb=0.3577 topkJ=0.1944
[TRAIN][ep=005] loss=0.6859 acc=55.17%
[TRAIN][ep=005] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3689
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4731 mb_mean=0.4733 norm_overlap=1.0004 corr_cb=0.5633 topkJ=0.1681
[TRAIN][ep=006] loss=0.6864 acc=57.32%
[TRAIN][ep=006] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3653
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4723 mb_mean=0.4718 norm_overlap=1.0002 corr_cb=0.4549 topkJ=0.1869
[TRAIN][ep=007] loss=0.6834 acc=58.39%
[TRAIN][ep=007] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3710
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4734 mb_mean=0.4747 norm_overlap=1.0002 corr_cb=0.3617 topkJ=0.1959
[TRAIN][ep=008] loss=0.6814 acc=59.60%
[TRAIN][ep=008] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3700
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4744 mb_mean=0.4729 norm_overlap=1.0001 corr_cb=0.3126 topkJ=0.0962
[TRAIN][ep=009] loss=0.6766 acc=59.33%
[TRAIN][ep=009] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3704
================= FIT START (fold=0) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4740 mb_mean=0.4722 norm_overlap=1.0002 corr_cb=0.3730 topkJ=0.1775
[TRAIN][ep=000] loss=0.6722 acc=61.61%
[TRAIN][ep=000] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3748
[EPOCH 000/089] train: loss=0.6722 acc=61.61% | val: loss=0.6833 acc=60.24% f1=63.74% auc=60.58% val_score=37.0937 val_score_bestthr=61.8943 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.375) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 61.8943
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4741 mb_mean=0.4758 norm_overlap=1.0000 corr_cb=0.0718 topkJ=0.1290
[TRAIN][ep=001] loss=0.6663 acc=59.60%
[TRAIN][ep=001] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3678
[EPOCH 001/089] train: loss=0.6663 acc=59.60% | val: loss=0.6969 acc=59.04% f1=63.83% auc=58.26% val_score=54.9121 val_score_bestthr=59.1945 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.368) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.8943 -> 59.1945
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4768 mb_mean=0.4754 norm_overlap=1.0002 corr_cb=0.3045 topkJ=0.2290
[TRAIN][ep=002] loss=0.6649 acc=61.21%
[TRAIN][ep=002] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3720
[EPOCH 002/089] train: loss=0.6649 acc=61.21% | val: loss=0.6742 acc=60.24% f1=64.52% auc=63.78% val_score=56.8472 val_score_bestthr=59.4427 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.372) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.8943 -> 59.4427
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4684 mb_mean=0.4694 norm_overlap=1.0003 corr_cb=0.5137 topkJ=0.2279
[TRAIN][ep=003] loss=0.6626 acc=62.82%
[TRAIN][ep=003] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3689
[EPOCH 003/089] train: loss=0.6626 acc=62.82% | val: loss=0.6674 acc=63.86% f1=66.67% auc=65.12% val_score=55.0292 val_score_bestthr=62.2240 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.369) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 61.8943 -> 62.2240
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4725 mb_mean=0.4704 norm_overlap=1.0002 corr_cb=0.4488 topkJ=0.1783
[TRAIN][ep=004] loss=0.6562 acc=64.16%
[TRAIN][ep=004] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3726
[EPOCH 004/089] train: loss=0.6562 acc=64.16% | val: loss=0.6846 acc=60.24% f1=63.74% auc=60.87% val_score=40.1125 val_score_bestthr=58.9269 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.373) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.2240 -> 58.9269
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4748 mb_mean=0.4735 norm_overlap=1.0001 corr_cb=0.2218 topkJ=0.0905
[TRAIN][ep=005] loss=1.4769 acc=62.01%
[TRAIN][ep=005] mask_avg: mc_mean=0.3877 mb_mean=0.4721 norm_overlap=1.0015 corr_cb=0.5391
[EPOCH 005/089] train: loss=1.4769 acc=62.01% | val: loss=0.6673 acc=68.67% f1=71.11% auc=66.28% val_score=47.1564 val_score_bestthr=64.3671 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.388, mb=0.472, no=1.001, corr=0.539) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 62.2240 -> 64.3671
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.3087 mb_mean=0.4730 norm_overlap=1.0015 corr_cb=0.3859 topkJ=0.2138
[TRAIN][ep=006] loss=1.4562 acc=62.68%
[TRAIN][ep=006] mask_avg: mc_mean=0.2834 mb_mean=0.4721 norm_overlap=1.0032 corr_cb=0.5045
[EPOCH 006/089] train: loss=1.4562 acc=62.68% | val: loss=0.6902 acc=59.04% f1=64.58% auc=61.74% val_score=50.2325 val_score_bestthr=56.9212 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.283, mb=0.472, no=1.003, corr=0.505) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 56.9212
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2516 mb_mean=0.4707 norm_overlap=1.0066 corr_cb=0.6435 topkJ=0.2142
[TRAIN][ep=007] loss=1.4530 acc=62.28%
[TRAIN][ep=007] mask_avg: mc_mean=0.2556 mb_mean=0.4721 norm_overlap=1.0036 corr_cb=0.4672
[EPOCH 007/089] train: loss=1.4530 acc=62.28% | val: loss=0.6561 acc=67.47% f1=69.66% auc=68.49% val_score=61.7986 val_score_bestthr=64.3484 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.256, mb=0.472, no=1.004, corr=0.467) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 64.3484
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2822 mb_mean=0.4760 norm_overlap=1.0019 corr_cb=0.3010 topkJ=0.1944
[TRAIN][ep=008] loss=1.4367 acc=65.23%
[TRAIN][ep=008] mask_avg: mc_mean=0.2414 mb_mean=0.4721 norm_overlap=1.0033 corr_cb=0.3750
[EPOCH 008/089] train: loss=1.4367 acc=65.23% | val: loss=0.6575 acc=66.27% f1=68.89% auc=67.15% val_score=43.5647 val_score_bestthr=60.7956 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.241, mb=0.472, no=1.003, corr=0.375) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 60.7956
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2192 mb_mean=0.4697 norm_overlap=1.0051 corr_cb=0.4710 topkJ=0.1625
[TRAIN][ep=009] loss=1.4288 acc=66.44%
[TRAIN][ep=009] mask_avg: mc_mean=0.2324 mb_mean=0.4721 norm_overlap=1.0031 corr_cb=0.3212
[EPOCH 009/089] train: loss=1.4288 acc=66.44% | val: loss=0.6988 acc=61.45% f1=65.96% auc=61.57% val_score=54.9121 val_score_bestthr=60.3341 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.232, mb=0.472, no=1.003, corr=0.321) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 60.3341
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.2348 mb_mean=0.4726 norm_overlap=1.0041 corr_cb=0.3904 topkJ=0.1049
[TRAIN][ep=010] loss=1.4363 acc=64.03%
[TRAIN][ep=010] mask_avg: mc_mean=0.2251 mb_mean=0.4721 norm_overlap=1.0028 corr_cb=0.2646
[EPOCH 010/089] train: loss=1.4363 acc=64.03% | val: loss=0.6455 acc=56.63% f1=70.49% auc=70.58% val_score=51.8684 val_score_bestthr=63.9539 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.225, mb=0.472, no=1.003, corr=0.265) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 63.9539
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.2358 mb_mean=0.4757 norm_overlap=1.0018 corr_cb=0.2190 topkJ=0.0728
[TRAIN][ep=011] loss=1.2167 acc=65.23%
[TRAIN][ep=011] mask_avg: mc_mean=0.2072 mb_mean=0.4721 norm_overlap=1.0027 corr_cb=0.2176
[EPOCH 011/089] train: loss=1.2167 acc=65.23% | val: loss=0.6380 acc=63.86% f1=70.59% auc=69.83% val_score=57.0625 val_score_bestthr=59.4672 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.207, mb=0.472, no=1.003, corr=0.218) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 59.4672
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.2041 mb_mean=0.4710 norm_overlap=1.0038 corr_cb=0.2762 topkJ=0.1217
[TRAIN][ep=012] loss=1.0026 acc=68.86%
[TRAIN][ep=012] mask_avg: mc_mean=0.2039 mb_mean=0.4721 norm_overlap=1.0018 corr_cb=0.1258
[EPOCH 012/089] train: loss=1.0026 acc=68.86% | val: loss=0.6365 acc=61.45% f1=69.23% auc=69.24% val_score=55.1103 val_score_bestthr=56.6039 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.204, mb=0.472, no=1.002, corr=0.126) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 56.6039
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.2350 mb_mean=0.4762 norm_overlap=0.9999 corr_cb=-0.0080 topkJ=0.0597
[TRAIN][ep=013] loss=0.9621 acc=68.59%
[TRAIN][ep=013] mask_avg: mc_mean=0.2107 mb_mean=0.4721 norm_overlap=1.0005 corr_cb=0.0269
[EPOCH 013/089] train: loss=0.9621 acc=68.59% | val: loss=0.6307 acc=63.86% f1=70.00% auc=69.36% val_score=55.6749 val_score_bestthr=57.6120 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.211, mb=0.472, no=1.000, corr=0.027) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 57.6120
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.2203 mb_mean=0.4743 norm_overlap=1.0007 corr_cb=0.0493 topkJ=0.0783
[TRAIN][ep=014] loss=0.9372 acc=71.14%
[TRAIN][ep=014] mask_avg: mc_mean=0.1999 mb_mean=0.4721 norm_overlap=0.9998 corr_cb=-0.0189
[EPOCH 014/089] train: loss=0.9372 acc=71.14% | val: loss=0.6267 acc=59.04% f1=71.67% auc=70.06% val_score=55.6749 val_score_bestthr=63.6992 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.200, mb=0.472, no=1.000, corr=-0.019) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 63.6992
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1500 mb_mean=0.4689 norm_overlap=1.0013 corr_cb=0.0596 topkJ=0.0448
[TRAIN][ep=015] loss=0.9302 acc=71.01%
[TRAIN][ep=015] mask_avg: mc_mean=0.1730 mb_mean=0.4721 norm_overlap=0.9999 corr_cb=-0.0141
[EPOCH 015/089] train: loss=0.9302 acc=71.01% | val: loss=0.6622 acc=57.83% f1=71.07% auc=68.08% val_score=51.1388 val_score_bestthr=63.8258 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.173, mb=0.472, no=1.000, corr=-0.014) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 63.8258
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1876 mb_mean=0.4714 norm_overlap=1.0019 corr_cb=0.0954 topkJ=0.0484
[TRAIN][ep=016] loss=0.9243 acc=71.28%
[TRAIN][ep=016] mask_avg: mc_mean=0.1799 mb_mean=0.4721 norm_overlap=0.9991 corr_cb=-0.0476
[EPOCH 016/089] train: loss=0.9243 acc=71.28% | val: loss=0.6181 acc=65.06% f1=71.29% auc=70.52% val_score=53.9218 val_score_bestthr=58.8239 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.180, mb=0.472, no=0.999, corr=-0.048) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 58.8239
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1981 mb_mean=0.4756 norm_overlap=0.9978 corr_cb=-0.1139 topkJ=0.0329
[TRAIN][ep=017] loss=0.9109 acc=71.81%
[TRAIN][ep=017] mask_avg: mc_mean=0.1798 mb_mean=0.4721 norm_overlap=0.9985 corr_cb=-0.0682
[EPOCH 017/089] train: loss=0.9109 acc=71.81% | val: loss=0.6199 acc=66.27% f1=71.43% auc=70.87% val_score=42.0368 val_score_bestthr=59.8302 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.180, mb=0.472, no=0.999, corr=-0.068) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 59.8302
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.2118 mb_mean=0.4736 norm_overlap=0.9970 corr_cb=-0.1485 topkJ=0.0197
[TRAIN][ep=018] loss=0.9063 acc=72.89%
[TRAIN][ep=018] mask_avg: mc_mean=0.2120 mb_mean=0.4721 norm_overlap=0.9971 corr_cb=-0.1325
[EPOCH 018/089] train: loss=0.9063 acc=72.89% | val: loss=0.6178 acc=66.27% f1=71.43% auc=72.50% val_score=49.0581 val_score_bestthr=59.8302 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.212, mb=0.472, no=0.997, corr=-0.132) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 59.8302
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1695 mb_mean=0.4748 norm_overlap=0.9931 corr_cb=-0.3088 topkJ=0.0080
[TRAIN][ep=019] loss=0.8973 acc=73.69%
[TRAIN][ep=019] mask_avg: mc_mean=0.1910 mb_mean=0.4721 norm_overlap=0.9977 corr_cb=-0.1118
[EPOCH 019/089] train: loss=0.8973 acc=73.69% | val: loss=0.5968 acc=65.06% f1=68.82% auc=72.85% val_score=42.0396 val_score_bestthr=60.0963 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.191, mb=0.472, no=0.998, corr=-0.112) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 60.0963
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1049 mb_mean=0.4736 norm_overlap=1.0014 corr_cb=0.0395 topkJ=0.0342
[TRAIN][ep=020] loss=0.8968 acc=71.68%
[TRAIN][ep=020] mask_avg: mc_mean=0.1905 mb_mean=0.4721 norm_overlap=0.9974 corr_cb=-0.1171
[EPOCH 020/089] train: loss=0.8968 acc=71.68% | val: loss=0.6402 acc=66.27% f1=70.83% auc=70.81% val_score=60.1090 val_score_bestthr=60.9269 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.472, no=0.997, corr=-0.117) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 60.9269
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.1864 mb_mean=0.4700 norm_overlap=0.9969 corr_cb=-0.1317 topkJ=0.0358
[TRAIN][ep=021] loss=0.8978 acc=71.01%
[TRAIN][ep=021] mask_avg: mc_mean=0.2177 mb_mean=0.4721 norm_overlap=0.9967 corr_cb=-0.1460
[EPOCH 021/089] train: loss=0.8978 acc=71.01% | val: loss=0.6006 acc=67.47% f1=72.73% auc=73.72% val_score=47.4146 val_score_bestthr=62.7938 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.218, mb=0.472, no=0.997, corr=-0.146) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 62.7938
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1891 mb_mean=0.4722 norm_overlap=0.9980 corr_cb=-0.0732 topkJ=0.0355
[TRAIN][ep=022] loss=0.8773 acc=74.50%
[TRAIN][ep=022] mask_avg: mc_mean=0.1985 mb_mean=0.4721 norm_overlap=0.9972 corr_cb=-0.1215
[EPOCH 022/089] train: loss=0.8773 acc=74.50% | val: loss=0.6128 acc=66.27% f1=72.00% auc=72.09% val_score=52.9009 val_score_bestthr=61.6828 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.199, mb=0.472, no=0.997, corr=-0.122) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 61.6828
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1902 mb_mean=0.4728 norm_overlap=0.9965 corr_cb=-0.1360 topkJ=0.0376
[TRAIN][ep=023] loss=0.8731 acc=72.21%
[TRAIN][ep=023] mask_avg: mc_mean=0.2023 mb_mean=0.4721 norm_overlap=0.9967 corr_cb=-0.1307
[EPOCH 023/089] train: loss=0.8731 acc=72.21% | val: loss=0.5954 acc=67.47% f1=72.73% auc=75.06% val_score=58.7763 val_score_bestthr=63.3131 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.202, mb=0.472, no=0.997, corr=-0.131) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 63.3131
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2308 mb_mean=0.4734 norm_overlap=0.9983 corr_cb=-0.0696 topkJ=0.0437
[TRAIN][ep=024] loss=0.8595 acc=74.90%
[TRAIN][ep=024] mask_avg: mc_mean=0.2088 mb_mean=0.4721 norm_overlap=0.9960 corr_cb=-0.1578
[EPOCH 024/089] train: loss=0.8595 acc=74.90% | val: loss=0.6081 acc=67.47% f1=72.73% auc=72.97% val_score=50.5935 val_score_bestthr=62.7938 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.209, mb=0.472, no=0.996, corr=-0.158) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 62.7938
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1822 mb_mean=0.4715 norm_overlap=0.9997 corr_cb=-0.0088 topkJ=0.0390
[TRAIN][ep=025] loss=0.8488 acc=75.57%
[TRAIN][ep=025] mask_avg: mc_mean=0.2049 mb_mean=0.4721 norm_overlap=0.9963 corr_cb=-0.1408
[EPOCH 025/089] train: loss=0.8488 acc=75.57% | val: loss=0.5944 acc=66.27% f1=72.55% auc=74.24% val_score=55.5456 val_score_bestthr=63.5006 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.205, mb=0.472, no=0.996, corr=-0.141) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 63.5006
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1438 mb_mean=0.4765 norm_overlap=0.9969 corr_cb=-0.1147 topkJ=0.0449
[TRAIN][ep=026] loss=0.8446 acc=75.97%
[TRAIN][ep=026] mask_avg: mc_mean=0.1665 mb_mean=0.4721 norm_overlap=0.9975 corr_cb=-0.0933
[EPOCH 026/089] train: loss=0.8446 acc=75.97% | val: loss=0.5902 acc=67.47% f1=73.79% auc=74.19% val_score=44.1270 val_score_bestthr=62.5512 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.167, mb=0.472, no=0.997, corr=-0.093) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 62.5512
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.3211 mb_mean=0.4714 norm_overlap=0.9929 corr_cb=-0.3483 topkJ=0.0173
[TRAIN][ep=027] loss=0.8525 acc=74.77%
[TRAIN][ep=027] mask_avg: mc_mean=0.2087 mb_mean=0.4721 norm_overlap=0.9963 corr_cb=-0.1428
[EPOCH 027/089] train: loss=0.8525 acc=74.77% | val: loss=0.6187 acc=67.47% f1=72.73% auc=73.90% val_score=57.8015 val_score_bestthr=62.7938 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.209, mb=0.472, no=0.996, corr=-0.143) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 62.7938
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1693 mb_mean=0.4701 norm_overlap=0.9970 corr_cb=-0.0821 topkJ=0.0249
[TRAIN][ep=028] loss=0.8301 acc=75.44%
[TRAIN][ep=028] mask_avg: mc_mean=0.2061 mb_mean=0.4721 norm_overlap=0.9962 corr_cb=-0.1417
[EPOCH 028/089] train: loss=0.8301 acc=75.44% | val: loss=0.6360 acc=63.86% f1=71.15% auc=73.66% val_score=58.5426 val_score_bestthr=61.9239 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.206, mb=0.472, no=0.996, corr=-0.142) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 61.9239
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2103 mb_mean=0.4737 norm_overlap=0.9972 corr_cb=-0.1317 topkJ=0.0408
[TRAIN][ep=029] loss=0.8379 acc=74.90%
[TRAIN][ep=029] mask_avg: mc_mean=0.2121 mb_mean=0.4721 norm_overlap=0.9964 corr_cb=-0.1415
[EPOCH 029/089] train: loss=0.8379 acc=74.90% | val: loss=0.5809 acc=68.67% f1=74.00% auc=75.87% val_score=51.0815 val_score_bestthr=68.1569 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.212, mb=0.472, no=0.996, corr=-0.141) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 64.3671 -> 68.1569
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2183 mb_mean=0.4712 norm_overlap=0.9948 corr_cb=-0.1805 topkJ=0.0564
[TRAIN][ep=030] loss=0.8940 acc=75.97%
[TRAIN][ep=030] mask_avg: mc_mean=0.2061 mb_mean=0.4721 norm_overlap=0.9960 corr_cb=-0.1458
[EPOCH 030/089] train: loss=0.8940 acc=75.97% | val: loss=0.6167 acc=66.27% f1=72.55% auc=75.12% val_score=56.4907 val_score_bestthr=65.4789 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.206, mb=0.472, no=0.996, corr=-0.146) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.1569 -> 65.4789
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2064 mb_mean=0.4716 norm_overlap=0.9952 corr_cb=-0.1788 topkJ=0.0411
[TRAIN][ep=031] loss=0.9583 acc=77.58%
[TRAIN][ep=031] mask_avg: mc_mean=0.1902 mb_mean=0.4721 norm_overlap=0.9964 corr_cb=-0.1235
[EPOCH 031/089] train: loss=0.9583 acc=77.58% | val: loss=0.5874 acc=63.86% f1=72.73% auc=74.77% val_score=54.7092 val_score_bestthr=61.5939 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.190, mb=0.472, no=0.996, corr=-0.124) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.1569 -> 61.5939
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2214 mb_mean=0.4736 norm_overlap=0.9968 corr_cb=-0.1315 topkJ=0.0360
[TRAIN][ep=032] loss=1.0334 acc=75.57%
[TRAIN][ep=032] mask_avg: mc_mean=0.2111 mb_mean=0.4721 norm_overlap=0.9959 corr_cb=-0.1530
[EPOCH 032/089] train: loss=1.0334 acc=75.57% | val: loss=0.5935 acc=66.27% f1=73.58% auc=75.23% val_score=55.1934 val_score_bestthr=64.1346 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.211, mb=0.472, no=0.996, corr=-0.153) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.1569 -> 64.1346
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1432 mb_mean=0.4719 norm_overlap=0.9955 corr_cb=-0.1234 topkJ=0.0343
[TRAIN][ep=033] loss=1.1073 acc=75.44%
[TRAIN][ep=033] mask_avg: mc_mean=0.1982 mb_mean=0.4721 norm_overlap=0.9963 corr_cb=-0.1345
[EPOCH 033/089] train: loss=1.1073 acc=75.44% | val: loss=0.5833 acc=67.47% f1=72.73% auc=75.47% val_score=43.0532 val_score_bestthr=64.5305 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.198, mb=0.472, no=0.996, corr=-0.134) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.1569 -> 64.5305
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1903 mb_mean=0.4724 norm_overlap=1.0008 corr_cb=0.0267 topkJ=0.1309
[TRAIN][ep=034] loss=1.1549 acc=78.39%
[TRAIN][ep=034] mask_avg: mc_mean=0.1917 mb_mean=0.4721 norm_overlap=0.9967 corr_cb=-0.1127
[EPOCH 034/089] train: loss=1.1549 acc=78.39% | val: loss=0.5855 acc=65.06% f1=71.29% auc=75.64% val_score=54.4975 val_score_bestthr=62.8433 | dyn(w_pfs=0.100, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.192, mb=0.472, no=0.997, corr=-0.113) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.1569 -> 62.8433
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2439 mb_mean=0.4717 norm_overlap=1.0017 corr_cb=0.0549 topkJ=0.0549
[TRAIN][ep=035] loss=0.9644 acc=79.06%
[TRAIN][ep=035] mask_avg: mc_mean=0.2347 mb_mean=0.4721 norm_overlap=0.9955 corr_cb=-0.1717
[EPOCH 035/089] train: loss=0.9644 acc=79.06% | val: loss=0.6091 acc=66.27% f1=73.58% auc=75.87% val_score=59.7112 val_score_bestthr=64.1346 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.235, mb=0.472, no=0.995, corr=-0.172) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.1569 -> 64.1346
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2046 mb_mean=0.4719 norm_overlap=0.9964 corr_cb=-0.1080 topkJ=0.0375
[TRAIN][ep=036] loss=0.7911 acc=77.85%
[TRAIN][ep=036] mask_avg: mc_mean=0.2137 mb_mean=0.4721 norm_overlap=0.9965 corr_cb=-0.1254
[EPOCH 036/089] train: loss=0.7911 acc=77.85% | val: loss=0.6069 acc=67.47% f1=72.73% auc=77.56% val_score=65.7334 val_score_bestthr=65.7334 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.214, mb=0.472, no=0.997, corr=-0.125) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.1569 -> 65.7334
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1966 mb_mean=0.4646 norm_overlap=0.9949 corr_cb=-0.1657 topkJ=0.0549
[TRAIN][ep=037] loss=0.7737 acc=79.46%
[TRAIN][ep=037] mask_avg: mc_mean=0.2053 mb_mean=0.4721 norm_overlap=0.9964 corr_cb=-0.1287
[EPOCH 037/089] train: loss=0.7737 acc=79.46% | val: loss=0.5850 acc=67.47% f1=74.77% auc=76.51% val_score=43.4442 val_score_bestthr=66.1084 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.205, mb=0.472, no=0.996, corr=-0.129) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.1569 -> 66.1084
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2277 mb_mean=0.4726 norm_overlap=0.9956 corr_cb=-0.1433 topkJ=0.0419
[TRAIN][ep=038] loss=0.7465 acc=79.73%
[TRAIN][ep=038] mask_avg: mc_mean=0.2200 mb_mean=0.4721 norm_overlap=0.9957 corr_cb=-0.1563
[EPOCH 038/089] train: loss=0.7465 acc=79.73% | val: loss=0.5911 acc=65.06% f1=73.87% auc=76.28% val_score=55.4197 val_score_bestthr=67.1732 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.220, mb=0.472, no=0.996, corr=-0.156) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.1569 -> 67.1732
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2079 mb_mean=0.4731 norm_overlap=0.9932 corr_cb=-0.2410 topkJ=0.0284
[TRAIN][ep=039] loss=0.7420 acc=80.81%
[TRAIN][ep=039] mask_avg: mc_mean=0.2351 mb_mean=0.4721 norm_overlap=0.9954 corr_cb=-0.1739
[EPOCH 039/089] train: loss=0.7420 acc=80.81% | val: loss=0.6145 acc=63.86% f1=71.70% auc=75.99% val_score=54.7239 val_score_bestthr=64.4243 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.235, mb=0.472, no=0.995, corr=-0.174) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.1569 -> 64.4243
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.2328 mb_mean=0.4759 norm_overlap=0.9928 corr_cb=-0.2861 topkJ=0.0192
[TRAIN][ep=040] loss=0.7351 acc=80.67%
[TRAIN][ep=040] mask_avg: mc_mean=0.2064 mb_mean=0.4721 norm_overlap=0.9957 corr_cb=-0.1484
[EPOCH 040/089] train: loss=0.7351 acc=80.67% | val: loss=0.6117 acc=65.06% f1=73.39% auc=75.52% val_score=53.1811 val_score_bestthr=67.6761 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.206, mb=0.472, no=0.996, corr=-0.148) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.1569 -> 67.6761
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.2654 mb_mean=0.4749 norm_overlap=0.9956 corr_cb=-0.1835 topkJ=0.0377
[TRAIN][ep=041] loss=0.7453 acc=79.73%
[TRAIN][ep=041] mask_avg: mc_mean=0.2245 mb_mean=0.4721 norm_overlap=0.9952 corr_cb=-0.1768
[EPOCH 041/089] train: loss=0.7453 acc=79.73% | val: loss=0.6406 acc=67.47% f1=75.68% auc=74.94% val_score=60.5207 val_score_bestthr=70.3941 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.225, mb=0.472, no=0.995, corr=-0.177) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 68.1569 -> 70.3941
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.2199 mb_mean=0.4719 norm_overlap=0.9965 corr_cb=-0.1480 topkJ=0.0339
[TRAIN][ep=042] loss=0.8098 acc=81.74%
[TRAIN][ep=042] mask_avg: mc_mean=0.1977 mb_mean=0.4721 norm_overlap=0.9965 corr_cb=-0.1208
[EPOCH 042/089] train: loss=0.8098 acc=81.74% | val: loss=0.6753 acc=66.27% f1=75.00% auc=74.94% val_score=57.8015 val_score_bestthr=70.5083 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.198, mb=0.472, no=0.996, corr=-0.121) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 70.3941 -> 70.5083
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.1844 mb_mean=0.4726 norm_overlap=0.9937 corr_cb=-0.1861 topkJ=0.0353
[TRAIN][ep=043] loss=0.8583 acc=82.82%
[TRAIN][ep=043] mask_avg: mc_mean=0.2317 mb_mean=0.4721 norm_overlap=0.9951 corr_cb=-0.1802
[EPOCH 043/089] train: loss=0.8583 acc=82.82% | val: loss=0.6067 acc=67.47% f1=73.79% auc=76.80% val_score=51.3813 val_score_bestthr=66.9679 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.232, mb=0.472, no=0.995, corr=-0.180) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5083 -> 66.9679
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2525 mb_mean=0.4690 norm_overlap=0.9942 corr_cb=-0.2215 topkJ=0.0287
[TRAIN][ep=044] loss=0.9431 acc=80.67%
[TRAIN][ep=044] mask_avg: mc_mean=0.2418 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1924
[EPOCH 044/089] train: loss=0.9431 acc=80.67% | val: loss=0.6503 acc=68.67% f1=75.47% auc=77.09% val_score=58.8690 val_score_bestthr=68.0317 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.242, mb=0.472, no=0.995, corr=-0.192) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5083 -> 68.0317
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2096 mb_mean=0.4723 norm_overlap=0.9966 corr_cb=-0.1215 topkJ=0.0596
[TRAIN][ep=045] loss=0.9972 acc=82.55%
[TRAIN][ep=045] mask_avg: mc_mean=0.2291 mb_mean=0.4721 norm_overlap=0.9954 corr_cb=-0.1686
[EPOCH 045/089] train: loss=0.9972 acc=82.55% | val: loss=0.7110 acc=65.06% f1=73.87% auc=73.55% val_score=56.1562 val_score_bestthr=68.8906 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.229, mb=0.472, no=0.995, corr=-0.169) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5083 -> 68.8906
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.2359 mb_mean=0.4729 norm_overlap=0.9933 corr_cb=-0.2564 topkJ=0.0153
[TRAIN][ep=046] loss=1.0539 acc=82.95%
[TRAIN][ep=046] mask_avg: mc_mean=0.2458 mb_mean=0.4721 norm_overlap=0.9955 corr_cb=-0.1740
[EPOCH 046/089] train: loss=1.0539 acc=82.95% | val: loss=0.6412 acc=66.27% f1=74.55% auc=75.52% val_score=51.6418 val_score_bestthr=68.7758 | dyn(w_pfs=0.240, w_sup=0.240, w_csuf=0.200, stage2=False) | mask(mc=0.246, mb=0.472, no=0.995, corr=-0.174) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5083 -> 68.7758
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.2111 mb_mean=0.4700 norm_overlap=0.9955 corr_cb=-0.1667 topkJ=0.0419
[TRAIN][ep=047] loss=1.0590 acc=82.55%
[TRAIN][ep=047] mask_avg: mc_mean=0.2336 mb_mean=0.4721 norm_overlap=0.9952 corr_cb=-0.1748
[EPOCH 047/089] train: loss=1.0590 acc=82.55% | val: loss=0.6526 acc=66.27% f1=73.58% auc=75.93% val_score=55.9413 val_score_bestthr=68.8685 | dyn(w_pfs=0.140, w_sup=0.140, w_csuf=0.100, stage2=False) | mask(mc=0.234, mb=0.472, no=0.995, corr=-0.175) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5083 -> 68.8685
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.3197 mb_mean=0.4695 norm_overlap=0.9914 corr_cb=-0.3936 topkJ=0.0091
[TRAIN][ep=048] loss=0.8858 acc=82.68%
[TRAIN][ep=048] mask_avg: mc_mean=0.2608 mb_mean=0.4721 norm_overlap=0.9946 corr_cb=-0.2086
[EPOCH 048/089] train: loss=0.8858 acc=82.68% | val: loss=0.6261 acc=68.67% f1=75.00% auc=76.05% val_score=51.1656 val_score_bestthr=70.5375 | dyn(w_pfs=0.180, w_sup=0.180, w_csuf=0.140, stage2=False) | mask(mc=0.261, mb=0.472, no=0.995, corr=-0.209) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 70.5083 -> 70.5375
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=049] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.2615 mb_mean=0.4735 norm_overlap=0.9955 corr_cb=-0.1816 topkJ=0.0234
[TRAIN][ep=049] loss=0.9325 acc=84.43%
[TRAIN][ep=049] mask_avg: mc_mean=0.2370 mb_mean=0.4721 norm_overlap=0.9954 corr_cb=-0.1678
[EPOCH 049/089] train: loss=0.9325 acc=84.43% | val: loss=0.6289 acc=68.67% f1=75.00% auc=76.45% val_score=56.3108 val_score_bestthr=70.5375 | dyn(w_pfs=0.220, w_sup=0.220, w_csuf=0.180, stage2=False) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.168) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5375 -> 70.5375
[DBG][ep=050] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.2492 mb_mean=0.4713 norm_overlap=0.9908 corr_cb=-0.3377 topkJ=0.0106
[TRAIN][ep=050] loss=0.6826 acc=84.43%
[TRAIN][ep=050] mask_avg: mc_mean=0.2367 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1875
[EPOCH 050/089] train: loss=0.6826 acc=84.43% | val: loss=0.6357 acc=68.67% f1=75.00% auc=76.16% val_score=46.7184 val_score_bestthr=70.5375 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.187) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5375 -> 70.5375
[DBG][ep=051] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.2393 mb_mean=0.4781 norm_overlap=0.9935 corr_cb=-0.2429 topkJ=0.0202
[TRAIN][ep=051] loss=0.6360 acc=85.64%
[TRAIN][ep=051] mask_avg: mc_mean=0.2366 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1855
[EPOCH 051/089] train: loss=0.6360 acc=85.64% | val: loss=0.6558 acc=66.27% f1=74.55% auc=75.87% val_score=53.5483 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.185) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5375 -> 70.2831
[DBG][ep=052] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.2473 mb_mean=0.4697 norm_overlap=0.9951 corr_cb=-0.1677 topkJ=0.0402
[TRAIN][ep=052] loss=0.6343 acc=85.23%
[TRAIN][ep=052] mask_avg: mc_mean=0.2367 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1813
[EPOCH 052/089] train: loss=0.6343 acc=85.23% | val: loss=0.6468 acc=66.27% f1=74.55% auc=75.93% val_score=49.2625 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.181) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5375 -> 70.2831
[DBG][ep=053] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.2024 mb_mean=0.4687 norm_overlap=0.9949 corr_cb=-0.1959 topkJ=0.0296
[TRAIN][ep=053] loss=0.6337 acc=85.91%
[TRAIN][ep=053] mask_avg: mc_mean=0.2367 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1856
[EPOCH 053/089] train: loss=0.6337 acc=85.91% | val: loss=0.6584 acc=66.27% f1=74.55% auc=75.87% val_score=52.0125 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.186) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5375 -> 70.2831
[DBG][ep=054] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=054] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=054] mask(step0): mc_mean=0.2341 mb_mean=0.4716 norm_overlap=0.9988 corr_cb=-0.0447 topkJ=0.0516
[TRAIN][ep=054] loss=0.6315 acc=86.85%
[TRAIN][ep=054] mask_avg: mc_mean=0.2367 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1820
[EPOCH 054/089] train: loss=0.6315 acc=86.85% | val: loss=0.6614 acc=66.27% f1=74.55% auc=75.76% val_score=52.0125 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.182) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5375 -> 70.2831
[DBG][ep=055] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=055] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=055] mask(step0): mc_mean=0.2326 mb_mean=0.4709 norm_overlap=0.9960 corr_cb=-0.1566 topkJ=0.0326
[TRAIN][ep=055] loss=0.6286 acc=85.50%
[TRAIN][ep=055] mask_avg: mc_mean=0.2366 mb_mean=0.4721 norm_overlap=0.9950 corr_cb=-0.1807
[EPOCH 055/089] train: loss=0.6286 acc=85.50% | val: loss=0.6643 acc=66.27% f1=74.55% auc=75.93% val_score=52.0125 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.181) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5375 -> 70.2831
[DBG][ep=056] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=056] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=056] mask(step0): mc_mean=0.2635 mb_mean=0.4722 norm_overlap=0.9934 corr_cb=-0.2328 topkJ=0.0344
[TRAIN][ep=056] loss=0.6259 acc=85.64%
[TRAIN][ep=056] mask_avg: mc_mean=0.2366 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1816
[EPOCH 056/089] train: loss=0.6259 acc=85.64% | val: loss=0.6569 acc=67.47% f1=75.68% auc=75.99% val_score=51.1656 val_score_bestthr=71.9014 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.182) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 70.5375 -> 71.9014
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=057] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=057] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=057] mask(step0): mc_mean=0.2363 mb_mean=0.4721 norm_overlap=0.9963 corr_cb=-0.1432 topkJ=0.0567
[TRAIN][ep=057] loss=0.6272 acc=84.97%
[TRAIN][ep=057] mask_avg: mc_mean=0.2367 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1849
[EPOCH 057/089] train: loss=0.6272 acc=84.97% | val: loss=0.6663 acc=66.27% f1=74.55% auc=75.87% val_score=49.2625 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.185) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.2831
[DBG][ep=058] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=058] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=058] mask(step0): mc_mean=0.3078 mb_mean=0.4710 norm_overlap=0.9936 corr_cb=-0.2551 topkJ=0.0291
[TRAIN][ep=058] loss=0.6213 acc=86.31%
[TRAIN][ep=058] mask_avg: mc_mean=0.2367 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1847
[EPOCH 058/089] train: loss=0.6213 acc=86.31% | val: loss=0.6722 acc=66.27% f1=74.55% auc=75.76% val_score=50.1335 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.185) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.2831
[DBG][ep=059] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=059] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=059] mask(step0): mc_mean=0.2397 mb_mean=0.4713 norm_overlap=0.9930 corr_cb=-0.2228 topkJ=0.0288
[TRAIN][ep=059] loss=0.6198 acc=86.31%
[TRAIN][ep=059] mask_avg: mc_mean=0.2367 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1845
[EPOCH 059/089] train: loss=0.6198 acc=86.31% | val: loss=0.6872 acc=66.27% f1=74.55% auc=75.70% val_score=49.9234 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.185) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.2831
[DBG][ep=060] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=060] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=060] mask(step0): mc_mean=0.2791 mb_mean=0.4667 norm_overlap=0.9903 corr_cb=-0.2881 topkJ=0.0200
[TRAIN][ep=060] loss=0.6163 acc=86.31%
[TRAIN][ep=060] mask_avg: mc_mean=0.2367 mb_mean=0.4721 norm_overlap=0.9950 corr_cb=-0.1807
[EPOCH 060/089] train: loss=0.6163 acc=86.31% | val: loss=0.6654 acc=68.67% f1=75.00% auc=76.05% val_score=53.9142 val_score_bestthr=70.5375 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.181) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.5375
[DBG][ep=061] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=061] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=061] mask(step0): mc_mean=0.2066 mb_mean=0.4745 norm_overlap=0.9960 corr_cb=-0.1514 topkJ=0.0419
[TRAIN][ep=061] loss=0.6157 acc=86.44%
[TRAIN][ep=061] mask_avg: mc_mean=0.2366 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1816
[EPOCH 061/089] train: loss=0.6157 acc=86.44% | val: loss=0.7164 acc=65.06% f1=73.87% auc=75.47% val_score=48.8217 val_score_bestthr=68.8906 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.182) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 68.8906
[DBG][ep=062] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=062] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=062] mask(step0): mc_mean=0.2427 mb_mean=0.4636 norm_overlap=0.9950 corr_cb=-0.1871 topkJ=0.0540
[TRAIN][ep=062] loss=0.6206 acc=87.11%
[TRAIN][ep=062] mask_avg: mc_mean=0.2366 mb_mean=0.4721 norm_overlap=0.9950 corr_cb=-0.1800
[EPOCH 062/089] train: loss=0.6206 acc=87.11% | val: loss=0.6940 acc=67.47% f1=74.29% auc=75.70% val_score=51.4644 val_score_bestthr=69.4284 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.180) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 69.4284
[DBG][ep=063] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=063] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=063] mask(step0): mc_mean=0.2446 mb_mean=0.4693 norm_overlap=0.9969 corr_cb=-0.1238 topkJ=0.0635
[TRAIN][ep=063] loss=0.6133 acc=86.71%
[TRAIN][ep=063] mask_avg: mc_mean=0.2366 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1827
[EPOCH 063/089] train: loss=0.6133 acc=86.71% | val: loss=0.7063 acc=67.47% f1=74.29% auc=75.41% val_score=48.8217 val_score_bestthr=69.4284 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.183) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 69.4284
[DBG][ep=064] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=064] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=064] mask(step0): mc_mean=0.2415 mb_mean=0.4747 norm_overlap=0.9958 corr_cb=-0.1806 topkJ=0.0381
[TRAIN][ep=064] loss=0.6225 acc=85.10%
[TRAIN][ep=064] mask_avg: mc_mean=0.2367 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1850
[EPOCH 064/089] train: loss=0.6225 acc=85.10% | val: loss=0.6743 acc=66.27% f1=75.00% auc=76.16% val_score=53.9142 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.185) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.7981
[DBG][ep=065] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=065] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=065] mask(step0): mc_mean=0.2557 mb_mean=0.4721 norm_overlap=0.9929 corr_cb=-0.2618 topkJ=0.0180
[TRAIN][ep=065] loss=0.6137 acc=86.98%
[TRAIN][ep=065] mask_avg: mc_mean=0.2367 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1821
[EPOCH 065/089] train: loss=0.6137 acc=86.98% | val: loss=0.6845 acc=68.67% f1=75.00% auc=75.99% val_score=50.1335 val_score_bestthr=70.5375 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.182) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.5375
[DBG][ep=066] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=066] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=066] mask(step0): mc_mean=0.2127 mb_mean=0.4743 norm_overlap=0.9949 corr_cb=-0.1756 topkJ=0.0403
[TRAIN][ep=066] loss=0.6139 acc=86.58%
[TRAIN][ep=066] mask_avg: mc_mean=0.2367 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1824
[EPOCH 066/089] train: loss=0.6139 acc=86.58% | val: loss=0.7022 acc=68.67% f1=75.00% auc=75.70% val_score=48.7060 val_score_bestthr=70.5375 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.182) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.5375
[DBG][ep=067] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=067] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=067] mask(step0): mc_mean=0.2346 mb_mean=0.4704 norm_overlap=0.9939 corr_cb=-0.2368 topkJ=0.0276
[TRAIN][ep=067] loss=0.6070 acc=87.25%
[TRAIN][ep=067] mask_avg: mc_mean=0.2367 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1818
[EPOCH 067/089] train: loss=0.6070 acc=87.25% | val: loss=0.6891 acc=68.67% f1=75.00% auc=76.10% val_score=48.6024 val_score_bestthr=70.5375 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.182) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.5375
[DBG][ep=068] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=068] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=068] mask(step0): mc_mean=0.2169 mb_mean=0.4743 norm_overlap=0.9953 corr_cb=-0.1791 topkJ=0.0252
[TRAIN][ep=068] loss=0.6089 acc=86.58%
[TRAIN][ep=068] mask_avg: mc_mean=0.2367 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1820
[EPOCH 068/089] train: loss=0.6089 acc=86.58% | val: loss=0.6964 acc=66.27% f1=74.55% auc=75.76% val_score=50.1335 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.182) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.2831
[DBG][ep=069] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=069] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=069] mask(step0): mc_mean=0.2389 mb_mean=0.4699 norm_overlap=0.9912 corr_cb=-0.3275 topkJ=0.0229
[TRAIN][ep=069] loss=0.6043 acc=87.11%
[TRAIN][ep=069] mask_avg: mc_mean=0.2367 mb_mean=0.4721 norm_overlap=0.9950 corr_cb=-0.1813
[EPOCH 069/089] train: loss=0.6043 acc=87.11% | val: loss=0.6903 acc=66.27% f1=75.00% auc=76.05% val_score=48.6024 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.181) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.7981
[DBG][ep=070] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=070] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=070] mask(step0): mc_mean=0.2376 mb_mean=0.4706 norm_overlap=0.9927 corr_cb=-0.2369 topkJ=0.0296
[TRAIN][ep=070] loss=0.6032 acc=87.11%
[TRAIN][ep=070] mask_avg: mc_mean=0.2367 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1795
[EPOCH 070/089] train: loss=0.6032 acc=87.11% | val: loss=0.6917 acc=66.27% f1=75.00% auc=75.93% val_score=48.6024 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.179) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.7981
[DBG][ep=071] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=071] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=071] mask(step0): mc_mean=0.2399 mb_mean=0.4724 norm_overlap=0.9917 corr_cb=-0.3170 topkJ=0.0226
[TRAIN][ep=071] loss=0.6053 acc=86.58%
[TRAIN][ep=071] mask_avg: mc_mean=0.2366 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1826
[EPOCH 071/089] train: loss=0.6053 acc=86.58% | val: loss=0.7566 acc=68.67% f1=75.00% auc=75.23% val_score=48.8217 val_score_bestthr=70.5375 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.183) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.5375
[DBG][ep=072] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=072] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=072] mask(step0): mc_mean=0.2732 mb_mean=0.4695 norm_overlap=0.9907 corr_cb=-0.3519 topkJ=0.0227
[TRAIN][ep=072] loss=0.6025 acc=86.98%
[TRAIN][ep=072] mask_avg: mc_mean=0.2367 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1816
[EPOCH 072/089] train: loss=0.6025 acc=86.98% | val: loss=0.7136 acc=66.27% f1=74.55% auc=75.70% val_score=46.6347 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.182) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.2831
[DBG][ep=073] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=073] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=073] mask(step0): mc_mean=0.2071 mb_mean=0.4733 norm_overlap=0.9938 corr_cb=-0.1831 topkJ=0.0410
[TRAIN][ep=073] loss=0.6015 acc=86.85%
[TRAIN][ep=073] mask_avg: mc_mean=0.2367 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1814
[EPOCH 073/089] train: loss=0.6015 acc=86.85% | val: loss=0.7127 acc=66.27% f1=74.55% auc=75.64% val_score=49.2625 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.181) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.2831
[DBG][ep=074] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=074] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=074] mask(step0): mc_mean=0.2446 mb_mean=0.4701 norm_overlap=0.9942 corr_cb=-0.1935 topkJ=0.0335
[TRAIN][ep=074] loss=0.5976 acc=86.71%
[TRAIN][ep=074] mask_avg: mc_mean=0.2366 mb_mean=0.4721 norm_overlap=0.9951 corr_cb=-0.1795
[EPOCH 074/089] train: loss=0.5976 acc=86.71% | val: loss=0.6994 acc=67.47% f1=75.68% auc=75.93% val_score=53.9142 val_score_bestthr=71.9014 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.179) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 71.9014
[DBG][ep=075] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=075] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=075] mask(step0): mc_mean=0.2428 mb_mean=0.4685 norm_overlap=0.9931 corr_cb=-0.2621 topkJ=0.0318
[TRAIN][ep=075] loss=0.5979 acc=86.71%
[TRAIN][ep=075] mask_avg: mc_mean=0.2367 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1835
[EPOCH 075/089] train: loss=0.5979 acc=86.71% | val: loss=0.7443 acc=68.67% f1=75.00% auc=75.17% val_score=46.0653 val_score_bestthr=70.5375 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.183) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.5375
[DBG][ep=076] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=076] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=076] mask(step0): mc_mean=0.2187 mb_mean=0.4755 norm_overlap=0.9958 corr_cb=-0.1492 topkJ=0.0401
[TRAIN][ep=076] loss=0.5977 acc=86.71%
[TRAIN][ep=076] mask_avg: mc_mean=0.2366 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1817
[EPOCH 076/089] train: loss=0.5977 acc=86.71% | val: loss=0.7224 acc=66.27% f1=74.55% auc=75.52% val_score=46.6347 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.182) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.2831
[DBG][ep=077] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=077] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=077] mask(step0): mc_mean=0.2545 mb_mean=0.4711 norm_overlap=0.9918 corr_cb=-0.2951 topkJ=0.0187
[TRAIN][ep=077] loss=0.5902 acc=87.92%
[TRAIN][ep=077] mask_avg: mc_mean=0.2367 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1840
[EPOCH 077/089] train: loss=0.5902 acc=87.92% | val: loss=0.7061 acc=66.27% f1=75.00% auc=75.81% val_score=53.9142 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.184) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.7981
[DBG][ep=078] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=078] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=078] mask(step0): mc_mean=0.2058 mb_mean=0.4669 norm_overlap=0.9957 corr_cb=-0.1807 topkJ=0.0574
[TRAIN][ep=078] loss=0.5962 acc=87.52%
[TRAIN][ep=078] mask_avg: mc_mean=0.2367 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1845
[EPOCH 078/089] train: loss=0.5962 acc=87.52% | val: loss=0.7175 acc=66.27% f1=75.00% auc=75.81% val_score=48.6024 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.185) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.7981
[DBG][ep=079] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=079] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=079] mask(step0): mc_mean=0.2725 mb_mean=0.4680 norm_overlap=0.9940 corr_cb=-0.2040 topkJ=0.0242
[TRAIN][ep=079] loss=0.5899 acc=87.92%
[TRAIN][ep=079] mask_avg: mc_mean=0.2367 mb_mean=0.4721 norm_overlap=0.9950 corr_cb=-0.1788
[EPOCH 079/089] train: loss=0.5899 acc=87.92% | val: loss=0.7157 acc=66.27% f1=75.00% auc=75.81% val_score=49.4654 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.179) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.7981
[DBG][ep=080] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=080] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=080] mask(step0): mc_mean=0.2532 mb_mean=0.4747 norm_overlap=0.9935 corr_cb=-0.2419 topkJ=0.0172
[TRAIN][ep=080] loss=0.5919 acc=87.65%
[TRAIN][ep=080] mask_avg: mc_mean=0.2367 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1822
[EPOCH 080/089] train: loss=0.5919 acc=87.65% | val: loss=0.7207 acc=67.47% f1=75.68% auc=75.64% val_score=48.6024 val_score_bestthr=71.9014 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.182) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 71.9014
[DBG][ep=081] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=081] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=081] mask(step0): mc_mean=0.2315 mb_mean=0.4695 norm_overlap=0.9925 corr_cb=-0.2417 topkJ=0.0230
[TRAIN][ep=081] loss=0.5955 acc=87.25%
[TRAIN][ep=081] mask_avg: mc_mean=0.2367 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1848
[EPOCH 081/089] train: loss=0.5955 acc=87.25% | val: loss=0.7176 acc=69.88% f1=76.64% auc=75.70% val_score=60.1205 val_score_bestthr=68.8000 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.185) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 68.8000
[DBG][ep=082] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=082] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=082] mask(step0): mc_mean=0.2411 mb_mean=0.4682 norm_overlap=0.9953 corr_cb=-0.1996 topkJ=0.0491
[TRAIN][ep=082] loss=0.5985 acc=85.77%
[TRAIN][ep=082] mask_avg: mc_mean=0.2367 mb_mean=0.4721 norm_overlap=0.9950 corr_cb=-0.1815
[EPOCH 082/089] train: loss=0.5985 acc=85.77% | val: loss=0.7268 acc=66.27% f1=75.00% auc=75.47% val_score=48.6024 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.181) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.7981
[DBG][ep=083] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=083] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=083] mask(step0): mc_mean=0.2020 mb_mean=0.4737 norm_overlap=0.9945 corr_cb=-0.2017 topkJ=0.0244
[TRAIN][ep=083] loss=0.5873 acc=88.19%
[TRAIN][ep=083] mask_avg: mc_mean=0.2367 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1839
[EPOCH 083/089] train: loss=0.5873 acc=88.19% | val: loss=0.7452 acc=66.27% f1=74.55% auc=75.23% val_score=46.6347 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.184) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 70.2831
[DBG][ep=084] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=084] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=084] mask(step0): mc_mean=0.2473 mb_mean=0.4698 norm_overlap=0.9941 corr_cb=-0.2290 topkJ=0.0308
[TRAIN][ep=084] loss=0.5861 acc=87.65%
[TRAIN][ep=084] mask_avg: mc_mean=0.2367 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1800
[EPOCH 084/089] train: loss=0.5861 acc=87.65% | val: loss=0.7370 acc=67.47% f1=75.68% auc=75.35% val_score=47.5125 val_score_bestthr=71.9014 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.180) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 71.9014
[DBG][ep=085] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=085] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=085] mask(step0): mc_mean=0.2285 mb_mean=0.4751 norm_overlap=0.9981 corr_cb=-0.0792 topkJ=0.0465
[TRAIN][ep=085] loss=0.5851 acc=87.65%
[TRAIN][ep=085] mask_avg: mc_mean=0.2367 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1828
[EPOCH 085/089] train: loss=0.5851 acc=87.65% | val: loss=0.7466 acc=67.47% f1=75.68% auc=75.17% val_score=46.6347 val_score_bestthr=71.9014 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.183) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 71.9014
[DBG][ep=086] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=086] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=086] mask(step0): mc_mean=0.2682 mb_mean=0.4732 norm_overlap=0.9964 corr_cb=-0.1214 topkJ=0.0293
[TRAIN][ep=086] loss=0.5823 acc=88.59%
[TRAIN][ep=086] mask_avg: mc_mean=0.2366 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1803
[EPOCH 086/089] train: loss=0.5823 acc=88.59% | val: loss=0.7322 acc=67.47% f1=75.68% auc=75.52% val_score=48.6024 val_score_bestthr=71.9014 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.180) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.9014 -> 71.9014
[EARLY STOP] no improvement for 30 epochs. best_epoch=56
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
=============== FIT DONE ===============
[BEST] epoch=56 | val_acc=67.47% | val_f1=75.68% | val_auc=75.99% | val_score=51.1656 | val_score_bestthr=71.9014
[TEST@BEST] thr_used=0.500 | acc=61.84% f1=66.38% auc=65.37% | SP_sex=0.65% EO_sex=0.12% SP_age=11.90% EO_age=12.35%
[TIME] 1.99 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/summary_fold_0.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4732 mb_mean=0.4739 norm_overlap=1.0003 corr_cb=0.4202 topkJ=0.1261
[TRAIN][ep=000] loss=0.6955 acc=51.54%
[TRAIN][ep=000] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3729
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4746 mb_mean=0.4736 norm_overlap=1.0001 corr_cb=0.2526 topkJ=0.1426
[TRAIN][ep=001] loss=0.6932 acc=50.74%
[TRAIN][ep=001] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3696
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4719 mb_mean=0.4692 norm_overlap=1.0002 corr_cb=0.4403 topkJ=0.2099
[TRAIN][ep=002] loss=0.6920 acc=50.60%
[TRAIN][ep=002] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3688
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4696 mb_mean=0.4711 norm_overlap=1.0003 corr_cb=0.4991 topkJ=0.2274
[TRAIN][ep=003] loss=0.6903 acc=55.57%
[TRAIN][ep=003] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3683
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4752 mb_mean=0.4728 norm_overlap=1.0003 corr_cb=0.4629 topkJ=0.1590
[TRAIN][ep=004] loss=0.6892 acc=52.21%
[TRAIN][ep=004] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3684
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4723 mb_mean=0.4722 norm_overlap=1.0002 corr_cb=0.3577 topkJ=0.1944
[TRAIN][ep=005] loss=0.6859 acc=55.17%
[TRAIN][ep=005] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3689
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4731 mb_mean=0.4733 norm_overlap=1.0004 corr_cb=0.5633 topkJ=0.1681
[TRAIN][ep=006] loss=0.6864 acc=57.45%
[TRAIN][ep=006] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3653
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4723 mb_mean=0.4718 norm_overlap=1.0002 corr_cb=0.4549 topkJ=0.1869
[TRAIN][ep=007] loss=0.6834 acc=58.39%
[TRAIN][ep=007] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3710
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4734 mb_mean=0.4747 norm_overlap=1.0002 corr_cb=0.3617 topkJ=0.1959
[TRAIN][ep=008] loss=0.6814 acc=59.60%
[TRAIN][ep=008] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3700
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4744 mb_mean=0.4729 norm_overlap=1.0001 corr_cb=0.3126 topkJ=0.0962
[TRAIN][ep=009] loss=0.6766 acc=59.33%
[TRAIN][ep=009] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3704
================= FIT START (fold=0) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4740 mb_mean=0.4722 norm_overlap=1.0002 corr_cb=0.3730 topkJ=0.1775
[TRAIN][ep=000] loss=0.6722 acc=61.61%
[TRAIN][ep=000] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3748
[EPOCH 000/089] train: loss=0.6722 acc=61.61% | val: loss=0.6833 acc=60.24% f1=63.74% auc=60.52% val_score=37.0937 val_score_bestthr=61.8943 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.375) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 61.8943
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4741 mb_mean=0.4758 norm_overlap=1.0000 corr_cb=0.0718 topkJ=0.1290
[TRAIN][ep=001] loss=0.6663 acc=59.46%
[TRAIN][ep=001] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3678
[EPOCH 001/089] train: loss=0.6663 acc=59.46% | val: loss=0.6969 acc=59.04% f1=63.83% auc=58.26% val_score=54.9121 val_score_bestthr=59.1945 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.368) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.8943 -> 59.1945
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4768 mb_mean=0.4754 norm_overlap=1.0002 corr_cb=0.3045 topkJ=0.2290
[TRAIN][ep=002] loss=0.6649 acc=61.21%
[TRAIN][ep=002] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3720
[EPOCH 002/089] train: loss=0.6649 acc=61.21% | val: loss=0.6742 acc=61.45% f1=65.22% auc=63.84% val_score=56.8472 val_score_bestthr=60.5498 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.372) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.8943 -> 60.5498
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4684 mb_mean=0.4694 norm_overlap=1.0003 corr_cb=0.5137 topkJ=0.2279
[TRAIN][ep=003] loss=0.6626 acc=62.82%
[TRAIN][ep=003] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3689
[EPOCH 003/089] train: loss=0.6626 acc=62.82% | val: loss=0.6674 acc=63.86% f1=66.67% auc=65.12% val_score=55.0292 val_score_bestthr=62.2240 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.369) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 61.8943 -> 62.2240
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4725 mb_mean=0.4704 norm_overlap=1.0002 corr_cb=0.4488 topkJ=0.1783
[TRAIN][ep=004] loss=0.6562 acc=64.16%
[TRAIN][ep=004] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3726
[EPOCH 004/089] train: loss=0.6562 acc=64.16% | val: loss=0.6847 acc=60.24% f1=63.74% auc=60.87% val_score=40.1125 val_score_bestthr=58.9269 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.373) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.2240 -> 58.9269
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4748 mb_mean=0.4735 norm_overlap=1.0001 corr_cb=0.2218 topkJ=0.0905
[TRAIN][ep=005] loss=1.2693 acc=61.88%
[TRAIN][ep=005] mask_avg: mc_mean=0.3876 mb_mean=0.4721 norm_overlap=1.0015 corr_cb=0.5388
[EPOCH 005/089] train: loss=1.2693 acc=61.88% | val: loss=0.6672 acc=68.67% f1=71.11% auc=66.51% val_score=47.1564 val_score_bestthr=64.3671 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.388, mb=0.472, no=1.001, corr=0.539) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 62.2240 -> 64.3671
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.3084 mb_mean=0.4730 norm_overlap=1.0015 corr_cb=0.3856 topkJ=0.2138
[TRAIN][ep=006] loss=1.2571 acc=62.82%
[TRAIN][ep=006] mask_avg: mc_mean=0.2833 mb_mean=0.4721 norm_overlap=1.0032 corr_cb=0.5042
[EPOCH 006/089] train: loss=1.2571 acc=62.82% | val: loss=0.6896 acc=60.24% f1=65.26% auc=61.74% val_score=50.2325 val_score_bestthr=58.0251 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.283, mb=0.472, no=1.003, corr=0.504) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 58.0251
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2516 mb_mean=0.4707 norm_overlap=1.0066 corr_cb=0.6434 topkJ=0.2148
[TRAIN][ep=007] loss=1.2545 acc=62.42%
[TRAIN][ep=007] mask_avg: mc_mean=0.2556 mb_mean=0.4721 norm_overlap=1.0036 corr_cb=0.4674
[EPOCH 007/089] train: loss=1.2545 acc=62.42% | val: loss=0.6560 acc=67.47% f1=69.66% auc=68.37% val_score=61.7986 val_score_bestthr=64.3484 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.256, mb=0.472, no=1.004, corr=0.467) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 64.3484
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2819 mb_mean=0.4760 norm_overlap=1.0019 corr_cb=0.3009 topkJ=0.1950
[TRAIN][ep=008] loss=1.2384 acc=65.23%
[TRAIN][ep=008] mask_avg: mc_mean=0.2413 mb_mean=0.4721 norm_overlap=1.0033 corr_cb=0.3744
[EPOCH 008/089] train: loss=1.2384 acc=65.23% | val: loss=0.6572 acc=65.06% f1=68.13% auc=67.15% val_score=43.3431 val_score_bestthr=60.2272 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.241, mb=0.472, no=1.003, corr=0.374) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 60.2272
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2192 mb_mean=0.4697 norm_overlap=1.0051 corr_cb=0.4697 topkJ=0.1620
[TRAIN][ep=009] loss=1.2308 acc=66.31%
[TRAIN][ep=009] mask_avg: mc_mean=0.2324 mb_mean=0.4721 norm_overlap=1.0031 corr_cb=0.3199
[EPOCH 009/089] train: loss=1.2308 acc=66.31% | val: loss=0.6978 acc=61.45% f1=65.96% auc=61.63% val_score=54.9121 val_score_bestthr=60.3341 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.232, mb=0.472, no=1.003, corr=0.320) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 60.3341
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.2348 mb_mean=0.4726 norm_overlap=1.0041 corr_cb=0.3899 topkJ=0.1049
[TRAIN][ep=010] loss=1.2394 acc=63.89%
[TRAIN][ep=010] mask_avg: mc_mean=0.2249 mb_mean=0.4721 norm_overlap=1.0028 corr_cb=0.2641
[EPOCH 010/089] train: loss=1.2394 acc=63.89% | val: loss=0.6456 acc=56.63% f1=70.49% auc=70.64% val_score=51.8684 val_score_bestthr=63.9539 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.225, mb=0.472, no=1.003, corr=0.264) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 63.9539
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.2354 mb_mean=0.4757 norm_overlap=1.0018 corr_cb=0.2185 topkJ=0.0723
[TRAIN][ep=011] loss=1.0199 acc=65.10%
[TRAIN][ep=011] mask_avg: mc_mean=0.2072 mb_mean=0.4721 norm_overlap=1.0027 corr_cb=0.2174
[EPOCH 011/089] train: loss=1.0199 acc=65.10% | val: loss=0.6384 acc=63.86% f1=70.59% auc=69.77% val_score=52.1119 val_score_bestthr=59.4672 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.207, mb=0.472, no=1.003, corr=0.217) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 59.4672
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.2042 mb_mean=0.4710 norm_overlap=1.0038 corr_cb=0.2758 topkJ=0.1217
[TRAIN][ep=012] loss=0.8063 acc=68.59%
[TRAIN][ep=012] mask_avg: mc_mean=0.2040 mb_mean=0.4721 norm_overlap=1.0018 corr_cb=0.1256
[EPOCH 012/089] train: loss=0.8063 acc=68.59% | val: loss=0.6369 acc=61.45% f1=69.23% auc=69.19% val_score=53.9989 val_score_bestthr=56.6039 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.204, mb=0.472, no=1.002, corr=0.126) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 56.6039
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.2349 mb_mean=0.4762 norm_overlap=0.9999 corr_cb=-0.0074 topkJ=0.0601
[TRAIN][ep=013] loss=0.7663 acc=67.79%
[TRAIN][ep=013] mask_avg: mc_mean=0.2109 mb_mean=0.4721 norm_overlap=1.0005 corr_cb=0.0276
[EPOCH 013/089] train: loss=0.7663 acc=67.79% | val: loss=0.6310 acc=65.06% f1=70.71% auc=69.36% val_score=56.1210 val_score_bestthr=58.7200 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.211, mb=0.472, no=1.001, corr=0.028) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 58.7200
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.2205 mb_mean=0.4743 norm_overlap=1.0008 corr_cb=0.0506 topkJ=0.0783
[TRAIN][ep=014] loss=0.7419 acc=71.28%
[TRAIN][ep=014] mask_avg: mc_mean=0.1997 mb_mean=0.4721 norm_overlap=0.9998 corr_cb=-0.0171
[EPOCH 014/089] train: loss=0.7419 acc=71.28% | val: loss=0.6274 acc=57.83% f1=71.07% auc=69.94% val_score=55.6749 val_score_bestthr=63.8258 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.200, mb=0.472, no=1.000, corr=-0.017) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 63.8258
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1500 mb_mean=0.4689 norm_overlap=1.0013 corr_cb=0.0604 topkJ=0.0448
[TRAIN][ep=015] loss=0.7357 acc=71.01%
[TRAIN][ep=015] mask_avg: mc_mean=0.1733 mb_mean=0.4721 norm_overlap=0.9999 corr_cb=-0.0131
[EPOCH 015/089] train: loss=0.7357 acc=71.01% | val: loss=0.6624 acc=57.83% f1=71.07% auc=67.73% val_score=51.1388 val_score_bestthr=63.8258 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.173, mb=0.472, no=1.000, corr=-0.013) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 63.8258
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1874 mb_mean=0.4714 norm_overlap=1.0019 corr_cb=0.0983 topkJ=0.0484
[TRAIN][ep=016] loss=0.7301 acc=71.54%
[TRAIN][ep=016] mask_avg: mc_mean=0.1800 mb_mean=0.4721 norm_overlap=0.9991 corr_cb=-0.0461
[EPOCH 016/089] train: loss=0.7301 acc=71.54% | val: loss=0.6186 acc=65.06% f1=71.29% auc=70.41% val_score=54.7723 val_score_bestthr=58.8239 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.180, mb=0.472, no=0.999, corr=-0.046) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 58.8239
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1975 mb_mean=0.4756 norm_overlap=0.9979 corr_cb=-0.1115 topkJ=0.0333
[TRAIN][ep=017] loss=0.7174 acc=71.54%
[TRAIN][ep=017] mask_avg: mc_mean=0.1805 mb_mean=0.4721 norm_overlap=0.9985 corr_cb=-0.0675
[EPOCH 017/089] train: loss=0.7174 acc=71.54% | val: loss=0.6210 acc=66.27% f1=71.43% auc=70.70% val_score=42.0368 val_score_bestthr=59.8302 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.180, mb=0.472, no=0.999, corr=-0.068) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 59.8302
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.2108 mb_mean=0.4736 norm_overlap=0.9971 corr_cb=-0.1448 topkJ=0.0197
[TRAIN][ep=018] loss=0.7137 acc=72.48%
[TRAIN][ep=018] mask_avg: mc_mean=0.2119 mb_mean=0.4721 norm_overlap=0.9972 corr_cb=-0.1308
[EPOCH 018/089] train: loss=0.7137 acc=72.48% | val: loss=0.6183 acc=66.27% f1=71.43% auc=72.27% val_score=49.0581 val_score_bestthr=59.8302 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.212, mb=0.472, no=0.997, corr=-0.131) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 59.8302
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1688 mb_mean=0.4748 norm_overlap=0.9932 corr_cb=-0.3071 topkJ=0.0080
[TRAIN][ep=019] loss=0.7057 acc=73.83%
[TRAIN][ep=019] mask_avg: mc_mean=0.1910 mb_mean=0.4721 norm_overlap=0.9977 corr_cb=-0.1105
[EPOCH 019/089] train: loss=0.7057 acc=73.83% | val: loss=0.5974 acc=63.86% f1=71.15% auc=72.85% val_score=40.5170 val_score_bestthr=60.8455 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.191, mb=0.472, no=0.998, corr=-0.110) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 60.8455
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1058 mb_mean=0.4736 norm_overlap=1.0015 corr_cb=0.0402 topkJ=0.0338
[TRAIN][ep=020] loss=0.7056 acc=71.54%
[TRAIN][ep=020] mask_avg: mc_mean=0.1898 mb_mean=0.4721 norm_overlap=0.9974 corr_cb=-0.1154
[EPOCH 020/089] train: loss=0.7056 acc=71.54% | val: loss=0.6410 acc=66.27% f1=70.83% auc=70.70% val_score=56.2353 val_score_bestthr=60.9269 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.472, no=0.997, corr=-0.115) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 60.9269
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.1857 mb_mean=0.4700 norm_overlap=0.9969 corr_cb=-0.1297 topkJ=0.0358
[TRAIN][ep=021] loss=0.7082 acc=71.01%
[TRAIN][ep=021] mask_avg: mc_mean=0.2170 mb_mean=0.4721 norm_overlap=0.9967 corr_cb=-0.1452
[EPOCH 021/089] train: loss=0.7082 acc=71.01% | val: loss=0.6025 acc=67.47% f1=72.73% auc=73.78% val_score=47.4146 val_score_bestthr=62.7938 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.217, mb=0.472, no=0.997, corr=-0.145) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 62.7938
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1889 mb_mean=0.4722 norm_overlap=0.9980 corr_cb=-0.0730 topkJ=0.0355
[TRAIN][ep=022] loss=0.6885 acc=74.23%
[TRAIN][ep=022] mask_avg: mc_mean=0.1982 mb_mean=0.4721 norm_overlap=0.9972 corr_cb=-0.1213
[EPOCH 022/089] train: loss=0.6885 acc=74.23% | val: loss=0.6133 acc=66.27% f1=72.00% auc=71.92% val_score=52.9009 val_score_bestthr=61.6828 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.198, mb=0.472, no=0.997, corr=-0.121) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 61.6828
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1901 mb_mean=0.4728 norm_overlap=0.9965 corr_cb=-0.1367 topkJ=0.0363
[TRAIN][ep=023] loss=0.6829 acc=72.62%
[TRAIN][ep=023] mask_avg: mc_mean=0.2015 mb_mean=0.4721 norm_overlap=0.9967 corr_cb=-0.1303
[EPOCH 023/089] train: loss=0.6829 acc=72.62% | val: loss=0.5968 acc=67.47% f1=72.73% auc=75.00% val_score=55.7489 val_score_bestthr=63.3131 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.201, mb=0.472, no=0.997, corr=-0.130) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 63.3131
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2289 mb_mean=0.4734 norm_overlap=0.9983 corr_cb=-0.0672 topkJ=0.0437
[TRAIN][ep=024] loss=0.6732 acc=74.77%
[TRAIN][ep=024] mask_avg: mc_mean=0.2082 mb_mean=0.4721 norm_overlap=0.9960 corr_cb=-0.1581
[EPOCH 024/089] train: loss=0.6732 acc=74.77% | val: loss=0.6102 acc=67.47% f1=72.73% auc=72.91% val_score=50.5935 val_score_bestthr=62.7938 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.208, mb=0.472, no=0.996, corr=-0.158) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 62.7938
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1803 mb_mean=0.4715 norm_overlap=0.9998 corr_cb=-0.0057 topkJ=0.0386
[TRAIN][ep=025] loss=0.6640 acc=75.57%
[TRAIN][ep=025] mask_avg: mc_mean=0.2032 mb_mean=0.4721 norm_overlap=0.9963 corr_cb=-0.1393
[EPOCH 025/089] train: loss=0.6640 acc=75.57% | val: loss=0.5954 acc=66.27% f1=72.55% auc=73.95% val_score=55.5456 val_score_bestthr=63.5006 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.203, mb=0.472, no=0.996, corr=-0.139) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 63.5006
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1456 mb_mean=0.4765 norm_overlap=0.9969 corr_cb=-0.1181 topkJ=0.0444
[TRAIN][ep=026] loss=0.6603 acc=75.84%
[TRAIN][ep=026] mask_avg: mc_mean=0.1657 mb_mean=0.4721 norm_overlap=0.9975 corr_cb=-0.0925
[EPOCH 026/089] train: loss=0.6603 acc=75.84% | val: loss=0.5922 acc=66.27% f1=73.08% auc=73.72% val_score=44.1270 val_score_bestthr=60.2255 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.166, mb=0.472, no=0.997, corr=-0.093) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 60.2255
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.3203 mb_mean=0.4714 norm_overlap=0.9929 corr_cb=-0.3493 topkJ=0.0173
[TRAIN][ep=027] loss=0.6694 acc=74.77%
[TRAIN][ep=027] mask_avg: mc_mean=0.2088 mb_mean=0.4721 norm_overlap=0.9963 corr_cb=-0.1437
[EPOCH 027/089] train: loss=0.6694 acc=74.77% | val: loss=0.6192 acc=66.27% f1=72.00% auc=73.60% val_score=57.8015 val_score_bestthr=61.6828 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.209, mb=0.472, no=0.996, corr=-0.144) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 61.6828
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1667 mb_mean=0.4701 norm_overlap=0.9972 corr_cb=-0.0770 topkJ=0.0257
[TRAIN][ep=028] loss=0.6505 acc=75.17%
[TRAIN][ep=028] mask_avg: mc_mean=0.2057 mb_mean=0.4721 norm_overlap=0.9962 corr_cb=-0.1416
[EPOCH 028/089] train: loss=0.6505 acc=75.17% | val: loss=0.6429 acc=63.86% f1=71.15% auc=73.08% val_score=58.5426 val_score_bestthr=61.9239 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.206, mb=0.472, no=0.996, corr=-0.142) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 61.9239
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2115 mb_mean=0.4737 norm_overlap=0.9971 corr_cb=-0.1351 topkJ=0.0408
[TRAIN][ep=029] loss=0.6591 acc=74.90%
[TRAIN][ep=029] mask_avg: mc_mean=0.2116 mb_mean=0.4721 norm_overlap=0.9964 corr_cb=-0.1418
[EPOCH 029/089] train: loss=0.6591 acc=74.90% | val: loss=0.5845 acc=67.47% f1=72.73% auc=75.29% val_score=53.5782 val_score_bestthr=64.5305 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.212, mb=0.472, no=0.996, corr=-0.142) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 64.3671 -> 64.5305
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2170 mb_mean=0.4712 norm_overlap=0.9947 corr_cb=-0.1813 topkJ=0.0564
[TRAIN][ep=030] loss=0.7147 acc=76.38%
[TRAIN][ep=030] mask_avg: mc_mean=0.2053 mb_mean=0.4721 norm_overlap=0.9960 corr_cb=-0.1453
[EPOCH 030/089] train: loss=0.7147 acc=76.38% | val: loss=0.6124 acc=65.06% f1=71.84% auc=74.65% val_score=57.8015 val_score_bestthr=63.1539 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.205, mb=0.472, no=0.996, corr=-0.145) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.5305 -> 63.1539
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2044 mb_mean=0.4716 norm_overlap=0.9952 corr_cb=-0.1768 topkJ=0.0402
[TRAIN][ep=031] loss=0.7806 acc=77.72%
[TRAIN][ep=031] mask_avg: mc_mean=0.1901 mb_mean=0.4721 norm_overlap=0.9964 corr_cb=-0.1245
[EPOCH 031/089] train: loss=0.7806 acc=77.72% | val: loss=0.5916 acc=63.86% f1=72.73% auc=74.36% val_score=54.7092 val_score_bestthr=61.5939 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.190, mb=0.472, no=0.996, corr=-0.125) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.5305 -> 61.5939
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2224 mb_mean=0.4736 norm_overlap=0.9967 corr_cb=-0.1355 topkJ=0.0356
[TRAIN][ep=032] loss=0.8563 acc=76.24%
[TRAIN][ep=032] mask_avg: mc_mean=0.2105 mb_mean=0.4721 norm_overlap=0.9959 corr_cb=-0.1543
[EPOCH 032/089] train: loss=0.8563 acc=76.24% | val: loss=0.5998 acc=65.06% f1=71.29% auc=74.71% val_score=55.1934 val_score_bestthr=62.8433 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.211, mb=0.472, no=0.996, corr=-0.154) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.5305 -> 62.8433
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1416 mb_mean=0.4719 norm_overlap=0.9955 corr_cb=-0.1228 topkJ=0.0339
[TRAIN][ep=033] loss=0.9279 acc=75.17%
[TRAIN][ep=033] mask_avg: mc_mean=0.1929 mb_mean=0.4721 norm_overlap=0.9963 corr_cb=-0.1300
[EPOCH 033/089] train: loss=0.9279 acc=75.17% | val: loss=0.5870 acc=65.06% f1=72.38% auc=75.12% val_score=47.0897 val_score_bestthr=63.0938 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.193, mb=0.472, no=0.996, corr=-0.130) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.5305 -> 63.0938
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1900 mb_mean=0.4724 norm_overlap=1.0007 corr_cb=0.0246 topkJ=0.1324
[TRAIN][ep=034] loss=0.9783 acc=77.85%
[TRAIN][ep=034] mask_avg: mc_mean=0.1914 mb_mean=0.4721 norm_overlap=0.9967 corr_cb=-0.1147
[EPOCH 034/089] train: loss=0.9783 acc=77.85% | val: loss=0.5883 acc=63.86% f1=70.59% auc=75.29% val_score=51.7490 val_score_bestthr=61.7365 | dyn(w_pfs=0.100, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.191, mb=0.472, no=0.997, corr=-0.115) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.5305 -> 61.7365
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2446 mb_mean=0.4717 norm_overlap=1.0017 corr_cb=0.0543 topkJ=0.0536
[TRAIN][ep=035] loss=0.7894 acc=78.39%
[TRAIN][ep=035] mask_avg: mc_mean=0.2332 mb_mean=0.4721 norm_overlap=0.9955 corr_cb=-0.1724
[EPOCH 035/089] train: loss=0.7894 acc=78.39% | val: loss=0.6138 acc=65.06% f1=72.38% auc=75.64% val_score=59.7112 val_score_bestthr=64.3112 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.233, mb=0.472, no=0.995, corr=-0.172) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.5305 -> 64.3112
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2023 mb_mean=0.4719 norm_overlap=0.9964 corr_cb=-0.1074 topkJ=0.0379
[TRAIN][ep=036] loss=0.6185 acc=77.18%
[TRAIN][ep=036] mask_avg: mc_mean=0.2096 mb_mean=0.4721 norm_overlap=0.9965 corr_cb=-0.1237
[EPOCH 036/089] train: loss=0.6185 acc=77.18% | val: loss=0.6138 acc=68.67% f1=72.92% auc=77.09% val_score=63.4050 val_score_bestthr=63.4236 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.210, mb=0.472, no=0.997, corr=-0.124) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.5305 -> 63.4236
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1941 mb_mean=0.4646 norm_overlap=0.9948 corr_cb=-0.1676 topkJ=0.0544
[TRAIN][ep=037] loss=0.6009 acc=78.79%
[TRAIN][ep=037] mask_avg: mc_mean=0.2032 mb_mean=0.4721 norm_overlap=0.9964 corr_cb=-0.1300
[EPOCH 037/089] train: loss=0.6009 acc=78.79% | val: loss=0.5886 acc=65.06% f1=73.87% auc=76.05% val_score=43.4442 val_score_bestthr=66.1079 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.203, mb=0.472, no=0.996, corr=-0.130) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 64.5305 -> 66.1079
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2272 mb_mean=0.4726 norm_overlap=0.9955 corr_cb=-0.1470 topkJ=0.0414
[TRAIN][ep=038] loss=0.6479 acc=79.46%
[TRAIN][ep=038] mask_avg: mc_mean=0.2169 mb_mean=0.4721 norm_overlap=0.9957 corr_cb=-0.1573
[EPOCH 038/089] train: loss=0.6479 acc=79.46% | val: loss=0.5952 acc=65.06% f1=73.87% auc=75.76% val_score=49.0034 val_score_bestthr=67.1732 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.217, mb=0.472, no=0.996, corr=-0.157) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 66.1079 -> 67.1732
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2085 mb_mean=0.4731 norm_overlap=0.9929 corr_cb=-0.2496 topkJ=0.0267
[TRAIN][ep=039] loss=0.7205 acc=79.87%
[TRAIN][ep=039] mask_avg: mc_mean=0.2299 mb_mean=0.4721 norm_overlap=0.9954 corr_cb=-0.1735
[EPOCH 039/089] train: loss=0.7205 acc=79.87% | val: loss=0.6217 acc=63.86% f1=71.70% auc=75.29% val_score=54.7239 val_score_bestthr=64.4243 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.230, mb=0.472, no=0.995, corr=-0.173) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.1732 -> 64.4243
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.2339 mb_mean=0.4759 norm_overlap=0.9925 corr_cb=-0.2939 topkJ=0.0187
[TRAIN][ep=040] loss=0.7869 acc=80.94%
[TRAIN][ep=040] mask_avg: mc_mean=0.2016 mb_mean=0.4721 norm_overlap=0.9957 corr_cb=-0.1460
[EPOCH 040/089] train: loss=0.7869 acc=80.94% | val: loss=0.6149 acc=65.06% f1=72.90% auc=75.52% val_score=53.1811 val_score_bestthr=67.9917 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.202, mb=0.472, no=0.996, corr=-0.146) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 67.1732 -> 67.9917
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.2480 mb_mean=0.4749 norm_overlap=0.9955 corr_cb=-0.1758 topkJ=0.0381
[TRAIN][ep=041] loss=0.8657 acc=79.87%
[TRAIN][ep=041] mask_avg: mc_mean=0.2236 mb_mean=0.4721 norm_overlap=0.9951 corr_cb=-0.1815
[EPOCH 041/089] train: loss=0.8657 acc=79.87% | val: loss=0.6317 acc=67.47% f1=75.68% auc=74.71% val_score=54.8852 val_score_bestthr=70.3941 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.224, mb=0.472, no=0.995, corr=-0.181) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 67.9917 -> 70.3941
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.2232 mb_mean=0.4719 norm_overlap=0.9964 corr_cb=-0.1552 topkJ=0.0339
[TRAIN][ep=042] loss=0.9280 acc=81.07%
[TRAIN][ep=042] mask_avg: mc_mean=0.2009 mb_mean=0.4721 norm_overlap=0.9962 corr_cb=-0.1306
[EPOCH 042/089] train: loss=0.9280 acc=81.07% | val: loss=0.6735 acc=66.27% f1=75.00% auc=74.13% val_score=59.3779 val_score_bestthr=70.5083 | dyn(w_pfs=0.240, w_sup=0.240, w_csuf=0.200, stage2=False) | mask(mc=0.201, mb=0.472, no=0.996, corr=-0.131) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 70.3941 -> 70.5083
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.1862 mb_mean=0.4726 norm_overlap=0.9933 corr_cb=-0.2013 topkJ=0.0332
[TRAIN][ep=043] loss=0.9152 acc=83.22%
[TRAIN][ep=043] mask_avg: mc_mean=0.2373 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1906
[EPOCH 043/089] train: loss=0.9152 acc=83.22% | val: loss=0.6081 acc=67.47% f1=73.79% auc=76.57% val_score=48.6343 val_score_bestthr=66.9679 | dyn(w_pfs=0.280, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.191) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5083 -> 66.9679
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2483 mb_mean=0.4690 norm_overlap=0.9943 corr_cb=-0.2182 topkJ=0.0287
[TRAIN][ep=044] loss=0.9395 acc=80.54%
[TRAIN][ep=044] mask_avg: mc_mean=0.2445 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1975
[EPOCH 044/089] train: loss=0.9395 acc=80.54% | val: loss=0.6392 acc=67.47% f1=74.77% auc=76.57% val_score=58.8690 val_score_bestthr=66.9240 | dyn(w_pfs=0.320, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.244, mb=0.472, no=0.995, corr=-0.197) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5083 -> 66.9240
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2145 mb_mean=0.4723 norm_overlap=0.9964 corr_cb=-0.1276 topkJ=0.0592
[TRAIN][ep=045] loss=0.9329 acc=82.68%
[TRAIN][ep=045] mask_avg: mc_mean=0.2322 mb_mean=0.4721 norm_overlap=0.9953 corr_cb=-0.1730
[EPOCH 045/089] train: loss=0.9329 acc=82.68% | val: loss=0.7221 acc=65.06% f1=73.87% auc=73.14% val_score=53.5260 val_score_bestthr=68.8906 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.232, mb=0.472, no=0.995, corr=-0.173) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5083 -> 68.8906
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.2322 mb_mean=0.4729 norm_overlap=0.9935 corr_cb=-0.2460 topkJ=0.0173
[TRAIN][ep=046] loss=0.9238 acc=83.36%
[TRAIN][ep=046] mask_avg: mc_mean=0.2474 mb_mean=0.4721 norm_overlap=0.9954 corr_cb=-0.1759
[EPOCH 046/089] train: loss=0.9238 acc=83.36% | val: loss=0.6498 acc=65.06% f1=73.87% auc=74.83% val_score=48.7060 val_score_bestthr=68.8906 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.247, mb=0.472, no=0.995, corr=-0.176) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5083 -> 68.8906
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.2118 mb_mean=0.4700 norm_overlap=0.9954 corr_cb=-0.1706 topkJ=0.0419
[TRAIN][ep=047] loss=0.9179 acc=82.55%
[TRAIN][ep=047] mask_avg: mc_mean=0.2328 mb_mean=0.4721 norm_overlap=0.9952 corr_cb=-0.1740
[EPOCH 047/089] train: loss=0.9179 acc=82.55% | val: loss=0.6591 acc=65.06% f1=73.87% auc=75.35% val_score=50.2470 val_score_bestthr=68.8906 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.233, mb=0.472, no=0.995, corr=-0.174) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5083 -> 68.8906
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.3177 mb_mean=0.4695 norm_overlap=0.9914 corr_cb=-0.3907 topkJ=0.0103
[TRAIN][ep=048] loss=0.7475 acc=82.28%
[TRAIN][ep=048] mask_avg: mc_mean=0.2617 mb_mean=0.4721 norm_overlap=0.9946 corr_cb=-0.2102
[EPOCH 048/089] train: loss=0.7475 acc=82.28% | val: loss=0.6327 acc=66.27% f1=73.58% auc=75.58% val_score=51.1656 val_score_bestthr=70.0714 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.262, mb=0.472, no=0.995, corr=-0.210) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5083 -> 70.0714
[DBG][ep=049] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.2631 mb_mean=0.4735 norm_overlap=0.9955 corr_cb=-0.1834 topkJ=0.0226
[TRAIN][ep=049] loss=0.5418 acc=84.70%
[TRAIN][ep=049] mask_avg: mc_mean=0.2367 mb_mean=0.4721 norm_overlap=0.9954 corr_cb=-0.1685
[EPOCH 049/089] train: loss=0.5418 acc=84.70% | val: loss=0.6369 acc=68.67% f1=75.00% auc=76.05% val_score=50.1193 val_score_bestthr=70.5375 | dyn(w_pfs=0.190, w_sup=0.090, w_csuf=0.040, stage2=False) | mask(mc=0.237, mb=0.472, no=0.995, corr=-0.169) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 70.5083 -> 70.5375
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=050] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.2586 mb_mean=0.4713 norm_overlap=0.9908 corr_cb=-0.3468 topkJ=0.0102
[TRAIN][ep=050] loss=0.5154 acc=85.23%
[TRAIN][ep=050] mask_avg: mc_mean=0.2472 mb_mean=0.4721 norm_overlap=0.9946 corr_cb=-0.1986
[EPOCH 050/089] train: loss=0.5154 acc=85.23% | val: loss=0.6452 acc=67.47% f1=74.29% auc=75.99% val_score=50.9981 val_score_bestthr=69.4284 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.247, mb=0.472, no=0.995, corr=-0.199) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5375 -> 69.4284
[DBG][ep=051] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.2488 mb_mean=0.4781 norm_overlap=0.9933 corr_cb=-0.2551 topkJ=0.0186
[TRAIN][ep=051] loss=0.4720 acc=85.64%
[TRAIN][ep=051] mask_avg: mc_mean=0.2472 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1965
[EPOCH 051/089] train: loss=0.4720 acc=85.64% | val: loss=0.6664 acc=65.06% f1=73.87% auc=75.29% val_score=50.5954 val_score_bestthr=68.8906 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.247, mb=0.472, no=0.995, corr=-0.196) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5375 -> 68.8906
[DBG][ep=052] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.2579 mb_mean=0.4697 norm_overlap=0.9948 corr_cb=-0.1824 topkJ=0.0393
[TRAIN][ep=052] loss=0.4712 acc=85.50%
[TRAIN][ep=052] mask_avg: mc_mean=0.2473 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1925
[EPOCH 052/089] train: loss=0.4712 acc=85.50% | val: loss=0.6554 acc=66.27% f1=74.07% auc=75.47% val_score=50.1335 val_score_bestthr=66.7131 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.247, mb=0.472, no=0.995, corr=-0.192) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5375 -> 66.7131
[DBG][ep=053] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.2121 mb_mean=0.4687 norm_overlap=0.9947 corr_cb=-0.2088 topkJ=0.0283
[TRAIN][ep=053] loss=0.4688 acc=85.23%
[TRAIN][ep=053] mask_avg: mc_mean=0.2472 mb_mean=0.4721 norm_overlap=0.9946 corr_cb=-0.1968
[EPOCH 053/089] train: loss=0.4688 acc=85.23% | val: loss=0.6702 acc=65.06% f1=73.87% auc=75.29% val_score=49.2625 val_score_bestthr=68.8906 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.247, mb=0.472, no=0.995, corr=-0.197) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5375 -> 68.8906
[DBG][ep=054] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=054] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=054] mask(step0): mc_mean=0.2468 mb_mean=0.4716 norm_overlap=0.9982 corr_cb=-0.0683 topkJ=0.0481
[TRAIN][ep=054] loss=0.4685 acc=86.98%
[TRAIN][ep=054] mask_avg: mc_mean=0.2472 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1932
[EPOCH 054/089] train: loss=0.4685 acc=86.98% | val: loss=0.6726 acc=65.06% f1=73.87% auc=75.12% val_score=49.2625 val_score_bestthr=68.8906 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.247, mb=0.472, no=0.995, corr=-0.193) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5375 -> 68.8906
[DBG][ep=055] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=055] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=055] mask(step0): mc_mean=0.2421 mb_mean=0.4709 norm_overlap=0.9961 corr_cb=-0.1609 topkJ=0.0309
[TRAIN][ep=055] loss=0.4659 acc=85.64%
[TRAIN][ep=055] mask_avg: mc_mean=0.2472 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1917
[EPOCH 055/089] train: loss=0.4659 acc=85.64% | val: loss=0.6767 acc=65.06% f1=73.87% auc=75.29% val_score=49.2625 val_score_bestthr=68.8906 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.247, mb=0.472, no=0.995, corr=-0.192) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5375 -> 68.8906
[DBG][ep=056] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=056] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=056] mask(step0): mc_mean=0.2731 mb_mean=0.4722 norm_overlap=0.9934 corr_cb=-0.2380 topkJ=0.0327
[TRAIN][ep=056] loss=0.4633 acc=86.04%
[TRAIN][ep=056] mask_avg: mc_mean=0.2472 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1928
[EPOCH 056/089] train: loss=0.4633 acc=86.04% | val: loss=0.6655 acc=66.27% f1=75.00% auc=75.47% val_score=51.1656 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.247, mb=0.472, no=0.995, corr=-0.193) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 70.5375 -> 70.7981
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=057] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=057] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=057] mask(step0): mc_mean=0.2452 mb_mean=0.4721 norm_overlap=0.9963 corr_cb=-0.1491 topkJ=0.0562
[TRAIN][ep=057] loss=0.4645 acc=85.37%
[TRAIN][ep=057] mask_avg: mc_mean=0.2472 mb_mean=0.4721 norm_overlap=0.9947 corr_cb=-0.1957
[EPOCH 057/089] train: loss=0.4645 acc=85.37% | val: loss=0.6781 acc=67.47% f1=74.29% auc=75.41% val_score=49.2625 val_score_bestthr=69.4284 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.247, mb=0.472, no=0.995, corr=-0.196) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 69.4284
[DBG][ep=058] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=058] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=058] mask(step0): mc_mean=0.3173 mb_mean=0.4710 norm_overlap=0.9937 corr_cb=-0.2595 topkJ=0.0274
[TRAIN][ep=058] loss=0.4595 acc=86.44%
[TRAIN][ep=058] mask_avg: mc_mean=0.2472 mb_mean=0.4721 norm_overlap=0.9947 corr_cb=-0.1960
[EPOCH 058/089] train: loss=0.4595 acc=86.44% | val: loss=0.6825 acc=65.06% f1=74.34% auc=75.29% val_score=49.2625 val_score_bestthr=70.2437 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.247, mb=0.472, no=0.995, corr=-0.196) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.2437
[DBG][ep=059] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=059] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=059] mask(step0): mc_mean=0.2503 mb_mean=0.4713 norm_overlap=0.9929 corr_cb=-0.2347 topkJ=0.0280
[TRAIN][ep=059] loss=0.4579 acc=86.17%
[TRAIN][ep=059] mask_avg: mc_mean=0.2473 mb_mean=0.4721 norm_overlap=0.9947 corr_cb=-0.1958
[EPOCH 059/089] train: loss=0.4579 acc=86.17% | val: loss=0.7003 acc=65.06% f1=73.87% auc=75.29% val_score=49.9234 val_score_bestthr=68.8906 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.247, mb=0.472, no=0.995, corr=-0.196) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 68.8906
[DBG][ep=060] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=060] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=060] mask(step0): mc_mean=0.2886 mb_mean=0.4667 norm_overlap=0.9903 corr_cb=-0.2970 topkJ=0.0200
[TRAIN][ep=060] loss=0.4551 acc=86.44%
[TRAIN][ep=060] mask_avg: mc_mean=0.2472 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1917
[EPOCH 060/089] train: loss=0.4551 acc=86.44% | val: loss=0.6745 acc=67.47% f1=74.29% auc=75.70% val_score=49.4654 val_score_bestthr=69.4284 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.247, mb=0.472, no=0.995, corr=-0.192) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 69.4284
[DBG][ep=061] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=061] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=061] mask(step0): mc_mean=0.2179 mb_mean=0.4745 norm_overlap=0.9958 corr_cb=-0.1667 topkJ=0.0411
[TRAIN][ep=061] loss=0.4537 acc=86.44%
[TRAIN][ep=061] mask_avg: mc_mean=0.2472 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1926
[EPOCH 061/089] train: loss=0.4537 acc=86.44% | val: loss=0.7251 acc=65.06% f1=73.87% auc=74.77% val_score=50.3643 val_score_bestthr=68.8906 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.247, mb=0.472, no=0.995, corr=-0.193) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 68.8906
[DBG][ep=062] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=062] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=062] mask(step0): mc_mean=0.2596 mb_mean=0.4636 norm_overlap=0.9944 corr_cb=-0.2176 topkJ=0.0497
[TRAIN][ep=062] loss=0.4587 acc=86.98%
[TRAIN][ep=062] mask_avg: mc_mean=0.2471 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1911
[EPOCH 062/089] train: loss=0.4587 acc=86.98% | val: loss=0.7095 acc=65.06% f1=73.87% auc=75.17% val_score=44.5298 val_score_bestthr=68.8906 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.247, mb=0.472, no=0.995, corr=-0.191) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 68.8906
[DBG][ep=063] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=063] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=063] mask(step0): mc_mean=0.2564 mb_mean=0.4693 norm_overlap=0.9968 corr_cb=-0.1333 topkJ=0.0621
[TRAIN][ep=063] loss=0.4525 acc=86.44%
[TRAIN][ep=063] mask_avg: mc_mean=0.2472 mb_mean=0.4721 norm_overlap=0.9947 corr_cb=-0.1939
[EPOCH 063/089] train: loss=0.4525 acc=86.44% | val: loss=0.7134 acc=65.06% f1=73.87% auc=75.00% val_score=44.5298 val_score_bestthr=68.8906 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.247, mb=0.472, no=0.995, corr=-0.194) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 68.8906
[DBG][ep=064] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=064] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=064] mask(step0): mc_mean=0.2527 mb_mean=0.4747 norm_overlap=0.9957 corr_cb=-0.1913 topkJ=0.0368
[TRAIN][ep=064] loss=0.4611 acc=84.97%
[TRAIN][ep=064] mask_avg: mc_mean=0.2472 mb_mean=0.4721 norm_overlap=0.9947 corr_cb=-0.1960
[EPOCH 064/089] train: loss=0.4611 acc=84.97% | val: loss=0.6850 acc=65.06% f1=74.34% auc=75.52% val_score=49.4654 val_score_bestthr=70.2437 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.247, mb=0.472, no=0.995, corr=-0.196) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.2437
[DBG][ep=065] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=065] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=065] mask(step0): mc_mean=0.2653 mb_mean=0.4721 norm_overlap=0.9930 corr_cb=-0.2686 topkJ=0.0180
[TRAIN][ep=065] loss=0.4527 acc=86.31%
[TRAIN][ep=065] mask_avg: mc_mean=0.2473 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1930
[EPOCH 065/089] train: loss=0.4527 acc=86.31% | val: loss=0.6944 acc=67.47% f1=73.79% auc=75.23% val_score=50.1335 val_score_bestthr=66.9679 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.247, mb=0.472, no=0.995, corr=-0.193) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 66.9679
[DBG][ep=066] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=066] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=066] mask(step0): mc_mean=0.2234 mb_mean=0.4743 norm_overlap=0.9948 corr_cb=-0.1836 topkJ=0.0394
[TRAIN][ep=066] loss=0.4535 acc=86.58%
[TRAIN][ep=066] mask_avg: mc_mean=0.2473 mb_mean=0.4721 norm_overlap=0.9947 corr_cb=-0.1935
[EPOCH 066/089] train: loss=0.4535 acc=86.58% | val: loss=0.7117 acc=67.47% f1=73.79% auc=75.06% val_score=44.5298 val_score_bestthr=66.9679 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.247, mb=0.472, no=0.995, corr=-0.194) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 66.9679
[DBG][ep=067] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=067] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=067] mask(step0): mc_mean=0.2464 mb_mean=0.4704 norm_overlap=0.9937 corr_cb=-0.2512 topkJ=0.0264
[TRAIN][ep=067] loss=0.4460 acc=87.25%
[TRAIN][ep=067] mask_avg: mc_mean=0.2472 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1927
[EPOCH 067/089] train: loss=0.4460 acc=87.25% | val: loss=0.6979 acc=65.06% f1=74.34% auc=75.17% val_score=50.1335 val_score_bestthr=70.2437 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.247, mb=0.472, no=0.995, corr=-0.193) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.2437
[DBG][ep=068] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=068] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=068] mask(step0): mc_mean=0.2249 mb_mean=0.4743 norm_overlap=0.9953 corr_cb=-0.1824 topkJ=0.0260
[TRAIN][ep=068] loss=0.4486 acc=86.85%
[TRAIN][ep=068] mask_avg: mc_mean=0.2472 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1930
[EPOCH 068/089] train: loss=0.4486 acc=86.85% | val: loss=0.7082 acc=66.27% f1=74.55% auc=75.23% val_score=49.2625 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.247, mb=0.472, no=0.995, corr=-0.193) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.2831
[DBG][ep=069] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=069] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=069] mask(step0): mc_mean=0.2521 mb_mean=0.4699 norm_overlap=0.9912 corr_cb=-0.3400 topkJ=0.0221
[TRAIN][ep=069] loss=0.4435 acc=86.85%
[TRAIN][ep=069] mask_avg: mc_mean=0.2472 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1923
[EPOCH 069/089] train: loss=0.4435 acc=86.85% | val: loss=0.7026 acc=65.06% f1=74.34% auc=75.35% val_score=50.1335 val_score_bestthr=70.2437 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.247, mb=0.472, no=0.995, corr=-0.192) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.2437
[DBG][ep=070] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=070] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=070] mask(step0): mc_mean=0.2472 mb_mean=0.4706 norm_overlap=0.9925 corr_cb=-0.2505 topkJ=0.0288
[TRAIN][ep=070] loss=0.4433 acc=86.98%
[TRAIN][ep=070] mask_avg: mc_mean=0.2472 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1907
[EPOCH 070/089] train: loss=0.4433 acc=86.98% | val: loss=0.7020 acc=66.27% f1=75.00% auc=75.47% val_score=48.6024 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.247, mb=0.472, no=0.995, corr=-0.191) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.7981
[DBG][ep=071] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=071] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=071] mask(step0): mc_mean=0.2500 mb_mean=0.4724 norm_overlap=0.9918 corr_cb=-0.3237 topkJ=0.0226
[TRAIN][ep=071] loss=0.4461 acc=86.85%
[TRAIN][ep=071] mask_avg: mc_mean=0.2472 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1937
[EPOCH 071/089] train: loss=0.4461 acc=86.85% | val: loss=0.7693 acc=67.47% f1=73.79% auc=74.83% val_score=51.9109 val_score_bestthr=66.9679 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.247, mb=0.472, no=0.995, corr=-0.194) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 66.9679
[DBG][ep=072] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=072] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=072] mask(step0): mc_mean=0.2829 mb_mean=0.4695 norm_overlap=0.9908 corr_cb=-0.3571 topkJ=0.0210
[TRAIN][ep=072] loss=0.4426 acc=87.11%
[TRAIN][ep=072] mask_avg: mc_mean=0.2473 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1927
[EPOCH 072/089] train: loss=0.4426 acc=87.11% | val: loss=0.7272 acc=66.27% f1=74.55% auc=74.88% val_score=41.7804 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.247, mb=0.472, no=0.995, corr=-0.193) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.2831
[DBG][ep=073] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=073] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=073] mask(step0): mc_mean=0.2175 mb_mean=0.4733 norm_overlap=0.9936 corr_cb=-0.1954 topkJ=0.0406
[TRAIN][ep=073] loss=0.4425 acc=86.98%
[TRAIN][ep=073] mask_avg: mc_mean=0.2472 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1924
[EPOCH 073/089] train: loss=0.4425 acc=86.98% | val: loss=0.7244 acc=65.06% f1=73.87% auc=75.23% val_score=46.6347 val_score_bestthr=69.1804 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.247, mb=0.472, no=0.995, corr=-0.192) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 69.1804
[DBG][ep=074] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=074] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=074] mask(step0): mc_mean=0.2565 mb_mean=0.4701 norm_overlap=0.9937 corr_cb=-0.2153 topkJ=0.0335
[TRAIN][ep=074] loss=0.4382 acc=86.44%
[TRAIN][ep=074] mask_avg: mc_mean=0.2471 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1903
[EPOCH 074/089] train: loss=0.4382 acc=86.44% | val: loss=0.7096 acc=66.27% f1=75.00% auc=75.52% val_score=49.4654 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.247, mb=0.472, no=0.995, corr=-0.190) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.7981
[DBG][ep=075] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=075] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=075] mask(step0): mc_mean=0.2556 mb_mean=0.4685 norm_overlap=0.9933 corr_cb=-0.2643 topkJ=0.0318
[TRAIN][ep=075] loss=0.4386 acc=86.58%
[TRAIN][ep=075] mask_avg: mc_mean=0.2472 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1946
[EPOCH 075/089] train: loss=0.4386 acc=86.58% | val: loss=0.7584 acc=66.27% f1=74.55% auc=74.77% val_score=46.0653 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.247, mb=0.472, no=0.995, corr=-0.195) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.2831
[DBG][ep=076] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=076] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=076] mask(step0): mc_mean=0.2270 mb_mean=0.4755 norm_overlap=0.9958 corr_cb=-0.1513 topkJ=0.0397
[TRAIN][ep=076] loss=0.4386 acc=86.58%
[TRAIN][ep=076] mask_avg: mc_mean=0.2472 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1928
[EPOCH 076/089] train: loss=0.4386 acc=86.58% | val: loss=0.7351 acc=66.27% f1=74.55% auc=75.06% val_score=43.2045 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.247, mb=0.472, no=0.995, corr=-0.193) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.2831
[DBG][ep=077] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=077] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=077] mask(step0): mc_mean=0.2661 mb_mean=0.4711 norm_overlap=0.9919 corr_cb=-0.3031 topkJ=0.0191
[TRAIN][ep=077] loss=0.4314 acc=88.05%
[TRAIN][ep=077] mask_avg: mc_mean=0.2472 mb_mean=0.4721 norm_overlap=0.9947 corr_cb=-0.1948
[EPOCH 077/089] train: loss=0.4314 acc=88.05% | val: loss=0.7164 acc=66.27% f1=75.00% auc=75.41% val_score=49.4654 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.247, mb=0.472, no=0.995, corr=-0.195) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.7981
[DBG][ep=078] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=078] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=078] mask(step0): mc_mean=0.2203 mb_mean=0.4669 norm_overlap=0.9952 corr_cb=-0.2122 topkJ=0.0531
[TRAIN][ep=078] loss=0.4365 acc=87.52%
[TRAIN][ep=078] mask_avg: mc_mean=0.2473 mb_mean=0.4721 norm_overlap=0.9947 corr_cb=-0.1955
[EPOCH 078/089] train: loss=0.4365 acc=87.52% | val: loss=0.7269 acc=65.06% f1=74.34% auc=75.41% val_score=48.6024 val_score_bestthr=70.2437 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.247, mb=0.472, no=0.995, corr=-0.196) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.2437
[DBG][ep=079] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=079] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=079] mask(step0): mc_mean=0.2839 mb_mean=0.4680 norm_overlap=0.9938 corr_cb=-0.2149 topkJ=0.0229
[TRAIN][ep=079] loss=0.4314 acc=87.92%
[TRAIN][ep=079] mask_avg: mc_mean=0.2472 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1897
[EPOCH 079/089] train: loss=0.4314 acc=87.92% | val: loss=0.7262 acc=66.27% f1=75.00% auc=75.52% val_score=49.4654 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.247, mb=0.472, no=0.995, corr=-0.190) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.7981
[DBG][ep=080] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=080] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=080] mask(step0): mc_mean=0.2640 mb_mean=0.4747 norm_overlap=0.9934 corr_cb=-0.2518 topkJ=0.0168
[TRAIN][ep=080] loss=0.4331 acc=87.79%
[TRAIN][ep=080] mask_avg: mc_mean=0.2472 mb_mean=0.4721 norm_overlap=0.9947 corr_cb=-0.1933
[EPOCH 080/089] train: loss=0.4331 acc=87.79% | val: loss=0.7310 acc=66.27% f1=75.00% auc=75.35% val_score=48.6024 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.247, mb=0.472, no=0.995, corr=-0.193) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.7981
[DBG][ep=081] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=081] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=081] mask(step0): mc_mean=0.2425 mb_mean=0.4695 norm_overlap=0.9923 corr_cb=-0.2602 topkJ=0.0226
[TRAIN][ep=081] loss=0.4369 acc=87.65%
[TRAIN][ep=081] mask_avg: mc_mean=0.2472 mb_mean=0.4721 norm_overlap=0.9947 corr_cb=-0.1957
[EPOCH 081/089] train: loss=0.4369 acc=87.65% | val: loss=0.7268 acc=67.47% f1=73.79% auc=75.29% val_score=53.7278 val_score_bestthr=66.9679 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.247, mb=0.472, no=0.995, corr=-0.196) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 66.9679
[DBG][ep=082] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=082] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=082] mask(step0): mc_mean=0.2544 mb_mean=0.4682 norm_overlap=0.9951 corr_cb=-0.2166 topkJ=0.0483
[TRAIN][ep=082] loss=0.4413 acc=85.91%
[TRAIN][ep=082] mask_avg: mc_mean=0.2472 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1927
[EPOCH 082/089] train: loss=0.4413 acc=85.91% | val: loss=0.7375 acc=66.27% f1=75.00% auc=75.17% val_score=48.6024 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.247, mb=0.472, no=0.995, corr=-0.193) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.7981
[DBG][ep=083] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=083] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=083] mask(step0): mc_mean=0.2112 mb_mean=0.4737 norm_overlap=0.9945 corr_cb=-0.2087 topkJ=0.0239
[TRAIN][ep=083] loss=0.4292 acc=88.19%
[TRAIN][ep=083] mask_avg: mc_mean=0.2472 mb_mean=0.4721 norm_overlap=0.9947 corr_cb=-0.1948
[EPOCH 083/089] train: loss=0.4292 acc=88.19% | val: loss=0.7564 acc=67.47% f1=74.77% auc=75.00% val_score=43.2045 val_score_bestthr=66.9385 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.247, mb=0.472, no=0.995, corr=-0.195) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 66.9385
[DBG][ep=084] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=084] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=084] mask(step0): mc_mean=0.2590 mb_mean=0.4698 norm_overlap=0.9939 corr_cb=-0.2456 topkJ=0.0300
[TRAIN][ep=084] loss=0.4281 acc=87.65%
[TRAIN][ep=084] mask_avg: mc_mean=0.2472 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1911
[EPOCH 084/089] train: loss=0.4281 acc=87.65% | val: loss=0.7484 acc=66.27% f1=75.00% auc=75.23% val_score=47.5125 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.247, mb=0.472, no=0.995, corr=-0.191) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.7981
[DBG][ep=085] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=085] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=085] mask(step0): mc_mean=0.2363 mb_mean=0.4751 norm_overlap=0.9980 corr_cb=-0.0848 topkJ=0.0460
[TRAIN][ep=085] loss=0.4268 acc=87.52%
[TRAIN][ep=085] mask_avg: mc_mean=0.2472 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1937
[EPOCH 085/089] train: loss=0.4268 acc=87.52% | val: loss=0.7599 acc=66.27% f1=75.00% auc=75.12% val_score=43.2045 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.247, mb=0.472, no=0.995, corr=-0.194) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.7981
[DBG][ep=086] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=086] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=086] mask(step0): mc_mean=0.2776 mb_mean=0.4732 norm_overlap=0.9964 corr_cb=-0.1272 topkJ=0.0289
[TRAIN][ep=086] loss=0.4239 acc=88.59%
[TRAIN][ep=086] mask_avg: mc_mean=0.2472 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1915
[EPOCH 086/089] train: loss=0.4239 acc=88.59% | val: loss=0.7441 acc=66.27% f1=75.00% auc=75.29% val_score=48.6024 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.247, mb=0.472, no=0.995, corr=-0.191) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.7981
[EARLY STOP] no improvement for 30 epochs. best_epoch=56
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
=============== FIT DONE ===============
[BEST] epoch=56 | val_acc=66.27% | val_f1=75.00% | val_auc=75.47% | val_score=51.1656 | val_score_bestthr=70.7981
[TEST@BEST] thr_used=0.510 | acc=61.84% f1=66.38% auc=65.74% | SP_sex=0.65% EO_sex=0.12% SP_age=11.90% EO_age=12.35%
[TIME] 2.04 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/summary_fold_0.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4732 mb_mean=0.4739 norm_overlap=1.0003 corr_cb=0.4202 topkJ=0.1261
[TRAIN][ep=000] loss=0.6955 acc=51.54%
[TRAIN][ep=000] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3729
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4746 mb_mean=0.4736 norm_overlap=1.0001 corr_cb=0.2526 topkJ=0.1426
[TRAIN][ep=001] loss=0.6932 acc=50.74%
[TRAIN][ep=001] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3696
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4719 mb_mean=0.4692 norm_overlap=1.0002 corr_cb=0.4403 topkJ=0.2099
[TRAIN][ep=002] loss=0.6920 acc=50.60%
[TRAIN][ep=002] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3688
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4696 mb_mean=0.4711 norm_overlap=1.0003 corr_cb=0.4991 topkJ=0.2274
[TRAIN][ep=003] loss=0.6903 acc=55.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3683
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4752 mb_mean=0.4728 norm_overlap=1.0003 corr_cb=0.4629 topkJ=0.1590
[TRAIN][ep=004] loss=0.6892 acc=52.21%
[TRAIN][ep=004] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3684
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4723 mb_mean=0.4722 norm_overlap=1.0002 corr_cb=0.3577 topkJ=0.1944
[TRAIN][ep=005] loss=0.6859 acc=55.17%
[TRAIN][ep=005] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3689
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4731 mb_mean=0.4733 norm_overlap=1.0004 corr_cb=0.5633 topkJ=0.1681
[TRAIN][ep=006] loss=0.6864 acc=57.32%
[TRAIN][ep=006] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3653
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4723 mb_mean=0.4718 norm_overlap=1.0002 corr_cb=0.4549 topkJ=0.1869
[TRAIN][ep=007] loss=0.6834 acc=58.39%
[TRAIN][ep=007] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3710
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4734 mb_mean=0.4747 norm_overlap=1.0002 corr_cb=0.3617 topkJ=0.1959
[TRAIN][ep=008] loss=0.6814 acc=59.46%
[TRAIN][ep=008] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3700
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4744 mb_mean=0.4729 norm_overlap=1.0001 corr_cb=0.3126 topkJ=0.0962
[TRAIN][ep=009] loss=0.6766 acc=59.33%
[TRAIN][ep=009] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3704
================= FIT START (fold=0) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4740 mb_mean=0.4722 norm_overlap=1.0002 corr_cb=0.3730 topkJ=0.1775
[TRAIN][ep=000] loss=0.6722 acc=61.61%
[TRAIN][ep=000] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3748
[EPOCH 000/089] train: loss=0.6722 acc=61.61% | val: loss=0.6833 acc=60.24% f1=63.74% auc=60.52% val_score=37.0937 val_score_bestthr=61.8943 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.375) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 61.8943
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4741 mb_mean=0.4758 norm_overlap=1.0000 corr_cb=0.0718 topkJ=0.1290
[TRAIN][ep=001] loss=0.6662 acc=59.60%
[TRAIN][ep=001] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3678
[EPOCH 001/089] train: loss=0.6662 acc=59.60% | val: loss=0.6970 acc=59.04% f1=63.83% auc=58.43% val_score=54.9121 val_score_bestthr=59.1945 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.368) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.8943 -> 59.1945
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4768 mb_mean=0.4754 norm_overlap=1.0002 corr_cb=0.3045 topkJ=0.2290
[TRAIN][ep=002] loss=0.6648 acc=61.21%
[TRAIN][ep=002] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3720
[EPOCH 002/089] train: loss=0.6648 acc=61.21% | val: loss=0.6741 acc=60.24% f1=64.52% auc=63.78% val_score=56.8472 val_score_bestthr=59.4427 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.372) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.8943 -> 59.4427
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4684 mb_mean=0.4694 norm_overlap=1.0003 corr_cb=0.5137 topkJ=0.2279
[TRAIN][ep=003] loss=0.6625 acc=62.95%
[TRAIN][ep=003] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3689
[EPOCH 003/089] train: loss=0.6625 acc=62.95% | val: loss=0.6673 acc=63.86% f1=66.67% auc=65.17% val_score=55.0292 val_score_bestthr=62.2240 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.369) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 61.8943 -> 62.2240
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4725 mb_mean=0.4704 norm_overlap=1.0002 corr_cb=0.4488 topkJ=0.1783
[TRAIN][ep=004] loss=0.6562 acc=64.16%
[TRAIN][ep=004] mask_avg: mc_mean=0.4722 mb_mean=0.4721 norm_overlap=1.0002 corr_cb=0.3726
[EPOCH 004/089] train: loss=0.6562 acc=64.16% | val: loss=0.6845 acc=60.24% f1=63.74% auc=60.87% val_score=40.1125 val_score_bestthr=58.9269 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.472, mb=0.472, no=1.000, corr=0.373) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.2240 -> 58.9269
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4748 mb_mean=0.4735 norm_overlap=1.0001 corr_cb=0.2218 topkJ=0.0905
[TRAIN][ep=005] loss=1.3865 acc=62.01%
[TRAIN][ep=005] mask_avg: mc_mean=0.3873 mb_mean=0.4721 norm_overlap=1.0015 corr_cb=0.5392
[EPOCH 005/089] train: loss=1.3865 acc=62.01% | val: loss=0.6672 acc=68.67% f1=71.11% auc=66.28% val_score=47.1564 val_score_bestthr=64.3671 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.387, mb=0.472, no=1.001, corr=0.539) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 62.2240 -> 64.3671
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.3081 mb_mean=0.4730 norm_overlap=1.0015 corr_cb=0.3856 topkJ=0.2138
[TRAIN][ep=006] loss=1.3692 acc=62.68%
[TRAIN][ep=006] mask_avg: mc_mean=0.2831 mb_mean=0.4721 norm_overlap=1.0032 corr_cb=0.5043
[EPOCH 006/089] train: loss=1.3692 acc=62.68% | val: loss=0.6902 acc=60.24% f1=65.26% auc=61.80% val_score=50.2325 val_score_bestthr=58.0251 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.283, mb=0.472, no=1.003, corr=0.504) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 58.0251
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2515 mb_mean=0.4707 norm_overlap=1.0066 corr_cb=0.6434 topkJ=0.2142
[TRAIN][ep=007] loss=1.3662 acc=62.28%
[TRAIN][ep=007] mask_avg: mc_mean=0.2554 mb_mean=0.4721 norm_overlap=1.0036 corr_cb=0.4673
[EPOCH 007/089] train: loss=1.3662 acc=62.28% | val: loss=0.6560 acc=67.47% f1=69.66% auc=68.49% val_score=61.7986 val_score_bestthr=64.3484 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.255, mb=0.472, no=1.004, corr=0.467) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 64.3484
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2819 mb_mean=0.4760 norm_overlap=1.0019 corr_cb=0.3012 topkJ=0.1944
[TRAIN][ep=008] loss=1.3499 acc=65.23%
[TRAIN][ep=008] mask_avg: mc_mean=0.2412 mb_mean=0.4721 norm_overlap=1.0033 corr_cb=0.3749
[EPOCH 008/089] train: loss=1.3499 acc=65.23% | val: loss=0.6576 acc=66.27% f1=68.18% auc=67.03% val_score=43.3431 val_score_bestthr=61.1171 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.241, mb=0.472, no=1.003, corr=0.375) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 61.1171
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2190 mb_mean=0.4697 norm_overlap=1.0051 corr_cb=0.4707 topkJ=0.1620
[TRAIN][ep=009] loss=1.3422 acc=66.44%
[TRAIN][ep=009] mask_avg: mc_mean=0.2321 mb_mean=0.4721 norm_overlap=1.0031 corr_cb=0.3208
[EPOCH 009/089] train: loss=1.3422 acc=66.44% | val: loss=0.6989 acc=61.45% f1=65.96% auc=61.63% val_score=54.9121 val_score_bestthr=60.3341 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.232, mb=0.472, no=1.003, corr=0.321) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 60.3341
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.2346 mb_mean=0.4726 norm_overlap=1.0041 corr_cb=0.3900 topkJ=0.1044
[TRAIN][ep=010] loss=1.3502 acc=63.62%
[TRAIN][ep=010] mask_avg: mc_mean=0.2251 mb_mean=0.4721 norm_overlap=1.0028 corr_cb=0.2642
[EPOCH 010/089] train: loss=1.3502 acc=63.62% | val: loss=0.6455 acc=56.63% f1=70.49% auc=70.52% val_score=51.8684 val_score_bestthr=63.9539 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.225, mb=0.472, no=1.003, corr=0.264) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 63.9539
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.2356 mb_mean=0.4757 norm_overlap=1.0018 corr_cb=0.2186 topkJ=0.0728
[TRAIN][ep=011] loss=1.1364 acc=65.37%
[TRAIN][ep=011] mask_avg: mc_mean=0.2073 mb_mean=0.4721 norm_overlap=1.0027 corr_cb=0.2169
[EPOCH 011/089] train: loss=1.1364 acc=65.37% | val: loss=0.6385 acc=63.86% f1=70.59% auc=69.48% val_score=57.6724 val_score_bestthr=59.4672 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.207, mb=0.472, no=1.003, corr=0.217) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 59.4672
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.2042 mb_mean=0.4710 norm_overlap=1.0038 corr_cb=0.2757 topkJ=0.1212
[TRAIN][ep=012] loss=0.9284 acc=68.86%
[TRAIN][ep=012] mask_avg: mc_mean=0.2037 mb_mean=0.4721 norm_overlap=1.0018 corr_cb=0.1262
[EPOCH 012/089] train: loss=0.9284 acc=68.86% | val: loss=0.6365 acc=66.27% f1=69.57% auc=69.24% val_score=55.1103 val_score_bestthr=59.4604 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.204, mb=0.472, no=1.002, corr=0.126) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 59.4604
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.2346 mb_mean=0.4762 norm_overlap=0.9999 corr_cb=-0.0072 topkJ=0.0606
[TRAIN][ep=013] loss=0.8910 acc=68.32%
[TRAIN][ep=013] mask_avg: mc_mean=0.2107 mb_mean=0.4721 norm_overlap=1.0005 corr_cb=0.0277
[EPOCH 013/089] train: loss=0.8910 acc=68.32% | val: loss=0.6303 acc=65.06% f1=70.71% auc=69.48% val_score=55.6749 val_score_bestthr=58.7200 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.211, mb=0.472, no=1.001, corr=0.028) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 58.7200
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.2204 mb_mean=0.4743 norm_overlap=1.0008 corr_cb=0.0504 topkJ=0.0783
[TRAIN][ep=014] loss=0.8664 acc=71.14%
[TRAIN][ep=014] mask_avg: mc_mean=0.1996 mb_mean=0.4721 norm_overlap=0.9998 corr_cb=-0.0173
[EPOCH 014/089] train: loss=0.8664 acc=71.14% | val: loss=0.6271 acc=59.04% f1=71.67% auc=70.06% val_score=55.6749 val_score_bestthr=63.6992 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.200, mb=0.472, no=1.000, corr=-0.017) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 63.6992
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1502 mb_mean=0.4689 norm_overlap=1.0013 corr_cb=0.0602 topkJ=0.0448
[TRAIN][ep=015] loss=0.8598 acc=71.01%
[TRAIN][ep=015] mask_avg: mc_mean=0.1730 mb_mean=0.4721 norm_overlap=0.9999 corr_cb=-0.0129
[EPOCH 015/089] train: loss=0.8598 acc=71.01% | val: loss=0.6618 acc=57.83% f1=71.07% auc=68.20% val_score=51.1388 val_score_bestthr=63.8258 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.173, mb=0.472, no=1.000, corr=-0.013) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 63.8258
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1863 mb_mean=0.4714 norm_overlap=1.0019 corr_cb=0.0996 topkJ=0.0484
[TRAIN][ep=016] loss=0.8541 acc=71.28%
[TRAIN][ep=016] mask_avg: mc_mean=0.1799 mb_mean=0.4721 norm_overlap=0.9991 corr_cb=-0.0462
[EPOCH 016/089] train: loss=0.8541 acc=71.28% | val: loss=0.6181 acc=65.06% f1=71.29% auc=70.47% val_score=53.9218 val_score_bestthr=58.8239 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.180, mb=0.472, no=0.999, corr=-0.046) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 58.8239
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1977 mb_mean=0.4756 norm_overlap=0.9979 corr_cb=-0.1119 topkJ=0.0333
[TRAIN][ep=017] loss=0.8411 acc=71.41%
[TRAIN][ep=017] mask_avg: mc_mean=0.1799 mb_mean=0.4721 norm_overlap=0.9985 corr_cb=-0.0672
[EPOCH 017/089] train: loss=0.8411 acc=71.41% | val: loss=0.6201 acc=66.27% f1=71.43% auc=70.81% val_score=42.0368 val_score_bestthr=59.8302 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.180, mb=0.472, no=0.999, corr=-0.067) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 59.8302
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.2111 mb_mean=0.4736 norm_overlap=0.9971 corr_cb=-0.1458 topkJ=0.0197
[TRAIN][ep=018] loss=0.8370 acc=72.89%
[TRAIN][ep=018] mask_avg: mc_mean=0.2123 mb_mean=0.4721 norm_overlap=0.9971 corr_cb=-0.1322
[EPOCH 018/089] train: loss=0.8370 acc=72.89% | val: loss=0.6178 acc=66.27% f1=71.43% auc=72.62% val_score=49.0581 val_score_bestthr=59.8302 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.212, mb=0.472, no=0.997, corr=-0.132) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 59.8302
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1686 mb_mean=0.4748 norm_overlap=0.9932 corr_cb=-0.3071 topkJ=0.0080
[TRAIN][ep=019] loss=0.8285 acc=73.83%
[TRAIN][ep=019] mask_avg: mc_mean=0.1905 mb_mean=0.4721 norm_overlap=0.9977 corr_cb=-0.1106
[EPOCH 019/089] train: loss=0.8285 acc=73.83% | val: loss=0.5968 acc=65.06% f1=68.82% auc=72.85% val_score=42.0396 val_score_bestthr=60.0963 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.191, mb=0.472, no=0.998, corr=-0.111) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 60.0963
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1048 mb_mean=0.4736 norm_overlap=1.0015 corr_cb=0.0401 topkJ=0.0342
[TRAIN][ep=020] loss=0.8285 acc=71.95%
[TRAIN][ep=020] mask_avg: mc_mean=0.1901 mb_mean=0.4721 norm_overlap=0.9974 corr_cb=-0.1162
[EPOCH 020/089] train: loss=0.8285 acc=71.95% | val: loss=0.6407 acc=66.27% f1=70.83% auc=70.87% val_score=56.2353 val_score_bestthr=60.9269 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.472, no=0.997, corr=-0.116) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 60.9269
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.1863 mb_mean=0.4700 norm_overlap=0.9969 corr_cb=-0.1313 topkJ=0.0358
[TRAIN][ep=021] loss=0.8305 acc=71.01%
[TRAIN][ep=021] mask_avg: mc_mean=0.2170 mb_mean=0.4721 norm_overlap=0.9967 corr_cb=-0.1453
[EPOCH 021/089] train: loss=0.8305 acc=71.01% | val: loss=0.6014 acc=67.47% f1=72.73% auc=73.90% val_score=47.4146 val_score_bestthr=62.7938 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.217, mb=0.472, no=0.997, corr=-0.145) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 62.7938
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1893 mb_mean=0.4722 norm_overlap=0.9980 corr_cb=-0.0737 topkJ=0.0355
[TRAIN][ep=022] loss=0.8107 acc=74.23%
[TRAIN][ep=022] mask_avg: mc_mean=0.1983 mb_mean=0.4721 norm_overlap=0.9972 corr_cb=-0.1217
[EPOCH 022/089] train: loss=0.8107 acc=74.23% | val: loss=0.6128 acc=66.27% f1=72.00% auc=71.98% val_score=52.9009 val_score_bestthr=61.6828 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.198, mb=0.472, no=0.997, corr=-0.122) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 61.6828
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1903 mb_mean=0.4728 norm_overlap=0.9965 corr_cb=-0.1369 topkJ=0.0380
[TRAIN][ep=023] loss=0.8056 acc=72.35%
[TRAIN][ep=023] mask_avg: mc_mean=0.2017 mb_mean=0.4721 norm_overlap=0.9967 corr_cb=-0.1304
[EPOCH 023/089] train: loss=0.8056 acc=72.35% | val: loss=0.5957 acc=67.47% f1=72.73% auc=74.94% val_score=55.7489 val_score_bestthr=63.3131 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.202, mb=0.472, no=0.997, corr=-0.130) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 63.3131
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2296 mb_mean=0.4734 norm_overlap=0.9983 corr_cb=-0.0682 topkJ=0.0437
[TRAIN][ep=024] loss=0.7945 acc=74.77%
[TRAIN][ep=024] mask_avg: mc_mean=0.2083 mb_mean=0.4721 norm_overlap=0.9960 corr_cb=-0.1576
[EPOCH 024/089] train: loss=0.7945 acc=74.77% | val: loss=0.6088 acc=67.47% f1=72.73% auc=72.91% val_score=50.5935 val_score_bestthr=62.7938 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.208, mb=0.472, no=0.996, corr=-0.158) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 62.7938
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1809 mb_mean=0.4715 norm_overlap=0.9998 corr_cb=-0.0062 topkJ=0.0386
[TRAIN][ep=025] loss=0.7846 acc=75.57%
[TRAIN][ep=025] mask_avg: mc_mean=0.2037 mb_mean=0.4721 norm_overlap=0.9963 corr_cb=-0.1397
[EPOCH 025/089] train: loss=0.7846 acc=75.57% | val: loss=0.5945 acc=66.27% f1=72.55% auc=74.24% val_score=55.5456 val_score_bestthr=63.5006 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.204, mb=0.472, no=0.996, corr=-0.140) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 63.5006
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1447 mb_mean=0.4765 norm_overlap=0.9969 corr_cb=-0.1171 topkJ=0.0444
[TRAIN][ep=026] loss=0.7805 acc=75.97%
[TRAIN][ep=026] mask_avg: mc_mean=0.1664 mb_mean=0.4721 norm_overlap=0.9975 corr_cb=-0.0936
[EPOCH 026/089] train: loss=0.7805 acc=75.97% | val: loss=0.5912 acc=57.83% f1=71.07% auc=74.01% val_score=44.1270 val_score_bestthr=63.8258 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.166, mb=0.472, no=0.997, corr=-0.094) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 63.8258
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.3218 mb_mean=0.4714 norm_overlap=0.9929 corr_cb=-0.3500 topkJ=0.0173
[TRAIN][ep=027] loss=0.7889 acc=74.77%
[TRAIN][ep=027] mask_avg: mc_mean=0.2079 mb_mean=0.4721 norm_overlap=0.9963 corr_cb=-0.1425
[EPOCH 027/089] train: loss=0.7889 acc=74.77% | val: loss=0.6178 acc=67.47% f1=72.73% auc=73.95% val_score=57.8015 val_score_bestthr=62.7938 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.208, mb=0.472, no=0.996, corr=-0.143) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 62.7938
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1682 mb_mean=0.4701 norm_overlap=0.9971 corr_cb=-0.0803 topkJ=0.0253
[TRAIN][ep=028] loss=0.7683 acc=75.30%
[TRAIN][ep=028] mask_avg: mc_mean=0.2057 mb_mean=0.4721 norm_overlap=0.9962 corr_cb=-0.1419
[EPOCH 028/089] train: loss=0.7683 acc=75.30% | val: loss=0.6397 acc=63.86% f1=71.15% auc=73.37% val_score=58.5426 val_score_bestthr=61.9239 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.206, mb=0.472, no=0.996, corr=-0.142) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.3671 -> 61.9239
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2108 mb_mean=0.4737 norm_overlap=0.9972 corr_cb=-0.1336 topkJ=0.0408
[TRAIN][ep=029] loss=0.7767 acc=74.90%
[TRAIN][ep=029] mask_avg: mc_mean=0.2115 mb_mean=0.4721 norm_overlap=0.9964 corr_cb=-0.1418
[EPOCH 029/089] train: loss=0.7767 acc=74.90% | val: loss=0.5822 acc=67.47% f1=72.73% auc=75.70% val_score=53.5782 val_score_bestthr=64.5305 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.212, mb=0.472, no=0.996, corr=-0.142) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 64.3671 -> 64.5305
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2170 mb_mean=0.4712 norm_overlap=0.9948 corr_cb=-0.1805 topkJ=0.0564
[TRAIN][ep=030] loss=0.8293 acc=76.38%
[TRAIN][ep=030] mask_avg: mc_mean=0.2056 mb_mean=0.4721 norm_overlap=0.9960 corr_cb=-0.1461
[EPOCH 030/089] train: loss=0.8293 acc=76.38% | val: loss=0.6132 acc=65.06% f1=71.84% auc=74.77% val_score=56.4907 val_score_bestthr=63.1539 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.206, mb=0.472, no=0.996, corr=-0.146) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.5305 -> 63.1539
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2048 mb_mean=0.4716 norm_overlap=0.9952 corr_cb=-0.1779 topkJ=0.0402
[TRAIN][ep=031] loss=0.8924 acc=77.45%
[TRAIN][ep=031] mask_avg: mc_mean=0.1895 mb_mean=0.4721 norm_overlap=0.9964 corr_cb=-0.1239
[EPOCH 031/089] train: loss=0.8924 acc=77.45% | val: loss=0.5895 acc=63.86% f1=72.73% auc=74.48% val_score=57.2111 val_score_bestthr=61.5939 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.189, mb=0.472, no=0.996, corr=-0.124) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.5305 -> 61.5939
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2210 mb_mean=0.4736 norm_overlap=0.9967 corr_cb=-0.1337 topkJ=0.0356
[TRAIN][ep=032] loss=0.9657 acc=75.84%
[TRAIN][ep=032] mask_avg: mc_mean=0.2103 mb_mean=0.4721 norm_overlap=0.9959 corr_cb=-0.1537
[EPOCH 032/089] train: loss=0.9657 acc=75.84% | val: loss=0.5960 acc=66.27% f1=72.00% auc=74.94% val_score=55.1934 val_score_bestthr=65.1695 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.210, mb=0.472, no=0.996, corr=-0.154) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 64.5305 -> 65.1695
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1415 mb_mean=0.4719 norm_overlap=0.9955 corr_cb=-0.1225 topkJ=0.0348
[TRAIN][ep=033] loss=1.0369 acc=75.44%
[TRAIN][ep=033] mask_avg: mc_mean=0.1946 mb_mean=0.4721 norm_overlap=0.9963 corr_cb=-0.1316
[EPOCH 033/089] train: loss=1.0369 acc=75.44% | val: loss=0.5847 acc=65.06% f1=72.38% auc=75.17% val_score=43.0532 val_score_bestthr=63.0938 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.195, mb=0.472, no=0.996, corr=-0.132) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1695 -> 63.0938
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1896 mb_mean=0.4724 norm_overlap=1.0008 corr_cb=0.0259 topkJ=0.1319
[TRAIN][ep=034] loss=1.0824 acc=78.39%
[TRAIN][ep=034] mask_avg: mc_mean=0.1914 mb_mean=0.4721 norm_overlap=0.9967 corr_cb=-0.1140
[EPOCH 034/089] train: loss=1.0824 acc=78.39% | val: loss=0.5860 acc=65.06% f1=71.29% auc=75.52% val_score=54.4975 val_score_bestthr=62.8433 | dyn(w_pfs=0.240, w_sup=0.240, w_csuf=0.200, stage2=False) | mask(mc=0.191, mb=0.472, no=0.997, corr=-0.114) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1695 -> 62.8433
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2443 mb_mean=0.4717 norm_overlap=1.0017 corr_cb=0.0536 topkJ=0.0545
[TRAIN][ep=035] loss=1.0911 acc=78.66%
[TRAIN][ep=035] mask_avg: mc_mean=0.2302 mb_mean=0.4721 norm_overlap=0.9956 corr_cb=-0.1677
[EPOCH 035/089] train: loss=1.0911 acc=78.66% | val: loss=0.6093 acc=66.27% f1=73.58% auc=75.76% val_score=59.7112 val_score_bestthr=64.1346 | dyn(w_pfs=0.280, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.230, mb=0.472, no=0.996, corr=-0.168) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1695 -> 64.1346
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.1999 mb_mean=0.4719 norm_overlap=0.9965 corr_cb=-0.1028 topkJ=0.0379
[TRAIN][ep=036] loss=1.1157 acc=77.58%
[TRAIN][ep=036] mask_avg: mc_mean=0.2070 mb_mean=0.4721 norm_overlap=0.9967 corr_cb=-0.1172
[EPOCH 036/089] train: loss=1.1157 acc=77.58% | val: loss=0.6047 acc=67.47% f1=72.73% auc=77.56% val_score=62.3089 val_score_bestthr=65.7334 | dyn(w_pfs=0.320, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.207, mb=0.472, no=0.997, corr=-0.117) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 65.1695 -> 65.7334
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1902 mb_mean=0.4646 norm_overlap=0.9949 corr_cb=-0.1614 topkJ=0.0553
[TRAIN][ep=037] loss=1.1015 acc=78.79%
[TRAIN][ep=037] mask_avg: mc_mean=0.2004 mb_mean=0.4721 norm_overlap=0.9965 corr_cb=-0.1256
[EPOCH 037/089] train: loss=1.1015 acc=78.79% | val: loss=0.5933 acc=67.47% f1=75.23% auc=76.34% val_score=59.8769 val_score_bestthr=69.5180 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.200, mb=0.472, no=0.996, corr=-0.126) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 65.7334 -> 69.5180
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2260 mb_mean=0.4726 norm_overlap=0.9955 corr_cb=-0.1461 topkJ=0.0406
[TRAIN][ep=038] loss=1.0812 acc=79.87%
[TRAIN][ep=038] mask_avg: mc_mean=0.2141 mb_mean=0.4721 norm_overlap=0.9957 corr_cb=-0.1534
[EPOCH 038/089] train: loss=1.0812 acc=79.87% | val: loss=0.5928 acc=67.47% f1=75.23% auc=76.05% val_score=51.7490 val_score_bestthr=69.5180 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.214, mb=0.472, no=0.996, corr=-0.153) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.5180 -> 69.5180
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.1989 mb_mean=0.4731 norm_overlap=0.9930 corr_cb=-0.2389 topkJ=0.0284
[TRAIN][ep=039] loss=1.0757 acc=80.27%
[TRAIN][ep=039] mask_avg: mc_mean=0.2344 mb_mean=0.4721 norm_overlap=0.9953 corr_cb=-0.1763
[EPOCH 039/089] train: loss=1.0757 acc=80.27% | val: loss=0.6151 acc=63.86% f1=71.70% auc=75.58% val_score=54.7239 val_score_bestthr=64.4243 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.234, mb=0.472, no=0.995, corr=-0.176) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.5180 -> 64.4243
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.2386 mb_mean=0.4759 norm_overlap=0.9926 corr_cb=-0.2963 topkJ=0.0179
[TRAIN][ep=040] loss=1.0635 acc=81.21%
[TRAIN][ep=040] mask_avg: mc_mean=0.2053 mb_mean=0.4721 norm_overlap=0.9957 corr_cb=-0.1480
[EPOCH 040/089] train: loss=1.0635 acc=81.21% | val: loss=0.6128 acc=66.27% f1=74.55% auc=75.64% val_score=53.1811 val_score_bestthr=68.7758 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.205, mb=0.472, no=0.996, corr=-0.148) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.5180 -> 68.7758
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.2608 mb_mean=0.4749 norm_overlap=0.9955 corr_cb=-0.1830 topkJ=0.0381
[TRAIN][ep=041] loss=1.0712 acc=80.27%
[TRAIN][ep=041] mask_avg: mc_mean=0.2316 mb_mean=0.4721 norm_overlap=0.9950 corr_cb=-0.1867
[EPOCH 041/089] train: loss=1.0712 acc=80.27% | val: loss=0.6346 acc=67.47% f1=75.68% auc=74.53% val_score=54.8852 val_score_bestthr=70.3941 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.232, mb=0.472, no=0.995, corr=-0.187) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 69.5180 -> 70.3941
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.2339 mb_mean=0.4719 norm_overlap=0.9962 corr_cb=-0.1667 topkJ=0.0318
[TRAIN][ep=042] loss=1.0581 acc=82.15%
[TRAIN][ep=042] mask_avg: mc_mean=0.2023 mb_mean=0.4721 norm_overlap=0.9963 corr_cb=-0.1268
[EPOCH 042/089] train: loss=1.0581 acc=82.15% | val: loss=0.6701 acc=66.27% f1=75.00% auc=74.77% val_score=60.5207 val_score_bestthr=70.5083 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.202, mb=0.472, no=0.996, corr=-0.127) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 70.3941 -> 70.5083
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.1931 mb_mean=0.4726 norm_overlap=0.9935 corr_cb=-0.1976 topkJ=0.0336
[TRAIN][ep=043] loss=1.0292 acc=83.62%
[TRAIN][ep=043] mask_avg: mc_mean=0.2400 mb_mean=0.4721 norm_overlap=0.9950 corr_cb=-0.1875
[EPOCH 043/089] train: loss=1.0292 acc=83.62% | val: loss=0.6091 acc=67.47% f1=73.79% auc=76.92% val_score=53.2143 val_score_bestthr=66.9679 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.240, mb=0.472, no=0.995, corr=-0.188) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5083 -> 66.9679
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2517 mb_mean=0.4690 norm_overlap=0.9943 corr_cb=-0.2173 topkJ=0.0282
[TRAIN][ep=044] loss=1.0428 acc=81.07%
[TRAIN][ep=044] mask_avg: mc_mean=0.2485 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1957
[EPOCH 044/089] train: loss=1.0428 acc=81.07% | val: loss=0.6463 acc=67.47% f1=74.77% auc=76.92% val_score=58.8690 val_score_bestthr=66.9240 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.249, mb=0.472, no=0.995, corr=-0.196) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5083 -> 66.9240
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2125 mb_mean=0.4723 norm_overlap=0.9966 corr_cb=-0.1227 topkJ=0.0605
[TRAIN][ep=045] loss=1.0238 acc=82.82%
[TRAIN][ep=045] mask_avg: mc_mean=0.2321 mb_mean=0.4721 norm_overlap=0.9955 corr_cb=-0.1676
[EPOCH 045/089] train: loss=1.0238 acc=82.82% | val: loss=0.7223 acc=65.06% f1=73.87% auc=73.60% val_score=53.5260 val_score_bestthr=68.8906 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.232, mb=0.472, no=0.995, corr=-0.168) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5083 -> 68.8906
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.2330 mb_mean=0.4729 norm_overlap=0.9936 corr_cb=-0.2429 topkJ=0.0165
[TRAIN][ep=046] loss=1.0081 acc=83.49%
[TRAIN][ep=046] mask_avg: mc_mean=0.2489 mb_mean=0.4721 norm_overlap=0.9955 corr_cb=-0.1729
[EPOCH 046/089] train: loss=1.0081 acc=83.49% | val: loss=0.6532 acc=65.06% f1=73.87% auc=75.23% val_score=48.7060 val_score_bestthr=68.8906 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.249, mb=0.472, no=0.996, corr=-0.173) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5083 -> 68.8906
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.2125 mb_mean=0.4700 norm_overlap=0.9955 corr_cb=-0.1647 topkJ=0.0423
[TRAIN][ep=047] loss=1.0026 acc=82.68%
[TRAIN][ep=047] mask_avg: mc_mean=0.2343 mb_mean=0.4721 norm_overlap=0.9953 corr_cb=-0.1702
[EPOCH 047/089] train: loss=1.0026 acc=82.68% | val: loss=0.6589 acc=65.06% f1=73.87% auc=75.76% val_score=48.7060 val_score_bestthr=68.8906 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.234, mb=0.472, no=0.995, corr=-0.170) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5083 -> 68.8906
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.3167 mb_mean=0.4695 norm_overlap=0.9915 corr_cb=-0.3855 topkJ=0.0099
[TRAIN][ep=048] loss=0.8371 acc=83.49%
[TRAIN][ep=048] mask_avg: mc_mean=0.2649 mb_mean=0.4721 norm_overlap=0.9947 corr_cb=-0.2081
[EPOCH 048/089] train: loss=0.8371 acc=83.49% | val: loss=0.6350 acc=68.67% f1=75.00% auc=75.64% val_score=53.9142 val_score_bestthr=70.5375 | dyn(w_pfs=0.290, w_sup=0.190, w_csuf=0.140, stage2=False) | mask(mc=0.265, mb=0.472, no=0.995, corr=-0.208) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 70.5083 -> 70.5375
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=049] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.2646 mb_mean=0.4735 norm_overlap=0.9956 corr_cb=-0.1784 topkJ=0.0226
[TRAIN][ep=049] loss=0.8776 acc=84.83%
[TRAIN][ep=049] mask_avg: mc_mean=0.2382 mb_mean=0.4721 norm_overlap=0.9954 corr_cb=-0.1661
[EPOCH 049/089] train: loss=0.8776 acc=84.83% | val: loss=0.6385 acc=68.67% f1=75.00% auc=76.10% val_score=56.3108 val_score_bestthr=70.5375 | dyn(w_pfs=0.330, w_sup=0.230, w_csuf=0.180, stage2=False) | mask(mc=0.238, mb=0.472, no=0.995, corr=-0.166) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5375 -> 70.5375
[DBG][ep=050] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.2529 mb_mean=0.4713 norm_overlap=0.9908 corr_cb=-0.3397 topkJ=0.0106
[TRAIN][ep=050] loss=0.6412 acc=84.70%
[TRAIN][ep=050] mask_avg: mc_mean=0.2413 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1894
[EPOCH 050/089] train: loss=0.6412 acc=84.70% | val: loss=0.6462 acc=68.67% f1=75.00% auc=75.99% val_score=49.4654 val_score_bestthr=70.5375 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.241, mb=0.472, no=0.995, corr=-0.189) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5375 -> 70.5375
[DBG][ep=051] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.2437 mb_mean=0.4781 norm_overlap=0.9934 corr_cb=-0.2472 topkJ=0.0194
[TRAIN][ep=051] loss=0.5732 acc=86.31%
[TRAIN][ep=051] mask_avg: mc_mean=0.2413 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1874
[EPOCH 051/089] train: loss=0.5732 acc=86.31% | val: loss=0.6667 acc=66.27% f1=74.55% auc=75.70% val_score=52.0125 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.241, mb=0.472, no=0.995, corr=-0.187) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5375 -> 70.2831
[DBG][ep=052] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.2509 mb_mean=0.4697 norm_overlap=0.9951 corr_cb=-0.1706 topkJ=0.0419
[TRAIN][ep=052] loss=0.5723 acc=85.77%
[TRAIN][ep=052] mask_avg: mc_mean=0.2414 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1833
[EPOCH 052/089] train: loss=0.5723 acc=85.77% | val: loss=0.6577 acc=66.27% f1=74.55% auc=75.81% val_score=50.1335 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.241, mb=0.472, no=0.995, corr=-0.183) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5375 -> 70.2831
[DBG][ep=053] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.2055 mb_mean=0.4687 norm_overlap=0.9949 corr_cb=-0.1969 topkJ=0.0291
[TRAIN][ep=053] loss=0.5710 acc=86.58%
[TRAIN][ep=053] mask_avg: mc_mean=0.2413 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1877
[EPOCH 053/089] train: loss=0.5710 acc=86.58% | val: loss=0.6703 acc=66.27% f1=74.55% auc=75.70% val_score=49.2625 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.241, mb=0.472, no=0.995, corr=-0.188) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5375 -> 70.2831
[DBG][ep=054] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=054] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=054] mask(step0): mc_mean=0.2398 mb_mean=0.4716 norm_overlap=0.9987 corr_cb=-0.0485 topkJ=0.0521
[TRAIN][ep=054] loss=0.5694 acc=87.25%
[TRAIN][ep=054] mask_avg: mc_mean=0.2413 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1841
[EPOCH 054/089] train: loss=0.5694 acc=87.25% | val: loss=0.6739 acc=66.27% f1=74.55% auc=75.47% val_score=49.2625 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.241, mb=0.472, no=0.995, corr=-0.184) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5375 -> 70.2831
[DBG][ep=055] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=055] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=055] mask(step0): mc_mean=0.2364 mb_mean=0.4709 norm_overlap=0.9961 corr_cb=-0.1564 topkJ=0.0317
[TRAIN][ep=055] loss=0.5666 acc=86.04%
[TRAIN][ep=055] mask_avg: mc_mean=0.2413 mb_mean=0.4721 norm_overlap=0.9950 corr_cb=-0.1826
[EPOCH 055/089] train: loss=0.5666 acc=86.04% | val: loss=0.6768 acc=66.27% f1=74.55% auc=75.52% val_score=49.2625 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.241, mb=0.472, no=0.995, corr=-0.183) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.5375 -> 70.2831
[DBG][ep=056] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=056] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=056] mask(step0): mc_mean=0.2684 mb_mean=0.4722 norm_overlap=0.9935 corr_cb=-0.2317 topkJ=0.0344
[TRAIN][ep=056] loss=0.5639 acc=85.91%
[TRAIN][ep=056] mask_avg: mc_mean=0.2413 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1836
[EPOCH 056/089] train: loss=0.5639 acc=85.91% | val: loss=0.6671 acc=66.27% f1=75.00% auc=75.87% val_score=48.4200 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.241, mb=0.472, no=0.995, corr=-0.184) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 70.5375 -> 70.7981
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
[DBG][ep=057] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=057] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=057] mask(step0): mc_mean=0.2398 mb_mean=0.4721 norm_overlap=0.9964 corr_cb=-0.1420 topkJ=0.0580
[TRAIN][ep=057] loss=0.5653 acc=85.50%
[TRAIN][ep=057] mask_avg: mc_mean=0.2413 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1868
[EPOCH 057/089] train: loss=0.5653 acc=85.50% | val: loss=0.6786 acc=66.27% f1=74.55% auc=75.58% val_score=49.2625 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.241, mb=0.472, no=0.995, corr=-0.187) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.2831
[DBG][ep=058] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=058] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=058] mask(step0): mc_mean=0.3122 mb_mean=0.4710 norm_overlap=0.9936 corr_cb=-0.2571 topkJ=0.0266
[TRAIN][ep=058] loss=0.5599 acc=86.58%
[TRAIN][ep=058] mask_avg: mc_mean=0.2413 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1866
[EPOCH 058/089] train: loss=0.5599 acc=86.58% | val: loss=0.6840 acc=66.27% f1=74.55% auc=75.35% val_score=50.1335 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.241, mb=0.472, no=0.995, corr=-0.187) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.2831
[DBG][ep=059] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=059] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=059] mask(step0): mc_mean=0.2441 mb_mean=0.4713 norm_overlap=0.9930 corr_cb=-0.2244 topkJ=0.0280
[TRAIN][ep=059] loss=0.5585 acc=86.44%
[TRAIN][ep=059] mask_avg: mc_mean=0.2414 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1865
[EPOCH 059/089] train: loss=0.5585 acc=86.44% | val: loss=0.7003 acc=66.27% f1=74.55% auc=75.70% val_score=49.9234 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.241, mb=0.472, no=0.995, corr=-0.187) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.2831
[DBG][ep=060] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=060] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=060] mask(step0): mc_mean=0.2832 mb_mean=0.4667 norm_overlap=0.9903 corr_cb=-0.2901 topkJ=0.0200
[TRAIN][ep=060] loss=0.5552 acc=86.58%
[TRAIN][ep=060] mask_avg: mc_mean=0.2414 mb_mean=0.4721 norm_overlap=0.9950 corr_cb=-0.1826
[EPOCH 060/089] train: loss=0.5552 acc=86.58% | val: loss=0.6763 acc=65.06% f1=73.87% auc=76.05% val_score=49.4654 val_score_bestthr=69.1804 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.241, mb=0.472, no=0.995, corr=-0.183) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 69.1804
[DBG][ep=061] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=061] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=061] mask(step0): mc_mean=0.2117 mb_mean=0.4745 norm_overlap=0.9959 corr_cb=-0.1598 topkJ=0.0419
[TRAIN][ep=061] loss=0.5542 acc=86.98%
[TRAIN][ep=061] mask_avg: mc_mean=0.2413 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1835
[EPOCH 061/089] train: loss=0.5542 acc=86.98% | val: loss=0.7274 acc=65.06% f1=73.87% auc=75.35% val_score=48.8217 val_score_bestthr=68.8906 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.241, mb=0.472, no=0.995, corr=-0.184) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 68.8906
[DBG][ep=062] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=062] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=062] mask(step0): mc_mean=0.2504 mb_mean=0.4636 norm_overlap=0.9947 corr_cb=-0.1989 topkJ=0.0505
[TRAIN][ep=062] loss=0.5590 acc=87.38%
[TRAIN][ep=062] mask_avg: mc_mean=0.2413 mb_mean=0.4721 norm_overlap=0.9950 corr_cb=-0.1819
[EPOCH 062/089] train: loss=0.5590 acc=87.38% | val: loss=0.7095 acc=66.27% f1=74.55% auc=75.41% val_score=44.5298 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.241, mb=0.472, no=0.995, corr=-0.182) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.2831
[DBG][ep=063] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=063] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=063] mask(step0): mc_mean=0.2497 mb_mean=0.4693 norm_overlap=0.9970 corr_cb=-0.1235 topkJ=0.0639
[TRAIN][ep=063] loss=0.5526 acc=86.71%
[TRAIN][ep=063] mask_avg: mc_mean=0.2413 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1847
[EPOCH 063/089] train: loss=0.5526 acc=86.71% | val: loss=0.7176 acc=65.06% f1=73.87% auc=75.23% val_score=46.0653 val_score_bestthr=68.8906 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.241, mb=0.472, no=0.995, corr=-0.185) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 68.8906
[DBG][ep=064] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=064] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=064] mask(step0): mc_mean=0.2476 mb_mean=0.4747 norm_overlap=0.9957 corr_cb=-0.1839 topkJ=0.0373
[TRAIN][ep=064] loss=0.5612 acc=85.23%
[TRAIN][ep=064] mask_avg: mc_mean=0.2414 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1869
[EPOCH 064/089] train: loss=0.5612 acc=85.23% | val: loss=0.6862 acc=66.27% f1=75.00% auc=75.87% val_score=49.4654 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.241, mb=0.472, no=0.995, corr=-0.187) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.7981
[DBG][ep=065] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=065] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=065] mask(step0): mc_mean=0.2597 mb_mean=0.4721 norm_overlap=0.9930 corr_cb=-0.2626 topkJ=0.0180
[TRAIN][ep=065] loss=0.5528 acc=87.25%
[TRAIN][ep=065] mask_avg: mc_mean=0.2414 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1839
[EPOCH 065/089] train: loss=0.5528 acc=87.25% | val: loss=0.6967 acc=65.06% f1=74.34% auc=75.76% val_score=48.6024 val_score_bestthr=70.2437 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.241, mb=0.472, no=0.995, corr=-0.184) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.2437
[DBG][ep=066] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=066] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=066] mask(step0): mc_mean=0.2172 mb_mean=0.4743 norm_overlap=0.9949 corr_cb=-0.1767 topkJ=0.0398
[TRAIN][ep=066] loss=0.5532 acc=86.85%
[TRAIN][ep=066] mask_avg: mc_mean=0.2414 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1843
[EPOCH 066/089] train: loss=0.5532 acc=86.85% | val: loss=0.7146 acc=66.27% f1=74.55% auc=75.58% val_score=44.5298 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.241, mb=0.472, no=0.995, corr=-0.184) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.2831
[DBG][ep=067] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=067] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=067] mask(step0): mc_mean=0.2397 mb_mean=0.4704 norm_overlap=0.9939 corr_cb=-0.2409 topkJ=0.0272
[TRAIN][ep=067] loss=0.5460 acc=87.38%
[TRAIN][ep=067] mask_avg: mc_mean=0.2413 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1836
[EPOCH 067/089] train: loss=0.5460 acc=87.38% | val: loss=0.7011 acc=66.27% f1=75.00% auc=75.70% val_score=48.6024 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.241, mb=0.472, no=0.995, corr=-0.184) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.7981
[DBG][ep=068] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=068] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=068] mask(step0): mc_mean=0.2200 mb_mean=0.4743 norm_overlap=0.9954 corr_cb=-0.1759 topkJ=0.0260
[TRAIN][ep=068] loss=0.5483 acc=86.98%
[TRAIN][ep=068] mask_avg: mc_mean=0.2414 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1838
[EPOCH 068/089] train: loss=0.5483 acc=86.98% | val: loss=0.7099 acc=66.27% f1=74.55% auc=75.58% val_score=50.1335 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.241, mb=0.472, no=0.995, corr=-0.184) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.2831
[DBG][ep=069] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=069] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=069] mask(step0): mc_mean=0.2445 mb_mean=0.4699 norm_overlap=0.9913 corr_cb=-0.3277 topkJ=0.0225
[TRAIN][ep=069] loss=0.5435 acc=87.25%
[TRAIN][ep=069] mask_avg: mc_mean=0.2413 mb_mean=0.4721 norm_overlap=0.9950 corr_cb=-0.1832
[EPOCH 069/089] train: loss=0.5435 acc=87.25% | val: loss=0.7040 acc=66.27% f1=74.55% auc=75.76% val_score=48.6024 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.241, mb=0.472, no=0.995, corr=-0.183) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.2831
[DBG][ep=070] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=070] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=070] mask(step0): mc_mean=0.2413 mb_mean=0.4706 norm_overlap=0.9927 corr_cb=-0.2394 topkJ=0.0296
[TRAIN][ep=070] loss=0.5428 acc=87.65%
[TRAIN][ep=070] mask_avg: mc_mean=0.2413 mb_mean=0.4721 norm_overlap=0.9950 corr_cb=-0.1814
[EPOCH 070/089] train: loss=0.5428 acc=87.65% | val: loss=0.7044 acc=66.27% f1=75.00% auc=75.81% val_score=48.6024 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.241, mb=0.472, no=0.995, corr=-0.181) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.7981
[DBG][ep=071] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=071] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=071] mask(step0): mc_mean=0.2439 mb_mean=0.4724 norm_overlap=0.9918 corr_cb=-0.3166 topkJ=0.0226
[TRAIN][ep=071] loss=0.5450 acc=87.11%
[TRAIN][ep=071] mask_avg: mc_mean=0.2413 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1845
[EPOCH 071/089] train: loss=0.5450 acc=87.11% | val: loss=0.7743 acc=67.47% f1=74.77% auc=74.94% val_score=50.3643 val_score_bestthr=66.9385 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.241, mb=0.472, no=0.995, corr=-0.185) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 66.9385
[DBG][ep=072] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=072] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=072] mask(step0): mc_mean=0.2771 mb_mean=0.4695 norm_overlap=0.9908 corr_cb=-0.3536 topkJ=0.0223
[TRAIN][ep=072] loss=0.5421 acc=87.25%
[TRAIN][ep=072] mask_avg: mc_mean=0.2414 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1835
[EPOCH 072/089] train: loss=0.5421 acc=87.25% | val: loss=0.7296 acc=66.27% f1=74.55% auc=75.17% val_score=45.2126 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.241, mb=0.472, no=0.995, corr=-0.184) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.2831
[DBG][ep=073] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=073] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=073] mask(step0): mc_mean=0.2118 mb_mean=0.4733 norm_overlap=0.9937 corr_cb=-0.1885 topkJ=0.0406
[TRAIN][ep=073] loss=0.5413 acc=87.38%
[TRAIN][ep=073] mask_avg: mc_mean=0.2413 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1833
[EPOCH 073/089] train: loss=0.5413 acc=87.38% | val: loss=0.7272 acc=66.27% f1=74.55% auc=75.29% val_score=46.6347 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.241, mb=0.472, no=0.995, corr=-0.183) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.2831
[DBG][ep=074] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=074] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=074] mask(step0): mc_mean=0.2498 mb_mean=0.4701 norm_overlap=0.9940 corr_cb=-0.2014 topkJ=0.0339
[TRAIN][ep=074] loss=0.5370 acc=86.85%
[TRAIN][ep=074] mask_avg: mc_mean=0.2412 mb_mean=0.4721 norm_overlap=0.9951 corr_cb=-0.1813
[EPOCH 074/089] train: loss=0.5370 acc=86.85% | val: loss=0.7124 acc=66.27% f1=75.00% auc=75.93% val_score=49.4654 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.241, mb=0.472, no=0.995, corr=-0.181) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.7981
[DBG][ep=075] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=075] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=075] mask(step0): mc_mean=0.2488 mb_mean=0.4685 norm_overlap=0.9933 corr_cb=-0.2593 topkJ=0.0318
[TRAIN][ep=075] loss=0.5379 acc=87.11%
[TRAIN][ep=075] mask_avg: mc_mean=0.2413 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1854
[EPOCH 075/089] train: loss=0.5379 acc=87.11% | val: loss=0.7614 acc=66.27% f1=74.55% auc=75.00% val_score=46.0653 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.241, mb=0.472, no=0.995, corr=-0.185) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.2831
[DBG][ep=076] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=076] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=076] mask(step0): mc_mean=0.2228 mb_mean=0.4755 norm_overlap=0.9959 corr_cb=-0.1468 topkJ=0.0397
[TRAIN][ep=076] loss=0.5377 acc=87.52%
[TRAIN][ep=076] mask_avg: mc_mean=0.2413 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1836
[EPOCH 076/089] train: loss=0.5377 acc=87.52% | val: loss=0.7380 acc=66.27% f1=74.55% auc=75.17% val_score=45.1071 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.241, mb=0.472, no=0.995, corr=-0.184) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.2831
[DBG][ep=077] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=077] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=077] mask(step0): mc_mean=0.2599 mb_mean=0.4711 norm_overlap=0.9919 corr_cb=-0.2944 topkJ=0.0191
[TRAIN][ep=077] loss=0.5302 acc=88.72%
[TRAIN][ep=077] mask_avg: mc_mean=0.2413 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1859
[EPOCH 077/089] train: loss=0.5302 acc=88.72% | val: loss=0.7204 acc=66.27% f1=75.00% auc=75.52% val_score=49.4654 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.241, mb=0.472, no=0.995, corr=-0.186) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.7981
[DBG][ep=078] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=078] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=078] mask(step0): mc_mean=0.2116 mb_mean=0.4669 norm_overlap=0.9955 corr_cb=-0.1938 topkJ=0.0565
[TRAIN][ep=078] loss=0.5360 acc=87.52%
[TRAIN][ep=078] mask_avg: mc_mean=0.2414 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1864
[EPOCH 078/089] train: loss=0.5360 acc=87.52% | val: loss=0.7315 acc=66.27% f1=74.55% auc=75.58% val_score=48.6024 val_score_bestthr=70.2831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.241, mb=0.472, no=0.995, corr=-0.186) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.2831
[DBG][ep=079] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=079] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=079] mask(step0): mc_mean=0.2769 mb_mean=0.4680 norm_overlap=0.9939 corr_cb=-0.2083 topkJ=0.0237
[TRAIN][ep=079] loss=0.5301 acc=88.32%
[TRAIN][ep=079] mask_avg: mc_mean=0.2413 mb_mean=0.4721 norm_overlap=0.9950 corr_cb=-0.1807
[EPOCH 079/089] train: loss=0.5301 acc=88.32% | val: loss=0.7302 acc=66.27% f1=75.00% auc=75.47% val_score=49.4654 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.241, mb=0.472, no=0.995, corr=-0.181) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.7981
[DBG][ep=080] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=080] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=080] mask(step0): mc_mean=0.2587 mb_mean=0.4747 norm_overlap=0.9935 corr_cb=-0.2447 topkJ=0.0168
[TRAIN][ep=080] loss=0.5317 acc=87.92%
[TRAIN][ep=080] mask_avg: mc_mean=0.2413 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1842
[EPOCH 080/089] train: loss=0.5317 acc=87.92% | val: loss=0.7350 acc=66.27% f1=75.00% auc=75.12% val_score=48.6024 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.241, mb=0.472, no=0.995, corr=-0.184) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.7981
[DBG][ep=081] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=081] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=081] mask(step0): mc_mean=0.2346 mb_mean=0.4695 norm_overlap=0.9926 corr_cb=-0.2424 topkJ=0.0234
[TRAIN][ep=081] loss=0.5357 acc=87.79%
[TRAIN][ep=081] mask_avg: mc_mean=0.2413 mb_mean=0.4721 norm_overlap=0.9948 corr_cb=-0.1867
[EPOCH 081/089] train: loss=0.5357 acc=87.79% | val: loss=0.7318 acc=68.67% f1=75.47% auc=75.58% val_score=60.1205 val_score_bestthr=68.0462 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.241, mb=0.472, no=0.995, corr=-0.187) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 68.0462
[DBG][ep=082] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=082] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=082] mask(step0): mc_mean=0.2465 mb_mean=0.4682 norm_overlap=0.9952 corr_cb=-0.2041 topkJ=0.0487
[TRAIN][ep=082] loss=0.5387 acc=86.17%
[TRAIN][ep=082] mask_avg: mc_mean=0.2413 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1836
[EPOCH 082/089] train: loss=0.5387 acc=86.17% | val: loss=0.7425 acc=67.47% f1=74.29% auc=75.12% val_score=48.6024 val_score_bestthr=68.2255 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.241, mb=0.472, no=0.995, corr=-0.184) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 68.2255
[DBG][ep=083] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=083] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=083] mask(step0): mc_mean=0.2057 mb_mean=0.4737 norm_overlap=0.9946 corr_cb=-0.2003 topkJ=0.0244
[TRAIN][ep=083] loss=0.5276 acc=88.86%
[TRAIN][ep=083] mask_avg: mc_mean=0.2413 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1857
[EPOCH 083/089] train: loss=0.5276 acc=88.86% | val: loss=0.7618 acc=67.47% f1=74.77% auc=75.12% val_score=46.6347 val_score_bestthr=66.9385 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.241, mb=0.472, no=0.995, corr=-0.186) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 66.9385
[DBG][ep=084] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=084] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=084] mask(step0): mc_mean=0.2528 mb_mean=0.4698 norm_overlap=0.9941 corr_cb=-0.2336 topkJ=0.0312
[TRAIN][ep=084] loss=0.5263 acc=88.32%
[TRAIN][ep=084] mask_avg: mc_mean=0.2413 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1819
[EPOCH 084/089] train: loss=0.5263 acc=88.32% | val: loss=0.7539 acc=66.27% f1=75.00% auc=75.06% val_score=45.9830 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.241, mb=0.472, no=0.995, corr=-0.182) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.7981
[DBG][ep=085] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=085] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=085] mask(step0): mc_mean=0.2325 mb_mean=0.4751 norm_overlap=0.9981 corr_cb=-0.0791 topkJ=0.0456
[TRAIN][ep=085] loss=0.5252 acc=88.19%
[TRAIN][ep=085] mask_avg: mc_mean=0.2413 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1847
[EPOCH 085/089] train: loss=0.5252 acc=88.19% | val: loss=0.7645 acc=66.27% f1=75.00% auc=75.00% val_score=45.1071 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.241, mb=0.472, no=0.995, corr=-0.185) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.7981
[DBG][ep=086] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=086] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=086] mask(step0): mc_mean=0.2727 mb_mean=0.4732 norm_overlap=0.9965 corr_cb=-0.1212 topkJ=0.0298
[TRAIN][ep=086] loss=0.5222 acc=89.13%
[TRAIN][ep=086] mask_avg: mc_mean=0.2413 mb_mean=0.4721 norm_overlap=0.9949 corr_cb=-0.1822
[EPOCH 086/089] train: loss=0.5222 acc=89.13% | val: loss=0.7486 acc=66.27% f1=75.00% auc=75.12% val_score=48.6024 val_score_bestthr=70.7981 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.241, mb=0.472, no=0.995, corr=-0.182) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.7981 -> 70.7981
[EARLY STOP] no improvement for 30 epochs. best_epoch=56
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/ckpt_best_fold_0.pt
=============== FIT DONE ===============
[BEST] epoch=56 | val_acc=66.27% | val_f1=75.00% | val_auc=75.87% | val_score=48.4200 | val_score_bestthr=70.7981
[TEST@BEST] thr_used=0.375 | acc=63.29% f1=70.31% auc=65.70% | SP_sex=2.19% EO_sex=0.85% SP_age=12.58% EO_age=18.03%
[TIME] 2.02 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold0_rep0_seed0/summary_fold_0.json
