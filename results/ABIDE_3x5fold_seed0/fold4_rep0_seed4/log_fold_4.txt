[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4593 mb_mean=0.5110 norm_overlap=1.0000 corr_cb=0.0210 topkJ=0.1340
[TRAIN][ep=000] loss=0.6963 acc=51.01%
[TRAIN][ep=000] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0304
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4604 mb_mean=0.5129 norm_overlap=1.0000 corr_cb=-0.0341 topkJ=0.0385
[TRAIN][ep=001] loss=0.6937 acc=51.14%
[TRAIN][ep=001] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0340
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4621 mb_mean=0.5138 norm_overlap=0.9999 corr_cb=-0.2061 topkJ=0.0705
[TRAIN][ep=002] loss=0.6928 acc=51.81%
[TRAIN][ep=002] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0391
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4656 mb_mean=0.5133 norm_overlap=0.9999 corr_cb=-0.1525 topkJ=0.0702
[TRAIN][ep=003] loss=0.6918 acc=52.35%
[TRAIN][ep=003] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0291
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4607 mb_mean=0.5127 norm_overlap=1.0000 corr_cb=-0.0560 topkJ=0.0532
[TRAIN][ep=004] loss=0.6909 acc=52.75%
[TRAIN][ep=004] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0333
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4627 mb_mean=0.5146 norm_overlap=1.0000 corr_cb=0.0401 topkJ=0.1020
[TRAIN][ep=005] loss=0.6901 acc=53.96%
[TRAIN][ep=005] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0327
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4643 mb_mean=0.5121 norm_overlap=0.9999 corr_cb=-0.1954 topkJ=0.0265
[TRAIN][ep=006] loss=0.6888 acc=54.36%
[TRAIN][ep=006] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0382
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4600 mb_mean=0.5162 norm_overlap=1.0000 corr_cb=-0.0688 topkJ=0.0382
[TRAIN][ep=007] loss=0.6888 acc=53.96%
[TRAIN][ep=007] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0316
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4601 mb_mean=0.5162 norm_overlap=0.9998 corr_cb=-0.3232 topkJ=0.0124
[TRAIN][ep=008] loss=0.6872 acc=56.24%
[TRAIN][ep=008] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0367
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4657 mb_mean=0.5110 norm_overlap=1.0001 corr_cb=0.2304 topkJ=0.1165
[TRAIN][ep=009] loss=0.6858 acc=57.85%
[TRAIN][ep=009] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0276
================= FIT START (fold=4) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4625 mb_mean=0.5166 norm_overlap=0.9999 corr_cb=-0.1231 topkJ=0.0325
[TRAIN][ep=000] loss=0.6847 acc=56.78%
[TRAIN][ep=000] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0298
[EPOCH 000/089] train: loss=0.6847 acc=56.78% | val: loss=0.6879 acc=54.22% f1=68.33% auc=57.85% val_score=48.1500 val_score_bestthr=57.9748 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.030) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 57.9748
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep0_seed4/ckpt_best_fold_4.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4617 mb_mean=0.5124 norm_overlap=1.0000 corr_cb=0.0896 topkJ=0.0788
[TRAIN][ep=001] loss=0.6820 acc=59.60%
[TRAIN][ep=001] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0301
[EPOCH 001/089] train: loss=0.6820 acc=59.60% | val: loss=0.6854 acc=53.01% f1=67.77% auc=57.33% val_score=45.9160 val_score_bestthr=55.5349 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.030) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 57.9748 -> 55.5349
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4651 mb_mean=0.5120 norm_overlap=1.0000 corr_cb=0.0785 topkJ=0.0875
[TRAIN][ep=002] loss=0.6805 acc=56.64%
[TRAIN][ep=002] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0344
[EPOCH 002/089] train: loss=0.6805 acc=56.64% | val: loss=0.6876 acc=54.22% f1=68.33% auc=57.91% val_score=50.4785 val_score_bestthr=57.9748 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.034) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 57.9748 -> 57.9748
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4604 mb_mean=0.5131 norm_overlap=1.0000 corr_cb=0.0074 topkJ=0.0496
[TRAIN][ep=003] loss=0.6791 acc=60.40%
[TRAIN][ep=003] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0360
[EPOCH 003/089] train: loss=0.6791 acc=60.40% | val: loss=0.6850 acc=54.22% f1=68.33% auc=58.90% val_score=46.4248 val_score_bestthr=57.9748 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.036) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 57.9748 -> 57.9748
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4599 mb_mean=0.5131 norm_overlap=0.9998 corr_cb=-0.3378 topkJ=0.0131
[TRAIN][ep=004] loss=0.6783 acc=57.32%
[TRAIN][ep=004] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0322
[EPOCH 004/089] train: loss=0.6783 acc=57.32% | val: loss=0.6836 acc=55.42% f1=68.91% auc=59.71% val_score=44.1160 val_score_bestthr=59.4716 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.032) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 57.9748 -> 59.4716
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep0_seed4/ckpt_best_fold_4.pt
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4645 mb_mean=0.5123 norm_overlap=1.0000 corr_cb=0.1004 topkJ=0.0686
[TRAIN][ep=005] loss=1.2645 acc=61.88%
[TRAIN][ep=005] mask_avg: mc_mean=0.3599 mb_mean=0.5133 norm_overlap=0.9989 corr_cb=-0.3380
[EPOCH 005/089] train: loss=1.2645 acc=61.88% | val: loss=0.6837 acc=56.63% f1=69.49% auc=60.06% val_score=49.6112 val_score_bestthr=60.9699 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.360, mb=0.513, no=0.999, corr=-0.338) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 59.4716 -> 60.9699
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep0_seed4/ckpt_best_fold_4.pt
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.3050 mb_mean=0.5091 norm_overlap=0.9984 corr_cb=-0.2883 topkJ=0.0212
[TRAIN][ep=006] loss=1.2555 acc=60.27%
[TRAIN][ep=006] mask_avg: mc_mean=0.2414 mb_mean=0.5133 norm_overlap=0.9970 corr_cb=-0.4057
[EPOCH 006/089] train: loss=1.2555 acc=60.27% | val: loss=0.6877 acc=54.22% f1=68.33% auc=56.63% val_score=42.8398 val_score_bestthr=58.8748 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.241, mb=0.513, no=0.997, corr=-0.406) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 60.9699 -> 58.8748
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2172 mb_mean=0.5122 norm_overlap=0.9971 corr_cb=-0.3654 topkJ=0.0265
[TRAIN][ep=007] loss=1.2543 acc=61.21%
[TRAIN][ep=007] mask_avg: mc_mean=0.2000 mb_mean=0.5133 norm_overlap=0.9958 corr_cb=-0.4242
[EPOCH 007/089] train: loss=1.2543 acc=61.21% | val: loss=0.6831 acc=55.42% f1=68.91% auc=59.36% val_score=41.5996 val_score_bestthr=59.9272 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.200, mb=0.513, no=0.996, corr=-0.424) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 60.9699 -> 59.9272
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1401 mb_mean=0.5155 norm_overlap=0.9973 corr_cb=-0.2242 topkJ=0.0357
[TRAIN][ep=008] loss=1.2497 acc=61.88%
[TRAIN][ep=008] mask_avg: mc_mean=0.1742 mb_mean=0.5133 norm_overlap=0.9943 corr_cb=-0.4625
[EPOCH 008/089] train: loss=1.2497 acc=61.88% | val: loss=0.6854 acc=55.42% f1=68.91% auc=58.31% val_score=59.8605 val_score_bestthr=59.8605 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.174, mb=0.513, no=0.994, corr=-0.463) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 60.9699 -> 59.8605
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1914 mb_mean=0.5094 norm_overlap=0.9955 corr_cb=-0.3879 topkJ=0.0184
[TRAIN][ep=009] loss=1.2524 acc=59.60%
[TRAIN][ep=009] mask_avg: mc_mean=0.1601 mb_mean=0.5133 norm_overlap=0.9930 corr_cb=-0.4868
[EPOCH 009/089] train: loss=1.2524 acc=59.60% | val: loss=0.6825 acc=55.42% f1=68.91% auc=58.14% val_score=43.5843 val_score_bestthr=59.9272 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.160, mb=0.513, no=0.993, corr=-0.487) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 60.9699 -> 59.9272
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1604 mb_mean=0.5127 norm_overlap=0.9926 corr_cb=-0.5174 topkJ=0.0048
[TRAIN][ep=010] loss=1.2448 acc=62.55%
[TRAIN][ep=010] mask_avg: mc_mean=0.1512 mb_mean=0.5133 norm_overlap=0.9917 corr_cb=-0.4999
[EPOCH 010/089] train: loss=1.2448 acc=62.55% | val: loss=0.6823 acc=55.42% f1=68.38% auc=57.44% val_score=46.5380 val_score_bestthr=58.0473 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.151, mb=0.513, no=0.992, corr=-0.500) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 60.9699 -> 58.0473
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1357 mb_mean=0.5141 norm_overlap=0.9913 corr_cb=-0.5140 topkJ=0.0004
[TRAIN][ep=011] loss=1.0044 acc=59.33%
[TRAIN][ep=011] mask_avg: mc_mean=0.1535 mb_mean=0.5133 norm_overlap=0.9907 corr_cb=-0.5033
[EPOCH 011/089] train: loss=1.0044 acc=59.33% | val: loss=0.6849 acc=55.42% f1=67.83% auc=55.99% val_score=37.5747 val_score_bestthr=59.0082 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.154, mb=0.513, no=0.991, corr=-0.503) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 60.9699 -> 59.0082
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1918 mb_mean=0.5122 norm_overlap=0.9888 corr_cb=-0.6251 topkJ=0.0008
[TRAIN][ep=012] loss=0.7582 acc=63.62%
[TRAIN][ep=012] mask_avg: mc_mean=0.1457 mb_mean=0.5133 norm_overlap=0.9894 corr_cb=-0.4941
[EPOCH 012/089] train: loss=0.7582 acc=63.62% | val: loss=0.6850 acc=55.42% f1=67.26% auc=57.27% val_score=55.3268 val_score_bestthr=58.1518 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.146, mb=0.513, no=0.989, corr=-0.494) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 60.9699 -> 58.1518
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1461 mb_mean=0.5120 norm_overlap=0.9886 corr_cb=-0.4996 topkJ=0.0020
[TRAIN][ep=013] loss=0.6983 acc=63.62%
[TRAIN][ep=013] mask_avg: mc_mean=0.1471 mb_mean=0.5133 norm_overlap=0.9887 corr_cb=-0.4893
[EPOCH 013/089] train: loss=0.6983 acc=63.62% | val: loss=0.6837 acc=55.42% f1=67.83% auc=55.93% val_score=46.4406 val_score_bestthr=59.0082 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.147, mb=0.513, no=0.989, corr=-0.489) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 60.9699 -> 59.0082
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.2077 mb_mean=0.5110 norm_overlap=0.9815 corr_cb=-0.6570 topkJ=0.0004
[TRAIN][ep=014] loss=0.6830 acc=63.36%
[TRAIN][ep=014] mask_avg: mc_mean=0.1427 mb_mean=0.5133 norm_overlap=0.9877 corr_cb=-0.4721
[EPOCH 014/089] train: loss=0.6830 acc=63.36% | val: loss=0.6993 acc=55.42% f1=68.91% auc=56.80% val_score=55.8216 val_score_bestthr=59.8605 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.143, mb=0.513, no=0.988, corr=-0.472) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 60.9699 -> 59.8605
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.0997 mb_mean=0.5172 norm_overlap=0.9863 corr_cb=-0.4752 topkJ=0.0008
[TRAIN][ep=015] loss=0.6745 acc=64.30%
[TRAIN][ep=015] mask_avg: mc_mean=0.1547 mb_mean=0.5133 norm_overlap=0.9877 corr_cb=-0.4698
[EPOCH 015/089] train: loss=0.6745 acc=64.30% | val: loss=0.6875 acc=55.42% f1=67.83% auc=55.00% val_score=45.8867 val_score_bestthr=59.0082 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.155, mb=0.513, no=0.988, corr=-0.470) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 60.9699 -> 59.0082
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1563 mb_mean=0.5145 norm_overlap=0.9838 corr_cb=-0.5314 topkJ=0.0016
[TRAIN][ep=016] loss=0.6732 acc=64.83%
[TRAIN][ep=016] mask_avg: mc_mean=0.1557 mb_mean=0.5133 norm_overlap=0.9873 corr_cb=-0.4567
[EPOCH 016/089] train: loss=0.6732 acc=64.83% | val: loss=0.6905 acc=55.42% f1=67.83% auc=54.83% val_score=46.4991 val_score_bestthr=59.0082 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.156, mb=0.513, no=0.987, corr=-0.457) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 60.9699 -> 59.0082
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1490 mb_mean=0.5136 norm_overlap=0.9855 corr_cb=-0.4731 topkJ=0.0016
[TRAIN][ep=017] loss=0.6643 acc=66.31%
[TRAIN][ep=017] mask_avg: mc_mean=0.1613 mb_mean=0.5133 norm_overlap=0.9874 corr_cb=-0.4410
[EPOCH 017/089] train: loss=0.6643 acc=66.31% | val: loss=0.7036 acc=54.22% f1=67.24% auc=53.90% val_score=45.7130 val_score_bestthr=57.5098 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.161, mb=0.513, no=0.987, corr=-0.441) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 60.9699 -> 57.5098
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1263 mb_mean=0.5148 norm_overlap=0.9874 corr_cb=-0.3760 topkJ=0.0050
[TRAIN][ep=018] loss=0.6602 acc=65.23%
[TRAIN][ep=018] mask_avg: mc_mean=0.1616 mb_mean=0.5133 norm_overlap=0.9872 corr_cb=-0.4321
[EPOCH 018/089] train: loss=0.6602 acc=65.23% | val: loss=0.6967 acc=54.22% f1=67.80% auc=54.71% val_score=46.7607 val_score_bestthr=56.5497 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.162, mb=0.513, no=0.987, corr=-0.432) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 60.9699 -> 56.5497
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1521 mb_mean=0.5144 norm_overlap=0.9884 corr_cb=-0.4211 topkJ=0.0028
[TRAIN][ep=019] loss=0.6582 acc=64.70%
[TRAIN][ep=019] mask_avg: mc_mean=0.1622 mb_mean=0.5133 norm_overlap=0.9871 corr_cb=-0.4202
[EPOCH 019/089] train: loss=0.6582 acc=64.70% | val: loss=0.7019 acc=54.22% f1=67.80% auc=54.07% val_score=44.4894 val_score_bestthr=56.5497 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.162, mb=0.513, no=0.987, corr=-0.420) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 60.9699 -> 56.5497
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1552 mb_mean=0.5125 norm_overlap=0.9849 corr_cb=-0.4598 topkJ=0.0023
[TRAIN][ep=020] loss=0.6668 acc=64.03%
[TRAIN][ep=020] mask_avg: mc_mean=0.1516 mb_mean=0.5133 norm_overlap=0.9866 corr_cb=-0.4155
[EPOCH 020/089] train: loss=0.6668 acc=64.03% | val: loss=0.7039 acc=57.83% f1=67.29% auc=54.77% val_score=40.7721 val_score_bestthr=56.1715 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.152, mb=0.513, no=0.987, corr=-0.415) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 60.9699 -> 56.1715
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.1773 mb_mean=0.5107 norm_overlap=0.9847 corr_cb=-0.4808 topkJ=0.0033
[TRAIN][ep=021] loss=0.6505 acc=66.98%
[TRAIN][ep=021] mask_avg: mc_mean=0.1584 mb_mean=0.5133 norm_overlap=0.9868 corr_cb=-0.4140
[EPOCH 021/089] train: loss=0.6505 acc=66.98% | val: loss=0.7059 acc=57.83% f1=67.29% auc=54.24% val_score=34.5674 val_score_bestthr=56.1715 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.158, mb=0.513, no=0.987, corr=-0.414) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 60.9699 -> 56.1715
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1402 mb_mean=0.5140 norm_overlap=0.9940 corr_cb=-0.2028 topkJ=0.0090
[TRAIN][ep=022] loss=0.6437 acc=66.04%
[TRAIN][ep=022] mask_avg: mc_mean=0.1641 mb_mean=0.5133 norm_overlap=0.9869 corr_cb=-0.4135
[EPOCH 022/089] train: loss=0.6437 acc=66.04% | val: loss=0.7151 acc=54.22% f1=68.33% auc=54.48% val_score=51.1770 val_score_bestthr=58.3637 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.164, mb=0.513, no=0.987, corr=-0.413) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 60.9699 -> 58.3637
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1954 mb_mean=0.5105 norm_overlap=0.9849 corr_cb=-0.4513 topkJ=0.0036
[TRAIN][ep=023] loss=0.6419 acc=66.85%
[TRAIN][ep=023] mask_avg: mc_mean=0.1677 mb_mean=0.5133 norm_overlap=0.9871 corr_cb=-0.4061
[EPOCH 023/089] train: loss=0.6419 acc=66.85% | val: loss=0.7245 acc=57.83% f1=66.02% auc=54.48% val_score=39.7201 val_score_bestthr=56.9995 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.168, mb=0.513, no=0.987, corr=-0.406) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 60.9699 -> 56.9995
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1881 mb_mean=0.5126 norm_overlap=0.9878 corr_cb=-0.4001 topkJ=0.0098
[TRAIN][ep=024] loss=0.6369 acc=67.92%
[TRAIN][ep=024] mask_avg: mc_mean=0.1720 mb_mean=0.5133 norm_overlap=0.9872 corr_cb=-0.4034
[EPOCH 024/089] train: loss=0.6369 acc=67.92% | val: loss=0.7174 acc=54.22% f1=67.80% auc=54.48% val_score=42.0513 val_score_bestthr=56.5497 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.172, mb=0.513, no=0.987, corr=-0.403) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 60.9699 -> 56.5497
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1978 mb_mean=0.5144 norm_overlap=0.9899 corr_cb=-0.3979 topkJ=0.0056
[TRAIN][ep=025] loss=0.6411 acc=67.65%
[TRAIN][ep=025] mask_avg: mc_mean=0.1909 mb_mean=0.5133 norm_overlap=0.9884 corr_cb=-0.3907
[EPOCH 025/089] train: loss=0.6411 acc=67.65% | val: loss=0.7201 acc=57.83% f1=67.29% auc=54.30% val_score=43.5561 val_score_bestthr=56.3382 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.191, mb=0.513, no=0.988, corr=-0.391) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 60.9699 -> 56.3382
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1738 mb_mean=0.5127 norm_overlap=0.9904 corr_cb=-0.3372 topkJ=0.0071
[TRAIN][ep=026] loss=0.6332 acc=65.91%
[TRAIN][ep=026] mask_avg: mc_mean=0.1877 mb_mean=0.5133 norm_overlap=0.9883 corr_cb=-0.3861
[EPOCH 026/089] train: loss=0.6332 acc=65.91% | val: loss=0.7231 acc=57.83% f1=66.67% auc=53.90% val_score=49.7607 val_score_bestthr=57.4347 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.188, mb=0.513, no=0.988, corr=-0.386) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 60.9699 -> 57.4347
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1783 mb_mean=0.5153 norm_overlap=0.9929 corr_cb=-0.2891 topkJ=0.0086
[TRAIN][ep=027] loss=0.6241 acc=68.19%
[TRAIN][ep=027] mask_avg: mc_mean=0.1851 mb_mean=0.5133 norm_overlap=0.9881 corr_cb=-0.3815
[EPOCH 027/089] train: loss=0.6241 acc=68.19% | val: loss=0.7219 acc=59.04% f1=67.92% auc=54.01% val_score=48.3172 val_score_bestthr=57.2657 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.185, mb=0.513, no=0.988, corr=-0.382) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 60.9699 -> 57.2657
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1496 mb_mean=0.5149 norm_overlap=0.9849 corr_cb=-0.4191 topkJ=0.0015
[TRAIN][ep=028] loss=0.6239 acc=68.05%
[TRAIN][ep=028] mask_avg: mc_mean=0.1880 mb_mean=0.5133 norm_overlap=0.9883 corr_cb=-0.3760
[EPOCH 028/089] train: loss=0.6239 acc=68.05% | val: loss=0.7297 acc=57.83% f1=67.29% auc=53.90% val_score=43.2362 val_score_bestthr=56.3382 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.188, mb=0.513, no=0.988, corr=-0.376) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 60.9699 -> 56.3382
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.1467 mb_mean=0.5150 norm_overlap=0.9895 corr_cb=-0.3090 topkJ=0.0114
[TRAIN][ep=029] loss=0.6153 acc=68.72%
[TRAIN][ep=029] mask_avg: mc_mean=0.1807 mb_mean=0.5133 norm_overlap=0.9880 corr_cb=-0.3737
[EPOCH 029/089] train: loss=0.6153 acc=68.72% | val: loss=0.7467 acc=54.22% f1=67.80% auc=54.01% val_score=32.6999 val_score_bestthr=55.2164 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.181, mb=0.513, no=0.988, corr=-0.374) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 60.9699 -> 55.2164
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2117 mb_mean=0.5126 norm_overlap=0.9877 corr_cb=-0.4224 topkJ=0.0077
[TRAIN][ep=030] loss=0.6244 acc=66.58%
[TRAIN][ep=030] mask_avg: mc_mean=0.1836 mb_mean=0.5133 norm_overlap=0.9882 corr_cb=-0.3711
[EPOCH 030/089] train: loss=0.6244 acc=66.58% | val: loss=0.7778 acc=54.22% f1=68.33% auc=53.78% val_score=53.0758 val_score_bestthr=58.3637 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.184, mb=0.513, no=0.988, corr=-0.371) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 60.9699 -> 58.3637
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2531 mb_mean=0.5107 norm_overlap=0.9925 corr_cb=-0.3421 topkJ=0.0111
[TRAIN][ep=031] loss=0.6160 acc=69.13%
[TRAIN][ep=031] mask_avg: mc_mean=0.1944 mb_mean=0.5133 norm_overlap=0.9889 corr_cb=-0.3620
[EPOCH 031/089] train: loss=0.6160 acc=69.13% | val: loss=0.7345 acc=60.24% f1=68.57% auc=53.60% val_score=43.8258 val_score_bestthr=57.1950 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.194, mb=0.513, no=0.989, corr=-0.362) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 60.9699 -> 57.1950
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1887 mb_mean=0.5139 norm_overlap=0.9891 corr_cb=-0.3896 topkJ=0.0181
[TRAIN][ep=032] loss=0.6047 acc=69.80%
[TRAIN][ep=032] mask_avg: mc_mean=0.2046 mb_mean=0.5133 norm_overlap=0.9893 corr_cb=-0.3583
[EPOCH 032/089] train: loss=0.6047 acc=69.80% | val: loss=0.7401 acc=60.24% f1=68.57% auc=53.72% val_score=41.3306 val_score_bestthr=57.1950 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.205, mb=0.513, no=0.989, corr=-0.358) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 60.9699 -> 57.1950
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1498 mb_mean=0.5107 norm_overlap=0.9935 corr_cb=-0.2155 topkJ=0.0158
[TRAIN][ep=033] loss=0.6032 acc=69.93%
[TRAIN][ep=033] mask_avg: mc_mean=0.1895 mb_mean=0.5133 norm_overlap=0.9888 corr_cb=-0.3546
[EPOCH 033/089] train: loss=0.6032 acc=69.93% | val: loss=0.7610 acc=53.01% f1=67.23% auc=53.31% val_score=30.3375 val_score_bestthr=55.0536 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.513, no=0.989, corr=-0.355) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 60.9699 -> 55.0536
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1493 mb_mean=0.5160 norm_overlap=0.9857 corr_cb=-0.3769 topkJ=0.0039
[TRAIN][ep=034] loss=0.5981 acc=70.47%
[TRAIN][ep=034] mask_avg: mc_mean=0.1772 mb_mean=0.5133 norm_overlap=0.9882 corr_cb=-0.3530
[EPOCH 034/089] train: loss=0.5981 acc=70.47% | val: loss=0.7460 acc=53.01% f1=68.80% auc=53.49% val_score=40.4000 val_score_bestthr=61.2320 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.177, mb=0.513, no=0.988, corr=-0.353) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 60.9699 -> 61.2320
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep0_seed4/ckpt_best_fold_4.pt
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2207 mb_mean=0.5138 norm_overlap=0.9903 corr_cb=-0.3800 topkJ=0.0056
[TRAIN][ep=035] loss=0.6924 acc=70.34%
[TRAIN][ep=035] mask_avg: mc_mean=0.1946 mb_mean=0.5133 norm_overlap=0.9890 corr_cb=-0.3484
[EPOCH 035/089] train: loss=0.6924 acc=70.34% | val: loss=0.7676 acc=60.24% f1=69.72% auc=53.55% val_score=28.2143 val_score_bestthr=54.0360 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.195, mb=0.513, no=0.989, corr=-0.348) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.2320 -> 54.0360
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.1576 mb_mean=0.5137 norm_overlap=0.9893 corr_cb=-0.3410 topkJ=0.0043
[TRAIN][ep=036] loss=0.7953 acc=71.01%
[TRAIN][ep=036] mask_avg: mc_mean=0.1698 mb_mean=0.5133 norm_overlap=0.9878 corr_cb=-0.3525
[EPOCH 036/089] train: loss=0.7953 acc=71.01% | val: loss=0.7514 acc=59.04% f1=68.52% auc=53.84% val_score=42.1506 val_score_bestthr=55.4537 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.170, mb=0.513, no=0.988, corr=-0.352) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.2320 -> 55.4537
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1666 mb_mean=0.5159 norm_overlap=0.9861 corr_cb=-0.3452 topkJ=0.0074
[TRAIN][ep=037] loss=0.8718 acc=71.41%
[TRAIN][ep=037] mask_avg: mc_mean=0.2020 mb_mean=0.5133 norm_overlap=0.9892 corr_cb=-0.3477
[EPOCH 037/089] train: loss=0.8718 acc=71.41% | val: loss=0.7526 acc=57.83% f1=68.47% auc=53.66% val_score=40.4000 val_score_bestthr=55.0275 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.202, mb=0.513, no=0.989, corr=-0.348) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.2320 -> 55.0275
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.1764 mb_mean=0.5132 norm_overlap=0.9866 corr_cb=-0.3731 topkJ=0.0091
[TRAIN][ep=038] loss=0.9663 acc=69.66%
[TRAIN][ep=038] mask_avg: mc_mean=0.1829 mb_mean=0.5133 norm_overlap=0.9885 corr_cb=-0.3480
[EPOCH 038/089] train: loss=0.9663 acc=69.66% | val: loss=0.7560 acc=54.22% f1=68.33% auc=53.55% val_score=40.8619 val_score_bestthr=58.8748 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.183, mb=0.513, no=0.988, corr=-0.348) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.2320 -> 58.8748
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.1747 mb_mean=0.5157 norm_overlap=0.9856 corr_cb=-0.4264 topkJ=0.0091
[TRAIN][ep=039] loss=1.0523 acc=71.01%
[TRAIN][ep=039] mask_avg: mc_mean=0.1813 mb_mean=0.5133 norm_overlap=0.9884 corr_cb=-0.3457
[EPOCH 039/089] train: loss=1.0523 acc=71.01% | val: loss=0.7824 acc=53.01% f1=67.77% auc=52.79% val_score=26.1968 val_score_bestthr=57.6460 | dyn(w_pfs=0.100, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.181, mb=0.513, no=0.988, corr=-0.346) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.2320 -> 57.6460
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.1811 mb_mean=0.5137 norm_overlap=0.9892 corr_cb=-0.3402 topkJ=0.0106
[TRAIN][ep=040] loss=0.8100 acc=72.48%
[TRAIN][ep=040] mask_avg: mc_mean=0.2036 mb_mean=0.5133 norm_overlap=0.9894 corr_cb=-0.3380
[EPOCH 040/089] train: loss=0.8100 acc=72.48% | val: loss=0.7604 acc=54.22% f1=68.33% auc=53.26% val_score=40.2377 val_score_bestthr=58.8748 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.204, mb=0.513, no=0.989, corr=-0.338) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.2320 -> 58.8748
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.1869 mb_mean=0.5141 norm_overlap=0.9929 corr_cb=-0.2346 topkJ=0.0188
[TRAIN][ep=041] loss=0.5729 acc=70.47%
[TRAIN][ep=041] mask_avg: mc_mean=0.1882 mb_mean=0.5133 norm_overlap=0.9886 corr_cb=-0.3406
[EPOCH 041/089] train: loss=0.5729 acc=70.47% | val: loss=0.7725 acc=54.22% f1=68.33% auc=53.49% val_score=36.6052 val_score_bestthr=58.8748 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.188, mb=0.513, no=0.989, corr=-0.341) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.2320 -> 58.8748
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.1838 mb_mean=0.5130 norm_overlap=0.9883 corr_cb=-0.3171 topkJ=0.0072
[TRAIN][ep=042] loss=0.5636 acc=73.02%
[TRAIN][ep=042] mask_avg: mc_mean=0.2109 mb_mean=0.5133 norm_overlap=0.9896 corr_cb=-0.3338
[EPOCH 042/089] train: loss=0.5636 acc=73.02% | val: loss=0.7904 acc=53.01% f1=67.77% auc=53.08% val_score=28.1109 val_score_bestthr=57.6460 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.211, mb=0.513, no=0.990, corr=-0.334) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.2320 -> 57.6460
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.1911 mb_mean=0.5142 norm_overlap=0.9907 corr_cb=-0.2738 topkJ=0.0195
[TRAIN][ep=043] loss=0.5667 acc=72.62%
[TRAIN][ep=043] mask_avg: mc_mean=0.2056 mb_mean=0.5133 norm_overlap=0.9896 corr_cb=-0.3281
[EPOCH 043/089] train: loss=0.5667 acc=72.62% | val: loss=0.7949 acc=54.22% f1=68.33% auc=52.85% val_score=29.1898 val_score_bestthr=58.8748 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.206, mb=0.513, no=0.990, corr=-0.328) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.2320 -> 58.8748
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.1346 mb_mean=0.5187 norm_overlap=0.9893 corr_cb=-0.2781 topkJ=0.0085
[TRAIN][ep=044] loss=0.5640 acc=72.48%
[TRAIN][ep=044] mask_avg: mc_mean=0.1898 mb_mean=0.5133 norm_overlap=0.9890 corr_cb=-0.3260
[EPOCH 044/089] train: loss=0.5640 acc=72.48% | val: loss=0.7848 acc=54.22% f1=68.33% auc=53.26% val_score=38.8730 val_score_bestthr=58.8748 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.513, no=0.989, corr=-0.326) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.2320 -> 58.8748
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.1814 mb_mean=0.5162 norm_overlap=0.9884 corr_cb=-0.3455 topkJ=0.0109
[TRAIN][ep=045] loss=0.5543 acc=73.56%
[TRAIN][ep=045] mask_avg: mc_mean=0.1978 mb_mean=0.5133 norm_overlap=0.9894 corr_cb=-0.3265
[EPOCH 045/089] train: loss=0.5543 acc=73.56% | val: loss=0.8203 acc=56.63% f1=68.42% auc=52.85% val_score=43.2453 val_score_bestthr=58.2662 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.198, mb=0.513, no=0.989, corr=-0.327) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.2320 -> 58.2662
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.2152 mb_mean=0.5140 norm_overlap=0.9926 corr_cb=-0.2751 topkJ=0.0188
[TRAIN][ep=046] loss=0.5575 acc=72.48%
[TRAIN][ep=046] mask_avg: mc_mean=0.2176 mb_mean=0.5133 norm_overlap=0.9901 corr_cb=-0.3212
[EPOCH 046/089] train: loss=0.5575 acc=72.48% | val: loss=0.7999 acc=54.22% f1=68.33% auc=53.26% val_score=41.0046 val_score_bestthr=58.8748 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.218, mb=0.513, no=0.990, corr=-0.321) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.2320 -> 58.8748
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.1696 mb_mean=0.5159 norm_overlap=0.9921 corr_cb=-0.2439 topkJ=0.0142
[TRAIN][ep=047] loss=0.5488 acc=72.75%
[TRAIN][ep=047] mask_avg: mc_mean=0.2146 mb_mean=0.5133 norm_overlap=0.9900 corr_cb=-0.3214
[EPOCH 047/089] train: loss=0.5488 acc=72.75% | val: loss=0.7914 acc=54.22% f1=68.33% auc=53.02% val_score=41.5261 val_score_bestthr=58.8748 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.215, mb=0.513, no=0.990, corr=-0.321) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.2320 -> 58.8748
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.1921 mb_mean=0.5175 norm_overlap=0.9842 corr_cb=-0.4439 topkJ=0.0004
[TRAIN][ep=048] loss=0.5428 acc=73.69%
[TRAIN][ep=048] mask_avg: mc_mean=0.1821 mb_mean=0.5133 norm_overlap=0.9887 corr_cb=-0.3225
[EPOCH 048/089] train: loss=0.5428 acc=73.69% | val: loss=0.8107 acc=54.22% f1=68.33% auc=53.26% val_score=39.7433 val_score_bestthr=58.8748 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.182, mb=0.513, no=0.989, corr=-0.323) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.2320 -> 58.8748
[DBG][ep=049] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.2604 mb_mean=0.5123 norm_overlap=0.9824 corr_cb=-0.4610 topkJ=0.0065
[TRAIN][ep=049] loss=0.5485 acc=73.15%
[TRAIN][ep=049] mask_avg: mc_mean=0.2071 mb_mean=0.5133 norm_overlap=0.9898 corr_cb=-0.3175
[EPOCH 049/089] train: loss=0.5485 acc=73.15% | val: loss=0.8032 acc=54.22% f1=68.33% auc=52.91% val_score=31.8771 val_score_bestthr=58.8748 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.207, mb=0.513, no=0.990, corr=-0.318) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.2320 -> 58.8748
[DBG][ep=050] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.1575 mb_mean=0.5142 norm_overlap=0.9828 corr_cb=-0.4096 topkJ=0.0118
[TRAIN][ep=050] loss=0.5326 acc=73.69%
[TRAIN][ep=050] mask_avg: mc_mean=0.1976 mb_mean=0.5133 norm_overlap=0.9894 corr_cb=-0.3195
[EPOCH 050/089] train: loss=0.5326 acc=73.69% | val: loss=0.8013 acc=54.22% f1=68.33% auc=53.37% val_score=40.4000 val_score_bestthr=58.8748 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.198, mb=0.513, no=0.989, corr=-0.319) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.2320 -> 58.8748
[DBG][ep=051] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.2144 mb_mean=0.5126 norm_overlap=0.9889 corr_cb=-0.3680 topkJ=0.0100
[TRAIN][ep=051] loss=0.5321 acc=75.17%
[TRAIN][ep=051] mask_avg: mc_mean=0.1977 mb_mean=0.5133 norm_overlap=0.9896 corr_cb=-0.3158
[EPOCH 051/089] train: loss=0.5321 acc=75.17% | val: loss=0.8012 acc=54.22% f1=68.33% auc=53.55% val_score=40.8619 val_score_bestthr=58.8748 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.198, mb=0.513, no=0.990, corr=-0.316) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.2320 -> 58.8748
[DBG][ep=052] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.2282 mb_mean=0.5125 norm_overlap=0.9927 corr_cb=-0.2645 topkJ=0.0257
[TRAIN][ep=052] loss=0.5342 acc=74.36%
[TRAIN][ep=052] mask_avg: mc_mean=0.1976 mb_mean=0.5133 norm_overlap=0.9894 corr_cb=-0.3189
[EPOCH 052/089] train: loss=0.5342 acc=74.36% | val: loss=0.8023 acc=54.22% f1=68.33% auc=53.26% val_score=35.7571 val_score_bestthr=58.8748 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.198, mb=0.513, no=0.989, corr=-0.319) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.2320 -> 58.8748
[DBG][ep=053] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.1780 mb_mean=0.5143 norm_overlap=0.9884 corr_cb=-0.3324 topkJ=0.0100
[TRAIN][ep=053] loss=0.5283 acc=74.90%
[TRAIN][ep=053] mask_avg: mc_mean=0.1976 mb_mean=0.5133 norm_overlap=0.9895 corr_cb=-0.3177
[EPOCH 053/089] train: loss=0.5283 acc=74.90% | val: loss=0.8030 acc=54.22% f1=68.33% auc=53.20% val_score=35.7571 val_score_bestthr=58.8748 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.198, mb=0.513, no=0.989, corr=-0.318) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.2320 -> 58.8748
[DBG][ep=054] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=054] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=054] mask(step0): mc_mean=0.1960 mb_mean=0.5098 norm_overlap=0.9907 corr_cb=-0.2946 topkJ=0.0121
[TRAIN][ep=054] loss=0.5269 acc=74.23%
[TRAIN][ep=054] mask_avg: mc_mean=0.1977 mb_mean=0.5133 norm_overlap=0.9894 corr_cb=-0.3189
[EPOCH 054/089] train: loss=0.5269 acc=74.23% | val: loss=0.8061 acc=54.22% f1=68.33% auc=53.02% val_score=40.8619 val_score_bestthr=58.8748 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.198, mb=0.513, no=0.989, corr=-0.319) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.2320 -> 58.8748
[DBG][ep=055] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=055] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=055] mask(step0): mc_mean=0.2213 mb_mean=0.5131 norm_overlap=0.9909 corr_cb=-0.3040 topkJ=0.0209
[TRAIN][ep=055] loss=0.5284 acc=73.83%
[TRAIN][ep=055] mask_avg: mc_mean=0.1976 mb_mean=0.5133 norm_overlap=0.9894 corr_cb=-0.3192
[EPOCH 055/089] train: loss=0.5284 acc=73.83% | val: loss=0.8065 acc=54.22% f1=68.33% auc=53.02% val_score=35.7571 val_score_bestthr=58.8748 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.198, mb=0.513, no=0.989, corr=-0.319) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.2320 -> 58.8748
[DBG][ep=056] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=056] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=056] mask(step0): mc_mean=0.1833 mb_mean=0.5127 norm_overlap=0.9929 corr_cb=-0.2631 topkJ=0.0266
[TRAIN][ep=056] loss=0.5261 acc=75.17%
[TRAIN][ep=056] mask_avg: mc_mean=0.1976 mb_mean=0.5133 norm_overlap=0.9894 corr_cb=-0.3185
[EPOCH 056/089] train: loss=0.5261 acc=75.17% | val: loss=0.8074 acc=54.22% f1=68.33% auc=52.85% val_score=37.2036 val_score_bestthr=58.8748 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.198, mb=0.513, no=0.989, corr=-0.318) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.2320 -> 58.8748
[DBG][ep=057] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=057] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=057] mask(step0): mc_mean=0.1657 mb_mean=0.5166 norm_overlap=0.9865 corr_cb=-0.3454 topkJ=0.0075
[TRAIN][ep=057] loss=0.5249 acc=74.77%
[TRAIN][ep=057] mask_avg: mc_mean=0.1976 mb_mean=0.5133 norm_overlap=0.9895 corr_cb=-0.3181
[EPOCH 057/089] train: loss=0.5249 acc=74.77% | val: loss=0.8088 acc=54.22% f1=68.33% auc=52.62% val_score=37.2036 val_score_bestthr=58.8748 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.198, mb=0.513, no=0.989, corr=-0.318) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.2320 -> 58.8748
[DBG][ep=058] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=058] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=058] mask(step0): mc_mean=0.1872 mb_mean=0.5124 norm_overlap=0.9901 corr_cb=-0.3402 topkJ=0.0153
[TRAIN][ep=058] loss=0.5232 acc=74.36%
[TRAIN][ep=058] mask_avg: mc_mean=0.1976 mb_mean=0.5133 norm_overlap=0.9894 corr_cb=-0.3186
[EPOCH 058/089] train: loss=0.5232 acc=74.36% | val: loss=0.8096 acc=54.22% f1=68.33% auc=53.37% val_score=40.6233 val_score_bestthr=58.8748 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.198, mb=0.513, no=0.989, corr=-0.319) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.2320 -> 58.8748
[DBG][ep=059] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=059] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=059] mask(step0): mc_mean=0.2421 mb_mean=0.5097 norm_overlap=0.9868 corr_cb=-0.4121 topkJ=0.0053
[TRAIN][ep=059] loss=0.5250 acc=75.03%
[TRAIN][ep=059] mask_avg: mc_mean=0.1976 mb_mean=0.5133 norm_overlap=0.9895 corr_cb=-0.3182
[EPOCH 059/089] train: loss=0.5250 acc=75.03% | val: loss=0.8106 acc=54.22% f1=68.33% auc=53.37% val_score=41.5261 val_score_bestthr=58.8748 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.198, mb=0.513, no=0.989, corr=-0.318) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.2320 -> 58.8748
[DBG][ep=060] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=060] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=060] mask(step0): mc_mean=0.1584 mb_mean=0.5176 norm_overlap=0.9903 corr_cb=-0.2459 topkJ=0.0126
[TRAIN][ep=060] loss=0.5231 acc=75.70%
[TRAIN][ep=060] mask_avg: mc_mean=0.1976 mb_mean=0.5133 norm_overlap=0.9895 corr_cb=-0.3187
[EPOCH 060/089] train: loss=0.5231 acc=75.70% | val: loss=0.8129 acc=54.22% f1=68.33% auc=52.79% val_score=37.2036 val_score_bestthr=58.8748 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.198, mb=0.513, no=0.989, corr=-0.319) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.2320 -> 58.8748
[DBG][ep=061] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=061] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=061] mask(step0): mc_mean=0.1905 mb_mean=0.5122 norm_overlap=0.9929 corr_cb=-0.2288 topkJ=0.0317
[TRAIN][ep=061] loss=0.5229 acc=74.90%
[TRAIN][ep=061] mask_avg: mc_mean=0.1976 mb_mean=0.5133 norm_overlap=0.9895 corr_cb=-0.3173
[EPOCH 061/089] train: loss=0.5229 acc=74.90% | val: loss=0.8170 acc=54.22% f1=68.33% auc=52.67% val_score=31.3900 val_score_bestthr=58.8748 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.198, mb=0.513, no=0.989, corr=-0.317) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.2320 -> 58.8748
[DBG][ep=062] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=062] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=062] mask(step0): mc_mean=0.2198 mb_mean=0.5129 norm_overlap=0.9850 corr_cb=-0.4057 topkJ=0.0083
[TRAIN][ep=062] loss=0.5233 acc=76.24%
[TRAIN][ep=062] mask_avg: mc_mean=0.1976 mb_mean=0.5133 norm_overlap=0.9894 corr_cb=-0.3178
[EPOCH 062/089] train: loss=0.5233 acc=76.24% | val: loss=0.8131 acc=54.22% f1=68.33% auc=52.91% val_score=37.2036 val_score_bestthr=58.8748 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.198, mb=0.513, no=0.989, corr=-0.318) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.2320 -> 58.8748
[DBG][ep=063] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=063] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=063] mask(step0): mc_mean=0.2127 mb_mean=0.5121 norm_overlap=0.9885 corr_cb=-0.3435 topkJ=0.0049
[TRAIN][ep=063] loss=0.5210 acc=75.70%
[TRAIN][ep=063] mask_avg: mc_mean=0.1975 mb_mean=0.5133 norm_overlap=0.9894 corr_cb=-0.3184
[EPOCH 063/089] train: loss=0.5210 acc=75.70% | val: loss=0.8143 acc=54.22% f1=68.33% auc=53.43% val_score=39.1079 val_score_bestthr=58.8748 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.198, mb=0.513, no=0.989, corr=-0.318) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.2320 -> 58.8748
[DBG][ep=064] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=064] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=064] mask(step0): mc_mean=0.2248 mb_mean=0.5123 norm_overlap=0.9846 corr_cb=-0.4580 topkJ=0.0071
[TRAIN][ep=064] loss=0.5190 acc=74.90%
[TRAIN][ep=064] mask_avg: mc_mean=0.1976 mb_mean=0.5133 norm_overlap=0.9895 corr_cb=-0.3157
[EPOCH 064/089] train: loss=0.5190 acc=74.90% | val: loss=0.8149 acc=54.22% f1=68.33% auc=53.37% val_score=41.5261 val_score_bestthr=58.8748 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.198, mb=0.513, no=0.990, corr=-0.316) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.2320 -> 58.8748
[EARLY STOP] no improvement for 30 epochs. best_epoch=34
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold4_rep0_seed4/ckpt_best_fold_4.pt
=============== FIT DONE ===============
[BEST] epoch=34 | val_acc=53.01% | val_f1=68.80% | val_auc=53.49% | val_score=40.4000 | val_score_bestthr=61.2320
[TEST@BEST] thr_used=0.445 | acc=68.12% f1=72.95% auc=72.35% | SP_sex=13.04% EO_sex=10.92% SP_age=5.98% EO_age=7.50%
[TIME] 1.54 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold4_rep0_seed4/summary_fold_4.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4593 mb_mean=0.5110 norm_overlap=1.0000 corr_cb=0.0210 topkJ=0.1340
[TRAIN][ep=000] loss=0.6957 acc=51.28%
[TRAIN][ep=000] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0304
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4604 mb_mean=0.5129 norm_overlap=1.0000 corr_cb=-0.0341 topkJ=0.0385
[TRAIN][ep=001] loss=0.6936 acc=49.53%
[TRAIN][ep=001] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0340
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4621 mb_mean=0.5138 norm_overlap=0.9999 corr_cb=-0.2061 topkJ=0.0705
[TRAIN][ep=002] loss=0.6922 acc=52.35%
[TRAIN][ep=002] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0391
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4656 mb_mean=0.5133 norm_overlap=0.9999 corr_cb=-0.1525 topkJ=0.0702
[TRAIN][ep=003] loss=0.6908 acc=55.03%
[TRAIN][ep=003] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0291
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4607 mb_mean=0.5127 norm_overlap=1.0000 corr_cb=-0.0560 topkJ=0.0532
[TRAIN][ep=004] loss=0.6894 acc=53.96%
[TRAIN][ep=004] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0333
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4627 mb_mean=0.5146 norm_overlap=1.0000 corr_cb=0.0401 topkJ=0.1020
[TRAIN][ep=005] loss=0.6883 acc=55.30%
[TRAIN][ep=005] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0327
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4643 mb_mean=0.5121 norm_overlap=0.9999 corr_cb=-0.1954 topkJ=0.0265
[TRAIN][ep=006] loss=0.6856 acc=56.24%
[TRAIN][ep=006] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0382
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4600 mb_mean=0.5162 norm_overlap=1.0000 corr_cb=-0.0688 topkJ=0.0382
[TRAIN][ep=007] loss=0.6857 acc=54.23%
[TRAIN][ep=007] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0316
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4601 mb_mean=0.5162 norm_overlap=0.9998 corr_cb=-0.3232 topkJ=0.0124
[TRAIN][ep=008] loss=0.6834 acc=57.58%
[TRAIN][ep=008] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0367
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4657 mb_mean=0.5110 norm_overlap=1.0001 corr_cb=0.2304 topkJ=0.1165
[TRAIN][ep=009] loss=0.6810 acc=58.26%
[TRAIN][ep=009] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0276
================= FIT START (fold=4) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4625 mb_mean=0.5166 norm_overlap=0.9999 corr_cb=-0.1231 topkJ=0.0325
[TRAIN][ep=000] loss=0.6781 acc=61.34%
[TRAIN][ep=000] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0298
[EPOCH 000/089] train: loss=0.6781 acc=61.34% | val: loss=0.6839 acc=56.63% f1=69.49% auc=58.78% val_score=52.0580 val_score_bestthr=61.0366 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.030) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 61.0366
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep0_seed4/ckpt_best_fold_4.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4617 mb_mean=0.5124 norm_overlap=1.0000 corr_cb=0.0896 topkJ=0.0788
[TRAIN][ep=001] loss=0.6732 acc=59.87%
[TRAIN][ep=001] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0301
[EPOCH 001/089] train: loss=0.6732 acc=59.87% | val: loss=0.6806 acc=54.22% f1=68.33% auc=59.88% val_score=52.5592 val_score_bestthr=57.0303 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.030) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.0366 -> 57.0303
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4651 mb_mean=0.5120 norm_overlap=1.0000 corr_cb=0.0785 topkJ=0.0875
[TRAIN][ep=002] loss=0.6699 acc=59.06%
[TRAIN][ep=002] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0344
[EPOCH 002/089] train: loss=0.6699 acc=59.06% | val: loss=0.6859 acc=55.42% f1=68.91% auc=58.26% val_score=46.7572 val_score_bestthr=59.5383 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.034) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.0366 -> 59.5383
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4604 mb_mean=0.5131 norm_overlap=1.0000 corr_cb=0.0074 topkJ=0.0496
[TRAIN][ep=003] loss=0.6661 acc=62.01%
[TRAIN][ep=003] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0360
[EPOCH 003/089] train: loss=0.6661 acc=62.01% | val: loss=0.6835 acc=54.22% f1=68.85% auc=58.37% val_score=47.1756 val_score_bestthr=57.8426 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.036) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.0366 -> 57.8426
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4599 mb_mean=0.5131 norm_overlap=0.9998 corr_cb=-0.3378 topkJ=0.0131
[TRAIN][ep=004] loss=0.6625 acc=59.73%
[TRAIN][ep=004] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0322
[EPOCH 004/089] train: loss=0.6625 acc=59.73% | val: loss=0.6819 acc=55.42% f1=68.91% auc=58.14% val_score=42.0950 val_score_bestthr=59.5383 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.032) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.0366 -> 59.5383
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4645 mb_mean=0.5123 norm_overlap=1.0000 corr_cb=0.1004 topkJ=0.0686
[TRAIN][ep=005] loss=1.4407 acc=60.40%
[TRAIN][ep=005] mask_avg: mc_mean=0.3531 mb_mean=0.5133 norm_overlap=0.9988 corr_cb=-0.3431
[EPOCH 005/089] train: loss=1.4407 acc=60.40% | val: loss=0.6796 acc=57.83% f1=69.57% auc=59.48% val_score=51.9020 val_score_bestthr=61.1138 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.353, mb=0.513, no=0.999, corr=-0.343) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 61.0366 -> 61.1138
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep0_seed4/ckpt_best_fold_4.pt
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2960 mb_mean=0.5091 norm_overlap=0.9982 corr_cb=-0.2913 topkJ=0.0204
[TRAIN][ep=006] loss=1.4245 acc=63.49%
[TRAIN][ep=006] mask_avg: mc_mean=0.2305 mb_mean=0.5133 norm_overlap=0.9967 corr_cb=-0.4061
[EPOCH 006/089] train: loss=1.4245 acc=63.49% | val: loss=0.6791 acc=56.63% f1=68.42% auc=58.72% val_score=46.9090 val_score_bestthr=61.5238 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.230, mb=0.513, no=0.997, corr=-0.406) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 61.1138 -> 61.5238
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep0_seed4/ckpt_best_fold_4.pt
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2072 mb_mean=0.5122 norm_overlap=0.9968 corr_cb=-0.3662 topkJ=0.0253
[TRAIN][ep=007] loss=1.4224 acc=62.42%
[TRAIN][ep=007] mask_avg: mc_mean=0.1891 mb_mean=0.5133 norm_overlap=0.9954 corr_cb=-0.4226
[EPOCH 007/089] train: loss=1.4224 acc=62.42% | val: loss=0.6845 acc=55.42% f1=68.38% auc=57.73% val_score=41.9574 val_score_bestthr=58.0473 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.189, mb=0.513, no=0.995, corr=-0.423) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.5238 -> 58.0473
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1238 mb_mean=0.5155 norm_overlap=0.9966 corr_cb=-0.2290 topkJ=0.0320
[TRAIN][ep=008] loss=1.4114 acc=64.83%
[TRAIN][ep=008] mask_avg: mc_mean=0.1562 mb_mean=0.5133 norm_overlap=0.9935 corr_cb=-0.4422
[EPOCH 008/089] train: loss=1.4114 acc=64.83% | val: loss=0.6877 acc=56.63% f1=68.97% auc=58.55% val_score=52.6532 val_score_bestthr=59.1465 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.156, mb=0.513, no=0.994, corr=-0.442) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.5238 -> 59.1465
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1732 mb_mean=0.5094 norm_overlap=0.9949 corr_cb=-0.3726 topkJ=0.0179
[TRAIN][ep=009] loss=1.4174 acc=64.43%
[TRAIN][ep=009] mask_avg: mc_mean=0.1431 mb_mean=0.5133 norm_overlap=0.9921 corr_cb=-0.4601
[EPOCH 009/089] train: loss=1.4174 acc=64.43% | val: loss=0.6857 acc=57.83% f1=69.03% auc=56.80% val_score=44.0466 val_score_bestthr=60.7136 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.143, mb=0.513, no=0.992, corr=-0.460) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.5238 -> 60.7136
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1414 mb_mean=0.5127 norm_overlap=0.9916 corr_cb=-0.4929 topkJ=0.0076
[TRAIN][ep=010] loss=1.4088 acc=62.95%
[TRAIN][ep=010] mask_avg: mc_mean=0.1285 mb_mean=0.5133 norm_overlap=0.9904 corr_cb=-0.4663
[EPOCH 010/089] train: loss=1.4088 acc=62.95% | val: loss=0.6819 acc=56.63% f1=68.97% auc=57.21% val_score=47.3839 val_score_bestthr=58.2131 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.129, mb=0.513, no=0.990, corr=-0.466) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.5238 -> 58.2131
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1136 mb_mean=0.5141 norm_overlap=0.9900 corr_cb=-0.4808 topkJ=0.0008
[TRAIN][ep=011] loss=1.3977 acc=65.10%
[TRAIN][ep=011] mask_avg: mc_mean=0.1364 mb_mean=0.5133 norm_overlap=0.9897 corr_cb=-0.4792
[EPOCH 011/089] train: loss=1.3977 acc=65.10% | val: loss=0.7055 acc=57.83% f1=68.47% auc=55.12% val_score=39.2605 val_score_bestthr=57.5164 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.136, mb=0.513, no=0.990, corr=-0.479) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.5238 -> 57.5164
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1750 mb_mean=0.5122 norm_overlap=0.9876 corr_cb=-0.5977 topkJ=0.0012
[TRAIN][ep=012] loss=1.1778 acc=64.56%
[TRAIN][ep=012] mask_avg: mc_mean=0.1300 mb_mean=0.5133 norm_overlap=0.9886 corr_cb=-0.4651
[EPOCH 012/089] train: loss=1.1778 acc=64.56% | val: loss=0.7048 acc=56.63% f1=69.49% auc=57.21% val_score=52.6313 val_score_bestthr=62.3588 | dyn(w_pfs=0.290, w_sup=0.190, w_csuf=0.140, stage2=False) | mask(mc=0.130, mb=0.513, no=0.989, corr=-0.465) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 61.5238 -> 62.3588
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep0_seed4/ckpt_best_fold_4.pt
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1426 mb_mean=0.5120 norm_overlap=0.9883 corr_cb=-0.4812 topkJ=0.0020
[TRAIN][ep=013] loss=1.2611 acc=64.43%
[TRAIN][ep=013] mask_avg: mc_mean=0.1319 mb_mean=0.5133 norm_overlap=0.9880 corr_cb=-0.4741
[EPOCH 013/089] train: loss=1.2611 acc=64.43% | val: loss=0.6876 acc=56.63% f1=68.97% auc=56.28% val_score=47.3839 val_score_bestthr=58.2131 | dyn(w_pfs=0.330, w_sup=0.230, w_csuf=0.180, stage2=False) | mask(mc=0.132, mb=0.513, no=0.988, corr=-0.474) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 58.2131
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1907 mb_mean=0.5110 norm_overlap=0.9812 corr_cb=-0.6331 topkJ=0.0000
[TRAIN][ep=014] loss=1.3277 acc=67.79%
[TRAIN][ep=014] mask_avg: mc_mean=0.1321 mb_mean=0.5133 norm_overlap=0.9872 corr_cb=-0.4640
[EPOCH 014/089] train: loss=1.3277 acc=67.79% | val: loss=0.6972 acc=56.63% f1=68.97% auc=55.81% val_score=38.8773 val_score_bestthr=58.2131 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.132, mb=0.513, no=0.987, corr=-0.464) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 58.2131
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.0728 mb_mean=0.5172 norm_overlap=0.9839 corr_cb=-0.4532 topkJ=0.0012
[TRAIN][ep=015] loss=1.3689 acc=66.98%
[TRAIN][ep=015] mask_avg: mc_mean=0.1405 mb_mean=0.5133 norm_overlap=0.9872 corr_cb=-0.4548
[EPOCH 015/089] train: loss=1.3689 acc=66.98% | val: loss=0.6983 acc=55.42% f1=68.38% auc=55.76% val_score=43.8410 val_score_bestthr=56.7140 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.141, mb=0.513, no=0.987, corr=-0.455) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 56.7140
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1429 mb_mean=0.5145 norm_overlap=0.9829 corr_cb=-0.5308 topkJ=0.0012
[TRAIN][ep=016] loss=1.3729 acc=64.43%
[TRAIN][ep=016] mask_avg: mc_mean=0.1401 mb_mean=0.5133 norm_overlap=0.9868 corr_cb=-0.4488
[EPOCH 016/089] train: loss=1.3729 acc=64.43% | val: loss=0.7113 acc=55.42% f1=68.91% auc=56.34% val_score=55.4680 val_score_bestthr=59.9272 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.140, mb=0.513, no=0.987, corr=-0.449) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 59.9272
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1269 mb_mean=0.5136 norm_overlap=0.9844 corr_cb=-0.4808 topkJ=0.0016
[TRAIN][ep=017] loss=1.3524 acc=67.65%
[TRAIN][ep=017] mask_avg: mc_mean=0.1482 mb_mean=0.5133 norm_overlap=0.9871 corr_cb=-0.4459
[EPOCH 017/089] train: loss=1.3524 acc=67.65% | val: loss=0.7232 acc=57.83% f1=69.57% auc=55.17% val_score=32.6665 val_score_bestthr=59.7138 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.148, mb=0.513, no=0.987, corr=-0.446) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 59.7138
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1089 mb_mean=0.5148 norm_overlap=0.9867 corr_cb=-0.3874 topkJ=0.0038
[TRAIN][ep=018] loss=1.1272 acc=68.46%
[TRAIN][ep=018] mask_avg: mc_mean=0.1517 mb_mean=0.5133 norm_overlap=0.9870 corr_cb=-0.4390
[EPOCH 018/089] train: loss=1.1272 acc=68.46% | val: loss=0.7173 acc=55.42% f1=68.38% auc=54.88% val_score=42.0192 val_score_bestthr=56.7140 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.152, mb=0.513, no=0.987, corr=-0.439) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 56.7140
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1415 mb_mean=0.5144 norm_overlap=0.9885 corr_cb=-0.4260 topkJ=0.0040
[TRAIN][ep=019] loss=0.9083 acc=68.59%
[TRAIN][ep=019] mask_avg: mc_mean=0.1532 mb_mean=0.5133 norm_overlap=0.9871 corr_cb=-0.4224
[EPOCH 019/089] train: loss=0.9083 acc=68.59% | val: loss=0.7595 acc=54.22% f1=68.33% auc=54.53% val_score=54.1330 val_score_bestthr=58.3637 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.153, mb=0.513, no=0.987, corr=-0.422) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 58.3637
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1557 mb_mean=0.5125 norm_overlap=0.9855 corr_cb=-0.4658 topkJ=0.0023
[TRAIN][ep=020] loss=0.8744 acc=68.32%
[TRAIN][ep=020] mask_avg: mc_mean=0.1560 mb_mean=0.5133 norm_overlap=0.9874 corr_cb=-0.4171
[EPOCH 020/089] train: loss=0.8744 acc=68.32% | val: loss=0.7357 acc=55.42% f1=68.38% auc=54.83% val_score=37.3466 val_score_bestthr=56.7140 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.156, mb=0.513, no=0.987, corr=-0.417) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 56.7140
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.1741 mb_mean=0.5107 norm_overlap=0.9850 corr_cb=-0.4850 topkJ=0.0037
[TRAIN][ep=021] loss=0.8497 acc=68.59%
[TRAIN][ep=021] mask_avg: mc_mean=0.1397 mb_mean=0.5133 norm_overlap=0.9864 corr_cb=-0.4162
[EPOCH 021/089] train: loss=0.8497 acc=68.59% | val: loss=0.7262 acc=59.04% f1=69.09% auc=54.94% val_score=40.2377 val_score_bestthr=55.6753 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.140, mb=0.513, no=0.986, corr=-0.416) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 55.6753
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1245 mb_mean=0.5140 norm_overlap=0.9936 corr_cb=-0.2208 topkJ=0.0074
[TRAIN][ep=022] loss=0.8367 acc=69.66%
[TRAIN][ep=022] mask_avg: mc_mean=0.1558 mb_mean=0.5133 norm_overlap=0.9868 corr_cb=-0.4252
[EPOCH 022/089] train: loss=0.8367 acc=69.66% | val: loss=0.7455 acc=55.42% f1=68.91% auc=55.29% val_score=45.1090 val_score_bestthr=59.9272 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.156, mb=0.513, no=0.987, corr=-0.425) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 59.9272
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1786 mb_mean=0.5105 norm_overlap=0.9853 corr_cb=-0.4369 topkJ=0.0040
[TRAIN][ep=023] loss=0.8365 acc=70.74%
[TRAIN][ep=023] mask_avg: mc_mean=0.1595 mb_mean=0.5133 norm_overlap=0.9870 corr_cb=-0.4157
[EPOCH 023/089] train: loss=0.8365 acc=70.74% | val: loss=0.7503 acc=60.24% f1=68.57% auc=54.71% val_score=37.3466 val_score_bestthr=57.4283 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.159, mb=0.513, no=0.987, corr=-0.416) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 57.4283
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1735 mb_mean=0.5126 norm_overlap=0.9871 corr_cb=-0.4216 topkJ=0.0077
[TRAIN][ep=024] loss=0.8265 acc=70.87%
[TRAIN][ep=024] mask_avg: mc_mean=0.1595 mb_mean=0.5133 norm_overlap=0.9869 corr_cb=-0.4148
[EPOCH 024/089] train: loss=0.8265 acc=70.87% | val: loss=0.7466 acc=55.42% f1=68.91% auc=54.77% val_score=45.9962 val_score_bestthr=59.9272 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.160, mb=0.513, no=0.987, corr=-0.415) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 59.9272
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2008 mb_mean=0.5144 norm_overlap=0.9905 corr_cb=-0.4027 topkJ=0.0068
[TRAIN][ep=025] loss=0.8388 acc=69.40%
[TRAIN][ep=025] mask_avg: mc_mean=0.1900 mb_mean=0.5133 norm_overlap=0.9886 corr_cb=-0.4060
[EPOCH 025/089] train: loss=0.8388 acc=69.40% | val: loss=0.7467 acc=54.22% f1=68.33% auc=55.00% val_score=37.6893 val_score_bestthr=58.8748 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.513, no=0.989, corr=-0.406) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 58.8748
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1618 mb_mean=0.5127 norm_overlap=0.9908 corr_cb=-0.3392 topkJ=0.0095
[TRAIN][ep=026] loss=0.8232 acc=70.60%
[TRAIN][ep=026] mask_avg: mc_mean=0.1754 mb_mean=0.5133 norm_overlap=0.9880 corr_cb=-0.4041
[EPOCH 026/089] train: loss=0.8232 acc=70.60% | val: loss=0.7527 acc=54.22% f1=68.33% auc=55.29% val_score=40.5842 val_score_bestthr=58.8748 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.175, mb=0.513, no=0.988, corr=-0.404) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 58.8748
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1823 mb_mean=0.5153 norm_overlap=0.9935 corr_cb=-0.2917 topkJ=0.0145
[TRAIN][ep=027] loss=0.8110 acc=71.14%
[TRAIN][ep=027] mask_avg: mc_mean=0.1847 mb_mean=0.5133 norm_overlap=0.9882 corr_cb=-0.4017
[EPOCH 027/089] train: loss=0.8110 acc=71.14% | val: loss=0.7552 acc=55.42% f1=68.91% auc=55.70% val_score=44.1756 val_score_bestthr=59.9272 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.185, mb=0.513, no=0.988, corr=-0.402) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 59.9272
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1395 mb_mean=0.5149 norm_overlap=0.9844 corr_cb=-0.4431 topkJ=0.0043
[TRAIN][ep=028] loss=0.8118 acc=72.48%
[TRAIN][ep=028] mask_avg: mc_mean=0.1868 mb_mean=0.5133 norm_overlap=0.9884 corr_cb=-0.3978
[EPOCH 028/089] train: loss=0.8118 acc=72.48% | val: loss=0.7660 acc=55.42% f1=68.91% auc=55.17% val_score=42.1438 val_score_bestthr=59.9272 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.187, mb=0.513, no=0.988, corr=-0.398) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 59.9272
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.1323 mb_mean=0.5150 norm_overlap=0.9893 corr_cb=-0.3235 topkJ=0.0122
[TRAIN][ep=029] loss=0.7979 acc=72.21%
[TRAIN][ep=029] mask_avg: mc_mean=0.1644 mb_mean=0.5133 norm_overlap=0.9874 corr_cb=-0.3980
[EPOCH 029/089] train: loss=0.7979 acc=72.21% | val: loss=0.7705 acc=56.63% f1=69.49% auc=54.24% val_score=37.4444 val_score_bestthr=59.8699 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.164, mb=0.513, no=0.987, corr=-0.398) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 59.8699
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2113 mb_mean=0.5126 norm_overlap=0.9878 corr_cb=-0.4524 topkJ=0.0040
[TRAIN][ep=030] loss=0.7994 acc=72.21%
[TRAIN][ep=030] mask_avg: mc_mean=0.1915 mb_mean=0.5133 norm_overlap=0.9886 corr_cb=-0.3945
[EPOCH 030/089] train: loss=0.7994 acc=72.21% | val: loss=0.7812 acc=55.42% f1=68.91% auc=54.30% val_score=41.0046 val_score_bestthr=59.9272 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.192, mb=0.513, no=0.989, corr=-0.395) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 59.9272
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2588 mb_mean=0.5107 norm_overlap=0.9930 corr_cb=-0.3437 topkJ=0.0115
[TRAIN][ep=031] loss=0.7904 acc=73.15%
[TRAIN][ep=031] mask_avg: mc_mean=0.1936 mb_mean=0.5133 norm_overlap=0.9889 corr_cb=-0.3863
[EPOCH 031/089] train: loss=0.7904 acc=73.15% | val: loss=0.7714 acc=55.42% f1=68.91% auc=54.48% val_score=41.5261 val_score_bestthr=59.9272 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.194, mb=0.513, no=0.989, corr=-0.386) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 59.9272
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2050 mb_mean=0.5139 norm_overlap=0.9897 corr_cb=-0.4218 topkJ=0.0160
[TRAIN][ep=032] loss=0.7775 acc=74.36%
[TRAIN][ep=032] mask_avg: mc_mean=0.2038 mb_mean=0.5133 norm_overlap=0.9892 corr_cb=-0.3858
[EPOCH 032/089] train: loss=0.7775 acc=74.36% | val: loss=0.7845 acc=54.22% f1=68.33% auc=54.94% val_score=34.7887 val_score_bestthr=58.8748 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.204, mb=0.513, no=0.989, corr=-0.386) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 58.8748
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1266 mb_mean=0.5107 norm_overlap=0.9932 corr_cb=-0.2298 topkJ=0.0204
[TRAIN][ep=033] loss=0.7754 acc=73.42%
[TRAIN][ep=033] mask_avg: mc_mean=0.1892 mb_mean=0.5133 norm_overlap=0.9888 corr_cb=-0.3820
[EPOCH 033/089] train: loss=0.7754 acc=73.42% | val: loss=0.8162 acc=54.22% f1=68.33% auc=54.19% val_score=30.6294 val_score_bestthr=58.8748 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.189, mb=0.513, no=0.989, corr=-0.382) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 58.8748
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1531 mb_mean=0.5160 norm_overlap=0.9857 corr_cb=-0.4123 topkJ=0.0035
[TRAIN][ep=034] loss=0.7735 acc=74.90%
[TRAIN][ep=034] mask_avg: mc_mean=0.1760 mb_mean=0.5133 norm_overlap=0.9881 corr_cb=-0.3832
[EPOCH 034/089] train: loss=0.7735 acc=74.90% | val: loss=0.7874 acc=54.22% f1=67.80% auc=54.30% val_score=40.7655 val_score_bestthr=56.5497 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.176, mb=0.513, no=0.988, corr=-0.383) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 56.5497
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2129 mb_mean=0.5138 norm_overlap=0.9896 corr_cb=-0.4284 topkJ=0.0032
[TRAIN][ep=035] loss=0.7632 acc=75.44%
[TRAIN][ep=035] mask_avg: mc_mean=0.1905 mb_mean=0.5133 norm_overlap=0.9887 corr_cb=-0.3783
[EPOCH 035/089] train: loss=0.7632 acc=75.44% | val: loss=0.7996 acc=55.42% f1=68.38% auc=54.65% val_score=31.8410 val_score_bestthr=57.3807 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.513, no=0.989, corr=-0.378) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 57.3807
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.1524 mb_mean=0.5137 norm_overlap=0.9891 corr_cb=-0.3676 topkJ=0.0035
[TRAIN][ep=036] loss=0.7781 acc=73.02%
[TRAIN][ep=036] mask_avg: mc_mean=0.1794 mb_mean=0.5133 norm_overlap=0.9881 corr_cb=-0.3822
[EPOCH 036/089] train: loss=0.7781 acc=73.02% | val: loss=0.7979 acc=54.22% f1=67.80% auc=53.84% val_score=47.1756 val_score_bestthr=56.5497 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.179, mb=0.513, no=0.988, corr=-0.382) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 56.5497
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1949 mb_mean=0.5159 norm_overlap=0.9875 corr_cb=-0.3750 topkJ=0.0066
[TRAIN][ep=037] loss=0.7523 acc=75.44%
[TRAIN][ep=037] mask_avg: mc_mean=0.2116 mb_mean=0.5133 norm_overlap=0.9893 corr_cb=-0.3788
[EPOCH 037/089] train: loss=0.7523 acc=75.44% | val: loss=0.8204 acc=54.22% f1=67.80% auc=54.71% val_score=48.3441 val_score_bestthr=56.5497 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.212, mb=0.513, no=0.989, corr=-0.379) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 56.5497
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.1802 mb_mean=0.5132 norm_overlap=0.9863 corr_cb=-0.4182 topkJ=0.0071
[TRAIN][ep=038] loss=0.7560 acc=75.97%
[TRAIN][ep=038] mask_avg: mc_mean=0.1843 mb_mean=0.5133 norm_overlap=0.9883 corr_cb=-0.3792
[EPOCH 038/089] train: loss=0.7560 acc=75.97% | val: loss=0.8142 acc=54.22% f1=67.80% auc=54.53% val_score=34.1703 val_score_bestthr=56.5497 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.184, mb=0.513, no=0.988, corr=-0.379) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 56.5497
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.1778 mb_mean=0.5157 norm_overlap=0.9858 corr_cb=-0.4580 topkJ=0.0063
[TRAIN][ep=039] loss=0.7548 acc=76.24%
[TRAIN][ep=039] mask_avg: mc_mean=0.1901 mb_mean=0.5133 norm_overlap=0.9885 corr_cb=-0.3770
[EPOCH 039/089] train: loss=0.7548 acc=76.24% | val: loss=0.8357 acc=54.22% f1=67.80% auc=54.53% val_score=36.2183 val_score_bestthr=56.5497 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.513, no=0.989, corr=-0.377) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 56.5497
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.1806 mb_mean=0.5137 norm_overlap=0.9886 corr_cb=-0.3837 topkJ=0.0086
[TRAIN][ep=040] loss=0.7376 acc=76.24%
[TRAIN][ep=040] mask_avg: mc_mean=0.2036 mb_mean=0.5133 norm_overlap=0.9892 corr_cb=-0.3714
[EPOCH 040/089] train: loss=0.7376 acc=76.24% | val: loss=0.8188 acc=53.01% f1=68.80% auc=54.53% val_score=40.7571 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.204, mb=0.513, no=0.989, corr=-0.371) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 61.2320
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.1839 mb_mean=0.5141 norm_overlap=0.9923 corr_cb=-0.2659 topkJ=0.0176
[TRAIN][ep=041] loss=0.7337 acc=77.32%
[TRAIN][ep=041] mask_avg: mc_mean=0.1883 mb_mean=0.5133 norm_overlap=0.9883 corr_cb=-0.3737
[EPOCH 041/089] train: loss=0.7337 acc=77.32% | val: loss=0.8333 acc=54.22% f1=67.80% auc=54.48% val_score=39.0861 val_score_bestthr=56.5497 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.188, mb=0.513, no=0.988, corr=-0.374) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 56.5497
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.1790 mb_mean=0.5130 norm_overlap=0.9881 corr_cb=-0.3485 topkJ=0.0092
[TRAIN][ep=042] loss=0.7221 acc=77.18%
[TRAIN][ep=042] mask_avg: mc_mean=0.1978 mb_mean=0.5133 norm_overlap=0.9887 corr_cb=-0.3722
[EPOCH 042/089] train: loss=0.7221 acc=77.18% | val: loss=0.8465 acc=54.22% f1=67.80% auc=54.65% val_score=33.3031 val_score_bestthr=56.5497 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.198, mb=0.513, no=0.989, corr=-0.372) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 56.5497
[EARLY STOP] no improvement for 30 epochs. best_epoch=12
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold4_rep0_seed4/ckpt_best_fold_4.pt
=============== FIT DONE ===============
[BEST] epoch=12 | val_acc=56.63% | val_f1=69.49% | val_auc=57.21% | val_score=52.6313 | val_score_bestthr=62.3588
[TEST@BEST] thr_used=0.590 | acc=65.70% f1=69.00% auc=68.17% | SP_sex=11.41% EO_sex=6.37% SP_age=12.24% EO_age=15.00%
[TIME] 1.07 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold4_rep0_seed4/summary_fold_4.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4593 mb_mean=0.5110 norm_overlap=1.0000 corr_cb=0.0210 topkJ=0.1340
[TRAIN][ep=000] loss=0.6957 acc=51.28%
[TRAIN][ep=000] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0304
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4604 mb_mean=0.5129 norm_overlap=1.0000 corr_cb=-0.0341 topkJ=0.0385
[TRAIN][ep=001] loss=0.6936 acc=49.53%
[TRAIN][ep=001] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0340
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4621 mb_mean=0.5138 norm_overlap=0.9999 corr_cb=-0.2061 topkJ=0.0705
[TRAIN][ep=002] loss=0.6922 acc=52.35%
[TRAIN][ep=002] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0391
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4656 mb_mean=0.5133 norm_overlap=0.9999 corr_cb=-0.1525 topkJ=0.0702
[TRAIN][ep=003] loss=0.6908 acc=55.03%
[TRAIN][ep=003] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0291
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4607 mb_mean=0.5127 norm_overlap=1.0000 corr_cb=-0.0560 topkJ=0.0532
[TRAIN][ep=004] loss=0.6894 acc=53.96%
[TRAIN][ep=004] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0333
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4627 mb_mean=0.5146 norm_overlap=1.0000 corr_cb=0.0401 topkJ=0.1020
[TRAIN][ep=005] loss=0.6883 acc=55.30%
[TRAIN][ep=005] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0327
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4643 mb_mean=0.5121 norm_overlap=0.9999 corr_cb=-0.1954 topkJ=0.0265
[TRAIN][ep=006] loss=0.6856 acc=56.24%
[TRAIN][ep=006] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0382
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4600 mb_mean=0.5162 norm_overlap=1.0000 corr_cb=-0.0688 topkJ=0.0382
[TRAIN][ep=007] loss=0.6857 acc=54.23%
[TRAIN][ep=007] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0316
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4601 mb_mean=0.5162 norm_overlap=0.9998 corr_cb=-0.3232 topkJ=0.0124
[TRAIN][ep=008] loss=0.6834 acc=57.58%
[TRAIN][ep=008] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0367
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4657 mb_mean=0.5110 norm_overlap=1.0001 corr_cb=0.2304 topkJ=0.1165
[TRAIN][ep=009] loss=0.6810 acc=58.26%
[TRAIN][ep=009] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0276
================= FIT START (fold=4) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.45 select_by=val_score_bestthr | eval_thr_mode=fixed eval_thr_grid=coarse | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4625 mb_mean=0.5166 norm_overlap=0.9999 corr_cb=-0.1231 topkJ=0.0325
[TRAIN][ep=000] loss=0.6781 acc=61.34%
[TRAIN][ep=000] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0298
[EPOCH 000/089] train: loss=0.6781 acc=61.34% | val: loss=0.6839 acc=56.63% f1=69.49% auc=58.78% val_score=61.0366 val_score_bestthr=61.0366 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.030) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 61.0366
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep0_seed4/ckpt_best_fold_4.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4617 mb_mean=0.5124 norm_overlap=1.0000 corr_cb=0.0896 topkJ=0.0788
[TRAIN][ep=001] loss=0.6732 acc=59.87%
[TRAIN][ep=001] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0301
[EPOCH 001/089] train: loss=0.6732 acc=59.87% | val: loss=0.6806 acc=51.81% f1=68.25% auc=59.88% val_score=62.0453 val_score_bestthr=62.0453 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.030) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 61.0366 -> 62.0453
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep0_seed4/ckpt_best_fold_4.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4651 mb_mean=0.5120 norm_overlap=1.0000 corr_cb=0.0785 topkJ=0.0875
[TRAIN][ep=002] loss=0.6699 acc=59.06%
[TRAIN][ep=002] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0344
[EPOCH 002/089] train: loss=0.6699 acc=59.06% | val: loss=0.6859 acc=53.01% f1=61.39% auc=58.26% val_score=52.5287 val_score_bestthr=52.5287 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.034) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 52.5287
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4604 mb_mean=0.5131 norm_overlap=1.0000 corr_cb=0.0074 topkJ=0.0496
[TRAIN][ep=003] loss=0.6661 acc=62.01%
[TRAIN][ep=003] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0360
[EPOCH 003/089] train: loss=0.6661 acc=62.01% | val: loss=0.6835 acc=54.22% f1=62.75% auc=58.37% val_score=53.1116 val_score_bestthr=53.1116 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.036) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 53.1116
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4599 mb_mean=0.5131 norm_overlap=0.9998 corr_cb=-0.3378 topkJ=0.0131
[TRAIN][ep=004] loss=0.6625 acc=59.73%
[TRAIN][ep=004] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0322
[EPOCH 004/089] train: loss=0.6625 acc=59.73% | val: loss=0.6818 acc=54.22% f1=62.75% auc=58.14% val_score=53.1116 val_score_bestthr=53.1116 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.032) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 53.1116
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4645 mb_mean=0.5123 norm_overlap=1.0000 corr_cb=0.1004 topkJ=0.0686
[TRAIN][ep=005] loss=1.4407 acc=60.40%
[TRAIN][ep=005] mask_avg: mc_mean=0.3531 mb_mean=0.5133 norm_overlap=0.9988 corr_cb=-0.3431
[EPOCH 005/089] train: loss=1.4407 acc=60.40% | val: loss=0.6796 acc=51.81% f1=67.21% auc=59.48% val_score=55.1801 val_score_bestthr=55.1801 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.353, mb=0.513, no=0.999, corr=-0.343) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 55.1801
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2960 mb_mean=0.5091 norm_overlap=0.9982 corr_cb=-0.2912 topkJ=0.0204
[TRAIN][ep=006] loss=1.4245 acc=63.49%
[TRAIN][ep=006] mask_avg: mc_mean=0.2305 mb_mean=0.5133 norm_overlap=0.9967 corr_cb=-0.4061
[EPOCH 006/089] train: loss=1.4245 acc=63.49% | val: loss=0.6791 acc=56.63% f1=68.42% auc=58.72% val_score=61.5238 val_score_bestthr=61.5238 | dyn(w_pfs=0.240, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.230, mb=0.513, no=0.997, corr=-0.406) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 61.5238
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2071 mb_mean=0.5122 norm_overlap=0.9968 corr_cb=-0.3661 topkJ=0.0253
[TRAIN][ep=007] loss=1.2042 acc=62.55%
[TRAIN][ep=007] mask_avg: mc_mean=0.1894 mb_mean=0.5133 norm_overlap=0.9954 corr_cb=-0.4235
[EPOCH 007/089] train: loss=1.2042 acc=62.55% | val: loss=0.6837 acc=53.01% f1=60.61% auc=57.79% val_score=49.7577 val_score_bestthr=49.7577 | dyn(w_pfs=0.140, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.189, mb=0.513, no=0.995, corr=-0.424) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 49.7577
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1247 mb_mean=0.5155 norm_overlap=0.9966 corr_cb=-0.2303 topkJ=0.0296
[TRAIN][ep=008] loss=0.9764 acc=65.37%
[TRAIN][ep=008] mask_avg: mc_mean=0.1590 mb_mean=0.5133 norm_overlap=0.9935 corr_cb=-0.4416
[EPOCH 008/089] train: loss=0.9764 acc=65.37% | val: loss=0.6889 acc=51.81% f1=67.21% auc=58.49% val_score=55.1801 val_score_bestthr=55.1801 | dyn(w_pfs=0.040, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.159, mb=0.513, no=0.994, corr=-0.442) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 55.1801
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1783 mb_mean=0.5094 norm_overlap=0.9949 corr_cb=-0.3738 topkJ=0.0175
[TRAIN][ep=009] loss=0.9376 acc=64.16%
[TRAIN][ep=009] mask_avg: mc_mean=0.1482 mb_mean=0.5133 norm_overlap=0.9922 corr_cb=-0.4526
[EPOCH 009/089] train: loss=0.9376 acc=64.16% | val: loss=0.6848 acc=55.42% f1=61.05% auc=57.03% val_score=48.6596 val_score_bestthr=48.6596 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.148, mb=0.513, no=0.992, corr=-0.453) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 48.6596
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1473 mb_mean=0.5127 norm_overlap=0.9917 corr_cb=-0.4888 topkJ=0.0068
[TRAIN][ep=010] loss=0.9184 acc=63.36%
[TRAIN][ep=010] mask_avg: mc_mean=0.1333 mb_mean=0.5133 norm_overlap=0.9904 corr_cb=-0.4579
[EPOCH 010/089] train: loss=0.9184 acc=63.36% | val: loss=0.6825 acc=54.22% f1=62.75% auc=57.15% val_score=51.5561 val_score_bestthr=51.5561 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.133, mb=0.513, no=0.990, corr=-0.458) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 51.5561
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1172 mb_mean=0.5141 norm_overlap=0.9900 corr_cb=-0.4714 topkJ=0.0008
[TRAIN][ep=011] loss=0.9078 acc=65.77%
[TRAIN][ep=011] mask_avg: mc_mean=0.1427 mb_mean=0.5133 norm_overlap=0.9898 corr_cb=-0.4694
[EPOCH 011/089] train: loss=0.9078 acc=65.77% | val: loss=0.7072 acc=49.40% f1=44.74% auc=55.29% val_score=40.3449 val_score_bestthr=40.3449 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.143, mb=0.513, no=0.990, corr=-0.469) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 40.3449
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1818 mb_mean=0.5122 norm_overlap=0.9877 corr_cb=-0.5885 topkJ=0.0012
[TRAIN][ep=012] loss=0.9034 acc=64.56%
[TRAIN][ep=012] mask_avg: mc_mean=0.1337 mb_mean=0.5133 norm_overlap=0.9885 corr_cb=-0.4581
[EPOCH 012/089] train: loss=0.9034 acc=64.56% | val: loss=0.7079 acc=56.63% f1=69.49% auc=57.33% val_score=62.3588 val_score_bestthr=62.3588 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.134, mb=0.513, no=0.989, corr=-0.458) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 62.0453 -> 62.3588
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep0_seed4/ckpt_best_fold_4.pt
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1486 mb_mean=0.5120 norm_overlap=0.9883 corr_cb=-0.4780 topkJ=0.0028
[TRAIN][ep=013] loss=0.9893 acc=65.23%
[TRAIN][ep=013] mask_avg: mc_mean=0.1329 mb_mean=0.5133 norm_overlap=0.9878 corr_cb=-0.4691
[EPOCH 013/089] train: loss=0.9893 acc=65.23% | val: loss=0.6892 acc=53.01% f1=61.39% auc=56.34% val_score=45.4721 val_score_bestthr=45.4721 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.133, mb=0.513, no=0.988, corr=-0.469) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 45.4721
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1885 mb_mean=0.5110 norm_overlap=0.9809 corr_cb=-0.6272 topkJ=0.0000
[TRAIN][ep=014] loss=1.0595 acc=67.38%
[TRAIN][ep=014] mask_avg: mc_mean=0.1263 mb_mean=0.5133 norm_overlap=0.9867 corr_cb=-0.4621
[EPOCH 014/089] train: loss=1.0595 acc=67.38% | val: loss=0.6961 acc=55.42% f1=59.34% auc=55.99% val_score=48.7040 val_score_bestthr=48.7040 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.126, mb=0.513, no=0.987, corr=-0.462) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 48.7040
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.0684 mb_mean=0.5172 norm_overlap=0.9832 corr_cb=-0.4513 topkJ=0.0004
[TRAIN][ep=015] loss=1.1438 acc=66.71%
[TRAIN][ep=015] mask_avg: mc_mean=0.1318 mb_mean=0.5133 norm_overlap=0.9864 corr_cb=-0.4585
[EPOCH 015/089] train: loss=1.1438 acc=66.71% | val: loss=0.6985 acc=57.83% f1=67.29% auc=56.05% val_score=56.3382 val_score_bestthr=56.3382 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.132, mb=0.513, no=0.986, corr=-0.459) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 56.3382
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1369 mb_mean=0.5145 norm_overlap=0.9821 corr_cb=-0.5332 topkJ=0.0008
[TRAIN][ep=016] loss=1.2329 acc=64.83%
[TRAIN][ep=016] mask_avg: mc_mean=0.1315 mb_mean=0.5133 norm_overlap=0.9859 corr_cb=-0.4567
[EPOCH 016/089] train: loss=1.2329 acc=64.83% | val: loss=0.7089 acc=55.42% f1=67.26% auc=56.22% val_score=52.4034 val_score_bestthr=52.4034 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.131, mb=0.513, no=0.986, corr=-0.457) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 52.4034
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1131 mb_mean=0.5136 norm_overlap=0.9832 corr_cb=-0.4805 topkJ=0.0008
[TRAIN][ep=017] loss=1.2991 acc=67.79%
[TRAIN][ep=017] mask_avg: mc_mean=0.1364 mb_mean=0.5133 norm_overlap=0.9860 corr_cb=-0.4553
[EPOCH 017/089] train: loss=1.2991 acc=67.79% | val: loss=0.7224 acc=46.99% f1=43.59% auc=55.12% val_score=33.0397 val_score_bestthr=33.0397 | dyn(w_pfs=0.100, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.136, mb=0.513, no=0.986, corr=-0.455) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 33.0397
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1024 mb_mean=0.5148 norm_overlap=0.9859 corr_cb=-0.3934 topkJ=0.0038
[TRAIN][ep=018] loss=1.0732 acc=68.05%
[TRAIN][ep=018] mask_avg: mc_mean=0.1447 mb_mean=0.5133 norm_overlap=0.9861 corr_cb=-0.4516
[EPOCH 018/089] train: loss=1.0732 acc=68.05% | val: loss=0.7164 acc=54.22% f1=57.78% auc=54.77% val_score=47.6940 val_score_bestthr=47.6940 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.145, mb=0.513, no=0.986, corr=-0.452) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 47.6940
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1390 mb_mean=0.5144 norm_overlap=0.9877 corr_cb=-0.4455 topkJ=0.0036
[TRAIN][ep=019] loss=0.8540 acc=68.59%
[TRAIN][ep=019] mask_avg: mc_mean=0.1502 mb_mean=0.5133 norm_overlap=0.9864 corr_cb=-0.4375
[EPOCH 019/089] train: loss=0.8540 acc=68.59% | val: loss=0.7576 acc=53.01% f1=66.09% auc=54.36% val_score=51.0693 val_score_bestthr=51.0693 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.150, mb=0.513, no=0.986, corr=-0.437) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 51.0693
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1526 mb_mean=0.5125 norm_overlap=0.9848 corr_cb=-0.4794 topkJ=0.0023
[TRAIN][ep=020] loss=0.8630 acc=67.52%
[TRAIN][ep=020] mask_avg: mc_mean=0.1504 mb_mean=0.5133 norm_overlap=0.9865 corr_cb=-0.4330
[EPOCH 020/089] train: loss=0.8630 acc=67.52% | val: loss=0.7343 acc=49.40% f1=47.50% auc=55.17% val_score=40.6723 val_score_bestthr=40.6723 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.150, mb=0.513, no=0.987, corr=-0.433) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 40.6723
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.1683 mb_mean=0.5107 norm_overlap=0.9840 corr_cb=-0.5027 topkJ=0.0029
[TRAIN][ep=021] loss=0.8524 acc=68.46%
[TRAIN][ep=021] mask_avg: mc_mean=0.1354 mb_mean=0.5133 norm_overlap=0.9855 corr_cb=-0.4318
[EPOCH 021/089] train: loss=0.8524 acc=68.46% | val: loss=0.7248 acc=54.22% f1=60.42% auc=55.12% val_score=43.2362 val_score_bestthr=43.2362 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.135, mb=0.513, no=0.986, corr=-0.432) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 43.2362
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1170 mb_mean=0.5140 norm_overlap=0.9932 corr_cb=-0.2289 topkJ=0.0062
[TRAIN][ep=022] loss=0.8394 acc=69.80%
[TRAIN][ep=022] mask_avg: mc_mean=0.1518 mb_mean=0.5133 norm_overlap=0.9860 corr_cb=-0.4409
[EPOCH 022/089] train: loss=0.8394 acc=69.80% | val: loss=0.7443 acc=56.63% f1=67.27% auc=55.47% val_score=53.0218 val_score_bestthr=53.0218 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.152, mb=0.513, no=0.986, corr=-0.441) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 53.0218
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1767 mb_mean=0.5105 norm_overlap=0.9846 corr_cb=-0.4536 topkJ=0.0032
[TRAIN][ep=023] loss=0.8391 acc=70.34%
[TRAIN][ep=023] mask_avg: mc_mean=0.1553 mb_mean=0.5133 norm_overlap=0.9863 corr_cb=-0.4314
[EPOCH 023/089] train: loss=0.8391 acc=70.34% | val: loss=0.7491 acc=48.19% f1=46.91% auc=54.59% val_score=37.6157 val_score_bestthr=37.6157 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.155, mb=0.513, no=0.986, corr=-0.431) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 37.6157
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1687 mb_mean=0.5126 norm_overlap=0.9864 corr_cb=-0.4353 topkJ=0.0077
[TRAIN][ep=024] loss=0.8290 acc=71.14%
[TRAIN][ep=024] mask_avg: mc_mean=0.1551 mb_mean=0.5133 norm_overlap=0.9862 corr_cb=-0.4303
[EPOCH 024/089] train: loss=0.8290 acc=71.14% | val: loss=0.7461 acc=51.81% f1=61.54% auc=54.59% val_score=44.7263 val_score_bestthr=44.7263 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.155, mb=0.513, no=0.986, corr=-0.430) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 44.7263
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1968 mb_mean=0.5144 norm_overlap=0.9900 corr_cb=-0.4196 topkJ=0.0064
[TRAIN][ep=025] loss=0.8416 acc=69.66%
[TRAIN][ep=025] mask_avg: mc_mean=0.1881 mb_mean=0.5133 norm_overlap=0.9880 corr_cb=-0.4228
[EPOCH 025/089] train: loss=0.8416 acc=69.66% | val: loss=0.7456 acc=51.81% f1=54.55% auc=55.23% val_score=41.1710 val_score_bestthr=41.1710 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.188, mb=0.513, no=0.988, corr=-0.423) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 41.1710
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1577 mb_mean=0.5127 norm_overlap=0.9901 corr_cb=-0.3631 topkJ=0.0079
[TRAIN][ep=026] loss=0.8256 acc=70.87%
[TRAIN][ep=026] mask_avg: mc_mean=0.1733 mb_mean=0.5133 norm_overlap=0.9874 corr_cb=-0.4214
[EPOCH 026/089] train: loss=0.8256 acc=70.87% | val: loss=0.7520 acc=54.22% f1=57.78% auc=55.17% val_score=46.2940 val_score_bestthr=46.2940 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.173, mb=0.513, no=0.987, corr=-0.421) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 46.2940
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1762 mb_mean=0.5153 norm_overlap=0.9930 corr_cb=-0.3087 topkJ=0.0121
[TRAIN][ep=027] loss=0.8134 acc=70.87%
[TRAIN][ep=027] mask_avg: mc_mean=0.1834 mb_mean=0.5133 norm_overlap=0.9877 corr_cb=-0.4188
[EPOCH 027/089] train: loss=0.8134 acc=70.87% | val: loss=0.7542 acc=55.42% f1=63.37% auc=55.76% val_score=45.4267 val_score_bestthr=45.4267 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.183, mb=0.513, no=0.988, corr=-0.419) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 45.4267
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1366 mb_mean=0.5149 norm_overlap=0.9837 corr_cb=-0.4570 topkJ=0.0035
[TRAIN][ep=028] loss=0.8140 acc=71.95%
[TRAIN][ep=028] mask_avg: mc_mean=0.1838 mb_mean=0.5133 norm_overlap=0.9878 corr_cb=-0.4150
[EPOCH 028/089] train: loss=0.8140 acc=71.95% | val: loss=0.7651 acc=55.42% f1=65.42% auc=55.00% val_score=44.1669 val_score_bestthr=44.1669 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.184, mb=0.513, no=0.988, corr=-0.415) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 44.1669
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.1307 mb_mean=0.5150 norm_overlap=0.9886 corr_cb=-0.3438 topkJ=0.0098
[TRAIN][ep=029] loss=0.8001 acc=72.75%
[TRAIN][ep=029] mask_avg: mc_mean=0.1627 mb_mean=0.5133 norm_overlap=0.9868 corr_cb=-0.4146
[EPOCH 029/089] train: loss=0.8001 acc=72.75% | val: loss=0.7698 acc=54.22% f1=56.82% auc=54.30% val_score=36.2301 val_score_bestthr=36.2301 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.163, mb=0.513, no=0.987, corr=-0.415) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 36.2301
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2112 mb_mean=0.5126 norm_overlap=0.9872 corr_cb=-0.4724 topkJ=0.0036
[TRAIN][ep=030] loss=0.8017 acc=71.95%
[TRAIN][ep=030] mask_avg: mc_mean=0.1880 mb_mean=0.5133 norm_overlap=0.9880 corr_cb=-0.4110
[EPOCH 030/089] train: loss=0.8017 acc=71.95% | val: loss=0.7813 acc=54.22% f1=64.15% auc=54.30% val_score=44.7459 val_score_bestthr=44.7459 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.188, mb=0.513, no=0.988, corr=-0.411) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 44.7459
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2593 mb_mean=0.5107 norm_overlap=0.9926 corr_cb=-0.3653 topkJ=0.0094
[TRAIN][ep=031] loss=0.7928 acc=72.75%
[TRAIN][ep=031] mask_avg: mc_mean=0.1918 mb_mean=0.5133 norm_overlap=0.9884 corr_cb=-0.4031
[EPOCH 031/089] train: loss=0.7928 acc=72.75% | val: loss=0.7706 acc=55.42% f1=60.22% auc=54.71% val_score=45.9962 val_score_bestthr=45.9962 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.192, mb=0.513, no=0.988, corr=-0.403) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 45.9962
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1989 mb_mean=0.5139 norm_overlap=0.9889 corr_cb=-0.4439 topkJ=0.0140
[TRAIN][ep=032] loss=0.7793 acc=74.23%
[TRAIN][ep=032] mask_avg: mc_mean=0.2009 mb_mean=0.5133 norm_overlap=0.9887 corr_cb=-0.4024
[EPOCH 032/089] train: loss=0.7793 acc=74.23% | val: loss=0.7849 acc=56.63% f1=59.09% auc=55.00% val_score=37.4730 val_score_bestthr=37.4730 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.201, mb=0.513, no=0.989, corr=-0.402) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 37.4730
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1256 mb_mean=0.5107 norm_overlap=0.9926 corr_cb=-0.2481 topkJ=0.0179
[TRAIN][ep=033] loss=0.7772 acc=73.29%
[TRAIN][ep=033] mask_avg: mc_mean=0.1866 mb_mean=0.5133 norm_overlap=0.9882 corr_cb=-0.3976
[EPOCH 033/089] train: loss=0.7772 acc=73.29% | val: loss=0.8166 acc=48.19% f1=41.10% auc=54.24% val_score=34.0238 val_score_bestthr=34.0238 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.187, mb=0.513, no=0.988, corr=-0.398) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 34.0238
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1504 mb_mean=0.5160 norm_overlap=0.9849 corr_cb=-0.4284 topkJ=0.0023
[TRAIN][ep=034] loss=0.7751 acc=75.03%
[TRAIN][ep=034] mask_avg: mc_mean=0.1738 mb_mean=0.5133 norm_overlap=0.9875 corr_cb=-0.3984
[EPOCH 034/089] train: loss=0.7751 acc=75.03% | val: loss=0.7872 acc=56.63% f1=61.70% auc=54.42% val_score=44.5164 val_score_bestthr=44.5164 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.174, mb=0.513, no=0.988, corr=-0.398) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 44.5164
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2095 mb_mean=0.5138 norm_overlap=0.9890 corr_cb=-0.4457 topkJ=0.0016
[TRAIN][ep=035] loss=0.7646 acc=75.44%
[TRAIN][ep=035] mask_avg: mc_mean=0.1892 mb_mean=0.5133 norm_overlap=0.9882 corr_cb=-0.3932
[EPOCH 035/089] train: loss=0.7646 acc=75.44% | val: loss=0.8003 acc=54.22% f1=55.81% auc=54.71% val_score=36.7204 val_score_bestthr=36.7204 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.189, mb=0.513, no=0.988, corr=-0.393) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 36.7204
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.1523 mb_mean=0.5137 norm_overlap=0.9889 corr_cb=-0.3789 topkJ=0.0023
[TRAIN][ep=036] loss=0.7795 acc=72.75%
[TRAIN][ep=036] mask_avg: mc_mean=0.1764 mb_mean=0.5133 norm_overlap=0.9875 corr_cb=-0.3966
[EPOCH 036/089] train: loss=0.7795 acc=72.75% | val: loss=0.7997 acc=50.60% f1=59.41% auc=53.84% val_score=35.4919 val_score_bestthr=35.4919 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.176, mb=0.513, no=0.987, corr=-0.397) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 35.4919
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1927 mb_mean=0.5159 norm_overlap=0.9869 corr_cb=-0.3900 topkJ=0.0062
[TRAIN][ep=037] loss=0.7536 acc=75.30%
[TRAIN][ep=037] mask_avg: mc_mean=0.2098 mb_mean=0.5133 norm_overlap=0.9889 corr_cb=-0.3931
[EPOCH 037/089] train: loss=0.7536 acc=75.30% | val: loss=0.8226 acc=50.60% f1=60.95% auc=54.48% val_score=42.0611 val_score_bestthr=42.0611 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.210, mb=0.513, no=0.989, corr=-0.393) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 42.0611
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.1779 mb_mean=0.5132 norm_overlap=0.9858 corr_cb=-0.4297 topkJ=0.0055
[TRAIN][ep=038] loss=0.7572 acc=76.24%
[TRAIN][ep=038] mask_avg: mc_mean=0.1823 mb_mean=0.5133 norm_overlap=0.9877 corr_cb=-0.3927
[EPOCH 038/089] train: loss=0.7572 acc=76.24% | val: loss=0.8153 acc=55.42% f1=57.47% auc=54.36% val_score=47.4200 val_score_bestthr=47.4200 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.182, mb=0.513, no=0.988, corr=-0.393) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 47.4200
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.1761 mb_mean=0.5157 norm_overlap=0.9853 corr_cb=-0.4692 topkJ=0.0059
[TRAIN][ep=039] loss=0.7558 acc=76.24%
[TRAIN][ep=039] mask_avg: mc_mean=0.1879 mb_mean=0.5133 norm_overlap=0.9880 corr_cb=-0.3909
[EPOCH 039/089] train: loss=0.7558 acc=76.24% | val: loss=0.8375 acc=54.22% f1=51.28% auc=54.77% val_score=38.5011 val_score_bestthr=38.5011 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.188, mb=0.513, no=0.988, corr=-0.391) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 38.5011
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.1769 mb_mean=0.5137 norm_overlap=0.9882 corr_cb=-0.3955 topkJ=0.0078
[TRAIN][ep=040] loss=0.7385 acc=76.24%
[TRAIN][ep=040] mask_avg: mc_mean=0.2015 mb_mean=0.5133 norm_overlap=0.9887 corr_cb=-0.3860
[EPOCH 040/089] train: loss=0.7385 acc=76.24% | val: loss=0.8204 acc=55.42% f1=58.43% auc=54.88% val_score=46.0570 val_score_bestthr=46.0570 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.202, mb=0.513, no=0.989, corr=-0.386) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 46.0570
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.1818 mb_mean=0.5141 norm_overlap=0.9918 corr_cb=-0.2817 topkJ=0.0147
[TRAIN][ep=041] loss=0.7348 acc=77.58%
[TRAIN][ep=041] mask_avg: mc_mean=0.1854 mb_mean=0.5133 norm_overlap=0.9877 corr_cb=-0.3873
[EPOCH 041/089] train: loss=0.7348 acc=77.58% | val: loss=0.8355 acc=55.42% f1=58.43% auc=54.48% val_score=46.0570 val_score_bestthr=46.0570 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.185, mb=0.513, no=0.988, corr=-0.387) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 46.0570
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.1783 mb_mean=0.5130 norm_overlap=0.9876 corr_cb=-0.3627 topkJ=0.0084
[TRAIN][ep=042] loss=0.7230 acc=76.91%
[TRAIN][ep=042] mask_avg: mc_mean=0.1955 mb_mean=0.5133 norm_overlap=0.9882 corr_cb=-0.3861
[EPOCH 042/089] train: loss=0.7230 acc=76.91% | val: loss=0.8497 acc=55.42% f1=58.43% auc=55.00% val_score=46.0570 val_score_bestthr=46.0570 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.196, mb=0.513, no=0.988, corr=-0.386) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3588 -> 46.0570
[EARLY STOP] no improvement for 30 epochs. best_epoch=12
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold4_rep0_seed4/ckpt_best_fold_4.pt
=============== FIT DONE ===============
[BEST] epoch=12 | val_acc=56.63% | val_f1=69.49% | val_auc=57.33% | val_score=62.3588 | val_score_bestthr=62.3588
[TEST@BEST] thr_used=0.450 | acc=53.14% f1=67.34% auc=67.85% | SP_sex=8.70% EO_sex=6.59% SP_age=13.36% EO_age=10.00%
[TIME] 1.01 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold4_rep0_seed4/summary_fold_4.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4593 mb_mean=0.5110 norm_overlap=1.0000 corr_cb=0.0210 topkJ=0.1340
[TRAIN][ep=000] loss=0.6955 acc=50.87%
[TRAIN][ep=000] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0304
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4604 mb_mean=0.5129 norm_overlap=1.0000 corr_cb=-0.0341 topkJ=0.0385
[TRAIN][ep=001] loss=0.6935 acc=51.54%
[TRAIN][ep=001] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0340
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4621 mb_mean=0.5138 norm_overlap=0.9999 corr_cb=-0.2061 topkJ=0.0705
[TRAIN][ep=002] loss=0.6917 acc=53.02%
[TRAIN][ep=002] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0391
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4656 mb_mean=0.5133 norm_overlap=0.9999 corr_cb=-0.1525 topkJ=0.0702
[TRAIN][ep=003] loss=0.6899 acc=55.17%
[TRAIN][ep=003] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0291
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4607 mb_mean=0.5127 norm_overlap=1.0000 corr_cb=-0.0560 topkJ=0.0532
[TRAIN][ep=004] loss=0.6878 acc=54.36%
[TRAIN][ep=004] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0333
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4627 mb_mean=0.5146 norm_overlap=1.0000 corr_cb=0.0401 topkJ=0.1020
[TRAIN][ep=005] loss=0.6867 acc=57.05%
[TRAIN][ep=005] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0327
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4643 mb_mean=0.5121 norm_overlap=0.9999 corr_cb=-0.1954 topkJ=0.0265
[TRAIN][ep=006] loss=0.6821 acc=57.99%
[TRAIN][ep=006] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0382
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4600 mb_mean=0.5162 norm_overlap=1.0000 corr_cb=-0.0688 topkJ=0.0382
[TRAIN][ep=007] loss=0.6832 acc=56.91%
[TRAIN][ep=007] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0316
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4601 mb_mean=0.5162 norm_overlap=0.9998 corr_cb=-0.3232 topkJ=0.0124
[TRAIN][ep=008] loss=0.6789 acc=58.66%
[TRAIN][ep=008] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0367
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4657 mb_mean=0.5110 norm_overlap=1.0001 corr_cb=0.2304 topkJ=0.1165
[TRAIN][ep=009] loss=0.6761 acc=57.45%
[TRAIN][ep=009] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0276
================= FIT START (fold=4) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4625 mb_mean=0.5166 norm_overlap=0.9999 corr_cb=-0.1231 topkJ=0.0325
[TRAIN][ep=000] loss=0.6713 acc=62.15%
[TRAIN][ep=000] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0298
[EPOCH 000/089] train: loss=0.6713 acc=62.15% | val: loss=0.6780 acc=59.04% f1=69.64% auc=60.12% val_score=45.6694 val_score_bestthr=63.2736 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.030) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 63.2736
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep0_seed4/ckpt_best_fold_4.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4617 mb_mean=0.5124 norm_overlap=1.0000 corr_cb=0.0896 topkJ=0.0788
[TRAIN][ep=001] loss=0.6635 acc=62.15%
[TRAIN][ep=001] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0301
[EPOCH 001/089] train: loss=0.6635 acc=62.15% | val: loss=0.6770 acc=56.63% f1=69.49% auc=61.34% val_score=51.7735 val_score_bestthr=60.9699 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.030) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 60.9699
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4651 mb_mean=0.5120 norm_overlap=1.0000 corr_cb=0.0785 topkJ=0.0875
[TRAIN][ep=002] loss=0.6581 acc=61.07%
[TRAIN][ep=002] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0344
[EPOCH 002/089] train: loss=0.6581 acc=61.07% | val: loss=0.6815 acc=56.63% f1=68.42% auc=59.07% val_score=45.3596 val_score_bestthr=59.6238 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.034) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.6238
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4604 mb_mean=0.5131 norm_overlap=1.0000 corr_cb=0.0074 topkJ=0.0496
[TRAIN][ep=003] loss=0.6514 acc=62.55%
[TRAIN][ep=003] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0360
[EPOCH 003/089] train: loss=0.6514 acc=62.55% | val: loss=0.6898 acc=54.22% f1=68.85% auc=58.49% val_score=40.9798 val_score_bestthr=57.8426 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.036) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 57.8426
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4599 mb_mean=0.5131 norm_overlap=0.9998 corr_cb=-0.3378 topkJ=0.0131
[TRAIN][ep=004] loss=0.6449 acc=62.95%
[TRAIN][ep=004] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0322
[EPOCH 004/089] train: loss=0.6449 acc=62.95% | val: loss=0.6806 acc=56.63% f1=67.86% auc=58.95% val_score=42.0950 val_score_bestthr=58.9924 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.032) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.9924
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4645 mb_mean=0.5123 norm_overlap=1.0000 corr_cb=0.1004 topkJ=0.0686
[TRAIN][ep=005] loss=1.3619 acc=61.07%
[TRAIN][ep=005] mask_avg: mc_mean=0.3506 mb_mean=0.5133 norm_overlap=0.9987 corr_cb=-0.3457
[EPOCH 005/089] train: loss=1.3619 acc=61.07% | val: loss=0.6890 acc=53.01% f1=68.29% auc=58.60% val_score=52.2337 val_score_bestthr=56.7094 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.351, mb=0.513, no=0.999, corr=-0.346) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 56.7094
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2919 mb_mean=0.5091 norm_overlap=0.9982 corr_cb=-0.2963 topkJ=0.0212
[TRAIN][ep=006] loss=1.1355 acc=65.50%
[TRAIN][ep=006] mask_avg: mc_mean=0.2245 mb_mean=0.5133 norm_overlap=0.9966 corr_cb=-0.4095
[EPOCH 006/089] train: loss=1.1355 acc=65.50% | val: loss=0.6769 acc=57.83% f1=69.57% auc=57.85% val_score=47.1417 val_score_bestthr=61.1138 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.225, mb=0.513, no=0.997, corr=-0.410) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 61.1138
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2010 mb_mean=0.5122 norm_overlap=0.9966 corr_cb=-0.3733 topkJ=0.0253
[TRAIN][ep=007] loss=0.9397 acc=64.03%
[TRAIN][ep=007] mask_avg: mc_mean=0.1851 mb_mean=0.5133 norm_overlap=0.9952 corr_cb=-0.4284
[EPOCH 007/089] train: loss=0.9397 acc=64.03% | val: loss=0.7084 acc=57.83% f1=69.57% auc=56.40% val_score=40.6038 val_score_bestthr=59.7138 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.185, mb=0.513, no=0.995, corr=-0.428) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.7138
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1174 mb_mean=0.5155 norm_overlap=0.9962 corr_cb=-0.2356 topkJ=0.0276
[TRAIN][ep=008] loss=0.8951 acc=65.64%
[TRAIN][ep=008] mask_avg: mc_mean=0.1486 mb_mean=0.5133 norm_overlap=0.9930 corr_cb=-0.4378
[EPOCH 008/089] train: loss=0.8951 acc=65.64% | val: loss=0.7057 acc=56.63% f1=68.97% auc=58.02% val_score=54.1330 val_score_bestthr=59.1465 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.149, mb=0.513, no=0.993, corr=-0.438) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.1465
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1688 mb_mean=0.5094 norm_overlap=0.9944 corr_cb=-0.3817 topkJ=0.0171
[TRAIN][ep=009] loss=0.9063 acc=64.56%
[TRAIN][ep=009] mask_avg: mc_mean=0.1384 mb_mean=0.5133 norm_overlap=0.9917 corr_cb=-0.4627
[EPOCH 009/089] train: loss=0.9063 acc=64.56% | val: loss=0.6925 acc=59.04% f1=70.18% auc=57.62% val_score=41.7827 val_score_bestthr=60.8317 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.138, mb=0.513, no=0.992, corr=-0.463) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 60.8317
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1370 mb_mean=0.5127 norm_overlap=0.9912 corr_cb=-0.5016 topkJ=0.0080
[TRAIN][ep=010] loss=0.8967 acc=66.17%
[TRAIN][ep=010] mask_avg: mc_mean=0.1232 mb_mean=0.5133 norm_overlap=0.9898 corr_cb=-0.4734
[EPOCH 010/089] train: loss=0.8967 acc=66.17% | val: loss=0.6874 acc=57.83% f1=69.57% auc=58.14% val_score=43.1744 val_score_bestthr=59.7138 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.123, mb=0.513, no=0.990, corr=-0.473) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.7138
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1037 mb_mean=0.5141 norm_overlap=0.9892 corr_cb=-0.4821 topkJ=0.0008
[TRAIN][ep=011] loss=0.8819 acc=68.59%
[TRAIN][ep=011] mask_avg: mc_mean=0.1293 mb_mean=0.5133 norm_overlap=0.9890 corr_cb=-0.4974
[EPOCH 011/089] train: loss=0.8819 acc=68.59% | val: loss=0.7041 acc=59.04% f1=70.18% auc=56.16% val_score=39.8392 val_score_bestthr=60.8317 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.129, mb=0.513, no=0.989, corr=-0.497) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 60.8317
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1781 mb_mean=0.5122 norm_overlap=0.9873 corr_cb=-0.6172 topkJ=0.0016
[TRAIN][ep=012] loss=0.8814 acc=66.71%
[TRAIN][ep=012] mask_avg: mc_mean=0.1281 mb_mean=0.5133 norm_overlap=0.9881 corr_cb=-0.4890
[EPOCH 012/089] train: loss=0.8814 acc=66.71% | val: loss=0.7085 acc=55.42% f1=68.91% auc=57.79% val_score=53.3354 val_score_bestthr=59.9272 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.128, mb=0.513, no=0.988, corr=-0.489) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.9272
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1468 mb_mean=0.5120 norm_overlap=0.9881 corr_cb=-0.5126 topkJ=0.0016
[TRAIN][ep=013] loss=0.8751 acc=67.79%
[TRAIN][ep=013] mask_avg: mc_mean=0.1368 mb_mean=0.5133 norm_overlap=0.9879 corr_cb=-0.5095
[EPOCH 013/089] train: loss=0.8751 acc=67.79% | val: loss=0.6977 acc=57.83% f1=69.57% auc=57.38% val_score=43.6134 val_score_bestthr=59.7138 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.137, mb=0.513, no=0.988, corr=-0.509) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.7138
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1938 mb_mean=0.5110 norm_overlap=0.9803 corr_cb=-0.6706 topkJ=0.0000
[TRAIN][ep=014] loss=0.8547 acc=68.32%
[TRAIN][ep=014] mask_avg: mc_mean=0.1380 mb_mean=0.5133 norm_overlap=0.9871 corr_cb=-0.5019
[EPOCH 014/089] train: loss=0.8547 acc=68.32% | val: loss=0.7359 acc=56.63% f1=68.97% auc=56.74% val_score=35.2960 val_score_bestthr=58.2131 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.138, mb=0.513, no=0.987, corr=-0.502) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.2131
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.0609 mb_mean=0.5172 norm_overlap=0.9822 corr_cb=-0.4732 topkJ=0.0004
[TRAIN][ep=015] loss=0.8550 acc=68.86%
[TRAIN][ep=015] mask_avg: mc_mean=0.1287 mb_mean=0.5133 norm_overlap=0.9861 corr_cb=-0.4897
[EPOCH 015/089] train: loss=0.8550 acc=68.86% | val: loss=0.7106 acc=56.63% f1=68.97% auc=56.98% val_score=42.7306 val_score_bestthr=58.2131 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.129, mb=0.513, no=0.986, corr=-0.490) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.2131
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1354 mb_mean=0.5145 norm_overlap=0.9817 corr_cb=-0.5645 topkJ=0.0012
[TRAIN][ep=016] loss=0.8564 acc=68.19%
[TRAIN][ep=016] mask_avg: mc_mean=0.1453 mb_mean=0.5133 norm_overlap=0.9864 corr_cb=-0.4982
[EPOCH 016/089] train: loss=0.8564 acc=68.19% | val: loss=0.7356 acc=59.04% f1=69.09% auc=57.21% val_score=54.3604 val_score_bestthr=55.6753 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.145, mb=0.513, no=0.986, corr=-0.498) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 55.6753
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1658 mb_mean=0.5136 norm_overlap=0.9853 corr_cb=-0.5535 topkJ=0.0004
[TRAIN][ep=017] loss=0.8385 acc=70.34%
[TRAIN][ep=017] mask_avg: mc_mean=0.1672 mb_mean=0.5133 norm_overlap=0.9875 corr_cb=-0.5090
[EPOCH 017/089] train: loss=0.8385 acc=70.34% | val: loss=0.7340 acc=56.63% f1=68.97% auc=56.80% val_score=35.0726 val_score_bestthr=58.2131 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.167, mb=0.513, no=0.987, corr=-0.509) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.2131
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1167 mb_mean=0.5148 norm_overlap=0.9863 corr_cb=-0.4521 topkJ=0.0017
[TRAIN][ep=018] loss=0.8233 acc=72.89%
[TRAIN][ep=018] mask_avg: mc_mean=0.1595 mb_mean=0.5133 norm_overlap=0.9866 corr_cb=-0.5082
[EPOCH 018/089] train: loss=0.8233 acc=72.89% | val: loss=0.7385 acc=55.42% f1=68.38% auc=55.99% val_score=34.7708 val_score_bestthr=57.3807 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.159, mb=0.513, no=0.987, corr=-0.508) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 57.3807
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1356 mb_mean=0.5144 norm_overlap=0.9875 corr_cb=-0.4998 topkJ=0.0056
[TRAIN][ep=019] loss=0.8157 acc=71.41%
[TRAIN][ep=019] mask_avg: mc_mean=0.1503 mb_mean=0.5133 norm_overlap=0.9861 corr_cb=-0.4930
[EPOCH 019/089] train: loss=0.8157 acc=71.41% | val: loss=0.7888 acc=55.42% f1=67.83% auc=56.74% val_score=49.1298 val_score_bestthr=57.1506 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.150, mb=0.513, no=0.986, corr=-0.493) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 57.1506
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1634 mb_mean=0.5125 norm_overlap=0.9850 corr_cb=-0.5391 topkJ=0.0012
[TRAIN][ep=020] loss=0.8199 acc=71.28%
[TRAIN][ep=020] mask_avg: mc_mean=0.1701 mb_mean=0.5133 norm_overlap=0.9870 corr_cb=-0.4964
[EPOCH 020/089] train: loss=0.8199 acc=71.28% | val: loss=0.7641 acc=56.63% f1=69.49% auc=56.80% val_score=33.3600 val_score_bestthr=59.8699 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.170, mb=0.513, no=0.987, corr=-0.496) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.8699
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.1925 mb_mean=0.5107 norm_overlap=0.9842 corr_cb=-0.5763 topkJ=0.0016
[TRAIN][ep=021] loss=0.8145 acc=71.95%
[TRAIN][ep=021] mask_avg: mc_mean=0.1596 mb_mean=0.5133 norm_overlap=0.9861 corr_cb=-0.5122
[EPOCH 021/089] train: loss=0.8145 acc=71.95% | val: loss=0.7382 acc=55.42% f1=68.91% auc=57.09% val_score=43.0320 val_score_bestthr=59.9272 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.160, mb=0.513, no=0.986, corr=-0.512) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.9272
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1501 mb_mean=0.5140 norm_overlap=0.9936 corr_cb=-0.3199 topkJ=0.0039
[TRAIN][ep=022] loss=0.7970 acc=73.83%
[TRAIN][ep=022] mask_avg: mc_mean=0.1639 mb_mean=0.5133 norm_overlap=0.9858 corr_cb=-0.5275
[EPOCH 022/089] train: loss=0.7970 acc=73.83% | val: loss=0.7672 acc=54.22% f1=69.35% auc=57.85% val_score=43.6067 val_score_bestthr=62.5593 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.164, mb=0.513, no=0.986, corr=-0.528) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 62.5593
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1982 mb_mean=0.5105 norm_overlap=0.9846 corr_cb=-0.5357 topkJ=0.0020
[TRAIN][ep=023] loss=0.7961 acc=72.75%
[TRAIN][ep=023] mask_avg: mc_mean=0.1665 mb_mean=0.5133 norm_overlap=0.9859 corr_cb=-0.5180
[EPOCH 023/089] train: loss=0.7961 acc=72.75% | val: loss=0.7531 acc=56.63% f1=69.49% auc=56.74% val_score=38.5240 val_score_bestthr=59.8699 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.167, mb=0.513, no=0.986, corr=-0.518) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.8699
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1938 mb_mean=0.5126 norm_overlap=0.9866 corr_cb=-0.5169 topkJ=0.0028
[TRAIN][ep=024] loss=0.7785 acc=74.23%
[TRAIN][ep=024] mask_avg: mc_mean=0.1748 mb_mean=0.5133 norm_overlap=0.9862 corr_cb=-0.5208
[EPOCH 024/089] train: loss=0.7785 acc=74.23% | val: loss=0.7605 acc=54.22% f1=68.33% auc=57.27% val_score=46.5430 val_score_bestthr=58.3637 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.175, mb=0.513, no=0.986, corr=-0.521) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.3637
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2097 mb_mean=0.5144 norm_overlap=0.9899 corr_cb=-0.5012 topkJ=0.0040
[TRAIN][ep=025] loss=0.7924 acc=73.15%
[TRAIN][ep=025] mask_avg: mc_mean=0.2105 mb_mean=0.5133 norm_overlap=0.9880 corr_cb=-0.5176
[EPOCH 025/089] train: loss=0.7924 acc=73.15% | val: loss=0.7580 acc=55.42% f1=68.91% auc=57.91% val_score=37.1286 val_score_bestthr=58.3049 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.210, mb=0.513, no=0.988, corr=-0.518) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.3049
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1993 mb_mean=0.5127 norm_overlap=0.9909 corr_cb=-0.4635 topkJ=0.0040
[TRAIN][ep=026] loss=0.7702 acc=73.56%
[TRAIN][ep=026] mask_avg: mc_mean=0.1889 mb_mean=0.5133 norm_overlap=0.9871 corr_cb=-0.5131
[EPOCH 026/089] train: loss=0.7702 acc=73.56% | val: loss=0.7927 acc=55.42% f1=68.38% auc=57.33% val_score=39.4685 val_score_bestthr=57.3807 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.189, mb=0.513, no=0.987, corr=-0.513) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 57.3807
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2175 mb_mean=0.5153 norm_overlap=0.9937 corr_cb=-0.3747 topkJ=0.0157
[TRAIN][ep=027] loss=0.7593 acc=75.03%
[TRAIN][ep=027] mask_avg: mc_mean=0.1979 mb_mean=0.5133 norm_overlap=0.9873 corr_cb=-0.5068
[EPOCH 027/089] train: loss=0.7593 acc=75.03% | val: loss=0.7743 acc=54.22% f1=69.35% auc=57.38% val_score=40.7655 val_score_bestthr=62.5593 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.198, mb=0.513, no=0.987, corr=-0.507) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 62.5593
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1621 mb_mean=0.5149 norm_overlap=0.9854 corr_cb=-0.5224 topkJ=0.0050
[TRAIN][ep=028] loss=0.7563 acc=74.36%
[TRAIN][ep=028] mask_avg: mc_mean=0.2014 mb_mean=0.5133 norm_overlap=0.9875 corr_cb=-0.5116
[EPOCH 028/089] train: loss=0.7563 acc=74.36% | val: loss=0.7860 acc=54.22% f1=69.35% auc=57.27% val_score=42.3677 val_score_bestthr=62.5593 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.201, mb=0.513, no=0.988, corr=-0.512) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 62.5593
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.1492 mb_mean=0.5150 norm_overlap=0.9891 corr_cb=-0.4248 topkJ=0.0055
[TRAIN][ep=029] loss=0.7460 acc=75.03%
[TRAIN][ep=029] mask_avg: mc_mean=0.1873 mb_mean=0.5133 norm_overlap=0.9868 corr_cb=-0.5098
[EPOCH 029/089] train: loss=0.7460 acc=75.03% | val: loss=0.7901 acc=56.63% f1=68.97% auc=56.74% val_score=44.0252 val_score_bestthr=58.8798 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.187, mb=0.513, no=0.987, corr=-0.510) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.8798
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2426 mb_mean=0.5126 norm_overlap=0.9882 corr_cb=-0.5539 topkJ=0.0040
[TRAIN][ep=030] loss=0.7441 acc=76.11%
[TRAIN][ep=030] mask_avg: mc_mean=0.1947 mb_mean=0.5133 norm_overlap=0.9871 corr_cb=-0.5094
[EPOCH 030/089] train: loss=0.7441 acc=76.11% | val: loss=0.7950 acc=55.42% f1=68.38% auc=56.80% val_score=47.8897 val_score_bestthr=57.3807 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.195, mb=0.513, no=0.987, corr=-0.509) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 57.3807
[EARLY STOP] no improvement for 30 epochs. best_epoch=0
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold4_rep0_seed4/ckpt_best_fold_4.pt
=============== FIT DONE ===============
[BEST] epoch=0 | val_acc=59.04% | val_f1=69.64% | val_auc=60.12% | val_score=45.6694 | val_score_bestthr=63.2736
[TEST@BEST] thr_used=0.480 | acc=62.32% f1=68.03% auc=65.41% | SP_sex=17.93% EO_sex=17.51% SP_age=15.31% EO_age=14.38%
[TIME] 0.76 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold4_rep0_seed4/summary_fold_4.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4593 mb_mean=0.5110 norm_overlap=1.0000 corr_cb=0.0210 topkJ=0.1340
[TRAIN][ep=000] loss=0.6955 acc=50.87%
[TRAIN][ep=000] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0304
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4604 mb_mean=0.5129 norm_overlap=1.0000 corr_cb=-0.0341 topkJ=0.0385
[TRAIN][ep=001] loss=0.6935 acc=51.54%
[TRAIN][ep=001] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0340
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4621 mb_mean=0.5138 norm_overlap=0.9999 corr_cb=-0.2061 topkJ=0.0705
[TRAIN][ep=002] loss=0.6917 acc=53.02%
[TRAIN][ep=002] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0391
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4656 mb_mean=0.5133 norm_overlap=0.9999 corr_cb=-0.1525 topkJ=0.0702
[TRAIN][ep=003] loss=0.6899 acc=55.17%
[TRAIN][ep=003] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0291
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4607 mb_mean=0.5127 norm_overlap=1.0000 corr_cb=-0.0560 topkJ=0.0532
[TRAIN][ep=004] loss=0.6878 acc=54.36%
[TRAIN][ep=004] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0333
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4627 mb_mean=0.5146 norm_overlap=1.0000 corr_cb=0.0401 topkJ=0.1020
[TRAIN][ep=005] loss=0.6867 acc=57.05%
[TRAIN][ep=005] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0327
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4643 mb_mean=0.5121 norm_overlap=0.9999 corr_cb=-0.1954 topkJ=0.0265
[TRAIN][ep=006] loss=0.6821 acc=57.85%
[TRAIN][ep=006] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0382
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4600 mb_mean=0.5162 norm_overlap=1.0000 corr_cb=-0.0688 topkJ=0.0382
[TRAIN][ep=007] loss=0.6832 acc=56.91%
[TRAIN][ep=007] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0316
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4601 mb_mean=0.5162 norm_overlap=0.9998 corr_cb=-0.3232 topkJ=0.0124
[TRAIN][ep=008] loss=0.6789 acc=58.66%
[TRAIN][ep=008] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0367
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4657 mb_mean=0.5110 norm_overlap=1.0001 corr_cb=0.2304 topkJ=0.1165
[TRAIN][ep=009] loss=0.6761 acc=57.45%
[TRAIN][ep=009] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0276
================= FIT START (fold=4) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4625 mb_mean=0.5166 norm_overlap=0.9999 corr_cb=-0.1231 topkJ=0.0325
[TRAIN][ep=000] loss=0.6713 acc=62.15%
[TRAIN][ep=000] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0298
[EPOCH 000/089] train: loss=0.6713 acc=62.15% | val: loss=0.6780 acc=59.04% f1=69.64% auc=60.12% val_score=45.6694 val_score_bestthr=63.2736 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.030) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 63.2736
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep0_seed4/ckpt_best_fold_4.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4617 mb_mean=0.5124 norm_overlap=1.0000 corr_cb=0.0896 topkJ=0.0788
[TRAIN][ep=001] loss=0.6635 acc=62.28%
[TRAIN][ep=001] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0301
[EPOCH 001/089] train: loss=0.6635 acc=62.28% | val: loss=0.6770 acc=56.63% f1=69.49% auc=61.34% val_score=51.7735 val_score_bestthr=60.9699 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.030) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 60.9699
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4651 mb_mean=0.5120 norm_overlap=1.0000 corr_cb=0.0785 topkJ=0.0875
[TRAIN][ep=002] loss=0.6581 acc=61.07%
[TRAIN][ep=002] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0344
[EPOCH 002/089] train: loss=0.6581 acc=61.07% | val: loss=0.6815 acc=56.63% f1=64.71% auc=59.07% val_score=45.3596 val_score_bestthr=58.7293 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.034) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.7293
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4604 mb_mean=0.5131 norm_overlap=1.0000 corr_cb=0.0074 topkJ=0.0496
[TRAIN][ep=003] loss=0.6514 acc=62.55%
[TRAIN][ep=003] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0360
[EPOCH 003/089] train: loss=0.6514 acc=62.55% | val: loss=0.6898 acc=54.22% f1=68.85% auc=58.49% val_score=40.9798 val_score_bestthr=57.8426 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.036) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 57.8426
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4599 mb_mean=0.5131 norm_overlap=0.9998 corr_cb=-0.3378 topkJ=0.0131
[TRAIN][ep=004] loss=0.6448 acc=62.82%
[TRAIN][ep=004] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0322
[EPOCH 004/089] train: loss=0.6448 acc=62.82% | val: loss=0.6806 acc=57.83% f1=69.03% auc=58.84% val_score=42.0950 val_score_bestthr=60.7136 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.032) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 60.7136
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4645 mb_mean=0.5123 norm_overlap=1.0000 corr_cb=0.1004 topkJ=0.0686
[TRAIN][ep=005] loss=1.5411 acc=61.07%
[TRAIN][ep=005] mask_avg: mc_mean=0.3544 mb_mean=0.5133 norm_overlap=0.9988 corr_cb=-0.3449
[EPOCH 005/089] train: loss=1.5411 acc=61.07% | val: loss=0.6874 acc=53.01% f1=68.29% auc=58.37% val_score=47.7064 val_score_bestthr=56.7094 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.354, mb=0.513, no=0.999, corr=-0.345) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 56.7094
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2951 mb_mean=0.5091 norm_overlap=0.9982 corr_cb=-0.2955 topkJ=0.0208
[TRAIN][ep=006] loss=1.2408 acc=64.83%
[TRAIN][ep=006] mask_avg: mc_mean=0.2265 mb_mean=0.5133 norm_overlap=0.9966 corr_cb=-0.4084
[EPOCH 006/089] train: loss=1.2408 acc=64.83% | val: loss=0.6771 acc=57.83% f1=69.57% auc=57.97% val_score=43.2957 val_score_bestthr=61.1138 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.227, mb=0.513, no=0.997, corr=-0.408) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 61.1138
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2027 mb_mean=0.5122 norm_overlap=0.9967 corr_cb=-0.3710 topkJ=0.0253
[TRAIN][ep=007] loss=0.9753 acc=63.89%
[TRAIN][ep=007] mask_avg: mc_mean=0.1858 mb_mean=0.5133 norm_overlap=0.9952 corr_cb=-0.4270
[EPOCH 007/089] train: loss=0.9753 acc=63.89% | val: loss=0.7080 acc=57.83% f1=69.57% auc=56.34% val_score=40.6038 val_score_bestthr=59.7138 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.186, mb=0.513, no=0.995, corr=-0.427) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.7138
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1172 mb_mean=0.5155 norm_overlap=0.9963 corr_cb=-0.2344 topkJ=0.0280
[TRAIN][ep=008] loss=0.8954 acc=65.64%
[TRAIN][ep=008] mask_avg: mc_mean=0.1483 mb_mean=0.5133 norm_overlap=0.9930 corr_cb=-0.4369
[EPOCH 008/089] train: loss=0.8954 acc=65.64% | val: loss=0.7052 acc=56.63% f1=69.49% auc=57.91% val_score=54.1330 val_score_bestthr=62.3588 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.148, mb=0.513, no=0.993, corr=-0.437) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 62.3588
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1690 mb_mean=0.5094 norm_overlap=0.9944 corr_cb=-0.3809 topkJ=0.0171
[TRAIN][ep=009] loss=0.9067 acc=64.43%
[TRAIN][ep=009] mask_avg: mc_mean=0.1383 mb_mean=0.5133 norm_overlap=0.9917 corr_cb=-0.4614
[EPOCH 009/089] train: loss=0.9067 acc=64.43% | val: loss=0.6926 acc=59.04% f1=70.18% auc=57.85% val_score=41.7827 val_score_bestthr=60.8317 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.138, mb=0.513, no=0.992, corr=-0.461) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 60.8317
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1363 mb_mean=0.5127 norm_overlap=0.9912 corr_cb=-0.5000 topkJ=0.0080
[TRAIN][ep=010] loss=0.8971 acc=66.17%
[TRAIN][ep=010] mask_avg: mc_mean=0.1221 mb_mean=0.5133 norm_overlap=0.9898 corr_cb=-0.4715
[EPOCH 010/089] train: loss=0.8971 acc=66.17% | val: loss=0.6876 acc=57.83% f1=69.57% auc=58.08% val_score=43.1744 val_score_bestthr=59.7138 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.122, mb=0.513, no=0.990, corr=-0.471) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.7138
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1036 mb_mean=0.5141 norm_overlap=0.9892 corr_cb=-0.4813 topkJ=0.0008
[TRAIN][ep=011] loss=0.8822 acc=68.59%
[TRAIN][ep=011] mask_avg: mc_mean=0.1284 mb_mean=0.5133 norm_overlap=0.9890 corr_cb=-0.4954
[EPOCH 011/089] train: loss=0.8822 acc=68.59% | val: loss=0.7042 acc=59.04% f1=70.18% auc=56.10% val_score=39.8392 val_score_bestthr=60.8317 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.128, mb=0.513, no=0.989, corr=-0.495) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 60.8317
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1764 mb_mean=0.5122 norm_overlap=0.9872 corr_cb=-0.6145 topkJ=0.0016
[TRAIN][ep=012] loss=0.8818 acc=66.71%
[TRAIN][ep=012] mask_avg: mc_mean=0.1268 mb_mean=0.5133 norm_overlap=0.9880 corr_cb=-0.4865
[EPOCH 012/089] train: loss=0.8818 acc=66.71% | val: loss=0.7085 acc=55.42% f1=68.91% auc=57.56% val_score=53.3354 val_score_bestthr=59.9272 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.127, mb=0.513, no=0.988, corr=-0.487) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.9272
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1458 mb_mean=0.5120 norm_overlap=0.9880 corr_cb=-0.5107 topkJ=0.0016
[TRAIN][ep=013] loss=0.8755 acc=67.38%
[TRAIN][ep=013] mask_avg: mc_mean=0.1354 mb_mean=0.5133 norm_overlap=0.9879 corr_cb=-0.5071
[EPOCH 013/089] train: loss=0.8755 acc=67.38% | val: loss=0.6979 acc=57.83% f1=69.57% auc=57.33% val_score=43.6134 val_score_bestthr=59.7138 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.135, mb=0.513, no=0.988, corr=-0.507) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.7138
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1929 mb_mean=0.5110 norm_overlap=0.9802 corr_cb=-0.6691 topkJ=0.0000
[TRAIN][ep=014] loss=0.8551 acc=68.19%
[TRAIN][ep=014] mask_avg: mc_mean=0.1372 mb_mean=0.5133 norm_overlap=0.9870 corr_cb=-0.4999
[EPOCH 014/089] train: loss=0.8551 acc=68.19% | val: loss=0.7361 acc=56.63% f1=68.97% auc=56.69% val_score=35.2960 val_score_bestthr=58.2131 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.137, mb=0.513, no=0.987, corr=-0.500) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.2131
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.0611 mb_mean=0.5172 norm_overlap=0.9822 corr_cb=-0.4721 topkJ=0.0004
[TRAIN][ep=015] loss=0.8554 acc=69.13%
[TRAIN][ep=015] mask_avg: mc_mean=0.1285 mb_mean=0.5133 norm_overlap=0.9861 corr_cb=-0.4879
[EPOCH 015/089] train: loss=0.8554 acc=69.13% | val: loss=0.7106 acc=56.63% f1=68.97% auc=56.98% val_score=42.7306 val_score_bestthr=58.2131 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.128, mb=0.513, no=0.986, corr=-0.488) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.2131
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1343 mb_mean=0.5145 norm_overlap=0.9816 corr_cb=-0.5625 topkJ=0.0012
[TRAIN][ep=016] loss=0.8569 acc=68.05%
[TRAIN][ep=016] mask_avg: mc_mean=0.1436 mb_mean=0.5133 norm_overlap=0.9863 corr_cb=-0.4958
[EPOCH 016/089] train: loss=0.8569 acc=68.05% | val: loss=0.7356 acc=59.04% f1=69.09% auc=57.27% val_score=54.3604 val_score_bestthr=55.6753 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.144, mb=0.513, no=0.986, corr=-0.496) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 55.6753
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1626 mb_mean=0.5136 norm_overlap=0.9851 corr_cb=-0.5517 topkJ=0.0008
[TRAIN][ep=017] loss=0.8390 acc=70.20%
[TRAIN][ep=017] mask_avg: mc_mean=0.1659 mb_mean=0.5133 norm_overlap=0.9874 corr_cb=-0.5066
[EPOCH 017/089] train: loss=0.8390 acc=70.20% | val: loss=0.7341 acc=56.63% f1=68.97% auc=56.80% val_score=35.0726 val_score_bestthr=58.2131 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.166, mb=0.513, no=0.987, corr=-0.507) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.2131
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1161 mb_mean=0.5148 norm_overlap=0.9863 corr_cb=-0.4499 topkJ=0.0017
[TRAIN][ep=018] loss=0.8239 acc=72.75%
[TRAIN][ep=018] mask_avg: mc_mean=0.1583 mb_mean=0.5133 norm_overlap=0.9865 corr_cb=-0.5053
[EPOCH 018/089] train: loss=0.8239 acc=72.75% | val: loss=0.7389 acc=55.42% f1=68.38% auc=55.87% val_score=34.7708 val_score_bestthr=57.3807 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.158, mb=0.513, no=0.987, corr=-0.505) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 57.3807
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1351 mb_mean=0.5144 norm_overlap=0.9875 corr_cb=-0.4973 topkJ=0.0056
[TRAIN][ep=019] loss=0.8163 acc=71.68%
[TRAIN][ep=019] mask_avg: mc_mean=0.1498 mb_mean=0.5133 norm_overlap=0.9860 corr_cb=-0.4898
[EPOCH 019/089] train: loss=0.8163 acc=71.68% | val: loss=0.7894 acc=55.42% f1=67.83% auc=56.74% val_score=49.1298 val_score_bestthr=57.1506 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.150, mb=0.513, no=0.986, corr=-0.490) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 57.1506
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1625 mb_mean=0.5125 norm_overlap=0.9850 corr_cb=-0.5363 topkJ=0.0012
[TRAIN][ep=020] loss=0.8204 acc=71.28%
[TRAIN][ep=020] mask_avg: mc_mean=0.1677 mb_mean=0.5133 norm_overlap=0.9869 corr_cb=-0.4928
[EPOCH 020/089] train: loss=0.8204 acc=71.28% | val: loss=0.7646 acc=56.63% f1=69.49% auc=56.69% val_score=33.3600 val_score_bestthr=59.8699 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.168, mb=0.513, no=0.987, corr=-0.493) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.8699
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.1890 mb_mean=0.5107 norm_overlap=0.9841 corr_cb=-0.5723 topkJ=0.0016
[TRAIN][ep=021] loss=0.8151 acc=71.95%
[TRAIN][ep=021] mask_avg: mc_mean=0.1570 mb_mean=0.5133 norm_overlap=0.9861 corr_cb=-0.5078
[EPOCH 021/089] train: loss=0.8151 acc=71.95% | val: loss=0.7388 acc=55.42% f1=68.91% auc=57.15% val_score=43.0320 val_score_bestthr=59.9272 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.157, mb=0.513, no=0.986, corr=-0.508) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.9272
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1473 mb_mean=0.5140 norm_overlap=0.9936 corr_cb=-0.3157 topkJ=0.0043
[TRAIN][ep=022] loss=0.7976 acc=73.69%
[TRAIN][ep=022] mask_avg: mc_mean=0.1624 mb_mean=0.5133 norm_overlap=0.9858 corr_cb=-0.5234
[EPOCH 022/089] train: loss=0.7976 acc=73.69% | val: loss=0.7677 acc=54.22% f1=69.35% auc=57.73% val_score=43.6067 val_score_bestthr=62.5593 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.162, mb=0.513, no=0.986, corr=-0.523) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 62.5593
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1969 mb_mean=0.5105 norm_overlap=0.9846 corr_cb=-0.5303 topkJ=0.0020
[TRAIN][ep=023] loss=0.7966 acc=73.02%
[TRAIN][ep=023] mask_avg: mc_mean=0.1655 mb_mean=0.5133 norm_overlap=0.9859 corr_cb=-0.5138
[EPOCH 023/089] train: loss=0.7966 acc=73.02% | val: loss=0.7530 acc=56.63% f1=69.49% auc=56.51% val_score=41.8281 val_score_bestthr=59.8699 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.165, mb=0.513, no=0.986, corr=-0.514) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.8699
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1909 mb_mean=0.5126 norm_overlap=0.9865 corr_cb=-0.5140 topkJ=0.0028
[TRAIN][ep=024] loss=0.7791 acc=74.23%
[TRAIN][ep=024] mask_avg: mc_mean=0.1735 mb_mean=0.5133 norm_overlap=0.9862 corr_cb=-0.5165
[EPOCH 024/089] train: loss=0.7791 acc=74.23% | val: loss=0.7607 acc=54.22% f1=68.33% auc=57.44% val_score=46.5430 val_score_bestthr=58.3637 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.174, mb=0.513, no=0.986, corr=-0.516) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.3637
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2096 mb_mean=0.5144 norm_overlap=0.9899 corr_cb=-0.4964 topkJ=0.0040
[TRAIN][ep=025] loss=0.7927 acc=72.89%
[TRAIN][ep=025] mask_avg: mc_mean=0.2095 mb_mean=0.5133 norm_overlap=0.9880 corr_cb=-0.5131
[EPOCH 025/089] train: loss=0.7927 acc=72.89% | val: loss=0.7582 acc=55.42% f1=68.38% auc=57.85% val_score=40.4226 val_score_bestthr=57.3807 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.210, mb=0.513, no=0.988, corr=-0.513) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 57.3807
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1978 mb_mean=0.5127 norm_overlap=0.9909 corr_cb=-0.4577 topkJ=0.0044
[TRAIN][ep=026] loss=0.7706 acc=73.29%
[TRAIN][ep=026] mask_avg: mc_mean=0.1875 mb_mean=0.5133 norm_overlap=0.9871 corr_cb=-0.5085
[EPOCH 026/089] train: loss=0.7706 acc=73.29% | val: loss=0.7927 acc=55.42% f1=68.38% auc=57.03% val_score=39.4685 val_score_bestthr=57.3807 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.188, mb=0.513, no=0.987, corr=-0.509) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 57.3807
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2184 mb_mean=0.5153 norm_overlap=0.9937 corr_cb=-0.3691 topkJ=0.0157
[TRAIN][ep=027] loss=0.7599 acc=75.03%
[TRAIN][ep=027] mask_avg: mc_mean=0.1971 mb_mean=0.5133 norm_overlap=0.9873 corr_cb=-0.5022
[EPOCH 027/089] train: loss=0.7599 acc=75.03% | val: loss=0.7742 acc=54.22% f1=69.35% auc=57.50% val_score=40.7655 val_score_bestthr=62.5593 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.197, mb=0.513, no=0.987, corr=-0.502) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 62.5593
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1599 mb_mean=0.5149 norm_overlap=0.9853 corr_cb=-0.5195 topkJ=0.0050
[TRAIN][ep=028] loss=0.7568 acc=74.63%
[TRAIN][ep=028] mask_avg: mc_mean=0.2004 mb_mean=0.5133 norm_overlap=0.9875 corr_cb=-0.5072
[EPOCH 028/089] train: loss=0.7568 acc=74.63% | val: loss=0.7859 acc=55.42% f1=68.38% auc=57.33% val_score=42.3677 val_score_bestthr=57.3807 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.200, mb=0.513, no=0.988, corr=-0.507) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 57.3807
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.1481 mb_mean=0.5150 norm_overlap=0.9890 corr_cb=-0.4214 topkJ=0.0055
[TRAIN][ep=029] loss=0.7463 acc=75.17%
[TRAIN][ep=029] mask_avg: mc_mean=0.1857 mb_mean=0.5133 norm_overlap=0.9868 corr_cb=-0.5057
[EPOCH 029/089] train: loss=0.7463 acc=75.17% | val: loss=0.7902 acc=56.63% f1=68.97% auc=56.51% val_score=44.0252 val_score_bestthr=58.8798 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.186, mb=0.513, no=0.987, corr=-0.506) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.8798
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2410 mb_mean=0.5126 norm_overlap=0.9881 corr_cb=-0.5518 topkJ=0.0036
[TRAIN][ep=030] loss=0.7441 acc=76.24%
[TRAIN][ep=030] mask_avg: mc_mean=0.1946 mb_mean=0.5133 norm_overlap=0.9871 corr_cb=-0.5055
[EPOCH 030/089] train: loss=0.7441 acc=76.24% | val: loss=0.7943 acc=55.42% f1=68.38% auc=56.98% val_score=47.8897 val_score_bestthr=57.3807 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.195, mb=0.513, no=0.987, corr=-0.506) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 57.3807
[EARLY STOP] no improvement for 30 epochs. best_epoch=0
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold4_rep0_seed4/ckpt_best_fold_4.pt
=============== FIT DONE ===============
[BEST] epoch=0 | val_acc=59.04% | val_f1=69.64% | val_auc=60.12% | val_score=45.6694 | val_score_bestthr=63.2736
[TEST@BEST] thr_used=0.480 | acc=62.32% f1=68.03% auc=65.42% | SP_sex=17.93% EO_sex=17.51% SP_age=15.31% EO_age=14.38%
[TIME] 0.71 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold4_rep0_seed4/summary_fold_4.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4593 mb_mean=0.5110 norm_overlap=1.0000 corr_cb=0.0210 topkJ=0.1340
[TRAIN][ep=000] loss=0.6955 acc=50.87%
[TRAIN][ep=000] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0304
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4604 mb_mean=0.5129 norm_overlap=1.0000 corr_cb=-0.0341 topkJ=0.0385
[TRAIN][ep=001] loss=0.6935 acc=51.54%
[TRAIN][ep=001] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0340
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4621 mb_mean=0.5138 norm_overlap=0.9999 corr_cb=-0.2061 topkJ=0.0705
[TRAIN][ep=002] loss=0.6917 acc=53.02%
[TRAIN][ep=002] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0391
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4656 mb_mean=0.5133 norm_overlap=0.9999 corr_cb=-0.1525 topkJ=0.0702
[TRAIN][ep=003] loss=0.6899 acc=55.17%
[TRAIN][ep=003] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0291
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4607 mb_mean=0.5127 norm_overlap=1.0000 corr_cb=-0.0560 topkJ=0.0532
[TRAIN][ep=004] loss=0.6878 acc=54.36%
[TRAIN][ep=004] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0333
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4627 mb_mean=0.5146 norm_overlap=1.0000 corr_cb=0.0401 topkJ=0.1020
[TRAIN][ep=005] loss=0.6867 acc=57.05%
[TRAIN][ep=005] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0327
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4643 mb_mean=0.5121 norm_overlap=0.9999 corr_cb=-0.1954 topkJ=0.0265
[TRAIN][ep=006] loss=0.6821 acc=57.85%
[TRAIN][ep=006] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0382
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4600 mb_mean=0.5162 norm_overlap=1.0000 corr_cb=-0.0688 topkJ=0.0382
[TRAIN][ep=007] loss=0.6832 acc=56.91%
[TRAIN][ep=007] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0316
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4601 mb_mean=0.5162 norm_overlap=0.9998 corr_cb=-0.3232 topkJ=0.0124
[TRAIN][ep=008] loss=0.6789 acc=58.66%
[TRAIN][ep=008] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0367
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4657 mb_mean=0.5110 norm_overlap=1.0001 corr_cb=0.2304 topkJ=0.1165
[TRAIN][ep=009] loss=0.6761 acc=57.45%
[TRAIN][ep=009] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0276
================= FIT START (fold=4) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4625 mb_mean=0.5166 norm_overlap=0.9999 corr_cb=-0.1231 topkJ=0.0325
[TRAIN][ep=000] loss=0.6713 acc=62.01%
[TRAIN][ep=000] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0298
[EPOCH 000/089] train: loss=0.6713 acc=62.01% | val: loss=0.6780 acc=59.04% f1=69.64% auc=60.12% val_score=45.6694 val_score_bestthr=63.2736 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.030) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 63.2736
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep0_seed4/ckpt_best_fold_4.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4617 mb_mean=0.5124 norm_overlap=1.0000 corr_cb=0.0896 topkJ=0.0788
[TRAIN][ep=001] loss=0.6635 acc=62.28%
[TRAIN][ep=001] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0301
[EPOCH 001/089] train: loss=0.6635 acc=62.28% | val: loss=0.6770 acc=57.83% f1=70.09% auc=61.34% val_score=51.7735 val_score_bestthr=60.1638 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.030) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 60.1638
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4651 mb_mean=0.5120 norm_overlap=1.0000 corr_cb=0.0785 topkJ=0.0875
[TRAIN][ep=002] loss=0.6581 acc=61.07%
[TRAIN][ep=002] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0344
[EPOCH 002/089] train: loss=0.6581 acc=61.07% | val: loss=0.6815 acc=56.63% f1=68.42% auc=59.13% val_score=45.3596 val_score_bestthr=59.6238 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.034) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.6238
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4604 mb_mean=0.5131 norm_overlap=1.0000 corr_cb=0.0074 topkJ=0.0496
[TRAIN][ep=003] loss=0.6514 acc=62.55%
[TRAIN][ep=003] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0360
[EPOCH 003/089] train: loss=0.6514 acc=62.55% | val: loss=0.6899 acc=54.22% f1=68.85% auc=58.49% val_score=40.9798 val_score_bestthr=57.8426 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.036) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 57.8426
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4599 mb_mean=0.5131 norm_overlap=0.9998 corr_cb=-0.3378 topkJ=0.0131
[TRAIN][ep=004] loss=0.6449 acc=62.82%
[TRAIN][ep=004] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0322
[EPOCH 004/089] train: loss=0.6449 acc=62.82% | val: loss=0.6806 acc=57.83% f1=69.03% auc=58.84% val_score=42.0950 val_score_bestthr=60.7136 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.032) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 60.7136
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4645 mb_mean=0.5123 norm_overlap=1.0000 corr_cb=0.1004 topkJ=0.0686
[TRAIN][ep=005] loss=1.4813 acc=61.07%
[TRAIN][ep=005] mask_avg: mc_mean=0.3532 mb_mean=0.5133 norm_overlap=0.9988 corr_cb=-0.3452
[EPOCH 005/089] train: loss=1.4813 acc=61.07% | val: loss=0.6880 acc=53.01% f1=68.29% auc=58.26% val_score=52.2337 val_score_bestthr=56.7094 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.353, mb=0.513, no=0.999, corr=-0.345) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 56.7094
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2940 mb_mean=0.5091 norm_overlap=0.9982 corr_cb=-0.2959 topkJ=0.0212
[TRAIN][ep=006] loss=1.2057 acc=65.10%
[TRAIN][ep=006] mask_avg: mc_mean=0.2256 mb_mean=0.5133 norm_overlap=0.9966 corr_cb=-0.4087
[EPOCH 006/089] train: loss=1.2057 acc=65.10% | val: loss=0.6771 acc=57.83% f1=69.57% auc=57.85% val_score=43.2957 val_score_bestthr=61.1138 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.226, mb=0.513, no=0.997, corr=-0.409) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 61.1138
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2017 mb_mean=0.5122 norm_overlap=0.9967 corr_cb=-0.3713 topkJ=0.0253
[TRAIN][ep=007] loss=0.9634 acc=63.76%
[TRAIN][ep=007] mask_avg: mc_mean=0.1853 mb_mean=0.5133 norm_overlap=0.9952 corr_cb=-0.4275
[EPOCH 007/089] train: loss=0.9634 acc=63.76% | val: loss=0.7081 acc=57.83% f1=69.57% auc=56.40% val_score=40.6038 val_score_bestthr=59.7138 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.185, mb=0.513, no=0.995, corr=-0.427) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.7138
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1172 mb_mean=0.5155 norm_overlap=0.9963 corr_cb=-0.2349 topkJ=0.0280
[TRAIN][ep=008] loss=0.8952 acc=66.04%
[TRAIN][ep=008] mask_avg: mc_mean=0.1485 mb_mean=0.5133 norm_overlap=0.9930 corr_cb=-0.4370
[EPOCH 008/089] train: loss=0.8952 acc=66.04% | val: loss=0.7054 acc=56.63% f1=69.49% auc=57.97% val_score=53.3859 val_score_bestthr=62.3588 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.148, mb=0.513, no=0.993, corr=-0.437) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 62.3588
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1691 mb_mean=0.5094 norm_overlap=0.9944 corr_cb=-0.3813 topkJ=0.0171
[TRAIN][ep=009] loss=0.9065 acc=64.30%
[TRAIN][ep=009] mask_avg: mc_mean=0.1384 mb_mean=0.5133 norm_overlap=0.9917 corr_cb=-0.4617
[EPOCH 009/089] train: loss=0.9065 acc=64.30% | val: loss=0.6926 acc=59.04% f1=70.18% auc=57.73% val_score=41.7827 val_score_bestthr=60.8317 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.138, mb=0.513, no=0.992, corr=-0.462) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 60.8317
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1370 mb_mean=0.5127 norm_overlap=0.9912 corr_cb=-0.5011 topkJ=0.0080
[TRAIN][ep=010] loss=0.8969 acc=66.04%
[TRAIN][ep=010] mask_avg: mc_mean=0.1228 mb_mean=0.5133 norm_overlap=0.9898 corr_cb=-0.4723
[EPOCH 010/089] train: loss=0.8969 acc=66.04% | val: loss=0.6876 acc=57.83% f1=69.57% auc=58.02% val_score=43.1744 val_score_bestthr=59.7138 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.123, mb=0.513, no=0.990, corr=-0.472) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.7138
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1035 mb_mean=0.5141 norm_overlap=0.9892 corr_cb=-0.4810 topkJ=0.0008
[TRAIN][ep=011] loss=0.8820 acc=68.46%
[TRAIN][ep=011] mask_avg: mc_mean=0.1290 mb_mean=0.5133 norm_overlap=0.9890 corr_cb=-0.4961
[EPOCH 011/089] train: loss=0.8820 acc=68.46% | val: loss=0.7042 acc=59.04% f1=70.18% auc=56.10% val_score=39.8392 val_score_bestthr=60.8317 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.129, mb=0.513, no=0.989, corr=-0.496) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 60.8317
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1770 mb_mean=0.5122 norm_overlap=0.9872 corr_cb=-0.6151 topkJ=0.0016
[TRAIN][ep=012] loss=0.8815 acc=66.98%
[TRAIN][ep=012] mask_avg: mc_mean=0.1274 mb_mean=0.5133 norm_overlap=0.9881 corr_cb=-0.4869
[EPOCH 012/089] train: loss=0.8815 acc=66.98% | val: loss=0.7085 acc=55.42% f1=68.91% auc=57.62% val_score=53.3354 val_score_bestthr=59.9272 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.127, mb=0.513, no=0.988, corr=-0.487) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.9272
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1464 mb_mean=0.5120 norm_overlap=0.9880 corr_cb=-0.5109 topkJ=0.0016
[TRAIN][ep=013] loss=0.8753 acc=67.65%
[TRAIN][ep=013] mask_avg: mc_mean=0.1360 mb_mean=0.5133 norm_overlap=0.9879 corr_cb=-0.5074
[EPOCH 013/089] train: loss=0.8753 acc=67.65% | val: loss=0.6979 acc=57.83% f1=69.57% auc=57.38% val_score=43.6134 val_score_bestthr=59.7138 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.136, mb=0.513, no=0.988, corr=-0.507) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.7138
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1931 mb_mean=0.5110 norm_overlap=0.9803 corr_cb=-0.6684 topkJ=0.0000
[TRAIN][ep=014] loss=0.8548 acc=68.32%
[TRAIN][ep=014] mask_avg: mc_mean=0.1371 mb_mean=0.5133 norm_overlap=0.9870 corr_cb=-0.5004
[EPOCH 014/089] train: loss=0.8548 acc=68.32% | val: loss=0.7359 acc=56.63% f1=68.97% auc=56.80% val_score=35.2960 val_score_bestthr=58.2131 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.137, mb=0.513, no=0.987, corr=-0.500) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.2131
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.0613 mb_mean=0.5172 norm_overlap=0.9822 corr_cb=-0.4728 topkJ=0.0004
[TRAIN][ep=015] loss=0.8551 acc=69.26%
[TRAIN][ep=015] mask_avg: mc_mean=0.1284 mb_mean=0.5133 norm_overlap=0.9861 corr_cb=-0.4888
[EPOCH 015/089] train: loss=0.8551 acc=69.26% | val: loss=0.7103 acc=56.63% f1=68.97% auc=56.98% val_score=42.7306 val_score_bestthr=58.2131 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.128, mb=0.513, no=0.986, corr=-0.489) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.2131
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1348 mb_mean=0.5145 norm_overlap=0.9816 corr_cb=-0.5639 topkJ=0.0012
[TRAIN][ep=016] loss=0.8566 acc=67.92%
[TRAIN][ep=016] mask_avg: mc_mean=0.1450 mb_mean=0.5133 norm_overlap=0.9864 corr_cb=-0.4974
[EPOCH 016/089] train: loss=0.8566 acc=67.92% | val: loss=0.7353 acc=59.04% f1=69.09% auc=57.33% val_score=54.3604 val_score_bestthr=55.6753 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.145, mb=0.513, no=0.986, corr=-0.497) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 55.6753
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1659 mb_mean=0.5136 norm_overlap=0.9853 corr_cb=-0.5534 topkJ=0.0008
[TRAIN][ep=017] loss=0.8386 acc=70.20%
[TRAIN][ep=017] mask_avg: mc_mean=0.1671 mb_mean=0.5133 norm_overlap=0.9875 corr_cb=-0.5083
[EPOCH 017/089] train: loss=0.8386 acc=70.20% | val: loss=0.7342 acc=56.63% f1=68.97% auc=56.74% val_score=33.3600 val_score_bestthr=58.2131 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.167, mb=0.513, no=0.987, corr=-0.508) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.2131
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1169 mb_mean=0.5148 norm_overlap=0.9863 corr_cb=-0.4508 topkJ=0.0017
[TRAIN][ep=018] loss=0.8234 acc=72.89%
[TRAIN][ep=018] mask_avg: mc_mean=0.1590 mb_mean=0.5133 norm_overlap=0.9865 corr_cb=-0.5065
[EPOCH 018/089] train: loss=0.8234 acc=72.89% | val: loss=0.7390 acc=55.42% f1=68.38% auc=55.93% val_score=34.7708 val_score_bestthr=57.3807 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.159, mb=0.513, no=0.987, corr=-0.506) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 57.3807
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1354 mb_mean=0.5144 norm_overlap=0.9875 corr_cb=-0.4980 topkJ=0.0056
[TRAIN][ep=019] loss=0.8158 acc=71.68%
[TRAIN][ep=019] mask_avg: mc_mean=0.1502 mb_mean=0.5133 norm_overlap=0.9861 corr_cb=-0.4907
[EPOCH 019/089] train: loss=0.8158 acc=71.68% | val: loss=0.7891 acc=55.42% f1=67.83% auc=56.92% val_score=49.1298 val_score_bestthr=57.1506 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.150, mb=0.513, no=0.986, corr=-0.491) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 57.1506
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1632 mb_mean=0.5125 norm_overlap=0.9850 corr_cb=-0.5369 topkJ=0.0012
[TRAIN][ep=020] loss=0.8197 acc=71.28%
[TRAIN][ep=020] mask_avg: mc_mean=0.1687 mb_mean=0.5133 norm_overlap=0.9869 corr_cb=-0.4938
[EPOCH 020/089] train: loss=0.8197 acc=71.28% | val: loss=0.7646 acc=56.63% f1=69.49% auc=56.80% val_score=33.3600 val_score_bestthr=59.8699 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.169, mb=0.513, no=0.987, corr=-0.494) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.8699
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.1899 mb_mean=0.5107 norm_overlap=0.9842 corr_cb=-0.5733 topkJ=0.0016
[TRAIN][ep=021] loss=0.8143 acc=71.95%
[TRAIN][ep=021] mask_avg: mc_mean=0.1583 mb_mean=0.5133 norm_overlap=0.9861 corr_cb=-0.5090
[EPOCH 021/089] train: loss=0.8143 acc=71.95% | val: loss=0.7386 acc=55.42% f1=68.91% auc=57.03% val_score=43.0320 val_score_bestthr=59.9272 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.158, mb=0.513, no=0.986, corr=-0.509) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.9272
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1492 mb_mean=0.5140 norm_overlap=0.9936 corr_cb=-0.3180 topkJ=0.0039
[TRAIN][ep=022] loss=0.7967 acc=73.69%
[TRAIN][ep=022] mask_avg: mc_mean=0.1633 mb_mean=0.5133 norm_overlap=0.9858 corr_cb=-0.5245
[EPOCH 022/089] train: loss=0.7967 acc=73.69% | val: loss=0.7675 acc=54.22% f1=69.35% auc=57.79% val_score=43.6067 val_score_bestthr=62.5593 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.163, mb=0.513, no=0.986, corr=-0.525) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 62.5593
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1978 mb_mean=0.5105 norm_overlap=0.9846 corr_cb=-0.5325 topkJ=0.0020
[TRAIN][ep=023] loss=0.7957 acc=72.89%
[TRAIN][ep=023] mask_avg: mc_mean=0.1658 mb_mean=0.5133 norm_overlap=0.9859 corr_cb=-0.5149
[EPOCH 023/089] train: loss=0.7957 acc=72.89% | val: loss=0.7530 acc=56.63% f1=69.49% auc=56.57% val_score=41.8281 val_score_bestthr=59.8699 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.166, mb=0.513, no=0.986, corr=-0.515) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.8699
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1918 mb_mean=0.5126 norm_overlap=0.9866 corr_cb=-0.5154 topkJ=0.0028
[TRAIN][ep=024] loss=0.7781 acc=74.36%
[TRAIN][ep=024] mask_avg: mc_mean=0.1741 mb_mean=0.5133 norm_overlap=0.9862 corr_cb=-0.5176
[EPOCH 024/089] train: loss=0.7781 acc=74.36% | val: loss=0.7603 acc=54.22% f1=68.33% auc=57.44% val_score=46.5430 val_score_bestthr=58.3637 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.174, mb=0.513, no=0.986, corr=-0.518) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.3637
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2103 mb_mean=0.5144 norm_overlap=0.9899 corr_cb=-0.4978 topkJ=0.0040
[TRAIN][ep=025] loss=0.7917 acc=73.29%
[TRAIN][ep=025] mask_avg: mc_mean=0.2095 mb_mean=0.5133 norm_overlap=0.9880 corr_cb=-0.5142
[EPOCH 025/089] train: loss=0.7917 acc=73.29% | val: loss=0.7582 acc=55.42% f1=68.38% auc=58.02% val_score=37.1286 val_score_bestthr=57.3807 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.210, mb=0.513, no=0.988, corr=-0.514) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 57.3807
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1984 mb_mean=0.5127 norm_overlap=0.9909 corr_cb=-0.4589 topkJ=0.0044
[TRAIN][ep=026] loss=0.7697 acc=73.29%
[TRAIN][ep=026] mask_avg: mc_mean=0.1878 mb_mean=0.5133 norm_overlap=0.9871 corr_cb=-0.5095
[EPOCH 026/089] train: loss=0.7697 acc=73.29% | val: loss=0.7925 acc=55.42% f1=68.38% auc=57.15% val_score=39.4685 val_score_bestthr=57.3807 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.188, mb=0.513, no=0.987, corr=-0.509) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 57.3807
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2190 mb_mean=0.5153 norm_overlap=0.9937 corr_cb=-0.3701 topkJ=0.0157
[TRAIN][ep=027] loss=0.7588 acc=74.90%
[TRAIN][ep=027] mask_avg: mc_mean=0.1971 mb_mean=0.5133 norm_overlap=0.9873 corr_cb=-0.5030
[EPOCH 027/089] train: loss=0.7588 acc=74.90% | val: loss=0.7745 acc=54.22% f1=69.35% auc=57.56% val_score=40.7655 val_score_bestthr=62.5593 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.197, mb=0.513, no=0.987, corr=-0.503) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 62.5593
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1608 mb_mean=0.5149 norm_overlap=0.9853 corr_cb=-0.5199 topkJ=0.0050
[TRAIN][ep=028] loss=0.7559 acc=74.63%
[TRAIN][ep=028] mask_avg: mc_mean=0.2007 mb_mean=0.5133 norm_overlap=0.9875 corr_cb=-0.5079
[EPOCH 028/089] train: loss=0.7559 acc=74.63% | val: loss=0.7857 acc=54.22% f1=69.35% auc=57.27% val_score=42.3677 val_score_bestthr=62.5593 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.201, mb=0.513, no=0.988, corr=-0.508) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 62.5593
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.1479 mb_mean=0.5150 norm_overlap=0.9890 corr_cb=-0.4220 topkJ=0.0055
[TRAIN][ep=029] loss=0.7454 acc=75.30%
[TRAIN][ep=029] mask_avg: mc_mean=0.1860 mb_mean=0.5133 norm_overlap=0.9868 corr_cb=-0.5063
[EPOCH 029/089] train: loss=0.7454 acc=75.30% | val: loss=0.7900 acc=56.63% f1=68.97% auc=56.69% val_score=44.0252 val_score_bestthr=58.8798 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.186, mb=0.513, no=0.987, corr=-0.506) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.8798
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2410 mb_mean=0.5126 norm_overlap=0.9881 corr_cb=-0.5521 topkJ=0.0040
[TRAIN][ep=030] loss=0.7434 acc=76.38%
[TRAIN][ep=030] mask_avg: mc_mean=0.1946 mb_mean=0.5133 norm_overlap=0.9871 corr_cb=-0.5060
[EPOCH 030/089] train: loss=0.7434 acc=76.38% | val: loss=0.7943 acc=55.42% f1=68.38% auc=56.92% val_score=47.8897 val_score_bestthr=57.3807 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.195, mb=0.513, no=0.987, corr=-0.506) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 57.3807
[EARLY STOP] no improvement for 30 epochs. best_epoch=0
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold4_rep0_seed4/ckpt_best_fold_4.pt
=============== FIT DONE ===============
[BEST] epoch=0 | val_acc=59.04% | val_f1=69.64% | val_auc=60.12% | val_score=45.6694 | val_score_bestthr=63.2736
[TEST@BEST] thr_used=0.480 | acc=62.32% f1=68.03% auc=65.41% | SP_sex=17.93% EO_sex=17.51% SP_age=15.31% EO_age=14.38%
[TIME] 0.76 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold4_rep0_seed4/summary_fold_4.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4593 mb_mean=0.5110 norm_overlap=1.0000 corr_cb=0.0210 topkJ=0.1340
[TRAIN][ep=000] loss=0.6955 acc=50.87%
[TRAIN][ep=000] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0304
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4604 mb_mean=0.5129 norm_overlap=1.0000 corr_cb=-0.0341 topkJ=0.0385
[TRAIN][ep=001] loss=0.6935 acc=51.54%
[TRAIN][ep=001] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0340
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4621 mb_mean=0.5138 norm_overlap=0.9999 corr_cb=-0.2061 topkJ=0.0705
[TRAIN][ep=002] loss=0.6917 acc=53.02%
[TRAIN][ep=002] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0391
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4656 mb_mean=0.5133 norm_overlap=0.9999 corr_cb=-0.1525 topkJ=0.0702
[TRAIN][ep=003] loss=0.6899 acc=55.17%
[TRAIN][ep=003] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0291
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4607 mb_mean=0.5127 norm_overlap=1.0000 corr_cb=-0.0560 topkJ=0.0532
[TRAIN][ep=004] loss=0.6878 acc=54.36%
[TRAIN][ep=004] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0333
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4627 mb_mean=0.5146 norm_overlap=1.0000 corr_cb=0.0401 topkJ=0.1020
[TRAIN][ep=005] loss=0.6867 acc=57.05%
[TRAIN][ep=005] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0327
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4643 mb_mean=0.5121 norm_overlap=0.9999 corr_cb=-0.1954 topkJ=0.0265
[TRAIN][ep=006] loss=0.6821 acc=57.99%
[TRAIN][ep=006] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0382
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4600 mb_mean=0.5162 norm_overlap=1.0000 corr_cb=-0.0688 topkJ=0.0382
[TRAIN][ep=007] loss=0.6832 acc=56.91%
[TRAIN][ep=007] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0316
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4601 mb_mean=0.5162 norm_overlap=0.9998 corr_cb=-0.3232 topkJ=0.0124
[TRAIN][ep=008] loss=0.6789 acc=58.66%
[TRAIN][ep=008] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0367
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4657 mb_mean=0.5110 norm_overlap=1.0001 corr_cb=0.2304 topkJ=0.1165
[TRAIN][ep=009] loss=0.6761 acc=57.45%
[TRAIN][ep=009] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0276
================= FIT START (fold=4) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4625 mb_mean=0.5166 norm_overlap=0.9999 corr_cb=-0.1231 topkJ=0.0325
[TRAIN][ep=000] loss=0.6713 acc=62.15%
[TRAIN][ep=000] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0298
[EPOCH 000/089] train: loss=0.6713 acc=62.15% | val: loss=0.6780 acc=59.04% f1=69.64% auc=60.12% val_score=45.6694 val_score_bestthr=63.2736 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.030) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 63.2736
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep0_seed4/ckpt_best_fold_4.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4617 mb_mean=0.5124 norm_overlap=1.0000 corr_cb=0.0896 topkJ=0.0788
[TRAIN][ep=001] loss=0.6635 acc=62.28%
[TRAIN][ep=001] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0301
[EPOCH 001/089] train: loss=0.6635 acc=62.28% | val: loss=0.6770 acc=56.63% f1=69.49% auc=61.34% val_score=51.7735 val_score_bestthr=60.9699 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.030) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 60.9699
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4651 mb_mean=0.5120 norm_overlap=1.0000 corr_cb=0.0785 topkJ=0.0875
[TRAIN][ep=002] loss=0.6581 acc=61.07%
[TRAIN][ep=002] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0344
[EPOCH 002/089] train: loss=0.6581 acc=61.07% | val: loss=0.6815 acc=56.63% f1=64.71% auc=59.07% val_score=45.3596 val_score_bestthr=58.7293 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.034) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.7293
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4604 mb_mean=0.5131 norm_overlap=1.0000 corr_cb=0.0074 topkJ=0.0496
[TRAIN][ep=003] loss=0.6514 acc=62.55%
[TRAIN][ep=003] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0360
[EPOCH 003/089] train: loss=0.6514 acc=62.55% | val: loss=0.6898 acc=54.22% f1=68.85% auc=58.43% val_score=40.9798 val_score_bestthr=57.8426 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.036) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 57.8426
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4599 mb_mean=0.5131 norm_overlap=0.9998 corr_cb=-0.3378 topkJ=0.0131
[TRAIN][ep=004] loss=0.6448 acc=62.95%
[TRAIN][ep=004] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0322
[EPOCH 004/089] train: loss=0.6448 acc=62.95% | val: loss=0.6806 acc=56.63% f1=67.86% auc=58.84% val_score=42.0950 val_score_bestthr=58.9924 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.032) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.9924
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4645 mb_mean=0.5123 norm_overlap=1.0000 corr_cb=0.1004 topkJ=0.0686
[TRAIN][ep=005] loss=1.2420 acc=61.21%
[TRAIN][ep=005] mask_avg: mc_mean=0.3513 mb_mean=0.5133 norm_overlap=0.9987 corr_cb=-0.3459
[EPOCH 005/089] train: loss=1.2420 acc=61.21% | val: loss=0.6878 acc=54.22% f1=67.80% auc=58.55% val_score=55.1855 val_score_bestthr=56.4399 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.351, mb=0.513, no=0.999, corr=-0.346) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 56.4399
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2923 mb_mean=0.5091 norm_overlap=0.9982 corr_cb=-0.2969 topkJ=0.0212
[TRAIN][ep=006] loss=1.0071 acc=64.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.2245 mb_mean=0.5133 norm_overlap=0.9966 corr_cb=-0.4097
[EPOCH 006/089] train: loss=1.0071 acc=64.70% | val: loss=0.6768 acc=57.83% f1=69.57% auc=58.26% val_score=43.2957 val_score_bestthr=61.1138 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.224, mb=0.513, no=0.997, corr=-0.410) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 61.1138
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2007 mb_mean=0.5122 norm_overlap=0.9966 corr_cb=-0.3723 topkJ=0.0253
[TRAIN][ep=007] loss=0.7999 acc=63.62%
[TRAIN][ep=007] mask_avg: mc_mean=0.1849 mb_mean=0.5133 norm_overlap=0.9952 corr_cb=-0.4282
[EPOCH 007/089] train: loss=0.7999 acc=63.62% | val: loss=0.7078 acc=57.83% f1=69.57% auc=56.69% val_score=40.6038 val_score_bestthr=59.7138 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.185, mb=0.513, no=0.995, corr=-0.428) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.7138
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1173 mb_mean=0.5155 norm_overlap=0.9962 corr_cb=-0.2354 topkJ=0.0280
[TRAIN][ep=008] loss=0.7495 acc=65.91%
[TRAIN][ep=008] mask_avg: mc_mean=0.1486 mb_mean=0.5133 norm_overlap=0.9930 corr_cb=-0.4375
[EPOCH 008/089] train: loss=0.7495 acc=65.91% | val: loss=0.7055 acc=57.83% f1=70.09% auc=58.02% val_score=54.1330 val_score_bestthr=62.9697 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.149, mb=0.513, no=0.993, corr=-0.438) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 62.9697
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1691 mb_mean=0.5094 norm_overlap=0.9944 corr_cb=-0.3820 topkJ=0.0167
[TRAIN][ep=009] loss=0.7610 acc=64.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.1379 mb_mean=0.5133 norm_overlap=0.9917 corr_cb=-0.4619
[EPOCH 009/089] train: loss=0.7610 acc=64.70% | val: loss=0.6923 acc=57.83% f1=69.57% auc=57.97% val_score=41.7827 val_score_bestthr=59.7138 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.138, mb=0.513, no=0.992, corr=-0.462) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.7138
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1364 mb_mean=0.5127 norm_overlap=0.9912 corr_cb=-0.5010 topkJ=0.0080
[TRAIN][ep=010] loss=0.7516 acc=66.17%
[TRAIN][ep=010] mask_avg: mc_mean=0.1226 mb_mean=0.5133 norm_overlap=0.9898 corr_cb=-0.4727
[EPOCH 010/089] train: loss=0.7516 acc=66.17% | val: loss=0.6873 acc=57.83% f1=69.57% auc=57.97% val_score=43.1744 val_score_bestthr=59.7138 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.123, mb=0.513, no=0.990, corr=-0.473) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.7138
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1041 mb_mean=0.5141 norm_overlap=0.9892 corr_cb=-0.4822 topkJ=0.0008
[TRAIN][ep=011] loss=0.7368 acc=68.72%
[TRAIN][ep=011] mask_avg: mc_mean=0.1290 mb_mean=0.5133 norm_overlap=0.9890 corr_cb=-0.4966
[EPOCH 011/089] train: loss=0.7368 acc=68.72% | val: loss=0.7045 acc=59.04% f1=70.18% auc=56.16% val_score=39.8392 val_score_bestthr=60.8317 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.129, mb=0.513, no=0.989, corr=-0.497) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 60.8317
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1773 mb_mean=0.5122 norm_overlap=0.9872 corr_cb=-0.6155 topkJ=0.0016
[TRAIN][ep=012] loss=0.7366 acc=66.71%
[TRAIN][ep=012] mask_avg: mc_mean=0.1281 mb_mean=0.5133 norm_overlap=0.9881 corr_cb=-0.4884
[EPOCH 012/089] train: loss=0.7366 acc=66.71% | val: loss=0.7086 acc=55.42% f1=68.91% auc=57.85% val_score=53.3354 val_score_bestthr=59.9272 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.128, mb=0.513, no=0.988, corr=-0.488) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.9272
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1463 mb_mean=0.5120 norm_overlap=0.9880 corr_cb=-0.5119 topkJ=0.0016
[TRAIN][ep=013] loss=0.7304 acc=67.65%
[TRAIN][ep=013] mask_avg: mc_mean=0.1362 mb_mean=0.5133 norm_overlap=0.9879 corr_cb=-0.5082
[EPOCH 013/089] train: loss=0.7304 acc=67.65% | val: loss=0.6979 acc=56.63% f1=68.97% auc=57.21% val_score=43.6134 val_score_bestthr=58.2131 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.136, mb=0.513, no=0.988, corr=-0.508) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.2131
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1937 mb_mean=0.5110 norm_overlap=0.9802 corr_cb=-0.6709 topkJ=0.0000
[TRAIN][ep=014] loss=0.7107 acc=68.46%
[TRAIN][ep=014] mask_avg: mc_mean=0.1380 mb_mean=0.5133 norm_overlap=0.9871 corr_cb=-0.5014
[EPOCH 014/089] train: loss=0.7107 acc=68.46% | val: loss=0.7361 acc=56.63% f1=68.97% auc=56.74% val_score=35.2960 val_score_bestthr=58.2131 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.138, mb=0.513, no=0.987, corr=-0.501) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.2131
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.0612 mb_mean=0.5172 norm_overlap=0.9822 corr_cb=-0.4737 topkJ=0.0004
[TRAIN][ep=015] loss=0.7109 acc=69.40%
[TRAIN][ep=015] mask_avg: mc_mean=0.1280 mb_mean=0.5133 norm_overlap=0.9861 corr_cb=-0.4897
[EPOCH 015/089] train: loss=0.7109 acc=69.40% | val: loss=0.7110 acc=56.63% f1=68.97% auc=56.92% val_score=42.7306 val_score_bestthr=58.2131 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.128, mb=0.513, no=0.986, corr=-0.490) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.2131
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1356 mb_mean=0.5145 norm_overlap=0.9817 corr_cb=-0.5648 topkJ=0.0012
[TRAIN][ep=016] loss=0.7129 acc=68.05%
[TRAIN][ep=016] mask_avg: mc_mean=0.1452 mb_mean=0.5133 norm_overlap=0.9864 corr_cb=-0.4986
[EPOCH 016/089] train: loss=0.7129 acc=68.05% | val: loss=0.7351 acc=59.04% f1=69.09% auc=57.33% val_score=54.3604 val_score_bestthr=55.6753 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.145, mb=0.513, no=0.986, corr=-0.499) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 55.6753
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1654 mb_mean=0.5136 norm_overlap=0.9852 corr_cb=-0.5548 topkJ=0.0004
[TRAIN][ep=017] loss=0.6957 acc=70.34%
[TRAIN][ep=017] mask_avg: mc_mean=0.1676 mb_mean=0.5133 norm_overlap=0.9875 corr_cb=-0.5095
[EPOCH 017/089] train: loss=0.6957 acc=70.34% | val: loss=0.7343 acc=56.63% f1=68.97% auc=56.80% val_score=35.0726 val_score_bestthr=58.2131 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.168, mb=0.513, no=0.987, corr=-0.510) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.2131
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1167 mb_mean=0.5148 norm_overlap=0.9863 corr_cb=-0.4514 topkJ=0.0017
[TRAIN][ep=018] loss=0.6814 acc=73.02%
[TRAIN][ep=018] mask_avg: mc_mean=0.1593 mb_mean=0.5133 norm_overlap=0.9866 corr_cb=-0.5079
[EPOCH 018/089] train: loss=0.6814 acc=73.02% | val: loss=0.7394 acc=53.01% f1=68.80% auc=55.87% val_score=34.7708 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.159, mb=0.513, no=0.987, corr=-0.508) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 61.2320
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1372 mb_mean=0.5144 norm_overlap=0.9876 corr_cb=-0.5012 topkJ=0.0056
[TRAIN][ep=019] loss=0.6743 acc=71.68%
[TRAIN][ep=019] mask_avg: mc_mean=0.1504 mb_mean=0.5133 norm_overlap=0.9861 corr_cb=-0.4924
[EPOCH 019/089] train: loss=0.6743 acc=71.68% | val: loss=0.7890 acc=55.42% f1=67.83% auc=56.86% val_score=49.1298 val_score_bestthr=57.1506 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.150, mb=0.513, no=0.986, corr=-0.492) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 57.1506
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1618 mb_mean=0.5125 norm_overlap=0.9849 corr_cb=-0.5387 topkJ=0.0012
[TRAIN][ep=020] loss=0.6790 acc=71.01%
[TRAIN][ep=020] mask_avg: mc_mean=0.1683 mb_mean=0.5133 norm_overlap=0.9869 corr_cb=-0.4954
[EPOCH 020/089] train: loss=0.6790 acc=71.01% | val: loss=0.7644 acc=56.63% f1=69.49% auc=56.80% val_score=33.3600 val_score_bestthr=59.8699 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.168, mb=0.513, no=0.987, corr=-0.495) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.8699
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.1914 mb_mean=0.5107 norm_overlap=0.9842 corr_cb=-0.5757 topkJ=0.0016
[TRAIN][ep=021] loss=0.6752 acc=72.08%
[TRAIN][ep=021] mask_avg: mc_mean=0.1595 mb_mean=0.5133 norm_overlap=0.9861 corr_cb=-0.5119
[EPOCH 021/089] train: loss=0.6752 acc=72.08% | val: loss=0.7385 acc=55.42% f1=68.91% auc=57.03% val_score=44.5435 val_score_bestthr=59.9272 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.160, mb=0.513, no=0.986, corr=-0.512) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.9272
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1487 mb_mean=0.5140 norm_overlap=0.9936 corr_cb=-0.3179 topkJ=0.0035
[TRAIN][ep=022] loss=0.6585 acc=73.83%
[TRAIN][ep=022] mask_avg: mc_mean=0.1634 mb_mean=0.5133 norm_overlap=0.9858 corr_cb=-0.5268
[EPOCH 022/089] train: loss=0.6585 acc=73.83% | val: loss=0.7691 acc=54.22% f1=69.35% auc=57.91% val_score=43.2453 val_score_bestthr=62.5593 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.163, mb=0.513, no=0.986, corr=-0.527) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 62.5593
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1975 mb_mean=0.5105 norm_overlap=0.9846 corr_cb=-0.5330 topkJ=0.0020
[TRAIN][ep=023] loss=0.6586 acc=72.75%
[TRAIN][ep=023] mask_avg: mc_mean=0.1664 mb_mean=0.5133 norm_overlap=0.9859 corr_cb=-0.5174
[EPOCH 023/089] train: loss=0.6586 acc=72.75% | val: loss=0.7542 acc=56.63% f1=69.49% auc=56.69% val_score=38.5240 val_score_bestthr=59.8699 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.166, mb=0.513, no=0.986, corr=-0.517) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.8699
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1934 mb_mean=0.5126 norm_overlap=0.9866 corr_cb=-0.5158 topkJ=0.0028
[TRAIN][ep=024] loss=0.6424 acc=74.63%
[TRAIN][ep=024] mask_avg: mc_mean=0.1741 mb_mean=0.5133 norm_overlap=0.9861 corr_cb=-0.5203
[EPOCH 024/089] train: loss=0.6424 acc=74.63% | val: loss=0.7613 acc=54.22% f1=68.33% auc=57.33% val_score=46.5430 val_score_bestthr=58.3637 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.174, mb=0.513, no=0.986, corr=-0.520) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.3637
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2097 mb_mean=0.5144 norm_overlap=0.9899 corr_cb=-0.4996 topkJ=0.0040
[TRAIN][ep=025] loss=0.6582 acc=73.15%
[TRAIN][ep=025] mask_avg: mc_mean=0.2102 mb_mean=0.5133 norm_overlap=0.9880 corr_cb=-0.5172
[EPOCH 025/089] train: loss=0.6582 acc=73.15% | val: loss=0.7580 acc=55.42% f1=68.91% auc=57.85% val_score=37.1286 val_score_bestthr=58.3049 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.210, mb=0.513, no=0.988, corr=-0.517) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.3049
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1980 mb_mean=0.5127 norm_overlap=0.9909 corr_cb=-0.4631 topkJ=0.0044
[TRAIN][ep=026] loss=0.6361 acc=73.69%
[TRAIN][ep=026] mask_avg: mc_mean=0.1882 mb_mean=0.5133 norm_overlap=0.9870 corr_cb=-0.5130
[EPOCH 026/089] train: loss=0.6361 acc=73.69% | val: loss=0.7932 acc=55.42% f1=68.38% auc=57.38% val_score=39.4685 val_score_bestthr=57.3807 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.188, mb=0.513, no=0.987, corr=-0.513) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 57.3807
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2179 mb_mean=0.5153 norm_overlap=0.9936 corr_cb=-0.3765 topkJ=0.0157
[TRAIN][ep=027] loss=0.6255 acc=75.30%
[TRAIN][ep=027] mask_avg: mc_mean=0.1974 mb_mean=0.5133 norm_overlap=0.9873 corr_cb=-0.5064
[EPOCH 027/089] train: loss=0.6255 acc=75.30% | val: loss=0.7750 acc=54.22% f1=69.35% auc=57.56% val_score=40.7655 val_score_bestthr=62.5593 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.197, mb=0.513, no=0.987, corr=-0.506) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 62.5593
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1631 mb_mean=0.5149 norm_overlap=0.9855 corr_cb=-0.5217 topkJ=0.0050
[TRAIN][ep=028] loss=0.6219 acc=74.36%
[TRAIN][ep=028] mask_avg: mc_mean=0.2012 mb_mean=0.5133 norm_overlap=0.9875 corr_cb=-0.5112
[EPOCH 028/089] train: loss=0.6219 acc=74.36% | val: loss=0.7884 acc=54.22% f1=69.35% auc=57.27% val_score=42.1320 val_score_bestthr=62.5593 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.201, mb=0.513, no=0.988, corr=-0.511) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 62.5593
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.1475 mb_mean=0.5150 norm_overlap=0.9889 corr_cb=-0.4261 topkJ=0.0055
[TRAIN][ep=029] loss=0.6145 acc=74.90%
[TRAIN][ep=029] mask_avg: mc_mean=0.1856 mb_mean=0.5133 norm_overlap=0.9867 corr_cb=-0.5095
[EPOCH 029/089] train: loss=0.6145 acc=74.90% | val: loss=0.7918 acc=56.63% f1=68.97% auc=56.69% val_score=44.0252 val_score_bestthr=58.8798 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.186, mb=0.513, no=0.987, corr=-0.510) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.8798
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2420 mb_mean=0.5126 norm_overlap=0.9882 corr_cb=-0.5535 topkJ=0.0036
[TRAIN][ep=030] loss=0.6138 acc=76.11%
[TRAIN][ep=030] mask_avg: mc_mean=0.1949 mb_mean=0.5133 norm_overlap=0.9870 corr_cb=-0.5095
[EPOCH 030/089] train: loss=0.6138 acc=76.11% | val: loss=0.7961 acc=55.42% f1=68.38% auc=56.74% val_score=49.9192 val_score_bestthr=57.3807 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.195, mb=0.513, no=0.987, corr=-0.509) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 57.3807
[EARLY STOP] no improvement for 30 epochs. best_epoch=0
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold4_rep0_seed4/ckpt_best_fold_4.pt
=============== FIT DONE ===============
[BEST] epoch=0 | val_acc=59.04% | val_f1=69.64% | val_auc=60.12% | val_score=45.6694 | val_score_bestthr=63.2736
[TEST@BEST] thr_used=0.480 | acc=62.32% f1=68.03% auc=65.41% | SP_sex=17.93% EO_sex=17.51% SP_age=15.31% EO_age=14.38%
[TIME] 0.73 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold4_rep0_seed4/summary_fold_4.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4593 mb_mean=0.5110 norm_overlap=1.0000 corr_cb=0.0210 topkJ=0.1340
[TRAIN][ep=000] loss=0.6955 acc=50.87%
[TRAIN][ep=000] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0304
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4604 mb_mean=0.5129 norm_overlap=1.0000 corr_cb=-0.0341 topkJ=0.0385
[TRAIN][ep=001] loss=0.6935 acc=51.54%
[TRAIN][ep=001] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0340
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4621 mb_mean=0.5138 norm_overlap=0.9999 corr_cb=-0.2061 topkJ=0.0705
[TRAIN][ep=002] loss=0.6917 acc=53.02%
[TRAIN][ep=002] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0391
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4656 mb_mean=0.5133 norm_overlap=0.9999 corr_cb=-0.1525 topkJ=0.0702
[TRAIN][ep=003] loss=0.6899 acc=55.17%
[TRAIN][ep=003] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0291
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4607 mb_mean=0.5127 norm_overlap=1.0000 corr_cb=-0.0560 topkJ=0.0532
[TRAIN][ep=004] loss=0.6878 acc=54.36%
[TRAIN][ep=004] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0333
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4627 mb_mean=0.5146 norm_overlap=1.0000 corr_cb=0.0401 topkJ=0.1020
[TRAIN][ep=005] loss=0.6867 acc=57.05%
[TRAIN][ep=005] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0327
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4643 mb_mean=0.5121 norm_overlap=0.9999 corr_cb=-0.1954 topkJ=0.0265
[TRAIN][ep=006] loss=0.6821 acc=57.85%
[TRAIN][ep=006] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0382
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4600 mb_mean=0.5162 norm_overlap=1.0000 corr_cb=-0.0688 topkJ=0.0382
[TRAIN][ep=007] loss=0.6832 acc=56.91%
[TRAIN][ep=007] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0316
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4601 mb_mean=0.5162 norm_overlap=0.9998 corr_cb=-0.3232 topkJ=0.0124
[TRAIN][ep=008] loss=0.6789 acc=58.66%
[TRAIN][ep=008] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0367
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4657 mb_mean=0.5110 norm_overlap=1.0001 corr_cb=0.2304 topkJ=0.1165
[TRAIN][ep=009] loss=0.6761 acc=57.45%
[TRAIN][ep=009] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0276
================= FIT START (fold=4) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4625 mb_mean=0.5166 norm_overlap=0.9999 corr_cb=-0.1231 topkJ=0.0325
[TRAIN][ep=000] loss=0.6713 acc=62.15%
[TRAIN][ep=000] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0298
[EPOCH 000/089] train: loss=0.6713 acc=62.15% | val: loss=0.6780 acc=59.04% f1=69.64% auc=60.12% val_score=45.6694 val_score_bestthr=63.2736 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.030) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 63.2736
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep0_seed4/ckpt_best_fold_4.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4617 mb_mean=0.5124 norm_overlap=1.0000 corr_cb=0.0896 topkJ=0.0788
[TRAIN][ep=001] loss=0.6635 acc=62.28%
[TRAIN][ep=001] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0301
[EPOCH 001/089] train: loss=0.6635 acc=62.28% | val: loss=0.6770 acc=57.83% f1=70.09% auc=61.28% val_score=51.7735 val_score_bestthr=60.1638 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.030) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 60.1638
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4651 mb_mean=0.5120 norm_overlap=1.0000 corr_cb=0.0785 topkJ=0.0875
[TRAIN][ep=002] loss=0.6581 acc=61.07%
[TRAIN][ep=002] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0344
[EPOCH 002/089] train: loss=0.6581 acc=61.07% | val: loss=0.6815 acc=56.63% f1=68.42% auc=59.13% val_score=45.3596 val_score_bestthr=59.6238 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.034) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.6238
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4604 mb_mean=0.5131 norm_overlap=1.0000 corr_cb=0.0074 topkJ=0.0496
[TRAIN][ep=003] loss=0.6514 acc=62.55%
[TRAIN][ep=003] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0360
[EPOCH 003/089] train: loss=0.6514 acc=62.55% | val: loss=0.6899 acc=54.22% f1=68.85% auc=58.49% val_score=40.9798 val_score_bestthr=57.8426 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.036) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 57.8426
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4599 mb_mean=0.5131 norm_overlap=0.9998 corr_cb=-0.3378 topkJ=0.0131
[TRAIN][ep=004] loss=0.6448 acc=62.82%
[TRAIN][ep=004] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0322
[EPOCH 004/089] train: loss=0.6448 acc=62.82% | val: loss=0.6806 acc=57.83% f1=69.03% auc=58.84% val_score=42.0950 val_score_bestthr=60.7136 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.032) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 60.7136
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4645 mb_mean=0.5123 norm_overlap=1.0000 corr_cb=0.1004 topkJ=0.0686
[TRAIN][ep=005] loss=1.2980 acc=60.94%
[TRAIN][ep=005] mask_avg: mc_mean=0.3512 mb_mean=0.5133 norm_overlap=0.9987 corr_cb=-0.3456
[EPOCH 005/089] train: loss=1.2980 acc=60.94% | val: loss=0.6884 acc=53.01% f1=68.29% auc=58.49% val_score=52.2337 val_score_bestthr=56.7094 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.351, mb=0.513, no=0.999, corr=-0.346) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 56.7094
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2922 mb_mean=0.5091 norm_overlap=0.9982 corr_cb=-0.2964 topkJ=0.0212
[TRAIN][ep=006] loss=1.0619 acc=65.23%
[TRAIN][ep=006] mask_avg: mc_mean=0.2245 mb_mean=0.5133 norm_overlap=0.9966 corr_cb=-0.4092
[EPOCH 006/089] train: loss=1.0619 acc=65.23% | val: loss=0.6771 acc=57.83% f1=69.57% auc=58.02% val_score=43.2957 val_score_bestthr=61.1138 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.224, mb=0.513, no=0.997, corr=-0.409) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 61.1138
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2008 mb_mean=0.5122 norm_overlap=0.9966 corr_cb=-0.3721 topkJ=0.0253
[TRAIN][ep=007] loss=0.8547 acc=64.03%
[TRAIN][ep=007] mask_avg: mc_mean=0.1850 mb_mean=0.5133 norm_overlap=0.9952 corr_cb=-0.4280
[EPOCH 007/089] train: loss=0.8547 acc=64.03% | val: loss=0.7084 acc=57.83% f1=69.57% auc=56.45% val_score=40.6038 val_score_bestthr=59.7138 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.185, mb=0.513, no=0.995, corr=-0.428) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.7138
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1172 mb_mean=0.5155 norm_overlap=0.9962 corr_cb=-0.2351 topkJ=0.0280
[TRAIN][ep=008] loss=0.8044 acc=65.77%
[TRAIN][ep=008] mask_avg: mc_mean=0.1483 mb_mean=0.5133 norm_overlap=0.9930 corr_cb=-0.4371
[EPOCH 008/089] train: loss=0.8044 acc=65.77% | val: loss=0.7060 acc=57.83% f1=70.09% auc=57.97% val_score=54.1330 val_score_bestthr=62.9697 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.148, mb=0.513, no=0.993, corr=-0.437) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 62.9697
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1686 mb_mean=0.5094 norm_overlap=0.9944 corr_cb=-0.3815 topkJ=0.0171
[TRAIN][ep=009] loss=0.8158 acc=64.83%
[TRAIN][ep=009] mask_avg: mc_mean=0.1382 mb_mean=0.5133 norm_overlap=0.9917 corr_cb=-0.4621
[EPOCH 009/089] train: loss=0.8158 acc=64.83% | val: loss=0.6928 acc=59.04% f1=70.18% auc=57.79% val_score=41.7827 val_score_bestthr=60.8317 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.138, mb=0.513, no=0.992, corr=-0.462) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 60.8317
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1369 mb_mean=0.5127 norm_overlap=0.9912 corr_cb=-0.5011 topkJ=0.0080
[TRAIN][ep=010] loss=0.8063 acc=66.17%
[TRAIN][ep=010] mask_avg: mc_mean=0.1231 mb_mean=0.5133 norm_overlap=0.9898 corr_cb=-0.4728
[EPOCH 010/089] train: loss=0.8063 acc=66.17% | val: loss=0.6876 acc=57.83% f1=69.57% auc=57.91% val_score=43.1744 val_score_bestthr=59.7138 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.123, mb=0.513, no=0.990, corr=-0.473) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.7138
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1046 mb_mean=0.5141 norm_overlap=0.9892 corr_cb=-0.4822 topkJ=0.0008
[TRAIN][ep=011] loss=0.7916 acc=68.72%
[TRAIN][ep=011] mask_avg: mc_mean=0.1299 mb_mean=0.5133 norm_overlap=0.9891 corr_cb=-0.4968
[EPOCH 011/089] train: loss=0.7916 acc=68.72% | val: loss=0.7045 acc=59.04% f1=70.18% auc=56.10% val_score=39.8392 val_score_bestthr=60.8317 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.130, mb=0.513, no=0.989, corr=-0.497) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 60.8317
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1780 mb_mean=0.5122 norm_overlap=0.9873 corr_cb=-0.6158 topkJ=0.0016
[TRAIN][ep=012] loss=0.7914 acc=66.85%
[TRAIN][ep=012] mask_avg: mc_mean=0.1283 mb_mean=0.5133 norm_overlap=0.9881 corr_cb=-0.4882
[EPOCH 012/089] train: loss=0.7914 acc=66.85% | val: loss=0.7087 acc=55.42% f1=68.91% auc=57.85% val_score=53.3354 val_score_bestthr=59.9272 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.128, mb=0.513, no=0.988, corr=-0.488) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.9272
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1471 mb_mean=0.5120 norm_overlap=0.9881 corr_cb=-0.5118 topkJ=0.0016
[TRAIN][ep=013] loss=0.7852 acc=67.38%
[TRAIN][ep=013] mask_avg: mc_mean=0.1372 mb_mean=0.5133 norm_overlap=0.9880 corr_cb=-0.5086
[EPOCH 013/089] train: loss=0.7852 acc=67.38% | val: loss=0.6980 acc=56.63% f1=68.97% auc=57.21% val_score=43.6134 val_score_bestthr=58.2131 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.137, mb=0.513, no=0.988, corr=-0.509) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.2131
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1938 mb_mean=0.5110 norm_overlap=0.9803 corr_cb=-0.6698 topkJ=0.0000
[TRAIN][ep=014] loss=0.7653 acc=68.32%
[TRAIN][ep=014] mask_avg: mc_mean=0.1382 mb_mean=0.5133 norm_overlap=0.9871 corr_cb=-0.5011
[EPOCH 014/089] train: loss=0.7653 acc=68.32% | val: loss=0.7365 acc=56.63% f1=68.97% auc=56.69% val_score=35.2960 val_score_bestthr=58.2131 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.138, mb=0.513, no=0.987, corr=-0.501) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.2131
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.0611 mb_mean=0.5172 norm_overlap=0.9822 corr_cb=-0.4730 topkJ=0.0004
[TRAIN][ep=015] loss=0.7655 acc=69.26%
[TRAIN][ep=015] mask_avg: mc_mean=0.1293 mb_mean=0.5133 norm_overlap=0.9862 corr_cb=-0.4891
[EPOCH 015/089] train: loss=0.7655 acc=69.26% | val: loss=0.7110 acc=56.63% f1=68.97% auc=56.98% val_score=42.7306 val_score_bestthr=58.2131 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.129, mb=0.513, no=0.986, corr=-0.489) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.2131
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1366 mb_mean=0.5145 norm_overlap=0.9818 corr_cb=-0.5644 topkJ=0.0012
[TRAIN][ep=016] loss=0.7674 acc=68.19%
[TRAIN][ep=016] mask_avg: mc_mean=0.1461 mb_mean=0.5133 norm_overlap=0.9865 corr_cb=-0.4977
[EPOCH 016/089] train: loss=0.7674 acc=68.19% | val: loss=0.7353 acc=54.22% f1=68.33% auc=57.33% val_score=54.3604 val_score_bestthr=58.3637 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.146, mb=0.513, no=0.986, corr=-0.498) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.3637
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1663 mb_mean=0.5136 norm_overlap=0.9853 corr_cb=-0.5533 topkJ=0.0004
[TRAIN][ep=017] loss=0.7501 acc=70.34%
[TRAIN][ep=017] mask_avg: mc_mean=0.1676 mb_mean=0.5133 norm_overlap=0.9875 corr_cb=-0.5084
[EPOCH 017/089] train: loss=0.7501 acc=70.34% | val: loss=0.7343 acc=56.63% f1=68.97% auc=56.80% val_score=35.0726 val_score_bestthr=58.2131 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.168, mb=0.513, no=0.988, corr=-0.508) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.2131
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1172 mb_mean=0.5148 norm_overlap=0.9864 corr_cb=-0.4519 topkJ=0.0017
[TRAIN][ep=018] loss=0.7356 acc=72.89%
[TRAIN][ep=018] mask_avg: mc_mean=0.1599 mb_mean=0.5133 norm_overlap=0.9866 corr_cb=-0.5077
[EPOCH 018/089] train: loss=0.7356 acc=72.89% | val: loss=0.7389 acc=55.42% f1=68.38% auc=55.87% val_score=34.7708 val_score_bestthr=57.3807 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.160, mb=0.513, no=0.987, corr=-0.508) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 57.3807
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1361 mb_mean=0.5144 norm_overlap=0.9876 corr_cb=-0.4994 topkJ=0.0060
[TRAIN][ep=019] loss=0.7285 acc=71.54%
[TRAIN][ep=019] mask_avg: mc_mean=0.1503 mb_mean=0.5133 norm_overlap=0.9861 corr_cb=-0.4922
[EPOCH 019/089] train: loss=0.7285 acc=71.54% | val: loss=0.7886 acc=55.42% f1=67.83% auc=56.80% val_score=49.1298 val_score_bestthr=57.1506 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.150, mb=0.513, no=0.986, corr=-0.492) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 57.1506
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1628 mb_mean=0.5125 norm_overlap=0.9850 corr_cb=-0.5387 topkJ=0.0012
[TRAIN][ep=020] loss=0.7331 acc=71.28%
[TRAIN][ep=020] mask_avg: mc_mean=0.1697 mb_mean=0.5133 norm_overlap=0.9870 corr_cb=-0.4957
[EPOCH 020/089] train: loss=0.7331 acc=71.28% | val: loss=0.7648 acc=56.63% f1=69.49% auc=56.80% val_score=33.3600 val_score_bestthr=59.8699 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.170, mb=0.513, no=0.987, corr=-0.496) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.8699
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.1922 mb_mean=0.5107 norm_overlap=0.9843 corr_cb=-0.5758 topkJ=0.0012
[TRAIN][ep=021] loss=0.7290 acc=71.95%
[TRAIN][ep=021] mask_avg: mc_mean=0.1596 mb_mean=0.5133 norm_overlap=0.9862 corr_cb=-0.5111
[EPOCH 021/089] train: loss=0.7290 acc=71.95% | val: loss=0.7385 acc=55.42% f1=68.91% auc=57.09% val_score=44.5435 val_score_bestthr=59.9272 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.160, mb=0.513, no=0.986, corr=-0.511) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.9272
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1502 mb_mean=0.5140 norm_overlap=0.9936 corr_cb=-0.3203 topkJ=0.0039
[TRAIN][ep=022] loss=0.7125 acc=73.96%
[TRAIN][ep=022] mask_avg: mc_mean=0.1641 mb_mean=0.5133 norm_overlap=0.9859 corr_cb=-0.5263
[EPOCH 022/089] train: loss=0.7125 acc=73.96% | val: loss=0.7689 acc=54.22% f1=69.35% auc=57.73% val_score=43.6067 val_score_bestthr=62.5593 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.164, mb=0.513, no=0.986, corr=-0.526) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 62.5593
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1987 mb_mean=0.5105 norm_overlap=0.9846 corr_cb=-0.5347 topkJ=0.0020
[TRAIN][ep=023] loss=0.7124 acc=73.02%
[TRAIN][ep=023] mask_avg: mc_mean=0.1672 mb_mean=0.5133 norm_overlap=0.9860 corr_cb=-0.5167
[EPOCH 023/089] train: loss=0.7124 acc=73.02% | val: loss=0.7540 acc=56.63% f1=69.49% auc=56.74% val_score=38.5240 val_score_bestthr=59.8699 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.167, mb=0.513, no=0.986, corr=-0.517) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.8699
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1937 mb_mean=0.5126 norm_overlap=0.9867 corr_cb=-0.5166 topkJ=0.0028
[TRAIN][ep=024] loss=0.6961 acc=74.77%
[TRAIN][ep=024] mask_avg: mc_mean=0.1746 mb_mean=0.5133 norm_overlap=0.9862 corr_cb=-0.5194
[EPOCH 024/089] train: loss=0.6961 acc=74.77% | val: loss=0.7610 acc=54.22% f1=68.33% auc=57.21% val_score=46.5430 val_score_bestthr=58.3637 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.175, mb=0.513, no=0.986, corr=-0.519) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.3637
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2102 mb_mean=0.5144 norm_overlap=0.9899 corr_cb=-0.4995 topkJ=0.0040
[TRAIN][ep=025] loss=0.7121 acc=72.89%
[TRAIN][ep=025] mask_avg: mc_mean=0.2106 mb_mean=0.5133 norm_overlap=0.9880 corr_cb=-0.5165
[EPOCH 025/089] train: loss=0.7121 acc=72.89% | val: loss=0.7584 acc=55.42% f1=68.91% auc=57.91% val_score=37.1286 val_score_bestthr=58.3049 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.211, mb=0.513, no=0.988, corr=-0.516) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.3049
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1985 mb_mean=0.5127 norm_overlap=0.9909 corr_cb=-0.4615 topkJ=0.0040
[TRAIN][ep=026] loss=0.6896 acc=73.69%
[TRAIN][ep=026] mask_avg: mc_mean=0.1880 mb_mean=0.5133 norm_overlap=0.9871 corr_cb=-0.5119
[EPOCH 026/089] train: loss=0.6896 acc=73.69% | val: loss=0.7937 acc=55.42% f1=68.38% auc=57.27% val_score=39.4685 val_score_bestthr=57.3807 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.188, mb=0.513, no=0.987, corr=-0.512) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 57.3807
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2190 mb_mean=0.5153 norm_overlap=0.9937 corr_cb=-0.3734 topkJ=0.0157
[TRAIN][ep=027] loss=0.6795 acc=75.44%
[TRAIN][ep=027] mask_avg: mc_mean=0.1975 mb_mean=0.5133 norm_overlap=0.9873 corr_cb=-0.5052
[EPOCH 027/089] train: loss=0.6795 acc=75.44% | val: loss=0.7751 acc=54.22% f1=69.35% auc=57.38% val_score=40.7655 val_score_bestthr=62.5593 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.197, mb=0.513, no=0.987, corr=-0.505) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 62.5593
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1623 mb_mean=0.5149 norm_overlap=0.9854 corr_cb=-0.5213 topkJ=0.0050
[TRAIN][ep=028] loss=0.6756 acc=74.23%
[TRAIN][ep=028] mask_avg: mc_mean=0.2011 mb_mean=0.5133 norm_overlap=0.9875 corr_cb=-0.5099
[EPOCH 028/089] train: loss=0.6756 acc=74.23% | val: loss=0.7886 acc=54.22% f1=69.35% auc=57.03% val_score=42.1320 val_score_bestthr=62.5593 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.201, mb=0.513, no=0.988, corr=-0.510) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 62.5593
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.1476 mb_mean=0.5150 norm_overlap=0.9890 corr_cb=-0.4233 topkJ=0.0055
[TRAIN][ep=029] loss=0.6682 acc=74.90%
[TRAIN][ep=029] mask_avg: mc_mean=0.1856 mb_mean=0.5133 norm_overlap=0.9868 corr_cb=-0.5083
[EPOCH 029/089] train: loss=0.6682 acc=74.90% | val: loss=0.7920 acc=56.63% f1=68.97% auc=56.74% val_score=44.0252 val_score_bestthr=58.8798 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.186, mb=0.513, no=0.987, corr=-0.508) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.8798
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2414 mb_mean=0.5126 norm_overlap=0.9881 corr_cb=-0.5531 topkJ=0.0036
[TRAIN][ep=030] loss=0.6674 acc=76.11%
[TRAIN][ep=030] mask_avg: mc_mean=0.1945 mb_mean=0.5133 norm_overlap=0.9871 corr_cb=-0.5080
[EPOCH 030/089] train: loss=0.6674 acc=76.11% | val: loss=0.7961 acc=55.42% f1=68.38% auc=56.69% val_score=49.9192 val_score_bestthr=57.3807 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.195, mb=0.513, no=0.987, corr=-0.508) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 57.3807
[EARLY STOP] no improvement for 30 epochs. best_epoch=0
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold4_rep0_seed4/ckpt_best_fold_4.pt
=============== FIT DONE ===============
[BEST] epoch=0 | val_acc=59.04% | val_f1=69.64% | val_auc=60.12% | val_score=45.6694 | val_score_bestthr=63.2736
[TEST@BEST] thr_used=0.480 | acc=62.32% f1=68.03% auc=65.42% | SP_sex=17.93% EO_sex=17.51% SP_age=15.31% EO_age=14.38%
[TIME] 0.80 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold4_rep0_seed4/summary_fold_4.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4593 mb_mean=0.5110 norm_overlap=1.0000 corr_cb=0.0210 topkJ=0.1340
[TRAIN][ep=000] loss=0.6955 acc=50.87%
[TRAIN][ep=000] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0304
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4604 mb_mean=0.5129 norm_overlap=1.0000 corr_cb=-0.0341 topkJ=0.0385
[TRAIN][ep=001] loss=0.6935 acc=51.54%
[TRAIN][ep=001] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0340
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4621 mb_mean=0.5138 norm_overlap=0.9999 corr_cb=-0.2061 topkJ=0.0705
[TRAIN][ep=002] loss=0.6917 acc=53.02%
[TRAIN][ep=002] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0391
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4656 mb_mean=0.5133 norm_overlap=0.9999 corr_cb=-0.1525 topkJ=0.0702
[TRAIN][ep=003] loss=0.6899 acc=55.17%
[TRAIN][ep=003] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0291
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4607 mb_mean=0.5127 norm_overlap=1.0000 corr_cb=-0.0560 topkJ=0.0532
[TRAIN][ep=004] loss=0.6878 acc=54.36%
[TRAIN][ep=004] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0333
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4627 mb_mean=0.5146 norm_overlap=1.0000 corr_cb=0.0401 topkJ=0.1020
[TRAIN][ep=005] loss=0.6867 acc=57.05%
[TRAIN][ep=005] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0327
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4643 mb_mean=0.5121 norm_overlap=0.9999 corr_cb=-0.1954 topkJ=0.0265
[TRAIN][ep=006] loss=0.6821 acc=57.85%
[TRAIN][ep=006] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0382
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4600 mb_mean=0.5162 norm_overlap=1.0000 corr_cb=-0.0688 topkJ=0.0382
[TRAIN][ep=007] loss=0.6832 acc=56.78%
[TRAIN][ep=007] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0316
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4601 mb_mean=0.5162 norm_overlap=0.9998 corr_cb=-0.3232 topkJ=0.0124
[TRAIN][ep=008] loss=0.6789 acc=58.66%
[TRAIN][ep=008] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0367
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4657 mb_mean=0.5110 norm_overlap=1.0001 corr_cb=0.2304 topkJ=0.1165
[TRAIN][ep=009] loss=0.6761 acc=57.45%
[TRAIN][ep=009] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0276
================= FIT START (fold=4) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4625 mb_mean=0.5166 norm_overlap=0.9999 corr_cb=-0.1231 topkJ=0.0325
[TRAIN][ep=000] loss=0.6713 acc=62.15%
[TRAIN][ep=000] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0298
[EPOCH 000/089] train: loss=0.6713 acc=62.15% | val: loss=0.6780 acc=59.04% f1=69.64% auc=60.12% val_score=45.6694 val_score_bestthr=63.2736 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.030) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 63.2736
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep0_seed4/ckpt_best_fold_4.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4617 mb_mean=0.5124 norm_overlap=1.0000 corr_cb=0.0896 topkJ=0.0788
[TRAIN][ep=001] loss=0.6635 acc=62.15%
[TRAIN][ep=001] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0301
[EPOCH 001/089] train: loss=0.6635 acc=62.15% | val: loss=0.6770 acc=56.63% f1=69.49% auc=61.34% val_score=51.7735 val_score_bestthr=60.9699 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.030) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 60.9699
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4651 mb_mean=0.5120 norm_overlap=1.0000 corr_cb=0.0785 topkJ=0.0875
[TRAIN][ep=002] loss=0.6581 acc=61.07%
[TRAIN][ep=002] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0344
[EPOCH 002/089] train: loss=0.6581 acc=61.07% | val: loss=0.6815 acc=56.63% f1=68.42% auc=59.07% val_score=45.3596 val_score_bestthr=59.6238 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.034) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.6238
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4604 mb_mean=0.5131 norm_overlap=1.0000 corr_cb=0.0074 topkJ=0.0496
[TRAIN][ep=003] loss=0.6514 acc=62.55%
[TRAIN][ep=003] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0360
[EPOCH 003/089] train: loss=0.6514 acc=62.55% | val: loss=0.6898 acc=54.22% f1=68.85% auc=58.43% val_score=40.9798 val_score_bestthr=57.8426 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.036) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 57.8426
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4599 mb_mean=0.5131 norm_overlap=0.9998 corr_cb=-0.3378 topkJ=0.0131
[TRAIN][ep=004] loss=0.6448 acc=62.95%
[TRAIN][ep=004] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0322
[EPOCH 004/089] train: loss=0.6448 acc=62.95% | val: loss=0.6806 acc=56.63% f1=67.86% auc=58.90% val_score=42.0950 val_score_bestthr=58.9924 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.032) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.9924
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4645 mb_mean=0.5123 norm_overlap=1.0000 corr_cb=0.1004 topkJ=0.0686
[TRAIN][ep=005] loss=1.4665 acc=60.94%
[TRAIN][ep=005] mask_avg: mc_mean=0.3512 mb_mean=0.5133 norm_overlap=0.9987 corr_cb=-0.3456
[EPOCH 005/089] train: loss=1.4665 acc=60.94% | val: loss=0.6888 acc=53.01% f1=68.29% auc=58.55% val_score=52.2337 val_score_bestthr=56.7094 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.351, mb=0.513, no=0.999, corr=-0.346) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 56.7094
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2922 mb_mean=0.5091 norm_overlap=0.9982 corr_cb=-0.2962 topkJ=0.0212
[TRAIN][ep=006] loss=1.2259 acc=65.37%
[TRAIN][ep=006] mask_avg: mc_mean=0.2246 mb_mean=0.5133 norm_overlap=0.9966 corr_cb=-0.4092
[EPOCH 006/089] train: loss=1.2259 acc=65.37% | val: loss=0.6770 acc=57.83% f1=69.57% auc=57.79% val_score=47.1417 val_score_bestthr=61.1138 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.225, mb=0.513, no=0.997, corr=-0.409) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 61.1138
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2010 mb_mean=0.5122 norm_overlap=0.9966 corr_cb=-0.3725 topkJ=0.0253
[TRAIN][ep=007] loss=1.0184 acc=64.03%
[TRAIN][ep=007] mask_avg: mc_mean=0.1852 mb_mean=0.5133 norm_overlap=0.9952 corr_cb=-0.4281
[EPOCH 007/089] train: loss=1.0184 acc=64.03% | val: loss=0.7083 acc=57.83% f1=69.57% auc=56.40% val_score=40.6038 val_score_bestthr=59.7138 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.185, mb=0.513, no=0.995, corr=-0.428) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.7138
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1173 mb_mean=0.5155 norm_overlap=0.9962 corr_cb=-0.2352 topkJ=0.0280
[TRAIN][ep=008] loss=0.9677 acc=65.64%
[TRAIN][ep=008] mask_avg: mc_mean=0.1483 mb_mean=0.5133 norm_overlap=0.9930 corr_cb=-0.4375
[EPOCH 008/089] train: loss=0.9677 acc=65.64% | val: loss=0.7056 acc=56.63% f1=68.97% auc=58.02% val_score=54.1330 val_score_bestthr=59.1465 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.148, mb=0.513, no=0.993, corr=-0.438) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.1465
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1686 mb_mean=0.5094 norm_overlap=0.9944 corr_cb=-0.3815 topkJ=0.0171
[TRAIN][ep=009] loss=0.9786 acc=64.56%
[TRAIN][ep=009] mask_avg: mc_mean=0.1382 mb_mean=0.5133 norm_overlap=0.9917 corr_cb=-0.4626
[EPOCH 009/089] train: loss=0.9786 acc=64.56% | val: loss=0.6925 acc=59.04% f1=70.18% auc=57.56% val_score=41.7827 val_score_bestthr=60.8317 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.138, mb=0.513, no=0.992, corr=-0.463) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 60.8317
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1369 mb_mean=0.5127 norm_overlap=0.9912 corr_cb=-0.5017 topkJ=0.0080
[TRAIN][ep=010] loss=0.9688 acc=66.17%
[TRAIN][ep=010] mask_avg: mc_mean=0.1230 mb_mean=0.5133 norm_overlap=0.9898 corr_cb=-0.4734
[EPOCH 010/089] train: loss=0.9688 acc=66.17% | val: loss=0.6874 acc=59.04% f1=70.18% auc=58.20% val_score=43.1744 val_score_bestthr=60.8317 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.123, mb=0.513, no=0.990, corr=-0.473) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 60.8317
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1042 mb_mean=0.5141 norm_overlap=0.9892 corr_cb=-0.4824 topkJ=0.0008
[TRAIN][ep=011] loss=0.9537 acc=68.46%
[TRAIN][ep=011] mask_avg: mc_mean=0.1297 mb_mean=0.5133 norm_overlap=0.9891 corr_cb=-0.4977
[EPOCH 011/089] train: loss=0.9537 acc=68.46% | val: loss=0.7039 acc=59.04% f1=70.18% auc=56.16% val_score=39.8392 val_score_bestthr=60.8317 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.130, mb=0.513, no=0.989, corr=-0.498) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 60.8317
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1771 mb_mean=0.5122 norm_overlap=0.9872 corr_cb=-0.6164 topkJ=0.0016
[TRAIN][ep=012] loss=0.9530 acc=66.71%
[TRAIN][ep=012] mask_avg: mc_mean=0.1276 mb_mean=0.5133 norm_overlap=0.9881 corr_cb=-0.4883
[EPOCH 012/089] train: loss=0.9530 acc=66.71% | val: loss=0.7085 acc=55.42% f1=68.91% auc=57.73% val_score=53.3354 val_score_bestthr=59.9272 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.128, mb=0.513, no=0.988, corr=-0.488) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.9272
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1467 mb_mean=0.5120 norm_overlap=0.9881 corr_cb=-0.5122 topkJ=0.0016
[TRAIN][ep=013] loss=0.9462 acc=67.52%
[TRAIN][ep=013] mask_avg: mc_mean=0.1366 mb_mean=0.5133 norm_overlap=0.9879 corr_cb=-0.5093
[EPOCH 013/089] train: loss=0.9462 acc=67.52% | val: loss=0.6975 acc=57.83% f1=69.57% auc=57.38% val_score=43.6134 val_score_bestthr=59.7138 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.137, mb=0.513, no=0.988, corr=-0.509) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.7138
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1930 mb_mean=0.5110 norm_overlap=0.9803 corr_cb=-0.6697 topkJ=0.0000
[TRAIN][ep=014] loss=0.9252 acc=68.32%
[TRAIN][ep=014] mask_avg: mc_mean=0.1376 mb_mean=0.5133 norm_overlap=0.9870 corr_cb=-0.5016
[EPOCH 014/089] train: loss=0.9252 acc=68.32% | val: loss=0.7357 acc=56.63% f1=68.97% auc=56.69% val_score=35.2960 val_score_bestthr=58.2131 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.138, mb=0.513, no=0.987, corr=-0.502) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.2131
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.0610 mb_mean=0.5172 norm_overlap=0.9822 corr_cb=-0.4732 topkJ=0.0004
[TRAIN][ep=015] loss=0.9252 acc=68.99%
[TRAIN][ep=015] mask_avg: mc_mean=0.1289 mb_mean=0.5133 norm_overlap=0.9861 corr_cb=-0.4896
[EPOCH 015/089] train: loss=0.9252 acc=68.99% | val: loss=0.7106 acc=56.63% f1=68.97% auc=56.98% val_score=42.7306 val_score_bestthr=58.2131 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.129, mb=0.513, no=0.986, corr=-0.490) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.2131
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1355 mb_mean=0.5145 norm_overlap=0.9817 corr_cb=-0.5645 topkJ=0.0012
[TRAIN][ep=016] loss=0.9258 acc=68.05%
[TRAIN][ep=016] mask_avg: mc_mean=0.1452 mb_mean=0.5133 norm_overlap=0.9864 corr_cb=-0.4979
[EPOCH 016/089] train: loss=0.9258 acc=68.05% | val: loss=0.7357 acc=59.04% f1=69.09% auc=57.15% val_score=54.3604 val_score_bestthr=55.6753 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.145, mb=0.513, no=0.986, corr=-0.498) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 55.6753
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1661 mb_mean=0.5136 norm_overlap=0.9853 corr_cb=-0.5536 topkJ=0.0004
[TRAIN][ep=017] loss=0.9073 acc=70.20%
[TRAIN][ep=017] mask_avg: mc_mean=0.1671 mb_mean=0.5133 norm_overlap=0.9875 corr_cb=-0.5086
[EPOCH 017/089] train: loss=0.9073 acc=70.20% | val: loss=0.7339 acc=56.63% f1=68.97% auc=56.86% val_score=35.0726 val_score_bestthr=58.2131 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.167, mb=0.513, no=0.987, corr=-0.509) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.2131
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1165 mb_mean=0.5148 norm_overlap=0.9863 corr_cb=-0.4515 topkJ=0.0017
[TRAIN][ep=018] loss=0.8907 acc=73.02%
[TRAIN][ep=018] mask_avg: mc_mean=0.1592 mb_mean=0.5133 norm_overlap=0.9865 corr_cb=-0.5077
[EPOCH 018/089] train: loss=0.8907 acc=73.02% | val: loss=0.7387 acc=55.42% f1=68.38% auc=56.05% val_score=34.7708 val_score_bestthr=57.3807 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.159, mb=0.513, no=0.987, corr=-0.508) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 57.3807
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1356 mb_mean=0.5144 norm_overlap=0.9875 corr_cb=-0.4994 topkJ=0.0056
[TRAIN][ep=019] loss=0.8825 acc=71.68%
[TRAIN][ep=019] mask_avg: mc_mean=0.1503 mb_mean=0.5133 norm_overlap=0.9861 corr_cb=-0.4926
[EPOCH 019/089] train: loss=0.8825 acc=71.68% | val: loss=0.7886 acc=55.42% f1=67.83% auc=56.92% val_score=49.1298 val_score_bestthr=57.1506 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.150, mb=0.513, no=0.986, corr=-0.493) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 57.1506
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1632 mb_mean=0.5125 norm_overlap=0.9850 corr_cb=-0.5388 topkJ=0.0012
[TRAIN][ep=020] loss=0.8857 acc=71.28%
[TRAIN][ep=020] mask_avg: mc_mean=0.1696 mb_mean=0.5133 norm_overlap=0.9869 corr_cb=-0.4959
[EPOCH 020/089] train: loss=0.8857 acc=71.28% | val: loss=0.7643 acc=56.63% f1=69.49% auc=56.69% val_score=33.3600 val_score_bestthr=59.8699 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.170, mb=0.513, no=0.987, corr=-0.496) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.8699
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.1914 mb_mean=0.5107 norm_overlap=0.9842 corr_cb=-0.5757 topkJ=0.0016
[TRAIN][ep=021] loss=0.8790 acc=71.95%
[TRAIN][ep=021] mask_avg: mc_mean=0.1595 mb_mean=0.5133 norm_overlap=0.9861 corr_cb=-0.5115
[EPOCH 021/089] train: loss=0.8790 acc=71.95% | val: loss=0.7386 acc=55.42% f1=68.91% auc=57.21% val_score=43.0320 val_score_bestthr=59.9272 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.159, mb=0.513, no=0.986, corr=-0.511) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.9272
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1497 mb_mean=0.5140 norm_overlap=0.9936 corr_cb=-0.3193 topkJ=0.0039
[TRAIN][ep=022] loss=0.8610 acc=73.83%
[TRAIN][ep=022] mask_avg: mc_mean=0.1638 mb_mean=0.5133 norm_overlap=0.9858 corr_cb=-0.5267
[EPOCH 022/089] train: loss=0.8610 acc=73.83% | val: loss=0.7678 acc=54.22% f1=69.35% auc=57.91% val_score=43.6067 val_score_bestthr=62.5593 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.164, mb=0.513, no=0.986, corr=-0.527) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 62.5593
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1982 mb_mean=0.5105 norm_overlap=0.9846 corr_cb=-0.5348 topkJ=0.0020
[TRAIN][ep=023] loss=0.8598 acc=72.75%
[TRAIN][ep=023] mask_avg: mc_mean=0.1666 mb_mean=0.5133 norm_overlap=0.9859 corr_cb=-0.5171
[EPOCH 023/089] train: loss=0.8598 acc=72.75% | val: loss=0.7531 acc=56.63% f1=69.49% auc=56.74% val_score=38.5240 val_score_bestthr=59.8699 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.167, mb=0.513, no=0.986, corr=-0.517) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.8699
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1934 mb_mean=0.5126 norm_overlap=0.9866 corr_cb=-0.5160 topkJ=0.0028
[TRAIN][ep=024] loss=0.8419 acc=74.23%
[TRAIN][ep=024] mask_avg: mc_mean=0.1748 mb_mean=0.5133 norm_overlap=0.9862 corr_cb=-0.5198
[EPOCH 024/089] train: loss=0.8419 acc=74.23% | val: loss=0.7608 acc=54.22% f1=68.33% auc=57.33% val_score=46.5430 val_score_bestthr=58.3637 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.175, mb=0.513, no=0.986, corr=-0.520) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.3637
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2098 mb_mean=0.5144 norm_overlap=0.9899 corr_cb=-0.5001 topkJ=0.0040
[TRAIN][ep=025] loss=0.8551 acc=73.02%
[TRAIN][ep=025] mask_avg: mc_mean=0.2106 mb_mean=0.5133 norm_overlap=0.9880 corr_cb=-0.5166
[EPOCH 025/089] train: loss=0.8551 acc=73.02% | val: loss=0.7580 acc=55.42% f1=68.91% auc=57.73% val_score=37.1323 val_score_bestthr=58.3049 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.211, mb=0.513, no=0.988, corr=-0.517) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.3049
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1987 mb_mean=0.5127 norm_overlap=0.9909 corr_cb=-0.4618 topkJ=0.0040
[TRAIN][ep=026] loss=0.8330 acc=73.42%
[TRAIN][ep=026] mask_avg: mc_mean=0.1887 mb_mean=0.5133 norm_overlap=0.9871 corr_cb=-0.5120
[EPOCH 026/089] train: loss=0.8330 acc=73.42% | val: loss=0.7931 acc=55.42% f1=68.38% auc=57.15% val_score=39.1815 val_score_bestthr=57.3807 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.189, mb=0.513, no=0.987, corr=-0.512) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 57.3807
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2171 mb_mean=0.5153 norm_overlap=0.9936 corr_cb=-0.3740 topkJ=0.0157
[TRAIN][ep=027] loss=0.8220 acc=75.17%
[TRAIN][ep=027] mask_avg: mc_mean=0.1980 mb_mean=0.5133 norm_overlap=0.9873 corr_cb=-0.5059
[EPOCH 027/089] train: loss=0.8220 acc=75.17% | val: loss=0.7743 acc=54.22% f1=69.35% auc=57.38% val_score=40.7655 val_score_bestthr=62.5593 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.198, mb=0.513, no=0.987, corr=-0.506) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 62.5593
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1617 mb_mean=0.5149 norm_overlap=0.9854 corr_cb=-0.5218 topkJ=0.0050
[TRAIN][ep=028] loss=0.8189 acc=74.50%
[TRAIN][ep=028] mask_avg: mc_mean=0.2012 mb_mean=0.5133 norm_overlap=0.9875 corr_cb=-0.5107
[EPOCH 028/089] train: loss=0.8189 acc=74.50% | val: loss=0.7863 acc=55.42% f1=68.38% auc=57.15% val_score=41.2721 val_score_bestthr=57.3807 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.201, mb=0.513, no=0.988, corr=-0.511) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 57.3807
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.1492 mb_mean=0.5150 norm_overlap=0.9891 corr_cb=-0.4242 topkJ=0.0055
[TRAIN][ep=029] loss=0.8078 acc=75.17%
[TRAIN][ep=029] mask_avg: mc_mean=0.1871 mb_mean=0.5133 norm_overlap=0.9868 corr_cb=-0.5093
[EPOCH 029/089] train: loss=0.8078 acc=75.17% | val: loss=0.7896 acc=56.63% f1=68.97% auc=56.69% val_score=44.0252 val_score_bestthr=58.8798 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.187, mb=0.513, no=0.987, corr=-0.509) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.8798
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2425 mb_mean=0.5126 norm_overlap=0.9882 corr_cb=-0.5536 topkJ=0.0036
[TRAIN][ep=030] loss=0.8059 acc=76.38%
[TRAIN][ep=030] mask_avg: mc_mean=0.1953 mb_mean=0.5133 norm_overlap=0.9871 corr_cb=-0.5088
[EPOCH 030/089] train: loss=0.8059 acc=76.38% | val: loss=0.7944 acc=55.42% f1=68.38% auc=56.69% val_score=47.8897 val_score_bestthr=57.3807 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.195, mb=0.513, no=0.987, corr=-0.509) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 57.3807
[EARLY STOP] no improvement for 30 epochs. best_epoch=0
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold4_rep0_seed4/ckpt_best_fold_4.pt
=============== FIT DONE ===============
[BEST] epoch=0 | val_acc=59.04% | val_f1=69.64% | val_auc=60.12% | val_score=45.6694 | val_score_bestthr=63.2736
[TEST@BEST] thr_used=0.480 | acc=62.32% f1=68.03% auc=65.40% | SP_sex=17.93% EO_sex=17.51% SP_age=15.31% EO_age=14.38%
[TIME] 0.77 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold4_rep0_seed4/summary_fold_4.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4593 mb_mean=0.5110 norm_overlap=1.0000 corr_cb=0.0210 topkJ=0.1340
[TRAIN][ep=000] loss=0.6955 acc=50.87%
[TRAIN][ep=000] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0304
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4604 mb_mean=0.5129 norm_overlap=1.0000 corr_cb=-0.0341 topkJ=0.0385
[TRAIN][ep=001] loss=0.6935 acc=51.54%
[TRAIN][ep=001] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0340
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4621 mb_mean=0.5138 norm_overlap=0.9999 corr_cb=-0.2061 topkJ=0.0705
[TRAIN][ep=002] loss=0.6917 acc=53.02%
[TRAIN][ep=002] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0391
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4656 mb_mean=0.5133 norm_overlap=0.9999 corr_cb=-0.1525 topkJ=0.0702
[TRAIN][ep=003] loss=0.6899 acc=55.17%
[TRAIN][ep=003] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0291
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4607 mb_mean=0.5127 norm_overlap=1.0000 corr_cb=-0.0560 topkJ=0.0532
[TRAIN][ep=004] loss=0.6878 acc=54.36%
[TRAIN][ep=004] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0333
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4627 mb_mean=0.5146 norm_overlap=1.0000 corr_cb=0.0401 topkJ=0.1020
[TRAIN][ep=005] loss=0.6867 acc=57.05%
[TRAIN][ep=005] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0327
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4643 mb_mean=0.5121 norm_overlap=0.9999 corr_cb=-0.1954 topkJ=0.0265
[TRAIN][ep=006] loss=0.6821 acc=57.85%
[TRAIN][ep=006] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0382
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4600 mb_mean=0.5162 norm_overlap=1.0000 corr_cb=-0.0688 topkJ=0.0382
[TRAIN][ep=007] loss=0.6832 acc=56.91%
[TRAIN][ep=007] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0316
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4601 mb_mean=0.5162 norm_overlap=0.9998 corr_cb=-0.3232 topkJ=0.0124
[TRAIN][ep=008] loss=0.6789 acc=58.66%
[TRAIN][ep=008] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0367
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4657 mb_mean=0.5110 norm_overlap=1.0001 corr_cb=0.2304 topkJ=0.1165
[TRAIN][ep=009] loss=0.6761 acc=57.45%
[TRAIN][ep=009] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0276
================= FIT START (fold=4) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4625 mb_mean=0.5166 norm_overlap=0.9999 corr_cb=-0.1231 topkJ=0.0325
[TRAIN][ep=000] loss=0.6713 acc=62.15%
[TRAIN][ep=000] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0298
[EPOCH 000/089] train: loss=0.6713 acc=62.15% | val: loss=0.6780 acc=59.04% f1=69.64% auc=60.12% val_score=45.6694 val_score_bestthr=63.2736 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.030) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 63.2736
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep0_seed4/ckpt_best_fold_4.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4617 mb_mean=0.5124 norm_overlap=1.0000 corr_cb=0.0896 topkJ=0.0788
[TRAIN][ep=001] loss=0.6635 acc=62.28%
[TRAIN][ep=001] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0301
[EPOCH 001/089] train: loss=0.6635 acc=62.28% | val: loss=0.6770 acc=56.63% f1=69.49% auc=61.34% val_score=51.7735 val_score_bestthr=60.9699 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.030) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 60.9699
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4651 mb_mean=0.5120 norm_overlap=1.0000 corr_cb=0.0785 topkJ=0.0875
[TRAIN][ep=002] loss=0.6581 acc=61.07%
[TRAIN][ep=002] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0344
[EPOCH 002/089] train: loss=0.6581 acc=61.07% | val: loss=0.6814 acc=56.63% f1=64.71% auc=59.13% val_score=45.3596 val_score_bestthr=58.7293 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.034) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.7293
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4604 mb_mean=0.5131 norm_overlap=1.0000 corr_cb=0.0074 topkJ=0.0496
[TRAIN][ep=003] loss=0.6514 acc=62.55%
[TRAIN][ep=003] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0360
[EPOCH 003/089] train: loss=0.6514 acc=62.55% | val: loss=0.6898 acc=54.22% f1=68.85% auc=58.49% val_score=40.9798 val_score_bestthr=57.8426 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.036) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 57.8426
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4599 mb_mean=0.5131 norm_overlap=0.9998 corr_cb=-0.3378 topkJ=0.0131
[TRAIN][ep=004] loss=0.6448 acc=62.95%
[TRAIN][ep=004] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0322
[EPOCH 004/089] train: loss=0.6448 acc=62.95% | val: loss=0.6806 acc=57.83% f1=69.03% auc=58.84% val_score=42.0950 val_score_bestthr=60.7136 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.032) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 60.7136
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4645 mb_mean=0.5123 norm_overlap=1.0000 corr_cb=0.1004 topkJ=0.0686
[TRAIN][ep=005] loss=1.2606 acc=61.21%
[TRAIN][ep=005] mask_avg: mc_mean=0.3512 mb_mean=0.5133 norm_overlap=0.9987 corr_cb=-0.3459
[EPOCH 005/089] train: loss=1.2606 acc=61.21% | val: loss=0.6879 acc=54.22% f1=67.80% auc=58.55% val_score=55.1855 val_score_bestthr=56.4399 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.351, mb=0.513, no=0.999, corr=-0.346) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 56.4399
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2921 mb_mean=0.5091 norm_overlap=0.9982 corr_cb=-0.2968 topkJ=0.0212
[TRAIN][ep=006] loss=1.0253 acc=64.97%
[TRAIN][ep=006] mask_avg: mc_mean=0.2244 mb_mean=0.5133 norm_overlap=0.9966 corr_cb=-0.4095
[EPOCH 006/089] train: loss=1.0253 acc=64.97% | val: loss=0.6769 acc=57.83% f1=69.57% auc=58.02% val_score=43.2957 val_score_bestthr=61.1138 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.224, mb=0.513, no=0.997, corr=-0.409) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 61.1138
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2007 mb_mean=0.5122 norm_overlap=0.9966 corr_cb=-0.3723 topkJ=0.0253
[TRAIN][ep=007] loss=0.8181 acc=63.76%
[TRAIN][ep=007] mask_avg: mc_mean=0.1848 mb_mean=0.5133 norm_overlap=0.9952 corr_cb=-0.4280
[EPOCH 007/089] train: loss=0.8181 acc=63.76% | val: loss=0.7081 acc=57.83% f1=69.57% auc=56.63% val_score=40.6038 val_score_bestthr=59.7138 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.185, mb=0.513, no=0.995, corr=-0.428) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.7138
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1170 mb_mean=0.5155 norm_overlap=0.9962 corr_cb=-0.2350 topkJ=0.0280
[TRAIN][ep=008] loss=0.7678 acc=65.91%
[TRAIN][ep=008] mask_avg: mc_mean=0.1484 mb_mean=0.5133 norm_overlap=0.9930 corr_cb=-0.4372
[EPOCH 008/089] train: loss=0.7678 acc=65.91% | val: loss=0.7056 acc=57.83% f1=70.09% auc=58.02% val_score=54.1330 val_score_bestthr=62.9697 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.148, mb=0.513, no=0.993, corr=-0.437) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 62.9697
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1690 mb_mean=0.5094 norm_overlap=0.9944 corr_cb=-0.3822 topkJ=0.0167
[TRAIN][ep=009] loss=0.7793 acc=64.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.1382 mb_mean=0.5133 norm_overlap=0.9917 corr_cb=-0.4620
[EPOCH 009/089] train: loss=0.7793 acc=64.70% | val: loss=0.6925 acc=59.04% f1=70.18% auc=57.91% val_score=41.7827 val_score_bestthr=60.8317 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.138, mb=0.513, no=0.992, corr=-0.462) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 60.8317
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1368 mb_mean=0.5127 norm_overlap=0.9912 corr_cb=-0.5012 topkJ=0.0080
[TRAIN][ep=010] loss=0.7699 acc=66.17%
[TRAIN][ep=010] mask_avg: mc_mean=0.1232 mb_mean=0.5133 norm_overlap=0.9898 corr_cb=-0.4731
[EPOCH 010/089] train: loss=0.7699 acc=66.17% | val: loss=0.6874 acc=57.83% f1=69.57% auc=57.91% val_score=43.1744 val_score_bestthr=59.7138 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.123, mb=0.513, no=0.990, corr=-0.473) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.7138
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1046 mb_mean=0.5141 norm_overlap=0.9892 corr_cb=-0.4821 topkJ=0.0008
[TRAIN][ep=011] loss=0.7550 acc=68.72%
[TRAIN][ep=011] mask_avg: mc_mean=0.1301 mb_mean=0.5133 norm_overlap=0.9891 corr_cb=-0.4970
[EPOCH 011/089] train: loss=0.7550 acc=68.72% | val: loss=0.7046 acc=59.04% f1=70.18% auc=56.10% val_score=39.8392 val_score_bestthr=60.8317 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.130, mb=0.513, no=0.989, corr=-0.497) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 60.8317
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1778 mb_mean=0.5122 norm_overlap=0.9872 corr_cb=-0.6155 topkJ=0.0016
[TRAIN][ep=012] loss=0.7549 acc=66.58%
[TRAIN][ep=012] mask_avg: mc_mean=0.1282 mb_mean=0.5133 norm_overlap=0.9881 corr_cb=-0.4881
[EPOCH 012/089] train: loss=0.7549 acc=66.58% | val: loss=0.7087 acc=55.42% f1=68.91% auc=57.85% val_score=53.3354 val_score_bestthr=59.9272 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.128, mb=0.513, no=0.988, corr=-0.488) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.9272
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1464 mb_mean=0.5120 norm_overlap=0.9880 corr_cb=-0.5116 topkJ=0.0016
[TRAIN][ep=013] loss=0.7487 acc=67.79%
[TRAIN][ep=013] mask_avg: mc_mean=0.1363 mb_mean=0.5133 norm_overlap=0.9879 corr_cb=-0.5080
[EPOCH 013/089] train: loss=0.7487 acc=67.79% | val: loss=0.6979 acc=56.63% f1=68.97% auc=57.21% val_score=43.6134 val_score_bestthr=58.2131 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.136, mb=0.513, no=0.988, corr=-0.508) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.2131
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1934 mb_mean=0.5110 norm_overlap=0.9803 corr_cb=-0.6697 topkJ=0.0000
[TRAIN][ep=014] loss=0.7289 acc=68.59%
[TRAIN][ep=014] mask_avg: mc_mean=0.1381 mb_mean=0.5133 norm_overlap=0.9871 corr_cb=-0.5009
[EPOCH 014/089] train: loss=0.7289 acc=68.59% | val: loss=0.7363 acc=56.63% f1=68.97% auc=56.74% val_score=35.2960 val_score_bestthr=58.2131 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.138, mb=0.513, no=0.987, corr=-0.501) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.2131
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.0613 mb_mean=0.5172 norm_overlap=0.9822 corr_cb=-0.4731 topkJ=0.0004
[TRAIN][ep=015] loss=0.7290 acc=69.40%
[TRAIN][ep=015] mask_avg: mc_mean=0.1290 mb_mean=0.5133 norm_overlap=0.9861 corr_cb=-0.4888
[EPOCH 015/089] train: loss=0.7290 acc=69.40% | val: loss=0.7110 acc=56.63% f1=68.97% auc=56.92% val_score=42.7306 val_score_bestthr=58.2131 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.129, mb=0.513, no=0.986, corr=-0.489) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.2131
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1360 mb_mean=0.5145 norm_overlap=0.9818 corr_cb=-0.5639 topkJ=0.0012
[TRAIN][ep=016] loss=0.7310 acc=68.05%
[TRAIN][ep=016] mask_avg: mc_mean=0.1460 mb_mean=0.5133 norm_overlap=0.9865 corr_cb=-0.4975
[EPOCH 016/089] train: loss=0.7310 acc=68.05% | val: loss=0.7351 acc=54.22% f1=68.33% auc=57.33% val_score=54.3604 val_score_bestthr=58.3637 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.146, mb=0.513, no=0.986, corr=-0.497) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.3637
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1678 mb_mean=0.5136 norm_overlap=0.9854 corr_cb=-0.5532 topkJ=0.0008
[TRAIN][ep=017] loss=0.7138 acc=70.34%
[TRAIN][ep=017] mask_avg: mc_mean=0.1681 mb_mean=0.5133 norm_overlap=0.9875 corr_cb=-0.5080
[EPOCH 017/089] train: loss=0.7138 acc=70.34% | val: loss=0.7342 acc=56.63% f1=68.97% auc=56.86% val_score=35.0726 val_score_bestthr=58.2131 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.168, mb=0.513, no=0.988, corr=-0.508) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.2131
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1165 mb_mean=0.5148 norm_overlap=0.9863 corr_cb=-0.4510 topkJ=0.0017
[TRAIN][ep=018] loss=0.6994 acc=73.02%
[TRAIN][ep=018] mask_avg: mc_mean=0.1593 mb_mean=0.5133 norm_overlap=0.9866 corr_cb=-0.5072
[EPOCH 018/089] train: loss=0.6994 acc=73.02% | val: loss=0.7392 acc=55.42% f1=68.38% auc=55.87% val_score=34.7708 val_score_bestthr=57.3807 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.159, mb=0.513, no=0.987, corr=-0.507) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 57.3807
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1371 mb_mean=0.5144 norm_overlap=0.9876 corr_cb=-0.5004 topkJ=0.0056
[TRAIN][ep=019] loss=0.6923 acc=71.54%
[TRAIN][ep=019] mask_avg: mc_mean=0.1508 mb_mean=0.5133 norm_overlap=0.9861 corr_cb=-0.4924
[EPOCH 019/089] train: loss=0.6923 acc=71.54% | val: loss=0.7892 acc=55.42% f1=67.83% auc=56.92% val_score=49.1298 val_score_bestthr=57.1506 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.151, mb=0.513, no=0.986, corr=-0.492) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 57.1506
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1628 mb_mean=0.5125 norm_overlap=0.9850 corr_cb=-0.5389 topkJ=0.0012
[TRAIN][ep=020] loss=0.6969 acc=71.28%
[TRAIN][ep=020] mask_avg: mc_mean=0.1696 mb_mean=0.5133 norm_overlap=0.9869 corr_cb=-0.4956
[EPOCH 020/089] train: loss=0.6969 acc=71.28% | val: loss=0.7646 acc=56.63% f1=69.49% auc=56.80% val_score=33.3600 val_score_bestthr=59.8699 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.170, mb=0.513, no=0.987, corr=-0.496) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.8699
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.1922 mb_mean=0.5107 norm_overlap=0.9842 corr_cb=-0.5759 topkJ=0.0016
[TRAIN][ep=021] loss=0.6930 acc=72.21%
[TRAIN][ep=021] mask_avg: mc_mean=0.1600 mb_mean=0.5133 norm_overlap=0.9862 corr_cb=-0.5118
[EPOCH 021/089] train: loss=0.6930 acc=72.21% | val: loss=0.7386 acc=55.42% f1=68.91% auc=57.03% val_score=44.5435 val_score_bestthr=59.9272 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.160, mb=0.513, no=0.986, corr=-0.512) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.9272
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1501 mb_mean=0.5140 norm_overlap=0.9936 corr_cb=-0.3187 topkJ=0.0039
[TRAIN][ep=022] loss=0.6764 acc=73.96%
[TRAIN][ep=022] mask_avg: mc_mean=0.1638 mb_mean=0.5133 norm_overlap=0.9858 corr_cb=-0.5266
[EPOCH 022/089] train: loss=0.6764 acc=73.96% | val: loss=0.7694 acc=54.22% f1=69.35% auc=57.85% val_score=43.2453 val_score_bestthr=62.5593 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.164, mb=0.513, no=0.986, corr=-0.527) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 62.5593
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1984 mb_mean=0.5105 norm_overlap=0.9846 corr_cb=-0.5336 topkJ=0.0020
[TRAIN][ep=023] loss=0.6763 acc=72.75%
[TRAIN][ep=023] mask_avg: mc_mean=0.1671 mb_mean=0.5133 norm_overlap=0.9860 corr_cb=-0.5172
[EPOCH 023/089] train: loss=0.6763 acc=72.75% | val: loss=0.7542 acc=56.63% f1=69.49% auc=56.80% val_score=38.5240 val_score_bestthr=59.8699 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.167, mb=0.513, no=0.986, corr=-0.517) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.8699
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1939 mb_mean=0.5126 norm_overlap=0.9867 corr_cb=-0.5158 topkJ=0.0028
[TRAIN][ep=024] loss=0.6600 acc=74.50%
[TRAIN][ep=024] mask_avg: mc_mean=0.1746 mb_mean=0.5133 norm_overlap=0.9862 corr_cb=-0.5200
[EPOCH 024/089] train: loss=0.6600 acc=74.50% | val: loss=0.7612 acc=54.22% f1=68.33% auc=57.27% val_score=46.5430 val_score_bestthr=58.3637 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.175, mb=0.513, no=0.986, corr=-0.520) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.3637
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2103 mb_mean=0.5144 norm_overlap=0.9899 corr_cb=-0.4992 topkJ=0.0040
[TRAIN][ep=025] loss=0.6758 acc=73.15%
[TRAIN][ep=025] mask_avg: mc_mean=0.2104 mb_mean=0.5133 norm_overlap=0.9880 corr_cb=-0.5168
[EPOCH 025/089] train: loss=0.6758 acc=73.15% | val: loss=0.7577 acc=54.22% f1=68.33% auc=57.85% val_score=36.8913 val_score_bestthr=58.3637 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.210, mb=0.513, no=0.988, corr=-0.517) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.3637
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1988 mb_mean=0.5127 norm_overlap=0.9909 corr_cb=-0.4624 topkJ=0.0044
[TRAIN][ep=026] loss=0.6536 acc=73.56%
[TRAIN][ep=026] mask_avg: mc_mean=0.1881 mb_mean=0.5133 norm_overlap=0.9871 corr_cb=-0.5124
[EPOCH 026/089] train: loss=0.6536 acc=73.56% | val: loss=0.7936 acc=55.42% f1=68.38% auc=57.33% val_score=39.4685 val_score_bestthr=57.3807 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.188, mb=0.513, no=0.987, corr=-0.512) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 57.3807
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2189 mb_mean=0.5153 norm_overlap=0.9937 corr_cb=-0.3751 topkJ=0.0157
[TRAIN][ep=027] loss=0.6431 acc=75.30%
[TRAIN][ep=027] mask_avg: mc_mean=0.1976 mb_mean=0.5133 norm_overlap=0.9873 corr_cb=-0.5059
[EPOCH 027/089] train: loss=0.6431 acc=75.30% | val: loss=0.7754 acc=54.22% f1=69.35% auc=57.56% val_score=40.7655 val_score_bestthr=62.5593 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.198, mb=0.513, no=0.987, corr=-0.506) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 62.5593
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1633 mb_mean=0.5149 norm_overlap=0.9855 corr_cb=-0.5210 topkJ=0.0050
[TRAIN][ep=028] loss=0.6394 acc=74.23%
[TRAIN][ep=028] mask_avg: mc_mean=0.2015 mb_mean=0.5133 norm_overlap=0.9875 corr_cb=-0.5107
[EPOCH 028/089] train: loss=0.6394 acc=74.23% | val: loss=0.7886 acc=54.22% f1=69.35% auc=57.33% val_score=42.1320 val_score_bestthr=62.5593 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.201, mb=0.513, no=0.988, corr=-0.511) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 62.5593
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.1478 mb_mean=0.5150 norm_overlap=0.9889 corr_cb=-0.4257 topkJ=0.0055
[TRAIN][ep=029] loss=0.6321 acc=74.90%
[TRAIN][ep=029] mask_avg: mc_mean=0.1857 mb_mean=0.5133 norm_overlap=0.9867 corr_cb=-0.5091
[EPOCH 029/089] train: loss=0.6321 acc=74.90% | val: loss=0.7920 acc=56.63% f1=68.97% auc=56.69% val_score=44.0252 val_score_bestthr=58.8798 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.186, mb=0.513, no=0.987, corr=-0.509) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.8798
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2428 mb_mean=0.5126 norm_overlap=0.9882 corr_cb=-0.5530 topkJ=0.0032
[TRAIN][ep=030] loss=0.6311 acc=76.11%
[TRAIN][ep=030] mask_avg: mc_mean=0.1951 mb_mean=0.5133 norm_overlap=0.9871 corr_cb=-0.5091
[EPOCH 030/089] train: loss=0.6311 acc=76.11% | val: loss=0.7962 acc=55.42% f1=68.38% auc=56.69% val_score=49.9192 val_score_bestthr=57.3807 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.195, mb=0.513, no=0.987, corr=-0.509) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 57.3807
[EARLY STOP] no improvement for 30 epochs. best_epoch=0
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold4_rep0_seed4/ckpt_best_fold_4.pt
=============== FIT DONE ===============
[BEST] epoch=0 | val_acc=59.04% | val_f1=69.64% | val_auc=60.12% | val_score=45.6694 | val_score_bestthr=63.2736
[TEST@BEST] thr_used=0.480 | acc=62.32% f1=68.03% auc=65.40% | SP_sex=17.93% EO_sex=17.51% SP_age=15.31% EO_age=14.38%
[TIME] 0.80 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold4_rep0_seed4/summary_fold_4.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4593 mb_mean=0.5110 norm_overlap=1.0000 corr_cb=0.0210 topkJ=0.1340
[TRAIN][ep=000] loss=0.6955 acc=50.87%
[TRAIN][ep=000] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0304
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4604 mb_mean=0.5129 norm_overlap=1.0000 corr_cb=-0.0341 topkJ=0.0385
[TRAIN][ep=001] loss=0.6935 acc=51.54%
[TRAIN][ep=001] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0340
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4621 mb_mean=0.5138 norm_overlap=0.9999 corr_cb=-0.2061 topkJ=0.0705
[TRAIN][ep=002] loss=0.6917 acc=53.02%
[TRAIN][ep=002] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0391
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4656 mb_mean=0.5133 norm_overlap=0.9999 corr_cb=-0.1525 topkJ=0.0702
[TRAIN][ep=003] loss=0.6899 acc=55.17%
[TRAIN][ep=003] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0291
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4607 mb_mean=0.5127 norm_overlap=1.0000 corr_cb=-0.0560 topkJ=0.0532
[TRAIN][ep=004] loss=0.6878 acc=54.36%
[TRAIN][ep=004] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0333
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4627 mb_mean=0.5146 norm_overlap=1.0000 corr_cb=0.0401 topkJ=0.1020
[TRAIN][ep=005] loss=0.6867 acc=57.05%
[TRAIN][ep=005] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0327
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4643 mb_mean=0.5121 norm_overlap=0.9999 corr_cb=-0.1954 topkJ=0.0265
[TRAIN][ep=006] loss=0.6821 acc=57.85%
[TRAIN][ep=006] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0382
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4600 mb_mean=0.5162 norm_overlap=1.0000 corr_cb=-0.0688 topkJ=0.0382
[TRAIN][ep=007] loss=0.6832 acc=56.91%
[TRAIN][ep=007] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0316
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4601 mb_mean=0.5162 norm_overlap=0.9998 corr_cb=-0.3232 topkJ=0.0124
[TRAIN][ep=008] loss=0.6789 acc=58.66%
[TRAIN][ep=008] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0367
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4657 mb_mean=0.5110 norm_overlap=1.0001 corr_cb=0.2304 topkJ=0.1165
[TRAIN][ep=009] loss=0.6761 acc=57.45%
[TRAIN][ep=009] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0276
================= FIT START (fold=4) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4625 mb_mean=0.5166 norm_overlap=0.9999 corr_cb=-0.1231 topkJ=0.0325
[TRAIN][ep=000] loss=0.6713 acc=62.15%
[TRAIN][ep=000] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0298
[EPOCH 000/089] train: loss=0.6713 acc=62.15% | val: loss=0.6780 acc=59.04% f1=69.64% auc=60.12% val_score=45.6694 val_score_bestthr=63.2736 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.030) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 63.2736
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep0_seed4/ckpt_best_fold_4.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4617 mb_mean=0.5124 norm_overlap=1.0000 corr_cb=0.0896 topkJ=0.0788
[TRAIN][ep=001] loss=0.6635 acc=62.15%
[TRAIN][ep=001] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0301
[EPOCH 001/089] train: loss=0.6635 acc=62.15% | val: loss=0.6770 acc=57.83% f1=70.09% auc=61.28% val_score=51.7735 val_score_bestthr=60.1638 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.030) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 60.1638
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4651 mb_mean=0.5120 norm_overlap=1.0000 corr_cb=0.0785 topkJ=0.0875
[TRAIN][ep=002] loss=0.6581 acc=61.07%
[TRAIN][ep=002] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0344
[EPOCH 002/089] train: loss=0.6581 acc=61.07% | val: loss=0.6814 acc=56.63% f1=64.71% auc=59.13% val_score=45.3596 val_score_bestthr=58.7293 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.034) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.7293
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4604 mb_mean=0.5131 norm_overlap=1.0000 corr_cb=0.0074 topkJ=0.0496
[TRAIN][ep=003] loss=0.6514 acc=62.55%
[TRAIN][ep=003] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0360
[EPOCH 003/089] train: loss=0.6514 acc=62.55% | val: loss=0.6898 acc=54.22% f1=68.85% auc=58.43% val_score=40.9798 val_score_bestthr=57.8426 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.036) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 57.8426
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4599 mb_mean=0.5131 norm_overlap=0.9998 corr_cb=-0.3378 topkJ=0.0131
[TRAIN][ep=004] loss=0.6448 acc=62.82%
[TRAIN][ep=004] mask_avg: mc_mean=0.4628 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=-0.0322
[EPOCH 004/089] train: loss=0.6448 acc=62.82% | val: loss=0.6806 acc=56.63% f1=67.86% auc=59.01% val_score=42.0950 val_score_bestthr=58.9924 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.463, mb=0.513, no=1.000, corr=-0.032) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.9924
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4645 mb_mean=0.5123 norm_overlap=1.0000 corr_cb=0.1004 topkJ=0.0686
[TRAIN][ep=005] loss=1.3768 acc=60.94%
[TRAIN][ep=005] mask_avg: mc_mean=0.3509 mb_mean=0.5133 norm_overlap=0.9987 corr_cb=-0.3456
[EPOCH 005/089] train: loss=1.3768 acc=60.94% | val: loss=0.6891 acc=53.01% f1=68.29% auc=58.49% val_score=52.2337 val_score_bestthr=56.7094 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.351, mb=0.513, no=0.999, corr=-0.346) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 56.7094
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2920 mb_mean=0.5091 norm_overlap=0.9982 corr_cb=-0.2962 topkJ=0.0212
[TRAIN][ep=006] loss=1.1443 acc=65.37%
[TRAIN][ep=006] mask_avg: mc_mean=0.2244 mb_mean=0.5133 norm_overlap=0.9966 corr_cb=-0.4094
[EPOCH 006/089] train: loss=1.1443 acc=65.37% | val: loss=0.6770 acc=57.83% f1=69.57% auc=57.85% val_score=47.1417 val_score_bestthr=61.1138 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.224, mb=0.513, no=0.997, corr=-0.409) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 61.1138
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2010 mb_mean=0.5122 norm_overlap=0.9966 corr_cb=-0.3734 topkJ=0.0253
[TRAIN][ep=007] loss=0.9427 acc=64.03%
[TRAIN][ep=007] mask_avg: mc_mean=0.1851 mb_mean=0.5133 norm_overlap=0.9952 corr_cb=-0.4283
[EPOCH 007/089] train: loss=0.9427 acc=64.03% | val: loss=0.7083 acc=57.83% f1=69.57% auc=56.45% val_score=40.6038 val_score_bestthr=59.7138 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.185, mb=0.513, no=0.995, corr=-0.428) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.7138
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1174 mb_mean=0.5155 norm_overlap=0.9962 corr_cb=-0.2354 topkJ=0.0276
[TRAIN][ep=008] loss=0.8951 acc=65.64%
[TRAIN][ep=008] mask_avg: mc_mean=0.1484 mb_mean=0.5133 norm_overlap=0.9930 corr_cb=-0.4376
[EPOCH 008/089] train: loss=0.8951 acc=65.64% | val: loss=0.7057 acc=56.63% f1=68.97% auc=58.08% val_score=54.1330 val_score_bestthr=59.1465 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.148, mb=0.513, no=0.993, corr=-0.438) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.1465
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1686 mb_mean=0.5094 norm_overlap=0.9944 corr_cb=-0.3815 topkJ=0.0171
[TRAIN][ep=009] loss=0.9063 acc=64.43%
[TRAIN][ep=009] mask_avg: mc_mean=0.1383 mb_mean=0.5133 norm_overlap=0.9917 corr_cb=-0.4627
[EPOCH 009/089] train: loss=0.9063 acc=64.43% | val: loss=0.6924 acc=59.04% f1=70.18% auc=57.56% val_score=41.7827 val_score_bestthr=60.8317 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.138, mb=0.513, no=0.992, corr=-0.463) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 60.8317
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1371 mb_mean=0.5127 norm_overlap=0.9912 corr_cb=-0.5019 topkJ=0.0080
[TRAIN][ep=010] loss=0.8968 acc=66.17%
[TRAIN][ep=010] mask_avg: mc_mean=0.1234 mb_mean=0.5133 norm_overlap=0.9898 corr_cb=-0.4737
[EPOCH 010/089] train: loss=0.8968 acc=66.17% | val: loss=0.6873 acc=59.04% f1=70.18% auc=58.20% val_score=43.1744 val_score_bestthr=60.8317 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.123, mb=0.513, no=0.990, corr=-0.474) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 60.8317
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1044 mb_mean=0.5141 norm_overlap=0.9892 corr_cb=-0.4826 topkJ=0.0008
[TRAIN][ep=011] loss=0.8819 acc=68.59%
[TRAIN][ep=011] mask_avg: mc_mean=0.1300 mb_mean=0.5133 norm_overlap=0.9891 corr_cb=-0.4978
[EPOCH 011/089] train: loss=0.8819 acc=68.59% | val: loss=0.7040 acc=59.04% f1=70.18% auc=56.10% val_score=39.8392 val_score_bestthr=60.8317 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.130, mb=0.513, no=0.989, corr=-0.498) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 60.8317
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1777 mb_mean=0.5122 norm_overlap=0.9872 corr_cb=-0.6168 topkJ=0.0016
[TRAIN][ep=012] loss=0.8814 acc=66.58%
[TRAIN][ep=012] mask_avg: mc_mean=0.1282 mb_mean=0.5133 norm_overlap=0.9881 corr_cb=-0.4888
[EPOCH 012/089] train: loss=0.8814 acc=66.58% | val: loss=0.7085 acc=55.42% f1=68.91% auc=57.73% val_score=53.3354 val_score_bestthr=59.9272 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.128, mb=0.513, no=0.988, corr=-0.489) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.9272
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1475 mb_mean=0.5120 norm_overlap=0.9881 corr_cb=-0.5126 topkJ=0.0016
[TRAIN][ep=013] loss=0.8752 acc=67.65%
[TRAIN][ep=013] mask_avg: mc_mean=0.1376 mb_mean=0.5133 norm_overlap=0.9880 corr_cb=-0.5097
[EPOCH 013/089] train: loss=0.8752 acc=67.65% | val: loss=0.6977 acc=57.83% f1=69.57% auc=57.38% val_score=43.6134 val_score_bestthr=59.7138 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.138, mb=0.513, no=0.988, corr=-0.510) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.7138
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1939 mb_mean=0.5110 norm_overlap=0.9803 corr_cb=-0.6702 topkJ=0.0000
[TRAIN][ep=014] loss=0.8548 acc=68.32%
[TRAIN][ep=014] mask_avg: mc_mean=0.1380 mb_mean=0.5133 norm_overlap=0.9871 corr_cb=-0.5023
[EPOCH 014/089] train: loss=0.8548 acc=68.32% | val: loss=0.7359 acc=56.63% f1=68.97% auc=56.69% val_score=35.2960 val_score_bestthr=58.2131 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.138, mb=0.513, no=0.987, corr=-0.502) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.2131
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.0615 mb_mean=0.5172 norm_overlap=0.9823 corr_cb=-0.4747 topkJ=0.0004
[TRAIN][ep=015] loss=0.8550 acc=68.99%
[TRAIN][ep=015] mask_avg: mc_mean=0.1291 mb_mean=0.5133 norm_overlap=0.9861 corr_cb=-0.4907
[EPOCH 015/089] train: loss=0.8550 acc=68.99% | val: loss=0.7104 acc=56.63% f1=68.97% auc=57.03% val_score=42.7306 val_score_bestthr=58.2131 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.129, mb=0.513, no=0.986, corr=-0.491) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.2131
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1358 mb_mean=0.5145 norm_overlap=0.9817 corr_cb=-0.5657 topkJ=0.0012
[TRAIN][ep=016] loss=0.8565 acc=68.05%
[TRAIN][ep=016] mask_avg: mc_mean=0.1460 mb_mean=0.5133 norm_overlap=0.9864 corr_cb=-0.4994
[EPOCH 016/089] train: loss=0.8565 acc=68.05% | val: loss=0.7354 acc=59.04% f1=69.09% auc=57.09% val_score=54.3604 val_score_bestthr=55.6753 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.146, mb=0.513, no=0.986, corr=-0.499) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 55.6753
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1674 mb_mean=0.5136 norm_overlap=0.9853 corr_cb=-0.5555 topkJ=0.0004
[TRAIN][ep=017] loss=0.8387 acc=70.07%
[TRAIN][ep=017] mask_avg: mc_mean=0.1678 mb_mean=0.5133 norm_overlap=0.9875 corr_cb=-0.5103
[EPOCH 017/089] train: loss=0.8387 acc=70.07% | val: loss=0.7341 acc=56.63% f1=68.97% auc=56.80% val_score=35.0726 val_score_bestthr=58.2131 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.168, mb=0.513, no=0.988, corr=-0.510) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.2131
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1173 mb_mean=0.5148 norm_overlap=0.9864 corr_cb=-0.4524 topkJ=0.0017
[TRAIN][ep=018] loss=0.8235 acc=72.89%
[TRAIN][ep=018] mask_avg: mc_mean=0.1597 mb_mean=0.5133 norm_overlap=0.9866 corr_cb=-0.5089
[EPOCH 018/089] train: loss=0.8235 acc=72.89% | val: loss=0.7390 acc=55.42% f1=68.38% auc=55.99% val_score=34.7708 val_score_bestthr=57.3807 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.160, mb=0.513, no=0.987, corr=-0.509) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 57.3807
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1356 mb_mean=0.5144 norm_overlap=0.9875 corr_cb=-0.4999 topkJ=0.0056
[TRAIN][ep=019] loss=0.8158 acc=71.54%
[TRAIN][ep=019] mask_avg: mc_mean=0.1503 mb_mean=0.5133 norm_overlap=0.9861 corr_cb=-0.4931
[EPOCH 019/089] train: loss=0.8158 acc=71.54% | val: loss=0.7891 acc=55.42% f1=67.83% auc=56.92% val_score=49.1298 val_score_bestthr=57.1506 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.150, mb=0.513, no=0.986, corr=-0.493) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 57.1506
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1631 mb_mean=0.5125 norm_overlap=0.9850 corr_cb=-0.5390 topkJ=0.0012
[TRAIN][ep=020] loss=0.8200 acc=71.28%
[TRAIN][ep=020] mask_avg: mc_mean=0.1698 mb_mean=0.5133 norm_overlap=0.9870 corr_cb=-0.4964
[EPOCH 020/089] train: loss=0.8200 acc=71.28% | val: loss=0.7644 acc=56.63% f1=69.49% auc=56.86% val_score=33.3600 val_score_bestthr=59.8699 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.170, mb=0.513, no=0.987, corr=-0.496) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.8699
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.1922 mb_mean=0.5107 norm_overlap=0.9842 corr_cb=-0.5764 topkJ=0.0016
[TRAIN][ep=021] loss=0.8148 acc=71.81%
[TRAIN][ep=021] mask_avg: mc_mean=0.1596 mb_mean=0.5133 norm_overlap=0.9861 corr_cb=-0.5126
[EPOCH 021/089] train: loss=0.8148 acc=71.81% | val: loss=0.7382 acc=55.42% f1=68.91% auc=57.09% val_score=43.0320 val_score_bestthr=59.9272 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.160, mb=0.513, no=0.986, corr=-0.513) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.9272
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1497 mb_mean=0.5140 norm_overlap=0.9936 corr_cb=-0.3208 topkJ=0.0035
[TRAIN][ep=022] loss=0.7971 acc=73.83%
[TRAIN][ep=022] mask_avg: mc_mean=0.1640 mb_mean=0.5133 norm_overlap=0.9858 corr_cb=-0.5280
[EPOCH 022/089] train: loss=0.7971 acc=73.83% | val: loss=0.7670 acc=54.22% f1=69.35% auc=57.91% val_score=43.6067 val_score_bestthr=62.5593 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.164, mb=0.513, no=0.986, corr=-0.528) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 62.5593
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1991 mb_mean=0.5105 norm_overlap=0.9846 corr_cb=-0.5370 topkJ=0.0020
[TRAIN][ep=023] loss=0.7961 acc=72.89%
[TRAIN][ep=023] mask_avg: mc_mean=0.1671 mb_mean=0.5133 norm_overlap=0.9859 corr_cb=-0.5187
[EPOCH 023/089] train: loss=0.7961 acc=72.89% | val: loss=0.7532 acc=56.63% f1=69.49% auc=56.86% val_score=38.5240 val_score_bestthr=59.8699 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.167, mb=0.513, no=0.986, corr=-0.519) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 59.8699
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1943 mb_mean=0.5126 norm_overlap=0.9867 corr_cb=-0.5179 topkJ=0.0028
[TRAIN][ep=024] loss=0.7786 acc=74.23%
[TRAIN][ep=024] mask_avg: mc_mean=0.1748 mb_mean=0.5133 norm_overlap=0.9862 corr_cb=-0.5214
[EPOCH 024/089] train: loss=0.7786 acc=74.23% | val: loss=0.7606 acc=54.22% f1=68.33% auc=57.33% val_score=46.5430 val_score_bestthr=58.3637 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.175, mb=0.513, no=0.986, corr=-0.521) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.3637
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2102 mb_mean=0.5144 norm_overlap=0.9899 corr_cb=-0.5019 topkJ=0.0040
[TRAIN][ep=025] loss=0.7924 acc=72.89%
[TRAIN][ep=025] mask_avg: mc_mean=0.2102 mb_mean=0.5133 norm_overlap=0.9880 corr_cb=-0.5184
[EPOCH 025/089] train: loss=0.7924 acc=72.89% | val: loss=0.7579 acc=55.42% f1=68.91% auc=57.79% val_score=34.0832 val_score_bestthr=58.3049 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.210, mb=0.513, no=0.988, corr=-0.518) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.3049
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1992 mb_mean=0.5127 norm_overlap=0.9909 corr_cb=-0.4644 topkJ=0.0040
[TRAIN][ep=026] loss=0.7704 acc=73.56%
[TRAIN][ep=026] mask_avg: mc_mean=0.1887 mb_mean=0.5133 norm_overlap=0.9871 corr_cb=-0.5139
[EPOCH 026/089] train: loss=0.7704 acc=73.56% | val: loss=0.7927 acc=55.42% f1=68.38% auc=57.27% val_score=39.4685 val_score_bestthr=57.3807 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.189, mb=0.513, no=0.987, corr=-0.514) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 57.3807
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2177 mb_mean=0.5153 norm_overlap=0.9936 corr_cb=-0.3763 topkJ=0.0157
[TRAIN][ep=027] loss=0.7595 acc=75.03%
[TRAIN][ep=027] mask_avg: mc_mean=0.1986 mb_mean=0.5133 norm_overlap=0.9873 corr_cb=-0.5077
[EPOCH 027/089] train: loss=0.7595 acc=75.03% | val: loss=0.7742 acc=54.22% f1=69.35% auc=57.44% val_score=40.7655 val_score_bestthr=62.5593 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.199, mb=0.513, no=0.987, corr=-0.508) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 62.5593
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1633 mb_mean=0.5149 norm_overlap=0.9855 corr_cb=-0.5229 topkJ=0.0050
[TRAIN][ep=028] loss=0.7565 acc=74.36%
[TRAIN][ep=028] mask_avg: mc_mean=0.2021 mb_mean=0.5133 norm_overlap=0.9875 corr_cb=-0.5125
[EPOCH 028/089] train: loss=0.7565 acc=74.36% | val: loss=0.7859 acc=54.22% f1=69.35% auc=57.27% val_score=41.2721 val_score_bestthr=62.5593 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.202, mb=0.513, no=0.988, corr=-0.512) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 62.5593
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.1493 mb_mean=0.5150 norm_overlap=0.9890 corr_cb=-0.4261 topkJ=0.0055
[TRAIN][ep=029] loss=0.7463 acc=75.03%
[TRAIN][ep=029] mask_avg: mc_mean=0.1872 mb_mean=0.5133 norm_overlap=0.9868 corr_cb=-0.5107
[EPOCH 029/089] train: loss=0.7463 acc=75.03% | val: loss=0.7900 acc=56.63% f1=68.97% auc=56.74% val_score=44.0252 val_score_bestthr=58.8798 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.187, mb=0.513, no=0.987, corr=-0.511) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 58.8798
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2433 mb_mean=0.5126 norm_overlap=0.9882 corr_cb=-0.5546 topkJ=0.0036
[TRAIN][ep=030] loss=0.7441 acc=76.24%
[TRAIN][ep=030] mask_avg: mc_mean=0.1956 mb_mean=0.5133 norm_overlap=0.9871 corr_cb=-0.5102
[EPOCH 030/089] train: loss=0.7441 acc=76.24% | val: loss=0.7951 acc=55.42% f1=68.38% auc=56.69% val_score=47.8897 val_score_bestthr=57.3807 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.196, mb=0.513, no=0.987, corr=-0.510) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2736 -> 57.3807
[EARLY STOP] no improvement for 30 epochs. best_epoch=0
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold4_rep0_seed4/ckpt_best_fold_4.pt
=============== FIT DONE ===============
[BEST] epoch=0 | val_acc=59.04% | val_f1=69.64% | val_auc=60.12% | val_score=45.6694 | val_score_bestthr=63.2736
[TEST@BEST] thr_used=0.480 | acc=62.32% f1=68.03% auc=65.44% | SP_sex=17.93% EO_sex=17.51% SP_age=15.31% EO_age=14.38%
[TIME] 0.76 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold4_rep0_seed4/summary_fold_4.json
