[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5042 mb_mean=0.5040 norm_overlap=1.0001 corr_cb=0.1951 topkJ=0.1574
[TRAIN][ep=000] loss=0.6947 acc=50.47%
[TRAIN][ep=000] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0819
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5061 mb_mean=0.5005 norm_overlap=1.0000 corr_cb=0.1183 topkJ=0.0577
[TRAIN][ep=001] loss=0.6933 acc=50.34%
[TRAIN][ep=001] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0801
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5044 mb_mean=0.5040 norm_overlap=1.0000 corr_cb=0.0722 topkJ=0.0959
[TRAIN][ep=002] loss=0.6923 acc=53.42%
[TRAIN][ep=002] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0784
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5035 mb_mean=0.4968 norm_overlap=1.0002 corr_cb=0.3148 topkJ=0.1021
[TRAIN][ep=003] loss=0.6912 acc=51.68%
[TRAIN][ep=003] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0800
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5044 mb_mean=0.5048 norm_overlap=1.0001 corr_cb=0.2160 topkJ=0.0656
[TRAIN][ep=004] loss=0.6907 acc=54.90%
[TRAIN][ep=004] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0800
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5067 mb_mean=0.5067 norm_overlap=1.0001 corr_cb=0.1932 topkJ=0.0734
[TRAIN][ep=005] loss=0.6897 acc=54.50%
[TRAIN][ep=005] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0823
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5065 mb_mean=0.5067 norm_overlap=1.0000 corr_cb=-0.0363 topkJ=0.1013
[TRAIN][ep=006] loss=0.6889 acc=56.11%
[TRAIN][ep=006] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0796
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5062 mb_mean=0.5019 norm_overlap=1.0001 corr_cb=0.3117 topkJ=0.2049
[TRAIN][ep=007] loss=0.6891 acc=56.64%
[TRAIN][ep=007] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0800
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5025 mb_mean=0.5033 norm_overlap=1.0000 corr_cb=-0.0452 topkJ=0.0691
[TRAIN][ep=008] loss=0.6871 acc=59.06%
[TRAIN][ep=008] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0804
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5034 mb_mean=0.5057 norm_overlap=1.0001 corr_cb=0.1863 topkJ=0.0624
[TRAIN][ep=009] loss=0.6862 acc=58.26%
[TRAIN][ep=009] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0876
================= FIT START (fold=3) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5055 mb_mean=0.5024 norm_overlap=0.9999 corr_cb=-0.0929 topkJ=0.0409
[TRAIN][ep=000] loss=0.6856 acc=58.26%
[TRAIN][ep=000] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0802
[EPOCH 000/089] train: loss=0.6856 acc=58.26% | val: loss=0.6925 acc=54.22% f1=69.35% auc=50.87% val_score=39.5069 val_score_bestthr=62.6702 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.080) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 62.6702
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5046 mb_mean=0.4991 norm_overlap=1.0000 corr_cb=0.0132 topkJ=0.0779
[TRAIN][ep=001] loss=0.6844 acc=57.18%
[TRAIN][ep=001] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0802
[EPOCH 001/089] train: loss=0.6844 acc=57.18% | val: loss=0.6913 acc=56.63% f1=69.49% auc=52.03% val_score=45.5913 val_score_bestthr=58.3172 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.080) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6702 -> 58.3172
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5047 mb_mean=0.5037 norm_overlap=1.0002 corr_cb=0.2934 topkJ=0.0559
[TRAIN][ep=002] loss=0.6831 acc=59.73%
[TRAIN][ep=002] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0808
[EPOCH 002/089] train: loss=0.6831 acc=59.73% | val: loss=0.6900 acc=59.04% f1=71.19% auc=53.14% val_score=48.0497 val_score_bestthr=62.6144 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.081) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6702 -> 62.6144
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5066 mb_mean=0.5041 norm_overlap=1.0001 corr_cb=0.1759 topkJ=0.1404
[TRAIN][ep=003] loss=0.6824 acc=56.51%
[TRAIN][ep=003] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0798
[EPOCH 003/089] train: loss=0.6824 acc=56.51% | val: loss=0.6950 acc=55.42% f1=69.42% auc=49.01% val_score=36.2637 val_score_bestthr=60.1357 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.080) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6702 -> 60.1357
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5061 mb_mean=0.5050 norm_overlap=1.0000 corr_cb=0.0586 topkJ=0.0847
[TRAIN][ep=004] loss=0.6796 acc=60.40%
[TRAIN][ep=004] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0832
[EPOCH 004/089] train: loss=0.6796 acc=60.40% | val: loss=0.6885 acc=59.04% f1=71.67% auc=55.06% val_score=51.9285 val_score_bestthr=66.8919 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.083) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 62.6702 -> 66.8919
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5043 mb_mean=0.5027 norm_overlap=1.0001 corr_cb=0.2297 topkJ=0.0605
[TRAIN][ep=005] loss=1.2658 acc=59.19%
[TRAIN][ep=005] mask_avg: mc_mean=0.3901 mb_mean=0.5029 norm_overlap=1.0019 corr_cb=0.5896
[EPOCH 005/089] train: loss=1.2658 acc=59.19% | val: loss=0.6887 acc=57.83% f1=71.07% auc=54.65% val_score=47.3777 val_score_bestthr=66.6666 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.390, mb=0.503, no=1.002, corr=0.590) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.8919 -> 66.6666
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.3125 mb_mean=0.5054 norm_overlap=1.0015 corr_cb=0.4337 topkJ=0.1844
[TRAIN][ep=006] loss=1.2589 acc=59.19%
[TRAIN][ep=006] mask_avg: mc_mean=0.2893 mb_mean=0.5029 norm_overlap=1.0038 corr_cb=0.5978
[EPOCH 006/089] train: loss=1.2589 acc=59.19% | val: loss=0.6904 acc=56.63% f1=70.00% auc=53.31% val_score=45.5913 val_score_bestthr=61.8212 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.289, mb=0.503, no=1.004, corr=0.598) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.8919 -> 61.8212
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2688 mb_mean=0.5008 norm_overlap=1.0029 corr_cb=0.5515 topkJ=0.2460
[TRAIN][ep=007] loss=1.2577 acc=61.61%
[TRAIN][ep=007] mask_avg: mc_mean=0.2751 mb_mean=0.5029 norm_overlap=1.0038 corr_cb=0.5424
[EPOCH 007/089] train: loss=1.2577 acc=61.61% | val: loss=0.6909 acc=57.83% f1=69.57% auc=53.08% val_score=45.5913 val_score_bestthr=59.9526 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.275, mb=0.503, no=1.004, corr=0.542) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.8919 -> 59.9526
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2502 mb_mean=0.4971 norm_overlap=1.0063 corr_cb=0.6884 topkJ=0.2124
[TRAIN][ep=008] loss=1.2578 acc=57.58%
[TRAIN][ep=008] mask_avg: mc_mean=0.2687 mb_mean=0.5029 norm_overlap=1.0036 corr_cb=0.4767
[EPOCH 008/089] train: loss=1.2578 acc=57.58% | val: loss=0.6906 acc=59.04% f1=70.18% auc=53.72% val_score=45.5913 val_score_bestthr=59.4963 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.269, mb=0.503, no=1.004, corr=0.477) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.8919 -> 59.4963
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2331 mb_mean=0.4964 norm_overlap=1.0030 corr_cb=0.4740 topkJ=0.2059
[TRAIN][ep=009] loss=1.2517 acc=61.88%
[TRAIN][ep=009] mask_avg: mc_mean=0.2629 mb_mean=0.5029 norm_overlap=1.0032 corr_cb=0.4007
[EPOCH 009/089] train: loss=1.2517 acc=61.88% | val: loss=0.6923 acc=57.83% f1=69.03% auc=52.73% val_score=44.2330 val_score_bestthr=60.2469 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.263, mb=0.503, no=1.003, corr=0.401) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.8919 -> 60.2469
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.2715 mb_mean=0.5031 norm_overlap=1.0027 corr_cb=0.3197 topkJ=0.1456
[TRAIN][ep=010] loss=1.0085 acc=60.00%
[TRAIN][ep=010] mask_avg: mc_mean=0.2560 mb_mean=0.5029 norm_overlap=1.0028 corr_cb=0.3178
[EPOCH 010/089] train: loss=1.0085 acc=60.00% | val: loss=0.6933 acc=59.04% f1=70.18% auc=52.67% val_score=39.2585 val_score_bestthr=59.4963 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.256, mb=0.503, no=1.003, corr=0.318) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.8919 -> 59.4963
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.2758 mb_mean=0.5027 norm_overlap=1.0016 corr_cb=0.2113 topkJ=0.0631
[TRAIN][ep=011] loss=0.7639 acc=63.09%
[TRAIN][ep=011] mask_avg: mc_mean=0.2475 mb_mean=0.5029 norm_overlap=1.0023 corr_cb=0.2183
[EPOCH 011/089] train: loss=0.7639 acc=63.09% | val: loss=0.7050 acc=57.83% f1=69.57% auc=49.42% val_score=36.6302 val_score_bestthr=57.8371 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.247, mb=0.503, no=1.002, corr=0.218) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.8919 -> 57.8371
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.2805 mb_mean=0.5058 norm_overlap=1.0012 corr_cb=0.1334 topkJ=0.0743
[TRAIN][ep=012] loss=0.7055 acc=62.95%
[TRAIN][ep=012] mask_avg: mc_mean=0.2434 mb_mean=0.5029 norm_overlap=1.0018 corr_cb=0.1462
[EPOCH 012/089] train: loss=0.7055 acc=62.95% | val: loss=0.6916 acc=59.04% f1=71.67% auc=54.53% val_score=47.0243 val_score_bestthr=67.2030 | dyn(w_pfs=0.090, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.243, mb=0.503, no=1.002, corr=0.146) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 66.8919 -> 67.2030
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.2597 mb_mean=0.5051 norm_overlap=1.0004 corr_cb=0.0401 topkJ=0.0662
[TRAIN][ep=013] loss=0.8017 acc=59.33%
[TRAIN][ep=013] mask_avg: mc_mean=0.2459 mb_mean=0.5029 norm_overlap=1.0010 corr_cb=0.0689
[EPOCH 013/089] train: loss=0.8017 acc=59.33% | val: loss=0.7125 acc=56.63% f1=68.97% auc=49.13% val_score=38.8205 val_score_bestthr=58.2951 | dyn(w_pfs=0.130, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.246, mb=0.503, no=1.001, corr=0.069) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.2030 -> 58.2951
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.2449 mb_mean=0.5041 norm_overlap=0.9976 corr_cb=-0.1947 topkJ=0.0354
[TRAIN][ep=014] loss=0.8888 acc=64.56%
[TRAIN][ep=014] mask_avg: mc_mean=0.2258 mb_mean=0.5029 norm_overlap=1.0010 corr_cb=0.0583
[EPOCH 014/089] train: loss=0.8888 acc=64.56% | val: loss=0.6941 acc=60.24% f1=71.79% auc=54.13% val_score=44.0909 val_score_bestthr=64.5533 | dyn(w_pfs=0.170, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.226, mb=0.503, no=1.001, corr=0.058) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.2030 -> 64.5533
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1763 mb_mean=0.5008 norm_overlap=1.0030 corr_cb=0.1334 topkJ=0.0326
[TRAIN][ep=015] loss=0.9842 acc=63.22%
[TRAIN][ep=015] mask_avg: mc_mean=0.2154 mb_mean=0.5029 norm_overlap=1.0006 corr_cb=0.0261
[EPOCH 015/089] train: loss=0.9842 acc=63.22% | val: loss=0.6960 acc=60.24% f1=71.79% auc=55.29% val_score=58.0695 val_score_bestthr=66.1328 | dyn(w_pfs=0.210, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.215, mb=0.503, no=1.001, corr=0.026) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.2030 -> 66.1328
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.2530 mb_mean=0.5040 norm_overlap=0.9970 corr_cb=-0.1659 topkJ=0.0267
[TRAIN][ep=016] loss=1.0719 acc=65.37%
[TRAIN][ep=016] mask_avg: mc_mean=0.2187 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=-0.0081
[EPOCH 016/089] train: loss=1.0719 acc=65.37% | val: loss=0.6990 acc=60.24% f1=71.79% auc=53.66% val_score=42.7210 val_score_bestthr=64.5533 | dyn(w_pfs=0.250, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.219, mb=0.503, no=1.000, corr=-0.008) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.2030 -> 64.5533
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.2125 mb_mean=0.5001 norm_overlap=0.9990 corr_cb=-0.0408 topkJ=0.0140
[TRAIN][ep=017] loss=1.1623 acc=64.83%
[TRAIN][ep=017] mask_avg: mc_mean=0.2139 mb_mean=0.5029 norm_overlap=0.9996 corr_cb=-0.0249
[EPOCH 017/089] train: loss=1.1623 acc=64.83% | val: loss=0.7005 acc=60.24% f1=71.79% auc=56.05% val_score=52.2803 val_score_bestthr=66.1328 | dyn(w_pfs=0.150, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.214, mb=0.503, no=1.000, corr=-0.025) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.2030 -> 66.1328
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.2461 mb_mean=0.5046 norm_overlap=0.9972 corr_cb=-0.1252 topkJ=0.0147
[TRAIN][ep=018] loss=0.9176 acc=66.17%
[TRAIN][ep=018] mask_avg: mc_mean=0.2149 mb_mean=0.5029 norm_overlap=0.9991 corr_cb=-0.0493
[EPOCH 018/089] train: loss=0.9176 acc=66.17% | val: loss=0.7030 acc=61.45% f1=72.88% auc=54.19% val_score=44.9031 val_score_bestthr=69.9294 | dyn(w_pfs=0.190, w_sup=0.140, w_csuf=0.140, stage2=False) | mask(mc=0.215, mb=0.503, no=0.999, corr=-0.049) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 67.2030 -> 69.9294
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.2117 mb_mean=0.5051 norm_overlap=0.9949 corr_cb=-0.2274 topkJ=0.0179
[TRAIN][ep=019] loss=1.0104 acc=66.04%
[TRAIN][ep=019] mask_avg: mc_mean=0.2118 mb_mean=0.5029 norm_overlap=0.9986 corr_cb=-0.0676
[EPOCH 019/089] train: loss=1.0104 acc=66.04% | val: loss=0.7103 acc=60.24% f1=72.27% auc=53.55% val_score=42.8269 val_score_bestthr=67.9899 | dyn(w_pfs=0.230, w_sup=0.180, w_csuf=0.180, stage2=False) | mask(mc=0.212, mb=0.503, no=0.999, corr=-0.068) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9294 -> 67.9899
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.2794 mb_mean=0.5115 norm_overlap=0.9936 corr_cb=-0.3550 topkJ=0.0119
[TRAIN][ep=020] loss=1.0960 acc=65.91%
[TRAIN][ep=020] mask_avg: mc_mean=0.2095 mb_mean=0.5029 norm_overlap=0.9983 corr_cb=-0.0810
[EPOCH 020/089] train: loss=1.0960 acc=65.91% | val: loss=0.7239 acc=57.83% f1=71.07% auc=52.62% val_score=35.6833 val_score_bestthr=64.3955 | dyn(w_pfs=0.270, w_sup=0.220, w_csuf=0.200, stage2=False) | mask(mc=0.209, mb=0.503, no=0.998, corr=-0.081) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9294 -> 64.3955
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2151 mb_mean=0.5054 norm_overlap=0.9979 corr_cb=-0.1113 topkJ=0.0338
[TRAIN][ep=021] loss=1.1549 acc=67.38%
[TRAIN][ep=021] mask_avg: mc_mean=0.2085 mb_mean=0.5029 norm_overlap=0.9980 corr_cb=-0.0858
[EPOCH 021/089] train: loss=1.1549 acc=67.38% | val: loss=0.7121 acc=60.24% f1=71.79% auc=55.81% val_score=45.9915 val_score_bestthr=66.0967 | dyn(w_pfs=0.310, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.209, mb=0.503, no=0.998, corr=-0.086) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9294 -> 66.0967
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2373 mb_mean=0.5063 norm_overlap=0.9980 corr_cb=-0.0936 topkJ=0.0317
[TRAIN][ep=022] loss=1.1771 acc=66.17%
[TRAIN][ep=022] mask_avg: mc_mean=0.2317 mb_mean=0.5029 norm_overlap=0.9971 corr_cb=-0.1221
[EPOCH 022/089] train: loss=1.1771 acc=66.17% | val: loss=0.7175 acc=61.45% f1=72.88% auc=54.07% val_score=39.9677 val_score_bestthr=69.0844 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.232, mb=0.503, no=0.997, corr=-0.122) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9294 -> 69.0844
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1911 mb_mean=0.4990 norm_overlap=1.0008 corr_cb=0.0287 topkJ=0.0508
[TRAIN][ep=023] loss=1.1891 acc=65.10%
[TRAIN][ep=023] mask_avg: mc_mean=0.2225 mb_mean=0.5029 norm_overlap=0.9971 corr_cb=-0.1208
[EPOCH 023/089] train: loss=1.1891 acc=65.10% | val: loss=0.7280 acc=60.24% f1=71.79% auc=53.43% val_score=35.7087 val_score_bestthr=67.4967 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.223, mb=0.503, no=0.997, corr=-0.121) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9294 -> 67.4967
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2185 mb_mean=0.4986 norm_overlap=0.9964 corr_cb=-0.1448 topkJ=0.0206
[TRAIN][ep=024] loss=0.9468 acc=66.44%
[TRAIN][ep=024] mask_avg: mc_mean=0.2290 mb_mean=0.5029 norm_overlap=0.9967 corr_cb=-0.1365
[EPOCH 024/089] train: loss=0.9468 acc=66.44% | val: loss=0.7169 acc=61.45% f1=72.88% auc=55.70% val_score=48.4617 val_score_bestthr=69.0844 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.229, mb=0.503, no=0.997, corr=-0.136) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9294 -> 69.0844
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2009 mb_mean=0.5043 norm_overlap=0.9933 corr_cb=-0.2201 topkJ=0.0117
[TRAIN][ep=025] loss=0.7085 acc=66.71%
[TRAIN][ep=025] mask_avg: mc_mean=0.2307 mb_mean=0.5029 norm_overlap=0.9965 corr_cb=-0.1449
[EPOCH 025/089] train: loss=0.7085 acc=66.71% | val: loss=0.7186 acc=60.24% f1=72.27% auc=54.83% val_score=49.5701 val_score_bestthr=69.0738 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.231, mb=0.503, no=0.997, corr=-0.145) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9294 -> 69.0738
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2291 mb_mean=0.5065 norm_overlap=0.9945 corr_cb=-0.2611 topkJ=0.0226
[TRAIN][ep=026] loss=0.6454 acc=67.79%
[TRAIN][ep=026] mask_avg: mc_mean=0.2287 mb_mean=0.5029 norm_overlap=0.9964 corr_cb=-0.1459
[EPOCH 026/089] train: loss=0.6454 acc=67.79% | val: loss=0.7222 acc=59.04% f1=71.67% auc=57.03% val_score=49.1870 val_score_bestthr=67.9254 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.229, mb=0.503, no=0.996, corr=-0.146) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9294 -> 67.9254
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2282 mb_mean=0.4994 norm_overlap=0.9954 corr_cb=-0.1629 topkJ=0.0308
[TRAIN][ep=027] loss=0.6342 acc=67.52%
[TRAIN][ep=027] mask_avg: mc_mean=0.2393 mb_mean=0.5029 norm_overlap=0.9958 corr_cb=-0.1728
[EPOCH 027/089] train: loss=0.6342 acc=67.52% | val: loss=0.7258 acc=60.24% f1=72.27% auc=54.24% val_score=42.5840 val_score_bestthr=69.0738 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.239, mb=0.503, no=0.996, corr=-0.173) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9294 -> 69.0738
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2069 mb_mean=0.5002 norm_overlap=0.9970 corr_cb=-0.0958 topkJ=0.0597
[TRAIN][ep=028] loss=0.6283 acc=68.32%
[TRAIN][ep=028] mask_avg: mc_mean=0.2208 mb_mean=0.5029 norm_overlap=0.9962 corr_cb=-0.1485
[EPOCH 028/089] train: loss=0.6283 acc=68.32% | val: loss=0.7339 acc=60.24% f1=72.27% auc=54.24% val_score=41.4192 val_score_bestthr=69.0738 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.221, mb=0.503, no=0.996, corr=-0.149) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9294 -> 69.0738
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2690 mb_mean=0.5037 norm_overlap=0.9928 corr_cb=-0.3043 topkJ=0.0212
[TRAIN][ep=029] loss=0.6274 acc=68.59%
[TRAIN][ep=029] mask_avg: mc_mean=0.2541 mb_mean=0.5029 norm_overlap=0.9953 corr_cb=-0.1984
[EPOCH 029/089] train: loss=0.6274 acc=68.59% | val: loss=0.7287 acc=59.04% f1=71.67% auc=54.83% val_score=42.4227 val_score_bestthr=67.9254 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.254, mb=0.503, no=0.995, corr=-0.198) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9294 -> 67.9254
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2104 mb_mean=0.4993 norm_overlap=1.0001 corr_cb=0.0029 topkJ=0.0379
[TRAIN][ep=030] loss=0.6359 acc=67.92%
[TRAIN][ep=030] mask_avg: mc_mean=0.2459 mb_mean=0.5029 norm_overlap=0.9954 corr_cb=-0.1870
[EPOCH 030/089] train: loss=0.6359 acc=67.92% | val: loss=0.7340 acc=59.04% f1=71.67% auc=54.53% val_score=43.5252 val_score_bestthr=67.9254 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.246, mb=0.503, no=0.995, corr=-0.187) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9294 -> 67.9254
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2512 mb_mean=0.4945 norm_overlap=0.9923 corr_cb=-0.3378 topkJ=0.0164
[TRAIN][ep=031] loss=0.6250 acc=68.32%
[TRAIN][ep=031] mask_avg: mc_mean=0.2614 mb_mean=0.5029 norm_overlap=0.9949 corr_cb=-0.2151
[EPOCH 031/089] train: loss=0.6250 acc=68.32% | val: loss=0.7339 acc=59.04% f1=71.67% auc=54.59% val_score=42.5218 val_score_bestthr=67.9254 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.261, mb=0.503, no=0.995, corr=-0.215) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9294 -> 67.9254
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2622 mb_mean=0.5035 norm_overlap=0.9955 corr_cb=-0.2434 topkJ=0.0172
[TRAIN][ep=032] loss=0.6209 acc=69.66%
[TRAIN][ep=032] mask_avg: mc_mean=0.2345 mb_mean=0.5029 norm_overlap=0.9955 corr_cb=-0.1830
[EPOCH 032/089] train: loss=0.6209 acc=69.66% | val: loss=0.7358 acc=59.04% f1=71.67% auc=57.44% val_score=57.9211 val_score_bestthr=67.9254 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.235, mb=0.503, no=0.995, corr=-0.183) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9294 -> 67.9254
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2873 mb_mean=0.5076 norm_overlap=0.9925 corr_cb=-0.3351 topkJ=0.0072
[TRAIN][ep=033] loss=0.6161 acc=68.72%
[TRAIN][ep=033] mask_avg: mc_mean=0.2631 mb_mean=0.5029 norm_overlap=0.9946 corr_cb=-0.2286
[EPOCH 033/089] train: loss=0.6161 acc=68.72% | val: loss=0.7300 acc=59.04% f1=71.67% auc=55.47% val_score=44.6757 val_score_bestthr=67.9254 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.263, mb=0.503, no=0.995, corr=-0.229) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9294 -> 67.9254
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1815 mb_mean=0.5064 norm_overlap=0.9939 corr_cb=-0.2045 topkJ=0.0091
[TRAIN][ep=034] loss=0.6080 acc=69.26%
[TRAIN][ep=034] mask_avg: mc_mean=0.2342 mb_mean=0.5029 norm_overlap=0.9952 corr_cb=-0.1839
[EPOCH 034/089] train: loss=0.6080 acc=69.26% | val: loss=0.7334 acc=59.04% f1=71.67% auc=55.76% val_score=44.2140 val_score_bestthr=67.9254 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.234, mb=0.503, no=0.995, corr=-0.184) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9294 -> 67.9254
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2230 mb_mean=0.4981 norm_overlap=0.9973 corr_cb=-0.0910 topkJ=0.0206
[TRAIN][ep=035] loss=0.6081 acc=69.93%
[TRAIN][ep=035] mask_avg: mc_mean=0.2414 mb_mean=0.5029 norm_overlap=0.9949 corr_cb=-0.1967
[EPOCH 035/089] train: loss=0.6081 acc=69.93% | val: loss=0.7376 acc=59.04% f1=71.67% auc=55.58% val_score=44.6079 val_score_bestthr=67.9254 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.241, mb=0.503, no=0.995, corr=-0.197) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9294 -> 67.9254
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2271 mb_mean=0.4988 norm_overlap=0.9967 corr_cb=-0.1158 topkJ=0.0336
[TRAIN][ep=036] loss=0.5989 acc=71.68%
[TRAIN][ep=036] mask_avg: mc_mean=0.2365 mb_mean=0.5029 norm_overlap=0.9949 corr_cb=-0.1936
[EPOCH 036/089] train: loss=0.5989 acc=71.68% | val: loss=0.7546 acc=59.04% f1=71.67% auc=55.70% val_score=39.1059 val_score_bestthr=67.9254 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.237, mb=0.503, no=0.995, corr=-0.194) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9294 -> 67.9254
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.2297 mb_mean=0.4998 norm_overlap=0.9956 corr_cb=-0.1545 topkJ=0.0225
[TRAIN][ep=037] loss=0.6006 acc=70.87%
[TRAIN][ep=037] mask_avg: mc_mean=0.2468 mb_mean=0.5029 norm_overlap=0.9945 corr_cb=-0.2127
[EPOCH 037/089] train: loss=0.6006 acc=70.87% | val: loss=0.7523 acc=59.04% f1=71.67% auc=55.70% val_score=36.9446 val_score_bestthr=67.9254 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.247, mb=0.503, no=0.995, corr=-0.213) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9294 -> 67.9254
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2825 mb_mean=0.5025 norm_overlap=0.9904 corr_cb=-0.3030 topkJ=0.0076
[TRAIN][ep=038] loss=0.6039 acc=70.87%
[TRAIN][ep=038] mask_avg: mc_mean=0.2653 mb_mean=0.5029 norm_overlap=0.9941 corr_cb=-0.2400
[EPOCH 038/089] train: loss=0.6039 acc=70.87% | val: loss=0.7502 acc=59.04% f1=71.67% auc=55.99% val_score=40.0968 val_score_bestthr=67.9254 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.265, mb=0.503, no=0.994, corr=-0.240) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9294 -> 67.9254
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2195 mb_mean=0.5026 norm_overlap=0.9967 corr_cb=-0.1143 topkJ=0.0137
[TRAIN][ep=039] loss=0.5911 acc=72.21%
[TRAIN][ep=039] mask_avg: mc_mean=0.2560 mb_mean=0.5029 norm_overlap=0.9942 corr_cb=-0.2330
[EPOCH 039/089] train: loss=0.5911 acc=72.21% | val: loss=0.7399 acc=62.65% f1=71.03% auc=56.98% val_score=48.7171 val_score_bestthr=63.4256 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.256, mb=0.503, no=0.994, corr=-0.233) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9294 -> 63.4256
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.1930 mb_mean=0.4982 norm_overlap=0.9947 corr_cb=-0.2050 topkJ=0.0163
[TRAIN][ep=040] loss=0.5919 acc=70.74%
[TRAIN][ep=040] mask_avg: mc_mean=0.2429 mb_mean=0.5029 norm_overlap=0.9944 corr_cb=-0.2146
[EPOCH 040/089] train: loss=0.5919 acc=70.74% | val: loss=0.7573 acc=60.24% f1=68.57% auc=56.40% val_score=38.0060 val_score_bestthr=63.1898 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.243, mb=0.503, no=0.994, corr=-0.215) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9294 -> 63.1898
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.2555 mb_mean=0.5057 norm_overlap=0.9985 corr_cb=-0.0688 topkJ=0.0456
[TRAIN][ep=041] loss=0.5891 acc=71.54%
[TRAIN][ep=041] mask_avg: mc_mean=0.2462 mb_mean=0.5029 norm_overlap=0.9943 corr_cb=-0.2168
[EPOCH 041/089] train: loss=0.5891 acc=71.54% | val: loss=0.7473 acc=60.24% f1=68.57% auc=57.15% val_score=44.2140 val_score_bestthr=63.1898 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.246, mb=0.503, no=0.994, corr=-0.217) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9294 -> 63.1898
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.2140 mb_mean=0.4989 norm_overlap=0.9970 corr_cb=-0.0758 topkJ=0.0420
[TRAIN][ep=042] loss=0.5869 acc=71.41%
[TRAIN][ep=042] mask_avg: mc_mean=0.2505 mb_mean=0.5029 norm_overlap=0.9941 corr_cb=-0.2255
[EPOCH 042/089] train: loss=0.5869 acc=71.41% | val: loss=0.7460 acc=62.65% f1=71.03% auc=57.50% val_score=44.2140 val_score_bestthr=63.4256 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.251, mb=0.503, no=0.994, corr=-0.225) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9294 -> 63.4256
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.2691 mb_mean=0.5069 norm_overlap=0.9951 corr_cb=-0.1887 topkJ=0.0187
[TRAIN][ep=043] loss=0.5800 acc=72.75%
[TRAIN][ep=043] mask_avg: mc_mean=0.2476 mb_mean=0.5029 norm_overlap=0.9941 corr_cb=-0.2260
[EPOCH 043/089] train: loss=0.5800 acc=72.75% | val: loss=0.7446 acc=62.65% f1=71.03% auc=58.08% val_score=52.9369 val_score_bestthr=63.4256 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.248, mb=0.503, no=0.994, corr=-0.226) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9294 -> 63.4256
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2483 mb_mean=0.5063 norm_overlap=0.9937 corr_cb=-0.2172 topkJ=0.0055
[TRAIN][ep=044] loss=0.5794 acc=72.08%
[TRAIN][ep=044] mask_avg: mc_mean=0.2706 mb_mean=0.5029 norm_overlap=0.9938 corr_cb=-0.2521
[EPOCH 044/089] train: loss=0.5794 acc=72.08% | val: loss=0.7438 acc=60.24% f1=72.27% auc=58.02% val_score=50.7676 val_score_bestthr=69.8204 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.271, mb=0.503, no=0.994, corr=-0.252) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9294 -> 69.8204
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2305 mb_mean=0.5026 norm_overlap=0.9939 corr_cb=-0.2412 topkJ=0.0171
[TRAIN][ep=045] loss=0.5809 acc=71.68%
[TRAIN][ep=045] mask_avg: mc_mean=0.2521 mb_mean=0.5029 norm_overlap=0.9940 corr_cb=-0.2276
[EPOCH 045/089] train: loss=0.5809 acc=71.68% | val: loss=0.7465 acc=60.24% f1=72.27% auc=57.73% val_score=52.9369 val_score_bestthr=69.8204 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.252, mb=0.503, no=0.994, corr=-0.228) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9294 -> 69.8204
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.2345 mb_mean=0.4981 norm_overlap=0.9966 corr_cb=-0.1010 topkJ=0.0424
[TRAIN][ep=046] loss=0.5743 acc=72.08%
[TRAIN][ep=046] mask_avg: mc_mean=0.2483 mb_mean=0.5029 norm_overlap=0.9941 corr_cb=-0.2240
[EPOCH 046/089] train: loss=0.5743 acc=72.08% | val: loss=0.7754 acc=60.24% f1=72.27% auc=57.33% val_score=39.4359 val_score_bestthr=69.8204 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.248, mb=0.503, no=0.994, corr=-0.224) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9294 -> 69.8204
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.2407 mb_mean=0.5056 norm_overlap=0.9925 corr_cb=-0.2782 topkJ=0.0088
[TRAIN][ep=047] loss=0.5671 acc=72.89%
[TRAIN][ep=047] mask_avg: mc_mean=0.2614 mb_mean=0.5029 norm_overlap=0.9936 corr_cb=-0.2480
[EPOCH 047/089] train: loss=0.5671 acc=72.89% | val: loss=0.7624 acc=60.24% f1=72.27% auc=57.33% val_score=43.5587 val_score_bestthr=69.8204 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.261, mb=0.503, no=0.994, corr=-0.248) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9294 -> 69.8204
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.3156 mb_mean=0.5025 norm_overlap=0.9923 corr_cb=-0.3428 topkJ=0.0114
[TRAIN][ep=048] loss=0.5657 acc=72.08%
[TRAIN][ep=048] mask_avg: mc_mean=0.2524 mb_mean=0.5029 norm_overlap=0.9937 corr_cb=-0.2342
[EPOCH 048/089] train: loss=0.5657 acc=72.08% | val: loss=0.7655 acc=61.45% f1=72.41% auc=58.78% val_score=52.0590 val_score_bestthr=67.4771 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.252, mb=0.503, no=0.994, corr=-0.234) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9294 -> 67.4771
[EARLY STOP] no improvement for 30 epochs. best_epoch=18
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
=============== FIT DONE ===============
[BEST] epoch=18 | val_acc=61.45% | val_f1=72.88% | val_auc=54.19% | val_score=44.9031 | val_score_bestthr=69.9294
[TEST@BEST] thr_used=0.445 | acc=63.77% f1=71.91% auc=67.97% | SP_sex=10.60% EO_sex=3.36% SP_age=18.04% EO_age=20.88%
[TIME] 1.25 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/summary_fold_3.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5042 mb_mean=0.5040 norm_overlap=1.0001 corr_cb=0.1951 topkJ=0.1574
[TRAIN][ep=000] loss=0.6946 acc=48.19%
[TRAIN][ep=000] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0819
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5061 mb_mean=0.5005 norm_overlap=1.0000 corr_cb=0.1183 topkJ=0.0577
[TRAIN][ep=001] loss=0.6934 acc=49.66%
[TRAIN][ep=001] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0801
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5044 mb_mean=0.5040 norm_overlap=1.0000 corr_cb=0.0722 topkJ=0.0959
[TRAIN][ep=002] loss=0.6917 acc=54.63%
[TRAIN][ep=002] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0784
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5035 mb_mean=0.4968 norm_overlap=1.0002 corr_cb=0.3148 topkJ=0.1021
[TRAIN][ep=003] loss=0.6903 acc=51.68%
[TRAIN][ep=003] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0800
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5044 mb_mean=0.5048 norm_overlap=1.0001 corr_cb=0.2160 topkJ=0.0656
[TRAIN][ep=004] loss=0.6899 acc=53.96%
[TRAIN][ep=004] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0800
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5067 mb_mean=0.5067 norm_overlap=1.0001 corr_cb=0.1932 topkJ=0.0734
[TRAIN][ep=005] loss=0.6882 acc=54.63%
[TRAIN][ep=005] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0823
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5065 mb_mean=0.5067 norm_overlap=1.0000 corr_cb=-0.0363 topkJ=0.1013
[TRAIN][ep=006] loss=0.6868 acc=56.51%
[TRAIN][ep=006] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0796
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5062 mb_mean=0.5019 norm_overlap=1.0001 corr_cb=0.3117 topkJ=0.2049
[TRAIN][ep=007] loss=0.6878 acc=55.17%
[TRAIN][ep=007] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0800
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5025 mb_mean=0.5033 norm_overlap=1.0000 corr_cb=-0.0452 topkJ=0.0691
[TRAIN][ep=008] loss=0.6836 acc=60.00%
[TRAIN][ep=008] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0804
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5034 mb_mean=0.5057 norm_overlap=1.0001 corr_cb=0.1863 topkJ=0.0624
[TRAIN][ep=009] loss=0.6816 acc=58.66%
[TRAIN][ep=009] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0876
================= FIT START (fold=3) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5055 mb_mean=0.5024 norm_overlap=0.9999 corr_cb=-0.0929 topkJ=0.0409
[TRAIN][ep=000] loss=0.6795 acc=58.79%
[TRAIN][ep=000] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0802
[EPOCH 000/089] train: loss=0.6795 acc=58.79% | val: loss=0.6931 acc=56.63% f1=68.97% auc=50.17% val_score=38.1644 val_score_bestthr=58.2951 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.080) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 58.2951
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5046 mb_mean=0.4991 norm_overlap=1.0000 corr_cb=0.0132 topkJ=0.0779
[TRAIN][ep=001] loss=0.6764 acc=59.73%
[TRAIN][ep=001] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0802
[EPOCH 001/089] train: loss=0.6764 acc=59.73% | val: loss=0.6970 acc=55.42% f1=69.42% auc=49.13% val_score=36.3310 val_score_bestthr=60.1357 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.080) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 58.2951 -> 60.1357
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5047 mb_mean=0.5037 norm_overlap=1.0002 corr_cb=0.2934 topkJ=0.0559
[TRAIN][ep=002] loss=0.6751 acc=60.54%
[TRAIN][ep=002] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0808
[EPOCH 002/089] train: loss=0.6751 acc=60.54% | val: loss=0.6888 acc=59.04% f1=71.67% auc=53.78% val_score=46.9352 val_score_bestthr=66.6119 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.081) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 60.1357 -> 66.6119
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5066 mb_mean=0.5041 norm_overlap=1.0001 corr_cb=0.1759 topkJ=0.1404
[TRAIN][ep=003] loss=0.6728 acc=60.54%
[TRAIN][ep=003] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0798
[EPOCH 003/089] train: loss=0.6728 acc=60.54% | val: loss=0.7009 acc=55.42% f1=68.38% auc=49.19% val_score=36.6302 val_score_bestthr=57.1990 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.080) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6119 -> 57.1990
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5061 mb_mean=0.5050 norm_overlap=1.0000 corr_cb=0.0586 topkJ=0.0847
[TRAIN][ep=004] loss=0.6669 acc=60.40%
[TRAIN][ep=004] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0832
[EPOCH 004/089] train: loss=0.6669 acc=60.40% | val: loss=0.6893 acc=59.04% f1=71.19% auc=56.51% val_score=63.6339 val_score_bestthr=63.6339 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.083) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6119 -> 63.6339
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5043 mb_mean=0.5027 norm_overlap=1.0001 corr_cb=0.2297 topkJ=0.0605
[TRAIN][ep=005] loss=1.4380 acc=59.60%
[TRAIN][ep=005] mask_avg: mc_mean=0.3769 mb_mean=0.5029 norm_overlap=1.0021 corr_cb=0.5896
[EPOCH 005/089] train: loss=1.4380 acc=59.60% | val: loss=0.6901 acc=57.83% f1=71.07% auc=54.53% val_score=39.6718 val_score_bestthr=65.8266 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.377, mb=0.503, no=1.002, corr=0.590) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6119 -> 65.8266
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.3001 mb_mean=0.5054 norm_overlap=1.0016 corr_cb=0.4229 topkJ=0.1828
[TRAIN][ep=006] loss=1.4297 acc=63.49%
[TRAIN][ep=006] mask_avg: mc_mean=0.2789 mb_mean=0.5029 norm_overlap=1.0039 corr_cb=0.5813
[EPOCH 006/089] train: loss=1.4297 acc=63.49% | val: loss=0.6962 acc=57.83% f1=69.03% auc=52.56% val_score=40.5966 val_score_bestthr=60.2469 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.279, mb=0.503, no=1.004, corr=0.581) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6119 -> 60.2469
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2573 mb_mean=0.5008 norm_overlap=1.0030 corr_cb=0.5244 topkJ=0.2274
[TRAIN][ep=007] loss=1.4293 acc=62.68%
[TRAIN][ep=007] mask_avg: mc_mean=0.2634 mb_mean=0.5029 norm_overlap=1.0039 corr_cb=0.5130
[EPOCH 007/089] train: loss=1.4293 acc=62.68% | val: loss=0.6896 acc=59.04% f1=71.19% auc=56.98% val_score=61.8396 val_score_bestthr=63.6339 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.263, mb=0.503, no=1.004, corr=0.513) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6119 -> 63.6339
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2383 mb_mean=0.4971 norm_overlap=1.0065 corr_cb=0.6541 topkJ=0.1936
[TRAIN][ep=008] loss=1.2159 acc=60.13%
[TRAIN][ep=008] mask_avg: mc_mean=0.2613 mb_mean=0.5029 norm_overlap=1.0035 corr_cb=0.4314
[EPOCH 008/089] train: loss=1.2159 acc=60.13% | val: loss=0.6892 acc=59.04% f1=70.69% auc=57.15% val_score=57.9517 val_score_bestthr=63.2761 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.261, mb=0.503, no=1.004, corr=0.431) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6119 -> 63.2761
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2232 mb_mean=0.4964 norm_overlap=1.0030 corr_cb=0.4315 topkJ=0.1862
[TRAIN][ep=009] loss=0.9880 acc=61.61%
[TRAIN][ep=009] mask_avg: mc_mean=0.2524 mb_mean=0.5029 norm_overlap=1.0032 corr_cb=0.3455
[EPOCH 009/089] train: loss=0.9880 acc=61.61% | val: loss=0.6959 acc=57.83% f1=69.03% auc=54.24% val_score=43.4695 val_score_bestthr=62.2330 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.252, mb=0.503, no=1.003, corr=0.346) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6119 -> 62.2330
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.2548 mb_mean=0.5031 norm_overlap=1.0027 corr_cb=0.2693 topkJ=0.1251
[TRAIN][ep=010] loss=0.9364 acc=62.82%
[TRAIN][ep=010] mask_avg: mc_mean=0.2433 mb_mean=0.5029 norm_overlap=1.0026 corr_cb=0.2442
[EPOCH 010/089] train: loss=0.9364 acc=62.82% | val: loss=0.6977 acc=60.24% f1=72.27% auc=54.48% val_score=43.8004 val_score_bestthr=67.9899 | dyn(w_pfs=0.090, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.243, mb=0.503, no=1.003, corr=0.244) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 66.6119 -> 67.9899
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.2599 mb_mean=0.5027 norm_overlap=1.0012 corr_cb=0.1275 topkJ=0.0528
[TRAIN][ep=011] loss=1.0147 acc=66.04%
[TRAIN][ep=011] mask_avg: mc_mean=0.2286 mb_mean=0.5029 norm_overlap=1.0021 corr_cb=0.1523
[EPOCH 011/089] train: loss=1.0147 acc=66.04% | val: loss=0.7281 acc=57.83% f1=69.57% auc=51.86% val_score=34.1458 val_score_bestthr=59.9526 | dyn(w_pfs=0.130, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.229, mb=0.503, no=1.002, corr=0.152) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9899 -> 59.9526
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.2538 mb_mean=0.5058 norm_overlap=1.0010 corr_cb=0.0819 topkJ=0.0602
[TRAIN][ep=012] loss=1.0994 acc=63.89%
[TRAIN][ep=012] mask_avg: mc_mean=0.2241 mb_mean=0.5029 norm_overlap=1.0016 corr_cb=0.1014
[EPOCH 012/089] train: loss=1.0994 acc=63.89% | val: loss=0.7016 acc=60.24% f1=71.79% auc=56.69% val_score=57.9211 val_score_bestthr=67.4967 | dyn(w_pfs=0.170, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.224, mb=0.503, no=1.002, corr=0.101) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9899 -> 67.4967
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.2434 mb_mean=0.5051 norm_overlap=1.0000 corr_cb=0.0026 topkJ=0.0582
[TRAIN][ep=013] loss=1.1854 acc=63.49%
[TRAIN][ep=013] mask_avg: mc_mean=0.2438 mb_mean=0.5029 norm_overlap=1.0003 corr_cb=0.0140
[EPOCH 013/089] train: loss=1.1854 acc=63.49% | val: loss=0.7069 acc=60.24% f1=71.79% auc=54.36% val_score=35.0072 val_score_bestthr=67.4967 | dyn(w_pfs=0.210, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.244, mb=0.503, no=1.000, corr=0.014) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9899 -> 67.4967
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.2232 mb_mean=0.5041 norm_overlap=0.9972 corr_cb=-0.2043 topkJ=0.0264
[TRAIN][ep=014] loss=1.2577 acc=65.37%
[TRAIN][ep=014] mask_avg: mc_mean=0.2100 mb_mean=0.5029 norm_overlap=1.0007 corr_cb=0.0362
[EPOCH 014/089] train: loss=1.2577 acc=65.37% | val: loss=0.7030 acc=60.24% f1=72.27% auc=56.16% val_score=45.4631 val_score_bestthr=69.0738 | dyn(w_pfs=0.250, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.210, mb=0.503, no=1.001, corr=0.036) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 67.9899 -> 69.0738
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1664 mb_mean=0.5008 norm_overlap=1.0028 corr_cb=0.1176 topkJ=0.0330
[TRAIN][ep=015] loss=1.3407 acc=67.79%
[TRAIN][ep=015] mask_avg: mc_mean=0.2107 mb_mean=0.5029 norm_overlap=0.9999 corr_cb=-0.0137
[EPOCH 015/089] train: loss=1.3407 acc=67.79% | val: loss=0.7036 acc=61.45% f1=72.88% auc=56.16% val_score=46.0300 val_score_bestthr=71.2933 | dyn(w_pfs=0.290, w_sup=0.240, w_csuf=0.200, stage2=False) | mask(mc=0.211, mb=0.503, no=1.000, corr=-0.014) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 69.0738 -> 71.2933
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.2614 mb_mean=0.5040 norm_overlap=0.9955 corr_cb=-0.2512 topkJ=0.0174
[TRAIN][ep=016] loss=1.3510 acc=66.98%
[TRAIN][ep=016] mask_avg: mc_mean=0.2159 mb_mean=0.5029 norm_overlap=0.9992 corr_cb=-0.0499
[EPOCH 016/089] train: loss=1.3510 acc=66.98% | val: loss=0.7191 acc=59.04% f1=71.67% auc=57.33% val_score=57.9211 val_score_bestthr=67.9254 | dyn(w_pfs=0.330, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.216, mb=0.503, no=0.999, corr=-0.050) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.9254
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.2154 mb_mean=0.5001 norm_overlap=0.9979 corr_cb=-0.0863 topkJ=0.0120
[TRAIN][ep=017] loss=1.3627 acc=67.79%
[TRAIN][ep=017] mask_avg: mc_mean=0.2241 mb_mean=0.5029 norm_overlap=0.9984 corr_cb=-0.0892
[EPOCH 017/089] train: loss=1.3627 acc=67.79% | val: loss=0.7170 acc=59.04% f1=71.67% auc=56.80% val_score=45.9915 val_score_bestthr=67.9254 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.224, mb=0.503, no=0.998, corr=-0.089) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.9254
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.2435 mb_mean=0.5046 norm_overlap=0.9960 corr_cb=-0.1719 topkJ=0.0075
[TRAIN][ep=018] loss=1.3559 acc=68.99%
[TRAIN][ep=018] mask_avg: mc_mean=0.2115 mb_mean=0.5029 norm_overlap=0.9981 corr_cb=-0.0961
[EPOCH 018/089] train: loss=1.3559 acc=68.99% | val: loss=0.7192 acc=59.04% f1=71.67% auc=56.57% val_score=43.8262 val_score_bestthr=67.9254 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.212, mb=0.503, no=0.998, corr=-0.096) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.9254
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.2139 mb_mean=0.5051 norm_overlap=0.9939 corr_cb=-0.2911 topkJ=0.0155
[TRAIN][ep=019] loss=1.3585 acc=68.32%
[TRAIN][ep=019] mask_avg: mc_mean=0.2236 mb_mean=0.5029 norm_overlap=0.9973 corr_cb=-0.1399
[EPOCH 019/089] train: loss=1.3585 acc=68.32% | val: loss=0.7243 acc=61.45% f1=70.37% auc=56.16% val_score=46.9660 val_score_bestthr=63.0971 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.224, mb=0.503, no=0.997, corr=-0.140) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 63.0971
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.2875 mb_mean=0.5115 norm_overlap=0.9923 corr_cb=-0.4213 topkJ=0.0065
[TRAIN][ep=020] loss=1.3416 acc=68.72%
[TRAIN][ep=020] mask_avg: mc_mean=0.2206 mb_mean=0.5029 norm_overlap=0.9969 corr_cb=-0.1528
[EPOCH 020/089] train: loss=1.3416 acc=68.72% | val: loss=0.7394 acc=59.04% f1=67.92% auc=55.87% val_score=32.2155 val_score_bestthr=62.0851 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.221, mb=0.503, no=0.997, corr=-0.153) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 62.0851
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2134 mb_mean=0.5054 norm_overlap=0.9977 corr_cb=-0.1255 topkJ=0.0325
[TRAIN][ep=021] loss=1.1232 acc=69.93%
[TRAIN][ep=021] mask_avg: mc_mean=0.2183 mb_mean=0.5029 norm_overlap=0.9966 corr_cb=-0.1592
[EPOCH 021/089] train: loss=1.1232 acc=69.93% | val: loss=0.7268 acc=60.24% f1=71.79% auc=58.66% val_score=49.1870 val_score_bestthr=65.1322 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.218, mb=0.503, no=0.997, corr=-0.159) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 65.1322
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2383 mb_mean=0.5063 norm_overlap=0.9972 corr_cb=-0.1447 topkJ=0.0299
[TRAIN][ep=022] loss=0.9069 acc=70.74%
[TRAIN][ep=022] mask_avg: mc_mean=0.2454 mb_mean=0.5029 norm_overlap=0.9957 corr_cb=-0.2025
[EPOCH 022/089] train: loss=0.9069 acc=70.74% | val: loss=0.7308 acc=61.45% f1=70.91% auc=58.55% val_score=48.4617 val_score_bestthr=61.9078 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.245, mb=0.503, no=0.996, corr=-0.203) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 61.9078
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2067 mb_mean=0.4990 norm_overlap=0.9991 corr_cb=-0.0408 topkJ=0.0420
[TRAIN][ep=023] loss=0.8645 acc=70.34%
[TRAIN][ep=023] mask_avg: mc_mean=0.2382 mb_mean=0.5029 norm_overlap=0.9956 corr_cb=-0.2034
[EPOCH 023/089] train: loss=0.8645 acc=70.34% | val: loss=0.7342 acc=61.45% f1=70.91% auc=57.62% val_score=47.9171 val_score_bestthr=61.9078 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.238, mb=0.503, no=0.996, corr=-0.203) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 61.9078
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2398 mb_mean=0.4986 norm_overlap=0.9953 corr_cb=-0.2240 topkJ=0.0150
[TRAIN][ep=024] loss=0.8501 acc=69.66%
[TRAIN][ep=024] mask_avg: mc_mean=0.2479 mb_mean=0.5029 norm_overlap=0.9952 corr_cb=-0.2259
[EPOCH 024/089] train: loss=0.8501 acc=69.66% | val: loss=0.7334 acc=61.45% f1=70.91% auc=58.26% val_score=43.5587 val_score_bestthr=61.9078 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.248, mb=0.503, no=0.995, corr=-0.226) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 61.9078
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1963 mb_mean=0.5043 norm_overlap=0.9914 corr_cb=-0.3092 topkJ=0.0035
[TRAIN][ep=025] loss=0.8423 acc=69.40%
[TRAIN][ep=025] mask_avg: mc_mean=0.2445 mb_mean=0.5029 norm_overlap=0.9951 corr_cb=-0.2253
[EPOCH 025/089] train: loss=0.8423 acc=69.40% | val: loss=0.7266 acc=60.24% f1=71.79% auc=59.07% val_score=48.7416 val_score_bestthr=65.1322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.245, mb=0.503, no=0.995, corr=-0.225) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 65.1322
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2384 mb_mean=0.5065 norm_overlap=0.9933 corr_cb=-0.3337 topkJ=0.0074
[TRAIN][ep=026] loss=0.8291 acc=70.87%
[TRAIN][ep=026] mask_avg: mc_mean=0.2385 mb_mean=0.5029 norm_overlap=0.9950 corr_cb=-0.2211
[EPOCH 026/089] train: loss=0.8291 acc=70.87% | val: loss=0.7368 acc=61.45% f1=72.41% auc=60.23% val_score=60.9059 val_score_bestthr=67.4771 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.238, mb=0.503, no=0.995, corr=-0.221) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.4771
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2371 mb_mean=0.4994 norm_overlap=0.9930 corr_cb=-0.2749 topkJ=0.0176
[TRAIN][ep=027] loss=0.8260 acc=72.75%
[TRAIN][ep=027] mask_avg: mc_mean=0.2422 mb_mean=0.5029 norm_overlap=0.9947 corr_cb=-0.2386
[EPOCH 027/089] train: loss=0.8260 acc=72.75% | val: loss=0.7343 acc=63.86% f1=69.39% auc=59.42% val_score=49.5369 val_score_bestthr=62.0186 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.242, mb=0.503, no=0.995, corr=-0.239) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 62.0186
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2235 mb_mean=0.5002 norm_overlap=0.9955 corr_cb=-0.1680 topkJ=0.0563
[TRAIN][ep=028] loss=0.8302 acc=71.95%
[TRAIN][ep=028] mask_avg: mc_mean=0.2424 mb_mean=0.5029 norm_overlap=0.9945 corr_cb=-0.2401
[EPOCH 028/089] train: loss=0.8302 acc=71.95% | val: loss=0.7418 acc=60.24% f1=72.27% auc=59.19% val_score=43.5587 val_score_bestthr=69.8204 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.242, mb=0.503, no=0.995, corr=-0.240) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 69.8204
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2983 mb_mean=0.5037 norm_overlap=0.9914 corr_cb=-0.3941 topkJ=0.0097
[TRAIN][ep=029] loss=0.8288 acc=71.68%
[TRAIN][ep=029] mask_avg: mc_mean=0.2747 mb_mean=0.5029 norm_overlap=0.9939 corr_cb=-0.2922
[EPOCH 029/089] train: loss=0.8288 acc=71.68% | val: loss=0.7354 acc=60.24% f1=71.79% auc=59.48% val_score=50.4629 val_score_bestthr=65.1322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.275, mb=0.503, no=0.994, corr=-0.292) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 65.1322
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2437 mb_mean=0.4993 norm_overlap=0.9979 corr_cb=-0.0994 topkJ=0.0214
[TRAIN][ep=030] loss=0.8334 acc=72.08%
[TRAIN][ep=030] mask_avg: mc_mean=0.2771 mb_mean=0.5029 norm_overlap=0.9937 corr_cb=-0.2966
[EPOCH 030/089] train: loss=0.8334 acc=72.08% | val: loss=0.7445 acc=61.45% f1=72.41% auc=59.53% val_score=60.9152 val_score_bestthr=67.4771 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.277, mb=0.503, no=0.994, corr=-0.297) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.4771
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2996 mb_mean=0.4945 norm_overlap=0.9916 corr_cb=-0.4517 topkJ=0.0099
[TRAIN][ep=031] loss=0.8246 acc=71.01%
[TRAIN][ep=031] mask_avg: mc_mean=0.2863 mb_mean=0.5029 norm_overlap=0.9936 corr_cb=-0.3104
[EPOCH 031/089] train: loss=0.8246 acc=71.01% | val: loss=0.7542 acc=63.86% f1=68.75% auc=58.66% val_score=35.1294 val_score_bestthr=60.4218 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.286, mb=0.503, no=0.994, corr=-0.310) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 60.4218
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2475 mb_mean=0.5035 norm_overlap=0.9950 corr_cb=-0.2884 topkJ=0.0143
[TRAIN][ep=032] loss=0.8176 acc=72.21%
[TRAIN][ep=032] mask_avg: mc_mean=0.2523 mb_mean=0.5029 norm_overlap=0.9943 corr_cb=-0.2619
[EPOCH 032/089] train: loss=0.8176 acc=72.21% | val: loss=0.7476 acc=61.45% f1=72.41% auc=60.81% val_score=59.2726 val_score_bestthr=67.4771 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.252, mb=0.503, no=0.994, corr=-0.262) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.4771
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2713 mb_mean=0.5076 norm_overlap=0.9916 corr_cb=-0.3771 topkJ=0.0040
[TRAIN][ep=033] loss=0.8116 acc=72.62%
[TRAIN][ep=033] mask_avg: mc_mean=0.2798 mb_mean=0.5029 norm_overlap=0.9937 corr_cb=-0.3059
[EPOCH 033/089] train: loss=0.8116 acc=72.62% | val: loss=0.7293 acc=60.24% f1=72.27% auc=60.17% val_score=50.9369 val_score_bestthr=69.8204 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.280, mb=0.503, no=0.994, corr=-0.306) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 69.8204
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1514 mb_mean=0.5064 norm_overlap=0.9942 corr_cb=-0.1883 topkJ=0.0091
[TRAIN][ep=034] loss=0.7996 acc=73.83%
[TRAIN][ep=034] mask_avg: mc_mean=0.2362 mb_mean=0.5029 norm_overlap=0.9942 corr_cb=-0.2423
[EPOCH 034/089] train: loss=0.7996 acc=73.83% | val: loss=0.7315 acc=61.45% f1=72.41% auc=60.76% val_score=56.8909 val_score_bestthr=67.4771 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.236, mb=0.503, no=0.994, corr=-0.242) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.4771
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2230 mb_mean=0.4981 norm_overlap=0.9965 corr_cb=-0.1387 topkJ=0.0125
[TRAIN][ep=035] loss=0.7985 acc=73.96%
[TRAIN][ep=035] mask_avg: mc_mean=0.2595 mb_mean=0.5029 norm_overlap=0.9936 corr_cb=-0.2792
[EPOCH 035/089] train: loss=0.7985 acc=73.96% | val: loss=0.7477 acc=60.24% f1=71.79% auc=60.29% val_score=53.8664 val_score_bestthr=65.1322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.260, mb=0.503, no=0.994, corr=-0.279) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 65.1322
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2601 mb_mean=0.4988 norm_overlap=0.9956 corr_cb=-0.1902 topkJ=0.0365
[TRAIN][ep=036] loss=0.7861 acc=74.63%
[TRAIN][ep=036] mask_avg: mc_mean=0.2560 mb_mean=0.5029 norm_overlap=0.9936 corr_cb=-0.2757
[EPOCH 036/089] train: loss=0.7861 acc=74.63% | val: loss=0.7562 acc=62.65% f1=69.31% auc=60.58% val_score=43.7584 val_score_bestthr=64.5175 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.256, mb=0.503, no=0.994, corr=-0.276) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 64.5175
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.2547 mb_mean=0.4998 norm_overlap=0.9945 corr_cb=-0.2269 topkJ=0.0165
[TRAIN][ep=037] loss=0.7896 acc=74.23%
[TRAIN][ep=037] mask_avg: mc_mean=0.2625 mb_mean=0.5029 norm_overlap=0.9933 corr_cb=-0.2924
[EPOCH 037/089] train: loss=0.7896 acc=74.23% | val: loss=0.7506 acc=61.45% f1=72.41% auc=60.64% val_score=47.4190 val_score_bestthr=67.4771 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.263, mb=0.503, no=0.993, corr=-0.292) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.4771
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2805 mb_mean=0.5025 norm_overlap=0.9890 corr_cb=-0.3614 topkJ=0.0024
[TRAIN][ep=038] loss=0.7985 acc=73.69%
[TRAIN][ep=038] mask_avg: mc_mean=0.2898 mb_mean=0.5029 norm_overlap=0.9929 corr_cb=-0.3306
[EPOCH 038/089] train: loss=0.7985 acc=73.69% | val: loss=0.7487 acc=61.45% f1=72.41% auc=60.17% val_score=54.4113 val_score_bestthr=67.4771 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.290, mb=0.503, no=0.993, corr=-0.331) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.4771
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2394 mb_mean=0.5026 norm_overlap=0.9953 corr_cb=-0.1949 topkJ=0.0132
[TRAIN][ep=039] loss=0.7768 acc=75.03%
[TRAIN][ep=039] mask_avg: mc_mean=0.2572 mb_mean=0.5029 norm_overlap=0.9933 corr_cb=-0.2874
[EPOCH 039/089] train: loss=0.7768 acc=75.03% | val: loss=0.7490 acc=62.65% f1=69.31% auc=60.35% val_score=54.4113 val_score_bestthr=64.5175 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.257, mb=0.503, no=0.993, corr=-0.287) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 64.5175
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.2144 mb_mean=0.4982 norm_overlap=0.9941 corr_cb=-0.2702 topkJ=0.0115
[TRAIN][ep=040] loss=0.7856 acc=73.56%
[TRAIN][ep=040] mask_avg: mc_mean=0.2630 mb_mean=0.5029 norm_overlap=0.9932 corr_cb=-0.2959
[EPOCH 040/089] train: loss=0.7856 acc=73.56% | val: loss=0.7558 acc=63.86% f1=70.00% auc=60.64% val_score=47.3400 val_score_bestthr=65.6291 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.263, mb=0.503, no=0.993, corr=-0.296) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 65.6291
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.2728 mb_mean=0.5057 norm_overlap=0.9975 corr_cb=-0.1320 topkJ=0.0425
[TRAIN][ep=041] loss=0.7730 acc=74.90%
[TRAIN][ep=041] mask_avg: mc_mean=0.2656 mb_mean=0.5029 norm_overlap=0.9932 corr_cb=-0.2957
[EPOCH 041/089] train: loss=0.7730 acc=74.90% | val: loss=0.7653 acc=65.06% f1=70.71% auc=62.09% val_score=47.5146 val_score_bestthr=66.7428 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.266, mb=0.503, no=0.993, corr=-0.296) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 66.7428
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.1965 mb_mean=0.4989 norm_overlap=0.9966 corr_cb=-0.0889 topkJ=0.0407
[TRAIN][ep=042] loss=0.7732 acc=73.83%
[TRAIN][ep=042] mask_avg: mc_mean=0.2496 mb_mean=0.5029 norm_overlap=0.9933 corr_cb=-0.2748
[EPOCH 042/089] train: loss=0.7732 acc=73.83% | val: loss=0.7415 acc=65.06% f1=70.71% auc=61.34% val_score=53.2978 val_score_bestthr=64.0074 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.250, mb=0.503, no=0.993, corr=-0.275) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 64.0074
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.2972 mb_mean=0.5069 norm_overlap=0.9938 corr_cb=-0.2679 topkJ=0.0113
[TRAIN][ep=043] loss=0.7636 acc=75.30%
[TRAIN][ep=043] mask_avg: mc_mean=0.2663 mb_mean=0.5029 norm_overlap=0.9930 corr_cb=-0.3033
[EPOCH 043/089] train: loss=0.7636 acc=75.30% | val: loss=0.7548 acc=66.27% f1=72.00% auc=61.45% val_score=54.4113 val_score_bestthr=69.2661 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.266, mb=0.503, no=0.993, corr=-0.303) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 69.2661
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2628 mb_mean=0.5063 norm_overlap=0.9930 corr_cb=-0.2650 topkJ=0.0051
[TRAIN][ep=044] loss=0.7616 acc=75.57%
[TRAIN][ep=044] mask_avg: mc_mean=0.2770 mb_mean=0.5029 norm_overlap=0.9930 corr_cb=-0.3106
[EPOCH 044/089] train: loss=0.7616 acc=75.57% | val: loss=0.7561 acc=66.27% f1=72.00% auc=61.74% val_score=54.4113 val_score_bestthr=69.2661 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.277, mb=0.503, no=0.993, corr=-0.311) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 69.2661
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2393 mb_mean=0.5026 norm_overlap=0.9928 corr_cb=-0.3209 topkJ=0.0159
[TRAIN][ep=045] loss=0.7626 acc=75.97%
[TRAIN][ep=045] mask_avg: mc_mean=0.2696 mb_mean=0.5029 norm_overlap=0.9930 corr_cb=-0.3001
[EPOCH 045/089] train: loss=0.7626 acc=75.97% | val: loss=0.7548 acc=65.06% f1=71.29% auc=62.50% val_score=51.2473 val_score_bestthr=68.1515 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.270, mb=0.503, no=0.993, corr=-0.300) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 68.1515
[EARLY STOP] no improvement for 30 epochs. best_epoch=15
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
=============== FIT DONE ===============
[BEST] epoch=15 | val_acc=61.45% | val_f1=72.88% | val_auc=56.16% | val_score=46.0300 | val_score_bestthr=71.2933
[TEST@BEST] thr_used=0.370 | acc=58.45% f1=70.34% auc=69.95% | SP_sex=10.24% EO_sex=4.94% SP_age=12.65% EO_age=12.00%
[TIME] 1.10 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/summary_fold_3.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5042 mb_mean=0.5040 norm_overlap=1.0001 corr_cb=0.1951 topkJ=0.1574
[TRAIN][ep=000] loss=0.6946 acc=48.19%
[TRAIN][ep=000] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0819
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5061 mb_mean=0.5005 norm_overlap=1.0000 corr_cb=0.1183 topkJ=0.0577
[TRAIN][ep=001] loss=0.6934 acc=49.66%
[TRAIN][ep=001] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0801
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5044 mb_mean=0.5040 norm_overlap=1.0000 corr_cb=0.0722 topkJ=0.0959
[TRAIN][ep=002] loss=0.6917 acc=54.63%
[TRAIN][ep=002] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0784
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5035 mb_mean=0.4968 norm_overlap=1.0002 corr_cb=0.3148 topkJ=0.1021
[TRAIN][ep=003] loss=0.6903 acc=51.68%
[TRAIN][ep=003] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0800
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5044 mb_mean=0.5048 norm_overlap=1.0001 corr_cb=0.2160 topkJ=0.0656
[TRAIN][ep=004] loss=0.6899 acc=53.96%
[TRAIN][ep=004] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0800
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5067 mb_mean=0.5067 norm_overlap=1.0001 corr_cb=0.1932 topkJ=0.0734
[TRAIN][ep=005] loss=0.6882 acc=54.77%
[TRAIN][ep=005] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0823
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5065 mb_mean=0.5067 norm_overlap=1.0000 corr_cb=-0.0363 topkJ=0.1013
[TRAIN][ep=006] loss=0.6868 acc=56.51%
[TRAIN][ep=006] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0796
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5062 mb_mean=0.5019 norm_overlap=1.0001 corr_cb=0.3117 topkJ=0.2049
[TRAIN][ep=007] loss=0.6878 acc=55.17%
[TRAIN][ep=007] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0800
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5025 mb_mean=0.5033 norm_overlap=1.0000 corr_cb=-0.0452 topkJ=0.0691
[TRAIN][ep=008] loss=0.6836 acc=60.00%
[TRAIN][ep=008] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0804
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5034 mb_mean=0.5057 norm_overlap=1.0001 corr_cb=0.1863 topkJ=0.0624
[TRAIN][ep=009] loss=0.6816 acc=58.79%
[TRAIN][ep=009] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0876
================= FIT START (fold=3) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.45 select_by=val_score_bestthr | eval_thr_mode=fixed eval_thr_grid=coarse | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5055 mb_mean=0.5024 norm_overlap=0.9999 corr_cb=-0.0929 topkJ=0.0409
[TRAIN][ep=000] loss=0.6795 acc=58.79%
[TRAIN][ep=000] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0802
[EPOCH 000/089] train: loss=0.6795 acc=58.79% | val: loss=0.6931 acc=55.42% f1=69.42% auc=50.17% val_score=60.1357 val_score_bestthr=60.1357 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.080) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 60.1357
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5046 mb_mean=0.4991 norm_overlap=1.0000 corr_cb=0.0132 topkJ=0.0779
[TRAIN][ep=001] loss=0.6764 acc=59.73%
[TRAIN][ep=001] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0802
[EPOCH 001/089] train: loss=0.6764 acc=59.73% | val: loss=0.6970 acc=53.01% f1=63.55% auc=49.13% val_score=47.6761 val_score_bestthr=47.6761 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.080) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 60.1357 -> 47.6761
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5047 mb_mean=0.5037 norm_overlap=1.0002 corr_cb=0.2934 topkJ=0.0559
[TRAIN][ep=002] loss=0.6751 acc=60.54%
[TRAIN][ep=002] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0808
[EPOCH 002/089] train: loss=0.6751 acc=60.54% | val: loss=0.6888 acc=54.22% f1=69.35% auc=53.78% val_score=62.6702 val_score_bestthr=62.6702 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.081) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 60.1357 -> 62.6702
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5066 mb_mean=0.5041 norm_overlap=1.0001 corr_cb=0.1759 topkJ=0.1404
[TRAIN][ep=003] loss=0.6728 acc=60.54%
[TRAIN][ep=003] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0798
[EPOCH 003/089] train: loss=0.6728 acc=60.54% | val: loss=0.7009 acc=48.19% f1=54.74% auc=49.13% val_score=41.5924 val_score_bestthr=41.5924 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.080) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6702 -> 41.5924
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5061 mb_mean=0.5050 norm_overlap=1.0000 corr_cb=0.0586 topkJ=0.0847
[TRAIN][ep=004] loss=0.6669 acc=60.40%
[TRAIN][ep=004] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0832
[EPOCH 004/089] train: loss=0.6669 acc=60.40% | val: loss=0.6893 acc=53.01% f1=68.80% auc=56.51% val_score=61.7349 val_score_bestthr=61.7349 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.083) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6702 -> 61.7349
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5043 mb_mean=0.5027 norm_overlap=1.0001 corr_cb=0.2297 topkJ=0.0605
[TRAIN][ep=005] loss=1.4380 acc=59.46%
[TRAIN][ep=005] mask_avg: mc_mean=0.3769 mb_mean=0.5029 norm_overlap=1.0021 corr_cb=0.5896
[EPOCH 005/089] train: loss=1.4380 acc=59.46% | val: loss=0.6901 acc=56.63% f1=67.86% auc=54.53% val_score=58.1035 val_score_bestthr=58.1035 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.377, mb=0.503, no=1.002, corr=0.590) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6702 -> 58.1035
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.3001 mb_mean=0.5054 norm_overlap=1.0016 corr_cb=0.4229 topkJ=0.1828
[TRAIN][ep=006] loss=1.4297 acc=63.49%
[TRAIN][ep=006] mask_avg: mc_mean=0.2789 mb_mean=0.5029 norm_overlap=1.0039 corr_cb=0.5812
[EPOCH 006/089] train: loss=1.4297 acc=63.49% | val: loss=0.6962 acc=53.01% f1=60.61% auc=52.56% val_score=48.5236 val_score_bestthr=48.5236 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.279, mb=0.503, no=1.004, corr=0.581) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6702 -> 48.5236
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2573 mb_mean=0.5008 norm_overlap=1.0030 corr_cb=0.5243 topkJ=0.2274
[TRAIN][ep=007] loss=1.4293 acc=62.68%
[TRAIN][ep=007] mask_avg: mc_mean=0.2634 mb_mean=0.5029 norm_overlap=1.0039 corr_cb=0.5130
[EPOCH 007/089] train: loss=1.4293 acc=62.68% | val: loss=0.6896 acc=54.22% f1=69.35% auc=56.98% val_score=62.8257 val_score_bestthr=62.8257 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.263, mb=0.503, no=1.004, corr=0.513) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 62.6702 -> 62.8257
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2384 mb_mean=0.4971 norm_overlap=1.0065 corr_cb=0.6539 topkJ=0.1936
[TRAIN][ep=008] loss=1.4321 acc=60.40%
[TRAIN][ep=008] mask_avg: mc_mean=0.2608 mb_mean=0.5029 norm_overlap=1.0035 corr_cb=0.4342
[EPOCH 008/089] train: loss=1.4321 acc=60.40% | val: loss=0.6887 acc=55.42% f1=69.92% auc=57.27% val_score=62.5179 val_score_bestthr=62.5179 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.261, mb=0.503, no=1.004, corr=0.434) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.8257 -> 62.5179
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2226 mb_mean=0.4964 norm_overlap=1.0030 corr_cb=0.4400 topkJ=0.1890
[TRAIN][ep=009] loss=1.4197 acc=60.94%
[TRAIN][ep=009] mask_avg: mc_mean=0.2509 mb_mean=0.5029 norm_overlap=1.0033 corr_cb=0.3617
[EPOCH 009/089] train: loss=1.4197 acc=60.94% | val: loss=0.6934 acc=56.63% f1=64.71% auc=55.12% val_score=51.3118 val_score_bestthr=51.3118 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.251, mb=0.503, no=1.003, corr=0.362) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.8257 -> 51.3118
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.2519 mb_mean=0.5031 norm_overlap=1.0028 corr_cb=0.2915 topkJ=0.1312
[TRAIN][ep=010] loss=1.4121 acc=62.15%
[TRAIN][ep=010] mask_avg: mc_mean=0.2409 mb_mean=0.5029 norm_overlap=1.0028 corr_cb=0.2717
[EPOCH 010/089] train: loss=1.4121 acc=62.15% | val: loss=0.6935 acc=57.83% f1=66.02% auc=55.58% val_score=56.5736 val_score_bestthr=56.5736 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.241, mb=0.503, no=1.003, corr=0.272) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.8257 -> 56.5736
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.2573 mb_mean=0.5027 norm_overlap=1.0014 corr_cb=0.1559 topkJ=0.0568
[TRAIN][ep=011] loss=1.4023 acc=66.31%
[TRAIN][ep=011] mask_avg: mc_mean=0.2267 mb_mean=0.5029 norm_overlap=1.0023 corr_cb=0.1763
[EPOCH 011/089] train: loss=1.4023 acc=66.31% | val: loss=0.7241 acc=46.99% f1=42.11% auc=52.21% val_score=36.9843 val_score_bestthr=36.9843 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.227, mb=0.503, no=1.002, corr=0.176) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.8257 -> 36.9843
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.2511 mb_mean=0.5058 norm_overlap=1.0012 corr_cb=0.1064 topkJ=0.0665
[TRAIN][ep=012] loss=1.4009 acc=63.76%
[TRAIN][ep=012] mask_avg: mc_mean=0.2215 mb_mean=0.5029 norm_overlap=1.0018 corr_cb=0.1171
[EPOCH 012/089] train: loss=1.4009 acc=63.76% | val: loss=0.7003 acc=60.24% f1=71.79% auc=57.33% val_score=67.4967 val_score_bestthr=67.4967 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.221, mb=0.503, no=1.002, corr=0.117) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 62.8257 -> 67.4967
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.2420 mb_mean=0.5051 norm_overlap=1.0001 corr_cb=0.0087 topkJ=0.0600
[TRAIN][ep=013] loss=1.3994 acc=63.09%
[TRAIN][ep=013] mask_avg: mc_mean=0.2420 mb_mean=0.5029 norm_overlap=1.0004 corr_cb=0.0232
[EPOCH 013/089] train: loss=1.3994 acc=63.09% | val: loss=0.7064 acc=56.63% f1=60.87% auc=54.36% val_score=47.9590 val_score_bestthr=47.9590 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.242, mb=0.503, no=1.000, corr=0.023) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4967 -> 47.9590
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.2234 mb_mean=0.5041 norm_overlap=0.9972 corr_cb=-0.2042 topkJ=0.0260
[TRAIN][ep=014] loss=1.3851 acc=66.17%
[TRAIN][ep=014] mask_avg: mc_mean=0.2104 mb_mean=0.5029 norm_overlap=1.0007 corr_cb=0.0381
[EPOCH 014/089] train: loss=1.3851 acc=66.17% | val: loss=0.7038 acc=57.83% f1=66.02% auc=56.16% val_score=55.4536 val_score_bestthr=55.4536 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.210, mb=0.503, no=1.001, corr=0.038) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4967 -> 55.4536
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1671 mb_mean=0.5008 norm_overlap=1.0028 corr_cb=0.1206 topkJ=0.0326
[TRAIN][ep=015] loss=1.3820 acc=67.52%
[TRAIN][ep=015] mask_avg: mc_mean=0.2114 mb_mean=0.5029 norm_overlap=0.9999 corr_cb=-0.0145
[EPOCH 015/089] train: loss=1.3820 acc=67.52% | val: loss=0.7048 acc=60.24% f1=67.33% auc=55.99% val_score=58.4427 val_score_bestthr=58.4427 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.211, mb=0.503, no=1.000, corr=-0.015) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4967 -> 58.4427
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.2598 mb_mean=0.5040 norm_overlap=0.9955 corr_cb=-0.2464 topkJ=0.0170
[TRAIN][ep=016] loss=1.3693 acc=67.11%
[TRAIN][ep=016] mask_avg: mc_mean=0.2165 mb_mean=0.5029 norm_overlap=0.9992 corr_cb=-0.0509
[EPOCH 016/089] train: loss=1.3693 acc=67.11% | val: loss=0.7197 acc=54.22% f1=67.24% auc=57.33% val_score=52.7536 val_score_bestthr=52.7536 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.217, mb=0.503, no=0.999, corr=-0.051) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4967 -> 52.7536
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.2162 mb_mean=0.5001 norm_overlap=0.9979 corr_cb=-0.0876 topkJ=0.0120
[TRAIN][ep=017] loss=1.3663 acc=67.52%
[TRAIN][ep=017] mask_avg: mc_mean=0.2247 mb_mean=0.5029 norm_overlap=0.9984 corr_cb=-0.0902
[EPOCH 017/089] train: loss=1.3663 acc=67.52% | val: loss=0.7180 acc=60.24% f1=67.96% auc=56.69% val_score=57.9211 val_score_bestthr=57.9211 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.225, mb=0.503, no=0.998, corr=-0.090) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4967 -> 57.9211
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.2447 mb_mean=0.5046 norm_overlap=0.9959 corr_cb=-0.1724 topkJ=0.0075
[TRAIN][ep=018] loss=1.1411 acc=68.99%
[TRAIN][ep=018] mask_avg: mc_mean=0.2141 mb_mean=0.5029 norm_overlap=0.9980 corr_cb=-0.1004
[EPOCH 018/089] train: loss=1.1411 acc=68.99% | val: loss=0.7206 acc=60.24% f1=67.33% auc=56.74% val_score=58.4427 val_score_bestthr=58.4427 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.214, mb=0.503, no=0.998, corr=-0.100) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4967 -> 58.4427
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.2146 mb_mean=0.5051 norm_overlap=0.9939 corr_cb=-0.2903 topkJ=0.0155
[TRAIN][ep=019] loss=0.9320 acc=68.59%
[TRAIN][ep=019] mask_avg: mc_mean=0.2245 mb_mean=0.5029 norm_overlap=0.9972 corr_cb=-0.1399
[EPOCH 019/089] train: loss=0.9320 acc=68.59% | val: loss=0.7268 acc=60.24% f1=65.26% auc=56.40% val_score=51.5760 val_score_bestthr=51.5760 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.224, mb=0.503, no=0.997, corr=-0.140) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4967 -> 51.5760
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.2889 mb_mean=0.5115 norm_overlap=0.9924 corr_cb=-0.4169 topkJ=0.0069
[TRAIN][ep=020] loss=0.8736 acc=69.66%
[TRAIN][ep=020] mask_avg: mc_mean=0.2227 mb_mean=0.5029 norm_overlap=0.9969 corr_cb=-0.1534
[EPOCH 020/089] train: loss=0.8736 acc=69.66% | val: loss=0.7434 acc=54.22% f1=53.66% auc=56.05% val_score=46.1909 val_score_bestthr=46.1909 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.223, mb=0.503, no=0.997, corr=-0.153) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4967 -> 46.1909
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2163 mb_mean=0.5054 norm_overlap=0.9977 corr_cb=-0.1276 topkJ=0.0329
[TRAIN][ep=021] loss=0.8542 acc=69.80%
[TRAIN][ep=021] mask_avg: mc_mean=0.2202 mb_mean=0.5029 norm_overlap=0.9966 corr_cb=-0.1590
[EPOCH 021/089] train: loss=0.8542 acc=69.80% | val: loss=0.7291 acc=60.24% f1=67.96% auc=58.43% val_score=57.9211 val_score_bestthr=57.9211 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.220, mb=0.503, no=0.997, corr=-0.159) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4967 -> 57.9211
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2375 mb_mean=0.5063 norm_overlap=0.9973 corr_cb=-0.1373 topkJ=0.0312
[TRAIN][ep=022] loss=0.8503 acc=70.34%
[TRAIN][ep=022] mask_avg: mc_mean=0.2460 mb_mean=0.5029 norm_overlap=0.9957 corr_cb=-0.2011
[EPOCH 022/089] train: loss=0.8503 acc=70.34% | val: loss=0.7305 acc=61.45% f1=68.63% auc=58.55% val_score=60.4287 val_score_bestthr=60.4287 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.246, mb=0.503, no=0.996, corr=-0.201) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4967 -> 60.4287
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2083 mb_mean=0.4990 norm_overlap=0.9991 corr_cb=-0.0419 topkJ=0.0420
[TRAIN][ep=023] loss=0.8507 acc=69.93%
[TRAIN][ep=023] mask_avg: mc_mean=0.2392 mb_mean=0.5029 norm_overlap=0.9956 corr_cb=-0.2033
[EPOCH 023/089] train: loss=0.8507 acc=69.93% | val: loss=0.7340 acc=61.45% f1=66.67% auc=57.67% val_score=53.5774 val_score_bestthr=53.5774 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.239, mb=0.503, no=0.996, corr=-0.203) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4967 -> 53.5774
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2402 mb_mean=0.4986 norm_overlap=0.9954 corr_cb=-0.2229 topkJ=0.0150
[TRAIN][ep=024] loss=0.8507 acc=69.66%
[TRAIN][ep=024] mask_avg: mc_mean=0.2477 mb_mean=0.5029 norm_overlap=0.9952 corr_cb=-0.2248
[EPOCH 024/089] train: loss=0.8507 acc=69.66% | val: loss=0.7326 acc=61.45% f1=63.64% auc=58.43% val_score=46.2565 val_score_bestthr=46.2565 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.248, mb=0.503, no=0.995, corr=-0.225) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4967 -> 46.2565
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1950 mb_mean=0.5043 norm_overlap=0.9915 corr_cb=-0.3068 topkJ=0.0035
[TRAIN][ep=025] loss=0.8427 acc=69.66%
[TRAIN][ep=025] mask_avg: mc_mean=0.2446 mb_mean=0.5029 norm_overlap=0.9951 corr_cb=-0.2255
[EPOCH 025/089] train: loss=0.8427 acc=69.66% | val: loss=0.7259 acc=59.04% f1=63.83% auc=59.13% val_score=49.5701 val_score_bestthr=49.5701 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.245, mb=0.503, no=0.995, corr=-0.226) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4967 -> 49.5701
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2377 mb_mean=0.5065 norm_overlap=0.9934 corr_cb=-0.3321 topkJ=0.0074
[TRAIN][ep=026] loss=0.8296 acc=70.60%
[TRAIN][ep=026] mask_avg: mc_mean=0.2385 mb_mean=0.5029 norm_overlap=0.9950 corr_cb=-0.2218
[EPOCH 026/089] train: loss=0.8296 acc=70.60% | val: loss=0.7362 acc=60.24% f1=68.57% auc=60.41% val_score=56.6181 val_score_bestthr=56.6181 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.238, mb=0.503, no=0.995, corr=-0.222) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4967 -> 56.6181
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2390 mb_mean=0.4994 norm_overlap=0.9930 corr_cb=-0.2782 topkJ=0.0176
[TRAIN][ep=027] loss=0.8266 acc=72.35%
[TRAIN][ep=027] mask_avg: mc_mean=0.2424 mb_mean=0.5029 norm_overlap=0.9947 corr_cb=-0.2397
[EPOCH 027/089] train: loss=0.8266 acc=72.35% | val: loss=0.7331 acc=62.65% f1=65.93% auc=59.53% val_score=51.5086 val_score_bestthr=51.5086 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.242, mb=0.503, no=0.995, corr=-0.240) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4967 -> 51.5086
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2245 mb_mean=0.5002 norm_overlap=0.9954 corr_cb=-0.1701 topkJ=0.0563
[TRAIN][ep=028] loss=0.8304 acc=71.54%
[TRAIN][ep=028] mask_avg: mc_mean=0.2427 mb_mean=0.5029 norm_overlap=0.9945 corr_cb=-0.2417
[EPOCH 028/089] train: loss=0.8304 acc=71.54% | val: loss=0.7406 acc=57.83% f1=58.82% auc=59.48% val_score=49.1841 val_score_bestthr=49.1841 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.243, mb=0.503, no=0.995, corr=-0.242) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4967 -> 49.1841
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2980 mb_mean=0.5037 norm_overlap=0.9914 corr_cb=-0.3948 topkJ=0.0093
[TRAIN][ep=029] loss=0.8290 acc=71.54%
[TRAIN][ep=029] mask_avg: mc_mean=0.2742 mb_mean=0.5029 norm_overlap=0.9939 corr_cb=-0.2928
[EPOCH 029/089] train: loss=0.8290 acc=71.54% | val: loss=0.7344 acc=61.45% f1=64.44% auc=59.42% val_score=54.0054 val_score_bestthr=54.0054 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.274, mb=0.503, no=0.994, corr=-0.293) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4967 -> 54.0054
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2479 mb_mean=0.4993 norm_overlap=0.9977 corr_cb=-0.1079 topkJ=0.0210
[TRAIN][ep=030] loss=0.8335 acc=72.08%
[TRAIN][ep=030] mask_avg: mc_mean=0.2778 mb_mean=0.5029 norm_overlap=0.9937 corr_cb=-0.2987
[EPOCH 030/089] train: loss=0.8335 acc=72.08% | val: loss=0.7437 acc=60.24% f1=69.16% auc=59.65% val_score=60.6523 val_score_bestthr=60.6523 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.278, mb=0.503, no=0.994, corr=-0.299) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4967 -> 60.6523
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.3018 mb_mean=0.4945 norm_overlap=0.9916 corr_cb=-0.4543 topkJ=0.0095
[TRAIN][ep=031] loss=0.8247 acc=70.87%
[TRAIN][ep=031] mask_avg: mc_mean=0.2863 mb_mean=0.5029 norm_overlap=0.9936 corr_cb=-0.3112
[EPOCH 031/089] train: loss=0.8247 acc=70.87% | val: loss=0.7533 acc=54.22% f1=51.28% auc=58.84% val_score=43.9164 val_score_bestthr=43.9164 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.286, mb=0.503, no=0.994, corr=-0.311) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4967 -> 43.9164
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2441 mb_mean=0.5035 norm_overlap=0.9950 corr_cb=-0.2854 topkJ=0.0147
[TRAIN][ep=032] loss=0.8176 acc=72.21%
[TRAIN][ep=032] mask_avg: mc_mean=0.2526 mb_mean=0.5029 norm_overlap=0.9942 corr_cb=-0.2631
[EPOCH 032/089] train: loss=0.8176 acc=72.21% | val: loss=0.7468 acc=60.24% f1=69.72% auc=60.70% val_score=59.5293 val_score_bestthr=59.5293 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.253, mb=0.503, no=0.994, corr=-0.263) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4967 -> 59.5293
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2695 mb_mean=0.5076 norm_overlap=0.9916 corr_cb=-0.3753 topkJ=0.0040
[TRAIN][ep=033] loss=0.8116 acc=72.62%
[TRAIN][ep=033] mask_avg: mc_mean=0.2795 mb_mean=0.5029 norm_overlap=0.9937 corr_cb=-0.3062
[EPOCH 033/089] train: loss=0.8116 acc=72.62% | val: loss=0.7277 acc=61.45% f1=63.64% auc=60.47% val_score=54.5009 val_score_bestthr=54.5009 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.279, mb=0.503, no=0.994, corr=-0.306) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4967 -> 54.5009
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1491 mb_mean=0.5064 norm_overlap=0.9942 corr_cb=-0.1845 topkJ=0.0091
[TRAIN][ep=034] loss=0.7997 acc=73.69%
[TRAIN][ep=034] mask_avg: mc_mean=0.2354 mb_mean=0.5029 norm_overlap=0.9942 corr_cb=-0.2419
[EPOCH 034/089] train: loss=0.7997 acc=73.69% | val: loss=0.7298 acc=60.24% f1=62.07% auc=61.05% val_score=54.4113 val_score_bestthr=54.4113 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.235, mb=0.503, no=0.994, corr=-0.242) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4967 -> 54.4113
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2196 mb_mean=0.4981 norm_overlap=0.9966 corr_cb=-0.1329 topkJ=0.0125
[TRAIN][ep=035] loss=0.7985 acc=74.23%
[TRAIN][ep=035] mask_avg: mc_mean=0.2592 mb_mean=0.5029 norm_overlap=0.9936 corr_cb=-0.2794
[EPOCH 035/089] train: loss=0.7985 acc=74.23% | val: loss=0.7461 acc=60.24% f1=62.07% auc=60.47% val_score=54.4113 val_score_bestthr=54.4113 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.259, mb=0.503, no=0.994, corr=-0.279) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4967 -> 54.4113
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2619 mb_mean=0.4988 norm_overlap=0.9956 corr_cb=-0.1928 topkJ=0.0361
[TRAIN][ep=036] loss=0.7860 acc=74.50%
[TRAIN][ep=036] mask_avg: mc_mean=0.2564 mb_mean=0.5029 norm_overlap=0.9936 corr_cb=-0.2767
[EPOCH 036/089] train: loss=0.7860 acc=74.50% | val: loss=0.7552 acc=57.83% f1=58.82% auc=60.47% val_score=51.5799 val_score_bestthr=51.5799 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.256, mb=0.503, no=0.994, corr=-0.277) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4967 -> 51.5799
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.2563 mb_mean=0.4998 norm_overlap=0.9945 corr_cb=-0.2287 topkJ=0.0165
[TRAIN][ep=037] loss=0.7895 acc=74.36%
[TRAIN][ep=037] mask_avg: mc_mean=0.2623 mb_mean=0.5029 norm_overlap=0.9933 corr_cb=-0.2928
[EPOCH 037/089] train: loss=0.7895 acc=74.36% | val: loss=0.7496 acc=60.24% f1=62.07% auc=60.87% val_score=54.4113 val_score_bestthr=54.4113 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.262, mb=0.503, no=0.993, corr=-0.293) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4967 -> 54.4113
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2802 mb_mean=0.5025 norm_overlap=0.9891 corr_cb=-0.3604 topkJ=0.0020
[TRAIN][ep=038] loss=0.7985 acc=73.83%
[TRAIN][ep=038] mask_avg: mc_mean=0.2899 mb_mean=0.5029 norm_overlap=0.9929 corr_cb=-0.3309
[EPOCH 038/089] train: loss=0.7985 acc=73.83% | val: loss=0.7478 acc=63.86% f1=68.75% auc=60.23% val_score=60.4218 val_score_bestthr=60.4218 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.290, mb=0.503, no=0.993, corr=-0.331) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4967 -> 60.4218
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2400 mb_mean=0.5026 norm_overlap=0.9953 corr_cb=-0.1967 topkJ=0.0132
[TRAIN][ep=039] loss=0.7767 acc=74.77%
[TRAIN][ep=039] mask_avg: mc_mean=0.2564 mb_mean=0.5029 norm_overlap=0.9934 corr_cb=-0.2864
[EPOCH 039/089] train: loss=0.7767 acc=74.77% | val: loss=0.7479 acc=61.45% f1=64.44% auc=60.35% val_score=51.4306 val_score_bestthr=51.4306 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.256, mb=0.503, no=0.993, corr=-0.286) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4967 -> 51.4306
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.2169 mb_mean=0.4982 norm_overlap=0.9942 corr_cb=-0.2714 topkJ=0.0111
[TRAIN][ep=040] loss=0.7855 acc=73.42%
[TRAIN][ep=040] mask_avg: mc_mean=0.2629 mb_mean=0.5029 norm_overlap=0.9932 corr_cb=-0.2960
[EPOCH 040/089] train: loss=0.7855 acc=73.42% | val: loss=0.7544 acc=57.83% f1=57.83% auc=60.70% val_score=53.4478 val_score_bestthr=53.4478 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.263, mb=0.503, no=0.993, corr=-0.296) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4967 -> 53.4478
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.2725 mb_mean=0.5057 norm_overlap=0.9975 corr_cb=-0.1307 topkJ=0.0425
[TRAIN][ep=041] loss=0.7729 acc=75.17%
[TRAIN][ep=041] mask_avg: mc_mean=0.2654 mb_mean=0.5029 norm_overlap=0.9932 corr_cb=-0.2957
[EPOCH 041/089] train: loss=0.7729 acc=75.17% | val: loss=0.7641 acc=57.83% f1=55.70% auc=62.09% val_score=45.2572 val_score_bestthr=45.2572 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.265, mb=0.503, no=0.993, corr=-0.296) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4967 -> 45.2572
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.1964 mb_mean=0.4989 norm_overlap=0.9966 corr_cb=-0.0891 topkJ=0.0411
[TRAIN][ep=042] loss=0.7732 acc=74.23%
[TRAIN][ep=042] mask_avg: mc_mean=0.2496 mb_mean=0.5029 norm_overlap=0.9934 corr_cb=-0.2748
[EPOCH 042/089] train: loss=0.7732 acc=74.23% | val: loss=0.7403 acc=61.45% f1=65.96% auc=61.40% val_score=55.5219 val_score_bestthr=55.5219 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.250, mb=0.503, no=0.993, corr=-0.275) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4967 -> 55.5219
[EARLY STOP] no improvement for 30 epochs. best_epoch=12
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
=============== FIT DONE ===============
[BEST] epoch=12 | val_acc=60.24% | val_f1=71.79% | val_auc=57.33% | val_score=67.4967 | val_score_bestthr=67.4967
[TEST@BEST] thr_used=0.450 | acc=59.90% f1=70.46% auc=68.73% | SP_sex=12.24% EO_sex=3.41% SP_age=15.20% EO_age=16.00%
[TIME] 0.94 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/summary_fold_3.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5042 mb_mean=0.5040 norm_overlap=1.0001 corr_cb=0.1951 topkJ=0.1574
[TRAIN][ep=000] loss=0.6944 acc=49.53%
[TRAIN][ep=000] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0819
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5061 mb_mean=0.5005 norm_overlap=1.0000 corr_cb=0.1183 topkJ=0.0577
[TRAIN][ep=001] loss=0.6937 acc=51.14%
[TRAIN][ep=001] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0801
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5044 mb_mean=0.5040 norm_overlap=1.0000 corr_cb=0.0722 topkJ=0.0959
[TRAIN][ep=002] loss=0.6913 acc=54.63%
[TRAIN][ep=002] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0784
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5035 mb_mean=0.4968 norm_overlap=1.0002 corr_cb=0.3148 topkJ=0.1021
[TRAIN][ep=003] loss=0.6896 acc=51.95%
[TRAIN][ep=003] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0800
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5044 mb_mean=0.5048 norm_overlap=1.0001 corr_cb=0.2160 topkJ=0.0656
[TRAIN][ep=004] loss=0.6894 acc=54.23%
[TRAIN][ep=004] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0800
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5067 mb_mean=0.5067 norm_overlap=1.0001 corr_cb=0.1932 topkJ=0.0734
[TRAIN][ep=005] loss=0.6867 acc=53.69%
[TRAIN][ep=005] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0823
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5065 mb_mean=0.5067 norm_overlap=1.0000 corr_cb=-0.0363 topkJ=0.1013
[TRAIN][ep=006] loss=0.6844 acc=55.97%
[TRAIN][ep=006] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0796
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5062 mb_mean=0.5019 norm_overlap=1.0001 corr_cb=0.3117 topkJ=0.2049
[TRAIN][ep=007] loss=0.6865 acc=55.44%
[TRAIN][ep=007] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0800
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5025 mb_mean=0.5033 norm_overlap=1.0000 corr_cb=-0.0452 topkJ=0.0691
[TRAIN][ep=008] loss=0.6797 acc=59.87%
[TRAIN][ep=008] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0804
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5034 mb_mean=0.5057 norm_overlap=1.0001 corr_cb=0.1863 topkJ=0.0624
[TRAIN][ep=009] loss=0.6760 acc=59.19%
[TRAIN][ep=009] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0876
================= FIT START (fold=3) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5055 mb_mean=0.5024 norm_overlap=0.9999 corr_cb=-0.0929 topkJ=0.0409
[TRAIN][ep=000] loss=0.6714 acc=61.34%
[TRAIN][ep=000] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0802
[EPOCH 000/089] train: loss=0.6714 acc=61.34% | val: loss=0.6915 acc=57.83% f1=70.59% auc=51.86% val_score=42.8972 val_score_bestthr=61.2371 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.080) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 61.2371
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5046 mb_mean=0.4991 norm_overlap=1.0000 corr_cb=0.0132 topkJ=0.0779
[TRAIN][ep=001] loss=0.6660 acc=61.88%
[TRAIN][ep=001] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0802
[EPOCH 001/089] train: loss=0.6660 acc=61.88% | val: loss=0.7107 acc=55.42% f1=68.38% auc=48.90% val_score=36.9276 val_score_bestthr=57.1990 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.080) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.2371 -> 57.1990
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5047 mb_mean=0.5037 norm_overlap=1.0002 corr_cb=0.2934 topkJ=0.0559
[TRAIN][ep=002] loss=0.6642 acc=60.54%
[TRAIN][ep=002] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0808
[EPOCH 002/089] train: loss=0.6642 acc=60.54% | val: loss=0.6896 acc=60.24% f1=72.27% auc=54.36% val_score=43.6583 val_score_bestthr=67.7099 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.081) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 61.2371 -> 67.7099
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5066 mb_mean=0.5041 norm_overlap=1.0001 corr_cb=0.1759 topkJ=0.1404
[TRAIN][ep=003] loss=0.6611 acc=60.54%
[TRAIN][ep=003] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0798
[EPOCH 003/089] train: loss=0.6611 acc=60.54% | val: loss=0.6973 acc=57.83% f1=67.89% auc=52.21% val_score=32.5867 val_score_bestthr=63.2593 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.080) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.7099 -> 63.2593
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5061 mb_mean=0.5050 norm_overlap=1.0000 corr_cb=0.0586 topkJ=0.0847
[TRAIN][ep=004] loss=0.6532 acc=62.15%
[TRAIN][ep=004] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0832
[EPOCH 004/089] train: loss=0.6532 acc=62.15% | val: loss=0.6920 acc=61.45% f1=71.93% auc=57.21% val_score=60.7211 val_score_bestthr=64.5440 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.083) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.7099 -> 64.5440
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5043 mb_mean=0.5027 norm_overlap=1.0001 corr_cb=0.2297 topkJ=0.0605
[TRAIN][ep=005] loss=1.3514 acc=62.28%
[TRAIN][ep=005] mask_avg: mc_mean=0.3692 mb_mean=0.5029 norm_overlap=1.0023 corr_cb=0.5971
[EPOCH 005/089] train: loss=1.3514 acc=62.28% | val: loss=0.6864 acc=60.24% f1=71.79% auc=57.62% val_score=52.5376 val_score_bestthr=67.4967 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.369, mb=0.503, no=1.002, corr=0.597) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.7099 -> 67.4967
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2905 mb_mean=0.5054 norm_overlap=1.0017 corr_cb=0.4241 topkJ=0.1822
[TRAIN][ep=006] loss=1.3423 acc=64.03%
[TRAIN][ep=006] mask_avg: mc_mean=0.2713 mb_mean=0.5029 norm_overlap=1.0041 corr_cb=0.5797
[EPOCH 006/089] train: loss=1.3423 acc=64.03% | val: loss=0.6953 acc=57.83% f1=70.09% auc=55.06% val_score=35.3805 val_score_bestthr=62.8622 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.271, mb=0.503, no=1.004, corr=0.580) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.7099 -> 62.8622
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2505 mb_mean=0.5008 norm_overlap=1.0032 corr_cb=0.5184 topkJ=0.2257
[TRAIN][ep=007] loss=1.3408 acc=62.82%
[TRAIN][ep=007] mask_avg: mc_mean=0.2581 mb_mean=0.5029 norm_overlap=1.0040 corr_cb=0.5082
[EPOCH 007/089] train: loss=1.3408 acc=62.82% | val: loss=0.6945 acc=59.04% f1=71.67% auc=58.60% val_score=59.5466 val_score_bestthr=67.9254 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.258, mb=0.503, no=1.004, corr=0.508) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 67.7099 -> 67.9254
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2385 mb_mean=0.4971 norm_overlap=1.0063 corr_cb=0.6447 topkJ=0.1936
[TRAIN][ep=008] loss=1.3419 acc=62.15%
[TRAIN][ep=008] mask_avg: mc_mean=0.2627 mb_mean=0.5029 norm_overlap=1.0034 corr_cb=0.4312
[EPOCH 008/089] train: loss=1.3419 acc=62.15% | val: loss=0.6884 acc=62.65% f1=69.31% auc=57.73% val_score=50.2800 val_score_bestthr=61.5383 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.263, mb=0.503, no=1.003, corr=0.431) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 61.5383
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2211 mb_mean=0.4964 norm_overlap=1.0031 corr_cb=0.4628 topkJ=0.1979
[TRAIN][ep=009] loss=1.3256 acc=65.64%
[TRAIN][ep=009] mask_avg: mc_mean=0.2450 mb_mean=0.5029 norm_overlap=1.0034 corr_cb=0.3710
[EPOCH 009/089] train: loss=1.3256 acc=65.64% | val: loss=0.6931 acc=59.04% f1=71.67% auc=56.28% val_score=45.1171 val_score_bestthr=67.9254 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.245, mb=0.503, no=1.003, corr=0.371) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 67.9254
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.2487 mb_mean=0.5031 norm_overlap=1.0028 corr_cb=0.2871 topkJ=0.1291
[TRAIN][ep=010] loss=1.3190 acc=65.77%
[TRAIN][ep=010] mask_avg: mc_mean=0.2387 mb_mean=0.5029 norm_overlap=1.0028 corr_cb=0.2740
[EPOCH 010/089] train: loss=1.3190 acc=65.77% | val: loss=0.6947 acc=61.45% f1=72.88% auc=57.85% val_score=57.5501 val_score_bestthr=71.2933 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.239, mb=0.503, no=1.003, corr=0.274) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 67.9254 -> 71.2933
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.2581 mb_mean=0.5027 norm_overlap=1.0012 corr_cb=0.1365 topkJ=0.0554
[TRAIN][ep=011] loss=1.3080 acc=65.64%
[TRAIN][ep=011] mask_avg: mc_mean=0.2302 mb_mean=0.5029 norm_overlap=1.0021 corr_cb=0.1713
[EPOCH 011/089] train: loss=1.3080 acc=65.64% | val: loss=0.7262 acc=59.04% f1=71.67% auc=55.35% val_score=33.8440 val_score_bestthr=66.4943 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.230, mb=0.503, no=1.002, corr=0.171) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 66.4943
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.2437 mb_mean=0.5058 norm_overlap=1.0014 corr_cb=0.1186 topkJ=0.0584
[TRAIN][ep=012] loss=1.3080 acc=66.71%
[TRAIN][ep=012] mask_avg: mc_mean=0.2254 mb_mean=0.5029 norm_overlap=1.0015 corr_cb=0.1127
[EPOCH 012/089] train: loss=1.3080 acc=66.71% | val: loss=0.7131 acc=60.24% f1=72.27% auc=59.01% val_score=56.1506 val_score_bestthr=67.9849 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.225, mb=0.503, no=1.002, corr=0.113) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.9849
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.2499 mb_mean=0.5051 norm_overlap=0.9996 corr_cb=-0.0384 topkJ=0.0543
[TRAIN][ep=013] loss=1.3044 acc=66.85%
[TRAIN][ep=013] mask_avg: mc_mean=0.2452 mb_mean=0.5029 norm_overlap=1.0003 corr_cb=0.0189
[EPOCH 013/089] train: loss=1.3044 acc=66.85% | val: loss=0.7098 acc=61.45% f1=69.81% auc=56.86% val_score=42.6525 val_score_bestthr=64.2778 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.245, mb=0.503, no=1.000, corr=0.019) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 64.2778
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.2257 mb_mean=0.5041 norm_overlap=0.9972 corr_cb=-0.2303 topkJ=0.0168
[TRAIN][ep=014] loss=1.2883 acc=67.79%
[TRAIN][ep=014] mask_avg: mc_mean=0.2193 mb_mean=0.5029 norm_overlap=1.0003 corr_cb=0.0197
[EPOCH 014/089] train: loss=1.2883 acc=67.79% | val: loss=0.7062 acc=59.04% f1=71.67% auc=58.66% val_score=46.2282 val_score_bestthr=67.9254 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.219, mb=0.503, no=1.000, corr=0.020) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.9254
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1714 mb_mean=0.5008 norm_overlap=1.0028 corr_cb=0.1511 topkJ=0.0388
[TRAIN][ep=015] loss=1.2810 acc=69.40%
[TRAIN][ep=015] mask_avg: mc_mean=0.2203 mb_mean=0.5029 norm_overlap=0.9994 corr_cb=-0.0429
[EPOCH 015/089] train: loss=1.2810 acc=69.40% | val: loss=0.7058 acc=61.45% f1=72.41% auc=59.42% val_score=56.2000 val_score_bestthr=65.1127 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.220, mb=0.503, no=0.999, corr=-0.043) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 65.1127
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.2588 mb_mean=0.5040 norm_overlap=0.9950 corr_cb=-0.2840 topkJ=0.0122
[TRAIN][ep=016] loss=1.0837 acc=68.86%
[TRAIN][ep=016] mask_avg: mc_mean=0.2299 mb_mean=0.5029 norm_overlap=0.9986 corr_cb=-0.0896
[EPOCH 016/089] train: loss=1.0837 acc=68.86% | val: loss=0.7374 acc=61.45% f1=72.41% auc=60.35% val_score=55.0451 val_score_bestthr=67.4771 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.230, mb=0.503, no=0.999, corr=-0.090) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.4771
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.2269 mb_mean=0.5001 norm_overlap=0.9975 corr_cb=-0.1162 topkJ=0.0136
[TRAIN][ep=017] loss=0.8972 acc=69.53%
[TRAIN][ep=017] mask_avg: mc_mean=0.2381 mb_mean=0.5029 norm_overlap=0.9978 corr_cb=-0.1381
[EPOCH 017/089] train: loss=0.8972 acc=69.53% | val: loss=0.7284 acc=60.24% f1=72.27% auc=59.83% val_score=55.4025 val_score_bestthr=69.8204 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.238, mb=0.503, no=0.998, corr=-0.138) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 69.8204
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.2532 mb_mean=0.5046 norm_overlap=0.9954 corr_cb=-0.1987 topkJ=0.0059
[TRAIN][ep=018] loss=0.8554 acc=71.81%
[TRAIN][ep=018] mask_avg: mc_mean=0.2273 mb_mean=0.5029 norm_overlap=0.9974 corr_cb=-0.1463
[EPOCH 018/089] train: loss=0.8554 acc=71.81% | val: loss=0.7223 acc=60.24% f1=72.27% auc=60.29% val_score=53.8018 val_score_bestthr=69.8204 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.227, mb=0.503, no=0.997, corr=-0.146) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 69.8204
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.2221 mb_mean=0.5051 norm_overlap=0.9936 corr_cb=-0.3397 topkJ=0.0095
[TRAIN][ep=019] loss=0.8498 acc=68.99%
[TRAIN][ep=019] mask_avg: mc_mean=0.2439 mb_mean=0.5029 norm_overlap=0.9966 corr_cb=-0.1978
[EPOCH 019/089] train: loss=0.8498 acc=68.99% | val: loss=0.7327 acc=62.65% f1=69.31% auc=59.07% val_score=48.8609 val_score_bestthr=65.2642 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.244, mb=0.503, no=0.997, corr=-0.198) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 65.2642
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.2831 mb_mean=0.5115 norm_overlap=0.9920 corr_cb=-0.4373 topkJ=0.0024
[TRAIN][ep=020] loss=0.8323 acc=71.14%
[TRAIN][ep=020] mask_avg: mc_mean=0.2353 mb_mean=0.5029 norm_overlap=0.9964 corr_cb=-0.1959
[EPOCH 020/089] train: loss=0.8323 acc=71.14% | val: loss=0.7347 acc=61.45% f1=68.63% auc=59.36% val_score=36.5251 val_score_bestthr=64.1546 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.235, mb=0.503, no=0.996, corr=-0.196) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 64.1546
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2310 mb_mean=0.5054 norm_overlap=0.9977 corr_cb=-0.1421 topkJ=0.0292
[TRAIN][ep=021] loss=0.8258 acc=72.48%
[TRAIN][ep=021] mask_avg: mc_mean=0.2405 mb_mean=0.5029 norm_overlap=0.9958 corr_cb=-0.2188
[EPOCH 021/089] train: loss=0.8258 acc=72.48% | val: loss=0.7230 acc=61.45% f1=72.41% auc=61.57% val_score=56.0663 val_score_bestthr=67.4771 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.240, mb=0.503, no=0.996, corr=-0.219) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.4771
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2476 mb_mean=0.5063 norm_overlap=0.9969 corr_cb=-0.1880 topkJ=0.0236
[TRAIN][ep=022] loss=0.8244 acc=73.29%
[TRAIN][ep=022] mask_avg: mc_mean=0.2589 mb_mean=0.5029 norm_overlap=0.9953 corr_cb=-0.2446
[EPOCH 022/089] train: loss=0.8244 acc=73.29% | val: loss=0.7386 acc=61.45% f1=72.41% auc=61.51% val_score=62.0186 val_score_bestthr=67.4771 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.259, mb=0.503, no=0.995, corr=-0.245) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.4771
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2405 mb_mean=0.4990 norm_overlap=0.9981 corr_cb=-0.1097 topkJ=0.0325
[TRAIN][ep=023] loss=0.8248 acc=71.41%
[TRAIN][ep=023] mask_avg: mc_mean=0.2570 mb_mean=0.5029 norm_overlap=0.9952 corr_cb=-0.2510
[EPOCH 023/089] train: loss=0.8248 acc=71.41% | val: loss=0.7303 acc=60.24% f1=71.79% auc=60.41% val_score=53.8018 val_score_bestthr=65.1322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.257, mb=0.503, no=0.995, corr=-0.251) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 65.1322
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2563 mb_mean=0.4986 norm_overlap=0.9955 corr_cb=-0.2510 topkJ=0.0170
[TRAIN][ep=024] loss=0.8222 acc=71.81%
[TRAIN][ep=024] mask_avg: mc_mean=0.2582 mb_mean=0.5029 norm_overlap=0.9950 corr_cb=-0.2546
[EPOCH 024/089] train: loss=0.8222 acc=71.81% | val: loss=0.7425 acc=61.45% f1=68.63% auc=60.93% val_score=34.2967 val_score_bestthr=63.4079 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.258, mb=0.503, no=0.995, corr=-0.255) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 63.4079
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1885 mb_mean=0.5043 norm_overlap=0.9910 corr_cb=-0.3530 topkJ=0.0050
[TRAIN][ep=025] loss=0.8080 acc=73.29%
[TRAIN][ep=025] mask_avg: mc_mean=0.2581 mb_mean=0.5029 norm_overlap=0.9948 corr_cb=-0.2626
[EPOCH 025/089] train: loss=0.8080 acc=73.29% | val: loss=0.7135 acc=61.45% f1=72.41% auc=62.85% val_score=54.4113 val_score_bestthr=67.4771 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.258, mb=0.503, no=0.995, corr=-0.263) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.4771
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2375 mb_mean=0.5065 norm_overlap=0.9934 corr_cb=-0.3443 topkJ=0.0049
[TRAIN][ep=026] loss=0.7963 acc=73.15%
[TRAIN][ep=026] mask_avg: mc_mean=0.2503 mb_mean=0.5029 norm_overlap=0.9948 corr_cb=-0.2574
[EPOCH 026/089] train: loss=0.7963 acc=73.15% | val: loss=0.7243 acc=61.45% f1=72.41% auc=62.15% val_score=53.5181 val_score_bestthr=67.4771 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.250, mb=0.503, no=0.995, corr=-0.257) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.4771
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2291 mb_mean=0.4994 norm_overlap=0.9927 corr_cb=-0.2958 topkJ=0.0209
[TRAIN][ep=027] loss=0.7912 acc=75.17%
[TRAIN][ep=027] mask_avg: mc_mean=0.2394 mb_mean=0.5029 norm_overlap=0.9949 corr_cb=-0.2444
[EPOCH 027/089] train: loss=0.7912 acc=75.17% | val: loss=0.7256 acc=61.45% f1=72.41% auc=62.33% val_score=53.4051 val_score_bestthr=67.4771 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.239, mb=0.503, no=0.995, corr=-0.244) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.4771
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2450 mb_mean=0.5002 norm_overlap=0.9951 corr_cb=-0.2088 topkJ=0.0511
[TRAIN][ep=028] loss=0.8072 acc=73.56%
[TRAIN][ep=028] mask_avg: mc_mean=0.2631 mb_mean=0.5029 norm_overlap=0.9944 corr_cb=-0.2802
[EPOCH 028/089] train: loss=0.8072 acc=73.56% | val: loss=0.7444 acc=63.86% f1=70.00% auc=62.62% val_score=40.1437 val_score_bestthr=65.6291 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.263, mb=0.503, no=0.994, corr=-0.280) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 65.6291
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2817 mb_mean=0.5037 norm_overlap=0.9916 corr_cb=-0.3841 topkJ=0.0073
[TRAIN][ep=029] loss=0.8012 acc=74.09%
[TRAIN][ep=029] mask_avg: mc_mean=0.2743 mb_mean=0.5029 norm_overlap=0.9942 corr_cb=-0.2977
[EPOCH 029/089] train: loss=0.8012 acc=74.09% | val: loss=0.7267 acc=65.06% f1=71.29% auc=62.67% val_score=53.4051 val_score_bestthr=68.1515 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.274, mb=0.503, no=0.994, corr=-0.298) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 68.1515
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2616 mb_mean=0.4993 norm_overlap=0.9977 corr_cb=-0.1233 topkJ=0.0210
[TRAIN][ep=030] loss=0.8006 acc=73.29%
[TRAIN][ep=030] mask_avg: mc_mean=0.2821 mb_mean=0.5029 norm_overlap=0.9938 corr_cb=-0.3130
[EPOCH 030/089] train: loss=0.8006 acc=73.29% | val: loss=0.7848 acc=66.27% f1=73.58% auc=62.21% val_score=63.9939 val_score_bestthr=66.8805 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.282, mb=0.503, no=0.994, corr=-0.313) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 66.8805
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.3112 mb_mean=0.4945 norm_overlap=0.9928 corr_cb=-0.4202 topkJ=0.0168
[TRAIN][ep=031] loss=0.8016 acc=71.68%
[TRAIN][ep=031] mask_avg: mc_mean=0.2794 mb_mean=0.5029 norm_overlap=0.9941 corr_cb=-0.3006
[EPOCH 031/089] train: loss=0.8016 acc=71.68% | val: loss=0.7545 acc=63.86% f1=70.00% auc=62.67% val_score=41.3782 val_score_bestthr=65.6291 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.279, mb=0.503, no=0.994, corr=-0.301) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 65.6291
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1812 mb_mean=0.5035 norm_overlap=0.9963 corr_cb=-0.1912 topkJ=0.0233
[TRAIN][ep=032] loss=0.7861 acc=73.56%
[TRAIN][ep=032] mask_avg: mc_mean=0.2702 mb_mean=0.5029 norm_overlap=0.9944 corr_cb=-0.2813
[EPOCH 032/089] train: loss=0.7861 acc=73.56% | val: loss=0.7381 acc=65.06% f1=71.29% auc=62.97% val_score=60.9059 val_score_bestthr=68.1515 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.270, mb=0.503, no=0.994, corr=-0.281) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 68.1515
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2478 mb_mean=0.5076 norm_overlap=0.9918 corr_cb=-0.3581 topkJ=0.0012
[TRAIN][ep=033] loss=0.7748 acc=73.83%
[TRAIN][ep=033] mask_avg: mc_mean=0.2790 mb_mean=0.5029 norm_overlap=0.9942 corr_cb=-0.2978
[EPOCH 033/089] train: loss=0.7748 acc=73.83% | val: loss=0.7305 acc=66.27% f1=70.83% auc=63.26% val_score=50.8055 val_score_bestthr=67.2661 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.279, mb=0.503, no=0.994, corr=-0.298) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.2661
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1328 mb_mean=0.5064 norm_overlap=0.9955 corr_cb=-0.1494 topkJ=0.0103
[TRAIN][ep=034] loss=0.7645 acc=75.17%
[TRAIN][ep=034] mask_avg: mc_mean=0.2413 mb_mean=0.5029 norm_overlap=0.9944 corr_cb=-0.2524
[EPOCH 034/089] train: loss=0.7645 acc=75.17% | val: loss=0.7233 acc=65.06% f1=71.29% auc=63.72% val_score=53.8664 val_score_bestthr=68.1515 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.241, mb=0.503, no=0.994, corr=-0.252) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 68.1515
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2092 mb_mean=0.4981 norm_overlap=0.9974 corr_cb=-0.1124 topkJ=0.0157
[TRAIN][ep=035] loss=0.7617 acc=74.90%
[TRAIN][ep=035] mask_avg: mc_mean=0.2628 mb_mean=0.5029 norm_overlap=0.9939 corr_cb=-0.2864
[EPOCH 035/089] train: loss=0.7617 acc=74.90% | val: loss=0.7559 acc=65.06% f1=70.71% auc=62.44% val_score=49.5398 val_score_bestthr=66.7428 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.263, mb=0.503, no=0.994, corr=-0.286) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 66.7428
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2899 mb_mean=0.4988 norm_overlap=0.9953 corr_cb=-0.2324 topkJ=0.0382
[TRAIN][ep=036] loss=0.7461 acc=76.51%
[TRAIN][ep=036] mask_avg: mc_mean=0.2633 mb_mean=0.5029 norm_overlap=0.9938 corr_cb=-0.2887
[EPOCH 036/089] train: loss=0.7461 acc=76.51% | val: loss=0.7569 acc=66.27% f1=72.00% auc=62.79% val_score=52.7263 val_score_bestthr=69.2661 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.263, mb=0.503, no=0.994, corr=-0.289) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 69.2661
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.2944 mb_mean=0.4998 norm_overlap=0.9945 corr_cb=-0.2800 topkJ=0.0141
[TRAIN][ep=037] loss=0.7471 acc=76.38%
[TRAIN][ep=037] mask_avg: mc_mean=0.2555 mb_mean=0.5029 norm_overlap=0.9936 corr_cb=-0.2893
[EPOCH 037/089] train: loss=0.7471 acc=76.38% | val: loss=0.7503 acc=62.65% f1=73.04% auc=62.56% val_score=53.4478 val_score_bestthr=67.4592 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.256, mb=0.503, no=0.994, corr=-0.289) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.4592
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2813 mb_mean=0.5025 norm_overlap=0.9890 corr_cb=-0.3783 topkJ=0.0008
[TRAIN][ep=038] loss=0.7549 acc=75.97%
[TRAIN][ep=038] mask_avg: mc_mean=0.3086 mb_mean=0.5029 norm_overlap=0.9929 corr_cb=-0.3615
[EPOCH 038/089] train: loss=0.7549 acc=75.97% | val: loss=0.7842 acc=63.86% f1=70.00% auc=61.69% val_score=62.4156 val_score_bestthr=64.8202 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.309, mb=0.503, no=0.993, corr=-0.361) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 64.8202
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2484 mb_mean=0.5026 norm_overlap=0.9949 corr_cb=-0.2393 topkJ=0.0198
[TRAIN][ep=039] loss=0.7349 acc=76.91%
[TRAIN][ep=039] mask_avg: mc_mean=0.2538 mb_mean=0.5029 norm_overlap=0.9938 corr_cb=-0.2856
[EPOCH 039/089] train: loss=0.7349 acc=76.91% | val: loss=0.7576 acc=65.06% f1=71.29% auc=61.86% val_score=52.5084 val_score_bestthr=68.1515 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.254, mb=0.503, no=0.994, corr=-0.286) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 68.1515
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.2216 mb_mean=0.4982 norm_overlap=0.9955 corr_cb=-0.2340 topkJ=0.0195
[TRAIN][ep=040] loss=0.7427 acc=75.30%
[TRAIN][ep=040] mask_avg: mc_mean=0.2760 mb_mean=0.5029 norm_overlap=0.9932 corr_cb=-0.3198
[EPOCH 040/089] train: loss=0.7427 acc=75.30% | val: loss=0.7530 acc=65.06% f1=71.29% auc=62.38% val_score=55.0225 val_score_bestthr=68.1515 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.276, mb=0.503, no=0.993, corr=-0.320) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 68.1515
[EARLY STOP] no improvement for 30 epochs. best_epoch=10
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
=============== FIT DONE ===============
[BEST] epoch=10 | val_acc=61.45% | val_f1=72.88% | val_auc=57.85% | val_score=57.5501 | val_score_bestthr=71.2933
[TEST@BEST] thr_used=0.395 | acc=59.90% f1=71.48% auc=70.45% | SP_sex=9.65% EO_sex=2.47% SP_age=10.69% EO_age=8.00%
[TIME] 0.94 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/summary_fold_3.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5042 mb_mean=0.5040 norm_overlap=1.0001 corr_cb=0.1951 topkJ=0.1574
[TRAIN][ep=000] loss=0.6944 acc=49.53%
[TRAIN][ep=000] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0819
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5061 mb_mean=0.5005 norm_overlap=1.0000 corr_cb=0.1183 topkJ=0.0577
[TRAIN][ep=001] loss=0.6937 acc=51.14%
[TRAIN][ep=001] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0801
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5044 mb_mean=0.5040 norm_overlap=1.0000 corr_cb=0.0722 topkJ=0.0959
[TRAIN][ep=002] loss=0.6913 acc=54.63%
[TRAIN][ep=002] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0784
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5035 mb_mean=0.4968 norm_overlap=1.0002 corr_cb=0.3148 topkJ=0.1021
[TRAIN][ep=003] loss=0.6896 acc=51.95%
[TRAIN][ep=003] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0800
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5044 mb_mean=0.5048 norm_overlap=1.0001 corr_cb=0.2160 topkJ=0.0656
[TRAIN][ep=004] loss=0.6894 acc=54.23%
[TRAIN][ep=004] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0800
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5067 mb_mean=0.5067 norm_overlap=1.0001 corr_cb=0.1932 topkJ=0.0734
[TRAIN][ep=005] loss=0.6867 acc=53.69%
[TRAIN][ep=005] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0823
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5065 mb_mean=0.5067 norm_overlap=1.0000 corr_cb=-0.0363 topkJ=0.1013
[TRAIN][ep=006] loss=0.6844 acc=55.97%
[TRAIN][ep=006] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0796
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5062 mb_mean=0.5019 norm_overlap=1.0001 corr_cb=0.3117 topkJ=0.2049
[TRAIN][ep=007] loss=0.6865 acc=55.44%
[TRAIN][ep=007] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0800
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5025 mb_mean=0.5033 norm_overlap=1.0000 corr_cb=-0.0452 topkJ=0.0691
[TRAIN][ep=008] loss=0.6797 acc=60.00%
[TRAIN][ep=008] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0804
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5034 mb_mean=0.5057 norm_overlap=1.0001 corr_cb=0.1863 topkJ=0.0624
[TRAIN][ep=009] loss=0.6760 acc=59.19%
[TRAIN][ep=009] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0876
================= FIT START (fold=3) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5055 mb_mean=0.5024 norm_overlap=0.9999 corr_cb=-0.0929 topkJ=0.0409
[TRAIN][ep=000] loss=0.6714 acc=61.34%
[TRAIN][ep=000] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0802
[EPOCH 000/089] train: loss=0.6714 acc=61.34% | val: loss=0.6915 acc=57.83% f1=70.59% auc=51.86% val_score=42.8972 val_score_bestthr=61.2371 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.080) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 61.2371
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5046 mb_mean=0.4991 norm_overlap=1.0000 corr_cb=0.0132 topkJ=0.0779
[TRAIN][ep=001] loss=0.6660 acc=61.88%
[TRAIN][ep=001] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0802
[EPOCH 001/089] train: loss=0.6660 acc=61.88% | val: loss=0.7107 acc=55.42% f1=68.38% auc=48.90% val_score=36.9276 val_score_bestthr=57.1990 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.080) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.2371 -> 57.1990
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5047 mb_mean=0.5037 norm_overlap=1.0002 corr_cb=0.2934 topkJ=0.0559
[TRAIN][ep=002] loss=0.6642 acc=60.54%
[TRAIN][ep=002] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0808
[EPOCH 002/089] train: loss=0.6642 acc=60.54% | val: loss=0.6896 acc=60.24% f1=72.27% auc=54.42% val_score=43.6583 val_score_bestthr=67.7099 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.081) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 61.2371 -> 67.7099
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5066 mb_mean=0.5041 norm_overlap=1.0001 corr_cb=0.1759 topkJ=0.1404
[TRAIN][ep=003] loss=0.6611 acc=60.54%
[TRAIN][ep=003] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0798
[EPOCH 003/089] train: loss=0.6611 acc=60.54% | val: loss=0.6973 acc=59.04% f1=69.09% auc=52.21% val_score=32.5867 val_score_bestthr=59.5114 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.080) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.7099 -> 59.5114
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5061 mb_mean=0.5050 norm_overlap=1.0000 corr_cb=0.0586 topkJ=0.0847
[TRAIN][ep=004] loss=0.6532 acc=62.15%
[TRAIN][ep=004] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0832
[EPOCH 004/089] train: loss=0.6532 acc=62.15% | val: loss=0.6920 acc=61.45% f1=71.93% auc=57.21% val_score=60.7211 val_score_bestthr=64.5440 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.083) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.7099 -> 64.5440
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5043 mb_mean=0.5027 norm_overlap=1.0001 corr_cb=0.2297 topkJ=0.0605
[TRAIN][ep=005] loss=1.5281 acc=62.28%
[TRAIN][ep=005] mask_avg: mc_mean=0.3718 mb_mean=0.5029 norm_overlap=1.0022 corr_cb=0.5980
[EPOCH 005/089] train: loss=1.5281 acc=62.28% | val: loss=0.6862 acc=59.04% f1=70.69% auc=57.73% val_score=52.5376 val_score_bestthr=62.2661 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.372, mb=0.503, no=1.002, corr=0.598) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.7099 -> 62.2661
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2922 mb_mean=0.5054 norm_overlap=1.0017 corr_cb=0.4269 topkJ=0.1833
[TRAIN][ep=006] loss=1.5173 acc=64.03%
[TRAIN][ep=006] mask_avg: mc_mean=0.2720 mb_mean=0.5029 norm_overlap=1.0041 corr_cb=0.5818
[EPOCH 006/089] train: loss=1.5173 acc=64.03% | val: loss=0.6952 acc=57.83% f1=70.09% auc=55.17% val_score=35.3805 val_score_bestthr=62.8622 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.272, mb=0.503, no=1.004, corr=0.582) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.7099 -> 62.8622
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2510 mb_mean=0.5008 norm_overlap=1.0032 corr_cb=0.5214 topkJ=0.2257
[TRAIN][ep=007] loss=1.5157 acc=62.82%
[TRAIN][ep=007] mask_avg: mc_mean=0.2585 mb_mean=0.5029 norm_overlap=1.0040 corr_cb=0.5118
[EPOCH 007/089] train: loss=1.5157 acc=62.82% | val: loss=0.6945 acc=59.04% f1=71.67% auc=58.72% val_score=57.2531 val_score_bestthr=67.9254 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.258, mb=0.503, no=1.004, corr=0.512) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 67.7099 -> 67.9254
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2387 mb_mean=0.4971 norm_overlap=1.0063 corr_cb=0.6507 topkJ=0.1964
[TRAIN][ep=008] loss=1.5170 acc=61.88%
[TRAIN][ep=008] mask_avg: mc_mean=0.2609 mb_mean=0.5029 norm_overlap=1.0035 corr_cb=0.4398
[EPOCH 008/089] train: loss=1.5170 acc=61.88% | val: loss=0.6882 acc=62.65% f1=69.31% auc=57.91% val_score=50.2800 val_score_bestthr=61.5383 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.261, mb=0.503, no=1.003, corr=0.440) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 61.5383
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2203 mb_mean=0.4964 norm_overlap=1.0031 corr_cb=0.4696 topkJ=0.2036
[TRAIN][ep=009] loss=1.5007 acc=65.77%
[TRAIN][ep=009] mask_avg: mc_mean=0.2453 mb_mean=0.5029 norm_overlap=1.0034 corr_cb=0.3776
[EPOCH 009/089] train: loss=1.5007 acc=65.77% | val: loss=0.6927 acc=59.04% f1=71.67% auc=56.86% val_score=45.1171 val_score_bestthr=67.9254 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.245, mb=0.503, no=1.003, corr=0.378) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 67.9254
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.2496 mb_mean=0.5031 norm_overlap=1.0028 corr_cb=0.2915 topkJ=0.1297
[TRAIN][ep=010] loss=1.4940 acc=66.04%
[TRAIN][ep=010] mask_avg: mc_mean=0.2390 mb_mean=0.5029 norm_overlap=1.0028 corr_cb=0.2796
[EPOCH 010/089] train: loss=1.4940 acc=66.04% | val: loss=0.6944 acc=61.45% f1=72.88% auc=57.67% val_score=57.5501 val_score_bestthr=71.2933 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.239, mb=0.503, no=1.003, corr=0.280) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 67.9254 -> 71.2933
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.2579 mb_mean=0.5027 norm_overlap=1.0013 corr_cb=0.1421 topkJ=0.0559
[TRAIN][ep=011] loss=1.4828 acc=65.91%
[TRAIN][ep=011] mask_avg: mc_mean=0.2303 mb_mean=0.5029 norm_overlap=1.0021 corr_cb=0.1750
[EPOCH 011/089] train: loss=1.4828 acc=65.91% | val: loss=0.7259 acc=61.45% f1=69.81% auc=55.17% val_score=36.2948 val_score_bestthr=64.6710 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.230, mb=0.503, no=1.002, corr=0.175) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 64.6710
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.2438 mb_mean=0.5058 norm_overlap=1.0014 corr_cb=0.1215 topkJ=0.0579
[TRAIN][ep=012] loss=1.4830 acc=66.85%
[TRAIN][ep=012] mask_avg: mc_mean=0.2253 mb_mean=0.5029 norm_overlap=1.0016 corr_cb=0.1144
[EPOCH 012/089] train: loss=1.4830 acc=66.85% | val: loss=0.7131 acc=61.45% f1=72.88% auc=59.13% val_score=55.0451 val_score_bestthr=69.5199 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.225, mb=0.503, no=1.002, corr=0.114) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 69.5199
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.2503 mb_mean=0.5051 norm_overlap=0.9995 corr_cb=-0.0398 topkJ=0.0539
[TRAIN][ep=013] loss=1.4787 acc=66.71%
[TRAIN][ep=013] mask_avg: mc_mean=0.2451 mb_mean=0.5029 norm_overlap=1.0003 corr_cb=0.0194
[EPOCH 013/089] train: loss=1.4787 acc=66.71% | val: loss=0.7100 acc=60.24% f1=71.79% auc=56.86% val_score=42.6525 val_score_bestthr=67.4967 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.245, mb=0.503, no=1.000, corr=0.019) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.4967
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.2261 mb_mean=0.5041 norm_overlap=0.9972 corr_cb=-0.2318 topkJ=0.0160
[TRAIN][ep=014] loss=1.4627 acc=68.19%
[TRAIN][ep=014] mask_avg: mc_mean=0.2196 mb_mean=0.5029 norm_overlap=1.0003 corr_cb=0.0181
[EPOCH 014/089] train: loss=1.4627 acc=68.19% | val: loss=0.7060 acc=59.04% f1=71.67% auc=58.72% val_score=46.2282 val_score_bestthr=67.9254 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.220, mb=0.503, no=1.000, corr=0.018) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.9254
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1703 mb_mean=0.5008 norm_overlap=1.0029 corr_cb=0.1517 topkJ=0.0388
[TRAIN][ep=015] loss=1.4554 acc=69.40%
[TRAIN][ep=015] mask_avg: mc_mean=0.2198 mb_mean=0.5029 norm_overlap=0.9994 corr_cb=-0.0440
[EPOCH 015/089] train: loss=1.4554 acc=69.40% | val: loss=0.7056 acc=61.45% f1=72.41% auc=59.59% val_score=56.2000 val_score_bestthr=65.1127 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.220, mb=0.503, no=0.999, corr=-0.044) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 65.1127
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.2576 mb_mean=0.5040 norm_overlap=0.9950 corr_cb=-0.2834 topkJ=0.0122
[TRAIN][ep=016] loss=1.1880 acc=68.72%
[TRAIN][ep=016] mask_avg: mc_mean=0.2304 mb_mean=0.5029 norm_overlap=0.9986 corr_cb=-0.0928
[EPOCH 016/089] train: loss=1.1880 acc=68.72% | val: loss=0.7370 acc=62.65% f1=73.04% auc=60.41% val_score=55.0451 val_score_bestthr=68.5792 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.230, mb=0.503, no=0.999, corr=-0.093) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 68.5792
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.2275 mb_mean=0.5001 norm_overlap=0.9975 corr_cb=-0.1188 topkJ=0.0132
[TRAIN][ep=017] loss=0.9318 acc=69.66%
[TRAIN][ep=017] mask_avg: mc_mean=0.2386 mb_mean=0.5029 norm_overlap=0.9977 corr_cb=-0.1415
[EPOCH 017/089] train: loss=0.9318 acc=69.66% | val: loss=0.7283 acc=60.24% f1=72.27% auc=59.88% val_score=55.4025 val_score_bestthr=69.8204 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.239, mb=0.503, no=0.998, corr=-0.141) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 69.8204
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.2541 mb_mean=0.5046 norm_overlap=0.9954 corr_cb=-0.2011 topkJ=0.0055
[TRAIN][ep=018] loss=0.8549 acc=71.95%
[TRAIN][ep=018] mask_avg: mc_mean=0.2279 mb_mean=0.5029 norm_overlap=0.9973 corr_cb=-0.1498
[EPOCH 018/089] train: loss=0.8549 acc=71.95% | val: loss=0.7224 acc=60.24% f1=71.79% auc=60.23% val_score=58.2943 val_score_bestthr=65.1322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.228, mb=0.503, no=0.997, corr=-0.150) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 65.1322
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.2231 mb_mean=0.5051 norm_overlap=0.9936 corr_cb=-0.3434 topkJ=0.0095
[TRAIN][ep=019] loss=0.8495 acc=69.53%
[TRAIN][ep=019] mask_avg: mc_mean=0.2446 mb_mean=0.5029 norm_overlap=0.9965 corr_cb=-0.2009
[EPOCH 019/089] train: loss=0.8495 acc=69.53% | val: loss=0.7338 acc=62.65% f1=69.31% auc=58.90% val_score=47.3702 val_score_bestthr=65.2642 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.245, mb=0.503, no=0.997, corr=-0.201) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 65.2642
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.2844 mb_mean=0.5115 norm_overlap=0.9920 corr_cb=-0.4391 topkJ=0.0024
[TRAIN][ep=020] loss=0.8319 acc=71.28%
[TRAIN][ep=020] mask_avg: mc_mean=0.2361 mb_mean=0.5029 norm_overlap=0.9963 corr_cb=-0.1989
[EPOCH 020/089] train: loss=0.8319 acc=71.28% | val: loss=0.7341 acc=61.45% f1=68.63% auc=59.48% val_score=40.1636 val_score_bestthr=64.1546 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.236, mb=0.503, no=0.996, corr=-0.199) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 64.1546
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2325 mb_mean=0.5054 norm_overlap=0.9977 corr_cb=-0.1453 topkJ=0.0292
[TRAIN][ep=021] loss=0.8253 acc=72.48%
[TRAIN][ep=021] mask_avg: mc_mean=0.2410 mb_mean=0.5029 norm_overlap=0.9958 corr_cb=-0.2210
[EPOCH 021/089] train: loss=0.8253 acc=72.48% | val: loss=0.7230 acc=61.45% f1=72.41% auc=61.45% val_score=56.0663 val_score_bestthr=67.4771 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.241, mb=0.503, no=0.996, corr=-0.221) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.4771
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2481 mb_mean=0.5063 norm_overlap=0.9968 corr_cb=-0.1909 topkJ=0.0231
[TRAIN][ep=022] loss=0.8240 acc=73.29%
[TRAIN][ep=022] mask_avg: mc_mean=0.2594 mb_mean=0.5029 norm_overlap=0.9953 corr_cb=-0.2467
[EPOCH 022/089] train: loss=0.8240 acc=73.29% | val: loss=0.7401 acc=61.45% f1=72.41% auc=61.34% val_score=58.7063 val_score_bestthr=67.4771 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.259, mb=0.503, no=0.995, corr=-0.247) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.4771
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2420 mb_mean=0.4990 norm_overlap=0.9980 corr_cb=-0.1148 topkJ=0.0317
[TRAIN][ep=023] loss=0.8246 acc=71.68%
[TRAIN][ep=023] mask_avg: mc_mean=0.2587 mb_mean=0.5029 norm_overlap=0.9951 corr_cb=-0.2543
[EPOCH 023/089] train: loss=0.8246 acc=71.68% | val: loss=0.7302 acc=61.45% f1=71.43% auc=60.47% val_score=53.8018 val_score_bestthr=61.8668 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.259, mb=0.503, no=0.995, corr=-0.254) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 61.8668
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2572 mb_mean=0.4986 norm_overlap=0.9955 corr_cb=-0.2519 topkJ=0.0170
[TRAIN][ep=024] loss=0.8217 acc=71.68%
[TRAIN][ep=024] mask_avg: mc_mean=0.2590 mb_mean=0.5029 norm_overlap=0.9950 corr_cb=-0.2563
[EPOCH 024/089] train: loss=0.8217 acc=71.68% | val: loss=0.7430 acc=61.45% f1=68.63% auc=60.93% val_score=34.2967 val_score_bestthr=63.4079 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.259, mb=0.503, no=0.995, corr=-0.256) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 63.4079
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1876 mb_mean=0.5043 norm_overlap=0.9909 corr_cb=-0.3524 topkJ=0.0050
[TRAIN][ep=025] loss=0.8073 acc=73.29%
[TRAIN][ep=025] mask_avg: mc_mean=0.2583 mb_mean=0.5029 norm_overlap=0.9948 corr_cb=-0.2636
[EPOCH 025/089] train: loss=0.8073 acc=73.29% | val: loss=0.7139 acc=61.45% f1=72.41% auc=62.67% val_score=54.4113 val_score_bestthr=67.4771 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.258, mb=0.503, no=0.995, corr=-0.264) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.4771
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2371 mb_mean=0.5065 norm_overlap=0.9934 corr_cb=-0.3426 topkJ=0.0045
[TRAIN][ep=026] loss=0.7956 acc=73.29%
[TRAIN][ep=026] mask_avg: mc_mean=0.2513 mb_mean=0.5029 norm_overlap=0.9947 corr_cb=-0.2596
[EPOCH 026/089] train: loss=0.7956 acc=73.29% | val: loss=0.7241 acc=61.45% f1=72.41% auc=62.15% val_score=54.0054 val_score_bestthr=67.4771 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.251, mb=0.503, no=0.995, corr=-0.260) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.4771
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2320 mb_mean=0.4994 norm_overlap=0.9927 corr_cb=-0.2997 topkJ=0.0205
[TRAIN][ep=027] loss=0.7904 acc=75.30%
[TRAIN][ep=027] mask_avg: mc_mean=0.2394 mb_mean=0.5029 norm_overlap=0.9948 corr_cb=-0.2450
[EPOCH 027/089] train: loss=0.7904 acc=75.30% | val: loss=0.7257 acc=61.45% f1=72.41% auc=62.33% val_score=53.4051 val_score_bestthr=67.4771 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.239, mb=0.503, no=0.995, corr=-0.245) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.4771
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2470 mb_mean=0.5002 norm_overlap=0.9951 corr_cb=-0.2106 topkJ=0.0502
[TRAIN][ep=028] loss=0.8066 acc=73.42%
[TRAIN][ep=028] mask_avg: mc_mean=0.2645 mb_mean=0.5029 norm_overlap=0.9943 corr_cb=-0.2822
[EPOCH 028/089] train: loss=0.8066 acc=73.42% | val: loss=0.7454 acc=63.86% f1=70.00% auc=62.56% val_score=40.1437 val_score_bestthr=65.6291 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.265, mb=0.503, no=0.994, corr=-0.282) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 65.6291
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2784 mb_mean=0.5037 norm_overlap=0.9916 corr_cb=-0.3803 topkJ=0.0073
[TRAIN][ep=029] loss=0.8004 acc=73.96%
[TRAIN][ep=029] mask_avg: mc_mean=0.2755 mb_mean=0.5029 norm_overlap=0.9942 corr_cb=-0.2986
[EPOCH 029/089] train: loss=0.8004 acc=73.96% | val: loss=0.7265 acc=63.86% f1=70.00% auc=62.62% val_score=53.4051 val_score_bestthr=65.6291 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.275, mb=0.503, no=0.994, corr=-0.299) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 65.6291
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2636 mb_mean=0.4993 norm_overlap=0.9976 corr_cb=-0.1256 topkJ=0.0206
[TRAIN][ep=030] loss=0.7995 acc=73.42%
[TRAIN][ep=030] mask_avg: mc_mean=0.2836 mb_mean=0.5029 norm_overlap=0.9938 corr_cb=-0.3146
[EPOCH 030/089] train: loss=0.7995 acc=73.42% | val: loss=0.7882 acc=66.27% f1=73.58% auc=62.15% val_score=63.9939 val_score_bestthr=66.8805 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.284, mb=0.503, no=0.994, corr=-0.315) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 66.8805
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.3127 mb_mean=0.4945 norm_overlap=0.9928 corr_cb=-0.4191 topkJ=0.0168
[TRAIN][ep=031] loss=0.8013 acc=71.95%
[TRAIN][ep=031] mask_avg: mc_mean=0.2797 mb_mean=0.5029 norm_overlap=0.9940 corr_cb=-0.3001
[EPOCH 031/089] train: loss=0.8013 acc=71.95% | val: loss=0.7541 acc=65.06% f1=70.71% auc=62.79% val_score=41.3782 val_score_bestthr=66.7428 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.280, mb=0.503, no=0.994, corr=-0.300) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 66.7428
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1791 mb_mean=0.5035 norm_overlap=0.9964 corr_cb=-0.1888 topkJ=0.0233
[TRAIN][ep=032] loss=0.7851 acc=73.29%
[TRAIN][ep=032] mask_avg: mc_mean=0.2721 mb_mean=0.5029 norm_overlap=0.9944 corr_cb=-0.2830
[EPOCH 032/089] train: loss=0.7851 acc=73.29% | val: loss=0.7367 acc=63.86% f1=70.00% auc=63.02% val_score=60.9059 val_score_bestthr=65.6291 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.272, mb=0.503, no=0.994, corr=-0.283) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 65.6291
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2463 mb_mean=0.5076 norm_overlap=0.9917 corr_cb=-0.3559 topkJ=0.0012
[TRAIN][ep=033] loss=0.7731 acc=73.83%
[TRAIN][ep=033] mask_avg: mc_mean=0.2790 mb_mean=0.5029 norm_overlap=0.9942 corr_cb=-0.2970
[EPOCH 033/089] train: loss=0.7731 acc=73.83% | val: loss=0.7298 acc=66.27% f1=70.83% auc=63.31% val_score=47.0040 val_score_bestthr=67.2661 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.279, mb=0.503, no=0.994, corr=-0.297) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.2661
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1328 mb_mean=0.5064 norm_overlap=0.9955 corr_cb=-0.1478 topkJ=0.0103
[TRAIN][ep=034] loss=0.7626 acc=75.70%
[TRAIN][ep=034] mask_avg: mc_mean=0.2415 mb_mean=0.5029 norm_overlap=0.9944 corr_cb=-0.2526
[EPOCH 034/089] train: loss=0.7626 acc=75.70% | val: loss=0.7236 acc=66.27% f1=72.00% auc=63.95% val_score=53.8664 val_score_bestthr=69.2661 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.241, mb=0.503, no=0.994, corr=-0.253) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 69.2661
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2099 mb_mean=0.4981 norm_overlap=0.9973 corr_cb=-0.1135 topkJ=0.0157
[TRAIN][ep=035] loss=0.7596 acc=74.77%
[TRAIN][ep=035] mask_avg: mc_mean=0.2638 mb_mean=0.5029 norm_overlap=0.9938 corr_cb=-0.2876
[EPOCH 035/089] train: loss=0.7596 acc=74.77% | val: loss=0.7567 acc=65.06% f1=70.71% auc=62.67% val_score=49.5398 val_score_bestthr=66.7428 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.264, mb=0.503, no=0.994, corr=-0.288) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 66.7428
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2951 mb_mean=0.4988 norm_overlap=0.9952 corr_cb=-0.2387 topkJ=0.0378
[TRAIN][ep=036] loss=0.7433 acc=76.38%
[TRAIN][ep=036] mask_avg: mc_mean=0.2648 mb_mean=0.5029 norm_overlap=0.9937 corr_cb=-0.2909
[EPOCH 036/089] train: loss=0.7433 acc=76.38% | val: loss=0.7568 acc=65.06% f1=71.29% auc=62.79% val_score=52.7263 val_score_bestthr=68.8982 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.265, mb=0.503, no=0.994, corr=-0.291) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 68.8982
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.2964 mb_mean=0.4998 norm_overlap=0.9945 corr_cb=-0.2801 topkJ=0.0137
[TRAIN][ep=037] loss=0.7442 acc=76.24%
[TRAIN][ep=037] mask_avg: mc_mean=0.2560 mb_mean=0.5029 norm_overlap=0.9936 corr_cb=-0.2899
[EPOCH 037/089] train: loss=0.7442 acc=76.24% | val: loss=0.7502 acc=62.65% f1=73.04% auc=62.50% val_score=53.4478 val_score_bestthr=67.4592 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.256, mb=0.503, no=0.994, corr=-0.290) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.4592
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2822 mb_mean=0.5025 norm_overlap=0.9890 corr_cb=-0.3776 topkJ=0.0008
[TRAIN][ep=038] loss=0.7518 acc=75.70%
[TRAIN][ep=038] mask_avg: mc_mean=0.3110 mb_mean=0.5029 norm_overlap=0.9929 corr_cb=-0.3640
[EPOCH 038/089] train: loss=0.7518 acc=75.70% | val: loss=0.7816 acc=66.27% f1=70.83% auc=61.80% val_score=63.5328 val_score_bestthr=63.5328 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.311, mb=0.503, no=0.993, corr=-0.364) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 63.5328
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2507 mb_mean=0.5026 norm_overlap=0.9948 corr_cb=-0.2430 topkJ=0.0198
[TRAIN][ep=039] loss=0.7313 acc=76.78%
[TRAIN][ep=039] mask_avg: mc_mean=0.2540 mb_mean=0.5029 norm_overlap=0.9937 corr_cb=-0.2852
[EPOCH 039/089] train: loss=0.7313 acc=76.78% | val: loss=0.7578 acc=65.06% f1=71.29% auc=61.63% val_score=55.0225 val_score_bestthr=68.1515 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.254, mb=0.503, no=0.994, corr=-0.285) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 68.1515
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.2213 mb_mean=0.4982 norm_overlap=0.9955 corr_cb=-0.2315 topkJ=0.0191
[TRAIN][ep=040] loss=0.7395 acc=75.17%
[TRAIN][ep=040] mask_avg: mc_mean=0.2763 mb_mean=0.5029 norm_overlap=0.9932 corr_cb=-0.3200
[EPOCH 040/089] train: loss=0.7395 acc=75.17% | val: loss=0.7521 acc=65.06% f1=71.29% auc=62.38% val_score=52.5084 val_score_bestthr=68.1515 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.276, mb=0.503, no=0.993, corr=-0.320) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 68.1515
[EARLY STOP] no improvement for 30 epochs. best_epoch=10
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
=============== FIT DONE ===============
[BEST] epoch=10 | val_acc=61.45% | val_f1=72.88% | val_auc=57.67% | val_score=57.5501 | val_score_bestthr=71.2933
[TEST@BEST] thr_used=0.400 | acc=59.90% f1=71.48% auc=70.44% | SP_sex=9.65% EO_sex=2.47% SP_age=10.69% EO_age=8.00%
[TIME] 1.07 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/summary_fold_3.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5042 mb_mean=0.5040 norm_overlap=1.0001 corr_cb=0.1951 topkJ=0.1574
[TRAIN][ep=000] loss=0.6944 acc=49.53%
[TRAIN][ep=000] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0819
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5061 mb_mean=0.5005 norm_overlap=1.0000 corr_cb=0.1183 topkJ=0.0577
[TRAIN][ep=001] loss=0.6937 acc=51.14%
[TRAIN][ep=001] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0801
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5044 mb_mean=0.5040 norm_overlap=1.0000 corr_cb=0.0722 topkJ=0.0959
[TRAIN][ep=002] loss=0.6913 acc=54.63%
[TRAIN][ep=002] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0784
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5035 mb_mean=0.4968 norm_overlap=1.0002 corr_cb=0.3148 topkJ=0.1021
[TRAIN][ep=003] loss=0.6896 acc=51.95%
[TRAIN][ep=003] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0800
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5044 mb_mean=0.5048 norm_overlap=1.0001 corr_cb=0.2160 topkJ=0.0656
[TRAIN][ep=004] loss=0.6894 acc=54.23%
[TRAIN][ep=004] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0800
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5067 mb_mean=0.5067 norm_overlap=1.0001 corr_cb=0.1932 topkJ=0.0734
[TRAIN][ep=005] loss=0.6867 acc=53.69%
[TRAIN][ep=005] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0823
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5065 mb_mean=0.5067 norm_overlap=1.0000 corr_cb=-0.0363 topkJ=0.1013
[TRAIN][ep=006] loss=0.6844 acc=55.97%
[TRAIN][ep=006] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0796
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5062 mb_mean=0.5019 norm_overlap=1.0001 corr_cb=0.3117 topkJ=0.2049
[TRAIN][ep=007] loss=0.6865 acc=55.44%
[TRAIN][ep=007] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0800
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5025 mb_mean=0.5033 norm_overlap=1.0000 corr_cb=-0.0452 topkJ=0.0691
[TRAIN][ep=008] loss=0.6797 acc=60.00%
[TRAIN][ep=008] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0804
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5034 mb_mean=0.5057 norm_overlap=1.0001 corr_cb=0.1863 topkJ=0.0624
[TRAIN][ep=009] loss=0.6760 acc=59.19%
[TRAIN][ep=009] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0876
================= FIT START (fold=3) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5055 mb_mean=0.5024 norm_overlap=0.9999 corr_cb=-0.0929 topkJ=0.0409
[TRAIN][ep=000] loss=0.6714 acc=61.34%
[TRAIN][ep=000] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0802
[EPOCH 000/089] train: loss=0.6714 acc=61.34% | val: loss=0.6915 acc=57.83% f1=70.59% auc=51.86% val_score=42.8972 val_score_bestthr=61.2371 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.080) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 61.2371
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5046 mb_mean=0.4991 norm_overlap=1.0000 corr_cb=0.0132 topkJ=0.0779
[TRAIN][ep=001] loss=0.6660 acc=61.88%
[TRAIN][ep=001] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0802
[EPOCH 001/089] train: loss=0.6660 acc=61.88% | val: loss=0.7107 acc=55.42% f1=68.38% auc=48.84% val_score=36.9276 val_score_bestthr=57.1990 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.080) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.2371 -> 57.1990
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5047 mb_mean=0.5037 norm_overlap=1.0002 corr_cb=0.2934 topkJ=0.0559
[TRAIN][ep=002] loss=0.6642 acc=60.54%
[TRAIN][ep=002] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0808
[EPOCH 002/089] train: loss=0.6642 acc=60.54% | val: loss=0.6896 acc=60.24% f1=72.27% auc=54.42% val_score=43.6583 val_score_bestthr=67.7099 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.081) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 61.2371 -> 67.7099
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5066 mb_mean=0.5041 norm_overlap=1.0001 corr_cb=0.1759 topkJ=0.1404
[TRAIN][ep=003] loss=0.6611 acc=60.54%
[TRAIN][ep=003] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0798
[EPOCH 003/089] train: loss=0.6611 acc=60.54% | val: loss=0.6974 acc=57.83% f1=67.89% auc=52.21% val_score=32.5867 val_score_bestthr=63.2593 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.080) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.7099 -> 63.2593
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5061 mb_mean=0.5050 norm_overlap=1.0000 corr_cb=0.0586 topkJ=0.0847
[TRAIN][ep=004] loss=0.6532 acc=62.15%
[TRAIN][ep=004] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0832
[EPOCH 004/089] train: loss=0.6532 acc=62.15% | val: loss=0.6920 acc=61.45% f1=71.93% auc=57.21% val_score=60.7211 val_score_bestthr=64.5440 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.083) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.7099 -> 64.5440
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5043 mb_mean=0.5027 norm_overlap=1.0001 corr_cb=0.2297 topkJ=0.0605
[TRAIN][ep=005] loss=1.4691 acc=62.42%
[TRAIN][ep=005] mask_avg: mc_mean=0.3709 mb_mean=0.5029 norm_overlap=1.0022 corr_cb=0.5976
[EPOCH 005/089] train: loss=1.4691 acc=62.42% | val: loss=0.6862 acc=60.24% f1=71.79% auc=57.62% val_score=52.5376 val_score_bestthr=67.4967 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.371, mb=0.503, no=1.002, corr=0.598) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.7099 -> 67.4967
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2916 mb_mean=0.5054 norm_overlap=1.0017 corr_cb=0.4259 topkJ=0.1828
[TRAIN][ep=006] loss=1.4590 acc=64.03%
[TRAIN][ep=006] mask_avg: mc_mean=0.2717 mb_mean=0.5029 norm_overlap=1.0041 corr_cb=0.5811
[EPOCH 006/089] train: loss=1.4590 acc=64.03% | val: loss=0.6951 acc=57.83% f1=70.09% auc=55.17% val_score=35.3805 val_score_bestthr=62.8622 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.272, mb=0.503, no=1.004, corr=0.581) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.7099 -> 62.8622
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2508 mb_mean=0.5008 norm_overlap=1.0032 corr_cb=0.5205 topkJ=0.2263
[TRAIN][ep=007] loss=1.4575 acc=62.95%
[TRAIN][ep=007] mask_avg: mc_mean=0.2583 mb_mean=0.5029 norm_overlap=1.0040 corr_cb=0.5110
[EPOCH 007/089] train: loss=1.4575 acc=62.95% | val: loss=0.6945 acc=59.04% f1=71.67% auc=58.72% val_score=57.2531 val_score_bestthr=67.9254 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.258, mb=0.503, no=1.004, corr=0.511) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 67.7099 -> 67.9254
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2387 mb_mean=0.4971 norm_overlap=1.0063 corr_cb=0.6494 topkJ=0.1964
[TRAIN][ep=008] loss=1.4587 acc=62.15%
[TRAIN][ep=008] mask_avg: mc_mean=0.2610 mb_mean=0.5029 norm_overlap=1.0035 corr_cb=0.4381
[EPOCH 008/089] train: loss=1.4587 acc=62.15% | val: loss=0.6883 acc=62.65% f1=69.31% auc=57.79% val_score=50.2800 val_score_bestthr=61.5383 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.261, mb=0.503, no=1.003, corr=0.438) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 61.5383
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2204 mb_mean=0.4964 norm_overlap=1.0031 corr_cb=0.4677 topkJ=0.2019
[TRAIN][ep=009] loss=1.4423 acc=65.64%
[TRAIN][ep=009] mask_avg: mc_mean=0.2450 mb_mean=0.5029 norm_overlap=1.0034 corr_cb=0.3763
[EPOCH 009/089] train: loss=1.4423 acc=65.64% | val: loss=0.6928 acc=59.04% f1=71.67% auc=56.74% val_score=45.1171 val_score_bestthr=67.9254 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.245, mb=0.503, no=1.003, corr=0.376) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 67.9254
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.2489 mb_mean=0.5031 norm_overlap=1.0028 corr_cb=0.2913 topkJ=0.1302
[TRAIN][ep=010] loss=1.4357 acc=65.91%
[TRAIN][ep=010] mask_avg: mc_mean=0.2391 mb_mean=0.5029 norm_overlap=1.0028 corr_cb=0.2779
[EPOCH 010/089] train: loss=1.4357 acc=65.91% | val: loss=0.6945 acc=59.04% f1=71.67% auc=57.73% val_score=57.5501 val_score_bestthr=67.9254 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.239, mb=0.503, no=1.003, corr=0.278) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 67.9254
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.2580 mb_mean=0.5027 norm_overlap=1.0013 corr_cb=0.1402 topkJ=0.0559
[TRAIN][ep=011] loss=1.4245 acc=65.77%
[TRAIN][ep=011] mask_avg: mc_mean=0.2302 mb_mean=0.5029 norm_overlap=1.0021 corr_cb=0.1734
[EPOCH 011/089] train: loss=1.4245 acc=65.77% | val: loss=0.7262 acc=61.45% f1=69.81% auc=55.12% val_score=36.2948 val_score_bestthr=64.6710 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.230, mb=0.503, no=1.002, corr=0.173) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 64.6710
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.2434 mb_mean=0.5058 norm_overlap=1.0014 corr_cb=0.1205 topkJ=0.0588
[TRAIN][ep=012] loss=1.4247 acc=66.85%
[TRAIN][ep=012] mask_avg: mc_mean=0.2251 mb_mean=0.5029 norm_overlap=1.0016 corr_cb=0.1141
[EPOCH 012/089] train: loss=1.4247 acc=66.85% | val: loss=0.7130 acc=61.45% f1=72.88% auc=59.07% val_score=55.0451 val_score_bestthr=69.5199 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.225, mb=0.503, no=1.002, corr=0.114) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 67.9254 -> 69.5199
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.2498 mb_mean=0.5051 norm_overlap=0.9996 corr_cb=-0.0381 topkJ=0.0539
[TRAIN][ep=013] loss=1.4206 acc=66.71%
[TRAIN][ep=013] mask_avg: mc_mean=0.2447 mb_mean=0.5029 norm_overlap=1.0003 corr_cb=0.0198
[EPOCH 013/089] train: loss=1.4206 acc=66.71% | val: loss=0.7100 acc=60.24% f1=71.79% auc=56.86% val_score=42.6525 val_score_bestthr=67.4967 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.245, mb=0.503, no=1.000, corr=0.020) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.5199 -> 67.4967
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.2260 mb_mean=0.5041 norm_overlap=0.9972 corr_cb=-0.2314 topkJ=0.0164
[TRAIN][ep=014] loss=1.4046 acc=67.92%
[TRAIN][ep=014] mask_avg: mc_mean=0.2191 mb_mean=0.5029 norm_overlap=1.0003 corr_cb=0.0191
[EPOCH 014/089] train: loss=1.4046 acc=67.92% | val: loss=0.7061 acc=59.04% f1=71.67% auc=58.66% val_score=46.2282 val_score_bestthr=67.9254 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.219, mb=0.503, no=1.000, corr=0.019) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.5199 -> 67.9254
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1699 mb_mean=0.5008 norm_overlap=1.0029 corr_cb=0.1526 topkJ=0.0388
[TRAIN][ep=015] loss=1.3973 acc=69.40%
[TRAIN][ep=015] mask_avg: mc_mean=0.2195 mb_mean=0.5029 norm_overlap=0.9994 corr_cb=-0.0426
[EPOCH 015/089] train: loss=1.3973 acc=69.40% | val: loss=0.7056 acc=60.24% f1=71.79% auc=59.42% val_score=56.2000 val_score_bestthr=65.1322 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.220, mb=0.503, no=0.999, corr=-0.043) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.5199 -> 65.1322
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.2582 mb_mean=0.5040 norm_overlap=0.9950 corr_cb=-0.2837 topkJ=0.0122
[TRAIN][ep=016] loss=1.3821 acc=68.72%
[TRAIN][ep=016] mask_avg: mc_mean=0.2295 mb_mean=0.5029 norm_overlap=0.9986 corr_cb=-0.0898
[EPOCH 016/089] train: loss=1.3821 acc=68.72% | val: loss=0.7365 acc=62.65% f1=73.04% auc=60.17% val_score=55.0451 val_score_bestthr=68.5792 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.229, mb=0.503, no=0.999, corr=-0.090) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.5199 -> 68.5792
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.2269 mb_mean=0.5001 norm_overlap=0.9975 corr_cb=-0.1169 topkJ=0.0136
[TRAIN][ep=017] loss=1.3788 acc=69.53%
[TRAIN][ep=017] mask_avg: mc_mean=0.2368 mb_mean=0.5029 norm_overlap=0.9977 corr_cb=-0.1380
[EPOCH 017/089] train: loss=1.3788 acc=69.53% | val: loss=0.7272 acc=60.24% f1=72.27% auc=59.94% val_score=55.4025 val_score_bestthr=69.8204 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.237, mb=0.503, no=0.998, corr=-0.138) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 69.5199 -> 69.8204
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.2520 mb_mean=0.5046 norm_overlap=0.9954 corr_cb=-0.1982 topkJ=0.0055
[TRAIN][ep=018] loss=1.3624 acc=71.68%
[TRAIN][ep=018] mask_avg: mc_mean=0.2257 mb_mean=0.5029 norm_overlap=0.9974 corr_cb=-0.1443
[EPOCH 018/089] train: loss=1.3624 acc=71.68% | val: loss=0.7206 acc=60.24% f1=71.79% auc=60.29% val_score=57.1792 val_score_bestthr=65.1322 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.226, mb=0.503, no=0.997, corr=-0.144) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.8204 -> 65.1322
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.2242 mb_mean=0.5051 norm_overlap=0.9936 corr_cb=-0.3434 topkJ=0.0091
[TRAIN][ep=019] loss=1.3715 acc=69.40%
[TRAIN][ep=019] mask_avg: mc_mean=0.2471 mb_mean=0.5029 norm_overlap=0.9965 corr_cb=-0.2032
[EPOCH 019/089] train: loss=1.3715 acc=69.40% | val: loss=0.7351 acc=62.65% f1=69.90% auc=58.95% val_score=33.6615 val_score_bestthr=65.2753 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.247, mb=0.503, no=0.996, corr=-0.203) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.8204 -> 65.2753
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.2820 mb_mean=0.5115 norm_overlap=0.9919 corr_cb=-0.4356 topkJ=0.0024
[TRAIN][ep=020] loss=1.3513 acc=71.01%
[TRAIN][ep=020] mask_avg: mc_mean=0.2370 mb_mean=0.5029 norm_overlap=0.9963 corr_cb=-0.1980
[EPOCH 020/089] train: loss=1.3513 acc=71.01% | val: loss=0.7296 acc=61.45% f1=68.63% auc=59.59% val_score=38.6057 val_score_bestthr=64.1546 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.237, mb=0.503, no=0.996, corr=-0.198) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.8204 -> 64.1546
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2321 mb_mean=0.5054 norm_overlap=0.9978 corr_cb=-0.1397 topkJ=0.0296
[TRAIN][ep=021] loss=1.3420 acc=72.35%
[TRAIN][ep=021] mask_avg: mc_mean=0.2425 mb_mean=0.5029 norm_overlap=0.9958 corr_cb=-0.2197
[EPOCH 021/089] train: loss=1.3420 acc=72.35% | val: loss=0.7199 acc=61.45% f1=72.41% auc=61.51% val_score=53.7407 val_score_bestthr=67.4771 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.243, mb=0.503, no=0.996, corr=-0.220) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.8204 -> 67.4771
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2517 mb_mean=0.5063 norm_overlap=0.9968 corr_cb=-0.1919 topkJ=0.0222
[TRAIN][ep=022] loss=1.3388 acc=73.15%
[TRAIN][ep=022] mask_avg: mc_mean=0.2620 mb_mean=0.5029 norm_overlap=0.9953 corr_cb=-0.2456
[EPOCH 022/089] train: loss=1.3388 acc=73.15% | val: loss=0.7423 acc=61.45% f1=72.41% auc=61.45% val_score=56.7552 val_score_bestthr=67.4771 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.262, mb=0.503, no=0.995, corr=-0.246) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.8204 -> 67.4771
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2446 mb_mean=0.4990 norm_overlap=0.9980 corr_cb=-0.1123 topkJ=0.0349
[TRAIN][ep=023] loss=1.1132 acc=72.08%
[TRAIN][ep=023] mask_avg: mc_mean=0.2605 mb_mean=0.5029 norm_overlap=0.9951 corr_cb=-0.2511
[EPOCH 023/089] train: loss=1.1132 acc=72.08% | val: loss=0.7300 acc=60.24% f1=71.79% auc=60.70% val_score=58.2943 val_score_bestthr=65.1322 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.261, mb=0.503, no=0.995, corr=-0.251) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.8204 -> 65.1322
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2634 mb_mean=0.4986 norm_overlap=0.9956 corr_cb=-0.2466 topkJ=0.0166
[TRAIN][ep=024] loss=0.8816 acc=71.68%
[TRAIN][ep=024] mask_avg: mc_mean=0.2621 mb_mean=0.5029 norm_overlap=0.9950 corr_cb=-0.2543
[EPOCH 024/089] train: loss=0.8816 acc=71.68% | val: loss=0.7442 acc=63.86% f1=70.00% auc=61.28% val_score=34.2967 val_score_bestthr=64.8202 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.262, mb=0.503, no=0.995, corr=-0.254) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.8204 -> 64.8202
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1900 mb_mean=0.5043 norm_overlap=0.9908 corr_cb=-0.3550 topkJ=0.0054
[TRAIN][ep=025] loss=0.8164 acc=73.56%
[TRAIN][ep=025] mask_avg: mc_mean=0.2596 mb_mean=0.5029 norm_overlap=0.9948 corr_cb=-0.2589
[EPOCH 025/089] train: loss=0.8164 acc=73.56% | val: loss=0.7157 acc=61.45% f1=72.41% auc=62.97% val_score=54.4113 val_score_bestthr=67.4771 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.260, mb=0.503, no=0.995, corr=-0.259) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.8204 -> 67.4771
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2432 mb_mean=0.5065 norm_overlap=0.9934 corr_cb=-0.3447 topkJ=0.0041
[TRAIN][ep=026] loss=0.7915 acc=73.69%
[TRAIN][ep=026] mask_avg: mc_mean=0.2544 mb_mean=0.5029 norm_overlap=0.9947 corr_cb=-0.2576
[EPOCH 026/089] train: loss=0.7915 acc=73.69% | val: loss=0.7254 acc=61.45% f1=72.41% auc=62.03% val_score=53.5181 val_score_bestthr=67.4771 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.254, mb=0.503, no=0.995, corr=-0.258) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.8204 -> 67.4771
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2352 mb_mean=0.4994 norm_overlap=0.9927 corr_cb=-0.2988 topkJ=0.0221
[TRAIN][ep=027] loss=0.7863 acc=75.70%
[TRAIN][ep=027] mask_avg: mc_mean=0.2425 mb_mean=0.5029 norm_overlap=0.9949 corr_cb=-0.2440
[EPOCH 027/089] train: loss=0.7863 acc=75.70% | val: loss=0.7270 acc=61.45% f1=72.41% auc=62.27% val_score=53.4051 val_score_bestthr=67.4771 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.242, mb=0.503, no=0.995, corr=-0.244) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.8204 -> 67.4771
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2453 mb_mean=0.5002 norm_overlap=0.9952 corr_cb=-0.2032 topkJ=0.0507
[TRAIN][ep=028] loss=0.8026 acc=73.69%
[TRAIN][ep=028] mask_avg: mc_mean=0.2657 mb_mean=0.5029 norm_overlap=0.9944 corr_cb=-0.2775
[EPOCH 028/089] train: loss=0.8026 acc=73.69% | val: loss=0.7467 acc=63.86% f1=70.00% auc=62.56% val_score=40.1437 val_score_bestthr=65.6291 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.266, mb=0.503, no=0.994, corr=-0.278) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.8204 -> 65.6291
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2812 mb_mean=0.5037 norm_overlap=0.9917 corr_cb=-0.3754 topkJ=0.0077
[TRAIN][ep=029] loss=0.7965 acc=74.09%
[TRAIN][ep=029] mask_avg: mc_mean=0.2743 mb_mean=0.5029 norm_overlap=0.9943 corr_cb=-0.2914
[EPOCH 029/089] train: loss=0.7965 acc=74.09% | val: loss=0.7273 acc=63.86% f1=70.00% auc=62.67% val_score=53.4051 val_score_bestthr=65.6291 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.274, mb=0.503, no=0.994, corr=-0.291) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.8204 -> 65.6291
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2626 mb_mean=0.4993 norm_overlap=0.9978 corr_cb=-0.1167 topkJ=0.0206
[TRAIN][ep=030] loss=0.7955 acc=73.42%
[TRAIN][ep=030] mask_avg: mc_mean=0.2844 mb_mean=0.5029 norm_overlap=0.9939 corr_cb=-0.3092
[EPOCH 030/089] train: loss=0.7955 acc=73.42% | val: loss=0.7913 acc=66.27% f1=73.58% auc=62.33% val_score=63.9939 val_score_bestthr=66.8805 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.284, mb=0.503, no=0.994, corr=-0.309) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.8204 -> 66.8805
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.3159 mb_mean=0.4945 norm_overlap=0.9929 corr_cb=-0.4138 topkJ=0.0172
[TRAIN][ep=031] loss=0.7979 acc=72.35%
[TRAIN][ep=031] mask_avg: mc_mean=0.2829 mb_mean=0.5029 norm_overlap=0.9941 corr_cb=-0.2987
[EPOCH 031/089] train: loss=0.7979 acc=72.35% | val: loss=0.7563 acc=63.86% f1=70.00% auc=62.67% val_score=41.3782 val_score_bestthr=65.6291 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.283, mb=0.503, no=0.994, corr=-0.299) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.8204 -> 65.6291
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1852 mb_mean=0.5035 norm_overlap=0.9964 corr_cb=-0.1909 topkJ=0.0237
[TRAIN][ep=032] loss=0.7812 acc=73.69%
[TRAIN][ep=032] mask_avg: mc_mean=0.2731 mb_mean=0.5029 norm_overlap=0.9945 corr_cb=-0.2787
[EPOCH 032/089] train: loss=0.7812 acc=73.69% | val: loss=0.7388 acc=63.86% f1=70.00% auc=62.85% val_score=60.9059 val_score_bestthr=65.6291 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.273, mb=0.503, no=0.994, corr=-0.279) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.8204 -> 65.6291
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2574 mb_mean=0.5076 norm_overlap=0.9918 corr_cb=-0.3630 topkJ=0.0012
[TRAIN][ep=033] loss=0.7689 acc=73.96%
[TRAIN][ep=033] mask_avg: mc_mean=0.2816 mb_mean=0.5029 norm_overlap=0.9942 corr_cb=-0.2946
[EPOCH 033/089] train: loss=0.7689 acc=73.96% | val: loss=0.7321 acc=67.47% f1=72.16% auc=63.14% val_score=50.8055 val_score_bestthr=67.8568 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.282, mb=0.503, no=0.994, corr=-0.295) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.8204 -> 67.8568
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1379 mb_mean=0.5064 norm_overlap=0.9954 corr_cb=-0.1548 topkJ=0.0107
[TRAIN][ep=034] loss=0.7585 acc=75.44%
[TRAIN][ep=034] mask_avg: mc_mean=0.2444 mb_mean=0.5029 norm_overlap=0.9944 corr_cb=-0.2500
[EPOCH 034/089] train: loss=0.7585 acc=75.44% | val: loss=0.7251 acc=66.27% f1=72.00% auc=63.72% val_score=53.8664 val_score_bestthr=69.2661 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.244, mb=0.503, no=0.994, corr=-0.250) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.8204 -> 69.2661
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2114 mb_mean=0.4981 norm_overlap=0.9974 corr_cb=-0.1093 topkJ=0.0169
[TRAIN][ep=035] loss=0.7554 acc=75.17%
[TRAIN][ep=035] mask_avg: mc_mean=0.2657 mb_mean=0.5029 norm_overlap=0.9939 corr_cb=-0.2835
[EPOCH 035/089] train: loss=0.7554 acc=75.17% | val: loss=0.7579 acc=65.06% f1=70.71% auc=62.67% val_score=49.5398 val_score_bestthr=66.7428 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.266, mb=0.503, no=0.994, corr=-0.283) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.8204 -> 66.7428
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2969 mb_mean=0.4988 norm_overlap=0.9953 corr_cb=-0.2349 topkJ=0.0403
[TRAIN][ep=036] loss=0.7390 acc=76.64%
[TRAIN][ep=036] mask_avg: mc_mean=0.2667 mb_mean=0.5029 norm_overlap=0.9938 corr_cb=-0.2865
[EPOCH 036/089] train: loss=0.7390 acc=76.64% | val: loss=0.7566 acc=65.06% f1=71.29% auc=62.73% val_score=53.8664 val_score_bestthr=68.8982 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.267, mb=0.503, no=0.994, corr=-0.287) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.8204 -> 68.8982
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.2970 mb_mean=0.4998 norm_overlap=0.9946 corr_cb=-0.2726 topkJ=0.0157
[TRAIN][ep=037] loss=0.7401 acc=76.24%
[TRAIN][ep=037] mask_avg: mc_mean=0.2561 mb_mean=0.5029 norm_overlap=0.9938 corr_cb=-0.2826
[EPOCH 037/089] train: loss=0.7401 acc=76.24% | val: loss=0.7507 acc=63.86% f1=70.00% auc=62.38% val_score=54.0926 val_score_bestthr=65.6291 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.256, mb=0.503, no=0.994, corr=-0.283) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.8204 -> 65.6291
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2832 mb_mean=0.5025 norm_overlap=0.9893 corr_cb=-0.3705 topkJ=0.0008
[TRAIN][ep=038] loss=0.7488 acc=75.84%
[TRAIN][ep=038] mask_avg: mc_mean=0.3140 mb_mean=0.5029 norm_overlap=0.9930 corr_cb=-0.3610
[EPOCH 038/089] train: loss=0.7488 acc=75.84% | val: loss=0.7826 acc=66.27% f1=70.83% auc=61.86% val_score=62.4156 val_score_bestthr=63.5328 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.314, mb=0.503, no=0.993, corr=-0.361) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.8204 -> 63.5328
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2515 mb_mean=0.5026 norm_overlap=0.9950 corr_cb=-0.2360 topkJ=0.0198
[TRAIN][ep=039] loss=0.7276 acc=76.78%
[TRAIN][ep=039] mask_avg: mc_mean=0.2558 mb_mean=0.5029 norm_overlap=0.9939 corr_cb=-0.2808
[EPOCH 039/089] train: loss=0.7276 acc=76.78% | val: loss=0.7576 acc=65.06% f1=71.29% auc=61.74% val_score=55.0225 val_score_bestthr=68.1515 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.256, mb=0.503, no=0.994, corr=-0.281) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.8204 -> 68.1515
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.2237 mb_mean=0.4982 norm_overlap=0.9957 corr_cb=-0.2243 topkJ=0.0211
[TRAIN][ep=040] loss=0.7360 acc=75.30%
[TRAIN][ep=040] mask_avg: mc_mean=0.2765 mb_mean=0.5029 norm_overlap=0.9934 corr_cb=-0.3131
[EPOCH 040/089] train: loss=0.7360 acc=75.30% | val: loss=0.7515 acc=65.06% f1=71.29% auc=62.56% val_score=52.5084 val_score_bestthr=68.1515 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.276, mb=0.503, no=0.993, corr=-0.313) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.8204 -> 68.1515
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.2885 mb_mean=0.5057 norm_overlap=0.9971 corr_cb=-0.1621 topkJ=0.0473
[TRAIN][ep=041] loss=0.7196 acc=76.38%
[TRAIN][ep=041] mask_avg: mc_mean=0.2835 mb_mean=0.5029 norm_overlap=0.9932 corr_cb=-0.3221
[EPOCH 041/089] train: loss=0.7196 acc=76.38% | val: loss=0.7958 acc=66.27% f1=72.55% auc=63.60% val_score=48.7222 val_score_bestthr=69.9895 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.284, mb=0.503, no=0.993, corr=-0.322) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 69.8204 -> 69.9895
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.2178 mb_mean=0.4989 norm_overlap=0.9942 corr_cb=-0.1762 topkJ=0.0290
[TRAIN][ep=042] loss=0.8192 acc=76.64%
[TRAIN][ep=042] mask_avg: mc_mean=0.2518 mb_mean=0.5029 norm_overlap=0.9938 corr_cb=-0.2707
[EPOCH 042/089] train: loss=0.8192 acc=76.64% | val: loss=0.7447 acc=65.06% f1=71.84% auc=64.42% val_score=49.0830 val_score_bestthr=69.2495 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.252, mb=0.503, no=0.994, corr=-0.271) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9895 -> 69.2495
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.3082 mb_mean=0.5069 norm_overlap=0.9931 corr_cb=-0.3268 topkJ=0.0105
[TRAIN][ep=043] loss=0.8960 acc=77.58%
[TRAIN][ep=043] mask_avg: mc_mean=0.2761 mb_mean=0.5029 norm_overlap=0.9932 corr_cb=-0.3144
[EPOCH 043/089] train: loss=0.8960 acc=77.58% | val: loss=0.7611 acc=66.27% f1=72.55% auc=63.43% val_score=50.4697 val_score_bestthr=67.8428 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.276, mb=0.503, no=0.993, corr=-0.314) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9895 -> 67.8428
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2732 mb_mean=0.5063 norm_overlap=0.9935 corr_cb=-0.2779 topkJ=0.0051
[TRAIN][ep=044] loss=0.9753 acc=78.93%
[TRAIN][ep=044] mask_avg: mc_mean=0.2724 mb_mean=0.5029 norm_overlap=0.9936 corr_cb=-0.3007
[EPOCH 044/089] train: loss=0.9753 acc=78.93% | val: loss=0.7603 acc=65.06% f1=71.84% auc=64.01% val_score=45.9396 val_score_bestthr=67.4762 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.272, mb=0.503, no=0.994, corr=-0.301) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9895 -> 67.4762
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2404 mb_mean=0.5026 norm_overlap=0.9934 corr_cb=-0.3116 topkJ=0.0187
[TRAIN][ep=045] loss=1.0710 acc=76.24%
[TRAIN][ep=045] mask_avg: mc_mean=0.2927 mb_mean=0.5029 norm_overlap=0.9933 corr_cb=-0.3220
[EPOCH 045/089] train: loss=1.0710 acc=76.24% | val: loss=0.7667 acc=63.86% f1=71.70% auc=63.66% val_score=56.8907 val_score_bestthr=68.4034 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.293, mb=0.503, no=0.993, corr=-0.322) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9895 -> 68.4034
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.2001 mb_mean=0.4981 norm_overlap=0.9970 corr_cb=-0.0928 topkJ=0.0466
[TRAIN][ep=046] loss=1.1432 acc=78.66%
[TRAIN][ep=046] mask_avg: mc_mean=0.2725 mb_mean=0.5029 norm_overlap=0.9935 corr_cb=-0.2997
[EPOCH 046/089] train: loss=1.1432 acc=78.66% | val: loss=0.7915 acc=62.65% f1=69.90% auc=61.45% val_score=50.9183 val_score_bestthr=65.2753 | dyn(w_pfs=0.100, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.273, mb=0.503, no=0.994, corr=-0.300) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9895 -> 65.2753
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.3020 mb_mean=0.5056 norm_overlap=0.9907 corr_cb=-0.4312 topkJ=0.0048
[TRAIN][ep=047] loss=0.9031 acc=79.46%
[TRAIN][ep=047] mask_avg: mc_mean=0.2681 mb_mean=0.5029 norm_overlap=0.9934 corr_cb=-0.2972
[EPOCH 047/089] train: loss=0.9031 acc=79.46% | val: loss=0.7890 acc=62.65% f1=71.03% auc=63.43% val_score=54.0926 val_score_bestthr=65.4076 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.268, mb=0.503, no=0.993, corr=-0.297) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9895 -> 65.4076
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.3184 mb_mean=0.5025 norm_overlap=0.9929 corr_cb=-0.3476 topkJ=0.0051
[TRAIN][ep=048] loss=0.6699 acc=81.61%
[TRAIN][ep=048] mask_avg: mc_mean=0.2706 mb_mean=0.5029 norm_overlap=0.9934 corr_cb=-0.2969
[EPOCH 048/089] train: loss=0.6699 acc=81.61% | val: loss=0.8170 acc=62.65% f1=71.03% auc=63.37% val_score=58.9076 val_score_bestthr=66.9632 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.271, mb=0.503, no=0.993, corr=-0.297) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9895 -> 66.9632
[DBG][ep=049] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.2868 mb_mean=0.5093 norm_overlap=0.9944 corr_cb=-0.2683 topkJ=0.0080
[TRAIN][ep=049] loss=0.6723 acc=79.87%
[TRAIN][ep=049] mask_avg: mc_mean=0.2917 mb_mean=0.5029 norm_overlap=0.9930 corr_cb=-0.3250
[EPOCH 049/089] train: loss=0.6723 acc=79.87% | val: loss=0.8450 acc=61.45% f1=69.81% auc=62.27% val_score=53.9986 val_score_bestthr=63.9458 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.292, mb=0.503, no=0.993, corr=-0.325) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9895 -> 63.9458
[DBG][ep=050] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.1794 mb_mean=0.4987 norm_overlap=0.9942 corr_cb=-0.2279 topkJ=0.0301
[TRAIN][ep=050] loss=0.6438 acc=81.61%
[TRAIN][ep=050] mask_avg: mc_mean=0.2306 mb_mean=0.5029 norm_overlap=0.9939 corr_cb=-0.2452
[EPOCH 050/089] train: loss=0.6438 acc=81.61% | val: loss=0.8043 acc=62.65% f1=71.03% auc=63.08% val_score=57.0235 val_score_bestthr=66.9632 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.231, mb=0.503, no=0.994, corr=-0.245) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9895 -> 66.9632
[DBG][ep=051] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.2559 mb_mean=0.4947 norm_overlap=0.9980 corr_cb=-0.0818 topkJ=0.0379
[TRAIN][ep=051] loss=0.6445 acc=81.74%
[TRAIN][ep=051] mask_avg: mc_mean=0.2307 mb_mean=0.5029 norm_overlap=0.9940 corr_cb=-0.2427
[EPOCH 051/089] train: loss=0.6445 acc=81.74% | val: loss=0.8088 acc=62.65% f1=71.03% auc=63.37% val_score=53.4478 val_score_bestthr=66.9632 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.231, mb=0.503, no=0.994, corr=-0.243) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9895 -> 66.9632
[DBG][ep=052] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.2447 mb_mean=0.5042 norm_overlap=0.9926 corr_cb=-0.2880 topkJ=0.0107
[TRAIN][ep=052] loss=0.6444 acc=81.74%
[TRAIN][ep=052] mask_avg: mc_mean=0.2306 mb_mean=0.5029 norm_overlap=0.9940 corr_cb=-0.2425
[EPOCH 052/089] train: loss=0.6444 acc=81.74% | val: loss=0.8083 acc=61.45% f1=70.37% auc=63.55% val_score=53.4478 val_score_bestthr=66.2403 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.231, mb=0.503, no=0.994, corr=-0.243) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9895 -> 66.2403
[DBG][ep=053] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.2098 mb_mean=0.5000 norm_overlap=0.9961 corr_cb=-0.2005 topkJ=0.0334
[TRAIN][ep=053] loss=0.6413 acc=82.28%
[TRAIN][ep=053] mask_avg: mc_mean=0.2306 mb_mean=0.5029 norm_overlap=0.9939 corr_cb=-0.2428
[EPOCH 053/089] train: loss=0.6413 acc=82.28% | val: loss=0.8212 acc=62.65% f1=71.03% auc=63.08% val_score=56.6272 val_score_bestthr=66.9632 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.231, mb=0.503, no=0.994, corr=-0.243) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9895 -> 66.9632
[DBG][ep=054] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=054] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=054] mask(step0): mc_mean=0.2530 mb_mean=0.5008 norm_overlap=0.9959 corr_cb=-0.1959 topkJ=0.0335
[TRAIN][ep=054] loss=0.6465 acc=81.74%
[TRAIN][ep=054] mask_avg: mc_mean=0.2306 mb_mean=0.5029 norm_overlap=0.9940 corr_cb=-0.2442
[EPOCH 054/089] train: loss=0.6465 acc=81.74% | val: loss=0.8194 acc=61.45% f1=70.37% auc=63.43% val_score=53.3082 val_score_bestthr=66.2403 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.231, mb=0.503, no=0.994, corr=-0.244) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9895 -> 66.2403
[DBG][ep=055] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=055] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=055] mask(step0): mc_mean=0.2146 mb_mean=0.5058 norm_overlap=0.9924 corr_cb=-0.3512 topkJ=0.0035
[TRAIN][ep=055] loss=0.6407 acc=81.61%
[TRAIN][ep=055] mask_avg: mc_mean=0.2306 mb_mean=0.5029 norm_overlap=0.9940 corr_cb=-0.2415
[EPOCH 055/089] train: loss=0.6407 acc=81.61% | val: loss=0.8146 acc=62.65% f1=71.03% auc=63.37% val_score=56.8909 val_score_bestthr=66.9632 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.231, mb=0.503, no=0.994, corr=-0.242) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9895 -> 66.9632
[DBG][ep=056] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=056] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=056] mask(step0): mc_mean=0.1901 mb_mean=0.5026 norm_overlap=0.9902 corr_cb=-0.3545 topkJ=0.0099
[TRAIN][ep=056] loss=0.6420 acc=81.61%
[TRAIN][ep=056] mask_avg: mc_mean=0.2306 mb_mean=0.5029 norm_overlap=0.9939 corr_cb=-0.2487
[EPOCH 056/089] train: loss=0.6420 acc=81.61% | val: loss=0.8253 acc=61.45% f1=70.37% auc=63.20% val_score=53.4478 val_score_bestthr=66.2403 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.231, mb=0.503, no=0.994, corr=-0.249) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9895 -> 66.2403
[DBG][ep=057] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=057] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=057] mask(step0): mc_mean=0.1960 mb_mean=0.5034 norm_overlap=0.9957 corr_cb=-0.2104 topkJ=0.0235
[TRAIN][ep=057] loss=0.6391 acc=82.15%
[TRAIN][ep=057] mask_avg: mc_mean=0.2307 mb_mean=0.5029 norm_overlap=0.9938 corr_cb=-0.2509
[EPOCH 057/089] train: loss=0.6391 acc=82.15% | val: loss=0.8318 acc=61.45% f1=70.37% auc=63.08% val_score=53.2836 val_score_bestthr=66.2403 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.231, mb=0.503, no=0.994, corr=-0.251) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9895 -> 66.2403
[DBG][ep=058] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=058] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=058] mask(step0): mc_mean=0.2403 mb_mean=0.5031 norm_overlap=0.9897 corr_cb=-0.3261 topkJ=0.0165
[TRAIN][ep=058] loss=0.6378 acc=82.55%
[TRAIN][ep=058] mask_avg: mc_mean=0.2306 mb_mean=0.5029 norm_overlap=0.9939 corr_cb=-0.2415
[EPOCH 058/089] train: loss=0.6378 acc=82.55% | val: loss=0.8304 acc=61.45% f1=70.37% auc=62.85% val_score=52.0298 val_score_bestthr=66.2403 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.231, mb=0.503, no=0.994, corr=-0.242) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9895 -> 66.2403
[DBG][ep=059] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=059] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=059] mask(step0): mc_mean=0.2161 mb_mean=0.4998 norm_overlap=0.9944 corr_cb=-0.2320 topkJ=0.0188
[TRAIN][ep=059] loss=0.6384 acc=82.55%
[TRAIN][ep=059] mask_avg: mc_mean=0.2307 mb_mean=0.5029 norm_overlap=0.9940 corr_cb=-0.2416
[EPOCH 059/089] train: loss=0.6384 acc=82.55% | val: loss=0.8482 acc=61.45% f1=69.81% auc=62.73% val_score=53.2836 val_score_bestthr=63.9458 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.231, mb=0.503, no=0.994, corr=-0.242) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9895 -> 63.9458
[DBG][ep=060] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=060] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=060] mask(step0): mc_mean=0.2224 mb_mean=0.5073 norm_overlap=0.9939 corr_cb=-0.2429 topkJ=0.0096
[TRAIN][ep=060] loss=0.6352 acc=82.15%
[TRAIN][ep=060] mask_avg: mc_mean=0.2306 mb_mean=0.5029 norm_overlap=0.9939 corr_cb=-0.2448
[EPOCH 060/089] train: loss=0.6352 acc=82.15% | val: loss=0.8239 acc=62.65% f1=71.03% auc=63.14% val_score=56.8909 val_score_bestthr=66.9632 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.231, mb=0.503, no=0.994, corr=-0.245) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9895 -> 66.9632
[DBG][ep=061] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=061] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=061] mask(step0): mc_mean=0.2115 mb_mean=0.5061 norm_overlap=0.9922 corr_cb=-0.2898 topkJ=0.0079
[TRAIN][ep=061] loss=0.6340 acc=82.82%
[TRAIN][ep=061] mask_avg: mc_mean=0.2306 mb_mean=0.5029 norm_overlap=0.9939 corr_cb=-0.2449
[EPOCH 061/089] train: loss=0.6340 acc=82.82% | val: loss=0.8277 acc=62.65% f1=71.03% auc=63.31% val_score=56.8909 val_score_bestthr=66.9632 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.231, mb=0.503, no=0.994, corr=-0.245) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9895 -> 66.9632
[DBG][ep=062] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=062] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=062] mask(step0): mc_mean=0.2287 mb_mean=0.4972 norm_overlap=0.9941 corr_cb=-0.2606 topkJ=0.0160
[TRAIN][ep=062] loss=0.6345 acc=81.88%
[TRAIN][ep=062] mask_avg: mc_mean=0.2307 mb_mean=0.5029 norm_overlap=0.9939 corr_cb=-0.2444
[EPOCH 062/089] train: loss=0.6345 acc=81.88% | val: loss=0.8320 acc=62.65% f1=71.03% auc=63.14% val_score=56.8909 val_score_bestthr=66.9632 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.231, mb=0.503, no=0.994, corr=-0.244) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9895 -> 66.9632
[DBG][ep=063] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=063] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=063] mask(step0): mc_mean=0.2389 mb_mean=0.5026 norm_overlap=0.9943 corr_cb=-0.1722 topkJ=0.0138
[TRAIN][ep=063] loss=0.6284 acc=82.55%
[TRAIN][ep=063] mask_avg: mc_mean=0.2306 mb_mean=0.5029 norm_overlap=0.9939 corr_cb=-0.2438
[EPOCH 063/089] train: loss=0.6284 acc=82.55% | val: loss=0.8371 acc=62.65% f1=71.03% auc=62.44% val_score=55.7790 val_score_bestthr=66.9632 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.231, mb=0.503, no=0.994, corr=-0.244) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9895 -> 66.9632
[DBG][ep=064] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=064] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=064] mask(step0): mc_mean=0.2222 mb_mean=0.5018 norm_overlap=0.9997 corr_cb=-0.0111 topkJ=0.0264
[TRAIN][ep=064] loss=0.6297 acc=81.88%
[TRAIN][ep=064] mask_avg: mc_mean=0.2306 mb_mean=0.5029 norm_overlap=0.9940 corr_cb=-0.2427
[EPOCH 064/089] train: loss=0.6297 acc=81.88% | val: loss=0.8374 acc=62.65% f1=71.03% auc=62.67% val_score=55.2295 val_score_bestthr=66.9632 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.231, mb=0.503, no=0.994, corr=-0.243) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9895 -> 66.9632
[DBG][ep=065] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=065] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=065] mask(step0): mc_mean=0.2071 mb_mean=0.5059 norm_overlap=0.9914 corr_cb=-0.3326 topkJ=0.0153
[TRAIN][ep=065] loss=0.6288 acc=82.68%
[TRAIN][ep=065] mask_avg: mc_mean=0.2307 mb_mean=0.5029 norm_overlap=0.9939 corr_cb=-0.2446
[EPOCH 065/089] train: loss=0.6288 acc=82.68% | val: loss=0.8380 acc=62.65% f1=71.03% auc=62.79% val_score=59.4052 val_score_bestthr=66.9632 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.231, mb=0.503, no=0.994, corr=-0.245) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9895 -> 66.9632
[DBG][ep=066] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=066] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=066] mask(step0): mc_mean=0.2129 mb_mean=0.5042 norm_overlap=0.9933 corr_cb=-0.3072 topkJ=0.0110
[TRAIN][ep=066] loss=0.6269 acc=83.22%
[TRAIN][ep=066] mask_avg: mc_mean=0.2306 mb_mean=0.5029 norm_overlap=0.9940 corr_cb=-0.2438
[EPOCH 066/089] train: loss=0.6269 acc=83.22% | val: loss=0.8463 acc=61.45% f1=70.37% auc=62.38% val_score=53.2492 val_score_bestthr=66.2403 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.231, mb=0.503, no=0.994, corr=-0.244) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9895 -> 66.2403
[DBG][ep=067] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=067] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=067] mask(step0): mc_mean=0.2358 mb_mean=0.5023 norm_overlap=0.9919 corr_cb=-0.3199 topkJ=0.0071
[TRAIN][ep=067] loss=0.6249 acc=82.68%
[TRAIN][ep=067] mask_avg: mc_mean=0.2306 mb_mean=0.5029 norm_overlap=0.9940 corr_cb=-0.2457
[EPOCH 067/089] train: loss=0.6249 acc=82.68% | val: loss=0.8496 acc=61.45% f1=70.37% auc=62.44% val_score=53.2492 val_score_bestthr=66.2403 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.231, mb=0.503, no=0.994, corr=-0.246) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9895 -> 66.2403
[DBG][ep=068] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=068] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=068] mask(step0): mc_mean=0.2320 mb_mean=0.5042 norm_overlap=0.9948 corr_cb=-0.2309 topkJ=0.0086
[TRAIN][ep=068] loss=0.6221 acc=83.49%
[TRAIN][ep=068] mask_avg: mc_mean=0.2306 mb_mean=0.5029 norm_overlap=0.9939 corr_cb=-0.2446
[EPOCH 068/089] train: loss=0.6221 acc=83.49% | val: loss=0.8484 acc=61.45% f1=70.37% auc=62.50% val_score=59.4052 val_score_bestthr=66.2403 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.231, mb=0.503, no=0.994, corr=-0.245) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9895 -> 66.2403
[DBG][ep=069] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=069] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=069] mask(step0): mc_mean=0.1889 mb_mean=0.5023 norm_overlap=0.9961 corr_cb=-0.1466 topkJ=0.0221
[TRAIN][ep=069] loss=0.6234 acc=82.55%
[TRAIN][ep=069] mask_avg: mc_mean=0.2306 mb_mean=0.5029 norm_overlap=0.9939 corr_cb=-0.2474
[EPOCH 069/089] train: loss=0.6234 acc=82.55% | val: loss=0.8438 acc=62.65% f1=71.03% auc=62.73% val_score=58.7665 val_score_bestthr=66.9632 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.231, mb=0.503, no=0.994, corr=-0.247) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9895 -> 66.9632
[DBG][ep=070] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=070] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=070] mask(step0): mc_mean=0.2153 mb_mean=0.5055 norm_overlap=0.9938 corr_cb=-0.2738 topkJ=0.0134
[TRAIN][ep=070] loss=0.6204 acc=83.36%
[TRAIN][ep=070] mask_avg: mc_mean=0.2307 mb_mean=0.5029 norm_overlap=0.9939 corr_cb=-0.2487
[EPOCH 070/089] train: loss=0.6204 acc=83.36% | val: loss=0.8499 acc=62.65% f1=71.03% auc=62.44% val_score=56.8909 val_score_bestthr=66.9632 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.231, mb=0.503, no=0.994, corr=-0.249) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9895 -> 66.9632
[DBG][ep=071] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=071] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=071] mask(step0): mc_mean=0.2123 mb_mean=0.5009 norm_overlap=0.9961 corr_cb=-0.1878 topkJ=0.0281
[TRAIN][ep=071] loss=0.6258 acc=83.49%
[TRAIN][ep=071] mask_avg: mc_mean=0.2307 mb_mean=0.5029 norm_overlap=0.9939 corr_cb=-0.2480
[EPOCH 071/089] train: loss=0.6258 acc=83.49% | val: loss=0.8500 acc=62.65% f1=71.03% auc=62.85% val_score=59.4052 val_score_bestthr=66.9632 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.231, mb=0.503, no=0.994, corr=-0.248) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 69.9895 -> 66.9632
[EARLY STOP] no improvement for 30 epochs. best_epoch=41
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
=============== FIT DONE ===============
[BEST] epoch=41 | val_acc=66.27% | val_f1=72.55% | val_auc=63.60% | val_score=48.7222 | val_score_bestthr=69.9895
[TEST@BEST] thr_used=0.305 | acc=67.15% f1=70.94% auc=72.82% | SP_sex=16.85% EO_sex=2.22% SP_age=18.61% EO_age=9.38%
[TIME] 1.73 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/summary_fold_3.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5042 mb_mean=0.5040 norm_overlap=1.0001 corr_cb=0.1951 topkJ=0.1574
[TRAIN][ep=000] loss=0.6944 acc=49.53%
[TRAIN][ep=000] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0819
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5061 mb_mean=0.5005 norm_overlap=1.0000 corr_cb=0.1183 topkJ=0.0577
[TRAIN][ep=001] loss=0.6937 acc=51.14%
[TRAIN][ep=001] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0801
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5044 mb_mean=0.5040 norm_overlap=1.0000 corr_cb=0.0722 topkJ=0.0959
[TRAIN][ep=002] loss=0.6913 acc=54.63%
[TRAIN][ep=002] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0784
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5035 mb_mean=0.4968 norm_overlap=1.0002 corr_cb=0.3148 topkJ=0.1021
[TRAIN][ep=003] loss=0.6896 acc=51.95%
[TRAIN][ep=003] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0800
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5044 mb_mean=0.5048 norm_overlap=1.0001 corr_cb=0.2160 topkJ=0.0656
[TRAIN][ep=004] loss=0.6894 acc=54.23%
[TRAIN][ep=004] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0800
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5067 mb_mean=0.5067 norm_overlap=1.0001 corr_cb=0.1932 topkJ=0.0734
[TRAIN][ep=005] loss=0.6867 acc=53.69%
[TRAIN][ep=005] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0823
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5065 mb_mean=0.5067 norm_overlap=1.0000 corr_cb=-0.0363 topkJ=0.1013
[TRAIN][ep=006] loss=0.6844 acc=55.97%
[TRAIN][ep=006] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0796
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5062 mb_mean=0.5019 norm_overlap=1.0001 corr_cb=0.3117 topkJ=0.2049
[TRAIN][ep=007] loss=0.6865 acc=55.44%
[TRAIN][ep=007] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0800
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5025 mb_mean=0.5033 norm_overlap=1.0000 corr_cb=-0.0452 topkJ=0.0691
[TRAIN][ep=008] loss=0.6797 acc=59.87%
[TRAIN][ep=008] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0804
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5034 mb_mean=0.5057 norm_overlap=1.0001 corr_cb=0.1863 topkJ=0.0624
[TRAIN][ep=009] loss=0.6760 acc=59.19%
[TRAIN][ep=009] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0876
================= FIT START (fold=3) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5055 mb_mean=0.5024 norm_overlap=0.9999 corr_cb=-0.0929 topkJ=0.0409
[TRAIN][ep=000] loss=0.6714 acc=61.34%
[TRAIN][ep=000] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0802
[EPOCH 000/089] train: loss=0.6714 acc=61.34% | val: loss=0.6915 acc=57.83% f1=70.59% auc=51.86% val_score=42.8972 val_score_bestthr=61.2371 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.080) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 61.2371
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5046 mb_mean=0.4991 norm_overlap=1.0000 corr_cb=0.0132 topkJ=0.0779
[TRAIN][ep=001] loss=0.6660 acc=61.88%
[TRAIN][ep=001] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0802
[EPOCH 001/089] train: loss=0.6660 acc=61.88% | val: loss=0.7107 acc=55.42% f1=68.38% auc=48.84% val_score=36.9276 val_score_bestthr=57.1990 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.080) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.2371 -> 57.1990
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5047 mb_mean=0.5037 norm_overlap=1.0002 corr_cb=0.2934 topkJ=0.0559
[TRAIN][ep=002] loss=0.6642 acc=60.54%
[TRAIN][ep=002] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0808
[EPOCH 002/089] train: loss=0.6642 acc=60.54% | val: loss=0.6896 acc=60.24% f1=72.27% auc=54.36% val_score=43.6583 val_score_bestthr=67.7099 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.081) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 61.2371 -> 67.7099
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5066 mb_mean=0.5041 norm_overlap=1.0001 corr_cb=0.1759 topkJ=0.1404
[TRAIN][ep=003] loss=0.6611 acc=60.54%
[TRAIN][ep=003] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0798
[EPOCH 003/089] train: loss=0.6611 acc=60.54% | val: loss=0.6974 acc=57.83% f1=67.89% auc=52.21% val_score=32.5867 val_score_bestthr=63.2593 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.080) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.7099 -> 63.2593
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5061 mb_mean=0.5050 norm_overlap=1.0000 corr_cb=0.0586 topkJ=0.0847
[TRAIN][ep=004] loss=0.6532 acc=62.15%
[TRAIN][ep=004] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0832
[EPOCH 004/089] train: loss=0.6532 acc=62.15% | val: loss=0.6921 acc=61.45% f1=71.93% auc=57.21% val_score=60.7211 val_score_bestthr=64.5440 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.083) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.7099 -> 64.5440
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5043 mb_mean=0.5027 norm_overlap=1.0001 corr_cb=0.2297 topkJ=0.0605
[TRAIN][ep=005] loss=1.2330 acc=62.42%
[TRAIN][ep=005] mask_avg: mc_mean=0.3697 mb_mean=0.5029 norm_overlap=1.0022 corr_cb=0.5971
[EPOCH 005/089] train: loss=1.2330 acc=62.42% | val: loss=0.6859 acc=60.24% f1=71.79% auc=57.67% val_score=42.4713 val_score_bestthr=67.4967 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.370, mb=0.503, no=1.002, corr=0.597) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.7099 -> 67.4967
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2907 mb_mean=0.5054 norm_overlap=1.0017 corr_cb=0.4244 topkJ=0.1817
[TRAIN][ep=006] loss=1.2279 acc=64.30%
[TRAIN][ep=006] mask_avg: mc_mean=0.2715 mb_mean=0.5029 norm_overlap=1.0041 corr_cb=0.5797
[EPOCH 006/089] train: loss=1.2279 acc=64.30% | val: loss=0.6954 acc=57.83% f1=70.09% auc=55.23% val_score=35.3805 val_score_bestthr=62.8622 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.271, mb=0.503, no=1.004, corr=0.580) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.7099 -> 62.8622
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2510 mb_mean=0.5008 norm_overlap=1.0031 corr_cb=0.5187 topkJ=0.2257
[TRAIN][ep=007] loss=1.2267 acc=62.68%
[TRAIN][ep=007] mask_avg: mc_mean=0.2581 mb_mean=0.5029 norm_overlap=1.0040 corr_cb=0.5093
[EPOCH 007/089] train: loss=1.2267 acc=62.68% | val: loss=0.6944 acc=59.04% f1=71.67% auc=59.19% val_score=54.0688 val_score_bestthr=67.9254 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.258, mb=0.503, no=1.004, corr=0.509) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 67.7099 -> 67.9254
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2395 mb_mean=0.4971 norm_overlap=1.0063 corr_cb=0.6484 topkJ=0.1947
[TRAIN][ep=008] loss=1.2284 acc=62.28%
[TRAIN][ep=008] mask_avg: mc_mean=0.2621 mb_mean=0.5029 norm_overlap=1.0034 corr_cb=0.4363
[EPOCH 008/089] train: loss=1.2284 acc=62.28% | val: loss=0.6876 acc=60.24% f1=72.27% auc=58.20% val_score=59.5420 val_score_bestthr=69.8204 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.262, mb=0.503, no=1.003, corr=0.436) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 67.9254 -> 69.8204
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2226 mb_mean=0.4964 norm_overlap=1.0031 corr_cb=0.4662 topkJ=0.1991
[TRAIN][ep=009] loss=1.2124 acc=65.77%
[TRAIN][ep=009] mask_avg: mc_mean=0.2464 mb_mean=0.5029 norm_overlap=1.0033 corr_cb=0.3731
[EPOCH 009/089] train: loss=1.2124 acc=65.77% | val: loss=0.6920 acc=59.04% f1=71.67% auc=56.51% val_score=45.1171 val_score_bestthr=67.9254 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.246, mb=0.503, no=1.003, corr=0.373) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.8204 -> 67.9254
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.2490 mb_mean=0.5031 norm_overlap=1.0028 corr_cb=0.2890 topkJ=0.1291
[TRAIN][ep=010] loss=1.2053 acc=65.91%
[TRAIN][ep=010] mask_avg: mc_mean=0.2380 mb_mean=0.5029 norm_overlap=1.0028 corr_cb=0.2757
[EPOCH 010/089] train: loss=1.2053 acc=65.91% | val: loss=0.6936 acc=61.45% f1=72.88% auc=57.62% val_score=54.8361 val_score_bestthr=71.2933 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.238, mb=0.503, no=1.003, corr=0.276) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 69.8204 -> 71.2933
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.2582 mb_mean=0.5027 norm_overlap=1.0012 corr_cb=0.1362 topkJ=0.0563
[TRAIN][ep=011] loss=1.1943 acc=65.64%
[TRAIN][ep=011] mask_avg: mc_mean=0.2286 mb_mean=0.5029 norm_overlap=1.0021 corr_cb=0.1687
[EPOCH 011/089] train: loss=1.1943 acc=65.64% | val: loss=0.7252 acc=59.04% f1=71.67% auc=55.47% val_score=31.3595 val_score_bestthr=66.4943 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.229, mb=0.503, no=1.002, corr=0.169) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 66.4943
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.2411 mb_mean=0.5058 norm_overlap=1.0013 corr_cb=0.1127 topkJ=0.0602
[TRAIN][ep=012] loss=1.1944 acc=66.85%
[TRAIN][ep=012] mask_avg: mc_mean=0.2239 mb_mean=0.5029 norm_overlap=1.0015 corr_cb=0.1064
[EPOCH 012/089] train: loss=1.1944 acc=66.85% | val: loss=0.7119 acc=60.24% f1=72.27% auc=59.13% val_score=56.1506 val_score_bestthr=67.9849 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.224, mb=0.503, no=1.001, corr=0.106) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.9849
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.2503 mb_mean=0.5051 norm_overlap=0.9995 corr_cb=-0.0453 topkJ=0.0522
[TRAIN][ep=013] loss=1.1904 acc=66.85%
[TRAIN][ep=013] mask_avg: mc_mean=0.2450 mb_mean=0.5029 norm_overlap=1.0002 corr_cb=0.0081
[EPOCH 013/089] train: loss=1.1904 acc=66.85% | val: loss=0.7092 acc=61.45% f1=69.81% auc=56.98% val_score=42.6525 val_score_bestthr=64.2778 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.245, mb=0.503, no=1.000, corr=0.008) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 64.2778
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.2224 mb_mean=0.5041 norm_overlap=0.9971 corr_cb=-0.2329 topkJ=0.0160
[TRAIN][ep=014] loss=1.1749 acc=67.79%
[TRAIN][ep=014] mask_avg: mc_mean=0.2167 mb_mean=0.5029 norm_overlap=1.0002 corr_cb=0.0124
[EPOCH 014/089] train: loss=1.1749 acc=67.79% | val: loss=0.7055 acc=59.04% f1=71.67% auc=58.72% val_score=46.2282 val_score_bestthr=67.9254 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.217, mb=0.503, no=1.000, corr=0.012) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.9254
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1683 mb_mean=0.5008 norm_overlap=1.0027 corr_cb=0.1419 topkJ=0.0371
[TRAIN][ep=015] loss=1.1679 acc=69.40%
[TRAIN][ep=015] mask_avg: mc_mean=0.2181 mb_mean=0.5029 norm_overlap=0.9993 corr_cb=-0.0519
[EPOCH 015/089] train: loss=1.1679 acc=69.40% | val: loss=0.7048 acc=61.45% f1=72.41% auc=59.65% val_score=56.2000 val_score_bestthr=65.1127 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.218, mb=0.503, no=0.999, corr=-0.052) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 65.1127
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.2588 mb_mean=0.5040 norm_overlap=0.9947 corr_cb=-0.2972 topkJ=0.0122
[TRAIN][ep=016] loss=0.9580 acc=68.99%
[TRAIN][ep=016] mask_avg: mc_mean=0.2279 mb_mean=0.5029 norm_overlap=0.9984 corr_cb=-0.1004
[EPOCH 016/089] train: loss=0.9580 acc=68.99% | val: loss=0.7374 acc=62.65% f1=73.04% auc=60.47% val_score=55.0451 val_score_bestthr=68.5792 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.228, mb=0.503, no=0.998, corr=-0.100) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 68.5792
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.2266 mb_mean=0.5001 norm_overlap=0.9972 corr_cb=-0.1278 topkJ=0.0120
[TRAIN][ep=017] loss=0.7602 acc=69.66%
[TRAIN][ep=017] mask_avg: mc_mean=0.2369 mb_mean=0.5029 norm_overlap=0.9975 corr_cb=-0.1492
[EPOCH 017/089] train: loss=0.7602 acc=69.66% | val: loss=0.7284 acc=60.24% f1=72.27% auc=59.94% val_score=55.4025 val_score_bestthr=69.8204 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.237, mb=0.503, no=0.998, corr=-0.149) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 69.8204
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.2518 mb_mean=0.5046 norm_overlap=0.9951 corr_cb=-0.2082 topkJ=0.0047
[TRAIN][ep=018] loss=0.7128 acc=71.81%
[TRAIN][ep=018] mask_avg: mc_mean=0.2258 mb_mean=0.5029 norm_overlap=0.9972 corr_cb=-0.1565
[EPOCH 018/089] train: loss=0.7128 acc=71.81% | val: loss=0.7223 acc=60.24% f1=72.27% auc=60.23% val_score=53.8018 val_score_bestthr=69.8204 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.226, mb=0.503, no=0.997, corr=-0.156) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 69.8204
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.2203 mb_mean=0.5051 norm_overlap=0.9934 corr_cb=-0.3418 topkJ=0.0107
[TRAIN][ep=019] loss=0.7069 acc=68.99%
[TRAIN][ep=019] mask_avg: mc_mean=0.2435 mb_mean=0.5029 norm_overlap=0.9963 corr_cb=-0.2086
[EPOCH 019/089] train: loss=0.7069 acc=68.99% | val: loss=0.7323 acc=62.65% f1=69.31% auc=58.90% val_score=48.8609 val_score_bestthr=65.2642 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.244, mb=0.503, no=0.996, corr=-0.209) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 65.2642
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.2806 mb_mean=0.5115 norm_overlap=0.9917 corr_cb=-0.4423 topkJ=0.0024
[TRAIN][ep=020] loss=0.6898 acc=71.01%
[TRAIN][ep=020] mask_avg: mc_mean=0.2338 mb_mean=0.5029 norm_overlap=0.9961 corr_cb=-0.2045
[EPOCH 020/089] train: loss=0.6898 acc=71.01% | val: loss=0.7346 acc=61.45% f1=68.63% auc=59.53% val_score=36.5251 val_score_bestthr=64.1546 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.234, mb=0.503, no=0.996, corr=-0.205) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 64.1546
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2311 mb_mean=0.5054 norm_overlap=0.9974 corr_cb=-0.1579 topkJ=0.0292
[TRAIN][ep=021] loss=0.6831 acc=72.48%
[TRAIN][ep=021] mask_avg: mc_mean=0.2394 mb_mean=0.5029 norm_overlap=0.9956 corr_cb=-0.2264
[EPOCH 021/089] train: loss=0.6831 acc=72.48% | val: loss=0.7231 acc=61.45% f1=72.41% auc=61.63% val_score=56.0663 val_score_bestthr=67.4771 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.239, mb=0.503, no=0.996, corr=-0.226) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.4771
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2482 mb_mean=0.5063 norm_overlap=0.9966 corr_cb=-0.2020 topkJ=0.0227
[TRAIN][ep=022] loss=0.6821 acc=73.29%
[TRAIN][ep=022] mask_avg: mc_mean=0.2588 mb_mean=0.5029 norm_overlap=0.9951 corr_cb=-0.2529
[EPOCH 022/089] train: loss=0.6821 acc=73.29% | val: loss=0.7391 acc=61.45% f1=72.41% auc=61.45% val_score=61.2170 val_score_bestthr=67.4771 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.259, mb=0.503, no=0.995, corr=-0.253) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.4771
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2414 mb_mean=0.4990 norm_overlap=0.9978 corr_cb=-0.1261 topkJ=0.0304
[TRAIN][ep=023] loss=0.6826 acc=71.54%
[TRAIN][ep=023] mask_avg: mc_mean=0.2561 mb_mean=0.5029 norm_overlap=0.9950 corr_cb=-0.2574
[EPOCH 023/089] train: loss=0.6826 acc=71.54% | val: loss=0.7297 acc=60.24% f1=71.79% auc=60.58% val_score=53.8018 val_score_bestthr=65.1322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.256, mb=0.503, no=0.995, corr=-0.257) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 65.1322
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2569 mb_mean=0.4986 norm_overlap=0.9952 corr_cb=-0.2622 topkJ=0.0158
[TRAIN][ep=024] loss=0.6800 acc=71.95%
[TRAIN][ep=024] mask_avg: mc_mean=0.2581 mb_mean=0.5029 norm_overlap=0.9948 corr_cb=-0.2613
[EPOCH 024/089] train: loss=0.6800 acc=71.95% | val: loss=0.7416 acc=62.65% f1=69.31% auc=61.10% val_score=34.2967 val_score_bestthr=64.5175 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.258, mb=0.503, no=0.995, corr=-0.261) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 64.5175
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1871 mb_mean=0.5043 norm_overlap=0.9908 corr_cb=-0.3537 topkJ=0.0047
[TRAIN][ep=025] loss=0.6653 acc=73.42%
[TRAIN][ep=025] mask_avg: mc_mean=0.2569 mb_mean=0.5029 norm_overlap=0.9947 corr_cb=-0.2675
[EPOCH 025/089] train: loss=0.6653 acc=73.42% | val: loss=0.7126 acc=61.45% f1=72.41% auc=63.14% val_score=54.4113 val_score_bestthr=67.4771 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.257, mb=0.503, no=0.995, corr=-0.268) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.4771
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2348 mb_mean=0.5065 norm_overlap=0.9932 corr_cb=-0.3502 topkJ=0.0049
[TRAIN][ep=026] loss=0.6538 acc=73.29%
[TRAIN][ep=026] mask_avg: mc_mean=0.2482 mb_mean=0.5029 norm_overlap=0.9946 corr_cb=-0.2599
[EPOCH 026/089] train: loss=0.6538 acc=73.29% | val: loss=0.7241 acc=61.45% f1=72.41% auc=62.15% val_score=53.5181 val_score_bestthr=67.4771 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.248, mb=0.503, no=0.995, corr=-0.260) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.4771
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2322 mb_mean=0.4994 norm_overlap=0.9924 corr_cb=-0.3101 topkJ=0.0205
[TRAIN][ep=027] loss=0.6487 acc=75.17%
[TRAIN][ep=027] mask_avg: mc_mean=0.2390 mb_mean=0.5029 norm_overlap=0.9947 corr_cb=-0.2499
[EPOCH 027/089] train: loss=0.6487 acc=75.17% | val: loss=0.7249 acc=63.86% f1=70.59% auc=62.62% val_score=53.4051 val_score_bestthr=65.6391 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.239, mb=0.503, no=0.995, corr=-0.250) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 65.6391
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2474 mb_mean=0.5002 norm_overlap=0.9948 corr_cb=-0.2198 topkJ=0.0489
[TRAIN][ep=028] loss=0.6651 acc=73.29%
[TRAIN][ep=028] mask_avg: mc_mean=0.2619 mb_mean=0.5029 norm_overlap=0.9942 corr_cb=-0.2843
[EPOCH 028/089] train: loss=0.6651 acc=73.29% | val: loss=0.7438 acc=63.86% f1=70.00% auc=62.62% val_score=40.1437 val_score_bestthr=65.6291 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.262, mb=0.503, no=0.994, corr=-0.284) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 65.6291
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2768 mb_mean=0.5037 norm_overlap=0.9915 corr_cb=-0.3823 topkJ=0.0073
[TRAIN][ep=029] loss=0.6589 acc=74.23%
[TRAIN][ep=029] mask_avg: mc_mean=0.2742 mb_mean=0.5029 norm_overlap=0.9941 corr_cb=-0.3023
[EPOCH 029/089] train: loss=0.6589 acc=74.23% | val: loss=0.7267 acc=65.06% f1=71.29% auc=62.91% val_score=53.4051 val_score_bestthr=68.1515 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.274, mb=0.503, no=0.994, corr=-0.302) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 68.1515
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2603 mb_mean=0.4993 norm_overlap=0.9976 corr_cb=-0.1276 topkJ=0.0214
[TRAIN][ep=030] loss=0.6586 acc=73.42%
[TRAIN][ep=030] mask_avg: mc_mean=0.2816 mb_mean=0.5029 norm_overlap=0.9937 corr_cb=-0.3173
[EPOCH 030/089] train: loss=0.6586 acc=73.42% | val: loss=0.7842 acc=66.27% f1=73.58% auc=62.21% val_score=63.9939 val_score_bestthr=66.8805 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.282, mb=0.503, no=0.994, corr=-0.317) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 66.8805
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.3108 mb_mean=0.4945 norm_overlap=0.9927 corr_cb=-0.4229 topkJ=0.0168
[TRAIN][ep=031] loss=0.6593 acc=72.08%
[TRAIN][ep=031] mask_avg: mc_mean=0.2789 mb_mean=0.5029 norm_overlap=0.9939 corr_cb=-0.3041
[EPOCH 031/089] train: loss=0.6593 acc=72.08% | val: loss=0.7535 acc=63.86% f1=70.00% auc=62.73% val_score=41.3782 val_score_bestthr=65.6291 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.279, mb=0.503, no=0.994, corr=-0.304) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 65.6291
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1819 mb_mean=0.5035 norm_overlap=0.9962 corr_cb=-0.1978 topkJ=0.0233
[TRAIN][ep=032] loss=0.6445 acc=73.42%
[TRAIN][ep=032] mask_avg: mc_mean=0.2694 mb_mean=0.5029 norm_overlap=0.9943 corr_cb=-0.2846
[EPOCH 032/089] train: loss=0.6445 acc=73.42% | val: loss=0.7368 acc=65.06% f1=71.29% auc=63.14% val_score=60.9059 val_score_bestthr=68.1515 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.269, mb=0.503, no=0.994, corr=-0.285) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 68.1515
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2409 mb_mean=0.5076 norm_overlap=0.9917 corr_cb=-0.3523 topkJ=0.0008
[TRAIN][ep=033] loss=0.6334 acc=73.83%
[TRAIN][ep=033] mask_avg: mc_mean=0.2765 mb_mean=0.5029 norm_overlap=0.9941 corr_cb=-0.2986
[EPOCH 033/089] train: loss=0.6334 acc=73.83% | val: loss=0.7285 acc=67.47% f1=72.16% auc=63.55% val_score=43.3525 val_score_bestthr=67.8568 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.276, mb=0.503, no=0.994, corr=-0.299) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.8568
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1290 mb_mean=0.5064 norm_overlap=0.9954 corr_cb=-0.1471 topkJ=0.0099
[TRAIN][ep=034] loss=0.6230 acc=75.44%
[TRAIN][ep=034] mask_avg: mc_mean=0.2395 mb_mean=0.5029 norm_overlap=0.9943 corr_cb=-0.2545
[EPOCH 034/089] train: loss=0.6230 acc=75.44% | val: loss=0.7230 acc=66.27% f1=72.00% auc=63.90% val_score=53.8664 val_score_bestthr=69.2661 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.240, mb=0.503, no=0.994, corr=-0.254) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 69.2661
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2102 mb_mean=0.4981 norm_overlap=0.9972 corr_cb=-0.1191 topkJ=0.0165
[TRAIN][ep=035] loss=0.6204 acc=75.03%
[TRAIN][ep=035] mask_avg: mc_mean=0.2620 mb_mean=0.5029 norm_overlap=0.9937 corr_cb=-0.2891
[EPOCH 035/089] train: loss=0.6204 acc=75.03% | val: loss=0.7563 acc=65.06% f1=70.71% auc=63.02% val_score=49.5398 val_score_bestthr=66.7428 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.262, mb=0.503, no=0.994, corr=-0.289) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 66.7428
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2946 mb_mean=0.4988 norm_overlap=0.9952 corr_cb=-0.2405 topkJ=0.0382
[TRAIN][ep=036] loss=0.6055 acc=76.64%
[TRAIN][ep=036] mask_avg: mc_mean=0.2619 mb_mean=0.5029 norm_overlap=0.9937 corr_cb=-0.2905
[EPOCH 036/089] train: loss=0.6055 acc=76.64% | val: loss=0.7572 acc=65.06% f1=71.29% auc=63.08% val_score=52.7263 val_score_bestthr=68.8982 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.262, mb=0.503, no=0.994, corr=-0.291) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 68.8982
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.2961 mb_mean=0.4998 norm_overlap=0.9943 corr_cb=-0.2869 topkJ=0.0141
[TRAIN][ep=037] loss=0.6068 acc=76.51%
[TRAIN][ep=037] mask_avg: mc_mean=0.2541 mb_mean=0.5029 norm_overlap=0.9935 corr_cb=-0.2903
[EPOCH 037/089] train: loss=0.6068 acc=76.51% | val: loss=0.7497 acc=65.06% f1=71.29% auc=62.91% val_score=54.0926 val_score_bestthr=68.1515 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.254, mb=0.503, no=0.994, corr=-0.290) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 68.1515
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2815 mb_mean=0.5025 norm_overlap=0.9888 corr_cb=-0.3818 topkJ=0.0008
[TRAIN][ep=038] loss=0.6138 acc=76.24%
[TRAIN][ep=038] mask_avg: mc_mean=0.3071 mb_mean=0.5029 norm_overlap=0.9928 corr_cb=-0.3619
[EPOCH 038/089] train: loss=0.6138 acc=76.24% | val: loss=0.7847 acc=63.86% f1=70.00% auc=61.69% val_score=62.4156 val_score_bestthr=64.8202 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.307, mb=0.503, no=0.993, corr=-0.362) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 64.8202
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2499 mb_mean=0.5026 norm_overlap=0.9947 corr_cb=-0.2472 topkJ=0.0194
[TRAIN][ep=039] loss=0.5964 acc=76.11%
[TRAIN][ep=039] mask_avg: mc_mean=0.2532 mb_mean=0.5029 norm_overlap=0.9937 corr_cb=-0.2875
[EPOCH 039/089] train: loss=0.5964 acc=76.11% | val: loss=0.7575 acc=65.06% f1=71.29% auc=62.15% val_score=55.0225 val_score_bestthr=68.1515 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.253, mb=0.503, no=0.994, corr=-0.288) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 68.1515
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.2159 mb_mean=0.4982 norm_overlap=0.9954 corr_cb=-0.2308 topkJ=0.0191
[TRAIN][ep=040] loss=0.6050 acc=75.03%
[TRAIN][ep=040] mask_avg: mc_mean=0.2751 mb_mean=0.5029 norm_overlap=0.9931 corr_cb=-0.3213
[EPOCH 040/089] train: loss=0.6050 acc=75.03% | val: loss=0.7528 acc=65.06% f1=71.29% auc=62.97% val_score=55.0225 val_score_bestthr=68.1515 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.275, mb=0.503, no=0.993, corr=-0.321) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 68.1515
[EARLY STOP] no improvement for 30 epochs. best_epoch=10
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
=============== FIT DONE ===============
[BEST] epoch=10 | val_acc=61.45% | val_f1=72.88% | val_auc=57.62% | val_score=54.8361 | val_score_bestthr=71.2933
[TEST@BEST] thr_used=0.405 | acc=60.87% f1=71.78% auc=70.38% | SP_sex=12.00% EO_sex=3.70% SP_age=12.94% EO_age=12.00%
[TIME] 1.01 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/summary_fold_3.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5042 mb_mean=0.5040 norm_overlap=1.0001 corr_cb=0.1951 topkJ=0.1574
[TRAIN][ep=000] loss=0.6944 acc=49.53%
[TRAIN][ep=000] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0819
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5061 mb_mean=0.5005 norm_overlap=1.0000 corr_cb=0.1183 topkJ=0.0577
[TRAIN][ep=001] loss=0.6937 acc=51.14%
[TRAIN][ep=001] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0801
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5044 mb_mean=0.5040 norm_overlap=1.0000 corr_cb=0.0722 topkJ=0.0959
[TRAIN][ep=002] loss=0.6913 acc=54.63%
[TRAIN][ep=002] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0784
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5035 mb_mean=0.4968 norm_overlap=1.0002 corr_cb=0.3148 topkJ=0.1021
[TRAIN][ep=003] loss=0.6896 acc=51.95%
[TRAIN][ep=003] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0800
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5044 mb_mean=0.5048 norm_overlap=1.0001 corr_cb=0.2160 topkJ=0.0656
[TRAIN][ep=004] loss=0.6894 acc=54.23%
[TRAIN][ep=004] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0800
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5067 mb_mean=0.5067 norm_overlap=1.0001 corr_cb=0.1932 topkJ=0.0734
[TRAIN][ep=005] loss=0.6867 acc=53.69%
[TRAIN][ep=005] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0823
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5065 mb_mean=0.5067 norm_overlap=1.0000 corr_cb=-0.0363 topkJ=0.1013
[TRAIN][ep=006] loss=0.6844 acc=55.97%
[TRAIN][ep=006] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0796
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5062 mb_mean=0.5019 norm_overlap=1.0001 corr_cb=0.3117 topkJ=0.2049
[TRAIN][ep=007] loss=0.6865 acc=55.44%
[TRAIN][ep=007] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0800
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5025 mb_mean=0.5033 norm_overlap=1.0000 corr_cb=-0.0452 topkJ=0.0691
[TRAIN][ep=008] loss=0.6797 acc=60.00%
[TRAIN][ep=008] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0804
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5034 mb_mean=0.5057 norm_overlap=1.0001 corr_cb=0.1863 topkJ=0.0624
[TRAIN][ep=009] loss=0.6760 acc=59.19%
[TRAIN][ep=009] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0876
================= FIT START (fold=3) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5055 mb_mean=0.5024 norm_overlap=0.9999 corr_cb=-0.0929 topkJ=0.0409
[TRAIN][ep=000] loss=0.6714 acc=61.48%
[TRAIN][ep=000] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0802
[EPOCH 000/089] train: loss=0.6714 acc=61.48% | val: loss=0.6915 acc=57.83% f1=70.59% auc=51.92% val_score=42.8972 val_score_bestthr=61.2371 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.080) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 61.2371
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5046 mb_mean=0.4991 norm_overlap=1.0000 corr_cb=0.0132 topkJ=0.0779
[TRAIN][ep=001] loss=0.6660 acc=61.88%
[TRAIN][ep=001] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0802
[EPOCH 001/089] train: loss=0.6660 acc=61.88% | val: loss=0.7106 acc=55.42% f1=68.38% auc=48.90% val_score=36.9276 val_score_bestthr=57.1990 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.080) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.2371 -> 57.1990
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5047 mb_mean=0.5037 norm_overlap=1.0002 corr_cb=0.2934 topkJ=0.0559
[TRAIN][ep=002] loss=0.6642 acc=60.54%
[TRAIN][ep=002] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0808
[EPOCH 002/089] train: loss=0.6642 acc=60.54% | val: loss=0.6896 acc=60.24% f1=72.27% auc=54.48% val_score=43.6583 val_score_bestthr=67.7099 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.081) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 61.2371 -> 67.7099
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5066 mb_mean=0.5041 norm_overlap=1.0001 corr_cb=0.1759 topkJ=0.1404
[TRAIN][ep=003] loss=0.6611 acc=60.54%
[TRAIN][ep=003] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0798
[EPOCH 003/089] train: loss=0.6611 acc=60.54% | val: loss=0.6973 acc=59.04% f1=69.09% auc=52.21% val_score=32.5867 val_score_bestthr=59.5114 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.080) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.7099 -> 59.5114
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5061 mb_mean=0.5050 norm_overlap=1.0000 corr_cb=0.0586 topkJ=0.0847
[TRAIN][ep=004] loss=0.6532 acc=62.15%
[TRAIN][ep=004] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0832
[EPOCH 004/089] train: loss=0.6532 acc=62.15% | val: loss=0.6921 acc=61.45% f1=71.93% auc=57.09% val_score=60.7211 val_score_bestthr=64.5440 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.083) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.7099 -> 64.5440
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5043 mb_mean=0.5027 norm_overlap=1.0001 corr_cb=0.2297 topkJ=0.0605
[TRAIN][ep=005] loss=1.2879 acc=62.15%
[TRAIN][ep=005] mask_avg: mc_mean=0.3696 mb_mean=0.5029 norm_overlap=1.0022 corr_cb=0.5970
[EPOCH 005/089] train: loss=1.2879 acc=62.15% | val: loss=0.6861 acc=60.24% f1=71.79% auc=57.73% val_score=48.2249 val_score_bestthr=67.4967 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.370, mb=0.503, no=1.002, corr=0.597) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.7099 -> 67.4967
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2905 mb_mean=0.5054 norm_overlap=1.0017 corr_cb=0.4247 topkJ=0.1822
[TRAIN][ep=006] loss=1.2815 acc=63.89%
[TRAIN][ep=006] mask_avg: mc_mean=0.2713 mb_mean=0.5029 norm_overlap=1.0041 corr_cb=0.5800
[EPOCH 006/089] train: loss=1.2815 acc=63.89% | val: loss=0.6953 acc=57.83% f1=70.09% auc=55.23% val_score=35.3805 val_score_bestthr=62.8622 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.271, mb=0.503, no=1.004, corr=0.580) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.7099 -> 62.8622
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2506 mb_mean=0.5008 norm_overlap=1.0032 corr_cb=0.5191 topkJ=0.2263
[TRAIN][ep=007] loss=1.2802 acc=62.95%
[TRAIN][ep=007] mask_avg: mc_mean=0.2582 mb_mean=0.5029 norm_overlap=1.0040 corr_cb=0.5098
[EPOCH 007/089] train: loss=1.2802 acc=62.95% | val: loss=0.6944 acc=59.04% f1=71.67% auc=58.49% val_score=58.4456 val_score_bestthr=67.9254 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.258, mb=0.503, no=1.004, corr=0.510) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 67.7099 -> 67.9254
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2390 mb_mean=0.4971 norm_overlap=1.0063 corr_cb=0.6480 topkJ=0.1947
[TRAIN][ep=008] loss=1.2814 acc=62.15%
[TRAIN][ep=008] mask_avg: mc_mean=0.2614 mb_mean=0.5029 norm_overlap=1.0035 corr_cb=0.4362
[EPOCH 008/089] train: loss=1.2814 acc=62.15% | val: loss=0.6881 acc=62.65% f1=69.31% auc=57.79% val_score=50.2800 val_score_bestthr=61.5383 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.261, mb=0.503, no=1.003, corr=0.436) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 61.5383
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2212 mb_mean=0.4964 norm_overlap=1.0031 corr_cb=0.4658 topkJ=0.1996
[TRAIN][ep=009] loss=1.2653 acc=65.64%
[TRAIN][ep=009] mask_avg: mc_mean=0.2452 mb_mean=0.5029 norm_overlap=1.0034 corr_cb=0.3738
[EPOCH 009/089] train: loss=1.2653 acc=65.64% | val: loss=0.6927 acc=59.04% f1=71.67% auc=56.63% val_score=45.1171 val_score_bestthr=67.9254 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.245, mb=0.503, no=1.003, corr=0.374) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 67.9254
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.2474 mb_mean=0.5031 norm_overlap=1.0029 corr_cb=0.2923 topkJ=0.1302
[TRAIN][ep=010] loss=1.2587 acc=65.77%
[TRAIN][ep=010] mask_avg: mc_mean=0.2388 mb_mean=0.5029 norm_overlap=1.0028 corr_cb=0.2758
[EPOCH 010/089] train: loss=1.2587 acc=65.77% | val: loss=0.6944 acc=61.45% f1=72.88% auc=57.85% val_score=57.5604 val_score_bestthr=71.2933 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.239, mb=0.503, no=1.003, corr=0.276) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 67.9254 -> 71.2933
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.2585 mb_mean=0.5027 norm_overlap=1.0012 corr_cb=0.1372 topkJ=0.0550
[TRAIN][ep=011] loss=1.2478 acc=65.64%
[TRAIN][ep=011] mask_avg: mc_mean=0.2304 mb_mean=0.5029 norm_overlap=1.0021 corr_cb=0.1704
[EPOCH 011/089] train: loss=1.2478 acc=65.64% | val: loss=0.7261 acc=59.04% f1=71.67% auc=55.41% val_score=33.8440 val_score_bestthr=66.4943 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.230, mb=0.503, no=1.002, corr=0.170) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 66.4943
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.2434 mb_mean=0.5058 norm_overlap=1.0013 corr_cb=0.1170 topkJ=0.0597
[TRAIN][ep=012] loss=1.2478 acc=66.85%
[TRAIN][ep=012] mask_avg: mc_mean=0.2254 mb_mean=0.5029 norm_overlap=1.0015 corr_cb=0.1111
[EPOCH 012/089] train: loss=1.2478 acc=66.85% | val: loss=0.7128 acc=60.24% f1=72.27% auc=59.01% val_score=55.0451 val_score_bestthr=67.9849 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.225, mb=0.503, no=1.002, corr=0.111) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.9849
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.2499 mb_mean=0.5051 norm_overlap=0.9995 corr_cb=-0.0396 topkJ=0.0539
[TRAIN][ep=013] loss=1.2440 acc=66.85%
[TRAIN][ep=013] mask_avg: mc_mean=0.2454 mb_mean=0.5029 norm_overlap=1.0003 corr_cb=0.0159
[EPOCH 013/089] train: loss=1.2440 acc=66.85% | val: loss=0.7095 acc=61.45% f1=69.81% auc=56.80% val_score=42.6525 val_score_bestthr=64.2778 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.245, mb=0.503, no=1.000, corr=0.016) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 64.2778
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.2248 mb_mean=0.5041 norm_overlap=0.9972 corr_cb=-0.2313 topkJ=0.0168
[TRAIN][ep=014] loss=1.2282 acc=67.92%
[TRAIN][ep=014] mask_avg: mc_mean=0.2190 mb_mean=0.5029 norm_overlap=1.0003 corr_cb=0.0170
[EPOCH 014/089] train: loss=1.2282 acc=67.92% | val: loss=0.7061 acc=59.04% f1=71.67% auc=58.72% val_score=46.2282 val_score_bestthr=67.9254 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.219, mb=0.503, no=1.000, corr=0.017) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.9254
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1712 mb_mean=0.5008 norm_overlap=1.0028 corr_cb=0.1468 topkJ=0.0380
[TRAIN][ep=015] loss=1.2211 acc=69.53%
[TRAIN][ep=015] mask_avg: mc_mean=0.2200 mb_mean=0.5029 norm_overlap=0.9994 corr_cb=-0.0460
[EPOCH 015/089] train: loss=1.2211 acc=69.53% | val: loss=0.7056 acc=60.24% f1=71.79% auc=59.36% val_score=56.2000 val_score_bestthr=65.1322 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.220, mb=0.503, no=0.999, corr=-0.046) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 65.1322
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.2593 mb_mean=0.5040 norm_overlap=0.9949 corr_cb=-0.2880 topkJ=0.0122
[TRAIN][ep=016] loss=1.0119 acc=68.86%
[TRAIN][ep=016] mask_avg: mc_mean=0.2300 mb_mean=0.5029 norm_overlap=0.9986 corr_cb=-0.0938
[EPOCH 016/089] train: loss=1.0119 acc=68.86% | val: loss=0.7374 acc=61.45% f1=72.41% auc=60.29% val_score=55.0451 val_score_bestthr=67.4771 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.230, mb=0.503, no=0.999, corr=-0.094) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.4771
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.2273 mb_mean=0.5001 norm_overlap=0.9974 corr_cb=-0.1203 topkJ=0.0136
[TRAIN][ep=017] loss=0.8139 acc=69.66%
[TRAIN][ep=017] mask_avg: mc_mean=0.2382 mb_mean=0.5029 norm_overlap=0.9977 corr_cb=-0.1421
[EPOCH 017/089] train: loss=0.8139 acc=69.66% | val: loss=0.7285 acc=60.24% f1=72.27% auc=59.88% val_score=55.4025 val_score_bestthr=69.8204 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.238, mb=0.503, no=0.998, corr=-0.142) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 69.8204
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.2532 mb_mean=0.5046 norm_overlap=0.9954 corr_cb=-0.2015 topkJ=0.0055
[TRAIN][ep=018] loss=0.7664 acc=72.08%
[TRAIN][ep=018] mask_avg: mc_mean=0.2272 mb_mean=0.5029 norm_overlap=0.9973 corr_cb=-0.1497
[EPOCH 018/089] train: loss=0.7664 acc=72.08% | val: loss=0.7225 acc=60.24% f1=72.27% auc=60.29% val_score=53.8018 val_score_bestthr=69.8204 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.227, mb=0.503, no=0.997, corr=-0.150) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 69.8204
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.2222 mb_mean=0.5051 norm_overlap=0.9936 corr_cb=-0.3417 topkJ=0.0095
[TRAIN][ep=019] loss=0.7607 acc=68.99%
[TRAIN][ep=019] mask_avg: mc_mean=0.2442 mb_mean=0.5029 norm_overlap=0.9965 corr_cb=-0.2016
[EPOCH 019/089] train: loss=0.7607 acc=68.99% | val: loss=0.7328 acc=62.65% f1=69.31% auc=59.07% val_score=48.8609 val_score_bestthr=65.2642 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.244, mb=0.503, no=0.996, corr=-0.202) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 65.2642
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.2830 mb_mean=0.5115 norm_overlap=0.9919 corr_cb=-0.4389 topkJ=0.0024
[TRAIN][ep=020] loss=0.7434 acc=71.14%
[TRAIN][ep=020] mask_avg: mc_mean=0.2353 mb_mean=0.5029 norm_overlap=0.9963 corr_cb=-0.1990
[EPOCH 020/089] train: loss=0.7434 acc=71.14% | val: loss=0.7346 acc=61.45% f1=68.63% auc=59.42% val_score=36.5251 val_score_bestthr=64.1546 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.235, mb=0.503, no=0.996, corr=-0.199) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 64.1546
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2319 mb_mean=0.5054 norm_overlap=0.9976 corr_cb=-0.1475 topkJ=0.0288
[TRAIN][ep=021] loss=0.7368 acc=72.48%
[TRAIN][ep=021] mask_avg: mc_mean=0.2408 mb_mean=0.5029 norm_overlap=0.9958 corr_cb=-0.2218
[EPOCH 021/089] train: loss=0.7368 acc=72.48% | val: loss=0.7233 acc=61.45% f1=72.41% auc=61.63% val_score=56.0663 val_score_bestthr=67.4771 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.241, mb=0.503, no=0.996, corr=-0.222) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.4771
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2483 mb_mean=0.5063 norm_overlap=0.9968 corr_cb=-0.1930 topkJ=0.0231
[TRAIN][ep=022] loss=0.7357 acc=73.29%
[TRAIN][ep=022] mask_avg: mc_mean=0.2592 mb_mean=0.5029 norm_overlap=0.9953 corr_cb=-0.2473
[EPOCH 022/089] train: loss=0.7357 acc=73.29% | val: loss=0.7390 acc=61.45% f1=72.41% auc=61.51% val_score=61.2170 val_score_bestthr=67.4771 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.259, mb=0.503, no=0.995, corr=-0.247) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.4771
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2419 mb_mean=0.4990 norm_overlap=0.9980 corr_cb=-0.1165 topkJ=0.0317
[TRAIN][ep=023] loss=0.7362 acc=71.68%
[TRAIN][ep=023] mask_avg: mc_mean=0.2579 mb_mean=0.5029 norm_overlap=0.9951 corr_cb=-0.2540
[EPOCH 023/089] train: loss=0.7362 acc=71.68% | val: loss=0.7305 acc=60.24% f1=71.79% auc=60.52% val_score=53.8018 val_score_bestthr=65.1322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.258, mb=0.503, no=0.995, corr=-0.254) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 65.1322
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2576 mb_mean=0.4986 norm_overlap=0.9954 corr_cb=-0.2545 topkJ=0.0158
[TRAIN][ep=024] loss=0.7335 acc=71.95%
[TRAIN][ep=024] mask_avg: mc_mean=0.2590 mb_mean=0.5029 norm_overlap=0.9950 corr_cb=-0.2571
[EPOCH 024/089] train: loss=0.7335 acc=71.95% | val: loss=0.7425 acc=61.45% f1=68.63% auc=61.10% val_score=34.2967 val_score_bestthr=63.4079 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.259, mb=0.503, no=0.995, corr=-0.257) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 63.4079
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1880 mb_mean=0.5043 norm_overlap=0.9909 corr_cb=-0.3532 topkJ=0.0050
[TRAIN][ep=025] loss=0.7190 acc=73.29%
[TRAIN][ep=025] mask_avg: mc_mean=0.2584 mb_mean=0.5029 norm_overlap=0.9948 corr_cb=-0.2645
[EPOCH 025/089] train: loss=0.7190 acc=73.29% | val: loss=0.7135 acc=61.45% f1=72.41% auc=62.79% val_score=54.4113 val_score_bestthr=67.4771 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.258, mb=0.503, no=0.995, corr=-0.265) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.4771
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2365 mb_mean=0.5065 norm_overlap=0.9934 corr_cb=-0.3445 topkJ=0.0049
[TRAIN][ep=026] loss=0.7076 acc=73.29%
[TRAIN][ep=026] mask_avg: mc_mean=0.2505 mb_mean=0.5029 norm_overlap=0.9947 corr_cb=-0.2589
[EPOCH 026/089] train: loss=0.7076 acc=73.29% | val: loss=0.7246 acc=61.45% f1=72.41% auc=62.15% val_score=53.5181 val_score_bestthr=67.4771 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.250, mb=0.503, no=0.995, corr=-0.259) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.4771
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2315 mb_mean=0.4994 norm_overlap=0.9926 corr_cb=-0.3012 topkJ=0.0205
[TRAIN][ep=027] loss=0.7025 acc=75.44%
[TRAIN][ep=027] mask_avg: mc_mean=0.2398 mb_mean=0.5029 norm_overlap=0.9948 corr_cb=-0.2463
[EPOCH 027/089] train: loss=0.7025 acc=75.44% | val: loss=0.7257 acc=61.45% f1=72.41% auc=62.38% val_score=53.4051 val_score_bestthr=67.4771 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.240, mb=0.503, no=0.995, corr=-0.246) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.4771
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2464 mb_mean=0.5002 norm_overlap=0.9951 corr_cb=-0.2112 topkJ=0.0507
[TRAIN][ep=028] loss=0.7188 acc=73.56%
[TRAIN][ep=028] mask_avg: mc_mean=0.2641 mb_mean=0.5029 norm_overlap=0.9943 corr_cb=-0.2824
[EPOCH 028/089] train: loss=0.7188 acc=73.56% | val: loss=0.7444 acc=63.86% f1=70.00% auc=62.62% val_score=40.1437 val_score_bestthr=65.6291 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.264, mb=0.503, no=0.994, corr=-0.282) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 65.6291
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2797 mb_mean=0.5037 norm_overlap=0.9916 corr_cb=-0.3821 topkJ=0.0073
[TRAIN][ep=029] loss=0.7126 acc=74.09%
[TRAIN][ep=029] mask_avg: mc_mean=0.2754 mb_mean=0.5029 norm_overlap=0.9942 corr_cb=-0.2996
[EPOCH 029/089] train: loss=0.7126 acc=74.09% | val: loss=0.7273 acc=65.06% f1=71.29% auc=62.79% val_score=53.4051 val_score_bestthr=68.1515 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.275, mb=0.503, no=0.994, corr=-0.300) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 68.1515
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2622 mb_mean=0.4993 norm_overlap=0.9976 corr_cb=-0.1252 topkJ=0.0210
[TRAIN][ep=030] loss=0.7122 acc=73.29%
[TRAIN][ep=030] mask_avg: mc_mean=0.2825 mb_mean=0.5029 norm_overlap=0.9938 corr_cb=-0.3138
[EPOCH 030/089] train: loss=0.7122 acc=73.29% | val: loss=0.7856 acc=66.27% f1=73.58% auc=62.09% val_score=63.9939 val_score_bestthr=66.8805 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.283, mb=0.503, no=0.994, corr=-0.314) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 66.8805
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.3124 mb_mean=0.4945 norm_overlap=0.9928 corr_cb=-0.4210 topkJ=0.0168
[TRAIN][ep=031] loss=0.7131 acc=71.68%
[TRAIN][ep=031] mask_avg: mc_mean=0.2799 mb_mean=0.5029 norm_overlap=0.9940 corr_cb=-0.3015
[EPOCH 031/089] train: loss=0.7131 acc=71.68% | val: loss=0.7548 acc=63.86% f1=70.00% auc=62.62% val_score=41.3782 val_score_bestthr=65.6291 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.280, mb=0.503, no=0.994, corr=-0.301) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 65.6291
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1796 mb_mean=0.5035 norm_overlap=0.9963 corr_cb=-0.1905 topkJ=0.0229
[TRAIN][ep=032] loss=0.6982 acc=73.56%
[TRAIN][ep=032] mask_avg: mc_mean=0.2707 mb_mean=0.5029 norm_overlap=0.9944 corr_cb=-0.2824
[EPOCH 032/089] train: loss=0.6982 acc=73.56% | val: loss=0.7381 acc=65.06% f1=71.29% auc=63.08% val_score=60.9059 val_score_bestthr=68.1515 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.271, mb=0.503, no=0.994, corr=-0.282) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 68.1515
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2450 mb_mean=0.5076 norm_overlap=0.9917 corr_cb=-0.3550 topkJ=0.0012
[TRAIN][ep=033] loss=0.6870 acc=73.83%
[TRAIN][ep=033] mask_avg: mc_mean=0.2784 mb_mean=0.5029 norm_overlap=0.9942 corr_cb=-0.2974
[EPOCH 033/089] train: loss=0.6870 acc=73.83% | val: loss=0.7309 acc=67.47% f1=72.16% auc=63.20% val_score=50.8055 val_score_bestthr=67.8568 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.278, mb=0.503, no=0.994, corr=-0.297) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.8568
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1315 mb_mean=0.5064 norm_overlap=0.9955 corr_cb=-0.1477 topkJ=0.0103
[TRAIN][ep=034] loss=0.6768 acc=75.44%
[TRAIN][ep=034] mask_avg: mc_mean=0.2415 mb_mean=0.5029 norm_overlap=0.9943 corr_cb=-0.2536
[EPOCH 034/089] train: loss=0.6768 acc=75.44% | val: loss=0.7237 acc=65.06% f1=71.29% auc=63.78% val_score=53.8664 val_score_bestthr=68.1515 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.242, mb=0.503, no=0.994, corr=-0.254) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 68.1515
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2093 mb_mean=0.4981 norm_overlap=0.9973 corr_cb=-0.1137 topkJ=0.0157
[TRAIN][ep=035] loss=0.6744 acc=74.77%
[TRAIN][ep=035] mask_avg: mc_mean=0.2625 mb_mean=0.5029 norm_overlap=0.9938 corr_cb=-0.2867
[EPOCH 035/089] train: loss=0.6744 acc=74.77% | val: loss=0.7570 acc=65.06% f1=70.71% auc=62.50% val_score=49.5398 val_score_bestthr=66.7428 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.263, mb=0.503, no=0.994, corr=-0.287) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 66.7428
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2907 mb_mean=0.4988 norm_overlap=0.9953 corr_cb=-0.2334 topkJ=0.0382
[TRAIN][ep=036] loss=0.6593 acc=76.51%
[TRAIN][ep=036] mask_avg: mc_mean=0.2635 mb_mean=0.5029 norm_overlap=0.9937 corr_cb=-0.2898
[EPOCH 036/089] train: loss=0.6593 acc=76.51% | val: loss=0.7579 acc=66.27% f1=72.00% auc=62.73% val_score=52.7263 val_score_bestthr=69.2661 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.264, mb=0.503, no=0.994, corr=-0.290) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 69.2661
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.2948 mb_mean=0.4998 norm_overlap=0.9944 corr_cb=-0.2803 topkJ=0.0141
[TRAIN][ep=037] loss=0.6610 acc=76.51%
[TRAIN][ep=037] mask_avg: mc_mean=0.2556 mb_mean=0.5029 norm_overlap=0.9936 corr_cb=-0.2899
[EPOCH 037/089] train: loss=0.6610 acc=76.51% | val: loss=0.7511 acc=62.65% f1=73.04% auc=62.67% val_score=53.4478 val_score_bestthr=67.4592 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.256, mb=0.503, no=0.994, corr=-0.290) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.4592
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2818 mb_mean=0.5025 norm_overlap=0.9889 corr_cb=-0.3793 topkJ=0.0008
[TRAIN][ep=038] loss=0.6686 acc=75.97%
[TRAIN][ep=038] mask_avg: mc_mean=0.3093 mb_mean=0.5029 norm_overlap=0.9929 corr_cb=-0.3625
[EPOCH 038/089] train: loss=0.6686 acc=75.97% | val: loss=0.7848 acc=63.86% f1=70.00% auc=61.57% val_score=62.4156 val_score_bestthr=64.8202 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.309, mb=0.503, no=0.993, corr=-0.363) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 64.8202
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2496 mb_mean=0.5026 norm_overlap=0.9948 corr_cb=-0.2426 topkJ=0.0198
[TRAIN][ep=039] loss=0.6504 acc=76.51%
[TRAIN][ep=039] mask_avg: mc_mean=0.2537 mb_mean=0.5029 norm_overlap=0.9937 corr_cb=-0.2857
[EPOCH 039/089] train: loss=0.6504 acc=76.51% | val: loss=0.7591 acc=65.06% f1=71.29% auc=61.74% val_score=55.0225 val_score_bestthr=68.1515 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.254, mb=0.503, no=0.994, corr=-0.286) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 68.1515
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.2210 mb_mean=0.4982 norm_overlap=0.9954 corr_cb=-0.2337 topkJ=0.0195
[TRAIN][ep=040] loss=0.6593 acc=75.03%
[TRAIN][ep=040] mask_avg: mc_mean=0.2763 mb_mean=0.5029 norm_overlap=0.9932 corr_cb=-0.3202
[EPOCH 040/089] train: loss=0.6593 acc=75.03% | val: loss=0.7548 acc=65.06% f1=71.29% auc=62.44% val_score=55.0225 val_score_bestthr=68.1515 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.276, mb=0.503, no=0.993, corr=-0.320) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 68.1515
[EARLY STOP] no improvement for 30 epochs. best_epoch=10
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
=============== FIT DONE ===============
[BEST] epoch=10 | val_acc=61.45% | val_f1=72.88% | val_auc=57.85% | val_score=57.5604 | val_score_bestthr=71.2933
[TEST@BEST] thr_used=0.400 | acc=59.90% f1=71.28% auc=70.41% | SP_sex=10.83% EO_sex=3.70% SP_age=10.98% EO_age=12.00%
[TIME] 1.16 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/summary_fold_3.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5042 mb_mean=0.5040 norm_overlap=1.0001 corr_cb=0.1951 topkJ=0.1574
[TRAIN][ep=000] loss=0.6944 acc=49.53%
[TRAIN][ep=000] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0819
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5061 mb_mean=0.5005 norm_overlap=1.0000 corr_cb=0.1183 topkJ=0.0577
[TRAIN][ep=001] loss=0.6937 acc=51.14%
[TRAIN][ep=001] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0801
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5044 mb_mean=0.5040 norm_overlap=1.0000 corr_cb=0.0722 topkJ=0.0959
[TRAIN][ep=002] loss=0.6913 acc=54.63%
[TRAIN][ep=002] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0784
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5035 mb_mean=0.4968 norm_overlap=1.0002 corr_cb=0.3148 topkJ=0.1021
[TRAIN][ep=003] loss=0.6896 acc=51.95%
[TRAIN][ep=003] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0800
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5044 mb_mean=0.5048 norm_overlap=1.0001 corr_cb=0.2160 topkJ=0.0656
[TRAIN][ep=004] loss=0.6894 acc=54.23%
[TRAIN][ep=004] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0800
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5067 mb_mean=0.5067 norm_overlap=1.0001 corr_cb=0.1932 topkJ=0.0734
[TRAIN][ep=005] loss=0.6867 acc=53.69%
[TRAIN][ep=005] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0823
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5065 mb_mean=0.5067 norm_overlap=1.0000 corr_cb=-0.0363 topkJ=0.1013
[TRAIN][ep=006] loss=0.6844 acc=55.97%
[TRAIN][ep=006] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0796
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5062 mb_mean=0.5019 norm_overlap=1.0001 corr_cb=0.3117 topkJ=0.2049
[TRAIN][ep=007] loss=0.6865 acc=55.44%
[TRAIN][ep=007] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0800
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5025 mb_mean=0.5033 norm_overlap=1.0000 corr_cb=-0.0452 topkJ=0.0691
[TRAIN][ep=008] loss=0.6797 acc=60.00%
[TRAIN][ep=008] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0804
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5034 mb_mean=0.5057 norm_overlap=1.0001 corr_cb=0.1863 topkJ=0.0624
[TRAIN][ep=009] loss=0.6760 acc=59.19%
[TRAIN][ep=009] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0876
================= FIT START (fold=3) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5055 mb_mean=0.5024 norm_overlap=0.9999 corr_cb=-0.0929 topkJ=0.0409
[TRAIN][ep=000] loss=0.6714 acc=61.48%
[TRAIN][ep=000] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0802
[EPOCH 000/089] train: loss=0.6714 acc=61.48% | val: loss=0.6915 acc=57.83% f1=70.59% auc=51.92% val_score=42.8972 val_score_bestthr=61.2371 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.080) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 61.2371
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5046 mb_mean=0.4991 norm_overlap=1.0000 corr_cb=0.0132 topkJ=0.0779
[TRAIN][ep=001] loss=0.6660 acc=62.01%
[TRAIN][ep=001] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0802
[EPOCH 001/089] train: loss=0.6660 acc=62.01% | val: loss=0.7106 acc=54.22% f1=69.35% auc=48.90% val_score=36.9276 val_score_bestthr=62.6702 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.080) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 61.2371 -> 62.6702
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5047 mb_mean=0.5037 norm_overlap=1.0002 corr_cb=0.2934 topkJ=0.0559
[TRAIN][ep=002] loss=0.6642 acc=60.54%
[TRAIN][ep=002] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0808
[EPOCH 002/089] train: loss=0.6642 acc=60.54% | val: loss=0.6896 acc=60.24% f1=72.27% auc=54.48% val_score=43.6583 val_score_bestthr=67.7099 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.081) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 62.6702 -> 67.7099
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5066 mb_mean=0.5041 norm_overlap=1.0001 corr_cb=0.1759 topkJ=0.1404
[TRAIN][ep=003] loss=0.6611 acc=60.54%
[TRAIN][ep=003] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0798
[EPOCH 003/089] train: loss=0.6611 acc=60.54% | val: loss=0.6973 acc=59.04% f1=69.09% auc=52.21% val_score=32.5867 val_score_bestthr=59.5114 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.080) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.7099 -> 59.5114
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5061 mb_mean=0.5050 norm_overlap=1.0000 corr_cb=0.0586 topkJ=0.0847
[TRAIN][ep=004] loss=0.6532 acc=62.01%
[TRAIN][ep=004] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0832
[EPOCH 004/089] train: loss=0.6532 acc=62.01% | val: loss=0.6920 acc=61.45% f1=71.93% auc=57.21% val_score=60.7211 val_score_bestthr=64.5440 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.083) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.7099 -> 64.5440
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5043 mb_mean=0.5027 norm_overlap=1.0001 corr_cb=0.2297 topkJ=0.0605
[TRAIN][ep=005] loss=1.4552 acc=62.42%
[TRAIN][ep=005] mask_avg: mc_mean=0.3696 mb_mean=0.5029 norm_overlap=1.0022 corr_cb=0.5970
[EPOCH 005/089] train: loss=1.4552 acc=62.42% | val: loss=0.6863 acc=60.24% f1=71.79% auc=57.67% val_score=52.5376 val_score_bestthr=67.4967 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.370, mb=0.503, no=1.002, corr=0.597) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.7099 -> 67.4967
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2906 mb_mean=0.5054 norm_overlap=1.0017 corr_cb=0.4246 topkJ=0.1822
[TRAIN][ep=006] loss=1.4434 acc=64.03%
[TRAIN][ep=006] mask_avg: mc_mean=0.2713 mb_mean=0.5029 norm_overlap=1.0041 corr_cb=0.5800
[EPOCH 006/089] train: loss=1.4434 acc=64.03% | val: loss=0.6953 acc=57.83% f1=70.09% auc=55.06% val_score=35.3805 val_score_bestthr=62.8622 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.271, mb=0.503, no=1.004, corr=0.580) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.7099 -> 62.8622
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2505 mb_mean=0.5008 norm_overlap=1.0032 corr_cb=0.5190 topkJ=0.2257
[TRAIN][ep=007] loss=1.4418 acc=62.68%
[TRAIN][ep=007] mask_avg: mc_mean=0.2581 mb_mean=0.5029 norm_overlap=1.0040 corr_cb=0.5089
[EPOCH 007/089] train: loss=1.4418 acc=62.68% | val: loss=0.6946 acc=59.04% f1=71.67% auc=58.60% val_score=58.8200 val_score_bestthr=67.9254 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.258, mb=0.503, no=1.004, corr=0.509) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 67.7099 -> 67.9254
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2391 mb_mean=0.4971 norm_overlap=1.0063 corr_cb=0.6453 topkJ=0.1947
[TRAIN][ep=008] loss=1.4428 acc=62.15%
[TRAIN][ep=008] mask_avg: mc_mean=0.2621 mb_mean=0.5029 norm_overlap=1.0034 corr_cb=0.4329
[EPOCH 008/089] train: loss=1.4428 acc=62.15% | val: loss=0.6885 acc=62.65% f1=69.31% auc=57.73% val_score=50.2800 val_score_bestthr=61.5383 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.262, mb=0.503, no=1.003, corr=0.433) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 61.5383
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2211 mb_mean=0.4964 norm_overlap=1.0031 corr_cb=0.4635 topkJ=0.1991
[TRAIN][ep=009] loss=1.4263 acc=65.50%
[TRAIN][ep=009] mask_avg: mc_mean=0.2449 mb_mean=0.5029 norm_overlap=1.0034 corr_cb=0.3722
[EPOCH 009/089] train: loss=1.4263 acc=65.50% | val: loss=0.6932 acc=59.04% f1=71.67% auc=56.51% val_score=45.1171 val_score_bestthr=67.9254 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.245, mb=0.503, no=1.003, corr=0.372) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 67.9254
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.2484 mb_mean=0.5031 norm_overlap=1.0028 corr_cb=0.2889 topkJ=0.1297
[TRAIN][ep=010] loss=1.4196 acc=65.77%
[TRAIN][ep=010] mask_avg: mc_mean=0.2390 mb_mean=0.5029 norm_overlap=1.0028 corr_cb=0.2753
[EPOCH 010/089] train: loss=1.4196 acc=65.77% | val: loss=0.6949 acc=61.45% f1=72.88% auc=57.97% val_score=57.5501 val_score_bestthr=71.2933 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.239, mb=0.503, no=1.003, corr=0.275) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 67.9254 -> 71.2933
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.2583 mb_mean=0.5027 norm_overlap=1.0012 corr_cb=0.1372 topkJ=0.0554
[TRAIN][ep=011] loss=1.4085 acc=65.50%
[TRAIN][ep=011] mask_avg: mc_mean=0.2304 mb_mean=0.5029 norm_overlap=1.0021 corr_cb=0.1716
[EPOCH 011/089] train: loss=1.4085 acc=65.50% | val: loss=0.7263 acc=61.45% f1=69.81% auc=55.29% val_score=33.8440 val_score_bestthr=64.6710 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.230, mb=0.503, no=1.002, corr=0.172) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 64.6710
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.2444 mb_mean=0.5058 norm_overlap=1.0013 corr_cb=0.1176 topkJ=0.0561
[TRAIN][ep=012] loss=1.4084 acc=66.58%
[TRAIN][ep=012] mask_avg: mc_mean=0.2261 mb_mean=0.5029 norm_overlap=1.0015 corr_cb=0.1113
[EPOCH 012/089] train: loss=1.4084 acc=66.58% | val: loss=0.7137 acc=60.24% f1=72.27% auc=59.07% val_score=55.0451 val_score_bestthr=67.9849 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.226, mb=0.503, no=1.002, corr=0.111) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.9849
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.2502 mb_mean=0.5051 norm_overlap=0.9995 corr_cb=-0.0407 topkJ=0.0543
[TRAIN][ep=013] loss=1.4046 acc=66.71%
[TRAIN][ep=013] mask_avg: mc_mean=0.2453 mb_mean=0.5029 norm_overlap=1.0003 corr_cb=0.0181
[EPOCH 013/089] train: loss=1.4046 acc=66.71% | val: loss=0.7103 acc=60.24% f1=71.79% auc=56.80% val_score=42.6525 val_score_bestthr=67.4967 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.245, mb=0.503, no=1.000, corr=0.018) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.4967
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.2260 mb_mean=0.5041 norm_overlap=0.9972 corr_cb=-0.2320 topkJ=0.0160
[TRAIN][ep=014] loss=1.3883 acc=67.79%
[TRAIN][ep=014] mask_avg: mc_mean=0.2195 mb_mean=0.5029 norm_overlap=1.0003 corr_cb=0.0178
[EPOCH 014/089] train: loss=1.3883 acc=67.79% | val: loss=0.7064 acc=59.04% f1=71.67% auc=58.72% val_score=46.2282 val_score_bestthr=67.9254 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.219, mb=0.503, no=1.000, corr=0.018) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.9254
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1716 mb_mean=0.5008 norm_overlap=1.0028 corr_cb=0.1494 topkJ=0.0384
[TRAIN][ep=015] loss=1.3806 acc=69.53%
[TRAIN][ep=015] mask_avg: mc_mean=0.2211 mb_mean=0.5029 norm_overlap=0.9994 corr_cb=-0.0464
[EPOCH 015/089] train: loss=1.3806 acc=69.53% | val: loss=0.7060 acc=61.45% f1=72.41% auc=59.30% val_score=56.2000 val_score_bestthr=65.1127 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.221, mb=0.503, no=0.999, corr=-0.046) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 65.1127
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.2597 mb_mean=0.5040 norm_overlap=0.9949 corr_cb=-0.2878 topkJ=0.0122
[TRAIN][ep=016] loss=1.1717 acc=68.72%
[TRAIN][ep=016] mask_avg: mc_mean=0.2306 mb_mean=0.5029 norm_overlap=0.9986 corr_cb=-0.0929
[EPOCH 016/089] train: loss=1.1717 acc=68.72% | val: loss=0.7375 acc=61.45% f1=72.41% auc=60.35% val_score=55.0451 val_score_bestthr=67.4771 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.231, mb=0.503, no=0.999, corr=-0.093) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.4771
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.2279 mb_mean=0.5001 norm_overlap=0.9974 corr_cb=-0.1194 topkJ=0.0136
[TRAIN][ep=017] loss=0.9735 acc=69.53%
[TRAIN][ep=017] mask_avg: mc_mean=0.2390 mb_mean=0.5029 norm_overlap=0.9977 corr_cb=-0.1419
[EPOCH 017/089] train: loss=0.9735 acc=69.53% | val: loss=0.7285 acc=60.24% f1=72.27% auc=59.88% val_score=55.4025 val_score_bestthr=69.8204 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.239, mb=0.503, no=0.998, corr=-0.142) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 69.8204
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.2542 mb_mean=0.5046 norm_overlap=0.9954 corr_cb=-0.2006 topkJ=0.0059
[TRAIN][ep=018] loss=0.9256 acc=71.81%
[TRAIN][ep=018] mask_avg: mc_mean=0.2282 mb_mean=0.5029 norm_overlap=0.9973 corr_cb=-0.1496
[EPOCH 018/089] train: loss=0.9256 acc=71.81% | val: loss=0.7223 acc=60.24% f1=71.79% auc=60.29% val_score=53.8018 val_score_bestthr=65.1322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.228, mb=0.503, no=0.997, corr=-0.150) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 65.1322
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.2232 mb_mean=0.5051 norm_overlap=0.9936 corr_cb=-0.3429 topkJ=0.0087
[TRAIN][ep=019] loss=0.9199 acc=68.99%
[TRAIN][ep=019] mask_avg: mc_mean=0.2444 mb_mean=0.5029 norm_overlap=0.9965 corr_cb=-0.2000
[EPOCH 019/089] train: loss=0.9199 acc=68.99% | val: loss=0.7334 acc=62.65% f1=69.31% auc=59.01% val_score=48.8609 val_score_bestthr=65.2642 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.244, mb=0.503, no=0.997, corr=-0.200) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 65.2642
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.2839 mb_mean=0.5115 norm_overlap=0.9920 corr_cb=-0.4380 topkJ=0.0024
[TRAIN][ep=020] loss=0.9020 acc=71.41%
[TRAIN][ep=020] mask_avg: mc_mean=0.2362 mb_mean=0.5029 norm_overlap=0.9963 corr_cb=-0.1982
[EPOCH 020/089] train: loss=0.9020 acc=71.41% | val: loss=0.7350 acc=61.45% f1=68.63% auc=59.42% val_score=36.5251 val_score_bestthr=64.1546 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.236, mb=0.503, no=0.996, corr=-0.198) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 64.1546
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2334 mb_mean=0.5054 norm_overlap=0.9977 corr_cb=-0.1459 topkJ=0.0292
[TRAIN][ep=021] loss=0.8954 acc=72.62%
[TRAIN][ep=021] mask_avg: mc_mean=0.2416 mb_mean=0.5029 norm_overlap=0.9958 corr_cb=-0.2214
[EPOCH 021/089] train: loss=0.8954 acc=72.62% | val: loss=0.7232 acc=61.45% f1=72.41% auc=61.51% val_score=56.0663 val_score_bestthr=67.4771 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.242, mb=0.503, no=0.996, corr=-0.221) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.4771
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2490 mb_mean=0.5063 norm_overlap=0.9968 corr_cb=-0.1917 topkJ=0.0231
[TRAIN][ep=022] loss=0.8937 acc=73.29%
[TRAIN][ep=022] mask_avg: mc_mean=0.2597 mb_mean=0.5029 norm_overlap=0.9953 corr_cb=-0.2460
[EPOCH 022/089] train: loss=0.8937 acc=73.29% | val: loss=0.7396 acc=61.45% f1=72.41% auc=61.40% val_score=62.0186 val_score_bestthr=67.4771 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.260, mb=0.503, no=0.995, corr=-0.246) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.4771
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2427 mb_mean=0.4990 norm_overlap=0.9980 corr_cb=-0.1153 topkJ=0.0325
[TRAIN][ep=023] loss=0.8937 acc=71.81%
[TRAIN][ep=023] mask_avg: mc_mean=0.2582 mb_mean=0.5029 norm_overlap=0.9951 corr_cb=-0.2525
[EPOCH 023/089] train: loss=0.8937 acc=71.81% | val: loss=0.7305 acc=60.24% f1=71.79% auc=60.52% val_score=53.8018 val_score_bestthr=65.1322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.258, mb=0.503, no=0.995, corr=-0.252) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 65.1322
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2581 mb_mean=0.4986 norm_overlap=0.9955 corr_cb=-0.2519 topkJ=0.0162
[TRAIN][ep=024] loss=0.8908 acc=71.68%
[TRAIN][ep=024] mask_avg: mc_mean=0.2588 mb_mean=0.5029 norm_overlap=0.9950 corr_cb=-0.2547
[EPOCH 024/089] train: loss=0.8908 acc=71.68% | val: loss=0.7427 acc=61.45% f1=68.63% auc=61.10% val_score=34.2967 val_score_bestthr=63.4079 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.259, mb=0.503, no=0.995, corr=-0.255) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 63.4079
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1872 mb_mean=0.5043 norm_overlap=0.9909 corr_cb=-0.3510 topkJ=0.0050
[TRAIN][ep=025] loss=0.8765 acc=73.56%
[TRAIN][ep=025] mask_avg: mc_mean=0.2582 mb_mean=0.5029 norm_overlap=0.9948 corr_cb=-0.2622
[EPOCH 025/089] train: loss=0.8765 acc=73.56% | val: loss=0.7136 acc=61.45% f1=72.41% auc=62.91% val_score=54.4113 val_score_bestthr=67.4771 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.258, mb=0.503, no=0.995, corr=-0.262) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.4771
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2366 mb_mean=0.5065 norm_overlap=0.9934 corr_cb=-0.3416 topkJ=0.0045
[TRAIN][ep=026] loss=0.8637 acc=73.29%
[TRAIN][ep=026] mask_avg: mc_mean=0.2506 mb_mean=0.5029 norm_overlap=0.9947 corr_cb=-0.2574
[EPOCH 026/089] train: loss=0.8637 acc=73.29% | val: loss=0.7237 acc=61.45% f1=72.41% auc=62.21% val_score=53.5181 val_score_bestthr=67.4771 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.251, mb=0.503, no=0.995, corr=-0.257) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.4771
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2322 mb_mean=0.4994 norm_overlap=0.9927 corr_cb=-0.3005 topkJ=0.0217
[TRAIN][ep=027] loss=0.8581 acc=75.30%
[TRAIN][ep=027] mask_avg: mc_mean=0.2396 mb_mean=0.5029 norm_overlap=0.9949 corr_cb=-0.2443
[EPOCH 027/089] train: loss=0.8581 acc=75.30% | val: loss=0.7254 acc=61.45% f1=72.41% auc=62.44% val_score=53.4051 val_score_bestthr=67.4771 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.240, mb=0.503, no=0.995, corr=-0.244) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.4771
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2460 mb_mean=0.5002 norm_overlap=0.9951 corr_cb=-0.2085 topkJ=0.0507
[TRAIN][ep=028] loss=0.8730 acc=73.42%
[TRAIN][ep=028] mask_avg: mc_mean=0.2647 mb_mean=0.5029 norm_overlap=0.9943 corr_cb=-0.2815
[EPOCH 028/089] train: loss=0.8730 acc=73.42% | val: loss=0.7449 acc=63.86% f1=70.00% auc=62.67% val_score=40.1437 val_score_bestthr=65.6291 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.265, mb=0.503, no=0.994, corr=-0.282) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 65.6291
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2780 mb_mean=0.5037 norm_overlap=0.9916 corr_cb=-0.3789 topkJ=0.0077
[TRAIN][ep=029] loss=0.8654 acc=74.09%
[TRAIN][ep=029] mask_avg: mc_mean=0.2749 mb_mean=0.5029 norm_overlap=0.9942 corr_cb=-0.2967
[EPOCH 029/089] train: loss=0.8654 acc=74.09% | val: loss=0.7269 acc=63.86% f1=70.00% auc=62.67% val_score=53.4051 val_score_bestthr=65.6291 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.275, mb=0.503, no=0.994, corr=-0.297) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 65.6291
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2635 mb_mean=0.4993 norm_overlap=0.9976 corr_cb=-0.1258 topkJ=0.0202
[TRAIN][ep=030] loss=0.8633 acc=73.29%
[TRAIN][ep=030] mask_avg: mc_mean=0.2838 mb_mean=0.5029 norm_overlap=0.9938 corr_cb=-0.3136
[EPOCH 030/089] train: loss=0.8633 acc=73.29% | val: loss=0.7876 acc=66.27% f1=73.58% auc=62.15% val_score=63.9939 val_score_bestthr=66.8805 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.284, mb=0.503, no=0.994, corr=-0.314) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 66.8805
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.3133 mb_mean=0.4945 norm_overlap=0.9928 corr_cb=-0.4189 topkJ=0.0164
[TRAIN][ep=031] loss=0.8630 acc=72.21%
[TRAIN][ep=031] mask_avg: mc_mean=0.2793 mb_mean=0.5029 norm_overlap=0.9941 corr_cb=-0.2982
[EPOCH 031/089] train: loss=0.8630 acc=72.21% | val: loss=0.7532 acc=65.06% f1=70.71% auc=62.73% val_score=41.3782 val_score_bestthr=66.7428 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.279, mb=0.503, no=0.994, corr=-0.298) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 66.7428
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1767 mb_mean=0.5035 norm_overlap=0.9964 corr_cb=-0.1833 topkJ=0.0245
[TRAIN][ep=032] loss=0.8453 acc=73.42%
[TRAIN][ep=032] mask_avg: mc_mean=0.2710 mb_mean=0.5029 norm_overlap=0.9944 corr_cb=-0.2805
[EPOCH 032/089] train: loss=0.8453 acc=73.42% | val: loss=0.7350 acc=65.06% f1=71.29% auc=62.91% val_score=60.9059 val_score_bestthr=68.1515 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.271, mb=0.503, no=0.994, corr=-0.280) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 68.1515
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2465 mb_mean=0.5076 norm_overlap=0.9917 corr_cb=-0.3554 topkJ=0.0012
[TRAIN][ep=033] loss=0.8324 acc=73.96%
[TRAIN][ep=033] mask_avg: mc_mean=0.2794 mb_mean=0.5029 norm_overlap=0.9942 corr_cb=-0.2964
[EPOCH 033/089] train: loss=0.8324 acc=73.96% | val: loss=0.7301 acc=66.27% f1=70.83% auc=63.26% val_score=41.2506 val_score_bestthr=67.2661 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.279, mb=0.503, no=0.994, corr=-0.296) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.2661
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1321 mb_mean=0.5064 norm_overlap=0.9955 corr_cb=-0.1459 topkJ=0.0103
[TRAIN][ep=034] loss=0.8225 acc=75.30%
[TRAIN][ep=034] mask_avg: mc_mean=0.2421 mb_mean=0.5029 norm_overlap=0.9944 corr_cb=-0.2525
[EPOCH 034/089] train: loss=0.8225 acc=75.30% | val: loss=0.7240 acc=65.06% f1=71.29% auc=63.78% val_score=53.8664 val_score_bestthr=68.1515 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.242, mb=0.503, no=0.994, corr=-0.252) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 68.1515
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2104 mb_mean=0.4981 norm_overlap=0.9973 corr_cb=-0.1134 topkJ=0.0161
[TRAIN][ep=035] loss=0.8176 acc=74.77%
[TRAIN][ep=035] mask_avg: mc_mean=0.2639 mb_mean=0.5029 norm_overlap=0.9938 corr_cb=-0.2867
[EPOCH 035/089] train: loss=0.8176 acc=74.77% | val: loss=0.7550 acc=65.06% f1=70.71% auc=62.79% val_score=49.5398 val_score_bestthr=66.7428 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.264, mb=0.503, no=0.994, corr=-0.287) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 66.7428
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2944 mb_mean=0.4988 norm_overlap=0.9953 corr_cb=-0.2366 topkJ=0.0378
[TRAIN][ep=036] loss=0.8013 acc=76.51%
[TRAIN][ep=036] mask_avg: mc_mean=0.2646 mb_mean=0.5029 norm_overlap=0.9938 corr_cb=-0.2894
[EPOCH 036/089] train: loss=0.8013 acc=76.51% | val: loss=0.7556 acc=65.06% f1=71.29% auc=62.79% val_score=52.7263 val_score_bestthr=68.8982 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.265, mb=0.503, no=0.994, corr=-0.289) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 68.8982
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.2957 mb_mean=0.4998 norm_overlap=0.9945 corr_cb=-0.2794 topkJ=0.0141
[TRAIN][ep=037] loss=0.8022 acc=75.70%
[TRAIN][ep=037] mask_avg: mc_mean=0.2556 mb_mean=0.5029 norm_overlap=0.9936 corr_cb=-0.2883
[EPOCH 037/089] train: loss=0.8022 acc=75.70% | val: loss=0.7503 acc=62.65% f1=73.04% auc=62.03% val_score=53.4478 val_score_bestthr=67.4592 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.256, mb=0.503, no=0.994, corr=-0.288) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.4592
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2830 mb_mean=0.5025 norm_overlap=0.9890 corr_cb=-0.3785 topkJ=0.0008
[TRAIN][ep=038] loss=0.8143 acc=75.70%
[TRAIN][ep=038] mask_avg: mc_mean=0.3111 mb_mean=0.5029 norm_overlap=0.9929 corr_cb=-0.3625
[EPOCH 038/089] train: loss=0.8143 acc=75.70% | val: loss=0.7823 acc=66.27% f1=70.83% auc=61.69% val_score=60.4990 val_score_bestthr=63.5328 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.311, mb=0.503, no=0.993, corr=-0.362) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 63.5328
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2518 mb_mean=0.5026 norm_overlap=0.9948 corr_cb=-0.2438 topkJ=0.0202
[TRAIN][ep=039] loss=0.7903 acc=76.91%
[TRAIN][ep=039] mask_avg: mc_mean=0.2537 mb_mean=0.5029 norm_overlap=0.9938 corr_cb=-0.2838
[EPOCH 039/089] train: loss=0.7903 acc=76.91% | val: loss=0.7563 acc=65.06% f1=71.29% auc=61.69% val_score=51.3624 val_score_bestthr=68.1515 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.254, mb=0.503, no=0.994, corr=-0.284) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 68.1515
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.2210 mb_mean=0.4982 norm_overlap=0.9955 corr_cb=-0.2300 topkJ=0.0195
[TRAIN][ep=040] loss=0.7977 acc=75.30%
[TRAIN][ep=040] mask_avg: mc_mean=0.2765 mb_mean=0.5029 norm_overlap=0.9933 corr_cb=-0.3188
[EPOCH 040/089] train: loss=0.7977 acc=75.30% | val: loss=0.7502 acc=65.06% f1=71.29% auc=62.44% val_score=55.0225 val_score_bestthr=68.1515 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.276, mb=0.503, no=0.993, corr=-0.319) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 68.1515
[EARLY STOP] no improvement for 30 epochs. best_epoch=10
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
=============== FIT DONE ===============
[BEST] epoch=10 | val_acc=61.45% | val_f1=72.88% | val_auc=57.97% | val_score=57.5501 | val_score_bestthr=71.2933
[TEST@BEST] thr_used=0.395 | acc=59.90% f1=71.48% auc=70.43% | SP_sex=9.65% EO_sex=2.47% SP_age=10.69% EO_age=8.00%
[TIME] 1.07 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/summary_fold_3.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5042 mb_mean=0.5040 norm_overlap=1.0001 corr_cb=0.1951 topkJ=0.1574
[TRAIN][ep=000] loss=0.6944 acc=49.53%
[TRAIN][ep=000] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0819
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5061 mb_mean=0.5005 norm_overlap=1.0000 corr_cb=0.1183 topkJ=0.0577
[TRAIN][ep=001] loss=0.6937 acc=51.14%
[TRAIN][ep=001] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0801
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5044 mb_mean=0.5040 norm_overlap=1.0000 corr_cb=0.0722 topkJ=0.0959
[TRAIN][ep=002] loss=0.6913 acc=54.63%
[TRAIN][ep=002] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0784
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5035 mb_mean=0.4968 norm_overlap=1.0002 corr_cb=0.3148 topkJ=0.1021
[TRAIN][ep=003] loss=0.6896 acc=51.95%
[TRAIN][ep=003] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0800
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5044 mb_mean=0.5048 norm_overlap=1.0001 corr_cb=0.2160 topkJ=0.0656
[TRAIN][ep=004] loss=0.6894 acc=54.23%
[TRAIN][ep=004] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0800
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5067 mb_mean=0.5067 norm_overlap=1.0001 corr_cb=0.1932 topkJ=0.0734
[TRAIN][ep=005] loss=0.6867 acc=53.69%
[TRAIN][ep=005] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0823
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5065 mb_mean=0.5067 norm_overlap=1.0000 corr_cb=-0.0363 topkJ=0.1013
[TRAIN][ep=006] loss=0.6844 acc=55.97%
[TRAIN][ep=006] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0796
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5062 mb_mean=0.5019 norm_overlap=1.0001 corr_cb=0.3117 topkJ=0.2049
[TRAIN][ep=007] loss=0.6865 acc=55.44%
[TRAIN][ep=007] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0800
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5025 mb_mean=0.5033 norm_overlap=1.0000 corr_cb=-0.0452 topkJ=0.0691
[TRAIN][ep=008] loss=0.6797 acc=60.00%
[TRAIN][ep=008] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0804
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5034 mb_mean=0.5057 norm_overlap=1.0001 corr_cb=0.1863 topkJ=0.0624
[TRAIN][ep=009] loss=0.6760 acc=59.19%
[TRAIN][ep=009] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0876
================= FIT START (fold=3) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5055 mb_mean=0.5024 norm_overlap=0.9999 corr_cb=-0.0929 topkJ=0.0409
[TRAIN][ep=000] loss=0.6714 acc=61.34%
[TRAIN][ep=000] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0802
[EPOCH 000/089] train: loss=0.6714 acc=61.34% | val: loss=0.6915 acc=57.83% f1=70.59% auc=51.86% val_score=42.8972 val_score_bestthr=61.2371 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.080) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 61.2371
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5046 mb_mean=0.4991 norm_overlap=1.0000 corr_cb=0.0132 topkJ=0.0779
[TRAIN][ep=001] loss=0.6660 acc=61.88%
[TRAIN][ep=001] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0802
[EPOCH 001/089] train: loss=0.6660 acc=61.88% | val: loss=0.7107 acc=55.42% f1=68.38% auc=48.84% val_score=36.9276 val_score_bestthr=57.1990 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.080) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.2371 -> 57.1990
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5047 mb_mean=0.5037 norm_overlap=1.0002 corr_cb=0.2934 topkJ=0.0559
[TRAIN][ep=002] loss=0.6642 acc=60.54%
[TRAIN][ep=002] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0808
[EPOCH 002/089] train: loss=0.6642 acc=60.54% | val: loss=0.6896 acc=60.24% f1=72.27% auc=54.42% val_score=43.6583 val_score_bestthr=67.7099 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.081) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 61.2371 -> 67.7099
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5066 mb_mean=0.5041 norm_overlap=1.0001 corr_cb=0.1759 topkJ=0.1404
[TRAIN][ep=003] loss=0.6611 acc=60.54%
[TRAIN][ep=003] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0798
[EPOCH 003/089] train: loss=0.6611 acc=60.54% | val: loss=0.6974 acc=57.83% f1=67.89% auc=52.21% val_score=32.5867 val_score_bestthr=63.2593 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.080) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.7099 -> 63.2593
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5061 mb_mean=0.5050 norm_overlap=1.0000 corr_cb=0.0586 topkJ=0.0847
[TRAIN][ep=004] loss=0.6532 acc=62.15%
[TRAIN][ep=004] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0832
[EPOCH 004/089] train: loss=0.6532 acc=62.15% | val: loss=0.6920 acc=61.45% f1=71.93% auc=57.21% val_score=60.7211 val_score_bestthr=64.5440 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.083) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.7099 -> 64.5440
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5043 mb_mean=0.5027 norm_overlap=1.0001 corr_cb=0.2297 topkJ=0.0605
[TRAIN][ep=005] loss=1.2510 acc=62.42%
[TRAIN][ep=005] mask_avg: mc_mean=0.3696 mb_mean=0.5029 norm_overlap=1.0022 corr_cb=0.5971
[EPOCH 005/089] train: loss=1.2510 acc=62.42% | val: loss=0.6860 acc=60.24% f1=71.79% auc=57.73% val_score=51.1633 val_score_bestthr=67.4967 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.370, mb=0.503, no=1.002, corr=0.597) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.7099 -> 67.4967
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2907 mb_mean=0.5054 norm_overlap=1.0017 corr_cb=0.4243 topkJ=0.1822
[TRAIN][ep=006] loss=1.2455 acc=63.89%
[TRAIN][ep=006] mask_avg: mc_mean=0.2713 mb_mean=0.5029 norm_overlap=1.0041 corr_cb=0.5798
[EPOCH 006/089] train: loss=1.2455 acc=63.89% | val: loss=0.6952 acc=57.83% f1=70.09% auc=55.35% val_score=35.3805 val_score_bestthr=62.8622 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.271, mb=0.503, no=1.004, corr=0.580) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.7099 -> 62.8622
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2505 mb_mean=0.5008 norm_overlap=1.0032 corr_cb=0.5188 topkJ=0.2257
[TRAIN][ep=007] loss=1.2444 acc=62.68%
[TRAIN][ep=007] mask_avg: mc_mean=0.2579 mb_mean=0.5029 norm_overlap=1.0040 corr_cb=0.5090
[EPOCH 007/089] train: loss=1.2444 acc=62.68% | val: loss=0.6943 acc=59.04% f1=71.67% auc=59.01% val_score=55.9462 val_score_bestthr=67.9254 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.258, mb=0.503, no=1.004, corr=0.509) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 67.7099 -> 67.9254
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2381 mb_mean=0.4971 norm_overlap=1.0063 corr_cb=0.6478 topkJ=0.1953
[TRAIN][ep=008] loss=1.2459 acc=62.15%
[TRAIN][ep=008] mask_avg: mc_mean=0.2621 mb_mean=0.5029 norm_overlap=1.0034 corr_cb=0.4345
[EPOCH 008/089] train: loss=1.2459 acc=62.15% | val: loss=0.6877 acc=62.65% f1=69.31% auc=57.97% val_score=59.5420 val_score_bestthr=61.5383 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.262, mb=0.503, no=1.003, corr=0.435) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 61.5383
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2214 mb_mean=0.4964 norm_overlap=1.0031 corr_cb=0.4647 topkJ=0.1996
[TRAIN][ep=009] loss=1.2298 acc=65.64%
[TRAIN][ep=009] mask_avg: mc_mean=0.2451 mb_mean=0.5029 norm_overlap=1.0034 corr_cb=0.3737
[EPOCH 009/089] train: loss=1.2298 acc=65.64% | val: loss=0.6923 acc=59.04% f1=71.67% auc=56.57% val_score=45.1171 val_score_bestthr=67.9254 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.245, mb=0.503, no=1.003, corr=0.374) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 67.9254
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.2474 mb_mean=0.5031 norm_overlap=1.0029 corr_cb=0.2926 topkJ=0.1302
[TRAIN][ep=010] loss=1.2230 acc=65.91%
[TRAIN][ep=010] mask_avg: mc_mean=0.2383 mb_mean=0.5029 norm_overlap=1.0028 corr_cb=0.2766
[EPOCH 010/089] train: loss=1.2230 acc=65.91% | val: loss=0.6939 acc=61.45% f1=72.88% auc=57.67% val_score=54.8361 val_score_bestthr=71.2933 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.238, mb=0.503, no=1.003, corr=0.277) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 67.9254 -> 71.2933
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.2582 mb_mean=0.5027 norm_overlap=1.0013 corr_cb=0.1378 topkJ=0.0554
[TRAIN][ep=011] loss=1.2121 acc=65.64%
[TRAIN][ep=011] mask_avg: mc_mean=0.2293 mb_mean=0.5029 norm_overlap=1.0021 corr_cb=0.1707
[EPOCH 011/089] train: loss=1.2121 acc=65.64% | val: loss=0.7255 acc=59.04% f1=71.67% auc=55.47% val_score=31.3595 val_score_bestthr=66.4943 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.229, mb=0.503, no=1.002, corr=0.171) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 66.4943
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.2418 mb_mean=0.5058 norm_overlap=1.0013 corr_cb=0.1163 topkJ=0.0606
[TRAIN][ep=012] loss=1.2121 acc=66.85%
[TRAIN][ep=012] mask_avg: mc_mean=0.2243 mb_mean=0.5029 norm_overlap=1.0015 corr_cb=0.1098
[EPOCH 012/089] train: loss=1.2121 acc=66.85% | val: loss=0.7120 acc=60.24% f1=72.27% auc=59.13% val_score=55.0451 val_score_bestthr=67.9849 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.224, mb=0.503, no=1.002, corr=0.110) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.9849
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.2500 mb_mean=0.5051 norm_overlap=0.9995 corr_cb=-0.0420 topkJ=0.0530
[TRAIN][ep=013] loss=1.2082 acc=66.71%
[TRAIN][ep=013] mask_avg: mc_mean=0.2452 mb_mean=0.5029 norm_overlap=1.0002 corr_cb=0.0121
[EPOCH 013/089] train: loss=1.2082 acc=66.71% | val: loss=0.7092 acc=61.45% f1=69.81% auc=57.03% val_score=42.6525 val_score_bestthr=64.2778 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.245, mb=0.503, no=1.000, corr=0.012) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 64.2778
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.2236 mb_mean=0.5041 norm_overlap=0.9971 corr_cb=-0.2323 topkJ=0.0160
[TRAIN][ep=014] loss=1.1926 acc=67.79%
[TRAIN][ep=014] mask_avg: mc_mean=0.2179 mb_mean=0.5029 norm_overlap=1.0003 corr_cb=0.0145
[EPOCH 014/089] train: loss=1.1926 acc=67.79% | val: loss=0.7056 acc=59.04% f1=71.67% auc=58.66% val_score=46.2282 val_score_bestthr=67.9254 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.218, mb=0.503, no=1.000, corr=0.014) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.9254
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1696 mb_mean=0.5008 norm_overlap=1.0028 corr_cb=0.1441 topkJ=0.0367
[TRAIN][ep=015] loss=1.1857 acc=69.40%
[TRAIN][ep=015] mask_avg: mc_mean=0.2193 mb_mean=0.5029 norm_overlap=0.9993 corr_cb=-0.0500
[EPOCH 015/089] train: loss=1.1857 acc=69.40% | val: loss=0.7049 acc=61.45% f1=72.41% auc=59.65% val_score=56.2000 val_score_bestthr=65.1127 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.219, mb=0.503, no=0.999, corr=-0.050) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 65.1127
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.2600 mb_mean=0.5040 norm_overlap=0.9948 corr_cb=-0.2950 topkJ=0.0122
[TRAIN][ep=016] loss=0.9760 acc=68.99%
[TRAIN][ep=016] mask_avg: mc_mean=0.2291 mb_mean=0.5029 norm_overlap=0.9985 corr_cb=-0.0982
[EPOCH 016/089] train: loss=0.9760 acc=68.99% | val: loss=0.7374 acc=61.45% f1=72.41% auc=60.35% val_score=55.0451 val_score_bestthr=67.4771 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.229, mb=0.503, no=0.998, corr=-0.098) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.4771
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.2273 mb_mean=0.5001 norm_overlap=0.9973 corr_cb=-0.1259 topkJ=0.0136
[TRAIN][ep=017] loss=0.7781 acc=69.66%
[TRAIN][ep=017] mask_avg: mc_mean=0.2378 mb_mean=0.5029 norm_overlap=0.9976 corr_cb=-0.1471
[EPOCH 017/089] train: loss=0.7781 acc=69.66% | val: loss=0.7285 acc=60.24% f1=72.27% auc=59.88% val_score=55.4025 val_score_bestthr=69.8204 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.238, mb=0.503, no=0.998, corr=-0.147) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 69.8204
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.2527 mb_mean=0.5046 norm_overlap=0.9952 corr_cb=-0.2055 topkJ=0.0051
[TRAIN][ep=018] loss=0.7307 acc=72.08%
[TRAIN][ep=018] mask_avg: mc_mean=0.2267 mb_mean=0.5029 norm_overlap=0.9972 corr_cb=-0.1545
[EPOCH 018/089] train: loss=0.7307 acc=72.08% | val: loss=0.7224 acc=60.24% f1=72.27% auc=60.29% val_score=53.8018 val_score_bestthr=69.8204 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.227, mb=0.503, no=0.997, corr=-0.154) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 69.8204
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.2210 mb_mean=0.5051 norm_overlap=0.9935 corr_cb=-0.3415 topkJ=0.0107
[TRAIN][ep=019] loss=0.7249 acc=69.13%
[TRAIN][ep=019] mask_avg: mc_mean=0.2439 mb_mean=0.5029 norm_overlap=0.9964 corr_cb=-0.2063
[EPOCH 019/089] train: loss=0.7249 acc=69.13% | val: loss=0.7324 acc=62.65% f1=69.31% auc=59.01% val_score=48.8609 val_score_bestthr=65.2642 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.244, mb=0.503, no=0.996, corr=-0.206) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 65.2642
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.2816 mb_mean=0.5115 norm_overlap=0.9918 corr_cb=-0.4408 topkJ=0.0024
[TRAIN][ep=020] loss=0.7076 acc=71.14%
[TRAIN][ep=020] mask_avg: mc_mean=0.2348 mb_mean=0.5029 norm_overlap=0.9962 corr_cb=-0.2032
[EPOCH 020/089] train: loss=0.7076 acc=71.14% | val: loss=0.7347 acc=61.45% f1=68.63% auc=59.53% val_score=36.5251 val_score_bestthr=64.1546 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.235, mb=0.503, no=0.996, corr=-0.203) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 64.1546
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2323 mb_mean=0.5054 norm_overlap=0.9975 corr_cb=-0.1561 topkJ=0.0288
[TRAIN][ep=021] loss=0.7012 acc=72.48%
[TRAIN][ep=021] mask_avg: mc_mean=0.2400 mb_mean=0.5029 norm_overlap=0.9957 corr_cb=-0.2250
[EPOCH 021/089] train: loss=0.7012 acc=72.48% | val: loss=0.7234 acc=61.45% f1=72.41% auc=61.63% val_score=56.0663 val_score_bestthr=67.4771 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.240, mb=0.503, no=0.996, corr=-0.225) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.4771
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2492 mb_mean=0.5063 norm_overlap=0.9966 corr_cb=-0.2004 topkJ=0.0231
[TRAIN][ep=022] loss=0.7000 acc=73.29%
[TRAIN][ep=022] mask_avg: mc_mean=0.2592 mb_mean=0.5029 norm_overlap=0.9952 corr_cb=-0.2512
[EPOCH 022/089] train: loss=0.7000 acc=73.29% | val: loss=0.7386 acc=61.45% f1=72.41% auc=61.51% val_score=61.2170 val_score_bestthr=67.4771 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.259, mb=0.503, no=0.995, corr=-0.251) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.4771
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2425 mb_mean=0.4990 norm_overlap=0.9978 corr_cb=-0.1239 topkJ=0.0309
[TRAIN][ep=023] loss=0.7004 acc=71.54%
[TRAIN][ep=023] mask_avg: mc_mean=0.2570 mb_mean=0.5029 norm_overlap=0.9950 corr_cb=-0.2562
[EPOCH 023/089] train: loss=0.7004 acc=71.54% | val: loss=0.7300 acc=60.24% f1=71.79% auc=60.41% val_score=53.8018 val_score_bestthr=65.1322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.257, mb=0.503, no=0.995, corr=-0.256) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 65.1322
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2579 mb_mean=0.4986 norm_overlap=0.9953 corr_cb=-0.2602 topkJ=0.0158
[TRAIN][ep=024] loss=0.6978 acc=71.95%
[TRAIN][ep=024] mask_avg: mc_mean=0.2583 mb_mean=0.5029 norm_overlap=0.9949 corr_cb=-0.2593
[EPOCH 024/089] train: loss=0.6978 acc=71.95% | val: loss=0.7418 acc=62.65% f1=69.31% auc=61.05% val_score=34.2967 val_score_bestthr=64.5175 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.258, mb=0.503, no=0.995, corr=-0.259) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 64.5175
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1867 mb_mean=0.5043 norm_overlap=0.9908 corr_cb=-0.3517 topkJ=0.0047
[TRAIN][ep=025] loss=0.6833 acc=73.42%
[TRAIN][ep=025] mask_avg: mc_mean=0.2578 mb_mean=0.5029 norm_overlap=0.9947 corr_cb=-0.2666
[EPOCH 025/089] train: loss=0.6833 acc=73.42% | val: loss=0.7130 acc=61.45% f1=72.41% auc=63.14% val_score=54.4113 val_score_bestthr=67.4771 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.258, mb=0.503, no=0.995, corr=-0.267) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.4771
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2356 mb_mean=0.5065 norm_overlap=0.9932 corr_cb=-0.3483 topkJ=0.0049
[TRAIN][ep=026] loss=0.6720 acc=73.15%
[TRAIN][ep=026] mask_avg: mc_mean=0.2497 mb_mean=0.5029 norm_overlap=0.9946 corr_cb=-0.2601
[EPOCH 026/089] train: loss=0.6720 acc=73.15% | val: loss=0.7244 acc=61.45% f1=72.41% auc=62.27% val_score=53.5181 val_score_bestthr=67.4771 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.250, mb=0.503, no=0.995, corr=-0.260) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.4771
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2326 mb_mean=0.4994 norm_overlap=0.9924 corr_cb=-0.3080 topkJ=0.0205
[TRAIN][ep=027] loss=0.6667 acc=75.30%
[TRAIN][ep=027] mask_avg: mc_mean=0.2396 mb_mean=0.5029 norm_overlap=0.9947 corr_cb=-0.2487
[EPOCH 027/089] train: loss=0.6667 acc=75.30% | val: loss=0.7253 acc=61.45% f1=72.41% auc=62.67% val_score=53.4051 val_score_bestthr=67.4771 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.240, mb=0.503, no=0.995, corr=-0.249) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.4771
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2481 mb_mean=0.5002 norm_overlap=0.9949 corr_cb=-0.2175 topkJ=0.0498
[TRAIN][ep=028] loss=0.6833 acc=73.29%
[TRAIN][ep=028] mask_avg: mc_mean=0.2632 mb_mean=0.5029 norm_overlap=0.9942 corr_cb=-0.2840
[EPOCH 028/089] train: loss=0.6833 acc=73.29% | val: loss=0.7433 acc=63.86% f1=70.00% auc=62.79% val_score=40.1437 val_score_bestthr=65.6291 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.263, mb=0.503, no=0.994, corr=-0.284) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 65.6291
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2777 mb_mean=0.5037 norm_overlap=0.9915 corr_cb=-0.3811 topkJ=0.0073
[TRAIN][ep=029] loss=0.6770 acc=74.23%
[TRAIN][ep=029] mask_avg: mc_mean=0.2755 mb_mean=0.5029 norm_overlap=0.9941 corr_cb=-0.3022
[EPOCH 029/089] train: loss=0.6770 acc=74.23% | val: loss=0.7270 acc=65.06% f1=71.29% auc=62.73% val_score=53.4051 val_score_bestthr=68.1515 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.276, mb=0.503, no=0.994, corr=-0.302) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 68.1515
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2623 mb_mean=0.4993 norm_overlap=0.9975 corr_cb=-0.1290 topkJ=0.0214
[TRAIN][ep=030] loss=0.6766 acc=73.42%
[TRAIN][ep=030] mask_avg: mc_mean=0.2824 mb_mean=0.5029 norm_overlap=0.9937 corr_cb=-0.3160
[EPOCH 030/089] train: loss=0.6766 acc=73.42% | val: loss=0.7842 acc=66.27% f1=73.58% auc=62.27% val_score=63.9939 val_score_bestthr=66.8805 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.282, mb=0.503, no=0.994, corr=-0.316) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 66.8805
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.3121 mb_mean=0.4945 norm_overlap=0.9927 corr_cb=-0.4223 topkJ=0.0168
[TRAIN][ep=031] loss=0.6773 acc=71.68%
[TRAIN][ep=031] mask_avg: mc_mean=0.2796 mb_mean=0.5029 norm_overlap=0.9940 corr_cb=-0.3030
[EPOCH 031/089] train: loss=0.6773 acc=71.68% | val: loss=0.7536 acc=63.86% f1=70.00% auc=62.73% val_score=41.3782 val_score_bestthr=65.6291 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.280, mb=0.503, no=0.994, corr=-0.303) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 65.6291
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1797 mb_mean=0.5035 norm_overlap=0.9962 corr_cb=-0.1934 topkJ=0.0233
[TRAIN][ep=032] loss=0.6626 acc=73.29%
[TRAIN][ep=032] mask_avg: mc_mean=0.2701 mb_mean=0.5029 norm_overlap=0.9943 corr_cb=-0.2835
[EPOCH 032/089] train: loss=0.6626 acc=73.29% | val: loss=0.7371 acc=65.06% f1=71.29% auc=63.14% val_score=62.8937 val_score_bestthr=68.1515 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.270, mb=0.503, no=0.994, corr=-0.284) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 68.1515
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2420 mb_mean=0.5076 norm_overlap=0.9917 corr_cb=-0.3525 topkJ=0.0012
[TRAIN][ep=033] loss=0.6514 acc=73.83%
[TRAIN][ep=033] mask_avg: mc_mean=0.2772 mb_mean=0.5029 norm_overlap=0.9941 corr_cb=-0.2976
[EPOCH 033/089] train: loss=0.6514 acc=73.83% | val: loss=0.7294 acc=67.47% f1=72.16% auc=63.37% val_score=50.8055 val_score_bestthr=67.8568 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.277, mb=0.503, no=0.994, corr=-0.298) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.8568
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1305 mb_mean=0.5064 norm_overlap=0.9954 corr_cb=-0.1484 topkJ=0.0099
[TRAIN][ep=034] loss=0.6412 acc=75.44%
[TRAIN][ep=034] mask_avg: mc_mean=0.2410 mb_mean=0.5029 norm_overlap=0.9943 corr_cb=-0.2550
[EPOCH 034/089] train: loss=0.6412 acc=75.44% | val: loss=0.7234 acc=66.27% f1=72.00% auc=63.84% val_score=53.8664 val_score_bestthr=69.2661 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.241, mb=0.503, no=0.994, corr=-0.255) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 69.2661
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2119 mb_mean=0.4981 norm_overlap=0.9971 corr_cb=-0.1212 topkJ=0.0165
[TRAIN][ep=035] loss=0.6388 acc=74.90%
[TRAIN][ep=035] mask_avg: mc_mean=0.2629 mb_mean=0.5029 norm_overlap=0.9938 corr_cb=-0.2888
[EPOCH 035/089] train: loss=0.6388 acc=74.90% | val: loss=0.7561 acc=65.06% f1=70.71% auc=62.73% val_score=49.5398 val_score_bestthr=66.7428 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.263, mb=0.503, no=0.994, corr=-0.289) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 66.7428
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2929 mb_mean=0.4988 norm_overlap=0.9952 corr_cb=-0.2367 topkJ=0.0382
[TRAIN][ep=036] loss=0.6238 acc=76.51%
[TRAIN][ep=036] mask_avg: mc_mean=0.2630 mb_mean=0.5029 norm_overlap=0.9937 corr_cb=-0.2907
[EPOCH 036/089] train: loss=0.6238 acc=76.51% | val: loss=0.7575 acc=66.27% f1=72.00% auc=62.79% val_score=53.8664 val_score_bestthr=69.2661 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.263, mb=0.503, no=0.994, corr=-0.291) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 69.2661
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.2964 mb_mean=0.4998 norm_overlap=0.9943 corr_cb=-0.2856 topkJ=0.0137
[TRAIN][ep=037] loss=0.6254 acc=76.51%
[TRAIN][ep=037] mask_avg: mc_mean=0.2553 mb_mean=0.5029 norm_overlap=0.9936 corr_cb=-0.2905
[EPOCH 037/089] train: loss=0.6254 acc=76.51% | val: loss=0.7504 acc=62.65% f1=73.04% auc=62.79% val_score=53.4478 val_score_bestthr=67.4592 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.255, mb=0.503, no=0.994, corr=-0.290) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.4592
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2823 mb_mean=0.5025 norm_overlap=0.9888 corr_cb=-0.3816 topkJ=0.0008
[TRAIN][ep=038] loss=0.6328 acc=75.97%
[TRAIN][ep=038] mask_avg: mc_mean=0.3083 mb_mean=0.5029 norm_overlap=0.9928 corr_cb=-0.3621
[EPOCH 038/089] train: loss=0.6328 acc=75.97% | val: loss=0.7843 acc=63.86% f1=70.00% auc=61.63% val_score=62.4156 val_score_bestthr=64.8202 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.308, mb=0.503, no=0.993, corr=-0.362) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 64.8202
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2493 mb_mean=0.5026 norm_overlap=0.9947 corr_cb=-0.2445 topkJ=0.0198
[TRAIN][ep=039] loss=0.6149 acc=76.51%
[TRAIN][ep=039] mask_avg: mc_mean=0.2538 mb_mean=0.5029 norm_overlap=0.9937 corr_cb=-0.2870
[EPOCH 039/089] train: loss=0.6149 acc=76.51% | val: loss=0.7581 acc=65.06% f1=71.29% auc=61.86% val_score=55.0225 val_score_bestthr=68.1515 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.254, mb=0.503, no=0.994, corr=-0.287) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 68.1515
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.2174 mb_mean=0.4982 norm_overlap=0.9954 corr_cb=-0.2315 topkJ=0.0195
[TRAIN][ep=040] loss=0.6238 acc=75.17%
[TRAIN][ep=040] mask_avg: mc_mean=0.2759 mb_mean=0.5029 norm_overlap=0.9932 corr_cb=-0.3209
[EPOCH 040/089] train: loss=0.6238 acc=75.17% | val: loss=0.7539 acc=65.06% f1=71.29% auc=62.56% val_score=56.3832 val_score_bestthr=68.1515 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.276, mb=0.503, no=0.993, corr=-0.321) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 68.1515
[EARLY STOP] no improvement for 30 epochs. best_epoch=10
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
=============== FIT DONE ===============
[BEST] epoch=10 | val_acc=61.45% | val_f1=72.88% | val_auc=57.67% | val_score=54.8361 | val_score_bestthr=71.2933
[TEST@BEST] thr_used=0.400 | acc=59.90% f1=71.28% auc=70.36% | SP_sex=10.83% EO_sex=3.70% SP_age=10.98% EO_age=12.00%
[TIME] 1.16 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/summary_fold_3.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5042 mb_mean=0.5040 norm_overlap=1.0001 corr_cb=0.1951 topkJ=0.1574
[TRAIN][ep=000] loss=0.6944 acc=49.53%
[TRAIN][ep=000] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0819
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5061 mb_mean=0.5005 norm_overlap=1.0000 corr_cb=0.1183 topkJ=0.0577
[TRAIN][ep=001] loss=0.6937 acc=51.14%
[TRAIN][ep=001] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0801
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5044 mb_mean=0.5040 norm_overlap=1.0000 corr_cb=0.0722 topkJ=0.0959
[TRAIN][ep=002] loss=0.6913 acc=54.63%
[TRAIN][ep=002] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0784
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5035 mb_mean=0.4968 norm_overlap=1.0002 corr_cb=0.3148 topkJ=0.1021
[TRAIN][ep=003] loss=0.6896 acc=51.95%
[TRAIN][ep=003] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0800
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5044 mb_mean=0.5048 norm_overlap=1.0001 corr_cb=0.2160 topkJ=0.0656
[TRAIN][ep=004] loss=0.6894 acc=54.23%
[TRAIN][ep=004] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0800
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5067 mb_mean=0.5067 norm_overlap=1.0001 corr_cb=0.1932 topkJ=0.0734
[TRAIN][ep=005] loss=0.6867 acc=53.69%
[TRAIN][ep=005] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0823
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5065 mb_mean=0.5067 norm_overlap=1.0000 corr_cb=-0.0363 topkJ=0.1013
[TRAIN][ep=006] loss=0.6844 acc=55.97%
[TRAIN][ep=006] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0796
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5062 mb_mean=0.5019 norm_overlap=1.0001 corr_cb=0.3117 topkJ=0.2049
[TRAIN][ep=007] loss=0.6865 acc=55.44%
[TRAIN][ep=007] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0800
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5025 mb_mean=0.5033 norm_overlap=1.0000 corr_cb=-0.0452 topkJ=0.0691
[TRAIN][ep=008] loss=0.6797 acc=59.87%
[TRAIN][ep=008] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0804
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5034 mb_mean=0.5057 norm_overlap=1.0001 corr_cb=0.1863 topkJ=0.0624
[TRAIN][ep=009] loss=0.6760 acc=59.19%
[TRAIN][ep=009] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0876
================= FIT START (fold=3) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5055 mb_mean=0.5024 norm_overlap=0.9999 corr_cb=-0.0929 topkJ=0.0409
[TRAIN][ep=000] loss=0.6714 acc=61.34%
[TRAIN][ep=000] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0802
[EPOCH 000/089] train: loss=0.6714 acc=61.34% | val: loss=0.6915 acc=57.83% f1=70.59% auc=51.86% val_score=42.8972 val_score_bestthr=61.2371 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.080) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 61.2371
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5046 mb_mean=0.4991 norm_overlap=1.0000 corr_cb=0.0132 topkJ=0.0779
[TRAIN][ep=001] loss=0.6660 acc=61.88%
[TRAIN][ep=001] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0802
[EPOCH 001/089] train: loss=0.6660 acc=61.88% | val: loss=0.7107 acc=55.42% f1=68.38% auc=48.90% val_score=36.9276 val_score_bestthr=57.1990 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.080) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.2371 -> 57.1990
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5047 mb_mean=0.5037 norm_overlap=1.0002 corr_cb=0.2934 topkJ=0.0559
[TRAIN][ep=002] loss=0.6642 acc=60.54%
[TRAIN][ep=002] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0808
[EPOCH 002/089] train: loss=0.6642 acc=60.54% | val: loss=0.6896 acc=60.24% f1=72.27% auc=54.42% val_score=43.6583 val_score_bestthr=67.7099 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.081) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 61.2371 -> 67.7099
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5066 mb_mean=0.5041 norm_overlap=1.0001 corr_cb=0.1759 topkJ=0.1404
[TRAIN][ep=003] loss=0.6611 acc=60.54%
[TRAIN][ep=003] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0798
[EPOCH 003/089] train: loss=0.6611 acc=60.54% | val: loss=0.6973 acc=59.04% f1=69.09% auc=52.21% val_score=32.5867 val_score_bestthr=59.5114 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.080) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.7099 -> 59.5114
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5061 mb_mean=0.5050 norm_overlap=1.0000 corr_cb=0.0586 topkJ=0.0847
[TRAIN][ep=004] loss=0.6532 acc=62.15%
[TRAIN][ep=004] mask_avg: mc_mean=0.5051 mb_mean=0.5029 norm_overlap=1.0000 corr_cb=0.0832
[EPOCH 004/089] train: loss=0.6532 acc=62.15% | val: loss=0.6920 acc=61.45% f1=71.93% auc=57.21% val_score=60.7211 val_score_bestthr=64.5440 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.505, mb=0.503, no=1.000, corr=0.083) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.7099 -> 64.5440
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5043 mb_mean=0.5027 norm_overlap=1.0001 corr_cb=0.2297 topkJ=0.0605
[TRAIN][ep=005] loss=1.3661 acc=62.42%
[TRAIN][ep=005] mask_avg: mc_mean=0.3694 mb_mean=0.5029 norm_overlap=1.0022 corr_cb=0.5972
[EPOCH 005/089] train: loss=1.3661 acc=62.42% | val: loss=0.6863 acc=60.24% f1=71.79% auc=57.56% val_score=52.5376 val_score_bestthr=67.4967 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.369, mb=0.503, no=1.002, corr=0.597) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.7099 -> 67.4967
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2906 mb_mean=0.5054 norm_overlap=1.0017 corr_cb=0.4247 topkJ=0.1822
[TRAIN][ep=006] loss=1.3568 acc=64.03%
[TRAIN][ep=006] mask_avg: mc_mean=0.2713 mb_mean=0.5029 norm_overlap=1.0041 corr_cb=0.5800
[EPOCH 006/089] train: loss=1.3568 acc=64.03% | val: loss=0.6953 acc=57.83% f1=70.09% auc=55.29% val_score=35.3805 val_score_bestthr=62.8622 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.271, mb=0.503, no=1.004, corr=0.580) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.7099 -> 62.8622
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2506 mb_mean=0.5008 norm_overlap=1.0032 corr_cb=0.5187 topkJ=0.2263
[TRAIN][ep=007] loss=1.3554 acc=62.82%
[TRAIN][ep=007] mask_avg: mc_mean=0.2584 mb_mean=0.5029 norm_overlap=1.0040 corr_cb=0.5087
[EPOCH 007/089] train: loss=1.3554 acc=62.82% | val: loss=0.6945 acc=59.04% f1=71.67% auc=58.55% val_score=59.5466 val_score_bestthr=67.9254 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.258, mb=0.503, no=1.004, corr=0.509) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 67.7099 -> 67.9254
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2399 mb_mean=0.4971 norm_overlap=1.0062 corr_cb=0.6445 topkJ=0.1942
[TRAIN][ep=008] loss=1.3564 acc=62.15%
[TRAIN][ep=008] mask_avg: mc_mean=0.2619 mb_mean=0.5029 norm_overlap=1.0034 corr_cb=0.4324
[EPOCH 008/089] train: loss=1.3564 acc=62.15% | val: loss=0.6883 acc=62.65% f1=69.31% auc=57.79% val_score=50.2800 val_score_bestthr=61.5383 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.262, mb=0.503, no=1.003, corr=0.432) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 61.5383
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2207 mb_mean=0.4964 norm_overlap=1.0031 corr_cb=0.4637 topkJ=0.1979
[TRAIN][ep=009] loss=1.3401 acc=65.64%
[TRAIN][ep=009] mask_avg: mc_mean=0.2450 mb_mean=0.5029 norm_overlap=1.0034 corr_cb=0.3710
[EPOCH 009/089] train: loss=1.3401 acc=65.64% | val: loss=0.6931 acc=59.04% f1=71.67% auc=56.40% val_score=45.1171 val_score_bestthr=67.9254 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.245, mb=0.503, no=1.003, corr=0.371) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 67.9254
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.2483 mb_mean=0.5031 norm_overlap=1.0028 corr_cb=0.2877 topkJ=0.1297
[TRAIN][ep=010] loss=1.3335 acc=65.77%
[TRAIN][ep=010] mask_avg: mc_mean=0.2386 mb_mean=0.5029 norm_overlap=1.0028 corr_cb=0.2748
[EPOCH 010/089] train: loss=1.3335 acc=65.77% | val: loss=0.6947 acc=61.45% f1=72.88% auc=57.85% val_score=57.5501 val_score_bestthr=71.2933 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.239, mb=0.503, no=1.003, corr=0.275) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 67.9254 -> 71.2933
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.2579 mb_mean=0.5027 norm_overlap=1.0013 corr_cb=0.1379 topkJ=0.0554
[TRAIN][ep=011] loss=1.3226 acc=65.64%
[TRAIN][ep=011] mask_avg: mc_mean=0.2300 mb_mean=0.5029 norm_overlap=1.0021 corr_cb=0.1723
[EPOCH 011/089] train: loss=1.3226 acc=65.64% | val: loss=0.7262 acc=59.04% f1=71.67% auc=55.29% val_score=33.8440 val_score_bestthr=66.4943 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.230, mb=0.503, no=1.002, corr=0.172) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 66.4943
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.2440 mb_mean=0.5058 norm_overlap=1.0014 corr_cb=0.1183 topkJ=0.0584
[TRAIN][ep=012] loss=1.3225 acc=66.85%
[TRAIN][ep=012] mask_avg: mc_mean=0.2252 mb_mean=0.5029 norm_overlap=1.0016 corr_cb=0.1139
[EPOCH 012/089] train: loss=1.3225 acc=66.85% | val: loss=0.7132 acc=60.24% f1=72.27% auc=59.01% val_score=55.0451 val_score_bestthr=67.9849 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.225, mb=0.503, no=1.002, corr=0.114) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.9849
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.2499 mb_mean=0.5051 norm_overlap=0.9996 corr_cb=-0.0375 topkJ=0.0548
[TRAIN][ep=013] loss=1.3189 acc=66.85%
[TRAIN][ep=013] mask_avg: mc_mean=0.2453 mb_mean=0.5029 norm_overlap=1.0003 corr_cb=0.0196
[EPOCH 013/089] train: loss=1.3189 acc=66.85% | val: loss=0.7099 acc=60.24% f1=71.79% auc=56.80% val_score=42.6525 val_score_bestthr=67.4967 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.245, mb=0.503, no=1.000, corr=0.020) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.4967
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.2259 mb_mean=0.5041 norm_overlap=0.9972 corr_cb=-0.2304 topkJ=0.0164
[TRAIN][ep=014] loss=1.3029 acc=67.79%
[TRAIN][ep=014] mask_avg: mc_mean=0.2192 mb_mean=0.5029 norm_overlap=1.0004 corr_cb=0.0203
[EPOCH 014/089] train: loss=1.3029 acc=67.79% | val: loss=0.7063 acc=59.04% f1=71.67% auc=58.72% val_score=46.2282 val_score_bestthr=67.9254 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.219, mb=0.503, no=1.000, corr=0.020) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.9254
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1711 mb_mean=0.5008 norm_overlap=1.0029 corr_cb=0.1519 topkJ=0.0388
[TRAIN][ep=015] loss=1.2954 acc=69.53%
[TRAIN][ep=015] mask_avg: mc_mean=0.2205 mb_mean=0.5029 norm_overlap=0.9994 corr_cb=-0.0431
[EPOCH 015/089] train: loss=1.2954 acc=69.53% | val: loss=0.7057 acc=61.45% f1=72.41% auc=59.36% val_score=56.2000 val_score_bestthr=65.1127 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.220, mb=0.503, no=0.999, corr=-0.043) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 65.1127
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.2593 mb_mean=0.5040 norm_overlap=0.9950 corr_cb=-0.2847 topkJ=0.0122
[TRAIN][ep=016] loss=1.0923 acc=68.86%
[TRAIN][ep=016] mask_avg: mc_mean=0.2300 mb_mean=0.5029 norm_overlap=0.9986 corr_cb=-0.0898
[EPOCH 016/089] train: loss=1.0923 acc=68.86% | val: loss=0.7375 acc=61.45% f1=72.41% auc=60.29% val_score=55.0451 val_score_bestthr=67.4771 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.230, mb=0.503, no=0.999, corr=-0.090) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.4771
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.2275 mb_mean=0.5001 norm_overlap=0.9975 corr_cb=-0.1173 topkJ=0.0136
[TRAIN][ep=017] loss=0.9001 acc=69.53%
[TRAIN][ep=017] mask_avg: mc_mean=0.2383 mb_mean=0.5029 norm_overlap=0.9978 corr_cb=-0.1387
[EPOCH 017/089] train: loss=0.9001 acc=69.53% | val: loss=0.7285 acc=60.24% f1=72.27% auc=59.83% val_score=55.4025 val_score_bestthr=69.8204 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.238, mb=0.503, no=0.998, corr=-0.139) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 69.8204
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.2530 mb_mean=0.5046 norm_overlap=0.9954 corr_cb=-0.1988 topkJ=0.0059
[TRAIN][ep=018] loss=0.8553 acc=71.81%
[TRAIN][ep=018] mask_avg: mc_mean=0.2274 mb_mean=0.5029 norm_overlap=0.9974 corr_cb=-0.1468
[EPOCH 018/089] train: loss=0.8553 acc=71.81% | val: loss=0.7225 acc=60.24% f1=72.27% auc=60.29% val_score=53.8018 val_score_bestthr=69.8204 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.227, mb=0.503, no=0.997, corr=-0.147) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 69.8204
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.2226 mb_mean=0.5051 norm_overlap=0.9936 corr_cb=-0.3405 topkJ=0.0095
[TRAIN][ep=019] loss=0.8496 acc=68.99%
[TRAIN][ep=019] mask_avg: mc_mean=0.2440 mb_mean=0.5029 norm_overlap=0.9966 corr_cb=-0.1985
[EPOCH 019/089] train: loss=0.8496 acc=68.99% | val: loss=0.7332 acc=62.65% f1=69.31% auc=59.07% val_score=48.8609 val_score_bestthr=65.2642 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.244, mb=0.503, no=0.997, corr=-0.198) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 65.2642
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.2833 mb_mean=0.5115 norm_overlap=0.9920 corr_cb=-0.4382 topkJ=0.0024
[TRAIN][ep=020] loss=0.8321 acc=71.01%
[TRAIN][ep=020] mask_avg: mc_mean=0.2355 mb_mean=0.5029 norm_overlap=0.9963 corr_cb=-0.1968
[EPOCH 020/089] train: loss=0.8321 acc=71.01% | val: loss=0.7347 acc=61.45% f1=68.63% auc=59.36% val_score=36.5251 val_score_bestthr=64.1546 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.236, mb=0.503, no=0.996, corr=-0.197) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 64.1546
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2316 mb_mean=0.5054 norm_overlap=0.9977 corr_cb=-0.1436 topkJ=0.0292
[TRAIN][ep=021] loss=0.8256 acc=72.48%
[TRAIN][ep=021] mask_avg: mc_mean=0.2408 mb_mean=0.5029 norm_overlap=0.9958 corr_cb=-0.2200
[EPOCH 021/089] train: loss=0.8256 acc=72.48% | val: loss=0.7230 acc=61.45% f1=72.41% auc=61.51% val_score=56.0663 val_score_bestthr=67.4771 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.241, mb=0.503, no=0.996, corr=-0.220) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.4771
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2482 mb_mean=0.5063 norm_overlap=0.9968 corr_cb=-0.1900 topkJ=0.0231
[TRAIN][ep=022] loss=0.8243 acc=73.29%
[TRAIN][ep=022] mask_avg: mc_mean=0.2594 mb_mean=0.5029 norm_overlap=0.9953 corr_cb=-0.2459
[EPOCH 022/089] train: loss=0.8243 acc=73.29% | val: loss=0.7389 acc=61.45% f1=72.41% auc=61.51% val_score=61.2170 val_score_bestthr=67.4771 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.259, mb=0.503, no=0.995, corr=-0.246) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.4771
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2420 mb_mean=0.4990 norm_overlap=0.9980 corr_cb=-0.1139 topkJ=0.0321
[TRAIN][ep=023] loss=0.8247 acc=71.54%
[TRAIN][ep=023] mask_avg: mc_mean=0.2576 mb_mean=0.5029 norm_overlap=0.9952 corr_cb=-0.2521
[EPOCH 023/089] train: loss=0.8247 acc=71.54% | val: loss=0.7303 acc=60.24% f1=71.79% auc=60.47% val_score=53.8018 val_score_bestthr=65.1322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.258, mb=0.503, no=0.995, corr=-0.252) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 65.1322
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2569 mb_mean=0.4986 norm_overlap=0.9955 corr_cb=-0.2517 topkJ=0.0170
[TRAIN][ep=024] loss=0.8220 acc=71.68%
[TRAIN][ep=024] mask_avg: mc_mean=0.2589 mb_mean=0.5029 norm_overlap=0.9950 corr_cb=-0.2556
[EPOCH 024/089] train: loss=0.8220 acc=71.68% | val: loss=0.7428 acc=61.45% f1=68.63% auc=61.10% val_score=33.0396 val_score_bestthr=63.4079 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.259, mb=0.503, no=0.995, corr=-0.256) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 63.4079
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1890 mb_mean=0.5043 norm_overlap=0.9909 corr_cb=-0.3544 topkJ=0.0050
[TRAIN][ep=025] loss=0.8078 acc=73.15%
[TRAIN][ep=025] mask_avg: mc_mean=0.2585 mb_mean=0.5029 norm_overlap=0.9948 corr_cb=-0.2635
[EPOCH 025/089] train: loss=0.8078 acc=73.15% | val: loss=0.7134 acc=61.45% f1=72.41% auc=62.85% val_score=54.4113 val_score_bestthr=67.4771 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.259, mb=0.503, no=0.995, corr=-0.264) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.4771
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2365 mb_mean=0.5065 norm_overlap=0.9934 corr_cb=-0.3435 topkJ=0.0049
[TRAIN][ep=026] loss=0.7960 acc=73.29%
[TRAIN][ep=026] mask_avg: mc_mean=0.2506 mb_mean=0.5029 norm_overlap=0.9947 corr_cb=-0.2585
[EPOCH 026/089] train: loss=0.7960 acc=73.29% | val: loss=0.7245 acc=61.45% f1=72.41% auc=62.09% val_score=53.5181 val_score_bestthr=67.4771 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.251, mb=0.503, no=0.995, corr=-0.259) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.4771
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2322 mb_mean=0.4994 norm_overlap=0.9927 corr_cb=-0.3015 topkJ=0.0205
[TRAIN][ep=027] loss=0.7909 acc=75.30%
[TRAIN][ep=027] mask_avg: mc_mean=0.2401 mb_mean=0.5029 norm_overlap=0.9948 corr_cb=-0.2460
[EPOCH 027/089] train: loss=0.7909 acc=75.30% | val: loss=0.7254 acc=61.45% f1=72.41% auc=62.38% val_score=53.4051 val_score_bestthr=67.4771 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.240, mb=0.503, no=0.995, corr=-0.246) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.4771
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2460 mb_mean=0.5002 norm_overlap=0.9951 corr_cb=-0.2105 topkJ=0.0511
[TRAIN][ep=028] loss=0.8070 acc=73.56%
[TRAIN][ep=028] mask_avg: mc_mean=0.2639 mb_mean=0.5029 norm_overlap=0.9943 corr_cb=-0.2817
[EPOCH 028/089] train: loss=0.8070 acc=73.56% | val: loss=0.7445 acc=63.86% f1=70.00% auc=62.62% val_score=40.1437 val_score_bestthr=65.6291 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.264, mb=0.503, no=0.994, corr=-0.282) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 65.6291
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2805 mb_mean=0.5037 norm_overlap=0.9916 corr_cb=-0.3830 topkJ=0.0073
[TRAIN][ep=029] loss=0.8009 acc=73.83%
[TRAIN][ep=029] mask_avg: mc_mean=0.2748 mb_mean=0.5029 norm_overlap=0.9942 corr_cb=-0.2984
[EPOCH 029/089] train: loss=0.8009 acc=73.83% | val: loss=0.7270 acc=65.06% f1=71.29% auc=62.50% val_score=53.4051 val_score_bestthr=68.1515 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.275, mb=0.503, no=0.994, corr=-0.298) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 68.1515
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2621 mb_mean=0.4993 norm_overlap=0.9976 corr_cb=-0.1246 topkJ=0.0210
[TRAIN][ep=030] loss=0.8004 acc=73.29%
[TRAIN][ep=030] mask_avg: mc_mean=0.2822 mb_mean=0.5029 norm_overlap=0.9938 corr_cb=-0.3134
[EPOCH 030/089] train: loss=0.8004 acc=73.29% | val: loss=0.7856 acc=66.27% f1=73.58% auc=61.98% val_score=63.9939 val_score_bestthr=66.8805 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.282, mb=0.503, no=0.994, corr=-0.313) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 66.8805
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.3116 mb_mean=0.4945 norm_overlap=0.9928 corr_cb=-0.4206 topkJ=0.0168
[TRAIN][ep=031] loss=0.8015 acc=71.68%
[TRAIN][ep=031] mask_avg: mc_mean=0.2796 mb_mean=0.5029 norm_overlap=0.9940 corr_cb=-0.3011
[EPOCH 031/089] train: loss=0.8015 acc=71.68% | val: loss=0.7545 acc=63.86% f1=70.00% auc=62.73% val_score=41.3782 val_score_bestthr=65.6291 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.280, mb=0.503, no=0.994, corr=-0.301) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 65.6291
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1809 mb_mean=0.5035 norm_overlap=0.9963 corr_cb=-0.1918 topkJ=0.0233
[TRAIN][ep=032] loss=0.7859 acc=73.56%
[TRAIN][ep=032] mask_avg: mc_mean=0.2704 mb_mean=0.5029 norm_overlap=0.9944 corr_cb=-0.2821
[EPOCH 032/089] train: loss=0.7859 acc=73.56% | val: loss=0.7379 acc=65.06% f1=71.29% auc=62.97% val_score=60.9059 val_score_bestthr=68.1515 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.270, mb=0.503, no=0.994, corr=-0.282) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 68.1515
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2460 mb_mean=0.5076 norm_overlap=0.9917 corr_cb=-0.3564 topkJ=0.0012
[TRAIN][ep=033] loss=0.7744 acc=73.83%
[TRAIN][ep=033] mask_avg: mc_mean=0.2788 mb_mean=0.5029 norm_overlap=0.9942 corr_cb=-0.2981
[EPOCH 033/089] train: loss=0.7744 acc=73.83% | val: loss=0.7306 acc=66.27% f1=70.83% auc=63.20% val_score=45.4461 val_score_bestthr=67.2661 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.279, mb=0.503, no=0.994, corr=-0.298) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 67.2661
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1314 mb_mean=0.5064 norm_overlap=0.9955 corr_cb=-0.1472 topkJ=0.0103
[TRAIN][ep=034] loss=0.7643 acc=75.30%
[TRAIN][ep=034] mask_avg: mc_mean=0.2412 mb_mean=0.5029 norm_overlap=0.9944 corr_cb=-0.2530
[EPOCH 034/089] train: loss=0.7643 acc=75.30% | val: loss=0.7236 acc=65.06% f1=71.29% auc=63.78% val_score=53.8664 val_score_bestthr=68.1515 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.241, mb=0.503, no=0.994, corr=-0.253) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 68.1515
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2087 mb_mean=0.4981 norm_overlap=0.9974 corr_cb=-0.1122 topkJ=0.0157
[TRAIN][ep=035] loss=0.7614 acc=74.50%
[TRAIN][ep=035] mask_avg: mc_mean=0.2629 mb_mean=0.5029 norm_overlap=0.9938 corr_cb=-0.2873
[EPOCH 035/089] train: loss=0.7614 acc=74.50% | val: loss=0.7566 acc=65.06% f1=70.71% auc=62.62% val_score=49.5398 val_score_bestthr=66.7428 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.263, mb=0.503, no=0.994, corr=-0.287) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 66.7428
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2919 mb_mean=0.4988 norm_overlap=0.9953 corr_cb=-0.2356 topkJ=0.0378
[TRAIN][ep=036] loss=0.7456 acc=76.51%
[TRAIN][ep=036] mask_avg: mc_mean=0.2636 mb_mean=0.5029 norm_overlap=0.9937 corr_cb=-0.2899
[EPOCH 036/089] train: loss=0.7456 acc=76.51% | val: loss=0.7570 acc=66.27% f1=72.00% auc=62.85% val_score=53.8664 val_score_bestthr=69.2661 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.264, mb=0.503, no=0.994, corr=-0.290) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 69.2661
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.2945 mb_mean=0.4998 norm_overlap=0.9945 corr_cb=-0.2803 topkJ=0.0137
[TRAIN][ep=037] loss=0.7466 acc=76.51%
[TRAIN][ep=037] mask_avg: mc_mean=0.2556 mb_mean=0.5029 norm_overlap=0.9936 corr_cb=-0.2903
[EPOCH 037/089] train: loss=0.7466 acc=76.51% | val: loss=0.7507 acc=65.06% f1=71.29% auc=62.56% val_score=53.4478 val_score_bestthr=68.1515 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.256, mb=0.503, no=0.994, corr=-0.290) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 68.1515
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2817 mb_mean=0.5025 norm_overlap=0.9890 corr_cb=-0.3793 topkJ=0.0008
[TRAIN][ep=038] loss=0.7543 acc=75.97%
[TRAIN][ep=038] mask_avg: mc_mean=0.3089 mb_mean=0.5029 norm_overlap=0.9929 corr_cb=-0.3623
[EPOCH 038/089] train: loss=0.7543 acc=75.97% | val: loss=0.7843 acc=66.27% f1=70.83% auc=61.57% val_score=62.4156 val_score_bestthr=63.5328 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.309, mb=0.503, no=0.993, corr=-0.362) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 63.5328
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2501 mb_mean=0.5026 norm_overlap=0.9948 corr_cb=-0.2428 topkJ=0.0198
[TRAIN][ep=039] loss=0.7343 acc=76.91%
[TRAIN][ep=039] mask_avg: mc_mean=0.2540 mb_mean=0.5029 norm_overlap=0.9937 corr_cb=-0.2864
[EPOCH 039/089] train: loss=0.7343 acc=76.91% | val: loss=0.7579 acc=65.06% f1=71.29% auc=61.74% val_score=55.0225 val_score_bestthr=68.1515 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.254, mb=0.503, no=0.994, corr=-0.286) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 68.1515
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.2208 mb_mean=0.4982 norm_overlap=0.9954 corr_cb=-0.2338 topkJ=0.0195
[TRAIN][ep=040] loss=0.7422 acc=75.17%
[TRAIN][ep=040] mask_avg: mc_mean=0.2768 mb_mean=0.5029 norm_overlap=0.9932 corr_cb=-0.3214
[EPOCH 040/089] train: loss=0.7422 acc=75.17% | val: loss=0.7530 acc=65.06% f1=71.29% auc=62.38% val_score=55.0225 val_score_bestthr=68.1515 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.277, mb=0.503, no=0.993, corr=-0.321) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.2933 -> 68.1515
[EARLY STOP] no improvement for 30 epochs. best_epoch=10
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/ckpt_best_fold_3.pt
=============== FIT DONE ===============
[BEST] epoch=10 | val_acc=61.45% | val_f1=72.88% | val_auc=57.85% | val_score=57.5501 | val_score_bestthr=71.2933
[TEST@BEST] thr_used=0.400 | acc=59.90% f1=71.28% auc=70.46% | SP_sex=10.83% EO_sex=3.70% SP_age=10.98% EO_age=12.00%
[TIME] 1.04 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold3_rep2_seed2003/summary_fold_3.json
