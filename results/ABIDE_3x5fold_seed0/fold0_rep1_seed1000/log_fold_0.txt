[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4752 mb_mean=0.5091 norm_overlap=0.9996 corr_cb=-0.4004 topkJ=0.0039
[TRAIN][ep=000] loss=0.6935 acc=50.74%
[TRAIN][ep=000] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1325
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4782 mb_mean=0.5028 norm_overlap=0.9999 corr_cb=-0.0933 topkJ=0.0031
[TRAIN][ep=001] loss=0.6925 acc=52.21%
[TRAIN][ep=001] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1283
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4776 mb_mean=0.5098 norm_overlap=0.9997 corr_cb=-0.3755 topkJ=0.0024
[TRAIN][ep=002] loss=0.6917 acc=52.08%
[TRAIN][ep=002] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1407
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4785 mb_mean=0.5037 norm_overlap=1.0000 corr_cb=0.0262 topkJ=0.0152
[TRAIN][ep=003] loss=0.6908 acc=54.50%
[TRAIN][ep=003] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1330
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4760 mb_mean=0.5053 norm_overlap=0.9998 corr_cb=-0.2618 topkJ=0.0459
[TRAIN][ep=004] loss=0.6901 acc=57.18%
[TRAIN][ep=004] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1247
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4794 mb_mean=0.5002 norm_overlap=0.9999 corr_cb=-0.2006 topkJ=0.0064
[TRAIN][ep=005] loss=0.6898 acc=53.29%
[TRAIN][ep=005] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1272
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4760 mb_mean=0.5040 norm_overlap=0.9997 corr_cb=-0.4011 topkJ=0.0113
[TRAIN][ep=006] loss=0.6886 acc=57.72%
[TRAIN][ep=006] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1302
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4758 mb_mean=0.5023 norm_overlap=0.9998 corr_cb=-0.2950 topkJ=0.0024
[TRAIN][ep=007] loss=0.6867 acc=58.79%
[TRAIN][ep=007] mask_avg: mc_mean=0.4785 mb_mean=0.5015 norm_overlap=0.9999 corr_cb=-0.1365
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4784 mb_mean=0.4987 norm_overlap=0.9997 corr_cb=-0.3532 topkJ=0.0048
[TRAIN][ep=008] loss=0.6853 acc=58.52%
[TRAIN][ep=008] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1238
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4781 mb_mean=0.5042 norm_overlap=0.9998 corr_cb=-0.2975 topkJ=0.0188
[TRAIN][ep=009] loss=0.6829 acc=58.39%
[TRAIN][ep=009] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1254
================= FIT START (fold=0) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4787 mb_mean=0.5043 norm_overlap=0.9999 corr_cb=-0.0822 topkJ=0.0502
[TRAIN][ep=000] loss=0.6824 acc=61.48%
[TRAIN][ep=000] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1201
[EPOCH 000/089] train: loss=0.6824 acc=61.48% | val: loss=0.6814 acc=59.04% f1=70.69% auc=68.72% val_score=47.4823 val_score_bestthr=61.7205 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.120) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 61.7205
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4793 mb_mean=0.5022 norm_overlap=0.9998 corr_cb=-0.2365 topkJ=0.0024
[TRAIN][ep=001] loss=0.6809 acc=59.87%
[TRAIN][ep=001] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1274
[EPOCH 001/089] train: loss=0.6809 acc=59.87% | val: loss=0.6803 acc=66.27% f1=72.55% auc=68.90% val_score=52.3124 val_score_bestthr=62.1343 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.127) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 61.7205 -> 62.1343
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4774 mb_mean=0.4982 norm_overlap=1.0000 corr_cb=-0.0324 topkJ=0.0252
[TRAIN][ep=002] loss=0.6790 acc=62.28%
[TRAIN][ep=002] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1182
[EPOCH 002/089] train: loss=0.6790 acc=62.28% | val: loss=0.6797 acc=60.24% f1=71.79% auc=67.85% val_score=43.8599 val_score_bestthr=62.5815 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.118) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 62.1343 -> 62.5815
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4776 mb_mean=0.5075 norm_overlap=0.9998 corr_cb=-0.2177 topkJ=0.0023
[TRAIN][ep=003] loss=0.6772 acc=61.21%
[TRAIN][ep=003] mask_avg: mc_mean=0.4785 mb_mean=0.5015 norm_overlap=0.9999 corr_cb=-0.1255
[EPOCH 003/089] train: loss=0.6772 acc=61.21% | val: loss=0.6768 acc=65.06% f1=70.71% auc=69.42% val_score=47.6616 val_score_bestthr=62.8944 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.125) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 62.5815 -> 62.8944
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4824 mb_mean=0.4950 norm_overlap=0.9998 corr_cb=-0.2211 topkJ=0.0294
[TRAIN][ep=004] loss=0.6772 acc=61.21%
[TRAIN][ep=004] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1284
[EPOCH 004/089] train: loss=0.6772 acc=61.21% | val: loss=0.6763 acc=60.24% f1=71.30% auc=68.60% val_score=45.2257 val_score_bestthr=62.8146 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.128) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.8944 -> 62.8146
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4744 mb_mean=0.5047 norm_overlap=0.9999 corr_cb=-0.0747 topkJ=0.0278
[TRAIN][ep=005] loss=1.2603 acc=62.68%
[TRAIN][ep=005] mask_avg: mc_mean=0.3613 mb_mean=0.5014 norm_overlap=0.9967 corr_cb=-0.6361
[EPOCH 005/089] train: loss=1.2603 acc=62.68% | val: loss=0.6727 acc=60.24% f1=70.80% auc=70.99% val_score=61.4724 val_score_bestthr=61.4724 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.361, mb=0.501, no=0.997, corr=-0.636) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.8944 -> 61.4724
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2188 mb_mean=0.5118 norm_overlap=0.9880 corr_cb=-0.7907 topkJ=0.0000
[TRAIN][ep=006] loss=1.2529 acc=56.91%
[TRAIN][ep=006] mask_avg: mc_mean=0.2104 mb_mean=0.5014 norm_overlap=0.9900 corr_cb=-0.7063
[EPOCH 006/089] train: loss=1.2529 acc=56.91% | val: loss=0.6718 acc=59.04% f1=70.69% auc=72.09% val_score=61.0368 val_score_bestthr=61.7205 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.210, mb=0.501, no=0.990, corr=-0.706) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.8944 -> 61.7205
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.1720 mb_mean=0.5024 norm_overlap=0.9859 corr_cb=-0.7879 topkJ=0.0000
[TRAIN][ep=007] loss=1.2489 acc=61.88%
[TRAIN][ep=007] mask_avg: mc_mean=0.1473 mb_mean=0.5014 norm_overlap=0.9844 corr_cb=-0.7243
[EPOCH 007/089] train: loss=1.2489 acc=61.88% | val: loss=0.6683 acc=59.04% f1=71.67% auc=72.67% val_score=60.9025 val_score_bestthr=67.4890 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.147, mb=0.501, no=0.984, corr=-0.724) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 62.8944 -> 67.4890
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1386 mb_mean=0.5001 norm_overlap=0.9798 corr_cb=-0.7769 topkJ=0.0000
[TRAIN][ep=008] loss=1.2429 acc=62.42%
[TRAIN][ep=008] mask_avg: mc_mean=0.1098 mb_mean=0.5014 norm_overlap=0.9794 corr_cb=-0.7110
[EPOCH 008/089] train: loss=1.2429 acc=62.42% | val: loss=0.6661 acc=59.04% f1=70.69% auc=72.56% val_score=52.9305 val_score_bestthr=61.7205 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.110, mb=0.501, no=0.979, corr=-0.711) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4890 -> 61.7205
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.0867 mb_mean=0.5043 norm_overlap=0.9784 corr_cb=-0.7381 topkJ=0.0000
[TRAIN][ep=009] loss=1.2347 acc=65.23%
[TRAIN][ep=009] mask_avg: mc_mean=0.0888 mb_mean=0.5014 norm_overlap=0.9751 corr_cb=-0.6861
[EPOCH 009/089] train: loss=1.2347 acc=65.23% | val: loss=0.6624 acc=68.67% f1=75.47% auc=72.38% val_score=57.5909 val_score_bestthr=63.4734 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.089, mb=0.501, no=0.975, corr=-0.686) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4890 -> 63.4734
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.0971 mb_mean=0.4997 norm_overlap=0.9653 corr_cb=-0.7402 topkJ=0.0000
[TRAIN][ep=010] loss=1.2303 acc=65.37%
[TRAIN][ep=010] mask_avg: mc_mean=0.0757 mb_mean=0.5015 norm_overlap=0.9707 corr_cb=-0.6551
[EPOCH 010/089] train: loss=1.2303 acc=65.37% | val: loss=0.6627 acc=68.67% f1=75.47% auc=71.16% val_score=41.0188 val_score_bestthr=63.1690 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.076, mb=0.501, no=0.971, corr=-0.655) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4890 -> 63.1690
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1012 mb_mean=0.5016 norm_overlap=0.9566 corr_cb=-0.7160 topkJ=0.0000
[TRAIN][ep=011] loss=0.7439 acc=66.17%
[TRAIN][ep=011] mask_avg: mc_mean=0.0720 mb_mean=0.5015 norm_overlap=0.9679 corr_cb=-0.6316
[EPOCH 011/089] train: loss=0.7439 acc=66.17% | val: loss=0.6561 acc=63.86% f1=72.73% auc=72.21% val_score=60.2509 val_score_bestthr=61.8294 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.072, mb=0.501, no=0.968, corr=-0.632) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4890 -> 61.8294
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.0458 mb_mean=0.5072 norm_overlap=0.9674 corr_cb=-0.5951 topkJ=0.0000
[TRAIN][ep=012] loss=0.6759 acc=66.04%
[TRAIN][ep=012] mask_avg: mc_mean=0.0808 mb_mean=0.5014 norm_overlap=0.9675 corr_cb=-0.6231
[EPOCH 012/089] train: loss=0.6759 acc=66.04% | val: loss=0.6511 acc=65.06% f1=73.39% auc=72.50% val_score=58.5034 val_score_bestthr=63.3372 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.081, mb=0.501, no=0.968, corr=-0.623) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4890 -> 63.3372
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.0601 mb_mean=0.5080 norm_overlap=0.9621 corr_cb=-0.4864 topkJ=0.0000
[TRAIN][ep=013] loss=0.6688 acc=65.23%
[TRAIN][ep=013] mask_avg: mc_mean=0.0797 mb_mean=0.5015 norm_overlap=0.9656 corr_cb=-0.6047
[EPOCH 013/089] train: loss=0.6688 acc=65.23% | val: loss=0.6493 acc=66.27% f1=73.58% auc=70.70% val_score=41.6516 val_score_bestthr=63.0549 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.080, mb=0.501, no=0.966, corr=-0.605) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4890 -> 63.0549
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.0991 mb_mean=0.4973 norm_overlap=0.9768 corr_cb=-0.5486 topkJ=0.0020
[TRAIN][ep=014] loss=0.6638 acc=65.23%
[TRAIN][ep=014] mask_avg: mc_mean=0.0917 mb_mean=0.5014 norm_overlap=0.9664 corr_cb=-0.6052
[EPOCH 014/089] train: loss=0.6638 acc=65.23% | val: loss=0.6431 acc=62.65% f1=72.07% auc=72.27% val_score=54.0553 val_score_bestthr=60.2509 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.092, mb=0.501, no=0.966, corr=-0.605) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4890 -> 60.2509
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.0722 mb_mean=0.5043 norm_overlap=0.9662 corr_cb=-0.5433 topkJ=0.0000
[TRAIN][ep=015] loss=0.6562 acc=65.91%
[TRAIN][ep=015] mask_avg: mc_mean=0.1065 mb_mean=0.5014 norm_overlap=0.9678 corr_cb=-0.6046
[EPOCH 015/089] train: loss=0.6562 acc=65.91% | val: loss=0.6364 acc=63.86% f1=72.73% auc=72.85% val_score=54.9465 val_score_bestthr=59.6011 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.106, mb=0.501, no=0.968, corr=-0.605) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4890 -> 59.6011
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.0735 mb_mean=0.5102 norm_overlap=0.9581 corr_cb=-0.6107 topkJ=0.0000
[TRAIN][ep=016] loss=0.6528 acc=66.98%
[TRAIN][ep=016] mask_avg: mc_mean=0.1075 mb_mean=0.5014 norm_overlap=0.9674 corr_cb=-0.5916
[EPOCH 016/089] train: loss=0.6528 acc=66.98% | val: loss=0.6413 acc=65.06% f1=73.39% auc=70.47% val_score=42.7837 val_score_bestthr=60.7031 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.107, mb=0.501, no=0.967, corr=-0.592) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4890 -> 60.7031
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1446 mb_mean=0.4927 norm_overlap=0.9814 corr_cb=-0.5266 topkJ=0.0000
[TRAIN][ep=017] loss=0.6444 acc=66.98%
[TRAIN][ep=017] mask_avg: mc_mean=0.1245 mb_mean=0.5014 norm_overlap=0.9695 corr_cb=-0.5930
[EPOCH 017/089] train: loss=0.6444 acc=66.98% | val: loss=0.6338 acc=60.24% f1=71.30% auc=70.99% val_score=52.6651 val_score_bestthr=61.9197 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.125, mb=0.501, no=0.969, corr=-0.593) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4890 -> 61.9197
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1250 mb_mean=0.5052 norm_overlap=0.9655 corr_cb=-0.6119 topkJ=0.0000
[TRAIN][ep=018] loss=0.6395 acc=66.85%
[TRAIN][ep=018] mask_avg: mc_mean=0.1379 mb_mean=0.5014 norm_overlap=0.9706 corr_cb=-0.5822
[EPOCH 018/089] train: loss=0.6395 acc=66.85% | val: loss=0.6452 acc=63.86% f1=71.70% auc=70.35% val_score=50.9584 val_score_bestthr=62.4315 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.138, mb=0.501, no=0.971, corr=-0.582) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4890 -> 62.4315
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1073 mb_mean=0.4998 norm_overlap=0.9683 corr_cb=-0.5685 topkJ=0.0000
[TRAIN][ep=019] loss=0.6465 acc=64.70%
[TRAIN][ep=019] mask_avg: mc_mean=0.1101 mb_mean=0.5014 norm_overlap=0.9668 corr_cb=-0.5654
[EPOCH 019/089] train: loss=0.6465 acc=64.70% | val: loss=0.6220 acc=60.24% f1=71.30% auc=73.55% val_score=47.6028 val_score_bestthr=61.9197 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.110, mb=0.501, no=0.967, corr=-0.565) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4890 -> 61.9197
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1909 mb_mean=0.4956 norm_overlap=0.9685 corr_cb=-0.6405 topkJ=0.0000
[TRAIN][ep=020] loss=0.6334 acc=67.65%
[TRAIN][ep=020] mask_avg: mc_mean=0.1219 mb_mean=0.5014 norm_overlap=0.9681 corr_cb=-0.5693
[EPOCH 020/089] train: loss=0.6334 acc=67.65% | val: loss=0.6424 acc=66.27% f1=73.08% auc=70.87% val_score=55.6753 val_score_bestthr=62.8922 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.122, mb=0.501, no=0.968, corr=-0.569) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4890 -> 62.8922
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.1045 mb_mean=0.5057 norm_overlap=0.9588 corr_cb=-0.5425 topkJ=0.0000
[TRAIN][ep=021] loss=0.6248 acc=67.92%
[TRAIN][ep=021] mask_avg: mc_mean=0.1433 mb_mean=0.5014 norm_overlap=0.9707 corr_cb=-0.5690
[EPOCH 021/089] train: loss=0.6248 acc=67.92% | val: loss=0.6220 acc=59.04% f1=70.69% auc=73.14% val_score=52.7842 val_score_bestthr=61.7205 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.143, mb=0.501, no=0.971, corr=-0.569) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4890 -> 61.7205
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1760 mb_mean=0.4985 norm_overlap=0.9735 corr_cb=-0.5420 topkJ=0.0020
[TRAIN][ep=022] loss=0.6233 acc=68.86%
[TRAIN][ep=022] mask_avg: mc_mean=0.1525 mb_mean=0.5014 norm_overlap=0.9717 corr_cb=-0.5648
[EPOCH 022/089] train: loss=0.6233 acc=68.86% | val: loss=0.6133 acc=65.06% f1=73.39% auc=73.78% val_score=56.0574 val_score_bestthr=60.7031 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.153, mb=0.501, no=0.972, corr=-0.565) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4890 -> 60.7031
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1165 mb_mean=0.5003 norm_overlap=0.9678 corr_cb=-0.5572 topkJ=0.0000
[TRAIN][ep=023] loss=0.6212 acc=68.99%
[TRAIN][ep=023] mask_avg: mc_mean=0.1150 mb_mean=0.5015 norm_overlap=0.9670 corr_cb=-0.5475
[EPOCH 023/089] train: loss=0.6212 acc=68.99% | val: loss=0.6100 acc=71.08% f1=69.23% auc=74.01% val_score=56.0574 val_score_bestthr=61.0829 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.115, mb=0.501, no=0.967, corr=-0.547) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4890 -> 61.0829
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1317 mb_mean=0.5001 norm_overlap=0.9716 corr_cb=-0.4852 topkJ=0.0032
[TRAIN][ep=024] loss=0.6100 acc=68.59%
[TRAIN][ep=024] mask_avg: mc_mean=0.1395 mb_mean=0.5014 norm_overlap=0.9702 corr_cb=-0.5513
[EPOCH 024/089] train: loss=0.6100 acc=68.59% | val: loss=0.6114 acc=69.88% f1=62.69% auc=74.07% val_score=58.4373 val_score_bestthr=61.9473 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.140, mb=0.501, no=0.970, corr=-0.551) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4890 -> 61.9473
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1344 mb_mean=0.5013 norm_overlap=0.9699 corr_cb=-0.5855 topkJ=0.0004
[TRAIN][ep=025] loss=0.6217 acc=68.72%
[TRAIN][ep=025] mask_avg: mc_mean=0.0940 mb_mean=0.5014 norm_overlap=0.9639 corr_cb=-0.5180
[EPOCH 025/089] train: loss=0.6217 acc=68.72% | val: loss=0.6038 acc=69.88% f1=62.69% auc=74.59% val_score=56.0574 val_score_bestthr=61.9473 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.094, mb=0.501, no=0.964, corr=-0.518) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4890 -> 61.9473
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.0939 mb_mean=0.5025 norm_overlap=0.9654 corr_cb=-0.5514 topkJ=0.0004
[TRAIN][ep=026] loss=0.6028 acc=69.93%
[TRAIN][ep=026] mask_avg: mc_mean=0.1261 mb_mean=0.5014 norm_overlap=0.9685 corr_cb=-0.5428
[EPOCH 026/089] train: loss=0.6028 acc=69.93% | val: loss=0.6008 acc=73.49% f1=70.27% auc=75.58% val_score=50.4532 val_score_bestthr=61.4098 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.126, mb=0.501, no=0.968, corr=-0.543) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4890 -> 61.4098
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1321 mb_mean=0.5001 norm_overlap=0.9655 corr_cb=-0.5976 topkJ=0.0000
[TRAIN][ep=027] loss=0.6000 acc=71.54%
[TRAIN][ep=027] mask_avg: mc_mean=0.1375 mb_mean=0.5014 norm_overlap=0.9697 corr_cb=-0.5436
[EPOCH 027/089] train: loss=0.6000 acc=71.54% | val: loss=0.6119 acc=72.29% f1=66.67% auc=74.83% val_score=59.4232 val_score_bestthr=65.0876 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.137, mb=0.501, no=0.970, corr=-0.544) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4890 -> 65.0876
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1663 mb_mean=0.4951 norm_overlap=0.9798 corr_cb=-0.4913 topkJ=0.0004
[TRAIN][ep=028] loss=0.6027 acc=70.07%
[TRAIN][ep=028] mask_avg: mc_mean=0.1365 mb_mean=0.5015 norm_overlap=0.9696 corr_cb=-0.5397
[EPOCH 028/089] train: loss=0.6027 acc=70.07% | val: loss=0.5952 acc=72.29% f1=65.67% auc=75.35% val_score=48.4681 val_score_bestthr=63.0185 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.136, mb=0.501, no=0.970, corr=-0.540) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4890 -> 63.0185
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.1409 mb_mean=0.4980 norm_overlap=0.9704 corr_cb=-0.5405 topkJ=0.0000
[TRAIN][ep=029] loss=0.6005 acc=70.74%
[TRAIN][ep=029] mask_avg: mc_mean=0.1255 mb_mean=0.5015 norm_overlap=0.9681 corr_cb=-0.5348
[EPOCH 029/089] train: loss=0.6005 acc=70.74% | val: loss=0.5922 acc=74.70% f1=72.73% auc=75.93% val_score=51.2043 val_score_bestthr=63.6598 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.125, mb=0.501, no=0.968, corr=-0.535) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4890 -> 63.6598
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.1553 mb_mean=0.4961 norm_overlap=0.9767 corr_cb=-0.5364 topkJ=0.0004
[TRAIN][ep=030] loss=0.6053 acc=68.99%
[TRAIN][ep=030] mask_avg: mc_mean=0.1113 mb_mean=0.5015 norm_overlap=0.9661 corr_cb=-0.5245
[EPOCH 030/089] train: loss=0.6053 acc=68.99% | val: loss=0.5933 acc=72.29% f1=67.61% auc=75.87% val_score=55.6930 val_score_bestthr=63.5581 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.111, mb=0.501, no=0.966, corr=-0.524) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4890 -> 63.5581
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.1019 mb_mean=0.5019 norm_overlap=0.9678 corr_cb=-0.5225 topkJ=0.0016
[TRAIN][ep=031] loss=0.5849 acc=72.75%
[TRAIN][ep=031] mask_avg: mc_mean=0.1270 mb_mean=0.5015 norm_overlap=0.9681 corr_cb=-0.5343
[EPOCH 031/089] train: loss=0.5849 acc=72.75% | val: loss=0.5892 acc=75.90% f1=73.68% auc=76.05% val_score=49.6855 val_score_bestthr=65.2110 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.127, mb=0.501, no=0.968, corr=-0.534) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4890 -> 65.2110
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1382 mb_mean=0.4988 norm_overlap=0.9715 corr_cb=-0.5575 topkJ=0.0012
[TRAIN][ep=032] loss=0.5842 acc=71.41%
[TRAIN][ep=032] mask_avg: mc_mean=0.1507 mb_mean=0.5014 norm_overlap=0.9711 corr_cb=-0.5382
[EPOCH 032/089] train: loss=0.5842 acc=71.41% | val: loss=0.5806 acc=75.90% f1=73.68% auc=76.57% val_score=54.3437 val_score_bestthr=65.2110 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.151, mb=0.501, no=0.971, corr=-0.538) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.4890 -> 65.2110
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1748 mb_mean=0.4952 norm_overlap=0.9798 corr_cb=-0.5166 topkJ=0.0020
[TRAIN][ep=033] loss=0.5793 acc=72.48%
[TRAIN][ep=033] mask_avg: mc_mean=0.1296 mb_mean=0.5014 norm_overlap=0.9687 corr_cb=-0.5261
[EPOCH 033/089] train: loss=0.5793 acc=72.48% | val: loss=0.5894 acc=75.90% f1=72.22% auc=76.22% val_score=59.4716 val_score_bestthr=69.5707 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.130, mb=0.501, no=0.969, corr=-0.526) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 67.4890 -> 69.5707
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1550 mb_mean=0.5028 norm_overlap=0.9696 corr_cb=-0.5821 topkJ=0.0000
[TRAIN][ep=034] loss=0.6829 acc=70.47%
[TRAIN][ep=034] mask_avg: mc_mean=0.1570 mb_mean=0.5014 norm_overlap=0.9715 corr_cb=-0.5305
[EPOCH 034/089] train: loss=0.6829 acc=70.47% | val: loss=0.5851 acc=75.90% f1=72.97% auc=76.80% val_score=47.4307 val_score_bestthr=65.3386 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.157, mb=0.501, no=0.972, corr=-0.530) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.5707 -> 65.3386
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.1138 mb_mean=0.5037 norm_overlap=0.9707 corr_cb=-0.5063 topkJ=0.0004
[TRAIN][ep=035] loss=0.7651 acc=72.48%
[TRAIN][ep=035] mask_avg: mc_mean=0.1382 mb_mean=0.5014 norm_overlap=0.9699 corr_cb=-0.5262
[EPOCH 035/089] train: loss=0.7651 acc=72.48% | val: loss=0.5748 acc=75.90% f1=72.22% auc=77.50% val_score=60.1008 val_score_bestthr=69.5707 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.138, mb=0.501, no=0.970, corr=-0.526) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.5707 -> 69.5707
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.1479 mb_mean=0.4983 norm_overlap=0.9706 corr_cb=-0.5456 topkJ=0.0004
[TRAIN][ep=036] loss=0.8584 acc=72.89%
[TRAIN][ep=036] mask_avg: mc_mean=0.1539 mb_mean=0.5015 norm_overlap=0.9716 corr_cb=-0.5266
[EPOCH 036/089] train: loss=0.8584 acc=72.89% | val: loss=0.5719 acc=77.11% f1=73.24% auc=77.21% val_score=54.0409 val_score_bestthr=65.6926 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.154, mb=0.501, no=0.972, corr=-0.527) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.5707 -> 65.6926
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1265 mb_mean=0.5046 norm_overlap=0.9669 corr_cb=-0.5212 topkJ=0.0000
[TRAIN][ep=037] loss=0.9460 acc=72.08%
[TRAIN][ep=037] mask_avg: mc_mean=0.1296 mb_mean=0.5014 norm_overlap=0.9690 corr_cb=-0.5165
[EPOCH 037/089] train: loss=0.9460 acc=72.08% | val: loss=0.5736 acc=75.90% f1=71.43% auc=77.91% val_score=51.2201 val_score_bestthr=66.9956 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.130, mb=0.501, no=0.969, corr=-0.516) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.5707 -> 66.9956
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.1702 mb_mean=0.4966 norm_overlap=0.9795 corr_cb=-0.5123 topkJ=0.0012
[TRAIN][ep=038] loss=1.0396 acc=72.21%
[TRAIN][ep=038] mask_avg: mc_mean=0.1018 mb_mean=0.5014 norm_overlap=0.9649 corr_cb=-0.4999
[EPOCH 038/089] train: loss=1.0396 acc=72.21% | val: loss=0.5779 acc=75.90% f1=72.97% auc=76.80% val_score=60.8829 val_score_bestthr=65.3386 | dyn(w_pfs=0.100, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.102, mb=0.501, no=0.965, corr=-0.500) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.5707 -> 65.3386
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.0881 mb_mean=0.5081 norm_overlap=0.9597 corr_cb=-0.4994 topkJ=0.0000
[TRAIN][ep=039] loss=0.7936 acc=72.89%
[TRAIN][ep=039] mask_avg: mc_mean=0.1366 mb_mean=0.5015 norm_overlap=0.9696 corr_cb=-0.5188
[EPOCH 039/089] train: loss=0.7936 acc=72.89% | val: loss=0.5635 acc=78.31% f1=75.00% auc=77.67% val_score=54.0409 val_score_bestthr=70.6320 | dyn(w_pfs=0.140, w_sup=0.140, w_csuf=0.140, stage2=False) | mask(mc=0.137, mb=0.501, no=0.970, corr=-0.519) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 69.5707 -> 70.6320
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.1543 mb_mean=0.5035 norm_overlap=0.9638 corr_cb=-0.6043 topkJ=0.0000
[TRAIN][ep=040] loss=0.8906 acc=72.89%
[TRAIN][ep=040] mask_avg: mc_mean=0.1374 mb_mean=0.5014 norm_overlap=0.9698 corr_cb=-0.5145
[EPOCH 040/089] train: loss=0.8906 acc=72.89% | val: loss=0.5709 acc=78.31% f1=75.68% auc=77.91% val_score=49.4711 val_score_bestthr=72.7273 | dyn(w_pfs=0.180, w_sup=0.180, w_csuf=0.180, stage2=False) | mask(mc=0.137, mb=0.501, no=0.970, corr=-0.514) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 70.6320 -> 72.7273
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.1589 mb_mean=0.5010 norm_overlap=0.9686 corr_cb=-0.5819 topkJ=0.0000
[TRAIN][ep=041] loss=0.9807 acc=73.15%
[TRAIN][ep=041] mask_avg: mc_mean=0.1530 mb_mean=0.5014 norm_overlap=0.9716 corr_cb=-0.5187
[EPOCH 041/089] train: loss=0.9807 acc=73.15% | val: loss=0.6120 acc=75.90% f1=72.97% auc=76.57% val_score=55.8939 val_score_bestthr=66.5560 | dyn(w_pfs=0.220, w_sup=0.220, w_csuf=0.200, stage2=False) | mask(mc=0.153, mb=0.501, no=0.972, corr=-0.519) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7273 -> 66.5560
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.1611 mb_mean=0.4956 norm_overlap=0.9803 corr_cb=-0.4536 topkJ=0.0004
[TRAIN][ep=042] loss=1.0314 acc=74.63%
[TRAIN][ep=042] mask_avg: mc_mean=0.1536 mb_mean=0.5014 norm_overlap=0.9718 corr_cb=-0.5158
[EPOCH 042/089] train: loss=1.0314 acc=74.63% | val: loss=0.5578 acc=78.31% f1=75.00% auc=78.14% val_score=60.1917 val_score_bestthr=70.6320 | dyn(w_pfs=0.260, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.154, mb=0.501, no=0.972, corr=-0.516) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7273 -> 70.6320
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.1114 mb_mean=0.4997 norm_overlap=0.9710 corr_cb=-0.5304 topkJ=0.0004
[TRAIN][ep=043] loss=1.0587 acc=74.50%
[TRAIN][ep=043] mask_avg: mc_mean=0.1228 mb_mean=0.5014 norm_overlap=0.9683 corr_cb=-0.5045
[EPOCH 043/089] train: loss=1.0587 acc=74.50% | val: loss=0.5797 acc=62.65% f1=73.04% auc=77.79% val_score=56.2778 val_score_bestthr=67.4521 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.123, mb=0.501, no=0.968, corr=-0.504) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7273 -> 67.4521
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.1108 mb_mean=0.5072 norm_overlap=0.9640 corr_cb=-0.5405 topkJ=0.0000
[TRAIN][ep=044] loss=1.0675 acc=74.50%
[TRAIN][ep=044] mask_avg: mc_mean=0.1395 mb_mean=0.5015 norm_overlap=0.9700 corr_cb=-0.5127
[EPOCH 044/089] train: loss=1.0675 acc=74.50% | val: loss=0.5992 acc=77.11% f1=73.24% auc=79.53% val_score=61.7883 val_score_bestthr=69.0638 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.139, mb=0.501, no=0.970, corr=-0.513) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7273 -> 69.0638
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.1479 mb_mean=0.4984 norm_overlap=0.9712 corr_cb=-0.4633 topkJ=0.0000
[TRAIN][ep=045] loss=1.0643 acc=75.97%
[TRAIN][ep=045] mask_avg: mc_mean=0.1474 mb_mean=0.5014 norm_overlap=0.9710 corr_cb=-0.5136
[EPOCH 045/089] train: loss=1.0643 acc=75.97% | val: loss=0.5530 acc=78.31% f1=75.00% auc=78.43% val_score=57.8818 val_score_bestthr=70.6320 | dyn(w_pfs=0.240, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.147, mb=0.501, no=0.971, corr=-0.514) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7273 -> 70.6320
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.1813 mb_mean=0.4955 norm_overlap=0.9779 corr_cb=-0.4808 topkJ=0.0028
[TRAIN][ep=046] loss=0.8258 acc=75.30%
[TRAIN][ep=046] mask_avg: mc_mean=0.1374 mb_mean=0.5015 norm_overlap=0.9697 corr_cb=-0.5067
[EPOCH 046/089] train: loss=0.8258 acc=75.30% | val: loss=0.5630 acc=75.90% f1=72.97% auc=77.91% val_score=66.5560 val_score_bestthr=66.5560 | dyn(w_pfs=0.140, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.137, mb=0.501, no=0.970, corr=-0.507) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7273 -> 66.5560
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.1456 mb_mean=0.5047 norm_overlap=0.9723 corr_cb=-0.5277 topkJ=0.0004
[TRAIN][ep=047] loss=0.5931 acc=74.90%
[TRAIN][ep=047] mask_avg: mc_mean=0.1630 mb_mean=0.5014 norm_overlap=0.9727 corr_cb=-0.5114
[EPOCH 047/089] train: loss=0.5931 acc=74.90% | val: loss=0.5522 acc=75.90% f1=72.97% auc=77.91% val_score=59.4716 val_score_bestthr=66.5560 | dyn(w_pfs=0.040, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.163, mb=0.501, no=0.973, corr=-0.511) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7273 -> 66.5560
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.1858 mb_mean=0.4955 norm_overlap=0.9761 corr_cb=-0.5102 topkJ=0.0000
[TRAIN][ep=048] loss=0.5468 acc=74.63%
[TRAIN][ep=048] mask_avg: mc_mean=0.1583 mb_mean=0.5014 norm_overlap=0.9723 corr_cb=-0.5073
[EPOCH 048/089] train: loss=0.5468 acc=74.63% | val: loss=0.5596 acc=75.90% f1=72.97% auc=77.67% val_score=66.5560 val_score_bestthr=66.5560 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.158, mb=0.501, no=0.972, corr=-0.507) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7273 -> 66.5560
[DBG][ep=049] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.1380 mb_mean=0.5049 norm_overlap=0.9710 corr_cb=-0.5244 topkJ=0.0008
[TRAIN][ep=049] loss=0.5320 acc=75.70%
[TRAIN][ep=049] mask_avg: mc_mean=0.1447 mb_mean=0.5014 norm_overlap=0.9710 corr_cb=-0.5025
[EPOCH 049/089] train: loss=0.5320 acc=75.70% | val: loss=0.5425 acc=77.11% f1=73.97% auc=79.24% val_score=62.3946 val_score_bestthr=69.3311 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.145, mb=0.501, no=0.971, corr=-0.503) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7273 -> 69.3311
[DBG][ep=050] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.1369 mb_mean=0.5029 norm_overlap=0.9688 corr_cb=-0.4736 topkJ=0.0016
[TRAIN][ep=050] loss=0.5125 acc=76.38%
[TRAIN][ep=050] mask_avg: mc_mean=0.1451 mb_mean=0.5015 norm_overlap=0.9709 corr_cb=-0.5031
[EPOCH 050/089] train: loss=0.5125 acc=76.38% | val: loss=0.5597 acc=68.67% f1=75.47% auc=78.49% val_score=54.7166 val_score_bestthr=66.6295 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.145, mb=0.501, no=0.971, corr=-0.503) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7273 -> 66.6295
[DBG][ep=051] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.1354 mb_mean=0.5035 norm_overlap=0.9670 corr_cb=-0.5638 topkJ=0.0008
[TRAIN][ep=051] loss=0.5159 acc=75.84%
[TRAIN][ep=051] mask_avg: mc_mean=0.1451 mb_mean=0.5015 norm_overlap=0.9710 corr_cb=-0.5023
[EPOCH 051/089] train: loss=0.5159 acc=75.84% | val: loss=0.5598 acc=68.67% f1=75.47% auc=78.60% val_score=54.7166 val_score_bestthr=66.6295 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.145, mb=0.501, no=0.971, corr=-0.502) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7273 -> 66.6295
[DBG][ep=052] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.1657 mb_mean=0.4999 norm_overlap=0.9702 corr_cb=-0.5274 topkJ=0.0008
[TRAIN][ep=052] loss=0.5106 acc=76.51%
[TRAIN][ep=052] mask_avg: mc_mean=0.1452 mb_mean=0.5014 norm_overlap=0.9709 corr_cb=-0.5034
[EPOCH 052/089] train: loss=0.5106 acc=76.51% | val: loss=0.5444 acc=75.90% f1=72.97% auc=78.84% val_score=64.1539 val_score_bestthr=66.5560 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.145, mb=0.501, no=0.971, corr=-0.503) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7273 -> 66.5560
[DBG][ep=053] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.1273 mb_mean=0.5085 norm_overlap=0.9577 corr_cb=-0.5115 topkJ=0.0000
[TRAIN][ep=053] loss=0.5133 acc=77.32%
[TRAIN][ep=053] mask_avg: mc_mean=0.1451 mb_mean=0.5015 norm_overlap=0.9709 corr_cb=-0.5037
[EPOCH 053/089] train: loss=0.5133 acc=77.32% | val: loss=0.5444 acc=75.90% f1=72.97% auc=78.66% val_score=64.1539 val_score_bestthr=66.5560 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.145, mb=0.501, no=0.971, corr=-0.504) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7273 -> 66.5560
[DBG][ep=054] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=054] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=054] mask(step0): mc_mean=0.1401 mb_mean=0.5047 norm_overlap=0.9661 corr_cb=-0.5045 topkJ=0.0000
[TRAIN][ep=054] loss=0.5127 acc=75.97%
[TRAIN][ep=054] mask_avg: mc_mean=0.1452 mb_mean=0.5014 norm_overlap=0.9709 corr_cb=-0.5044
[EPOCH 054/089] train: loss=0.5127 acc=75.97% | val: loss=0.5505 acc=75.90% f1=72.97% auc=78.84% val_score=66.5560 val_score_bestthr=66.5560 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.145, mb=0.501, no=0.971, corr=-0.504) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7273 -> 66.5560
[DBG][ep=055] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=055] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=055] mask(step0): mc_mean=0.1422 mb_mean=0.5009 norm_overlap=0.9718 corr_cb=-0.5715 topkJ=0.0000
[TRAIN][ep=055] loss=0.5097 acc=76.51%
[TRAIN][ep=055] mask_avg: mc_mean=0.1452 mb_mean=0.5014 norm_overlap=0.9710 corr_cb=-0.5015
[EPOCH 055/089] train: loss=0.5097 acc=76.51% | val: loss=0.5552 acc=68.67% f1=75.47% auc=78.72% val_score=59.8023 val_score_bestthr=66.6295 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.145, mb=0.501, no=0.971, corr=-0.502) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7273 -> 66.6295
[DBG][ep=056] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=056] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=056] mask(step0): mc_mean=0.1493 mb_mean=0.5009 norm_overlap=0.9710 corr_cb=-0.5228 topkJ=0.0000
[TRAIN][ep=056] loss=0.5106 acc=76.38%
[TRAIN][ep=056] mask_avg: mc_mean=0.1451 mb_mean=0.5014 norm_overlap=0.9709 corr_cb=-0.5051
[EPOCH 056/089] train: loss=0.5106 acc=76.38% | val: loss=0.5553 acc=68.67% f1=75.47% auc=78.78% val_score=50.3899 val_score_bestthr=66.6295 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.145, mb=0.501, no=0.971, corr=-0.505) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7273 -> 66.6295
[DBG][ep=057] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=057] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=057] mask(step0): mc_mean=0.1816 mb_mean=0.4930 norm_overlap=0.9828 corr_cb=-0.4685 topkJ=0.0061
[TRAIN][ep=057] loss=0.5126 acc=76.91%
[TRAIN][ep=057] mask_avg: mc_mean=0.1451 mb_mean=0.5014 norm_overlap=0.9708 corr_cb=-0.5049
[EPOCH 057/089] train: loss=0.5126 acc=76.91% | val: loss=0.5620 acc=69.88% f1=76.19% auc=78.60% val_score=54.7166 val_score_bestthr=68.7103 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.145, mb=0.501, no=0.971, corr=-0.505) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7273 -> 68.7103
[DBG][ep=058] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=058] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=058] mask(step0): mc_mean=0.1667 mb_mean=0.5023 norm_overlap=0.9677 corr_cb=-0.4873 topkJ=0.0000
[TRAIN][ep=058] loss=0.5121 acc=77.32%
[TRAIN][ep=058] mask_avg: mc_mean=0.1452 mb_mean=0.5014 norm_overlap=0.9711 corr_cb=-0.5030
[EPOCH 058/089] train: loss=0.5121 acc=77.32% | val: loss=0.5483 acc=72.29% f1=72.94% auc=78.95% val_score=66.5560 val_score_bestthr=68.5320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.145, mb=0.501, no=0.971, corr=-0.503) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7273 -> 68.5320
[DBG][ep=059] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=059] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=059] mask(step0): mc_mean=0.1440 mb_mean=0.5009 norm_overlap=0.9718 corr_cb=-0.4982 topkJ=0.0016
[TRAIN][ep=059] loss=0.5095 acc=76.24%
[TRAIN][ep=059] mask_avg: mc_mean=0.1451 mb_mean=0.5014 norm_overlap=0.9709 corr_cb=-0.5046
[EPOCH 059/089] train: loss=0.5095 acc=76.24% | val: loss=0.5465 acc=72.29% f1=72.94% auc=79.07% val_score=66.5560 val_score_bestthr=68.5320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.145, mb=0.501, no=0.971, corr=-0.505) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7273 -> 68.5320
[DBG][ep=060] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=060] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=060] mask(step0): mc_mean=0.1390 mb_mean=0.5029 norm_overlap=0.9702 corr_cb=-0.4828 topkJ=0.0008
[TRAIN][ep=060] loss=0.5094 acc=76.78%
[TRAIN][ep=060] mask_avg: mc_mean=0.1451 mb_mean=0.5015 norm_overlap=0.9708 corr_cb=-0.5039
[EPOCH 060/089] train: loss=0.5094 acc=76.78% | val: loss=0.5416 acc=73.49% f1=73.81% auc=79.07% val_score=64.1539 val_score_bestthr=69.8671 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.145, mb=0.501, no=0.971, corr=-0.504) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7273 -> 69.8671
[DBG][ep=061] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=061] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=061] mask(step0): mc_mean=0.2086 mb_mean=0.4912 norm_overlap=0.9818 corr_cb=-0.4495 topkJ=0.0004
[TRAIN][ep=061] loss=0.5057 acc=75.44%
[TRAIN][ep=061] mask_avg: mc_mean=0.1451 mb_mean=0.5014 norm_overlap=0.9710 corr_cb=-0.5032
[EPOCH 061/089] train: loss=0.5057 acc=75.44% | val: loss=0.5485 acc=73.49% f1=73.81% auc=79.13% val_score=59.8023 val_score_bestthr=69.8671 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.145, mb=0.501, no=0.971, corr=-0.503) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7273 -> 69.8671
[DBG][ep=062] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=062] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=062] mask(step0): mc_mean=0.1218 mb_mean=0.5065 norm_overlap=0.9671 corr_cb=-0.5440 topkJ=0.0000
[TRAIN][ep=062] loss=0.5109 acc=76.78%
[TRAIN][ep=062] mask_avg: mc_mean=0.1452 mb_mean=0.5014 norm_overlap=0.9711 corr_cb=-0.5044
[EPOCH 062/089] train: loss=0.5109 acc=76.78% | val: loss=0.5471 acc=73.49% f1=73.81% auc=79.24% val_score=59.8023 val_score_bestthr=69.8671 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.145, mb=0.501, no=0.971, corr=-0.504) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7273 -> 69.8671
[DBG][ep=063] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=063] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=063] mask(step0): mc_mean=0.1525 mb_mean=0.4998 norm_overlap=0.9767 corr_cb=-0.4748 topkJ=0.0016
[TRAIN][ep=063] loss=0.5068 acc=75.70%
[TRAIN][ep=063] mask_avg: mc_mean=0.1451 mb_mean=0.5014 norm_overlap=0.9709 corr_cb=-0.5037
[EPOCH 063/089] train: loss=0.5068 acc=75.70% | val: loss=0.5456 acc=73.49% f1=73.81% auc=79.24% val_score=60.9269 val_score_bestthr=69.8671 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.145, mb=0.501, no=0.971, corr=-0.504) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7273 -> 69.8671
[DBG][ep=064] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=064] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=064] mask(step0): mc_mean=0.1620 mb_mean=0.4966 norm_overlap=0.9801 corr_cb=-0.4831 topkJ=0.0023
[TRAIN][ep=064] loss=0.5066 acc=76.64%
[TRAIN][ep=064] mask_avg: mc_mean=0.1452 mb_mean=0.5014 norm_overlap=0.9709 corr_cb=-0.5030
[EPOCH 064/089] train: loss=0.5066 acc=76.64% | val: loss=0.5464 acc=69.88% f1=76.19% auc=79.24% val_score=59.8023 val_score_bestthr=68.7103 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.145, mb=0.501, no=0.971, corr=-0.503) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7273 -> 68.7103
[DBG][ep=065] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=065] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=065] mask(step0): mc_mean=0.1326 mb_mean=0.5017 norm_overlap=0.9679 corr_cb=-0.5317 topkJ=0.0000
[TRAIN][ep=065] loss=0.5040 acc=76.78%
[TRAIN][ep=065] mask_avg: mc_mean=0.1451 mb_mean=0.5015 norm_overlap=0.9710 corr_cb=-0.5035
[EPOCH 065/089] train: loss=0.5040 acc=76.78% | val: loss=0.5466 acc=73.49% f1=73.81% auc=79.19% val_score=59.8023 val_score_bestthr=69.8671 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.145, mb=0.501, no=0.971, corr=-0.503) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7273 -> 69.8671
[DBG][ep=066] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=066] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=066] mask(step0): mc_mean=0.1543 mb_mean=0.5007 norm_overlap=0.9751 corr_cb=-0.5108 topkJ=0.0012
[TRAIN][ep=066] loss=0.5058 acc=75.30%
[TRAIN][ep=066] mask_avg: mc_mean=0.1451 mb_mean=0.5015 norm_overlap=0.9708 corr_cb=-0.5047
[EPOCH 066/089] train: loss=0.5058 acc=75.30% | val: loss=0.5486 acc=73.49% f1=73.81% auc=79.30% val_score=59.8023 val_score_bestthr=69.8671 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.145, mb=0.501, no=0.971, corr=-0.505) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7273 -> 69.8671
[DBG][ep=067] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=067] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=067] mask(step0): mc_mean=0.1334 mb_mean=0.5058 norm_overlap=0.9585 corr_cb=-0.5334 topkJ=0.0000
[TRAIN][ep=067] loss=0.5019 acc=77.32%
[TRAIN][ep=067] mask_avg: mc_mean=0.1452 mb_mean=0.5014 norm_overlap=0.9709 corr_cb=-0.5047
[EPOCH 067/089] train: loss=0.5019 acc=77.32% | val: loss=0.5378 acc=74.70% f1=74.70% auc=79.65% val_score=64.1539 val_score_bestthr=71.0024 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.145, mb=0.501, no=0.971, corr=-0.505) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7273 -> 71.0024
[DBG][ep=068] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=068] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=068] mask(step0): mc_mean=0.1391 mb_mean=0.5032 norm_overlap=0.9720 corr_cb=-0.4938 topkJ=0.0043
[TRAIN][ep=068] loss=0.5059 acc=76.91%
[TRAIN][ep=068] mask_avg: mc_mean=0.1452 mb_mean=0.5014 norm_overlap=0.9710 corr_cb=-0.5037
[EPOCH 068/089] train: loss=0.5059 acc=76.91% | val: loss=0.5489 acc=69.88% f1=76.19% auc=79.19% val_score=59.8023 val_score_bestthr=68.7103 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.145, mb=0.501, no=0.971, corr=-0.504) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7273 -> 68.7103
[DBG][ep=069] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=069] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=069] mask(step0): mc_mean=0.1519 mb_mean=0.5002 norm_overlap=0.9700 corr_cb=-0.5590 topkJ=0.0000
[TRAIN][ep=069] loss=0.5064 acc=77.18%
[TRAIN][ep=069] mask_avg: mc_mean=0.1451 mb_mean=0.5014 norm_overlap=0.9709 corr_cb=-0.5039
[EPOCH 069/089] train: loss=0.5064 acc=77.18% | val: loss=0.5450 acc=73.49% f1=73.81% auc=79.30% val_score=59.8023 val_score_bestthr=69.8671 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.145, mb=0.501, no=0.971, corr=-0.504) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7273 -> 69.8671
[DBG][ep=070] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=070] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=070] mask(step0): mc_mean=0.1554 mb_mean=0.4982 norm_overlap=0.9778 corr_cb=-0.4909 topkJ=0.0000
[TRAIN][ep=070] loss=0.5014 acc=76.11%
[TRAIN][ep=070] mask_avg: mc_mean=0.1451 mb_mean=0.5014 norm_overlap=0.9709 corr_cb=-0.5035
[EPOCH 070/089] train: loss=0.5014 acc=76.11% | val: loss=0.5384 acc=74.70% f1=74.70% auc=79.83% val_score=60.7710 val_score_bestthr=71.0024 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.145, mb=0.501, no=0.971, corr=-0.504) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7273 -> 71.0024
[EARLY STOP] no improvement for 30 epochs. best_epoch=40
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
=============== FIT DONE ===============
[BEST] epoch=40 | val_acc=78.31% | val_f1=75.68% | val_auc=77.91% | val_score=49.4711 | val_score_bestthr=72.7273
[TEST@BEST] thr_used=0.460 | acc=59.90% f1=68.68% auc=62.12% | SP_sex=3.84% EO_sex=4.42% SP_age=10.29% EO_age=14.18%
[TIME] 1.62 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/summary_fold_0.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4752 mb_mean=0.5091 norm_overlap=0.9996 corr_cb=-0.4004 topkJ=0.0039
[TRAIN][ep=000] loss=0.6933 acc=51.14%
[TRAIN][ep=000] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1325
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4782 mb_mean=0.5028 norm_overlap=0.9999 corr_cb=-0.0933 topkJ=0.0031
[TRAIN][ep=001] loss=0.6926 acc=51.81%
[TRAIN][ep=001] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1283
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4776 mb_mean=0.5098 norm_overlap=0.9997 corr_cb=-0.3755 topkJ=0.0024
[TRAIN][ep=002] loss=0.6911 acc=52.21%
[TRAIN][ep=002] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1407
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4785 mb_mean=0.5037 norm_overlap=1.0000 corr_cb=0.0262 topkJ=0.0152
[TRAIN][ep=003] loss=0.6899 acc=56.51%
[TRAIN][ep=003] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1330
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4760 mb_mean=0.5053 norm_overlap=0.9998 corr_cb=-0.2618 topkJ=0.0459
[TRAIN][ep=004] loss=0.6890 acc=56.38%
[TRAIN][ep=004] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1247
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4794 mb_mean=0.5002 norm_overlap=0.9999 corr_cb=-0.2006 topkJ=0.0064
[TRAIN][ep=005] loss=0.6885 acc=53.96%
[TRAIN][ep=005] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1272
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4760 mb_mean=0.5040 norm_overlap=0.9997 corr_cb=-0.4011 topkJ=0.0113
[TRAIN][ep=006] loss=0.6861 acc=56.24%
[TRAIN][ep=006] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1302
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4758 mb_mean=0.5023 norm_overlap=0.9998 corr_cb=-0.2950 topkJ=0.0024
[TRAIN][ep=007] loss=0.6818 acc=57.58%
[TRAIN][ep=007] mask_avg: mc_mean=0.4785 mb_mean=0.5015 norm_overlap=0.9999 corr_cb=-0.1365
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4784 mb_mean=0.4987 norm_overlap=0.9997 corr_cb=-0.3532 topkJ=0.0048
[TRAIN][ep=008] loss=0.6793 acc=62.01%
[TRAIN][ep=008] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1238
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4781 mb_mean=0.5042 norm_overlap=0.9998 corr_cb=-0.2975 topkJ=0.0188
[TRAIN][ep=009] loss=0.6738 acc=61.21%
[TRAIN][ep=009] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1254
================= FIT START (fold=0) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4787 mb_mean=0.5043 norm_overlap=0.9999 corr_cb=-0.0822 topkJ=0.0502
[TRAIN][ep=000] loss=0.6723 acc=63.09%
[TRAIN][ep=000] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1201
[EPOCH 000/089] train: loss=0.6723 acc=63.09% | val: loss=0.6708 acc=63.86% f1=70.00% auc=69.42% val_score=48.0273 val_score_bestthr=61.6560 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.120) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 61.6560
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4793 mb_mean=0.5022 norm_overlap=0.9998 corr_cb=-0.2365 topkJ=0.0024
[TRAIN][ep=001] loss=0.6679 acc=63.22%
[TRAIN][ep=001] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1274
[EPOCH 001/089] train: loss=0.6679 acc=63.22% | val: loss=0.6737 acc=61.45% f1=72.41% auc=66.57% val_score=45.5113 val_score_bestthr=64.7777 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.127) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 61.6560 -> 64.7777
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4774 mb_mean=0.4982 norm_overlap=1.0000 corr_cb=-0.0324 topkJ=0.0252
[TRAIN][ep=002] loss=0.6644 acc=62.55%
[TRAIN][ep=002] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1182
[EPOCH 002/089] train: loss=0.6644 acc=62.55% | val: loss=0.6647 acc=66.27% f1=73.08% auc=69.48% val_score=43.8599 val_score_bestthr=63.3994 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.118) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.7777 -> 63.3994
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4776 mb_mean=0.5075 norm_overlap=0.9998 corr_cb=-0.2177 topkJ=0.0023
[TRAIN][ep=003] loss=0.6601 acc=63.36%
[TRAIN][ep=003] mask_avg: mc_mean=0.4785 mb_mean=0.5015 norm_overlap=0.9999 corr_cb=-0.1255
[EPOCH 003/089] train: loss=0.6601 acc=63.36% | val: loss=0.6671 acc=61.45% f1=72.41% auc=67.97% val_score=49.7410 val_score_bestthr=64.7777 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.125) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.7777 -> 64.7777
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4824 mb_mean=0.4950 norm_overlap=0.9998 corr_cb=-0.2211 topkJ=0.0294
[TRAIN][ep=004] loss=0.6627 acc=60.94%
[TRAIN][ep=004] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1284
[EPOCH 004/089] train: loss=0.6627 acc=60.94% | val: loss=0.6584 acc=61.45% f1=72.41% auc=70.12% val_score=44.0606 val_score_bestthr=64.7777 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.128) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.7777 -> 64.7777
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4744 mb_mean=0.5047 norm_overlap=0.9999 corr_cb=-0.0747 topkJ=0.0278
[TRAIN][ep=005] loss=1.4287 acc=64.03%
[TRAIN][ep=005] mask_avg: mc_mean=0.3511 mb_mean=0.5014 norm_overlap=0.9963 corr_cb=-0.6428
[EPOCH 005/089] train: loss=1.4287 acc=64.03% | val: loss=0.6608 acc=57.83% f1=70.59% auc=73.20% val_score=62.4643 val_score_bestthr=61.6301 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.351, mb=0.501, no=0.996, corr=-0.643) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.7777 -> 61.6301
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2060 mb_mean=0.5118 norm_overlap=0.9870 corr_cb=-0.7971 topkJ=0.0000
[TRAIN][ep=006] loss=1.4137 acc=64.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.1980 mb_mean=0.5014 norm_overlap=0.9890 corr_cb=-0.7162
[EPOCH 006/089] train: loss=1.4137 acc=64.70% | val: loss=0.6498 acc=67.47% f1=74.29% auc=74.24% val_score=60.2695 val_score_bestthr=63.2489 | dyn(w_pfs=0.240, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.198, mb=0.501, no=0.989, corr=-0.716) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.7777 -> 63.2489
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.1589 mb_mean=0.5024 norm_overlap=0.9846 corr_cb=-0.7890 topkJ=0.0000
[TRAIN][ep=007] loss=1.2002 acc=62.15%
[TRAIN][ep=007] mask_avg: mc_mean=0.1331 mb_mean=0.5014 norm_overlap=0.9826 corr_cb=-0.7238
[EPOCH 007/089] train: loss=1.2002 acc=62.15% | val: loss=0.6445 acc=69.88% f1=76.19% auc=74.83% val_score=63.0099 val_score_bestthr=64.5831 | dyn(w_pfs=0.140, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.133, mb=0.501, no=0.983, corr=-0.724) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.7777 -> 64.5831
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1201 mb_mean=0.5001 norm_overlap=0.9768 corr_cb=-0.7765 topkJ=0.0000
[TRAIN][ep=008] loss=0.9719 acc=65.37%
[TRAIN][ep=008] mask_avg: mc_mean=0.0921 mb_mean=0.5014 norm_overlap=0.9763 corr_cb=-0.6887
[EPOCH 008/089] train: loss=0.9719 acc=65.37% | val: loss=0.6411 acc=71.08% f1=76.92% auc=72.73% val_score=45.3952 val_score_bestthr=66.2022 | dyn(w_pfs=0.180, w_sup=0.090, w_csuf=0.040, stage2=False) | mask(mc=0.092, mb=0.501, no=0.976, corr=-0.689) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 64.7777 -> 66.2022
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.0714 mb_mean=0.5043 norm_overlap=0.9747 corr_cb=-0.7015 topkJ=0.0000
[TRAIN][ep=009] loss=1.0399 acc=67.52%
[TRAIN][ep=009] mask_avg: mc_mean=0.0825 mb_mean=0.5014 norm_overlap=0.9726 corr_cb=-0.6595
[EPOCH 009/089] train: loss=1.0399 acc=67.52% | val: loss=0.6314 acc=69.88% f1=76.19% auc=73.49% val_score=49.3521 val_score_bestthr=64.5831 | dyn(w_pfs=0.220, w_sup=0.130, w_csuf=0.080, stage2=False) | mask(mc=0.083, mb=0.501, no=0.973, corr=-0.659) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.2022 -> 64.5831
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.0978 mb_mean=0.4997 norm_overlap=0.9638 corr_cb=-0.7114 topkJ=0.0000
[TRAIN][ep=010] loss=1.1191 acc=67.11%
[TRAIN][ep=010] mask_avg: mc_mean=0.0816 mb_mean=0.5015 norm_overlap=0.9698 corr_cb=-0.6296
[EPOCH 010/089] train: loss=1.1191 acc=67.11% | val: loss=0.6381 acc=67.47% f1=73.79% auc=71.69% val_score=51.0293 val_score_bestthr=64.9136 | dyn(w_pfs=0.260, w_sup=0.170, w_csuf=0.120, stage2=False) | mask(mc=0.082, mb=0.501, no=0.970, corr=-0.630) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.2022 -> 64.9136
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1035 mb_mean=0.5016 norm_overlap=0.9563 corr_cb=-0.6759 topkJ=0.0000
[TRAIN][ep=011] loss=1.1923 acc=68.99%
[TRAIN][ep=011] mask_avg: mc_mean=0.0748 mb_mean=0.5015 norm_overlap=0.9667 corr_cb=-0.6005
[EPOCH 011/089] train: loss=1.1923 acc=68.99% | val: loss=0.6196 acc=69.88% f1=76.19% auc=74.13% val_score=49.9869 val_score_bestthr=64.5831 | dyn(w_pfs=0.060, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.075, mb=0.501, no=0.967, corr=-0.600) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.2022 -> 64.5831
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.0460 mb_mean=0.5072 norm_overlap=0.9650 corr_cb=-0.5649 topkJ=0.0000
[TRAIN][ep=012] loss=0.8970 acc=67.52%
[TRAIN][ep=012] mask_avg: mc_mean=0.0789 mb_mean=0.5014 norm_overlap=0.9662 corr_cb=-0.5877
[EPOCH 012/089] train: loss=0.8970 acc=67.52% | val: loss=0.6291 acc=66.27% f1=74.07% auc=72.44% val_score=54.8864 val_score_bestthr=61.8070 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.079, mb=0.501, no=0.966, corr=-0.588) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.2022 -> 61.8070
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.0490 mb_mean=0.5080 norm_overlap=0.9589 corr_cb=-0.4314 topkJ=0.0000
[TRAIN][ep=013] loss=0.8680 acc=66.98%
[TRAIN][ep=013] mask_avg: mc_mean=0.0713 mb_mean=0.5015 norm_overlap=0.9636 corr_cb=-0.5665
[EPOCH 013/089] train: loss=0.8680 acc=66.98% | val: loss=0.6142 acc=67.47% f1=73.79% auc=74.13% val_score=57.2775 val_score_bestthr=64.0005 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.071, mb=0.501, no=0.964, corr=-0.566) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.2022 -> 64.0005
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.0851 mb_mean=0.4973 norm_overlap=0.9751 corr_cb=-0.5146 topkJ=0.0024
[TRAIN][ep=014] loss=0.8618 acc=69.13%
[TRAIN][ep=014] mask_avg: mc_mean=0.0760 mb_mean=0.5014 norm_overlap=0.9637 corr_cb=-0.5638
[EPOCH 014/089] train: loss=0.8618 acc=69.13% | val: loss=0.6056 acc=66.27% f1=74.07% auc=74.53% val_score=48.4681 val_score_bestthr=61.8070 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.076, mb=0.501, no=0.964, corr=-0.564) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.2022 -> 61.8070
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.0557 mb_mean=0.5043 norm_overlap=0.9631 corr_cb=-0.4960 topkJ=0.0000
[TRAIN][ep=015] loss=0.8506 acc=70.07%
[TRAIN][ep=015] mask_avg: mc_mean=0.0884 mb_mean=0.5014 norm_overlap=0.9654 corr_cb=-0.5696
[EPOCH 015/089] train: loss=0.8506 acc=70.07% | val: loss=0.6004 acc=69.88% f1=61.54% auc=75.00% val_score=56.0574 val_score_bestthr=62.9011 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.088, mb=0.501, no=0.965, corr=-0.570) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.2022 -> 62.9011
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.0550 mb_mean=0.5102 norm_overlap=0.9517 corr_cb=-0.5738 topkJ=0.0000
[TRAIN][ep=016] loss=0.8549 acc=69.26%
[TRAIN][ep=016] mask_avg: mc_mean=0.0736 mb_mean=0.5014 norm_overlap=0.9622 corr_cb=-0.5390
[EPOCH 016/089] train: loss=0.8549 acc=69.26% | val: loss=0.6011 acc=68.67% f1=75.00% auc=75.17% val_score=50.8738 val_score_bestthr=63.8253 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.074, mb=0.501, no=0.962, corr=-0.539) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.2022 -> 63.8253
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.0899 mb_mean=0.4927 norm_overlap=0.9776 corr_cb=-0.4612 topkJ=0.0012
[TRAIN][ep=017] loss=0.8447 acc=70.07%
[TRAIN][ep=017] mask_avg: mc_mean=0.0744 mb_mean=0.5014 norm_overlap=0.9622 corr_cb=-0.5374
[EPOCH 017/089] train: loss=0.8447 acc=70.07% | val: loss=0.6048 acc=71.08% f1=64.71% auc=74.77% val_score=58.3731 val_score_bestthr=66.1865 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.074, mb=0.501, no=0.962, corr=-0.537) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.2022 -> 66.1865
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.0802 mb_mean=0.5052 norm_overlap=0.9571 corr_cb=-0.5778 topkJ=0.0000
[TRAIN][ep=018] loss=0.8368 acc=71.01%
[TRAIN][ep=018] mask_avg: mc_mean=0.0976 mb_mean=0.5014 norm_overlap=0.9656 corr_cb=-0.5558
[EPOCH 018/089] train: loss=0.8368 acc=71.01% | val: loss=0.6519 acc=61.45% f1=71.43% auc=72.97% val_score=51.4761 val_score_bestthr=61.2905 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.098, mb=0.501, no=0.966, corr=-0.556) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.2022 -> 61.2905
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.0652 mb_mean=0.4998 norm_overlap=0.9621 corr_cb=-0.5173 topkJ=0.0000
[TRAIN][ep=019] loss=0.8570 acc=67.25%
[TRAIN][ep=019] mask_avg: mc_mean=0.0614 mb_mean=0.5014 norm_overlap=0.9590 corr_cb=-0.5060
[EPOCH 019/089] train: loss=0.8570 acc=67.25% | val: loss=0.6071 acc=72.29% f1=65.67% auc=74.83% val_score=65.0876 val_score_bestthr=68.9564 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.061, mb=0.501, no=0.959, corr=-0.506) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 66.2022 -> 68.9564
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1050 mb_mean=0.4956 norm_overlap=0.9594 corr_cb=-0.5989 topkJ=0.0000
[TRAIN][ep=020] loss=0.8358 acc=70.20%
[TRAIN][ep=020] mask_avg: mc_mean=0.0652 mb_mean=0.5014 norm_overlap=0.9596 corr_cb=-0.5146
[EPOCH 020/089] train: loss=0.8358 acc=70.20% | val: loss=0.6034 acc=73.49% f1=67.65% auc=75.23% val_score=65.0876 val_score_bestthr=67.8597 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.065, mb=0.501, no=0.960, corr=-0.515) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.9564 -> 67.8597
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.0620 mb_mean=0.5057 norm_overlap=0.9509 corr_cb=-0.4931 topkJ=0.0000
[TRAIN][ep=021] loss=0.8228 acc=72.35%
[TRAIN][ep=021] mask_avg: mc_mean=0.0905 mb_mean=0.5014 norm_overlap=0.9638 corr_cb=-0.5462
[EPOCH 021/089] train: loss=0.8228 acc=72.35% | val: loss=0.5976 acc=74.70% f1=69.57% auc=75.76% val_score=68.2907 val_score_bestthr=68.2907 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.090, mb=0.501, no=0.964, corr=-0.546) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.9564 -> 68.2907
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1207 mb_mean=0.4985 norm_overlap=0.9696 corr_cb=-0.5111 topkJ=0.0008
[TRAIN][ep=022] loss=0.9116 acc=71.68%
[TRAIN][ep=022] mask_avg: mc_mean=0.0933 mb_mean=0.5014 norm_overlap=0.9642 corr_cb=-0.5462
[EPOCH 022/089] train: loss=0.9116 acc=71.68% | val: loss=0.5763 acc=65.06% f1=74.78% auc=76.57% val_score=55.3754 val_score_bestthr=70.3791 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.093, mb=0.501, no=0.964, corr=-0.546) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 68.9564 -> 70.3791
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.0639 mb_mean=0.5003 norm_overlap=0.9592 corr_cb=-0.5036 topkJ=0.0000
[TRAIN][ep=023] loss=0.9998 acc=71.81%
[TRAIN][ep=023] mask_avg: mc_mean=0.0635 mb_mean=0.5015 norm_overlap=0.9586 corr_cb=-0.5023
[EPOCH 023/089] train: loss=0.9998 acc=71.81% | val: loss=0.5719 acc=73.49% f1=68.57% auc=77.33% val_score=55.5704 val_score_bestthr=65.9223 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.063, mb=0.501, no=0.959, corr=-0.502) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.3791 -> 65.9223
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.0686 mb_mean=0.5001 norm_overlap=0.9655 corr_cb=-0.4226 topkJ=0.0012
[TRAIN][ep=024] loss=0.8055 acc=73.83%
[TRAIN][ep=024] mask_avg: mc_mean=0.0744 mb_mean=0.5014 norm_overlap=0.9608 corr_cb=-0.5159
[EPOCH 024/089] train: loss=0.8055 acc=73.83% | val: loss=0.5711 acc=75.90% f1=71.43% auc=76.69% val_score=55.2438 val_score_bestthr=66.9956 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.074, mb=0.501, no=0.961, corr=-0.516) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.3791 -> 66.9956
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.0764 mb_mean=0.5013 norm_overlap=0.9619 corr_cb=-0.5636 topkJ=0.0000
[TRAIN][ep=025] loss=0.8250 acc=71.41%
[TRAIN][ep=025] mask_avg: mc_mean=0.0626 mb_mean=0.5014 norm_overlap=0.9581 corr_cb=-0.4929
[EPOCH 025/089] train: loss=0.8250 acc=71.41% | val: loss=0.5812 acc=63.86% f1=72.73% auc=76.45% val_score=64.1793 val_score_bestthr=65.6051 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.063, mb=0.501, no=0.958, corr=-0.493) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.3791 -> 65.6051
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.0515 mb_mean=0.5025 norm_overlap=0.9550 corr_cb=-0.5284 topkJ=0.0000
[TRAIN][ep=026] loss=0.8022 acc=72.89%
[TRAIN][ep=026] mask_avg: mc_mean=0.0736 mb_mean=0.5014 norm_overlap=0.9603 corr_cb=-0.5161
[EPOCH 026/089] train: loss=0.8022 acc=72.89% | val: loss=0.5693 acc=75.90% f1=72.97% auc=77.03% val_score=50.3087 val_score_bestthr=69.7099 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.074, mb=0.501, no=0.960, corr=-0.516) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.3791 -> 69.7099
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.0869 mb_mean=0.5001 norm_overlap=0.9560 corr_cb=-0.5867 topkJ=0.0000
[TRAIN][ep=027] loss=0.7979 acc=73.83%
[TRAIN][ep=027] mask_avg: mc_mean=0.0858 mb_mean=0.5014 norm_overlap=0.9623 corr_cb=-0.5322
[EPOCH 027/089] train: loss=0.7979 acc=73.83% | val: loss=0.6112 acc=63.86% f1=73.21% auc=75.41% val_score=58.7307 val_score_bestthr=64.5888 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.086, mb=0.501, no=0.962, corr=-0.532) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.3791 -> 64.5888
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.0981 mb_mean=0.4951 norm_overlap=0.9751 corr_cb=-0.4607 topkJ=0.0000
[TRAIN][ep=028] loss=0.8034 acc=73.15%
[TRAIN][ep=028] mask_avg: mc_mean=0.0834 mb_mean=0.5015 norm_overlap=0.9618 corr_cb=-0.5256
[EPOCH 028/089] train: loss=0.8034 acc=73.15% | val: loss=0.5688 acc=75.90% f1=72.22% auc=76.80% val_score=66.6919 val_score_bestthr=66.6919 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.083, mb=0.501, no=0.962, corr=-0.526) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.3791 -> 66.6919
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.0853 mb_mean=0.4980 norm_overlap=0.9650 corr_cb=-0.5082 topkJ=0.0000
[TRAIN][ep=029] loss=0.7901 acc=74.77%
[TRAIN][ep=029] mask_avg: mc_mean=0.0742 mb_mean=0.5015 norm_overlap=0.9601 corr_cb=-0.5145
[EPOCH 029/089] train: loss=0.7901 acc=74.77% | val: loss=0.6018 acc=77.11% f1=73.97% auc=78.43% val_score=59.5399 val_score_bestthr=72.4849 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.074, mb=0.501, no=0.960, corr=-0.514) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 70.3791 -> 72.4849
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.1066 mb_mean=0.4961 norm_overlap=0.9716 corr_cb=-0.5477 topkJ=0.0000
[TRAIN][ep=030] loss=0.7986 acc=72.08%
[TRAIN][ep=030] mask_avg: mc_mean=0.0732 mb_mean=0.5015 norm_overlap=0.9596 corr_cb=-0.5117
[EPOCH 030/089] train: loss=0.7986 acc=72.08% | val: loss=0.5680 acc=66.27% f1=74.55% auc=78.20% val_score=60.8080 val_score_bestthr=66.2452 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.073, mb=0.501, no=0.960, corr=-0.512) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.4849 -> 66.2452
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.0654 mb_mean=0.5019 norm_overlap=0.9618 corr_cb=-0.5119 topkJ=0.0000
[TRAIN][ep=031] loss=0.7765 acc=76.24%
[TRAIN][ep=031] mask_avg: mc_mean=0.0826 mb_mean=0.5015 norm_overlap=0.9612 corr_cb=-0.5271
[EPOCH 031/089] train: loss=0.7765 acc=76.24% | val: loss=0.5647 acc=74.70% f1=72.73% auc=77.38% val_score=62.3946 val_score_bestthr=66.1924 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.083, mb=0.501, no=0.961, corr=-0.527) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.4849 -> 66.1924
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.0825 mb_mean=0.4988 norm_overlap=0.9618 corr_cb=-0.5821 topkJ=0.0000
[TRAIN][ep=032] loss=0.8656 acc=74.77%
[TRAIN][ep=032] mask_avg: mc_mean=0.0888 mb_mean=0.5014 norm_overlap=0.9625 corr_cb=-0.5295
[EPOCH 032/089] train: loss=0.8656 acc=74.77% | val: loss=0.5466 acc=75.90% f1=73.68% auc=78.78% val_score=65.6993 val_score_bestthr=70.5496 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.089, mb=0.501, no=0.963, corr=-0.529) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.4849 -> 70.5496
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1031 mb_mean=0.4952 norm_overlap=0.9733 corr_cb=-0.5111 topkJ=0.0012
[TRAIN][ep=033] loss=0.9415 acc=74.63%
[TRAIN][ep=033] mask_avg: mc_mean=0.0753 mb_mean=0.5014 norm_overlap=0.9603 corr_cb=-0.5062
[EPOCH 033/089] train: loss=0.9415 acc=74.63% | val: loss=0.5830 acc=74.70% f1=73.42% auc=76.74% val_score=56.2778 val_score_bestthr=66.9167 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.075, mb=0.501, no=0.960, corr=-0.506) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.4849 -> 66.9167
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.0975 mb_mean=0.5028 norm_overlap=0.9611 corr_cb=-0.5939 topkJ=0.0000
[TRAIN][ep=034] loss=0.7767 acc=75.44%
[TRAIN][ep=034] mask_avg: mc_mean=0.1000 mb_mean=0.5014 norm_overlap=0.9637 corr_cb=-0.5305
[EPOCH 034/089] train: loss=0.7767 acc=75.44% | val: loss=0.5475 acc=75.90% f1=75.00% auc=78.55% val_score=60.6272 val_score_bestthr=69.8729 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.100, mb=0.501, no=0.964, corr=-0.530) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.4849 -> 69.8729
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.0524 mb_mean=0.5037 norm_overlap=0.9600 corr_cb=-0.4668 topkJ=0.0000
[TRAIN][ep=035] loss=0.7643 acc=76.38%
[TRAIN][ep=035] mask_avg: mc_mean=0.0782 mb_mean=0.5014 norm_overlap=0.9608 corr_cb=-0.5108
[EPOCH 035/089] train: loss=0.7643 acc=76.38% | val: loss=0.5442 acc=75.90% f1=74.36% auc=79.30% val_score=68.2337 val_score_bestthr=68.2337 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.078, mb=0.501, no=0.961, corr=-0.511) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.4849 -> 68.2337
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.0879 mb_mean=0.4983 norm_overlap=0.9616 corr_cb=-0.5498 topkJ=0.0000
[TRAIN][ep=036] loss=0.7714 acc=75.70%
[TRAIN][ep=036] mask_avg: mc_mean=0.0934 mb_mean=0.5015 norm_overlap=0.9631 corr_cb=-0.5297
[EPOCH 036/089] train: loss=0.7714 acc=75.70% | val: loss=0.5433 acc=74.70% f1=74.07% auc=79.48% val_score=68.3263 val_score_bestthr=68.3263 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.093, mb=0.501, no=0.963, corr=-0.530) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.4849 -> 68.3263
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.0644 mb_mean=0.5046 norm_overlap=0.9553 corr_cb=-0.5130 topkJ=0.0000
[TRAIN][ep=037] loss=0.7609 acc=76.11%
[TRAIN][ep=037] mask_avg: mc_mean=0.0817 mb_mean=0.5014 norm_overlap=0.9613 corr_cb=-0.5140
[EPOCH 037/089] train: loss=0.7609 acc=76.11% | val: loss=0.5345 acc=69.88% f1=77.06% auc=80.58% val_score=67.3146 val_score_bestthr=73.6392 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.514) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 72.4849 -> 73.6392
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.1068 mb_mean=0.4966 norm_overlap=0.9728 corr_cb=-0.5435 topkJ=0.0000
[TRAIN][ep=038] loss=0.8499 acc=74.50%
[TRAIN][ep=038] mask_avg: mc_mean=0.0520 mb_mean=0.5014 norm_overlap=0.9549 corr_cb=-0.4567
[EPOCH 038/089] train: loss=0.8499 acc=74.50% | val: loss=0.5416 acc=75.90% f1=75.00% auc=79.30% val_score=59.1170 val_score_bestthr=69.8729 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.052, mb=0.501, no=0.955, corr=-0.457) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6392 -> 69.8729
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.0463 mb_mean=0.5081 norm_overlap=0.9469 corr_cb=-0.4864 topkJ=0.0000
[TRAIN][ep=039] loss=0.7398 acc=77.72%
[TRAIN][ep=039] mask_avg: mc_mean=0.0885 mb_mean=0.5015 norm_overlap=0.9623 corr_cb=-0.5222
[EPOCH 039/089] train: loss=0.7398 acc=77.72% | val: loss=0.5365 acc=77.11% f1=76.54% auc=80.06% val_score=74.5003 val_score_bestthr=74.5003 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.089, mb=0.501, no=0.962, corr=-0.522) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 73.6392 -> 74.5003
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.1138 mb_mean=0.5035 norm_overlap=0.9559 corr_cb=-0.6327 topkJ=0.0000
[TRAIN][ep=040] loss=0.8346 acc=77.05%
[TRAIN][ep=040] mask_avg: mc_mean=0.0872 mb_mean=0.5014 norm_overlap=0.9622 corr_cb=-0.5153
[EPOCH 040/089] train: loss=0.8346 acc=77.05% | val: loss=0.5429 acc=75.90% f1=75.61% auc=80.23% val_score=57.2334 val_score_bestthr=73.3583 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.087, mb=0.501, no=0.962, corr=-0.515) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.5003 -> 73.3583
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.1017 mb_mean=0.5010 norm_overlap=0.9581 corr_cb=-0.6043 topkJ=0.0000
[TRAIN][ep=041] loss=0.9123 acc=75.70%
[TRAIN][ep=041] mask_avg: mc_mean=0.0952 mb_mean=0.5014 norm_overlap=0.9635 corr_cb=-0.5254
[EPOCH 041/089] train: loss=0.9123 acc=75.70% | val: loss=0.5559 acc=77.11% f1=76.54% auc=80.35% val_score=55.9281 val_score_bestthr=74.5003 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.095, mb=0.501, no=0.964, corr=-0.525) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.5003 -> 74.5003
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.0984 mb_mean=0.4956 norm_overlap=0.9733 corr_cb=-0.4771 topkJ=0.0000
[TRAIN][ep=042] loss=0.9838 acc=78.52%
[TRAIN][ep=042] mask_avg: mc_mean=0.0968 mb_mean=0.5014 norm_overlap=0.9638 corr_cb=-0.5201
[EPOCH 042/089] train: loss=0.9838 acc=78.52% | val: loss=0.5300 acc=75.90% f1=75.61% auc=81.34% val_score=71.0024 val_score_bestthr=73.3583 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.097, mb=0.501, no=0.964, corr=-0.520) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.5003 -> 73.3583
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.0506 mb_mean=0.4997 norm_overlap=0.9606 corr_cb=-0.4969 topkJ=0.0000
[TRAIN][ep=043] loss=1.0720 acc=75.70%
[TRAIN][ep=043] mask_avg: mc_mean=0.0744 mb_mean=0.5014 norm_overlap=0.9602 corr_cb=-0.4930
[EPOCH 043/089] train: loss=1.0720 acc=75.70% | val: loss=0.6036 acc=72.29% f1=74.16% auc=80.99% val_score=57.8030 val_score_bestthr=70.5334 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.074, mb=0.501, no=0.960, corr=-0.493) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.5003 -> 70.5334
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.0607 mb_mean=0.5072 norm_overlap=0.9528 corr_cb=-0.5231 topkJ=0.0000
[TRAIN][ep=044] loss=0.7318 acc=77.32%
[TRAIN][ep=044] mask_avg: mc_mean=0.0850 mb_mean=0.5015 norm_overlap=0.9618 corr_cb=-0.5129
[EPOCH 044/089] train: loss=0.7318 acc=77.32% | val: loss=0.5628 acc=75.90% f1=75.61% auc=81.40% val_score=65.6222 val_score_bestthr=73.3583 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.085, mb=0.501, no=0.962, corr=-0.513) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.5003 -> 73.3583
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.0942 mb_mean=0.4984 norm_overlap=0.9637 corr_cb=-0.4661 topkJ=0.0000
[TRAIN][ep=045] loss=0.7149 acc=79.87%
[TRAIN][ep=045] mask_avg: mc_mean=0.0980 mb_mean=0.5014 norm_overlap=0.9637 corr_cb=-0.5249
[EPOCH 045/089] train: loss=0.7149 acc=79.87% | val: loss=0.5389 acc=77.11% f1=76.54% auc=81.34% val_score=61.0299 val_score_bestthr=74.5003 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.098, mb=0.501, no=0.964, corr=-0.525) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.5003 -> 74.5003
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.1217 mb_mean=0.4955 norm_overlap=0.9720 corr_cb=-0.5074 topkJ=0.0004
[TRAIN][ep=046] loss=0.7112 acc=78.39%
[TRAIN][ep=046] mask_avg: mc_mean=0.0891 mb_mean=0.5015 norm_overlap=0.9622 corr_cb=-0.5102
[EPOCH 046/089] train: loss=0.7112 acc=78.39% | val: loss=0.5806 acc=73.49% f1=75.00% auc=80.12% val_score=53.4640 val_score_bestthr=73.4262 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.089, mb=0.501, no=0.962, corr=-0.510) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.5003 -> 73.4262
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.0923 mb_mean=0.5047 norm_overlap=0.9653 corr_cb=-0.5366 topkJ=0.0000
[TRAIN][ep=047] loss=0.7085 acc=77.72%
[TRAIN][ep=047] mask_avg: mc_mean=0.1069 mb_mean=0.5014 norm_overlap=0.9652 corr_cb=-0.5264
[EPOCH 047/089] train: loss=0.7085 acc=77.72% | val: loss=0.5306 acc=69.88% f1=76.64% auc=81.22% val_score=68.5320 val_score_bestthr=71.7183 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.107, mb=0.501, no=0.965, corr=-0.526) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.5003 -> 71.7183
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.1118 mb_mean=0.4955 norm_overlap=0.9693 corr_cb=-0.5200 topkJ=0.0000
[TRAIN][ep=048] loss=0.7269 acc=76.91%
[TRAIN][ep=048] mask_avg: mc_mean=0.0959 mb_mean=0.5014 norm_overlap=0.9635 corr_cb=-0.5153
[EPOCH 048/089] train: loss=0.7269 acc=76.91% | val: loss=0.5286 acc=75.90% f1=75.61% auc=80.70% val_score=65.0862 val_score_bestthr=72.1409 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.096, mb=0.501, no=0.964, corr=-0.515) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.5003 -> 72.1409
[DBG][ep=049] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.0602 mb_mean=0.5049 norm_overlap=0.9586 corr_cb=-0.4973 topkJ=0.0000
[TRAIN][ep=049] loss=0.7051 acc=77.99%
[TRAIN][ep=049] mask_avg: mc_mean=0.0849 mb_mean=0.5014 norm_overlap=0.9619 corr_cb=-0.5025
[EPOCH 049/089] train: loss=0.7051 acc=77.99% | val: loss=0.5610 acc=74.70% f1=75.86% auc=80.99% val_score=53.4640 val_score_bestthr=74.0103 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.085, mb=0.501, no=0.962, corr=-0.502) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.5003 -> 74.0103
[DBG][ep=050] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.0888 mb_mean=0.5029 norm_overlap=0.9611 corr_cb=-0.4791 topkJ=0.0000
[TRAIN][ep=050] loss=0.6776 acc=80.13%
[TRAIN][ep=050] mask_avg: mc_mean=0.0986 mb_mean=0.5015 norm_overlap=0.9640 corr_cb=-0.5180
[EPOCH 050/089] train: loss=0.6776 acc=80.13% | val: loss=0.5644 acc=74.70% f1=75.86% auc=80.87% val_score=53.4640 val_score_bestthr=74.0103 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.099, mb=0.501, no=0.964, corr=-0.518) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.5003 -> 74.0103
[DBG][ep=051] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.0927 mb_mean=0.5035 norm_overlap=0.9602 corr_cb=-0.5721 topkJ=0.0000
[TRAIN][ep=051] loss=0.6798 acc=80.54%
[TRAIN][ep=051] mask_avg: mc_mean=0.0986 mb_mean=0.5015 norm_overlap=0.9642 corr_cb=-0.5167
[EPOCH 051/089] train: loss=0.6798 acc=80.54% | val: loss=0.5538 acc=75.90% f1=77.27% auc=81.22% val_score=54.3627 val_score_bestthr=76.0185 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.099, mb=0.501, no=0.964, corr=-0.517) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 74.5003 -> 76.0185
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=052] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.1196 mb_mean=0.4999 norm_overlap=0.9636 corr_cb=-0.5394 topkJ=0.0000
[TRAIN][ep=052] loss=0.6753 acc=81.34%
[TRAIN][ep=052] mask_avg: mc_mean=0.0987 mb_mean=0.5014 norm_overlap=0.9641 corr_cb=-0.5182
[EPOCH 052/089] train: loss=0.6753 acc=81.34% | val: loss=0.5323 acc=75.90% f1=77.27% auc=81.57% val_score=65.0862 val_score_bestthr=76.0185 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.099, mb=0.501, no=0.964, corr=-0.518) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 76.0185 -> 76.0185
[DBG][ep=053] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.0871 mb_mean=0.5085 norm_overlap=0.9482 corr_cb=-0.5221 topkJ=0.0000
[TRAIN][ep=053] loss=0.6751 acc=80.40%
[TRAIN][ep=053] mask_avg: mc_mean=0.0986 mb_mean=0.5015 norm_overlap=0.9641 corr_cb=-0.5189
[EPOCH 053/089] train: loss=0.6751 acc=80.40% | val: loss=0.5306 acc=73.49% f1=75.56% auc=81.80% val_score=65.0862 val_score_bestthr=75.2172 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.099, mb=0.501, no=0.964, corr=-0.519) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 76.0185 -> 75.2172
[DBG][ep=054] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=054] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=054] mask(step0): mc_mean=0.0943 mb_mean=0.5047 norm_overlap=0.9582 corr_cb=-0.5173 topkJ=0.0000
[TRAIN][ep=054] loss=0.6771 acc=81.07%
[TRAIN][ep=054] mask_avg: mc_mean=0.0987 mb_mean=0.5014 norm_overlap=0.9640 corr_cb=-0.5193
[EPOCH 054/089] train: loss=0.6771 acc=81.07% | val: loss=0.5488 acc=74.70% f1=76.40% auc=81.05% val_score=63.0788 val_score_bestthr=76.6364 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.099, mb=0.501, no=0.964, corr=-0.519) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 76.0185 -> 76.6364
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=055] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=055] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=055] mask(step0): mc_mean=0.0944 mb_mean=0.5009 norm_overlap=0.9657 corr_cb=-0.5807 topkJ=0.0000
[TRAIN][ep=055] loss=0.6721 acc=80.27%
[TRAIN][ep=055] mask_avg: mc_mean=0.0987 mb_mean=0.5014 norm_overlap=0.9641 corr_cb=-0.5156
[EPOCH 055/089] train: loss=0.6721 acc=80.27% | val: loss=0.5554 acc=73.49% f1=75.00% auc=81.05% val_score=54.3627 val_score_bestthr=74.6291 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.099, mb=0.501, no=0.964, corr=-0.516) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 76.6364 -> 74.6291
[DBG][ep=056] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=056] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=056] mask(step0): mc_mean=0.1060 mb_mean=0.5009 norm_overlap=0.9649 corr_cb=-0.5427 topkJ=0.0000
[TRAIN][ep=056] loss=0.6699 acc=81.61%
[TRAIN][ep=056] mask_avg: mc_mean=0.0987 mb_mean=0.5014 norm_overlap=0.9640 corr_cb=-0.5202
[EPOCH 056/089] train: loss=0.6699 acc=81.61% | val: loss=0.5486 acc=74.70% f1=76.40% auc=81.05% val_score=53.3629 val_score_bestthr=76.6364 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.099, mb=0.501, no=0.964, corr=-0.520) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 76.6364 -> 76.6364
[DBG][ep=057] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=057] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=057] mask(step0): mc_mean=0.1314 mb_mean=0.4930 norm_overlap=0.9784 corr_cb=-0.5077 topkJ=0.0028
[TRAIN][ep=057] loss=0.6746 acc=80.94%
[TRAIN][ep=057] mask_avg: mc_mean=0.0986 mb_mean=0.5014 norm_overlap=0.9639 corr_cb=-0.5202
[EPOCH 057/089] train: loss=0.6746 acc=80.94% | val: loss=0.5515 acc=73.49% f1=75.00% auc=81.16% val_score=52.4816 val_score_bestthr=74.6291 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.099, mb=0.501, no=0.964, corr=-0.520) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 76.6364 -> 74.6291
[DBG][ep=058] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=058] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=058] mask(step0): mc_mean=0.1270 mb_mean=0.5023 norm_overlap=0.9624 corr_cb=-0.5077 topkJ=0.0000
[TRAIN][ep=058] loss=0.6722 acc=81.34%
[TRAIN][ep=058] mask_avg: mc_mean=0.0986 mb_mean=0.5014 norm_overlap=0.9642 corr_cb=-0.5183
[EPOCH 058/089] train: loss=0.6722 acc=81.34% | val: loss=0.5403 acc=74.70% f1=76.40% auc=81.22% val_score=64.8706 val_score_bestthr=76.6364 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.099, mb=0.501, no=0.964, corr=-0.518) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 76.6364 -> 76.6364
[DBG][ep=059] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=059] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=059] mask(step0): mc_mean=0.0978 mb_mean=0.5009 norm_overlap=0.9630 corr_cb=-0.5478 topkJ=0.0000
[TRAIN][ep=059] loss=0.6727 acc=80.81%
[TRAIN][ep=059] mask_avg: mc_mean=0.0986 mb_mean=0.5014 norm_overlap=0.9640 corr_cb=-0.5201
[EPOCH 059/089] train: loss=0.6727 acc=80.81% | val: loss=0.5455 acc=74.70% f1=76.40% auc=81.22% val_score=63.0788 val_score_bestthr=76.6364 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.099, mb=0.501, no=0.964, corr=-0.520) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 76.6364 -> 76.6364
[DBG][ep=060] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=060] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=060] mask(step0): mc_mean=0.0881 mb_mean=0.5029 norm_overlap=0.9643 corr_cb=-0.4906 topkJ=0.0000
[TRAIN][ep=060] loss=0.6707 acc=81.07%
[TRAIN][ep=060] mask_avg: mc_mean=0.0986 mb_mean=0.5015 norm_overlap=0.9640 corr_cb=-0.5190
[EPOCH 060/089] train: loss=0.6707 acc=81.07% | val: loss=0.5397 acc=74.70% f1=76.40% auc=81.22% val_score=63.9458 val_score_bestthr=76.6364 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.099, mb=0.501, no=0.964, corr=-0.519) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 76.6364 -> 76.6364
[DBG][ep=061] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=061] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=061] mask(step0): mc_mean=0.1641 mb_mean=0.4912 norm_overlap=0.9786 corr_cb=-0.4771 topkJ=0.0000
[TRAIN][ep=061] loss=0.6675 acc=80.67%
[TRAIN][ep=061] mask_avg: mc_mean=0.0986 mb_mean=0.5014 norm_overlap=0.9641 corr_cb=-0.5177
[EPOCH 061/089] train: loss=0.6675 acc=80.67% | val: loss=0.5482 acc=74.70% f1=76.40% auc=81.34% val_score=63.0788 val_score_bestthr=76.6364 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.099, mb=0.501, no=0.964, corr=-0.518) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 76.6364 -> 76.6364
[DBG][ep=062] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=062] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=062] mask(step0): mc_mean=0.0704 mb_mean=0.5065 norm_overlap=0.9604 corr_cb=-0.5273 topkJ=0.0000
[TRAIN][ep=062] loss=0.6709 acc=81.07%
[TRAIN][ep=062] mask_avg: mc_mean=0.0987 mb_mean=0.5014 norm_overlap=0.9642 corr_cb=-0.5197
[EPOCH 062/089] train: loss=0.6709 acc=81.07% | val: loss=0.5368 acc=74.70% f1=76.40% auc=81.80% val_score=68.4999 val_score_bestthr=76.6364 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.099, mb=0.501, no=0.964, corr=-0.520) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 76.6364 -> 76.6364
[DBG][ep=063] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=063] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=063] mask(step0): mc_mean=0.0997 mb_mean=0.4998 norm_overlap=0.9709 corr_cb=-0.4889 topkJ=0.0008
[TRAIN][ep=063] loss=0.6687 acc=79.60%
[TRAIN][ep=063] mask_avg: mc_mean=0.0986 mb_mean=0.5014 norm_overlap=0.9641 corr_cb=-0.5194
[EPOCH 063/089] train: loss=0.6687 acc=79.60% | val: loss=0.5389 acc=74.70% f1=76.40% auc=81.69% val_score=62.3907 val_score_bestthr=76.6364 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.099, mb=0.501, no=0.964, corr=-0.519) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 76.6364 -> 76.6364
[DBG][ep=064] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=064] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=064] mask(step0): mc_mean=0.1125 mb_mean=0.4966 norm_overlap=0.9763 corr_cb=-0.4908 topkJ=0.0012
[TRAIN][ep=064] loss=0.6662 acc=81.48%
[TRAIN][ep=064] mask_avg: mc_mean=0.0986 mb_mean=0.5014 norm_overlap=0.9640 corr_cb=-0.5186
[EPOCH 064/089] train: loss=0.6662 acc=81.48% | val: loss=0.5403 acc=74.70% f1=76.40% auc=81.74% val_score=63.9458 val_score_bestthr=76.6364 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.099, mb=0.501, no=0.964, corr=-0.519) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 76.6364 -> 76.6364
[DBG][ep=065] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=065] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=065] mask(step0): mc_mean=0.0926 mb_mean=0.5017 norm_overlap=0.9615 corr_cb=-0.5477 topkJ=0.0000
[TRAIN][ep=065] loss=0.6629 acc=81.07%
[TRAIN][ep=065] mask_avg: mc_mean=0.0986 mb_mean=0.5015 norm_overlap=0.9641 corr_cb=-0.5183
[EPOCH 065/089] train: loss=0.6629 acc=81.07% | val: loss=0.5601 acc=74.70% f1=76.40% auc=81.45% val_score=55.2534 val_score_bestthr=76.6364 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.099, mb=0.501, no=0.964, corr=-0.518) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 76.6364 -> 76.6364
[DBG][ep=066] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=066] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=066] mask(step0): mc_mean=0.1058 mb_mean=0.5007 norm_overlap=0.9685 corr_cb=-0.5433 topkJ=0.0000
[TRAIN][ep=066] loss=0.6646 acc=80.67%
[TRAIN][ep=066] mask_avg: mc_mean=0.0986 mb_mean=0.5015 norm_overlap=0.9639 corr_cb=-0.5204
[EPOCH 066/089] train: loss=0.6646 acc=80.67% | val: loss=0.5444 acc=74.70% f1=76.40% auc=81.63% val_score=63.9458 val_score_bestthr=76.6364 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.099, mb=0.501, no=0.964, corr=-0.520) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 76.6364 -> 76.6364
[DBG][ep=067] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=067] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=067] mask(step0): mc_mean=0.0945 mb_mean=0.5058 norm_overlap=0.9510 corr_cb=-0.5363 topkJ=0.0000
[TRAIN][ep=067] loss=0.6625 acc=81.21%
[TRAIN][ep=067] mask_avg: mc_mean=0.0987 mb_mean=0.5014 norm_overlap=0.9640 corr_cb=-0.5205
[EPOCH 067/089] train: loss=0.6625 acc=81.21% | val: loss=0.5385 acc=74.70% f1=76.40% auc=81.86% val_score=64.8706 val_score_bestthr=76.6364 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.099, mb=0.501, no=0.964, corr=-0.520) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 76.6364 -> 76.6364
[DBG][ep=068] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=068] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=068] mask(step0): mc_mean=0.0878 mb_mean=0.5032 norm_overlap=0.9644 corr_cb=-0.5193 topkJ=0.0008
[TRAIN][ep=068] loss=0.6605 acc=81.21%
[TRAIN][ep=068] mask_avg: mc_mean=0.0987 mb_mean=0.5014 norm_overlap=0.9641 corr_cb=-0.5187
[EPOCH 068/089] train: loss=0.6605 acc=81.21% | val: loss=0.5907 acc=74.70% f1=76.92% auc=81.10% val_score=54.3627 val_score_bestthr=76.2901 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.099, mb=0.501, no=0.964, corr=-0.519) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 76.6364 -> 76.2901
[DBG][ep=069] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=069] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=069] mask(step0): mc_mean=0.1126 mb_mean=0.5002 norm_overlap=0.9633 corr_cb=-0.5904 topkJ=0.0000
[TRAIN][ep=069] loss=0.6702 acc=80.67%
[TRAIN][ep=069] mask_avg: mc_mean=0.0986 mb_mean=0.5014 norm_overlap=0.9641 corr_cb=-0.5189
[EPOCH 069/089] train: loss=0.6702 acc=80.67% | val: loss=0.5373 acc=73.49% f1=75.56% auc=81.80% val_score=72.1570 val_score_bestthr=75.2172 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.099, mb=0.501, no=0.964, corr=-0.519) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 76.6364 -> 75.2172
[DBG][ep=070] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=070] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=070] mask(step0): mc_mean=0.1012 mb_mean=0.4982 norm_overlap=0.9720 corr_cb=-0.5181 topkJ=0.0000
[TRAIN][ep=070] loss=0.6609 acc=81.34%
[TRAIN][ep=070] mask_avg: mc_mean=0.0986 mb_mean=0.5014 norm_overlap=0.9641 corr_cb=-0.5186
[EPOCH 070/089] train: loss=0.6609 acc=81.34% | val: loss=0.5354 acc=72.29% f1=74.73% auc=81.86% val_score=66.3036 val_score_bestthr=73.8589 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.099, mb=0.501, no=0.964, corr=-0.519) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 76.6364 -> 73.8589
[DBG][ep=071] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=071] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=071] mask(step0): mc_mean=0.1123 mb_mean=0.4983 norm_overlap=0.9638 corr_cb=-0.5698 topkJ=0.0004
[TRAIN][ep=071] loss=0.6598 acc=80.00%
[TRAIN][ep=071] mask_avg: mc_mean=0.0986 mb_mean=0.5014 norm_overlap=0.9640 corr_cb=-0.5230
[EPOCH 071/089] train: loss=0.6598 acc=80.00% | val: loss=0.5440 acc=74.70% f1=76.40% auc=81.57% val_score=64.8706 val_score_bestthr=76.6364 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.099, mb=0.501, no=0.964, corr=-0.523) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 76.6364 -> 76.6364
[DBG][ep=072] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=072] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=072] mask(step0): mc_mean=0.0717 mb_mean=0.5071 norm_overlap=0.9591 corr_cb=-0.5027 topkJ=0.0000
[TRAIN][ep=072] loss=0.6565 acc=81.34%
[TRAIN][ep=072] mask_avg: mc_mean=0.0986 mb_mean=0.5015 norm_overlap=0.9640 corr_cb=-0.5186
[EPOCH 072/089] train: loss=0.6565 acc=81.34% | val: loss=0.5532 acc=73.49% f1=75.56% auc=81.69% val_score=53.3629 val_score_bestthr=75.2172 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.099, mb=0.501, no=0.964, corr=-0.519) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 76.6364 -> 75.2172
[DBG][ep=073] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=073] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=073] mask(step0): mc_mean=0.0638 mb_mean=0.5061 norm_overlap=0.9566 corr_cb=-0.5044 topkJ=0.0000
[TRAIN][ep=073] loss=0.6548 acc=80.94%
[TRAIN][ep=073] mask_avg: mc_mean=0.0986 mb_mean=0.5015 norm_overlap=0.9640 corr_cb=-0.5182
[EPOCH 073/089] train: loss=0.6548 acc=80.94% | val: loss=0.5553 acc=73.49% f1=76.09% auc=81.45% val_score=53.3629 val_score_bestthr=74.7570 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.099, mb=0.501, no=0.964, corr=-0.518) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 76.6364 -> 74.7570
[DBG][ep=074] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=074] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=074] mask(step0): mc_mean=0.1209 mb_mean=0.4965 norm_overlap=0.9717 corr_cb=-0.5271 topkJ=0.0000
[TRAIN][ep=074] loss=0.6571 acc=81.48%
[TRAIN][ep=074] mask_avg: mc_mean=0.0986 mb_mean=0.5015 norm_overlap=0.9639 corr_cb=-0.5197
[EPOCH 074/089] train: loss=0.6571 acc=81.48% | val: loss=0.5647 acc=74.70% f1=76.40% auc=81.51% val_score=55.2534 val_score_bestthr=71.7329 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.099, mb=0.501, no=0.964, corr=-0.520) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 76.6364 -> 71.7329
[DBG][ep=075] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=075] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=075] mask(step0): mc_mean=0.0695 mb_mean=0.5054 norm_overlap=0.9640 corr_cb=-0.4614 topkJ=0.0000
[TRAIN][ep=075] loss=0.6575 acc=80.94%
[TRAIN][ep=075] mask_avg: mc_mean=0.0986 mb_mean=0.5014 norm_overlap=0.9641 corr_cb=-0.5198
[EPOCH 075/089] train: loss=0.6575 acc=80.94% | val: loss=0.5365 acc=74.70% f1=78.35% auc=81.98% val_score=66.5210 val_score_bestthr=74.1061 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.099, mb=0.501, no=0.964, corr=-0.520) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 76.6364 -> 74.1061
[DBG][ep=076] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=076] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=076] mask(step0): mc_mean=0.0816 mb_mean=0.5036 norm_overlap=0.9567 corr_cb=-0.4979 topkJ=0.0000
[TRAIN][ep=076] loss=0.6536 acc=81.48%
[TRAIN][ep=076] mask_avg: mc_mean=0.0986 mb_mean=0.5014 norm_overlap=0.9641 corr_cb=-0.5192
[EPOCH 076/089] train: loss=0.6536 acc=81.48% | val: loss=0.5458 acc=73.49% f1=76.09% auc=81.74% val_score=63.9458 val_score_bestthr=74.7570 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.099, mb=0.501, no=0.964, corr=-0.519) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 76.6364 -> 74.7570
[DBG][ep=077] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=077] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=077] mask(step0): mc_mean=0.1468 mb_mean=0.4942 norm_overlap=0.9669 corr_cb=-0.5696 topkJ=0.0000
[TRAIN][ep=077] loss=0.6547 acc=81.48%
[TRAIN][ep=077] mask_avg: mc_mean=0.0987 mb_mean=0.5014 norm_overlap=0.9642 corr_cb=-0.5202
[EPOCH 077/089] train: loss=0.6547 acc=81.48% | val: loss=0.5406 acc=72.29% f1=74.73% auc=81.86% val_score=65.7299 val_score_bestthr=73.8589 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.099, mb=0.501, no=0.964, corr=-0.520) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 76.6364 -> 73.8589
[DBG][ep=078] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=078] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=078] mask(step0): mc_mean=0.0716 mb_mean=0.5049 norm_overlap=0.9538 corr_cb=-0.5541 topkJ=0.0000
[TRAIN][ep=078] loss=0.6482 acc=82.55%
[TRAIN][ep=078] mask_avg: mc_mean=0.0986 mb_mean=0.5015 norm_overlap=0.9640 corr_cb=-0.5200
[EPOCH 078/089] train: loss=0.6482 acc=82.55% | val: loss=0.5574 acc=73.49% f1=76.09% auc=81.45% val_score=53.3629 val_score_bestthr=74.7570 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.099, mb=0.501, no=0.964, corr=-0.520) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 76.6364 -> 74.7570
[DBG][ep=079] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=079] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=079] mask(step0): mc_mean=0.1050 mb_mean=0.5000 norm_overlap=0.9706 corr_cb=-0.5052 topkJ=0.0008
[TRAIN][ep=079] loss=0.6473 acc=81.74%
[TRAIN][ep=079] mask_avg: mc_mean=0.0987 mb_mean=0.5014 norm_overlap=0.9640 corr_cb=-0.5201
[EPOCH 079/089] train: loss=0.6473 acc=81.74% | val: loss=0.5574 acc=73.49% f1=76.09% auc=81.69% val_score=53.3629 val_score_bestthr=74.7570 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.099, mb=0.501, no=0.964, corr=-0.520) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 76.6364 -> 74.7570
[DBG][ep=080] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=080] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=080] mask(step0): mc_mean=0.1227 mb_mean=0.5033 norm_overlap=0.9584 corr_cb=-0.5213 topkJ=0.0000
[TRAIN][ep=080] loss=0.6511 acc=81.34%
[TRAIN][ep=080] mask_avg: mc_mean=0.0986 mb_mean=0.5014 norm_overlap=0.9640 corr_cb=-0.5194
[EPOCH 080/089] train: loss=0.6511 acc=81.34% | val: loss=0.5409 acc=72.29% f1=74.73% auc=81.86% val_score=68.0676 val_score_bestthr=73.8589 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.099, mb=0.501, no=0.964, corr=-0.519) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 76.6364 -> 73.8589
[DBG][ep=081] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=081] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=081] mask(step0): mc_mean=0.1236 mb_mean=0.4976 norm_overlap=0.9762 corr_cb=-0.5212 topkJ=0.0000
[TRAIN][ep=081] loss=0.6537 acc=80.27%
[TRAIN][ep=081] mask_avg: mc_mean=0.0986 mb_mean=0.5014 norm_overlap=0.9639 corr_cb=-0.5201
[EPOCH 081/089] train: loss=0.6537 acc=80.27% | val: loss=0.5430 acc=73.49% f1=76.09% auc=81.74% val_score=59.6221 val_score_bestthr=74.7570 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.099, mb=0.501, no=0.964, corr=-0.520) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 76.6364 -> 74.7570
[DBG][ep=082] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=082] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=082] mask(step0): mc_mean=0.1238 mb_mean=0.4943 norm_overlap=0.9759 corr_cb=-0.4405 topkJ=0.0000
[TRAIN][ep=082] loss=0.6525 acc=81.21%
[TRAIN][ep=082] mask_avg: mc_mean=0.0986 mb_mean=0.5014 norm_overlap=0.9641 corr_cb=-0.5174
[EPOCH 082/089] train: loss=0.6525 acc=81.21% | val: loss=0.5861 acc=74.70% f1=76.40% auc=80.99% val_score=55.2534 val_score_bestthr=71.7329 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.099, mb=0.501, no=0.964, corr=-0.517) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 76.6364 -> 71.7329
[DBG][ep=083] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=083] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=083] mask(step0): mc_mean=0.1117 mb_mean=0.4958 norm_overlap=0.9750 corr_cb=-0.4615 topkJ=0.0024
[TRAIN][ep=083] loss=0.6453 acc=82.28%
[TRAIN][ep=083] mask_avg: mc_mean=0.0986 mb_mean=0.5014 norm_overlap=0.9640 corr_cb=-0.5195
[EPOCH 083/089] train: loss=0.6453 acc=82.28% | val: loss=0.5617 acc=73.49% f1=77.55% auc=81.86% val_score=53.3629 val_score_bestthr=72.5785 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.099, mb=0.501, no=0.964, corr=-0.519) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 76.6364 -> 72.5785
[DBG][ep=084] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=084] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=084] mask(step0): mc_mean=0.0873 mb_mean=0.5021 norm_overlap=0.9589 corr_cb=-0.5778 topkJ=0.0008
[TRAIN][ep=084] loss=0.6476 acc=81.34%
[TRAIN][ep=084] mask_avg: mc_mean=0.0987 mb_mean=0.5014 norm_overlap=0.9641 corr_cb=-0.5188
[EPOCH 084/089] train: loss=0.6476 acc=81.34% | val: loss=0.5390 acc=75.90% f1=79.17% auc=81.92% val_score=62.6356 val_score_bestthr=76.8246 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.099, mb=0.501, no=0.964, corr=-0.519) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 76.6364 -> 76.8246
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=085] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=085] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=085] mask(step0): mc_mean=0.0940 mb_mean=0.5028 norm_overlap=0.9603 corr_cb=-0.5616 topkJ=0.0000
[TRAIN][ep=085] loss=0.6497 acc=81.21%
[TRAIN][ep=085] mask_avg: mc_mean=0.0986 mb_mean=0.5015 norm_overlap=0.9639 corr_cb=-0.5190
[EPOCH 085/089] train: loss=0.6497 acc=81.21% | val: loss=0.6060 acc=74.70% f1=76.40% auc=80.99% val_score=54.3627 val_score_bestthr=71.7329 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.099, mb=0.501, no=0.964, corr=-0.519) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 76.8246 -> 71.7329
[DBG][ep=086] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=086] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=086] mask(step0): mc_mean=0.1109 mb_mean=0.5001 norm_overlap=0.9613 corr_cb=-0.5309 topkJ=0.0000
[TRAIN][ep=086] loss=0.6439 acc=82.82%
[TRAIN][ep=086] mask_avg: mc_mean=0.0987 mb_mean=0.5014 norm_overlap=0.9641 corr_cb=-0.5197
[EPOCH 086/089] train: loss=0.6439 acc=82.82% | val: loss=0.5461 acc=73.49% f1=76.09% auc=81.74% val_score=62.3907 val_score_bestthr=74.7570 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.099, mb=0.501, no=0.964, corr=-0.520) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 76.8246 -> 74.7570
[DBG][ep=087] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=087] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=087] mask(step0): mc_mean=0.1093 mb_mean=0.5006 norm_overlap=0.9678 corr_cb=-0.5118 topkJ=0.0000
[TRAIN][ep=087] loss=0.6388 acc=82.01%
[TRAIN][ep=087] mask_avg: mc_mean=0.0987 mb_mean=0.5014 norm_overlap=0.9641 corr_cb=-0.5179
[EPOCH 087/089] train: loss=0.6388 acc=82.01% | val: loss=0.5386 acc=75.90% f1=79.17% auc=82.33% val_score=61.8653 val_score_bestthr=76.8246 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.099, mb=0.501, no=0.964, corr=-0.518) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 76.8246 -> 76.8246
[DBG][ep=088] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=088] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=088] mask(step0): mc_mean=0.0845 mb_mean=0.5053 norm_overlap=0.9629 corr_cb=-0.5032 topkJ=0.0000
[TRAIN][ep=088] loss=0.6501 acc=82.15%
[TRAIN][ep=088] mask_avg: mc_mean=0.0986 mb_mean=0.5014 norm_overlap=0.9640 corr_cb=-0.5178
[EPOCH 088/089] train: loss=0.6501 acc=82.15% | val: loss=0.5435 acc=73.49% f1=76.09% auc=81.63% val_score=65.3984 val_score_bestthr=74.7570 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.099, mb=0.501, no=0.964, corr=-0.518) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 76.8246 -> 74.7570
[DBG][ep=089] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=089] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=089] mask(step0): mc_mean=0.1009 mb_mean=0.4998 norm_overlap=0.9637 corr_cb=-0.5073 topkJ=0.0000
[TRAIN][ep=089] loss=0.6417 acc=80.81%
[TRAIN][ep=089] mask_avg: mc_mean=0.0986 mb_mean=0.5014 norm_overlap=0.9642 corr_cb=-0.5173
[EPOCH 089/089] train: loss=0.6417 acc=80.81% | val: loss=0.5674 acc=72.29% f1=75.27% auc=81.63% val_score=53.3629 val_score_bestthr=73.2265 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.099, mb=0.501, no=0.964, corr=-0.517) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 76.8246 -> 73.2265
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
=============== FIT DONE ===============
[BEST] epoch=84 | val_acc=75.90% | val_f1=79.17% | val_auc=81.92% | val_score=62.6356 | val_score_bestthr=76.8246
[TEST@BEST] thr_used=0.195 | acc=58.94% f1=69.75% auc=63.34% | SP_sex=11.73% EO_sex=9.20% SP_age=11.29% EO_age=4.11%
[TIME] 1.92 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/summary_fold_0.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4752 mb_mean=0.5091 norm_overlap=0.9996 corr_cb=-0.4004 topkJ=0.0039
[TRAIN][ep=000] loss=0.6933 acc=51.14%
[TRAIN][ep=000] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1325
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4782 mb_mean=0.5028 norm_overlap=0.9999 corr_cb=-0.0933 topkJ=0.0031
[TRAIN][ep=001] loss=0.6926 acc=51.81%
[TRAIN][ep=001] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1283
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4776 mb_mean=0.5098 norm_overlap=0.9997 corr_cb=-0.3755 topkJ=0.0024
[TRAIN][ep=002] loss=0.6911 acc=52.21%
[TRAIN][ep=002] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1407
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4785 mb_mean=0.5037 norm_overlap=1.0000 corr_cb=0.0262 topkJ=0.0152
[TRAIN][ep=003] loss=0.6899 acc=56.51%
[TRAIN][ep=003] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1330
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4760 mb_mean=0.5053 norm_overlap=0.9998 corr_cb=-0.2618 topkJ=0.0459
[TRAIN][ep=004] loss=0.6890 acc=56.51%
[TRAIN][ep=004] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1247
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4794 mb_mean=0.5002 norm_overlap=0.9999 corr_cb=-0.2006 topkJ=0.0064
[TRAIN][ep=005] loss=0.6885 acc=53.96%
[TRAIN][ep=005] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1272
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4760 mb_mean=0.5040 norm_overlap=0.9997 corr_cb=-0.4011 topkJ=0.0113
[TRAIN][ep=006] loss=0.6861 acc=56.24%
[TRAIN][ep=006] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1302
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4758 mb_mean=0.5023 norm_overlap=0.9998 corr_cb=-0.2950 topkJ=0.0024
[TRAIN][ep=007] loss=0.6818 acc=57.58%
[TRAIN][ep=007] mask_avg: mc_mean=0.4785 mb_mean=0.5015 norm_overlap=0.9999 corr_cb=-0.1365
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4784 mb_mean=0.4987 norm_overlap=0.9997 corr_cb=-0.3532 topkJ=0.0048
[TRAIN][ep=008] loss=0.6793 acc=61.88%
[TRAIN][ep=008] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1238
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4781 mb_mean=0.5042 norm_overlap=0.9998 corr_cb=-0.2975 topkJ=0.0188
[TRAIN][ep=009] loss=0.6738 acc=61.21%
[TRAIN][ep=009] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1254
================= FIT START (fold=0) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.45 select_by=val_score_bestthr | eval_thr_mode=fixed eval_thr_grid=coarse | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4787 mb_mean=0.5043 norm_overlap=0.9999 corr_cb=-0.0822 topkJ=0.0502
[TRAIN][ep=000] loss=0.6723 acc=63.09%
[TRAIN][ep=000] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1201
[EPOCH 000/089] train: loss=0.6723 acc=63.09% | val: loss=0.6708 acc=57.83% f1=70.59% auc=69.42% val_score=60.2807 val_score_bestthr=60.2807 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.120) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 60.2807
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4793 mb_mean=0.5022 norm_overlap=0.9998 corr_cb=-0.2365 topkJ=0.0024
[TRAIN][ep=001] loss=0.6679 acc=63.09%
[TRAIN][ep=001] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1274
[EPOCH 001/089] train: loss=0.6679 acc=63.09% | val: loss=0.6737 acc=62.65% f1=70.48% auc=66.57% val_score=57.0712 val_score_bestthr=57.0712 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.127) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 60.2807 -> 57.0712
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4774 mb_mean=0.4982 norm_overlap=1.0000 corr_cb=-0.0324 topkJ=0.0252
[TRAIN][ep=002] loss=0.6644 acc=62.55%
[TRAIN][ep=002] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1182
[EPOCH 002/089] train: loss=0.6644 acc=62.55% | val: loss=0.6648 acc=60.24% f1=71.30% auc=69.48% val_score=62.8146 val_score_bestthr=62.8146 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.118) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 60.2807 -> 62.8146
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4776 mb_mean=0.5075 norm_overlap=0.9998 corr_cb=-0.2177 topkJ=0.0023
[TRAIN][ep=003] loss=0.6601 acc=63.36%
[TRAIN][ep=003] mask_avg: mc_mean=0.4785 mb_mean=0.5015 norm_overlap=0.9999 corr_cb=-0.1255
[EPOCH 003/089] train: loss=0.6601 acc=63.36% | val: loss=0.6672 acc=62.65% f1=67.37% auc=67.97% val_score=54.2166 val_score_bestthr=54.2166 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.125) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.8146 -> 54.2166
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4824 mb_mean=0.4950 norm_overlap=0.9998 corr_cb=-0.2211 topkJ=0.0294
[TRAIN][ep=004] loss=0.6627 acc=60.94%
[TRAIN][ep=004] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1284
[EPOCH 004/089] train: loss=0.6627 acc=60.94% | val: loss=0.6584 acc=67.47% f1=74.77% auc=70.06% val_score=61.6555 val_score_bestthr=61.6555 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.128) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.8146 -> 61.6555
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4744 mb_mean=0.5047 norm_overlap=0.9999 corr_cb=-0.0747 topkJ=0.0278
[TRAIN][ep=005] loss=1.4287 acc=64.03%
[TRAIN][ep=005] mask_avg: mc_mean=0.3511 mb_mean=0.5014 norm_overlap=0.9963 corr_cb=-0.6428
[EPOCH 005/089] train: loss=1.4287 acc=64.03% | val: loss=0.6608 acc=51.81% f1=68.25% auc=73.37% val_score=62.0453 val_score_bestthr=62.0453 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.351, mb=0.501, no=0.996, corr=-0.643) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.8146 -> 62.0453
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2060 mb_mean=0.5118 norm_overlap=0.9870 corr_cb=-0.7971 topkJ=0.0000
[TRAIN][ep=006] loss=1.4137 acc=64.56%
[TRAIN][ep=006] mask_avg: mc_mean=0.1980 mb_mean=0.5014 norm_overlap=0.9891 corr_cb=-0.7163
[EPOCH 006/089] train: loss=1.4137 acc=64.56% | val: loss=0.6498 acc=53.01% f1=68.80% auc=74.24% val_score=61.3791 val_score_bestthr=61.3791 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.198, mb=0.501, no=0.989, corr=-0.716) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.8146 -> 61.3791
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.1589 mb_mean=0.5024 norm_overlap=0.9846 corr_cb=-0.7890 topkJ=0.0000
[TRAIN][ep=007] loss=1.4185 acc=62.01%
[TRAIN][ep=007] mask_avg: mc_mean=0.1328 mb_mean=0.5014 norm_overlap=0.9826 corr_cb=-0.7232
[EPOCH 007/089] train: loss=1.4185 acc=62.01% | val: loss=0.6447 acc=54.22% f1=69.35% auc=74.83% val_score=62.4643 val_score_bestthr=62.4643 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.133, mb=0.501, no=0.983, corr=-0.723) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.8146 -> 62.4643
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1195 mb_mean=0.5001 norm_overlap=0.9768 corr_cb=-0.7756 topkJ=0.0000
[TRAIN][ep=008] loss=1.1904 acc=65.64%
[TRAIN][ep=008] mask_avg: mc_mean=0.0912 mb_mean=0.5014 norm_overlap=0.9763 corr_cb=-0.6872
[EPOCH 008/089] train: loss=1.1904 acc=65.64% | val: loss=0.6414 acc=69.88% f1=76.19% auc=73.02% val_score=64.6846 val_score_bestthr=64.6846 | dyn(w_pfs=0.290, w_sup=0.190, w_csuf=0.140, stage2=False) | mask(mc=0.091, mb=0.501, no=0.976, corr=-0.687) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 62.8146 -> 64.6846
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.0693 mb_mean=0.5043 norm_overlap=0.9746 corr_cb=-0.6973 topkJ=0.0000
[TRAIN][ep=009] loss=1.2583 acc=67.92%
[TRAIN][ep=009] mask_avg: mc_mean=0.0790 mb_mean=0.5014 norm_overlap=0.9723 corr_cb=-0.6554
[EPOCH 009/089] train: loss=1.2583 acc=67.92% | val: loss=0.6320 acc=69.88% f1=76.19% auc=73.78% val_score=64.5831 val_score_bestthr=64.5831 | dyn(w_pfs=0.090, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.079, mb=0.501, no=0.972, corr=-0.655) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.6846 -> 64.5831
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.0933 mb_mean=0.4997 norm_overlap=0.9636 corr_cb=-0.7071 topkJ=0.0000
[TRAIN][ep=010] loss=0.9179 acc=67.25%
[TRAIN][ep=010] mask_avg: mc_mean=0.0797 mb_mean=0.5015 norm_overlap=0.9697 corr_cb=-0.6297
[EPOCH 010/089] train: loss=0.9179 acc=67.25% | val: loss=0.6377 acc=61.45% f1=61.90% auc=71.74% val_score=48.4618 val_score_bestthr=48.4618 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.080, mb=0.501, no=0.970, corr=-0.630) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.6846 -> 48.4618
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1059 mb_mean=0.5016 norm_overlap=0.9568 corr_cb=-0.6827 topkJ=0.0000
[TRAIN][ep=011] loss=0.8794 acc=69.26%
[TRAIN][ep=011] mask_avg: mc_mean=0.0801 mb_mean=0.5015 norm_overlap=0.9678 corr_cb=-0.6098
[EPOCH 011/089] train: loss=0.8794 acc=69.26% | val: loss=0.6202 acc=67.47% f1=73.79% auc=73.84% val_score=57.9514 val_score_bestthr=57.9514 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.080, mb=0.501, no=0.968, corr=-0.610) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.6846 -> 57.9514
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.0504 mb_mean=0.5072 norm_overlap=0.9662 corr_cb=-0.5752 topkJ=0.0000
[TRAIN][ep=012] loss=0.9662 acc=67.38%
[TRAIN][ep=012] mask_avg: mc_mean=0.0806 mb_mean=0.5014 norm_overlap=0.9666 corr_cb=-0.5906
[EPOCH 012/089] train: loss=0.9662 acc=67.38% | val: loss=0.6284 acc=65.06% f1=65.06% auc=72.50% val_score=53.5202 val_score_bestthr=53.5202 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.081, mb=0.501, no=0.967, corr=-0.591) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.6846 -> 53.5202
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.0472 mb_mean=0.5080 norm_overlap=0.9584 corr_cb=-0.4263 topkJ=0.0000
[TRAIN][ep=013] loss=1.0401 acc=66.98%
[TRAIN][ep=013] mask_avg: mc_mean=0.0683 mb_mean=0.5015 norm_overlap=0.9630 corr_cb=-0.5613
[EPOCH 013/089] train: loss=1.0401 acc=66.98% | val: loss=0.6148 acc=60.24% f1=62.92% auc=74.24% val_score=45.9557 val_score_bestthr=45.9557 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.068, mb=0.501, no=0.963, corr=-0.561) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.6846 -> 45.9557
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.0778 mb_mean=0.4973 norm_overlap=0.9742 corr_cb=-0.5057 topkJ=0.0024
[TRAIN][ep=014] loss=0.8625 acc=69.26%
[TRAIN][ep=014] mask_avg: mc_mean=0.0724 mb_mean=0.5014 norm_overlap=0.9630 corr_cb=-0.5590
[EPOCH 014/089] train: loss=0.8625 acc=69.26% | val: loss=0.6059 acc=63.86% f1=70.00% auc=74.77% val_score=53.9982 val_score_bestthr=53.9982 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.072, mb=0.501, no=0.963, corr=-0.559) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.6846 -> 53.9982
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.0545 mb_mean=0.5043 norm_overlap=0.9627 corr_cb=-0.4946 topkJ=0.0000
[TRAIN][ep=015] loss=0.8510 acc=70.07%
[TRAIN][ep=015] mask_avg: mc_mean=0.0877 mb_mean=0.5014 norm_overlap=0.9652 corr_cb=-0.5695
[EPOCH 015/089] train: loss=0.8510 acc=70.07% | val: loss=0.6007 acc=60.24% f1=63.74% auc=75.06% val_score=46.6407 val_score_bestthr=46.6407 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.088, mb=0.501, no=0.965, corr=-0.569) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.6846 -> 46.6407
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.0547 mb_mean=0.5102 norm_overlap=0.9515 corr_cb=-0.5736 topkJ=0.0000
[TRAIN][ep=016] loss=0.8553 acc=69.13%
[TRAIN][ep=016] mask_avg: mc_mean=0.0732 mb_mean=0.5014 norm_overlap=0.9620 corr_cb=-0.5386
[EPOCH 016/089] train: loss=0.8553 acc=69.13% | val: loss=0.6011 acc=60.24% f1=63.74% auc=75.17% val_score=46.6407 val_score_bestthr=46.6407 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.073, mb=0.501, no=0.962, corr=-0.539) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.6846 -> 46.6407
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.0894 mb_mean=0.4927 norm_overlap=0.9774 corr_cb=-0.4615 topkJ=0.0012
[TRAIN][ep=017] loss=0.8450 acc=69.93%
[TRAIN][ep=017] mask_avg: mc_mean=0.0739 mb_mean=0.5014 norm_overlap=0.9620 corr_cb=-0.5368
[EPOCH 017/089] train: loss=0.8450 acc=69.93% | val: loss=0.6046 acc=67.47% f1=67.47% auc=74.83% val_score=54.5263 val_score_bestthr=54.5263 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.074, mb=0.501, no=0.962, corr=-0.537) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.6846 -> 54.5263
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.0800 mb_mean=0.5052 norm_overlap=0.9570 corr_cb=-0.5774 topkJ=0.0000
[TRAIN][ep=018] loss=0.8370 acc=71.01%
[TRAIN][ep=018] mask_avg: mc_mean=0.0971 mb_mean=0.5014 norm_overlap=0.9655 corr_cb=-0.5552
[EPOCH 018/089] train: loss=0.8370 acc=71.01% | val: loss=0.6527 acc=69.88% f1=61.54% auc=73.14% val_score=60.5868 val_score_bestthr=60.5868 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.097, mb=0.501, no=0.965, corr=-0.555) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.6846 -> 60.5868
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.0649 mb_mean=0.4998 norm_overlap=0.9619 corr_cb=-0.5173 topkJ=0.0000
[TRAIN][ep=019] loss=0.8574 acc=66.98%
[TRAIN][ep=019] mask_avg: mc_mean=0.0609 mb_mean=0.5014 norm_overlap=0.9588 corr_cb=-0.5048
[EPOCH 019/089] train: loss=0.8574 acc=66.98% | val: loss=0.6069 acc=67.47% f1=64.94% auc=75.06% val_score=57.0750 val_score_bestthr=57.0750 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.061, mb=0.501, no=0.959, corr=-0.505) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.6846 -> 57.0750
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1043 mb_mean=0.4956 norm_overlap=0.9592 corr_cb=-0.5984 topkJ=0.0000
[TRAIN][ep=020] loss=0.8359 acc=70.20%
[TRAIN][ep=020] mask_avg: mc_mean=0.0647 mb_mean=0.5014 norm_overlap=0.9595 corr_cb=-0.5135
[EPOCH 020/089] train: loss=0.8359 acc=70.20% | val: loss=0.6032 acc=68.67% f1=66.67% auc=75.06% val_score=55.3543 val_score_bestthr=55.3543 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.065, mb=0.501, no=0.959, corr=-0.513) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.6846 -> 55.3543
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.0617 mb_mean=0.5057 norm_overlap=0.9507 corr_cb=-0.4927 topkJ=0.0000
[TRAIN][ep=021] loss=0.8227 acc=72.35%
[TRAIN][ep=021] mask_avg: mc_mean=0.0905 mb_mean=0.5014 norm_overlap=0.9637 corr_cb=-0.5462
[EPOCH 021/089] train: loss=0.8227 acc=72.35% | val: loss=0.5976 acc=68.67% f1=67.50% auc=75.81% val_score=50.8738 val_score_bestthr=50.8738 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.090, mb=0.501, no=0.964, corr=-0.546) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.6846 -> 50.8738
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1198 mb_mean=0.4985 norm_overlap=0.9696 corr_cb=-0.5097 topkJ=0.0008
[TRAIN][ep=022] loss=0.8252 acc=71.68%
[TRAIN][ep=022] mask_avg: mc_mean=0.0946 mb_mean=0.5014 norm_overlap=0.9643 corr_cb=-0.5474
[EPOCH 022/089] train: loss=0.8252 acc=71.68% | val: loss=0.5770 acc=65.06% f1=66.67% auc=76.51% val_score=52.5372 val_score_bestthr=52.5372 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.095, mb=0.501, no=0.964, corr=-0.547) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.6846 -> 52.5372
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.0653 mb_mean=0.5003 norm_overlap=0.9595 corr_cb=-0.5062 topkJ=0.0000
[TRAIN][ep=023] loss=0.8265 acc=71.54%
[TRAIN][ep=023] mask_avg: mc_mean=0.0662 mb_mean=0.5015 norm_overlap=0.9591 corr_cb=-0.5079
[EPOCH 023/089] train: loss=0.8265 acc=71.54% | val: loss=0.5733 acc=62.65% f1=65.17% auc=77.09% val_score=50.3087 val_score_bestthr=50.3087 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.066, mb=0.501, no=0.959, corr=-0.508) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.6846 -> 50.3087
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.0733 mb_mean=0.5001 norm_overlap=0.9660 corr_cb=-0.4318 topkJ=0.0012
[TRAIN][ep=024] loss=0.8051 acc=73.42%
[TRAIN][ep=024] mask_avg: mc_mean=0.0772 mb_mean=0.5014 norm_overlap=0.9613 corr_cb=-0.5207
[EPOCH 024/089] train: loss=0.8051 acc=73.42% | val: loss=0.5717 acc=62.65% f1=65.17% auc=76.69% val_score=50.3087 val_score_bestthr=50.3087 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.077, mb=0.501, no=0.961, corr=-0.521) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.6846 -> 50.3087
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.0768 mb_mean=0.5013 norm_overlap=0.9620 corr_cb=-0.5642 topkJ=0.0000
[TRAIN][ep=025] loss=0.8253 acc=71.54%
[TRAIN][ep=025] mask_avg: mc_mean=0.0619 mb_mean=0.5014 norm_overlap=0.9579 corr_cb=-0.4914
[EPOCH 025/089] train: loss=0.8253 acc=71.54% | val: loss=0.5809 acc=71.08% f1=70.73% auc=76.45% val_score=59.8559 val_score_bestthr=59.8559 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.062, mb=0.501, no=0.958, corr=-0.491) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.6846 -> 59.8559
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.0507 mb_mean=0.5025 norm_overlap=0.9548 corr_cb=-0.5266 topkJ=0.0000
[TRAIN][ep=026] loss=0.8019 acc=72.75%
[TRAIN][ep=026] mask_avg: mc_mean=0.0728 mb_mean=0.5014 norm_overlap=0.9602 corr_cb=-0.5152
[EPOCH 026/089] train: loss=0.8019 acc=72.75% | val: loss=0.5687 acc=62.65% f1=68.04% auc=77.03% val_score=47.9633 val_score_bestthr=47.9633 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.073, mb=0.501, no=0.960, corr=-0.515) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.6846 -> 47.9633
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.0864 mb_mean=0.5001 norm_overlap=0.9559 corr_cb=-0.5868 topkJ=0.0000
[TRAIN][ep=027] loss=0.7976 acc=73.83%
[TRAIN][ep=027] mask_avg: mc_mean=0.0855 mb_mean=0.5014 norm_overlap=0.9623 corr_cb=-0.5325
[EPOCH 027/089] train: loss=0.7976 acc=73.83% | val: loss=0.6106 acc=71.08% f1=63.64% auc=75.41% val_score=58.7307 val_score_bestthr=58.7307 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.085, mb=0.501, no=0.962, corr=-0.532) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.6846 -> 58.7307
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.0977 mb_mean=0.4951 norm_overlap=0.9751 corr_cb=-0.4605 topkJ=0.0000
[TRAIN][ep=028] loss=0.8029 acc=73.02%
[TRAIN][ep=028] mask_avg: mc_mean=0.0827 mb_mean=0.5015 norm_overlap=0.9617 corr_cb=-0.5255
[EPOCH 028/089] train: loss=0.8029 acc=73.02% | val: loss=0.5676 acc=72.29% f1=71.60% auc=76.63% val_score=62.6120 val_score_bestthr=62.6120 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.083, mb=0.501, no=0.962, corr=-0.526) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.6846 -> 62.6120
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.0849 mb_mean=0.4980 norm_overlap=0.9649 corr_cb=-0.5084 topkJ=0.0000
[TRAIN][ep=029] loss=0.7898 acc=74.90%
[TRAIN][ep=029] mask_avg: mc_mean=0.0738 mb_mean=0.5015 norm_overlap=0.9600 corr_cb=-0.5147
[EPOCH 029/089] train: loss=0.7898 acc=74.90% | val: loss=0.6005 acc=60.24% f1=71.30% auc=78.60% val_score=60.8018 val_score_bestthr=60.8018 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.074, mb=0.501, no=0.960, corr=-0.515) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.6846 -> 60.8018
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.1063 mb_mean=0.4961 norm_overlap=0.9716 corr_cb=-0.5489 topkJ=0.0000
[TRAIN][ep=030] loss=0.7983 acc=71.81%
[TRAIN][ep=030] mask_avg: mc_mean=0.0727 mb_mean=0.5015 norm_overlap=0.9595 corr_cb=-0.5118
[EPOCH 030/089] train: loss=0.7983 acc=71.81% | val: loss=0.5673 acc=72.29% f1=71.60% auc=78.08% val_score=62.6120 val_score_bestthr=62.6120 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.073, mb=0.501, no=0.959, corr=-0.512) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.6846 -> 62.6120
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.0646 mb_mean=0.5019 norm_overlap=0.9617 corr_cb=-0.5112 topkJ=0.0000
[TRAIN][ep=031] loss=0.7760 acc=75.97%
[TRAIN][ep=031] mask_avg: mc_mean=0.0819 mb_mean=0.5015 norm_overlap=0.9611 corr_cb=-0.5271
[EPOCH 031/089] train: loss=0.7760 acc=75.97% | val: loss=0.5639 acc=69.88% f1=69.88% auc=77.50% val_score=60.6790 val_score_bestthr=60.6790 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.527) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.6846 -> 60.6790
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.0818 mb_mean=0.4988 norm_overlap=0.9616 corr_cb=-0.5827 topkJ=0.0000
[TRAIN][ep=032] loss=0.7791 acc=74.90%
[TRAIN][ep=032] mask_avg: mc_mean=0.0902 mb_mean=0.5014 norm_overlap=0.9628 corr_cb=-0.5324
[EPOCH 032/089] train: loss=0.7791 acc=74.90% | val: loss=0.5465 acc=68.67% f1=69.77% auc=78.90% val_score=59.4098 val_score_bestthr=59.4098 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.090, mb=0.501, no=0.963, corr=-0.532) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.6846 -> 59.4098
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1065 mb_mean=0.4952 norm_overlap=0.9737 corr_cb=-0.5146 topkJ=0.0012
[TRAIN][ep=033] loss=0.7704 acc=75.03%
[TRAIN][ep=033] mask_avg: mc_mean=0.0780 mb_mean=0.5014 norm_overlap=0.9608 corr_cb=-0.5114
[EPOCH 033/089] train: loss=0.7704 acc=75.03% | val: loss=0.5840 acc=72.29% f1=68.49% auc=77.03% val_score=54.5230 val_score_bestthr=54.5230 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.078, mb=0.501, no=0.961, corr=-0.511) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.6846 -> 54.5230
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.0995 mb_mean=0.5028 norm_overlap=0.9615 corr_cb=-0.5970 topkJ=0.0000
[TRAIN][ep=034] loss=0.7755 acc=75.17%
[TRAIN][ep=034] mask_avg: mc_mean=0.1002 mb_mean=0.5014 norm_overlap=0.9637 corr_cb=-0.5314
[EPOCH 034/089] train: loss=0.7755 acc=75.17% | val: loss=0.5465 acc=66.27% f1=72.00% auc=78.95% val_score=56.4417 val_score_bestthr=56.4417 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.100, mb=0.501, no=0.964, corr=-0.531) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.6846 -> 56.4417
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.0516 mb_mean=0.5037 norm_overlap=0.9599 corr_cb=-0.4663 topkJ=0.0000
[TRAIN][ep=035] loss=0.7633 acc=76.24%
[TRAIN][ep=035] mask_avg: mc_mean=0.0775 mb_mean=0.5014 norm_overlap=0.9607 corr_cb=-0.5110
[EPOCH 035/089] train: loss=0.7633 acc=76.24% | val: loss=0.5429 acc=72.29% f1=71.60% auc=79.48% val_score=62.3946 val_score_bestthr=62.3946 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.077, mb=0.501, no=0.961, corr=-0.511) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.6846 -> 62.3946
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.0872 mb_mean=0.4983 norm_overlap=0.9615 corr_cb=-0.5504 topkJ=0.0000
[TRAIN][ep=036] loss=0.7706 acc=76.11%
[TRAIN][ep=036] mask_avg: mc_mean=0.0926 mb_mean=0.5015 norm_overlap=0.9630 corr_cb=-0.5302
[EPOCH 036/089] train: loss=0.7706 acc=76.11% | val: loss=0.5417 acc=67.47% f1=69.66% auc=79.65% val_score=58.7572 val_score_bestthr=58.7572 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.093, mb=0.501, no=0.963, corr=-0.530) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.6846 -> 58.7572
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.0640 mb_mean=0.5046 norm_overlap=0.9553 corr_cb=-0.5142 topkJ=0.0000
[TRAIN][ep=037] loss=0.7600 acc=76.24%
[TRAIN][ep=037] mask_avg: mc_mean=0.0816 mb_mean=0.5014 norm_overlap=0.9613 corr_cb=-0.5154
[EPOCH 037/089] train: loss=0.7600 acc=76.24% | val: loss=0.5335 acc=67.47% f1=70.97% auc=80.81% val_score=52.7749 val_score_bestthr=52.7749 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.515) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.6846 -> 52.7749
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.1067 mb_mean=0.4966 norm_overlap=0.9728 corr_cb=-0.5449 topkJ=0.0000
[TRAIN][ep=038] loss=0.7651 acc=73.83%
[TRAIN][ep=038] mask_avg: mc_mean=0.0520 mb_mean=0.5014 norm_overlap=0.9550 corr_cb=-0.4580
[EPOCH 038/089] train: loss=0.7651 acc=73.83% | val: loss=0.5401 acc=75.90% f1=75.00% auc=79.48% val_score=69.8729 val_score_bestthr=69.8729 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.052, mb=0.501, no=0.955, corr=-0.458) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 64.6846 -> 69.8729
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.0459 mb_mean=0.5081 norm_overlap=0.9468 corr_cb=-0.4875 topkJ=0.0000
[TRAIN][ep=039] loss=0.7388 acc=77.85%
[TRAIN][ep=039] mask_avg: mc_mean=0.0878 mb_mean=0.5015 norm_overlap=0.9622 corr_cb=-0.5230
[EPOCH 039/089] train: loss=0.7388 acc=77.85% | val: loss=0.5346 acc=69.88% f1=71.26% auc=80.23% val_score=63.0302 val_score_bestthr=63.0302 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.088, mb=0.501, no=0.962, corr=-0.523) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.8729 -> 63.0302
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.1134 mb_mean=0.5035 norm_overlap=0.9558 corr_cb=-0.6345 topkJ=0.0000
[TRAIN][ep=040] loss=0.8387 acc=77.05%
[TRAIN][ep=040] mask_avg: mc_mean=0.0857 mb_mean=0.5014 norm_overlap=0.9620 corr_cb=-0.5152
[EPOCH 040/089] train: loss=0.8387 acc=77.05% | val: loss=0.5408 acc=66.27% f1=70.83% auc=80.47% val_score=55.2553 val_score_bestthr=55.2553 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.086, mb=0.501, no=0.962, corr=-0.515) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.8729 -> 55.2553
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.0989 mb_mean=0.5010 norm_overlap=0.9575 corr_cb=-0.6034 topkJ=0.0000
[TRAIN][ep=041] loss=0.9156 acc=75.84%
[TRAIN][ep=041] mask_avg: mc_mean=0.0929 mb_mean=0.5014 norm_overlap=0.9632 corr_cb=-0.5248
[EPOCH 041/089] train: loss=0.9156 acc=75.84% | val: loss=0.5539 acc=74.70% f1=71.23% auc=80.47% val_score=61.8865 val_score_bestthr=61.8865 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.093, mb=0.501, no=0.963, corr=-0.525) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.8729 -> 61.8865
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.0964 mb_mean=0.4956 norm_overlap=0.9731 corr_cb=-0.4771 topkJ=0.0000
[TRAIN][ep=042] loss=0.9856 acc=78.66%
[TRAIN][ep=042] mask_avg: mc_mean=0.0946 mb_mean=0.5014 norm_overlap=0.9634 corr_cb=-0.5197
[EPOCH 042/089] train: loss=0.9856 acc=78.66% | val: loss=0.5278 acc=68.67% f1=71.11% auc=81.57% val_score=60.8049 val_score_bestthr=60.8049 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.095, mb=0.501, no=0.963, corr=-0.520) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.8729 -> 60.8049
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.0497 mb_mean=0.4997 norm_overlap=0.9604 corr_cb=-0.4962 topkJ=0.0000
[TRAIN][ep=043] loss=1.0741 acc=75.44%
[TRAIN][ep=043] mask_avg: mc_mean=0.0730 mb_mean=0.5014 norm_overlap=0.9599 corr_cb=-0.4925
[EPOCH 043/089] train: loss=1.0741 acc=75.44% | val: loss=0.6057 acc=69.88% f1=62.69% auc=80.99% val_score=55.0122 val_score_bestthr=55.0122 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.073, mb=0.501, no=0.960, corr=-0.493) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.8729 -> 55.0122
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.0589 mb_mean=0.5072 norm_overlap=0.9522 corr_cb=-0.5213 topkJ=0.0000
[TRAIN][ep=044] loss=0.7320 acc=77.32%
[TRAIN][ep=044] mask_avg: mc_mean=0.0832 mb_mean=0.5015 norm_overlap=0.9615 corr_cb=-0.5123
[EPOCH 044/089] train: loss=0.7320 acc=77.32% | val: loss=0.5618 acc=68.67% f1=75.93% auc=81.40% val_score=71.5991 val_score_bestthr=71.5991 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.083, mb=0.501, no=0.961, corr=-0.512) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 69.8729 -> 71.5991
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.0928 mb_mean=0.4984 norm_overlap=0.9635 corr_cb=-0.4669 topkJ=0.0000
[TRAIN][ep=045] loss=0.7978 acc=79.73%
[TRAIN][ep=045] mask_avg: mc_mean=0.0962 mb_mean=0.5014 norm_overlap=0.9635 corr_cb=-0.5250
[EPOCH 045/089] train: loss=0.7978 acc=79.73% | val: loss=0.5381 acc=68.67% f1=74.00% auc=81.34% val_score=57.4756 val_score_bestthr=57.4756 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.096, mb=0.501, no=0.963, corr=-0.525) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.5991 -> 57.4756
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.1192 mb_mean=0.4955 norm_overlap=0.9718 corr_cb=-0.5069 topkJ=0.0004
[TRAIN][ep=046] loss=0.8761 acc=78.39%
[TRAIN][ep=046] mask_avg: mc_mean=0.0870 mb_mean=0.5015 norm_overlap=0.9619 corr_cb=-0.5093
[EPOCH 046/089] train: loss=0.8761 acc=78.39% | val: loss=0.5830 acc=73.49% f1=68.57% auc=80.12% val_score=54.3627 val_score_bestthr=54.3627 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.087, mb=0.501, no=0.962, corr=-0.509) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.5991 -> 54.3627
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.0911 mb_mean=0.5047 norm_overlap=0.9651 corr_cb=-0.5381 topkJ=0.0000
[TRAIN][ep=047] loss=0.9549 acc=77.45%
[TRAIN][ep=047] mask_avg: mc_mean=0.1039 mb_mean=0.5014 norm_overlap=0.9647 corr_cb=-0.5258
[EPOCH 047/089] train: loss=0.9549 acc=77.45% | val: loss=0.5289 acc=67.47% f1=70.97% auc=81.63% val_score=59.7053 val_score_bestthr=59.7053 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.104, mb=0.501, no=0.965, corr=-0.526) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.5991 -> 59.7053
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.1077 mb_mean=0.4955 norm_overlap=0.9688 corr_cb=-0.5202 topkJ=0.0000
[TRAIN][ep=048] loss=1.0558 acc=76.78%
[TRAIN][ep=048] mask_avg: mc_mean=0.0918 mb_mean=0.5014 norm_overlap=0.9628 corr_cb=-0.5131
[EPOCH 048/089] train: loss=1.0558 acc=76.78% | val: loss=0.5265 acc=72.29% f1=73.56% auc=81.22% val_score=68.0033 val_score_bestthr=68.0033 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.092, mb=0.501, no=0.963, corr=-0.513) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.5991 -> 68.0033
[DBG][ep=049] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.0564 mb_mean=0.5049 norm_overlap=0.9576 corr_cb=-0.4924 topkJ=0.0000
[TRAIN][ep=049] loss=1.1092 acc=77.99%
[TRAIN][ep=049] mask_avg: mc_mean=0.0813 mb_mean=0.5014 norm_overlap=0.9612 corr_cb=-0.5004
[EPOCH 049/089] train: loss=1.1092 acc=77.99% | val: loss=0.5617 acc=73.49% f1=70.27% auc=81.16% val_score=51.8108 val_score_bestthr=51.8108 | dyn(w_pfs=0.100, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.500) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.5991 -> 51.8108
[DBG][ep=050] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.0854 mb_mean=0.5029 norm_overlap=0.9604 corr_cb=-0.4773 topkJ=0.0000
[TRAIN][ep=050] loss=0.7005 acc=80.40%
[TRAIN][ep=050] mask_avg: mc_mean=0.0950 mb_mean=0.5015 norm_overlap=0.9634 corr_cb=-0.5169
[EPOCH 050/089] train: loss=0.7005 acc=80.40% | val: loss=0.5633 acc=73.49% f1=70.27% auc=81.16% val_score=51.8108 val_score_bestthr=51.8108 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.095, mb=0.501, no=0.963, corr=-0.517) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.5991 -> 51.8108
[DBG][ep=051] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.0893 mb_mean=0.5035 norm_overlap=0.9596 corr_cb=-0.5710 topkJ=0.0000
[TRAIN][ep=051] loss=0.6794 acc=80.40%
[TRAIN][ep=051] mask_avg: mc_mean=0.0950 mb_mean=0.5015 norm_overlap=0.9636 corr_cb=-0.5156
[EPOCH 051/089] train: loss=0.6794 acc=80.40% | val: loss=0.5523 acc=77.11% f1=75.32% auc=80.99% val_score=64.8706 val_score_bestthr=64.8706 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.095, mb=0.501, no=0.964, corr=-0.516) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.5991 -> 64.8706
[DBG][ep=052] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.1159 mb_mean=0.4999 norm_overlap=0.9630 corr_cb=-0.5383 topkJ=0.0000
[TRAIN][ep=052] loss=0.6750 acc=81.21%
[TRAIN][ep=052] mask_avg: mc_mean=0.0951 mb_mean=0.5014 norm_overlap=0.9635 corr_cb=-0.5172
[EPOCH 052/089] train: loss=0.6750 acc=81.21% | val: loss=0.5306 acc=72.29% f1=72.94% auc=81.34% val_score=68.5320 val_score_bestthr=68.5320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.095, mb=0.501, no=0.964, corr=-0.517) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.5991 -> 68.5320
[DBG][ep=053] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.0842 mb_mean=0.5085 norm_overlap=0.9475 corr_cb=-0.5193 topkJ=0.0000
[TRAIN][ep=053] loss=0.6746 acc=80.94%
[TRAIN][ep=053] mask_avg: mc_mean=0.0950 mb_mean=0.5015 norm_overlap=0.9635 corr_cb=-0.5178
[EPOCH 053/089] train: loss=0.6746 acc=80.94% | val: loss=0.5290 acc=72.29% f1=72.94% auc=81.57% val_score=68.5320 val_score_bestthr=68.5320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.095, mb=0.501, no=0.963, corr=-0.518) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 71.5991 -> 68.5320
[DBG][ep=054] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=054] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=054] mask(step0): mc_mean=0.0909 mb_mean=0.5047 norm_overlap=0.9576 corr_cb=-0.5155 topkJ=0.0000
[TRAIN][ep=054] loss=0.6766 acc=81.21%
[TRAIN][ep=054] mask_avg: mc_mean=0.0951 mb_mean=0.5014 norm_overlap=0.9634 corr_cb=-0.5183
[EPOCH 054/089] train: loss=0.6766 acc=81.21% | val: loss=0.5469 acc=78.31% f1=76.92% auc=80.93% val_score=72.1570 val_score_bestthr=72.1570 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.095, mb=0.501, no=0.963, corr=-0.518) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 71.5991 -> 72.1570
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=055] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=055] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=055] mask(step0): mc_mean=0.0909 mb_mean=0.5009 norm_overlap=0.9651 corr_cb=-0.5795 topkJ=0.0000
[TRAIN][ep=055] loss=0.6717 acc=80.67%
[TRAIN][ep=055] mask_avg: mc_mean=0.0951 mb_mean=0.5014 norm_overlap=0.9635 corr_cb=-0.5145
[EPOCH 055/089] train: loss=0.6717 acc=80.67% | val: loss=0.5537 acc=75.90% f1=73.68% auc=81.05% val_score=62.3907 val_score_bestthr=62.3907 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.095, mb=0.501, no=0.964, corr=-0.515) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1570 -> 62.3907
[DBG][ep=056] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=056] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=056] mask(step0): mc_mean=0.1028 mb_mean=0.5009 norm_overlap=0.9645 corr_cb=-0.5411 topkJ=0.0000
[TRAIN][ep=056] loss=0.6692 acc=81.74%
[TRAIN][ep=056] mask_avg: mc_mean=0.0950 mb_mean=0.5014 norm_overlap=0.9634 corr_cb=-0.5192
[EPOCH 056/089] train: loss=0.6692 acc=81.74% | val: loss=0.5467 acc=78.31% f1=76.92% auc=81.05% val_score=72.1570 val_score_bestthr=72.1570 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.095, mb=0.501, no=0.963, corr=-0.519) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1570 -> 72.1570
[DBG][ep=057] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=057] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=057] mask(step0): mc_mean=0.1270 mb_mean=0.4930 norm_overlap=0.9780 corr_cb=-0.5085 topkJ=0.0024
[TRAIN][ep=057] loss=0.6739 acc=80.94%
[TRAIN][ep=057] mask_avg: mc_mean=0.0950 mb_mean=0.5014 norm_overlap=0.9633 corr_cb=-0.5191
[EPOCH 057/089] train: loss=0.6739 acc=80.94% | val: loss=0.5500 acc=77.11% f1=75.32% auc=81.10% val_score=64.8706 val_score_bestthr=64.8706 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.095, mb=0.501, no=0.963, corr=-0.519) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1570 -> 64.8706
[DBG][ep=058] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=058] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=058] mask(step0): mc_mean=0.1231 mb_mean=0.5023 norm_overlap=0.9618 corr_cb=-0.5086 topkJ=0.0000
[TRAIN][ep=058] loss=0.6715 acc=81.61%
[TRAIN][ep=058] mask_avg: mc_mean=0.0950 mb_mean=0.5014 norm_overlap=0.9636 corr_cb=-0.5172
[EPOCH 058/089] train: loss=0.6715 acc=81.61% | val: loss=0.5386 acc=75.90% f1=75.00% auc=81.34% val_score=67.4444 val_score_bestthr=67.4444 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.095, mb=0.501, no=0.964, corr=-0.517) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1570 -> 67.4444
[DBG][ep=059] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=059] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=059] mask(step0): mc_mean=0.0941 mb_mean=0.5009 norm_overlap=0.9623 corr_cb=-0.5471 topkJ=0.0000
[TRAIN][ep=059] loss=0.6721 acc=81.21%
[TRAIN][ep=059] mask_avg: mc_mean=0.0950 mb_mean=0.5014 norm_overlap=0.9634 corr_cb=-0.5190
[EPOCH 059/089] train: loss=0.6721 acc=81.21% | val: loss=0.5440 acc=78.31% f1=76.92% auc=81.51% val_score=72.1570 val_score_bestthr=72.1570 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.095, mb=0.501, no=0.963, corr=-0.519) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1570 -> 72.1570
[DBG][ep=060] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=060] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=060] mask(step0): mc_mean=0.0839 mb_mean=0.5029 norm_overlap=0.9638 corr_cb=-0.4879 topkJ=0.0000
[TRAIN][ep=060] loss=0.6701 acc=80.54%
[TRAIN][ep=060] mask_avg: mc_mean=0.0950 mb_mean=0.5015 norm_overlap=0.9634 corr_cb=-0.5179
[EPOCH 060/089] train: loss=0.6701 acc=80.54% | val: loss=0.5383 acc=77.11% f1=75.95% auc=81.40% val_score=69.8061 val_score_bestthr=69.8061 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.095, mb=0.501, no=0.963, corr=-0.518) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1570 -> 69.8061
[DBG][ep=061] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=061] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=061] mask(step0): mc_mean=0.1595 mb_mean=0.4912 norm_overlap=0.9782 corr_cb=-0.4791 topkJ=0.0000
[TRAIN][ep=061] loss=0.6669 acc=80.67%
[TRAIN][ep=061] mask_avg: mc_mean=0.0950 mb_mean=0.5014 norm_overlap=0.9635 corr_cb=-0.5166
[EPOCH 061/089] train: loss=0.6669 acc=80.67% | val: loss=0.5460 acc=75.90% f1=73.68% auc=81.34% val_score=62.3907 val_score_bestthr=62.3907 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.095, mb=0.501, no=0.964, corr=-0.517) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1570 -> 62.3907
[DBG][ep=062] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=062] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=062] mask(step0): mc_mean=0.0669 mb_mean=0.5065 norm_overlap=0.9597 corr_cb=-0.5235 topkJ=0.0000
[TRAIN][ep=062] loss=0.6701 acc=81.21%
[TRAIN][ep=062] mask_avg: mc_mean=0.0951 mb_mean=0.5014 norm_overlap=0.9636 corr_cb=-0.5186
[EPOCH 062/089] train: loss=0.6701 acc=81.21% | val: loss=0.5350 acc=73.49% f1=73.17% auc=81.80% val_score=63.9488 val_score_bestthr=63.9488 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.095, mb=0.501, no=0.964, corr=-0.519) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1570 -> 63.9488
[DBG][ep=063] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=063] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=063] mask(step0): mc_mean=0.0954 mb_mean=0.4998 norm_overlap=0.9703 corr_cb=-0.4876 topkJ=0.0008
[TRAIN][ep=063] loss=0.6681 acc=79.73%
[TRAIN][ep=063] mask_avg: mc_mean=0.0950 mb_mean=0.5014 norm_overlap=0.9635 corr_cb=-0.5184
[EPOCH 063/089] train: loss=0.6681 acc=79.73% | val: loss=0.5370 acc=73.49% f1=73.17% auc=81.74% val_score=63.9488 val_score_bestthr=63.9488 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.095, mb=0.501, no=0.963, corr=-0.518) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1570 -> 63.9488
[DBG][ep=064] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=064] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=064] mask(step0): mc_mean=0.1088 mb_mean=0.4966 norm_overlap=0.9759 corr_cb=-0.4918 topkJ=0.0012
[TRAIN][ep=064] loss=0.6655 acc=81.61%
[TRAIN][ep=064] mask_avg: mc_mean=0.0950 mb_mean=0.5014 norm_overlap=0.9634 corr_cb=-0.5176
[EPOCH 064/089] train: loss=0.6655 acc=81.61% | val: loss=0.5383 acc=74.70% f1=74.07% auc=81.74% val_score=66.3036 val_score_bestthr=66.3036 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.095, mb=0.501, no=0.963, corr=-0.518) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1570 -> 66.3036
[DBG][ep=065] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=065] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=065] mask(step0): mc_mean=0.0893 mb_mean=0.5017 norm_overlap=0.9610 corr_cb=-0.5464 topkJ=0.0000
[TRAIN][ep=065] loss=0.6623 acc=81.07%
[TRAIN][ep=065] mask_avg: mc_mean=0.0950 mb_mean=0.5015 norm_overlap=0.9635 corr_cb=-0.5172
[EPOCH 065/089] train: loss=0.6623 acc=81.07% | val: loss=0.5586 acc=77.11% f1=74.67% auc=81.63% val_score=63.9458 val_score_bestthr=63.9458 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.095, mb=0.501, no=0.964, corr=-0.517) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1570 -> 63.9458
[DBG][ep=066] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=066] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=066] mask(step0): mc_mean=0.1018 mb_mean=0.5007 norm_overlap=0.9677 corr_cb=-0.5447 topkJ=0.0000
[TRAIN][ep=066] loss=0.6639 acc=80.54%
[TRAIN][ep=066] mask_avg: mc_mean=0.0950 mb_mean=0.5015 norm_overlap=0.9633 corr_cb=-0.5194
[EPOCH 066/089] train: loss=0.6639 acc=80.54% | val: loss=0.5423 acc=77.11% f1=75.95% auc=81.74% val_score=69.8061 val_score_bestthr=69.8061 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.095, mb=0.501, no=0.963, corr=-0.519) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1570 -> 69.8061
[DBG][ep=067] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=067] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=067] mask(step0): mc_mean=0.0916 mb_mean=0.5058 norm_overlap=0.9504 corr_cb=-0.5343 topkJ=0.0000
[TRAIN][ep=067] loss=0.6619 acc=81.34%
[TRAIN][ep=067] mask_avg: mc_mean=0.0951 mb_mean=0.5014 norm_overlap=0.9634 corr_cb=-0.5195
[EPOCH 067/089] train: loss=0.6619 acc=81.34% | val: loss=0.5365 acc=73.49% f1=73.17% auc=81.98% val_score=63.9488 val_score_bestthr=63.9488 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.095, mb=0.501, no=0.963, corr=-0.519) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1570 -> 63.9488
[DBG][ep=068] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=068] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=068] mask(step0): mc_mean=0.0841 mb_mean=0.5032 norm_overlap=0.9637 corr_cb=-0.5194 topkJ=0.0008
[TRAIN][ep=068] loss=0.6597 acc=81.21%
[TRAIN][ep=068] mask_avg: mc_mean=0.0951 mb_mean=0.5014 norm_overlap=0.9635 corr_cb=-0.5177
[EPOCH 068/089] train: loss=0.6597 acc=81.21% | val: loss=0.5904 acc=74.70% f1=70.42% auc=81.16% val_score=55.2534 val_score_bestthr=55.2534 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.095, mb=0.501, no=0.963, corr=-0.518) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1570 -> 55.2534
[DBG][ep=069] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=069] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=069] mask(step0): mc_mean=0.1094 mb_mean=0.5002 norm_overlap=0.9627 corr_cb=-0.5893 topkJ=0.0000
[TRAIN][ep=069] loss=0.6697 acc=80.81%
[TRAIN][ep=069] mask_avg: mc_mean=0.0950 mb_mean=0.5014 norm_overlap=0.9635 corr_cb=-0.5179
[EPOCH 069/089] train: loss=0.6697 acc=80.81% | val: loss=0.5352 acc=72.29% f1=72.29% auc=81.92% val_score=62.8146 val_score_bestthr=62.8146 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.095, mb=0.501, no=0.963, corr=-0.518) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1570 -> 62.8146
[DBG][ep=070] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=070] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=070] mask(step0): mc_mean=0.0973 mb_mean=0.4982 norm_overlap=0.9715 corr_cb=-0.5172 topkJ=0.0000
[TRAIN][ep=070] loss=0.6602 acc=81.34%
[TRAIN][ep=070] mask_avg: mc_mean=0.0950 mb_mean=0.5014 norm_overlap=0.9635 corr_cb=-0.5175
[EPOCH 070/089] train: loss=0.6602 acc=81.34% | val: loss=0.5335 acc=73.49% f1=73.81% auc=81.98% val_score=61.2475 val_score_bestthr=61.2475 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.095, mb=0.501, no=0.963, corr=-0.518) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1570 -> 61.2475
[DBG][ep=071] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=071] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=071] mask(step0): mc_mean=0.1088 mb_mean=0.4983 norm_overlap=0.9632 corr_cb=-0.5699 topkJ=0.0004
[TRAIN][ep=071] loss=0.6590 acc=80.81%
[TRAIN][ep=071] mask_avg: mc_mean=0.0950 mb_mean=0.5014 norm_overlap=0.9634 corr_cb=-0.5221
[EPOCH 071/089] train: loss=0.6590 acc=80.81% | val: loss=0.5422 acc=73.49% f1=73.17% auc=81.86% val_score=63.9488 val_score_bestthr=63.9488 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.095, mb=0.501, no=0.963, corr=-0.522) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1570 -> 63.9488
[DBG][ep=072] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=072] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=072] mask(step0): mc_mean=0.0686 mb_mean=0.5071 norm_overlap=0.9583 corr_cb=-0.5018 topkJ=0.0000
[TRAIN][ep=072] loss=0.6557 acc=81.34%
[TRAIN][ep=072] mask_avg: mc_mean=0.0950 mb_mean=0.5015 norm_overlap=0.9634 corr_cb=-0.5176
[EPOCH 072/089] train: loss=0.6557 acc=81.34% | val: loss=0.5514 acc=77.11% f1=75.32% auc=81.69% val_score=64.8706 val_score_bestthr=64.8706 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.095, mb=0.501, no=0.963, corr=-0.518) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1570 -> 64.8706
[DBG][ep=073] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=073] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=073] mask(step0): mc_mean=0.0607 mb_mean=0.5061 norm_overlap=0.9558 corr_cb=-0.5016 topkJ=0.0000
[TRAIN][ep=073] loss=0.6540 acc=81.21%
[TRAIN][ep=073] mask_avg: mc_mean=0.0950 mb_mean=0.5015 norm_overlap=0.9634 corr_cb=-0.5172
[EPOCH 073/089] train: loss=0.6540 acc=81.21% | val: loss=0.5535 acc=75.90% f1=73.68% auc=81.45% val_score=62.3907 val_score_bestthr=62.3907 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.095, mb=0.501, no=0.963, corr=-0.517) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1570 -> 62.3907
[DBG][ep=074] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=074] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=074] mask(step0): mc_mean=0.1168 mb_mean=0.4965 norm_overlap=0.9713 corr_cb=-0.5267 topkJ=0.0000
[TRAIN][ep=074] loss=0.6565 acc=81.21%
[TRAIN][ep=074] mask_avg: mc_mean=0.0950 mb_mean=0.5015 norm_overlap=0.9633 corr_cb=-0.5186
[EPOCH 074/089] train: loss=0.6565 acc=81.21% | val: loss=0.5634 acc=75.90% f1=72.97% auc=81.69% val_score=63.0788 val_score_bestthr=63.0788 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.095, mb=0.501, no=0.963, corr=-0.519) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1570 -> 63.0788
[DBG][ep=075] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=075] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=075] mask(step0): mc_mean=0.0658 mb_mean=0.5054 norm_overlap=0.9632 corr_cb=-0.4600 topkJ=0.0000
[TRAIN][ep=075] loss=0.6568 acc=80.94%
[TRAIN][ep=075] mask_avg: mc_mean=0.0950 mb_mean=0.5014 norm_overlap=0.9635 corr_cb=-0.5188
[EPOCH 075/089] train: loss=0.6568 acc=80.94% | val: loss=0.5345 acc=73.49% f1=73.81% auc=82.09% val_score=61.2475 val_score_bestthr=61.2475 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.095, mb=0.501, no=0.963, corr=-0.519) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1570 -> 61.2475
[DBG][ep=076] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=076] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=076] mask(step0): mc_mean=0.0780 mb_mean=0.5036 norm_overlap=0.9560 corr_cb=-0.4954 topkJ=0.0000
[TRAIN][ep=076] loss=0.6530 acc=81.34%
[TRAIN][ep=076] mask_avg: mc_mean=0.0950 mb_mean=0.5014 norm_overlap=0.9635 corr_cb=-0.5181
[EPOCH 076/089] train: loss=0.6530 acc=81.34% | val: loss=0.5441 acc=74.70% f1=74.07% auc=81.98% val_score=66.3036 val_score_bestthr=66.3036 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.095, mb=0.501, no=0.963, corr=-0.518) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1570 -> 66.3036
[DBG][ep=077] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=077] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=077] mask(step0): mc_mean=0.1426 mb_mean=0.4942 norm_overlap=0.9664 corr_cb=-0.5697 topkJ=0.0000
[TRAIN][ep=077] loss=0.6539 acc=81.74%
[TRAIN][ep=077] mask_avg: mc_mean=0.0950 mb_mean=0.5014 norm_overlap=0.9636 corr_cb=-0.5192
[EPOCH 077/089] train: loss=0.6539 acc=81.74% | val: loss=0.5390 acc=73.49% f1=73.81% auc=81.86% val_score=61.2475 val_score_bestthr=61.2475 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.095, mb=0.501, no=0.964, corr=-0.519) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1570 -> 61.2475
[DBG][ep=078] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=078] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=078] mask(step0): mc_mean=0.0689 mb_mean=0.5049 norm_overlap=0.9530 corr_cb=-0.5526 topkJ=0.0000
[TRAIN][ep=078] loss=0.6476 acc=82.82%
[TRAIN][ep=078] mask_avg: mc_mean=0.0950 mb_mean=0.5015 norm_overlap=0.9633 corr_cb=-0.5189
[EPOCH 078/089] train: loss=0.6476 acc=82.82% | val: loss=0.5557 acc=75.90% f1=73.68% auc=81.51% val_score=62.3907 val_score_bestthr=62.3907 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.095, mb=0.501, no=0.963, corr=-0.519) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1570 -> 62.3907
[DBG][ep=079] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=079] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=079] mask(step0): mc_mean=0.1009 mb_mean=0.5000 norm_overlap=0.9701 corr_cb=-0.5048 topkJ=0.0008
[TRAIN][ep=079] loss=0.6466 acc=81.34%
[TRAIN][ep=079] mask_avg: mc_mean=0.0951 mb_mean=0.5014 norm_overlap=0.9634 corr_cb=-0.5191
[EPOCH 079/089] train: loss=0.6466 acc=81.34% | val: loss=0.5564 acc=75.90% f1=73.68% auc=81.63% val_score=62.3907 val_score_bestthr=62.3907 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.095, mb=0.501, no=0.963, corr=-0.519) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1570 -> 62.3907
[DBG][ep=080] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=080] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=080] mask(step0): mc_mean=0.1191 mb_mean=0.5033 norm_overlap=0.9579 corr_cb=-0.5199 topkJ=0.0000
[TRAIN][ep=080] loss=0.6503 acc=81.34%
[TRAIN][ep=080] mask_avg: mc_mean=0.0950 mb_mean=0.5014 norm_overlap=0.9634 corr_cb=-0.5184
[EPOCH 080/089] train: loss=0.6503 acc=81.34% | val: loss=0.5392 acc=73.49% f1=73.81% auc=81.69% val_score=61.2475 val_score_bestthr=61.2475 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.095, mb=0.501, no=0.963, corr=-0.518) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1570 -> 61.2475
[DBG][ep=081] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=081] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=081] mask(step0): mc_mean=0.1191 mb_mean=0.4976 norm_overlap=0.9758 corr_cb=-0.5200 topkJ=0.0000
[TRAIN][ep=081] loss=0.6529 acc=80.54%
[TRAIN][ep=081] mask_avg: mc_mean=0.0950 mb_mean=0.5014 norm_overlap=0.9633 corr_cb=-0.5190
[EPOCH 081/089] train: loss=0.6529 acc=80.54% | val: loss=0.5415 acc=73.49% f1=73.81% auc=81.74% val_score=61.2475 val_score_bestthr=61.2475 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.095, mb=0.501, no=0.963, corr=-0.519) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1570 -> 61.2475
[DBG][ep=082] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=082] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=082] mask(step0): mc_mean=0.1196 mb_mean=0.4943 norm_overlap=0.9755 corr_cb=-0.4412 topkJ=0.0000
[TRAIN][ep=082] loss=0.6519 acc=81.48%
[TRAIN][ep=082] mask_avg: mc_mean=0.0950 mb_mean=0.5014 norm_overlap=0.9635 corr_cb=-0.5163
[EPOCH 082/089] train: loss=0.6519 acc=81.48% | val: loss=0.5856 acc=74.70% f1=71.23% auc=81.05% val_score=53.3629 val_score_bestthr=53.3629 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.095, mb=0.501, no=0.964, corr=-0.516) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1570 -> 53.3629
[DBG][ep=083] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=083] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=083] mask(step0): mc_mean=0.1070 mb_mean=0.4958 norm_overlap=0.9744 corr_cb=-0.4646 topkJ=0.0024
[TRAIN][ep=083] loss=0.6448 acc=82.01%
[TRAIN][ep=083] mask_avg: mc_mean=0.0950 mb_mean=0.5014 norm_overlap=0.9634 corr_cb=-0.5185
[EPOCH 083/089] train: loss=0.6448 acc=82.01% | val: loss=0.5609 acc=75.90% f1=73.68% auc=81.74% val_score=62.3907 val_score_bestthr=62.3907 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.095, mb=0.501, no=0.963, corr=-0.518) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1570 -> 62.3907
[DBG][ep=084] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=084] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=084] mask(step0): mc_mean=0.0841 mb_mean=0.5021 norm_overlap=0.9581 corr_cb=-0.5773 topkJ=0.0004
[TRAIN][ep=084] loss=0.6470 acc=81.34%
[TRAIN][ep=084] mask_avg: mc_mean=0.0950 mb_mean=0.5014 norm_overlap=0.9635 corr_cb=-0.5177
[EPOCH 084/089] train: loss=0.6470 acc=81.34% | val: loss=0.5374 acc=73.49% f1=73.81% auc=81.92% val_score=61.2475 val_score_bestthr=61.2475 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.095, mb=0.501, no=0.963, corr=-0.518) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1570 -> 61.2475
[EARLY STOP] no improvement for 30 epochs. best_epoch=54
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
=============== FIT DONE ===============
[BEST] epoch=54 | val_acc=78.31% | val_f1=76.92% | val_auc=80.93% | val_score=72.1570 | val_score_bestthr=72.1570
[TEST@BEST] thr_used=0.450 | acc=58.45% f1=60.55% auc=63.70% | SP_sex=3.65% EO_sex=13.91% SP_age=17.70% EO_age=11.34%
[TIME] 1.69 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/summary_fold_0.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4752 mb_mean=0.5091 norm_overlap=0.9996 corr_cb=-0.4004 topkJ=0.0039
[TRAIN][ep=000] loss=0.6932 acc=51.14%
[TRAIN][ep=000] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1325
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4782 mb_mean=0.5028 norm_overlap=0.9999 corr_cb=-0.0933 topkJ=0.0031
[TRAIN][ep=001] loss=0.6927 acc=51.01%
[TRAIN][ep=001] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1283
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4776 mb_mean=0.5098 norm_overlap=0.9997 corr_cb=-0.3755 topkJ=0.0024
[TRAIN][ep=002] loss=0.6906 acc=53.42%
[TRAIN][ep=002] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1407
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4785 mb_mean=0.5037 norm_overlap=1.0000 corr_cb=0.0262 topkJ=0.0152
[TRAIN][ep=003] loss=0.6892 acc=55.84%
[TRAIN][ep=003] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1330
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4760 mb_mean=0.5053 norm_overlap=0.9998 corr_cb=-0.2618 topkJ=0.0459
[TRAIN][ep=004] loss=0.6879 acc=57.32%
[TRAIN][ep=004] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1247
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4794 mb_mean=0.5002 norm_overlap=0.9999 corr_cb=-0.2006 topkJ=0.0064
[TRAIN][ep=005] loss=0.6871 acc=54.09%
[TRAIN][ep=005] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1272
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4760 mb_mean=0.5040 norm_overlap=0.9997 corr_cb=-0.4011 topkJ=0.0113
[TRAIN][ep=006] loss=0.6832 acc=56.24%
[TRAIN][ep=006] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1302
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4758 mb_mean=0.5023 norm_overlap=0.9998 corr_cb=-0.2950 topkJ=0.0024
[TRAIN][ep=007] loss=0.6767 acc=59.19%
[TRAIN][ep=007] mask_avg: mc_mean=0.4785 mb_mean=0.5015 norm_overlap=0.9999 corr_cb=-0.1365
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4784 mb_mean=0.4987 norm_overlap=0.9997 corr_cb=-0.3532 topkJ=0.0048
[TRAIN][ep=008] loss=0.6721 acc=63.89%
[TRAIN][ep=008] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1238
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4781 mb_mean=0.5042 norm_overlap=0.9998 corr_cb=-0.2975 topkJ=0.0188
[TRAIN][ep=009] loss=0.6643 acc=62.55%
[TRAIN][ep=009] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1254
================= FIT START (fold=0) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4787 mb_mean=0.5043 norm_overlap=0.9999 corr_cb=-0.0822 topkJ=0.0502
[TRAIN][ep=000] loss=0.6583 acc=63.62%
[TRAIN][ep=000] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1201
[EPOCH 000/089] train: loss=0.6583 acc=63.62% | val: loss=0.6534 acc=67.47% f1=74.29% auc=71.74% val_score=55.4225 val_score_bestthr=63.3503 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.120) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 63.3503
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4793 mb_mean=0.5022 norm_overlap=0.9998 corr_cb=-0.2365 topkJ=0.0024
[TRAIN][ep=001] loss=0.6517 acc=64.43%
[TRAIN][ep=001] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1274
[EPOCH 001/089] train: loss=0.6517 acc=64.43% | val: loss=0.6599 acc=61.45% f1=72.41% auc=68.49% val_score=47.5336 val_score_bestthr=64.7777 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.127) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 63.3503 -> 64.7777
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4774 mb_mean=0.4982 norm_overlap=1.0000 corr_cb=-0.0324 topkJ=0.0252
[TRAIN][ep=002] loss=0.6471 acc=64.30%
[TRAIN][ep=002] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1182
[EPOCH 002/089] train: loss=0.6471 acc=64.30% | val: loss=0.6414 acc=68.67% f1=75.00% auc=72.44% val_score=47.9380 val_score_bestthr=63.1152 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.118) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.7777 -> 63.1152
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4776 mb_mean=0.5075 norm_overlap=0.9998 corr_cb=-0.2177 topkJ=0.0023
[TRAIN][ep=003] loss=0.6422 acc=64.43%
[TRAIN][ep=003] mask_avg: mc_mean=0.4785 mb_mean=0.5015 norm_overlap=0.9999 corr_cb=-0.1255
[EPOCH 003/089] train: loss=0.6422 acc=64.43% | val: loss=0.6608 acc=63.86% f1=73.68% auc=69.24% val_score=54.7539 val_score_bestthr=65.2221 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.125) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 64.7777 -> 65.2221
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4824 mb_mean=0.4950 norm_overlap=0.9998 corr_cb=-0.2211 topkJ=0.0294
[TRAIN][ep=004] loss=0.6475 acc=62.01%
[TRAIN][ep=004] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1284
[EPOCH 004/089] train: loss=0.6475 acc=62.01% | val: loss=0.6352 acc=69.88% f1=76.19% auc=73.08% val_score=46.9114 val_score_bestthr=64.6846 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.128) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 65.2221 -> 64.6846
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4744 mb_mean=0.5047 norm_overlap=0.9999 corr_cb=-0.0747 topkJ=0.0278
[TRAIN][ep=005] loss=1.3412 acc=65.23%
[TRAIN][ep=005] mask_avg: mc_mean=0.3454 mb_mean=0.5014 norm_overlap=0.9961 corr_cb=-0.6427
[EPOCH 005/089] train: loss=1.3412 acc=65.23% | val: loss=0.6516 acc=68.67% f1=70.45% auc=75.87% val_score=62.4643 val_score_bestthr=63.5854 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.345, mb=0.501, no=0.996, corr=-0.643) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.2221 -> 63.5854
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.1982 mb_mean=0.5118 norm_overlap=0.9863 corr_cb=-0.7998 topkJ=0.0000
[TRAIN][ep=006] loss=1.3178 acc=65.91%
[TRAIN][ep=006] mask_avg: mc_mean=0.1910 mb_mean=0.5014 norm_overlap=0.9885 corr_cb=-0.7196
[EPOCH 006/089] train: loss=1.3178 acc=65.91% | val: loss=0.6379 acc=61.45% f1=71.93% auc=76.51% val_score=65.9943 val_score_bestthr=60.9430 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.191, mb=0.501, no=0.989, corr=-0.720) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.2221 -> 60.9430
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.1507 mb_mean=0.5024 norm_overlap=0.9838 corr_cb=-0.7853 topkJ=0.0000
[TRAIN][ep=007] loss=1.3203 acc=62.68%
[TRAIN][ep=007] mask_avg: mc_mean=0.1238 mb_mean=0.5014 norm_overlap=0.9815 corr_cb=-0.7175
[EPOCH 007/089] train: loss=1.3203 acc=62.68% | val: loss=0.6281 acc=68.67% f1=74.51% auc=74.24% val_score=52.4552 val_score_bestthr=66.3139 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.124, mb=0.501, no=0.982, corr=-0.717) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 65.2221 -> 66.3139
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1087 mb_mean=0.5001 norm_overlap=0.9750 corr_cb=-0.7724 topkJ=0.0000
[TRAIN][ep=008] loss=1.3041 acc=67.25%
[TRAIN][ep=008] mask_avg: mc_mean=0.0808 mb_mean=0.5014 norm_overlap=0.9746 corr_cb=-0.6706
[EPOCH 008/089] train: loss=1.3041 acc=67.25% | val: loss=0.6341 acc=67.47% f1=75.23% auc=73.43% val_score=61.5991 val_score_bestthr=65.3678 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.081, mb=0.501, no=0.975, corr=-0.671) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3139 -> 65.3678
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.0577 mb_mean=0.5043 norm_overlap=0.9721 corr_cb=-0.6652 topkJ=0.0000
[TRAIN][ep=009] loss=1.2832 acc=69.26%
[TRAIN][ep=009] mask_avg: mc_mean=0.0693 mb_mean=0.5014 norm_overlap=0.9703 corr_cb=-0.6316
[EPOCH 009/089] train: loss=1.2832 acc=69.26% | val: loss=0.6049 acc=67.47% f1=73.79% auc=75.81% val_score=49.7236 val_score_bestthr=64.0005 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.069, mb=0.501, no=0.970, corr=-0.632) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3139 -> 64.0005
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.0851 mb_mean=0.4997 norm_overlap=0.9624 corr_cb=-0.6843 topkJ=0.0000
[TRAIN][ep=010] loss=0.9040 acc=67.65%
[TRAIN][ep=010] mask_avg: mc_mean=0.0698 mb_mean=0.5015 norm_overlap=0.9678 corr_cb=-0.6067
[EPOCH 010/089] train: loss=0.9040 acc=67.65% | val: loss=0.6028 acc=71.08% f1=65.71% auc=75.64% val_score=54.5243 val_score_bestthr=64.2616 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.070, mb=0.501, no=0.968, corr=-0.607) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3139 -> 64.2616
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.0924 mb_mean=0.5016 norm_overlap=0.9550 corr_cb=-0.6484 topkJ=0.0000
[TRAIN][ep=011] loss=0.8500 acc=69.93%
[TRAIN][ep=011] mask_avg: mc_mean=0.0609 mb_mean=0.5015 norm_overlap=0.9642 corr_cb=-0.5717
[EPOCH 011/089] train: loss=0.8500 acc=69.93% | val: loss=0.5923 acc=71.08% f1=63.64% auc=75.87% val_score=47.9807 val_score_bestthr=64.4250 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.061, mb=0.501, no=0.964, corr=-0.572) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3139 -> 64.4250
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.0357 mb_mean=0.5072 norm_overlap=0.9622 corr_cb=-0.5394 topkJ=0.0000
[TRAIN][ep=012] loss=0.8501 acc=68.99%
[TRAIN][ep=012] mask_avg: mc_mean=0.0578 mb_mean=0.5014 norm_overlap=0.9622 corr_cb=-0.5488
[EPOCH 012/089] train: loss=0.8501 acc=68.99% | val: loss=0.6282 acc=71.08% f1=64.71% auc=74.01% val_score=51.3437 val_score_bestthr=66.1865 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.058, mb=0.501, no=0.962, corr=-0.549) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3139 -> 66.1865
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.0307 mb_mean=0.5080 norm_overlap=0.9534 corr_cb=-0.3698 topkJ=0.0000
[TRAIN][ep=013] loss=0.8376 acc=71.28%
[TRAIN][ep=013] mask_avg: mc_mean=0.0515 mb_mean=0.5015 norm_overlap=0.9595 corr_cb=-0.5257
[EPOCH 013/089] train: loss=0.8376 acc=71.28% | val: loss=0.5898 acc=72.29% f1=66.67% auc=75.52% val_score=59.7524 val_score_bestthr=66.6238 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.052, mb=0.501, no=0.960, corr=-0.526) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 66.3139 -> 66.6238
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.0578 mb_mean=0.4973 norm_overlap=0.9714 corr_cb=-0.4807 topkJ=0.0024
[TRAIN][ep=014] loss=0.8322 acc=71.41%
[TRAIN][ep=014] mask_avg: mc_mean=0.0518 mb_mean=0.5014 norm_overlap=0.9586 corr_cb=-0.5179
[EPOCH 014/089] train: loss=0.8322 acc=71.41% | val: loss=0.5834 acc=72.29% f1=66.67% auc=75.87% val_score=52.8036 val_score_bestthr=66.6238 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.052, mb=0.501, no=0.959, corr=-0.518) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6238 -> 66.6238
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.0310 mb_mean=0.5043 norm_overlap=0.9558 corr_cb=-0.4273 topkJ=0.0000
[TRAIN][ep=015] loss=0.8195 acc=72.48%
[TRAIN][ep=015] mask_avg: mc_mean=0.0550 mb_mean=0.5014 norm_overlap=0.9588 corr_cb=-0.5189
[EPOCH 015/089] train: loss=0.8195 acc=72.48% | val: loss=0.5739 acc=73.49% f1=68.57% auc=76.51% val_score=54.8728 val_score_bestthr=65.9223 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.055, mb=0.501, no=0.959, corr=-0.519) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6238 -> 65.9223
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.0357 mb_mean=0.5102 norm_overlap=0.9419 corr_cb=-0.5241 topkJ=0.0000
[TRAIN][ep=016] loss=0.8280 acc=71.68%
[TRAIN][ep=016] mask_avg: mc_mean=0.0469 mb_mean=0.5014 norm_overlap=0.9560 corr_cb=-0.4906
[EPOCH 016/089] train: loss=0.8280 acc=71.68% | val: loss=0.5746 acc=73.49% f1=68.57% auc=76.98% val_score=49.0913 val_score_bestthr=65.9223 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.047, mb=0.501, no=0.956, corr=-0.491) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6238 -> 65.9223
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.0578 mb_mean=0.4927 norm_overlap=0.9730 corr_cb=-0.4254 topkJ=0.0008
[TRAIN][ep=017] loss=0.8200 acc=71.28%
[TRAIN][ep=017] mask_avg: mc_mean=0.0426 mb_mean=0.5014 norm_overlap=0.9545 corr_cb=-0.4745
[EPOCH 017/089] train: loss=0.8200 acc=71.28% | val: loss=0.5796 acc=73.49% f1=68.57% auc=76.22% val_score=61.1980 val_score_bestthr=65.9223 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.043, mb=0.501, no=0.955, corr=-0.474) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6238 -> 65.9223
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.0489 mb_mean=0.5052 norm_overlap=0.9473 corr_cb=-0.5286 topkJ=0.0000
[TRAIN][ep=018] loss=0.8057 acc=72.89%
[TRAIN][ep=018] mask_avg: mc_mean=0.0583 mb_mean=0.5014 norm_overlap=0.9578 corr_cb=-0.5140
[EPOCH 018/089] train: loss=0.8057 acc=72.89% | val: loss=0.7115 acc=67.47% f1=73.27% auc=74.53% val_score=51.6446 val_score_bestthr=67.5365 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.058, mb=0.501, no=0.958, corr=-0.514) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 66.6238 -> 67.5365
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.0366 mb_mean=0.4998 norm_overlap=0.9534 corr_cb=-0.4662 topkJ=0.0000
[TRAIN][ep=019] loss=0.8317 acc=70.20%
[TRAIN][ep=019] mask_avg: mc_mean=0.0390 mb_mean=0.5014 norm_overlap=0.9527 corr_cb=-0.4581
[EPOCH 019/089] train: loss=0.8317 acc=70.20% | val: loss=0.6261 acc=67.47% f1=74.77% auc=75.81% val_score=60.2367 val_score_bestthr=66.4819 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.039, mb=0.501, no=0.953, corr=-0.458) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5365 -> 66.4819
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.0767 mb_mean=0.4956 norm_overlap=0.9529 corr_cb=-0.5799 topkJ=0.0000
[TRAIN][ep=020] loss=0.8109 acc=72.75%
[TRAIN][ep=020] mask_avg: mc_mean=0.0454 mb_mean=0.5014 norm_overlap=0.9544 corr_cb=-0.4820
[EPOCH 020/089] train: loss=0.8109 acc=72.75% | val: loss=0.5864 acc=73.49% f1=68.57% auc=76.92% val_score=58.7307 val_score_bestthr=65.9223 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.045, mb=0.501, no=0.954, corr=-0.482) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5365 -> 65.9223
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.0428 mb_mean=0.5057 norm_overlap=0.9444 corr_cb=-0.4632 topkJ=0.0000
[TRAIN][ep=021] loss=0.7920 acc=73.69%
[TRAIN][ep=021] mask_avg: mc_mean=0.0621 mb_mean=0.5014 norm_overlap=0.9577 corr_cb=-0.5219
[EPOCH 021/089] train: loss=0.7920 acc=73.69% | val: loss=0.5901 acc=65.06% f1=73.39% auc=77.27% val_score=58.7307 val_score_bestthr=64.2759 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.062, mb=0.501, no=0.958, corr=-0.522) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5365 -> 64.2759
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.0782 mb_mean=0.4985 norm_overlap=0.9655 corr_cb=-0.4704 topkJ=0.0000
[TRAIN][ep=022] loss=0.7959 acc=73.96%
[TRAIN][ep=022] mask_avg: mc_mean=0.0575 mb_mean=0.5014 norm_overlap=0.9565 corr_cb=-0.5100
[EPOCH 022/089] train: loss=0.7959 acc=73.96% | val: loss=0.5492 acc=66.27% f1=75.00% auc=77.97% val_score=61.2877 val_score_bestthr=69.6680 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.058, mb=0.501, no=0.956, corr=-0.510) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 67.5365 -> 69.6680
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.0439 mb_mean=0.5003 norm_overlap=0.9547 corr_cb=-0.4498 topkJ=0.0000
[TRAIN][ep=023] loss=0.8028 acc=72.62%
[TRAIN][ep=023] mask_avg: mc_mean=0.0458 mb_mean=0.5015 norm_overlap=0.9535 corr_cb=-0.4765
[EPOCH 023/089] train: loss=0.8028 acc=72.62% | val: loss=0.5534 acc=74.70% f1=72.00% auc=78.20% val_score=57.8118 val_score_bestthr=65.3644 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.046, mb=0.501, no=0.953, corr=-0.477) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.6680 -> 65.3644
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.0459 mb_mean=0.5001 norm_overlap=0.9619 corr_cb=-0.3872 topkJ=0.0000
[TRAIN][ep=024] loss=0.7720 acc=75.84%
[TRAIN][ep=024] mask_avg: mc_mean=0.0529 mb_mean=0.5014 norm_overlap=0.9552 corr_cb=-0.4916
[EPOCH 024/089] train: loss=0.7720 acc=75.84% | val: loss=0.5557 acc=75.90% f1=74.36% auc=78.20% val_score=57.1066 val_score_bestthr=68.2337 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.053, mb=0.501, no=0.955, corr=-0.492) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.6680 -> 68.2337
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.0513 mb_mean=0.5013 norm_overlap=0.9564 corr_cb=-0.5423 topkJ=0.0000
[TRAIN][ep=025] loss=0.7915 acc=73.56%
[TRAIN][ep=025] mask_avg: mc_mean=0.0502 mb_mean=0.5014 norm_overlap=0.9542 corr_cb=-0.4823
[EPOCH 025/089] train: loss=0.7915 acc=73.56% | val: loss=0.5552 acc=72.29% f1=72.29% auc=77.09% val_score=64.9703 val_score_bestthr=66.3844 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.050, mb=0.501, no=0.954, corr=-0.482) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.6680 -> 66.3844
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.0380 mb_mean=0.5025 norm_overlap=0.9491 corr_cb=-0.5163 topkJ=0.0000
[TRAIN][ep=026] loss=0.7680 acc=74.50%
[TRAIN][ep=026] mask_avg: mc_mean=0.0574 mb_mean=0.5014 norm_overlap=0.9561 corr_cb=-0.5039
[EPOCH 026/089] train: loss=0.7680 acc=74.50% | val: loss=0.5757 acc=74.70% f1=72.73% auc=78.60% val_score=60.3976 val_score_bestthr=69.5636 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.057, mb=0.501, no=0.956, corr=-0.504) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.6680 -> 69.5636
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.0748 mb_mean=0.5001 norm_overlap=0.9520 corr_cb=-0.5841 topkJ=0.0000
[TRAIN][ep=027] loss=0.7656 acc=74.36%
[TRAIN][ep=027] mask_avg: mc_mean=0.0621 mb_mean=0.5014 norm_overlap=0.9570 corr_cb=-0.5121
[EPOCH 027/089] train: loss=0.7656 acc=74.36% | val: loss=0.6026 acc=72.29% f1=72.94% auc=77.56% val_score=58.7307 val_score_bestthr=69.2820 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.062, mb=0.501, no=0.957, corr=-0.512) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.6680 -> 69.2820
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.0698 mb_mean=0.4951 norm_overlap=0.9720 corr_cb=-0.4182 topkJ=0.0000
[TRAIN][ep=028] loss=0.7629 acc=74.77%
[TRAIN][ep=028] mask_avg: mc_mean=0.0605 mb_mean=0.5015 norm_overlap=0.9566 corr_cb=-0.5049
[EPOCH 028/089] train: loss=0.7629 acc=74.77% | val: loss=0.5534 acc=77.11% f1=76.54% auc=79.24% val_score=58.6883 val_score_bestthr=74.5003 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.061, mb=0.501, no=0.957, corr=-0.505) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 69.6680 -> 74.5003
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.0739 mb_mean=0.4980 norm_overlap=0.9636 corr_cb=-0.5055 topkJ=0.0000
[TRAIN][ep=029] loss=0.7464 acc=78.39%
[TRAIN][ep=029] mask_avg: mc_mean=0.0583 mb_mean=0.5015 norm_overlap=0.9562 corr_cb=-0.5033
[EPOCH 029/089] train: loss=0.7464 acc=78.39% | val: loss=0.6009 acc=68.67% f1=75.93% auc=79.94% val_score=68.9564 val_score_bestthr=71.5991 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.058, mb=0.501, no=0.956, corr=-0.503) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.5003 -> 71.5991
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.0831 mb_mean=0.4961 norm_overlap=0.9685 corr_cb=-0.5516 topkJ=0.0000
[TRAIN][ep=030] loss=0.7515 acc=74.77%
[TRAIN][ep=030] mask_avg: mc_mean=0.0625 mb_mean=0.5015 norm_overlap=0.9569 corr_cb=-0.5109
[EPOCH 030/089] train: loss=0.7515 acc=74.77% | val: loss=0.5415 acc=74.70% f1=74.70% auc=80.17% val_score=64.7481 val_score_bestthr=71.0024 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.062, mb=0.501, no=0.957, corr=-0.511) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.5003 -> 71.0024
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.0587 mb_mean=0.5019 norm_overlap=0.9606 corr_cb=-0.5150 topkJ=0.0000
[TRAIN][ep=031] loss=0.7323 acc=77.32%
[TRAIN][ep=031] mask_avg: mc_mean=0.0656 mb_mean=0.5015 norm_overlap=0.9576 corr_cb=-0.5162
[EPOCH 031/089] train: loss=0.7323 acc=77.32% | val: loss=0.5481 acc=75.90% f1=75.61% auc=79.07% val_score=63.4226 val_score_bestthr=73.9054 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.066, mb=0.501, no=0.958, corr=-0.516) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.5003 -> 73.9054
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.0598 mb_mean=0.4988 norm_overlap=0.9566 corr_cb=-0.5753 topkJ=0.0000
[TRAIN][ep=032] loss=0.7402 acc=78.12%
[TRAIN][ep=032] mask_avg: mc_mean=0.0672 mb_mean=0.5014 norm_overlap=0.9583 corr_cb=-0.5129
[EPOCH 032/089] train: loss=0.7402 acc=78.12% | val: loss=0.5520 acc=75.90% f1=75.00% auc=80.35% val_score=58.9681 val_score_bestthr=76.0656 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.067, mb=0.501, no=0.958, corr=-0.513) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 74.5003 -> 76.0656
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.0782 mb_mean=0.4952 norm_overlap=0.9705 corr_cb=-0.4889 topkJ=0.0004
[TRAIN][ep=033] loss=0.7210 acc=77.05%
[TRAIN][ep=033] mask_avg: mc_mean=0.0636 mb_mean=0.5014 norm_overlap=0.9576 corr_cb=-0.5008
[EPOCH 033/089] train: loss=0.7210 acc=77.05% | val: loss=0.5576 acc=74.70% f1=75.86% auc=79.83% val_score=54.5230 val_score_bestthr=76.0816 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.064, mb=0.501, no=0.958, corr=-0.501) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 76.0656 -> 76.0816
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.0871 mb_mean=0.5028 norm_overlap=0.9593 corr_cb=-0.6038 topkJ=0.0000
[TRAIN][ep=034] loss=0.7229 acc=75.70%
[TRAIN][ep=034] mask_avg: mc_mean=0.0789 mb_mean=0.5014 norm_overlap=0.9597 corr_cb=-0.5176
[EPOCH 034/089] train: loss=0.7229 acc=75.70% | val: loss=0.5381 acc=71.08% f1=73.91% auc=79.88% val_score=62.0977 val_score_bestthr=72.1808 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.079, mb=0.501, no=0.960, corr=-0.518) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.0816 -> 72.1808
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.0384 mb_mean=0.5037 norm_overlap=0.9557 corr_cb=-0.4432 topkJ=0.0000
[TRAIN][ep=035] loss=0.7111 acc=80.00%
[TRAIN][ep=035] mask_avg: mc_mean=0.0658 mb_mean=0.5014 norm_overlap=0.9580 corr_cb=-0.5039
[EPOCH 035/089] train: loss=0.7111 acc=80.00% | val: loss=0.5296 acc=75.90% f1=79.17% auc=81.80% val_score=57.5059 val_score_bestthr=77.3717 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.066, mb=0.501, no=0.958, corr=-0.504) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 76.0816 -> 77.3717
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.0690 mb_mean=0.4983 norm_overlap=0.9578 corr_cb=-0.5415 topkJ=0.0000
[TRAIN][ep=036] loss=0.7198 acc=77.99%
[TRAIN][ep=036] mask_avg: mc_mean=0.0728 mb_mean=0.5015 norm_overlap=0.9591 corr_cb=-0.5167
[EPOCH 036/089] train: loss=0.7198 acc=77.99% | val: loss=0.5646 acc=73.49% f1=77.55% auc=80.99% val_score=55.9281 val_score_bestthr=74.5060 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.073, mb=0.501, no=0.959, corr=-0.517) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 77.3717 -> 74.5060
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.0444 mb_mean=0.5046 norm_overlap=0.9512 corr_cb=-0.4953 topkJ=0.0000
[TRAIN][ep=037] loss=0.7066 acc=78.66%
[TRAIN][ep=037] mask_avg: mc_mean=0.0700 mb_mean=0.5014 norm_overlap=0.9586 corr_cb=-0.5094
[EPOCH 037/089] train: loss=0.7066 acc=78.66% | val: loss=0.5576 acc=71.08% f1=74.47% auc=81.69% val_score=55.0122 val_score_bestthr=75.4451 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.070, mb=0.501, no=0.959, corr=-0.509) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 77.3717 -> 75.4451
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.0750 mb_mean=0.4966 norm_overlap=0.9680 corr_cb=-0.5346 topkJ=0.0000
[TRAIN][ep=038] loss=0.7262 acc=77.45%
[TRAIN][ep=038] mask_avg: mc_mean=0.0418 mb_mean=0.5014 norm_overlap=0.9520 corr_cb=-0.4333
[EPOCH 038/089] train: loss=0.7262 acc=77.45% | val: loss=0.5310 acc=72.29% f1=74.73% auc=81.28% val_score=65.3839 val_score_bestthr=75.2466 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.042, mb=0.501, no=0.952, corr=-0.433) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 77.3717 -> 75.2466
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.0424 mb_mean=0.5081 norm_overlap=0.9450 corr_cb=-0.5072 topkJ=0.0000
[TRAIN][ep=039] loss=0.6819 acc=80.94%
[TRAIN][ep=039] mask_avg: mc_mean=0.0791 mb_mean=0.5015 norm_overlap=0.9603 corr_cb=-0.5234
[EPOCH 039/089] train: loss=0.6819 acc=80.94% | val: loss=0.5294 acc=75.90% f1=77.27% auc=82.09% val_score=69.8061 val_score_bestthr=76.2758 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.079, mb=0.501, no=0.960, corr=-0.523) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 77.3717 -> 76.2758
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.1033 mb_mean=0.5035 norm_overlap=0.9532 corr_cb=-0.6348 topkJ=0.0000
[TRAIN][ep=040] loss=0.6903 acc=79.46%
[TRAIN][ep=040] mask_avg: mc_mean=0.0755 mb_mean=0.5014 norm_overlap=0.9600 corr_cb=-0.5104
[EPOCH 040/089] train: loss=0.6903 acc=79.46% | val: loss=0.5557 acc=77.11% f1=76.54% auc=81.69% val_score=69.4162 val_score_bestthr=75.6597 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.076, mb=0.501, no=0.960, corr=-0.510) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 77.3717 -> 75.6597
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.0939 mb_mean=0.5010 norm_overlap=0.9557 corr_cb=-0.6081 topkJ=0.0000
[TRAIN][ep=041] loss=0.6971 acc=77.99%
[TRAIN][ep=041] mask_avg: mc_mean=0.0749 mb_mean=0.5014 norm_overlap=0.9596 corr_cb=-0.5078
[EPOCH 041/089] train: loss=0.6971 acc=77.99% | val: loss=0.5436 acc=74.70% f1=76.40% auc=82.15% val_score=66.4816 val_score_bestthr=76.2849 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.075, mb=0.501, no=0.960, corr=-0.508) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 77.3717 -> 76.2849
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.0828 mb_mean=0.4956 norm_overlap=0.9719 corr_cb=-0.4713 topkJ=0.0000
[TRAIN][ep=042] loss=0.6866 acc=80.54%
[TRAIN][ep=042] mask_avg: mc_mean=0.0806 mb_mean=0.5014 norm_overlap=0.9606 corr_cb=-0.5073
[EPOCH 042/089] train: loss=0.6866 acc=80.54% | val: loss=0.5240 acc=74.70% f1=75.86% auc=82.67% val_score=62.3828 val_score_bestthr=75.7603 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.507) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 77.3717 -> 75.7603
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.0396 mb_mean=0.4997 norm_overlap=0.9589 corr_cb=-0.4704 topkJ=0.0000
[TRAIN][ep=043] loss=0.6870 acc=77.72%
[TRAIN][ep=043] mask_avg: mc_mean=0.0692 mb_mean=0.5014 norm_overlap=0.9591 corr_cb=-0.4911
[EPOCH 043/089] train: loss=0.6870 acc=77.72% | val: loss=0.6643 acc=77.11% f1=79.57% auc=82.38% val_score=52.4567 val_score_bestthr=79.3644 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.069, mb=0.501, no=0.959, corr=-0.491) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 77.3717 -> 79.3644
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.0510 mb_mean=0.5072 norm_overlap=0.9505 corr_cb=-0.5173 topkJ=0.0000
[TRAIN][ep=044] loss=0.6690 acc=80.00%
[TRAIN][ep=044] mask_avg: mc_mean=0.0793 mb_mean=0.5015 norm_overlap=0.9608 corr_cb=-0.5120
[EPOCH 044/089] train: loss=0.6690 acc=80.00% | val: loss=0.5445 acc=74.70% f1=77.89% auc=82.33% val_score=67.0877 val_score_bestthr=73.4753 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.079, mb=0.501, no=0.961, corr=-0.512) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3644 -> 73.4753
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.0816 mb_mean=0.4984 norm_overlap=0.9614 corr_cb=-0.4576 topkJ=0.0000
[TRAIN][ep=045] loss=0.6548 acc=81.88%
[TRAIN][ep=045] mask_avg: mc_mean=0.0843 mb_mean=0.5014 norm_overlap=0.9614 corr_cb=-0.5139
[EPOCH 045/089] train: loss=0.6548 acc=81.88% | val: loss=0.5634 acc=75.90% f1=79.17% auc=82.79% val_score=70.5913 val_score_bestthr=76.7960 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.084, mb=0.501, no=0.961, corr=-0.514) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3644 -> 76.7960
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.1047 mb_mean=0.4955 norm_overlap=0.9703 corr_cb=-0.4983 topkJ=0.0000
[TRAIN][ep=046] loss=0.7246 acc=80.67%
[TRAIN][ep=046] mask_avg: mc_mean=0.0776 mb_mean=0.5015 norm_overlap=0.9600 corr_cb=-0.4992
[EPOCH 046/089] train: loss=0.7246 acc=80.67% | val: loss=0.6096 acc=79.52% f1=79.52% auc=82.38% val_score=55.9281 val_score_bestthr=74.9962 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.078, mb=0.501, no=0.960, corr=-0.499) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3644 -> 74.9962
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.0780 mb_mean=0.5047 norm_overlap=0.9633 corr_cb=-0.5337 topkJ=0.0000
[TRAIN][ep=047] loss=0.6491 acc=80.67%
[TRAIN][ep=047] mask_avg: mc_mean=0.0891 mb_mean=0.5014 norm_overlap=0.9622 corr_cb=-0.5131
[EPOCH 047/089] train: loss=0.6491 acc=80.67% | val: loss=0.5597 acc=75.90% f1=80.00% auc=82.33% val_score=74.3383 val_score_bestthr=78.9398 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.089, mb=0.501, no=0.962, corr=-0.513) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3644 -> 78.9398
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.0894 mb_mean=0.4955 norm_overlap=0.9677 corr_cb=-0.4921 topkJ=0.0000
[TRAIN][ep=048] loss=0.7387 acc=81.07%
[TRAIN][ep=048] mask_avg: mc_mean=0.0829 mb_mean=0.5014 norm_overlap=0.9610 corr_cb=-0.5057
[EPOCH 048/089] train: loss=0.7387 acc=81.07% | val: loss=0.5408 acc=77.11% f1=76.54% auc=81.74% val_score=70.4671 val_score_bestthr=74.5003 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.083, mb=0.501, no=0.961, corr=-0.506) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3644 -> 74.5003
[DBG][ep=049] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.0471 mb_mean=0.5049 norm_overlap=0.9566 corr_cb=-0.4729 topkJ=0.0000
[TRAIN][ep=049] loss=0.6395 acc=81.48%
[TRAIN][ep=049] mask_avg: mc_mean=0.0758 mb_mean=0.5014 norm_overlap=0.9601 corr_cb=-0.4955
[EPOCH 049/089] train: loss=0.6395 acc=81.48% | val: loss=0.6200 acc=71.08% f1=76.92% auc=81.86% val_score=55.9281 val_score_bestthr=75.3926 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.076, mb=0.501, no=0.960, corr=-0.496) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3644 -> 75.3926
[DBG][ep=050] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.0730 mb_mean=0.5029 norm_overlap=0.9578 corr_cb=-0.4627 topkJ=0.0000
[TRAIN][ep=050] loss=0.6074 acc=84.97%
[TRAIN][ep=050] mask_avg: mc_mean=0.0814 mb_mean=0.5015 norm_overlap=0.9610 corr_cb=-0.5037
[EPOCH 050/089] train: loss=0.6074 acc=84.97% | val: loss=0.5917 acc=74.70% f1=78.35% auc=81.69% val_score=53.6990 val_score_bestthr=76.3235 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.504) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3644 -> 76.3235
[DBG][ep=051] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.0770 mb_mean=0.5035 norm_overlap=0.9572 corr_cb=-0.5478 topkJ=0.0000
[TRAIN][ep=051] loss=0.6059 acc=84.97%
[TRAIN][ep=051] mask_avg: mc_mean=0.0815 mb_mean=0.5015 norm_overlap=0.9612 corr_cb=-0.5018
[EPOCH 051/089] train: loss=0.6059 acc=84.97% | val: loss=0.5744 acc=74.70% f1=77.89% auc=81.69% val_score=58.8580 val_score_bestthr=73.9970 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.502) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3644 -> 73.9970
[DBG][ep=052] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.1059 mb_mean=0.4999 norm_overlap=0.9608 corr_cb=-0.5223 topkJ=0.0000
[TRAIN][ep=052] loss=0.6022 acc=85.91%
[TRAIN][ep=052] mask_avg: mc_mean=0.0815 mb_mean=0.5014 norm_overlap=0.9611 corr_cb=-0.5034
[EPOCH 052/089] train: loss=0.6022 acc=85.91% | val: loss=0.5531 acc=74.70% f1=77.89% auc=81.69% val_score=67.6328 val_score_bestthr=74.8086 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.503) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3644 -> 74.8086
[DBG][ep=053] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.0745 mb_mean=0.5085 norm_overlap=0.9439 corr_cb=-0.5067 topkJ=0.0000
[TRAIN][ep=053] loss=0.6005 acc=84.43%
[TRAIN][ep=053] mask_avg: mc_mean=0.0814 mb_mean=0.5015 norm_overlap=0.9611 corr_cb=-0.5043
[EPOCH 053/089] train: loss=0.6005 acc=84.43% | val: loss=0.5526 acc=73.49% f1=77.55% auc=81.92% val_score=68.1889 val_score_bestthr=76.4190 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.504) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3644 -> 76.4190
[DBG][ep=054] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=054] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=054] mask(step0): mc_mean=0.0763 mb_mean=0.5047 norm_overlap=0.9553 corr_cb=-0.4915 topkJ=0.0000
[TRAIN][ep=054] loss=0.6019 acc=84.70%
[TRAIN][ep=054] mask_avg: mc_mean=0.0815 mb_mean=0.5014 norm_overlap=0.9609 corr_cb=-0.5046
[EPOCH 054/089] train: loss=0.6019 acc=84.70% | val: loss=0.5758 acc=72.29% f1=76.77% auc=81.28% val_score=58.8580 val_score_bestthr=74.6040 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.505) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3644 -> 74.6040
[DBG][ep=055] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=055] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=055] mask(step0): mc_mean=0.0751 mb_mean=0.5009 norm_overlap=0.9623 corr_cb=-0.5682 topkJ=0.0000
[TRAIN][ep=055] loss=0.5964 acc=85.37%
[TRAIN][ep=055] mask_avg: mc_mean=0.0816 mb_mean=0.5014 norm_overlap=0.9611 corr_cb=-0.5009
[EPOCH 055/089] train: loss=0.5964 acc=85.37% | val: loss=0.5824 acc=73.49% f1=77.55% auc=81.51% val_score=58.8580 val_score_bestthr=75.7234 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.501) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3644 -> 75.7234
[DBG][ep=056] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=056] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=056] mask(step0): mc_mean=0.0928 mb_mean=0.5009 norm_overlap=0.9630 corr_cb=-0.5249 topkJ=0.0000
[TRAIN][ep=056] loss=0.5920 acc=85.23%
[TRAIN][ep=056] mask_avg: mc_mean=0.0815 mb_mean=0.5014 norm_overlap=0.9609 corr_cb=-0.5061
[EPOCH 056/089] train: loss=0.5920 acc=85.23% | val: loss=0.5697 acc=73.49% f1=77.55% auc=81.45% val_score=67.7710 val_score_bestthr=75.7234 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.506) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3644 -> 75.7234
[DBG][ep=057] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=057] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=057] mask(step0): mc_mean=0.1167 mb_mean=0.4930 norm_overlap=0.9768 corr_cb=-0.5049 topkJ=0.0032
[TRAIN][ep=057] loss=0.5982 acc=85.23%
[TRAIN][ep=057] mask_avg: mc_mean=0.0815 mb_mean=0.5014 norm_overlap=0.9608 corr_cb=-0.5053
[EPOCH 057/089] train: loss=0.5982 acc=85.23% | val: loss=0.5683 acc=72.29% f1=76.77% auc=81.45% val_score=67.7710 val_score_bestthr=74.6040 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.505) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3644 -> 74.6040
[DBG][ep=058] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=058] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=058] mask(step0): mc_mean=0.1131 mb_mean=0.5023 norm_overlap=0.9607 corr_cb=-0.5001 topkJ=0.0000
[TRAIN][ep=058] loss=0.5951 acc=85.10%
[TRAIN][ep=058] mask_avg: mc_mean=0.0815 mb_mean=0.5014 norm_overlap=0.9610 corr_cb=-0.5040
[EPOCH 058/089] train: loss=0.5951 acc=85.10% | val: loss=0.5686 acc=72.29% f1=76.77% auc=81.16% val_score=67.7710 val_score_bestthr=74.6040 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.504) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3644 -> 74.6040
[DBG][ep=059] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=059] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=059] mask(step0): mc_mean=0.0775 mb_mean=0.5009 norm_overlap=0.9581 corr_cb=-0.5542 topkJ=0.0000
[TRAIN][ep=059] loss=0.5994 acc=84.70%
[TRAIN][ep=059] mask_avg: mc_mean=0.0814 mb_mean=0.5014 norm_overlap=0.9610 corr_cb=-0.5054
[EPOCH 059/089] train: loss=0.5994 acc=84.70% | val: loss=0.5927 acc=77.11% f1=76.54% auc=81.45% val_score=62.3641 val_score_bestthr=75.7177 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.505) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3644 -> 75.7177
[DBG][ep=060] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=060] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=060] mask(step0): mc_mean=0.0653 mb_mean=0.5029 norm_overlap=0.9618 corr_cb=-0.4717 topkJ=0.0000
[TRAIN][ep=060] loss=0.5922 acc=85.50%
[TRAIN][ep=060] mask_avg: mc_mean=0.0814 mb_mean=0.5015 norm_overlap=0.9609 corr_cb=-0.5045
[EPOCH 060/089] train: loss=0.5922 acc=85.50% | val: loss=0.5896 acc=74.70% f1=78.79% auc=81.40% val_score=58.4318 val_score_bestthr=75.5517 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.504) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3644 -> 75.5517
[DBG][ep=061] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=061] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=061] mask(step0): mc_mean=0.1477 mb_mean=0.4912 norm_overlap=0.9770 corr_cb=-0.4802 topkJ=0.0000
[TRAIN][ep=061] loss=0.5919 acc=84.83%
[TRAIN][ep=061] mask_avg: mc_mean=0.0815 mb_mean=0.5014 norm_overlap=0.9611 corr_cb=-0.5028
[EPOCH 061/089] train: loss=0.5919 acc=84.83% | val: loss=0.5789 acc=74.70% f1=78.79% auc=81.69% val_score=58.4318 val_score_bestthr=75.5517 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.503) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3644 -> 75.5517
[DBG][ep=062] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=062] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=062] mask(step0): mc_mean=0.0490 mb_mean=0.5065 norm_overlap=0.9576 corr_cb=-0.4829 topkJ=0.0000
[TRAIN][ep=062] loss=0.5913 acc=85.23%
[TRAIN][ep=062] mask_avg: mc_mean=0.0815 mb_mean=0.5014 norm_overlap=0.9611 corr_cb=-0.5051
[EPOCH 062/089] train: loss=0.5913 acc=85.23% | val: loss=0.5656 acc=73.49% f1=77.55% auc=81.86% val_score=68.1889 val_score_bestthr=76.4190 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.505) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3644 -> 76.4190
[DBG][ep=063] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=063] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=063] mask(step0): mc_mean=0.0790 mb_mean=0.4998 norm_overlap=0.9688 corr_cb=-0.4701 topkJ=0.0008
[TRAIN][ep=063] loss=0.5932 acc=84.70%
[TRAIN][ep=063] mask_avg: mc_mean=0.0815 mb_mean=0.5014 norm_overlap=0.9610 corr_cb=-0.5056
[EPOCH 063/089] train: loss=0.5932 acc=84.70% | val: loss=0.5752 acc=72.29% f1=76.77% auc=81.45% val_score=66.6278 val_score_bestthr=74.6040 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.506) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3644 -> 74.6040
[DBG][ep=064] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=064] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=064] mask(step0): mc_mean=0.0963 mb_mean=0.4966 norm_overlap=0.9751 corr_cb=-0.4724 topkJ=0.0035
[TRAIN][ep=064] loss=0.5869 acc=86.31%
[TRAIN][ep=064] mask_avg: mc_mean=0.0815 mb_mean=0.5014 norm_overlap=0.9609 corr_cb=-0.5044
[EPOCH 064/089] train: loss=0.5869 acc=86.31% | val: loss=0.5787 acc=74.70% f1=77.89% auc=81.57% val_score=59.3378 val_score_bestthr=74.8086 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.504) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3644 -> 74.8086
[DBG][ep=065] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=065] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=065] mask(step0): mc_mean=0.0765 mb_mean=0.5017 norm_overlap=0.9590 corr_cb=-0.5338 topkJ=0.0000
[TRAIN][ep=065] loss=0.5827 acc=85.23%
[TRAIN][ep=065] mask_avg: mc_mean=0.0814 mb_mean=0.5015 norm_overlap=0.9611 corr_cb=-0.5036
[EPOCH 065/089] train: loss=0.5827 acc=85.23% | val: loss=0.6227 acc=77.11% f1=76.54% auc=81.16% val_score=55.2534 val_score_bestthr=75.7177 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.504) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3644 -> 75.7177
[DBG][ep=066] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=066] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=066] mask(step0): mc_mean=0.0889 mb_mean=0.5007 norm_overlap=0.9651 corr_cb=-0.5460 topkJ=0.0000
[TRAIN][ep=066] loss=0.5838 acc=85.23%
[TRAIN][ep=066] mask_avg: mc_mean=0.0814 mb_mean=0.5015 norm_overlap=0.9608 corr_cb=-0.5066
[EPOCH 066/089] train: loss=0.5838 acc=85.23% | val: loss=0.5839 acc=74.70% f1=77.89% auc=81.16% val_score=58.4318 val_score_bestthr=74.8086 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.507) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3644 -> 74.8086
[DBG][ep=067] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=067] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=067] mask(step0): mc_mean=0.0802 mb_mean=0.5058 norm_overlap=0.9479 corr_cb=-0.5310 topkJ=0.0000
[TRAIN][ep=067] loss=0.5817 acc=85.64%
[TRAIN][ep=067] mask_avg: mc_mean=0.0815 mb_mean=0.5014 norm_overlap=0.9609 corr_cb=-0.5068
[EPOCH 067/089] train: loss=0.5817 acc=85.64% | val: loss=0.5770 acc=75.90% f1=78.72% auc=81.40% val_score=71.6845 val_score_bestthr=75.9348 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.507) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3644 -> 75.9348
[DBG][ep=068] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=068] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=068] mask(step0): mc_mean=0.0719 mb_mean=0.5032 norm_overlap=0.9604 corr_cb=-0.5265 topkJ=0.0004
[TRAIN][ep=068] loss=0.5786 acc=85.64%
[TRAIN][ep=068] mask_avg: mc_mean=0.0816 mb_mean=0.5014 norm_overlap=0.9609 corr_cb=-0.5039
[EPOCH 068/089] train: loss=0.5786 acc=85.64% | val: loss=0.6753 acc=74.70% f1=77.89% auc=80.70% val_score=57.7340 val_score_bestthr=73.9970 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.504) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3644 -> 73.9970
[DBG][ep=069] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=069] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=069] mask(step0): mc_mean=0.0975 mb_mean=0.5002 norm_overlap=0.9610 corr_cb=-0.5783 topkJ=0.0000
[TRAIN][ep=069] loss=0.5904 acc=84.83%
[TRAIN][ep=069] mask_avg: mc_mean=0.0815 mb_mean=0.5014 norm_overlap=0.9610 corr_cb=-0.5042
[EPOCH 069/089] train: loss=0.5904 acc=84.83% | val: loss=0.5713 acc=73.49% f1=77.55% auc=81.51% val_score=73.2884 val_score_bestthr=76.4190 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.504) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3644 -> 76.4190
[DBG][ep=070] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=070] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=070] mask(step0): mc_mean=0.0826 mb_mean=0.4982 norm_overlap=0.9700 corr_cb=-0.5062 topkJ=0.0000
[TRAIN][ep=070] loss=0.5814 acc=86.44%
[TRAIN][ep=070] mask_avg: mc_mean=0.0814 mb_mean=0.5014 norm_overlap=0.9610 corr_cb=-0.5040
[EPOCH 070/089] train: loss=0.5814 acc=86.44% | val: loss=0.5748 acc=73.49% f1=77.55% auc=81.22% val_score=72.2198 val_score_bestthr=76.4190 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.504) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3644 -> 76.4190
[DBG][ep=071] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=071] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=071] mask(step0): mc_mean=0.0944 mb_mean=0.4983 norm_overlap=0.9596 corr_cb=-0.5686 topkJ=0.0000
[TRAIN][ep=071] loss=0.5797 acc=85.50%
[TRAIN][ep=071] mask_avg: mc_mean=0.0814 mb_mean=0.5014 norm_overlap=0.9609 corr_cb=-0.5087
[EPOCH 071/089] train: loss=0.5797 acc=85.50% | val: loss=0.5851 acc=74.70% f1=77.89% auc=80.99% val_score=69.3263 val_score_bestthr=74.8086 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.509) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3644 -> 74.8086
[DBG][ep=072] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=072] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=072] mask(step0): mc_mean=0.0559 mb_mean=0.5071 norm_overlap=0.9548 corr_cb=-0.4943 topkJ=0.0000
[TRAIN][ep=072] loss=0.5769 acc=86.58%
[TRAIN][ep=072] mask_avg: mc_mean=0.0815 mb_mean=0.5015 norm_overlap=0.9609 corr_cb=-0.5045
[EPOCH 072/089] train: loss=0.5769 acc=86.58% | val: loss=0.6015 acc=75.90% f1=78.72% auc=80.99% val_score=58.4318 val_score_bestthr=75.9348 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.504) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3644 -> 75.9348
[DBG][ep=073] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=073] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=073] mask(step0): mc_mean=0.0473 mb_mean=0.5061 norm_overlap=0.9527 corr_cb=-0.4862 topkJ=0.0000
[TRAIN][ep=073] loss=0.5742 acc=86.31%
[TRAIN][ep=073] mask_avg: mc_mean=0.0814 mb_mean=0.5015 norm_overlap=0.9610 corr_cb=-0.5033
[EPOCH 073/089] train: loss=0.5742 acc=86.31% | val: loss=0.6078 acc=73.49% f1=77.08% auc=80.76% val_score=58.4318 val_score_bestthr=72.8734 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.503) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3644 -> 72.8734
[EARLY STOP] no improvement for 30 epochs. best_epoch=43
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
=============== FIT DONE ===============
[BEST] epoch=43 | val_acc=77.11% | val_f1=79.57% | val_auc=82.38% | val_score=52.4567 | val_score_bestthr=79.3644
[TEST@BEST] thr_used=0.100 | acc=57.49% f1=67.41% auc=64.44% | SP_sex=11.25% EO_sex=4.42% SP_age=8.47% EO_age=11.06%
[TIME] 1.60 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/summary_fold_0.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4752 mb_mean=0.5091 norm_overlap=0.9996 corr_cb=-0.4004 topkJ=0.0039
[TRAIN][ep=000] loss=0.6932 acc=51.14%
[TRAIN][ep=000] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1325
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4782 mb_mean=0.5028 norm_overlap=0.9999 corr_cb=-0.0933 topkJ=0.0031
[TRAIN][ep=001] loss=0.6927 acc=51.01%
[TRAIN][ep=001] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1283
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4776 mb_mean=0.5098 norm_overlap=0.9997 corr_cb=-0.3755 topkJ=0.0024
[TRAIN][ep=002] loss=0.6906 acc=53.42%
[TRAIN][ep=002] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1407
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4785 mb_mean=0.5037 norm_overlap=1.0000 corr_cb=0.0262 topkJ=0.0152
[TRAIN][ep=003] loss=0.6892 acc=55.84%
[TRAIN][ep=003] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1330
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4760 mb_mean=0.5053 norm_overlap=0.9998 corr_cb=-0.2618 topkJ=0.0459
[TRAIN][ep=004] loss=0.6879 acc=57.32%
[TRAIN][ep=004] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1247
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4794 mb_mean=0.5002 norm_overlap=0.9999 corr_cb=-0.2006 topkJ=0.0064
[TRAIN][ep=005] loss=0.6871 acc=54.09%
[TRAIN][ep=005] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1272
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4760 mb_mean=0.5040 norm_overlap=0.9997 corr_cb=-0.4011 topkJ=0.0113
[TRAIN][ep=006] loss=0.6832 acc=56.24%
[TRAIN][ep=006] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1302
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4758 mb_mean=0.5023 norm_overlap=0.9998 corr_cb=-0.2950 topkJ=0.0024
[TRAIN][ep=007] loss=0.6767 acc=59.19%
[TRAIN][ep=007] mask_avg: mc_mean=0.4785 mb_mean=0.5015 norm_overlap=0.9999 corr_cb=-0.1365
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4784 mb_mean=0.4987 norm_overlap=0.9997 corr_cb=-0.3532 topkJ=0.0048
[TRAIN][ep=008] loss=0.6721 acc=63.89%
[TRAIN][ep=008] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1238
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4781 mb_mean=0.5042 norm_overlap=0.9998 corr_cb=-0.2975 topkJ=0.0188
[TRAIN][ep=009] loss=0.6643 acc=62.68%
[TRAIN][ep=009] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1254
================= FIT START (fold=0) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4787 mb_mean=0.5043 norm_overlap=0.9999 corr_cb=-0.0822 topkJ=0.0502
[TRAIN][ep=000] loss=0.6582 acc=63.62%
[TRAIN][ep=000] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1201
[EPOCH 000/089] train: loss=0.6582 acc=63.62% | val: loss=0.6534 acc=67.47% f1=74.29% auc=71.74% val_score=55.4225 val_score_bestthr=63.3503 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.120) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 63.3503
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4793 mb_mean=0.5022 norm_overlap=0.9998 corr_cb=-0.2365 topkJ=0.0024
[TRAIN][ep=001] loss=0.6517 acc=64.43%
[TRAIN][ep=001] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1274
[EPOCH 001/089] train: loss=0.6517 acc=64.43% | val: loss=0.6599 acc=61.45% f1=72.41% auc=68.49% val_score=47.5336 val_score_bestthr=64.7777 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.127) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 63.3503 -> 64.7777
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4774 mb_mean=0.4982 norm_overlap=1.0000 corr_cb=-0.0324 topkJ=0.0252
[TRAIN][ep=002] loss=0.6471 acc=64.30%
[TRAIN][ep=002] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1182
[EPOCH 002/089] train: loss=0.6471 acc=64.30% | val: loss=0.6414 acc=68.67% f1=75.00% auc=72.44% val_score=47.9380 val_score_bestthr=63.1152 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.118) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.7777 -> 63.1152
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4776 mb_mean=0.5075 norm_overlap=0.9998 corr_cb=-0.2177 topkJ=0.0023
[TRAIN][ep=003] loss=0.6421 acc=64.43%
[TRAIN][ep=003] mask_avg: mc_mean=0.4785 mb_mean=0.5015 norm_overlap=0.9999 corr_cb=-0.1255
[EPOCH 003/089] train: loss=0.6421 acc=64.43% | val: loss=0.6608 acc=63.86% f1=73.68% auc=69.24% val_score=54.7539 val_score_bestthr=65.2221 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.125) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 64.7777 -> 65.2221
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4824 mb_mean=0.4950 norm_overlap=0.9998 corr_cb=-0.2211 topkJ=0.0294
[TRAIN][ep=004] loss=0.6474 acc=62.01%
[TRAIN][ep=004] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1284
[EPOCH 004/089] train: loss=0.6474 acc=62.01% | val: loss=0.6352 acc=69.88% f1=76.19% auc=73.08% val_score=46.9114 val_score_bestthr=64.6846 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.128) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 65.2221 -> 64.6846
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4744 mb_mean=0.5047 norm_overlap=0.9999 corr_cb=-0.0747 topkJ=0.0278
[TRAIN][ep=005] loss=1.5189 acc=65.23%
[TRAIN][ep=005] mask_avg: mc_mean=0.3499 mb_mean=0.5014 norm_overlap=0.9963 corr_cb=-0.6366
[EPOCH 005/089] train: loss=1.5189 acc=65.23% | val: loss=0.6522 acc=67.47% f1=69.66% auc=75.58% val_score=62.4643 val_score_bestthr=63.5118 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.350, mb=0.501, no=0.996, corr=-0.637) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.2221 -> 63.5118
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2034 mb_mean=0.5118 norm_overlap=0.9868 corr_cb=-0.7984 topkJ=0.0000
[TRAIN][ep=006] loss=1.4929 acc=66.04%
[TRAIN][ep=006] mask_avg: mc_mean=0.1954 mb_mean=0.5014 norm_overlap=0.9889 corr_cb=-0.7182
[EPOCH 006/089] train: loss=1.4929 acc=66.04% | val: loss=0.6381 acc=69.88% f1=66.67% auc=76.69% val_score=65.9943 val_score_bestthr=62.2202 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.195, mb=0.501, no=0.989, corr=-0.718) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.2221 -> 62.2202
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.1544 mb_mean=0.5024 norm_overlap=0.9842 corr_cb=-0.7874 topkJ=0.0000
[TRAIN][ep=007] loss=1.4954 acc=62.55%
[TRAIN][ep=007] mask_avg: mc_mean=0.1266 mb_mean=0.5014 norm_overlap=0.9819 corr_cb=-0.7189
[EPOCH 007/089] train: loss=1.4954 acc=62.55% | val: loss=0.6287 acc=67.47% f1=75.23% auc=74.13% val_score=52.4552 val_score_bestthr=65.0345 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.127, mb=0.501, no=0.982, corr=-0.719) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.2221 -> 65.0345
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1106 mb_mean=0.5001 norm_overlap=0.9753 corr_cb=-0.7731 topkJ=0.0000
[TRAIN][ep=008] loss=1.4792 acc=67.25%
[TRAIN][ep=008] mask_avg: mc_mean=0.0820 mb_mean=0.5014 norm_overlap=0.9749 corr_cb=-0.6725
[EPOCH 008/089] train: loss=1.4792 acc=67.25% | val: loss=0.6348 acc=67.47% f1=75.23% auc=73.55% val_score=61.5991 val_score_bestthr=65.3678 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.082, mb=0.501, no=0.975, corr=-0.672) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 65.2221 -> 65.3678
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.0583 mb_mean=0.5043 norm_overlap=0.9724 corr_cb=-0.6672 topkJ=0.0000
[TRAIN][ep=009] loss=1.4585 acc=69.40%
[TRAIN][ep=009] mask_avg: mc_mean=0.0692 mb_mean=0.5014 norm_overlap=0.9704 corr_cb=-0.6320
[EPOCH 009/089] train: loss=1.4585 acc=69.40% | val: loss=0.6054 acc=67.47% f1=73.79% auc=75.76% val_score=49.7236 val_score_bestthr=64.0005 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.069, mb=0.501, no=0.970, corr=-0.632) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.3678 -> 64.0005
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.0842 mb_mean=0.4997 norm_overlap=0.9624 corr_cb=-0.6838 topkJ=0.0000
[TRAIN][ep=010] loss=0.9395 acc=67.79%
[TRAIN][ep=010] mask_avg: mc_mean=0.0691 mb_mean=0.5015 norm_overlap=0.9678 corr_cb=-0.6066
[EPOCH 010/089] train: loss=0.9395 acc=67.79% | val: loss=0.6028 acc=71.08% f1=65.71% auc=75.58% val_score=54.5243 val_score_bestthr=64.2616 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.069, mb=0.501, no=0.968, corr=-0.607) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.3678 -> 64.2616
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.0920 mb_mean=0.5016 norm_overlap=0.9549 corr_cb=-0.6491 topkJ=0.0000
[TRAIN][ep=011] loss=0.8505 acc=69.80%
[TRAIN][ep=011] mask_avg: mc_mean=0.0608 mb_mean=0.5015 norm_overlap=0.9643 corr_cb=-0.5721
[EPOCH 011/089] train: loss=0.8505 acc=69.80% | val: loss=0.5925 acc=73.49% f1=69.44% auc=75.99% val_score=47.9807 val_score_bestthr=65.6306 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.061, mb=0.501, no=0.964, corr=-0.572) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 65.3678 -> 65.6306
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.0357 mb_mean=0.5072 norm_overlap=0.9622 corr_cb=-0.5395 topkJ=0.0000
[TRAIN][ep=012] loss=0.8505 acc=68.86%
[TRAIN][ep=012] mask_avg: mc_mean=0.0579 mb_mean=0.5014 norm_overlap=0.9623 corr_cb=-0.5491
[EPOCH 012/089] train: loss=0.8505 acc=68.86% | val: loss=0.6284 acc=71.08% f1=64.71% auc=73.90% val_score=51.3437 val_score_bestthr=66.1865 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.058, mb=0.501, no=0.962, corr=-0.549) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 65.6306 -> 66.1865
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.0308 mb_mean=0.5080 norm_overlap=0.9534 corr_cb=-0.3700 topkJ=0.0000
[TRAIN][ep=013] loss=0.8380 acc=71.28%
[TRAIN][ep=013] mask_avg: mc_mean=0.0515 mb_mean=0.5015 norm_overlap=0.9595 corr_cb=-0.5256
[EPOCH 013/089] train: loss=0.8380 acc=71.28% | val: loss=0.5900 acc=72.29% f1=66.67% auc=75.58% val_score=59.7524 val_score_bestthr=66.6238 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.051, mb=0.501, no=0.960, corr=-0.526) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 66.1865 -> 66.6238
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.0579 mb_mean=0.4973 norm_overlap=0.9714 corr_cb=-0.4808 topkJ=0.0024
[TRAIN][ep=014] loss=0.8326 acc=71.28%
[TRAIN][ep=014] mask_avg: mc_mean=0.0519 mb_mean=0.5014 norm_overlap=0.9586 corr_cb=-0.5179
[EPOCH 014/089] train: loss=0.8326 acc=71.28% | val: loss=0.5836 acc=73.49% f1=68.57% auc=75.93% val_score=52.8036 val_score_bestthr=65.9223 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.052, mb=0.501, no=0.959, corr=-0.518) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6238 -> 65.9223
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.0311 mb_mean=0.5043 norm_overlap=0.9558 corr_cb=-0.4271 topkJ=0.0000
[TRAIN][ep=015] loss=0.8199 acc=72.21%
[TRAIN][ep=015] mask_avg: mc_mean=0.0551 mb_mean=0.5014 norm_overlap=0.9588 corr_cb=-0.5188
[EPOCH 015/089] train: loss=0.8199 acc=72.21% | val: loss=0.5741 acc=73.49% f1=68.57% auc=76.63% val_score=54.8728 val_score_bestthr=65.9223 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.055, mb=0.501, no=0.959, corr=-0.519) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6238 -> 65.9223
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.0358 mb_mean=0.5102 norm_overlap=0.9419 corr_cb=-0.5242 topkJ=0.0000
[TRAIN][ep=016] loss=0.8284 acc=71.54%
[TRAIN][ep=016] mask_avg: mc_mean=0.0469 mb_mean=0.5014 norm_overlap=0.9560 corr_cb=-0.4902
[EPOCH 016/089] train: loss=0.8284 acc=71.54% | val: loss=0.5747 acc=75.90% f1=72.22% auc=77.09% val_score=49.0913 val_score_bestthr=66.6919 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.047, mb=0.501, no=0.956, corr=-0.490) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 66.6238 -> 66.6919
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.0579 mb_mean=0.4927 norm_overlap=0.9730 corr_cb=-0.4256 topkJ=0.0008
[TRAIN][ep=017] loss=0.8204 acc=71.28%
[TRAIN][ep=017] mask_avg: mc_mean=0.0427 mb_mean=0.5014 norm_overlap=0.9545 corr_cb=-0.4747
[EPOCH 017/089] train: loss=0.8204 acc=71.28% | val: loss=0.5795 acc=73.49% f1=68.57% auc=76.16% val_score=61.1980 val_score_bestthr=65.9223 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.043, mb=0.501, no=0.955, corr=-0.475) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6919 -> 65.9223
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.0492 mb_mean=0.5052 norm_overlap=0.9474 corr_cb=-0.5290 topkJ=0.0000
[TRAIN][ep=018] loss=0.8061 acc=72.35%
[TRAIN][ep=018] mask_avg: mc_mean=0.0587 mb_mean=0.5014 norm_overlap=0.9578 corr_cb=-0.5143
[EPOCH 018/089] train: loss=0.8061 acc=72.35% | val: loss=0.7100 acc=67.47% f1=74.77% auc=74.48% val_score=51.6446 val_score_bestthr=66.4819 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.059, mb=0.501, no=0.958, corr=-0.514) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6919 -> 66.4819
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.0367 mb_mean=0.4998 norm_overlap=0.9534 corr_cb=-0.4662 topkJ=0.0000
[TRAIN][ep=019] loss=0.8320 acc=70.20%
[TRAIN][ep=019] mask_avg: mc_mean=0.0391 mb_mean=0.5014 norm_overlap=0.9527 corr_cb=-0.4580
[EPOCH 019/089] train: loss=0.8320 acc=70.20% | val: loss=0.6271 acc=67.47% f1=74.77% auc=75.64% val_score=60.2367 val_score_bestthr=66.4819 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.039, mb=0.501, no=0.953, corr=-0.458) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6919 -> 66.4819
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.0770 mb_mean=0.4956 norm_overlap=0.9529 corr_cb=-0.5806 topkJ=0.0000
[TRAIN][ep=020] loss=0.8115 acc=72.89%
[TRAIN][ep=020] mask_avg: mc_mean=0.0456 mb_mean=0.5014 norm_overlap=0.9544 corr_cb=-0.4822
[EPOCH 020/089] train: loss=0.8115 acc=72.89% | val: loss=0.5865 acc=73.49% f1=68.57% auc=76.98% val_score=58.7307 val_score_bestthr=65.9223 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.046, mb=0.501, no=0.954, corr=-0.482) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6919 -> 65.9223
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.0430 mb_mean=0.5057 norm_overlap=0.9444 corr_cb=-0.4637 topkJ=0.0000
[TRAIN][ep=021] loss=0.7926 acc=73.69%
[TRAIN][ep=021] mask_avg: mc_mean=0.0625 mb_mean=0.5014 norm_overlap=0.9577 corr_cb=-0.5223
[EPOCH 021/089] train: loss=0.7926 acc=73.69% | val: loss=0.5897 acc=67.47% f1=74.29% auc=77.27% val_score=58.7307 val_score_bestthr=68.5589 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.062, mb=0.501, no=0.958, corr=-0.522) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 66.6919 -> 68.5589
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.0783 mb_mean=0.4985 norm_overlap=0.9654 corr_cb=-0.4698 topkJ=0.0000
[TRAIN][ep=022] loss=0.7967 acc=73.83%
[TRAIN][ep=022] mask_avg: mc_mean=0.0576 mb_mean=0.5014 norm_overlap=0.9565 corr_cb=-0.5096
[EPOCH 022/089] train: loss=0.7967 acc=73.83% | val: loss=0.5495 acc=66.27% f1=75.00% auc=77.97% val_score=61.2877 val_score_bestthr=69.6680 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.058, mb=0.501, no=0.956, corr=-0.510) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 68.5589 -> 69.6680
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.0438 mb_mean=0.5003 norm_overlap=0.9547 corr_cb=-0.4487 topkJ=0.0000
[TRAIN][ep=023] loss=0.8036 acc=72.62%
[TRAIN][ep=023] mask_avg: mc_mean=0.0458 mb_mean=0.5015 norm_overlap=0.9534 corr_cb=-0.4761
[EPOCH 023/089] train: loss=0.8036 acc=72.62% | val: loss=0.5535 acc=74.70% f1=72.00% auc=78.14% val_score=57.8118 val_score_bestthr=65.3644 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.046, mb=0.501, no=0.953, corr=-0.476) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.6680 -> 65.3644
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.0459 mb_mean=0.5001 norm_overlap=0.9618 corr_cb=-0.3868 topkJ=0.0000
[TRAIN][ep=024] loss=0.7729 acc=75.84%
[TRAIN][ep=024] mask_avg: mc_mean=0.0530 mb_mean=0.5014 norm_overlap=0.9552 corr_cb=-0.4914
[EPOCH 024/089] train: loss=0.7729 acc=75.84% | val: loss=0.5559 acc=75.90% f1=74.36% auc=78.14% val_score=57.1066 val_score_bestthr=68.2337 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.053, mb=0.501, no=0.955, corr=-0.491) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.6680 -> 68.2337
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.0514 mb_mean=0.5013 norm_overlap=0.9564 corr_cb=-0.5422 topkJ=0.0000
[TRAIN][ep=025] loss=0.7923 acc=73.69%
[TRAIN][ep=025] mask_avg: mc_mean=0.0503 mb_mean=0.5014 norm_overlap=0.9542 corr_cb=-0.4821
[EPOCH 025/089] train: loss=0.7923 acc=73.69% | val: loss=0.5552 acc=72.29% f1=72.29% auc=77.15% val_score=63.6469 val_score_bestthr=66.3844 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.050, mb=0.501, no=0.954, corr=-0.482) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.6680 -> 66.3844
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.0379 mb_mean=0.5025 norm_overlap=0.9489 corr_cb=-0.5158 topkJ=0.0000
[TRAIN][ep=026] loss=0.7691 acc=74.50%
[TRAIN][ep=026] mask_avg: mc_mean=0.0574 mb_mean=0.5014 norm_overlap=0.9561 corr_cb=-0.5035
[EPOCH 026/089] train: loss=0.7691 acc=74.50% | val: loss=0.5754 acc=74.70% f1=72.73% auc=78.84% val_score=60.3976 val_score_bestthr=69.5636 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.057, mb=0.501, no=0.956, corr=-0.504) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.6680 -> 69.5636
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.0748 mb_mean=0.5001 norm_overlap=0.9519 corr_cb=-0.5840 topkJ=0.0000
[TRAIN][ep=027] loss=0.7668 acc=74.50%
[TRAIN][ep=027] mask_avg: mc_mean=0.0621 mb_mean=0.5014 norm_overlap=0.9570 corr_cb=-0.5118
[EPOCH 027/089] train: loss=0.7668 acc=74.50% | val: loss=0.6034 acc=72.29% f1=72.94% auc=77.15% val_score=58.7307 val_score_bestthr=69.2820 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.062, mb=0.501, no=0.957, corr=-0.512) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.6680 -> 69.2820
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.0700 mb_mean=0.4951 norm_overlap=0.9721 corr_cb=-0.4178 topkJ=0.0000
[TRAIN][ep=028] loss=0.7642 acc=74.77%
[TRAIN][ep=028] mask_avg: mc_mean=0.0606 mb_mean=0.5015 norm_overlap=0.9565 corr_cb=-0.5048
[EPOCH 028/089] train: loss=0.7642 acc=74.77% | val: loss=0.5537 acc=77.11% f1=76.54% auc=79.19% val_score=58.6883 val_score_bestthr=74.5003 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.061, mb=0.501, no=0.957, corr=-0.505) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 69.6680 -> 74.5003
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.0738 mb_mean=0.4980 norm_overlap=0.9636 corr_cb=-0.5046 topkJ=0.0000
[TRAIN][ep=029] loss=0.7476 acc=78.39%
[TRAIN][ep=029] mask_avg: mc_mean=0.0581 mb_mean=0.5015 norm_overlap=0.9561 corr_cb=-0.5023
[EPOCH 029/089] train: loss=0.7476 acc=78.39% | val: loss=0.6024 acc=74.70% f1=72.73% auc=79.88% val_score=68.9564 val_score_bestthr=69.5636 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.058, mb=0.501, no=0.956, corr=-0.502) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.5003 -> 69.5636
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.0832 mb_mean=0.4961 norm_overlap=0.9684 corr_cb=-0.5517 topkJ=0.0000
[TRAIN][ep=030] loss=0.7525 acc=74.77%
[TRAIN][ep=030] mask_avg: mc_mean=0.0625 mb_mean=0.5015 norm_overlap=0.9569 corr_cb=-0.5107
[EPOCH 030/089] train: loss=0.7525 acc=74.77% | val: loss=0.5448 acc=74.70% f1=74.70% auc=79.71% val_score=60.1640 val_score_bestthr=72.2198 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.062, mb=0.501, no=0.957, corr=-0.511) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.5003 -> 72.2198
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.0590 mb_mean=0.5019 norm_overlap=0.9607 corr_cb=-0.5153 topkJ=0.0000
[TRAIN][ep=031] loss=0.7336 acc=77.72%
[TRAIN][ep=031] mask_avg: mc_mean=0.0653 mb_mean=0.5015 norm_overlap=0.9575 corr_cb=-0.5153
[EPOCH 031/089] train: loss=0.7336 acc=77.72% | val: loss=0.5494 acc=75.90% f1=75.61% auc=78.78% val_score=62.0977 val_score_bestthr=73.9054 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.065, mb=0.501, no=0.957, corr=-0.515) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.5003 -> 73.9054
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.0600 mb_mean=0.4988 norm_overlap=0.9566 corr_cb=-0.5754 topkJ=0.0000
[TRAIN][ep=032] loss=0.7410 acc=78.26%
[TRAIN][ep=032] mask_avg: mc_mean=0.0673 mb_mean=0.5014 norm_overlap=0.9583 corr_cb=-0.5126
[EPOCH 032/089] train: loss=0.7410 acc=78.26% | val: loss=0.5540 acc=75.90% f1=75.61% auc=80.12% val_score=58.9681 val_score_bestthr=73.3583 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.067, mb=0.501, no=0.958, corr=-0.513) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.5003 -> 73.3583
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.0786 mb_mean=0.4952 norm_overlap=0.9705 corr_cb=-0.4890 topkJ=0.0004
[TRAIN][ep=033] loss=0.7217 acc=77.45%
[TRAIN][ep=033] mask_avg: mc_mean=0.0637 mb_mean=0.5014 norm_overlap=0.9576 corr_cb=-0.5006
[EPOCH 033/089] train: loss=0.7217 acc=77.45% | val: loss=0.5596 acc=73.49% f1=75.00% auc=79.71% val_score=54.5230 val_score_bestthr=74.9503 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.064, mb=0.501, no=0.958, corr=-0.501) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 74.5003 -> 74.9503
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.0869 mb_mean=0.5028 norm_overlap=0.9593 corr_cb=-0.6027 topkJ=0.0000
[TRAIN][ep=034] loss=0.7234 acc=75.70%
[TRAIN][ep=034] mask_avg: mc_mean=0.0789 mb_mean=0.5014 norm_overlap=0.9597 corr_cb=-0.5165
[EPOCH 034/089] train: loss=0.7234 acc=75.70% | val: loss=0.5405 acc=71.08% f1=76.47% auc=79.36% val_score=62.0977 val_score_bestthr=68.5461 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.079, mb=0.501, no=0.960, corr=-0.517) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.9503 -> 68.5461
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.0380 mb_mean=0.5037 norm_overlap=0.9556 corr_cb=-0.4416 topkJ=0.0000
[TRAIN][ep=035] loss=0.7113 acc=80.00%
[TRAIN][ep=035] mask_avg: mc_mean=0.0657 mb_mean=0.5014 norm_overlap=0.9580 corr_cb=-0.5028
[EPOCH 035/089] train: loss=0.7113 acc=80.00% | val: loss=0.5343 acc=75.90% f1=75.61% auc=81.16% val_score=56.3691 val_score_bestthr=73.3583 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.066, mb=0.501, no=0.958, corr=-0.503) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.9503 -> 73.3583
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.0689 mb_mean=0.4983 norm_overlap=0.9577 corr_cb=-0.5398 topkJ=0.0000
[TRAIN][ep=036] loss=0.7199 acc=78.26%
[TRAIN][ep=036] mask_avg: mc_mean=0.0726 mb_mean=0.5015 norm_overlap=0.9590 corr_cb=-0.5153
[EPOCH 036/089] train: loss=0.7199 acc=78.26% | val: loss=0.5696 acc=73.49% f1=75.56% auc=80.70% val_score=55.9281 val_score_bestthr=72.6810 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.073, mb=0.501, no=0.959, corr=-0.515) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.9503 -> 72.6810
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.0443 mb_mean=0.5046 norm_overlap=0.9512 corr_cb=-0.4938 topkJ=0.0000
[TRAIN][ep=037] loss=0.7067 acc=78.79%
[TRAIN][ep=037] mask_avg: mc_mean=0.0702 mb_mean=0.5014 norm_overlap=0.9586 corr_cb=-0.5089
[EPOCH 037/089] train: loss=0.7067 acc=78.79% | val: loss=0.5630 acc=71.08% f1=73.91% auc=81.22% val_score=55.0122 val_score_bestthr=72.1808 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.070, mb=0.501, no=0.959, corr=-0.509) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.9503 -> 72.1808
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.0751 mb_mean=0.4966 norm_overlap=0.9680 corr_cb=-0.5336 topkJ=0.0000
[TRAIN][ep=038] loss=0.7253 acc=77.58%
[TRAIN][ep=038] mask_avg: mc_mean=0.0419 mb_mean=0.5014 norm_overlap=0.9520 corr_cb=-0.4325
[EPOCH 038/089] train: loss=0.7253 acc=77.58% | val: loss=0.5356 acc=71.08% f1=73.33% auc=80.76% val_score=65.3839 val_score_bestthr=69.7688 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.042, mb=0.501, no=0.952, corr=-0.433) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.9503 -> 69.7688
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.0428 mb_mean=0.5081 norm_overlap=0.9450 corr_cb=-0.5081 topkJ=0.0000
[TRAIN][ep=039] loss=0.6813 acc=80.81%
[TRAIN][ep=039] mask_avg: mc_mean=0.0792 mb_mean=0.5015 norm_overlap=0.9602 corr_cb=-0.5222
[EPOCH 039/089] train: loss=0.6813 acc=80.81% | val: loss=0.5354 acc=72.29% f1=74.73% auc=81.74% val_score=69.8061 val_score_bestthr=73.3045 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.079, mb=0.501, no=0.960, corr=-0.522) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.9503 -> 73.3045
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.1036 mb_mean=0.5035 norm_overlap=0.9532 corr_cb=-0.6341 topkJ=0.0000
[TRAIN][ep=040] loss=0.6892 acc=79.46%
[TRAIN][ep=040] mask_avg: mc_mean=0.0757 mb_mean=0.5014 norm_overlap=0.9600 corr_cb=-0.5093
[EPOCH 040/089] train: loss=0.6892 acc=79.46% | val: loss=0.5612 acc=77.11% f1=76.54% auc=81.10% val_score=62.1770 val_score_bestthr=75.6597 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.076, mb=0.501, no=0.960, corr=-0.509) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 74.9503 -> 75.6597
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.0936 mb_mean=0.5010 norm_overlap=0.9556 corr_cb=-0.6068 topkJ=0.0000
[TRAIN][ep=041] loss=0.6964 acc=78.26%
[TRAIN][ep=041] mask_avg: mc_mean=0.0744 mb_mean=0.5014 norm_overlap=0.9595 corr_cb=-0.5054
[EPOCH 041/089] train: loss=0.6964 acc=78.26% | val: loss=0.5525 acc=74.70% f1=77.42% auc=81.74% val_score=66.4816 val_score_bestthr=74.3342 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.074, mb=0.501, no=0.960, corr=-0.505) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.6597 -> 74.3342
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.0826 mb_mean=0.4956 norm_overlap=0.9719 corr_cb=-0.4683 topkJ=0.0000
[TRAIN][ep=042] loss=0.6857 acc=80.54%
[TRAIN][ep=042] mask_avg: mc_mean=0.0805 mb_mean=0.5014 norm_overlap=0.9605 corr_cb=-0.5056
[EPOCH 042/089] train: loss=0.6857 acc=80.54% | val: loss=0.5308 acc=73.49% f1=78.43% auc=81.80% val_score=62.7118 val_score_bestthr=74.4471 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.080, mb=0.501, no=0.960, corr=-0.506) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.6597 -> 74.4471
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.0395 mb_mean=0.4997 norm_overlap=0.9589 corr_cb=-0.4683 topkJ=0.0000
[TRAIN][ep=043] loss=0.7959 acc=78.39%
[TRAIN][ep=043] mask_avg: mc_mean=0.0681 mb_mean=0.5014 norm_overlap=0.9588 corr_cb=-0.4880
[EPOCH 043/089] train: loss=0.7959 acc=78.39% | val: loss=0.6833 acc=74.70% f1=77.42% auc=81.86% val_score=52.4567 val_score_bestthr=74.3342 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.068, mb=0.501, no=0.959, corr=-0.488) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.6597 -> 74.3342
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.0482 mb_mean=0.5072 norm_overlap=0.9494 corr_cb=-0.5097 topkJ=0.0000
[TRAIN][ep=044] loss=0.6682 acc=80.27%
[TRAIN][ep=044] mask_avg: mc_mean=0.0770 mb_mean=0.5015 norm_overlap=0.9603 corr_cb=-0.5068
[EPOCH 044/089] train: loss=0.6682 acc=80.27% | val: loss=0.5505 acc=71.08% f1=77.36% auc=82.03% val_score=66.2133 val_score_bestthr=72.8286 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.077, mb=0.501, no=0.960, corr=-0.507) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.6597 -> 72.8286
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.0819 mb_mean=0.4984 norm_overlap=0.9614 corr_cb=-0.4566 topkJ=0.0000
[TRAIN][ep=045] loss=0.6535 acc=82.55%
[TRAIN][ep=045] mask_avg: mc_mean=0.0846 mb_mean=0.5014 norm_overlap=0.9614 corr_cb=-0.5129
[EPOCH 045/089] train: loss=0.6535 acc=82.55% | val: loss=0.5726 acc=73.49% f1=77.55% auc=81.86% val_score=68.8938 val_score_bestthr=73.2165 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.085, mb=0.501, no=0.961, corr=-0.513) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.6597 -> 73.2165
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.1054 mb_mean=0.4955 norm_overlap=0.9703 corr_cb=-0.4968 topkJ=0.0000
[TRAIN][ep=046] loss=0.6494 acc=81.48%
[TRAIN][ep=046] mask_avg: mc_mean=0.0790 mb_mean=0.5015 norm_overlap=0.9602 corr_cb=-0.5000
[EPOCH 046/089] train: loss=0.6494 acc=81.48% | val: loss=0.6179 acc=74.70% f1=77.42% auc=81.57% val_score=55.9281 val_score_bestthr=74.3342 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.079, mb=0.501, no=0.960, corr=-0.500) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.6597 -> 74.3342
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.0767 mb_mean=0.5047 norm_overlap=0.9630 corr_cb=-0.5297 topkJ=0.0000
[TRAIN][ep=047] loss=0.6464 acc=81.34%
[TRAIN][ep=047] mask_avg: mc_mean=0.0896 mb_mean=0.5014 norm_overlap=0.9623 corr_cb=-0.5113
[EPOCH 047/089] train: loss=0.6464 acc=81.34% | val: loss=0.5665 acc=74.70% f1=76.92% auc=81.80% val_score=70.5913 val_score_bestthr=79.3735 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.090, mb=0.501, no=0.962, corr=-0.511) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 75.6597 -> 79.3735
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.0896 mb_mean=0.4955 norm_overlap=0.9678 corr_cb=-0.4876 topkJ=0.0000
[TRAIN][ep=048] loss=0.7679 acc=81.48%
[TRAIN][ep=048] mask_avg: mc_mean=0.0832 mb_mean=0.5014 norm_overlap=0.9611 corr_cb=-0.5041
[EPOCH 048/089] train: loss=0.7679 acc=81.48% | val: loss=0.5501 acc=72.29% f1=74.16% auc=81.16% val_score=65.4105 val_score_bestthr=71.1842 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.083, mb=0.501, no=0.961, corr=-0.504) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3735 -> 71.1842
[DBG][ep=049] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.0476 mb_mean=0.5049 norm_overlap=0.9567 corr_cb=-0.4720 topkJ=0.0000
[TRAIN][ep=049] loss=0.8323 acc=82.42%
[TRAIN][ep=049] mask_avg: mc_mean=0.0743 mb_mean=0.5014 norm_overlap=0.9598 corr_cb=-0.4918
[EPOCH 049/089] train: loss=0.8323 acc=82.42% | val: loss=0.6362 acc=69.88% f1=76.19% auc=80.99% val_score=53.7972 val_score_bestthr=73.0634 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.074, mb=0.501, no=0.960, corr=-0.492) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3735 -> 73.0634
[DBG][ep=050] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.0708 mb_mean=0.5029 norm_overlap=0.9573 corr_cb=-0.4572 topkJ=0.0000
[TRAIN][ep=050] loss=0.6074 acc=84.83%
[TRAIN][ep=050] mask_avg: mc_mean=0.0789 mb_mean=0.5015 norm_overlap=0.9605 corr_cb=-0.4983
[EPOCH 050/089] train: loss=0.6074 acc=84.83% | val: loss=0.6001 acc=72.29% f1=76.77% auc=80.93% val_score=53.6990 val_score_bestthr=74.6040 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.079, mb=0.501, no=0.960, corr=-0.498) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3735 -> 74.6040
[DBG][ep=051] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.0744 mb_mean=0.5035 norm_overlap=0.9566 corr_cb=-0.5432 topkJ=0.0000
[TRAIN][ep=051] loss=0.6045 acc=85.10%
[TRAIN][ep=051] mask_avg: mc_mean=0.0789 mb_mean=0.5015 norm_overlap=0.9606 corr_cb=-0.4964
[EPOCH 051/089] train: loss=0.6045 acc=85.10% | val: loss=0.5837 acc=71.08% f1=76.00% auc=80.52% val_score=58.8580 val_score_bestthr=72.2695 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.079, mb=0.501, no=0.961, corr=-0.496) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3735 -> 72.2695
[DBG][ep=052] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.1037 mb_mean=0.4999 norm_overlap=0.9604 corr_cb=-0.5190 topkJ=0.0000
[TRAIN][ep=052] loss=0.6007 acc=85.91%
[TRAIN][ep=052] mask_avg: mc_mean=0.0790 mb_mean=0.5014 norm_overlap=0.9606 corr_cb=-0.4980
[EPOCH 052/089] train: loss=0.6007 acc=85.91% | val: loss=0.5628 acc=72.29% f1=76.29% auc=80.52% val_score=65.4883 val_score_bestthr=70.5349 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.079, mb=0.501, no=0.961, corr=-0.498) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3735 -> 70.5349
[DBG][ep=053] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.0726 mb_mean=0.5085 norm_overlap=0.9434 corr_cb=-0.5005 topkJ=0.0000
[TRAIN][ep=053] loss=0.5990 acc=84.97%
[TRAIN][ep=053] mask_avg: mc_mean=0.0789 mb_mean=0.5015 norm_overlap=0.9606 corr_cb=-0.4989
[EPOCH 053/089] train: loss=0.5990 acc=84.97% | val: loss=0.5626 acc=72.29% f1=76.77% auc=80.64% val_score=65.4883 val_score_bestthr=74.6040 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.079, mb=0.501, no=0.961, corr=-0.499) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3735 -> 74.6040
[DBG][ep=054] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=054] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=054] mask(step0): mc_mean=0.0741 mb_mean=0.5047 norm_overlap=0.9548 corr_cb=-0.4860 topkJ=0.0000
[TRAIN][ep=054] loss=0.6002 acc=85.64%
[TRAIN][ep=054] mask_avg: mc_mean=0.0790 mb_mean=0.5014 norm_overlap=0.9604 corr_cb=-0.4993
[EPOCH 054/089] train: loss=0.6002 acc=85.64% | val: loss=0.5861 acc=72.29% f1=76.77% auc=80.35% val_score=58.4318 val_score_bestthr=74.6040 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.079, mb=0.501, no=0.960, corr=-0.499) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3735 -> 74.6040
[DBG][ep=055] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=055] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=055] mask(step0): mc_mean=0.0725 mb_mean=0.5009 norm_overlap=0.9617 corr_cb=-0.5629 topkJ=0.0000
[TRAIN][ep=055] loss=0.5947 acc=85.50%
[TRAIN][ep=055] mask_avg: mc_mean=0.0791 mb_mean=0.5014 norm_overlap=0.9606 corr_cb=-0.4955
[EPOCH 055/089] train: loss=0.5947 acc=85.50% | val: loss=0.5924 acc=73.49% f1=77.55% auc=80.41% val_score=58.8580 val_score_bestthr=75.7234 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.079, mb=0.501, no=0.961, corr=-0.495) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3735 -> 75.7234
[DBG][ep=056] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=056] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=056] mask(step0): mc_mean=0.0906 mb_mean=0.5009 norm_overlap=0.9626 corr_cb=-0.5191 topkJ=0.0000
[TRAIN][ep=056] loss=0.5900 acc=85.77%
[TRAIN][ep=056] mask_avg: mc_mean=0.0790 mb_mean=0.5014 norm_overlap=0.9604 corr_cb=-0.5007
[EPOCH 056/089] train: loss=0.5900 acc=85.77% | val: loss=0.5810 acc=73.49% f1=77.55% auc=80.58% val_score=67.7710 val_score_bestthr=75.7234 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.079, mb=0.501, no=0.960, corr=-0.501) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3735 -> 75.7234
[DBG][ep=057] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=057] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=057] mask(step0): mc_mean=0.1132 mb_mean=0.4930 norm_overlap=0.9764 corr_cb=-0.5012 topkJ=0.0032
[TRAIN][ep=057] loss=0.5961 acc=85.77%
[TRAIN][ep=057] mask_avg: mc_mean=0.0789 mb_mean=0.5014 norm_overlap=0.9603 corr_cb=-0.5000
[EPOCH 057/089] train: loss=0.5961 acc=85.77% | val: loss=0.5780 acc=72.29% f1=76.77% auc=80.76% val_score=67.7710 val_score_bestthr=74.6040 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.079, mb=0.501, no=0.960, corr=-0.500) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3735 -> 74.6040
[DBG][ep=058] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=058] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=058] mask(step0): mc_mean=0.1104 mb_mean=0.5023 norm_overlap=0.9603 corr_cb=-0.4964 topkJ=0.0000
[TRAIN][ep=058] loss=0.5927 acc=85.64%
[TRAIN][ep=058] mask_avg: mc_mean=0.0790 mb_mean=0.5014 norm_overlap=0.9605 corr_cb=-0.4987
[EPOCH 058/089] train: loss=0.5927 acc=85.64% | val: loss=0.5786 acc=72.29% f1=76.77% auc=80.58% val_score=67.7710 val_score_bestthr=74.6040 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.079, mb=0.501, no=0.960, corr=-0.499) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3735 -> 74.6040
[DBG][ep=059] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=059] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=059] mask(step0): mc_mean=0.0746 mb_mean=0.5009 norm_overlap=0.9575 corr_cb=-0.5474 topkJ=0.0000
[TRAIN][ep=059] loss=0.5977 acc=84.83%
[TRAIN][ep=059] mask_avg: mc_mean=0.0789 mb_mean=0.5014 norm_overlap=0.9604 corr_cb=-0.5000
[EPOCH 059/089] train: loss=0.5977 acc=84.83% | val: loss=0.6060 acc=74.70% f1=74.70% auc=80.70% val_score=61.9411 val_score_bestthr=73.9263 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.079, mb=0.501, no=0.960, corr=-0.500) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3735 -> 73.9263
[DBG][ep=060] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=060] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=060] mask(step0): mc_mean=0.0623 mb_mean=0.5029 norm_overlap=0.9614 corr_cb=-0.4629 topkJ=0.0000
[TRAIN][ep=060] loss=0.5900 acc=85.50%
[TRAIN][ep=060] mask_avg: mc_mean=0.0789 mb_mean=0.5015 norm_overlap=0.9604 corr_cb=-0.4992
[EPOCH 060/089] train: loss=0.5900 acc=85.50% | val: loss=0.6039 acc=74.70% f1=74.70% auc=80.76% val_score=59.5758 val_score_bestthr=73.9263 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.079, mb=0.501, no=0.960, corr=-0.499) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3735 -> 73.9263
[DBG][ep=061] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=061] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=061] mask(step0): mc_mean=0.1437 mb_mean=0.4912 norm_overlap=0.9767 corr_cb=-0.4755 topkJ=0.0000
[TRAIN][ep=061] loss=0.5898 acc=85.23%
[TRAIN][ep=061] mask_avg: mc_mean=0.0790 mb_mean=0.5014 norm_overlap=0.9606 corr_cb=-0.4974
[EPOCH 061/089] train: loss=0.5898 acc=85.23% | val: loss=0.5924 acc=74.70% f1=78.79% auc=80.81% val_score=60.4796 val_score_bestthr=75.5517 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.079, mb=0.501, no=0.961, corr=-0.497) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3735 -> 75.5517
[DBG][ep=062] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=062] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=062] mask(step0): mc_mean=0.0467 mb_mean=0.5065 norm_overlap=0.9569 corr_cb=-0.4749 topkJ=0.0000
[TRAIN][ep=062] loss=0.5891 acc=85.50%
[TRAIN][ep=062] mask_avg: mc_mean=0.0790 mb_mean=0.5014 norm_overlap=0.9606 corr_cb=-0.4998
[EPOCH 062/089] train: loss=0.5891 acc=85.50% | val: loss=0.5770 acc=73.49% f1=77.08% auc=80.64% val_score=65.4883 val_score_bestthr=72.8734 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.079, mb=0.501, no=0.961, corr=-0.500) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3735 -> 72.8734
[DBG][ep=063] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=063] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=063] mask(step0): mc_mean=0.0761 mb_mean=0.4998 norm_overlap=0.9684 corr_cb=-0.4636 topkJ=0.0008
[TRAIN][ep=063] loss=0.5909 acc=85.37%
[TRAIN][ep=063] mask_avg: mc_mean=0.0789 mb_mean=0.5014 norm_overlap=0.9605 corr_cb=-0.5002
[EPOCH 063/089] train: loss=0.5909 acc=85.37% | val: loss=0.5876 acc=74.70% f1=77.89% auc=80.58% val_score=67.7710 val_score_bestthr=73.9970 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.079, mb=0.501, no=0.961, corr=-0.500) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3735 -> 73.9970
[DBG][ep=064] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=064] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=064] mask(step0): mc_mean=0.0936 mb_mean=0.4966 norm_overlap=0.9747 corr_cb=-0.4690 topkJ=0.0035
[TRAIN][ep=064] loss=0.5845 acc=86.98%
[TRAIN][ep=064] mask_avg: mc_mean=0.0790 mb_mean=0.5014 norm_overlap=0.9604 corr_cb=-0.4990
[EPOCH 064/089] train: loss=0.5845 acc=86.98% | val: loss=0.5914 acc=74.70% f1=77.89% auc=80.41% val_score=60.4796 val_score_bestthr=73.9970 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.079, mb=0.501, no=0.960, corr=-0.499) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3735 -> 73.9970
[DBG][ep=065] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=065] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=065] mask(step0): mc_mean=0.0745 mb_mean=0.5017 norm_overlap=0.9586 corr_cb=-0.5295 topkJ=0.0000
[TRAIN][ep=065] loss=0.5800 acc=85.91%
[TRAIN][ep=065] mask_avg: mc_mean=0.0789 mb_mean=0.5015 norm_overlap=0.9606 corr_cb=-0.4983
[EPOCH 065/089] train: loss=0.5800 acc=85.91% | val: loss=0.6394 acc=74.70% f1=77.89% auc=80.52% val_score=55.2534 val_score_bestthr=73.9970 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.079, mb=0.501, no=0.961, corr=-0.498) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3735 -> 73.9970
[DBG][ep=066] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=066] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=066] mask(step0): mc_mean=0.0856 mb_mean=0.5007 norm_overlap=0.9642 corr_cb=-0.5436 topkJ=0.0000
[TRAIN][ep=066] loss=0.5814 acc=85.50%
[TRAIN][ep=066] mask_avg: mc_mean=0.0789 mb_mean=0.5015 norm_overlap=0.9603 corr_cb=-0.5012
[EPOCH 066/089] train: loss=0.5814 acc=85.50% | val: loss=0.5962 acc=74.70% f1=77.89% auc=80.52% val_score=60.4796 val_score_bestthr=73.9970 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.079, mb=0.501, no=0.960, corr=-0.501) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3735 -> 73.9970
[DBG][ep=067] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=067] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=067] mask(step0): mc_mean=0.0782 mb_mean=0.5058 norm_overlap=0.9473 corr_cb=-0.5256 topkJ=0.0000
[TRAIN][ep=067] loss=0.5790 acc=85.77%
[TRAIN][ep=067] mask_avg: mc_mean=0.0790 mb_mean=0.5014 norm_overlap=0.9604 corr_cb=-0.5015
[EPOCH 067/089] train: loss=0.5790 acc=85.77% | val: loss=0.5881 acc=74.70% f1=77.89% auc=80.64% val_score=66.6278 val_score_bestthr=73.9970 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.079, mb=0.501, no=0.960, corr=-0.501) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3735 -> 73.9970
[DBG][ep=068] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=068] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=068] mask(step0): mc_mean=0.0692 mb_mean=0.5032 norm_overlap=0.9598 corr_cb=-0.5197 topkJ=0.0004
[TRAIN][ep=068] loss=0.5758 acc=85.77%
[TRAIN][ep=068] mask_avg: mc_mean=0.0791 mb_mean=0.5014 norm_overlap=0.9604 corr_cb=-0.4987
[EPOCH 068/089] train: loss=0.5758 acc=85.77% | val: loss=0.6912 acc=74.70% f1=77.89% auc=80.17% val_score=56.8352 val_score_bestthr=73.9970 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.079, mb=0.501, no=0.960, corr=-0.499) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3735 -> 73.9970
[DBG][ep=069] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=069] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=069] mask(step0): mc_mean=0.0952 mb_mean=0.5002 norm_overlap=0.9605 corr_cb=-0.5737 topkJ=0.0000
[TRAIN][ep=069] loss=0.5880 acc=85.23%
[TRAIN][ep=069] mask_avg: mc_mean=0.0789 mb_mean=0.5014 norm_overlap=0.9605 corr_cb=-0.4989
[EPOCH 069/089] train: loss=0.5880 acc=85.23% | val: loss=0.5821 acc=73.49% f1=77.55% auc=81.05% val_score=65.1662 val_score_bestthr=76.4190 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.079, mb=0.501, no=0.960, corr=-0.499) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3735 -> 76.4190
[DBG][ep=070] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=070] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=070] mask(step0): mc_mean=0.0797 mb_mean=0.4982 norm_overlap=0.9695 corr_cb=-0.5001 topkJ=0.0000
[TRAIN][ep=070] loss=0.5791 acc=86.71%
[TRAIN][ep=070] mask_avg: mc_mean=0.0789 mb_mean=0.5014 norm_overlap=0.9605 corr_cb=-0.4987
[EPOCH 070/089] train: loss=0.5791 acc=86.71% | val: loss=0.5864 acc=73.49% f1=76.60% auc=80.81% val_score=65.1662 val_score_bestthr=73.2087 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.079, mb=0.501, no=0.960, corr=-0.499) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3735 -> 73.2087
[DBG][ep=071] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=071] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=071] mask(step0): mc_mean=0.0918 mb_mean=0.4983 norm_overlap=0.9591 corr_cb=-0.5646 topkJ=0.0000
[TRAIN][ep=071] loss=0.5769 acc=85.64%
[TRAIN][ep=071] mask_avg: mc_mean=0.0789 mb_mean=0.5014 norm_overlap=0.9604 corr_cb=-0.5034
[EPOCH 071/089] train: loss=0.5769 acc=85.64% | val: loss=0.5961 acc=74.70% f1=77.89% auc=80.41% val_score=66.6278 val_score_bestthr=73.9970 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.079, mb=0.501, no=0.960, corr=-0.503) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3735 -> 73.9970
[DBG][ep=072] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=072] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=072] mask(step0): mc_mean=0.0539 mb_mean=0.5071 norm_overlap=0.9541 corr_cb=-0.4892 topkJ=0.0000
[TRAIN][ep=072] loss=0.5745 acc=86.85%
[TRAIN][ep=072] mask_avg: mc_mean=0.0790 mb_mean=0.5015 norm_overlap=0.9604 corr_cb=-0.4991
[EPOCH 072/089] train: loss=0.5745 acc=86.85% | val: loss=0.6139 acc=74.70% f1=77.89% auc=80.35% val_score=58.4318 val_score_bestthr=73.9970 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.079, mb=0.501, no=0.960, corr=-0.499) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3735 -> 73.9970
[DBG][ep=073] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=073] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=073] mask(step0): mc_mean=0.0454 mb_mean=0.5061 norm_overlap=0.9521 corr_cb=-0.4787 topkJ=0.0000
[TRAIN][ep=073] loss=0.5716 acc=86.58%
[TRAIN][ep=073] mask_avg: mc_mean=0.0789 mb_mean=0.5015 norm_overlap=0.9604 corr_cb=-0.4980
[EPOCH 073/089] train: loss=0.5716 acc=86.58% | val: loss=0.6196 acc=74.70% f1=77.89% auc=80.47% val_score=60.4796 val_score_bestthr=73.9970 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.079, mb=0.501, no=0.960, corr=-0.498) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3735 -> 73.9970
[DBG][ep=074] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=074] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=074] mask(step0): mc_mean=0.0999 mb_mean=0.4965 norm_overlap=0.9693 corr_cb=-0.5086 topkJ=0.0000
[TRAIN][ep=074] loss=0.5720 acc=85.91%
[TRAIN][ep=074] mask_avg: mc_mean=0.0789 mb_mean=0.5015 norm_overlap=0.9603 corr_cb=-0.5003
[EPOCH 074/089] train: loss=0.5720 acc=85.91% | val: loss=0.6320 acc=74.70% f1=77.89% auc=80.29% val_score=59.5758 val_score_bestthr=73.9970 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.079, mb=0.501, no=0.960, corr=-0.500) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3735 -> 73.9970
[DBG][ep=075] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=075] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=075] mask(step0): mc_mean=0.0444 mb_mean=0.5054 norm_overlap=0.9590 corr_cb=-0.4298 topkJ=0.0000
[TRAIN][ep=075] loss=0.5709 acc=86.71%
[TRAIN][ep=075] mask_avg: mc_mean=0.0789 mb_mean=0.5014 norm_overlap=0.9605 corr_cb=-0.5001
[EPOCH 075/089] train: loss=0.5709 acc=86.71% | val: loss=0.5921 acc=73.49% f1=76.60% auc=80.87% val_score=68.7470 val_score_bestthr=73.2087 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.079, mb=0.501, no=0.961, corr=-0.500) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3735 -> 73.2087
[DBG][ep=076] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=076] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=076] mask(step0): mc_mean=0.0601 mb_mean=0.5036 norm_overlap=0.9514 corr_cb=-0.4782 topkJ=0.0000
[TRAIN][ep=076] loss=0.5701 acc=85.64%
[TRAIN][ep=076] mask_avg: mc_mean=0.0790 mb_mean=0.5014 norm_overlap=0.9605 corr_cb=-0.4994
[EPOCH 076/089] train: loss=0.5701 acc=85.64% | val: loss=0.6005 acc=74.70% f1=77.89% auc=80.58% val_score=66.6278 val_score_bestthr=73.9970 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.079, mb=0.501, no=0.960, corr=-0.499) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3735 -> 73.9970
[DBG][ep=077] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=077] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=077] mask(step0): mc_mean=0.1286 mb_mean=0.4942 norm_overlap=0.9638 corr_cb=-0.5684 topkJ=0.0000
[TRAIN][ep=077] loss=0.5718 acc=86.44%
[TRAIN][ep=077] mask_avg: mc_mean=0.0790 mb_mean=0.5014 norm_overlap=0.9606 corr_cb=-0.5002
[EPOCH 077/089] train: loss=0.5718 acc=86.44% | val: loss=0.6077 acc=73.49% f1=76.60% auc=80.58% val_score=66.6278 val_score_bestthr=73.2087 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.079, mb=0.501, no=0.961, corr=-0.500) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.3735 -> 73.2087
[EARLY STOP] no improvement for 30 epochs. best_epoch=47
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
=============== FIT DONE ===============
[BEST] epoch=47 | val_acc=74.70% | val_f1=76.92% | val_auc=81.80% | val_score=70.5913 | val_score_bestthr=79.3735
[TEST@BEST] thr_used=0.395 | acc=57.97% f1=67.66% auc=64.24% | SP_sex=8.39% EO_sex=4.42% SP_age=13.30% EO_age=5.10%
[TIME] 1.82 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/summary_fold_0.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4752 mb_mean=0.5091 norm_overlap=0.9996 corr_cb=-0.4004 topkJ=0.0039
[TRAIN][ep=000] loss=0.6932 acc=51.14%
[TRAIN][ep=000] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1325
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4782 mb_mean=0.5028 norm_overlap=0.9999 corr_cb=-0.0933 topkJ=0.0031
[TRAIN][ep=001] loss=0.6927 acc=51.01%
[TRAIN][ep=001] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1283
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4776 mb_mean=0.5098 norm_overlap=0.9997 corr_cb=-0.3755 topkJ=0.0024
[TRAIN][ep=002] loss=0.6906 acc=53.42%
[TRAIN][ep=002] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1407
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4785 mb_mean=0.5037 norm_overlap=1.0000 corr_cb=0.0262 topkJ=0.0152
[TRAIN][ep=003] loss=0.6892 acc=55.84%
[TRAIN][ep=003] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1330
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4760 mb_mean=0.5053 norm_overlap=0.9998 corr_cb=-0.2618 topkJ=0.0459
[TRAIN][ep=004] loss=0.6879 acc=57.32%
[TRAIN][ep=004] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1247
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4794 mb_mean=0.5002 norm_overlap=0.9999 corr_cb=-0.2006 topkJ=0.0064
[TRAIN][ep=005] loss=0.6871 acc=54.09%
[TRAIN][ep=005] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1272
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4760 mb_mean=0.5040 norm_overlap=0.9997 corr_cb=-0.4011 topkJ=0.0113
[TRAIN][ep=006] loss=0.6832 acc=56.24%
[TRAIN][ep=006] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1302
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4758 mb_mean=0.5023 norm_overlap=0.9998 corr_cb=-0.2950 topkJ=0.0024
[TRAIN][ep=007] loss=0.6767 acc=59.19%
[TRAIN][ep=007] mask_avg: mc_mean=0.4785 mb_mean=0.5015 norm_overlap=0.9999 corr_cb=-0.1365
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4784 mb_mean=0.4987 norm_overlap=0.9997 corr_cb=-0.3532 topkJ=0.0048
[TRAIN][ep=008] loss=0.6721 acc=63.89%
[TRAIN][ep=008] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1238
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4781 mb_mean=0.5042 norm_overlap=0.9998 corr_cb=-0.2975 topkJ=0.0188
[TRAIN][ep=009] loss=0.6643 acc=62.68%
[TRAIN][ep=009] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1254
================= FIT START (fold=0) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4787 mb_mean=0.5043 norm_overlap=0.9999 corr_cb=-0.0822 topkJ=0.0502
[TRAIN][ep=000] loss=0.6582 acc=63.62%
[TRAIN][ep=000] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1201
[EPOCH 000/089] train: loss=0.6582 acc=63.62% | val: loss=0.6534 acc=67.47% f1=74.29% auc=71.74% val_score=55.4225 val_score_bestthr=63.3503 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.120) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 63.3503
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4793 mb_mean=0.5022 norm_overlap=0.9998 corr_cb=-0.2365 topkJ=0.0024
[TRAIN][ep=001] loss=0.6517 acc=64.43%
[TRAIN][ep=001] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1274
[EPOCH 001/089] train: loss=0.6517 acc=64.43% | val: loss=0.6599 acc=61.45% f1=72.41% auc=68.49% val_score=47.5336 val_score_bestthr=64.7777 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.127) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 63.3503 -> 64.7777
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4774 mb_mean=0.4982 norm_overlap=1.0000 corr_cb=-0.0324 topkJ=0.0252
[TRAIN][ep=002] loss=0.6471 acc=64.30%
[TRAIN][ep=002] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1182
[EPOCH 002/089] train: loss=0.6471 acc=64.30% | val: loss=0.6414 acc=68.67% f1=75.00% auc=72.44% val_score=47.9380 val_score_bestthr=63.1152 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.118) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.7777 -> 63.1152
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4776 mb_mean=0.5075 norm_overlap=0.9998 corr_cb=-0.2177 topkJ=0.0023
[TRAIN][ep=003] loss=0.6421 acc=64.43%
[TRAIN][ep=003] mask_avg: mc_mean=0.4785 mb_mean=0.5015 norm_overlap=0.9999 corr_cb=-0.1255
[EPOCH 003/089] train: loss=0.6421 acc=64.43% | val: loss=0.6608 acc=63.86% f1=73.68% auc=69.24% val_score=54.7539 val_score_bestthr=65.2221 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.125) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 64.7777 -> 65.2221
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4824 mb_mean=0.4950 norm_overlap=0.9998 corr_cb=-0.2211 topkJ=0.0294
[TRAIN][ep=004] loss=0.6474 acc=62.01%
[TRAIN][ep=004] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1284
[EPOCH 004/089] train: loss=0.6474 acc=62.01% | val: loss=0.6352 acc=69.88% f1=76.19% auc=73.08% val_score=46.9114 val_score_bestthr=64.6846 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.128) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 65.2221 -> 64.6846
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4744 mb_mean=0.5047 norm_overlap=0.9999 corr_cb=-0.0747 topkJ=0.0278
[TRAIN][ep=005] loss=1.4596 acc=65.10%
[TRAIN][ep=005] mask_avg: mc_mean=0.3484 mb_mean=0.5014 norm_overlap=0.9963 corr_cb=-0.6385
[EPOCH 005/089] train: loss=1.4596 acc=65.10% | val: loss=0.6522 acc=67.47% f1=69.66% auc=75.70% val_score=62.4643 val_score_bestthr=63.5118 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.348, mb=0.501, no=0.996, corr=-0.639) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.2221 -> 63.5118
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2017 mb_mean=0.5118 norm_overlap=0.9866 corr_cb=-0.7988 topkJ=0.0000
[TRAIN][ep=006] loss=1.4346 acc=66.04%
[TRAIN][ep=006] mask_avg: mc_mean=0.1942 mb_mean=0.5014 norm_overlap=0.9888 corr_cb=-0.7186
[EPOCH 006/089] train: loss=1.4346 acc=66.04% | val: loss=0.6380 acc=69.88% f1=66.67% auc=76.63% val_score=65.9943 val_score_bestthr=62.2202 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.194, mb=0.501, no=0.989, corr=-0.719) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.2221 -> 62.2202
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.1535 mb_mean=0.5024 norm_overlap=0.9841 corr_cb=-0.7870 topkJ=0.0000
[TRAIN][ep=007] loss=1.4371 acc=62.55%
[TRAIN][ep=007] mask_avg: mc_mean=0.1259 mb_mean=0.5014 norm_overlap=0.9818 corr_cb=-0.7186
[EPOCH 007/089] train: loss=1.4371 acc=62.55% | val: loss=0.6285 acc=69.88% f1=75.73% auc=74.19% val_score=52.4552 val_score_bestthr=64.6321 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.126, mb=0.501, no=0.982, corr=-0.719) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.2221 -> 64.6321
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1101 mb_mean=0.5001 norm_overlap=0.9752 corr_cb=-0.7729 topkJ=0.0000
[TRAIN][ep=008] loss=1.4208 acc=67.25%
[TRAIN][ep=008] mask_avg: mc_mean=0.0817 mb_mean=0.5014 norm_overlap=0.9748 corr_cb=-0.6720
[EPOCH 008/089] train: loss=1.4208 acc=67.25% | val: loss=0.6346 acc=67.47% f1=75.23% auc=73.55% val_score=61.5991 val_score_bestthr=65.3678 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.082, mb=0.501, no=0.975, corr=-0.672) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 65.2221 -> 65.3678
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.0581 mb_mean=0.5043 norm_overlap=0.9723 corr_cb=-0.6664 topkJ=0.0000
[TRAIN][ep=009] loss=1.4000 acc=69.26%
[TRAIN][ep=009] mask_avg: mc_mean=0.0691 mb_mean=0.5014 norm_overlap=0.9704 corr_cb=-0.6316
[EPOCH 009/089] train: loss=1.4000 acc=69.26% | val: loss=0.6052 acc=67.47% f1=73.79% auc=75.76% val_score=49.7236 val_score_bestthr=64.0005 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.069, mb=0.501, no=0.970, corr=-0.632) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.3678 -> 64.0005
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.0844 mb_mean=0.4997 norm_overlap=0.9624 corr_cb=-0.6836 topkJ=0.0000
[TRAIN][ep=010] loss=0.9276 acc=67.79%
[TRAIN][ep=010] mask_avg: mc_mean=0.0694 mb_mean=0.5015 norm_overlap=0.9678 corr_cb=-0.6064
[EPOCH 010/089] train: loss=0.9276 acc=67.79% | val: loss=0.6027 acc=71.08% f1=65.71% auc=75.64% val_score=54.5243 val_score_bestthr=64.2616 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.069, mb=0.501, no=0.968, corr=-0.606) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.3678 -> 64.2616
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.0921 mb_mean=0.5016 norm_overlap=0.9549 corr_cb=-0.6486 topkJ=0.0000
[TRAIN][ep=011] loss=0.8502 acc=69.80%
[TRAIN][ep=011] mask_avg: mc_mean=0.0609 mb_mean=0.5015 norm_overlap=0.9643 corr_cb=-0.5718
[EPOCH 011/089] train: loss=0.8502 acc=69.80% | val: loss=0.5923 acc=73.49% f1=69.44% auc=75.93% val_score=47.9807 val_score_bestthr=65.6306 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.061, mb=0.501, no=0.964, corr=-0.572) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 65.3678 -> 65.6306
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.0357 mb_mean=0.5072 norm_overlap=0.9622 corr_cb=-0.5393 topkJ=0.0000
[TRAIN][ep=012] loss=0.8502 acc=68.99%
[TRAIN][ep=012] mask_avg: mc_mean=0.0579 mb_mean=0.5014 norm_overlap=0.9623 corr_cb=-0.5487
[EPOCH 012/089] train: loss=0.8502 acc=68.99% | val: loss=0.6284 acc=71.08% f1=64.71% auc=74.01% val_score=51.3437 val_score_bestthr=66.1865 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.058, mb=0.501, no=0.962, corr=-0.549) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 65.6306 -> 66.1865
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.0307 mb_mean=0.5080 norm_overlap=0.9533 corr_cb=-0.3694 topkJ=0.0000
[TRAIN][ep=013] loss=0.8377 acc=71.28%
[TRAIN][ep=013] mask_avg: mc_mean=0.0515 mb_mean=0.5015 norm_overlap=0.9595 corr_cb=-0.5254
[EPOCH 013/089] train: loss=0.8377 acc=71.28% | val: loss=0.5898 acc=72.29% f1=66.67% auc=75.52% val_score=59.7524 val_score_bestthr=66.6238 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.052, mb=0.501, no=0.959, corr=-0.525) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 66.1865 -> 66.6238
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.0579 mb_mean=0.4973 norm_overlap=0.9714 corr_cb=-0.4805 topkJ=0.0024
[TRAIN][ep=014] loss=0.8322 acc=71.28%
[TRAIN][ep=014] mask_avg: mc_mean=0.0519 mb_mean=0.5014 norm_overlap=0.9586 corr_cb=-0.5177
[EPOCH 014/089] train: loss=0.8322 acc=71.28% | val: loss=0.5833 acc=73.49% f1=68.57% auc=75.93% val_score=52.8036 val_score_bestthr=65.9223 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.052, mb=0.501, no=0.959, corr=-0.518) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6238 -> 65.9223
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.0311 mb_mean=0.5043 norm_overlap=0.9558 corr_cb=-0.4268 topkJ=0.0000
[TRAIN][ep=015] loss=0.8195 acc=72.48%
[TRAIN][ep=015] mask_avg: mc_mean=0.0552 mb_mean=0.5014 norm_overlap=0.9588 corr_cb=-0.5187
[EPOCH 015/089] train: loss=0.8195 acc=72.48% | val: loss=0.5738 acc=73.49% f1=68.57% auc=76.69% val_score=54.8728 val_score_bestthr=65.9223 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.055, mb=0.501, no=0.959, corr=-0.519) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6238 -> 65.9223
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.0358 mb_mean=0.5102 norm_overlap=0.9419 corr_cb=-0.5241 topkJ=0.0000
[TRAIN][ep=016] loss=0.8280 acc=71.54%
[TRAIN][ep=016] mask_avg: mc_mean=0.0468 mb_mean=0.5014 norm_overlap=0.9559 corr_cb=-0.4897
[EPOCH 016/089] train: loss=0.8280 acc=71.54% | val: loss=0.5743 acc=75.90% f1=72.22% auc=76.92% val_score=49.0913 val_score_bestthr=66.6919 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.047, mb=0.501, no=0.956, corr=-0.490) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 66.6238 -> 66.6919
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.0577 mb_mean=0.4927 norm_overlap=0.9730 corr_cb=-0.4252 topkJ=0.0008
[TRAIN][ep=017] loss=0.8200 acc=71.41%
[TRAIN][ep=017] mask_avg: mc_mean=0.0426 mb_mean=0.5014 norm_overlap=0.9545 corr_cb=-0.4742
[EPOCH 017/089] train: loss=0.8200 acc=71.41% | val: loss=0.5793 acc=73.49% f1=68.57% auc=76.28% val_score=61.1980 val_score_bestthr=65.9223 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.043, mb=0.501, no=0.955, corr=-0.474) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6919 -> 65.9223
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.0492 mb_mean=0.5052 norm_overlap=0.9474 corr_cb=-0.5286 topkJ=0.0000
[TRAIN][ep=018] loss=0.8054 acc=72.48%
[TRAIN][ep=018] mask_avg: mc_mean=0.0587 mb_mean=0.5014 norm_overlap=0.9578 corr_cb=-0.5140
[EPOCH 018/089] train: loss=0.8054 acc=72.48% | val: loss=0.7129 acc=66.27% f1=72.00% auc=74.59% val_score=51.6446 val_score_bestthr=67.0213 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.059, mb=0.501, no=0.958, corr=-0.514) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 66.6919 -> 67.0213
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.0367 mb_mean=0.4998 norm_overlap=0.9534 corr_cb=-0.4658 topkJ=0.0000
[TRAIN][ep=019] loss=0.8316 acc=70.47%
[TRAIN][ep=019] mask_avg: mc_mean=0.0390 mb_mean=0.5014 norm_overlap=0.9527 corr_cb=-0.4574
[EPOCH 019/089] train: loss=0.8316 acc=70.47% | val: loss=0.6265 acc=67.47% f1=74.77% auc=75.70% val_score=60.2367 val_score_bestthr=66.4819 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.039, mb=0.501, no=0.953, corr=-0.457) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.0213 -> 66.4819
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.0767 mb_mean=0.4956 norm_overlap=0.9529 corr_cb=-0.5794 topkJ=0.0000
[TRAIN][ep=020] loss=0.8108 acc=72.89%
[TRAIN][ep=020] mask_avg: mc_mean=0.0456 mb_mean=0.5014 norm_overlap=0.9544 corr_cb=-0.4821
[EPOCH 020/089] train: loss=0.8108 acc=72.89% | val: loss=0.5863 acc=73.49% f1=68.57% auc=76.92% val_score=58.7307 val_score_bestthr=65.9223 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.046, mb=0.501, no=0.954, corr=-0.482) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.0213 -> 65.9223
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.0430 mb_mean=0.5057 norm_overlap=0.9444 corr_cb=-0.4632 topkJ=0.0000
[TRAIN][ep=021] loss=0.7919 acc=73.69%
[TRAIN][ep=021] mask_avg: mc_mean=0.0624 mb_mean=0.5014 norm_overlap=0.9577 corr_cb=-0.5218
[EPOCH 021/089] train: loss=0.7919 acc=73.69% | val: loss=0.5899 acc=67.47% f1=74.29% auc=77.33% val_score=58.7307 val_score_bestthr=68.5589 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.062, mb=0.501, no=0.958, corr=-0.522) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 67.0213 -> 68.5589
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.0782 mb_mean=0.4985 norm_overlap=0.9654 corr_cb=-0.4694 topkJ=0.0000
[TRAIN][ep=022] loss=0.7958 acc=73.83%
[TRAIN][ep=022] mask_avg: mc_mean=0.0576 mb_mean=0.5014 norm_overlap=0.9565 corr_cb=-0.5094
[EPOCH 022/089] train: loss=0.7958 acc=73.83% | val: loss=0.5491 acc=66.27% f1=75.00% auc=78.20% val_score=61.2877 val_score_bestthr=69.6680 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.058, mb=0.501, no=0.956, corr=-0.509) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 68.5589 -> 69.6680
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.0438 mb_mean=0.5003 norm_overlap=0.9547 corr_cb=-0.4490 topkJ=0.0000
[TRAIN][ep=023] loss=0.8028 acc=72.62%
[TRAIN][ep=023] mask_avg: mc_mean=0.0459 mb_mean=0.5015 norm_overlap=0.9535 corr_cb=-0.4762
[EPOCH 023/089] train: loss=0.8028 acc=72.62% | val: loss=0.5534 acc=74.70% f1=72.00% auc=78.26% val_score=57.8118 val_score_bestthr=65.3644 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.046, mb=0.501, no=0.953, corr=-0.476) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.6680 -> 65.3644
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.0460 mb_mean=0.5001 norm_overlap=0.9619 corr_cb=-0.3866 topkJ=0.0000
[TRAIN][ep=024] loss=0.7720 acc=75.84%
[TRAIN][ep=024] mask_avg: mc_mean=0.0531 mb_mean=0.5014 norm_overlap=0.9552 corr_cb=-0.4912
[EPOCH 024/089] train: loss=0.7720 acc=75.84% | val: loss=0.5555 acc=75.90% f1=74.36% auc=78.14% val_score=57.1066 val_score_bestthr=68.2337 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.053, mb=0.501, no=0.955, corr=-0.491) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.6680 -> 68.2337
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.0514 mb_mean=0.5013 norm_overlap=0.9564 corr_cb=-0.5419 topkJ=0.0000
[TRAIN][ep=025] loss=0.7914 acc=73.69%
[TRAIN][ep=025] mask_avg: mc_mean=0.0503 mb_mean=0.5014 norm_overlap=0.9542 corr_cb=-0.4818
[EPOCH 025/089] train: loss=0.7914 acc=73.69% | val: loss=0.5549 acc=72.29% f1=72.29% auc=77.15% val_score=64.9703 val_score_bestthr=66.3844 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.050, mb=0.501, no=0.954, corr=-0.482) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.6680 -> 66.3844
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.0383 mb_mean=0.5025 norm_overlap=0.9490 corr_cb=-0.5166 topkJ=0.0000
[TRAIN][ep=026] loss=0.7680 acc=74.50%
[TRAIN][ep=026] mask_avg: mc_mean=0.0577 mb_mean=0.5014 norm_overlap=0.9561 corr_cb=-0.5038
[EPOCH 026/089] train: loss=0.7680 acc=74.50% | val: loss=0.5764 acc=74.70% f1=72.73% auc=78.66% val_score=60.3976 val_score_bestthr=69.5636 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.058, mb=0.501, no=0.956, corr=-0.504) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.6680 -> 69.5636
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.0749 mb_mean=0.5001 norm_overlap=0.9520 corr_cb=-0.5840 topkJ=0.0000
[TRAIN][ep=027] loss=0.7657 acc=74.63%
[TRAIN][ep=027] mask_avg: mc_mean=0.0621 mb_mean=0.5014 norm_overlap=0.9570 corr_cb=-0.5111
[EPOCH 027/089] train: loss=0.7657 acc=74.63% | val: loss=0.6055 acc=72.29% f1=72.94% auc=77.27% val_score=58.7307 val_score_bestthr=69.2820 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.062, mb=0.501, no=0.957, corr=-0.511) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.6680 -> 69.2820
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.0698 mb_mean=0.4951 norm_overlap=0.9720 corr_cb=-0.4176 topkJ=0.0000
[TRAIN][ep=028] loss=0.7631 acc=74.63%
[TRAIN][ep=028] mask_avg: mc_mean=0.0607 mb_mean=0.5015 norm_overlap=0.9566 corr_cb=-0.5044
[EPOCH 028/089] train: loss=0.7631 acc=74.63% | val: loss=0.5538 acc=77.11% f1=76.54% auc=79.13% val_score=58.6883 val_score_bestthr=74.5003 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.061, mb=0.501, no=0.957, corr=-0.504) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 69.6680 -> 74.5003
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.0734 mb_mean=0.4980 norm_overlap=0.9636 corr_cb=-0.5034 topkJ=0.0000
[TRAIN][ep=029] loss=0.7465 acc=78.39%
[TRAIN][ep=029] mask_avg: mc_mean=0.0581 mb_mean=0.5015 norm_overlap=0.9561 corr_cb=-0.5019
[EPOCH 029/089] train: loss=0.7465 acc=78.39% | val: loss=0.6013 acc=68.67% f1=75.47% auc=79.88% val_score=68.9564 val_score_bestthr=68.0317 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.058, mb=0.501, no=0.956, corr=-0.502) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.5003 -> 68.0317
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.0832 mb_mean=0.4961 norm_overlap=0.9684 corr_cb=-0.5510 topkJ=0.0000
[TRAIN][ep=030] loss=0.7513 acc=74.90%
[TRAIN][ep=030] mask_avg: mc_mean=0.0627 mb_mean=0.5015 norm_overlap=0.9569 corr_cb=-0.5107
[EPOCH 030/089] train: loss=0.7513 acc=74.90% | val: loss=0.5443 acc=75.90% f1=75.61% auc=79.77% val_score=60.1640 val_score_bestthr=73.3583 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.063, mb=0.501, no=0.957, corr=-0.511) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.5003 -> 73.3583
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.0588 mb_mean=0.5019 norm_overlap=0.9606 corr_cb=-0.5145 topkJ=0.0000
[TRAIN][ep=031] loss=0.7323 acc=77.45%
[TRAIN][ep=031] mask_avg: mc_mean=0.0655 mb_mean=0.5015 norm_overlap=0.9575 corr_cb=-0.5152
[EPOCH 031/089] train: loss=0.7323 acc=77.45% | val: loss=0.5494 acc=75.90% f1=75.61% auc=78.95% val_score=63.4226 val_score_bestthr=73.9054 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.066, mb=0.501, no=0.957, corr=-0.515) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.5003 -> 73.9054
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.0598 mb_mean=0.4988 norm_overlap=0.9566 corr_cb=-0.5742 topkJ=0.0000
[TRAIN][ep=032] loss=0.7400 acc=78.39%
[TRAIN][ep=032] mask_avg: mc_mean=0.0670 mb_mean=0.5014 norm_overlap=0.9582 corr_cb=-0.5115
[EPOCH 032/089] train: loss=0.7400 acc=78.39% | val: loss=0.5538 acc=74.70% f1=74.07% auc=79.88% val_score=58.9681 val_score_bestthr=74.8669 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.067, mb=0.501, no=0.958, corr=-0.512) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 74.5003 -> 74.8669
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.0779 mb_mean=0.4952 norm_overlap=0.9704 corr_cb=-0.4878 topkJ=0.0004
[TRAIN][ep=033] loss=0.7206 acc=77.58%
[TRAIN][ep=033] mask_avg: mc_mean=0.0638 mb_mean=0.5014 norm_overlap=0.9575 corr_cb=-0.5001
[EPOCH 033/089] train: loss=0.7206 acc=77.58% | val: loss=0.5592 acc=74.70% f1=75.86% auc=79.71% val_score=54.5230 val_score_bestthr=76.0816 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.064, mb=0.501, no=0.958, corr=-0.500) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 74.8669 -> 76.0816
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.0873 mb_mean=0.5028 norm_overlap=0.9593 corr_cb=-0.6024 topkJ=0.0000
[TRAIN][ep=034] loss=0.7224 acc=75.84%
[TRAIN][ep=034] mask_avg: mc_mean=0.0789 mb_mean=0.5014 norm_overlap=0.9596 corr_cb=-0.5160
[EPOCH 034/089] train: loss=0.7224 acc=75.84% | val: loss=0.5398 acc=68.67% f1=72.34% auc=79.30% val_score=62.0977 val_score_bestthr=69.7382 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.079, mb=0.501, no=0.960, corr=-0.516) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.0816 -> 69.7382
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.0381 mb_mean=0.5037 norm_overlap=0.9555 corr_cb=-0.4414 topkJ=0.0000
[TRAIN][ep=035] loss=0.7102 acc=80.13%
[TRAIN][ep=035] mask_avg: mc_mean=0.0658 mb_mean=0.5014 norm_overlap=0.9579 corr_cb=-0.5024
[EPOCH 035/089] train: loss=0.7102 acc=80.13% | val: loss=0.5340 acc=73.49% f1=77.55% auc=81.22% val_score=56.3691 val_score_bestthr=72.5893 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.066, mb=0.501, no=0.958, corr=-0.502) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.0816 -> 72.5893
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.0688 mb_mean=0.4983 norm_overlap=0.9577 corr_cb=-0.5394 topkJ=0.0000
[TRAIN][ep=036] loss=0.7190 acc=78.12%
[TRAIN][ep=036] mask_avg: mc_mean=0.0725 mb_mean=0.5015 norm_overlap=0.9589 corr_cb=-0.5148
[EPOCH 036/089] train: loss=0.7190 acc=78.12% | val: loss=0.5699 acc=73.49% f1=77.55% auc=80.70% val_score=55.9281 val_score_bestthr=74.5060 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.073, mb=0.501, no=0.959, corr=-0.515) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.0816 -> 74.5060
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.0442 mb_mean=0.5046 norm_overlap=0.9511 corr_cb=-0.4929 topkJ=0.0000
[TRAIN][ep=037] loss=0.7058 acc=78.66%
[TRAIN][ep=037] mask_avg: mc_mean=0.0701 mb_mean=0.5014 norm_overlap=0.9585 corr_cb=-0.5083
[EPOCH 037/089] train: loss=0.7058 acc=78.66% | val: loss=0.5640 acc=71.08% f1=74.47% auc=81.28% val_score=55.0122 val_score_bestthr=75.4451 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.070, mb=0.501, no=0.959, corr=-0.508) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.0816 -> 75.4451
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.0747 mb_mean=0.4966 norm_overlap=0.9678 corr_cb=-0.5327 topkJ=0.0000
[TRAIN][ep=038] loss=0.7246 acc=77.72%
[TRAIN][ep=038] mask_avg: mc_mean=0.0422 mb_mean=0.5014 norm_overlap=0.9520 corr_cb=-0.4332
[EPOCH 038/089] train: loss=0.7246 acc=77.72% | val: loss=0.5360 acc=71.08% f1=73.33% auc=80.81% val_score=65.3839 val_score_bestthr=69.7688 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.042, mb=0.501, no=0.952, corr=-0.433) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.0816 -> 69.7688
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.0433 mb_mean=0.5081 norm_overlap=0.9451 corr_cb=-0.5081 topkJ=0.0000
[TRAIN][ep=039] loss=0.6806 acc=81.21%
[TRAIN][ep=039] mask_avg: mc_mean=0.0792 mb_mean=0.5015 norm_overlap=0.9602 corr_cb=-0.5220
[EPOCH 039/089] train: loss=0.6806 acc=81.21% | val: loss=0.5360 acc=72.29% f1=74.73% auc=81.63% val_score=69.8061 val_score_bestthr=73.3045 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.079, mb=0.501, no=0.960, corr=-0.522) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.0816 -> 73.3045
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.1030 mb_mean=0.5035 norm_overlap=0.9531 corr_cb=-0.6325 topkJ=0.0000
[TRAIN][ep=040] loss=0.6887 acc=79.73%
[TRAIN][ep=040] mask_avg: mc_mean=0.0754 mb_mean=0.5014 norm_overlap=0.9598 corr_cb=-0.5084
[EPOCH 040/089] train: loss=0.6887 acc=79.73% | val: loss=0.5613 acc=75.90% f1=75.61% auc=81.16% val_score=62.1770 val_score_bestthr=74.5177 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.075, mb=0.501, no=0.960, corr=-0.508) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.0816 -> 74.5177
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.0934 mb_mean=0.5010 norm_overlap=0.9555 corr_cb=-0.6056 topkJ=0.0000
[TRAIN][ep=041] loss=0.6958 acc=78.26%
[TRAIN][ep=041] mask_avg: mc_mean=0.0745 mb_mean=0.5014 norm_overlap=0.9595 corr_cb=-0.5051
[EPOCH 041/089] train: loss=0.6958 acc=78.26% | val: loss=0.5524 acc=74.70% f1=77.42% auc=81.63% val_score=66.4816 val_score_bestthr=74.3342 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.074, mb=0.501, no=0.959, corr=-0.505) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.0816 -> 74.3342
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.0826 mb_mean=0.4956 norm_overlap=0.9718 corr_cb=-0.4693 topkJ=0.0000
[TRAIN][ep=042] loss=0.6851 acc=80.67%
[TRAIN][ep=042] mask_avg: mc_mean=0.0804 mb_mean=0.5014 norm_overlap=0.9604 corr_cb=-0.5052
[EPOCH 042/089] train: loss=0.6851 acc=80.67% | val: loss=0.5313 acc=73.49% f1=78.43% auc=81.74% val_score=61.5744 val_score_bestthr=74.4471 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.080, mb=0.501, no=0.960, corr=-0.505) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.0816 -> 74.4471
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.0394 mb_mean=0.4997 norm_overlap=0.9587 corr_cb=-0.4675 topkJ=0.0000
[TRAIN][ep=043] loss=0.6851 acc=78.66%
[TRAIN][ep=043] mask_avg: mc_mean=0.0690 mb_mean=0.5014 norm_overlap=0.9589 corr_cb=-0.4891
[EPOCH 043/089] train: loss=0.6851 acc=78.66% | val: loss=0.6721 acc=75.90% f1=78.72% auc=82.21% val_score=52.4567 val_score_bestthr=78.3116 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.069, mb=0.501, no=0.959, corr=-0.489) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 76.0816 -> 78.3116
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.0509 mb_mean=0.5072 norm_overlap=0.9503 corr_cb=-0.5151 topkJ=0.0000
[TRAIN][ep=044] loss=0.6665 acc=80.40%
[TRAIN][ep=044] mask_avg: mc_mean=0.0786 mb_mean=0.5015 norm_overlap=0.9605 corr_cb=-0.5087
[EPOCH 044/089] train: loss=0.6665 acc=80.40% | val: loss=0.5511 acc=71.08% f1=77.36% auc=81.80% val_score=66.2133 val_score_bestthr=72.8286 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.079, mb=0.501, no=0.961, corr=-0.509) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 78.3116 -> 72.8286
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.0811 mb_mean=0.4984 norm_overlap=0.9612 corr_cb=-0.4542 topkJ=0.0000
[TRAIN][ep=045] loss=0.6522 acc=82.55%
[TRAIN][ep=045] mask_avg: mc_mean=0.0842 mb_mean=0.5014 norm_overlap=0.9613 corr_cb=-0.5115
[EPOCH 045/089] train: loss=0.6522 acc=82.55% | val: loss=0.5718 acc=73.49% f1=77.55% auc=82.03% val_score=70.5913 val_score_bestthr=73.2165 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.084, mb=0.501, no=0.961, corr=-0.511) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 78.3116 -> 73.2165
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.1048 mb_mean=0.4955 norm_overlap=0.9702 corr_cb=-0.4964 topkJ=0.0000
[TRAIN][ep=046] loss=0.7469 acc=81.48%
[TRAIN][ep=046] mask_avg: mc_mean=0.0777 mb_mean=0.5015 norm_overlap=0.9599 corr_cb=-0.4975
[EPOCH 046/089] train: loss=0.7469 acc=81.48% | val: loss=0.6250 acc=73.49% f1=76.60% auc=81.51% val_score=55.9281 val_score_bestthr=73.2087 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.078, mb=0.501, no=0.960, corr=-0.498) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 78.3116 -> 73.2087
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.0749 mb_mean=0.5047 norm_overlap=0.9625 corr_cb=-0.5277 topkJ=0.0000
[TRAIN][ep=047] loss=0.6476 acc=81.21%
[TRAIN][ep=047] mask_avg: mc_mean=0.0880 mb_mean=0.5014 norm_overlap=0.9619 corr_cb=-0.5101
[EPOCH 047/089] train: loss=0.6476 acc=81.21% | val: loss=0.5675 acc=74.70% f1=79.21% auc=81.80% val_score=77.8191 val_score_bestthr=77.8191 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.088, mb=0.501, no=0.962, corr=-0.510) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 78.3116 -> 77.8191
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.0893 mb_mean=0.4955 norm_overlap=0.9675 corr_cb=-0.4897 topkJ=0.0000
[TRAIN][ep=048] loss=0.7570 acc=81.48%
[TRAIN][ep=048] mask_avg: mc_mean=0.0827 mb_mean=0.5014 norm_overlap=0.9608 corr_cb=-0.5039
[EPOCH 048/089] train: loss=0.7570 acc=81.48% | val: loss=0.5514 acc=72.29% f1=74.16% auc=80.99% val_score=65.4105 val_score_bestthr=71.1842 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.083, mb=0.501, no=0.961, corr=-0.504) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 78.3116 -> 71.1842
[DBG][ep=049] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.0475 mb_mean=0.5049 norm_overlap=0.9565 corr_cb=-0.4719 topkJ=0.0000
[TRAIN][ep=049] loss=0.6379 acc=82.42%
[TRAIN][ep=049] mask_avg: mc_mean=0.0754 mb_mean=0.5014 norm_overlap=0.9598 corr_cb=-0.4938
[EPOCH 049/089] train: loss=0.6379 acc=82.42% | val: loss=0.6331 acc=77.11% f1=75.95% auc=81.05% val_score=55.0122 val_score_bestthr=72.8288 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.075, mb=0.501, no=0.960, corr=-0.494) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 78.3116 -> 72.8288
[DBG][ep=050] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.0730 mb_mean=0.5029 norm_overlap=0.9576 corr_cb=-0.4615 topkJ=0.0000
[TRAIN][ep=050] loss=0.6050 acc=84.83%
[TRAIN][ep=050] mask_avg: mc_mean=0.0816 mb_mean=0.5015 norm_overlap=0.9608 corr_cb=-0.5026
[EPOCH 050/089] train: loss=0.6050 acc=84.83% | val: loss=0.6015 acc=72.29% f1=76.77% auc=80.76% val_score=55.2534 val_score_bestthr=74.6040 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.503) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 78.3116 -> 74.6040
[DBG][ep=051] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.0770 mb_mean=0.5035 norm_overlap=0.9570 corr_cb=-0.5473 topkJ=0.0000
[TRAIN][ep=051] loss=0.6030 acc=85.10%
[TRAIN][ep=051] mask_avg: mc_mean=0.0817 mb_mean=0.5015 norm_overlap=0.9610 corr_cb=-0.5007
[EPOCH 051/089] train: loss=0.6030 acc=85.10% | val: loss=0.5856 acc=73.49% f1=77.55% auc=80.76% val_score=58.8580 val_score_bestthr=75.7234 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.501) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 78.3116 -> 75.7234
[DBG][ep=052] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.1064 mb_mean=0.4999 norm_overlap=0.9608 corr_cb=-0.5213 topkJ=0.0000
[TRAIN][ep=052] loss=0.5996 acc=86.04%
[TRAIN][ep=052] mask_avg: mc_mean=0.0817 mb_mean=0.5014 norm_overlap=0.9609 corr_cb=-0.5023
[EPOCH 052/089] train: loss=0.5996 acc=86.04% | val: loss=0.5639 acc=72.29% f1=76.77% auc=80.52% val_score=64.2709 val_score_bestthr=74.6040 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.502) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 78.3116 -> 74.6040
[DBG][ep=053] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.0747 mb_mean=0.5085 norm_overlap=0.9438 corr_cb=-0.5051 topkJ=0.0000
[TRAIN][ep=053] loss=0.5979 acc=84.83%
[TRAIN][ep=053] mask_avg: mc_mean=0.0816 mb_mean=0.5015 norm_overlap=0.9609 corr_cb=-0.5032
[EPOCH 053/089] train: loss=0.5979 acc=84.83% | val: loss=0.5638 acc=72.29% f1=76.77% auc=80.87% val_score=65.4883 val_score_bestthr=74.6040 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.503) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 78.3116 -> 74.6040
[DBG][ep=054] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=054] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=054] mask(step0): mc_mean=0.0767 mb_mean=0.5047 norm_overlap=0.9551 corr_cb=-0.4912 topkJ=0.0000
[TRAIN][ep=054] loss=0.5991 acc=85.37%
[TRAIN][ep=054] mask_avg: mc_mean=0.0817 mb_mean=0.5014 norm_overlap=0.9607 corr_cb=-0.5035
[EPOCH 054/089] train: loss=0.5991 acc=85.37% | val: loss=0.5880 acc=73.49% f1=77.55% auc=80.52% val_score=58.4318 val_score_bestthr=75.7234 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.504) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 78.3116 -> 75.7234
[DBG][ep=055] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=055] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=055] mask(step0): mc_mean=0.0752 mb_mean=0.5009 norm_overlap=0.9622 corr_cb=-0.5664 topkJ=0.0000
[TRAIN][ep=055] loss=0.5938 acc=85.64%
[TRAIN][ep=055] mask_avg: mc_mean=0.0818 mb_mean=0.5014 norm_overlap=0.9609 corr_cb=-0.4998
[EPOCH 055/089] train: loss=0.5938 acc=85.64% | val: loss=0.5939 acc=73.49% f1=77.55% auc=80.76% val_score=60.0004 val_score_bestthr=75.7234 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.500) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 78.3116 -> 75.7234
[DBG][ep=056] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=056] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=056] mask(step0): mc_mean=0.0933 mb_mean=0.5009 norm_overlap=0.9630 corr_cb=-0.5229 topkJ=0.0000
[TRAIN][ep=056] loss=0.5891 acc=85.77%
[TRAIN][ep=056] mask_avg: mc_mean=0.0817 mb_mean=0.5014 norm_overlap=0.9608 corr_cb=-0.5049
[EPOCH 056/089] train: loss=0.5891 acc=85.77% | val: loss=0.5826 acc=73.49% f1=77.55% auc=80.70% val_score=67.7710 val_score_bestthr=75.7234 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.505) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 78.3116 -> 75.7234
[DBG][ep=057] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=057] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=057] mask(step0): mc_mean=0.1171 mb_mean=0.4930 norm_overlap=0.9767 corr_cb=-0.5050 topkJ=0.0032
[TRAIN][ep=057] loss=0.5951 acc=85.50%
[TRAIN][ep=057] mask_avg: mc_mean=0.0816 mb_mean=0.5014 norm_overlap=0.9607 corr_cb=-0.5042
[EPOCH 057/089] train: loss=0.5951 acc=85.50% | val: loss=0.5798 acc=72.29% f1=76.77% auc=80.93% val_score=67.7710 val_score_bestthr=74.6040 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.504) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 78.3116 -> 74.6040
[DBG][ep=058] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=058] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=058] mask(step0): mc_mean=0.1133 mb_mean=0.5023 norm_overlap=0.9605 corr_cb=-0.4996 topkJ=0.0000
[TRAIN][ep=058] loss=0.5919 acc=85.64%
[TRAIN][ep=058] mask_avg: mc_mean=0.0817 mb_mean=0.5014 norm_overlap=0.9609 corr_cb=-0.5029
[EPOCH 058/089] train: loss=0.5919 acc=85.64% | val: loss=0.5802 acc=72.29% f1=76.77% auc=80.64% val_score=67.7710 val_score_bestthr=74.6040 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.503) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 78.3116 -> 74.6040
[DBG][ep=059] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=059] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=059] mask(step0): mc_mean=0.0777 mb_mean=0.5009 norm_overlap=0.9579 corr_cb=-0.5528 topkJ=0.0000
[TRAIN][ep=059] loss=0.5968 acc=84.83%
[TRAIN][ep=059] mask_avg: mc_mean=0.0816 mb_mean=0.5014 norm_overlap=0.9608 corr_cb=-0.5043
[EPOCH 059/089] train: loss=0.5968 acc=84.83% | val: loss=0.6070 acc=74.70% f1=77.89% auc=80.81% val_score=61.9411 val_score_bestthr=73.9970 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.504) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 78.3116 -> 73.9970
[DBG][ep=060] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=060] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=060] mask(step0): mc_mean=0.0654 mb_mean=0.5029 norm_overlap=0.9618 corr_cb=-0.4678 topkJ=0.0000
[TRAIN][ep=060] loss=0.5892 acc=85.64%
[TRAIN][ep=060] mask_avg: mc_mean=0.0816 mb_mean=0.5015 norm_overlap=0.9608 corr_cb=-0.5034
[EPOCH 060/089] train: loss=0.5892 acc=85.64% | val: loss=0.6046 acc=74.70% f1=78.79% auc=80.87% val_score=59.5758 val_score_bestthr=75.5517 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.503) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 78.3116 -> 75.5517
[DBG][ep=061] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=061] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=061] mask(step0): mc_mean=0.1477 mb_mean=0.4912 norm_overlap=0.9768 corr_cb=-0.4798 topkJ=0.0000
[TRAIN][ep=061] loss=0.5889 acc=84.97%
[TRAIN][ep=061] mask_avg: mc_mean=0.0817 mb_mean=0.5014 norm_overlap=0.9609 corr_cb=-0.5016
[EPOCH 061/089] train: loss=0.5889 acc=84.97% | val: loss=0.5946 acc=74.70% f1=78.79% auc=80.99% val_score=59.5758 val_score_bestthr=75.5517 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.502) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 78.3116 -> 75.5517
[DBG][ep=062] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=062] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=062] mask(step0): mc_mean=0.0495 mb_mean=0.5065 norm_overlap=0.9574 corr_cb=-0.4819 topkJ=0.0000
[TRAIN][ep=062] loss=0.5885 acc=85.37%
[TRAIN][ep=062] mask_avg: mc_mean=0.0817 mb_mean=0.5014 norm_overlap=0.9609 corr_cb=-0.5041
[EPOCH 062/089] train: loss=0.5885 acc=85.37% | val: loss=0.5785 acc=72.29% f1=76.77% auc=80.64% val_score=63.1347 val_score_bestthr=74.6040 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.504) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 78.3116 -> 74.6040
[DBG][ep=063] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=063] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=063] mask(step0): mc_mean=0.0791 mb_mean=0.4998 norm_overlap=0.9686 corr_cb=-0.4686 topkJ=0.0008
[TRAIN][ep=063] loss=0.5901 acc=85.10%
[TRAIN][ep=063] mask_avg: mc_mean=0.0817 mb_mean=0.5014 norm_overlap=0.9609 corr_cb=-0.5044
[EPOCH 063/089] train: loss=0.5901 acc=85.10% | val: loss=0.5895 acc=74.70% f1=77.89% auc=80.58% val_score=66.6278 val_score_bestthr=73.9970 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.504) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 78.3116 -> 73.9970
[DBG][ep=064] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=064] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=064] mask(step0): mc_mean=0.0966 mb_mean=0.4966 norm_overlap=0.9750 corr_cb=-0.4707 topkJ=0.0035
[TRAIN][ep=064] loss=0.5837 acc=86.85%
[TRAIN][ep=064] mask_avg: mc_mean=0.0817 mb_mean=0.5014 norm_overlap=0.9607 corr_cb=-0.5033
[EPOCH 064/089] train: loss=0.5837 acc=86.85% | val: loss=0.5933 acc=74.70% f1=77.89% auc=80.52% val_score=66.6278 val_score_bestthr=73.9970 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.503) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 78.3116 -> 73.9970
[DBG][ep=065] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=065] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=065] mask(step0): mc_mean=0.0770 mb_mean=0.5017 norm_overlap=0.9589 corr_cb=-0.5328 topkJ=0.0000
[TRAIN][ep=065] loss=0.5793 acc=85.64%
[TRAIN][ep=065] mask_avg: mc_mean=0.0816 mb_mean=0.5015 norm_overlap=0.9609 corr_cb=-0.5026
[EPOCH 065/089] train: loss=0.5793 acc=85.64% | val: loss=0.6416 acc=74.70% f1=77.89% auc=80.58% val_score=55.2534 val_score_bestthr=73.9970 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.503) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 78.3116 -> 73.9970
[DBG][ep=066] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=066] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=066] mask(step0): mc_mean=0.0887 mb_mean=0.5007 norm_overlap=0.9648 corr_cb=-0.5451 topkJ=0.0000
[TRAIN][ep=066] loss=0.5805 acc=85.50%
[TRAIN][ep=066] mask_avg: mc_mean=0.0816 mb_mean=0.5015 norm_overlap=0.9606 corr_cb=-0.5054
[EPOCH 066/089] train: loss=0.5805 acc=85.50% | val: loss=0.5982 acc=74.70% f1=77.89% auc=80.64% val_score=59.3378 val_score_bestthr=73.9970 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.505) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 78.3116 -> 73.9970
[DBG][ep=067] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=067] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=067] mask(step0): mc_mean=0.0806 mb_mean=0.5058 norm_overlap=0.9477 corr_cb=-0.5293 topkJ=0.0000
[TRAIN][ep=067] loss=0.5781 acc=85.77%
[TRAIN][ep=067] mask_avg: mc_mean=0.0817 mb_mean=0.5014 norm_overlap=0.9607 corr_cb=-0.5057
[EPOCH 067/089] train: loss=0.5781 acc=85.77% | val: loss=0.5904 acc=74.70% f1=77.89% auc=80.70% val_score=66.6278 val_score_bestthr=73.9970 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.506) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 78.3116 -> 73.9970
[DBG][ep=068] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=068] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=068] mask(step0): mc_mean=0.0721 mb_mean=0.5032 norm_overlap=0.9603 corr_cb=-0.5241 topkJ=0.0004
[TRAIN][ep=068] loss=0.5750 acc=86.04%
[TRAIN][ep=068] mask_avg: mc_mean=0.0818 mb_mean=0.5014 norm_overlap=0.9608 corr_cb=-0.5029
[EPOCH 068/089] train: loss=0.5750 acc=86.04% | val: loss=0.6927 acc=74.70% f1=77.89% auc=80.29% val_score=56.8352 val_score_bestthr=73.9970 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.503) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 78.3116 -> 73.9970
[DBG][ep=069] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=069] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=069] mask(step0): mc_mean=0.0979 mb_mean=0.5002 norm_overlap=0.9609 corr_cb=-0.5770 topkJ=0.0000
[TRAIN][ep=069] loss=0.5872 acc=85.10%
[TRAIN][ep=069] mask_avg: mc_mean=0.0816 mb_mean=0.5014 norm_overlap=0.9609 corr_cb=-0.5031
[EPOCH 069/089] train: loss=0.5872 acc=85.10% | val: loss=0.5842 acc=74.70% f1=77.42% auc=80.87% val_score=65.1662 val_score_bestthr=74.3342 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.503) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 78.3116 -> 74.3342
[DBG][ep=070] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=070] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=070] mask(step0): mc_mean=0.0829 mb_mean=0.4982 norm_overlap=0.9698 corr_cb=-0.5055 topkJ=0.0000
[TRAIN][ep=070] loss=0.5783 acc=86.04%
[TRAIN][ep=070] mask_avg: mc_mean=0.0816 mb_mean=0.5014 norm_overlap=0.9609 corr_cb=-0.5029
[EPOCH 070/089] train: loss=0.5783 acc=86.04% | val: loss=0.5885 acc=72.29% f1=76.77% auc=80.64% val_score=65.1662 val_score_bestthr=74.6040 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.503) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 78.3116 -> 74.6040
[DBG][ep=071] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=071] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=071] mask(step0): mc_mean=0.0944 mb_mean=0.4983 norm_overlap=0.9595 corr_cb=-0.5669 topkJ=0.0000
[TRAIN][ep=071] loss=0.5763 acc=85.77%
[TRAIN][ep=071] mask_avg: mc_mean=0.0816 mb_mean=0.5014 norm_overlap=0.9608 corr_cb=-0.5076
[EPOCH 071/089] train: loss=0.5763 acc=85.77% | val: loss=0.5983 acc=74.70% f1=77.89% auc=80.52% val_score=66.6278 val_score_bestthr=73.9970 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.508) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 78.3116 -> 73.9970
[DBG][ep=072] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=072] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=072] mask(step0): mc_mean=0.0560 mb_mean=0.5071 norm_overlap=0.9545 corr_cb=-0.4935 topkJ=0.0000
[TRAIN][ep=072] loss=0.5738 acc=86.85%
[TRAIN][ep=072] mask_avg: mc_mean=0.0817 mb_mean=0.5015 norm_overlap=0.9607 corr_cb=-0.5033
[EPOCH 072/089] train: loss=0.5738 acc=86.85% | val: loss=0.6165 acc=74.70% f1=77.89% auc=80.12% val_score=58.4318 val_score_bestthr=73.9970 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.503) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 78.3116 -> 73.9970
[DBG][ep=073] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=073] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=073] mask(step0): mc_mean=0.0474 mb_mean=0.5061 norm_overlap=0.9525 corr_cb=-0.4836 topkJ=0.0000
[TRAIN][ep=073] loss=0.5710 acc=86.44%
[TRAIN][ep=073] mask_avg: mc_mean=0.0816 mb_mean=0.5015 norm_overlap=0.9608 corr_cb=-0.5022
[EPOCH 073/089] train: loss=0.5710 acc=86.44% | val: loss=0.6224 acc=74.70% f1=77.89% auc=80.35% val_score=58.4318 val_score_bestthr=73.9970 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.502) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 78.3116 -> 73.9970
[EARLY STOP] no improvement for 30 epochs. best_epoch=43
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
=============== FIT DONE ===============
[BEST] epoch=43 | val_acc=75.90% | val_f1=78.72% | val_auc=82.21% | val_score=52.4567 | val_score_bestthr=78.3116
[TEST@BEST] thr_used=0.100 | acc=57.49% f1=67.41% auc=64.49% | SP_sex=7.81% EO_sex=4.42% SP_age=8.47% EO_age=11.06%
[TIME] 1.71 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/summary_fold_0.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4752 mb_mean=0.5091 norm_overlap=0.9996 corr_cb=-0.4004 topkJ=0.0039
[TRAIN][ep=000] loss=0.6932 acc=51.14%
[TRAIN][ep=000] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1325
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4782 mb_mean=0.5028 norm_overlap=0.9999 corr_cb=-0.0933 topkJ=0.0031
[TRAIN][ep=001] loss=0.6927 acc=51.01%
[TRAIN][ep=001] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1283
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4776 mb_mean=0.5098 norm_overlap=0.9997 corr_cb=-0.3755 topkJ=0.0024
[TRAIN][ep=002] loss=0.6906 acc=53.42%
[TRAIN][ep=002] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1407
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4785 mb_mean=0.5037 norm_overlap=1.0000 corr_cb=0.0262 topkJ=0.0152
[TRAIN][ep=003] loss=0.6892 acc=55.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1330
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4760 mb_mean=0.5053 norm_overlap=0.9998 corr_cb=-0.2618 topkJ=0.0459
[TRAIN][ep=004] loss=0.6879 acc=57.32%
[TRAIN][ep=004] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1247
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4794 mb_mean=0.5002 norm_overlap=0.9999 corr_cb=-0.2006 topkJ=0.0064
[TRAIN][ep=005] loss=0.6870 acc=54.09%
[TRAIN][ep=005] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1272
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4760 mb_mean=0.5040 norm_overlap=0.9997 corr_cb=-0.4011 topkJ=0.0113
[TRAIN][ep=006] loss=0.6832 acc=56.38%
[TRAIN][ep=006] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1302
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4758 mb_mean=0.5023 norm_overlap=0.9998 corr_cb=-0.2950 topkJ=0.0024
[TRAIN][ep=007] loss=0.6767 acc=59.33%
[TRAIN][ep=007] mask_avg: mc_mean=0.4785 mb_mean=0.5015 norm_overlap=0.9999 corr_cb=-0.1365
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4784 mb_mean=0.4987 norm_overlap=0.9997 corr_cb=-0.3532 topkJ=0.0048
[TRAIN][ep=008] loss=0.6721 acc=63.76%
[TRAIN][ep=008] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1238
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4781 mb_mean=0.5042 norm_overlap=0.9998 corr_cb=-0.2975 topkJ=0.0188
[TRAIN][ep=009] loss=0.6643 acc=62.55%
[TRAIN][ep=009] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1254
================= FIT START (fold=0) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4787 mb_mean=0.5043 norm_overlap=0.9999 corr_cb=-0.0822 topkJ=0.0502
[TRAIN][ep=000] loss=0.6583 acc=63.62%
[TRAIN][ep=000] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1201
[EPOCH 000/089] train: loss=0.6583 acc=63.62% | val: loss=0.6535 acc=67.47% f1=74.29% auc=71.74% val_score=55.4225 val_score_bestthr=63.3503 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.120) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 63.3503
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4793 mb_mean=0.5022 norm_overlap=0.9998 corr_cb=-0.2365 topkJ=0.0024
[TRAIN][ep=001] loss=0.6518 acc=64.56%
[TRAIN][ep=001] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1274
[EPOCH 001/089] train: loss=0.6518 acc=64.56% | val: loss=0.6600 acc=61.45% f1=72.41% auc=68.49% val_score=47.5336 val_score_bestthr=64.7777 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.127) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 63.3503 -> 64.7777
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4774 mb_mean=0.4982 norm_overlap=1.0000 corr_cb=-0.0324 topkJ=0.0252
[TRAIN][ep=002] loss=0.6471 acc=64.30%
[TRAIN][ep=002] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1182
[EPOCH 002/089] train: loss=0.6471 acc=64.30% | val: loss=0.6414 acc=68.67% f1=75.00% auc=72.38% val_score=47.9380 val_score_bestthr=63.1152 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.118) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.7777 -> 63.1152
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4776 mb_mean=0.5075 norm_overlap=0.9998 corr_cb=-0.2177 topkJ=0.0023
[TRAIN][ep=003] loss=0.6422 acc=64.43%
[TRAIN][ep=003] mask_avg: mc_mean=0.4785 mb_mean=0.5015 norm_overlap=0.9999 corr_cb=-0.1255
[EPOCH 003/089] train: loss=0.6422 acc=64.43% | val: loss=0.6608 acc=63.86% f1=73.68% auc=69.24% val_score=54.7539 val_score_bestthr=65.2221 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.125) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 64.7777 -> 65.2221
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4824 mb_mean=0.4950 norm_overlap=0.9998 corr_cb=-0.2211 topkJ=0.0294
[TRAIN][ep=004] loss=0.6475 acc=62.01%
[TRAIN][ep=004] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1284
[EPOCH 004/089] train: loss=0.6475 acc=62.01% | val: loss=0.6352 acc=69.88% f1=76.19% auc=73.20% val_score=46.9114 val_score_bestthr=64.6846 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.128) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 65.2221 -> 64.6846
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4744 mb_mean=0.5047 norm_overlap=0.9999 corr_cb=-0.0747 topkJ=0.0278
[TRAIN][ep=005] loss=1.2219 acc=65.23%
[TRAIN][ep=005] mask_avg: mc_mean=0.3460 mb_mean=0.5014 norm_overlap=0.9962 corr_cb=-0.6418
[EPOCH 005/089] train: loss=1.2219 acc=65.23% | val: loss=0.6515 acc=67.47% f1=69.66% auc=75.81% val_score=62.4643 val_score_bestthr=63.5118 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.346, mb=0.501, no=0.996, corr=-0.642) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.2221 -> 63.5118
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.1988 mb_mean=0.5118 norm_overlap=0.9864 corr_cb=-0.7998 topkJ=0.0000
[TRAIN][ep=006] loss=1.2023 acc=66.17%
[TRAIN][ep=006] mask_avg: mc_mean=0.1917 mb_mean=0.5014 norm_overlap=0.9885 corr_cb=-0.7197
[EPOCH 006/089] train: loss=1.2023 acc=66.17% | val: loss=0.6369 acc=60.24% f1=71.79% auc=76.63% val_score=62.4655 val_score_bestthr=62.4655 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.192, mb=0.501, no=0.989, corr=-0.720) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.2221 -> 62.4655
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.1514 mb_mean=0.5024 norm_overlap=0.9839 corr_cb=-0.7859 topkJ=0.0000
[TRAIN][ep=007] loss=1.2052 acc=62.82%
[TRAIN][ep=007] mask_avg: mc_mean=0.1239 mb_mean=0.5014 norm_overlap=0.9815 corr_cb=-0.7176
[EPOCH 007/089] train: loss=1.2052 acc=62.82% | val: loss=0.6280 acc=68.67% f1=74.51% auc=74.19% val_score=52.4552 val_score_bestthr=66.3139 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.124, mb=0.501, no=0.982, corr=-0.718) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 65.2221 -> 66.3139
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1082 mb_mean=0.5001 norm_overlap=0.9749 corr_cb=-0.7721 topkJ=0.0000
[TRAIN][ep=008] loss=1.1893 acc=67.52%
[TRAIN][ep=008] mask_avg: mc_mean=0.0801 mb_mean=0.5014 norm_overlap=0.9744 corr_cb=-0.6689
[EPOCH 008/089] train: loss=1.1893 acc=67.52% | val: loss=0.6343 acc=67.47% f1=75.23% auc=73.55% val_score=61.5991 val_score_bestthr=65.3678 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.080, mb=0.501, no=0.974, corr=-0.669) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3139 -> 65.3678
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.0571 mb_mean=0.5043 norm_overlap=0.9720 corr_cb=-0.6630 topkJ=0.0000
[TRAIN][ep=009] loss=1.1686 acc=69.26%
[TRAIN][ep=009] mask_avg: mc_mean=0.0686 mb_mean=0.5014 norm_overlap=0.9702 corr_cb=-0.6295
[EPOCH 009/089] train: loss=1.1686 acc=69.26% | val: loss=0.6051 acc=67.47% f1=73.79% auc=75.81% val_score=55.2432 val_score_bestthr=64.0005 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.069, mb=0.501, no=0.970, corr=-0.629) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3139 -> 64.0005
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.0841 mb_mean=0.4997 norm_overlap=0.9623 corr_cb=-0.6814 topkJ=0.0000
[TRAIN][ep=010] loss=0.7661 acc=67.52%
[TRAIN][ep=010] mask_avg: mc_mean=0.0693 mb_mean=0.5015 norm_overlap=0.9677 corr_cb=-0.6050
[EPOCH 010/089] train: loss=0.7661 acc=67.52% | val: loss=0.6024 acc=71.08% f1=65.71% auc=75.52% val_score=54.5243 val_score_bestthr=64.2616 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.069, mb=0.501, no=0.968, corr=-0.605) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3139 -> 64.2616
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.0924 mb_mean=0.5016 norm_overlap=0.9550 corr_cb=-0.6476 topkJ=0.0000
[TRAIN][ep=011] loss=0.7066 acc=69.66%
[TRAIN][ep=011] mask_avg: mc_mean=0.0607 mb_mean=0.5015 norm_overlap=0.9642 corr_cb=-0.5706
[EPOCH 011/089] train: loss=0.7066 acc=69.66% | val: loss=0.5923 acc=73.49% f1=69.44% auc=76.10% val_score=47.9807 val_score_bestthr=65.6306 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.061, mb=0.501, no=0.964, corr=-0.571) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3139 -> 65.6306
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.0357 mb_mean=0.5072 norm_overlap=0.9621 corr_cb=-0.5387 topkJ=0.0000
[TRAIN][ep=012] loss=0.7069 acc=68.99%
[TRAIN][ep=012] mask_avg: mc_mean=0.0578 mb_mean=0.5014 norm_overlap=0.9623 corr_cb=-0.5481
[EPOCH 012/089] train: loss=0.7069 acc=68.99% | val: loss=0.6280 acc=71.08% f1=64.71% auc=74.13% val_score=51.3437 val_score_bestthr=66.1865 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.058, mb=0.501, no=0.962, corr=-0.548) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3139 -> 66.1865
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.0306 mb_mean=0.5080 norm_overlap=0.9533 corr_cb=-0.3687 topkJ=0.0000
[TRAIN][ep=013] loss=0.6946 acc=71.28%
[TRAIN][ep=013] mask_avg: mc_mean=0.0515 mb_mean=0.5015 norm_overlap=0.9595 corr_cb=-0.5252
[EPOCH 013/089] train: loss=0.6946 acc=71.28% | val: loss=0.5898 acc=72.29% f1=66.67% auc=75.64% val_score=59.7524 val_score_bestthr=66.6238 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.051, mb=0.501, no=0.960, corr=-0.525) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 66.3139 -> 66.6238
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.0579 mb_mean=0.4973 norm_overlap=0.9714 corr_cb=-0.4806 topkJ=0.0024
[TRAIN][ep=014] loss=0.6896 acc=71.28%
[TRAIN][ep=014] mask_avg: mc_mean=0.0518 mb_mean=0.5014 norm_overlap=0.9586 corr_cb=-0.5176
[EPOCH 014/089] train: loss=0.6896 acc=71.28% | val: loss=0.5832 acc=72.29% f1=66.67% auc=75.93% val_score=52.8036 val_score_bestthr=66.6238 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.052, mb=0.501, no=0.959, corr=-0.518) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6238 -> 66.6238
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.0308 mb_mean=0.5043 norm_overlap=0.9557 corr_cb=-0.4263 topkJ=0.0000
[TRAIN][ep=015] loss=0.6769 acc=72.21%
[TRAIN][ep=015] mask_avg: mc_mean=0.0550 mb_mean=0.5014 norm_overlap=0.9588 corr_cb=-0.5185
[EPOCH 015/089] train: loss=0.6769 acc=72.21% | val: loss=0.5743 acc=73.49% f1=68.57% auc=76.63% val_score=54.8728 val_score_bestthr=65.9223 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.055, mb=0.501, no=0.959, corr=-0.519) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6238 -> 65.9223
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.0356 mb_mean=0.5102 norm_overlap=0.9419 corr_cb=-0.5239 topkJ=0.0000
[TRAIN][ep=016] loss=0.6854 acc=71.68%
[TRAIN][ep=016] mask_avg: mc_mean=0.0468 mb_mean=0.5014 norm_overlap=0.9560 corr_cb=-0.4905
[EPOCH 016/089] train: loss=0.6854 acc=71.68% | val: loss=0.5747 acc=73.49% f1=68.57% auc=77.03% val_score=51.4217 val_score_bestthr=65.9223 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.047, mb=0.501, no=0.956, corr=-0.490) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6238 -> 65.9223
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.0581 mb_mean=0.4927 norm_overlap=0.9731 corr_cb=-0.4257 topkJ=0.0008
[TRAIN][ep=017] loss=0.6771 acc=71.14%
[TRAIN][ep=017] mask_avg: mc_mean=0.0429 mb_mean=0.5014 norm_overlap=0.9546 corr_cb=-0.4755
[EPOCH 017/089] train: loss=0.6771 acc=71.14% | val: loss=0.5795 acc=73.49% f1=68.57% auc=76.16% val_score=59.9141 val_score_bestthr=65.9223 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.043, mb=0.501, no=0.955, corr=-0.476) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6238 -> 65.9223
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.0490 mb_mean=0.5052 norm_overlap=0.9473 corr_cb=-0.5289 topkJ=0.0000
[TRAIN][ep=018] loss=0.6632 acc=72.48%
[TRAIN][ep=018] mask_avg: mc_mean=0.0582 mb_mean=0.5014 norm_overlap=0.9578 corr_cb=-0.5135
[EPOCH 018/089] train: loss=0.6632 acc=72.48% | val: loss=0.7093 acc=66.27% f1=72.00% auc=74.53% val_score=51.6446 val_score_bestthr=67.0213 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.058, mb=0.501, no=0.958, corr=-0.514) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 66.6238 -> 67.0213
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.0365 mb_mean=0.4998 norm_overlap=0.9534 corr_cb=-0.4655 topkJ=0.0000
[TRAIN][ep=019] loss=0.6893 acc=70.34%
[TRAIN][ep=019] mask_avg: mc_mean=0.0390 mb_mean=0.5014 norm_overlap=0.9527 corr_cb=-0.4578
[EPOCH 019/089] train: loss=0.6893 acc=70.34% | val: loss=0.6263 acc=67.47% f1=74.77% auc=75.76% val_score=60.2367 val_score_bestthr=66.4819 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.039, mb=0.501, no=0.953, corr=-0.458) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.0213 -> 66.4819
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.0764 mb_mean=0.4956 norm_overlap=0.9530 corr_cb=-0.5793 topkJ=0.0000
[TRAIN][ep=020] loss=0.6689 acc=72.89%
[TRAIN][ep=020] mask_avg: mc_mean=0.0454 mb_mean=0.5014 norm_overlap=0.9544 corr_cb=-0.4819
[EPOCH 020/089] train: loss=0.6689 acc=72.89% | val: loss=0.5867 acc=73.49% f1=68.57% auc=76.98% val_score=58.7307 val_score_bestthr=65.9223 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.045, mb=0.501, no=0.954, corr=-0.482) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.0213 -> 65.9223
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.0428 mb_mean=0.5057 norm_overlap=0.9444 corr_cb=-0.4634 topkJ=0.0000
[TRAIN][ep=021] loss=0.6505 acc=73.69%
[TRAIN][ep=021] mask_avg: mc_mean=0.0618 mb_mean=0.5014 norm_overlap=0.9576 corr_cb=-0.5213
[EPOCH 021/089] train: loss=0.6505 acc=73.69% | val: loss=0.5898 acc=72.29% f1=66.67% auc=77.15% val_score=58.7307 val_score_bestthr=65.0876 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.062, mb=0.501, no=0.958, corr=-0.521) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.0213 -> 65.0876
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.0778 mb_mean=0.4985 norm_overlap=0.9655 corr_cb=-0.4698 topkJ=0.0000
[TRAIN][ep=022] loss=0.6549 acc=74.09%
[TRAIN][ep=022] mask_avg: mc_mean=0.0572 mb_mean=0.5014 norm_overlap=0.9565 corr_cb=-0.5094
[EPOCH 022/089] train: loss=0.6549 acc=74.09% | val: loss=0.5495 acc=66.27% f1=75.00% auc=77.97% val_score=61.2877 val_score_bestthr=69.6680 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.057, mb=0.501, no=0.956, corr=-0.509) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 67.0213 -> 69.6680
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.0440 mb_mean=0.5003 norm_overlap=0.9548 corr_cb=-0.4501 topkJ=0.0000
[TRAIN][ep=023] loss=0.6616 acc=72.62%
[TRAIN][ep=023] mask_avg: mc_mean=0.0458 mb_mean=0.5015 norm_overlap=0.9535 corr_cb=-0.4768
[EPOCH 023/089] train: loss=0.6616 acc=72.62% | val: loss=0.5533 acc=74.70% f1=72.00% auc=78.37% val_score=57.8118 val_score_bestthr=65.3644 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.046, mb=0.501, no=0.954, corr=-0.477) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.6680 -> 65.3644
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.0458 mb_mean=0.5001 norm_overlap=0.9619 corr_cb=-0.3868 topkJ=0.0000
[TRAIN][ep=024] loss=0.6314 acc=75.97%
[TRAIN][ep=024] mask_avg: mc_mean=0.0528 mb_mean=0.5014 norm_overlap=0.9552 corr_cb=-0.4912
[EPOCH 024/089] train: loss=0.6314 acc=75.97% | val: loss=0.5559 acc=75.90% f1=74.36% auc=78.20% val_score=57.1066 val_score_bestthr=68.2337 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.053, mb=0.501, no=0.955, corr=-0.491) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.6680 -> 68.2337
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.0511 mb_mean=0.5013 norm_overlap=0.9565 corr_cb=-0.5414 topkJ=0.0000
[TRAIN][ep=025] loss=0.6512 acc=73.56%
[TRAIN][ep=025] mask_avg: mc_mean=0.0498 mb_mean=0.5014 norm_overlap=0.9541 corr_cb=-0.4810
[EPOCH 025/089] train: loss=0.6512 acc=73.56% | val: loss=0.5550 acc=72.29% f1=72.29% auc=77.15% val_score=63.6469 val_score_bestthr=66.3844 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.050, mb=0.501, no=0.954, corr=-0.481) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.6680 -> 66.3844
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.0375 mb_mean=0.5025 norm_overlap=0.9489 corr_cb=-0.5141 topkJ=0.0000
[TRAIN][ep=026] loss=0.6283 acc=74.23%
[TRAIN][ep=026] mask_avg: mc_mean=0.0571 mb_mean=0.5014 norm_overlap=0.9561 corr_cb=-0.5032
[EPOCH 026/089] train: loss=0.6283 acc=74.23% | val: loss=0.5756 acc=74.70% f1=72.73% auc=78.84% val_score=60.3976 val_score_bestthr=69.5636 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.057, mb=0.501, no=0.956, corr=-0.503) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.6680 -> 69.5636
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.0744 mb_mean=0.5001 norm_overlap=0.9519 corr_cb=-0.5836 topkJ=0.0000
[TRAIN][ep=027] loss=0.6267 acc=74.36%
[TRAIN][ep=027] mask_avg: mc_mean=0.0616 mb_mean=0.5014 norm_overlap=0.9569 corr_cb=-0.5113
[EPOCH 027/089] train: loss=0.6267 acc=74.36% | val: loss=0.6038 acc=72.29% f1=72.94% auc=77.27% val_score=58.7307 val_score_bestthr=69.2820 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.062, mb=0.501, no=0.957, corr=-0.511) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.6680 -> 69.2820
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.0694 mb_mean=0.4951 norm_overlap=0.9720 corr_cb=-0.4175 topkJ=0.0000
[TRAIN][ep=028] loss=0.6247 acc=74.90%
[TRAIN][ep=028] mask_avg: mc_mean=0.0601 mb_mean=0.5015 norm_overlap=0.9565 corr_cb=-0.5044
[EPOCH 028/089] train: loss=0.6247 acc=74.90% | val: loss=0.5536 acc=77.11% f1=76.54% auc=79.24% val_score=58.6883 val_score_bestthr=74.5003 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.060, mb=0.501, no=0.957, corr=-0.504) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 69.6680 -> 74.5003
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.0738 mb_mean=0.4980 norm_overlap=0.9637 corr_cb=-0.5057 topkJ=0.0000
[TRAIN][ep=029] loss=0.6091 acc=78.12%
[TRAIN][ep=029] mask_avg: mc_mean=0.0582 mb_mean=0.5015 norm_overlap=0.9562 corr_cb=-0.5032
[EPOCH 029/089] train: loss=0.6091 acc=78.12% | val: loss=0.6012 acc=74.70% f1=72.73% auc=79.94% val_score=68.9564 val_score_bestthr=69.5636 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.058, mb=0.501, no=0.956, corr=-0.503) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.5003 -> 69.5636
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.0829 mb_mean=0.4961 norm_overlap=0.9684 corr_cb=-0.5514 topkJ=0.0000
[TRAIN][ep=030] loss=0.6148 acc=74.77%
[TRAIN][ep=030] mask_avg: mc_mean=0.0623 mb_mean=0.5015 norm_overlap=0.9569 corr_cb=-0.5107
[EPOCH 030/089] train: loss=0.6148 acc=74.77% | val: loss=0.5424 acc=74.70% f1=74.70% auc=80.00% val_score=61.3022 val_score_bestthr=71.0024 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.062, mb=0.501, no=0.957, corr=-0.511) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.5003 -> 71.0024
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.0584 mb_mean=0.5019 norm_overlap=0.9606 corr_cb=-0.5146 topkJ=0.0000
[TRAIN][ep=031] loss=0.5966 acc=77.45%
[TRAIN][ep=031] mask_avg: mc_mean=0.0651 mb_mean=0.5015 norm_overlap=0.9575 corr_cb=-0.5156
[EPOCH 031/089] train: loss=0.5966 acc=77.45% | val: loss=0.5487 acc=75.90% f1=75.61% auc=78.95% val_score=62.0977 val_score_bestthr=73.9054 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.065, mb=0.501, no=0.957, corr=-0.516) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.5003 -> 73.9054
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.0596 mb_mean=0.4988 norm_overlap=0.9566 corr_cb=-0.5746 topkJ=0.0000
[TRAIN][ep=032] loss=0.6044 acc=77.99%
[TRAIN][ep=032] mask_avg: mc_mean=0.0669 mb_mean=0.5014 norm_overlap=0.9582 corr_cb=-0.5125
[EPOCH 032/089] train: loss=0.6044 acc=77.99% | val: loss=0.5515 acc=77.11% f1=76.54% auc=80.35% val_score=58.9681 val_score_bestthr=74.5003 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.067, mb=0.501, no=0.958, corr=-0.513) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.5003 -> 74.5003
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.0776 mb_mean=0.4952 norm_overlap=0.9705 corr_cb=-0.4883 topkJ=0.0004
[TRAIN][ep=033] loss=0.5869 acc=77.45%
[TRAIN][ep=033] mask_avg: mc_mean=0.0633 mb_mean=0.5014 norm_overlap=0.9575 corr_cb=-0.5004
[EPOCH 033/089] train: loss=0.5869 acc=77.45% | val: loss=0.5583 acc=73.49% f1=75.00% auc=79.65% val_score=54.5230 val_score_bestthr=74.9503 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.063, mb=0.501, no=0.958, corr=-0.500) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 74.5003 -> 74.9503
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.0865 mb_mean=0.5028 norm_overlap=0.9593 corr_cb=-0.6031 topkJ=0.0000
[TRAIN][ep=034] loss=0.5898 acc=75.57%
[TRAIN][ep=034] mask_avg: mc_mean=0.0784 mb_mean=0.5014 norm_overlap=0.9596 corr_cb=-0.5169
[EPOCH 034/089] train: loss=0.5898 acc=75.57% | val: loss=0.5393 acc=71.08% f1=73.91% auc=79.77% val_score=62.0977 val_score_bestthr=72.1808 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.078, mb=0.501, no=0.960, corr=-0.517) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.9503 -> 72.1808
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.0381 mb_mean=0.5037 norm_overlap=0.9556 corr_cb=-0.4423 topkJ=0.0000
[TRAIN][ep=035] loss=0.5779 acc=79.87%
[TRAIN][ep=035] mask_avg: mc_mean=0.0654 mb_mean=0.5014 norm_overlap=0.9580 corr_cb=-0.5031
[EPOCH 035/089] train: loss=0.5779 acc=79.87% | val: loss=0.5310 acc=73.49% f1=76.09% auc=81.34% val_score=57.5059 val_score_bestthr=74.1918 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.065, mb=0.501, no=0.958, corr=-0.503) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.9503 -> 74.1918
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.0685 mb_mean=0.4983 norm_overlap=0.9577 corr_cb=-0.5403 topkJ=0.0000
[TRAIN][ep=036] loss=0.5870 acc=77.72%
[TRAIN][ep=036] mask_avg: mc_mean=0.0724 mb_mean=0.5015 norm_overlap=0.9590 corr_cb=-0.5160
[EPOCH 036/089] train: loss=0.5870 acc=77.72% | val: loss=0.5668 acc=73.49% f1=77.55% auc=80.76% val_score=55.9281 val_score_bestthr=74.5060 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.072, mb=0.501, no=0.959, corr=-0.516) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.9503 -> 74.5060
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.0441 mb_mean=0.5046 norm_overlap=0.9512 corr_cb=-0.4943 topkJ=0.0000
[TRAIN][ep=037] loss=0.5744 acc=78.66%
[TRAIN][ep=037] mask_avg: mc_mean=0.0699 mb_mean=0.5014 norm_overlap=0.9586 corr_cb=-0.5095
[EPOCH 037/089] train: loss=0.5744 acc=78.66% | val: loss=0.5581 acc=71.08% f1=74.47% auc=81.40% val_score=55.0122 val_score_bestthr=75.4451 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.070, mb=0.501, no=0.959, corr=-0.509) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 74.9503 -> 75.4451
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.0747 mb_mean=0.4966 norm_overlap=0.9679 corr_cb=-0.5341 topkJ=0.0000
[TRAIN][ep=038] loss=0.5933 acc=77.18%
[TRAIN][ep=038] mask_avg: mc_mean=0.0416 mb_mean=0.5014 norm_overlap=0.9520 corr_cb=-0.4328
[EPOCH 038/089] train: loss=0.5933 acc=77.18% | val: loss=0.5327 acc=72.29% f1=74.73% auc=81.28% val_score=65.3839 val_score_bestthr=75.2466 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.042, mb=0.501, no=0.952, corr=-0.433) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.4451 -> 75.2466
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.0424 mb_mean=0.5081 norm_overlap=0.9449 corr_cb=-0.5076 topkJ=0.0000
[TRAIN][ep=039] loss=0.5515 acc=80.94%
[TRAIN][ep=039] mask_avg: mc_mean=0.0789 mb_mean=0.5015 norm_overlap=0.9602 corr_cb=-0.5232
[EPOCH 039/089] train: loss=0.5515 acc=80.94% | val: loss=0.5314 acc=73.49% f1=75.56% auc=81.98% val_score=69.8061 val_score_bestthr=75.7643 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.079, mb=0.501, no=0.960, corr=-0.523) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 75.4451 -> 75.7643
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.1034 mb_mean=0.5035 norm_overlap=0.9533 corr_cb=-0.6345 topkJ=0.0000
[TRAIN][ep=040] loss=0.5605 acc=79.33%
[TRAIN][ep=040] mask_avg: mc_mean=0.0755 mb_mean=0.5014 norm_overlap=0.9599 corr_cb=-0.5104
[EPOCH 040/089] train: loss=0.5605 acc=79.33% | val: loss=0.5579 acc=77.11% f1=76.54% auc=81.28% val_score=69.4162 val_score_bestthr=75.6597 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.076, mb=0.501, no=0.960, corr=-0.510) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.7643 -> 75.6597
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.0937 mb_mean=0.5010 norm_overlap=0.9557 corr_cb=-0.6080 topkJ=0.0000
[TRAIN][ep=041] loss=0.5670 acc=78.26%
[TRAIN][ep=041] mask_avg: mc_mean=0.0748 mb_mean=0.5014 norm_overlap=0.9596 corr_cb=-0.5076
[EPOCH 041/089] train: loss=0.5670 acc=78.26% | val: loss=0.5478 acc=73.49% f1=76.09% auc=81.80% val_score=62.1952 val_score_bestthr=79.0251 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.075, mb=0.501, no=0.960, corr=-0.508) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 75.7643 -> 79.0251
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.0827 mb_mean=0.4956 norm_overlap=0.9719 corr_cb=-0.4709 topkJ=0.0000
[TRAIN][ep=042] loss=0.5560 acc=80.54%
[TRAIN][ep=042] mask_avg: mc_mean=0.0806 mb_mean=0.5014 norm_overlap=0.9605 corr_cb=-0.5072
[EPOCH 042/089] train: loss=0.5560 acc=80.54% | val: loss=0.5272 acc=73.49% f1=76.09% auc=82.15% val_score=60.3570 val_score_bestthr=75.9418 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.507) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 75.9418
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.0397 mb_mean=0.4997 norm_overlap=0.9589 corr_cb=-0.4704 topkJ=0.0000
[TRAIN][ep=043] loss=0.6385 acc=77.99%
[TRAIN][ep=043] mask_avg: mc_mean=0.0682 mb_mean=0.5014 norm_overlap=0.9589 corr_cb=-0.4897
[EPOCH 043/089] train: loss=0.6385 acc=77.99% | val: loss=0.6738 acc=74.70% f1=77.42% auc=82.33% val_score=54.1440 val_score_bestthr=74.3342 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.068, mb=0.501, no=0.959, corr=-0.490) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 74.3342
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.0482 mb_mean=0.5072 norm_overlap=0.9494 corr_cb=-0.5104 topkJ=0.0000
[TRAIN][ep=044] loss=0.5400 acc=80.13%
[TRAIN][ep=044] mask_avg: mc_mean=0.0776 mb_mean=0.5015 norm_overlap=0.9604 corr_cb=-0.5098
[EPOCH 044/089] train: loss=0.5400 acc=80.13% | val: loss=0.5473 acc=73.49% f1=77.08% auc=81.98% val_score=68.2151 val_score_bestthr=72.3516 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.078, mb=0.501, no=0.960, corr=-0.510) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 72.3516
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.0818 mb_mean=0.4984 norm_overlap=0.9614 corr_cb=-0.4582 topkJ=0.0000
[TRAIN][ep=045] loss=0.5269 acc=82.28%
[TRAIN][ep=045] mask_avg: mc_mean=0.0844 mb_mean=0.5014 norm_overlap=0.9614 corr_cb=-0.5146
[EPOCH 045/089] train: loss=0.5269 acc=82.28% | val: loss=0.5660 acc=75.90% f1=79.17% auc=82.44% val_score=68.8938 val_score_bestthr=76.7960 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.084, mb=0.501, no=0.961, corr=-0.515) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 76.7960
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.1054 mb_mean=0.4955 norm_overlap=0.9703 corr_cb=-0.4984 topkJ=0.0000
[TRAIN][ep=046] loss=0.5989 acc=81.21%
[TRAIN][ep=046] mask_avg: mc_mean=0.0783 mb_mean=0.5015 norm_overlap=0.9601 corr_cb=-0.5003
[EPOCH 046/089] train: loss=0.5989 acc=81.21% | val: loss=0.6105 acc=79.52% f1=79.52% auc=82.03% val_score=55.9281 val_score_bestthr=74.9962 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.078, mb=0.501, no=0.960, corr=-0.500) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 74.9962
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.0781 mb_mean=0.5047 norm_overlap=0.9632 corr_cb=-0.5336 topkJ=0.0000
[TRAIN][ep=047] loss=0.5202 acc=80.81%
[TRAIN][ep=047] mask_avg: mc_mean=0.0894 mb_mean=0.5014 norm_overlap=0.9623 corr_cb=-0.5131
[EPOCH 047/089] train: loss=0.5202 acc=80.81% | val: loss=0.5611 acc=74.70% f1=79.21% auc=81.98% val_score=72.8339 val_score_bestthr=77.8191 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.089, mb=0.501, no=0.962, corr=-0.513) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 77.8191
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.0891 mb_mean=0.4955 norm_overlap=0.9677 corr_cb=-0.4901 topkJ=0.0000
[TRAIN][ep=048] loss=0.5386 acc=81.07%
[TRAIN][ep=048] mask_avg: mc_mean=0.0838 mb_mean=0.5014 norm_overlap=0.9612 corr_cb=-0.5066
[EPOCH 048/089] train: loss=0.5386 acc=81.07% | val: loss=0.5451 acc=74.70% f1=75.29% auc=81.80% val_score=70.4671 val_score_bestthr=73.3296 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.084, mb=0.501, no=0.961, corr=-0.507) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 73.3296
[DBG][ep=049] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.0490 mb_mean=0.5049 norm_overlap=0.9572 corr_cb=-0.4759 topkJ=0.0000
[TRAIN][ep=049] loss=0.5107 acc=82.01%
[TRAIN][ep=049] mask_avg: mc_mean=0.0770 mb_mean=0.5014 norm_overlap=0.9603 corr_cb=-0.4967
[EPOCH 049/089] train: loss=0.5107 acc=82.01% | val: loss=0.6183 acc=69.88% f1=76.19% auc=81.45% val_score=55.9281 val_score_bestthr=73.0634 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.077, mb=0.501, no=0.960, corr=-0.497) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 73.0634
[DBG][ep=050] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.0728 mb_mean=0.5029 norm_overlap=0.9578 corr_cb=-0.4610 topkJ=0.0000
[TRAIN][ep=050] loss=0.4811 acc=84.83%
[TRAIN][ep=050] mask_avg: mc_mean=0.0811 mb_mean=0.5015 norm_overlap=0.9610 corr_cb=-0.5022
[EPOCH 050/089] train: loss=0.4811 acc=84.83% | val: loss=0.5952 acc=73.49% f1=77.08% auc=81.45% val_score=55.2534 val_score_bestthr=72.3516 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.502) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 72.3516
[DBG][ep=051] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.0764 mb_mean=0.5035 norm_overlap=0.9571 corr_cb=-0.5465 topkJ=0.0000
[TRAIN][ep=051] loss=0.4800 acc=84.83%
[TRAIN][ep=051] mask_avg: mc_mean=0.0812 mb_mean=0.5015 norm_overlap=0.9611 corr_cb=-0.5002
[EPOCH 051/089] train: loss=0.4800 acc=84.83% | val: loss=0.5778 acc=73.49% f1=77.08% auc=81.45% val_score=58.8580 val_score_bestthr=71.6560 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.500) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 71.6560
[DBG][ep=052] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.1058 mb_mean=0.4999 norm_overlap=0.9608 corr_cb=-0.5223 topkJ=0.0000
[TRAIN][ep=052] loss=0.4762 acc=85.37%
[TRAIN][ep=052] mask_avg: mc_mean=0.0812 mb_mean=0.5014 norm_overlap=0.9611 corr_cb=-0.5019
[EPOCH 052/089] train: loss=0.4762 acc=85.37% | val: loss=0.5562 acc=74.70% f1=77.89% auc=81.69% val_score=67.6328 val_score_bestthr=74.8086 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.502) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 74.8086
[DBG][ep=053] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.0743 mb_mean=0.5085 norm_overlap=0.9438 corr_cb=-0.5054 topkJ=0.0000
[TRAIN][ep=053] loss=0.4748 acc=84.56%
[TRAIN][ep=053] mask_avg: mc_mean=0.0811 mb_mean=0.5015 norm_overlap=0.9611 corr_cb=-0.5028
[EPOCH 053/089] train: loss=0.4748 acc=84.56% | val: loss=0.5558 acc=74.70% f1=77.89% auc=81.63% val_score=65.8373 val_score_bestthr=74.8086 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.503) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 74.8086
[DBG][ep=054] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=054] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=054] mask(step0): mc_mean=0.0761 mb_mean=0.5047 norm_overlap=0.9553 corr_cb=-0.4898 topkJ=0.0000
[TRAIN][ep=054] loss=0.4762 acc=84.56%
[TRAIN][ep=054] mask_avg: mc_mean=0.0812 mb_mean=0.5014 norm_overlap=0.9609 corr_cb=-0.5031
[EPOCH 054/089] train: loss=0.4762 acc=84.56% | val: loss=0.5792 acc=72.29% f1=77.23% auc=80.93% val_score=58.4318 val_score_bestthr=72.0964 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.503) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 72.0964
[DBG][ep=055] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=055] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=055] mask(step0): mc_mean=0.0746 mb_mean=0.5009 norm_overlap=0.9623 corr_cb=-0.5664 topkJ=0.0000
[TRAIN][ep=055] loss=0.4705 acc=84.83%
[TRAIN][ep=055] mask_avg: mc_mean=0.0813 mb_mean=0.5014 norm_overlap=0.9611 corr_cb=-0.4994
[EPOCH 055/089] train: loss=0.4705 acc=84.83% | val: loss=0.5849 acc=72.29% f1=76.77% auc=81.05% val_score=58.8580 val_score_bestthr=74.6040 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.499) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 74.6040
[DBG][ep=056] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=056] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=056] mask(step0): mc_mean=0.0925 mb_mean=0.5009 norm_overlap=0.9630 corr_cb=-0.5234 topkJ=0.0000
[TRAIN][ep=056] loss=0.4663 acc=85.50%
[TRAIN][ep=056] mask_avg: mc_mean=0.0812 mb_mean=0.5014 norm_overlap=0.9609 corr_cb=-0.5045
[EPOCH 056/089] train: loss=0.4663 acc=85.50% | val: loss=0.5733 acc=72.29% f1=76.77% auc=81.16% val_score=65.7296 val_score_bestthr=74.6040 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.505) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 74.6040
[DBG][ep=057] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=057] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=057] mask(step0): mc_mean=0.1161 mb_mean=0.4930 norm_overlap=0.9768 corr_cb=-0.5036 topkJ=0.0032
[TRAIN][ep=057] loss=0.4728 acc=85.64%
[TRAIN][ep=057] mask_avg: mc_mean=0.0812 mb_mean=0.5014 norm_overlap=0.9608 corr_cb=-0.5038
[EPOCH 057/089] train: loss=0.4728 acc=85.64% | val: loss=0.5717 acc=72.29% f1=76.77% auc=81.28% val_score=67.7710 val_score_bestthr=74.6040 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.504) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 74.6040
[DBG][ep=058] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=058] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=058] mask(step0): mc_mean=0.1127 mb_mean=0.5023 norm_overlap=0.9608 corr_cb=-0.4971 topkJ=0.0000
[TRAIN][ep=058] loss=0.4695 acc=85.23%
[TRAIN][ep=058] mask_avg: mc_mean=0.0812 mb_mean=0.5014 norm_overlap=0.9610 corr_cb=-0.5025
[EPOCH 058/089] train: loss=0.4695 acc=85.23% | val: loss=0.5735 acc=72.29% f1=76.77% auc=81.10% val_score=67.7710 val_score_bestthr=74.6040 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.503) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 74.6040
[DBG][ep=059] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=059] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=059] mask(step0): mc_mean=0.0772 mb_mean=0.5009 norm_overlap=0.9581 corr_cb=-0.5522 topkJ=0.0000
[TRAIN][ep=059] loss=0.4737 acc=84.70%
[TRAIN][ep=059] mask_avg: mc_mean=0.0811 mb_mean=0.5014 norm_overlap=0.9609 corr_cb=-0.5039
[EPOCH 059/089] train: loss=0.4737 acc=84.70% | val: loss=0.5971 acc=77.11% f1=76.54% auc=80.99% val_score=61.9411 val_score_bestthr=75.7177 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.504) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 75.7177
[DBG][ep=060] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=060] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=060] mask(step0): mc_mean=0.0650 mb_mean=0.5029 norm_overlap=0.9617 corr_cb=-0.4708 topkJ=0.0000
[TRAIN][ep=060] loss=0.4666 acc=85.10%
[TRAIN][ep=060] mask_avg: mc_mean=0.0811 mb_mean=0.5015 norm_overlap=0.9609 corr_cb=-0.5030
[EPOCH 060/089] train: loss=0.4666 acc=85.10% | val: loss=0.5945 acc=73.49% f1=78.00% auc=80.93% val_score=59.5758 val_score_bestthr=73.7939 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.503) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 73.7939
[DBG][ep=061] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=061] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=061] mask(step0): mc_mean=0.1472 mb_mean=0.4912 norm_overlap=0.9770 corr_cb=-0.4784 topkJ=0.0000
[TRAIN][ep=061] loss=0.4667 acc=84.70%
[TRAIN][ep=061] mask_avg: mc_mean=0.0812 mb_mean=0.5014 norm_overlap=0.9611 corr_cb=-0.5013
[EPOCH 061/089] train: loss=0.4667 acc=84.70% | val: loss=0.5831 acc=73.49% f1=78.00% auc=81.10% val_score=58.4318 val_score_bestthr=73.7939 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.501) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 73.7939
[DBG][ep=062] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=062] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=062] mask(step0): mc_mean=0.0488 mb_mean=0.5065 norm_overlap=0.9576 corr_cb=-0.4811 topkJ=0.0000
[TRAIN][ep=062] loss=0.4660 acc=84.83%
[TRAIN][ep=062] mask_avg: mc_mean=0.0812 mb_mean=0.5014 norm_overlap=0.9611 corr_cb=-0.5036
[EPOCH 062/089] train: loss=0.4660 acc=84.83% | val: loss=0.5694 acc=73.49% f1=77.55% auc=81.40% val_score=68.1889 val_score_bestthr=76.4190 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.504) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 76.4190
[DBG][ep=063] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=063] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=063] mask(step0): mc_mean=0.0786 mb_mean=0.4998 norm_overlap=0.9687 corr_cb=-0.4687 topkJ=0.0008
[TRAIN][ep=063] loss=0.4679 acc=84.83%
[TRAIN][ep=063] mask_avg: mc_mean=0.0812 mb_mean=0.5014 norm_overlap=0.9610 corr_cb=-0.5041
[EPOCH 063/089] train: loss=0.4679 acc=84.83% | val: loss=0.5791 acc=72.29% f1=76.77% auc=81.16% val_score=67.7710 val_score_bestthr=74.6040 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.504) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 74.6040
[DBG][ep=064] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=064] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=064] mask(step0): mc_mean=0.0961 mb_mean=0.4966 norm_overlap=0.9752 corr_cb=-0.4698 topkJ=0.0039
[TRAIN][ep=064] loss=0.4616 acc=86.31%
[TRAIN][ep=064] mask_avg: mc_mean=0.0812 mb_mean=0.5014 norm_overlap=0.9609 corr_cb=-0.5028
[EPOCH 064/089] train: loss=0.4616 acc=86.31% | val: loss=0.5826 acc=72.29% f1=76.77% auc=80.93% val_score=59.3378 val_score_bestthr=74.6040 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.503) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 74.6040
[DBG][ep=065] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=065] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=065] mask(step0): mc_mean=0.0760 mb_mean=0.5017 norm_overlap=0.9590 corr_cb=-0.5317 topkJ=0.0000
[TRAIN][ep=065] loss=0.4575 acc=85.23%
[TRAIN][ep=065] mask_avg: mc_mean=0.0811 mb_mean=0.5015 norm_overlap=0.9611 corr_cb=-0.5021
[EPOCH 065/089] train: loss=0.4575 acc=85.23% | val: loss=0.6272 acc=77.11% f1=76.54% auc=80.87% val_score=55.2534 val_score_bestthr=75.7177 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.502) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 75.7177
[DBG][ep=066] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=066] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=066] mask(step0): mc_mean=0.0884 mb_mean=0.5007 norm_overlap=0.9649 corr_cb=-0.5453 topkJ=0.0000
[TRAIN][ep=066] loss=0.4587 acc=85.23%
[TRAIN][ep=066] mask_avg: mc_mean=0.0811 mb_mean=0.5015 norm_overlap=0.9608 corr_cb=-0.5051
[EPOCH 066/089] train: loss=0.4587 acc=85.23% | val: loss=0.5876 acc=74.70% f1=77.89% auc=81.16% val_score=58.4318 val_score_bestthr=74.8086 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.505) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 74.8086
[DBG][ep=067] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=067] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=067] mask(step0): mc_mean=0.0801 mb_mean=0.5058 norm_overlap=0.9478 corr_cb=-0.5302 topkJ=0.0000
[TRAIN][ep=067] loss=0.4568 acc=85.64%
[TRAIN][ep=067] mask_avg: mc_mean=0.0812 mb_mean=0.5014 norm_overlap=0.9609 corr_cb=-0.5053
[EPOCH 067/089] train: loss=0.4568 acc=85.64% | val: loss=0.5810 acc=74.70% f1=77.89% auc=81.34% val_score=66.6278 val_score_bestthr=74.8086 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.505) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 74.8086
[DBG][ep=068] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=068] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=068] mask(step0): mc_mean=0.0718 mb_mean=0.5032 norm_overlap=0.9605 corr_cb=-0.5240 topkJ=0.0008
[TRAIN][ep=068] loss=0.4538 acc=85.91%
[TRAIN][ep=068] mask_avg: mc_mean=0.0813 mb_mean=0.5014 norm_overlap=0.9609 corr_cb=-0.5025
[EPOCH 068/089] train: loss=0.4538 acc=85.91% | val: loss=0.6789 acc=77.11% f1=76.54% auc=80.47% val_score=56.8352 val_score_bestthr=75.7177 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.502) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 75.7177
[DBG][ep=069] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=069] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=069] mask(step0): mc_mean=0.0971 mb_mean=0.5002 norm_overlap=0.9610 corr_cb=-0.5764 topkJ=0.0000
[TRAIN][ep=069] loss=0.4657 acc=84.97%
[TRAIN][ep=069] mask_avg: mc_mean=0.0812 mb_mean=0.5014 norm_overlap=0.9610 corr_cb=-0.5027
[EPOCH 069/089] train: loss=0.4657 acc=84.97% | val: loss=0.5748 acc=73.49% f1=77.55% auc=81.28% val_score=69.8671 val_score_bestthr=76.4190 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.503) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 76.4190
[DBG][ep=070] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=070] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=070] mask(step0): mc_mean=0.0822 mb_mean=0.4982 norm_overlap=0.9700 corr_cb=-0.5038 topkJ=0.0000
[TRAIN][ep=070] loss=0.4568 acc=86.31%
[TRAIN][ep=070] mask_avg: mc_mean=0.0811 mb_mean=0.5014 norm_overlap=0.9610 corr_cb=-0.5025
[EPOCH 070/089] train: loss=0.4568 acc=86.31% | val: loss=0.5786 acc=73.49% f1=78.43% auc=81.28% val_score=72.2198 val_score_bestthr=76.1210 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.503) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 76.1210
[DBG][ep=071] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=071] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=071] mask(step0): mc_mean=0.0941 mb_mean=0.4983 norm_overlap=0.9596 corr_cb=-0.5672 topkJ=0.0000
[TRAIN][ep=071] loss=0.4552 acc=85.77%
[TRAIN][ep=071] mask_avg: mc_mean=0.0811 mb_mean=0.5014 norm_overlap=0.9609 corr_cb=-0.5072
[EPOCH 071/089] train: loss=0.4552 acc=85.77% | val: loss=0.5888 acc=72.29% f1=76.77% auc=80.87% val_score=69.3263 val_score_bestthr=74.6040 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.507) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 74.6040
[EARLY STOP] no improvement for 30 epochs. best_epoch=41
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
=============== FIT DONE ===============
[BEST] epoch=41 | val_acc=73.49% | val_f1=76.09% | val_auc=81.80% | val_score=62.1952 | val_score_bestthr=79.0251
[TEST@BEST] thr_used=0.190 | acc=58.94% f1=68.63% auc=64.26% | SP_sex=7.23% EO_sex=2.12% SP_age=11.48% EO_age=7.93%
[TIME] 1.81 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/summary_fold_0.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4752 mb_mean=0.5091 norm_overlap=0.9996 corr_cb=-0.4004 topkJ=0.0039
[TRAIN][ep=000] loss=0.6932 acc=51.14%
[TRAIN][ep=000] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1325
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4782 mb_mean=0.5028 norm_overlap=0.9999 corr_cb=-0.0933 topkJ=0.0031
[TRAIN][ep=001] loss=0.6927 acc=51.01%
[TRAIN][ep=001] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1283
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4776 mb_mean=0.5098 norm_overlap=0.9997 corr_cb=-0.3755 topkJ=0.0024
[TRAIN][ep=002] loss=0.6906 acc=53.42%
[TRAIN][ep=002] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1407
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4785 mb_mean=0.5037 norm_overlap=1.0000 corr_cb=0.0262 topkJ=0.0152
[TRAIN][ep=003] loss=0.6892 acc=55.84%
[TRAIN][ep=003] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1330
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4760 mb_mean=0.5053 norm_overlap=0.9998 corr_cb=-0.2618 topkJ=0.0459
[TRAIN][ep=004] loss=0.6879 acc=57.32%
[TRAIN][ep=004] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1247
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4794 mb_mean=0.5002 norm_overlap=0.9999 corr_cb=-0.2006 topkJ=0.0064
[TRAIN][ep=005] loss=0.6871 acc=54.09%
[TRAIN][ep=005] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1272
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4760 mb_mean=0.5040 norm_overlap=0.9997 corr_cb=-0.4011 topkJ=0.0113
[TRAIN][ep=006] loss=0.6832 acc=56.24%
[TRAIN][ep=006] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1302
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4758 mb_mean=0.5023 norm_overlap=0.9998 corr_cb=-0.2950 topkJ=0.0024
[TRAIN][ep=007] loss=0.6767 acc=59.19%
[TRAIN][ep=007] mask_avg: mc_mean=0.4785 mb_mean=0.5015 norm_overlap=0.9999 corr_cb=-0.1365
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4784 mb_mean=0.4987 norm_overlap=0.9997 corr_cb=-0.3532 topkJ=0.0048
[TRAIN][ep=008] loss=0.6721 acc=63.89%
[TRAIN][ep=008] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1238
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4781 mb_mean=0.5042 norm_overlap=0.9998 corr_cb=-0.2975 topkJ=0.0188
[TRAIN][ep=009] loss=0.6643 acc=62.55%
[TRAIN][ep=009] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1254
================= FIT START (fold=0) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4787 mb_mean=0.5043 norm_overlap=0.9999 corr_cb=-0.0822 topkJ=0.0502
[TRAIN][ep=000] loss=0.6583 acc=63.62%
[TRAIN][ep=000] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1201
[EPOCH 000/089] train: loss=0.6583 acc=63.62% | val: loss=0.6534 acc=67.47% f1=74.29% auc=71.74% val_score=55.4225 val_score_bestthr=63.3503 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.120) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 63.3503
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4793 mb_mean=0.5022 norm_overlap=0.9998 corr_cb=-0.2365 topkJ=0.0024
[TRAIN][ep=001] loss=0.6517 acc=64.43%
[TRAIN][ep=001] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1274
[EPOCH 001/089] train: loss=0.6517 acc=64.43% | val: loss=0.6599 acc=61.45% f1=72.41% auc=68.49% val_score=47.5336 val_score_bestthr=64.7777 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.127) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 63.3503 -> 64.7777
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4774 mb_mean=0.4982 norm_overlap=1.0000 corr_cb=-0.0324 topkJ=0.0252
[TRAIN][ep=002] loss=0.6471 acc=64.30%
[TRAIN][ep=002] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1182
[EPOCH 002/089] train: loss=0.6471 acc=64.30% | val: loss=0.6414 acc=68.67% f1=75.00% auc=72.44% val_score=47.9380 val_score_bestthr=63.1152 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.118) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.7777 -> 63.1152
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4776 mb_mean=0.5075 norm_overlap=0.9998 corr_cb=-0.2177 topkJ=0.0023
[TRAIN][ep=003] loss=0.6422 acc=64.43%
[TRAIN][ep=003] mask_avg: mc_mean=0.4785 mb_mean=0.5015 norm_overlap=0.9999 corr_cb=-0.1255
[EPOCH 003/089] train: loss=0.6422 acc=64.43% | val: loss=0.6608 acc=63.86% f1=73.68% auc=69.24% val_score=54.7539 val_score_bestthr=65.2221 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.125) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 64.7777 -> 65.2221
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4824 mb_mean=0.4950 norm_overlap=0.9998 corr_cb=-0.2211 topkJ=0.0294
[TRAIN][ep=004] loss=0.6475 acc=62.01%
[TRAIN][ep=004] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1284
[EPOCH 004/089] train: loss=0.6475 acc=62.01% | val: loss=0.6352 acc=69.88% f1=76.19% auc=73.08% val_score=46.9114 val_score_bestthr=64.6846 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.128) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 65.2221 -> 64.6846
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4744 mb_mean=0.5047 norm_overlap=0.9999 corr_cb=-0.0747 topkJ=0.0278
[TRAIN][ep=005] loss=1.2774 acc=65.10%
[TRAIN][ep=005] mask_avg: mc_mean=0.3462 mb_mean=0.5014 norm_overlap=0.9962 corr_cb=-0.6416
[EPOCH 005/089] train: loss=1.2774 acc=65.10% | val: loss=0.6518 acc=67.47% f1=69.66% auc=75.76% val_score=62.4643 val_score_bestthr=63.5118 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.346, mb=0.501, no=0.996, corr=-0.642) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.2221 -> 63.5118
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.1991 mb_mean=0.5118 norm_overlap=0.9864 corr_cb=-0.7996 topkJ=0.0000
[TRAIN][ep=006] loss=1.2565 acc=66.04%
[TRAIN][ep=006] mask_avg: mc_mean=0.1918 mb_mean=0.5014 norm_overlap=0.9886 corr_cb=-0.7194
[EPOCH 006/089] train: loss=1.2565 acc=66.04% | val: loss=0.6378 acc=61.45% f1=71.93% auc=76.69% val_score=65.9943 val_score_bestthr=60.9430 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.192, mb=0.501, no=0.989, corr=-0.719) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.2221 -> 60.9430
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.1515 mb_mean=0.5024 norm_overlap=0.9839 corr_cb=-0.7858 topkJ=0.0000
[TRAIN][ep=007] loss=1.2594 acc=62.68%
[TRAIN][ep=007] mask_avg: mc_mean=0.1243 mb_mean=0.5014 norm_overlap=0.9816 corr_cb=-0.7177
[EPOCH 007/089] train: loss=1.2594 acc=62.68% | val: loss=0.6281 acc=68.67% f1=74.51% auc=74.19% val_score=52.4552 val_score_bestthr=66.3139 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.124, mb=0.501, no=0.982, corr=-0.718) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 65.2221 -> 66.3139
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1091 mb_mean=0.5001 norm_overlap=0.9750 corr_cb=-0.7725 topkJ=0.0000
[TRAIN][ep=008] loss=1.2433 acc=67.38%
[TRAIN][ep=008] mask_avg: mc_mean=0.0810 mb_mean=0.5014 norm_overlap=0.9746 corr_cb=-0.6708
[EPOCH 008/089] train: loss=1.2433 acc=67.38% | val: loss=0.6343 acc=67.47% f1=75.23% auc=73.43% val_score=61.5991 val_score_bestthr=65.3678 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.081, mb=0.501, no=0.975, corr=-0.671) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3139 -> 65.3678
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.0578 mb_mean=0.5043 norm_overlap=0.9722 corr_cb=-0.6653 topkJ=0.0000
[TRAIN][ep=009] loss=1.2226 acc=69.26%
[TRAIN][ep=009] mask_avg: mc_mean=0.0692 mb_mean=0.5014 norm_overlap=0.9703 corr_cb=-0.6314
[EPOCH 009/089] train: loss=1.2226 acc=69.26% | val: loss=0.6050 acc=67.47% f1=73.79% auc=75.76% val_score=49.7236 val_score_bestthr=64.0005 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.069, mb=0.501, no=0.970, corr=-0.631) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3139 -> 64.0005
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.0848 mb_mean=0.4997 norm_overlap=0.9624 corr_cb=-0.6837 topkJ=0.0000
[TRAIN][ep=010] loss=0.8201 acc=67.79%
[TRAIN][ep=010] mask_avg: mc_mean=0.0699 mb_mean=0.5015 norm_overlap=0.9679 corr_cb=-0.6066
[EPOCH 010/089] train: loss=0.8201 acc=67.79% | val: loss=0.6023 acc=71.08% f1=65.71% auc=75.64% val_score=54.5243 val_score_bestthr=64.2616 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.070, mb=0.501, no=0.968, corr=-0.607) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3139 -> 64.2616
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.0926 mb_mean=0.5016 norm_overlap=0.9550 corr_cb=-0.6483 topkJ=0.0000
[TRAIN][ep=011] loss=0.7604 acc=69.80%
[TRAIN][ep=011] mask_avg: mc_mean=0.0611 mb_mean=0.5015 norm_overlap=0.9643 corr_cb=-0.5718
[EPOCH 011/089] train: loss=0.7604 acc=69.80% | val: loss=0.5922 acc=73.49% f1=69.44% auc=75.99% val_score=47.9807 val_score_bestthr=65.6306 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.061, mb=0.501, no=0.964, corr=-0.572) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3139 -> 65.6306
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.0360 mb_mean=0.5072 norm_overlap=0.9622 corr_cb=-0.5399 topkJ=0.0000
[TRAIN][ep=012] loss=0.7608 acc=68.99%
[TRAIN][ep=012] mask_avg: mc_mean=0.0582 mb_mean=0.5014 norm_overlap=0.9623 corr_cb=-0.5492
[EPOCH 012/089] train: loss=0.7608 acc=68.99% | val: loss=0.6280 acc=71.08% f1=64.71% auc=74.19% val_score=51.3437 val_score_bestthr=66.1865 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.058, mb=0.501, no=0.962, corr=-0.549) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3139 -> 66.1865
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.0309 mb_mean=0.5080 norm_overlap=0.9534 corr_cb=-0.3701 topkJ=0.0000
[TRAIN][ep=013] loss=0.7484 acc=71.41%
[TRAIN][ep=013] mask_avg: mc_mean=0.0518 mb_mean=0.5015 norm_overlap=0.9596 corr_cb=-0.5259
[EPOCH 013/089] train: loss=0.7484 acc=71.41% | val: loss=0.5896 acc=72.29% f1=66.67% auc=75.64% val_score=59.7524 val_score_bestthr=66.6238 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.052, mb=0.501, no=0.960, corr=-0.526) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 66.3139 -> 66.6238
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.0583 mb_mean=0.4973 norm_overlap=0.9715 corr_cb=-0.4812 topkJ=0.0024
[TRAIN][ep=014] loss=0.7433 acc=71.54%
[TRAIN][ep=014] mask_avg: mc_mean=0.0521 mb_mean=0.5014 norm_overlap=0.9586 corr_cb=-0.5181
[EPOCH 014/089] train: loss=0.7433 acc=71.54% | val: loss=0.5832 acc=72.29% f1=66.67% auc=75.93% val_score=52.8036 val_score_bestthr=66.6238 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.052, mb=0.501, no=0.959, corr=-0.518) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6238 -> 66.6238
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.0311 mb_mean=0.5043 norm_overlap=0.9558 corr_cb=-0.4274 topkJ=0.0000
[TRAIN][ep=015] loss=0.7306 acc=72.35%
[TRAIN][ep=015] mask_avg: mc_mean=0.0554 mb_mean=0.5014 norm_overlap=0.9588 corr_cb=-0.5192
[EPOCH 015/089] train: loss=0.7306 acc=72.35% | val: loss=0.5739 acc=73.49% f1=68.57% auc=76.69% val_score=54.8728 val_score_bestthr=65.9223 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.055, mb=0.501, no=0.959, corr=-0.519) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6238 -> 65.9223
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.0358 mb_mean=0.5102 norm_overlap=0.9420 corr_cb=-0.5243 topkJ=0.0000
[TRAIN][ep=016] loss=0.7391 acc=71.68%
[TRAIN][ep=016] mask_avg: mc_mean=0.0470 mb_mean=0.5014 norm_overlap=0.9560 corr_cb=-0.4906
[EPOCH 016/089] train: loss=0.7391 acc=71.68% | val: loss=0.5743 acc=73.49% f1=68.57% auc=77.15% val_score=51.4217 val_score_bestthr=65.9223 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.047, mb=0.501, no=0.956, corr=-0.491) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6238 -> 65.9223
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.0582 mb_mean=0.4927 norm_overlap=0.9731 corr_cb=-0.4256 topkJ=0.0008
[TRAIN][ep=017] loss=0.7308 acc=71.28%
[TRAIN][ep=017] mask_avg: mc_mean=0.0432 mb_mean=0.5014 norm_overlap=0.9547 corr_cb=-0.4762
[EPOCH 017/089] train: loss=0.7308 acc=71.28% | val: loss=0.5793 acc=73.49% f1=68.57% auc=76.16% val_score=61.1980 val_score_bestthr=65.9223 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.043, mb=0.501, no=0.955, corr=-0.476) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6238 -> 65.9223
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.0496 mb_mean=0.5052 norm_overlap=0.9475 corr_cb=-0.5301 topkJ=0.0000
[TRAIN][ep=018] loss=0.7169 acc=72.48%
[TRAIN][ep=018] mask_avg: mc_mean=0.0590 mb_mean=0.5014 norm_overlap=0.9579 corr_cb=-0.5148
[EPOCH 018/089] train: loss=0.7169 acc=72.48% | val: loss=0.7086 acc=66.27% f1=74.07% auc=74.65% val_score=51.6446 val_score_bestthr=65.3762 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.059, mb=0.501, no=0.958, corr=-0.515) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6238 -> 65.3762
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.0368 mb_mean=0.4998 norm_overlap=0.9535 corr_cb=-0.4661 topkJ=0.0000
[TRAIN][ep=019] loss=0.7430 acc=70.20%
[TRAIN][ep=019] mask_avg: mc_mean=0.0392 mb_mean=0.5014 norm_overlap=0.9528 corr_cb=-0.4586
[EPOCH 019/089] train: loss=0.7430 acc=70.20% | val: loss=0.6262 acc=67.47% f1=74.77% auc=75.81% val_score=60.2367 val_score_bestthr=66.4819 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.039, mb=0.501, no=0.953, corr=-0.459) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6238 -> 66.4819
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.0769 mb_mean=0.4956 norm_overlap=0.9530 corr_cb=-0.5799 topkJ=0.0000
[TRAIN][ep=020] loss=0.7225 acc=72.89%
[TRAIN][ep=020] mask_avg: mc_mean=0.0457 mb_mean=0.5014 norm_overlap=0.9545 corr_cb=-0.4828
[EPOCH 020/089] train: loss=0.7225 acc=72.89% | val: loss=0.5862 acc=73.49% f1=68.57% auc=77.09% val_score=58.7307 val_score_bestthr=65.9223 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.046, mb=0.501, no=0.954, corr=-0.483) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6238 -> 65.9223
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.0432 mb_mean=0.5057 norm_overlap=0.9445 corr_cb=-0.4642 topkJ=0.0000
[TRAIN][ep=021] loss=0.7040 acc=73.69%
[TRAIN][ep=021] mask_avg: mc_mean=0.0626 mb_mean=0.5014 norm_overlap=0.9578 corr_cb=-0.5227
[EPOCH 021/089] train: loss=0.7040 acc=73.69% | val: loss=0.5894 acc=67.47% f1=74.29% auc=77.21% val_score=58.7307 val_score_bestthr=68.5589 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.063, mb=0.501, no=0.958, corr=-0.523) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 66.6238 -> 68.5589
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.0786 mb_mean=0.4985 norm_overlap=0.9655 corr_cb=-0.4706 topkJ=0.0000
[TRAIN][ep=022] loss=0.7084 acc=73.96%
[TRAIN][ep=022] mask_avg: mc_mean=0.0577 mb_mean=0.5014 norm_overlap=0.9566 corr_cb=-0.5101
[EPOCH 022/089] train: loss=0.7084 acc=73.96% | val: loss=0.5492 acc=66.27% f1=75.00% auc=77.97% val_score=61.2877 val_score_bestthr=69.6680 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.058, mb=0.501, no=0.957, corr=-0.510) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 68.5589 -> 69.6680
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.0441 mb_mean=0.5003 norm_overlap=0.9548 corr_cb=-0.4500 topkJ=0.0000
[TRAIN][ep=023] loss=0.7150 acc=72.62%
[TRAIN][ep=023] mask_avg: mc_mean=0.0461 mb_mean=0.5015 norm_overlap=0.9536 corr_cb=-0.4774
[EPOCH 023/089] train: loss=0.7150 acc=72.62% | val: loss=0.5532 acc=74.70% f1=72.00% auc=78.31% val_score=57.8118 val_score_bestthr=65.3644 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.046, mb=0.501, no=0.954, corr=-0.477) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.6680 -> 65.3644
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.0465 mb_mean=0.5001 norm_overlap=0.9620 corr_cb=-0.3886 topkJ=0.0000
[TRAIN][ep=024] loss=0.6849 acc=75.84%
[TRAIN][ep=024] mask_avg: mc_mean=0.0534 mb_mean=0.5014 norm_overlap=0.9554 corr_cb=-0.4925
[EPOCH 024/089] train: loss=0.6849 acc=75.84% | val: loss=0.5556 acc=75.90% f1=74.36% auc=78.26% val_score=57.1066 val_score_bestthr=68.2337 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.053, mb=0.501, no=0.955, corr=-0.492) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.6680 -> 68.2337
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.0515 mb_mean=0.5013 norm_overlap=0.9566 corr_cb=-0.5421 topkJ=0.0000
[TRAIN][ep=025] loss=0.7047 acc=73.56%
[TRAIN][ep=025] mask_avg: mc_mean=0.0502 mb_mean=0.5014 norm_overlap=0.9542 corr_cb=-0.4819
[EPOCH 025/089] train: loss=0.7047 acc=73.56% | val: loss=0.5548 acc=66.27% f1=74.55% auc=77.21% val_score=63.6469 val_score_bestthr=66.2452 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.050, mb=0.501, no=0.954, corr=-0.482) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.6680 -> 66.2452
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.0380 mb_mean=0.5025 norm_overlap=0.9491 corr_cb=-0.5156 topkJ=0.0000
[TRAIN][ep=026] loss=0.6817 acc=74.50%
[TRAIN][ep=026] mask_avg: mc_mean=0.0576 mb_mean=0.5014 norm_overlap=0.9562 corr_cb=-0.5042
[EPOCH 026/089] train: loss=0.6817 acc=74.50% | val: loss=0.5753 acc=74.70% f1=72.73% auc=78.90% val_score=60.3976 val_score_bestthr=69.5636 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.058, mb=0.501, no=0.956, corr=-0.504) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.6680 -> 69.5636
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.0749 mb_mean=0.5001 norm_overlap=0.9520 corr_cb=-0.5846 topkJ=0.0000
[TRAIN][ep=027] loss=0.6801 acc=74.36%
[TRAIN][ep=027] mask_avg: mc_mean=0.0621 mb_mean=0.5014 norm_overlap=0.9570 corr_cb=-0.5120
[EPOCH 027/089] train: loss=0.6801 acc=74.36% | val: loss=0.6042 acc=72.29% f1=72.94% auc=77.33% val_score=58.7307 val_score_bestthr=69.2820 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.062, mb=0.501, no=0.957, corr=-0.512) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.6680 -> 69.2820
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.0700 mb_mean=0.4951 norm_overlap=0.9721 corr_cb=-0.4187 topkJ=0.0000
[TRAIN][ep=028] loss=0.6780 acc=74.77%
[TRAIN][ep=028] mask_avg: mc_mean=0.0607 mb_mean=0.5015 norm_overlap=0.9566 corr_cb=-0.5054
[EPOCH 028/089] train: loss=0.6780 acc=74.77% | val: loss=0.5532 acc=77.11% f1=76.54% auc=79.36% val_score=58.6883 val_score_bestthr=74.5003 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.061, mb=0.501, no=0.957, corr=-0.505) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 69.6680 -> 74.5003
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.0748 mb_mean=0.4980 norm_overlap=0.9638 corr_cb=-0.5070 topkJ=0.0000
[TRAIN][ep=029] loss=0.6622 acc=78.12%
[TRAIN][ep=029] mask_avg: mc_mean=0.0588 mb_mean=0.5015 norm_overlap=0.9563 corr_cb=-0.5045
[EPOCH 029/089] train: loss=0.6622 acc=78.12% | val: loss=0.6006 acc=68.67% f1=75.93% auc=80.00% val_score=71.5991 val_score_bestthr=71.5991 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.059, mb=0.501, no=0.956, corr=-0.505) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.5003 -> 71.5991
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.0839 mb_mean=0.4961 norm_overlap=0.9686 corr_cb=-0.5520 topkJ=0.0000
[TRAIN][ep=030] loss=0.6680 acc=74.90%
[TRAIN][ep=030] mask_avg: mc_mean=0.0628 mb_mean=0.5015 norm_overlap=0.9570 corr_cb=-0.5116
[EPOCH 030/089] train: loss=0.6680 acc=74.90% | val: loss=0.5428 acc=74.70% f1=74.70% auc=80.06% val_score=61.3022 val_score_bestthr=71.0024 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.063, mb=0.501, no=0.957, corr=-0.512) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.5003 -> 71.0024
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.0592 mb_mean=0.5019 norm_overlap=0.9608 corr_cb=-0.5161 topkJ=0.0000
[TRAIN][ep=031] loss=0.6496 acc=77.58%
[TRAIN][ep=031] mask_avg: mc_mean=0.0659 mb_mean=0.5015 norm_overlap=0.9577 corr_cb=-0.5167
[EPOCH 031/089] train: loss=0.6496 acc=77.58% | val: loss=0.5487 acc=75.90% f1=75.61% auc=78.95% val_score=62.0977 val_score_bestthr=73.9054 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.066, mb=0.501, no=0.958, corr=-0.517) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.5003 -> 73.9054
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.0604 mb_mean=0.4988 norm_overlap=0.9569 corr_cb=-0.5757 topkJ=0.0000
[TRAIN][ep=032] loss=0.6572 acc=78.12%
[TRAIN][ep=032] mask_avg: mc_mean=0.0677 mb_mean=0.5014 norm_overlap=0.9584 corr_cb=-0.5135
[EPOCH 032/089] train: loss=0.6572 acc=78.12% | val: loss=0.5520 acc=77.11% f1=76.54% auc=80.29% val_score=58.9681 val_score_bestthr=74.5003 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.068, mb=0.501, no=0.958, corr=-0.513) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.5003 -> 74.5003
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.0790 mb_mean=0.4952 norm_overlap=0.9707 corr_cb=-0.4897 topkJ=0.0004
[TRAIN][ep=033] loss=0.6397 acc=77.45%
[TRAIN][ep=033] mask_avg: mc_mean=0.0641 mb_mean=0.5014 norm_overlap=0.9577 corr_cb=-0.5016
[EPOCH 033/089] train: loss=0.6397 acc=77.45% | val: loss=0.5576 acc=73.49% f1=75.00% auc=79.83% val_score=54.5230 val_score_bestthr=74.9503 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.064, mb=0.501, no=0.958, corr=-0.502) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 74.5003 -> 74.9503
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.0878 mb_mean=0.5028 norm_overlap=0.9596 corr_cb=-0.6041 topkJ=0.0000
[TRAIN][ep=034] loss=0.6425 acc=75.57%
[TRAIN][ep=034] mask_avg: mc_mean=0.0794 mb_mean=0.5014 norm_overlap=0.9599 corr_cb=-0.5176
[EPOCH 034/089] train: loss=0.6425 acc=75.57% | val: loss=0.5387 acc=71.08% f1=73.91% auc=79.83% val_score=62.0977 val_score_bestthr=72.1808 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.079, mb=0.501, no=0.960, corr=-0.518) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.9503 -> 72.1808
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.0385 mb_mean=0.5037 norm_overlap=0.9558 corr_cb=-0.4430 topkJ=0.0000
[TRAIN][ep=035] loss=0.6305 acc=79.87%
[TRAIN][ep=035] mask_avg: mc_mean=0.0663 mb_mean=0.5014 norm_overlap=0.9582 corr_cb=-0.5043
[EPOCH 035/089] train: loss=0.6305 acc=79.87% | val: loss=0.5311 acc=72.29% f1=76.29% auc=81.40% val_score=57.5059 val_score_bestthr=72.8356 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.066, mb=0.501, no=0.958, corr=-0.504) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.9503 -> 72.8356
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.0692 mb_mean=0.4983 norm_overlap=0.9579 corr_cb=-0.5408 topkJ=0.0000
[TRAIN][ep=036] loss=0.6398 acc=78.12%
[TRAIN][ep=036] mask_avg: mc_mean=0.0732 mb_mean=0.5015 norm_overlap=0.9592 corr_cb=-0.5167
[EPOCH 036/089] train: loss=0.6398 acc=78.12% | val: loss=0.5683 acc=73.49% f1=77.55% auc=80.70% val_score=55.9281 val_score_bestthr=74.5060 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.073, mb=0.501, no=0.959, corr=-0.517) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.9503 -> 74.5060
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.0445 mb_mean=0.5046 norm_overlap=0.9514 corr_cb=-0.4944 topkJ=0.0000
[TRAIN][ep=037] loss=0.6271 acc=78.93%
[TRAIN][ep=037] mask_avg: mc_mean=0.0707 mb_mean=0.5014 norm_overlap=0.9588 corr_cb=-0.5103
[EPOCH 037/089] train: loss=0.6271 acc=78.93% | val: loss=0.5582 acc=71.08% f1=74.47% auc=81.34% val_score=55.0122 val_score_bestthr=75.4451 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.071, mb=0.501, no=0.959, corr=-0.510) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 74.9503 -> 75.4451
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.0751 mb_mean=0.4966 norm_overlap=0.9680 corr_cb=-0.5342 topkJ=0.0000
[TRAIN][ep=038] loss=0.6458 acc=77.05%
[TRAIN][ep=038] mask_avg: mc_mean=0.0420 mb_mean=0.5014 norm_overlap=0.9521 corr_cb=-0.4333
[EPOCH 038/089] train: loss=0.6458 acc=77.05% | val: loss=0.5337 acc=71.08% f1=73.91% auc=81.05% val_score=65.3839 val_score_bestthr=73.1953 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.042, mb=0.501, no=0.952, corr=-0.433) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.4451 -> 73.1953
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.0431 mb_mean=0.5081 norm_overlap=0.9452 corr_cb=-0.5093 topkJ=0.0000
[TRAIN][ep=039] loss=0.6038 acc=80.94%
[TRAIN][ep=039] mask_avg: mc_mean=0.0796 mb_mean=0.5015 norm_overlap=0.9604 corr_cb=-0.5236
[EPOCH 039/089] train: loss=0.6038 acc=80.94% | val: loss=0.5329 acc=73.49% f1=75.56% auc=82.09% val_score=69.8061 val_score_bestthr=75.7643 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.080, mb=0.501, no=0.960, corr=-0.524) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 75.4451 -> 75.7643
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.1044 mb_mean=0.5035 norm_overlap=0.9534 corr_cb=-0.6355 topkJ=0.0000
[TRAIN][ep=040] loss=0.6129 acc=79.33%
[TRAIN][ep=040] mask_avg: mc_mean=0.0764 mb_mean=0.5014 norm_overlap=0.9601 corr_cb=-0.5111
[EPOCH 040/089] train: loss=0.6129 acc=79.33% | val: loss=0.5600 acc=77.11% f1=76.54% auc=80.99% val_score=62.1770 val_score_bestthr=75.6597 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.076, mb=0.501, no=0.960, corr=-0.511) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.7643 -> 75.6597
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.0944 mb_mean=0.5010 norm_overlap=0.9558 corr_cb=-0.6084 topkJ=0.0000
[TRAIN][ep=041] loss=0.6193 acc=78.12%
[TRAIN][ep=041] mask_avg: mc_mean=0.0751 mb_mean=0.5014 norm_overlap=0.9597 corr_cb=-0.5073
[EPOCH 041/089] train: loss=0.6193 acc=78.12% | val: loss=0.5496 acc=73.49% f1=76.09% auc=81.80% val_score=62.1952 val_score_bestthr=79.0251 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.075, mb=0.501, no=0.960, corr=-0.507) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 75.7643 -> 79.0251
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.0834 mb_mean=0.4956 norm_overlap=0.9721 corr_cb=-0.4698 topkJ=0.0000
[TRAIN][ep=042] loss=0.6080 acc=80.94%
[TRAIN][ep=042] mask_avg: mc_mean=0.0812 mb_mean=0.5014 norm_overlap=0.9607 corr_cb=-0.5075
[EPOCH 042/089] train: loss=0.6080 acc=80.94% | val: loss=0.5291 acc=73.49% f1=76.09% auc=82.15% val_score=60.3570 val_score_bestthr=75.9418 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.507) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 75.9418
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.0405 mb_mean=0.4997 norm_overlap=0.9592 corr_cb=-0.4726 topkJ=0.0000
[TRAIN][ep=043] loss=0.6904 acc=77.85%
[TRAIN][ep=043] mask_avg: mc_mean=0.0692 mb_mean=0.5014 norm_overlap=0.9591 corr_cb=-0.4906
[EPOCH 043/089] train: loss=0.6904 acc=77.85% | val: loss=0.6764 acc=74.70% f1=77.42% auc=82.09% val_score=54.1440 val_score_bestthr=74.3342 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.069, mb=0.501, no=0.959, corr=-0.491) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 74.3342
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.0486 mb_mean=0.5072 norm_overlap=0.9496 corr_cb=-0.5109 topkJ=0.0000
[TRAIN][ep=044] loss=0.5918 acc=80.13%
[TRAIN][ep=044] mask_avg: mc_mean=0.0782 mb_mean=0.5015 norm_overlap=0.9606 corr_cb=-0.5096
[EPOCH 044/089] train: loss=0.5918 acc=80.13% | val: loss=0.5488 acc=72.29% f1=76.29% auc=81.98% val_score=68.2151 val_score_bestthr=71.2305 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.078, mb=0.501, no=0.961, corr=-0.510) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 71.2305
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.0832 mb_mean=0.4984 norm_overlap=0.9617 corr_cb=-0.4586 topkJ=0.0000
[TRAIN][ep=045] loss=0.5784 acc=82.42%
[TRAIN][ep=045] mask_avg: mc_mean=0.0853 mb_mean=0.5014 norm_overlap=0.9616 corr_cb=-0.5146
[EPOCH 045/089] train: loss=0.5784 acc=82.42% | val: loss=0.5692 acc=74.70% f1=78.35% auc=82.27% val_score=68.8938 val_score_bestthr=74.3383 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.085, mb=0.501, no=0.962, corr=-0.515) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 74.3383
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.1075 mb_mean=0.4955 norm_overlap=0.9706 corr_cb=-0.4992 topkJ=0.0000
[TRAIN][ep=046] loss=0.6509 acc=80.94%
[TRAIN][ep=046] mask_avg: mc_mean=0.0788 mb_mean=0.5015 norm_overlap=0.9603 corr_cb=-0.5003
[EPOCH 046/089] train: loss=0.6509 acc=80.94% | val: loss=0.6165 acc=74.70% f1=77.42% auc=81.92% val_score=55.9281 val_score_bestthr=74.3342 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.079, mb=0.501, no=0.960, corr=-0.500) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 74.3342
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.0779 mb_mean=0.5047 norm_overlap=0.9633 corr_cb=-0.5315 topkJ=0.0000
[TRAIN][ep=047] loss=0.5720 acc=81.07%
[TRAIN][ep=047] mask_avg: mc_mean=0.0903 mb_mean=0.5014 norm_overlap=0.9625 corr_cb=-0.5134
[EPOCH 047/089] train: loss=0.5720 acc=81.07% | val: loss=0.5633 acc=74.70% f1=79.21% auc=81.98% val_score=72.8339 val_score_bestthr=77.8191 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.090, mb=0.501, no=0.962, corr=-0.513) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 77.8191
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.0902 mb_mean=0.4955 norm_overlap=0.9679 corr_cb=-0.4896 topkJ=0.0000
[TRAIN][ep=048] loss=0.5897 acc=81.61%
[TRAIN][ep=048] mask_avg: mc_mean=0.0848 mb_mean=0.5014 norm_overlap=0.9614 corr_cb=-0.5071
[EPOCH 048/089] train: loss=0.5897 acc=81.61% | val: loss=0.5485 acc=73.49% f1=75.00% auc=81.57% val_score=63.0535 val_score_bestthr=71.7038 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.085, mb=0.501, no=0.961, corr=-0.507) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 71.7038
[DBG][ep=049] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.0499 mb_mean=0.5049 norm_overlap=0.9576 corr_cb=-0.4774 topkJ=0.0000
[TRAIN][ep=049] loss=0.5622 acc=82.28%
[TRAIN][ep=049] mask_avg: mc_mean=0.0779 mb_mean=0.5014 norm_overlap=0.9605 corr_cb=-0.4973
[EPOCH 049/089] train: loss=0.5622 acc=82.28% | val: loss=0.6228 acc=73.49% f1=77.08% auc=81.34% val_score=53.4640 val_score_bestthr=72.3516 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.078, mb=0.501, no=0.961, corr=-0.497) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 72.3516
[DBG][ep=050] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.0741 mb_mean=0.5029 norm_overlap=0.9581 corr_cb=-0.4625 topkJ=0.0000
[TRAIN][ep=050] loss=0.5322 acc=84.43%
[TRAIN][ep=050] mask_avg: mc_mean=0.0826 mb_mean=0.5015 norm_overlap=0.9613 corr_cb=-0.5035
[EPOCH 050/089] train: loss=0.5322 acc=84.43% | val: loss=0.5986 acc=73.49% f1=77.55% auc=81.05% val_score=55.2534 val_score_bestthr=74.5060 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.083, mb=0.501, no=0.961, corr=-0.504) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 74.5060
[DBG][ep=051] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.0777 mb_mean=0.5035 norm_overlap=0.9574 corr_cb=-0.5483 topkJ=0.0000
[TRAIN][ep=051] loss=0.5309 acc=85.10%
[TRAIN][ep=051] mask_avg: mc_mean=0.0826 mb_mean=0.5015 norm_overlap=0.9614 corr_cb=-0.5016
[EPOCH 051/089] train: loss=0.5309 acc=85.10% | val: loss=0.5819 acc=73.49% f1=77.08% auc=80.93% val_score=58.8580 val_score_bestthr=71.6560 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.083, mb=0.501, no=0.961, corr=-0.502) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 71.6560
[DBG][ep=052] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.1073 mb_mean=0.4999 norm_overlap=0.9610 corr_cb=-0.5240 topkJ=0.0000
[TRAIN][ep=052] loss=0.5271 acc=85.77%
[TRAIN][ep=052] mask_avg: mc_mean=0.0827 mb_mean=0.5014 norm_overlap=0.9614 corr_cb=-0.5032
[EPOCH 052/089] train: loss=0.5271 acc=85.77% | val: loss=0.5600 acc=74.70% f1=77.89% auc=80.99% val_score=61.9173 val_score_bestthr=73.9970 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.083, mb=0.501, no=0.961, corr=-0.503) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 73.9970
[DBG][ep=053] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.0754 mb_mean=0.5085 norm_overlap=0.9442 corr_cb=-0.5069 topkJ=0.0000
[TRAIN][ep=053] loss=0.5256 acc=84.83%
[TRAIN][ep=053] mask_avg: mc_mean=0.0826 mb_mean=0.5015 norm_overlap=0.9614 corr_cb=-0.5041
[EPOCH 053/089] train: loss=0.5256 acc=84.83% | val: loss=0.5597 acc=74.70% f1=77.89% auc=81.05% val_score=65.4883 val_score_bestthr=74.8086 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.083, mb=0.501, no=0.961, corr=-0.504) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 74.8086
[DBG][ep=054] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=054] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=054] mask(step0): mc_mean=0.0773 mb_mean=0.5047 norm_overlap=0.9557 corr_cb=-0.4907 topkJ=0.0000
[TRAIN][ep=054] loss=0.5270 acc=84.97%
[TRAIN][ep=054] mask_avg: mc_mean=0.0827 mb_mean=0.5014 norm_overlap=0.9612 corr_cb=-0.5044
[EPOCH 054/089] train: loss=0.5270 acc=84.97% | val: loss=0.5838 acc=72.29% f1=77.23% auc=80.76% val_score=58.4318 val_score_bestthr=72.0964 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.083, mb=0.501, no=0.961, corr=-0.504) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 72.0964
[DBG][ep=055] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=055] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=055] mask(step0): mc_mean=0.0760 mb_mean=0.5009 norm_overlap=0.9627 corr_cb=-0.5670 topkJ=0.0000
[TRAIN][ep=055] loss=0.5214 acc=85.10%
[TRAIN][ep=055] mask_avg: mc_mean=0.0827 mb_mean=0.5014 norm_overlap=0.9614 corr_cb=-0.5007
[EPOCH 055/089] train: loss=0.5214 acc=85.10% | val: loss=0.5892 acc=73.49% f1=77.55% auc=80.81% val_score=60.0004 val_score_bestthr=75.7234 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.083, mb=0.501, no=0.961, corr=-0.501) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 75.7234
[DBG][ep=056] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=056] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=056] mask(step0): mc_mean=0.0940 mb_mean=0.5009 norm_overlap=0.9633 corr_cb=-0.5244 topkJ=0.0000
[TRAIN][ep=056] loss=0.5171 acc=85.77%
[TRAIN][ep=056] mask_avg: mc_mean=0.0827 mb_mean=0.5014 norm_overlap=0.9612 corr_cb=-0.5059
[EPOCH 056/089] train: loss=0.5171 acc=85.77% | val: loss=0.5784 acc=72.29% f1=76.77% auc=80.93% val_score=67.7710 val_score_bestthr=74.6040 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.083, mb=0.501, no=0.961, corr=-0.506) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 74.6040
[DBG][ep=057] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=057] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=057] mask(step0): mc_mean=0.1182 mb_mean=0.4930 norm_overlap=0.9770 corr_cb=-0.5049 topkJ=0.0032
[TRAIN][ep=057] loss=0.5234 acc=85.64%
[TRAIN][ep=057] mask_avg: mc_mean=0.0826 mb_mean=0.5014 norm_overlap=0.9611 corr_cb=-0.5052
[EPOCH 057/089] train: loss=0.5234 acc=85.64% | val: loss=0.5764 acc=72.29% f1=76.77% auc=80.99% val_score=67.7710 val_score_bestthr=74.6040 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.083, mb=0.501, no=0.961, corr=-0.505) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 74.6040
[DBG][ep=058] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=058] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=058] mask(step0): mc_mean=0.1143 mb_mean=0.5023 norm_overlap=0.9611 corr_cb=-0.4971 topkJ=0.0000
[TRAIN][ep=058] loss=0.5201 acc=85.64%
[TRAIN][ep=058] mask_avg: mc_mean=0.0827 mb_mean=0.5014 norm_overlap=0.9613 corr_cb=-0.5038
[EPOCH 058/089] train: loss=0.5201 acc=85.64% | val: loss=0.5778 acc=72.29% f1=76.77% auc=80.81% val_score=67.7710 val_score_bestthr=74.6040 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.083, mb=0.501, no=0.961, corr=-0.504) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 74.6040
[DBG][ep=059] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=059] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=059] mask(step0): mc_mean=0.0786 mb_mean=0.5009 norm_overlap=0.9585 corr_cb=-0.5532 topkJ=0.0000
[TRAIN][ep=059] loss=0.5246 acc=84.70%
[TRAIN][ep=059] mask_avg: mc_mean=0.0826 mb_mean=0.5014 norm_overlap=0.9612 corr_cb=-0.5053
[EPOCH 059/089] train: loss=0.5246 acc=84.70% | val: loss=0.6038 acc=77.11% f1=76.54% auc=80.87% val_score=61.9411 val_score_bestthr=75.7177 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.083, mb=0.501, no=0.961, corr=-0.505) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 75.7177
[DBG][ep=060] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=060] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=060] mask(step0): mc_mean=0.0666 mb_mean=0.5029 norm_overlap=0.9620 corr_cb=-0.4730 topkJ=0.0000
[TRAIN][ep=060] loss=0.5174 acc=85.23%
[TRAIN][ep=060] mask_avg: mc_mean=0.0826 mb_mean=0.5015 norm_overlap=0.9612 corr_cb=-0.5043
[EPOCH 060/089] train: loss=0.5174 acc=85.23% | val: loss=0.6014 acc=77.11% f1=76.54% auc=80.87% val_score=59.5758 val_score_bestthr=75.7177 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.083, mb=0.501, no=0.961, corr=-0.504) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 75.7177
[DBG][ep=061] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=061] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=061] mask(step0): mc_mean=0.1495 mb_mean=0.4912 norm_overlap=0.9772 corr_cb=-0.4769 topkJ=0.0000
[TRAIN][ep=061] loss=0.5174 acc=84.97%
[TRAIN][ep=061] mask_avg: mc_mean=0.0826 mb_mean=0.5014 norm_overlap=0.9614 corr_cb=-0.5026
[EPOCH 061/089] train: loss=0.5174 acc=84.97% | val: loss=0.5897 acc=73.49% f1=77.55% auc=80.99% val_score=59.5758 val_score_bestthr=75.7234 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.083, mb=0.501, no=0.961, corr=-0.503) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 75.7234
[DBG][ep=062] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=062] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=062] mask(step0): mc_mean=0.0501 mb_mean=0.5065 norm_overlap=0.9580 corr_cb=-0.4842 topkJ=0.0000
[TRAIN][ep=062] loss=0.5166 acc=85.23%
[TRAIN][ep=062] mask_avg: mc_mean=0.0827 mb_mean=0.5014 norm_overlap=0.9614 corr_cb=-0.5049
[EPOCH 062/089] train: loss=0.5166 acc=85.23% | val: loss=0.5747 acc=72.29% f1=76.77% auc=81.05% val_score=65.4883 val_score_bestthr=74.6040 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.083, mb=0.501, no=0.961, corr=-0.505) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 74.6040
[DBG][ep=063] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=063] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=063] mask(step0): mc_mean=0.0801 mb_mean=0.4998 norm_overlap=0.9689 corr_cb=-0.4705 topkJ=0.0008
[TRAIN][ep=063] loss=0.5185 acc=84.97%
[TRAIN][ep=063] mask_avg: mc_mean=0.0826 mb_mean=0.5014 norm_overlap=0.9613 corr_cb=-0.5053
[EPOCH 063/089] train: loss=0.5185 acc=84.97% | val: loss=0.5852 acc=72.29% f1=76.77% auc=80.87% val_score=66.6278 val_score_bestthr=74.6040 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.083, mb=0.501, no=0.961, corr=-0.505) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 74.6040
[DBG][ep=064] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=064] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=064] mask(step0): mc_mean=0.0978 mb_mean=0.4966 norm_overlap=0.9755 corr_cb=-0.4683 topkJ=0.0039
[TRAIN][ep=064] loss=0.5121 acc=86.31%
[TRAIN][ep=064] mask_avg: mc_mean=0.0826 mb_mean=0.5014 norm_overlap=0.9612 corr_cb=-0.5041
[EPOCH 064/089] train: loss=0.5121 acc=86.31% | val: loss=0.5891 acc=72.29% f1=76.77% auc=80.70% val_score=59.3378 val_score_bestthr=74.6040 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.083, mb=0.501, no=0.961, corr=-0.504) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 74.6040
[DBG][ep=065] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=065] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=065] mask(step0): mc_mean=0.0774 mb_mean=0.5017 norm_overlap=0.9593 corr_cb=-0.5330 topkJ=0.0000
[TRAIN][ep=065] loss=0.5080 acc=85.64%
[TRAIN][ep=065] mask_avg: mc_mean=0.0826 mb_mean=0.5015 norm_overlap=0.9614 corr_cb=-0.5035
[EPOCH 065/089] train: loss=0.5080 acc=85.64% | val: loss=0.6367 acc=77.11% f1=76.54% auc=80.64% val_score=55.2534 val_score_bestthr=75.7177 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.083, mb=0.501, no=0.961, corr=-0.503) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 75.7177
[DBG][ep=066] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=066] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=066] mask(step0): mc_mean=0.0898 mb_mean=0.5007 norm_overlap=0.9652 corr_cb=-0.5468 topkJ=0.0000
[TRAIN][ep=066] loss=0.5093 acc=85.23%
[TRAIN][ep=066] mask_avg: mc_mean=0.0826 mb_mean=0.5015 norm_overlap=0.9611 corr_cb=-0.5064
[EPOCH 066/089] train: loss=0.5093 acc=85.23% | val: loss=0.5936 acc=72.29% f1=76.77% auc=80.99% val_score=57.2915 val_score_bestthr=74.6040 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.083, mb=0.501, no=0.961, corr=-0.506) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 74.6040
[DBG][ep=067] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=067] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=067] mask(step0): mc_mean=0.0812 mb_mean=0.5058 norm_overlap=0.9481 corr_cb=-0.5318 topkJ=0.0000
[TRAIN][ep=067] loss=0.5072 acc=85.91%
[TRAIN][ep=067] mask_avg: mc_mean=0.0827 mb_mean=0.5014 norm_overlap=0.9612 corr_cb=-0.5066
[EPOCH 067/089] train: loss=0.5072 acc=85.91% | val: loss=0.5867 acc=74.70% f1=77.89% auc=81.05% val_score=66.6278 val_score_bestthr=73.9970 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.083, mb=0.501, no=0.961, corr=-0.507) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 73.9970
[DBG][ep=068] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=068] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=068] mask(step0): mc_mean=0.0733 mb_mean=0.5032 norm_overlap=0.9608 corr_cb=-0.5252 topkJ=0.0008
[TRAIN][ep=068] loss=0.5041 acc=86.17%
[TRAIN][ep=068] mask_avg: mc_mean=0.0827 mb_mean=0.5014 norm_overlap=0.9612 corr_cb=-0.5038
[EPOCH 068/089] train: loss=0.5041 acc=86.17% | val: loss=0.6875 acc=77.11% f1=76.54% auc=80.29% val_score=56.8352 val_score_bestthr=75.7177 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.083, mb=0.501, no=0.961, corr=-0.504) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 75.7177
[DBG][ep=069] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=069] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=069] mask(step0): mc_mean=0.0989 mb_mean=0.5002 norm_overlap=0.9613 corr_cb=-0.5781 topkJ=0.0000
[TRAIN][ep=069] loss=0.5162 acc=84.97%
[TRAIN][ep=069] mask_avg: mc_mean=0.0826 mb_mean=0.5014 norm_overlap=0.9613 corr_cb=-0.5040
[EPOCH 069/089] train: loss=0.5162 acc=84.97% | val: loss=0.5801 acc=73.49% f1=77.55% auc=81.10% val_score=72.2198 val_score_bestthr=76.4190 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.083, mb=0.501, no=0.961, corr=-0.504) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 76.4190
[DBG][ep=070] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=070] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=070] mask(step0): mc_mean=0.0840 mb_mean=0.4982 norm_overlap=0.9704 corr_cb=-0.5041 topkJ=0.0000
[TRAIN][ep=070] loss=0.5074 acc=86.31%
[TRAIN][ep=070] mask_avg: mc_mean=0.0826 mb_mean=0.5014 norm_overlap=0.9613 corr_cb=-0.5038
[EPOCH 070/089] train: loss=0.5074 acc=86.31% | val: loss=0.5841 acc=72.29% f1=76.77% auc=80.93% val_score=65.1662 val_score_bestthr=74.6040 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.083, mb=0.501, no=0.961, corr=-0.504) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 74.6040
[DBG][ep=071] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=071] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=071] mask(step0): mc_mean=0.0954 mb_mean=0.4983 norm_overlap=0.9598 corr_cb=-0.5686 topkJ=0.0000
[TRAIN][ep=071] loss=0.5056 acc=85.64%
[TRAIN][ep=071] mask_avg: mc_mean=0.0826 mb_mean=0.5014 norm_overlap=0.9612 corr_cb=-0.5085
[EPOCH 071/089] train: loss=0.5056 acc=85.64% | val: loss=0.5946 acc=72.29% f1=76.77% auc=80.70% val_score=66.6278 val_score_bestthr=74.6040 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.083, mb=0.501, no=0.961, corr=-0.508) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 74.6040
[EARLY STOP] no improvement for 30 epochs. best_epoch=41
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
=============== FIT DONE ===============
[BEST] epoch=41 | val_acc=73.49% | val_f1=76.09% | val_auc=81.80% | val_score=62.1952 | val_score_bestthr=79.0251
[TEST@BEST] thr_used=0.185 | acc=59.42% f1=69.12% auc=64.38% | SP_sex=10.08% EO_sex=7.38% SP_age=11.48% EO_age=10.36%
[TIME] 1.74 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/summary_fold_0.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4752 mb_mean=0.5091 norm_overlap=0.9996 corr_cb=-0.4004 topkJ=0.0039
[TRAIN][ep=000] loss=0.6932 acc=51.14%
[TRAIN][ep=000] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1325
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4782 mb_mean=0.5028 norm_overlap=0.9999 corr_cb=-0.0933 topkJ=0.0031
[TRAIN][ep=001] loss=0.6927 acc=51.01%
[TRAIN][ep=001] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1283
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4776 mb_mean=0.5098 norm_overlap=0.9997 corr_cb=-0.3755 topkJ=0.0024
[TRAIN][ep=002] loss=0.6906 acc=53.42%
[TRAIN][ep=002] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1407
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4785 mb_mean=0.5037 norm_overlap=1.0000 corr_cb=0.0262 topkJ=0.0152
[TRAIN][ep=003] loss=0.6892 acc=55.84%
[TRAIN][ep=003] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1330
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4760 mb_mean=0.5053 norm_overlap=0.9998 corr_cb=-0.2618 topkJ=0.0459
[TRAIN][ep=004] loss=0.6879 acc=57.32%
[TRAIN][ep=004] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1247
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4794 mb_mean=0.5002 norm_overlap=0.9999 corr_cb=-0.2006 topkJ=0.0064
[TRAIN][ep=005] loss=0.6871 acc=54.09%
[TRAIN][ep=005] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1272
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4760 mb_mean=0.5040 norm_overlap=0.9997 corr_cb=-0.4011 topkJ=0.0113
[TRAIN][ep=006] loss=0.6832 acc=56.24%
[TRAIN][ep=006] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1302
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4758 mb_mean=0.5023 norm_overlap=0.9998 corr_cb=-0.2950 topkJ=0.0024
[TRAIN][ep=007] loss=0.6767 acc=59.19%
[TRAIN][ep=007] mask_avg: mc_mean=0.4785 mb_mean=0.5015 norm_overlap=0.9999 corr_cb=-0.1365
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4784 mb_mean=0.4987 norm_overlap=0.9997 corr_cb=-0.3532 topkJ=0.0048
[TRAIN][ep=008] loss=0.6721 acc=63.89%
[TRAIN][ep=008] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1238
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4781 mb_mean=0.5042 norm_overlap=0.9998 corr_cb=-0.2975 topkJ=0.0188
[TRAIN][ep=009] loss=0.6643 acc=62.55%
[TRAIN][ep=009] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1254
================= FIT START (fold=0) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4787 mb_mean=0.5043 norm_overlap=0.9999 corr_cb=-0.0822 topkJ=0.0502
[TRAIN][ep=000] loss=0.6583 acc=63.62%
[TRAIN][ep=000] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1201
[EPOCH 000/089] train: loss=0.6583 acc=63.62% | val: loss=0.6534 acc=67.47% f1=74.29% auc=71.74% val_score=55.4225 val_score_bestthr=63.3503 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.120) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 63.3503
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4793 mb_mean=0.5022 norm_overlap=0.9998 corr_cb=-0.2365 topkJ=0.0024
[TRAIN][ep=001] loss=0.6517 acc=64.43%
[TRAIN][ep=001] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1274
[EPOCH 001/089] train: loss=0.6517 acc=64.43% | val: loss=0.6599 acc=61.45% f1=72.41% auc=68.49% val_score=47.5336 val_score_bestthr=64.7777 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.127) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 63.3503 -> 64.7777
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4774 mb_mean=0.4982 norm_overlap=1.0000 corr_cb=-0.0324 topkJ=0.0252
[TRAIN][ep=002] loss=0.6471 acc=64.30%
[TRAIN][ep=002] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1182
[EPOCH 002/089] train: loss=0.6471 acc=64.30% | val: loss=0.6414 acc=68.67% f1=75.00% auc=72.44% val_score=47.9380 val_score_bestthr=63.1152 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.118) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.7777 -> 63.1152
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4776 mb_mean=0.5075 norm_overlap=0.9998 corr_cb=-0.2177 topkJ=0.0023
[TRAIN][ep=003] loss=0.6421 acc=64.43%
[TRAIN][ep=003] mask_avg: mc_mean=0.4785 mb_mean=0.5015 norm_overlap=0.9999 corr_cb=-0.1255
[EPOCH 003/089] train: loss=0.6421 acc=64.43% | val: loss=0.6608 acc=63.86% f1=73.68% auc=69.24% val_score=54.7539 val_score_bestthr=65.2221 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.125) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 64.7777 -> 65.2221
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4824 mb_mean=0.4950 norm_overlap=0.9998 corr_cb=-0.2211 topkJ=0.0294
[TRAIN][ep=004] loss=0.6475 acc=62.01%
[TRAIN][ep=004] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1284
[EPOCH 004/089] train: loss=0.6475 acc=62.01% | val: loss=0.6352 acc=69.88% f1=76.19% auc=73.08% val_score=46.9114 val_score_bestthr=64.6846 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.128) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 65.2221 -> 64.6846
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4744 mb_mean=0.5047 norm_overlap=0.9999 corr_cb=-0.0747 topkJ=0.0278
[TRAIN][ep=005] loss=1.4455 acc=65.10%
[TRAIN][ep=005] mask_avg: mc_mean=0.3462 mb_mean=0.5014 norm_overlap=0.9962 corr_cb=-0.6416
[EPOCH 005/089] train: loss=1.4455 acc=65.10% | val: loss=0.6518 acc=67.47% f1=69.66% auc=75.93% val_score=62.4643 val_score_bestthr=63.5118 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.346, mb=0.501, no=0.996, corr=-0.642) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.2221 -> 63.5118
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.1991 mb_mean=0.5118 norm_overlap=0.9864 corr_cb=-0.7996 topkJ=0.0000
[TRAIN][ep=006] loss=1.4195 acc=66.04%
[TRAIN][ep=006] mask_avg: mc_mean=0.1918 mb_mean=0.5014 norm_overlap=0.9886 corr_cb=-0.7193
[EPOCH 006/089] train: loss=1.4195 acc=66.04% | val: loss=0.6380 acc=61.45% f1=71.93% auc=76.51% val_score=65.9943 val_score_bestthr=60.9430 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.192, mb=0.501, no=0.989, corr=-0.719) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.2221 -> 60.9430
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.1514 mb_mean=0.5024 norm_overlap=0.9839 corr_cb=-0.7858 topkJ=0.0000
[TRAIN][ep=007] loss=1.4216 acc=62.68%
[TRAIN][ep=007] mask_avg: mc_mean=0.1242 mb_mean=0.5014 norm_overlap=0.9816 corr_cb=-0.7178
[EPOCH 007/089] train: loss=1.4216 acc=62.68% | val: loss=0.6283 acc=69.88% f1=75.73% auc=74.24% val_score=52.4552 val_score_bestthr=64.6321 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.124, mb=0.501, no=0.982, corr=-0.718) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.2221 -> 64.6321
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1089 mb_mean=0.5001 norm_overlap=0.9750 corr_cb=-0.7727 topkJ=0.0000
[TRAIN][ep=008] loss=1.4052 acc=67.25%
[TRAIN][ep=008] mask_avg: mc_mean=0.0808 mb_mean=0.5014 norm_overlap=0.9746 corr_cb=-0.6706
[EPOCH 008/089] train: loss=1.4052 acc=67.25% | val: loss=0.6343 acc=67.47% f1=75.23% auc=73.49% val_score=55.6753 val_score_bestthr=65.3678 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.081, mb=0.501, no=0.975, corr=-0.671) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 65.2221 -> 65.3678
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.0575 mb_mean=0.5043 norm_overlap=0.9721 corr_cb=-0.6647 topkJ=0.0000
[TRAIN][ep=009] loss=1.3843 acc=69.26%
[TRAIN][ep=009] mask_avg: mc_mean=0.0690 mb_mean=0.5014 norm_overlap=0.9703 corr_cb=-0.6310
[EPOCH 009/089] train: loss=1.3843 acc=69.26% | val: loss=0.6051 acc=67.47% f1=73.79% auc=75.64% val_score=49.7236 val_score_bestthr=64.0005 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.069, mb=0.501, no=0.970, corr=-0.631) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.3678 -> 64.0005
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.0846 mb_mean=0.4997 norm_overlap=0.9624 corr_cb=-0.6835 topkJ=0.0000
[TRAIN][ep=010] loss=0.9817 acc=68.05%
[TRAIN][ep=010] mask_avg: mc_mean=0.0694 mb_mean=0.5015 norm_overlap=0.9678 corr_cb=-0.6062
[EPOCH 010/089] train: loss=0.9817 acc=68.05% | val: loss=0.6028 acc=71.08% f1=65.71% auc=75.64% val_score=54.5243 val_score_bestthr=64.2616 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.069, mb=0.501, no=0.968, corr=-0.606) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.3678 -> 64.2616
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.0921 mb_mean=0.5016 norm_overlap=0.9549 corr_cb=-0.6483 topkJ=0.0000
[TRAIN][ep=011] loss=0.9217 acc=69.93%
[TRAIN][ep=011] mask_avg: mc_mean=0.0607 mb_mean=0.5015 norm_overlap=0.9642 corr_cb=-0.5714
[EPOCH 011/089] train: loss=0.9217 acc=69.93% | val: loss=0.5923 acc=71.08% f1=63.64% auc=75.93% val_score=47.9807 val_score_bestthr=64.4250 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.061, mb=0.501, no=0.964, corr=-0.571) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.3678 -> 64.4250
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.0356 mb_mean=0.5072 norm_overlap=0.9621 corr_cb=-0.5389 topkJ=0.0000
[TRAIN][ep=012] loss=0.9215 acc=68.99%
[TRAIN][ep=012] mask_avg: mc_mean=0.0576 mb_mean=0.5014 norm_overlap=0.9622 corr_cb=-0.5484
[EPOCH 012/089] train: loss=0.9215 acc=68.99% | val: loss=0.6284 acc=71.08% f1=64.71% auc=73.95% val_score=51.3437 val_score_bestthr=66.1865 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.058, mb=0.501, no=0.962, corr=-0.548) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 65.3678 -> 66.1865
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.0306 mb_mean=0.5080 norm_overlap=0.9533 corr_cb=-0.3692 topkJ=0.0000
[TRAIN][ep=013] loss=0.9088 acc=71.14%
[TRAIN][ep=013] mask_avg: mc_mean=0.0513 mb_mean=0.5015 norm_overlap=0.9594 corr_cb=-0.5252
[EPOCH 013/089] train: loss=0.9088 acc=71.14% | val: loss=0.5899 acc=72.29% f1=66.67% auc=75.52% val_score=59.7524 val_score_bestthr=66.6238 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.051, mb=0.501, no=0.959, corr=-0.525) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 66.1865 -> 66.6238
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.0575 mb_mean=0.4973 norm_overlap=0.9714 corr_cb=-0.4801 topkJ=0.0024
[TRAIN][ep=014] loss=0.9029 acc=71.41%
[TRAIN][ep=014] mask_avg: mc_mean=0.0516 mb_mean=0.5014 norm_overlap=0.9585 corr_cb=-0.5175
[EPOCH 014/089] train: loss=0.9029 acc=71.41% | val: loss=0.5835 acc=73.49% f1=68.57% auc=75.93% val_score=52.8036 val_score_bestthr=65.9223 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.052, mb=0.501, no=0.959, corr=-0.517) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6238 -> 65.9223
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.0309 mb_mean=0.5043 norm_overlap=0.9557 corr_cb=-0.4266 topkJ=0.0000
[TRAIN][ep=015] loss=0.8903 acc=72.35%
[TRAIN][ep=015] mask_avg: mc_mean=0.0548 mb_mean=0.5014 norm_overlap=0.9587 corr_cb=-0.5182
[EPOCH 015/089] train: loss=0.8903 acc=72.35% | val: loss=0.5739 acc=73.49% f1=68.57% auc=76.57% val_score=54.8728 val_score_bestthr=65.9223 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.055, mb=0.501, no=0.959, corr=-0.518) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6238 -> 65.9223
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.0356 mb_mean=0.5102 norm_overlap=0.9418 corr_cb=-0.5238 topkJ=0.0000
[TRAIN][ep=016] loss=0.8985 acc=71.68%
[TRAIN][ep=016] mask_avg: mc_mean=0.0468 mb_mean=0.5014 norm_overlap=0.9559 corr_cb=-0.4902
[EPOCH 016/089] train: loss=0.8985 acc=71.68% | val: loss=0.5747 acc=73.49% f1=68.57% auc=76.86% val_score=49.0913 val_score_bestthr=65.9223 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.047, mb=0.501, no=0.956, corr=-0.490) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6238 -> 65.9223
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.0576 mb_mean=0.4927 norm_overlap=0.9730 corr_cb=-0.4254 topkJ=0.0008
[TRAIN][ep=017] loss=0.8905 acc=71.14%
[TRAIN][ep=017] mask_avg: mc_mean=0.0424 mb_mean=0.5014 norm_overlap=0.9545 corr_cb=-0.4739
[EPOCH 017/089] train: loss=0.8905 acc=71.14% | val: loss=0.5797 acc=73.49% f1=68.57% auc=76.22% val_score=61.1980 val_score_bestthr=65.9223 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.042, mb=0.501, no=0.954, corr=-0.474) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6238 -> 65.9223
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.0488 mb_mean=0.5052 norm_overlap=0.9473 corr_cb=-0.5281 topkJ=0.0000
[TRAIN][ep=018] loss=0.8756 acc=72.62%
[TRAIN][ep=018] mask_avg: mc_mean=0.0582 mb_mean=0.5014 norm_overlap=0.9577 corr_cb=-0.5137
[EPOCH 018/089] train: loss=0.8756 acc=72.62% | val: loss=0.7130 acc=66.27% f1=74.07% auc=74.59% val_score=51.6446 val_score_bestthr=65.3762 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.058, mb=0.501, no=0.958, corr=-0.514) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6238 -> 65.3762
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.0366 mb_mean=0.4998 norm_overlap=0.9533 corr_cb=-0.4661 topkJ=0.0000
[TRAIN][ep=019] loss=0.9012 acc=70.20%
[TRAIN][ep=019] mask_avg: mc_mean=0.0390 mb_mean=0.5014 norm_overlap=0.9527 corr_cb=-0.4579
[EPOCH 019/089] train: loss=0.9012 acc=70.20% | val: loss=0.6262 acc=67.47% f1=74.77% auc=75.76% val_score=60.2367 val_score_bestthr=66.4819 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.039, mb=0.501, no=0.953, corr=-0.458) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6238 -> 66.4819
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.0766 mb_mean=0.4956 norm_overlap=0.9529 corr_cb=-0.5800 topkJ=0.0000
[TRAIN][ep=020] loss=0.8795 acc=72.75%
[TRAIN][ep=020] mask_avg: mc_mean=0.0453 mb_mean=0.5014 norm_overlap=0.9543 corr_cb=-0.4818
[EPOCH 020/089] train: loss=0.8795 acc=72.75% | val: loss=0.5857 acc=73.49% f1=68.57% auc=76.92% val_score=58.7307 val_score_bestthr=65.9223 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.045, mb=0.501, no=0.954, corr=-0.482) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6238 -> 65.9223
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.0427 mb_mean=0.5057 norm_overlap=0.9443 corr_cb=-0.4630 topkJ=0.0000
[TRAIN][ep=021] loss=0.8602 acc=73.83%
[TRAIN][ep=021] mask_avg: mc_mean=0.0619 mb_mean=0.5014 norm_overlap=0.9576 corr_cb=-0.5215
[EPOCH 021/089] train: loss=0.8602 acc=73.83% | val: loss=0.5902 acc=65.06% f1=73.39% auc=77.09% val_score=58.7307 val_score_bestthr=64.2759 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.062, mb=0.501, no=0.958, corr=-0.522) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6238 -> 64.2759
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.0781 mb_mean=0.4985 norm_overlap=0.9654 corr_cb=-0.4702 topkJ=0.0000
[TRAIN][ep=022] loss=0.8626 acc=74.09%
[TRAIN][ep=022] mask_avg: mc_mean=0.0574 mb_mean=0.5014 norm_overlap=0.9564 corr_cb=-0.5096
[EPOCH 022/089] train: loss=0.8626 acc=74.09% | val: loss=0.5492 acc=66.27% f1=75.00% auc=78.14% val_score=61.2877 val_score_bestthr=69.6680 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.057, mb=0.501, no=0.956, corr=-0.510) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 66.6238 -> 69.6680
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.0438 mb_mean=0.5003 norm_overlap=0.9547 corr_cb=-0.4495 topkJ=0.0000
[TRAIN][ep=023] loss=0.8681 acc=72.62%
[TRAIN][ep=023] mask_avg: mc_mean=0.0457 mb_mean=0.5015 norm_overlap=0.9534 corr_cb=-0.4761
[EPOCH 023/089] train: loss=0.8681 acc=72.62% | val: loss=0.5533 acc=74.70% f1=72.00% auc=78.08% val_score=57.8118 val_score_bestthr=65.3644 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.046, mb=0.501, no=0.953, corr=-0.476) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.6680 -> 65.3644
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.0456 mb_mean=0.5001 norm_overlap=0.9618 corr_cb=-0.3863 topkJ=0.0000
[TRAIN][ep=024] loss=0.8363 acc=75.97%
[TRAIN][ep=024] mask_avg: mc_mean=0.0529 mb_mean=0.5014 norm_overlap=0.9552 corr_cb=-0.4914
[EPOCH 024/089] train: loss=0.8363 acc=75.97% | val: loss=0.5555 acc=75.90% f1=74.36% auc=78.02% val_score=55.9897 val_score_bestthr=68.2337 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.053, mb=0.501, no=0.955, corr=-0.491) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.6680 -> 68.2337
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.0514 mb_mean=0.5013 norm_overlap=0.9564 corr_cb=-0.5427 topkJ=0.0000
[TRAIN][ep=025] loss=0.8548 acc=73.56%
[TRAIN][ep=025] mask_avg: mc_mean=0.0501 mb_mean=0.5014 norm_overlap=0.9541 corr_cb=-0.4819
[EPOCH 025/089] train: loss=0.8548 acc=73.56% | val: loss=0.5542 acc=72.29% f1=72.29% auc=77.21% val_score=64.9703 val_score_bestthr=66.3844 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.050, mb=0.501, no=0.954, corr=-0.482) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.6680 -> 66.3844
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.0378 mb_mean=0.5025 norm_overlap=0.9489 corr_cb=-0.5156 topkJ=0.0000
[TRAIN][ep=026] loss=0.8313 acc=74.77%
[TRAIN][ep=026] mask_avg: mc_mean=0.0572 mb_mean=0.5014 norm_overlap=0.9560 corr_cb=-0.5035
[EPOCH 026/089] train: loss=0.8313 acc=74.77% | val: loss=0.5759 acc=67.47% f1=75.68% auc=78.72% val_score=60.3976 val_score_bestthr=72.2930 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.057, mb=0.501, no=0.956, corr=-0.504) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 69.6680 -> 72.2930
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.0745 mb_mean=0.5001 norm_overlap=0.9518 corr_cb=-0.5837 topkJ=0.0000
[TRAIN][ep=027] loss=0.8282 acc=74.36%
[TRAIN][ep=027] mask_avg: mc_mean=0.0618 mb_mean=0.5014 norm_overlap=0.9569 corr_cb=-0.5118
[EPOCH 027/089] train: loss=0.8282 acc=74.36% | val: loss=0.6036 acc=72.29% f1=72.94% auc=77.38% val_score=58.7307 val_score_bestthr=69.2820 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.062, mb=0.501, no=0.957, corr=-0.512) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.2930 -> 69.2820
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.0696 mb_mean=0.4951 norm_overlap=0.9720 corr_cb=-0.4175 topkJ=0.0000
[TRAIN][ep=028] loss=0.8251 acc=74.63%
[TRAIN][ep=028] mask_avg: mc_mean=0.0602 mb_mean=0.5015 norm_overlap=0.9565 corr_cb=-0.5044
[EPOCH 028/089] train: loss=0.8251 acc=74.63% | val: loss=0.5529 acc=77.11% f1=76.54% auc=79.48% val_score=58.6883 val_score_bestthr=74.5003 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.060, mb=0.501, no=0.956, corr=-0.504) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 72.2930 -> 74.5003
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.0740 mb_mean=0.4980 norm_overlap=0.9636 corr_cb=-0.5063 topkJ=0.0000
[TRAIN][ep=029] loss=0.8072 acc=78.52%
[TRAIN][ep=029] mask_avg: mc_mean=0.0583 mb_mean=0.5015 norm_overlap=0.9561 corr_cb=-0.5034
[EPOCH 029/089] train: loss=0.8072 acc=78.52% | val: loss=0.5992 acc=68.67% f1=75.93% auc=79.94% val_score=71.5991 val_score_bestthr=71.5991 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.058, mb=0.501, no=0.956, corr=-0.503) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.5003 -> 71.5991
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.0828 mb_mean=0.4961 norm_overlap=0.9684 corr_cb=-0.5521 topkJ=0.0000
[TRAIN][ep=030] loss=0.8136 acc=74.63%
[TRAIN][ep=030] mask_avg: mc_mean=0.0622 mb_mean=0.5015 norm_overlap=0.9568 corr_cb=-0.5104
[EPOCH 030/089] train: loss=0.8136 acc=74.63% | val: loss=0.5409 acc=75.90% f1=75.61% auc=80.23% val_score=69.3263 val_score_bestthr=73.3583 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.062, mb=0.501, no=0.957, corr=-0.510) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.5003 -> 73.3583
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.0581 mb_mean=0.5019 norm_overlap=0.9604 corr_cb=-0.5138 topkJ=0.0000
[TRAIN][ep=031] loss=0.7929 acc=77.05%
[TRAIN][ep=031] mask_avg: mc_mean=0.0651 mb_mean=0.5015 norm_overlap=0.9574 corr_cb=-0.5155
[EPOCH 031/089] train: loss=0.7929 acc=77.05% | val: loss=0.5482 acc=75.90% f1=75.61% auc=79.48% val_score=63.4226 val_score_bestthr=73.9054 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.065, mb=0.501, no=0.957, corr=-0.515) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.5003 -> 73.9054
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.0596 mb_mean=0.4988 norm_overlap=0.9564 corr_cb=-0.5760 topkJ=0.0000
[TRAIN][ep=032] loss=0.8009 acc=77.99%
[TRAIN][ep=032] mask_avg: mc_mean=0.0670 mb_mean=0.5014 norm_overlap=0.9582 corr_cb=-0.5127
[EPOCH 032/089] train: loss=0.8009 acc=77.99% | val: loss=0.5513 acc=75.90% f1=75.00% auc=80.64% val_score=61.0484 val_score_bestthr=76.0656 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.067, mb=0.501, no=0.958, corr=-0.513) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 74.5003 -> 76.0656
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.0782 mb_mean=0.4952 norm_overlap=0.9705 corr_cb=-0.4891 topkJ=0.0004
[TRAIN][ep=033] loss=0.7812 acc=77.05%
[TRAIN][ep=033] mask_avg: mc_mean=0.0634 mb_mean=0.5014 norm_overlap=0.9575 corr_cb=-0.5006
[EPOCH 033/089] train: loss=0.7812 acc=77.05% | val: loss=0.5580 acc=74.70% f1=75.86% auc=80.06% val_score=54.5230 val_score_bestthr=76.0816 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.063, mb=0.501, no=0.958, corr=-0.501) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 76.0656 -> 76.0816
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.0873 mb_mean=0.5028 norm_overlap=0.9594 corr_cb=-0.6041 topkJ=0.0000
[TRAIN][ep=034] loss=0.7831 acc=75.97%
[TRAIN][ep=034] mask_avg: mc_mean=0.0789 mb_mean=0.5014 norm_overlap=0.9597 corr_cb=-0.5176
[EPOCH 034/089] train: loss=0.7831 acc=75.97% | val: loss=0.5369 acc=71.08% f1=73.91% auc=80.06% val_score=62.0977 val_score_bestthr=72.1808 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.079, mb=0.501, no=0.960, corr=-0.518) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.0816 -> 72.1808
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.0381 mb_mean=0.5037 norm_overlap=0.9556 corr_cb=-0.4428 topkJ=0.0000
[TRAIN][ep=035] loss=0.7717 acc=80.00%
[TRAIN][ep=035] mask_avg: mc_mean=0.0659 mb_mean=0.5014 norm_overlap=0.9580 corr_cb=-0.5041
[EPOCH 035/089] train: loss=0.7717 acc=80.00% | val: loss=0.5295 acc=75.90% f1=78.72% auc=81.80% val_score=57.5059 val_score_bestthr=75.1522 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.066, mb=0.501, no=0.958, corr=-0.504) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.0816 -> 75.1522
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.0692 mb_mean=0.4983 norm_overlap=0.9578 corr_cb=-0.5420 topkJ=0.0000
[TRAIN][ep=036] loss=0.7798 acc=77.99%
[TRAIN][ep=036] mask_avg: mc_mean=0.0730 mb_mean=0.5015 norm_overlap=0.9591 corr_cb=-0.5171
[EPOCH 036/089] train: loss=0.7798 acc=77.99% | val: loss=0.5621 acc=74.70% f1=78.35% auc=81.22% val_score=55.9281 val_score_bestthr=75.5517 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.073, mb=0.501, no=0.959, corr=-0.517) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.0816 -> 75.5517
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.0442 mb_mean=0.5046 norm_overlap=0.9511 corr_cb=-0.4953 topkJ=0.0000
[TRAIN][ep=037] loss=0.7675 acc=78.79%
[TRAIN][ep=037] mask_avg: mc_mean=0.0696 mb_mean=0.5014 norm_overlap=0.9585 corr_cb=-0.5085
[EPOCH 037/089] train: loss=0.7675 acc=78.79% | val: loss=0.5592 acc=73.49% f1=77.08% auc=81.63% val_score=55.0122 val_score_bestthr=74.7284 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.070, mb=0.501, no=0.959, corr=-0.509) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.0816 -> 74.7284
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.0756 mb_mean=0.4966 norm_overlap=0.9681 corr_cb=-0.5352 topkJ=0.0000
[TRAIN][ep=038] loss=0.7876 acc=76.91%
[TRAIN][ep=038] mask_avg: mc_mean=0.0417 mb_mean=0.5014 norm_overlap=0.9520 corr_cb=-0.4326
[EPOCH 038/089] train: loss=0.7876 acc=76.91% | val: loss=0.5295 acc=72.29% f1=74.73% auc=81.45% val_score=65.3839 val_score_bestthr=75.2466 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.042, mb=0.501, no=0.952, corr=-0.433) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.0816 -> 75.2466
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.0422 mb_mean=0.5081 norm_overlap=0.9450 corr_cb=-0.5064 topkJ=0.0000
[TRAIN][ep=039] loss=0.7415 acc=81.07%
[TRAIN][ep=039] mask_avg: mc_mean=0.0787 mb_mean=0.5015 norm_overlap=0.9602 corr_cb=-0.5229
[EPOCH 039/089] train: loss=0.7415 acc=81.07% | val: loss=0.5292 acc=75.90% f1=77.27% auc=82.09% val_score=69.8061 val_score_bestthr=76.2758 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.079, mb=0.501, no=0.960, corr=-0.523) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 76.0816 -> 76.2758
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.1029 mb_mean=0.5035 norm_overlap=0.9531 corr_cb=-0.6346 topkJ=0.0000
[TRAIN][ep=040] loss=0.7499 acc=79.33%
[TRAIN][ep=040] mask_avg: mc_mean=0.0755 mb_mean=0.5014 norm_overlap=0.9600 corr_cb=-0.5105
[EPOCH 040/089] train: loss=0.7499 acc=79.33% | val: loss=0.5544 acc=75.90% f1=75.61% auc=81.86% val_score=69.4162 val_score_bestthr=74.5177 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.076, mb=0.501, no=0.960, corr=-0.510) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.2758 -> 74.5177
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.0940 mb_mean=0.5010 norm_overlap=0.9558 corr_cb=-0.6081 topkJ=0.0000
[TRAIN][ep=041] loss=0.7561 acc=77.72%
[TRAIN][ep=041] mask_avg: mc_mean=0.0752 mb_mean=0.5014 norm_overlap=0.9597 corr_cb=-0.5079
[EPOCH 041/089] train: loss=0.7561 acc=77.72% | val: loss=0.5426 acc=74.70% f1=76.92% auc=82.27% val_score=66.4816 val_score_bestthr=78.4024 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.075, mb=0.501, no=0.960, corr=-0.508) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 76.2758 -> 78.4024
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.0833 mb_mean=0.4956 norm_overlap=0.9720 corr_cb=-0.4713 topkJ=0.0000
[TRAIN][ep=042] loss=0.7465 acc=80.40%
[TRAIN][ep=042] mask_avg: mc_mean=0.0808 mb_mean=0.5014 norm_overlap=0.9606 corr_cb=-0.5072
[EPOCH 042/089] train: loss=0.7465 acc=80.40% | val: loss=0.5232 acc=77.11% f1=78.65% auc=82.73% val_score=63.4263 val_score_bestthr=80.1185 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.507) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 78.4024 -> 80.1185
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.0392 mb_mean=0.4997 norm_overlap=0.9588 corr_cb=-0.4696 topkJ=0.0000
[TRAIN][ep=043] loss=0.8284 acc=77.72%
[TRAIN][ep=043] mask_avg: mc_mean=0.0680 mb_mean=0.5014 norm_overlap=0.9589 corr_cb=-0.4889
[EPOCH 043/089] train: loss=0.8284 acc=77.72% | val: loss=0.6741 acc=75.90% f1=78.26% auc=82.38% val_score=52.4567 val_score_bestthr=73.7124 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.068, mb=0.501, no=0.959, corr=-0.489) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 80.1185 -> 73.7124
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.0489 mb_mean=0.5072 norm_overlap=0.9496 corr_cb=-0.5126 topkJ=0.0000
[TRAIN][ep=044] loss=0.7282 acc=79.87%
[TRAIN][ep=044] mask_avg: mc_mean=0.0781 mb_mean=0.5015 norm_overlap=0.9605 corr_cb=-0.5100
[EPOCH 044/089] train: loss=0.7282 acc=79.87% | val: loss=0.5448 acc=74.70% f1=78.35% auc=82.44% val_score=67.0877 val_score_bestthr=74.3383 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.078, mb=0.501, no=0.961, corr=-0.510) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 80.1185 -> 74.3383
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.0819 mb_mean=0.4984 norm_overlap=0.9614 corr_cb=-0.4579 topkJ=0.0000
[TRAIN][ep=045] loss=0.7134 acc=82.01%
[TRAIN][ep=045] mask_avg: mc_mean=0.0843 mb_mean=0.5014 norm_overlap=0.9614 corr_cb=-0.5139
[EPOCH 045/089] train: loss=0.7134 acc=82.01% | val: loss=0.5640 acc=75.90% f1=79.17% auc=82.73% val_score=70.5913 val_score_bestthr=76.7960 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.084, mb=0.501, no=0.961, corr=-0.514) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 80.1185 -> 76.7960
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.1043 mb_mean=0.4955 norm_overlap=0.9702 corr_cb=-0.4978 topkJ=0.0000
[TRAIN][ep=046] loss=0.7888 acc=80.81%
[TRAIN][ep=046] mask_avg: mc_mean=0.0779 mb_mean=0.5015 norm_overlap=0.9600 corr_cb=-0.4993
[EPOCH 046/089] train: loss=0.7888 acc=80.81% | val: loss=0.6080 acc=79.52% f1=79.52% auc=82.27% val_score=55.9281 val_score_bestthr=74.9962 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.078, mb=0.501, no=0.960, corr=-0.499) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 80.1185 -> 74.9962
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.0789 mb_mean=0.5047 norm_overlap=0.9634 corr_cb=-0.5345 topkJ=0.0000
[TRAIN][ep=047] loss=0.7079 acc=80.54%
[TRAIN][ep=047] mask_avg: mc_mean=0.0897 mb_mean=0.5014 norm_overlap=0.9623 corr_cb=-0.5130
[EPOCH 047/089] train: loss=0.7079 acc=80.54% | val: loss=0.5614 acc=75.90% f1=80.00% auc=82.27% val_score=73.2165 val_score_bestthr=78.9398 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.090, mb=0.501, no=0.962, corr=-0.513) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 80.1185 -> 78.9398
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.0890 mb_mean=0.4955 norm_overlap=0.9675 corr_cb=-0.4921 topkJ=0.0000
[TRAIN][ep=048] loss=0.7258 acc=81.48%
[TRAIN][ep=048] mask_avg: mc_mean=0.0833 mb_mean=0.5014 norm_overlap=0.9612 corr_cb=-0.5059
[EPOCH 048/089] train: loss=0.7258 acc=81.48% | val: loss=0.5395 acc=75.90% f1=79.17% auc=82.21% val_score=70.4671 val_score_bestthr=73.3088 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.083, mb=0.501, no=0.961, corr=-0.506) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 80.1185 -> 73.3088
[DBG][ep=049] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.0479 mb_mean=0.5049 norm_overlap=0.9569 corr_cb=-0.4744 topkJ=0.0000
[TRAIN][ep=049] loss=0.6977 acc=81.34%
[TRAIN][ep=049] mask_avg: mc_mean=0.0771 mb_mean=0.5014 norm_overlap=0.9604 corr_cb=-0.4964
[EPOCH 049/089] train: loss=0.6977 acc=81.34% | val: loss=0.6216 acc=75.90% f1=78.72% auc=81.86% val_score=55.0122 val_score_bestthr=73.3732 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.077, mb=0.501, no=0.960, corr=-0.496) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 80.1185 -> 73.3732
[DBG][ep=050] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.0744 mb_mean=0.5029 norm_overlap=0.9582 corr_cb=-0.4643 topkJ=0.0000
[TRAIN][ep=050] loss=0.6648 acc=84.43%
[TRAIN][ep=050] mask_avg: mc_mean=0.0830 mb_mean=0.5015 norm_overlap=0.9613 corr_cb=-0.5048
[EPOCH 050/089] train: loss=0.6648 acc=84.43% | val: loss=0.5903 acc=75.90% f1=79.17% auc=81.92% val_score=53.6990 val_score_bestthr=77.9696 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.083, mb=0.501, no=0.961, corr=-0.505) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 80.1185 -> 77.9696
[DBG][ep=051] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.0783 mb_mean=0.5035 norm_overlap=0.9576 corr_cb=-0.5484 topkJ=0.0000
[TRAIN][ep=051] loss=0.6632 acc=84.56%
[TRAIN][ep=051] mask_avg: mc_mean=0.0830 mb_mean=0.5015 norm_overlap=0.9615 corr_cb=-0.5029
[EPOCH 051/089] train: loss=0.6632 acc=84.56% | val: loss=0.5724 acc=74.70% f1=77.89% auc=81.86% val_score=58.8580 val_score_bestthr=73.9970 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.083, mb=0.501, no=0.962, corr=-0.503) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 80.1185 -> 73.9970
[DBG][ep=052] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.1074 mb_mean=0.4999 norm_overlap=0.9612 corr_cb=-0.5225 topkJ=0.0000
[TRAIN][ep=052] loss=0.6593 acc=85.77%
[TRAIN][ep=052] mask_avg: mc_mean=0.0831 mb_mean=0.5014 norm_overlap=0.9615 corr_cb=-0.5045
[EPOCH 052/089] train: loss=0.6593 acc=85.77% | val: loss=0.5513 acc=74.70% f1=77.89% auc=81.92% val_score=72.0102 val_score_bestthr=74.8086 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.083, mb=0.501, no=0.961, corr=-0.505) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 80.1185 -> 74.8086
[DBG][ep=053] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.0758 mb_mean=0.5085 norm_overlap=0.9442 corr_cb=-0.5090 topkJ=0.0000
[TRAIN][ep=053] loss=0.6575 acc=84.30%
[TRAIN][ep=053] mask_avg: mc_mean=0.0830 mb_mean=0.5015 norm_overlap=0.9614 corr_cb=-0.5055
[EPOCH 053/089] train: loss=0.6575 acc=84.30% | val: loss=0.5506 acc=73.49% f1=77.55% auc=81.98% val_score=70.6966 val_score_bestthr=76.4190 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.083, mb=0.501, no=0.961, corr=-0.505) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 80.1185 -> 76.4190
[DBG][ep=054] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=054] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=054] mask(step0): mc_mean=0.0777 mb_mean=0.5047 norm_overlap=0.9556 corr_cb=-0.4930 topkJ=0.0000
[TRAIN][ep=054] loss=0.6588 acc=84.97%
[TRAIN][ep=054] mask_avg: mc_mean=0.0831 mb_mean=0.5014 norm_overlap=0.9613 corr_cb=-0.5058
[EPOCH 054/089] train: loss=0.6588 acc=84.97% | val: loss=0.5734 acc=73.49% f1=77.08% auc=81.57% val_score=58.8580 val_score_bestthr=72.8734 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.083, mb=0.501, no=0.961, corr=-0.506) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 80.1185 -> 72.8734
[DBG][ep=055] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=055] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=055] mask(step0): mc_mean=0.0767 mb_mean=0.5009 norm_overlap=0.9628 corr_cb=-0.5697 topkJ=0.0000
[TRAIN][ep=055] loss=0.6536 acc=85.23%
[TRAIN][ep=055] mask_avg: mc_mean=0.0832 mb_mean=0.5014 norm_overlap=0.9615 corr_cb=-0.5021
[EPOCH 055/089] train: loss=0.6536 acc=85.23% | val: loss=0.5804 acc=73.49% f1=77.55% auc=81.51% val_score=58.8580 val_score_bestthr=75.7234 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.083, mb=0.501, no=0.961, corr=-0.502) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 80.1185 -> 75.7234
[DBG][ep=056] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=056] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=056] mask(step0): mc_mean=0.0943 mb_mean=0.5009 norm_overlap=0.9633 corr_cb=-0.5260 topkJ=0.0000
[TRAIN][ep=056] loss=0.6489 acc=85.10%
[TRAIN][ep=056] mask_avg: mc_mean=0.0831 mb_mean=0.5014 norm_overlap=0.9613 corr_cb=-0.5072
[EPOCH 056/089] train: loss=0.6489 acc=85.10% | val: loss=0.5675 acc=73.49% f1=77.55% auc=81.63% val_score=67.7710 val_score_bestthr=75.7234 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.083, mb=0.501, no=0.961, corr=-0.507) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 80.1185 -> 75.7234
[DBG][ep=057] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=057] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=057] mask(step0): mc_mean=0.1191 mb_mean=0.4930 norm_overlap=0.9771 corr_cb=-0.5049 topkJ=0.0032
[TRAIN][ep=057] loss=0.6551 acc=85.37%
[TRAIN][ep=057] mask_avg: mc_mean=0.0830 mb_mean=0.5014 norm_overlap=0.9612 corr_cb=-0.5065
[EPOCH 057/089] train: loss=0.6551 acc=85.37% | val: loss=0.5663 acc=73.49% f1=77.55% auc=81.69% val_score=67.7710 val_score_bestthr=75.7234 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.083, mb=0.501, no=0.961, corr=-0.506) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 80.1185 -> 75.7234
[DBG][ep=058] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=058] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=058] mask(step0): mc_mean=0.1153 mb_mean=0.5023 norm_overlap=0.9610 corr_cb=-0.5013 topkJ=0.0000
[TRAIN][ep=058] loss=0.6521 acc=85.23%
[TRAIN][ep=058] mask_avg: mc_mean=0.0831 mb_mean=0.5014 norm_overlap=0.9614 corr_cb=-0.5052
[EPOCH 058/089] train: loss=0.6521 acc=85.23% | val: loss=0.5652 acc=72.29% f1=76.77% auc=81.69% val_score=67.7710 val_score_bestthr=74.6040 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.083, mb=0.501, no=0.961, corr=-0.505) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 80.1185 -> 74.6040
[DBG][ep=059] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=059] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=059] mask(step0): mc_mean=0.0790 mb_mean=0.5009 norm_overlap=0.9585 corr_cb=-0.5562 topkJ=0.0000
[TRAIN][ep=059] loss=0.6563 acc=84.70%
[TRAIN][ep=059] mask_avg: mc_mean=0.0830 mb_mean=0.5014 norm_overlap=0.9613 corr_cb=-0.5066
[EPOCH 059/089] train: loss=0.6563 acc=84.70% | val: loss=0.5893 acc=77.11% f1=76.54% auc=81.63% val_score=60.7932 val_score_bestthr=75.7177 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.083, mb=0.501, no=0.961, corr=-0.507) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 80.1185 -> 75.7177
[DBG][ep=060] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=060] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=060] mask(step0): mc_mean=0.0670 mb_mean=0.5029 norm_overlap=0.9622 corr_cb=-0.4730 topkJ=0.0000
[TRAIN][ep=060] loss=0.6489 acc=85.50%
[TRAIN][ep=060] mask_avg: mc_mean=0.0830 mb_mean=0.5015 norm_overlap=0.9613 corr_cb=-0.5056
[EPOCH 060/089] train: loss=0.6489 acc=85.50% | val: loss=0.5850 acc=77.11% f1=77.11% auc=81.63% val_score=58.4318 val_score_bestthr=74.6020 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.083, mb=0.501, no=0.961, corr=-0.506) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 80.1185 -> 74.6020
[DBG][ep=061] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=061] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=061] mask(step0): mc_mean=0.1501 mb_mean=0.4912 norm_overlap=0.9772 corr_cb=-0.4791 topkJ=0.0000
[TRAIN][ep=061] loss=0.6484 acc=84.56%
[TRAIN][ep=061] mask_avg: mc_mean=0.0831 mb_mean=0.5014 norm_overlap=0.9615 corr_cb=-0.5039
[EPOCH 061/089] train: loss=0.6484 acc=84.56% | val: loss=0.5761 acc=73.49% f1=77.55% auc=81.80% val_score=58.4318 val_score_bestthr=75.7234 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.083, mb=0.501, no=0.961, corr=-0.504) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 80.1185 -> 75.7234
[DBG][ep=062] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=062] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=062] mask(step0): mc_mean=0.0502 mb_mean=0.5065 norm_overlap=0.9581 corr_cb=-0.4851 topkJ=0.0000
[TRAIN][ep=062] loss=0.6480 acc=85.10%
[TRAIN][ep=062] mask_avg: mc_mean=0.0831 mb_mean=0.5014 norm_overlap=0.9615 corr_cb=-0.5063
[EPOCH 062/089] train: loss=0.6480 acc=85.10% | val: loss=0.5631 acc=73.49% f1=77.55% auc=81.69% val_score=72.2198 val_score_bestthr=76.4190 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.083, mb=0.501, no=0.961, corr=-0.506) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 80.1185 -> 76.4190
[DBG][ep=063] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=063] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=063] mask(step0): mc_mean=0.0806 mb_mean=0.4998 norm_overlap=0.9691 corr_cb=-0.4716 topkJ=0.0008
[TRAIN][ep=063] loss=0.6497 acc=85.10%
[TRAIN][ep=063] mask_avg: mc_mean=0.0831 mb_mean=0.5014 norm_overlap=0.9614 corr_cb=-0.5067
[EPOCH 063/089] train: loss=0.6497 acc=85.10% | val: loss=0.5718 acc=74.70% f1=77.89% auc=81.63% val_score=66.6278 val_score_bestthr=74.8086 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.083, mb=0.501, no=0.961, corr=-0.507) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 80.1185 -> 74.8086
[DBG][ep=064] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=064] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=064] mask(step0): mc_mean=0.0981 mb_mean=0.4966 norm_overlap=0.9755 corr_cb=-0.4709 topkJ=0.0039
[TRAIN][ep=064] loss=0.6435 acc=86.58%
[TRAIN][ep=064] mask_avg: mc_mean=0.0831 mb_mean=0.5014 norm_overlap=0.9612 corr_cb=-0.5055
[EPOCH 064/089] train: loss=0.6435 acc=86.58% | val: loss=0.5758 acc=75.90% f1=78.72% auc=81.45% val_score=59.3378 val_score_bestthr=75.9348 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.083, mb=0.501, no=0.961, corr=-0.505) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 80.1185 -> 75.9348
[DBG][ep=065] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=065] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=065] mask(step0): mc_mean=0.0781 mb_mean=0.5017 norm_overlap=0.9593 corr_cb=-0.5352 topkJ=0.0000
[TRAIN][ep=065] loss=0.6392 acc=84.97%
[TRAIN][ep=065] mask_avg: mc_mean=0.0830 mb_mean=0.5015 norm_overlap=0.9614 corr_cb=-0.5048
[EPOCH 065/089] train: loss=0.6392 acc=84.97% | val: loss=0.6190 acc=77.11% f1=76.54% auc=81.05% val_score=55.2534 val_score_bestthr=75.7177 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.083, mb=0.501, no=0.961, corr=-0.505) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 80.1185 -> 75.7177
[DBG][ep=066] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=066] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=066] mask(step0): mc_mean=0.0906 mb_mean=0.5007 norm_overlap=0.9654 corr_cb=-0.5472 topkJ=0.0000
[TRAIN][ep=066] loss=0.6404 acc=85.23%
[TRAIN][ep=066] mask_avg: mc_mean=0.0830 mb_mean=0.5015 norm_overlap=0.9612 corr_cb=-0.5077
[EPOCH 066/089] train: loss=0.6404 acc=85.23% | val: loss=0.5810 acc=74.70% f1=77.89% auc=81.57% val_score=60.4796 val_score_bestthr=74.8086 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.083, mb=0.501, no=0.961, corr=-0.508) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 80.1185 -> 74.8086
[DBG][ep=067] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=067] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=067] mask(step0): mc_mean=0.0818 mb_mean=0.5058 norm_overlap=0.9483 corr_cb=-0.5329 topkJ=0.0000
[TRAIN][ep=067] loss=0.6380 acc=85.37%
[TRAIN][ep=067] mask_avg: mc_mean=0.0831 mb_mean=0.5014 norm_overlap=0.9613 corr_cb=-0.5080
[EPOCH 067/089] train: loss=0.6380 acc=85.37% | val: loss=0.5741 acc=75.90% f1=78.72% auc=81.57% val_score=71.6845 val_score_bestthr=75.9348 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.083, mb=0.501, no=0.961, corr=-0.508) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 80.1185 -> 75.9348
[DBG][ep=068] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=068] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=068] mask(step0): mc_mean=0.0736 mb_mean=0.5032 norm_overlap=0.9610 corr_cb=-0.5271 topkJ=0.0008
[TRAIN][ep=068] loss=0.6350 acc=85.64%
[TRAIN][ep=068] mask_avg: mc_mean=0.0832 mb_mean=0.5014 norm_overlap=0.9613 corr_cb=-0.5050
[EPOCH 068/089] train: loss=0.6350 acc=85.64% | val: loss=0.6701 acc=74.70% f1=77.89% auc=80.76% val_score=57.7340 val_score_bestthr=73.9970 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.083, mb=0.501, no=0.961, corr=-0.505) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 80.1185 -> 73.9970
[DBG][ep=069] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=069] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=069] mask(step0): mc_mean=0.0986 mb_mean=0.5002 norm_overlap=0.9613 corr_cb=-0.5783 topkJ=0.0000
[TRAIN][ep=069] loss=0.6466 acc=84.83%
[TRAIN][ep=069] mask_avg: mc_mean=0.0830 mb_mean=0.5014 norm_overlap=0.9614 corr_cb=-0.5053
[EPOCH 069/089] train: loss=0.6466 acc=84.83% | val: loss=0.5687 acc=73.49% f1=77.55% auc=81.63% val_score=73.2884 val_score_bestthr=76.4190 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.083, mb=0.501, no=0.961, corr=-0.505) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 80.1185 -> 76.4190
[DBG][ep=070] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=070] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=070] mask(step0): mc_mean=0.0844 mb_mean=0.4982 norm_overlap=0.9704 corr_cb=-0.5072 topkJ=0.0000
[TRAIN][ep=070] loss=0.6375 acc=86.71%
[TRAIN][ep=070] mask_avg: mc_mean=0.0830 mb_mean=0.5014 norm_overlap=0.9614 corr_cb=-0.5052
[EPOCH 070/089] train: loss=0.6375 acc=86.71% | val: loss=0.5719 acc=74.70% f1=77.89% auc=81.69% val_score=72.2198 val_score_bestthr=74.8086 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.083, mb=0.501, no=0.961, corr=-0.505) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 80.1185 -> 74.8086
[DBG][ep=071] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=071] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=071] mask(step0): mc_mean=0.0961 mb_mean=0.4983 norm_overlap=0.9600 corr_cb=-0.5693 topkJ=0.0000
[TRAIN][ep=071] loss=0.6357 acc=85.77%
[TRAIN][ep=071] mask_avg: mc_mean=0.0830 mb_mean=0.5014 norm_overlap=0.9613 corr_cb=-0.5098
[EPOCH 071/089] train: loss=0.6357 acc=85.77% | val: loss=0.5819 acc=74.70% f1=77.89% auc=81.40% val_score=69.3263 val_score_bestthr=74.8086 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.083, mb=0.501, no=0.961, corr=-0.510) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 80.1185 -> 74.8086
[DBG][ep=072] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=072] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=072] mask(step0): mc_mean=0.0573 mb_mean=0.5071 norm_overlap=0.9552 corr_cb=-0.4963 topkJ=0.0000
[TRAIN][ep=072] loss=0.6328 acc=86.71%
[TRAIN][ep=072] mask_avg: mc_mean=0.0831 mb_mean=0.5015 norm_overlap=0.9613 corr_cb=-0.5057
[EPOCH 072/089] train: loss=0.6328 acc=86.71% | val: loss=0.5979 acc=74.70% f1=77.89% auc=81.22% val_score=58.4318 val_score_bestthr=74.8086 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.083, mb=0.501, no=0.961, corr=-0.506) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 80.1185 -> 74.8086
[EARLY STOP] no improvement for 30 epochs. best_epoch=42
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
=============== FIT DONE ===============
[BEST] epoch=42 | val_acc=77.11% | val_f1=78.65% | val_auc=82.73% | val_score=63.4263 | val_score_bestthr=80.1185
[TEST@BEST] thr_used=0.330 | acc=58.45% f1=67.67% auc=64.18% | SP_sex=10.13% EO_sex=5.57% SP_age=13.37% EO_age=8.22%
[TIME] 1.79 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/summary_fold_0.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4752 mb_mean=0.5091 norm_overlap=0.9996 corr_cb=-0.4004 topkJ=0.0039
[TRAIN][ep=000] loss=0.6932 acc=51.14%
[TRAIN][ep=000] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1325
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4782 mb_mean=0.5028 norm_overlap=0.9999 corr_cb=-0.0933 topkJ=0.0031
[TRAIN][ep=001] loss=0.6927 acc=51.01%
[TRAIN][ep=001] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1283
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4776 mb_mean=0.5098 norm_overlap=0.9997 corr_cb=-0.3755 topkJ=0.0024
[TRAIN][ep=002] loss=0.6906 acc=53.42%
[TRAIN][ep=002] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1407
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4785 mb_mean=0.5037 norm_overlap=1.0000 corr_cb=0.0262 topkJ=0.0152
[TRAIN][ep=003] loss=0.6892 acc=55.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1330
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4760 mb_mean=0.5053 norm_overlap=0.9998 corr_cb=-0.2618 topkJ=0.0459
[TRAIN][ep=004] loss=0.6879 acc=57.32%
[TRAIN][ep=004] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1247
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4794 mb_mean=0.5002 norm_overlap=0.9999 corr_cb=-0.2006 topkJ=0.0064
[TRAIN][ep=005] loss=0.6870 acc=54.09%
[TRAIN][ep=005] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1272
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4760 mb_mean=0.5040 norm_overlap=0.9997 corr_cb=-0.4011 topkJ=0.0113
[TRAIN][ep=006] loss=0.6832 acc=56.38%
[TRAIN][ep=006] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1302
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4758 mb_mean=0.5023 norm_overlap=0.9998 corr_cb=-0.2950 topkJ=0.0024
[TRAIN][ep=007] loss=0.6767 acc=59.19%
[TRAIN][ep=007] mask_avg: mc_mean=0.4785 mb_mean=0.5015 norm_overlap=0.9999 corr_cb=-0.1365
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4784 mb_mean=0.4987 norm_overlap=0.9997 corr_cb=-0.3532 topkJ=0.0048
[TRAIN][ep=008] loss=0.6721 acc=63.89%
[TRAIN][ep=008] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1238
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4781 mb_mean=0.5042 norm_overlap=0.9998 corr_cb=-0.2975 topkJ=0.0188
[TRAIN][ep=009] loss=0.6643 acc=62.55%
[TRAIN][ep=009] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1254
================= FIT START (fold=0) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4787 mb_mean=0.5043 norm_overlap=0.9999 corr_cb=-0.0822 topkJ=0.0502
[TRAIN][ep=000] loss=0.6583 acc=63.49%
[TRAIN][ep=000] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1201
[EPOCH 000/089] train: loss=0.6583 acc=63.49% | val: loss=0.6535 acc=67.47% f1=74.29% auc=71.74% val_score=55.1146 val_score_bestthr=63.3503 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.120) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 63.3503
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4793 mb_mean=0.5022 norm_overlap=0.9998 corr_cb=-0.2365 topkJ=0.0024
[TRAIN][ep=001] loss=0.6518 acc=64.43%
[TRAIN][ep=001] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1274
[EPOCH 001/089] train: loss=0.6518 acc=64.43% | val: loss=0.6600 acc=61.45% f1=72.41% auc=68.49% val_score=47.5336 val_score_bestthr=64.7777 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.127) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 63.3503 -> 64.7777
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4774 mb_mean=0.4982 norm_overlap=1.0000 corr_cb=-0.0324 topkJ=0.0252
[TRAIN][ep=002] loss=0.6472 acc=64.30%
[TRAIN][ep=002] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1182
[EPOCH 002/089] train: loss=0.6472 acc=64.30% | val: loss=0.6414 acc=68.67% f1=75.00% auc=72.38% val_score=47.9380 val_score_bestthr=63.1152 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.118) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.7777 -> 63.1152
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4776 mb_mean=0.5075 norm_overlap=0.9998 corr_cb=-0.2177 topkJ=0.0023
[TRAIN][ep=003] loss=0.6422 acc=64.43%
[TRAIN][ep=003] mask_avg: mc_mean=0.4785 mb_mean=0.5015 norm_overlap=0.9999 corr_cb=-0.1255
[EPOCH 003/089] train: loss=0.6422 acc=64.43% | val: loss=0.6609 acc=63.86% f1=73.68% auc=69.24% val_score=54.7539 val_score_bestthr=65.2221 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.125) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 64.7777 -> 65.2221
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4824 mb_mean=0.4950 norm_overlap=0.9998 corr_cb=-0.2211 topkJ=0.0294
[TRAIN][ep=004] loss=0.6475 acc=62.01%
[TRAIN][ep=004] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1284
[EPOCH 004/089] train: loss=0.6475 acc=62.01% | val: loss=0.6353 acc=69.88% f1=76.19% auc=73.08% val_score=46.9114 val_score_bestthr=64.6846 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.128) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 65.2221 -> 64.6846
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4744 mb_mean=0.5047 norm_overlap=0.9999 corr_cb=-0.0747 topkJ=0.0278
[TRAIN][ep=005] loss=1.2404 acc=65.23%
[TRAIN][ep=005] mask_avg: mc_mean=0.3461 mb_mean=0.5014 norm_overlap=0.9962 corr_cb=-0.6416
[EPOCH 005/089] train: loss=1.2404 acc=65.23% | val: loss=0.6518 acc=67.47% f1=69.66% auc=75.76% val_score=62.4643 val_score_bestthr=63.5118 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.346, mb=0.501, no=0.996, corr=-0.642) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.2221 -> 63.5118
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.1990 mb_mean=0.5118 norm_overlap=0.9864 corr_cb=-0.7996 topkJ=0.0000
[TRAIN][ep=006] loss=1.2203 acc=65.91%
[TRAIN][ep=006] mask_avg: mc_mean=0.1919 mb_mean=0.5014 norm_overlap=0.9886 corr_cb=-0.7195
[EPOCH 006/089] train: loss=1.2203 acc=65.91% | val: loss=0.6373 acc=69.88% f1=66.67% auc=76.69% val_score=62.4655 val_score_bestthr=62.2202 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.192, mb=0.501, no=0.989, corr=-0.720) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.2221 -> 62.2202
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.1515 mb_mean=0.5024 norm_overlap=0.9839 corr_cb=-0.7860 topkJ=0.0000
[TRAIN][ep=007] loss=1.2232 acc=62.82%
[TRAIN][ep=007] mask_avg: mc_mean=0.1240 mb_mean=0.5014 norm_overlap=0.9815 corr_cb=-0.7178
[EPOCH 007/089] train: loss=1.2232 acc=62.82% | val: loss=0.6281 acc=67.47% f1=73.79% auc=74.24% val_score=52.4552 val_score_bestthr=64.0005 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.124, mb=0.501, no=0.982, corr=-0.718) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.2221 -> 64.0005
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1085 mb_mean=0.5001 norm_overlap=0.9749 corr_cb=-0.7726 topkJ=0.0000
[TRAIN][ep=008] loss=1.2073 acc=67.38%
[TRAIN][ep=008] mask_avg: mc_mean=0.0804 mb_mean=0.5014 norm_overlap=0.9745 corr_cb=-0.6696
[EPOCH 008/089] train: loss=1.2073 acc=67.38% | val: loss=0.6344 acc=67.47% f1=75.23% auc=73.49% val_score=61.5991 val_score_bestthr=65.3678 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.080, mb=0.501, no=0.974, corr=-0.670) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 65.2221 -> 65.3678
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.0573 mb_mean=0.5043 norm_overlap=0.9721 corr_cb=-0.6638 topkJ=0.0000
[TRAIN][ep=009] loss=1.1866 acc=69.13%
[TRAIN][ep=009] mask_avg: mc_mean=0.0690 mb_mean=0.5014 norm_overlap=0.9703 corr_cb=-0.6306
[EPOCH 009/089] train: loss=1.1866 acc=69.13% | val: loss=0.6051 acc=67.47% f1=73.79% auc=75.76% val_score=55.2432 val_score_bestthr=64.0005 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.069, mb=0.501, no=0.970, corr=-0.631) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.3678 -> 64.0005
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.0847 mb_mean=0.4997 norm_overlap=0.9624 corr_cb=-0.6831 topkJ=0.0000
[TRAIN][ep=010] loss=0.7841 acc=67.52%
[TRAIN][ep=010] mask_avg: mc_mean=0.0698 mb_mean=0.5015 norm_overlap=0.9678 corr_cb=-0.6061
[EPOCH 010/089] train: loss=0.7841 acc=67.52% | val: loss=0.6024 acc=71.08% f1=65.71% auc=75.52% val_score=54.5243 val_score_bestthr=64.2616 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.070, mb=0.501, no=0.968, corr=-0.606) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.3678 -> 64.2616
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.0926 mb_mean=0.5016 norm_overlap=0.9550 corr_cb=-0.6483 topkJ=0.0000
[TRAIN][ep=011] loss=0.7246 acc=69.66%
[TRAIN][ep=011] mask_avg: mc_mean=0.0611 mb_mean=0.5015 norm_overlap=0.9643 corr_cb=-0.5716
[EPOCH 011/089] train: loss=0.7246 acc=69.66% | val: loss=0.5923 acc=73.49% f1=69.44% auc=76.16% val_score=47.9807 val_score_bestthr=65.6306 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.061, mb=0.501, no=0.964, corr=-0.572) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 65.3678 -> 65.6306
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.0360 mb_mean=0.5072 norm_overlap=0.9622 corr_cb=-0.5398 topkJ=0.0000
[TRAIN][ep=012] loss=0.7250 acc=68.99%
[TRAIN][ep=012] mask_avg: mc_mean=0.0582 mb_mean=0.5014 norm_overlap=0.9623 corr_cb=-0.5491
[EPOCH 012/089] train: loss=0.7250 acc=68.99% | val: loss=0.6280 acc=71.08% f1=64.71% auc=74.19% val_score=51.3437 val_score_bestthr=66.1865 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.058, mb=0.501, no=0.962, corr=-0.549) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 65.6306 -> 66.1865
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.0308 mb_mean=0.5080 norm_overlap=0.9534 corr_cb=-0.3701 topkJ=0.0000
[TRAIN][ep=013] loss=0.7126 acc=71.28%
[TRAIN][ep=013] mask_avg: mc_mean=0.0518 mb_mean=0.5015 norm_overlap=0.9596 corr_cb=-0.5263
[EPOCH 013/089] train: loss=0.7126 acc=71.28% | val: loss=0.5899 acc=72.29% f1=66.67% auc=75.58% val_score=59.7524 val_score_bestthr=66.6238 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.052, mb=0.501, no=0.960, corr=-0.526) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 66.1865 -> 66.6238
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.0582 mb_mean=0.4973 norm_overlap=0.9715 corr_cb=-0.4814 topkJ=0.0024
[TRAIN][ep=014] loss=0.7076 acc=71.54%
[TRAIN][ep=014] mask_avg: mc_mean=0.0521 mb_mean=0.5014 norm_overlap=0.9587 corr_cb=-0.5183
[EPOCH 014/089] train: loss=0.7076 acc=71.54% | val: loss=0.5833 acc=72.29% f1=66.67% auc=75.93% val_score=52.8036 val_score_bestthr=66.6238 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.052, mb=0.501, no=0.959, corr=-0.518) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6238 -> 66.6238
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.0310 mb_mean=0.5043 norm_overlap=0.9558 corr_cb=-0.4272 topkJ=0.0000
[TRAIN][ep=015] loss=0.6949 acc=72.35%
[TRAIN][ep=015] mask_avg: mc_mean=0.0552 mb_mean=0.5014 norm_overlap=0.9589 corr_cb=-0.5192
[EPOCH 015/089] train: loss=0.6949 acc=72.35% | val: loss=0.5742 acc=73.49% f1=68.57% auc=76.74% val_score=54.8728 val_score_bestthr=65.9223 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.055, mb=0.501, no=0.959, corr=-0.519) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6238 -> 65.9223
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.0357 mb_mean=0.5102 norm_overlap=0.9420 corr_cb=-0.5245 topkJ=0.0000
[TRAIN][ep=016] loss=0.7034 acc=71.68%
[TRAIN][ep=016] mask_avg: mc_mean=0.0469 mb_mean=0.5014 norm_overlap=0.9561 corr_cb=-0.4908
[EPOCH 016/089] train: loss=0.7034 acc=71.68% | val: loss=0.5747 acc=73.49% f1=68.57% auc=77.09% val_score=49.0913 val_score_bestthr=65.9223 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.047, mb=0.501, no=0.956, corr=-0.491) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6238 -> 65.9223
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.0582 mb_mean=0.4927 norm_overlap=0.9731 corr_cb=-0.4259 topkJ=0.0008
[TRAIN][ep=017] loss=0.6951 acc=71.28%
[TRAIN][ep=017] mask_avg: mc_mean=0.0430 mb_mean=0.5014 norm_overlap=0.9547 corr_cb=-0.4759
[EPOCH 017/089] train: loss=0.6951 acc=71.28% | val: loss=0.5795 acc=73.49% f1=68.57% auc=76.10% val_score=59.9141 val_score_bestthr=65.9223 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.043, mb=0.501, no=0.955, corr=-0.476) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6238 -> 65.9223
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.0492 mb_mean=0.5052 norm_overlap=0.9474 corr_cb=-0.5295 topkJ=0.0000
[TRAIN][ep=018] loss=0.6812 acc=72.48%
[TRAIN][ep=018] mask_avg: mc_mean=0.0585 mb_mean=0.5014 norm_overlap=0.9578 corr_cb=-0.5141
[EPOCH 018/089] train: loss=0.6812 acc=72.48% | val: loss=0.7100 acc=68.67% f1=74.51% auc=74.42% val_score=51.6446 val_score_bestthr=65.3774 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.058, mb=0.501, no=0.958, corr=-0.514) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6238 -> 65.3774
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.0366 mb_mean=0.4998 norm_overlap=0.9535 corr_cb=-0.4659 topkJ=0.0000
[TRAIN][ep=019] loss=0.7073 acc=70.07%
[TRAIN][ep=019] mask_avg: mc_mean=0.0391 mb_mean=0.5014 norm_overlap=0.9528 corr_cb=-0.4584
[EPOCH 019/089] train: loss=0.7073 acc=70.07% | val: loss=0.6264 acc=67.47% f1=74.77% auc=75.76% val_score=60.2367 val_score_bestthr=66.4819 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.039, mb=0.501, no=0.953, corr=-0.458) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6238 -> 66.4819
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.0767 mb_mean=0.4956 norm_overlap=0.9531 corr_cb=-0.5797 topkJ=0.0000
[TRAIN][ep=020] loss=0.6869 acc=72.89%
[TRAIN][ep=020] mask_avg: mc_mean=0.0455 mb_mean=0.5014 norm_overlap=0.9545 corr_cb=-0.4824
[EPOCH 020/089] train: loss=0.6869 acc=72.89% | val: loss=0.5865 acc=73.49% f1=68.57% auc=76.98% val_score=58.7307 val_score_bestthr=65.9223 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.046, mb=0.501, no=0.954, corr=-0.482) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6238 -> 65.9223
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.0430 mb_mean=0.5057 norm_overlap=0.9445 corr_cb=-0.4638 topkJ=0.0000
[TRAIN][ep=021] loss=0.6685 acc=73.69%
[TRAIN][ep=021] mask_avg: mc_mean=0.0620 mb_mean=0.5014 norm_overlap=0.9577 corr_cb=-0.5219
[EPOCH 021/089] train: loss=0.6685 acc=73.69% | val: loss=0.5897 acc=66.27% f1=73.08% auc=77.38% val_score=58.7307 val_score_bestthr=64.5335 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.062, mb=0.501, no=0.958, corr=-0.522) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6238 -> 64.5335
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.0783 mb_mean=0.4985 norm_overlap=0.9655 corr_cb=-0.4706 topkJ=0.0000
[TRAIN][ep=022] loss=0.6729 acc=73.96%
[TRAIN][ep=022] mask_avg: mc_mean=0.0576 mb_mean=0.5014 norm_overlap=0.9566 corr_cb=-0.5103
[EPOCH 022/089] train: loss=0.6729 acc=73.96% | val: loss=0.5494 acc=66.27% f1=75.00% auc=77.97% val_score=61.2877 val_score_bestthr=69.6680 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.058, mb=0.501, no=0.957, corr=-0.510) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 66.6238 -> 69.6680
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.0441 mb_mean=0.5003 norm_overlap=0.9549 corr_cb=-0.4507 topkJ=0.0000
[TRAIN][ep=023] loss=0.6795 acc=72.62%
[TRAIN][ep=023] mask_avg: mc_mean=0.0460 mb_mean=0.5015 norm_overlap=0.9536 corr_cb=-0.4773
[EPOCH 023/089] train: loss=0.6795 acc=72.62% | val: loss=0.5532 acc=74.70% f1=72.00% auc=78.26% val_score=58.9466 val_score_bestthr=65.3644 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.046, mb=0.501, no=0.954, corr=-0.477) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.6680 -> 65.3644
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.0461 mb_mean=0.5001 norm_overlap=0.9619 corr_cb=-0.3878 topkJ=0.0000
[TRAIN][ep=024] loss=0.6493 acc=75.84%
[TRAIN][ep=024] mask_avg: mc_mean=0.0529 mb_mean=0.5014 norm_overlap=0.9553 corr_cb=-0.4918
[EPOCH 024/089] train: loss=0.6493 acc=75.84% | val: loss=0.5557 acc=75.90% f1=74.36% auc=78.20% val_score=57.1066 val_score_bestthr=68.2337 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.053, mb=0.501, no=0.955, corr=-0.492) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.6680 -> 68.2337
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.0512 mb_mean=0.5013 norm_overlap=0.9565 corr_cb=-0.5416 topkJ=0.0000
[TRAIN][ep=025] loss=0.6692 acc=73.56%
[TRAIN][ep=025] mask_avg: mc_mean=0.0499 mb_mean=0.5014 norm_overlap=0.9541 corr_cb=-0.4813
[EPOCH 025/089] train: loss=0.6692 acc=73.56% | val: loss=0.5548 acc=66.27% f1=74.55% auc=77.15% val_score=63.6469 val_score_bestthr=66.2452 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.050, mb=0.501, no=0.954, corr=-0.481) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.6680 -> 66.2452
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.0376 mb_mean=0.5025 norm_overlap=0.9490 corr_cb=-0.5143 topkJ=0.0000
[TRAIN][ep=026] loss=0.6462 acc=74.50%
[TRAIN][ep=026] mask_avg: mc_mean=0.0570 mb_mean=0.5014 norm_overlap=0.9561 corr_cb=-0.5031
[EPOCH 026/089] train: loss=0.6462 acc=74.50% | val: loss=0.5754 acc=74.70% f1=72.73% auc=78.95% val_score=60.3976 val_score_bestthr=69.5636 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.057, mb=0.501, no=0.956, corr=-0.503) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.6680 -> 69.5636
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.0743 mb_mean=0.5001 norm_overlap=0.9519 corr_cb=-0.5835 topkJ=0.0000
[TRAIN][ep=027] loss=0.6446 acc=74.36%
[TRAIN][ep=027] mask_avg: mc_mean=0.0617 mb_mean=0.5014 norm_overlap=0.9570 corr_cb=-0.5115
[EPOCH 027/089] train: loss=0.6446 acc=74.36% | val: loss=0.6035 acc=72.29% f1=72.94% auc=77.38% val_score=58.7307 val_score_bestthr=69.2820 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.062, mb=0.501, no=0.957, corr=-0.512) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.6680 -> 69.2820
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.0695 mb_mean=0.4951 norm_overlap=0.9720 corr_cb=-0.4179 topkJ=0.0000
[TRAIN][ep=028] loss=0.6425 acc=74.77%
[TRAIN][ep=028] mask_avg: mc_mean=0.0602 mb_mean=0.5015 norm_overlap=0.9565 corr_cb=-0.5045
[EPOCH 028/089] train: loss=0.6425 acc=74.77% | val: loss=0.5531 acc=77.11% f1=76.54% auc=79.42% val_score=58.6883 val_score_bestthr=74.5003 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.060, mb=0.501, no=0.957, corr=-0.504) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 69.6680 -> 74.5003
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.0740 mb_mean=0.4980 norm_overlap=0.9637 corr_cb=-0.5063 topkJ=0.0000
[TRAIN][ep=029] loss=0.6270 acc=78.12%
[TRAIN][ep=029] mask_avg: mc_mean=0.0583 mb_mean=0.5015 norm_overlap=0.9562 corr_cb=-0.5035
[EPOCH 029/089] train: loss=0.6270 acc=78.12% | val: loss=0.6012 acc=74.70% f1=72.73% auc=80.00% val_score=68.9564 val_score_bestthr=69.5636 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.058, mb=0.501, no=0.956, corr=-0.503) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.5003 -> 69.5636
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.0830 mb_mean=0.4961 norm_overlap=0.9685 corr_cb=-0.5515 topkJ=0.0000
[TRAIN][ep=030] loss=0.6327 acc=74.77%
[TRAIN][ep=030] mask_avg: mc_mean=0.0623 mb_mean=0.5015 norm_overlap=0.9569 corr_cb=-0.5110
[EPOCH 030/089] train: loss=0.6327 acc=74.77% | val: loss=0.5414 acc=74.70% f1=74.70% auc=80.23% val_score=65.8877 val_score_bestthr=71.0024 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.062, mb=0.501, no=0.957, corr=-0.511) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.5003 -> 71.0024
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.0585 mb_mean=0.5019 norm_overlap=0.9606 corr_cb=-0.5150 topkJ=0.0000
[TRAIN][ep=031] loss=0.6144 acc=77.45%
[TRAIN][ep=031] mask_avg: mc_mean=0.0653 mb_mean=0.5015 norm_overlap=0.9575 corr_cb=-0.5160
[EPOCH 031/089] train: loss=0.6144 acc=77.45% | val: loss=0.5480 acc=75.90% f1=75.61% auc=78.95% val_score=62.0977 val_score_bestthr=73.9054 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.065, mb=0.501, no=0.958, corr=-0.516) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.5003 -> 73.9054
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.0597 mb_mean=0.4988 norm_overlap=0.9567 corr_cb=-0.5750 topkJ=0.0000
[TRAIN][ep=032] loss=0.6221 acc=77.99%
[TRAIN][ep=032] mask_avg: mc_mean=0.0672 mb_mean=0.5014 norm_overlap=0.9583 corr_cb=-0.5132
[EPOCH 032/089] train: loss=0.6221 acc=77.99% | val: loss=0.5516 acc=77.11% f1=76.54% auc=80.41% val_score=58.9681 val_score_bestthr=74.5003 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.067, mb=0.501, no=0.958, corr=-0.513) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.5003 -> 74.5003
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.0781 mb_mean=0.4952 norm_overlap=0.9705 corr_cb=-0.4891 topkJ=0.0004
[TRAIN][ep=033] loss=0.6047 acc=77.32%
[TRAIN][ep=033] mask_avg: mc_mean=0.0634 mb_mean=0.5014 norm_overlap=0.9576 corr_cb=-0.5008
[EPOCH 033/089] train: loss=0.6047 acc=77.32% | val: loss=0.5578 acc=73.49% f1=75.00% auc=79.65% val_score=54.5230 val_score_bestthr=74.9503 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.063, mb=0.501, no=0.958, corr=-0.501) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 74.5003 -> 74.9503
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.0867 mb_mean=0.5028 norm_overlap=0.9593 corr_cb=-0.6036 topkJ=0.0000
[TRAIN][ep=034] loss=0.6076 acc=75.57%
[TRAIN][ep=034] mask_avg: mc_mean=0.0788 mb_mean=0.5014 norm_overlap=0.9598 corr_cb=-0.5177
[EPOCH 034/089] train: loss=0.6076 acc=75.57% | val: loss=0.5389 acc=71.08% f1=73.91% auc=79.88% val_score=62.0977 val_score_bestthr=72.1808 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.079, mb=0.501, no=0.960, corr=-0.518) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.9503 -> 72.1808
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.0383 mb_mean=0.5037 norm_overlap=0.9557 corr_cb=-0.4429 topkJ=0.0000
[TRAIN][ep=035] loss=0.5957 acc=79.87%
[TRAIN][ep=035] mask_avg: mc_mean=0.0655 mb_mean=0.5014 norm_overlap=0.9580 corr_cb=-0.5034
[EPOCH 035/089] train: loss=0.5957 acc=79.87% | val: loss=0.5303 acc=74.70% f1=76.92% auc=81.57% val_score=57.5059 val_score_bestthr=75.3191 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.065, mb=0.501, no=0.958, corr=-0.503) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 74.9503 -> 75.3191
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.0686 mb_mean=0.4983 norm_overlap=0.9578 corr_cb=-0.5409 topkJ=0.0000
[TRAIN][ep=036] loss=0.6048 acc=77.72%
[TRAIN][ep=036] mask_avg: mc_mean=0.0725 mb_mean=0.5015 norm_overlap=0.9591 corr_cb=-0.5164
[EPOCH 036/089] train: loss=0.6048 acc=77.72% | val: loss=0.5690 acc=73.49% f1=77.55% auc=80.99% val_score=55.9281 val_score_bestthr=74.5060 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.073, mb=0.501, no=0.959, corr=-0.516) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.3191 -> 74.5060
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.0442 mb_mean=0.5046 norm_overlap=0.9513 corr_cb=-0.4945 topkJ=0.0000
[TRAIN][ep=037] loss=0.5924 acc=78.66%
[TRAIN][ep=037] mask_avg: mc_mean=0.0700 mb_mean=0.5014 norm_overlap=0.9586 corr_cb=-0.5098
[EPOCH 037/089] train: loss=0.5924 acc=78.66% | val: loss=0.5571 acc=71.08% f1=74.47% auc=81.45% val_score=55.0122 val_score_bestthr=75.4451 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.070, mb=0.501, no=0.959, corr=-0.510) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 75.3191 -> 75.4451
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.0750 mb_mean=0.4966 norm_overlap=0.9681 corr_cb=-0.5345 topkJ=0.0000
[TRAIN][ep=038] loss=0.6113 acc=77.18%
[TRAIN][ep=038] mask_avg: mc_mean=0.0416 mb_mean=0.5014 norm_overlap=0.9520 corr_cb=-0.4330
[EPOCH 038/089] train: loss=0.6113 acc=77.18% | val: loss=0.5315 acc=72.29% f1=74.73% auc=81.34% val_score=65.3839 val_score_bestthr=75.2466 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.042, mb=0.501, no=0.952, corr=-0.433) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.4451 -> 75.2466
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.0421 mb_mean=0.5081 norm_overlap=0.9448 corr_cb=-0.5071 topkJ=0.0000
[TRAIN][ep=039] loss=0.5694 acc=80.94%
[TRAIN][ep=039] mask_avg: mc_mean=0.0788 mb_mean=0.5015 norm_overlap=0.9602 corr_cb=-0.5235
[EPOCH 039/089] train: loss=0.5694 acc=80.94% | val: loss=0.5300 acc=73.49% f1=75.56% auc=82.03% val_score=69.8061 val_score_bestthr=75.7643 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.079, mb=0.501, no=0.960, corr=-0.523) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 75.4451 -> 75.7643
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.1034 mb_mean=0.5035 norm_overlap=0.9533 corr_cb=-0.6351 topkJ=0.0000
[TRAIN][ep=040] loss=0.5784 acc=79.46%
[TRAIN][ep=040] mask_avg: mc_mean=0.0758 mb_mean=0.5014 norm_overlap=0.9600 corr_cb=-0.5112
[EPOCH 040/089] train: loss=0.5784 acc=79.46% | val: loss=0.5572 acc=77.11% f1=76.54% auc=81.40% val_score=69.4162 val_score_bestthr=75.6597 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.076, mb=0.501, no=0.960, corr=-0.511) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.7643 -> 75.6597
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.0941 mb_mean=0.5010 norm_overlap=0.9558 corr_cb=-0.6092 topkJ=0.0000
[TRAIN][ep=041] loss=0.5849 acc=78.12%
[TRAIN][ep=041] mask_avg: mc_mean=0.0749 mb_mean=0.5014 norm_overlap=0.9597 corr_cb=-0.5084
[EPOCH 041/089] train: loss=0.5849 acc=78.12% | val: loss=0.5454 acc=73.49% f1=76.09% auc=81.98% val_score=62.1952 val_score_bestthr=79.0251 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.075, mb=0.501, no=0.960, corr=-0.508) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 75.7643 -> 79.0251
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.0828 mb_mean=0.4956 norm_overlap=0.9719 corr_cb=-0.4714 topkJ=0.0000
[TRAIN][ep=042] loss=0.5738 acc=80.54%
[TRAIN][ep=042] mask_avg: mc_mean=0.0807 mb_mean=0.5014 norm_overlap=0.9606 corr_cb=-0.5080
[EPOCH 042/089] train: loss=0.5738 acc=80.54% | val: loss=0.5255 acc=72.29% f1=75.27% auc=82.38% val_score=62.3828 val_score_bestthr=76.5671 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.508) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 76.5671
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.0398 mb_mean=0.4997 norm_overlap=0.9590 corr_cb=-0.4714 topkJ=0.0000
[TRAIN][ep=043] loss=0.6564 acc=77.32%
[TRAIN][ep=043] mask_avg: mc_mean=0.0680 mb_mean=0.5014 norm_overlap=0.9589 corr_cb=-0.4898
[EPOCH 043/089] train: loss=0.6564 acc=77.32% | val: loss=0.6719 acc=74.70% f1=77.42% auc=82.50% val_score=54.1440 val_score_bestthr=74.3342 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.068, mb=0.501, no=0.959, corr=-0.490) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 74.3342
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.0482 mb_mean=0.5072 norm_overlap=0.9494 corr_cb=-0.5106 topkJ=0.0000
[TRAIN][ep=044] loss=0.5581 acc=80.13%
[TRAIN][ep=044] mask_avg: mc_mean=0.0777 mb_mean=0.5015 norm_overlap=0.9605 corr_cb=-0.5105
[EPOCH 044/089] train: loss=0.5581 acc=80.13% | val: loss=0.5456 acc=74.70% f1=77.89% auc=82.03% val_score=67.0877 val_score_bestthr=73.4753 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.078, mb=0.501, no=0.960, corr=-0.510) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 73.4753
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.0820 mb_mean=0.4984 norm_overlap=0.9615 corr_cb=-0.4589 topkJ=0.0000
[TRAIN][ep=045] loss=0.5449 acc=82.15%
[TRAIN][ep=045] mask_avg: mc_mean=0.0845 mb_mean=0.5014 norm_overlap=0.9614 corr_cb=-0.5153
[EPOCH 045/089] train: loss=0.5449 acc=82.15% | val: loss=0.5649 acc=75.90% f1=79.17% auc=82.62% val_score=68.8938 val_score_bestthr=76.7960 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.084, mb=0.501, no=0.961, corr=-0.515) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 76.7960
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.1058 mb_mean=0.4955 norm_overlap=0.9704 corr_cb=-0.4996 topkJ=0.0000
[TRAIN][ep=046] loss=0.6171 acc=80.94%
[TRAIN][ep=046] mask_avg: mc_mean=0.0781 mb_mean=0.5015 norm_overlap=0.9601 corr_cb=-0.5007
[EPOCH 046/089] train: loss=0.6171 acc=80.94% | val: loss=0.6088 acc=79.52% f1=79.52% auc=82.27% val_score=55.9281 val_score_bestthr=74.9962 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.078, mb=0.501, no=0.960, corr=-0.501) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 74.9962
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.0785 mb_mean=0.5047 norm_overlap=0.9633 corr_cb=-0.5348 topkJ=0.0000
[TRAIN][ep=047] loss=0.5382 acc=80.67%
[TRAIN][ep=047] mask_avg: mc_mean=0.0898 mb_mean=0.5014 norm_overlap=0.9623 corr_cb=-0.5144
[EPOCH 047/089] train: loss=0.5382 acc=80.67% | val: loss=0.5598 acc=75.90% f1=80.00% auc=82.21% val_score=72.8339 val_score_bestthr=78.9398 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.090, mb=0.501, no=0.962, corr=-0.514) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 78.9398
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.0893 mb_mean=0.4955 norm_overlap=0.9677 corr_cb=-0.4911 topkJ=0.0000
[TRAIN][ep=048] loss=0.5565 acc=81.07%
[TRAIN][ep=048] mask_avg: mc_mean=0.0839 mb_mean=0.5014 norm_overlap=0.9612 corr_cb=-0.5074
[EPOCH 048/089] train: loss=0.5565 acc=81.07% | val: loss=0.5432 acc=75.90% f1=76.74% auc=82.15% val_score=70.4671 val_score_bestthr=72.7519 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.084, mb=0.501, no=0.961, corr=-0.507) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 72.7519
[DBG][ep=049] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.0491 mb_mean=0.5049 norm_overlap=0.9573 corr_cb=-0.4772 topkJ=0.0000
[TRAIN][ep=049] loss=0.5288 acc=81.61%
[TRAIN][ep=049] mask_avg: mc_mean=0.0770 mb_mean=0.5014 norm_overlap=0.9604 corr_cb=-0.4974
[EPOCH 049/089] train: loss=0.5288 acc=81.61% | val: loss=0.6161 acc=73.49% f1=77.08% auc=81.86% val_score=53.4640 val_score_bestthr=72.3516 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.077, mb=0.501, no=0.960, corr=-0.497) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 72.3516
[DBG][ep=050] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.0728 mb_mean=0.5029 norm_overlap=0.9579 corr_cb=-0.4619 topkJ=0.0000
[TRAIN][ep=050] loss=0.4990 acc=84.83%
[TRAIN][ep=050] mask_avg: mc_mean=0.0812 mb_mean=0.5015 norm_overlap=0.9610 corr_cb=-0.5030
[EPOCH 050/089] train: loss=0.4990 acc=84.83% | val: loss=0.5935 acc=72.29% f1=76.77% auc=81.51% val_score=55.2534 val_score_bestthr=74.6040 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.503) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 74.6040
[DBG][ep=051] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.0766 mb_mean=0.5035 norm_overlap=0.9572 corr_cb=-0.5472 topkJ=0.0000
[TRAIN][ep=051] loss=0.4980 acc=84.70%
[TRAIN][ep=051] mask_avg: mc_mean=0.0812 mb_mean=0.5015 norm_overlap=0.9612 corr_cb=-0.5011
[EPOCH 051/089] train: loss=0.4980 acc=84.70% | val: loss=0.5761 acc=73.49% f1=77.08% auc=81.45% val_score=58.8580 val_score_bestthr=71.6560 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.501) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 71.6560
[DBG][ep=052] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.1058 mb_mean=0.4999 norm_overlap=0.9608 corr_cb=-0.5229 topkJ=0.0000
[TRAIN][ep=052] loss=0.4941 acc=85.50%
[TRAIN][ep=052] mask_avg: mc_mean=0.0813 mb_mean=0.5014 norm_overlap=0.9611 corr_cb=-0.5027
[EPOCH 052/089] train: loss=0.4941 acc=85.50% | val: loss=0.5543 acc=75.90% f1=78.72% auc=81.80% val_score=67.6328 val_score_bestthr=75.9348 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.503) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 75.9348
[DBG][ep=053] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.0743 mb_mean=0.5085 norm_overlap=0.9439 corr_cb=-0.5061 topkJ=0.0000
[TRAIN][ep=053] loss=0.4928 acc=84.43%
[TRAIN][ep=053] mask_avg: mc_mean=0.0812 mb_mean=0.5015 norm_overlap=0.9611 corr_cb=-0.5036
[EPOCH 053/089] train: loss=0.4928 acc=84.43% | val: loss=0.5539 acc=74.70% f1=77.89% auc=81.69% val_score=65.8373 val_score_bestthr=74.8086 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.504) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 74.8086
[DBG][ep=054] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=054] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=054] mask(step0): mc_mean=0.0761 mb_mean=0.5047 norm_overlap=0.9554 corr_cb=-0.4903 topkJ=0.0000
[TRAIN][ep=054] loss=0.4942 acc=84.83%
[TRAIN][ep=054] mask_avg: mc_mean=0.0813 mb_mean=0.5014 norm_overlap=0.9609 corr_cb=-0.5039
[EPOCH 054/089] train: loss=0.4942 acc=84.83% | val: loss=0.5772 acc=77.11% f1=75.95% auc=81.16% val_score=58.8580 val_score_bestthr=72.8288 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.504) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 72.8288
[DBG][ep=055] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=055] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=055] mask(step0): mc_mean=0.0748 mb_mean=0.5009 norm_overlap=0.9624 corr_cb=-0.5673 topkJ=0.0000
[TRAIN][ep=055] loss=0.4885 acc=84.97%
[TRAIN][ep=055] mask_avg: mc_mean=0.0814 mb_mean=0.5014 norm_overlap=0.9611 corr_cb=-0.5002
[EPOCH 055/089] train: loss=0.4885 acc=84.97% | val: loss=0.5829 acc=72.29% f1=76.77% auc=81.05% val_score=58.8580 val_score_bestthr=74.6040 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.500) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 74.6040
[DBG][ep=056] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=056] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=056] mask(step0): mc_mean=0.0925 mb_mean=0.5009 norm_overlap=0.9630 corr_cb=-0.5245 topkJ=0.0000
[TRAIN][ep=056] loss=0.4843 acc=85.37%
[TRAIN][ep=056] mask_avg: mc_mean=0.0813 mb_mean=0.5014 norm_overlap=0.9610 corr_cb=-0.5054
[EPOCH 056/089] train: loss=0.4843 acc=85.37% | val: loss=0.5711 acc=72.29% f1=76.77% auc=81.34% val_score=67.7710 val_score_bestthr=74.6040 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.505) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 74.6040
[DBG][ep=057] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=057] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=057] mask(step0): mc_mean=0.1161 mb_mean=0.4930 norm_overlap=0.9768 corr_cb=-0.5042 topkJ=0.0032
[TRAIN][ep=057] loss=0.4909 acc=85.64%
[TRAIN][ep=057] mask_avg: mc_mean=0.0812 mb_mean=0.5014 norm_overlap=0.9609 corr_cb=-0.5047
[EPOCH 057/089] train: loss=0.4909 acc=85.64% | val: loss=0.5696 acc=72.29% f1=76.77% auc=81.45% val_score=67.7710 val_score_bestthr=74.6040 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.505) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 74.6040
[DBG][ep=058] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=058] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=058] mask(step0): mc_mean=0.1127 mb_mean=0.5023 norm_overlap=0.9608 corr_cb=-0.4977 topkJ=0.0000
[TRAIN][ep=058] loss=0.4875 acc=84.97%
[TRAIN][ep=058] mask_avg: mc_mean=0.0813 mb_mean=0.5014 norm_overlap=0.9610 corr_cb=-0.5033
[EPOCH 058/089] train: loss=0.4875 acc=84.97% | val: loss=0.5713 acc=72.29% f1=76.77% auc=81.34% val_score=67.7710 val_score_bestthr=74.6040 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.503) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 74.6040
[DBG][ep=059] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=059] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=059] mask(step0): mc_mean=0.0774 mb_mean=0.5009 norm_overlap=0.9582 corr_cb=-0.5531 topkJ=0.0000
[TRAIN][ep=059] loss=0.4916 acc=84.70%
[TRAIN][ep=059] mask_avg: mc_mean=0.0812 mb_mean=0.5014 norm_overlap=0.9610 corr_cb=-0.5047
[EPOCH 059/089] train: loss=0.4916 acc=84.70% | val: loss=0.5948 acc=77.11% f1=76.54% auc=81.22% val_score=61.9411 val_score_bestthr=75.7177 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.505) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 75.7177
[DBG][ep=060] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=060] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=060] mask(step0): mc_mean=0.0653 mb_mean=0.5029 norm_overlap=0.9617 corr_cb=-0.4725 topkJ=0.0000
[TRAIN][ep=060] loss=0.4846 acc=85.23%
[TRAIN][ep=060] mask_avg: mc_mean=0.0812 mb_mean=0.5015 norm_overlap=0.9609 corr_cb=-0.5038
[EPOCH 060/089] train: loss=0.4846 acc=85.23% | val: loss=0.5920 acc=73.49% f1=78.00% auc=81.16% val_score=59.5758 val_score_bestthr=73.7939 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.504) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 73.7939
[DBG][ep=061] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=061] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=061] mask(step0): mc_mean=0.1474 mb_mean=0.4912 norm_overlap=0.9770 corr_cb=-0.4787 topkJ=0.0000
[TRAIN][ep=061] loss=0.4847 acc=84.70%
[TRAIN][ep=061] mask_avg: mc_mean=0.0813 mb_mean=0.5014 norm_overlap=0.9611 corr_cb=-0.5021
[EPOCH 061/089] train: loss=0.4847 acc=84.70% | val: loss=0.5802 acc=73.49% f1=78.00% auc=81.22% val_score=58.4318 val_score_bestthr=73.7939 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.502) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 73.7939
[DBG][ep=062] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=062] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=062] mask(step0): mc_mean=0.0490 mb_mean=0.5065 norm_overlap=0.9577 corr_cb=-0.4824 topkJ=0.0000
[TRAIN][ep=062] loss=0.4840 acc=85.10%
[TRAIN][ep=062] mask_avg: mc_mean=0.0813 mb_mean=0.5014 norm_overlap=0.9611 corr_cb=-0.5044
[EPOCH 062/089] train: loss=0.4840 acc=85.10% | val: loss=0.5671 acc=73.49% f1=77.55% auc=81.57% val_score=68.1889 val_score_bestthr=76.4190 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.504) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 76.4190
[DBG][ep=063] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=063] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=063] mask(step0): mc_mean=0.0787 mb_mean=0.4998 norm_overlap=0.9688 corr_cb=-0.4694 topkJ=0.0008
[TRAIN][ep=063] loss=0.4858 acc=84.70%
[TRAIN][ep=063] mask_avg: mc_mean=0.0813 mb_mean=0.5014 norm_overlap=0.9611 corr_cb=-0.5049
[EPOCH 063/089] train: loss=0.4858 acc=84.70% | val: loss=0.5769 acc=72.29% f1=76.77% auc=81.16% val_score=67.7710 val_score_bestthr=74.6040 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.505) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 74.6040
[DBG][ep=064] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=064] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=064] mask(step0): mc_mean=0.0962 mb_mean=0.4966 norm_overlap=0.9752 corr_cb=-0.4712 topkJ=0.0035
[TRAIN][ep=064] loss=0.4796 acc=86.17%
[TRAIN][ep=064] mask_avg: mc_mean=0.0813 mb_mean=0.5014 norm_overlap=0.9609 corr_cb=-0.5036
[EPOCH 064/089] train: loss=0.4796 acc=86.17% | val: loss=0.5802 acc=72.29% f1=76.77% auc=81.22% val_score=60.4796 val_score_bestthr=74.6040 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.504) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 74.6040
[DBG][ep=065] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=065] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=065] mask(step0): mc_mean=0.0761 mb_mean=0.5017 norm_overlap=0.9590 corr_cb=-0.5325 topkJ=0.0000
[TRAIN][ep=065] loss=0.4755 acc=85.37%
[TRAIN][ep=065] mask_avg: mc_mean=0.0812 mb_mean=0.5015 norm_overlap=0.9611 corr_cb=-0.5030
[EPOCH 065/089] train: loss=0.4755 acc=85.37% | val: loss=0.6247 acc=77.11% f1=76.54% auc=81.05% val_score=55.2534 val_score_bestthr=75.7177 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.503) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 75.7177
[DBG][ep=066] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=066] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=066] mask(step0): mc_mean=0.0886 mb_mean=0.5007 norm_overlap=0.9650 corr_cb=-0.5458 topkJ=0.0000
[TRAIN][ep=066] loss=0.4767 acc=85.23%
[TRAIN][ep=066] mask_avg: mc_mean=0.0812 mb_mean=0.5015 norm_overlap=0.9608 corr_cb=-0.5059
[EPOCH 066/089] train: loss=0.4767 acc=85.23% | val: loss=0.5850 acc=72.29% f1=76.77% auc=81.28% val_score=58.4318 val_score_bestthr=74.6040 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.506) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 74.6040
[DBG][ep=067] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=067] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=067] mask(step0): mc_mean=0.0801 mb_mean=0.5058 norm_overlap=0.9479 corr_cb=-0.5307 topkJ=0.0000
[TRAIN][ep=067] loss=0.4749 acc=85.23%
[TRAIN][ep=067] mask_avg: mc_mean=0.0813 mb_mean=0.5014 norm_overlap=0.9609 corr_cb=-0.5061
[EPOCH 067/089] train: loss=0.4749 acc=85.23% | val: loss=0.5787 acc=72.29% f1=76.77% auc=81.51% val_score=71.6845 val_score_bestthr=74.6040 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.506) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 74.6040
[DBG][ep=068] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=068] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=068] mask(step0): mc_mean=0.0718 mb_mean=0.5032 norm_overlap=0.9605 corr_cb=-0.5251 topkJ=0.0008
[TRAIN][ep=068] loss=0.4718 acc=85.91%
[TRAIN][ep=068] mask_avg: mc_mean=0.0814 mb_mean=0.5014 norm_overlap=0.9610 corr_cb=-0.5033
[EPOCH 068/089] train: loss=0.4718 acc=85.91% | val: loss=0.6767 acc=74.70% f1=77.89% auc=80.58% val_score=56.8352 val_score_bestthr=73.9970 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.503) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 73.9970
[DBG][ep=069] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=069] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=069] mask(step0): mc_mean=0.0973 mb_mean=0.5002 norm_overlap=0.9610 corr_cb=-0.5778 topkJ=0.0000
[TRAIN][ep=069] loss=0.4836 acc=84.97%
[TRAIN][ep=069] mask_avg: mc_mean=0.0812 mb_mean=0.5014 norm_overlap=0.9610 corr_cb=-0.5035
[EPOCH 069/089] train: loss=0.4836 acc=84.97% | val: loss=0.5724 acc=73.49% f1=77.55% auc=81.51% val_score=69.8671 val_score_bestthr=76.4190 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.503) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 76.4190
[DBG][ep=070] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=070] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=070] mask(step0): mc_mean=0.0822 mb_mean=0.4982 norm_overlap=0.9700 corr_cb=-0.5046 topkJ=0.0000
[TRAIN][ep=070] loss=0.4748 acc=86.31%
[TRAIN][ep=070] mask_avg: mc_mean=0.0812 mb_mean=0.5014 norm_overlap=0.9610 corr_cb=-0.5034
[EPOCH 070/089] train: loss=0.4748 acc=86.31% | val: loss=0.5760 acc=73.49% f1=77.55% auc=81.28% val_score=72.2198 val_score_bestthr=76.4190 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.503) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 76.4190
[DBG][ep=071] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=071] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=071] mask(step0): mc_mean=0.0942 mb_mean=0.4983 norm_overlap=0.9597 corr_cb=-0.5680 topkJ=0.0000
[TRAIN][ep=071] loss=0.4733 acc=85.64%
[TRAIN][ep=071] mask_avg: mc_mean=0.0812 mb_mean=0.5014 norm_overlap=0.9609 corr_cb=-0.5080
[EPOCH 071/089] train: loss=0.4733 acc=85.64% | val: loss=0.5866 acc=72.29% f1=76.77% auc=80.93% val_score=71.6845 val_score_bestthr=74.6040 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.081, mb=0.501, no=0.961, corr=-0.508) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 74.6040
[EARLY STOP] no improvement for 30 epochs. best_epoch=41
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
=============== FIT DONE ===============
[BEST] epoch=41 | val_acc=73.49% | val_f1=76.09% | val_auc=81.98% | val_score=62.1952 | val_score_bestthr=79.0251
[TEST@BEST] thr_used=0.190 | acc=58.94% f1=68.63% auc=64.29% | SP_sex=7.23% EO_sex=2.12% SP_age=11.48% EO_age=7.93%
[TIME] 1.74 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/summary_fold_0.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4752 mb_mean=0.5091 norm_overlap=0.9996 corr_cb=-0.4004 topkJ=0.0039
[TRAIN][ep=000] loss=0.6932 acc=51.14%
[TRAIN][ep=000] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1325
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4782 mb_mean=0.5028 norm_overlap=0.9999 corr_cb=-0.0933 topkJ=0.0031
[TRAIN][ep=001] loss=0.6927 acc=51.01%
[TRAIN][ep=001] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1283
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4776 mb_mean=0.5098 norm_overlap=0.9997 corr_cb=-0.3755 topkJ=0.0024
[TRAIN][ep=002] loss=0.6906 acc=53.42%
[TRAIN][ep=002] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1407
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4785 mb_mean=0.5037 norm_overlap=1.0000 corr_cb=0.0262 topkJ=0.0152
[TRAIN][ep=003] loss=0.6892 acc=55.84%
[TRAIN][ep=003] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1330
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4760 mb_mean=0.5053 norm_overlap=0.9998 corr_cb=-0.2618 topkJ=0.0459
[TRAIN][ep=004] loss=0.6879 acc=57.32%
[TRAIN][ep=004] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1247
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4794 mb_mean=0.5002 norm_overlap=0.9999 corr_cb=-0.2006 topkJ=0.0064
[TRAIN][ep=005] loss=0.6871 acc=54.09%
[TRAIN][ep=005] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1272
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4760 mb_mean=0.5040 norm_overlap=0.9997 corr_cb=-0.4011 topkJ=0.0113
[TRAIN][ep=006] loss=0.6832 acc=56.24%
[TRAIN][ep=006] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1302
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4758 mb_mean=0.5023 norm_overlap=0.9998 corr_cb=-0.2950 topkJ=0.0024
[TRAIN][ep=007] loss=0.6767 acc=59.19%
[TRAIN][ep=007] mask_avg: mc_mean=0.4785 mb_mean=0.5015 norm_overlap=0.9999 corr_cb=-0.1365
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4784 mb_mean=0.4987 norm_overlap=0.9997 corr_cb=-0.3532 topkJ=0.0048
[TRAIN][ep=008] loss=0.6721 acc=63.89%
[TRAIN][ep=008] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1238
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4781 mb_mean=0.5042 norm_overlap=0.9998 corr_cb=-0.2975 topkJ=0.0188
[TRAIN][ep=009] loss=0.6643 acc=62.55%
[TRAIN][ep=009] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1254
================= FIT START (fold=0) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4787 mb_mean=0.5043 norm_overlap=0.9999 corr_cb=-0.0822 topkJ=0.0502
[TRAIN][ep=000] loss=0.6583 acc=63.62%
[TRAIN][ep=000] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1201
[EPOCH 000/089] train: loss=0.6583 acc=63.62% | val: loss=0.6534 acc=67.47% f1=74.29% auc=71.74% val_score=55.4225 val_score_bestthr=63.3503 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.120) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 63.3503
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4793 mb_mean=0.5022 norm_overlap=0.9998 corr_cb=-0.2365 topkJ=0.0024
[TRAIN][ep=001] loss=0.6517 acc=64.43%
[TRAIN][ep=001] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1274
[EPOCH 001/089] train: loss=0.6517 acc=64.43% | val: loss=0.6599 acc=61.45% f1=72.41% auc=68.49% val_score=47.5336 val_score_bestthr=64.7777 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.127) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 63.3503 -> 64.7777
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4774 mb_mean=0.4982 norm_overlap=1.0000 corr_cb=-0.0324 topkJ=0.0252
[TRAIN][ep=002] loss=0.6471 acc=64.30%
[TRAIN][ep=002] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1182
[EPOCH 002/089] train: loss=0.6471 acc=64.30% | val: loss=0.6415 acc=68.67% f1=75.00% auc=72.44% val_score=47.9380 val_score_bestthr=63.1152 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.118) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.7777 -> 63.1152
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4776 mb_mean=0.5075 norm_overlap=0.9998 corr_cb=-0.2177 topkJ=0.0023
[TRAIN][ep=003] loss=0.6421 acc=64.43%
[TRAIN][ep=003] mask_avg: mc_mean=0.4785 mb_mean=0.5015 norm_overlap=0.9999 corr_cb=-0.1255
[EPOCH 003/089] train: loss=0.6421 acc=64.43% | val: loss=0.6608 acc=63.86% f1=73.68% auc=69.24% val_score=54.7539 val_score_bestthr=65.2221 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.125) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 64.7777 -> 65.2221
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4824 mb_mean=0.4950 norm_overlap=0.9998 corr_cb=-0.2211 topkJ=0.0294
[TRAIN][ep=004] loss=0.6475 acc=62.01%
[TRAIN][ep=004] mask_avg: mc_mean=0.4785 mb_mean=0.5014 norm_overlap=0.9999 corr_cb=-0.1284
[EPOCH 004/089] train: loss=0.6475 acc=62.01% | val: loss=0.6352 acc=69.88% f1=76.19% auc=73.08% val_score=46.9114 val_score_bestthr=64.6846 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.479, mb=0.501, no=1.000, corr=-0.128) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 65.2221 -> 64.6846
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4744 mb_mean=0.5047 norm_overlap=0.9999 corr_cb=-0.0747 topkJ=0.0278
[TRAIN][ep=005] loss=1.3560 acc=65.37%
[TRAIN][ep=005] mask_avg: mc_mean=0.3458 mb_mean=0.5014 norm_overlap=0.9961 corr_cb=-0.6422
[EPOCH 005/089] train: loss=1.3560 acc=65.37% | val: loss=0.6517 acc=68.67% f1=70.45% auc=75.81% val_score=62.4643 val_score_bestthr=63.5854 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.346, mb=0.501, no=0.996, corr=-0.642) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.2221 -> 63.5854
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.1986 mb_mean=0.5118 norm_overlap=0.9863 corr_cb=-0.7998 topkJ=0.0000
[TRAIN][ep=006] loss=1.3325 acc=66.04%
[TRAIN][ep=006] mask_avg: mc_mean=0.1913 mb_mean=0.5014 norm_overlap=0.9885 corr_cb=-0.7194
[EPOCH 006/089] train: loss=1.3325 acc=66.04% | val: loss=0.6379 acc=61.45% f1=71.93% auc=76.51% val_score=65.9943 val_score_bestthr=60.9430 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.191, mb=0.501, no=0.989, corr=-0.719) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.2221 -> 60.9430
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.1510 mb_mean=0.5024 norm_overlap=0.9839 corr_cb=-0.7855 topkJ=0.0000
[TRAIN][ep=007] loss=1.3350 acc=62.68%
[TRAIN][ep=007] mask_avg: mc_mean=0.1239 mb_mean=0.5014 norm_overlap=0.9816 corr_cb=-0.7175
[EPOCH 007/089] train: loss=1.3350 acc=62.68% | val: loss=0.6282 acc=69.88% f1=75.73% auc=74.24% val_score=52.4552 val_score_bestthr=64.6321 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.124, mb=0.501, no=0.982, corr=-0.717) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.2221 -> 64.6321
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1088 mb_mean=0.5001 norm_overlap=0.9750 corr_cb=-0.7724 topkJ=0.0000
[TRAIN][ep=008] loss=1.3187 acc=67.25%
[TRAIN][ep=008] mask_avg: mc_mean=0.0808 mb_mean=0.5014 norm_overlap=0.9746 corr_cb=-0.6705
[EPOCH 008/089] train: loss=1.3187 acc=67.25% | val: loss=0.6342 acc=67.47% f1=75.23% auc=73.49% val_score=61.5991 val_score_bestthr=65.3678 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.081, mb=0.501, no=0.975, corr=-0.670) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 65.2221 -> 65.3678
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.0576 mb_mean=0.5043 norm_overlap=0.9721 corr_cb=-0.6649 topkJ=0.0000
[TRAIN][ep=009] loss=1.2979 acc=69.40%
[TRAIN][ep=009] mask_avg: mc_mean=0.0692 mb_mean=0.5014 norm_overlap=0.9703 corr_cb=-0.6314
[EPOCH 009/089] train: loss=1.2979 acc=69.40% | val: loss=0.6050 acc=67.47% f1=73.79% auc=75.76% val_score=49.7236 val_score_bestthr=64.0005 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.069, mb=0.501, no=0.970, corr=-0.631) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.3678 -> 64.0005
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.0849 mb_mean=0.4997 norm_overlap=0.9624 corr_cb=-0.6839 topkJ=0.0000
[TRAIN][ep=010] loss=0.9070 acc=67.92%
[TRAIN][ep=010] mask_avg: mc_mean=0.0696 mb_mean=0.5015 norm_overlap=0.9678 corr_cb=-0.6063
[EPOCH 010/089] train: loss=0.9070 acc=67.92% | val: loss=0.6029 acc=71.08% f1=65.71% auc=75.64% val_score=54.5243 val_score_bestthr=64.2616 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.070, mb=0.501, no=0.968, corr=-0.606) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.3678 -> 64.2616
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.0922 mb_mean=0.5016 norm_overlap=0.9549 corr_cb=-0.6481 topkJ=0.0000
[TRAIN][ep=011] loss=0.8500 acc=69.93%
[TRAIN][ep=011] mask_avg: mc_mean=0.0608 mb_mean=0.5015 norm_overlap=0.9642 corr_cb=-0.5713
[EPOCH 011/089] train: loss=0.8500 acc=69.93% | val: loss=0.5925 acc=72.29% f1=65.67% auc=75.93% val_score=47.9807 val_score_bestthr=63.0185 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.061, mb=0.501, no=0.964, corr=-0.571) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.3678 -> 63.0185
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.0357 mb_mean=0.5072 norm_overlap=0.9621 corr_cb=-0.5390 topkJ=0.0000
[TRAIN][ep=012] loss=0.8502 acc=68.99%
[TRAIN][ep=012] mask_avg: mc_mean=0.0578 mb_mean=0.5014 norm_overlap=0.9622 corr_cb=-0.5485
[EPOCH 012/089] train: loss=0.8502 acc=68.99% | val: loss=0.6283 acc=71.08% f1=64.71% auc=74.01% val_score=51.3437 val_score_bestthr=66.1865 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.058, mb=0.501, no=0.962, corr=-0.549) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 65.3678 -> 66.1865
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.0307 mb_mean=0.5080 norm_overlap=0.9533 corr_cb=-0.3696 topkJ=0.0000
[TRAIN][ep=013] loss=0.8377 acc=71.28%
[TRAIN][ep=013] mask_avg: mc_mean=0.0515 mb_mean=0.5015 norm_overlap=0.9595 corr_cb=-0.5256
[EPOCH 013/089] train: loss=0.8377 acc=71.28% | val: loss=0.5899 acc=72.29% f1=66.67% auc=75.41% val_score=59.7524 val_score_bestthr=66.6238 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.052, mb=0.501, no=0.959, corr=-0.526) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 66.1865 -> 66.6238
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.0577 mb_mean=0.4973 norm_overlap=0.9714 corr_cb=-0.4805 topkJ=0.0024
[TRAIN][ep=014] loss=0.8322 acc=71.41%
[TRAIN][ep=014] mask_avg: mc_mean=0.0518 mb_mean=0.5014 norm_overlap=0.9586 corr_cb=-0.5178
[EPOCH 014/089] train: loss=0.8322 acc=71.41% | val: loss=0.5835 acc=72.29% f1=66.67% auc=75.87% val_score=52.8036 val_score_bestthr=66.6238 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.052, mb=0.501, no=0.959, corr=-0.518) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6238 -> 66.6238
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.0310 mb_mean=0.5043 norm_overlap=0.9558 corr_cb=-0.4272 topkJ=0.0000
[TRAIN][ep=015] loss=0.8195 acc=72.48%
[TRAIN][ep=015] mask_avg: mc_mean=0.0550 mb_mean=0.5014 norm_overlap=0.9587 corr_cb=-0.5186
[EPOCH 015/089] train: loss=0.8195 acc=72.48% | val: loss=0.5740 acc=73.49% f1=68.57% auc=76.51% val_score=54.8728 val_score_bestthr=65.9223 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.055, mb=0.501, no=0.959, corr=-0.519) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6238 -> 65.9223
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.0357 mb_mean=0.5102 norm_overlap=0.9419 corr_cb=-0.5240 topkJ=0.0000
[TRAIN][ep=016] loss=0.8280 acc=71.54%
[TRAIN][ep=016] mask_avg: mc_mean=0.0469 mb_mean=0.5014 norm_overlap=0.9560 corr_cb=-0.4904
[EPOCH 016/089] train: loss=0.8280 acc=71.54% | val: loss=0.5745 acc=73.49% f1=68.57% auc=76.98% val_score=49.0913 val_score_bestthr=65.9223 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.047, mb=0.501, no=0.956, corr=-0.490) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6238 -> 65.9223
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.0578 mb_mean=0.4927 norm_overlap=0.9730 corr_cb=-0.4255 topkJ=0.0008
[TRAIN][ep=017] loss=0.8199 acc=71.28%
[TRAIN][ep=017] mask_avg: mc_mean=0.0426 mb_mean=0.5014 norm_overlap=0.9545 corr_cb=-0.4745
[EPOCH 017/089] train: loss=0.8199 acc=71.28% | val: loss=0.5797 acc=73.49% f1=68.57% auc=76.10% val_score=59.9141 val_score_bestthr=65.9223 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.043, mb=0.501, no=0.955, corr=-0.475) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6238 -> 65.9223
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.0490 mb_mean=0.5052 norm_overlap=0.9473 corr_cb=-0.5286 topkJ=0.0000
[TRAIN][ep=018] loss=0.8057 acc=72.75%
[TRAIN][ep=018] mask_avg: mc_mean=0.0584 mb_mean=0.5014 norm_overlap=0.9578 corr_cb=-0.5140
[EPOCH 018/089] train: loss=0.8057 acc=72.75% | val: loss=0.7114 acc=67.47% f1=73.27% auc=74.53% val_score=51.6446 val_score_bestthr=67.5365 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.058, mb=0.501, no=0.958, corr=-0.514) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 66.6238 -> 67.5365
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.0367 mb_mean=0.4998 norm_overlap=0.9534 corr_cb=-0.4662 topkJ=0.0000
[TRAIN][ep=019] loss=0.8317 acc=70.34%
[TRAIN][ep=019] mask_avg: mc_mean=0.0390 mb_mean=0.5014 norm_overlap=0.9527 corr_cb=-0.4579
[EPOCH 019/089] train: loss=0.8317 acc=70.34% | val: loss=0.6260 acc=67.47% f1=74.77% auc=75.70% val_score=60.2367 val_score_bestthr=66.4819 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.039, mb=0.501, no=0.953, corr=-0.458) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5365 -> 66.4819
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.0766 mb_mean=0.4956 norm_overlap=0.9529 corr_cb=-0.5795 topkJ=0.0000
[TRAIN][ep=020] loss=0.8108 acc=72.89%
[TRAIN][ep=020] mask_avg: mc_mean=0.0454 mb_mean=0.5014 norm_overlap=0.9544 corr_cb=-0.4819
[EPOCH 020/089] train: loss=0.8108 acc=72.89% | val: loss=0.5864 acc=73.49% f1=68.57% auc=76.92% val_score=58.7307 val_score_bestthr=65.9223 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.045, mb=0.501, no=0.954, corr=-0.482) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5365 -> 65.9223
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.0429 mb_mean=0.5057 norm_overlap=0.9444 corr_cb=-0.4634 topkJ=0.0000
[TRAIN][ep=021] loss=0.7920 acc=73.69%
[TRAIN][ep=021] mask_avg: mc_mean=0.0622 mb_mean=0.5014 norm_overlap=0.9577 corr_cb=-0.5220
[EPOCH 021/089] train: loss=0.7920 acc=73.69% | val: loss=0.5902 acc=66.27% f1=73.58% auc=77.15% val_score=58.7307 val_score_bestthr=67.0098 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.062, mb=0.501, no=0.958, corr=-0.522) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5365 -> 67.0098
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.0782 mb_mean=0.4985 norm_overlap=0.9654 corr_cb=-0.4702 topkJ=0.0000
[TRAIN][ep=022] loss=0.7959 acc=73.83%
[TRAIN][ep=022] mask_avg: mc_mean=0.0576 mb_mean=0.5014 norm_overlap=0.9565 corr_cb=-0.5098
[EPOCH 022/089] train: loss=0.7959 acc=73.83% | val: loss=0.5495 acc=66.27% f1=75.00% auc=78.08% val_score=61.2877 val_score_bestthr=69.6680 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.058, mb=0.501, no=0.956, corr=-0.510) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 67.5365 -> 69.6680
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.0439 mb_mean=0.5003 norm_overlap=0.9547 corr_cb=-0.4497 topkJ=0.0000
[TRAIN][ep=023] loss=0.8028 acc=72.62%
[TRAIN][ep=023] mask_avg: mc_mean=0.0458 mb_mean=0.5015 norm_overlap=0.9535 corr_cb=-0.4764
[EPOCH 023/089] train: loss=0.8028 acc=72.62% | val: loss=0.5534 acc=67.47% f1=71.58% auc=78.08% val_score=57.8118 val_score_bestthr=66.5969 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.046, mb=0.501, no=0.953, corr=-0.476) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.6680 -> 66.5969
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.0459 mb_mean=0.5001 norm_overlap=0.9619 corr_cb=-0.3868 topkJ=0.0000
[TRAIN][ep=024] loss=0.7720 acc=75.84%
[TRAIN][ep=024] mask_avg: mc_mean=0.0530 mb_mean=0.5014 norm_overlap=0.9552 corr_cb=-0.4915
[EPOCH 024/089] train: loss=0.7720 acc=75.84% | val: loss=0.5558 acc=75.90% f1=74.36% auc=78.14% val_score=57.1066 val_score_bestthr=68.2337 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.053, mb=0.501, no=0.955, corr=-0.491) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.6680 -> 68.2337
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.0514 mb_mean=0.5013 norm_overlap=0.9564 corr_cb=-0.5422 topkJ=0.0000
[TRAIN][ep=025] loss=0.7915 acc=73.69%
[TRAIN][ep=025] mask_avg: mc_mean=0.0502 mb_mean=0.5014 norm_overlap=0.9542 corr_cb=-0.4821
[EPOCH 025/089] train: loss=0.7915 acc=73.69% | val: loss=0.5554 acc=72.29% f1=72.29% auc=77.09% val_score=64.9703 val_score_bestthr=66.3844 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.050, mb=0.501, no=0.954, corr=-0.482) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.6680 -> 66.3844
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.0381 mb_mean=0.5025 norm_overlap=0.9490 corr_cb=-0.5162 topkJ=0.0000
[TRAIN][ep=026] loss=0.7680 acc=74.36%
[TRAIN][ep=026] mask_avg: mc_mean=0.0574 mb_mean=0.5014 norm_overlap=0.9561 corr_cb=-0.5037
[EPOCH 026/089] train: loss=0.7680 acc=74.36% | val: loss=0.5755 acc=74.70% f1=72.73% auc=78.66% val_score=60.3976 val_score_bestthr=69.5636 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.057, mb=0.501, no=0.956, corr=-0.504) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.6680 -> 69.5636
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.0747 mb_mean=0.5001 norm_overlap=0.9519 corr_cb=-0.5838 topkJ=0.0000
[TRAIN][ep=027] loss=0.7656 acc=74.23%
[TRAIN][ep=027] mask_avg: mc_mean=0.0621 mb_mean=0.5014 norm_overlap=0.9570 corr_cb=-0.5118
[EPOCH 027/089] train: loss=0.7656 acc=74.23% | val: loss=0.6039 acc=72.29% f1=72.94% auc=77.62% val_score=58.7307 val_score_bestthr=69.2820 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.062, mb=0.501, no=0.957, corr=-0.512) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.6680 -> 69.2820
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.0697 mb_mean=0.4951 norm_overlap=0.9720 corr_cb=-0.4179 topkJ=0.0000
[TRAIN][ep=028] loss=0.7631 acc=74.77%
[TRAIN][ep=028] mask_avg: mc_mean=0.0605 mb_mean=0.5015 norm_overlap=0.9565 corr_cb=-0.5046
[EPOCH 028/089] train: loss=0.7631 acc=74.77% | val: loss=0.5537 acc=77.11% f1=76.54% auc=79.19% val_score=58.6883 val_score_bestthr=74.5003 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.060, mb=0.501, no=0.957, corr=-0.505) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 69.6680 -> 74.5003
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.0737 mb_mean=0.4980 norm_overlap=0.9636 corr_cb=-0.5046 topkJ=0.0000
[TRAIN][ep=029] loss=0.7466 acc=78.66%
[TRAIN][ep=029] mask_avg: mc_mean=0.0581 mb_mean=0.5015 norm_overlap=0.9561 corr_cb=-0.5025
[EPOCH 029/089] train: loss=0.7466 acc=78.66% | val: loss=0.6016 acc=68.67% f1=75.93% auc=80.00% val_score=68.9564 val_score_bestthr=71.5991 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.058, mb=0.501, no=0.956, corr=-0.502) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.5003 -> 71.5991
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.0825 mb_mean=0.4961 norm_overlap=0.9684 corr_cb=-0.5508 topkJ=0.0000
[TRAIN][ep=030] loss=0.7515 acc=74.90%
[TRAIN][ep=030] mask_avg: mc_mean=0.0625 mb_mean=0.5015 norm_overlap=0.9569 corr_cb=-0.5108
[EPOCH 030/089] train: loss=0.7515 acc=74.90% | val: loss=0.5427 acc=75.90% f1=75.61% auc=80.00% val_score=60.1640 val_score_bestthr=73.3583 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.062, mb=0.501, no=0.957, corr=-0.511) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.5003 -> 73.3583
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.0587 mb_mean=0.5019 norm_overlap=0.9606 corr_cb=-0.5148 topkJ=0.0000
[TRAIN][ep=031] loss=0.7325 acc=77.58%
[TRAIN][ep=031] mask_avg: mc_mean=0.0655 mb_mean=0.5015 norm_overlap=0.9575 corr_cb=-0.5159
[EPOCH 031/089] train: loss=0.7325 acc=77.58% | val: loss=0.5490 acc=75.90% f1=75.61% auc=79.13% val_score=63.4226 val_score_bestthr=73.9054 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.065, mb=0.501, no=0.958, corr=-0.516) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.5003 -> 73.9054
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.0597 mb_mean=0.4988 norm_overlap=0.9565 corr_cb=-0.5750 topkJ=0.0000
[TRAIN][ep=032] loss=0.7404 acc=77.85%
[TRAIN][ep=032] mask_avg: mc_mean=0.0669 mb_mean=0.5014 norm_overlap=0.9582 corr_cb=-0.5122
[EPOCH 032/089] train: loss=0.7404 acc=77.85% | val: loss=0.5519 acc=74.70% f1=74.07% auc=80.29% val_score=58.9681 val_score_bestthr=74.8669 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.067, mb=0.501, no=0.958, corr=-0.512) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 74.5003 -> 74.8669
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.0780 mb_mean=0.4952 norm_overlap=0.9705 corr_cb=-0.4884 topkJ=0.0004
[TRAIN][ep=033] loss=0.7211 acc=77.32%
[TRAIN][ep=033] mask_avg: mc_mean=0.0636 mb_mean=0.5014 norm_overlap=0.9575 corr_cb=-0.5005
[EPOCH 033/089] train: loss=0.7211 acc=77.32% | val: loss=0.5586 acc=74.70% f1=75.86% auc=79.83% val_score=54.5230 val_score_bestthr=76.0816 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.064, mb=0.501, no=0.958, corr=-0.500) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 74.8669 -> 76.0816
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.0871 mb_mean=0.5028 norm_overlap=0.9593 corr_cb=-0.6033 topkJ=0.0000
[TRAIN][ep=034] loss=0.7233 acc=75.70%
[TRAIN][ep=034] mask_avg: mc_mean=0.0788 mb_mean=0.5014 norm_overlap=0.9597 corr_cb=-0.5170
[EPOCH 034/089] train: loss=0.7233 acc=75.70% | val: loss=0.5384 acc=71.08% f1=73.91% auc=79.65% val_score=62.0977 val_score_bestthr=72.1808 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.079, mb=0.501, no=0.960, corr=-0.517) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.0816 -> 72.1808
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.0380 mb_mean=0.5037 norm_overlap=0.9556 corr_cb=-0.4417 topkJ=0.0000
[TRAIN][ep=035] loss=0.7112 acc=80.00%
[TRAIN][ep=035] mask_avg: mc_mean=0.0656 mb_mean=0.5014 norm_overlap=0.9579 corr_cb=-0.5031
[EPOCH 035/089] train: loss=0.7112 acc=80.00% | val: loss=0.5310 acc=74.70% f1=77.89% auc=81.63% val_score=57.5059 val_score_bestthr=75.7760 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.066, mb=0.501, no=0.958, corr=-0.503) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.0816 -> 75.7760
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.0689 mb_mean=0.4983 norm_overlap=0.9578 corr_cb=-0.5407 topkJ=0.0000
[TRAIN][ep=036] loss=0.7196 acc=77.99%
[TRAIN][ep=036] mask_avg: mc_mean=0.0727 mb_mean=0.5015 norm_overlap=0.9590 corr_cb=-0.5162
[EPOCH 036/089] train: loss=0.7196 acc=77.99% | val: loss=0.5671 acc=73.49% f1=77.55% auc=80.76% val_score=55.9281 val_score_bestthr=74.5060 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.073, mb=0.501, no=0.959, corr=-0.516) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.0816 -> 74.5060
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.0443 mb_mean=0.5046 norm_overlap=0.9511 corr_cb=-0.4949 topkJ=0.0000
[TRAIN][ep=037] loss=0.7065 acc=78.79%
[TRAIN][ep=037] mask_avg: mc_mean=0.0698 mb_mean=0.5014 norm_overlap=0.9585 corr_cb=-0.5089
[EPOCH 037/089] train: loss=0.7065 acc=78.79% | val: loss=0.5605 acc=72.29% f1=74.73% auc=81.51% val_score=55.0122 val_score_bestthr=73.7103 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.070, mb=0.501, no=0.959, corr=-0.509) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.0816 -> 73.7103
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.0750 mb_mean=0.4966 norm_overlap=0.9679 corr_cb=-0.5341 topkJ=0.0000
[TRAIN][ep=038] loss=0.7259 acc=77.45%
[TRAIN][ep=038] mask_avg: mc_mean=0.0420 mb_mean=0.5014 norm_overlap=0.9520 corr_cb=-0.4334
[EPOCH 038/089] train: loss=0.7259 acc=77.45% | val: loss=0.5332 acc=71.08% f1=73.91% auc=81.10% val_score=65.3839 val_score_bestthr=73.1953 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.042, mb=0.501, no=0.952, corr=-0.433) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.0816 -> 73.1953
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.0426 mb_mean=0.5081 norm_overlap=0.9450 corr_cb=-0.5073 topkJ=0.0000
[TRAIN][ep=039] loss=0.6819 acc=80.94%
[TRAIN][ep=039] mask_avg: mc_mean=0.0787 mb_mean=0.5015 norm_overlap=0.9602 corr_cb=-0.5225
[EPOCH 039/089] train: loss=0.6819 acc=80.94% | val: loss=0.5330 acc=73.49% f1=75.56% auc=81.92% val_score=69.8061 val_score_bestthr=75.7643 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.079, mb=0.501, no=0.960, corr=-0.522) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.0816 -> 75.7643
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.1028 mb_mean=0.5035 norm_overlap=0.9531 corr_cb=-0.6335 topkJ=0.0000
[TRAIN][ep=040] loss=0.6901 acc=79.46%
[TRAIN][ep=040] mask_avg: mc_mean=0.0754 mb_mean=0.5014 norm_overlap=0.9599 corr_cb=-0.5097
[EPOCH 040/089] train: loss=0.6901 acc=79.46% | val: loss=0.5576 acc=75.90% f1=75.61% auc=81.57% val_score=69.4162 val_score_bestthr=74.5177 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.075, mb=0.501, no=0.960, corr=-0.510) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.0816 -> 74.5177
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.0933 mb_mean=0.5010 norm_overlap=0.9556 corr_cb=-0.6067 topkJ=0.0000
[TRAIN][ep=041] loss=0.6968 acc=78.12%
[TRAIN][ep=041] mask_avg: mc_mean=0.0746 mb_mean=0.5014 norm_overlap=0.9596 corr_cb=-0.5067
[EPOCH 041/089] train: loss=0.6968 acc=78.12% | val: loss=0.5475 acc=73.49% f1=76.09% auc=82.03% val_score=66.4816 val_score_bestthr=79.0251 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.075, mb=0.501, no=0.960, corr=-0.507) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 76.0816 -> 79.0251
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.0826 mb_mean=0.4956 norm_overlap=0.9718 corr_cb=-0.4709 topkJ=0.0000
[TRAIN][ep=042] loss=0.6862 acc=80.54%
[TRAIN][ep=042] mask_avg: mc_mean=0.0802 mb_mean=0.5014 norm_overlap=0.9604 corr_cb=-0.5064
[EPOCH 042/089] train: loss=0.6862 acc=80.54% | val: loss=0.5274 acc=74.70% f1=76.92% auc=82.15% val_score=62.7118 val_score_bestthr=76.2901 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.080, mb=0.501, no=0.960, corr=-0.506) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 76.2901
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.0394 mb_mean=0.4997 norm_overlap=0.9587 corr_cb=-0.4693 topkJ=0.0000
[TRAIN][ep=043] loss=0.7650 acc=77.99%
[TRAIN][ep=043] mask_avg: mc_mean=0.0678 mb_mean=0.5014 norm_overlap=0.9587 corr_cb=-0.4885
[EPOCH 043/089] train: loss=0.7650 acc=77.99% | val: loss=0.6803 acc=75.90% f1=78.26% auc=81.98% val_score=52.4567 val_score_bestthr=73.7124 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.068, mb=0.501, no=0.959, corr=-0.489) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 73.7124
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.0488 mb_mean=0.5072 norm_overlap=0.9495 corr_cb=-0.5115 topkJ=0.0000
[TRAIN][ep=044] loss=0.6684 acc=80.13%
[TRAIN][ep=044] mask_avg: mc_mean=0.0771 mb_mean=0.5015 norm_overlap=0.9603 corr_cb=-0.5082
[EPOCH 044/089] train: loss=0.6684 acc=80.13% | val: loss=0.5480 acc=73.49% f1=77.08% auc=82.27% val_score=68.2151 val_score_bestthr=72.3516 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.077, mb=0.501, no=0.960, corr=-0.508) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 72.3516
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.0813 mb_mean=0.4984 norm_overlap=0.9612 corr_cb=-0.4566 topkJ=0.0000
[TRAIN][ep=045] loss=0.6542 acc=82.55%
[TRAIN][ep=045] mask_avg: mc_mean=0.0840 mb_mean=0.5014 norm_overlap=0.9613 corr_cb=-0.5133
[EPOCH 045/089] train: loss=0.6542 acc=82.55% | val: loss=0.5682 acc=75.90% f1=79.17% auc=82.33% val_score=70.5913 val_score_bestthr=76.7960 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.084, mb=0.501, no=0.961, corr=-0.513) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 76.7960
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.1042 mb_mean=0.4955 norm_overlap=0.9701 corr_cb=-0.4977 topkJ=0.0000
[TRAIN][ep=046] loss=0.7255 acc=81.21%
[TRAIN][ep=046] mask_avg: mc_mean=0.0777 mb_mean=0.5015 norm_overlap=0.9599 corr_cb=-0.4992
[EPOCH 046/089] train: loss=0.7255 acc=81.21% | val: loss=0.6133 acc=78.31% f1=78.57% auc=82.03% val_score=55.9281 val_score_bestthr=74.3994 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.078, mb=0.501, no=0.960, corr=-0.499) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 74.3994
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.0774 mb_mean=0.5047 norm_overlap=0.9630 corr_cb=-0.5327 topkJ=0.0000
[TRAIN][ep=047] loss=0.6483 acc=80.81%
[TRAIN][ep=047] mask_avg: mc_mean=0.0885 mb_mean=0.5014 norm_overlap=0.9620 corr_cb=-0.5120
[EPOCH 047/089] train: loss=0.6483 acc=80.81% | val: loss=0.5632 acc=74.70% f1=79.21% auc=82.09% val_score=72.8339 val_score_bestthr=77.8191 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.088, mb=0.501, no=0.962, corr=-0.512) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 77.8191
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.0893 mb_mean=0.4955 norm_overlap=0.9675 corr_cb=-0.4924 topkJ=0.0000
[TRAIN][ep=048] loss=0.6662 acc=81.34%
[TRAIN][ep=048] mask_avg: mc_mean=0.0832 mb_mean=0.5014 norm_overlap=0.9610 corr_cb=-0.5056
[EPOCH 048/089] train: loss=0.6662 acc=81.34% | val: loss=0.5456 acc=73.49% f1=75.00% auc=81.45% val_score=65.4105 val_score_bestthr=71.7038 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.083, mb=0.501, no=0.961, corr=-0.506) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 71.7038
[DBG][ep=049] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.0477 mb_mean=0.5049 norm_overlap=0.9567 corr_cb=-0.4733 topkJ=0.0000
[TRAIN][ep=049] loss=0.6381 acc=81.48%
[TRAIN][ep=049] mask_avg: mc_mean=0.0762 mb_mean=0.5014 norm_overlap=0.9601 corr_cb=-0.4954
[EPOCH 049/089] train: loss=0.6381 acc=81.48% | val: loss=0.6264 acc=69.88% f1=76.19% auc=81.28% val_score=55.9281 val_score_bestthr=73.0634 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.076, mb=0.501, no=0.960, corr=-0.495) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 73.0634
[DBG][ep=050] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.0730 mb_mean=0.5029 norm_overlap=0.9578 corr_cb=-0.4615 topkJ=0.0000
[TRAIN][ep=050] loss=0.6066 acc=84.56%
[TRAIN][ep=050] mask_avg: mc_mean=0.0815 mb_mean=0.5015 norm_overlap=0.9609 corr_cb=-0.5028
[EPOCH 050/089] train: loss=0.6066 acc=84.56% | val: loss=0.5974 acc=74.70% f1=78.35% auc=81.51% val_score=55.2534 val_score_bestthr=76.3235 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.503) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 76.3235
[DBG][ep=051] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.0770 mb_mean=0.5035 norm_overlap=0.9571 corr_cb=-0.5475 topkJ=0.0000
[TRAIN][ep=051] loss=0.6049 acc=84.97%
[TRAIN][ep=051] mask_avg: mc_mean=0.0816 mb_mean=0.5015 norm_overlap=0.9611 corr_cb=-0.5009
[EPOCH 051/089] train: loss=0.6049 acc=84.97% | val: loss=0.5807 acc=73.49% f1=77.08% auc=81.40% val_score=58.8580 val_score_bestthr=71.6560 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.501) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 71.6560
[DBG][ep=052] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.1062 mb_mean=0.4999 norm_overlap=0.9608 corr_cb=-0.5218 topkJ=0.0000
[TRAIN][ep=052] loss=0.6014 acc=86.04%
[TRAIN][ep=052] mask_avg: mc_mean=0.0816 mb_mean=0.5014 norm_overlap=0.9611 corr_cb=-0.5026
[EPOCH 052/089] train: loss=0.6014 acc=86.04% | val: loss=0.5595 acc=73.49% f1=77.08% auc=81.40% val_score=67.6328 val_score_bestthr=72.8734 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.503) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 72.8734
[DBG][ep=053] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.0746 mb_mean=0.5085 norm_overlap=0.9438 corr_cb=-0.5056 topkJ=0.0000
[TRAIN][ep=053] loss=0.5996 acc=84.83%
[TRAIN][ep=053] mask_avg: mc_mean=0.0815 mb_mean=0.5015 norm_overlap=0.9610 corr_cb=-0.5034
[EPOCH 053/089] train: loss=0.5996 acc=84.83% | val: loss=0.5593 acc=74.70% f1=77.89% auc=81.22% val_score=68.1889 val_score_bestthr=74.8086 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.503) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 74.8086
[DBG][ep=054] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=054] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=054] mask(step0): mc_mean=0.0766 mb_mean=0.5047 norm_overlap=0.9552 corr_cb=-0.4915 topkJ=0.0000
[TRAIN][ep=054] loss=0.6009 acc=85.10%
[TRAIN][ep=054] mask_avg: mc_mean=0.0816 mb_mean=0.5014 norm_overlap=0.9609 corr_cb=-0.5038
[EPOCH 054/089] train: loss=0.6009 acc=85.10% | val: loss=0.5827 acc=72.29% f1=76.77% auc=80.87% val_score=58.8580 val_score_bestthr=74.6040 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.504) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 74.6040
[DBG][ep=055] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=055] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=055] mask(step0): mc_mean=0.0752 mb_mean=0.5009 norm_overlap=0.9623 corr_cb=-0.5673 topkJ=0.0000
[TRAIN][ep=055] loss=0.5955 acc=85.23%
[TRAIN][ep=055] mask_avg: mc_mean=0.0817 mb_mean=0.5014 norm_overlap=0.9611 corr_cb=-0.5001
[EPOCH 055/089] train: loss=0.5955 acc=85.23% | val: loss=0.5893 acc=73.49% f1=77.55% auc=81.10% val_score=58.8580 val_score_bestthr=75.7234 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.500) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 75.7234
[DBG][ep=056] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=056] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=056] mask(step0): mc_mean=0.0929 mb_mean=0.5009 norm_overlap=0.9630 corr_cb=-0.5240 topkJ=0.0000
[TRAIN][ep=056] loss=0.5910 acc=85.50%
[TRAIN][ep=056] mask_avg: mc_mean=0.0816 mb_mean=0.5014 norm_overlap=0.9609 corr_cb=-0.5052
[EPOCH 056/089] train: loss=0.5910 acc=85.50% | val: loss=0.5774 acc=73.49% f1=77.55% auc=81.10% val_score=65.7296 val_score_bestthr=75.7234 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.505) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 75.7234
[DBG][ep=057] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=057] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=057] mask(step0): mc_mean=0.1169 mb_mean=0.4930 norm_overlap=0.9768 corr_cb=-0.5050 topkJ=0.0032
[TRAIN][ep=057] loss=0.5972 acc=85.37%
[TRAIN][ep=057] mask_avg: mc_mean=0.0816 mb_mean=0.5014 norm_overlap=0.9608 corr_cb=-0.5045
[EPOCH 057/089] train: loss=0.5972 acc=85.37% | val: loss=0.5756 acc=72.29% f1=76.77% auc=81.28% val_score=67.7710 val_score_bestthr=74.6040 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.504) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 74.6040
[DBG][ep=058] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=058] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=058] mask(step0): mc_mean=0.1133 mb_mean=0.5023 norm_overlap=0.9606 corr_cb=-0.4998 topkJ=0.0000
[TRAIN][ep=058] loss=0.5942 acc=85.64%
[TRAIN][ep=058] mask_avg: mc_mean=0.0816 mb_mean=0.5014 norm_overlap=0.9610 corr_cb=-0.5032
[EPOCH 058/089] train: loss=0.5942 acc=85.64% | val: loss=0.5760 acc=72.29% f1=76.77% auc=81.16% val_score=67.7710 val_score_bestthr=74.6040 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.503) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 74.6040
[DBG][ep=059] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=059] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=059] mask(step0): mc_mean=0.0775 mb_mean=0.5009 norm_overlap=0.9581 corr_cb=-0.5529 topkJ=0.0000
[TRAIN][ep=059] loss=0.5985 acc=84.43%
[TRAIN][ep=059] mask_avg: mc_mean=0.0816 mb_mean=0.5014 norm_overlap=0.9609 corr_cb=-0.5046
[EPOCH 059/089] train: loss=0.5985 acc=84.43% | val: loss=0.6010 acc=73.49% f1=77.55% auc=81.22% val_score=59.5758 val_score_bestthr=75.7234 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.505) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 75.7234
[DBG][ep=060] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=060] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=060] mask(step0): mc_mean=0.0655 mb_mean=0.5029 norm_overlap=0.9619 corr_cb=-0.4689 topkJ=0.0000
[TRAIN][ep=060] loss=0.5913 acc=85.50%
[TRAIN][ep=060] mask_avg: mc_mean=0.0815 mb_mean=0.5015 norm_overlap=0.9609 corr_cb=-0.5036
[EPOCH 060/089] train: loss=0.5913 acc=85.50% | val: loss=0.5977 acc=73.49% f1=78.00% auc=81.10% val_score=59.5758 val_score_bestthr=73.7939 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.504) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 73.7939
[DBG][ep=061] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=061] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=061] mask(step0): mc_mean=0.1476 mb_mean=0.4912 norm_overlap=0.9769 corr_cb=-0.4797 topkJ=0.0000
[TRAIN][ep=061] loss=0.5909 acc=84.43%
[TRAIN][ep=061] mask_avg: mc_mean=0.0816 mb_mean=0.5014 norm_overlap=0.9611 corr_cb=-0.5019
[EPOCH 061/089] train: loss=0.5909 acc=84.43% | val: loss=0.5883 acc=73.49% f1=77.55% auc=81.05% val_score=58.4318 val_score_bestthr=75.7234 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.502) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 75.7234
[DBG][ep=062] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=062] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=062] mask(step0): mc_mean=0.0491 mb_mean=0.5065 norm_overlap=0.9576 corr_cb=-0.4821 topkJ=0.0000
[TRAIN][ep=062] loss=0.5903 acc=85.37%
[TRAIN][ep=062] mask_avg: mc_mean=0.0817 mb_mean=0.5014 norm_overlap=0.9610 corr_cb=-0.5043
[EPOCH 062/089] train: loss=0.5903 acc=85.37% | val: loss=0.5737 acc=72.29% f1=76.77% auc=81.16% val_score=68.1889 val_score_bestthr=74.6040 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.504) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 74.6040
[DBG][ep=063] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=063] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=063] mask(step0): mc_mean=0.0791 mb_mean=0.4998 norm_overlap=0.9687 corr_cb=-0.4693 topkJ=0.0008
[TRAIN][ep=063] loss=0.5923 acc=84.97%
[TRAIN][ep=063] mask_avg: mc_mean=0.0816 mb_mean=0.5014 norm_overlap=0.9610 corr_cb=-0.5047
[EPOCH 063/089] train: loss=0.5923 acc=84.97% | val: loss=0.5839 acc=72.29% f1=76.77% auc=80.81% val_score=66.6278 val_score_bestthr=74.6040 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.505) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 74.6040
[DBG][ep=064] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=064] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=064] mask(step0): mc_mean=0.0966 mb_mean=0.4966 norm_overlap=0.9752 corr_cb=-0.4704 topkJ=0.0039
[TRAIN][ep=064] loss=0.5860 acc=86.71%
[TRAIN][ep=064] mask_avg: mc_mean=0.0816 mb_mean=0.5014 norm_overlap=0.9608 corr_cb=-0.5035
[EPOCH 064/089] train: loss=0.5860 acc=86.71% | val: loss=0.5876 acc=74.70% f1=77.89% auc=80.64% val_score=59.3378 val_score_bestthr=73.9970 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.504) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 73.9970
[DBG][ep=065] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=065] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=065] mask(step0): mc_mean=0.0768 mb_mean=0.5017 norm_overlap=0.9590 corr_cb=-0.5328 topkJ=0.0000
[TRAIN][ep=065] loss=0.5816 acc=85.50%
[TRAIN][ep=065] mask_avg: mc_mean=0.0816 mb_mean=0.5015 norm_overlap=0.9610 corr_cb=-0.5028
[EPOCH 065/089] train: loss=0.5816 acc=85.50% | val: loss=0.6323 acc=77.11% f1=76.54% auc=80.64% val_score=55.2534 val_score_bestthr=75.7177 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.503) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 75.7177
[DBG][ep=066] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=066] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=066] mask(step0): mc_mean=0.0888 mb_mean=0.5007 norm_overlap=0.9649 corr_cb=-0.5455 topkJ=0.0000
[TRAIN][ep=066] loss=0.5828 acc=85.37%
[TRAIN][ep=066] mask_avg: mc_mean=0.0816 mb_mean=0.5015 norm_overlap=0.9608 corr_cb=-0.5057
[EPOCH 066/089] train: loss=0.5828 acc=85.37% | val: loss=0.5926 acc=72.29% f1=76.77% auc=80.99% val_score=58.4318 val_score_bestthr=74.6040 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.506) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 74.6040
[DBG][ep=067] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=067] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=067] mask(step0): mc_mean=0.0805 mb_mean=0.5058 norm_overlap=0.9479 corr_cb=-0.5301 topkJ=0.0000
[TRAIN][ep=067] loss=0.5805 acc=85.77%
[TRAIN][ep=067] mask_avg: mc_mean=0.0816 mb_mean=0.5014 norm_overlap=0.9609 corr_cb=-0.5060
[EPOCH 067/089] train: loss=0.5805 acc=85.77% | val: loss=0.5854 acc=75.90% f1=78.72% auc=80.87% val_score=66.6278 val_score_bestthr=75.9348 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.506) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 75.9348
[DBG][ep=068] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=068] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=068] mask(step0): mc_mean=0.0720 mb_mean=0.5032 norm_overlap=0.9604 corr_cb=-0.5251 topkJ=0.0004
[TRAIN][ep=068] loss=0.5777 acc=85.91%
[TRAIN][ep=068] mask_avg: mc_mean=0.0817 mb_mean=0.5014 norm_overlap=0.9609 corr_cb=-0.5031
[EPOCH 068/089] train: loss=0.5777 acc=85.91% | val: loss=0.6848 acc=74.70% f1=77.89% auc=80.17% val_score=56.8352 val_score_bestthr=73.9970 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.503) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 73.9970
[DBG][ep=069] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=069] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=069] mask(step0): mc_mean=0.0974 mb_mean=0.5002 norm_overlap=0.9610 corr_cb=-0.5767 topkJ=0.0000
[TRAIN][ep=069] loss=0.5894 acc=84.83%
[TRAIN][ep=069] mask_avg: mc_mean=0.0816 mb_mean=0.5014 norm_overlap=0.9610 corr_cb=-0.5034
[EPOCH 069/089] train: loss=0.5894 acc=84.83% | val: loss=0.5798 acc=73.49% f1=77.55% auc=81.16% val_score=72.2198 val_score_bestthr=76.4190 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.503) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 76.4190
[DBG][ep=070] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=070] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=070] mask(step0): mc_mean=0.0828 mb_mean=0.4982 norm_overlap=0.9699 corr_cb=-0.5059 topkJ=0.0000
[TRAIN][ep=070] loss=0.5805 acc=86.44%
[TRAIN][ep=070] mask_avg: mc_mean=0.0816 mb_mean=0.5014 norm_overlap=0.9610 corr_cb=-0.5032
[EPOCH 070/089] train: loss=0.5805 acc=86.44% | val: loss=0.5836 acc=74.70% f1=77.89% auc=80.87% val_score=72.2198 val_score_bestthr=74.8086 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.503) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 74.8086
[DBG][ep=071] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=071] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=071] mask(step0): mc_mean=0.0945 mb_mean=0.4983 norm_overlap=0.9596 corr_cb=-0.5673 topkJ=0.0000
[TRAIN][ep=071] loss=0.5786 acc=85.77%
[TRAIN][ep=071] mask_avg: mc_mean=0.0816 mb_mean=0.5014 norm_overlap=0.9609 corr_cb=-0.5078
[EPOCH 071/089] train: loss=0.5786 acc=85.77% | val: loss=0.5939 acc=72.29% f1=76.77% auc=80.70% val_score=69.3263 val_score_bestthr=74.6040 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.082, mb=0.501, no=0.961, corr=-0.508) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 79.0251 -> 74.6040
[EARLY STOP] no improvement for 30 epochs. best_epoch=41
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/ckpt_best_fold_0.pt
=============== FIT DONE ===============
[BEST] epoch=41 | val_acc=73.49% | val_f1=76.09% | val_auc=82.03% | val_score=66.4816 | val_score_bestthr=79.0251
[TEST@BEST] thr_used=0.195 | acc=58.45% f1=68.15% auc=64.26% | SP_sex=7.81% EO_sex=3.27% SP_age=10.29% EO_age=11.06%
[TIME] 1.79 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold0_rep1_seed1000/summary_fold_0.json
