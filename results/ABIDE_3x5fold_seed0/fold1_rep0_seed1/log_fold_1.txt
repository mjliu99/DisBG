[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4855 mb_mean=0.5049 norm_overlap=1.0000 corr_cb=0.0473 topkJ=0.1080
[TRAIN][ep=000] loss=0.6943 acc=51.28%
[TRAIN][ep=000] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1097
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4906 mb_mean=0.5028 norm_overlap=1.0002 corr_cb=0.3495 topkJ=0.0900
[TRAIN][ep=001] loss=0.6925 acc=53.29%
[TRAIN][ep=001] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1148
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4863 mb_mean=0.5023 norm_overlap=1.0001 corr_cb=0.0850 topkJ=0.0855
[TRAIN][ep=002] loss=0.6924 acc=53.29%
[TRAIN][ep=002] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1042
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4827 mb_mean=0.5045 norm_overlap=1.0001 corr_cb=0.1327 topkJ=0.1111
[TRAIN][ep=003] loss=0.6909 acc=52.62%
[TRAIN][ep=003] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1168
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4839 mb_mean=0.5059 norm_overlap=1.0001 corr_cb=0.1207 topkJ=0.1266
[TRAIN][ep=004] loss=0.6905 acc=57.05%
[TRAIN][ep=004] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1129
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4874 mb_mean=0.5023 norm_overlap=1.0001 corr_cb=0.2085 topkJ=0.0997
[TRAIN][ep=005] loss=0.6900 acc=54.36%
[TRAIN][ep=005] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1147
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4933 mb_mean=0.5052 norm_overlap=1.0001 corr_cb=0.1915 topkJ=0.0991
[TRAIN][ep=006] loss=0.6887 acc=53.56%
[TRAIN][ep=006] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1051
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4811 mb_mean=0.5022 norm_overlap=1.0001 corr_cb=0.1599 topkJ=0.1247
[TRAIN][ep=007] loss=0.6866 acc=57.18%
[TRAIN][ep=007] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1165
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4923 mb_mean=0.5061 norm_overlap=1.0000 corr_cb=-0.0490 topkJ=0.0591
[TRAIN][ep=008] loss=0.6859 acc=59.06%
[TRAIN][ep=008] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1064
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4885 mb_mean=0.5031 norm_overlap=1.0001 corr_cb=0.1442 topkJ=0.0897
[TRAIN][ep=009] loss=0.6857 acc=59.33%
[TRAIN][ep=009] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1185
================= FIT START (fold=1) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4904 mb_mean=0.5056 norm_overlap=1.0001 corr_cb=0.1620 topkJ=0.1007
[TRAIN][ep=000] loss=0.6835 acc=58.26%
[TRAIN][ep=000] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1145
[EPOCH 000/089] train: loss=0.6835 acc=58.26% | val: loss=0.6878 acc=57.83% f1=67.89% auc=57.27% val_score=41.3159 val_score_bestthr=63.0994 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.115) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 63.0994
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4891 mb_mean=0.5036 norm_overlap=1.0002 corr_cb=0.2700 topkJ=0.1255
[TRAIN][ep=001] loss=0.6807 acc=63.89%
[TRAIN][ep=001] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1127
[EPOCH 001/089] train: loss=0.6807 acc=63.89% | val: loss=0.6866 acc=55.42% f1=69.92% auc=57.15% val_score=57.8359 val_score_bestthr=62.6871 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.113) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.0994 -> 62.6871
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4874 mb_mean=0.5035 norm_overlap=1.0000 corr_cb=0.0912 topkJ=0.0898
[TRAIN][ep=002] loss=0.6789 acc=61.88%
[TRAIN][ep=002] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1172
[EPOCH 002/089] train: loss=0.6789 acc=61.88% | val: loss=0.6860 acc=60.24% f1=66.67% auc=57.09% val_score=59.1323 val_score_bestthr=59.1323 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.117) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.0994 -> 59.1323
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4901 mb_mean=0.5043 norm_overlap=1.0001 corr_cb=0.1890 topkJ=0.1067
[TRAIN][ep=003] loss=0.6766 acc=60.81%
[TRAIN][ep=003] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1173
[EPOCH 003/089] train: loss=0.6766 acc=60.81% | val: loss=0.6863 acc=55.42% f1=69.92% auc=55.81% val_score=58.2105 val_score_bestthr=62.6871 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.117) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.0994 -> 62.6871
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4879 mb_mean=0.5014 norm_overlap=1.0004 corr_cb=0.5752 topkJ=0.1843
[TRAIN][ep=004] loss=0.6756 acc=60.54%
[TRAIN][ep=004] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1096
[EPOCH 004/089] train: loss=0.6756 acc=60.54% | val: loss=0.6854 acc=61.45% f1=69.81% auc=56.98% val_score=42.5886 val_score_bestthr=66.0310 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.110) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 63.0994 -> 66.0310
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4909 mb_mean=0.5055 norm_overlap=1.0002 corr_cb=0.3822 topkJ=0.1455
[TRAIN][ep=005] loss=1.2705 acc=60.13%
[TRAIN][ep=005] mask_avg: mc_mean=0.3807 mb_mean=0.5039 norm_overlap=1.0003 corr_cb=0.1202
[EPOCH 005/089] train: loss=1.2705 acc=60.13% | val: loss=0.6843 acc=59.04% f1=66.67% auc=57.38% val_score=57.8359 val_score_bestthr=61.6101 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.381, mb=0.504, no=1.000, corr=0.120) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 61.6101
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2786 mb_mean=0.5027 norm_overlap=1.0025 corr_cb=0.4452 topkJ=0.1480
[TRAIN][ep=006] loss=1.2584 acc=63.76%
[TRAIN][ep=006] mask_avg: mc_mean=0.2649 mb_mean=0.5039 norm_overlap=1.0006 corr_cb=0.1109
[EPOCH 006/089] train: loss=1.2584 acc=63.76% | val: loss=0.6839 acc=59.04% f1=66.00% auc=56.98% val_score=59.5546 val_score_bestthr=59.3002 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.265, mb=0.504, no=1.001, corr=0.111) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 59.3002
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2453 mb_mean=0.5043 norm_overlap=1.0011 corr_cb=0.1528 topkJ=0.1129
[TRAIN][ep=007] loss=1.2518 acc=63.89%
[TRAIN][ep=007] mask_avg: mc_mean=0.2333 mb_mean=0.5039 norm_overlap=1.0006 corr_cb=0.0815
[EPOCH 007/089] train: loss=1.2518 acc=63.89% | val: loss=0.6846 acc=59.04% f1=67.92% auc=56.69% val_score=48.1818 val_score_bestthr=63.4899 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.233, mb=0.504, no=1.001, corr=0.082) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 63.4899
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2426 mb_mean=0.5056 norm_overlap=1.0000 corr_cb=0.0034 topkJ=0.0946
[TRAIN][ep=008] loss=1.2444 acc=65.10%
[TRAIN][ep=008] mask_avg: mc_mean=0.2160 mb_mean=0.5039 norm_overlap=1.0004 corr_cb=0.0513
[EPOCH 008/089] train: loss=1.2444 acc=65.10% | val: loss=0.6830 acc=56.63% f1=70.00% auc=56.51% val_score=57.4676 val_score_bestthr=62.1241 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.216, mb=0.504, no=1.000, corr=0.051) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 62.1241
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2028 mb_mean=0.5044 norm_overlap=1.0002 corr_cb=0.0263 topkJ=0.0757
[TRAIN][ep=009] loss=1.2396 acc=62.95%
[TRAIN][ep=009] mask_avg: mc_mean=0.2061 mb_mean=0.5039 norm_overlap=1.0002 corr_cb=0.0252
[EPOCH 009/089] train: loss=1.2396 acc=62.95% | val: loss=0.6857 acc=60.24% f1=68.57% auc=56.63% val_score=42.5274 val_score_bestthr=62.9220 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.206, mb=0.504, no=1.000, corr=0.025) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 62.9220
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.2079 mb_mean=0.5054 norm_overlap=1.0000 corr_cb=-0.0007 topkJ=0.0486
[TRAIN][ep=010] loss=0.9981 acc=63.62%
[TRAIN][ep=010] mask_avg: mc_mean=0.1938 mb_mean=0.5039 norm_overlap=1.0000 corr_cb=-0.0017
[EPOCH 010/089] train: loss=0.9981 acc=63.62% | val: loss=0.6814 acc=59.04% f1=65.31% auc=56.74% val_score=59.2547 val_score_bestthr=59.4650 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.194, mb=0.504, no=1.000, corr=-0.002) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 59.4650
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.2094 mb_mean=0.5045 norm_overlap=1.0002 corr_cb=0.0191 topkJ=0.0658
[TRAIN][ep=011] loss=0.7578 acc=64.16%
[TRAIN][ep=011] mask_avg: mc_mean=0.1955 mb_mean=0.5039 norm_overlap=0.9995 corr_cb=-0.0396
[EPOCH 011/089] train: loss=0.7578 acc=64.16% | val: loss=0.6812 acc=60.24% f1=65.98% auc=56.63% val_score=59.3002 val_score_bestthr=60.5708 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.195, mb=0.504, no=1.000, corr=-0.040) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 60.5708
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1841 mb_mean=0.5042 norm_overlap=1.0003 corr_cb=0.0293 topkJ=0.0689
[TRAIN][ep=012] loss=0.6969 acc=63.76%
[TRAIN][ep=012] mask_avg: mc_mean=0.1824 mb_mean=0.5039 norm_overlap=0.9993 corr_cb=-0.0551
[EPOCH 012/089] train: loss=0.6969 acc=63.76% | val: loss=0.6821 acc=59.04% f1=67.31% auc=56.16% val_score=55.5716 val_score_bestthr=63.8842 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.182, mb=0.504, no=0.999, corr=-0.055) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 63.8842
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.2045 mb_mean=0.5031 norm_overlap=0.9987 corr_cb=-0.1069 topkJ=0.0911
[TRAIN][ep=013] loss=0.6768 acc=64.83%
[TRAIN][ep=013] mask_avg: mc_mean=0.1797 mb_mean=0.5039 norm_overlap=0.9988 corr_cb=-0.0858
[EPOCH 013/089] train: loss=0.6768 acc=64.83% | val: loss=0.6820 acc=60.24% f1=67.33% auc=56.28% val_score=53.1366 val_score_bestthr=63.1139 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.180, mb=0.504, no=0.999, corr=-0.086) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 63.1139
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1833 mb_mean=0.5017 norm_overlap=0.9965 corr_cb=-0.1969 topkJ=0.0558
[TRAIN][ep=014] loss=0.6770 acc=64.83%
[TRAIN][ep=014] mask_avg: mc_mean=0.1781 mb_mean=0.5039 norm_overlap=0.9986 corr_cb=-0.0901
[EPOCH 014/089] train: loss=0.6770 acc=64.83% | val: loss=0.6845 acc=60.24% f1=67.33% auc=56.10% val_score=59.3002 val_score_bestthr=63.1139 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.178, mb=0.504, no=0.999, corr=-0.090) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 63.1139
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1583 mb_mean=0.5031 norm_overlap=0.9983 corr_cb=-0.1015 topkJ=0.0586
[TRAIN][ep=015] loss=0.6691 acc=64.83%
[TRAIN][ep=015] mask_avg: mc_mean=0.1810 mb_mean=0.5039 norm_overlap=0.9982 corr_cb=-0.1102
[EPOCH 015/089] train: loss=0.6691 acc=64.83% | val: loss=0.6902 acc=60.24% f1=65.98% auc=55.93% val_score=57.4676 val_score_bestthr=61.7530 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.181, mb=0.504, no=0.998, corr=-0.110) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 61.7530
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1628 mb_mean=0.5045 norm_overlap=0.9973 corr_cb=-0.1726 topkJ=0.0407
[TRAIN][ep=016] loss=0.6687 acc=64.03%
[TRAIN][ep=016] mask_avg: mc_mean=0.1683 mb_mean=0.5039 norm_overlap=0.9980 corr_cb=-0.1105
[EPOCH 016/089] train: loss=0.6687 acc=64.03% | val: loss=0.6910 acc=59.04% f1=67.31% auc=55.81% val_score=35.3330 val_score_bestthr=63.8842 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.168, mb=0.504, no=0.998, corr=-0.110) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 63.8842
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.2062 mb_mean=0.5056 norm_overlap=0.9985 corr_cb=-0.1028 topkJ=0.0535
[TRAIN][ep=017] loss=0.6609 acc=66.71%
[TRAIN][ep=017] mask_avg: mc_mean=0.1641 mb_mean=0.5039 norm_overlap=0.9977 corr_cb=-0.1203
[EPOCH 017/089] train: loss=0.6609 acc=66.71% | val: loss=0.6908 acc=59.04% f1=67.31% auc=56.16% val_score=44.8150 val_score_bestthr=63.8842 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.164, mb=0.504, no=0.998, corr=-0.120) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 63.8842
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1927 mb_mean=0.5031 norm_overlap=0.9978 corr_cb=-0.1239 topkJ=0.0603
[TRAIN][ep=018] loss=0.6601 acc=65.91%
[TRAIN][ep=018] mask_avg: mc_mean=0.1730 mb_mean=0.5039 norm_overlap=0.9975 corr_cb=-0.1266
[EPOCH 018/089] train: loss=0.6601 acc=65.91% | val: loss=0.6882 acc=59.04% f1=66.67% auc=56.51% val_score=59.9850 val_score_bestthr=62.4586 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.173, mb=0.504, no=0.998, corr=-0.127) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 62.4586
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1294 mb_mean=0.4993 norm_overlap=0.9969 corr_cb=-0.1369 topkJ=0.0512
[TRAIN][ep=019] loss=0.6576 acc=65.77%
[TRAIN][ep=019] mask_avg: mc_mean=0.1642 mb_mean=0.5039 norm_overlap=0.9973 corr_cb=-0.1296
[EPOCH 019/089] train: loss=0.6576 acc=65.77% | val: loss=0.6948 acc=57.83% f1=67.29% auc=56.05% val_score=35.5037 val_score_bestthr=61.2084 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.164, mb=0.504, no=0.997, corr=-0.130) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 61.2084
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1800 mb_mean=0.5035 norm_overlap=0.9994 corr_cb=-0.0298 topkJ=0.0718
[TRAIN][ep=020] loss=0.6518 acc=66.58%
[TRAIN][ep=020] mask_avg: mc_mean=0.1795 mb_mean=0.5039 norm_overlap=0.9970 corr_cb=-0.1503
[EPOCH 020/089] train: loss=0.6518 acc=66.58% | val: loss=0.7028 acc=57.83% f1=68.47% auc=56.51% val_score=41.6196 val_score_bestthr=62.2615 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.179, mb=0.504, no=0.997, corr=-0.150) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 62.2615
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.1735 mb_mean=0.5031 norm_overlap=0.9966 corr_cb=-0.1915 topkJ=0.0601
[TRAIN][ep=021] loss=0.6489 acc=67.25%
[TRAIN][ep=021] mask_avg: mc_mean=0.1765 mb_mean=0.5039 norm_overlap=0.9968 corr_cb=-0.1568
[EPOCH 021/089] train: loss=0.6489 acc=67.25% | val: loss=0.6932 acc=57.83% f1=66.02% auc=56.80% val_score=46.8573 val_score_bestthr=61.3809 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.176, mb=0.504, no=0.997, corr=-0.157) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 61.3809
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1852 mb_mean=0.5056 norm_overlap=0.9944 corr_cb=-0.2703 topkJ=0.0197
[TRAIN][ep=022] loss=0.6431 acc=66.98%
[TRAIN][ep=022] mask_avg: mc_mean=0.1824 mb_mean=0.5039 norm_overlap=0.9967 corr_cb=-0.1593
[EPOCH 022/089] train: loss=0.6431 acc=66.98% | val: loss=0.6958 acc=57.83% f1=67.89% auc=56.86% val_score=47.5341 val_score_bestthr=61.2699 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.182, mb=0.504, no=0.997, corr=-0.159) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 61.2699
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1589 mb_mean=0.5049 norm_overlap=0.9950 corr_cb=-0.2235 topkJ=0.0196
[TRAIN][ep=023] loss=0.6378 acc=67.38%
[TRAIN][ep=023] mask_avg: mc_mean=0.1742 mb_mean=0.5039 norm_overlap=0.9966 corr_cb=-0.1594
[EPOCH 023/089] train: loss=0.6378 acc=67.38% | val: loss=0.6948 acc=61.45% f1=66.67% auc=56.80% val_score=60.2119 val_score_bestthr=61.7070 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.174, mb=0.504, no=0.997, corr=-0.159) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 61.7070
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1423 mb_mean=0.5040 norm_overlap=0.9968 corr_cb=-0.1181 topkJ=0.0337
[TRAIN][ep=024] loss=0.6409 acc=66.58%
[TRAIN][ep=024] mask_avg: mc_mean=0.1788 mb_mean=0.5039 norm_overlap=0.9965 corr_cb=-0.1641
[EPOCH 024/089] train: loss=0.6409 acc=66.58% | val: loss=0.6994 acc=59.04% f1=65.31% auc=57.09% val_score=58.0478 val_score_bestthr=61.1578 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.179, mb=0.504, no=0.996, corr=-0.164) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 61.1578
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1554 mb_mean=0.5015 norm_overlap=0.9973 corr_cb=-0.1188 topkJ=0.0487
[TRAIN][ep=025] loss=0.6335 acc=68.59%
[TRAIN][ep=025] mask_avg: mc_mean=0.1828 mb_mean=0.5039 norm_overlap=0.9962 corr_cb=-0.1770
[EPOCH 025/089] train: loss=0.6335 acc=68.59% | val: loss=0.6979 acc=60.24% f1=65.98% auc=57.56% val_score=51.4400 val_score_bestthr=61.6173 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.183, mb=0.504, no=0.996, corr=-0.177) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 61.6173
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2041 mb_mean=0.5035 norm_overlap=0.9971 corr_cb=-0.1462 topkJ=0.0476
[TRAIN][ep=026] loss=0.6377 acc=68.05%
[TRAIN][ep=026] mask_avg: mc_mean=0.1708 mb_mean=0.5039 norm_overlap=0.9962 corr_cb=-0.1654
[EPOCH 026/089] train: loss=0.6377 acc=68.05% | val: loss=0.6959 acc=60.24% f1=67.33% auc=57.67% val_score=60.2119 val_score_bestthr=60.2536 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.171, mb=0.504, no=0.996, corr=-0.165) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 60.2536
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1519 mb_mean=0.5061 norm_overlap=0.9925 corr_cb=-0.2973 topkJ=0.0281
[TRAIN][ep=027] loss=0.6330 acc=68.46%
[TRAIN][ep=027] mask_avg: mc_mean=0.1517 mb_mean=0.5039 norm_overlap=0.9962 corr_cb=-0.1587
[EPOCH 027/089] train: loss=0.6330 acc=68.46% | val: loss=0.7295 acc=57.83% f1=71.07% auc=56.92% val_score=52.0244 val_score_bestthr=65.1044 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.152, mb=0.504, no=0.996, corr=-0.159) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 65.1044
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1412 mb_mean=0.5045 norm_overlap=0.9959 corr_cb=-0.1663 topkJ=0.0373
[TRAIN][ep=028] loss=0.6235 acc=68.59%
[TRAIN][ep=028] mask_avg: mc_mean=0.1522 mb_mean=0.5039 norm_overlap=0.9961 corr_cb=-0.1573
[EPOCH 028/089] train: loss=0.6235 acc=68.59% | val: loss=0.7030 acc=60.24% f1=67.33% auc=57.67% val_score=60.2857 val_score_bestthr=60.2536 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.152, mb=0.504, no=0.996, corr=-0.157) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 60.2536
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.1715 mb_mean=0.5067 norm_overlap=0.9941 corr_cb=-0.2435 topkJ=0.0290
[TRAIN][ep=029] loss=0.6278 acc=69.80%
[TRAIN][ep=029] mask_avg: mc_mean=0.1593 mb_mean=0.5039 norm_overlap=0.9959 corr_cb=-0.1693
[EPOCH 029/089] train: loss=0.6278 acc=69.80% | val: loss=0.7007 acc=61.45% f1=68.63% auc=57.79% val_score=54.5396 val_score_bestthr=62.2424 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.159, mb=0.504, no=0.996, corr=-0.169) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 62.2424
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.1599 mb_mean=0.5046 norm_overlap=0.9958 corr_cb=-0.1797 topkJ=0.0259
[TRAIN][ep=030] loss=0.6172 acc=69.26%
[TRAIN][ep=030] mask_avg: mc_mean=0.1907 mb_mean=0.5039 norm_overlap=0.9957 corr_cb=-0.1957
[EPOCH 030/089] train: loss=0.6172 acc=69.26% | val: loss=0.6995 acc=61.45% f1=65.22% auc=58.31% val_score=48.9207 val_score_bestthr=60.8565 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.191, mb=0.504, no=0.996, corr=-0.196) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 60.8565
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.1591 mb_mean=0.5031 norm_overlap=0.9972 corr_cb=-0.1174 topkJ=0.0375
[TRAIN][ep=031] loss=0.6155 acc=70.34%
[TRAIN][ep=031] mask_avg: mc_mean=0.1672 mb_mean=0.5039 norm_overlap=0.9957 corr_cb=-0.1775
[EPOCH 031/089] train: loss=0.6155 acc=70.34% | val: loss=0.6986 acc=61.45% f1=65.96% auc=58.14% val_score=59.8200 val_score_bestthr=61.0663 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.167, mb=0.504, no=0.996, corr=-0.177) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 61.0663
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1714 mb_mean=0.5042 norm_overlap=0.9964 corr_cb=-0.1562 topkJ=0.0313
[TRAIN][ep=032] loss=0.6217 acc=69.26%
[TRAIN][ep=032] mask_avg: mc_mean=0.1787 mb_mean=0.5039 norm_overlap=0.9955 corr_cb=-0.1935
[EPOCH 032/089] train: loss=0.6217 acc=69.26% | val: loss=0.6978 acc=57.83% f1=71.07% auc=58.78% val_score=49.4896 val_score_bestthr=65.1044 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.179, mb=0.504, no=0.996, corr=-0.194) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 65.1044
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2021 mb_mean=0.5032 norm_overlap=0.9919 corr_cb=-0.3039 topkJ=0.0423
[TRAIN][ep=033] loss=0.6138 acc=70.60%
[TRAIN][ep=033] mask_avg: mc_mean=0.1769 mb_mean=0.5039 norm_overlap=0.9954 corr_cb=-0.1951
[EPOCH 033/089] train: loss=0.6138 acc=70.60% | val: loss=0.7035 acc=62.65% f1=65.93% auc=58.95% val_score=51.4400 val_score_bestthr=61.5615 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.177, mb=0.504, no=0.995, corr=-0.195) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 61.5615
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1372 mb_mean=0.5013 norm_overlap=1.0001 corr_cb=0.0041 topkJ=0.0765
[TRAIN][ep=034] loss=0.6029 acc=71.14%
[TRAIN][ep=034] mask_avg: mc_mean=0.1738 mb_mean=0.5039 norm_overlap=0.9953 corr_cb=-0.1954
[EPOCH 034/089] train: loss=0.6029 acc=71.14% | val: loss=0.7240 acc=57.83% f1=71.07% auc=58.95% val_score=39.4189 val_score_bestthr=65.1044 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.174, mb=0.504, no=0.995, corr=-0.195) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 65.1044
[EARLY STOP] no improvement for 30 epochs. best_epoch=4
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
=============== FIT DONE ===============
[BEST] epoch=4 | val_acc=61.45% | val_f1=69.81% | val_auc=56.98% | val_score=42.5886 | val_score_bestthr=66.0310
[TEST@BEST] thr_used=0.520 | acc=60.39% f1=49.38% auc=61.62% | SP_sex=5.56% EO_sex=20.66% SP_age=11.24% EO_age=11.82%
[TIME] 0.87 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/summary_fold_1.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4855 mb_mean=0.5049 norm_overlap=1.0000 corr_cb=0.0473 topkJ=0.1080
[TRAIN][ep=000] loss=0.6945 acc=50.34%
[TRAIN][ep=000] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1097
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4906 mb_mean=0.5028 norm_overlap=1.0002 corr_cb=0.3495 topkJ=0.0900
[TRAIN][ep=001] loss=0.6924 acc=52.62%
[TRAIN][ep=001] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1148
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4863 mb_mean=0.5023 norm_overlap=1.0001 corr_cb=0.0850 topkJ=0.0855
[TRAIN][ep=002] loss=0.6922 acc=53.56%
[TRAIN][ep=002] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1042
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4827 mb_mean=0.5045 norm_overlap=1.0001 corr_cb=0.1327 topkJ=0.1111
[TRAIN][ep=003] loss=0.6898 acc=52.21%
[TRAIN][ep=003] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1168
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4839 mb_mean=0.5059 norm_overlap=1.0001 corr_cb=0.1207 topkJ=0.1266
[TRAIN][ep=004] loss=0.6892 acc=55.97%
[TRAIN][ep=004] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1129
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4874 mb_mean=0.5023 norm_overlap=1.0001 corr_cb=0.2085 topkJ=0.0997
[TRAIN][ep=005] loss=0.6882 acc=53.42%
[TRAIN][ep=005] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1147
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4933 mb_mean=0.5052 norm_overlap=1.0001 corr_cb=0.1915 topkJ=0.0991
[TRAIN][ep=006] loss=0.6861 acc=55.03%
[TRAIN][ep=006] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1051
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4811 mb_mean=0.5022 norm_overlap=1.0001 corr_cb=0.1599 topkJ=0.1247
[TRAIN][ep=007] loss=0.6820 acc=57.05%
[TRAIN][ep=007] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1165
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4923 mb_mean=0.5061 norm_overlap=1.0000 corr_cb=-0.0490 topkJ=0.0591
[TRAIN][ep=008] loss=0.6809 acc=60.13%
[TRAIN][ep=008] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1064
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4885 mb_mean=0.5031 norm_overlap=1.0001 corr_cb=0.1442 topkJ=0.0897
[TRAIN][ep=009] loss=0.6818 acc=56.38%
[TRAIN][ep=009] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1185
================= FIT START (fold=1) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4904 mb_mean=0.5056 norm_overlap=1.0001 corr_cb=0.1620 topkJ=0.1007
[TRAIN][ep=000] loss=0.6748 acc=60.81%
[TRAIN][ep=000] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1145
[EPOCH 000/089] train: loss=0.6748 acc=60.81% | val: loss=0.6890 acc=61.45% f1=70.91% auc=56.63% val_score=42.7713 val_score_bestthr=63.8148 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.115) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 63.8148
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4891 mb_mean=0.5036 norm_overlap=1.0002 corr_cb=0.2700 topkJ=0.1255
[TRAIN][ep=001] loss=0.6703 acc=63.22%
[TRAIN][ep=001] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1127
[EPOCH 001/089] train: loss=0.6703 acc=63.22% | val: loss=0.6834 acc=57.83% f1=66.02% auc=56.72% val_score=59.5215 val_score_bestthr=59.6104 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.113) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8148 -> 59.6104
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4874 mb_mean=0.5035 norm_overlap=1.0000 corr_cb=0.0912 topkJ=0.0898
[TRAIN][ep=002] loss=0.6653 acc=62.42%
[TRAIN][ep=002] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1172
[EPOCH 002/089] train: loss=0.6653 acc=62.42% | val: loss=0.6831 acc=59.04% f1=66.67% auc=56.45% val_score=59.5215 val_score_bestthr=61.6101 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.117) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8148 -> 61.6101
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4901 mb_mean=0.5043 norm_overlap=1.0001 corr_cb=0.1890 topkJ=0.1067
[TRAIN][ep=003] loss=0.6597 acc=62.82%
[TRAIN][ep=003] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1173
[EPOCH 003/089] train: loss=0.6597 acc=62.82% | val: loss=0.6880 acc=56.63% f1=70.00% auc=55.58% val_score=55.7863 val_score_bestthr=62.1241 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.117) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8148 -> 62.1241
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4879 mb_mean=0.5014 norm_overlap=1.0004 corr_cb=0.5752 topkJ=0.1843
[TRAIN][ep=004] loss=0.6576 acc=61.21%
[TRAIN][ep=004] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1096
[EPOCH 004/089] train: loss=0.6576 acc=61.21% | val: loss=0.6820 acc=60.24% f1=68.57% auc=56.57% val_score=59.3002 val_score_bestthr=63.6857 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.110) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8148 -> 63.6857
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4909 mb_mean=0.5055 norm_overlap=1.0002 corr_cb=0.3822 topkJ=0.1455
[TRAIN][ep=005] loss=1.4418 acc=61.34%
[TRAIN][ep=005] mask_avg: mc_mean=0.3789 mb_mean=0.5039 norm_overlap=1.0003 corr_cb=0.1158
[EPOCH 005/089] train: loss=1.4418 acc=61.34% | val: loss=0.6814 acc=61.45% f1=68.63% auc=56.74% val_score=54.4707 val_score_bestthr=63.2603 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.379, mb=0.504, no=1.000, corr=0.116) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8148 -> 63.2603
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2790 mb_mean=0.5027 norm_overlap=1.0025 corr_cb=0.4436 topkJ=0.1501
[TRAIN][ep=006] loss=1.1954 acc=62.82%
[TRAIN][ep=006] mask_avg: mc_mean=0.2650 mb_mean=0.5039 norm_overlap=1.0006 corr_cb=0.1113
[EPOCH 006/089] train: loss=1.1954 acc=62.82% | val: loss=0.6819 acc=59.04% f1=68.52% auc=56.45% val_score=53.6590 val_score_bestthr=62.9799 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.265, mb=0.504, no=1.001, corr=0.111) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8148 -> 62.9799
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2447 mb_mean=0.5043 norm_overlap=1.0012 corr_cb=0.1571 topkJ=0.1179
[TRAIN][ep=007] loss=0.9728 acc=63.89%
[TRAIN][ep=007] mask_avg: mc_mean=0.2313 mb_mean=0.5039 norm_overlap=1.0006 corr_cb=0.0855
[EPOCH 007/089] train: loss=0.9728 acc=63.89% | val: loss=0.6832 acc=61.45% f1=69.81% auc=56.80% val_score=47.4342 val_score_bestthr=66.0310 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.040, stage2=False) | mask(mc=0.231, mb=0.504, no=1.001, corr=0.085) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 63.8148 -> 66.0310
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2382 mb_mean=0.5056 norm_overlap=1.0001 corr_cb=0.0074 topkJ=0.0922
[TRAIN][ep=008] loss=1.0474 acc=67.11%
[TRAIN][ep=008] mask_avg: mc_mean=0.2062 mb_mean=0.5039 norm_overlap=1.0005 corr_cb=0.0603
[EPOCH 008/089] train: loss=1.0474 acc=67.11% | val: loss=0.6834 acc=60.24% f1=67.33% auc=56.28% val_score=57.3035 val_score_bestthr=63.1139 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.080, stage2=False) | mask(mc=0.206, mb=0.504, no=1.001, corr=0.060) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 63.1139
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1915 mb_mean=0.5044 norm_overlap=1.0004 corr_cb=0.0402 topkJ=0.0776
[TRAIN][ep=009] loss=1.1291 acc=65.91%
[TRAIN][ep=009] mask_avg: mc_mean=0.1921 mb_mean=0.5039 norm_overlap=1.0003 corr_cb=0.0358
[EPOCH 009/089] train: loss=1.1291 acc=65.91% | val: loss=0.6902 acc=60.24% f1=69.72% auc=56.57% val_score=42.3419 val_score_bestthr=65.7323 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.120, stage2=False) | mask(mc=0.192, mb=0.504, no=1.000, corr=0.036) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 65.7323
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1881 mb_mean=0.5054 norm_overlap=1.0001 corr_cb=0.0114 topkJ=0.0516
[TRAIN][ep=010] loss=1.2160 acc=64.83%
[TRAIN][ep=010] mask_avg: mc_mean=0.1744 mb_mean=0.5039 norm_overlap=1.0002 corr_cb=0.0161
[EPOCH 010/089] train: loss=1.2160 acc=64.83% | val: loss=0.6829 acc=57.83% f1=65.35% auc=56.86% val_score=58.8794 val_score_bestthr=58.1932 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.160, stage2=False) | mask(mc=0.174, mb=0.504, no=1.000, corr=0.016) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 58.1932
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1893 mb_mean=0.5045 norm_overlap=1.0005 corr_cb=0.0462 topkJ=0.0695
[TRAIN][ep=011] loss=1.2989 acc=64.97%
[TRAIN][ep=011] mask_avg: mc_mean=0.1751 mb_mean=0.5039 norm_overlap=0.9997 corr_cb=-0.0210
[EPOCH 011/089] train: loss=1.2989 acc=64.97% | val: loss=0.6842 acc=60.24% f1=67.33% auc=56.92% val_score=54.7412 val_score_bestthr=63.1139 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.175, mb=0.504, no=1.000, corr=-0.021) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 63.1139
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1695 mb_mean=0.5042 norm_overlap=1.0005 corr_cb=0.0455 topkJ=0.0787
[TRAIN][ep=012] loss=1.3724 acc=65.50%
[TRAIN][ep=012] mask_avg: mc_mean=0.1640 mb_mean=0.5039 norm_overlap=0.9994 corr_cb=-0.0438
[EPOCH 012/089] train: loss=1.3724 acc=65.50% | val: loss=0.6986 acc=57.83% f1=68.47% auc=56.63% val_score=42.8525 val_score_bestthr=62.2615 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.164, mb=0.504, no=0.999, corr=-0.044) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 62.2615
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1835 mb_mean=0.5031 norm_overlap=0.9985 corr_cb=-0.1290 topkJ=0.0901
[TRAIN][ep=013] loss=1.1501 acc=66.58%
[TRAIN][ep=013] mask_avg: mc_mean=0.1595 mb_mean=0.5039 norm_overlap=0.9989 corr_cb=-0.0800
[EPOCH 013/089] train: loss=1.1501 acc=66.58% | val: loss=0.6884 acc=61.45% f1=68.63% auc=57.21% val_score=49.7900 val_score_bestthr=63.2603 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.160, mb=0.504, no=0.999, corr=-0.080) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 63.2603
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1652 mb_mean=0.5017 norm_overlap=0.9966 corr_cb=-0.2005 topkJ=0.0593
[TRAIN][ep=014] loss=0.9350 acc=66.44%
[TRAIN][ep=014] mask_avg: mc_mean=0.1649 mb_mean=0.5039 norm_overlap=0.9986 corr_cb=-0.0997
[EPOCH 014/089] train: loss=0.9350 acc=66.44% | val: loss=0.6942 acc=60.24% f1=67.33% auc=56.74% val_score=63.9586 val_score_bestthr=63.9586 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.165, mb=0.504, no=0.999, corr=-0.100) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 63.9586
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1433 mb_mean=0.5031 norm_overlap=0.9981 corr_cb=-0.1285 topkJ=0.0565
[TRAIN][ep=015] loss=0.8822 acc=67.38%
[TRAIN][ep=015] mask_avg: mc_mean=0.1656 mb_mean=0.5039 norm_overlap=0.9981 corr_cb=-0.1300
[EPOCH 015/089] train: loss=0.8822 acc=67.38% | val: loss=0.7170 acc=57.83% f1=71.07% auc=56.74% val_score=53.3240 val_score_bestthr=65.1044 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.166, mb=0.504, no=0.998, corr=-0.130) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 65.1044
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1547 mb_mean=0.5045 norm_overlap=0.9967 corr_cb=-0.2381 topkJ=0.0339
[TRAIN][ep=016] loss=0.8769 acc=68.05%
[TRAIN][ep=016] mask_avg: mc_mean=0.1594 mb_mean=0.5039 norm_overlap=0.9977 corr_cb=-0.1456
[EPOCH 016/089] train: loss=0.8769 acc=68.05% | val: loss=0.6968 acc=59.04% f1=68.52% auc=57.50% val_score=56.6188 val_score_bestthr=62.3690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.159, mb=0.504, no=0.998, corr=-0.146) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 62.3690
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.2015 mb_mean=0.5056 norm_overlap=0.9978 corr_cb=-0.1760 topkJ=0.0341
[TRAIN][ep=017] loss=0.8718 acc=69.40%
[TRAIN][ep=017] mask_avg: mc_mean=0.1604 mb_mean=0.5039 norm_overlap=0.9972 corr_cb=-0.1735
[EPOCH 017/089] train: loss=0.8718 acc=69.40% | val: loss=0.7019 acc=57.83% f1=67.89% auc=57.38% val_score=49.6464 val_score_bestthr=61.2699 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.160, mb=0.504, no=0.997, corr=-0.174) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 61.2699
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1852 mb_mean=0.5031 norm_overlap=0.9972 corr_cb=-0.1870 topkJ=0.0526
[TRAIN][ep=018] loss=0.8737 acc=66.85%
[TRAIN][ep=018] mask_avg: mc_mean=0.1667 mb_mean=0.5039 norm_overlap=0.9969 corr_cb=-0.1900
[EPOCH 018/089] train: loss=0.8737 acc=66.85% | val: loss=0.6974 acc=56.63% f1=70.49% auc=57.79% val_score=54.2394 val_score_bestthr=64.1779 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.167, mb=0.504, no=0.997, corr=-0.190) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 64.1779
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1158 mb_mean=0.4993 norm_overlap=0.9957 corr_cb=-0.2238 topkJ=0.0401
[TRAIN][ep=019] loss=0.8657 acc=69.26%
[TRAIN][ep=019] mask_avg: mc_mean=0.1567 mb_mean=0.5039 norm_overlap=0.9965 corr_cb=-0.2025
[EPOCH 019/089] train: loss=0.8657 acc=69.26% | val: loss=0.7159 acc=59.04% f1=67.92% auc=57.85% val_score=45.3654 val_score_bestthr=59.6676 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.157, mb=0.504, no=0.997, corr=-0.202) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 59.6676
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1619 mb_mean=0.5035 norm_overlap=0.9986 corr_cb=-0.0785 topkJ=0.0650
[TRAIN][ep=020] loss=0.8617 acc=71.14%
[TRAIN][ep=020] mask_avg: mc_mean=0.1699 mb_mean=0.5039 norm_overlap=0.9961 corr_cb=-0.2372
[EPOCH 020/089] train: loss=0.8617 acc=71.14% | val: loss=0.7136 acc=59.04% f1=67.92% auc=58.31% val_score=45.3654 val_score_bestthr=59.6676 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.170, mb=0.504, no=0.996, corr=-0.237) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 59.6676
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.1704 mb_mean=0.5031 norm_overlap=0.9950 corr_cb=-0.3377 topkJ=0.0273
[TRAIN][ep=021] loss=0.8564 acc=69.53%
[TRAIN][ep=021] mask_avg: mc_mean=0.1796 mb_mean=0.5039 norm_overlap=0.9957 corr_cb=-0.2644
[EPOCH 021/089] train: loss=0.8564 acc=69.53% | val: loss=0.7023 acc=57.83% f1=71.07% auc=58.20% val_score=56.7083 val_score_bestthr=65.1044 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.180, mb=0.504, no=0.996, corr=-0.264) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 65.1044
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1969 mb_mean=0.5056 norm_overlap=0.9924 corr_cb=-0.4369 topkJ=0.0051
[TRAIN][ep=022] loss=0.8472 acc=71.14%
[TRAIN][ep=022] mask_avg: mc_mean=0.1753 mb_mean=0.5039 norm_overlap=0.9954 corr_cb=-0.2642
[EPOCH 022/089] train: loss=0.8472 acc=71.14% | val: loss=0.7079 acc=59.04% f1=68.52% auc=58.95% val_score=47.5795 val_score_bestthr=61.7072 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.175, mb=0.504, no=0.995, corr=-0.264) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 61.7072
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1573 mb_mean=0.5049 norm_overlap=0.9941 corr_cb=-0.3295 topkJ=0.0143
[TRAIN][ep=023] loss=0.8428 acc=71.01%
[TRAIN][ep=023] mask_avg: mc_mean=0.1835 mb_mean=0.5039 norm_overlap=0.9951 corr_cb=-0.2850
[EPOCH 023/089] train: loss=0.8428 acc=71.01% | val: loss=0.7145 acc=60.24% f1=68.57% auc=58.60% val_score=53.2633 val_score_bestthr=63.1154 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.183, mb=0.504, no=0.995, corr=-0.285) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 63.1154
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1303 mb_mean=0.5040 norm_overlap=0.9958 corr_cb=-0.1808 topkJ=0.0261
[TRAIN][ep=024] loss=0.8398 acc=69.53%
[TRAIN][ep=024] mask_avg: mc_mean=0.1674 mb_mean=0.5039 norm_overlap=0.9948 corr_cb=-0.2727
[EPOCH 024/089] train: loss=0.8398 acc=69.53% | val: loss=0.7050 acc=57.83% f1=71.07% auc=59.30% val_score=55.5020 val_score_bestthr=65.1044 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.167, mb=0.504, no=0.995, corr=-0.273) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 65.1044
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1434 mb_mean=0.5015 norm_overlap=0.9961 corr_cb=-0.2120 topkJ=0.0325
[TRAIN][ep=025] loss=0.8310 acc=72.62%
[TRAIN][ep=025] mask_avg: mc_mean=0.1788 mb_mean=0.5039 norm_overlap=0.9945 corr_cb=-0.2955
[EPOCH 025/089] train: loss=0.8310 acc=72.62% | val: loss=0.7045 acc=57.83% f1=71.07% auc=59.07% val_score=51.6755 val_score_bestthr=65.1044 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.179, mb=0.504, no=0.995, corr=-0.296) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 65.1044
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1990 mb_mean=0.5035 norm_overlap=0.9962 corr_cb=-0.2289 topkJ=0.0371
[TRAIN][ep=026] loss=0.8319 acc=71.28%
[TRAIN][ep=026] mask_avg: mc_mean=0.1841 mb_mean=0.5039 norm_overlap=0.9943 corr_cb=-0.2968
[EPOCH 026/089] train: loss=0.8319 acc=71.28% | val: loss=0.7109 acc=57.83% f1=71.07% auc=59.48% val_score=53.6188 val_score_bestthr=65.1044 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.184, mb=0.504, no=0.994, corr=-0.297) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 65.1044
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1742 mb_mean=0.5061 norm_overlap=0.9908 corr_cb=-0.4305 topkJ=0.0096
[TRAIN][ep=027] loss=0.8455 acc=68.86%
[TRAIN][ep=027] mask_avg: mc_mean=0.1773 mb_mean=0.5039 norm_overlap=0.9941 corr_cb=-0.3022
[EPOCH 027/089] train: loss=0.8455 acc=68.86% | val: loss=0.7259 acc=59.04% f1=60.47% auc=59.36% val_score=49.8478 val_score_bestthr=60.7691 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.177, mb=0.504, no=0.994, corr=-0.302) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 60.7691
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1361 mb_mean=0.5045 norm_overlap=0.9928 corr_cb=-0.3181 topkJ=0.0162
[TRAIN][ep=028] loss=0.8159 acc=74.23%
[TRAIN][ep=028] mask_avg: mc_mean=0.1664 mb_mean=0.5039 norm_overlap=0.9939 corr_cb=-0.2918
[EPOCH 028/089] train: loss=0.8159 acc=74.23% | val: loss=0.7289 acc=57.83% f1=70.59% auc=59.30% val_score=53.4650 val_score_bestthr=60.6955 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.166, mb=0.504, no=0.994, corr=-0.292) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 60.6955
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.1943 mb_mean=0.5067 norm_overlap=0.9915 corr_cb=-0.4052 topkJ=0.0071
[TRAIN][ep=029] loss=0.8158 acc=72.89%
[TRAIN][ep=029] mask_avg: mc_mean=0.1701 mb_mean=0.5039 norm_overlap=0.9938 corr_cb=-0.2980
[EPOCH 029/089] train: loss=0.8158 acc=72.89% | val: loss=0.7156 acc=62.65% f1=69.31% auc=59.65% val_score=51.3049 val_score_bestthr=62.3366 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.170, mb=0.504, no=0.994, corr=-0.298) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 62.3366
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.1770 mb_mean=0.5046 norm_overlap=0.9937 corr_cb=-0.3150 topkJ=0.0082
[TRAIN][ep=030] loss=0.8045 acc=74.50%
[TRAIN][ep=030] mask_avg: mc_mean=0.2071 mb_mean=0.5039 norm_overlap=0.9937 corr_cb=-0.3273
[EPOCH 030/089] train: loss=0.8045 acc=74.50% | val: loss=0.7199 acc=62.65% f1=68.69% auc=60.17% val_score=56.1032 val_score_bestthr=60.5893 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.207, mb=0.504, no=0.994, corr=-0.327) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 60.5893
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.1763 mb_mean=0.5031 norm_overlap=0.9964 corr_cb=-0.1970 topkJ=0.0290
[TRAIN][ep=031] loss=0.8035 acc=72.62%
[TRAIN][ep=031] mask_avg: mc_mean=0.1898 mb_mean=0.5039 norm_overlap=0.9935 corr_cb=-0.3138
[EPOCH 031/089] train: loss=0.8035 acc=72.62% | val: loss=0.7314 acc=63.86% f1=70.00% auc=60.00% val_score=46.1600 val_score_bestthr=62.3254 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.504, no=0.994, corr=-0.314) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 62.3254
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1992 mb_mean=0.5042 norm_overlap=0.9942 corr_cb=-0.3081 topkJ=0.0116
[TRAIN][ep=032] loss=0.8149 acc=70.74%
[TRAIN][ep=032] mask_avg: mc_mean=0.1741 mb_mean=0.5039 norm_overlap=0.9933 corr_cb=-0.3085
[EPOCH 032/089] train: loss=0.8149 acc=70.74% | val: loss=0.7189 acc=62.65% f1=69.31% auc=59.88% val_score=50.1875 val_score_bestthr=59.6610 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.174, mb=0.504, no=0.993, corr=-0.309) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 59.6610
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2001 mb_mean=0.5032 norm_overlap=0.9895 corr_cb=-0.3913 topkJ=0.0144
[TRAIN][ep=033] loss=0.8007 acc=73.15%
[TRAIN][ep=033] mask_avg: mc_mean=0.1879 mb_mean=0.5039 norm_overlap=0.9933 corr_cb=-0.3174
[EPOCH 033/089] train: loss=0.8007 acc=73.15% | val: loss=0.7358 acc=62.65% f1=68.69% auc=59.88% val_score=44.0611 val_score_bestthr=60.5893 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.188, mb=0.504, no=0.993, corr=-0.317) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 60.5893
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1749 mb_mean=0.5013 norm_overlap=0.9969 corr_cb=-0.1488 topkJ=0.0398
[TRAIN][ep=034] loss=0.7860 acc=75.17%
[TRAIN][ep=034] mask_avg: mc_mean=0.1977 mb_mean=0.5039 norm_overlap=0.9932 corr_cb=-0.3250
[EPOCH 034/089] train: loss=0.7860 acc=75.17% | val: loss=0.7562 acc=62.65% f1=68.69% auc=59.94% val_score=39.0784 val_score_bestthr=60.4874 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.198, mb=0.504, no=0.993, corr=-0.325) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 60.4874
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.1800 mb_mean=0.5009 norm_overlap=0.9919 corr_cb=-0.3248 topkJ=0.0076
[TRAIN][ep=035] loss=0.7880 acc=74.36%
[TRAIN][ep=035] mask_avg: mc_mean=0.1894 mb_mean=0.5039 norm_overlap=0.9931 corr_cb=-0.3204
[EPOCH 035/089] train: loss=0.7880 acc=74.36% | val: loss=0.7574 acc=61.45% f1=68.00% auc=59.83% val_score=48.7784 val_score_bestthr=59.3796 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.189, mb=0.504, no=0.993, corr=-0.320) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 59.3796
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.1990 mb_mean=0.5038 norm_overlap=0.9975 corr_cb=-0.1373 topkJ=0.0243
[TRAIN][ep=036] loss=0.7981 acc=75.03%
[TRAIN][ep=036] mask_avg: mc_mean=0.1786 mb_mean=0.5039 norm_overlap=0.9929 corr_cb=-0.3120
[EPOCH 036/089] train: loss=0.7981 acc=75.03% | val: loss=0.7269 acc=61.45% f1=68.63% auc=60.70% val_score=52.8664 val_score_bestthr=59.6743 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.179, mb=0.504, no=0.993, corr=-0.312) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 59.6743
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.2306 mb_mean=0.5037 norm_overlap=0.9930 corr_cb=-0.3628 topkJ=0.0063
[TRAIN][ep=037] loss=0.7740 acc=73.83%
[TRAIN][ep=037] mask_avg: mc_mean=0.1974 mb_mean=0.5039 norm_overlap=0.9931 corr_cb=-0.3217
[EPOCH 037/089] train: loss=0.7740 acc=73.83% | val: loss=0.7271 acc=59.04% f1=57.50% auc=61.16% val_score=54.1652 val_score_bestthr=59.4165 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.197, mb=0.504, no=0.993, corr=-0.322) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 59.4165
[EARLY STOP] no improvement for 30 epochs. best_epoch=7
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
=============== FIT DONE ===============
[BEST] epoch=7 | val_acc=61.45% | val_f1=69.81% | val_auc=56.80% | val_score=47.4342 | val_score_bestthr=66.0310
[TEST@BEST] thr_used=0.430 | acc=59.90% f1=69.37% auc=63.93% | SP_sex=2.04% EO_sex=2.34% SP_age=5.78% EO_age=8.72%
[TIME] 0.87 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/summary_fold_1.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4855 mb_mean=0.5049 norm_overlap=1.0000 corr_cb=0.0473 topkJ=0.1080
[TRAIN][ep=000] loss=0.6945 acc=50.34%
[TRAIN][ep=000] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1097
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4906 mb_mean=0.5028 norm_overlap=1.0002 corr_cb=0.3495 topkJ=0.0900
[TRAIN][ep=001] loss=0.6924 acc=52.62%
[TRAIN][ep=001] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1148
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4863 mb_mean=0.5023 norm_overlap=1.0001 corr_cb=0.0850 topkJ=0.0855
[TRAIN][ep=002] loss=0.6922 acc=53.56%
[TRAIN][ep=002] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1042
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4827 mb_mean=0.5045 norm_overlap=1.0001 corr_cb=0.1327 topkJ=0.1111
[TRAIN][ep=003] loss=0.6898 acc=52.21%
[TRAIN][ep=003] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1168
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4839 mb_mean=0.5059 norm_overlap=1.0001 corr_cb=0.1207 topkJ=0.1266
[TRAIN][ep=004] loss=0.6892 acc=55.97%
[TRAIN][ep=004] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1129
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4874 mb_mean=0.5023 norm_overlap=1.0001 corr_cb=0.2085 topkJ=0.0997
[TRAIN][ep=005] loss=0.6882 acc=53.42%
[TRAIN][ep=005] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1147
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4933 mb_mean=0.5052 norm_overlap=1.0001 corr_cb=0.1915 topkJ=0.0991
[TRAIN][ep=006] loss=0.6861 acc=54.90%
[TRAIN][ep=006] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1051
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4811 mb_mean=0.5022 norm_overlap=1.0001 corr_cb=0.1599 topkJ=0.1247
[TRAIN][ep=007] loss=0.6820 acc=57.18%
[TRAIN][ep=007] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1165
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4923 mb_mean=0.5061 norm_overlap=1.0000 corr_cb=-0.0490 topkJ=0.0591
[TRAIN][ep=008] loss=0.6809 acc=60.13%
[TRAIN][ep=008] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1064
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4885 mb_mean=0.5031 norm_overlap=1.0001 corr_cb=0.1442 topkJ=0.0897
[TRAIN][ep=009] loss=0.6818 acc=56.51%
[TRAIN][ep=009] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1185
================= FIT START (fold=1) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.45 select_by=val_score_bestthr | eval_thr_mode=fixed eval_thr_grid=coarse | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4904 mb_mean=0.5056 norm_overlap=1.0001 corr_cb=0.1620 topkJ=0.1007
[TRAIN][ep=000] loss=0.6748 acc=60.81%
[TRAIN][ep=000] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1145
[EPOCH 000/089] train: loss=0.6748 acc=60.81% | val: loss=0.6890 acc=57.83% f1=64.65% auc=56.63% val_score=56.0307 val_score_bestthr=56.0307 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.115) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 56.0307
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4891 mb_mean=0.5036 norm_overlap=1.0002 corr_cb=0.2700 topkJ=0.1255
[TRAIN][ep=001] loss=0.6703 acc=63.22%
[TRAIN][ep=001] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1127
[EPOCH 001/089] train: loss=0.6703 acc=63.22% | val: loss=0.6834 acc=54.22% f1=68.85% auc=56.74% val_score=58.5880 val_score_bestthr=58.5880 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.113) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 56.0307 -> 58.5880
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4874 mb_mean=0.5035 norm_overlap=1.0000 corr_cb=0.0912 topkJ=0.0898
[TRAIN][ep=002] loss=0.6653 acc=62.42%
[TRAIN][ep=002] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1172
[EPOCH 002/089] train: loss=0.6653 acc=62.42% | val: loss=0.6831 acc=55.42% f1=68.91% auc=56.45% val_score=58.2105 val_score_bestthr=58.2105 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.117) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 58.5880 -> 58.2105
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4901 mb_mean=0.5043 norm_overlap=1.0001 corr_cb=0.1890 topkJ=0.1067
[TRAIN][ep=003] loss=0.6597 acc=62.82%
[TRAIN][ep=003] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1173
[EPOCH 003/089] train: loss=0.6597 acc=62.82% | val: loss=0.6880 acc=54.22% f1=68.85% auc=55.52% val_score=58.5880 val_score_bestthr=58.5880 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.117) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 58.5880 -> 58.5880
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4879 mb_mean=0.5014 norm_overlap=1.0004 corr_cb=0.5752 topkJ=0.1843
[TRAIN][ep=004] loss=0.6576 acc=61.34%
[TRAIN][ep=004] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1096
[EPOCH 004/089] train: loss=0.6576 acc=61.34% | val: loss=0.6820 acc=54.22% f1=67.24% auc=56.51% val_score=53.1583 val_score_bestthr=53.1583 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.110) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 58.5880 -> 53.1583
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4909 mb_mean=0.5055 norm_overlap=1.0002 corr_cb=0.3822 topkJ=0.1455
[TRAIN][ep=005] loss=1.4418 acc=61.34%
[TRAIN][ep=005] mask_avg: mc_mean=0.3789 mb_mean=0.5039 norm_overlap=1.0003 corr_cb=0.1158
[EPOCH 005/089] train: loss=1.4418 acc=61.34% | val: loss=0.6814 acc=55.42% f1=67.83% auc=56.74% val_score=54.6508 val_score_bestthr=54.6508 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.379, mb=0.504, no=1.000, corr=0.116) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 58.5880 -> 54.6508
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2791 mb_mean=0.5027 norm_overlap=1.0025 corr_cb=0.4436 topkJ=0.1501
[TRAIN][ep=006] loss=1.4244 acc=62.42%
[TRAIN][ep=006] mask_avg: mc_mean=0.2645 mb_mean=0.5039 norm_overlap=1.0006 corr_cb=0.1115
[EPOCH 006/089] train: loss=1.4244 acc=62.42% | val: loss=0.6819 acc=59.04% f1=67.92% auc=56.57% val_score=64.2536 val_score_bestthr=64.2536 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.264, mb=0.504, no=1.001, corr=0.112) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 58.5880 -> 64.2536
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2441 mb_mean=0.5043 norm_overlap=1.0012 corr_cb=0.1567 topkJ=0.1190
[TRAIN][ep=007] loss=1.4207 acc=64.43%
[TRAIN][ep=007] mask_avg: mc_mean=0.2300 mb_mean=0.5039 norm_overlap=1.0006 corr_cb=0.0877
[EPOCH 007/089] train: loss=1.4207 acc=64.43% | val: loss=0.6824 acc=59.04% f1=66.00% auc=56.45% val_score=59.8489 val_score_bestthr=59.8489 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.230, mb=0.504, no=1.001, corr=0.088) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2536 -> 59.8489
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2352 mb_mean=0.5056 norm_overlap=1.0001 corr_cb=0.0155 topkJ=0.0937
[TRAIN][ep=008] loss=1.4068 acc=67.11%
[TRAIN][ep=008] mask_avg: mc_mean=0.2053 mb_mean=0.5039 norm_overlap=1.0006 corr_cb=0.0656
[EPOCH 008/089] train: loss=1.4068 acc=67.11% | val: loss=0.6824 acc=55.42% f1=66.67% auc=56.28% val_score=57.7079 val_score_bestthr=57.7079 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.205, mb=0.504, no=1.001, corr=0.066) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2536 -> 57.7079
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1915 mb_mean=0.5044 norm_overlap=1.0004 corr_cb=0.0484 topkJ=0.0776
[TRAIN][ep=009] loss=1.4002 acc=65.91%
[TRAIN][ep=009] mask_avg: mc_mean=0.1933 mb_mean=0.5039 norm_overlap=1.0004 corr_cb=0.0422
[EPOCH 009/089] train: loss=1.4002 acc=65.91% | val: loss=0.6891 acc=54.22% f1=58.70% auc=57.09% val_score=51.4374 val_score_bestthr=51.4374 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.193, mb=0.504, no=1.000, corr=0.042) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2536 -> 51.4374
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1905 mb_mean=0.5054 norm_overlap=1.0002 corr_cb=0.0186 topkJ=0.0516
[TRAIN][ep=010] loss=1.4016 acc=64.56%
[TRAIN][ep=010] mask_avg: mc_mean=0.1769 mb_mean=0.5039 norm_overlap=1.0002 corr_cb=0.0220
[EPOCH 010/089] train: loss=1.4016 acc=64.56% | val: loss=0.6824 acc=54.22% f1=64.81% auc=56.74% val_score=54.6475 val_score_bestthr=54.6475 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.177, mb=0.504, no=1.000, corr=0.022) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2536 -> 54.6475
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1922 mb_mean=0.5045 norm_overlap=1.0006 corr_cb=0.0519 topkJ=0.0726
[TRAIN][ep=011] loss=1.3980 acc=65.37%
[TRAIN][ep=011] mask_avg: mc_mean=0.1780 mb_mean=0.5039 norm_overlap=0.9998 corr_cb=-0.0153
[EPOCH 011/089] train: loss=1.3980 acc=65.37% | val: loss=0.6841 acc=59.04% f1=66.00% auc=57.15% val_score=59.8489 val_score_bestthr=59.8489 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.178, mb=0.504, no=1.000, corr=-0.015) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2536 -> 59.8489
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1721 mb_mean=0.5042 norm_overlap=1.0006 corr_cb=0.0503 topkJ=0.0778
[TRAIN][ep=012] loss=1.1727 acc=66.04%
[TRAIN][ep=012] mask_avg: mc_mean=0.1678 mb_mean=0.5039 norm_overlap=0.9995 corr_cb=-0.0392
[EPOCH 012/089] train: loss=1.1727 acc=66.04% | val: loss=0.6977 acc=53.01% f1=56.18% auc=56.80% val_score=45.5247 val_score_bestthr=45.5247 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.168, mb=0.504, no=1.000, corr=-0.039) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2536 -> 45.5247
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1900 mb_mean=0.5031 norm_overlap=0.9986 corr_cb=-0.1250 topkJ=0.0915
[TRAIN][ep=013] loss=0.9495 acc=66.58%
[TRAIN][ep=013] mask_avg: mc_mean=0.1664 mb_mean=0.5039 norm_overlap=0.9990 corr_cb=-0.0778
[EPOCH 013/089] train: loss=0.9495 acc=66.58% | val: loss=0.6890 acc=59.04% f1=65.31% auc=57.21% val_score=60.1381 val_score_bestthr=60.1381 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.166, mb=0.504, no=0.999, corr=-0.078) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2536 -> 60.1381
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1719 mb_mean=0.5017 norm_overlap=0.9967 corr_cb=-0.2016 topkJ=0.0584
[TRAIN][ep=014] loss=0.9048 acc=66.58%
[TRAIN][ep=014] mask_avg: mc_mean=0.1687 mb_mean=0.5039 norm_overlap=0.9987 corr_cb=-0.0944
[EPOCH 014/089] train: loss=0.9048 acc=66.58% | val: loss=0.6945 acc=55.42% f1=66.06% auc=56.86% val_score=55.9484 val_score_bestthr=55.9484 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.169, mb=0.504, no=0.999, corr=-0.094) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2536 -> 55.9484
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1451 mb_mean=0.5031 norm_overlap=0.9982 corr_cb=-0.1227 topkJ=0.0556
[TRAIN][ep=015] loss=0.8816 acc=67.52%
[TRAIN][ep=015] mask_avg: mc_mean=0.1667 mb_mean=0.5039 norm_overlap=0.9982 corr_cb=-0.1228
[EPOCH 015/089] train: loss=0.8816 acc=67.52% | val: loss=0.7171 acc=55.42% f1=67.83% auc=56.80% val_score=54.0438 val_score_bestthr=54.0438 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.167, mb=0.504, no=0.998, corr=-0.123) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2536 -> 54.0438
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1560 mb_mean=0.5045 norm_overlap=0.9969 corr_cb=-0.2302 topkJ=0.0352
[TRAIN][ep=016] loss=0.8764 acc=68.72%
[TRAIN][ep=016] mask_avg: mc_mean=0.1594 mb_mean=0.5039 norm_overlap=0.9979 corr_cb=-0.1379
[EPOCH 016/089] train: loss=0.8764 acc=68.72% | val: loss=0.6966 acc=56.63% f1=62.50% auc=57.62% val_score=55.9318 val_score_bestthr=55.9318 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.159, mb=0.504, no=0.998, corr=-0.138) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2536 -> 55.9318
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.2012 mb_mean=0.5056 norm_overlap=0.9979 corr_cb=-0.1673 topkJ=0.0353
[TRAIN][ep=017] loss=0.8713 acc=69.93%
[TRAIN][ep=017] mask_avg: mc_mean=0.1594 mb_mean=0.5039 norm_overlap=0.9974 corr_cb=-0.1652
[EPOCH 017/089] train: loss=0.8713 acc=69.93% | val: loss=0.7014 acc=56.63% f1=61.70% auc=57.79% val_score=57.6140 val_score_bestthr=57.6140 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.159, mb=0.504, no=0.997, corr=-0.165) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2536 -> 57.6140
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1845 mb_mean=0.5031 norm_overlap=0.9973 corr_cb=-0.1777 topkJ=0.0539
[TRAIN][ep=018] loss=0.8732 acc=67.25%
[TRAIN][ep=018] mask_avg: mc_mean=0.1656 mb_mean=0.5039 norm_overlap=0.9970 corr_cb=-0.1821
[EPOCH 018/089] train: loss=0.8732 acc=67.25% | val: loss=0.6967 acc=59.04% f1=66.00% auc=58.02% val_score=55.4326 val_score_bestthr=55.4326 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.166, mb=0.504, no=0.997, corr=-0.182) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2536 -> 55.4326
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1142 mb_mean=0.4993 norm_overlap=0.9959 corr_cb=-0.2144 topkJ=0.0418
[TRAIN][ep=019] loss=0.8652 acc=69.53%
[TRAIN][ep=019] mask_avg: mc_mean=0.1551 mb_mean=0.5039 norm_overlap=0.9966 corr_cb=-0.1943
[EPOCH 019/089] train: loss=0.8652 acc=69.53% | val: loss=0.7149 acc=54.22% f1=52.50% auc=57.91% val_score=47.5795 val_score_bestthr=47.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.155, mb=0.504, no=0.997, corr=-0.194) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2536 -> 47.5795
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1609 mb_mean=0.5035 norm_overlap=0.9988 corr_cb=-0.0687 topkJ=0.0691
[TRAIN][ep=020] loss=0.8612 acc=71.41%
[TRAIN][ep=020] mask_avg: mc_mean=0.1688 mb_mean=0.5039 norm_overlap=0.9962 corr_cb=-0.2296
[EPOCH 020/089] train: loss=0.8612 acc=71.41% | val: loss=0.7130 acc=56.63% f1=56.10% auc=58.72% val_score=52.9793 val_score_bestthr=52.9793 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.169, mb=0.504, no=0.996, corr=-0.230) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2536 -> 52.9793
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.1685 mb_mean=0.5031 norm_overlap=0.9952 corr_cb=-0.3272 topkJ=0.0314
[TRAIN][ep=021] loss=0.8560 acc=69.93%
[TRAIN][ep=021] mask_avg: mc_mean=0.1775 mb_mean=0.5039 norm_overlap=0.9958 corr_cb=-0.2563
[EPOCH 021/089] train: loss=0.8560 acc=69.93% | val: loss=0.7015 acc=59.04% f1=66.00% auc=58.08% val_score=55.5740 val_score_bestthr=55.5740 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.178, mb=0.504, no=0.996, corr=-0.256) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2536 -> 55.5740
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1949 mb_mean=0.5056 norm_overlap=0.9925 corr_cb=-0.4301 topkJ=0.0059
[TRAIN][ep=022] loss=0.8466 acc=71.28%
[TRAIN][ep=022] mask_avg: mc_mean=0.1733 mb_mean=0.5039 norm_overlap=0.9955 corr_cb=-0.2565
[EPOCH 022/089] train: loss=0.8466 acc=71.28% | val: loss=0.7069 acc=59.04% f1=62.22% auc=58.72% val_score=56.8202 val_score_bestthr=56.8202 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.173, mb=0.504, no=0.996, corr=-0.257) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2536 -> 56.8202
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1545 mb_mean=0.5049 norm_overlap=0.9942 corr_cb=-0.3222 topkJ=0.0152
[TRAIN][ep=023] loss=0.8422 acc=71.14%
[TRAIN][ep=023] mask_avg: mc_mean=0.1813 mb_mean=0.5039 norm_overlap=0.9952 corr_cb=-0.2774
[EPOCH 023/089] train: loss=0.8422 acc=71.14% | val: loss=0.7134 acc=56.63% f1=66.67% auc=58.72% val_score=57.0450 val_score_bestthr=57.0450 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.181, mb=0.504, no=0.995, corr=-0.277) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2536 -> 57.0450
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1295 mb_mean=0.5040 norm_overlap=0.9959 corr_cb=-0.1760 topkJ=0.0265
[TRAIN][ep=024] loss=0.8391 acc=69.40%
[TRAIN][ep=024] mask_avg: mc_mean=0.1660 mb_mean=0.5039 norm_overlap=0.9949 corr_cb=-0.2660
[EPOCH 024/089] train: loss=0.8391 acc=69.40% | val: loss=0.7037 acc=60.24% f1=67.96% auc=59.01% val_score=58.5695 val_score_bestthr=58.5695 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.166, mb=0.504, no=0.995, corr=-0.266) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2536 -> 58.5695
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1400 mb_mean=0.5015 norm_overlap=0.9963 corr_cb=-0.1987 topkJ=0.0346
[TRAIN][ep=025] loss=0.8302 acc=72.89%
[TRAIN][ep=025] mask_avg: mc_mean=0.1759 mb_mean=0.5039 norm_overlap=0.9946 corr_cb=-0.2876
[EPOCH 025/089] train: loss=0.8302 acc=72.89% | val: loss=0.7035 acc=59.04% f1=64.58% auc=59.07% val_score=55.5020 val_score_bestthr=55.5020 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.176, mb=0.504, no=0.995, corr=-0.288) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2536 -> 55.5020
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1973 mb_mean=0.5035 norm_overlap=0.9963 corr_cb=-0.2236 topkJ=0.0379
[TRAIN][ep=026] loss=0.8309 acc=71.41%
[TRAIN][ep=026] mask_avg: mc_mean=0.1823 mb_mean=0.5039 norm_overlap=0.9944 corr_cb=-0.2900
[EPOCH 026/089] train: loss=0.8309 acc=71.41% | val: loss=0.7104 acc=59.04% f1=62.22% auc=59.65% val_score=56.8202 val_score_bestthr=56.8202 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.182, mb=0.504, no=0.994, corr=-0.290) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2536 -> 56.8202
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1701 mb_mean=0.5061 norm_overlap=0.9908 corr_cb=-0.4232 topkJ=0.0112
[TRAIN][ep=027] loss=0.8446 acc=68.86%
[TRAIN][ep=027] mask_avg: mc_mean=0.1736 mb_mean=0.5039 norm_overlap=0.9942 corr_cb=-0.2940
[EPOCH 027/089] train: loss=0.8446 acc=68.86% | val: loss=0.7244 acc=56.63% f1=67.27% auc=59.07% val_score=54.4197 val_score_bestthr=54.4197 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.174, mb=0.504, no=0.994, corr=-0.294) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2536 -> 54.4197
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1339 mb_mean=0.5045 norm_overlap=0.9930 corr_cb=-0.3057 topkJ=0.0175
[TRAIN][ep=028] loss=0.8146 acc=74.09%
[TRAIN][ep=028] mask_avg: mc_mean=0.1646 mb_mean=0.5039 norm_overlap=0.9940 corr_cb=-0.2853
[EPOCH 028/089] train: loss=0.8146 acc=74.09% | val: loss=0.7277 acc=57.83% f1=67.89% auc=59.19% val_score=55.5171 val_score_bestthr=55.5171 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.165, mb=0.504, no=0.994, corr=-0.285) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2536 -> 55.5171
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.1941 mb_mean=0.5067 norm_overlap=0.9917 corr_cb=-0.3948 topkJ=0.0075
[TRAIN][ep=029] loss=0.8141 acc=73.02%
[TRAIN][ep=029] mask_avg: mc_mean=0.1689 mb_mean=0.5039 norm_overlap=0.9938 corr_cb=-0.2922
[EPOCH 029/089] train: loss=0.8141 acc=73.02% | val: loss=0.7145 acc=60.24% f1=64.52% auc=60.00% val_score=53.6901 val_score_bestthr=53.6901 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.169, mb=0.504, no=0.994, corr=-0.292) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2536 -> 53.6901
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.1756 mb_mean=0.5046 norm_overlap=0.9937 corr_cb=-0.3121 topkJ=0.0086
[TRAIN][ep=030] loss=0.8030 acc=74.50%
[TRAIN][ep=030] mask_avg: mc_mean=0.2064 mb_mean=0.5039 norm_overlap=0.9938 corr_cb=-0.3217
[EPOCH 030/089] train: loss=0.8030 acc=74.50% | val: loss=0.7184 acc=59.04% f1=63.83% auc=60.23% val_score=53.7023 val_score_bestthr=53.7023 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.206, mb=0.504, no=0.994, corr=-0.322) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2536 -> 53.7023
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.1728 mb_mean=0.5031 norm_overlap=0.9964 corr_cb=-0.1900 topkJ=0.0298
[TRAIN][ep=031] loss=0.8014 acc=73.15%
[TRAIN][ep=031] mask_avg: mc_mean=0.1883 mb_mean=0.5039 norm_overlap=0.9936 corr_cb=-0.3076
[EPOCH 031/089] train: loss=0.8014 acc=73.15% | val: loss=0.7326 acc=56.63% f1=57.14% auc=60.29% val_score=54.0045 val_score_bestthr=54.0045 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.188, mb=0.504, no=0.994, corr=-0.308) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2536 -> 54.0045
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1973 mb_mean=0.5042 norm_overlap=0.9942 corr_cb=-0.3030 topkJ=0.0116
[TRAIN][ep=032] loss=0.8133 acc=71.14%
[TRAIN][ep=032] mask_avg: mc_mean=0.1720 mb_mean=0.5039 norm_overlap=0.9933 corr_cb=-0.3018
[EPOCH 032/089] train: loss=0.8133 acc=71.14% | val: loss=0.7181 acc=59.04% f1=63.83% auc=60.17% val_score=53.7023 val_score_bestthr=53.7023 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.172, mb=0.504, no=0.993, corr=-0.302) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2536 -> 53.7023
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1983 mb_mean=0.5032 norm_overlap=0.9895 corr_cb=-0.3859 topkJ=0.0152
[TRAIN][ep=033] loss=0.7984 acc=73.29%
[TRAIN][ep=033] mask_avg: mc_mean=0.1864 mb_mean=0.5039 norm_overlap=0.9934 corr_cb=-0.3114
[EPOCH 033/089] train: loss=0.7984 acc=73.29% | val: loss=0.7362 acc=57.83% f1=57.83% auc=59.88% val_score=57.7999 val_score_bestthr=57.7999 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.186, mb=0.504, no=0.993, corr=-0.311) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2536 -> 57.7999
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1738 mb_mean=0.5013 norm_overlap=0.9971 corr_cb=-0.1351 topkJ=0.0423
[TRAIN][ep=034] loss=0.7838 acc=75.17%
[TRAIN][ep=034] mask_avg: mc_mean=0.1965 mb_mean=0.5039 norm_overlap=0.9933 corr_cb=-0.3192
[EPOCH 034/089] train: loss=0.7838 acc=75.17% | val: loss=0.7564 acc=54.22% f1=50.00% auc=59.88% val_score=53.4260 val_score_bestthr=53.4260 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.197, mb=0.504, no=0.993, corr=-0.319) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2536 -> 53.4260
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.1792 mb_mean=0.5009 norm_overlap=0.9921 corr_cb=-0.3161 topkJ=0.0080
[TRAIN][ep=035] loss=0.7860 acc=74.36%
[TRAIN][ep=035] mask_avg: mc_mean=0.1892 mb_mean=0.5039 norm_overlap=0.9931 corr_cb=-0.3154
[EPOCH 035/089] train: loss=0.7860 acc=74.36% | val: loss=0.7580 acc=54.22% f1=52.50% auc=59.77% val_score=51.2778 val_score_bestthr=51.2778 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.189, mb=0.504, no=0.993, corr=-0.315) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2536 -> 51.2778
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2019 mb_mean=0.5038 norm_overlap=0.9976 corr_cb=-0.1354 topkJ=0.0259
[TRAIN][ep=036] loss=0.7967 acc=75.30%
[TRAIN][ep=036] mask_avg: mc_mean=0.1806 mb_mean=0.5039 norm_overlap=0.9930 corr_cb=-0.3092
[EPOCH 036/089] train: loss=0.7967 acc=75.30% | val: loss=0.7252 acc=59.04% f1=63.04% auc=60.58% val_score=53.9438 val_score_bestthr=53.9438 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.181, mb=0.504, no=0.993, corr=-0.309) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2536 -> 53.9438
[EARLY STOP] no improvement for 30 epochs. best_epoch=6
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
=============== FIT DONE ===============
[BEST] epoch=6 | val_acc=59.04% | val_f1=67.92% | val_auc=56.57% | val_score=64.2536 | val_score_bestthr=64.2536
[TEST@BEST] thr_used=0.450 | acc=58.94% f1=68.40% auc=64.21% | SP_sex=3.15% EO_sex=0.15% SP_age=6.36% EO_age=9.23%
[TIME] 0.76 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/summary_fold_1.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4855 mb_mean=0.5049 norm_overlap=1.0000 corr_cb=0.0473 topkJ=0.1080
[TRAIN][ep=000] loss=0.6948 acc=48.99%
[TRAIN][ep=000] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1097
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4906 mb_mean=0.5028 norm_overlap=1.0002 corr_cb=0.3495 topkJ=0.0900
[TRAIN][ep=001] loss=0.6923 acc=51.95%
[TRAIN][ep=001] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1148
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4863 mb_mean=0.5023 norm_overlap=1.0001 corr_cb=0.0850 topkJ=0.0855
[TRAIN][ep=002] loss=0.6921 acc=53.15%
[TRAIN][ep=002] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1042
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4827 mb_mean=0.5045 norm_overlap=1.0001 corr_cb=0.1327 topkJ=0.1111
[TRAIN][ep=003] loss=0.6889 acc=54.36%
[TRAIN][ep=003] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1168
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4839 mb_mean=0.5059 norm_overlap=1.0001 corr_cb=0.1207 topkJ=0.1266
[TRAIN][ep=004] loss=0.6880 acc=54.50%
[TRAIN][ep=004] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1129
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4874 mb_mean=0.5023 norm_overlap=1.0001 corr_cb=0.2085 topkJ=0.0997
[TRAIN][ep=005] loss=0.6863 acc=55.17%
[TRAIN][ep=005] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1147
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4933 mb_mean=0.5052 norm_overlap=1.0001 corr_cb=0.1915 topkJ=0.0991
[TRAIN][ep=006] loss=0.6834 acc=57.85%
[TRAIN][ep=006] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1051
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4811 mb_mean=0.5022 norm_overlap=1.0001 corr_cb=0.1599 topkJ=0.1247
[TRAIN][ep=007] loss=0.6773 acc=58.39%
[TRAIN][ep=007] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1165
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4923 mb_mean=0.5061 norm_overlap=1.0000 corr_cb=-0.0490 topkJ=0.0591
[TRAIN][ep=008] loss=0.6750 acc=60.54%
[TRAIN][ep=008] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1064
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4885 mb_mean=0.5031 norm_overlap=1.0001 corr_cb=0.1442 topkJ=0.0897
[TRAIN][ep=009] loss=0.6778 acc=56.38%
[TRAIN][ep=009] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1185
================= FIT START (fold=1) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4904 mb_mean=0.5056 norm_overlap=1.0001 corr_cb=0.1620 topkJ=0.1007
[TRAIN][ep=000] loss=0.6654 acc=62.55%
[TRAIN][ep=000] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1145
[EPOCH 000/089] train: loss=0.6654 acc=62.55% | val: loss=0.6955 acc=59.04% f1=66.67% auc=56.34% val_score=40.0230 val_score_bestthr=61.6101 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.115) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 61.6101
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4891 mb_mean=0.5036 norm_overlap=1.0002 corr_cb=0.2700 topkJ=0.1255
[TRAIN][ep=001] loss=0.6582 acc=62.55%
[TRAIN][ep=001] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1127
[EPOCH 001/089] train: loss=0.6582 acc=62.55% | val: loss=0.6829 acc=60.24% f1=67.33% auc=56.34% val_score=59.5215 val_score_bestthr=63.1139 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.113) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 61.6101 -> 63.1139
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4874 mb_mean=0.5035 norm_overlap=1.0000 corr_cb=0.0912 topkJ=0.0898
[TRAIN][ep=002] loss=0.6501 acc=64.03%
[TRAIN][ep=002] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1172
[EPOCH 002/089] train: loss=0.6501 acc=64.03% | val: loss=0.6854 acc=60.24% f1=67.33% auc=56.10% val_score=59.5215 val_score_bestthr=63.1139 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.117) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.1139 -> 63.1139
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4901 mb_mean=0.5043 norm_overlap=1.0001 corr_cb=0.1890 topkJ=0.1067
[TRAIN][ep=003] loss=0.6427 acc=64.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1173
[EPOCH 003/089] train: loss=0.6427 acc=64.70% | val: loss=0.6899 acc=59.04% f1=66.67% auc=56.57% val_score=60.3480 val_score_bestthr=61.6101 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.117) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.1139 -> 61.6101
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4879 mb_mean=0.5014 norm_overlap=1.0004 corr_cb=0.5752 topkJ=0.1843
[TRAIN][ep=004] loss=0.6386 acc=63.49%
[TRAIN][ep=004] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1096
[EPOCH 004/089] train: loss=0.6386 acc=63.49% | val: loss=0.6863 acc=60.24% f1=67.33% auc=55.64% val_score=59.3002 val_score_bestthr=63.1139 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.110) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.1139 -> 63.1139
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4909 mb_mean=0.5055 norm_overlap=1.0002 corr_cb=0.3822 topkJ=0.1455
[TRAIN][ep=005] loss=1.3605 acc=63.76%
[TRAIN][ep=005] mask_avg: mc_mean=0.3764 mb_mean=0.5039 norm_overlap=1.0003 corr_cb=0.1128
[EPOCH 005/089] train: loss=1.3605 acc=63.76% | val: loss=0.6814 acc=60.24% f1=67.33% auc=56.69% val_score=57.4025 val_score_bestthr=63.1139 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.376, mb=0.504, no=1.000, corr=0.113) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.1139 -> 63.1139
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2775 mb_mean=0.5027 norm_overlap=1.0025 corr_cb=0.4426 topkJ=0.1506
[TRAIN][ep=006] loss=1.3325 acc=65.10%
[TRAIN][ep=006] mask_avg: mc_mean=0.2626 mb_mean=0.5039 norm_overlap=1.0006 corr_cb=0.1094
[EPOCH 006/089] train: loss=1.3325 acc=65.10% | val: loss=0.6831 acc=60.24% f1=67.96% auc=56.74% val_score=49.9994 val_score_bestthr=61.4940 | dyn(w_pfs=0.240, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.263, mb=0.504, no=1.001, corr=0.109) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.1139 -> 61.4940
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2425 mb_mean=0.5043 norm_overlap=1.0011 corr_cb=0.1529 topkJ=0.1159
[TRAIN][ep=007] loss=1.1426 acc=65.91%
[TRAIN][ep=007] mask_avg: mc_mean=0.2302 mb_mean=0.5039 norm_overlap=1.0006 corr_cb=0.0864
[EPOCH 007/089] train: loss=1.1426 acc=65.91% | val: loss=0.6867 acc=60.24% f1=67.96% auc=56.63% val_score=44.7424 val_score_bestthr=61.4940 | dyn(w_pfs=0.140, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.230, mb=0.504, no=1.001, corr=0.086) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.1139 -> 61.4940
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2345 mb_mean=0.5056 norm_overlap=1.0002 corr_cb=0.0194 topkJ=0.0932
[TRAIN][ep=008] loss=0.9372 acc=68.46%
[TRAIN][ep=008] mask_avg: mc_mean=0.2067 mb_mean=0.5039 norm_overlap=1.0005 corr_cb=0.0654
[EPOCH 008/089] train: loss=0.9372 acc=68.46% | val: loss=0.6870 acc=60.24% f1=68.57% auc=56.69% val_score=57.6140 val_score_bestthr=63.7999 | dyn(w_pfs=0.180, w_sup=0.090, w_csuf=0.040, stage2=False) | mask(mc=0.207, mb=0.504, no=1.001, corr=0.065) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 63.1139 -> 63.7999
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1942 mb_mean=0.5044 norm_overlap=1.0004 corr_cb=0.0447 topkJ=0.0743
[TRAIN][ep=009] loss=1.0072 acc=66.98%
[TRAIN][ep=009] mask_avg: mc_mean=0.1975 mb_mean=0.5039 norm_overlap=1.0003 corr_cb=0.0376
[EPOCH 009/089] train: loss=1.0072 acc=66.98% | val: loss=0.6899 acc=60.24% f1=67.96% auc=56.80% val_score=55.6804 val_score_bestthr=61.4940 | dyn(w_pfs=0.220, w_sup=0.130, w_csuf=0.080, stage2=False) | mask(mc=0.198, mb=0.504, no=1.000, corr=0.038) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.7999 -> 61.4940
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1938 mb_mean=0.5054 norm_overlap=1.0001 corr_cb=0.0076 topkJ=0.0499
[TRAIN][ep=010] loss=1.0876 acc=66.17%
[TRAIN][ep=010] mask_avg: mc_mean=0.1846 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.0126
[EPOCH 010/089] train: loss=1.0876 acc=66.17% | val: loss=0.6863 acc=57.83% f1=67.89% auc=57.62% val_score=58.6341 val_score_bestthr=61.2699 | dyn(w_pfs=0.260, w_sup=0.170, w_csuf=0.120, stage2=False) | mask(mc=0.185, mb=0.504, no=1.000, corr=0.013) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.7999 -> 61.2699
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.2023 mb_mean=0.5045 norm_overlap=1.0004 corr_cb=0.0475 topkJ=0.0717
[TRAIN][ep=011] loss=1.1535 acc=67.25%
[TRAIN][ep=011] mask_avg: mc_mean=0.1885 mb_mean=0.5039 norm_overlap=0.9997 corr_cb=-0.0274
[EPOCH 011/089] train: loss=1.1535 acc=67.25% | val: loss=0.7031 acc=59.04% f1=67.31% auc=57.85% val_score=41.4213 val_score_bestthr=60.0348 | dyn(w_pfs=0.300, w_sup=0.210, w_csuf=0.160, stage2=False) | mask(mc=0.188, mb=0.504, no=1.000, corr=-0.027) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.7999 -> 60.0348
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1831 mb_mean=0.5042 norm_overlap=1.0005 corr_cb=0.0449 topkJ=0.0832
[TRAIN][ep=012] loss=1.2173 acc=66.71%
[TRAIN][ep=012] mask_avg: mc_mean=0.1767 mb_mean=0.5039 norm_overlap=0.9994 corr_cb=-0.0579
[EPOCH 012/089] train: loss=1.2173 acc=66.71% | val: loss=0.7076 acc=61.45% f1=68.63% auc=57.73% val_score=38.8095 val_score_bestthr=63.5151 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.177, mb=0.504, no=0.999, corr=-0.058) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.7999 -> 63.5151
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1974 mb_mean=0.5031 norm_overlap=0.9981 corr_cb=-0.1910 topkJ=0.0685
[TRAIN][ep=013] loss=1.2777 acc=69.13%
[TRAIN][ep=013] mask_avg: mc_mean=0.1785 mb_mean=0.5039 norm_overlap=0.9989 corr_cb=-0.1056
[EPOCH 013/089] train: loss=1.2777 acc=69.13% | val: loss=0.7016 acc=57.83% f1=67.89% auc=57.91% val_score=42.8525 val_score_bestthr=61.2699 | dyn(w_pfs=0.240, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.178, mb=0.504, no=0.999, corr=-0.106) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.7999 -> 61.2699
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1847 mb_mean=0.5017 norm_overlap=0.9968 corr_cb=-0.2331 topkJ=0.0571
[TRAIN][ep=014] loss=1.0975 acc=68.05%
[TRAIN][ep=014] mask_avg: mc_mean=0.1823 mb_mean=0.5039 norm_overlap=0.9985 corr_cb=-0.1328
[EPOCH 014/089] train: loss=1.0975 acc=68.05% | val: loss=0.6961 acc=59.04% f1=67.31% auc=58.26% val_score=55.5840 val_score_bestthr=61.9467 | dyn(w_pfs=0.140, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.182, mb=0.504, no=0.999, corr=-0.133) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.7999 -> 61.9467
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1526 mb_mean=0.5031 norm_overlap=0.9978 corr_cb=-0.1860 topkJ=0.0534
[TRAIN][ep=015] loss=0.8989 acc=69.53%
[TRAIN][ep=015] mask_avg: mc_mean=0.1728 mb_mean=0.5039 norm_overlap=0.9980 corr_cb=-0.1636
[EPOCH 015/089] train: loss=0.8989 acc=69.53% | val: loss=0.7478 acc=57.83% f1=71.07% auc=57.91% val_score=50.9295 val_score_bestthr=65.1044 | dyn(w_pfs=0.180, w_sup=0.090, w_csuf=0.040, stage2=False) | mask(mc=0.173, mb=0.504, no=0.998, corr=-0.164) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 63.7999 -> 65.1044
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1673 mb_mean=0.5045 norm_overlap=0.9965 corr_cb=-0.3022 topkJ=0.0206
[TRAIN][ep=016] loss=0.9610 acc=71.41%
[TRAIN][ep=016] mask_avg: mc_mean=0.1752 mb_mean=0.5039 norm_overlap=0.9975 corr_cb=-0.1965
[EPOCH 016/089] train: loss=0.9610 acc=71.41% | val: loss=0.7000 acc=56.63% f1=70.49% auc=58.43% val_score=57.3788 val_score_bestthr=64.1779 | dyn(w_pfs=0.220, w_sup=0.130, w_csuf=0.080, stage2=False) | mask(mc=0.175, mb=0.504, no=0.998, corr=-0.196) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 64.1779
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.2135 mb_mean=0.5056 norm_overlap=0.9973 corr_cb=-0.2389 topkJ=0.0248
[TRAIN][ep=017] loss=1.0308 acc=71.28%
[TRAIN][ep=017] mask_avg: mc_mean=0.1754 mb_mean=0.5039 norm_overlap=0.9969 corr_cb=-0.2296
[EPOCH 017/089] train: loss=1.0308 acc=71.28% | val: loss=0.7032 acc=62.65% f1=69.31% auc=57.97% val_score=57.3788 val_score_bestthr=62.3366 | dyn(w_pfs=0.260, w_sup=0.170, w_csuf=0.120, stage2=False) | mask(mc=0.175, mb=0.504, no=0.997, corr=-0.230) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 62.3366
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.2002 mb_mean=0.5031 norm_overlap=0.9966 corr_cb=-0.2708 topkJ=0.0400
[TRAIN][ep=018] loss=1.1118 acc=69.80%
[TRAIN][ep=018] mask_avg: mc_mean=0.1807 mb_mean=0.5039 norm_overlap=0.9964 corr_cb=-0.2563
[EPOCH 018/089] train: loss=1.1118 acc=69.80% | val: loss=0.6969 acc=57.83% f1=71.07% auc=59.24% val_score=55.4778 val_score_bestthr=65.1044 | dyn(w_pfs=0.300, w_sup=0.210, w_csuf=0.160, stage2=False) | mask(mc=0.181, mb=0.504, no=0.996, corr=-0.256) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 65.1044
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1308 mb_mean=0.4993 norm_overlap=0.9951 corr_cb=-0.3008 topkJ=0.0211
[TRAIN][ep=019] loss=1.1659 acc=71.41%
[TRAIN][ep=019] mask_avg: mc_mean=0.1949 mb_mean=0.5039 norm_overlap=0.9960 corr_cb=-0.2849
[EPOCH 019/089] train: loss=1.1659 acc=71.41% | val: loss=0.7168 acc=62.65% f1=69.31% auc=59.13% val_score=34.7326 val_score_bestthr=62.3366 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.195, mb=0.504, no=0.996, corr=-0.285) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 62.3366
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1821 mb_mean=0.5035 norm_overlap=0.9973 corr_cb=-0.1900 topkJ=0.0317
[TRAIN][ep=020] loss=1.2358 acc=71.14%
[TRAIN][ep=020] mask_avg: mc_mean=0.1966 mb_mean=0.5039 norm_overlap=0.9956 corr_cb=-0.3008
[EPOCH 020/089] train: loss=1.2358 acc=71.14% | val: loss=0.7049 acc=62.65% f1=68.69% auc=59.13% val_score=48.7053 val_score_bestthr=60.5893 | dyn(w_pfs=0.240, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.197, mb=0.504, no=0.996, corr=-0.301) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 60.5893
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.1896 mb_mean=0.5031 norm_overlap=0.9944 corr_cb=-0.4024 topkJ=0.0078
[TRAIN][ep=021] loss=1.0447 acc=71.81%
[TRAIN][ep=021] mask_avg: mc_mean=0.1940 mb_mean=0.5039 norm_overlap=0.9953 corr_cb=-0.3043
[EPOCH 021/089] train: loss=1.0447 acc=71.81% | val: loss=0.7099 acc=62.65% f1=69.31% auc=58.72% val_score=44.3074 val_score_bestthr=62.3366 | dyn(w_pfs=0.140, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.194, mb=0.504, no=0.995, corr=-0.304) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 62.3366
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2195 mb_mean=0.5056 norm_overlap=0.9918 corr_cb=-0.4717 topkJ=0.0039
[TRAIN][ep=022] loss=0.8525 acc=72.08%
[TRAIN][ep=022] mask_avg: mc_mean=0.1933 mb_mean=0.5039 norm_overlap=0.9949 corr_cb=-0.3123
[EPOCH 022/089] train: loss=0.8525 acc=72.08% | val: loss=0.7165 acc=63.86% f1=68.75% auc=59.24% val_score=48.0986 val_score_bestthr=59.7060 | dyn(w_pfs=0.040, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.193, mb=0.504, no=0.995, corr=-0.312) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.7060
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1856 mb_mean=0.5049 norm_overlap=0.9944 corr_cb=-0.3532 topkJ=0.0180
[TRAIN][ep=023] loss=0.8201 acc=74.09%
[TRAIN][ep=023] mask_avg: mc_mean=0.2148 mb_mean=0.5039 norm_overlap=0.9948 corr_cb=-0.3357
[EPOCH 023/089] train: loss=0.8201 acc=74.09% | val: loss=0.7435 acc=57.83% f1=70.59% auc=59.59% val_score=51.6757 val_score_bestthr=60.6955 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.215, mb=0.504, no=0.995, corr=-0.336) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 60.6955
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1509 mb_mean=0.5040 norm_overlap=0.9949 corr_cb=-0.2481 topkJ=0.0195
[TRAIN][ep=024] loss=0.7968 acc=73.69%
[TRAIN][ep=024] mask_avg: mc_mean=0.1899 mb_mean=0.5039 norm_overlap=0.9944 corr_cb=-0.3183
[EPOCH 024/089] train: loss=0.7968 acc=73.69% | val: loss=0.7123 acc=56.63% f1=69.49% auc=59.83% val_score=51.5646 val_score_bestthr=59.8573 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.504, no=0.994, corr=-0.318) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.8573
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1888 mb_mean=0.5015 norm_overlap=0.9955 corr_cb=-0.3020 topkJ=0.0136
[TRAIN][ep=025] loss=0.7870 acc=75.03%
[TRAIN][ep=025] mask_avg: mc_mean=0.2123 mb_mean=0.5039 norm_overlap=0.9942 corr_cb=-0.3428
[EPOCH 025/089] train: loss=0.7870 acc=75.03% | val: loss=0.7214 acc=61.45% f1=68.63% auc=59.30% val_score=53.6901 val_score_bestthr=59.6743 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.212, mb=0.504, no=0.994, corr=-0.343) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.6743
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2197 mb_mean=0.5035 norm_overlap=0.9965 corr_cb=-0.2261 topkJ=0.0325
[TRAIN][ep=026] loss=0.7852 acc=73.56%
[TRAIN][ep=026] mask_avg: mc_mean=0.2046 mb_mean=0.5039 norm_overlap=0.9940 corr_cb=-0.3361
[EPOCH 026/089] train: loss=0.7852 acc=73.56% | val: loss=0.7372 acc=65.06% f1=70.71% auc=60.76% val_score=48.4732 val_score_bestthr=62.3163 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.205, mb=0.504, no=0.994, corr=-0.336) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 62.3163
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2079 mb_mean=0.5061 norm_overlap=0.9911 corr_cb=-0.4551 topkJ=0.0052
[TRAIN][ep=027] loss=0.8089 acc=75.03%
[TRAIN][ep=027] mask_avg: mc_mean=0.1900 mb_mean=0.5039 norm_overlap=0.9939 corr_cb=-0.3242
[EPOCH 027/089] train: loss=0.8089 acc=75.03% | val: loss=0.7083 acc=55.42% f1=69.92% auc=60.47% val_score=53.4865 val_score_bestthr=63.6770 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.504, no=0.994, corr=-0.324) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 63.6770
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1201 mb_mean=0.5045 norm_overlap=0.9926 corr_cb=-0.3211 topkJ=0.0121
[TRAIN][ep=028] loss=0.7686 acc=76.24%
[TRAIN][ep=028] mask_avg: mc_mean=0.1835 mb_mean=0.5039 norm_overlap=0.9937 corr_cb=-0.3194
[EPOCH 028/089] train: loss=0.7686 acc=76.24% | val: loss=0.7399 acc=61.45% f1=69.81% auc=60.12% val_score=54.4903 val_score_bestthr=61.3072 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.183, mb=0.504, no=0.994, corr=-0.319) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 61.3072
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2258 mb_mean=0.5067 norm_overlap=0.9907 corr_cb=-0.4785 topkJ=0.0024
[TRAIN][ep=029] loss=0.7669 acc=75.97%
[TRAIN][ep=029] mask_avg: mc_mean=0.2069 mb_mean=0.5039 norm_overlap=0.9937 corr_cb=-0.3393
[EPOCH 029/089] train: loss=0.7669 acc=75.97% | val: loss=0.7410 acc=62.65% f1=69.31% auc=60.23% val_score=52.8520 val_score_bestthr=59.6610 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.207, mb=0.504, no=0.994, corr=-0.339) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.6610
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2098 mb_mean=0.5046 norm_overlap=0.9939 corr_cb=-0.3441 topkJ=0.0059
[TRAIN][ep=030] loss=0.7538 acc=76.11%
[TRAIN][ep=030] mask_avg: mc_mean=0.2270 mb_mean=0.5039 norm_overlap=0.9937 corr_cb=-0.3558
[EPOCH 030/089] train: loss=0.7538 acc=76.11% | val: loss=0.7460 acc=63.86% f1=70.59% auc=61.22% val_score=53.0090 val_score_bestthr=59.1015 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.227, mb=0.504, no=0.994, corr=-0.356) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.1015
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2269 mb_mean=0.5031 norm_overlap=0.9961 corr_cb=-0.2499 topkJ=0.0166
[TRAIN][ep=031] loss=0.7519 acc=75.44%
[TRAIN][ep=031] mask_avg: mc_mean=0.2172 mb_mean=0.5039 norm_overlap=0.9936 corr_cb=-0.3467
[EPOCH 031/089] train: loss=0.7519 acc=75.44% | val: loss=0.7979 acc=62.65% f1=68.04% auc=62.03% val_score=47.1839 val_score_bestthr=58.3290 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.217, mb=0.504, no=0.994, corr=-0.347) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 58.3290
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2330 mb_mean=0.5042 norm_overlap=0.9945 corr_cb=-0.3349 topkJ=0.0091
[TRAIN][ep=032] loss=0.7789 acc=73.96%
[TRAIN][ep=032] mask_avg: mc_mean=0.1945 mb_mean=0.5039 norm_overlap=0.9933 corr_cb=-0.3382
[EPOCH 032/089] train: loss=0.7789 acc=73.96% | val: loss=0.7428 acc=61.45% f1=68.63% auc=61.86% val_score=57.0189 val_score_bestthr=59.6743 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.194, mb=0.504, no=0.993, corr=-0.338) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.6743
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2116 mb_mean=0.5032 norm_overlap=0.9903 corr_cb=-0.4005 topkJ=0.0144
[TRAIN][ep=033] loss=0.7461 acc=75.84%
[TRAIN][ep=033] mask_avg: mc_mean=0.2078 mb_mean=0.5039 norm_overlap=0.9935 corr_cb=-0.3394
[EPOCH 033/089] train: loss=0.7461 acc=75.84% | val: loss=0.8269 acc=56.63% f1=68.97% auc=61.69% val_score=50.9998 val_score_bestthr=58.9895 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.208, mb=0.504, no=0.993, corr=-0.339) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 58.9895
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2496 mb_mean=0.5013 norm_overlap=0.9946 corr_cb=-0.3304 topkJ=0.0175
[TRAIN][ep=034] loss=0.7356 acc=77.45%
[TRAIN][ep=034] mask_avg: mc_mean=0.2148 mb_mean=0.5039 norm_overlap=0.9935 corr_cb=-0.3437
[EPOCH 034/089] train: loss=0.7356 acc=77.45% | val: loss=0.7822 acc=62.65% f1=69.31% auc=61.16% val_score=44.0646 val_score_bestthr=57.1156 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.215, mb=0.504, no=0.993, corr=-0.344) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 57.1156
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2080 mb_mean=0.5009 norm_overlap=0.9911 corr_cb=-0.4080 topkJ=0.0064
[TRAIN][ep=035] loss=0.7350 acc=77.18%
[TRAIN][ep=035] mask_avg: mc_mean=0.2190 mb_mean=0.5039 norm_overlap=0.9935 corr_cb=-0.3454
[EPOCH 035/089] train: loss=0.7350 acc=77.18% | val: loss=0.7697 acc=62.65% f1=69.90% auc=61.16% val_score=57.0189 val_score_bestthr=57.9939 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.219, mb=0.504, no=0.994, corr=-0.345) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 57.9939
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2040 mb_mean=0.5038 norm_overlap=0.9978 corr_cb=-0.1345 topkJ=0.0309
[TRAIN][ep=036] loss=0.7498 acc=76.11%
[TRAIN][ep=036] mask_avg: mc_mean=0.1866 mb_mean=0.5039 norm_overlap=0.9933 corr_cb=-0.3135
[EPOCH 036/089] train: loss=0.7498 acc=76.11% | val: loss=0.7519 acc=59.04% f1=69.64% auc=62.56% val_score=57.0189 val_score_bestthr=58.9090 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.187, mb=0.504, no=0.993, corr=-0.314) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 58.9090
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.2745 mb_mean=0.5037 norm_overlap=0.9943 corr_cb=-0.3209 topkJ=0.0111
[TRAIN][ep=037] loss=0.7113 acc=77.45%
[TRAIN][ep=037] mask_avg: mc_mean=0.2337 mb_mean=0.5039 norm_overlap=0.9937 corr_cb=-0.3430
[EPOCH 037/089] train: loss=0.7113 acc=77.45% | val: loss=0.7617 acc=56.63% f1=70.00% auc=63.14% val_score=55.3844 val_score_bestthr=60.2971 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.234, mb=0.504, no=0.994, corr=-0.343) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 60.2971
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2252 mb_mean=0.5034 norm_overlap=0.9938 corr_cb=-0.3498 topkJ=0.0166
[TRAIN][ep=038] loss=0.7090 acc=78.79%
[TRAIN][ep=038] mask_avg: mc_mean=0.2537 mb_mean=0.5039 norm_overlap=0.9939 corr_cb=-0.3539
[EPOCH 038/089] train: loss=0.7090 acc=78.79% | val: loss=0.8058 acc=60.24% f1=61.18% auc=63.26% val_score=52.5715 val_score_bestthr=58.2151 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.254, mb=0.504, no=0.994, corr=-0.354) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 58.2151
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2648 mb_mean=0.5021 norm_overlap=0.9963 corr_cb=-0.2239 topkJ=0.0159
[TRAIN][ep=039] loss=0.6994 acc=80.13%
[TRAIN][ep=039] mask_avg: mc_mean=0.2327 mb_mean=0.5039 norm_overlap=0.9937 corr_cb=-0.3486
[EPOCH 039/089] train: loss=0.6994 acc=80.13% | val: loss=0.8393 acc=60.24% f1=70.27% auc=62.91% val_score=55.7259 val_score_bestthr=62.7556 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.233, mb=0.504, no=0.994, corr=-0.349) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 62.7556
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.2105 mb_mean=0.5045 norm_overlap=0.9931 corr_cb=-0.4009 topkJ=0.0148
[TRAIN][ep=040] loss=0.6916 acc=80.40%
[TRAIN][ep=040] mask_avg: mc_mean=0.2073 mb_mean=0.5039 norm_overlap=0.9937 corr_cb=-0.3163
[EPOCH 040/089] train: loss=0.6916 acc=80.40% | val: loss=0.7870 acc=60.24% f1=70.27% auc=63.49% val_score=58.2236 val_score_bestthr=59.5101 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.207, mb=0.504, no=0.994, corr=-0.316) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.5101
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.1714 mb_mean=0.5043 norm_overlap=0.9952 corr_cb=-0.2459 topkJ=0.0187
[TRAIN][ep=041] loss=0.7001 acc=80.13%
[TRAIN][ep=041] mask_avg: mc_mean=0.2602 mb_mean=0.5039 norm_overlap=0.9940 corr_cb=-0.3502
[EPOCH 041/089] train: loss=0.7001 acc=80.13% | val: loss=0.8400 acc=59.04% f1=59.52% auc=63.90% val_score=50.1156 val_score_bestthr=58.7331 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.260, mb=0.504, no=0.994, corr=-0.350) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 58.7331
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.2959 mb_mean=0.5033 norm_overlap=0.9952 corr_cb=-0.3003 topkJ=0.0240
[TRAIN][ep=042] loss=0.6983 acc=79.06%
[TRAIN][ep=042] mask_avg: mc_mean=0.2068 mb_mean=0.5039 norm_overlap=0.9938 corr_cb=-0.3163
[EPOCH 042/089] train: loss=0.6983 acc=79.06% | val: loss=0.7930 acc=61.45% f1=68.00% auc=63.95% val_score=57.6745 val_score_bestthr=57.6713 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.207, mb=0.504, no=0.994, corr=-0.316) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 57.6713
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.2108 mb_mean=0.5044 norm_overlap=0.9938 corr_cb=-0.3573 topkJ=0.0175
[TRAIN][ep=043] loss=0.6629 acc=81.61%
[TRAIN][ep=043] mask_avg: mc_mean=0.2296 mb_mean=0.5039 norm_overlap=0.9938 corr_cb=-0.3385
[EPOCH 043/089] train: loss=0.6629 acc=81.61% | val: loss=0.8429 acc=61.45% f1=68.00% auc=64.42% val_score=54.9538 val_score_bestthr=58.9482 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.230, mb=0.504, no=0.994, corr=-0.339) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 58.9482
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.1961 mb_mean=0.5091 norm_overlap=0.9952 corr_cb=-0.3037 topkJ=0.0180
[TRAIN][ep=044] loss=0.6979 acc=79.19%
[TRAIN][ep=044] mask_avg: mc_mean=0.2319 mb_mean=0.5039 norm_overlap=0.9939 corr_cb=-0.3296
[EPOCH 044/089] train: loss=0.6979 acc=79.19% | val: loss=0.8084 acc=59.04% f1=69.09% auc=63.60% val_score=54.1599 val_score_bestthr=61.6781 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.232, mb=0.504, no=0.994, corr=-0.330) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 61.6781
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2372 mb_mean=0.5010 norm_overlap=0.9933 corr_cb=-0.3514 topkJ=0.0248
[TRAIN][ep=045] loss=0.6576 acc=82.15%
[TRAIN][ep=045] mask_avg: mc_mean=0.2466 mb_mean=0.5039 norm_overlap=0.9939 corr_cb=-0.3382
[EPOCH 045/089] train: loss=0.6576 acc=82.15% | val: loss=0.8391 acc=60.24% f1=60.24% auc=65.35% val_score=57.3360 val_score_bestthr=58.7255 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.247, mb=0.504, no=0.994, corr=-0.338) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 58.7255
[EARLY STOP] no improvement for 30 epochs. best_epoch=15
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
=============== FIT DONE ===============
[BEST] epoch=15 | val_acc=57.83% | val_f1=71.07% | val_auc=57.91% | val_score=50.9295 | val_score_bestthr=65.1044
[TEST@BEST] thr_used=0.635 | acc=65.22% f1=67.57% auc=68.47% | SP_sex=0.56% EO_sex=4.76% SP_age=18.79% EO_age=21.79%
[TIME] 1.19 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/summary_fold_1.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4855 mb_mean=0.5049 norm_overlap=1.0000 corr_cb=0.0473 topkJ=0.1080
[TRAIN][ep=000] loss=0.6948 acc=48.99%
[TRAIN][ep=000] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1097
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4906 mb_mean=0.5028 norm_overlap=1.0002 corr_cb=0.3495 topkJ=0.0900
[TRAIN][ep=001] loss=0.6923 acc=51.95%
[TRAIN][ep=001] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1148
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4863 mb_mean=0.5023 norm_overlap=1.0001 corr_cb=0.0850 topkJ=0.0855
[TRAIN][ep=002] loss=0.6921 acc=53.15%
[TRAIN][ep=002] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1042
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4827 mb_mean=0.5045 norm_overlap=1.0001 corr_cb=0.1327 topkJ=0.1111
[TRAIN][ep=003] loss=0.6889 acc=54.36%
[TRAIN][ep=003] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1168
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4839 mb_mean=0.5059 norm_overlap=1.0001 corr_cb=0.1207 topkJ=0.1266
[TRAIN][ep=004] loss=0.6880 acc=54.50%
[TRAIN][ep=004] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1129
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4874 mb_mean=0.5023 norm_overlap=1.0001 corr_cb=0.2085 topkJ=0.0997
[TRAIN][ep=005] loss=0.6863 acc=55.17%
[TRAIN][ep=005] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1147
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4933 mb_mean=0.5052 norm_overlap=1.0001 corr_cb=0.1915 topkJ=0.0991
[TRAIN][ep=006] loss=0.6834 acc=57.85%
[TRAIN][ep=006] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1051
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4811 mb_mean=0.5022 norm_overlap=1.0001 corr_cb=0.1599 topkJ=0.1247
[TRAIN][ep=007] loss=0.6773 acc=58.39%
[TRAIN][ep=007] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1165
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4923 mb_mean=0.5061 norm_overlap=1.0000 corr_cb=-0.0490 topkJ=0.0591
[TRAIN][ep=008] loss=0.6751 acc=60.54%
[TRAIN][ep=008] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1064
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4885 mb_mean=0.5031 norm_overlap=1.0001 corr_cb=0.1442 topkJ=0.0897
[TRAIN][ep=009] loss=0.6778 acc=56.24%
[TRAIN][ep=009] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1185
================= FIT START (fold=1) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4904 mb_mean=0.5056 norm_overlap=1.0001 corr_cb=0.1620 topkJ=0.1007
[TRAIN][ep=000] loss=0.6655 acc=62.42%
[TRAIN][ep=000] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1145
[EPOCH 000/089] train: loss=0.6655 acc=62.42% | val: loss=0.6955 acc=60.24% f1=70.27% auc=56.34% val_score=40.0230 val_score_bestthr=63.4778 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.115) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 63.4778
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4891 mb_mean=0.5036 norm_overlap=1.0002 corr_cb=0.2700 topkJ=0.1255
[TRAIN][ep=001] loss=0.6582 acc=62.28%
[TRAIN][ep=001] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1127
[EPOCH 001/089] train: loss=0.6582 acc=62.28% | val: loss=0.6830 acc=60.24% f1=67.33% auc=56.16% val_score=59.5215 val_score_bestthr=63.1139 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.113) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.4778 -> 63.1139
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4874 mb_mean=0.5035 norm_overlap=1.0000 corr_cb=0.0912 topkJ=0.0898
[TRAIN][ep=002] loss=0.6501 acc=64.03%
[TRAIN][ep=002] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1172
[EPOCH 002/089] train: loss=0.6501 acc=64.03% | val: loss=0.6854 acc=60.24% f1=67.33% auc=56.16% val_score=59.5215 val_score_bestthr=63.1139 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.117) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.4778 -> 63.1139
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4901 mb_mean=0.5043 norm_overlap=1.0001 corr_cb=0.1890 topkJ=0.1067
[TRAIN][ep=003] loss=0.6428 acc=64.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1173
[EPOCH 003/089] train: loss=0.6428 acc=64.70% | val: loss=0.6899 acc=59.04% f1=66.67% auc=56.45% val_score=60.3480 val_score_bestthr=61.6101 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.117) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.4778 -> 61.6101
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4879 mb_mean=0.5014 norm_overlap=1.0004 corr_cb=0.5752 topkJ=0.1843
[TRAIN][ep=004] loss=0.6386 acc=63.36%
[TRAIN][ep=004] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1096
[EPOCH 004/089] train: loss=0.6386 acc=63.36% | val: loss=0.6864 acc=60.24% f1=67.33% auc=55.70% val_score=59.3002 val_score_bestthr=63.1139 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.110) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.4778 -> 63.1139
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4909 mb_mean=0.5055 norm_overlap=1.0002 corr_cb=0.3822 topkJ=0.1455
[TRAIN][ep=005] loss=1.5414 acc=62.95%
[TRAIN][ep=005] mask_avg: mc_mean=0.3792 mb_mean=0.5039 norm_overlap=1.0003 corr_cb=0.1123
[EPOCH 005/089] train: loss=1.5414 acc=62.95% | val: loss=0.6818 acc=60.24% f1=67.33% auc=56.63% val_score=54.4018 val_score_bestthr=63.1139 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.379, mb=0.504, no=1.000, corr=0.112) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.4778 -> 63.1139
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2802 mb_mean=0.5027 norm_overlap=1.0025 corr_cb=0.4426 topkJ=0.1501
[TRAIN][ep=006] loss=1.2388 acc=65.91%
[TRAIN][ep=006] mask_avg: mc_mean=0.2649 mb_mean=0.5039 norm_overlap=1.0006 corr_cb=0.1084
[EPOCH 006/089] train: loss=1.2388 acc=65.91% | val: loss=0.6844 acc=59.04% f1=66.67% auc=56.51% val_score=47.7867 val_score_bestthr=61.7970 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.265, mb=0.504, no=1.001, corr=0.108) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.4778 -> 61.7970
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2442 mb_mean=0.5043 norm_overlap=1.0011 corr_cb=0.1527 topkJ=0.1184
[TRAIN][ep=007] loss=0.9790 acc=66.04%
[TRAIN][ep=007] mask_avg: mc_mean=0.2316 mb_mean=0.5039 norm_overlap=1.0006 corr_cb=0.0847
[EPOCH 007/089] train: loss=0.9790 acc=66.04% | val: loss=0.6878 acc=61.45% f1=68.63% auc=56.69% val_score=46.1192 val_score_bestthr=63.2603 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.232, mb=0.504, no=1.001, corr=0.085) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.4778 -> 63.2603
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2372 mb_mean=0.5056 norm_overlap=1.0001 corr_cb=0.0137 topkJ=0.0937
[TRAIN][ep=008] loss=0.8959 acc=67.79%
[TRAIN][ep=008] mask_avg: mc_mean=0.2073 mb_mean=0.5039 norm_overlap=1.0005 corr_cb=0.0632
[EPOCH 008/089] train: loss=0.8959 acc=67.79% | val: loss=0.6882 acc=61.45% f1=69.23% auc=56.57% val_score=57.6140 val_score_bestthr=64.9036 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.207, mb=0.504, no=1.001, corr=0.063) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 63.4778 -> 64.9036
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1947 mb_mean=0.5044 norm_overlap=1.0004 corr_cb=0.0422 topkJ=0.0748
[TRAIN][ep=009] loss=0.9950 acc=66.98%
[TRAIN][ep=009] mask_avg: mc_mean=0.1973 mb_mean=0.5039 norm_overlap=1.0003 corr_cb=0.0349
[EPOCH 009/089] train: loss=0.9950 acc=66.98% | val: loss=0.6906 acc=60.24% f1=68.57% auc=56.69% val_score=55.5121 val_score_bestthr=63.7999 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.197, mb=0.504, no=1.000, corr=0.035) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9036 -> 63.7999
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1924 mb_mean=0.5054 norm_overlap=1.0000 corr_cb=0.0045 topkJ=0.0494
[TRAIN][ep=010] loss=1.1033 acc=66.31%
[TRAIN][ep=010] mask_avg: mc_mean=0.1823 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.0116
[EPOCH 010/089] train: loss=1.1033 acc=66.31% | val: loss=0.6860 acc=57.83% f1=67.89% auc=57.56% val_score=58.6341 val_score_bestthr=61.2699 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.182, mb=0.504, no=1.000, corr=0.012) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9036 -> 61.2699
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1996 mb_mean=0.5045 norm_overlap=1.0004 corr_cb=0.0450 topkJ=0.0713
[TRAIN][ep=011] loss=1.1983 acc=66.85%
[TRAIN][ep=011] mask_avg: mc_mean=0.1851 mb_mean=0.5039 norm_overlap=0.9997 corr_cb=-0.0292
[EPOCH 011/089] train: loss=1.1983 acc=66.85% | val: loss=0.7005 acc=56.63% f1=70.49% auc=58.02% val_score=41.1344 val_score_bestthr=64.1779 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.185, mb=0.504, no=1.000, corr=-0.029) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9036 -> 64.1779
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1805 mb_mean=0.5042 norm_overlap=1.0004 corr_cb=0.0423 topkJ=0.0823
[TRAIN][ep=012] loss=1.2893 acc=66.85%
[TRAIN][ep=012] mask_avg: mc_mean=0.1751 mb_mean=0.5039 norm_overlap=0.9993 corr_cb=-0.0637
[EPOCH 012/089] train: loss=1.2893 acc=66.85% | val: loss=0.7070 acc=61.45% f1=68.63% auc=57.56% val_score=41.4213 val_score_bestthr=63.5151 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.175, mb=0.504, no=0.999, corr=-0.064) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9036 -> 63.5151
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1980 mb_mean=0.5031 norm_overlap=0.9980 corr_cb=-0.2004 topkJ=0.0657
[TRAIN][ep=013] loss=1.3786 acc=68.99%
[TRAIN][ep=013] mask_avg: mc_mean=0.1784 mb_mean=0.5039 norm_overlap=0.9988 corr_cb=-0.1138
[EPOCH 013/089] train: loss=1.3786 acc=68.99% | val: loss=0.7009 acc=59.04% f1=68.52% auc=57.91% val_score=42.8525 val_score_bestthr=62.3690 | dyn(w_pfs=0.100, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.178, mb=0.504, no=0.999, corr=-0.114) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9036 -> 62.3690
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1837 mb_mean=0.5017 norm_overlap=0.9967 corr_cb=-0.2378 topkJ=0.0553
[TRAIN][ep=014] loss=1.1281 acc=68.19%
[TRAIN][ep=014] mask_avg: mc_mean=0.1823 mb_mean=0.5039 norm_overlap=0.9984 corr_cb=-0.1412
[EPOCH 014/089] train: loss=1.1281 acc=68.19% | val: loss=0.6956 acc=59.04% f1=67.31% auc=58.20% val_score=55.5840 val_score_bestthr=61.9467 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.182, mb=0.504, no=0.998, corr=-0.141) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9036 -> 61.9467
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1521 mb_mean=0.5031 norm_overlap=0.9976 corr_cb=-0.1923 topkJ=0.0534
[TRAIN][ep=015] loss=0.8603 acc=69.13%
[TRAIN][ep=015] mask_avg: mc_mean=0.1720 mb_mean=0.5039 norm_overlap=0.9979 corr_cb=-0.1706
[EPOCH 015/089] train: loss=0.8603 acc=69.13% | val: loss=0.7472 acc=57.83% f1=71.07% auc=57.79% val_score=50.9295 val_score_bestthr=65.1044 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.172, mb=0.504, no=0.998, corr=-0.171) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 64.9036 -> 65.1044
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1669 mb_mean=0.5045 norm_overlap=0.9963 corr_cb=-0.3085 topkJ=0.0198
[TRAIN][ep=016] loss=0.9507 acc=71.14%
[TRAIN][ep=016] mask_avg: mc_mean=0.1750 mb_mean=0.5039 norm_overlap=0.9974 corr_cb=-0.2042
[EPOCH 016/089] train: loss=0.9507 acc=71.14% | val: loss=0.6995 acc=57.83% f1=67.89% auc=58.20% val_score=57.3788 val_score_bestthr=61.2699 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.175, mb=0.504, no=0.997, corr=-0.204) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 61.2699
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.2139 mb_mean=0.5056 norm_overlap=0.9971 corr_cb=-0.2462 topkJ=0.0227
[TRAIN][ep=017] loss=1.0485 acc=71.01%
[TRAIN][ep=017] mask_avg: mc_mean=0.1746 mb_mean=0.5039 norm_overlap=0.9968 corr_cb=-0.2362
[EPOCH 017/089] train: loss=1.0485 acc=71.01% | val: loss=0.7026 acc=62.65% f1=69.31% auc=58.08% val_score=57.3788 val_score_bestthr=62.3366 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.175, mb=0.504, no=0.997, corr=-0.236) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 62.3366
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.2000 mb_mean=0.5031 norm_overlap=0.9965 corr_cb=-0.2773 topkJ=0.0387
[TRAIN][ep=018] loss=1.1574 acc=69.66%
[TRAIN][ep=018] mask_avg: mc_mean=0.1801 mb_mean=0.5039 norm_overlap=0.9962 corr_cb=-0.2625
[EPOCH 018/089] train: loss=1.1574 acc=69.66% | val: loss=0.6965 acc=57.83% f1=71.07% auc=59.19% val_score=55.4778 val_score_bestthr=65.1044 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.180, mb=0.504, no=0.996, corr=-0.262) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 65.1044
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1305 mb_mean=0.4993 norm_overlap=0.9949 corr_cb=-0.3081 topkJ=0.0207
[TRAIN][ep=019] loss=1.2392 acc=71.14%
[TRAIN][ep=019] mask_avg: mc_mean=0.1921 mb_mean=0.5039 norm_overlap=0.9959 corr_cb=-0.2894
[EPOCH 019/089] train: loss=1.2392 acc=71.14% | val: loss=0.7158 acc=62.65% f1=69.31% auc=59.01% val_score=34.7326 val_score_bestthr=62.3366 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.192, mb=0.504, no=0.996, corr=-0.289) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 62.3366
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1790 mb_mean=0.5035 norm_overlap=0.9972 corr_cb=-0.1937 topkJ=0.0309
[TRAIN][ep=020] loss=1.3371 acc=71.28%
[TRAIN][ep=020] mask_avg: mc_mean=0.1938 mb_mean=0.5039 norm_overlap=0.9955 corr_cb=-0.3049
[EPOCH 020/089] train: loss=1.3371 acc=71.28% | val: loss=0.7039 acc=62.65% f1=68.69% auc=58.78% val_score=48.7053 val_score_bestthr=60.5893 | dyn(w_pfs=0.100, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.194, mb=0.504, no=0.995, corr=-0.305) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 60.5893
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.1870 mb_mean=0.5031 norm_overlap=0.9942 corr_cb=-0.4064 topkJ=0.0078
[TRAIN][ep=021] loss=1.0767 acc=71.81%
[TRAIN][ep=021] mask_avg: mc_mean=0.1924 mb_mean=0.5039 norm_overlap=0.9951 corr_cb=-0.3095
[EPOCH 021/089] train: loss=1.0767 acc=71.81% | val: loss=0.7091 acc=62.65% f1=69.31% auc=58.55% val_score=44.3074 val_score_bestthr=62.3366 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.192, mb=0.504, no=0.995, corr=-0.310) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 62.3366
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2187 mb_mean=0.5056 norm_overlap=0.9916 corr_cb=-0.4755 topkJ=0.0039
[TRAIN][ep=022] loss=0.8154 acc=71.81%
[TRAIN][ep=022] mask_avg: mc_mean=0.1914 mb_mean=0.5039 norm_overlap=0.9947 corr_cb=-0.3163
[EPOCH 022/089] train: loss=0.8154 acc=71.81% | val: loss=0.7159 acc=63.86% f1=68.75% auc=59.19% val_score=48.8201 val_score_bestthr=59.7060 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.191, mb=0.504, no=0.995, corr=-0.316) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.7060
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1831 mb_mean=0.5049 norm_overlap=0.9942 corr_cb=-0.3590 topkJ=0.0172
[TRAIN][ep=023] loss=0.8109 acc=73.56%
[TRAIN][ep=023] mask_avg: mc_mean=0.2128 mb_mean=0.5039 norm_overlap=0.9946 corr_cb=-0.3396
[EPOCH 023/089] train: loss=0.8109 acc=73.56% | val: loss=0.7448 acc=57.83% f1=70.59% auc=59.42% val_score=56.1476 val_score_bestthr=60.6955 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.213, mb=0.504, no=0.995, corr=-0.340) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 60.6955
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1490 mb_mean=0.5040 norm_overlap=0.9948 corr_cb=-0.2510 topkJ=0.0199
[TRAIN][ep=024] loss=0.7982 acc=73.29%
[TRAIN][ep=024] mask_avg: mc_mean=0.1877 mb_mean=0.5039 norm_overlap=0.9942 corr_cb=-0.3212
[EPOCH 024/089] train: loss=0.7982 acc=73.29% | val: loss=0.7116 acc=56.63% f1=69.49% auc=59.71% val_score=51.5646 val_score_bestthr=59.8573 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.188, mb=0.504, no=0.994, corr=-0.321) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.8573
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1842 mb_mean=0.5015 norm_overlap=0.9954 corr_cb=-0.3008 topkJ=0.0136
[TRAIN][ep=025] loss=0.7876 acc=75.17%
[TRAIN][ep=025] mask_avg: mc_mean=0.2096 mb_mean=0.5039 norm_overlap=0.9940 corr_cb=-0.3447
[EPOCH 025/089] train: loss=0.7876 acc=75.17% | val: loss=0.7213 acc=61.45% f1=68.63% auc=59.48% val_score=53.7023 val_score_bestthr=59.6743 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.210, mb=0.504, no=0.994, corr=-0.345) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.6743
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2188 mb_mean=0.5035 norm_overlap=0.9963 corr_cb=-0.2338 topkJ=0.0288
[TRAIN][ep=026] loss=0.7856 acc=73.56%
[TRAIN][ep=026] mask_avg: mc_mean=0.2042 mb_mean=0.5039 norm_overlap=0.9938 corr_cb=-0.3391
[EPOCH 026/089] train: loss=0.7856 acc=73.56% | val: loss=0.7381 acc=65.06% f1=70.71% auc=60.70% val_score=50.3141 val_score_bestthr=62.3163 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.204, mb=0.504, no=0.994, corr=-0.339) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 62.3163
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2057 mb_mean=0.5061 norm_overlap=0.9909 corr_cb=-0.4562 topkJ=0.0052
[TRAIN][ep=027] loss=0.8105 acc=74.23%
[TRAIN][ep=027] mask_avg: mc_mean=0.1890 mb_mean=0.5039 norm_overlap=0.9938 corr_cb=-0.3266
[EPOCH 027/089] train: loss=0.8105 acc=74.23% | val: loss=0.7076 acc=55.42% f1=69.92% auc=60.29% val_score=54.1742 val_score_bestthr=63.6770 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.189, mb=0.504, no=0.994, corr=-0.327) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 63.6770
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1187 mb_mean=0.5045 norm_overlap=0.9924 corr_cb=-0.3205 topkJ=0.0121
[TRAIN][ep=028] loss=0.7689 acc=75.97%
[TRAIN][ep=028] mask_avg: mc_mean=0.1828 mb_mean=0.5039 norm_overlap=0.9936 corr_cb=-0.3215
[EPOCH 028/089] train: loss=0.7689 acc=75.97% | val: loss=0.7383 acc=61.45% f1=69.81% auc=60.17% val_score=53.9002 val_score_bestthr=61.3072 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.183, mb=0.504, no=0.994, corr=-0.322) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 61.3072
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2252 mb_mean=0.5067 norm_overlap=0.9906 corr_cb=-0.4780 topkJ=0.0024
[TRAIN][ep=029] loss=0.7668 acc=75.97%
[TRAIN][ep=029] mask_avg: mc_mean=0.2059 mb_mean=0.5039 norm_overlap=0.9936 corr_cb=-0.3408
[EPOCH 029/089] train: loss=0.7668 acc=75.97% | val: loss=0.7405 acc=62.65% f1=69.31% auc=60.29% val_score=52.8520 val_score_bestthr=59.6610 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.206, mb=0.504, no=0.994, corr=-0.341) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.6610
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2077 mb_mean=0.5046 norm_overlap=0.9937 corr_cb=-0.3463 topkJ=0.0059
[TRAIN][ep=030] loss=0.7530 acc=75.97%
[TRAIN][ep=030] mask_avg: mc_mean=0.2255 mb_mean=0.5039 norm_overlap=0.9936 corr_cb=-0.3566
[EPOCH 030/089] train: loss=0.7530 acc=75.97% | val: loss=0.7449 acc=63.86% f1=70.59% auc=60.93% val_score=52.8664 val_score_bestthr=59.1015 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.225, mb=0.504, no=0.994, corr=-0.357) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.1015
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2227 mb_mean=0.5031 norm_overlap=0.9961 corr_cb=-0.2467 topkJ=0.0166
[TRAIN][ep=031] loss=0.7514 acc=75.44%
[TRAIN][ep=031] mask_avg: mc_mean=0.2163 mb_mean=0.5039 norm_overlap=0.9935 corr_cb=-0.3477
[EPOCH 031/089] train: loss=0.7514 acc=75.44% | val: loss=0.8009 acc=63.86% f1=69.39% auc=62.03% val_score=50.4830 val_score_bestthr=60.3247 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.216, mb=0.504, no=0.993, corr=-0.348) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 60.3247
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2315 mb_mean=0.5042 norm_overlap=0.9944 corr_cb=-0.3384 topkJ=0.0095
[TRAIN][ep=032] loss=0.7788 acc=74.23%
[TRAIN][ep=032] mask_avg: mc_mean=0.1923 mb_mean=0.5039 norm_overlap=0.9932 corr_cb=-0.3382
[EPOCH 032/089] train: loss=0.7788 acc=74.23% | val: loss=0.7412 acc=62.65% f1=69.31% auc=61.80% val_score=54.0996 val_score_bestthr=59.6610 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.192, mb=0.504, no=0.993, corr=-0.338) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.6610
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2121 mb_mean=0.5032 norm_overlap=0.9901 corr_cb=-0.4032 topkJ=0.0144
[TRAIN][ep=033] loss=0.7445 acc=75.70%
[TRAIN][ep=033] mask_avg: mc_mean=0.2083 mb_mean=0.5039 norm_overlap=0.9934 corr_cb=-0.3414
[EPOCH 033/089] train: loss=0.7445 acc=75.70% | val: loss=0.8285 acc=57.83% f1=69.57% auc=61.40% val_score=50.9998 val_score_bestthr=61.2042 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.208, mb=0.504, no=0.993, corr=-0.341) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 61.2042
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2500 mb_mean=0.5013 norm_overlap=0.9946 corr_cb=-0.3241 topkJ=0.0175
[TRAIN][ep=034] loss=0.7352 acc=77.32%
[TRAIN][ep=034] mask_avg: mc_mean=0.2130 mb_mean=0.5039 norm_overlap=0.9934 corr_cb=-0.3442
[EPOCH 034/089] train: loss=0.7352 acc=77.32% | val: loss=0.7809 acc=56.63% f1=69.49% auc=61.51% val_score=42.5654 val_score_bestthr=58.7373 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.213, mb=0.504, no=0.993, corr=-0.344) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 58.7373
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2064 mb_mean=0.5009 norm_overlap=0.9910 corr_cb=-0.4075 topkJ=0.0064
[TRAIN][ep=035] loss=0.7343 acc=76.64%
[TRAIN][ep=035] mask_avg: mc_mean=0.2183 mb_mean=0.5039 norm_overlap=0.9934 corr_cb=-0.3466
[EPOCH 035/089] train: loss=0.7343 acc=76.64% | val: loss=0.7677 acc=62.65% f1=69.90% auc=61.45% val_score=57.0189 val_score_bestthr=57.9939 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.218, mb=0.504, no=0.993, corr=-0.347) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 57.9939
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2030 mb_mean=0.5038 norm_overlap=0.9977 corr_cb=-0.1383 topkJ=0.0297
[TRAIN][ep=036] loss=0.7491 acc=76.11%
[TRAIN][ep=036] mask_avg: mc_mean=0.1851 mb_mean=0.5039 norm_overlap=0.9932 corr_cb=-0.3145
[EPOCH 036/089] train: loss=0.7491 acc=76.11% | val: loss=0.7512 acc=56.63% f1=70.00% auc=62.67% val_score=57.0189 val_score_bestthr=60.2971 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.185, mb=0.504, no=0.993, corr=-0.314) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 60.2971
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.2755 mb_mean=0.5037 norm_overlap=0.9942 corr_cb=-0.3253 topkJ=0.0107
[TRAIN][ep=037] loss=0.7109 acc=77.45%
[TRAIN][ep=037] mask_avg: mc_mean=0.2333 mb_mean=0.5039 norm_overlap=0.9936 corr_cb=-0.3444
[EPOCH 037/089] train: loss=0.7109 acc=77.45% | val: loss=0.7596 acc=59.04% f1=69.64% auc=63.31% val_score=55.3844 val_score_bestthr=59.5312 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.233, mb=0.504, no=0.994, corr=-0.344) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.5312
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2244 mb_mean=0.5034 norm_overlap=0.9937 corr_cb=-0.3506 topkJ=0.0157
[TRAIN][ep=038] loss=0.7090 acc=78.39%
[TRAIN][ep=038] mask_avg: mc_mean=0.2531 mb_mean=0.5039 norm_overlap=0.9938 corr_cb=-0.3550
[EPOCH 038/089] train: loss=0.7090 acc=78.39% | val: loss=0.8070 acc=59.04% f1=59.52% auc=63.14% val_score=50.4981 val_score_bestthr=58.7331 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.253, mb=0.504, no=0.994, corr=-0.355) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 58.7331
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2625 mb_mean=0.5021 norm_overlap=0.9963 corr_cb=-0.2199 topkJ=0.0159
[TRAIN][ep=039] loss=0.6996 acc=79.87%
[TRAIN][ep=039] mask_avg: mc_mean=0.2325 mb_mean=0.5039 norm_overlap=0.9936 corr_cb=-0.3498
[EPOCH 039/089] train: loss=0.6996 acc=79.87% | val: loss=0.8391 acc=60.24% f1=70.27% auc=62.67% val_score=55.7259 val_score_bestthr=62.7556 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.233, mb=0.504, no=0.994, corr=-0.350) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 62.7556
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.2104 mb_mean=0.5045 norm_overlap=0.9931 corr_cb=-0.4005 topkJ=0.0148
[TRAIN][ep=040] loss=0.6924 acc=80.27%
[TRAIN][ep=040] mask_avg: mc_mean=0.2064 mb_mean=0.5039 norm_overlap=0.9936 corr_cb=-0.3174
[EPOCH 040/089] train: loss=0.6924 acc=80.27% | val: loss=0.7853 acc=60.24% f1=70.27% auc=63.37% val_score=58.2236 val_score_bestthr=59.5101 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.206, mb=0.504, no=0.994, corr=-0.317) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.5101
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.1720 mb_mean=0.5043 norm_overlap=0.9951 corr_cb=-0.2484 topkJ=0.0183
[TRAIN][ep=041] loss=0.6993 acc=80.27%
[TRAIN][ep=041] mask_avg: mc_mean=0.2594 mb_mean=0.5039 norm_overlap=0.9939 corr_cb=-0.3512
[EPOCH 041/089] train: loss=0.6993 acc=80.27% | val: loss=0.8374 acc=61.45% f1=68.00% auc=63.72% val_score=50.1156 val_score_bestthr=57.6713 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.259, mb=0.504, no=0.994, corr=-0.351) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 57.6713
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.2963 mb_mean=0.5033 norm_overlap=0.9951 corr_cb=-0.3036 topkJ=0.0236
[TRAIN][ep=042] loss=0.6986 acc=79.19%
[TRAIN][ep=042] mask_avg: mc_mean=0.2063 mb_mean=0.5039 norm_overlap=0.9937 corr_cb=-0.3185
[EPOCH 042/089] train: loss=0.6986 acc=79.19% | val: loss=0.7900 acc=61.45% f1=69.81% auc=63.84% val_score=57.6745 val_score_bestthr=62.4386 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.206, mb=0.504, no=0.994, corr=-0.318) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 62.4386
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.2100 mb_mean=0.5044 norm_overlap=0.9937 corr_cb=-0.3589 topkJ=0.0171
[TRAIN][ep=043] loss=0.6638 acc=81.21%
[TRAIN][ep=043] mask_avg: mc_mean=0.2286 mb_mean=0.5039 norm_overlap=0.9937 corr_cb=-0.3392
[EPOCH 043/089] train: loss=0.6638 acc=81.21% | val: loss=0.8429 acc=62.65% f1=68.69% auc=64.53% val_score=54.9538 val_score_bestthr=59.2472 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.229, mb=0.504, no=0.994, corr=-0.339) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.2472
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.1953 mb_mean=0.5091 norm_overlap=0.9951 corr_cb=-0.3039 topkJ=0.0180
[TRAIN][ep=044] loss=0.6998 acc=78.93%
[TRAIN][ep=044] mask_avg: mc_mean=0.2286 mb_mean=0.5039 norm_overlap=0.9938 corr_cb=-0.3289
[EPOCH 044/089] train: loss=0.6998 acc=78.93% | val: loss=0.8064 acc=59.04% f1=69.09% auc=63.31% val_score=54.1599 val_score_bestthr=61.6781 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.229, mb=0.504, no=0.994, corr=-0.329) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 61.6781
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2417 mb_mean=0.5010 norm_overlap=0.9932 corr_cb=-0.3566 topkJ=0.0244
[TRAIN][ep=045] loss=0.6590 acc=81.61%
[TRAIN][ep=045] mask_avg: mc_mean=0.2469 mb_mean=0.5039 norm_overlap=0.9938 corr_cb=-0.3407
[EPOCH 045/089] train: loss=0.6590 acc=81.61% | val: loss=0.8385 acc=61.45% f1=58.97% auc=65.41% val_score=57.3360 val_score_bestthr=60.0545 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.247, mb=0.504, no=0.994, corr=-0.341) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 60.0545
[EARLY STOP] no improvement for 30 epochs. best_epoch=15
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
=============== FIT DONE ===============
[BEST] epoch=15 | val_acc=57.83% | val_f1=71.07% | val_auc=57.79% | val_score=50.9295 | val_score_bestthr=65.1044
[TEST@BEST] thr_used=0.635 | acc=65.22% f1=67.57% auc=68.43% | SP_sex=0.56% EO_sex=4.76% SP_age=18.79% EO_age=21.79%
[TIME] 1.12 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/summary_fold_1.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4855 mb_mean=0.5049 norm_overlap=1.0000 corr_cb=0.0473 topkJ=0.1080
[TRAIN][ep=000] loss=0.6948 acc=48.99%
[TRAIN][ep=000] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1097
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4906 mb_mean=0.5028 norm_overlap=1.0002 corr_cb=0.3495 topkJ=0.0900
[TRAIN][ep=001] loss=0.6923 acc=51.95%
[TRAIN][ep=001] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1148
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4863 mb_mean=0.5023 norm_overlap=1.0001 corr_cb=0.0850 topkJ=0.0855
[TRAIN][ep=002] loss=0.6921 acc=53.15%
[TRAIN][ep=002] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1042
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4827 mb_mean=0.5045 norm_overlap=1.0001 corr_cb=0.1327 topkJ=0.1111
[TRAIN][ep=003] loss=0.6889 acc=54.36%
[TRAIN][ep=003] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1168
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4839 mb_mean=0.5059 norm_overlap=1.0001 corr_cb=0.1207 topkJ=0.1266
[TRAIN][ep=004] loss=0.6880 acc=54.50%
[TRAIN][ep=004] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1129
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4874 mb_mean=0.5023 norm_overlap=1.0001 corr_cb=0.2085 topkJ=0.0997
[TRAIN][ep=005] loss=0.6863 acc=55.17%
[TRAIN][ep=005] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1147
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4933 mb_mean=0.5052 norm_overlap=1.0001 corr_cb=0.1915 topkJ=0.0991
[TRAIN][ep=006] loss=0.6834 acc=57.85%
[TRAIN][ep=006] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1051
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4811 mb_mean=0.5022 norm_overlap=1.0001 corr_cb=0.1599 topkJ=0.1247
[TRAIN][ep=007] loss=0.6773 acc=58.39%
[TRAIN][ep=007] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1165
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4923 mb_mean=0.5061 norm_overlap=1.0000 corr_cb=-0.0490 topkJ=0.0591
[TRAIN][ep=008] loss=0.6750 acc=60.54%
[TRAIN][ep=008] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1064
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4885 mb_mean=0.5031 norm_overlap=1.0001 corr_cb=0.1442 topkJ=0.0897
[TRAIN][ep=009] loss=0.6778 acc=56.38%
[TRAIN][ep=009] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1185
================= FIT START (fold=1) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4904 mb_mean=0.5056 norm_overlap=1.0001 corr_cb=0.1620 topkJ=0.1007
[TRAIN][ep=000] loss=0.6654 acc=62.55%
[TRAIN][ep=000] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1145
[EPOCH 000/089] train: loss=0.6654 acc=62.55% | val: loss=0.6955 acc=59.04% f1=66.67% auc=56.34% val_score=40.0230 val_score_bestthr=61.6101 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.115) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 61.6101
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4891 mb_mean=0.5036 norm_overlap=1.0002 corr_cb=0.2700 topkJ=0.1255
[TRAIN][ep=001] loss=0.6582 acc=62.42%
[TRAIN][ep=001] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1127
[EPOCH 001/089] train: loss=0.6582 acc=62.42% | val: loss=0.6829 acc=60.24% f1=67.33% auc=56.34% val_score=59.5215 val_score_bestthr=63.1139 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.113) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 61.6101 -> 63.1139
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4874 mb_mean=0.5035 norm_overlap=1.0000 corr_cb=0.0912 topkJ=0.0898
[TRAIN][ep=002] loss=0.6501 acc=64.03%
[TRAIN][ep=002] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1172
[EPOCH 002/089] train: loss=0.6501 acc=64.03% | val: loss=0.6853 acc=60.24% f1=67.33% auc=56.10% val_score=59.5215 val_score_bestthr=63.1139 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.117) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.1139 -> 63.1139
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4901 mb_mean=0.5043 norm_overlap=1.0001 corr_cb=0.1890 topkJ=0.1067
[TRAIN][ep=003] loss=0.6427 acc=64.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1173
[EPOCH 003/089] train: loss=0.6427 acc=64.70% | val: loss=0.6899 acc=59.04% f1=66.67% auc=56.51% val_score=60.3480 val_score_bestthr=61.6101 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.117) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.1139 -> 61.6101
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4879 mb_mean=0.5014 norm_overlap=1.0004 corr_cb=0.5752 topkJ=0.1843
[TRAIN][ep=004] loss=0.6386 acc=63.49%
[TRAIN][ep=004] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1096
[EPOCH 004/089] train: loss=0.6386 acc=63.49% | val: loss=0.6864 acc=60.24% f1=67.33% auc=55.58% val_score=59.3002 val_score_bestthr=63.1139 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.110) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.1139 -> 63.1139
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4909 mb_mean=0.5055 norm_overlap=1.0002 corr_cb=0.3822 topkJ=0.1455
[TRAIN][ep=005] loss=1.4808 acc=62.95%
[TRAIN][ep=005] mask_avg: mc_mean=0.3783 mb_mean=0.5039 norm_overlap=1.0003 corr_cb=0.1125
[EPOCH 005/089] train: loss=1.4808 acc=62.95% | val: loss=0.6815 acc=61.45% f1=68.63% auc=56.57% val_score=54.4018 val_score_bestthr=63.2603 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.378, mb=0.504, no=1.000, corr=0.112) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 63.1139 -> 63.2603
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2795 mb_mean=0.5027 norm_overlap=1.0025 corr_cb=0.4427 topkJ=0.1506
[TRAIN][ep=006] loss=1.4498 acc=65.23%
[TRAIN][ep=006] mask_avg: mc_mean=0.2640 mb_mean=0.5039 norm_overlap=1.0006 corr_cb=0.1090
[EPOCH 006/089] train: loss=1.4498 acc=65.23% | val: loss=0.6831 acc=60.24% f1=67.96% auc=56.74% val_score=49.9994 val_score_bestthr=61.4940 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.264, mb=0.504, no=1.001, corr=0.109) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2603 -> 61.4940
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2437 mb_mean=0.5043 norm_overlap=1.0011 corr_cb=0.1523 topkJ=0.1144
[TRAIN][ep=007] loss=1.4493 acc=65.91%
[TRAIN][ep=007] mask_avg: mc_mean=0.2289 mb_mean=0.5039 norm_overlap=1.0006 corr_cb=0.0859
[EPOCH 007/089] train: loss=1.4493 acc=65.91% | val: loss=0.6856 acc=60.24% f1=67.96% auc=56.74% val_score=44.7424 val_score_bestthr=61.4940 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.229, mb=0.504, no=1.001, corr=0.086) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2603 -> 61.4940
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2305 mb_mean=0.5056 norm_overlap=1.0002 corr_cb=0.0202 topkJ=0.0937
[TRAIN][ep=008] loss=1.4281 acc=67.65%
[TRAIN][ep=008] mask_avg: mc_mean=0.2023 mb_mean=0.5039 norm_overlap=1.0006 corr_cb=0.0673
[EPOCH 008/089] train: loss=1.4281 acc=67.65% | val: loss=0.6849 acc=60.24% f1=67.96% auc=56.51% val_score=57.9877 val_score_bestthr=61.4940 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.202, mb=0.504, no=1.001, corr=0.067) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2603 -> 61.4940
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1895 mb_mean=0.5044 norm_overlap=1.0004 corr_cb=0.0481 topkJ=0.0734
[TRAIN][ep=009] loss=1.4206 acc=67.11%
[TRAIN][ep=009] mask_avg: mc_mean=0.1955 mb_mean=0.5039 norm_overlap=1.0003 corr_cb=0.0420
[EPOCH 009/089] train: loss=1.4206 acc=67.11% | val: loss=0.6877 acc=60.24% f1=67.96% auc=57.27% val_score=58.4619 val_score_bestthr=61.4940 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.195, mb=0.504, no=1.000, corr=0.042) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2603 -> 61.4940
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1945 mb_mean=0.5054 norm_overlap=1.0001 corr_cb=0.0135 topkJ=0.0503
[TRAIN][ep=010] loss=1.4279 acc=65.64%
[TRAIN][ep=010] mask_avg: mc_mean=0.1851 mb_mean=0.5039 norm_overlap=1.0002 corr_cb=0.0173
[EPOCH 010/089] train: loss=1.4279 acc=65.64% | val: loss=0.6853 acc=60.24% f1=65.98% auc=57.67% val_score=57.3443 val_score_bestthr=59.3547 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.185, mb=0.504, no=1.000, corr=0.017) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2603 -> 59.3547
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.2037 mb_mean=0.5045 norm_overlap=1.0005 corr_cb=0.0521 topkJ=0.0722
[TRAIN][ep=011] loss=1.1877 acc=67.79%
[TRAIN][ep=011] mask_avg: mc_mean=0.1908 mb_mean=0.5039 norm_overlap=0.9998 corr_cb=-0.0235
[EPOCH 011/089] train: loss=1.1877 acc=67.79% | val: loss=0.7033 acc=56.63% f1=70.49% auc=57.56% val_score=41.4213 val_score_bestthr=64.1779 | dyn(w_pfs=0.290, w_sup=0.190, w_csuf=0.140, stage2=False) | mask(mc=0.191, mb=0.504, no=1.000, corr=-0.023) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 63.2603 -> 64.1779
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1841 mb_mean=0.5042 norm_overlap=1.0005 corr_cb=0.0498 topkJ=0.0845
[TRAIN][ep=012] loss=1.2704 acc=67.11%
[TRAIN][ep=012] mask_avg: mc_mean=0.1780 mb_mean=0.5039 norm_overlap=0.9995 corr_cb=-0.0525
[EPOCH 012/089] train: loss=1.2704 acc=67.11% | val: loss=0.7079 acc=61.45% f1=68.63% auc=57.62% val_score=38.8095 val_score_bestthr=63.5151 | dyn(w_pfs=0.330, w_sup=0.230, w_csuf=0.180, stage2=False) | mask(mc=0.178, mb=0.504, no=0.999, corr=-0.052) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1779 -> 63.5151
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.2009 mb_mean=0.5031 norm_overlap=0.9982 corr_cb=-0.1852 topkJ=0.0699
[TRAIN][ep=013] loss=1.3494 acc=69.26%
[TRAIN][ep=013] mask_avg: mc_mean=0.1808 mb_mean=0.5039 norm_overlap=0.9989 corr_cb=-0.1012
[EPOCH 013/089] train: loss=1.3494 acc=69.26% | val: loss=0.7028 acc=57.83% f1=67.89% auc=57.85% val_score=42.8525 val_score_bestthr=61.2699 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.181, mb=0.504, no=0.999, corr=-0.101) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1779 -> 61.2699
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1862 mb_mean=0.5017 norm_overlap=0.9969 corr_cb=-0.2312 topkJ=0.0566
[TRAIN][ep=014] loss=1.4003 acc=68.19%
[TRAIN][ep=014] mask_avg: mc_mean=0.1817 mb_mean=0.5039 norm_overlap=0.9986 corr_cb=-0.1252
[EPOCH 014/089] train: loss=1.4003 acc=68.19% | val: loss=0.6957 acc=59.04% f1=67.31% auc=58.14% val_score=55.5840 val_score_bestthr=61.9467 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.182, mb=0.504, no=0.999, corr=-0.125) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1779 -> 61.9467
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1505 mb_mean=0.5031 norm_overlap=0.9979 corr_cb=-0.1758 topkJ=0.0543
[TRAIN][ep=015] loss=1.3832 acc=70.47%
[TRAIN][ep=015] mask_avg: mc_mean=0.1685 mb_mean=0.5039 norm_overlap=0.9981 corr_cb=-0.1530
[EPOCH 015/089] train: loss=1.3832 acc=70.47% | val: loss=0.7506 acc=57.83% f1=71.07% auc=57.33% val_score=49.8362 val_score_bestthr=65.1044 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.168, mb=0.504, no=0.998, corr=-0.153) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 64.1779 -> 65.1044
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1599 mb_mean=0.5045 norm_overlap=0.9965 corr_cb=-0.2891 topkJ=0.0230
[TRAIN][ep=016] loss=1.3698 acc=71.68%
[TRAIN][ep=016] mask_avg: mc_mean=0.1712 mb_mean=0.5039 norm_overlap=0.9976 corr_cb=-0.1863
[EPOCH 016/089] train: loss=1.3698 acc=71.68% | val: loss=0.6960 acc=61.45% f1=68.00% auc=58.66% val_score=56.8202 val_score_bestthr=60.2281 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.171, mb=0.504, no=0.998, corr=-0.186) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 60.2281
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.2123 mb_mean=0.5056 norm_overlap=0.9973 corr_cb=-0.2315 topkJ=0.0248
[TRAIN][ep=017] loss=1.3657 acc=71.41%
[TRAIN][ep=017] mask_avg: mc_mean=0.1730 mb_mean=0.5039 norm_overlap=0.9970 corr_cb=-0.2211
[EPOCH 017/089] train: loss=1.3657 acc=71.41% | val: loss=0.6998 acc=62.65% f1=69.31% auc=58.26% val_score=57.3788 val_score_bestthr=62.3366 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.173, mb=0.504, no=0.997, corr=-0.221) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 62.3366
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1979 mb_mean=0.5031 norm_overlap=0.9967 corr_cb=-0.2608 topkJ=0.0404
[TRAIN][ep=018] loss=1.3736 acc=69.40%
[TRAIN][ep=018] mask_avg: mc_mean=0.1803 mb_mean=0.5039 norm_overlap=0.9965 corr_cb=-0.2504
[EPOCH 018/089] train: loss=1.3736 acc=69.40% | val: loss=0.6956 acc=57.83% f1=71.07% auc=59.36% val_score=55.4888 val_score_bestthr=65.1044 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.180, mb=0.504, no=0.996, corr=-0.250) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 65.1044
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1305 mb_mean=0.4993 norm_overlap=0.9952 corr_cb=-0.2937 topkJ=0.0215
[TRAIN][ep=019] loss=1.3537 acc=71.68%
[TRAIN][ep=019] mask_avg: mc_mean=0.1926 mb_mean=0.5039 norm_overlap=0.9961 corr_cb=-0.2780
[EPOCH 019/089] train: loss=1.3537 acc=71.68% | val: loss=0.7159 acc=62.65% f1=69.31% auc=59.19% val_score=34.7326 val_score_bestthr=62.3366 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.193, mb=0.504, no=0.996, corr=-0.278) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 62.3366
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1826 mb_mean=0.5035 norm_overlap=0.9974 corr_cb=-0.1833 topkJ=0.0330
[TRAIN][ep=020] loss=1.3500 acc=72.35%
[TRAIN][ep=020] mask_avg: mc_mean=0.1978 mb_mean=0.5039 norm_overlap=0.9957 corr_cb=-0.2985
[EPOCH 020/089] train: loss=1.3500 acc=72.35% | val: loss=0.7050 acc=62.65% f1=68.69% auc=59.01% val_score=48.7053 val_score_bestthr=60.5893 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.198, mb=0.504, no=0.996, corr=-0.299) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 60.5893
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.1885 mb_mean=0.5031 norm_overlap=0.9945 corr_cb=-0.3995 topkJ=0.0089
[TRAIN][ep=021] loss=1.1141 acc=72.08%
[TRAIN][ep=021] mask_avg: mc_mean=0.1951 mb_mean=0.5039 norm_overlap=0.9954 corr_cb=-0.3028
[EPOCH 021/089] train: loss=1.1141 acc=72.08% | val: loss=0.7100 acc=62.65% f1=69.31% auc=58.90% val_score=44.3074 val_score_bestthr=62.3366 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.195, mb=0.504, no=0.995, corr=-0.303) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 62.3366
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2188 mb_mean=0.5056 norm_overlap=0.9920 corr_cb=-0.4712 topkJ=0.0039
[TRAIN][ep=022] loss=0.8754 acc=72.35%
[TRAIN][ep=022] mask_avg: mc_mean=0.1935 mb_mean=0.5039 norm_overlap=0.9950 corr_cb=-0.3090
[EPOCH 022/089] train: loss=0.8754 acc=72.35% | val: loss=0.7166 acc=62.65% f1=69.31% auc=59.42% val_score=46.2761 val_score_bestthr=62.3366 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.194, mb=0.504, no=0.995, corr=-0.309) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 62.3366
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1843 mb_mean=0.5049 norm_overlap=0.9946 corr_cb=-0.3475 topkJ=0.0176
[TRAIN][ep=023] loss=0.8201 acc=74.23%
[TRAIN][ep=023] mask_avg: mc_mean=0.2142 mb_mean=0.5039 norm_overlap=0.9948 corr_cb=-0.3325
[EPOCH 023/089] train: loss=0.8201 acc=74.23% | val: loss=0.7420 acc=57.83% f1=70.59% auc=59.65% val_score=51.6757 val_score_bestthr=60.6955 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.214, mb=0.504, no=0.995, corr=-0.333) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 60.6955
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1521 mb_mean=0.5040 norm_overlap=0.9950 corr_cb=-0.2468 topkJ=0.0203
[TRAIN][ep=024] loss=0.7939 acc=73.42%
[TRAIN][ep=024] mask_avg: mc_mean=0.1896 mb_mean=0.5039 norm_overlap=0.9945 corr_cb=-0.3146
[EPOCH 024/089] train: loss=0.7939 acc=73.42% | val: loss=0.7129 acc=56.63% f1=69.49% auc=60.00% val_score=51.5646 val_score_bestthr=59.8573 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.504, no=0.994, corr=-0.315) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.8573
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1862 mb_mean=0.5015 norm_overlap=0.9955 corr_cb=-0.3000 topkJ=0.0140
[TRAIN][ep=025] loss=0.7836 acc=75.44%
[TRAIN][ep=025] mask_avg: mc_mean=0.2109 mb_mean=0.5039 norm_overlap=0.9943 corr_cb=-0.3387
[EPOCH 025/089] train: loss=0.7836 acc=75.44% | val: loss=0.7211 acc=61.45% f1=68.63% auc=59.48% val_score=53.7023 val_score_bestthr=59.6743 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.211, mb=0.504, no=0.994, corr=-0.339) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.6743
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2157 mb_mean=0.5035 norm_overlap=0.9966 corr_cb=-0.2144 topkJ=0.0333
[TRAIN][ep=026] loss=0.7817 acc=73.83%
[TRAIN][ep=026] mask_avg: mc_mean=0.2041 mb_mean=0.5039 norm_overlap=0.9941 corr_cb=-0.3319
[EPOCH 026/089] train: loss=0.7817 acc=73.83% | val: loss=0.7381 acc=65.06% f1=70.71% auc=61.05% val_score=51.6655 val_score_bestthr=62.3163 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.204, mb=0.504, no=0.994, corr=-0.332) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 62.3163
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2060 mb_mean=0.5061 norm_overlap=0.9913 corr_cb=-0.4523 topkJ=0.0052
[TRAIN][ep=027] loss=0.8076 acc=74.90%
[TRAIN][ep=027] mask_avg: mc_mean=0.1896 mb_mean=0.5039 norm_overlap=0.9941 corr_cb=-0.3198
[EPOCH 027/089] train: loss=0.8076 acc=74.90% | val: loss=0.7082 acc=55.42% f1=69.92% auc=60.41% val_score=53.7424 val_score_bestthr=63.6770 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.504, no=0.994, corr=-0.320) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 63.6770
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1163 mb_mean=0.5045 norm_overlap=0.9929 corr_cb=-0.3094 topkJ=0.0134
[TRAIN][ep=028] loss=0.7652 acc=76.38%
[TRAIN][ep=028] mask_avg: mc_mean=0.1830 mb_mean=0.5039 norm_overlap=0.9939 corr_cb=-0.3150
[EPOCH 028/089] train: loss=0.7652 acc=76.38% | val: loss=0.7382 acc=61.45% f1=69.81% auc=60.35% val_score=54.4903 val_score_bestthr=61.3072 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.183, mb=0.504, no=0.994, corr=-0.315) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 61.3072
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2264 mb_mean=0.5067 norm_overlap=0.9909 corr_cb=-0.4774 topkJ=0.0028
[TRAIN][ep=029] loss=0.7632 acc=76.51%
[TRAIN][ep=029] mask_avg: mc_mean=0.2051 mb_mean=0.5039 norm_overlap=0.9938 corr_cb=-0.3348
[EPOCH 029/089] train: loss=0.7632 acc=76.51% | val: loss=0.7430 acc=62.65% f1=69.31% auc=60.29% val_score=52.8520 val_score_bestthr=59.6610 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.205, mb=0.504, no=0.994, corr=-0.335) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.6610
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2126 mb_mean=0.5046 norm_overlap=0.9940 corr_cb=-0.3451 topkJ=0.0074
[TRAIN][ep=030] loss=0.7497 acc=75.97%
[TRAIN][ep=030] mask_avg: mc_mean=0.2275 mb_mean=0.5039 norm_overlap=0.9938 corr_cb=-0.3520
[EPOCH 030/089] train: loss=0.7497 acc=75.97% | val: loss=0.7465 acc=63.86% f1=70.59% auc=61.16% val_score=53.0215 val_score_bestthr=59.1015 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.227, mb=0.504, no=0.994, corr=-0.352) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.1015
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2221 mb_mean=0.5031 norm_overlap=0.9962 corr_cb=-0.2447 topkJ=0.0178
[TRAIN][ep=031] loss=0.7494 acc=75.30%
[TRAIN][ep=031] mask_avg: mc_mean=0.2161 mb_mean=0.5039 norm_overlap=0.9937 corr_cb=-0.3413
[EPOCH 031/089] train: loss=0.7494 acc=75.30% | val: loss=0.7996 acc=63.86% f1=69.39% auc=62.21% val_score=51.2079 val_score_bestthr=60.3247 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.216, mb=0.504, no=0.994, corr=-0.341) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 60.3247
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2300 mb_mean=0.5042 norm_overlap=0.9946 corr_cb=-0.3287 topkJ=0.0104
[TRAIN][ep=032] loss=0.7750 acc=73.56%
[TRAIN][ep=032] mask_avg: mc_mean=0.1951 mb_mean=0.5039 norm_overlap=0.9935 corr_cb=-0.3344
[EPOCH 032/089] train: loss=0.7750 acc=73.56% | val: loss=0.7422 acc=62.65% f1=69.31% auc=61.86% val_score=57.0189 val_score_bestthr=59.6610 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.195, mb=0.504, no=0.993, corr=-0.334) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.6610
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2141 mb_mean=0.5032 norm_overlap=0.9905 corr_cb=-0.3986 topkJ=0.0148
[TRAIN][ep=033] loss=0.7406 acc=75.84%
[TRAIN][ep=033] mask_avg: mc_mean=0.2100 mb_mean=0.5039 norm_overlap=0.9937 corr_cb=-0.3370
[EPOCH 033/089] train: loss=0.7406 acc=75.84% | val: loss=0.8285 acc=56.63% f1=68.97% auc=61.45% val_score=50.4830 val_score_bestthr=58.9895 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.210, mb=0.504, no=0.994, corr=-0.337) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 58.9895
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2452 mb_mean=0.5013 norm_overlap=0.9947 corr_cb=-0.3239 topkJ=0.0175
[TRAIN][ep=034] loss=0.7321 acc=77.58%
[TRAIN][ep=034] mask_avg: mc_mean=0.2143 mb_mean=0.5039 norm_overlap=0.9936 corr_cb=-0.3392
[EPOCH 034/089] train: loss=0.7321 acc=77.58% | val: loss=0.7865 acc=55.42% f1=68.38% auc=61.28% val_score=42.7877 val_score_bestthr=57.8962 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.214, mb=0.504, no=0.994, corr=-0.339) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 57.8962
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2081 mb_mean=0.5009 norm_overlap=0.9914 corr_cb=-0.4002 topkJ=0.0064
[TRAIN][ep=035] loss=0.7321 acc=77.18%
[TRAIN][ep=035] mask_avg: mc_mean=0.2183 mb_mean=0.5039 norm_overlap=0.9937 corr_cb=-0.3409
[EPOCH 035/089] train: loss=0.7321 acc=77.18% | val: loss=0.7707 acc=62.65% f1=69.90% auc=61.51% val_score=57.0189 val_score_bestthr=57.9939 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.218, mb=0.504, no=0.994, corr=-0.341) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 57.9939
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2068 mb_mean=0.5038 norm_overlap=0.9978 corr_cb=-0.1341 topkJ=0.0318
[TRAIN][ep=036] loss=0.7476 acc=76.24%
[TRAIN][ep=036] mask_avg: mc_mean=0.1877 mb_mean=0.5039 norm_overlap=0.9935 corr_cb=-0.3115
[EPOCH 036/089] train: loss=0.7476 acc=76.24% | val: loss=0.7526 acc=59.04% f1=69.64% auc=62.50% val_score=57.0189 val_score_bestthr=58.9090 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.188, mb=0.504, no=0.993, corr=-0.311) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 58.9090
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.2717 mb_mean=0.5037 norm_overlap=0.9944 corr_cb=-0.3226 topkJ=0.0111
[TRAIN][ep=037] loss=0.7092 acc=77.58%
[TRAIN][ep=037] mask_avg: mc_mean=0.2301 mb_mean=0.5039 norm_overlap=0.9938 corr_cb=-0.3376
[EPOCH 037/089] train: loss=0.7092 acc=77.58% | val: loss=0.7596 acc=56.63% f1=70.00% auc=63.14% val_score=52.8871 val_score_bestthr=60.2971 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.230, mb=0.504, no=0.994, corr=-0.338) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 60.2971
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2219 mb_mean=0.5034 norm_overlap=0.9941 corr_cb=-0.3375 topkJ=0.0170
[TRAIN][ep=038] loss=0.7065 acc=78.39%
[TRAIN][ep=038] mask_avg: mc_mean=0.2539 mb_mean=0.5039 norm_overlap=0.9940 corr_cb=-0.3501
[EPOCH 038/089] train: loss=0.7065 acc=78.39% | val: loss=0.8125 acc=60.24% f1=67.33% auc=63.08% val_score=45.4467 val_score_bestthr=56.5655 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.254, mb=0.504, no=0.994, corr=-0.350) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 56.5655
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2611 mb_mean=0.5021 norm_overlap=0.9963 corr_cb=-0.2211 topkJ=0.0163
[TRAIN][ep=039] loss=0.6976 acc=80.00%
[TRAIN][ep=039] mask_avg: mc_mean=0.2314 mb_mean=0.5039 norm_overlap=0.9938 corr_cb=-0.3424
[EPOCH 039/089] train: loss=0.6976 acc=80.00% | val: loss=0.8419 acc=60.24% f1=70.27% auc=62.85% val_score=54.2212 val_score_bestthr=62.7556 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.231, mb=0.504, no=0.994, corr=-0.342) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 62.7556
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.2100 mb_mean=0.5045 norm_overlap=0.9933 corr_cb=-0.3944 topkJ=0.0152
[TRAIN][ep=040] loss=0.6908 acc=80.13%
[TRAIN][ep=040] mask_avg: mc_mean=0.2061 mb_mean=0.5039 norm_overlap=0.9939 corr_cb=-0.3105
[EPOCH 040/089] train: loss=0.6908 acc=80.13% | val: loss=0.7868 acc=61.45% f1=70.91% auc=63.66% val_score=58.2236 val_score_bestthr=60.6108 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.206, mb=0.504, no=0.994, corr=-0.311) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 60.6108
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.1678 mb_mean=0.5043 norm_overlap=0.9954 corr_cb=-0.2374 topkJ=0.0203
[TRAIN][ep=041] loss=0.6978 acc=79.87%
[TRAIN][ep=041] mask_avg: mc_mean=0.2626 mb_mean=0.5039 norm_overlap=0.9941 corr_cb=-0.3456
[EPOCH 041/089] train: loss=0.6978 acc=79.87% | val: loss=0.8412 acc=59.04% f1=59.52% auc=63.66% val_score=52.4546 val_score_bestthr=58.7331 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.263, mb=0.504, no=0.994, corr=-0.346) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 58.7331
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.2931 mb_mean=0.5033 norm_overlap=0.9953 corr_cb=-0.2929 topkJ=0.0240
[TRAIN][ep=042] loss=0.6969 acc=79.06%
[TRAIN][ep=042] mask_avg: mc_mean=0.2074 mb_mean=0.5039 norm_overlap=0.9939 corr_cb=-0.3126
[EPOCH 042/089] train: loss=0.6969 acc=79.06% | val: loss=0.7926 acc=61.45% f1=68.00% auc=63.60% val_score=57.6745 val_score_bestthr=57.6713 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.207, mb=0.504, no=0.994, corr=-0.313) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 57.6713
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.2119 mb_mean=0.5044 norm_overlap=0.9939 corr_cb=-0.3532 topkJ=0.0179
[TRAIN][ep=043] loss=0.6627 acc=81.21%
[TRAIN][ep=043] mask_avg: mc_mean=0.2282 mb_mean=0.5039 norm_overlap=0.9939 corr_cb=-0.3321
[EPOCH 043/089] train: loss=0.6627 acc=81.21% | val: loss=0.8495 acc=61.45% f1=68.00% auc=63.78% val_score=56.3238 val_score_bestthr=58.9482 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.228, mb=0.504, no=0.994, corr=-0.332) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 58.9482
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.1947 mb_mean=0.5091 norm_overlap=0.9953 corr_cb=-0.2961 topkJ=0.0189
[TRAIN][ep=044] loss=0.7000 acc=79.06%
[TRAIN][ep=044] mask_avg: mc_mean=0.2377 mb_mean=0.5039 norm_overlap=0.9941 corr_cb=-0.3277
[EPOCH 044/089] train: loss=0.7000 acc=79.06% | val: loss=0.8092 acc=59.04% f1=69.09% auc=63.14% val_score=54.1599 val_score_bestthr=61.6781 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.238, mb=0.504, no=0.994, corr=-0.328) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 61.6781
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2365 mb_mean=0.5010 norm_overlap=0.9935 corr_cb=-0.3445 topkJ=0.0256
[TRAIN][ep=045] loss=0.6581 acc=82.15%
[TRAIN][ep=045] mask_avg: mc_mean=0.2456 mb_mean=0.5039 norm_overlap=0.9940 corr_cb=-0.3335
[EPOCH 045/089] train: loss=0.6581 acc=82.15% | val: loss=0.8379 acc=61.45% f1=58.97% auc=65.58% val_score=57.3360 val_score_bestthr=60.0545 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.246, mb=0.504, no=0.994, corr=-0.333) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 60.0545
[EARLY STOP] no improvement for 30 epochs. best_epoch=15
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
=============== FIT DONE ===============
[BEST] epoch=15 | val_acc=57.83% | val_f1=71.07% | val_auc=57.33% | val_score=49.8362 | val_score_bestthr=65.1044
[TEST@BEST] thr_used=0.635 | acc=65.22% f1=67.86% auc=68.47% | SP_sex=1.67% EO_sex=5.86% SP_age=17.04% EO_age=21.79%
[TIME] 1.21 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/summary_fold_1.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4855 mb_mean=0.5049 norm_overlap=1.0000 corr_cb=0.0473 topkJ=0.1080
[TRAIN][ep=000] loss=0.6948 acc=48.99%
[TRAIN][ep=000] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1097
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4906 mb_mean=0.5028 norm_overlap=1.0002 corr_cb=0.3495 topkJ=0.0900
[TRAIN][ep=001] loss=0.6923 acc=51.95%
[TRAIN][ep=001] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1148
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4863 mb_mean=0.5023 norm_overlap=1.0001 corr_cb=0.0850 topkJ=0.0855
[TRAIN][ep=002] loss=0.6921 acc=53.15%
[TRAIN][ep=002] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1042
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4827 mb_mean=0.5045 norm_overlap=1.0001 corr_cb=0.1327 topkJ=0.1111
[TRAIN][ep=003] loss=0.6889 acc=54.36%
[TRAIN][ep=003] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1168
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4839 mb_mean=0.5059 norm_overlap=1.0001 corr_cb=0.1207 topkJ=0.1266
[TRAIN][ep=004] loss=0.6880 acc=54.50%
[TRAIN][ep=004] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1129
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4874 mb_mean=0.5023 norm_overlap=1.0001 corr_cb=0.2085 topkJ=0.0997
[TRAIN][ep=005] loss=0.6863 acc=55.17%
[TRAIN][ep=005] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1147
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4933 mb_mean=0.5052 norm_overlap=1.0001 corr_cb=0.1915 topkJ=0.0991
[TRAIN][ep=006] loss=0.6834 acc=57.85%
[TRAIN][ep=006] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1051
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4811 mb_mean=0.5022 norm_overlap=1.0001 corr_cb=0.1599 topkJ=0.1247
[TRAIN][ep=007] loss=0.6773 acc=58.39%
[TRAIN][ep=007] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1165
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4923 mb_mean=0.5061 norm_overlap=1.0000 corr_cb=-0.0490 topkJ=0.0591
[TRAIN][ep=008] loss=0.6750 acc=60.54%
[TRAIN][ep=008] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1064
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4885 mb_mean=0.5031 norm_overlap=1.0001 corr_cb=0.1442 topkJ=0.0897
[TRAIN][ep=009] loss=0.6778 acc=56.38%
[TRAIN][ep=009] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1185
================= FIT START (fold=1) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4904 mb_mean=0.5056 norm_overlap=1.0001 corr_cb=0.1620 topkJ=0.1007
[TRAIN][ep=000] loss=0.6654 acc=62.55%
[TRAIN][ep=000] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1145
[EPOCH 000/089] train: loss=0.6654 acc=62.55% | val: loss=0.6955 acc=59.04% f1=66.67% auc=56.34% val_score=40.0230 val_score_bestthr=61.6101 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.115) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 61.6101
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4891 mb_mean=0.5036 norm_overlap=1.0002 corr_cb=0.2700 topkJ=0.1255
[TRAIN][ep=001] loss=0.6582 acc=62.55%
[TRAIN][ep=001] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1127
[EPOCH 001/089] train: loss=0.6582 acc=62.55% | val: loss=0.6829 acc=60.24% f1=67.33% auc=56.34% val_score=59.5215 val_score_bestthr=63.1139 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.113) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 61.6101 -> 63.1139
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4874 mb_mean=0.5035 norm_overlap=1.0000 corr_cb=0.0912 topkJ=0.0898
[TRAIN][ep=002] loss=0.6501 acc=64.03%
[TRAIN][ep=002] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1172
[EPOCH 002/089] train: loss=0.6501 acc=64.03% | val: loss=0.6854 acc=60.24% f1=67.33% auc=56.10% val_score=59.5215 val_score_bestthr=63.1139 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.117) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.1139 -> 63.1139
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4901 mb_mean=0.5043 norm_overlap=1.0001 corr_cb=0.1890 topkJ=0.1067
[TRAIN][ep=003] loss=0.6427 acc=64.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1173
[EPOCH 003/089] train: loss=0.6427 acc=64.70% | val: loss=0.6899 acc=59.04% f1=66.67% auc=56.57% val_score=60.3480 val_score_bestthr=61.6101 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.117) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.1139 -> 61.6101
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4879 mb_mean=0.5014 norm_overlap=1.0004 corr_cb=0.5752 topkJ=0.1843
[TRAIN][ep=004] loss=0.6386 acc=63.49%
[TRAIN][ep=004] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1096
[EPOCH 004/089] train: loss=0.6386 acc=63.49% | val: loss=0.6863 acc=60.24% f1=67.33% auc=55.70% val_score=59.3002 val_score_bestthr=63.1139 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.110) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.1139 -> 63.1139
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4909 mb_mean=0.5055 norm_overlap=1.0002 corr_cb=0.3822 topkJ=0.1455
[TRAIN][ep=005] loss=1.2365 acc=63.62%
[TRAIN][ep=005] mask_avg: mc_mean=0.3769 mb_mean=0.5039 norm_overlap=1.0003 corr_cb=0.1134
[EPOCH 005/089] train: loss=1.2365 acc=63.62% | val: loss=0.6821 acc=61.45% f1=68.63% auc=56.69% val_score=54.4018 val_score_bestthr=63.2603 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.377, mb=0.504, no=1.000, corr=0.113) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 63.1139 -> 63.2603
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2785 mb_mean=0.5027 norm_overlap=1.0025 corr_cb=0.4435 topkJ=0.1495
[TRAIN][ep=006] loss=1.2164 acc=65.91%
[TRAIN][ep=006] mask_avg: mc_mean=0.2638 mb_mean=0.5039 norm_overlap=1.0006 corr_cb=0.1100
[EPOCH 006/089] train: loss=1.2164 acc=65.91% | val: loss=0.6835 acc=59.04% f1=69.64% auc=56.51% val_score=49.8272 val_score_bestthr=60.2011 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.264, mb=0.504, no=1.001, corr=0.110) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2603 -> 60.2011
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2442 mb_mean=0.5043 norm_overlap=1.0011 corr_cb=0.1532 topkJ=0.1169
[TRAIN][ep=007] loss=1.2161 acc=65.77%
[TRAIN][ep=007] mask_avg: mc_mean=0.2294 mb_mean=0.5039 norm_overlap=1.0006 corr_cb=0.0868
[EPOCH 007/089] train: loss=1.2161 acc=65.77% | val: loss=0.6863 acc=60.24% f1=67.96% auc=56.69% val_score=44.7424 val_score_bestthr=61.4940 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.229, mb=0.504, no=1.001, corr=0.087) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2603 -> 61.4940
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2311 mb_mean=0.5056 norm_overlap=1.0002 corr_cb=0.0230 topkJ=0.0937
[TRAIN][ep=008] loss=1.1954 acc=67.92%
[TRAIN][ep=008] mask_avg: mc_mean=0.2031 mb_mean=0.5039 norm_overlap=1.0006 corr_cb=0.0682
[EPOCH 008/089] train: loss=1.1954 acc=67.92% | val: loss=0.6853 acc=60.24% f1=67.96% auc=56.45% val_score=57.5264 val_score_bestthr=61.4940 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.203, mb=0.504, no=1.001, corr=0.068) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2603 -> 61.4940
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1901 mb_mean=0.5044 norm_overlap=1.0004 corr_cb=0.0492 topkJ=0.0739
[TRAIN][ep=009] loss=1.1877 acc=67.52%
[TRAIN][ep=009] mask_avg: mc_mean=0.1960 mb_mean=0.5039 norm_overlap=1.0004 corr_cb=0.0431
[EPOCH 009/089] train: loss=1.1877 acc=67.52% | val: loss=0.6881 acc=60.24% f1=67.96% auc=57.21% val_score=58.4619 val_score_bestthr=61.4940 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.196, mb=0.504, no=1.000, corr=0.043) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2603 -> 61.4940
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1950 mb_mean=0.5054 norm_overlap=1.0001 corr_cb=0.0162 topkJ=0.0507
[TRAIN][ep=010] loss=1.1948 acc=65.91%
[TRAIN][ep=010] mask_avg: mc_mean=0.1857 mb_mean=0.5039 norm_overlap=1.0002 corr_cb=0.0191
[EPOCH 010/089] train: loss=1.1948 acc=65.91% | val: loss=0.6854 acc=60.24% f1=65.98% auc=58.02% val_score=57.3443 val_score_bestthr=59.3547 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.186, mb=0.504, no=1.000, corr=0.019) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2603 -> 59.3547
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.2047 mb_mean=0.5045 norm_overlap=1.0005 corr_cb=0.0554 topkJ=0.0736
[TRAIN][ep=011] loss=0.9903 acc=67.52%
[TRAIN][ep=011] mask_avg: mc_mean=0.1911 mb_mean=0.5039 norm_overlap=0.9998 corr_cb=-0.0211
[EPOCH 011/089] train: loss=0.9903 acc=67.52% | val: loss=0.7035 acc=59.04% f1=67.31% auc=57.79% val_score=41.4213 val_score_bestthr=60.0348 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.191, mb=0.504, no=1.000, corr=-0.021) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2603 -> 60.0348
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1849 mb_mean=0.5042 norm_overlap=1.0005 corr_cb=0.0507 topkJ=0.0868
[TRAIN][ep=012] loss=0.7860 acc=67.52%
[TRAIN][ep=012] mask_avg: mc_mean=0.1800 mb_mean=0.5039 norm_overlap=0.9995 corr_cb=-0.0511
[EPOCH 012/089] train: loss=0.7860 acc=67.52% | val: loss=0.7093 acc=61.45% f1=68.63% auc=58.02% val_score=39.4189 val_score_bestthr=63.5151 | dyn(w_pfs=0.190, w_sup=0.090, w_csuf=0.040, stage2=False) | mask(mc=0.180, mb=0.504, no=0.999, corr=-0.051) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 63.2603 -> 63.5151
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.2058 mb_mean=0.5031 norm_overlap=0.9983 corr_cb=-0.1832 topkJ=0.0699
[TRAIN][ep=013] loss=0.8505 acc=68.86%
[TRAIN][ep=013] mask_avg: mc_mean=0.1848 mb_mean=0.5039 norm_overlap=0.9989 corr_cb=-0.1011
[EPOCH 013/089] train: loss=0.8505 acc=68.86% | val: loss=0.7045 acc=59.04% f1=68.52% auc=57.67% val_score=45.3654 val_score_bestthr=62.3690 | dyn(w_pfs=0.230, w_sup=0.130, w_csuf=0.080, stage2=False) | mask(mc=0.185, mb=0.504, no=0.999, corr=-0.101) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.5151 -> 62.3690
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1896 mb_mean=0.5017 norm_overlap=0.9969 corr_cb=-0.2338 topkJ=0.0558
[TRAIN][ep=014] loss=0.9340 acc=67.92%
[TRAIN][ep=014] mask_avg: mc_mean=0.1848 mb_mean=0.5039 norm_overlap=0.9986 corr_cb=-0.1261
[EPOCH 014/089] train: loss=0.9340 acc=67.92% | val: loss=0.6981 acc=59.04% f1=67.31% auc=58.31% val_score=55.5840 val_score_bestthr=61.9467 | dyn(w_pfs=0.270, w_sup=0.170, w_csuf=0.120, stage2=False) | mask(mc=0.185, mb=0.504, no=0.999, corr=-0.126) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.5151 -> 61.9467
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1534 mb_mean=0.5031 norm_overlap=0.9979 corr_cb=-0.1766 topkJ=0.0534
[TRAIN][ep=015] loss=0.9981 acc=70.07%
[TRAIN][ep=015] mask_avg: mc_mean=0.1691 mb_mean=0.5039 norm_overlap=0.9981 corr_cb=-0.1520
[EPOCH 015/089] train: loss=0.9981 acc=70.07% | val: loss=0.7495 acc=57.83% f1=71.07% auc=57.56% val_score=49.8362 val_score_bestthr=65.1044 | dyn(w_pfs=0.310, w_sup=0.210, w_csuf=0.160, stage2=False) | mask(mc=0.169, mb=0.504, no=0.998, corr=-0.152) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 63.5151 -> 65.1044
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1609 mb_mean=0.5045 norm_overlap=0.9966 corr_cb=-0.2885 topkJ=0.0235
[TRAIN][ep=016] loss=1.0637 acc=71.28%
[TRAIN][ep=016] mask_avg: mc_mean=0.1724 mb_mean=0.5039 norm_overlap=0.9976 corr_cb=-0.1878
[EPOCH 016/089] train: loss=1.0637 acc=71.28% | val: loss=0.6969 acc=62.65% f1=69.31% auc=58.60% val_score=57.3788 val_score_bestthr=62.3366 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.172, mb=0.504, no=0.998, corr=-0.188) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 62.3366
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.2125 mb_mean=0.5056 norm_overlap=0.9973 corr_cb=-0.2310 topkJ=0.0252
[TRAIN][ep=017] loss=1.1376 acc=71.54%
[TRAIN][ep=017] mask_avg: mc_mean=0.1754 mb_mean=0.5039 norm_overlap=0.9970 corr_cb=-0.2253
[EPOCH 017/089] train: loss=1.1376 acc=71.54% | val: loss=0.6999 acc=62.65% f1=69.31% auc=58.49% val_score=57.3788 val_score_bestthr=62.3366 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.175, mb=0.504, no=0.997, corr=-0.225) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 62.3366
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.2022 mb_mean=0.5031 norm_overlap=0.9967 corr_cb=-0.2679 topkJ=0.0404
[TRAIN][ep=018] loss=1.1459 acc=69.80%
[TRAIN][ep=018] mask_avg: mc_mean=0.1826 mb_mean=0.5039 norm_overlap=0.9964 corr_cb=-0.2548
[EPOCH 018/089] train: loss=1.1459 acc=69.80% | val: loss=0.6955 acc=57.83% f1=71.07% auc=59.53% val_score=55.4778 val_score_bestthr=65.1044 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.183, mb=0.504, no=0.996, corr=-0.255) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 65.1044
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1323 mb_mean=0.4993 norm_overlap=0.9951 corr_cb=-0.2993 topkJ=0.0215
[TRAIN][ep=019] loss=1.1252 acc=71.81%
[TRAIN][ep=019] mask_avg: mc_mean=0.1945 mb_mean=0.5039 norm_overlap=0.9961 corr_cb=-0.2815
[EPOCH 019/089] train: loss=1.1252 acc=71.81% | val: loss=0.7168 acc=62.65% f1=69.31% auc=59.36% val_score=34.7326 val_score_bestthr=62.3366 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.195, mb=0.504, no=0.996, corr=-0.281) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 62.3366
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1858 mb_mean=0.5035 norm_overlap=0.9973 corr_cb=-0.1943 topkJ=0.0309
[TRAIN][ep=020] loss=1.1227 acc=72.21%
[TRAIN][ep=020] mask_avg: mc_mean=0.1999 mb_mean=0.5039 norm_overlap=0.9957 corr_cb=-0.3019
[EPOCH 020/089] train: loss=1.1227 acc=72.21% | val: loss=0.7055 acc=62.65% f1=68.69% auc=59.13% val_score=48.7053 val_score_bestthr=60.5893 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.200, mb=0.504, no=0.996, corr=-0.302) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 60.5893
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.1912 mb_mean=0.5031 norm_overlap=0.9945 corr_cb=-0.4039 topkJ=0.0086
[TRAIN][ep=021] loss=0.9210 acc=71.68%
[TRAIN][ep=021] mask_avg: mc_mean=0.1978 mb_mean=0.5039 norm_overlap=0.9953 corr_cb=-0.3066
[EPOCH 021/089] train: loss=0.9210 acc=71.68% | val: loss=0.7108 acc=62.65% f1=69.31% auc=59.07% val_score=44.3074 val_score_bestthr=62.3366 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.198, mb=0.504, no=0.995, corr=-0.307) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 62.3366
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2196 mb_mean=0.5056 norm_overlap=0.9918 corr_cb=-0.4756 topkJ=0.0036
[TRAIN][ep=022] loss=0.7180 acc=72.62%
[TRAIN][ep=022] mask_avg: mc_mean=0.1938 mb_mean=0.5039 norm_overlap=0.9949 corr_cb=-0.3113
[EPOCH 022/089] train: loss=0.7180 acc=72.62% | val: loss=0.7175 acc=62.65% f1=69.31% auc=59.42% val_score=46.2617 val_score_bestthr=62.3366 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.194, mb=0.504, no=0.995, corr=-0.311) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 62.3366
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1849 mb_mean=0.5049 norm_overlap=0.9945 corr_cb=-0.3492 topkJ=0.0176
[TRAIN][ep=023] loss=0.6793 acc=74.23%
[TRAIN][ep=023] mask_avg: mc_mean=0.2161 mb_mean=0.5039 norm_overlap=0.9948 corr_cb=-0.3358
[EPOCH 023/089] train: loss=0.6793 acc=74.23% | val: loss=0.7428 acc=57.83% f1=70.59% auc=59.65% val_score=51.6757 val_score_bestthr=60.6955 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.216, mb=0.504, no=0.995, corr=-0.336) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 60.6955
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1531 mb_mean=0.5040 norm_overlap=0.9950 corr_cb=-0.2497 topkJ=0.0199
[TRAIN][ep=024] loss=0.6540 acc=73.96%
[TRAIN][ep=024] mask_avg: mc_mean=0.1915 mb_mean=0.5039 norm_overlap=0.9944 corr_cb=-0.3183
[EPOCH 024/089] train: loss=0.6540 acc=73.96% | val: loss=0.7138 acc=56.63% f1=69.49% auc=59.88% val_score=51.5646 val_score_bestthr=59.8573 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.192, mb=0.504, no=0.994, corr=-0.318) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.8573
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1908 mb_mean=0.5015 norm_overlap=0.9955 corr_cb=-0.3080 topkJ=0.0144
[TRAIN][ep=025] loss=0.6446 acc=75.17%
[TRAIN][ep=025] mask_avg: mc_mean=0.2129 mb_mean=0.5039 norm_overlap=0.9943 corr_cb=-0.3427
[EPOCH 025/089] train: loss=0.6446 acc=75.17% | val: loss=0.7231 acc=61.45% f1=68.63% auc=59.59% val_score=53.7023 val_score_bestthr=59.6743 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.213, mb=0.504, no=0.994, corr=-0.343) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.6743
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2175 mb_mean=0.5035 norm_overlap=0.9967 corr_cb=-0.2139 topkJ=0.0333
[TRAIN][ep=026] loss=0.6432 acc=73.42%
[TRAIN][ep=026] mask_avg: mc_mean=0.2063 mb_mean=0.5039 norm_overlap=0.9940 corr_cb=-0.3364
[EPOCH 026/089] train: loss=0.6432 acc=73.42% | val: loss=0.7396 acc=63.86% f1=70.00% auc=61.05% val_score=57.0392 val_score_bestthr=62.3254 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.206, mb=0.504, no=0.994, corr=-0.336) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 62.3254
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2083 mb_mean=0.5061 norm_overlap=0.9913 corr_cb=-0.4540 topkJ=0.0052
[TRAIN][ep=027] loss=0.6646 acc=75.57%
[TRAIN][ep=027] mask_avg: mc_mean=0.1914 mb_mean=0.5039 norm_overlap=0.9940 corr_cb=-0.3242
[EPOCH 027/089] train: loss=0.6646 acc=75.57% | val: loss=0.7113 acc=55.42% f1=69.92% auc=60.12% val_score=57.1226 val_score_bestthr=63.6770 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.191, mb=0.504, no=0.994, corr=-0.324) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 63.6770
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1187 mb_mean=0.5045 norm_overlap=0.9927 corr_cb=-0.3179 topkJ=0.0125
[TRAIN][ep=028] loss=0.6271 acc=76.91%
[TRAIN][ep=028] mask_avg: mc_mean=0.1862 mb_mean=0.5039 norm_overlap=0.9938 corr_cb=-0.3206
[EPOCH 028/089] train: loss=0.6271 acc=76.91% | val: loss=0.7428 acc=61.45% f1=69.81% auc=60.23% val_score=54.4903 val_score_bestthr=61.3072 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.186, mb=0.504, no=0.994, corr=-0.321) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 61.3072
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2282 mb_mean=0.5067 norm_overlap=0.9908 corr_cb=-0.4830 topkJ=0.0024
[TRAIN][ep=029] loss=0.6261 acc=76.51%
[TRAIN][ep=029] mask_avg: mc_mean=0.2057 mb_mean=0.5039 norm_overlap=0.9938 corr_cb=-0.3384
[EPOCH 029/089] train: loss=0.6261 acc=76.51% | val: loss=0.7458 acc=62.65% f1=69.31% auc=59.88% val_score=52.8664 val_score_bestthr=59.6610 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.206, mb=0.504, no=0.994, corr=-0.338) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.6610
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2122 mb_mean=0.5046 norm_overlap=0.9940 corr_cb=-0.3462 topkJ=0.0063
[TRAIN][ep=030] loss=0.6140 acc=76.24%
[TRAIN][ep=030] mask_avg: mc_mean=0.2282 mb_mean=0.5039 norm_overlap=0.9938 corr_cb=-0.3562
[EPOCH 030/089] train: loss=0.6140 acc=76.24% | val: loss=0.7520 acc=55.42% f1=69.92% auc=60.81% val_score=56.7926 val_score_bestthr=63.6770 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.228, mb=0.504, no=0.994, corr=-0.356) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 63.6770
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2266 mb_mean=0.5031 norm_overlap=0.9961 corr_cb=-0.2527 topkJ=0.0174
[TRAIN][ep=031] loss=0.6133 acc=75.30%
[TRAIN][ep=031] mask_avg: mc_mean=0.2183 mb_mean=0.5039 norm_overlap=0.9937 corr_cb=-0.3467
[EPOCH 031/089] train: loss=0.6133 acc=75.30% | val: loss=0.8004 acc=62.65% f1=68.04% auc=61.74% val_score=47.1839 val_score_bestthr=58.3290 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.218, mb=0.504, no=0.994, corr=-0.347) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 58.3290
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2294 mb_mean=0.5042 norm_overlap=0.9946 corr_cb=-0.3300 topkJ=0.0108
[TRAIN][ep=032] loss=0.6400 acc=74.09%
[TRAIN][ep=032] mask_avg: mc_mean=0.1956 mb_mean=0.5039 norm_overlap=0.9934 corr_cb=-0.3384
[EPOCH 032/089] train: loss=0.6400 acc=74.09% | val: loss=0.7463 acc=61.45% f1=68.00% auc=61.57% val_score=57.0189 val_score_bestthr=57.6713 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.196, mb=0.504, no=0.993, corr=-0.338) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 57.6713
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2115 mb_mean=0.5032 norm_overlap=0.9905 corr_cb=-0.3958 topkJ=0.0152
[TRAIN][ep=033] loss=0.6085 acc=76.24%
[TRAIN][ep=033] mask_avg: mc_mean=0.2075 mb_mean=0.5039 norm_overlap=0.9936 corr_cb=-0.3388
[EPOCH 033/089] train: loss=0.6085 acc=76.24% | val: loss=0.8385 acc=56.63% f1=68.97% auc=60.99% val_score=50.9998 val_score_bestthr=58.9895 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.208, mb=0.504, no=0.994, corr=-0.339) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 58.9895
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2466 mb_mean=0.5013 norm_overlap=0.9944 corr_cb=-0.3422 topkJ=0.0167
[TRAIN][ep=034] loss=0.5992 acc=77.45%
[TRAIN][ep=034] mask_avg: mc_mean=0.2146 mb_mean=0.5039 norm_overlap=0.9936 corr_cb=-0.3430
[EPOCH 034/089] train: loss=0.5992 acc=77.45% | val: loss=0.7899 acc=57.83% f1=56.79% auc=61.05% val_score=44.2896 val_score_bestthr=57.5275 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.215, mb=0.504, no=0.994, corr=-0.343) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 57.5275
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2093 mb_mean=0.5009 norm_overlap=0.9913 corr_cb=-0.4063 topkJ=0.0060
[TRAIN][ep=035] loss=0.5983 acc=77.99%
[TRAIN][ep=035] mask_avg: mc_mean=0.2196 mb_mean=0.5039 norm_overlap=0.9936 corr_cb=-0.3451
[EPOCH 035/089] train: loss=0.5983 acc=77.99% | val: loss=0.7751 acc=57.83% f1=56.79% auc=61.16% val_score=57.0189 val_score_bestthr=57.5275 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.220, mb=0.504, no=0.994, corr=-0.345) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 57.5275
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2060 mb_mean=0.5038 norm_overlap=0.9978 corr_cb=-0.1330 topkJ=0.0318
[TRAIN][ep=036] loss=0.6170 acc=76.91%
[TRAIN][ep=036] mask_avg: mc_mean=0.1857 mb_mean=0.5039 norm_overlap=0.9934 corr_cb=-0.3125
[EPOCH 036/089] train: loss=0.6170 acc=76.91% | val: loss=0.7525 acc=56.63% f1=70.00% auc=62.21% val_score=56.9513 val_score_bestthr=60.2971 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.186, mb=0.504, no=0.993, corr=-0.312) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 60.2971
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.2723 mb_mean=0.5037 norm_overlap=0.9943 corr_cb=-0.3223 topkJ=0.0111
[TRAIN][ep=037] loss=0.5774 acc=77.99%
[TRAIN][ep=037] mask_avg: mc_mean=0.2314 mb_mean=0.5039 norm_overlap=0.9938 corr_cb=-0.3419
[EPOCH 037/089] train: loss=0.5774 acc=77.99% | val: loss=0.7656 acc=56.63% f1=70.00% auc=62.62% val_score=55.3877 val_score_bestthr=60.2971 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.231, mb=0.504, no=0.994, corr=-0.342) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 60.2971
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2251 mb_mean=0.5034 norm_overlap=0.9940 corr_cb=-0.3456 topkJ=0.0174
[TRAIN][ep=038] loss=0.5716 acc=78.93%
[TRAIN][ep=038] mask_avg: mc_mean=0.2531 mb_mean=0.5039 norm_overlap=0.9939 corr_cb=-0.3538
[EPOCH 038/089] train: loss=0.5716 acc=78.93% | val: loss=0.8122 acc=60.24% f1=61.18% auc=62.79% val_score=57.3360 val_score_bestthr=58.2151 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.253, mb=0.504, no=0.994, corr=-0.354) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 58.2151
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2590 mb_mean=0.5021 norm_overlap=0.9962 corr_cb=-0.2263 topkJ=0.0163
[TRAIN][ep=039] loss=0.5666 acc=80.54%
[TRAIN][ep=039] mask_avg: mc_mean=0.2313 mb_mean=0.5039 norm_overlap=0.9938 corr_cb=-0.3468
[EPOCH 039/089] train: loss=0.5666 acc=80.54% | val: loss=0.8492 acc=60.24% f1=70.27% auc=62.85% val_score=49.7456 val_score_bestthr=62.7556 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.231, mb=0.504, no=0.994, corr=-0.347) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 62.7556
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.2121 mb_mean=0.5045 norm_overlap=0.9932 corr_cb=-0.4000 topkJ=0.0152
[TRAIN][ep=040] loss=0.5571 acc=80.81%
[TRAIN][ep=040] mask_avg: mc_mean=0.2088 mb_mean=0.5039 norm_overlap=0.9938 corr_cb=-0.3164
[EPOCH 040/089] train: loss=0.5571 acc=80.81% | val: loss=0.7957 acc=57.83% f1=69.03% auc=63.49% val_score=58.2151 val_score_bestthr=57.7269 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.209, mb=0.504, no=0.994, corr=-0.316) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 57.7269
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.1659 mb_mean=0.5043 norm_overlap=0.9953 corr_cb=-0.2401 topkJ=0.0207
[TRAIN][ep=041] loss=0.5680 acc=79.87%
[TRAIN][ep=041] mask_avg: mc_mean=0.2598 mb_mean=0.5039 norm_overlap=0.9941 corr_cb=-0.3483
[EPOCH 041/089] train: loss=0.5680 acc=79.87% | val: loss=0.8558 acc=59.04% f1=59.52% auc=63.31% val_score=52.4546 val_score_bestthr=58.7331 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.260, mb=0.504, no=0.994, corr=-0.348) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 58.7331
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.2912 mb_mean=0.5033 norm_overlap=0.9952 corr_cb=-0.2965 topkJ=0.0240
[TRAIN][ep=042] loss=0.5679 acc=79.06%
[TRAIN][ep=042] mask_avg: mc_mean=0.2031 mb_mean=0.5039 norm_overlap=0.9938 corr_cb=-0.3125
[EPOCH 042/089] train: loss=0.5679 acc=79.06% | val: loss=0.7993 acc=56.63% f1=70.00% auc=63.66% val_score=57.6745 val_score_bestthr=60.2971 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.203, mb=0.504, no=0.994, corr=-0.313) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 60.2971
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.2055 mb_mean=0.5044 norm_overlap=0.9938 corr_cb=-0.3519 topkJ=0.0183
[TRAIN][ep=043] loss=0.5314 acc=80.67%
[TRAIN][ep=043] mask_avg: mc_mean=0.2254 mb_mean=0.5039 norm_overlap=0.9938 corr_cb=-0.3351
[EPOCH 043/089] train: loss=0.5314 acc=80.67% | val: loss=0.8521 acc=60.24% f1=61.18% auc=64.24% val_score=54.9538 val_score_bestthr=58.2151 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.225, mb=0.504, no=0.994, corr=-0.335) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 58.2151
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.1933 mb_mean=0.5091 norm_overlap=0.9952 corr_cb=-0.3018 topkJ=0.0176
[TRAIN][ep=044] loss=0.5608 acc=79.60%
[TRAIN][ep=044] mask_avg: mc_mean=0.2319 mb_mean=0.5039 norm_overlap=0.9940 corr_cb=-0.3274
[EPOCH 044/089] train: loss=0.5608 acc=79.60% | val: loss=0.8237 acc=59.04% f1=69.64% auc=63.08% val_score=53.7073 val_score_bestthr=59.5312 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.232, mb=0.504, no=0.994, corr=-0.327) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.5312
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2423 mb_mean=0.5010 norm_overlap=0.9933 corr_cb=-0.3576 topkJ=0.0244
[TRAIN][ep=045] loss=0.5270 acc=82.28%
[TRAIN][ep=045] mask_avg: mc_mean=0.2450 mb_mean=0.5039 norm_overlap=0.9940 corr_cb=-0.3355
[EPOCH 045/089] train: loss=0.5270 acc=82.28% | val: loss=0.8435 acc=60.24% f1=60.24% auc=65.17% val_score=59.3996 val_score_bestthr=58.7255 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.245, mb=0.504, no=0.994, corr=-0.336) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 58.7255
[EARLY STOP] no improvement for 30 epochs. best_epoch=15
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
=============== FIT DONE ===============
[BEST] epoch=15 | val_acc=57.83% | val_f1=71.07% | val_auc=57.56% | val_score=49.8362 | val_score_bestthr=65.1044
[TEST@BEST] thr_used=0.635 | acc=65.70% f1=68.16% auc=68.40% | SP_sex=1.11% EO_sex=5.86% SP_age=18.79% EO_age=21.79%
[TIME] 1.27 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/summary_fold_1.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4855 mb_mean=0.5049 norm_overlap=1.0000 corr_cb=0.0473 topkJ=0.1080
[TRAIN][ep=000] loss=0.6948 acc=48.99%
[TRAIN][ep=000] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1097
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4906 mb_mean=0.5028 norm_overlap=1.0002 corr_cb=0.3495 topkJ=0.0900
[TRAIN][ep=001] loss=0.6923 acc=51.95%
[TRAIN][ep=001] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1148
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4863 mb_mean=0.5023 norm_overlap=1.0001 corr_cb=0.0850 topkJ=0.0855
[TRAIN][ep=002] loss=0.6921 acc=53.15%
[TRAIN][ep=002] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1042
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4827 mb_mean=0.5045 norm_overlap=1.0001 corr_cb=0.1327 topkJ=0.1111
[TRAIN][ep=003] loss=0.6889 acc=54.36%
[TRAIN][ep=003] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1168
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4839 mb_mean=0.5059 norm_overlap=1.0001 corr_cb=0.1207 topkJ=0.1266
[TRAIN][ep=004] loss=0.6880 acc=54.50%
[TRAIN][ep=004] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1129
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4874 mb_mean=0.5023 norm_overlap=1.0001 corr_cb=0.2085 topkJ=0.0997
[TRAIN][ep=005] loss=0.6863 acc=55.17%
[TRAIN][ep=005] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1147
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4933 mb_mean=0.5052 norm_overlap=1.0001 corr_cb=0.1915 topkJ=0.0991
[TRAIN][ep=006] loss=0.6834 acc=57.85%
[TRAIN][ep=006] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1051
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4811 mb_mean=0.5022 norm_overlap=1.0001 corr_cb=0.1599 topkJ=0.1247
[TRAIN][ep=007] loss=0.6773 acc=58.39%
[TRAIN][ep=007] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1165
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4923 mb_mean=0.5061 norm_overlap=1.0000 corr_cb=-0.0490 topkJ=0.0591
[TRAIN][ep=008] loss=0.6750 acc=60.54%
[TRAIN][ep=008] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1064
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4885 mb_mean=0.5031 norm_overlap=1.0001 corr_cb=0.1442 topkJ=0.0897
[TRAIN][ep=009] loss=0.6778 acc=56.38%
[TRAIN][ep=009] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1185
================= FIT START (fold=1) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4904 mb_mean=0.5056 norm_overlap=1.0001 corr_cb=0.1620 topkJ=0.1007
[TRAIN][ep=000] loss=0.6654 acc=62.55%
[TRAIN][ep=000] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1145
[EPOCH 000/089] train: loss=0.6654 acc=62.55% | val: loss=0.6955 acc=59.04% f1=66.67% auc=56.34% val_score=40.0230 val_score_bestthr=61.6101 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.115) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 61.6101
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4891 mb_mean=0.5036 norm_overlap=1.0002 corr_cb=0.2700 topkJ=0.1255
[TRAIN][ep=001] loss=0.6582 acc=62.42%
[TRAIN][ep=001] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1127
[EPOCH 001/089] train: loss=0.6582 acc=62.42% | val: loss=0.6829 acc=60.24% f1=67.33% auc=56.34% val_score=59.5215 val_score_bestthr=63.1139 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.113) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 61.6101 -> 63.1139
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4874 mb_mean=0.5035 norm_overlap=1.0000 corr_cb=0.0912 topkJ=0.0898
[TRAIN][ep=002] loss=0.6501 acc=64.03%
[TRAIN][ep=002] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1172
[EPOCH 002/089] train: loss=0.6501 acc=64.03% | val: loss=0.6854 acc=60.24% f1=67.33% auc=56.10% val_score=59.5215 val_score_bestthr=63.1139 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.117) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.1139 -> 63.1139
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4901 mb_mean=0.5043 norm_overlap=1.0001 corr_cb=0.1890 topkJ=0.1067
[TRAIN][ep=003] loss=0.6427 acc=64.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1173
[EPOCH 003/089] train: loss=0.6427 acc=64.70% | val: loss=0.6899 acc=59.04% f1=66.67% auc=56.57% val_score=60.3480 val_score_bestthr=61.6101 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.117) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.1139 -> 61.6101
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4879 mb_mean=0.5014 norm_overlap=1.0004 corr_cb=0.5752 topkJ=0.1843
[TRAIN][ep=004] loss=0.6385 acc=63.36%
[TRAIN][ep=004] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1096
[EPOCH 004/089] train: loss=0.6385 acc=63.36% | val: loss=0.6864 acc=60.24% f1=67.33% auc=55.64% val_score=59.3002 val_score_bestthr=63.1139 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.110) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.1139 -> 63.1139
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4909 mb_mean=0.5055 norm_overlap=1.0002 corr_cb=0.3822 topkJ=0.1455
[TRAIN][ep=005] loss=1.2937 acc=63.36%
[TRAIN][ep=005] mask_avg: mc_mean=0.3769 mb_mean=0.5039 norm_overlap=1.0003 corr_cb=0.1127
[EPOCH 005/089] train: loss=1.2937 acc=63.36% | val: loss=0.6817 acc=61.45% f1=68.63% auc=56.57% val_score=54.4018 val_score_bestthr=63.2603 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.377, mb=0.504, no=1.000, corr=0.113) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 63.1139 -> 63.2603
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2782 mb_mean=0.5027 norm_overlap=1.0025 corr_cb=0.4426 topkJ=0.1506
[TRAIN][ep=006] loss=1.2706 acc=64.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.2634 mb_mean=0.5039 norm_overlap=1.0006 corr_cb=0.1092
[EPOCH 006/089] train: loss=1.2706 acc=64.70% | val: loss=0.6832 acc=59.04% f1=67.31% auc=56.74% val_score=49.9994 val_score_bestthr=58.7579 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.263, mb=0.504, no=1.001, corr=0.109) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2603 -> 58.7579
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2432 mb_mean=0.5043 norm_overlap=1.0011 corr_cb=0.1529 topkJ=0.1154
[TRAIN][ep=007] loss=1.2706 acc=65.91%
[TRAIN][ep=007] mask_avg: mc_mean=0.2292 mb_mean=0.5039 norm_overlap=1.0006 corr_cb=0.0868
[EPOCH 007/089] train: loss=1.2706 acc=65.91% | val: loss=0.6862 acc=57.83% f1=68.47% auc=56.69% val_score=44.7424 val_score_bestthr=62.9233 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.229, mb=0.504, no=1.001, corr=0.087) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2603 -> 62.9233
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2315 mb_mean=0.5056 norm_overlap=1.0002 corr_cb=0.0217 topkJ=0.0937
[TRAIN][ep=008] loss=1.2498 acc=67.79%
[TRAIN][ep=008] mask_avg: mc_mean=0.2026 mb_mean=0.5039 norm_overlap=1.0006 corr_cb=0.0682
[EPOCH 008/089] train: loss=1.2498 acc=67.79% | val: loss=0.6853 acc=60.24% f1=67.96% auc=56.51% val_score=57.5264 val_score_bestthr=61.4940 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.203, mb=0.504, no=1.001, corr=0.068) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2603 -> 61.4940
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1891 mb_mean=0.5044 norm_overlap=1.0004 corr_cb=0.0498 topkJ=0.0739
[TRAIN][ep=009] loss=1.2423 acc=67.25%
[TRAIN][ep=009] mask_avg: mc_mean=0.1955 mb_mean=0.5039 norm_overlap=1.0004 corr_cb=0.0426
[EPOCH 009/089] train: loss=1.2423 acc=67.25% | val: loss=0.6883 acc=60.24% f1=67.96% auc=56.92% val_score=58.4619 val_score_bestthr=61.4940 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.195, mb=0.504, no=1.000, corr=0.043) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2603 -> 61.4940
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1947 mb_mean=0.5054 norm_overlap=1.0001 corr_cb=0.0140 topkJ=0.0499
[TRAIN][ep=010] loss=1.2498 acc=65.91%
[TRAIN][ep=010] mask_avg: mc_mean=0.1854 mb_mean=0.5039 norm_overlap=1.0002 corr_cb=0.0180
[EPOCH 010/089] train: loss=1.2498 acc=65.91% | val: loss=0.6857 acc=60.24% f1=65.98% auc=57.85% val_score=57.3443 val_score_bestthr=59.3547 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.185, mb=0.504, no=1.000, corr=0.018) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2603 -> 59.3547
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.2038 mb_mean=0.5045 norm_overlap=1.0005 corr_cb=0.0531 topkJ=0.0731
[TRAIN][ep=011] loss=1.0449 acc=68.05%
[TRAIN][ep=011] mask_avg: mc_mean=0.1910 mb_mean=0.5039 norm_overlap=0.9998 corr_cb=-0.0223
[EPOCH 011/089] train: loss=1.0449 acc=68.05% | val: loss=0.7041 acc=60.24% f1=67.96% auc=57.67% val_score=41.4213 val_score_bestthr=61.1376 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.191, mb=0.504, no=1.000, corr=-0.022) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2603 -> 61.1376
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1847 mb_mean=0.5042 norm_overlap=1.0005 corr_cb=0.0501 topkJ=0.0859
[TRAIN][ep=012] loss=0.8406 acc=67.38%
[TRAIN][ep=012] mask_avg: mc_mean=0.1806 mb_mean=0.5039 norm_overlap=0.9995 corr_cb=-0.0536
[EPOCH 012/089] train: loss=0.8406 acc=67.38% | val: loss=0.7094 acc=61.45% f1=68.63% auc=57.85% val_score=39.4189 val_score_bestthr=63.5151 | dyn(w_pfs=0.190, w_sup=0.090, w_csuf=0.040, stage2=False) | mask(mc=0.181, mb=0.504, no=0.999, corr=-0.054) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 63.2603 -> 63.5151
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.2075 mb_mean=0.5031 norm_overlap=0.9982 corr_cb=-0.1894 topkJ=0.0680
[TRAIN][ep=013] loss=0.9049 acc=69.13%
[TRAIN][ep=013] mask_avg: mc_mean=0.1852 mb_mean=0.5039 norm_overlap=0.9989 corr_cb=-0.1036
[EPOCH 013/089] train: loss=0.9049 acc=69.13% | val: loss=0.7046 acc=59.04% f1=68.52% auc=57.73% val_score=45.3654 val_score_bestthr=62.3690 | dyn(w_pfs=0.230, w_sup=0.130, w_csuf=0.080, stage2=False) | mask(mc=0.185, mb=0.504, no=0.999, corr=-0.104) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.5151 -> 62.3690
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1894 mb_mean=0.5017 norm_overlap=0.9969 corr_cb=-0.2349 topkJ=0.0549
[TRAIN][ep=014] loss=0.9886 acc=68.05%
[TRAIN][ep=014] mask_avg: mc_mean=0.1839 mb_mean=0.5039 norm_overlap=0.9986 corr_cb=-0.1266
[EPOCH 014/089] train: loss=0.9886 acc=68.05% | val: loss=0.6981 acc=59.04% f1=67.31% auc=58.14% val_score=55.5840 val_score_bestthr=61.9467 | dyn(w_pfs=0.270, w_sup=0.170, w_csuf=0.120, stage2=False) | mask(mc=0.184, mb=0.504, no=0.999, corr=-0.127) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.5151 -> 61.9467
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1527 mb_mean=0.5031 norm_overlap=0.9979 corr_cb=-0.1774 topkJ=0.0530
[TRAIN][ep=015] loss=1.0525 acc=70.20%
[TRAIN][ep=015] mask_avg: mc_mean=0.1692 mb_mean=0.5039 norm_overlap=0.9981 corr_cb=-0.1534
[EPOCH 015/089] train: loss=1.0525 acc=70.20% | val: loss=0.7503 acc=57.83% f1=71.07% auc=57.56% val_score=49.8362 val_score_bestthr=65.1044 | dyn(w_pfs=0.310, w_sup=0.210, w_csuf=0.160, stage2=False) | mask(mc=0.169, mb=0.504, no=0.998, corr=-0.153) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 63.5151 -> 65.1044
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1609 mb_mean=0.5045 norm_overlap=0.9965 corr_cb=-0.2903 topkJ=0.0230
[TRAIN][ep=016] loss=1.1178 acc=71.54%
[TRAIN][ep=016] mask_avg: mc_mean=0.1715 mb_mean=0.5039 norm_overlap=0.9976 corr_cb=-0.1876
[EPOCH 016/089] train: loss=1.1178 acc=71.54% | val: loss=0.6970 acc=61.45% f1=68.63% auc=58.72% val_score=56.8202 val_score_bestthr=61.2808 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.171, mb=0.504, no=0.998, corr=-0.188) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 61.2808
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.2119 mb_mean=0.5056 norm_overlap=0.9973 corr_cb=-0.2326 topkJ=0.0248
[TRAIN][ep=017] loss=1.1919 acc=71.54%
[TRAIN][ep=017] mask_avg: mc_mean=0.1742 mb_mean=0.5039 norm_overlap=0.9970 corr_cb=-0.2249
[EPOCH 017/089] train: loss=1.1919 acc=71.54% | val: loss=0.7003 acc=62.65% f1=69.31% auc=58.26% val_score=57.3788 val_score_bestthr=62.3366 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.174, mb=0.504, no=0.997, corr=-0.225) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 62.3366
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.2007 mb_mean=0.5031 norm_overlap=0.9966 corr_cb=-0.2688 topkJ=0.0404
[TRAIN][ep=018] loss=1.2002 acc=69.53%
[TRAIN][ep=018] mask_avg: mc_mean=0.1815 mb_mean=0.5039 norm_overlap=0.9964 corr_cb=-0.2547
[EPOCH 018/089] train: loss=1.2002 acc=69.53% | val: loss=0.6958 acc=57.83% f1=71.07% auc=59.48% val_score=55.4778 val_score_bestthr=65.1044 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.181, mb=0.504, no=0.996, corr=-0.255) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 65.1044
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1312 mb_mean=0.4993 norm_overlap=0.9951 corr_cb=-0.2982 topkJ=0.0215
[TRAIN][ep=019] loss=1.1799 acc=71.68%
[TRAIN][ep=019] mask_avg: mc_mean=0.1952 mb_mean=0.5039 norm_overlap=0.9961 corr_cb=-0.2824
[EPOCH 019/089] train: loss=1.1799 acc=71.68% | val: loss=0.7159 acc=62.65% f1=69.31% auc=59.48% val_score=34.7326 val_score_bestthr=62.3366 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.195, mb=0.504, no=0.996, corr=-0.282) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 62.3366
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1862 mb_mean=0.5035 norm_overlap=0.9973 corr_cb=-0.1942 topkJ=0.0309
[TRAIN][ep=020] loss=1.1771 acc=71.95%
[TRAIN][ep=020] mask_avg: mc_mean=0.2005 mb_mean=0.5039 norm_overlap=0.9956 corr_cb=-0.3025
[EPOCH 020/089] train: loss=1.1771 acc=71.95% | val: loss=0.7055 acc=62.65% f1=68.69% auc=59.24% val_score=50.7239 val_score_bestthr=60.5893 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.200, mb=0.504, no=0.996, corr=-0.302) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 60.5893
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.1910 mb_mean=0.5031 norm_overlap=0.9944 corr_cb=-0.4037 topkJ=0.0082
[TRAIN][ep=021] loss=0.9756 acc=72.08%
[TRAIN][ep=021] mask_avg: mc_mean=0.1964 mb_mean=0.5039 norm_overlap=0.9953 corr_cb=-0.3052
[EPOCH 021/089] train: loss=0.9756 acc=72.08% | val: loss=0.7107 acc=62.65% f1=69.31% auc=59.19% val_score=44.3074 val_score_bestthr=62.3366 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.196, mb=0.504, no=0.995, corr=-0.305) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 62.3366
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2205 mb_mean=0.5056 norm_overlap=0.9919 corr_cb=-0.4731 topkJ=0.0039
[TRAIN][ep=022] loss=0.7724 acc=72.21%
[TRAIN][ep=022] mask_avg: mc_mean=0.1947 mb_mean=0.5039 norm_overlap=0.9949 corr_cb=-0.3117
[EPOCH 022/089] train: loss=0.7724 acc=72.21% | val: loss=0.7166 acc=62.65% f1=69.31% auc=59.65% val_score=51.6989 val_score_bestthr=62.3366 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.195, mb=0.504, no=0.995, corr=-0.312) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 62.3366
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1864 mb_mean=0.5049 norm_overlap=0.9945 corr_cb=-0.3498 topkJ=0.0176
[TRAIN][ep=023] loss=0.7340 acc=73.96%
[TRAIN][ep=023] mask_avg: mc_mean=0.2162 mb_mean=0.5039 norm_overlap=0.9948 corr_cb=-0.3353
[EPOCH 023/089] train: loss=0.7340 acc=73.96% | val: loss=0.7429 acc=57.83% f1=70.59% auc=59.59% val_score=51.6757 val_score_bestthr=60.6955 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.216, mb=0.504, no=0.995, corr=-0.335) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 60.6955
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1529 mb_mean=0.5040 norm_overlap=0.9950 corr_cb=-0.2494 topkJ=0.0203
[TRAIN][ep=024] loss=0.7088 acc=73.83%
[TRAIN][ep=024] mask_avg: mc_mean=0.1908 mb_mean=0.5039 norm_overlap=0.9944 corr_cb=-0.3170
[EPOCH 024/089] train: loss=0.7088 acc=73.83% | val: loss=0.7133 acc=56.63% f1=69.49% auc=59.94% val_score=51.5646 val_score_bestthr=59.8573 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.191, mb=0.504, no=0.994, corr=-0.317) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.8573
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1895 mb_mean=0.5015 norm_overlap=0.9955 corr_cb=-0.3039 topkJ=0.0136
[TRAIN][ep=025] loss=0.6994 acc=75.30%
[TRAIN][ep=025] mask_avg: mc_mean=0.2124 mb_mean=0.5039 norm_overlap=0.9943 corr_cb=-0.3413
[EPOCH 025/089] train: loss=0.6994 acc=75.30% | val: loss=0.7213 acc=61.45% f1=68.63% auc=59.42% val_score=53.6901 val_score_bestthr=59.6743 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.212, mb=0.504, no=0.994, corr=-0.341) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.6743
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2181 mb_mean=0.5035 norm_overlap=0.9966 corr_cb=-0.2162 topkJ=0.0333
[TRAIN][ep=026] loss=0.6982 acc=73.42%
[TRAIN][ep=026] mask_avg: mc_mean=0.2056 mb_mean=0.5039 norm_overlap=0.9940 corr_cb=-0.3348
[EPOCH 026/089] train: loss=0.6982 acc=73.42% | val: loss=0.7382 acc=63.86% f1=70.00% auc=60.87% val_score=52.4079 val_score_bestthr=62.3254 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.206, mb=0.504, no=0.994, corr=-0.335) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 62.3254
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2086 mb_mean=0.5061 norm_overlap=0.9913 corr_cb=-0.4539 topkJ=0.0048
[TRAIN][ep=027] loss=0.7204 acc=75.17%
[TRAIN][ep=027] mask_avg: mc_mean=0.1904 mb_mean=0.5039 norm_overlap=0.9940 corr_cb=-0.3224
[EPOCH 027/089] train: loss=0.7204 acc=75.17% | val: loss=0.7097 acc=55.42% f1=69.92% auc=60.23% val_score=53.0481 val_score_bestthr=63.6770 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.504, no=0.994, corr=-0.322) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 63.6770
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1182 mb_mean=0.5045 norm_overlap=0.9927 corr_cb=-0.3154 topkJ=0.0125
[TRAIN][ep=028] loss=0.6825 acc=76.24%
[TRAIN][ep=028] mask_avg: mc_mean=0.1844 mb_mean=0.5039 norm_overlap=0.9938 corr_cb=-0.3182
[EPOCH 028/089] train: loss=0.6825 acc=76.24% | val: loss=0.7416 acc=61.45% f1=69.81% auc=60.41% val_score=55.7103 val_score_bestthr=61.3072 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.184, mb=0.504, no=0.994, corr=-0.318) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 61.3072
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2283 mb_mean=0.5067 norm_overlap=0.9908 corr_cb=-0.4805 topkJ=0.0024
[TRAIN][ep=029] loss=0.6812 acc=76.38%
[TRAIN][ep=029] mask_avg: mc_mean=0.2068 mb_mean=0.5039 norm_overlap=0.9938 corr_cb=-0.3380
[EPOCH 029/089] train: loss=0.6812 acc=76.38% | val: loss=0.7422 acc=62.65% f1=69.31% auc=60.23% val_score=52.8664 val_score_bestthr=59.6610 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.207, mb=0.504, no=0.994, corr=-0.338) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.6610
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2113 mb_mean=0.5046 norm_overlap=0.9940 corr_cb=-0.3450 topkJ=0.0063
[TRAIN][ep=030] loss=0.6696 acc=76.24%
[TRAIN][ep=030] mask_avg: mc_mean=0.2277 mb_mean=0.5039 norm_overlap=0.9938 corr_cb=-0.3544
[EPOCH 030/089] train: loss=0.6696 acc=76.24% | val: loss=0.7470 acc=55.42% f1=69.92% auc=61.16% val_score=52.8664 val_score_bestthr=63.6770 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.228, mb=0.504, no=0.994, corr=-0.354) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 63.6770
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2241 mb_mean=0.5031 norm_overlap=0.9961 corr_cb=-0.2479 topkJ=0.0178
[TRAIN][ep=031] loss=0.6679 acc=75.57%
[TRAIN][ep=031] mask_avg: mc_mean=0.2176 mb_mean=0.5039 norm_overlap=0.9937 corr_cb=-0.3447
[EPOCH 031/089] train: loss=0.6679 acc=75.57% | val: loss=0.7972 acc=62.65% f1=68.04% auc=61.74% val_score=47.1839 val_score_bestthr=58.3290 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.218, mb=0.504, no=0.994, corr=-0.345) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 58.3290
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2314 mb_mean=0.5042 norm_overlap=0.9946 corr_cb=-0.3307 topkJ=0.0108
[TRAIN][ep=032] loss=0.6950 acc=73.83%
[TRAIN][ep=032] mask_avg: mc_mean=0.1957 mb_mean=0.5039 norm_overlap=0.9934 corr_cb=-0.3370
[EPOCH 032/089] train: loss=0.6950 acc=73.83% | val: loss=0.7438 acc=62.65% f1=69.31% auc=61.45% val_score=57.0189 val_score_bestthr=59.6610 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.196, mb=0.504, no=0.993, corr=-0.337) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.6610
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2113 mb_mean=0.5032 norm_overlap=0.9904 corr_cb=-0.3984 topkJ=0.0148
[TRAIN][ep=033] loss=0.6645 acc=75.97%
[TRAIN][ep=033] mask_avg: mc_mean=0.2069 mb_mean=0.5039 norm_overlap=0.9936 corr_cb=-0.3368
[EPOCH 033/089] train: loss=0.6645 acc=75.97% | val: loss=0.8314 acc=56.63% f1=68.97% auc=61.10% val_score=50.9998 val_score_bestthr=58.9895 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.207, mb=0.504, no=0.994, corr=-0.337) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 58.9895
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2501 mb_mean=0.5013 norm_overlap=0.9945 corr_cb=-0.3351 topkJ=0.0171
[TRAIN][ep=034] loss=0.6548 acc=77.05%
[TRAIN][ep=034] mask_avg: mc_mean=0.2154 mb_mean=0.5039 norm_overlap=0.9936 corr_cb=-0.3421
[EPOCH 034/089] train: loss=0.6548 acc=77.05% | val: loss=0.7837 acc=56.63% f1=69.49% auc=61.16% val_score=44.2896 val_score_bestthr=58.7373 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.215, mb=0.504, no=0.994, corr=-0.342) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 58.7373
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2062 mb_mean=0.5009 norm_overlap=0.9913 corr_cb=-0.4018 topkJ=0.0064
[TRAIN][ep=035] loss=0.6540 acc=77.45%
[TRAIN][ep=035] mask_avg: mc_mean=0.2181 mb_mean=0.5039 norm_overlap=0.9936 corr_cb=-0.3430
[EPOCH 035/089] train: loss=0.6540 acc=77.45% | val: loss=0.7731 acc=55.42% f1=68.38% auc=61.10% val_score=57.0189 val_score_bestthr=57.8962 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.218, mb=0.504, no=0.994, corr=-0.343) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 57.8962
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2066 mb_mean=0.5038 norm_overlap=0.9978 corr_cb=-0.1320 topkJ=0.0305
[TRAIN][ep=036] loss=0.6710 acc=76.51%
[TRAIN][ep=036] mask_avg: mc_mean=0.1882 mb_mean=0.5039 norm_overlap=0.9934 corr_cb=-0.3128
[EPOCH 036/089] train: loss=0.6710 acc=76.51% | val: loss=0.7538 acc=56.63% f1=70.00% auc=62.38% val_score=56.9513 val_score_bestthr=60.2971 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.188, mb=0.504, no=0.993, corr=-0.313) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 60.2971
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.2744 mb_mean=0.5037 norm_overlap=0.9944 corr_cb=-0.3220 topkJ=0.0111
[TRAIN][ep=037] loss=0.6335 acc=77.85%
[TRAIN][ep=037] mask_avg: mc_mean=0.2323 mb_mean=0.5039 norm_overlap=0.9938 corr_cb=-0.3406
[EPOCH 037/089] train: loss=0.6335 acc=77.85% | val: loss=0.7636 acc=56.63% f1=70.00% auc=62.85% val_score=56.8394 val_score_bestthr=60.2971 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.232, mb=0.504, no=0.994, corr=-0.341) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 60.2971
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2246 mb_mean=0.5034 norm_overlap=0.9940 corr_cb=-0.3432 topkJ=0.0170
[TRAIN][ep=038] loss=0.6284 acc=78.79%
[TRAIN][ep=038] mask_avg: mc_mean=0.2516 mb_mean=0.5039 norm_overlap=0.9939 corr_cb=-0.3508
[EPOCH 038/089] train: loss=0.6284 acc=78.79% | val: loss=0.8067 acc=60.24% f1=61.18% auc=62.85% val_score=57.3360 val_score_bestthr=58.2151 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.252, mb=0.504, no=0.994, corr=-0.351) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 58.2151
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2590 mb_mean=0.5021 norm_overlap=0.9963 corr_cb=-0.2202 topkJ=0.0163
[TRAIN][ep=039] loss=0.6229 acc=80.13%
[TRAIN][ep=039] mask_avg: mc_mean=0.2311 mb_mean=0.5039 norm_overlap=0.9938 corr_cb=-0.3444
[EPOCH 039/089] train: loss=0.6229 acc=80.13% | val: loss=0.8476 acc=59.04% f1=69.64% auc=62.97% val_score=49.7456 val_score_bestthr=59.5312 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.231, mb=0.504, no=0.994, corr=-0.344) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.5312
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.2125 mb_mean=0.5045 norm_overlap=0.9933 corr_cb=-0.3977 topkJ=0.0156
[TRAIN][ep=040] loss=0.6149 acc=80.81%
[TRAIN][ep=040] mask_avg: mc_mean=0.2081 mb_mean=0.5039 norm_overlap=0.9938 corr_cb=-0.3138
[EPOCH 040/089] train: loss=0.6149 acc=80.81% | val: loss=0.7905 acc=57.83% f1=68.47% auc=63.02% val_score=58.2151 val_score_bestthr=59.7160 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.208, mb=0.504, no=0.994, corr=-0.314) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.7160
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.1661 mb_mean=0.5043 norm_overlap=0.9953 corr_cb=-0.2371 topkJ=0.0207
[TRAIN][ep=041] loss=0.6248 acc=80.00%
[TRAIN][ep=041] mask_avg: mc_mean=0.2577 mb_mean=0.5039 norm_overlap=0.9941 corr_cb=-0.3455
[EPOCH 041/089] train: loss=0.6248 acc=80.00% | val: loss=0.8475 acc=59.04% f1=59.52% auc=63.90% val_score=50.1156 val_score_bestthr=58.7331 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.258, mb=0.504, no=0.994, corr=-0.345) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 58.7331
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.2917 mb_mean=0.5033 norm_overlap=0.9952 corr_cb=-0.2948 topkJ=0.0240
[TRAIN][ep=042] loss=0.6245 acc=78.93%
[TRAIN][ep=042] mask_avg: mc_mean=0.2019 mb_mean=0.5039 norm_overlap=0.9939 corr_cb=-0.3098
[EPOCH 042/089] train: loss=0.6245 acc=78.93% | val: loss=0.7959 acc=56.63% f1=70.00% auc=63.37% val_score=57.6745 val_score_bestthr=60.2971 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.202, mb=0.504, no=0.994, corr=-0.310) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 60.2971
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.2068 mb_mean=0.5044 norm_overlap=0.9939 corr_cb=-0.3482 topkJ=0.0183
[TRAIN][ep=043] loss=0.5890 acc=81.07%
[TRAIN][ep=043] mask_avg: mc_mean=0.2269 mb_mean=0.5039 norm_overlap=0.9939 corr_cb=-0.3332
[EPOCH 043/089] train: loss=0.5890 acc=81.07% | val: loss=0.8457 acc=60.24% f1=61.18% auc=64.13% val_score=54.9538 val_score_bestthr=58.2151 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.227, mb=0.504, no=0.994, corr=-0.333) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 58.2151
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.1929 mb_mean=0.5091 norm_overlap=0.9952 corr_cb=-0.2991 topkJ=0.0180
[TRAIN][ep=044] loss=0.6182 acc=79.19%
[TRAIN][ep=044] mask_avg: mc_mean=0.2274 mb_mean=0.5039 norm_overlap=0.9940 corr_cb=-0.3230
[EPOCH 044/089] train: loss=0.6182 acc=79.19% | val: loss=0.8184 acc=59.04% f1=69.64% auc=62.91% val_score=53.7073 val_score_bestthr=59.5312 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.227, mb=0.504, no=0.994, corr=-0.323) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.5312
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2431 mb_mean=0.5010 norm_overlap=0.9933 corr_cb=-0.3556 topkJ=0.0244
[TRAIN][ep=045] loss=0.5848 acc=82.15%
[TRAIN][ep=045] mask_avg: mc_mean=0.2444 mb_mean=0.5039 norm_overlap=0.9940 corr_cb=-0.3340
[EPOCH 045/089] train: loss=0.5848 acc=82.15% | val: loss=0.8406 acc=61.45% f1=58.97% auc=65.29% val_score=59.3956 val_score_bestthr=60.0545 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.244, mb=0.504, no=0.994, corr=-0.334) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 60.0545
[EARLY STOP] no improvement for 30 epochs. best_epoch=15
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
=============== FIT DONE ===============
[BEST] epoch=15 | val_acc=57.83% | val_f1=71.07% | val_auc=57.56% | val_score=49.8362 | val_score_bestthr=65.1044
[TEST@BEST] thr_used=0.635 | acc=65.70% f1=68.16% auc=68.39% | SP_sex=1.11% EO_sex=5.86% SP_age=18.79% EO_age=21.79%
[TIME] 1.35 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/summary_fold_1.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4855 mb_mean=0.5049 norm_overlap=1.0000 corr_cb=0.0473 topkJ=0.1080
[TRAIN][ep=000] loss=0.6948 acc=48.99%
[TRAIN][ep=000] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1097
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4906 mb_mean=0.5028 norm_overlap=1.0002 corr_cb=0.3495 topkJ=0.0900
[TRAIN][ep=001] loss=0.6923 acc=51.95%
[TRAIN][ep=001] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1148
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4863 mb_mean=0.5023 norm_overlap=1.0001 corr_cb=0.0850 topkJ=0.0855
[TRAIN][ep=002] loss=0.6921 acc=53.15%
[TRAIN][ep=002] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1042
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4827 mb_mean=0.5045 norm_overlap=1.0001 corr_cb=0.1327 topkJ=0.1111
[TRAIN][ep=003] loss=0.6889 acc=54.36%
[TRAIN][ep=003] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1168
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4839 mb_mean=0.5059 norm_overlap=1.0001 corr_cb=0.1207 topkJ=0.1266
[TRAIN][ep=004] loss=0.6880 acc=54.50%
[TRAIN][ep=004] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1129
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4874 mb_mean=0.5023 norm_overlap=1.0001 corr_cb=0.2085 topkJ=0.0997
[TRAIN][ep=005] loss=0.6863 acc=55.17%
[TRAIN][ep=005] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1147
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4933 mb_mean=0.5052 norm_overlap=1.0001 corr_cb=0.1915 topkJ=0.0991
[TRAIN][ep=006] loss=0.6834 acc=57.85%
[TRAIN][ep=006] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1051
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4811 mb_mean=0.5022 norm_overlap=1.0001 corr_cb=0.1599 topkJ=0.1247
[TRAIN][ep=007] loss=0.6773 acc=58.39%
[TRAIN][ep=007] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1165
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4923 mb_mean=0.5061 norm_overlap=1.0000 corr_cb=-0.0490 topkJ=0.0591
[TRAIN][ep=008] loss=0.6750 acc=60.54%
[TRAIN][ep=008] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1064
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4885 mb_mean=0.5031 norm_overlap=1.0001 corr_cb=0.1442 topkJ=0.0897
[TRAIN][ep=009] loss=0.6778 acc=56.38%
[TRAIN][ep=009] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1185
================= FIT START (fold=1) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4904 mb_mean=0.5056 norm_overlap=1.0001 corr_cb=0.1620 topkJ=0.1007
[TRAIN][ep=000] loss=0.6655 acc=62.42%
[TRAIN][ep=000] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1145
[EPOCH 000/089] train: loss=0.6655 acc=62.42% | val: loss=0.6955 acc=59.04% f1=66.67% auc=56.34% val_score=40.0230 val_score_bestthr=61.6101 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.115) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 61.6101
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4891 mb_mean=0.5036 norm_overlap=1.0002 corr_cb=0.2700 topkJ=0.1255
[TRAIN][ep=001] loss=0.6582 acc=62.42%
[TRAIN][ep=001] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1127
[EPOCH 001/089] train: loss=0.6582 acc=62.42% | val: loss=0.6829 acc=60.24% f1=67.33% auc=56.28% val_score=59.5215 val_score_bestthr=63.1139 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.113) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 61.6101 -> 63.1139
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4874 mb_mean=0.5035 norm_overlap=1.0000 corr_cb=0.0912 topkJ=0.0898
[TRAIN][ep=002] loss=0.6501 acc=64.03%
[TRAIN][ep=002] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1172
[EPOCH 002/089] train: loss=0.6501 acc=64.03% | val: loss=0.6854 acc=60.24% f1=67.33% auc=56.22% val_score=59.5215 val_score_bestthr=63.1139 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.117) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.1139 -> 63.1139
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4901 mb_mean=0.5043 norm_overlap=1.0001 corr_cb=0.1890 topkJ=0.1067
[TRAIN][ep=003] loss=0.6427 acc=64.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1173
[EPOCH 003/089] train: loss=0.6427 acc=64.70% | val: loss=0.6899 acc=59.04% f1=66.67% auc=56.57% val_score=60.3480 val_score_bestthr=61.6101 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.117) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.1139 -> 61.6101
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4879 mb_mean=0.5014 norm_overlap=1.0004 corr_cb=0.5752 topkJ=0.1843
[TRAIN][ep=004] loss=0.6386 acc=63.49%
[TRAIN][ep=004] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1096
[EPOCH 004/089] train: loss=0.6386 acc=63.49% | val: loss=0.6863 acc=60.24% f1=67.33% auc=55.64% val_score=59.3002 val_score_bestthr=63.1139 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.110) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.1139 -> 63.1139
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4909 mb_mean=0.5055 norm_overlap=1.0002 corr_cb=0.3822 topkJ=0.1455
[TRAIN][ep=005] loss=1.4679 acc=63.36%
[TRAIN][ep=005] mask_avg: mc_mean=0.3768 mb_mean=0.5039 norm_overlap=1.0003 corr_cb=0.1127
[EPOCH 005/089] train: loss=1.4679 acc=63.36% | val: loss=0.6812 acc=61.45% f1=68.63% auc=56.74% val_score=57.4025 val_score_bestthr=63.2603 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.377, mb=0.504, no=1.000, corr=0.113) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 63.1139 -> 63.2603
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2778 mb_mean=0.5027 norm_overlap=1.0025 corr_cb=0.4425 topkJ=0.1506
[TRAIN][ep=006] loss=1.4347 acc=65.23%
[TRAIN][ep=006] mask_avg: mc_mean=0.2629 mb_mean=0.5039 norm_overlap=1.0006 corr_cb=0.1092
[EPOCH 006/089] train: loss=1.4347 acc=65.23% | val: loss=0.6829 acc=60.24% f1=67.96% auc=56.74% val_score=49.9994 val_score_bestthr=61.4940 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.263, mb=0.504, no=1.001, corr=0.109) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2603 -> 61.4940
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2428 mb_mean=0.5043 norm_overlap=1.0011 corr_cb=0.1527 topkJ=0.1154
[TRAIN][ep=007] loss=1.4344 acc=65.77%
[TRAIN][ep=007] mask_avg: mc_mean=0.2289 mb_mean=0.5039 norm_overlap=1.0006 corr_cb=0.0865
[EPOCH 007/089] train: loss=1.4344 acc=65.77% | val: loss=0.6858 acc=60.24% f1=67.96% auc=56.80% val_score=44.7424 val_score_bestthr=61.4940 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.229, mb=0.504, no=1.001, corr=0.087) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2603 -> 61.4940
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2314 mb_mean=0.5056 norm_overlap=1.0002 corr_cb=0.0205 topkJ=0.0937
[TRAIN][ep=008] loss=1.4128 acc=68.05%
[TRAIN][ep=008] mask_avg: mc_mean=0.2026 mb_mean=0.5039 norm_overlap=1.0006 corr_cb=0.0678
[EPOCH 008/089] train: loss=1.4128 acc=68.05% | val: loss=0.6849 acc=60.24% f1=67.96% auc=56.63% val_score=57.9877 val_score_bestthr=61.4940 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.203, mb=0.504, no=1.001, corr=0.068) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2603 -> 61.4940
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1891 mb_mean=0.5044 norm_overlap=1.0004 corr_cb=0.0493 topkJ=0.0739
[TRAIN][ep=009] loss=1.4056 acc=67.25%
[TRAIN][ep=009] mask_avg: mc_mean=0.1956 mb_mean=0.5039 norm_overlap=1.0004 corr_cb=0.0423
[EPOCH 009/089] train: loss=1.4056 acc=67.25% | val: loss=0.6878 acc=60.24% f1=67.96% auc=57.15% val_score=58.4619 val_score_bestthr=61.4940 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.196, mb=0.504, no=1.000, corr=0.042) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2603 -> 61.4940
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1951 mb_mean=0.5054 norm_overlap=1.0001 corr_cb=0.0132 topkJ=0.0499
[TRAIN][ep=010] loss=1.4128 acc=65.77%
[TRAIN][ep=010] mask_avg: mc_mean=0.1860 mb_mean=0.5039 norm_overlap=1.0002 corr_cb=0.0172
[EPOCH 010/089] train: loss=1.4128 acc=65.77% | val: loss=0.6852 acc=60.24% f1=65.98% auc=57.79% val_score=57.3443 val_score_bestthr=59.3547 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.186, mb=0.504, no=1.000, corr=0.017) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2603 -> 59.3547
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.2041 mb_mean=0.5045 norm_overlap=1.0005 corr_cb=0.0521 topkJ=0.0722
[TRAIN][ep=011] loss=1.2070 acc=67.92%
[TRAIN][ep=011] mask_avg: mc_mean=0.1912 mb_mean=0.5039 norm_overlap=0.9998 corr_cb=-0.0229
[EPOCH 011/089] train: loss=1.2070 acc=67.92% | val: loss=0.7030 acc=59.04% f1=67.31% auc=57.85% val_score=41.4213 val_score_bestthr=60.0348 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.191, mb=0.504, no=1.000, corr=-0.023) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2603 -> 60.0348
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1849 mb_mean=0.5042 norm_overlap=1.0005 corr_cb=0.0497 topkJ=0.0859
[TRAIN][ep=012] loss=1.0022 acc=67.25%
[TRAIN][ep=012] mask_avg: mc_mean=0.1809 mb_mean=0.5039 norm_overlap=0.9995 corr_cb=-0.0539
[EPOCH 012/089] train: loss=1.0022 acc=67.25% | val: loss=0.7084 acc=61.45% f1=68.63% auc=57.85% val_score=39.4189 val_score_bestthr=63.5151 | dyn(w_pfs=0.190, w_sup=0.090, w_csuf=0.040, stage2=False) | mask(mc=0.181, mb=0.504, no=0.999, corr=-0.054) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 63.2603 -> 63.5151
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.2073 mb_mean=0.5031 norm_overlap=0.9982 corr_cb=-0.1897 topkJ=0.0685
[TRAIN][ep=013] loss=1.0663 acc=69.13%
[TRAIN][ep=013] mask_avg: mc_mean=0.1856 mb_mean=0.5039 norm_overlap=0.9989 corr_cb=-0.1043
[EPOCH 013/089] train: loss=1.0663 acc=69.13% | val: loss=0.7034 acc=59.04% f1=68.52% auc=57.85% val_score=45.3654 val_score_bestthr=62.3690 | dyn(w_pfs=0.230, w_sup=0.130, w_csuf=0.080, stage2=False) | mask(mc=0.186, mb=0.504, no=0.999, corr=-0.104) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.5151 -> 62.3690
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1901 mb_mean=0.5017 norm_overlap=0.9969 corr_cb=-0.2360 topkJ=0.0549
[TRAIN][ep=014] loss=1.1496 acc=67.92%
[TRAIN][ep=014] mask_avg: mc_mean=0.1842 mb_mean=0.5039 norm_overlap=0.9986 corr_cb=-0.1270
[EPOCH 014/089] train: loss=1.1496 acc=67.92% | val: loss=0.6972 acc=59.04% f1=67.31% auc=58.26% val_score=55.5840 val_score_bestthr=61.9467 | dyn(w_pfs=0.270, w_sup=0.170, w_csuf=0.120, stage2=False) | mask(mc=0.184, mb=0.504, no=0.999, corr=-0.127) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.5151 -> 61.9467
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1527 mb_mean=0.5031 norm_overlap=0.9978 corr_cb=-0.1777 topkJ=0.0534
[TRAIN][ep=015] loss=1.2125 acc=70.20%
[TRAIN][ep=015] mask_avg: mc_mean=0.1692 mb_mean=0.5039 norm_overlap=0.9981 corr_cb=-0.1534
[EPOCH 015/089] train: loss=1.2125 acc=70.20% | val: loss=0.7489 acc=57.83% f1=71.07% auc=57.44% val_score=49.8362 val_score_bestthr=65.1044 | dyn(w_pfs=0.310, w_sup=0.210, w_csuf=0.160, stage2=False) | mask(mc=0.169, mb=0.504, no=0.998, corr=-0.153) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 63.5151 -> 65.1044
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1608 mb_mean=0.5045 norm_overlap=0.9965 corr_cb=-0.2899 topkJ=0.0226
[TRAIN][ep=016] loss=1.2772 acc=71.41%
[TRAIN][ep=016] mask_avg: mc_mean=0.1709 mb_mean=0.5039 norm_overlap=0.9976 corr_cb=-0.1868
[EPOCH 016/089] train: loss=1.2772 acc=71.41% | val: loss=0.6960 acc=61.45% f1=68.00% auc=58.66% val_score=56.8202 val_score_bestthr=60.2281 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.171, mb=0.504, no=0.998, corr=-0.187) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 60.2281
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.2117 mb_mean=0.5056 norm_overlap=0.9973 corr_cb=-0.2330 topkJ=0.0248
[TRAIN][ep=017] loss=1.3506 acc=71.54%
[TRAIN][ep=017] mask_avg: mc_mean=0.1744 mb_mean=0.5039 norm_overlap=0.9970 corr_cb=-0.2250
[EPOCH 017/089] train: loss=1.3506 acc=71.54% | val: loss=0.6989 acc=62.65% f1=69.31% auc=58.55% val_score=57.3788 val_score_bestthr=62.3366 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.174, mb=0.504, no=0.997, corr=-0.225) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 62.3366
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.2012 mb_mean=0.5031 norm_overlap=0.9966 corr_cb=-0.2701 topkJ=0.0400
[TRAIN][ep=018] loss=1.3585 acc=70.20%
[TRAIN][ep=018] mask_avg: mc_mean=0.1815 mb_mean=0.5039 norm_overlap=0.9964 corr_cb=-0.2544
[EPOCH 018/089] train: loss=1.3585 acc=70.20% | val: loss=0.6941 acc=57.83% f1=71.07% auc=59.42% val_score=55.4778 val_score_bestthr=65.1044 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.182, mb=0.504, no=0.996, corr=-0.254) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 65.1044
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1314 mb_mean=0.4993 norm_overlap=0.9951 corr_cb=-0.2976 topkJ=0.0219
[TRAIN][ep=019] loss=1.3379 acc=71.81%
[TRAIN][ep=019] mask_avg: mc_mean=0.1948 mb_mean=0.5039 norm_overlap=0.9961 corr_cb=-0.2816
[EPOCH 019/089] train: loss=1.3379 acc=71.81% | val: loss=0.7144 acc=62.65% f1=69.31% auc=59.42% val_score=34.7326 val_score_bestthr=62.3366 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.195, mb=0.504, no=0.996, corr=-0.282) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 62.3366
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1847 mb_mean=0.5035 norm_overlap=0.9973 corr_cb=-0.1913 topkJ=0.0317
[TRAIN][ep=020] loss=1.3339 acc=71.95%
[TRAIN][ep=020] mask_avg: mc_mean=0.1995 mb_mean=0.5039 norm_overlap=0.9957 corr_cb=-0.3011
[EPOCH 020/089] train: loss=1.3339 acc=71.95% | val: loss=0.7036 acc=62.65% f1=68.69% auc=59.19% val_score=47.1990 val_score_bestthr=60.5893 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.200, mb=0.504, no=0.996, corr=-0.301) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 60.5893
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.1907 mb_mean=0.5031 norm_overlap=0.9944 corr_cb=-0.4026 topkJ=0.0086
[TRAIN][ep=021] loss=1.1321 acc=71.95%
[TRAIN][ep=021] mask_avg: mc_mean=0.1953 mb_mean=0.5039 norm_overlap=0.9953 corr_cb=-0.3036
[EPOCH 021/089] train: loss=1.1321 acc=71.95% | val: loss=0.7082 acc=62.65% f1=69.31% auc=59.07% val_score=44.3074 val_score_bestthr=62.3366 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.195, mb=0.504, no=0.995, corr=-0.304) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 62.3366
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2203 mb_mean=0.5056 norm_overlap=0.9919 corr_cb=-0.4707 topkJ=0.0039
[TRAIN][ep=022] loss=0.9274 acc=72.62%
[TRAIN][ep=022] mask_avg: mc_mean=0.1946 mb_mean=0.5039 norm_overlap=0.9949 corr_cb=-0.3110
[EPOCH 022/089] train: loss=0.9274 acc=72.62% | val: loss=0.7145 acc=62.65% f1=69.31% auc=59.59% val_score=53.8368 val_score_bestthr=62.3366 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.195, mb=0.504, no=0.995, corr=-0.311) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 62.3366
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1854 mb_mean=0.5049 norm_overlap=0.9945 corr_cb=-0.3496 topkJ=0.0180
[TRAIN][ep=023] loss=0.8895 acc=73.69%
[TRAIN][ep=023] mask_avg: mc_mean=0.2153 mb_mean=0.5039 norm_overlap=0.9948 corr_cb=-0.3338
[EPOCH 023/089] train: loss=0.8895 acc=73.69% | val: loss=0.7399 acc=57.83% f1=70.59% auc=60.17% val_score=51.6757 val_score_bestthr=60.6955 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.215, mb=0.504, no=0.995, corr=-0.334) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 60.6955
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1523 mb_mean=0.5040 norm_overlap=0.9950 corr_cb=-0.2484 topkJ=0.0203
[TRAIN][ep=024] loss=0.8626 acc=73.56%
[TRAIN][ep=024] mask_avg: mc_mean=0.1902 mb_mean=0.5039 norm_overlap=0.9944 corr_cb=-0.3157
[EPOCH 024/089] train: loss=0.8626 acc=73.56% | val: loss=0.7103 acc=56.63% f1=69.49% auc=60.29% val_score=51.5646 val_score_bestthr=59.8573 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.504, no=0.994, corr=-0.316) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.8573
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1866 mb_mean=0.5015 norm_overlap=0.9955 corr_cb=-0.2990 topkJ=0.0136
[TRAIN][ep=025] loss=0.8513 acc=75.70%
[TRAIN][ep=025] mask_avg: mc_mean=0.2114 mb_mean=0.5039 norm_overlap=0.9943 corr_cb=-0.3396
[EPOCH 025/089] train: loss=0.8513 acc=75.70% | val: loss=0.7187 acc=61.45% f1=68.63% auc=59.71% val_score=53.7023 val_score_bestthr=59.6743 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.211, mb=0.504, no=0.994, corr=-0.340) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.6743
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2177 mb_mean=0.5035 norm_overlap=0.9966 corr_cb=-0.2175 topkJ=0.0333
[TRAIN][ep=026] loss=0.8488 acc=73.56%
[TRAIN][ep=026] mask_avg: mc_mean=0.2052 mb_mean=0.5039 norm_overlap=0.9941 corr_cb=-0.3336
[EPOCH 026/089] train: loss=0.8488 acc=73.56% | val: loss=0.7343 acc=65.06% f1=70.71% auc=61.22% val_score=51.4109 val_score_bestthr=62.3163 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.205, mb=0.504, no=0.994, corr=-0.334) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 62.3163
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2065 mb_mean=0.5061 norm_overlap=0.9912 corr_cb=-0.4517 topkJ=0.0048
[TRAIN][ep=027] loss=0.8769 acc=75.03%
[TRAIN][ep=027] mask_avg: mc_mean=0.1879 mb_mean=0.5039 norm_overlap=0.9940 corr_cb=-0.3189
[EPOCH 027/089] train: loss=0.8769 acc=75.03% | val: loss=0.7040 acc=55.42% f1=69.92% auc=60.87% val_score=51.8183 val_score_bestthr=63.6770 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.188, mb=0.504, no=0.994, corr=-0.319) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 63.6770
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1144 mb_mean=0.5045 norm_overlap=0.9928 corr_cb=-0.3076 topkJ=0.0134
[TRAIN][ep=028] loss=0.8324 acc=76.24%
[TRAIN][ep=028] mask_avg: mc_mean=0.1820 mb_mean=0.5039 norm_overlap=0.9938 corr_cb=-0.3144
[EPOCH 028/089] train: loss=0.8324 acc=76.24% | val: loss=0.7347 acc=61.45% f1=69.81% auc=60.52% val_score=54.4903 val_score_bestthr=61.3072 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.182, mb=0.504, no=0.994, corr=-0.314) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 61.3072
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2286 mb_mean=0.5067 norm_overlap=0.9909 corr_cb=-0.4781 topkJ=0.0024
[TRAIN][ep=029] loss=0.8293 acc=76.38%
[TRAIN][ep=029] mask_avg: mc_mean=0.2075 mb_mean=0.5039 norm_overlap=0.9938 corr_cb=-0.3363
[EPOCH 029/089] train: loss=0.8293 acc=76.38% | val: loss=0.7384 acc=62.65% f1=69.31% auc=60.58% val_score=57.5388 val_score_bestthr=59.6610 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.208, mb=0.504, no=0.994, corr=-0.336) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.6610
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2121 mb_mean=0.5046 norm_overlap=0.9940 corr_cb=-0.3449 topkJ=0.0063
[TRAIN][ep=030] loss=0.8152 acc=75.97%
[TRAIN][ep=030] mask_avg: mc_mean=0.2271 mb_mean=0.5039 norm_overlap=0.9938 corr_cb=-0.3523
[EPOCH 030/089] train: loss=0.8152 acc=75.97% | val: loss=0.7412 acc=63.86% f1=70.59% auc=61.45% val_score=56.9614 val_score_bestthr=59.1015 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.227, mb=0.504, no=0.994, corr=-0.352) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.1015
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2233 mb_mean=0.5031 norm_overlap=0.9962 corr_cb=-0.2445 topkJ=0.0178
[TRAIN][ep=031] loss=0.8128 acc=75.44%
[TRAIN][ep=031] mask_avg: mc_mean=0.2170 mb_mean=0.5039 norm_overlap=0.9937 corr_cb=-0.3426
[EPOCH 031/089] train: loss=0.8128 acc=75.44% | val: loss=0.7964 acc=63.86% f1=69.39% auc=62.27% val_score=51.4486 val_score_bestthr=60.3247 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.217, mb=0.504, no=0.994, corr=-0.343) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 60.3247
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2318 mb_mean=0.5042 norm_overlap=0.9946 corr_cb=-0.3301 topkJ=0.0099
[TRAIN][ep=032] loss=0.8407 acc=73.69%
[TRAIN][ep=032] mask_avg: mc_mean=0.1938 mb_mean=0.5039 norm_overlap=0.9934 corr_cb=-0.3340
[EPOCH 032/089] train: loss=0.8407 acc=73.69% | val: loss=0.7375 acc=62.65% f1=69.31% auc=62.15% val_score=57.0189 val_score_bestthr=59.6610 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.194, mb=0.504, no=0.993, corr=-0.334) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.6610
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2128 mb_mean=0.5032 norm_overlap=0.9904 corr_cb=-0.3991 topkJ=0.0144
[TRAIN][ep=033] loss=0.8050 acc=75.97%
[TRAIN][ep=033] mask_avg: mc_mean=0.2097 mb_mean=0.5039 norm_overlap=0.9936 corr_cb=-0.3370
[EPOCH 033/089] train: loss=0.8050 acc=75.97% | val: loss=0.8238 acc=57.83% f1=69.57% auc=61.80% val_score=50.4830 val_score_bestthr=61.2042 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.210, mb=0.504, no=0.994, corr=-0.337) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 61.2042
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2541 mb_mean=0.5013 norm_overlap=0.9947 corr_cb=-0.3279 topkJ=0.0175
[TRAIN][ep=034] loss=0.7965 acc=77.58%
[TRAIN][ep=034] mask_avg: mc_mean=0.2148 mb_mean=0.5039 norm_overlap=0.9936 corr_cb=-0.3400
[EPOCH 034/089] train: loss=0.7965 acc=77.58% | val: loss=0.7814 acc=61.45% f1=68.00% auc=61.57% val_score=42.7877 val_score_bestthr=57.6713 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.215, mb=0.504, no=0.994, corr=-0.340) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 57.6713
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2082 mb_mean=0.5009 norm_overlap=0.9913 corr_cb=-0.4019 topkJ=0.0068
[TRAIN][ep=035] loss=0.7963 acc=76.91%
[TRAIN][ep=035] mask_avg: mc_mean=0.2204 mb_mean=0.5039 norm_overlap=0.9936 corr_cb=-0.3424
[EPOCH 035/089] train: loss=0.7963 acc=76.91% | val: loss=0.7655 acc=62.65% f1=69.90% auc=61.80% val_score=57.0189 val_score_bestthr=57.9939 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.220, mb=0.504, no=0.994, corr=-0.342) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 57.9939
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2053 mb_mean=0.5038 norm_overlap=0.9978 corr_cb=-0.1334 topkJ=0.0301
[TRAIN][ep=036] loss=0.8099 acc=76.38%
[TRAIN][ep=036] mask_avg: mc_mean=0.1866 mb_mean=0.5039 norm_overlap=0.9934 corr_cb=-0.3106
[EPOCH 036/089] train: loss=0.8099 acc=76.38% | val: loss=0.7484 acc=56.63% f1=70.00% auc=63.20% val_score=57.0189 val_score_bestthr=60.2971 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.187, mb=0.504, no=0.993, corr=-0.311) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 60.2971
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.2761 mb_mean=0.5037 norm_overlap=0.9944 corr_cb=-0.3240 topkJ=0.0111
[TRAIN][ep=037] loss=0.7727 acc=77.45%
[TRAIN][ep=037] mask_avg: mc_mean=0.2325 mb_mean=0.5039 norm_overlap=0.9938 corr_cb=-0.3389
[EPOCH 037/089] train: loss=0.7727 acc=77.45% | val: loss=0.7556 acc=60.24% f1=70.27% auc=63.55% val_score=57.4803 val_score_bestthr=59.5101 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.233, mb=0.504, no=0.994, corr=-0.339) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.5101
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2232 mb_mean=0.5034 norm_overlap=0.9940 corr_cb=-0.3407 topkJ=0.0166
[TRAIN][ep=038] loss=0.7706 acc=78.39%
[TRAIN][ep=038] mask_avg: mc_mean=0.2547 mb_mean=0.5039 norm_overlap=0.9940 corr_cb=-0.3498
[EPOCH 038/089] train: loss=0.7706 acc=78.39% | val: loss=0.8050 acc=60.24% f1=61.18% auc=63.14% val_score=47.2604 val_score_bestthr=58.2151 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.255, mb=0.504, no=0.994, corr=-0.350) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 58.2151
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2639 mb_mean=0.5021 norm_overlap=0.9963 corr_cb=-0.2203 topkJ=0.0163
[TRAIN][ep=039] loss=0.7599 acc=80.00%
[TRAIN][ep=039] mask_avg: mc_mean=0.2331 mb_mean=0.5039 norm_overlap=0.9938 corr_cb=-0.3441
[EPOCH 039/089] train: loss=0.7599 acc=80.00% | val: loss=0.8343 acc=57.83% f1=69.57% auc=63.02% val_score=55.7259 val_score_bestthr=61.2042 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.233, mb=0.504, no=0.994, corr=-0.344) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 61.2042
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.2089 mb_mean=0.5045 norm_overlap=0.9932 corr_cb=-0.3944 topkJ=0.0148
[TRAIN][ep=040] loss=0.7522 acc=80.67%
[TRAIN][ep=040] mask_avg: mc_mean=0.2076 mb_mean=0.5039 norm_overlap=0.9938 corr_cb=-0.3125
[EPOCH 040/089] train: loss=0.7522 acc=80.67% | val: loss=0.7828 acc=60.24% f1=70.27% auc=64.01% val_score=58.2236 val_score_bestthr=59.5101 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.208, mb=0.504, no=0.994, corr=-0.313) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.5101
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.1706 mb_mean=0.5043 norm_overlap=0.9953 corr_cb=-0.2408 topkJ=0.0195
[TRAIN][ep=041] loss=0.7586 acc=80.27%
[TRAIN][ep=041] mask_avg: mc_mean=0.2612 mb_mean=0.5039 norm_overlap=0.9941 corr_cb=-0.3462
[EPOCH 041/089] train: loss=0.7586 acc=80.27% | val: loss=0.8376 acc=61.45% f1=68.00% auc=63.90% val_score=53.5705 val_score_bestthr=57.6713 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.261, mb=0.504, no=0.994, corr=-0.346) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 57.6713
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.2933 mb_mean=0.5033 norm_overlap=0.9952 corr_cb=-0.2937 topkJ=0.0240
[TRAIN][ep=042] loss=0.7587 acc=78.79%
[TRAIN][ep=042] mask_avg: mc_mean=0.2067 mb_mean=0.5039 norm_overlap=0.9939 corr_cb=-0.3125
[EPOCH 042/089] train: loss=0.7587 acc=78.79% | val: loss=0.7874 acc=59.04% f1=69.64% auc=63.95% val_score=57.6745 val_score_bestthr=59.5312 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.207, mb=0.504, no=0.994, corr=-0.312) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.5312
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.2140 mb_mean=0.5044 norm_overlap=0.9938 corr_cb=-0.3566 topkJ=0.0175
[TRAIN][ep=043] loss=0.7244 acc=81.34%
[TRAIN][ep=043] mask_avg: mc_mean=0.2302 mb_mean=0.5039 norm_overlap=0.9939 corr_cb=-0.3340
[EPOCH 043/089] train: loss=0.7244 acc=81.34% | val: loss=0.8410 acc=62.65% f1=68.69% auc=64.42% val_score=56.3238 val_score_bestthr=59.2472 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.230, mb=0.504, no=0.994, corr=-0.334) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.2472
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.1945 mb_mean=0.5091 norm_overlap=0.9953 corr_cb=-0.2973 topkJ=0.0184
[TRAIN][ep=044] loss=0.7626 acc=78.93%
[TRAIN][ep=044] mask_avg: mc_mean=0.2367 mb_mean=0.5039 norm_overlap=0.9940 corr_cb=-0.3280
[EPOCH 044/089] train: loss=0.7626 acc=78.93% | val: loss=0.8013 acc=60.24% f1=69.72% auc=63.60% val_score=54.1599 val_score_bestthr=63.6022 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.237, mb=0.504, no=0.994, corr=-0.328) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 63.6022
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2361 mb_mean=0.5010 norm_overlap=0.9934 corr_cb=-0.3441 topkJ=0.0260
[TRAIN][ep=045] loss=0.7192 acc=81.74%
[TRAIN][ep=045] mask_avg: mc_mean=0.2474 mb_mean=0.5039 norm_overlap=0.9940 corr_cb=-0.3355
[EPOCH 045/089] train: loss=0.7192 acc=81.74% | val: loss=0.8368 acc=59.04% f1=69.64% auc=65.58% val_score=57.3360 val_score_bestthr=59.5312 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.247, mb=0.504, no=0.994, corr=-0.335) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.5312
[EARLY STOP] no improvement for 30 epochs. best_epoch=15
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
=============== FIT DONE ===============
[BEST] epoch=15 | val_acc=57.83% | val_f1=71.07% | val_auc=57.44% | val_score=49.8362 | val_score_bestthr=65.1044
[TEST@BEST] thr_used=0.640 | acc=65.22% f1=67.57% auc=68.40% | SP_sex=0.56% EO_sex=4.76% SP_age=18.22% EO_age=19.41%
[TIME] 1.34 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/summary_fold_1.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4855 mb_mean=0.5049 norm_overlap=1.0000 corr_cb=0.0473 topkJ=0.1080
[TRAIN][ep=000] loss=0.6948 acc=48.99%
[TRAIN][ep=000] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1097
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4906 mb_mean=0.5028 norm_overlap=1.0002 corr_cb=0.3495 topkJ=0.0900
[TRAIN][ep=001] loss=0.6923 acc=51.95%
[TRAIN][ep=001] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1148
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4863 mb_mean=0.5023 norm_overlap=1.0001 corr_cb=0.0850 topkJ=0.0855
[TRAIN][ep=002] loss=0.6921 acc=53.15%
[TRAIN][ep=002] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1042
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4827 mb_mean=0.5045 norm_overlap=1.0001 corr_cb=0.1327 topkJ=0.1111
[TRAIN][ep=003] loss=0.6889 acc=54.36%
[TRAIN][ep=003] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1168
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4839 mb_mean=0.5059 norm_overlap=1.0001 corr_cb=0.1207 topkJ=0.1266
[TRAIN][ep=004] loss=0.6880 acc=54.50%
[TRAIN][ep=004] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1129
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4874 mb_mean=0.5023 norm_overlap=1.0001 corr_cb=0.2085 topkJ=0.0997
[TRAIN][ep=005] loss=0.6863 acc=55.17%
[TRAIN][ep=005] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1147
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4933 mb_mean=0.5052 norm_overlap=1.0001 corr_cb=0.1915 topkJ=0.0991
[TRAIN][ep=006] loss=0.6834 acc=57.85%
[TRAIN][ep=006] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1051
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4811 mb_mean=0.5022 norm_overlap=1.0001 corr_cb=0.1599 topkJ=0.1247
[TRAIN][ep=007] loss=0.6773 acc=58.39%
[TRAIN][ep=007] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1165
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4923 mb_mean=0.5061 norm_overlap=1.0000 corr_cb=-0.0490 topkJ=0.0591
[TRAIN][ep=008] loss=0.6750 acc=60.54%
[TRAIN][ep=008] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1064
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4885 mb_mean=0.5031 norm_overlap=1.0001 corr_cb=0.1442 topkJ=0.0897
[TRAIN][ep=009] loss=0.6778 acc=56.38%
[TRAIN][ep=009] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1185
================= FIT START (fold=1) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4904 mb_mean=0.5056 norm_overlap=1.0001 corr_cb=0.1620 topkJ=0.1007
[TRAIN][ep=000] loss=0.6655 acc=62.55%
[TRAIN][ep=000] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1145
[EPOCH 000/089] train: loss=0.6655 acc=62.55% | val: loss=0.6955 acc=60.24% f1=70.27% auc=56.34% val_score=40.0230 val_score_bestthr=63.4778 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.115) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 63.4778
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4891 mb_mean=0.5036 norm_overlap=1.0002 corr_cb=0.2700 topkJ=0.1255
[TRAIN][ep=001] loss=0.6582 acc=62.55%
[TRAIN][ep=001] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1127
[EPOCH 001/089] train: loss=0.6582 acc=62.55% | val: loss=0.6829 acc=60.24% f1=67.33% auc=56.34% val_score=59.5215 val_score_bestthr=63.1139 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.113) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.4778 -> 63.1139
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4874 mb_mean=0.5035 norm_overlap=1.0000 corr_cb=0.0912 topkJ=0.0898
[TRAIN][ep=002] loss=0.6501 acc=64.03%
[TRAIN][ep=002] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1172
[EPOCH 002/089] train: loss=0.6501 acc=64.03% | val: loss=0.6854 acc=60.24% f1=67.33% auc=56.16% val_score=59.5215 val_score_bestthr=63.1139 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.117) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.4778 -> 63.1139
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4901 mb_mean=0.5043 norm_overlap=1.0001 corr_cb=0.1890 topkJ=0.1067
[TRAIN][ep=003] loss=0.6427 acc=64.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1173
[EPOCH 003/089] train: loss=0.6427 acc=64.70% | val: loss=0.6899 acc=59.04% f1=66.67% auc=56.57% val_score=60.3480 val_score_bestthr=61.6101 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.117) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.4778 -> 61.6101
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4879 mb_mean=0.5014 norm_overlap=1.0004 corr_cb=0.5752 topkJ=0.1843
[TRAIN][ep=004] loss=0.6386 acc=63.36%
[TRAIN][ep=004] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1096
[EPOCH 004/089] train: loss=0.6386 acc=63.36% | val: loss=0.6863 acc=60.24% f1=67.33% auc=55.64% val_score=59.3002 val_score_bestthr=63.1139 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.110) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.4778 -> 63.1139
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4909 mb_mean=0.5055 norm_overlap=1.0002 corr_cb=0.3822 topkJ=0.1455
[TRAIN][ep=005] loss=1.2554 acc=63.49%
[TRAIN][ep=005] mask_avg: mc_mean=0.3769 mb_mean=0.5039 norm_overlap=1.0003 corr_cb=0.1128
[EPOCH 005/089] train: loss=1.2554 acc=63.49% | val: loss=0.6818 acc=61.45% f1=68.63% auc=56.69% val_score=54.4018 val_score_bestthr=63.2603 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.377, mb=0.504, no=1.000, corr=0.113) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.4778 -> 63.2603
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2782 mb_mean=0.5027 norm_overlap=1.0025 corr_cb=0.4429 topkJ=0.1501
[TRAIN][ep=006] loss=1.0230 acc=65.64%
[TRAIN][ep=006] mask_avg: mc_mean=0.2642 mb_mean=0.5039 norm_overlap=1.0006 corr_cb=0.1091
[EPOCH 006/089] train: loss=1.0230 acc=65.64% | val: loss=0.6845 acc=59.04% f1=66.67% auc=56.57% val_score=49.9994 val_score_bestthr=61.7970 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.264, mb=0.504, no=1.001, corr=0.109) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.4778 -> 61.7970
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2443 mb_mean=0.5043 norm_overlap=1.0011 corr_cb=0.1531 topkJ=0.1190
[TRAIN][ep=007] loss=0.8217 acc=66.04%
[TRAIN][ep=007] mask_avg: mc_mean=0.2313 mb_mean=0.5039 norm_overlap=1.0006 corr_cb=0.0849
[EPOCH 007/089] train: loss=0.8217 acc=66.04% | val: loss=0.6884 acc=59.04% f1=68.52% auc=56.98% val_score=44.1744 val_score_bestthr=62.9799 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.231, mb=0.504, no=1.001, corr=0.085) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.4778 -> 62.9799
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2368 mb_mean=0.5056 norm_overlap=1.0001 corr_cb=0.0150 topkJ=0.0937
[TRAIN][ep=008] loss=0.7683 acc=67.65%
[TRAIN][ep=008] mask_avg: mc_mean=0.2073 mb_mean=0.5039 norm_overlap=1.0005 corr_cb=0.0634
[EPOCH 008/089] train: loss=0.7683 acc=67.65% | val: loss=0.6886 acc=60.24% f1=67.96% auc=56.57% val_score=57.6140 val_score_bestthr=61.4940 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.207, mb=0.504, no=1.001, corr=0.063) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.4778 -> 61.4940
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1947 mb_mean=0.5044 norm_overlap=1.0004 corr_cb=0.0426 topkJ=0.0753
[TRAIN][ep=009] loss=0.7648 acc=66.58%
[TRAIN][ep=009] mask_avg: mc_mean=0.1988 mb_mean=0.5039 norm_overlap=1.0003 corr_cb=0.0341
[EPOCH 009/089] train: loss=0.7648 acc=66.58% | val: loss=0.6920 acc=59.04% f1=68.52% auc=56.40% val_score=55.5121 val_score_bestthr=62.3690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.199, mb=0.504, no=1.000, corr=0.034) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.4778 -> 62.3690
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1949 mb_mean=0.5054 norm_overlap=1.0000 corr_cb=0.0027 topkJ=0.0499
[TRAIN][ep=010] loss=0.7701 acc=66.44%
[TRAIN][ep=010] mask_avg: mc_mean=0.1875 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.0068
[EPOCH 010/089] train: loss=0.7701 acc=66.44% | val: loss=0.6880 acc=57.83% f1=67.89% auc=57.44% val_score=57.2010 val_score_bestthr=61.2699 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.188, mb=0.504, no=1.000, corr=0.007) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.4778 -> 61.2699
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.2069 mb_mean=0.5045 norm_overlap=1.0004 corr_cb=0.0388 topkJ=0.0685
[TRAIN][ep=011] loss=0.7631 acc=67.11%
[TRAIN][ep=011] mask_avg: mc_mean=0.1946 mb_mean=0.5039 norm_overlap=0.9996 corr_cb=-0.0383
[EPOCH 011/089] train: loss=0.7631 acc=67.11% | val: loss=0.7014 acc=59.04% f1=67.31% auc=58.02% val_score=43.6693 val_score_bestthr=60.0348 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.195, mb=0.504, no=1.000, corr=-0.038) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.4778 -> 60.0348
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1880 mb_mean=0.5042 norm_overlap=1.0003 corr_cb=0.0337 topkJ=0.0782
[TRAIN][ep=012] loss=0.7549 acc=67.52%
[TRAIN][ep=012] mask_avg: mc_mean=0.1811 mb_mean=0.5039 norm_overlap=0.9993 corr_cb=-0.0685
[EPOCH 012/089] train: loss=0.7549 acc=67.52% | val: loss=0.7124 acc=60.24% f1=66.67% auc=57.73% val_score=39.4189 val_score_bestthr=63.5614 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.181, mb=0.504, no=0.999, corr=-0.069) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 63.4778 -> 63.5614
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.2089 mb_mean=0.5031 norm_overlap=0.9981 corr_cb=-0.2065 topkJ=0.0621
[TRAIN][ep=013] loss=0.8245 acc=68.59%
[TRAIN][ep=013] mask_avg: mc_mean=0.1843 mb_mean=0.5039 norm_overlap=0.9987 corr_cb=-0.1178
[EPOCH 013/089] train: loss=0.8245 acc=68.59% | val: loss=0.7022 acc=59.04% f1=68.52% auc=57.85% val_score=45.1414 val_score_bestthr=62.3690 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.184, mb=0.504, no=0.999, corr=-0.118) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.5614 -> 62.3690
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1878 mb_mean=0.5017 norm_overlap=0.9967 corr_cb=-0.2436 topkJ=0.0545
[TRAIN][ep=014] loss=0.9069 acc=67.52%
[TRAIN][ep=014] mask_avg: mc_mean=0.1829 mb_mean=0.5039 norm_overlap=0.9984 corr_cb=-0.1414
[EPOCH 014/089] train: loss=0.9069 acc=67.52% | val: loss=0.6967 acc=59.04% f1=67.31% auc=58.31% val_score=55.5840 val_score_bestthr=61.9467 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.183, mb=0.504, no=0.998, corr=-0.141) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.5614 -> 61.9467
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1507 mb_mean=0.5031 norm_overlap=0.9976 corr_cb=-0.1917 topkJ=0.0517
[TRAIN][ep=015] loss=0.9712 acc=69.66%
[TRAIN][ep=015] mask_avg: mc_mean=0.1663 mb_mean=0.5039 norm_overlap=0.9979 corr_cb=-0.1653
[EPOCH 015/089] train: loss=0.9712 acc=69.66% | val: loss=0.7482 acc=57.83% f1=71.07% auc=57.38% val_score=49.8362 val_score_bestthr=65.1044 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.166, mb=0.504, no=0.998, corr=-0.165) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 63.5614 -> 65.1044
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1580 mb_mean=0.5045 norm_overlap=0.9963 corr_cb=-0.3017 topkJ=0.0202
[TRAIN][ep=016] loss=1.0369 acc=71.14%
[TRAIN][ep=016] mask_avg: mc_mean=0.1703 mb_mean=0.5039 norm_overlap=0.9974 corr_cb=-0.2006
[EPOCH 016/089] train: loss=1.0369 acc=71.14% | val: loss=0.6950 acc=62.65% f1=69.31% auc=58.60% val_score=57.3788 val_score_bestthr=62.3366 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.170, mb=0.504, no=0.997, corr=-0.201) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 62.3366
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.2112 mb_mean=0.5056 norm_overlap=0.9971 corr_cb=-0.2489 topkJ=0.0227
[TRAIN][ep=017] loss=1.1106 acc=71.54%
[TRAIN][ep=017] mask_avg: mc_mean=0.1728 mb_mean=0.5039 norm_overlap=0.9967 corr_cb=-0.2361
[EPOCH 017/089] train: loss=1.1106 acc=71.54% | val: loss=0.6980 acc=62.65% f1=69.31% auc=58.37% val_score=57.3788 val_score_bestthr=62.3366 | dyn(w_pfs=0.240, w_sup=0.240, w_csuf=0.200, stage2=False) | mask(mc=0.173, mb=0.504, no=0.997, corr=-0.236) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 62.3366
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1999 mb_mean=0.5031 norm_overlap=0.9964 corr_cb=-0.2810 topkJ=0.0383
[TRAIN][ep=018] loss=1.1351 acc=69.66%
[TRAIN][ep=018] mask_avg: mc_mean=0.1824 mb_mean=0.5039 norm_overlap=0.9962 corr_cb=-0.2675
[EPOCH 018/089] train: loss=1.1351 acc=69.66% | val: loss=0.6942 acc=57.83% f1=71.07% auc=59.30% val_score=55.4888 val_score_bestthr=65.1044 | dyn(w_pfs=0.280, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.182, mb=0.504, no=0.996, corr=-0.267) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 65.1044
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1341 mb_mean=0.4993 norm_overlap=0.9948 corr_cb=-0.3120 topkJ=0.0211
[TRAIN][ep=019] loss=1.1266 acc=71.68%
[TRAIN][ep=019] mask_avg: mc_mean=0.1983 mb_mean=0.5039 norm_overlap=0.9958 corr_cb=-0.2943
[EPOCH 019/089] train: loss=1.1266 acc=71.68% | val: loss=0.7142 acc=62.65% f1=69.31% auc=59.36% val_score=34.7326 val_score_bestthr=62.3366 | dyn(w_pfs=0.320, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.198, mb=0.504, no=0.996, corr=-0.294) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 62.3366
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1862 mb_mean=0.5035 norm_overlap=0.9971 corr_cb=-0.2068 topkJ=0.0300
[TRAIN][ep=020] loss=1.1358 acc=71.14%
[TRAIN][ep=020] mask_avg: mc_mean=0.1995 mb_mean=0.5039 norm_overlap=0.9954 corr_cb=-0.3088
[EPOCH 020/089] train: loss=1.1358 acc=71.14% | val: loss=0.7033 acc=62.65% f1=68.69% auc=59.19% val_score=47.1990 val_score_bestthr=60.5893 | dyn(w_pfs=0.220, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.200, mb=0.504, no=0.995, corr=-0.309) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 60.5893
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.1910 mb_mean=0.5031 norm_overlap=0.9942 corr_cb=-0.4096 topkJ=0.0070
[TRAIN][ep=021] loss=0.9334 acc=72.08%
[TRAIN][ep=021] mask_avg: mc_mean=0.1954 mb_mean=0.5039 norm_overlap=0.9951 corr_cb=-0.3105
[EPOCH 021/089] train: loss=0.9334 acc=72.08% | val: loss=0.7101 acc=62.65% f1=69.31% auc=59.07% val_score=41.2637 val_score_bestthr=62.3366 | dyn(w_pfs=0.120, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.195, mb=0.504, no=0.995, corr=-0.311) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 62.3366
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2204 mb_mean=0.5056 norm_overlap=0.9916 corr_cb=-0.4770 topkJ=0.0032
[TRAIN][ep=022] loss=0.7306 acc=71.95%
[TRAIN][ep=022] mask_avg: mc_mean=0.1924 mb_mean=0.5039 norm_overlap=0.9947 corr_cb=-0.3164
[EPOCH 022/089] train: loss=0.7306 acc=71.95% | val: loss=0.7157 acc=63.86% f1=68.75% auc=59.30% val_score=54.2711 val_score_bestthr=59.7060 | dyn(w_pfs=0.020, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.192, mb=0.504, no=0.995, corr=-0.316) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.7060
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1853 mb_mean=0.5049 norm_overlap=0.9943 corr_cb=-0.3560 topkJ=0.0180
[TRAIN][ep=023] loss=0.6916 acc=73.96%
[TRAIN][ep=023] mask_avg: mc_mean=0.2158 mb_mean=0.5039 norm_overlap=0.9946 corr_cb=-0.3404
[EPOCH 023/089] train: loss=0.6916 acc=73.96% | val: loss=0.7441 acc=57.83% f1=70.59% auc=59.42% val_score=51.6757 val_score_bestthr=60.6955 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.216, mb=0.504, no=0.995, corr=-0.340) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 60.6955
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1514 mb_mean=0.5040 norm_overlap=0.9948 corr_cb=-0.2540 topkJ=0.0191
[TRAIN][ep=024] loss=0.6741 acc=73.69%
[TRAIN][ep=024] mask_avg: mc_mean=0.1904 mb_mean=0.5039 norm_overlap=0.9942 corr_cb=-0.3224
[EPOCH 024/089] train: loss=0.6741 acc=73.69% | val: loss=0.7124 acc=56.63% f1=69.49% auc=59.71% val_score=51.5646 val_score_bestthr=59.8573 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.504, no=0.994, corr=-0.322) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.8573
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1900 mb_mean=0.5015 norm_overlap=0.9954 corr_cb=-0.3069 topkJ=0.0132
[TRAIN][ep=025] loss=0.6647 acc=75.30%
[TRAIN][ep=025] mask_avg: mc_mean=0.2141 mb_mean=0.5039 norm_overlap=0.9941 corr_cb=-0.3473
[EPOCH 025/089] train: loss=0.6647 acc=75.30% | val: loss=0.7217 acc=61.45% f1=68.63% auc=59.30% val_score=53.6901 val_score_bestthr=59.6743 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.214, mb=0.504, no=0.994, corr=-0.347) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.6743
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2195 mb_mean=0.5035 norm_overlap=0.9964 corr_cb=-0.2284 topkJ=0.0325
[TRAIN][ep=026] loss=0.6632 acc=73.42%
[TRAIN][ep=026] mask_avg: mc_mean=0.2060 mb_mean=0.5039 norm_overlap=0.9939 corr_cb=-0.3406
[EPOCH 026/089] train: loss=0.6632 acc=73.42% | val: loss=0.7384 acc=63.86% f1=70.00% auc=60.52% val_score=48.4732 val_score_bestthr=62.3254 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.206, mb=0.504, no=0.994, corr=-0.341) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 62.3254
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2095 mb_mean=0.5061 norm_overlap=0.9911 corr_cb=-0.4565 topkJ=0.0048
[TRAIN][ep=027] loss=0.6850 acc=74.90%
[TRAIN][ep=027] mask_avg: mc_mean=0.1906 mb_mean=0.5039 norm_overlap=0.9938 corr_cb=-0.3278
[EPOCH 027/089] train: loss=0.6850 acc=74.90% | val: loss=0.7096 acc=55.42% f1=69.92% auc=60.17% val_score=57.1226 val_score_bestthr=63.6770 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.191, mb=0.504, no=0.994, corr=-0.328) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 63.6770
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1204 mb_mean=0.5045 norm_overlap=0.9925 corr_cb=-0.3248 topkJ=0.0121
[TRAIN][ep=028] loss=0.6470 acc=76.51%
[TRAIN][ep=028] mask_avg: mc_mean=0.1856 mb_mean=0.5039 norm_overlap=0.9936 corr_cb=-0.3241
[EPOCH 028/089] train: loss=0.6470 acc=76.51% | val: loss=0.7419 acc=61.45% f1=69.81% auc=60.52% val_score=55.1161 val_score_bestthr=61.3072 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.186, mb=0.504, no=0.994, corr=-0.324) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 61.3072
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2282 mb_mean=0.5067 norm_overlap=0.9906 corr_cb=-0.4832 topkJ=0.0024
[TRAIN][ep=029] loss=0.6458 acc=76.38%
[TRAIN][ep=029] mask_avg: mc_mean=0.2086 mb_mean=0.5039 norm_overlap=0.9936 corr_cb=-0.3430
[EPOCH 029/089] train: loss=0.6458 acc=76.38% | val: loss=0.7419 acc=62.65% f1=69.31% auc=60.17% val_score=52.8520 val_score_bestthr=59.6610 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.209, mb=0.504, no=0.994, corr=-0.343) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.6610
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2085 mb_mean=0.5046 norm_overlap=0.9938 corr_cb=-0.3457 topkJ=0.0055
[TRAIN][ep=030] loss=0.6336 acc=76.24%
[TRAIN][ep=030] mask_avg: mc_mean=0.2268 mb_mean=0.5039 norm_overlap=0.9936 corr_cb=-0.3583
[EPOCH 030/089] train: loss=0.6336 acc=76.24% | val: loss=0.7482 acc=55.42% f1=69.92% auc=60.87% val_score=56.7926 val_score_bestthr=63.6770 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.227, mb=0.504, no=0.994, corr=-0.358) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 63.6770
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2295 mb_mean=0.5031 norm_overlap=0.9961 corr_cb=-0.2536 topkJ=0.0162
[TRAIN][ep=031] loss=0.6318 acc=75.70%
[TRAIN][ep=031] mask_avg: mc_mean=0.2192 mb_mean=0.5039 norm_overlap=0.9935 corr_cb=-0.3502
[EPOCH 031/089] train: loss=0.6318 acc=75.70% | val: loss=0.7986 acc=62.65% f1=68.04% auc=61.74% val_score=47.1839 val_score_bestthr=58.3290 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.219, mb=0.504, no=0.994, corr=-0.350) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 58.3290
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2344 mb_mean=0.5042 norm_overlap=0.9945 corr_cb=-0.3377 topkJ=0.0095
[TRAIN][ep=032] loss=0.6596 acc=74.23%
[TRAIN][ep=032] mask_avg: mc_mean=0.1958 mb_mean=0.5039 norm_overlap=0.9932 corr_cb=-0.3413
[EPOCH 032/089] train: loss=0.6596 acc=74.23% | val: loss=0.7447 acc=62.65% f1=69.31% auc=61.80% val_score=57.0189 val_score_bestthr=59.6610 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.196, mb=0.504, no=0.993, corr=-0.341) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.6610
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2124 mb_mean=0.5032 norm_overlap=0.9903 corr_cb=-0.4000 topkJ=0.0144
[TRAIN][ep=033] loss=0.6284 acc=76.24%
[TRAIN][ep=033] mask_avg: mc_mean=0.2085 mb_mean=0.5039 norm_overlap=0.9934 corr_cb=-0.3421
[EPOCH 033/089] train: loss=0.6284 acc=76.24% | val: loss=0.8334 acc=56.63% f1=68.97% auc=61.40% val_score=50.9998 val_score_bestthr=58.9895 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.209, mb=0.504, no=0.993, corr=-0.342) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 58.9895
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2522 mb_mean=0.5013 norm_overlap=0.9944 corr_cb=-0.3387 topkJ=0.0171
[TRAIN][ep=034] loss=0.6187 acc=77.45%
[TRAIN][ep=034] mask_avg: mc_mean=0.2157 mb_mean=0.5039 norm_overlap=0.9934 corr_cb=-0.3462
[EPOCH 034/089] train: loss=0.6187 acc=77.45% | val: loss=0.7830 acc=55.42% f1=68.38% auc=61.22% val_score=49.0643 val_score_bestthr=57.8962 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.216, mb=0.504, no=0.993, corr=-0.346) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 57.8962
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2073 mb_mean=0.5009 norm_overlap=0.9910 corr_cb=-0.4109 topkJ=0.0068
[TRAIN][ep=035] loss=0.6177 acc=77.18%
[TRAIN][ep=035] mask_avg: mc_mean=0.2202 mb_mean=0.5039 norm_overlap=0.9935 corr_cb=-0.3482
[EPOCH 035/089] train: loss=0.6177 acc=77.18% | val: loss=0.7717 acc=55.42% f1=69.42% auc=61.05% val_score=57.0189 val_score_bestthr=59.5125 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.220, mb=0.504, no=0.993, corr=-0.348) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.5125
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2037 mb_mean=0.5038 norm_overlap=0.9977 corr_cb=-0.1357 topkJ=0.0301
[TRAIN][ep=036] loss=0.6332 acc=76.38%
[TRAIN][ep=036] mask_avg: mc_mean=0.1871 mb_mean=0.5039 norm_overlap=0.9933 corr_cb=-0.3158
[EPOCH 036/089] train: loss=0.6332 acc=76.38% | val: loss=0.7545 acc=56.63% f1=70.00% auc=62.50% val_score=56.9513 val_score_bestthr=60.2971 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.187, mb=0.504, no=0.993, corr=-0.316) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 60.2971
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.2753 mb_mean=0.5037 norm_overlap=0.9943 corr_cb=-0.3205 topkJ=0.0107
[TRAIN][ep=037] loss=0.5961 acc=78.12%
[TRAIN][ep=037] mask_avg: mc_mean=0.2353 mb_mean=0.5039 norm_overlap=0.9937 corr_cb=-0.3458
[EPOCH 037/089] train: loss=0.5961 acc=78.12% | val: loss=0.7654 acc=56.63% f1=70.00% auc=62.73% val_score=53.3307 val_score_bestthr=60.2971 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.235, mb=0.504, no=0.994, corr=-0.346) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 60.2971
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2254 mb_mean=0.5034 norm_overlap=0.9938 corr_cb=-0.3517 topkJ=0.0170
[TRAIN][ep=038] loss=0.5913 acc=78.93%
[TRAIN][ep=038] mask_avg: mc_mean=0.2529 mb_mean=0.5039 norm_overlap=0.9938 corr_cb=-0.3557
[EPOCH 038/089] train: loss=0.5913 acc=78.93% | val: loss=0.8056 acc=60.24% f1=61.18% auc=62.97% val_score=57.3360 val_score_bestthr=58.2151 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.253, mb=0.504, no=0.994, corr=-0.356) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 58.2151
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2618 mb_mean=0.5021 norm_overlap=0.9962 corr_cb=-0.2267 topkJ=0.0155
[TRAIN][ep=039] loss=0.5856 acc=79.60%
[TRAIN][ep=039] mask_avg: mc_mean=0.2328 mb_mean=0.5039 norm_overlap=0.9937 corr_cb=-0.3502
[EPOCH 039/089] train: loss=0.5856 acc=79.60% | val: loss=0.8468 acc=60.24% f1=70.27% auc=63.08% val_score=49.7456 val_score_bestthr=62.7556 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.233, mb=0.504, no=0.994, corr=-0.350) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 62.7556
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.2124 mb_mean=0.5045 norm_overlap=0.9931 corr_cb=-0.4026 topkJ=0.0156
[TRAIN][ep=040] loss=0.5761 acc=80.94%
[TRAIN][ep=040] mask_avg: mc_mean=0.2092 mb_mean=0.5039 norm_overlap=0.9937 corr_cb=-0.3194
[EPOCH 040/089] train: loss=0.5761 acc=80.94% | val: loss=0.7925 acc=57.83% f1=60.67% auc=62.67% val_score=58.2151 val_score_bestthr=58.2881 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.209, mb=0.504, no=0.994, corr=-0.319) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 58.2881
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.1704 mb_mean=0.5043 norm_overlap=0.9952 corr_cb=-0.2445 topkJ=0.0187
[TRAIN][ep=041] loss=0.5872 acc=80.00%
[TRAIN][ep=041] mask_avg: mc_mean=0.2576 mb_mean=0.5039 norm_overlap=0.9939 corr_cb=-0.3510
[EPOCH 041/089] train: loss=0.5872 acc=80.00% | val: loss=0.8477 acc=59.04% f1=59.52% auc=63.78% val_score=50.1156 val_score_bestthr=58.7331 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.258, mb=0.504, no=0.994, corr=-0.351) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 58.7331
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.2926 mb_mean=0.5033 norm_overlap=0.9951 corr_cb=-0.3002 topkJ=0.0240
[TRAIN][ep=042] loss=0.5870 acc=79.33%
[TRAIN][ep=042] mask_avg: mc_mean=0.2030 mb_mean=0.5039 norm_overlap=0.9937 corr_cb=-0.3155
[EPOCH 042/089] train: loss=0.5870 acc=79.33% | val: loss=0.7979 acc=56.63% f1=70.00% auc=63.60% val_score=57.6745 val_score_bestthr=60.2971 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.203, mb=0.504, no=0.994, corr=-0.316) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 60.2971
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.2078 mb_mean=0.5044 norm_overlap=0.9937 corr_cb=-0.3559 topkJ=0.0175
[TRAIN][ep=043] loss=0.5507 acc=80.67%
[TRAIN][ep=043] mask_avg: mc_mean=0.2279 mb_mean=0.5039 norm_overlap=0.9937 corr_cb=-0.3396
[EPOCH 043/089] train: loss=0.5507 acc=80.67% | val: loss=0.8460 acc=60.24% f1=61.18% auc=64.30% val_score=54.9538 val_score_bestthr=58.2151 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.228, mb=0.504, no=0.994, corr=-0.340) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 58.2151
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.1983 mb_mean=0.5091 norm_overlap=0.9951 corr_cb=-0.3061 topkJ=0.0160
[TRAIN][ep=044] loss=0.5788 acc=79.33%
[TRAIN][ep=044] mask_avg: mc_mean=0.2283 mb_mean=0.5039 norm_overlap=0.9939 corr_cb=-0.3292
[EPOCH 044/089] train: loss=0.5788 acc=79.33% | val: loss=0.8197 acc=62.65% f1=50.79% auc=63.55% val_score=55.6672 val_score_bestthr=58.0457 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.228, mb=0.504, no=0.994, corr=-0.329) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 58.0457
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2437 mb_mean=0.5010 norm_overlap=0.9931 corr_cb=-0.3661 topkJ=0.0221
[TRAIN][ep=045] loss=0.5462 acc=81.88%
[TRAIN][ep=045] mask_avg: mc_mean=0.2468 mb_mean=0.5039 norm_overlap=0.9939 corr_cb=-0.3402
[EPOCH 045/089] train: loss=0.5462 acc=81.88% | val: loss=0.8456 acc=61.45% f1=58.97% auc=65.17% val_score=57.3360 val_score_bestthr=60.0545 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.247, mb=0.504, no=0.994, corr=-0.340) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 60.0545
[EARLY STOP] no improvement for 30 epochs. best_epoch=15
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
=============== FIT DONE ===============
[BEST] epoch=15 | val_acc=57.83% | val_f1=71.07% | val_auc=57.38% | val_score=49.8362 | val_score_bestthr=65.1044
[TEST@BEST] thr_used=0.640 | acc=66.18% f1=68.47% auc=68.58% | SP_sex=0.56% EO_sex=5.86% SP_age=18.22% EO_age=21.79%
[TIME] 1.18 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/summary_fold_1.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4855 mb_mean=0.5049 norm_overlap=1.0000 corr_cb=0.0473 topkJ=0.1080
[TRAIN][ep=000] loss=0.6948 acc=48.99%
[TRAIN][ep=000] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1097
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4906 mb_mean=0.5028 norm_overlap=1.0002 corr_cb=0.3495 topkJ=0.0900
[TRAIN][ep=001] loss=0.6923 acc=51.95%
[TRAIN][ep=001] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1148
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4863 mb_mean=0.5023 norm_overlap=1.0001 corr_cb=0.0850 topkJ=0.0855
[TRAIN][ep=002] loss=0.6921 acc=53.15%
[TRAIN][ep=002] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1042
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4827 mb_mean=0.5045 norm_overlap=1.0001 corr_cb=0.1327 topkJ=0.1111
[TRAIN][ep=003] loss=0.6889 acc=54.36%
[TRAIN][ep=003] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1168
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4839 mb_mean=0.5059 norm_overlap=1.0001 corr_cb=0.1207 topkJ=0.1266
[TRAIN][ep=004] loss=0.6880 acc=54.50%
[TRAIN][ep=004] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1129
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4874 mb_mean=0.5023 norm_overlap=1.0001 corr_cb=0.2085 topkJ=0.0997
[TRAIN][ep=005] loss=0.6863 acc=55.17%
[TRAIN][ep=005] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1147
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4933 mb_mean=0.5052 norm_overlap=1.0001 corr_cb=0.1915 topkJ=0.0991
[TRAIN][ep=006] loss=0.6834 acc=57.85%
[TRAIN][ep=006] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1051
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4811 mb_mean=0.5022 norm_overlap=1.0001 corr_cb=0.1599 topkJ=0.1247
[TRAIN][ep=007] loss=0.6773 acc=58.39%
[TRAIN][ep=007] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1165
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4923 mb_mean=0.5061 norm_overlap=1.0000 corr_cb=-0.0490 topkJ=0.0591
[TRAIN][ep=008] loss=0.6750 acc=60.54%
[TRAIN][ep=008] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1064
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4885 mb_mean=0.5031 norm_overlap=1.0001 corr_cb=0.1442 topkJ=0.0897
[TRAIN][ep=009] loss=0.6778 acc=56.38%
[TRAIN][ep=009] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1185
================= FIT START (fold=1) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4904 mb_mean=0.5056 norm_overlap=1.0001 corr_cb=0.1620 topkJ=0.1007
[TRAIN][ep=000] loss=0.6654 acc=62.55%
[TRAIN][ep=000] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1145
[EPOCH 000/089] train: loss=0.6654 acc=62.55% | val: loss=0.6954 acc=59.04% f1=66.67% auc=56.34% val_score=40.0230 val_score_bestthr=61.6101 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.115) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 61.6101
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4891 mb_mean=0.5036 norm_overlap=1.0002 corr_cb=0.2700 topkJ=0.1255
[TRAIN][ep=001] loss=0.6582 acc=62.42%
[TRAIN][ep=001] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1127
[EPOCH 001/089] train: loss=0.6582 acc=62.42% | val: loss=0.6829 acc=60.24% f1=67.33% auc=56.34% val_score=59.5215 val_score_bestthr=63.1139 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.113) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 61.6101 -> 63.1139
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4874 mb_mean=0.5035 norm_overlap=1.0000 corr_cb=0.0912 topkJ=0.0898
[TRAIN][ep=002] loss=0.6501 acc=64.03%
[TRAIN][ep=002] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1172
[EPOCH 002/089] train: loss=0.6501 acc=64.03% | val: loss=0.6854 acc=60.24% f1=67.33% auc=56.10% val_score=59.5215 val_score_bestthr=63.1139 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.117) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.1139 -> 63.1139
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4901 mb_mean=0.5043 norm_overlap=1.0001 corr_cb=0.1890 topkJ=0.1067
[TRAIN][ep=003] loss=0.6427 acc=64.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1173
[EPOCH 003/089] train: loss=0.6427 acc=64.70% | val: loss=0.6899 acc=59.04% f1=66.67% auc=56.51% val_score=60.3480 val_score_bestthr=61.6101 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.117) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.1139 -> 61.6101
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4879 mb_mean=0.5014 norm_overlap=1.0004 corr_cb=0.5752 topkJ=0.1843
[TRAIN][ep=004] loss=0.6385 acc=63.36%
[TRAIN][ep=004] mask_avg: mc_mean=0.4881 mb_mean=0.5039 norm_overlap=1.0001 corr_cb=0.1096
[EPOCH 004/089] train: loss=0.6385 acc=63.36% | val: loss=0.6864 acc=60.24% f1=67.33% auc=55.58% val_score=59.3002 val_score_bestthr=63.1139 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.488, mb=0.504, no=1.000, corr=0.110) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.1139 -> 63.1139
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4909 mb_mean=0.5055 norm_overlap=1.0002 corr_cb=0.3822 topkJ=0.1455
[TRAIN][ep=005] loss=1.3755 acc=63.49%
[TRAIN][ep=005] mask_avg: mc_mean=0.3766 mb_mean=0.5039 norm_overlap=1.0003 corr_cb=0.1127
[EPOCH 005/089] train: loss=1.3755 acc=63.49% | val: loss=0.6813 acc=61.45% f1=68.63% auc=56.74% val_score=54.4018 val_score_bestthr=63.2603 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.377, mb=0.504, no=1.000, corr=0.113) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 63.1139 -> 63.2603
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2776 mb_mean=0.5027 norm_overlap=1.0025 corr_cb=0.4427 topkJ=0.1511
[TRAIN][ep=006] loss=1.3472 acc=64.83%
[TRAIN][ep=006] mask_avg: mc_mean=0.2628 mb_mean=0.5039 norm_overlap=1.0006 corr_cb=0.1093
[EPOCH 006/089] train: loss=1.3472 acc=64.83% | val: loss=0.6830 acc=60.24% f1=67.96% auc=56.63% val_score=49.9994 val_score_bestthr=61.4940 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.263, mb=0.504, no=1.001, corr=0.109) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2603 -> 61.4940
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2427 mb_mean=0.5043 norm_overlap=1.0011 corr_cb=0.1527 topkJ=0.1159
[TRAIN][ep=007] loss=1.3470 acc=65.64%
[TRAIN][ep=007] mask_avg: mc_mean=0.2290 mb_mean=0.5039 norm_overlap=1.0006 corr_cb=0.0865
[EPOCH 007/089] train: loss=1.3470 acc=65.64% | val: loss=0.6861 acc=60.24% f1=67.96% auc=56.80% val_score=44.7424 val_score_bestthr=61.4940 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.229, mb=0.504, no=1.001, corr=0.087) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2603 -> 61.4940
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2314 mb_mean=0.5056 norm_overlap=1.0002 corr_cb=0.0207 topkJ=0.0937
[TRAIN][ep=008] loss=1.3257 acc=67.92%
[TRAIN][ep=008] mask_avg: mc_mean=0.2026 mb_mean=0.5039 norm_overlap=1.0006 corr_cb=0.0679
[EPOCH 008/089] train: loss=1.3257 acc=67.92% | val: loss=0.6851 acc=60.24% f1=67.96% auc=56.69% val_score=57.5264 val_score_bestthr=61.4940 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.203, mb=0.504, no=1.001, corr=0.068) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2603 -> 61.4940
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1893 mb_mean=0.5044 norm_overlap=1.0004 corr_cb=0.0489 topkJ=0.0739
[TRAIN][ep=009] loss=1.3185 acc=67.38%
[TRAIN][ep=009] mask_avg: mc_mean=0.1952 mb_mean=0.5039 norm_overlap=1.0004 corr_cb=0.0426
[EPOCH 009/089] train: loss=1.3185 acc=67.38% | val: loss=0.6880 acc=60.24% f1=67.96% auc=57.09% val_score=58.4619 val_score_bestthr=61.4940 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.195, mb=0.504, no=1.000, corr=0.043) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2603 -> 61.4940
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1944 mb_mean=0.5054 norm_overlap=1.0001 corr_cb=0.0136 topkJ=0.0499
[TRAIN][ep=010] loss=1.3258 acc=65.77%
[TRAIN][ep=010] mask_avg: mc_mean=0.1847 mb_mean=0.5039 norm_overlap=1.0002 corr_cb=0.0180
[EPOCH 010/089] train: loss=1.3258 acc=65.77% | val: loss=0.6854 acc=60.24% f1=65.98% auc=57.73% val_score=57.3443 val_score_bestthr=59.3547 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.185, mb=0.504, no=1.000, corr=0.018) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.2603 -> 59.3547
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.2030 mb_mean=0.5045 norm_overlap=1.0005 corr_cb=0.0532 topkJ=0.0722
[TRAIN][ep=011] loss=1.1261 acc=67.92%
[TRAIN][ep=011] mask_avg: mc_mean=0.1905 mb_mean=0.5039 norm_overlap=0.9998 corr_cb=-0.0226
[EPOCH 011/089] train: loss=1.1261 acc=67.92% | val: loss=0.7037 acc=61.45% f1=68.63% auc=57.62% val_score=41.4213 val_score_bestthr=63.5151 | dyn(w_pfs=0.290, w_sup=0.190, w_csuf=0.140, stage2=False) | mask(mc=0.190, mb=0.504, no=1.000, corr=-0.023) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 63.2603 -> 63.5151
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1843 mb_mean=0.5042 norm_overlap=1.0005 corr_cb=0.0497 topkJ=0.0859
[TRAIN][ep=012] loss=1.1929 acc=66.98%
[TRAIN][ep=012] mask_avg: mc_mean=0.1788 mb_mean=0.5039 norm_overlap=0.9995 corr_cb=-0.0529
[EPOCH 012/089] train: loss=1.1929 acc=66.98% | val: loss=0.7082 acc=61.45% f1=68.63% auc=57.79% val_score=38.8095 val_score_bestthr=63.5151 | dyn(w_pfs=0.330, w_sup=0.230, w_csuf=0.180, stage2=False) | mask(mc=0.179, mb=0.504, no=0.999, corr=-0.053) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.5151 -> 63.5151
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.2017 mb_mean=0.5031 norm_overlap=0.9982 corr_cb=-0.1868 topkJ=0.0694
[TRAIN][ep=013] loss=1.2554 acc=69.40%
[TRAIN][ep=013] mask_avg: mc_mean=0.1811 mb_mean=0.5039 norm_overlap=0.9989 corr_cb=-0.1011
[EPOCH 013/089] train: loss=1.2554 acc=69.40% | val: loss=0.7029 acc=59.04% f1=68.52% auc=57.79% val_score=42.8525 val_score_bestthr=62.3690 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.181, mb=0.504, no=0.999, corr=-0.101) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.5151 -> 62.3690
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1860 mb_mean=0.5017 norm_overlap=0.9969 corr_cb=-0.2301 topkJ=0.0571
[TRAIN][ep=014] loss=1.2983 acc=68.19%
[TRAIN][ep=014] mask_avg: mc_mean=0.1822 mb_mean=0.5039 norm_overlap=0.9986 corr_cb=-0.1255
[EPOCH 014/089] train: loss=1.2983 acc=68.19% | val: loss=0.6958 acc=59.04% f1=67.31% auc=58.20% val_score=55.5840 val_score_bestthr=61.9467 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.182, mb=0.504, no=0.999, corr=-0.125) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.5151 -> 61.9467
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1509 mb_mean=0.5031 norm_overlap=0.9979 corr_cb=-0.1767 topkJ=0.0547
[TRAIN][ep=015] loss=1.2814 acc=70.47%
[TRAIN][ep=015] mask_avg: mc_mean=0.1679 mb_mean=0.5039 norm_overlap=0.9981 corr_cb=-0.1520
[EPOCH 015/089] train: loss=1.2814 acc=70.47% | val: loss=0.7512 acc=57.83% f1=71.07% auc=57.33% val_score=49.8362 val_score_bestthr=65.1044 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.168, mb=0.504, no=0.998, corr=-0.152) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 63.5151 -> 65.1044
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1588 mb_mean=0.5045 norm_overlap=0.9965 corr_cb=-0.2880 topkJ=0.0239
[TRAIN][ep=016] loss=1.2681 acc=71.68%
[TRAIN][ep=016] mask_avg: mc_mean=0.1708 mb_mean=0.5039 norm_overlap=0.9976 corr_cb=-0.1857
[EPOCH 016/089] train: loss=1.2681 acc=71.68% | val: loss=0.6962 acc=61.45% f1=68.00% auc=58.72% val_score=56.8202 val_score_bestthr=60.2281 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.171, mb=0.504, no=0.998, corr=-0.186) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 60.2281
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.2116 mb_mean=0.5056 norm_overlap=0.9973 corr_cb=-0.2309 topkJ=0.0244
[TRAIN][ep=017] loss=1.2641 acc=71.54%
[TRAIN][ep=017] mask_avg: mc_mean=0.1744 mb_mean=0.5039 norm_overlap=0.9970 corr_cb=-0.2229
[EPOCH 017/089] train: loss=1.2641 acc=71.54% | val: loss=0.7002 acc=62.65% f1=69.31% auc=58.26% val_score=57.3788 val_score_bestthr=62.3366 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.174, mb=0.504, no=0.997, corr=-0.223) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 62.3366
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.2007 mb_mean=0.5031 norm_overlap=0.9967 corr_cb=-0.2667 topkJ=0.0404
[TRAIN][ep=018] loss=1.2721 acc=69.66%
[TRAIN][ep=018] mask_avg: mc_mean=0.1813 mb_mean=0.5039 norm_overlap=0.9965 corr_cb=-0.2519
[EPOCH 018/089] train: loss=1.2721 acc=69.66% | val: loss=0.6962 acc=57.83% f1=71.07% auc=59.42% val_score=55.4778 val_score_bestthr=65.1044 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.181, mb=0.504, no=0.996, corr=-0.252) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 65.1044
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1306 mb_mean=0.4993 norm_overlap=0.9952 corr_cb=-0.2942 topkJ=0.0219
[TRAIN][ep=019] loss=1.2526 acc=71.95%
[TRAIN][ep=019] mask_avg: mc_mean=0.1944 mb_mean=0.5039 norm_overlap=0.9961 corr_cb=-0.2794
[EPOCH 019/089] train: loss=1.2526 acc=71.95% | val: loss=0.7161 acc=62.65% f1=69.31% auc=59.24% val_score=34.7326 val_score_bestthr=62.3366 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.194, mb=0.504, no=0.996, corr=-0.279) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 62.3366
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1845 mb_mean=0.5035 norm_overlap=0.9974 corr_cb=-0.1876 topkJ=0.0325
[TRAIN][ep=020] loss=1.2490 acc=72.21%
[TRAIN][ep=020] mask_avg: mc_mean=0.1996 mb_mean=0.5039 norm_overlap=0.9957 corr_cb=-0.2999
[EPOCH 020/089] train: loss=1.2490 acc=72.21% | val: loss=0.7059 acc=62.65% f1=68.69% auc=59.07% val_score=48.7053 val_score_bestthr=60.5893 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.200, mb=0.504, no=0.996, corr=-0.300) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 60.5893
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.1901 mb_mean=0.5031 norm_overlap=0.9945 corr_cb=-0.4005 topkJ=0.0082
[TRAIN][ep=021] loss=1.0538 acc=72.08%
[TRAIN][ep=021] mask_avg: mc_mean=0.1955 mb_mean=0.5039 norm_overlap=0.9954 corr_cb=-0.3026
[EPOCH 021/089] train: loss=1.0538 acc=72.08% | val: loss=0.7105 acc=62.65% f1=69.31% auc=59.01% val_score=44.3074 val_score_bestthr=62.3366 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.195, mb=0.504, no=0.995, corr=-0.303) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 62.3366
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2196 mb_mean=0.5056 norm_overlap=0.9920 corr_cb=-0.4709 topkJ=0.0039
[TRAIN][ep=022] loss=0.8557 acc=72.62%
[TRAIN][ep=022] mask_avg: mc_mean=0.1938 mb_mean=0.5039 norm_overlap=0.9950 corr_cb=-0.3092
[EPOCH 022/089] train: loss=0.8557 acc=72.62% | val: loss=0.7170 acc=62.65% f1=69.31% auc=59.30% val_score=49.2104 val_score_bestthr=62.3366 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.194, mb=0.504, no=0.995, corr=-0.309) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 62.3366
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1856 mb_mean=0.5049 norm_overlap=0.9946 corr_cb=-0.3480 topkJ=0.0176
[TRAIN][ep=023] loss=0.8207 acc=73.96%
[TRAIN][ep=023] mask_avg: mc_mean=0.2153 mb_mean=0.5039 norm_overlap=0.9948 corr_cb=-0.3331
[EPOCH 023/089] train: loss=0.8207 acc=73.96% | val: loss=0.7429 acc=57.83% f1=70.59% auc=59.59% val_score=51.6757 val_score_bestthr=60.6955 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.215, mb=0.504, no=0.995, corr=-0.333) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 60.6955
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1529 mb_mean=0.5040 norm_overlap=0.9950 corr_cb=-0.2479 topkJ=0.0199
[TRAIN][ep=024] loss=0.7949 acc=73.69%
[TRAIN][ep=024] mask_avg: mc_mean=0.1902 mb_mean=0.5039 norm_overlap=0.9945 corr_cb=-0.3151
[EPOCH 024/089] train: loss=0.7949 acc=73.69% | val: loss=0.7132 acc=56.63% f1=69.49% auc=60.00% val_score=51.5646 val_score_bestthr=59.8573 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.504, no=0.994, corr=-0.315) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.8573
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1877 mb_mean=0.5015 norm_overlap=0.9955 corr_cb=-0.3016 topkJ=0.0140
[TRAIN][ep=025] loss=0.7849 acc=75.44%
[TRAIN][ep=025] mask_avg: mc_mean=0.2114 mb_mean=0.5039 norm_overlap=0.9943 corr_cb=-0.3391
[EPOCH 025/089] train: loss=0.7849 acc=75.44% | val: loss=0.7213 acc=61.45% f1=68.63% auc=59.48% val_score=53.7023 val_score_bestthr=59.6743 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.211, mb=0.504, no=0.994, corr=-0.339) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.6743
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2174 mb_mean=0.5035 norm_overlap=0.9967 corr_cb=-0.2146 topkJ=0.0337
[TRAIN][ep=026] loss=0.7832 acc=73.56%
[TRAIN][ep=026] mask_avg: mc_mean=0.2043 mb_mean=0.5039 norm_overlap=0.9941 corr_cb=-0.3324
[EPOCH 026/089] train: loss=0.7832 acc=73.56% | val: loss=0.7384 acc=63.86% f1=70.00% auc=60.70% val_score=51.6655 val_score_bestthr=62.3254 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.204, mb=0.504, no=0.994, corr=-0.332) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 62.3254
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2079 mb_mean=0.5061 norm_overlap=0.9913 corr_cb=-0.4537 topkJ=0.0052
[TRAIN][ep=027] loss=0.8075 acc=74.90%
[TRAIN][ep=027] mask_avg: mc_mean=0.1901 mb_mean=0.5039 norm_overlap=0.9941 corr_cb=-0.3207
[EPOCH 027/089] train: loss=0.8075 acc=74.90% | val: loss=0.7089 acc=55.42% f1=69.92% auc=60.29% val_score=53.0481 val_score_bestthr=63.6770 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.504, no=0.994, corr=-0.321) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 63.6770
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1177 mb_mean=0.5045 norm_overlap=0.9928 corr_cb=-0.3125 topkJ=0.0125
[TRAIN][ep=028] loss=0.7668 acc=76.51%
[TRAIN][ep=028] mask_avg: mc_mean=0.1841 mb_mean=0.5039 norm_overlap=0.9938 corr_cb=-0.3164
[EPOCH 028/089] train: loss=0.7668 acc=76.51% | val: loss=0.7400 acc=61.45% f1=69.81% auc=60.35% val_score=55.7103 val_score_bestthr=61.3072 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.184, mb=0.504, no=0.994, corr=-0.316) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 61.3072
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2273 mb_mean=0.5067 norm_overlap=0.9909 corr_cb=-0.4790 topkJ=0.0028
[TRAIN][ep=029] loss=0.7651 acc=76.51%
[TRAIN][ep=029] mask_avg: mc_mean=0.2063 mb_mean=0.5039 norm_overlap=0.9938 corr_cb=-0.3361
[EPOCH 029/089] train: loss=0.7651 acc=76.51% | val: loss=0.7422 acc=62.65% f1=69.31% auc=60.29% val_score=53.0215 val_score_bestthr=59.6610 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.206, mb=0.504, no=0.994, corr=-0.336) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.6610
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2120 mb_mean=0.5046 norm_overlap=0.9940 corr_cb=-0.3443 topkJ=0.0066
[TRAIN][ep=030] loss=0.7523 acc=76.11%
[TRAIN][ep=030] mask_avg: mc_mean=0.2273 mb_mean=0.5039 norm_overlap=0.9938 corr_cb=-0.3527
[EPOCH 030/089] train: loss=0.7523 acc=76.11% | val: loss=0.7466 acc=63.86% f1=70.59% auc=61.22% val_score=56.9614 val_score_bestthr=59.1015 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.227, mb=0.504, no=0.994, corr=-0.353) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.1015
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2247 mb_mean=0.5031 norm_overlap=0.9961 corr_cb=-0.2475 topkJ=0.0178
[TRAIN][ep=031] loss=0.7507 acc=75.44%
[TRAIN][ep=031] mask_avg: mc_mean=0.2175 mb_mean=0.5039 norm_overlap=0.9937 corr_cb=-0.3434
[EPOCH 031/089] train: loss=0.7507 acc=75.44% | val: loss=0.7980 acc=62.65% f1=68.69% auc=61.92% val_score=48.1422 val_score_bestthr=60.3347 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.218, mb=0.504, no=0.994, corr=-0.343) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 60.3347
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2309 mb_mean=0.5042 norm_overlap=0.9946 corr_cb=-0.3296 topkJ=0.0108
[TRAIN][ep=032] loss=0.7775 acc=73.83%
[TRAIN][ep=032] mask_avg: mc_mean=0.1951 mb_mean=0.5039 norm_overlap=0.9934 corr_cb=-0.3355
[EPOCH 032/089] train: loss=0.7775 acc=73.83% | val: loss=0.7428 acc=61.45% f1=68.63% auc=61.74% val_score=57.0189 val_score_bestthr=59.6743 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.195, mb=0.504, no=0.993, corr=-0.335) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.6743
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2117 mb_mean=0.5032 norm_overlap=0.9904 corr_cb=-0.3979 topkJ=0.0148
[TRAIN][ep=033] loss=0.7444 acc=75.97%
[TRAIN][ep=033] mask_avg: mc_mean=0.2080 mb_mean=0.5039 norm_overlap=0.9936 corr_cb=-0.3366
[EPOCH 033/089] train: loss=0.7444 acc=75.97% | val: loss=0.8285 acc=56.63% f1=68.97% auc=61.57% val_score=50.9998 val_score_bestthr=58.9895 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.208, mb=0.504, no=0.994, corr=-0.337) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 58.9895
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2491 mb_mean=0.5013 norm_overlap=0.9946 corr_cb=-0.3312 topkJ=0.0171
[TRAIN][ep=034] loss=0.7343 acc=77.72%
[TRAIN][ep=034] mask_avg: mc_mean=0.2158 mb_mean=0.5039 norm_overlap=0.9936 corr_cb=-0.3412
[EPOCH 034/089] train: loss=0.7343 acc=77.72% | val: loss=0.7851 acc=55.42% f1=68.38% auc=61.10% val_score=44.2896 val_score_bestthr=57.8962 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.216, mb=0.504, no=0.994, corr=-0.341) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 57.8962
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2079 mb_mean=0.5009 norm_overlap=0.9913 corr_cb=-0.4020 topkJ=0.0064
[TRAIN][ep=035] loss=0.7342 acc=77.45%
[TRAIN][ep=035] mask_avg: mc_mean=0.2189 mb_mean=0.5039 norm_overlap=0.9937 corr_cb=-0.3423
[EPOCH 035/089] train: loss=0.7342 acc=77.45% | val: loss=0.7714 acc=62.65% f1=69.90% auc=61.22% val_score=57.0189 val_score_bestthr=57.9939 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.219, mb=0.504, no=0.994, corr=-0.342) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 57.9939
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2059 mb_mean=0.5038 norm_overlap=0.9978 corr_cb=-0.1331 topkJ=0.0314
[TRAIN][ep=036] loss=0.7494 acc=76.11%
[TRAIN][ep=036] mask_avg: mc_mean=0.1885 mb_mean=0.5039 norm_overlap=0.9935 corr_cb=-0.3120
[EPOCH 036/089] train: loss=0.7494 acc=76.11% | val: loss=0.7534 acc=56.63% f1=70.00% auc=62.15% val_score=56.9513 val_score_bestthr=60.2971 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.189, mb=0.504, no=0.993, corr=-0.312) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 60.2971
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.2748 mb_mean=0.5037 norm_overlap=0.9944 corr_cb=-0.3219 topkJ=0.0111
[TRAIN][ep=037] loss=0.7107 acc=77.72%
[TRAIN][ep=037] mask_avg: mc_mean=0.2334 mb_mean=0.5039 norm_overlap=0.9938 corr_cb=-0.3400
[EPOCH 037/089] train: loss=0.7107 acc=77.72% | val: loss=0.7610 acc=56.63% f1=70.00% auc=63.31% val_score=54.9920 val_score_bestthr=60.2971 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.233, mb=0.504, no=0.994, corr=-0.340) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 60.2971
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2232 mb_mean=0.5034 norm_overlap=0.9940 corr_cb=-0.3405 topkJ=0.0170
[TRAIN][ep=038] loss=0.7088 acc=78.66%
[TRAIN][ep=038] mask_avg: mc_mean=0.2528 mb_mean=0.5039 norm_overlap=0.9940 corr_cb=-0.3503
[EPOCH 038/089] train: loss=0.7088 acc=78.66% | val: loss=0.8084 acc=60.24% f1=61.18% auc=63.14% val_score=46.3574 val_score_bestthr=58.2151 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.253, mb=0.504, no=0.994, corr=-0.350) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 58.2151
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2633 mb_mean=0.5021 norm_overlap=0.9963 corr_cb=-0.2250 topkJ=0.0163
[TRAIN][ep=039] loss=0.6991 acc=80.13%
[TRAIN][ep=039] mask_avg: mc_mean=0.2327 mb_mean=0.5039 norm_overlap=0.9938 corr_cb=-0.3445
[EPOCH 039/089] train: loss=0.6991 acc=80.13% | val: loss=0.8409 acc=59.04% f1=69.64% auc=63.14% val_score=55.7259 val_score_bestthr=59.5312 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.233, mb=0.504, no=0.994, corr=-0.344) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 59.5312
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.2114 mb_mean=0.5045 norm_overlap=0.9933 corr_cb=-0.3973 topkJ=0.0152
[TRAIN][ep=040] loss=0.6925 acc=80.13%
[TRAIN][ep=040] mask_avg: mc_mean=0.2068 mb_mean=0.5039 norm_overlap=0.9938 corr_cb=-0.3122
[EPOCH 040/089] train: loss=0.6925 acc=80.13% | val: loss=0.7863 acc=61.45% f1=70.91% auc=63.72% val_score=58.2236 val_score_bestthr=60.6108 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.207, mb=0.504, no=0.994, corr=-0.312) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 60.6108
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.1677 mb_mean=0.5043 norm_overlap=0.9953 corr_cb=-0.2384 topkJ=0.0207
[TRAIN][ep=041] loss=0.6998 acc=80.00%
[TRAIN][ep=041] mask_avg: mc_mean=0.2624 mb_mean=0.5039 norm_overlap=0.9941 corr_cb=-0.3469
[EPOCH 041/089] train: loss=0.6998 acc=80.00% | val: loss=0.8408 acc=59.04% f1=59.52% auc=63.90% val_score=50.1156 val_score_bestthr=58.7331 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.262, mb=0.504, no=0.994, corr=-0.347) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 58.7331
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.2949 mb_mean=0.5033 norm_overlap=0.9953 corr_cb=-0.2952 topkJ=0.0240
[TRAIN][ep=042] loss=0.6984 acc=79.19%
[TRAIN][ep=042] mask_avg: mc_mean=0.2070 mb_mean=0.5039 norm_overlap=0.9939 corr_cb=-0.3134
[EPOCH 042/089] train: loss=0.6984 acc=79.19% | val: loss=0.7934 acc=61.45% f1=68.00% auc=63.72% val_score=57.6745 val_score_bestthr=57.6713 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.207, mb=0.504, no=0.994, corr=-0.313) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 57.6713
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.2127 mb_mean=0.5044 norm_overlap=0.9938 corr_cb=-0.3562 topkJ=0.0171
[TRAIN][ep=043] loss=0.6637 acc=81.61%
[TRAIN][ep=043] mask_avg: mc_mean=0.2300 mb_mean=0.5039 norm_overlap=0.9939 corr_cb=-0.3347
[EPOCH 043/089] train: loss=0.6637 acc=81.61% | val: loss=0.8467 acc=61.45% f1=68.00% auc=64.24% val_score=54.9538 val_score_bestthr=58.9482 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.230, mb=0.504, no=0.994, corr=-0.335) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 58.9482
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.1947 mb_mean=0.5091 norm_overlap=0.9953 corr_cb=-0.2992 topkJ=0.0189
[TRAIN][ep=044] loss=0.7004 acc=78.93%
[TRAIN][ep=044] mask_avg: mc_mean=0.2347 mb_mean=0.5039 norm_overlap=0.9941 corr_cb=-0.3272
[EPOCH 044/089] train: loss=0.7004 acc=78.93% | val: loss=0.8079 acc=59.04% f1=69.09% auc=63.43% val_score=54.1599 val_score_bestthr=61.6781 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.235, mb=0.504, no=0.994, corr=-0.327) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 61.6781
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2359 mb_mean=0.5010 norm_overlap=0.9934 corr_cb=-0.3468 topkJ=0.0252
[TRAIN][ep=045] loss=0.6589 acc=82.15%
[TRAIN][ep=045] mask_avg: mc_mean=0.2462 mb_mean=0.5039 norm_overlap=0.9940 corr_cb=-0.3350
[EPOCH 045/089] train: loss=0.6589 acc=82.15% | val: loss=0.8381 acc=60.24% f1=60.24% auc=65.23% val_score=57.3360 val_score_bestthr=58.7255 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.246, mb=0.504, no=0.994, corr=-0.335) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1044 -> 58.7255
[EARLY STOP] no improvement for 30 epochs. best_epoch=15
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
=============== FIT DONE ===============
[BEST] epoch=15 | val_acc=57.83% | val_f1=71.07% | val_auc=57.33% | val_score=49.8362 | val_score_bestthr=65.1044
[TEST@BEST] thr_used=0.640 | acc=65.70% f1=68.16% auc=68.44% | SP_sex=1.11% EO_sex=5.86% SP_age=18.79% EO_age=21.79%
[TIME] 1.27 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold1_rep0_seed1/summary_fold_1.json
