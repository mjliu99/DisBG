[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4653 mb_mean=0.4746 norm_overlap=1.0000 corr_cb=0.0009 topkJ=0.0721
[TRAIN][ep=000] loss=0.6946 acc=50.20%
[TRAIN][ep=000] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0577
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4666 mb_mean=0.4760 norm_overlap=1.0000 corr_cb=-0.0804 topkJ=0.0394
[TRAIN][ep=001] loss=0.6935 acc=50.87%
[TRAIN][ep=001] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0520
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4641 mb_mean=0.4759 norm_overlap=0.9999 corr_cb=-0.1516 topkJ=0.0427
[TRAIN][ep=002] loss=0.6927 acc=51.81%
[TRAIN][ep=002] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0518
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4682 mb_mean=0.4728 norm_overlap=1.0000 corr_cb=0.0088 topkJ=0.0867
[TRAIN][ep=003] loss=0.6920 acc=52.89%
[TRAIN][ep=003] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0540
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4660 mb_mean=0.4754 norm_overlap=0.9999 corr_cb=-0.2222 topkJ=0.0188
[TRAIN][ep=004] loss=0.6916 acc=53.83%
[TRAIN][ep=004] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0496
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4691 mb_mean=0.4730 norm_overlap=1.0000 corr_cb=-0.0798 topkJ=0.0197
[TRAIN][ep=005] loss=0.6908 acc=53.15%
[TRAIN][ep=005] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0535
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4653 mb_mean=0.4739 norm_overlap=0.9999 corr_cb=-0.2608 topkJ=0.0412
[TRAIN][ep=006] loss=0.6898 acc=55.30%
[TRAIN][ep=006] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0534
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4637 mb_mean=0.4748 norm_overlap=1.0000 corr_cb=0.0031 topkJ=0.0692
[TRAIN][ep=007] loss=0.6894 acc=53.83%
[TRAIN][ep=007] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0487
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4635 mb_mean=0.4737 norm_overlap=1.0000 corr_cb=0.0553 topkJ=0.0628
[TRAIN][ep=008] loss=0.6882 acc=56.91%
[TRAIN][ep=008] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0575
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4622 mb_mean=0.4769 norm_overlap=1.0000 corr_cb=-0.0556 topkJ=0.0226
[TRAIN][ep=009] loss=0.6865 acc=55.03%
[TRAIN][ep=009] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0557
================= FIT START (fold=4) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4686 mb_mean=0.4721 norm_overlap=0.9999 corr_cb=-0.1822 topkJ=0.0197
[TRAIN][ep=000] loss=0.6854 acc=59.46%
[TRAIN][ep=000] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0534
[EPOCH 000/089] train: loss=0.6854 acc=59.46% | val: loss=0.6865 acc=57.83% f1=70.59% auc=56.40% val_score=32.3885 val_score_bestthr=62.5018 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.053) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 62.5018
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/ckpt_best_fold_4.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4665 mb_mean=0.4758 norm_overlap=0.9999 corr_cb=-0.1292 topkJ=0.0478
[TRAIN][ep=001] loss=0.6830 acc=58.93%
[TRAIN][ep=001] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0547
[EPOCH 001/089] train: loss=0.6830 acc=58.93% | val: loss=0.6859 acc=56.63% f1=70.49% auc=56.69% val_score=28.0727 val_score_bestthr=63.4120 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.055) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 62.5018 -> 63.4120
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/ckpt_best_fold_4.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4682 mb_mean=0.4745 norm_overlap=1.0000 corr_cb=0.0238 topkJ=0.0471
[TRAIN][ep=002] loss=0.6833 acc=58.39%
[TRAIN][ep=002] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0516
[EPOCH 002/089] train: loss=0.6833 acc=58.39% | val: loss=0.6841 acc=56.63% f1=70.00% auc=56.16% val_score=51.4275 val_score_bestthr=61.2149 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.052) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.4120 -> 61.2149
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4654 mb_mean=0.4739 norm_overlap=1.0000 corr_cb=0.0819 topkJ=0.0805
[TRAIN][ep=003] loss=0.6807 acc=58.26%
[TRAIN][ep=003] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0531
[EPOCH 003/089] train: loss=0.6807 acc=58.26% | val: loss=0.6835 acc=56.63% f1=70.00% auc=56.57% val_score=48.1042 val_score_bestthr=61.2149 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.053) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.4120 -> 61.2149
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4650 mb_mean=0.4728 norm_overlap=0.9999 corr_cb=-0.1206 topkJ=0.0236
[TRAIN][ep=004] loss=0.6795 acc=59.06%
[TRAIN][ep=004] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0547
[EPOCH 004/089] train: loss=0.6795 acc=59.06% | val: loss=0.6830 acc=55.42% f1=69.42% auc=56.80% val_score=48.5519 val_score_bestthr=60.8841 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.055) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.4120 -> 60.8841
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4674 mb_mean=0.4747 norm_overlap=0.9999 corr_cb=-0.1348 topkJ=0.0317
[TRAIN][ep=005] loss=1.2683 acc=61.07%
[TRAIN][ep=005] mask_avg: mc_mean=0.3648 mb_mean=0.4751 norm_overlap=0.9990 corr_cb=-0.3125
[EPOCH 005/089] train: loss=1.2683 acc=61.07% | val: loss=0.6841 acc=56.63% f1=70.00% auc=57.03% val_score=34.1661 val_score_bestthr=62.1149 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.365, mb=0.475, no=0.999, corr=-0.312) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.4120 -> 62.1149
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2929 mb_mean=0.4698 norm_overlap=0.9974 corr_cb=-0.4634 topkJ=0.0231
[TRAIN][ep=006] loss=1.2566 acc=58.26%
[TRAIN][ep=006] mask_avg: mc_mean=0.2447 mb_mean=0.4751 norm_overlap=0.9976 corr_cb=-0.3510
[EPOCH 006/089] train: loss=1.2566 acc=58.26% | val: loss=0.6908 acc=57.83% f1=70.09% auc=56.34% val_score=43.7627 val_score_bestthr=63.8030 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.245, mb=0.475, no=0.998, corr=-0.351) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 63.4120 -> 63.8030
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/ckpt_best_fold_4.pt
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2484 mb_mean=0.4739 norm_overlap=0.9974 corr_cb=-0.3877 topkJ=0.0100
[TRAIN][ep=007] loss=1.2570 acc=61.74%
[TRAIN][ep=007] mask_avg: mc_mean=0.2032 mb_mean=0.4751 norm_overlap=0.9968 corr_cb=-0.3470
[EPOCH 007/089] train: loss=1.2570 acc=61.74% | val: loss=0.6818 acc=55.42% f1=69.42% auc=57.33% val_score=48.5519 val_score_bestthr=60.8841 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.203, mb=0.475, no=0.997, corr=-0.347) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8030 -> 60.8841
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1800 mb_mean=0.4764 norm_overlap=0.9958 corr_cb=-0.4292 topkJ=0.0192
[TRAIN][ep=008] loss=1.2551 acc=60.54%
[TRAIN][ep=008] mask_avg: mc_mean=0.1838 mb_mean=0.4751 norm_overlap=0.9962 corr_cb=-0.3510
[EPOCH 008/089] train: loss=1.2551 acc=60.54% | val: loss=0.6816 acc=55.42% f1=68.38% auc=57.73% val_score=50.4958 val_score_bestthr=58.0473 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.184, mb=0.475, no=0.996, corr=-0.351) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8030 -> 58.0473
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1410 mb_mean=0.4786 norm_overlap=0.9945 corr_cb=-0.4076 topkJ=0.0077
[TRAIN][ep=009] loss=1.2520 acc=61.88%
[TRAIN][ep=009] mask_avg: mc_mean=0.1701 mb_mean=0.4751 norm_overlap=0.9958 corr_cb=-0.3475
[EPOCH 009/089] train: loss=1.2520 acc=61.88% | val: loss=0.6814 acc=56.63% f1=68.97% auc=58.02% val_score=37.4151 val_score_bestthr=58.8798 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.170, mb=0.475, no=0.996, corr=-0.347) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8030 -> 58.8798
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1937 mb_mean=0.4729 norm_overlap=0.9956 corr_cb=-0.4031 topkJ=0.0077
[TRAIN][ep=010] loss=1.2515 acc=60.13%
[TRAIN][ep=010] mask_avg: mc_mean=0.1623 mb_mean=0.4751 norm_overlap=0.9955 corr_cb=-0.3486
[EPOCH 010/089] train: loss=1.2515 acc=60.13% | val: loss=0.6822 acc=55.42% f1=69.42% auc=56.98% val_score=39.8969 val_score_bestthr=60.8841 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.162, mb=0.475, no=0.995, corr=-0.349) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8030 -> 60.8841
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1537 mb_mean=0.4768 norm_overlap=0.9907 corr_cb=-0.5321 topkJ=0.0016
[TRAIN][ep=011] loss=1.2472 acc=61.61%
[TRAIN][ep=011] mask_avg: mc_mean=0.1559 mb_mean=0.4751 norm_overlap=0.9950 corr_cb=-0.3652
[EPOCH 011/089] train: loss=1.2472 acc=61.61% | val: loss=0.6848 acc=56.63% f1=68.97% auc=57.15% val_score=38.9038 val_score_bestthr=60.9465 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.156, mb=0.475, no=0.995, corr=-0.365) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8030 -> 60.9465
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1447 mb_mean=0.4755 norm_overlap=0.9942 corr_cb=-0.3583 topkJ=0.0239
[TRAIN][ep=012] loss=0.9995 acc=63.22%
[TRAIN][ep=012] mask_avg: mc_mean=0.1521 mb_mean=0.4751 norm_overlap=0.9949 corr_cb=-0.3406
[EPOCH 012/089] train: loss=0.9995 acc=63.22% | val: loss=0.6851 acc=56.63% f1=68.42% auc=57.38% val_score=58.2662 val_score_bestthr=58.2662 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.152, mb=0.475, no=0.995, corr=-0.341) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8030 -> 58.2662
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1475 mb_mean=0.4743 norm_overlap=0.9937 corr_cb=-0.3742 topkJ=0.0148
[TRAIN][ep=013] loss=0.7621 acc=62.42%
[TRAIN][ep=013] mask_avg: mc_mean=0.1432 mb_mean=0.4751 norm_overlap=0.9944 corr_cb=-0.3317
[EPOCH 013/089] train: loss=0.7621 acc=62.42% | val: loss=0.6802 acc=56.63% f1=70.49% auc=57.67% val_score=38.3246 val_score_bestthr=63.4120 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.143, mb=0.475, no=0.994, corr=-0.332) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8030 -> 63.4120
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1590 mb_mean=0.4742 norm_overlap=0.9947 corr_cb=-0.3442 topkJ=0.0191
[TRAIN][ep=014] loss=0.6975 acc=62.15%
[TRAIN][ep=014] mask_avg: mc_mean=0.1462 mb_mean=0.4751 norm_overlap=0.9943 corr_cb=-0.3097
[EPOCH 014/089] train: loss=0.6975 acc=62.15% | val: loss=0.6888 acc=56.63% f1=68.97% auc=56.16% val_score=33.2166 val_score_bestthr=60.9465 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.146, mb=0.475, no=0.994, corr=-0.310) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8030 -> 60.9465
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1867 mb_mean=0.4730 norm_overlap=0.9949 corr_cb=-0.3360 topkJ=0.0158
[TRAIN][ep=015] loss=0.6838 acc=61.34%
[TRAIN][ep=015] mask_avg: mc_mean=0.1500 mb_mean=0.4751 norm_overlap=0.9944 corr_cb=-0.2798
[EPOCH 015/089] train: loss=0.6838 acc=61.34% | val: loss=0.6891 acc=54.22% f1=69.35% auc=56.05% val_score=35.5522 val_score_bestthr=62.5593 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.150, mb=0.475, no=0.994, corr=-0.280) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8030 -> 62.5593
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1627 mb_mean=0.4758 norm_overlap=0.9937 corr_cb=-0.3091 topkJ=0.0104
[TRAIN][ep=016] loss=0.6787 acc=64.56%
[TRAIN][ep=016] mask_avg: mc_mean=0.1571 mb_mean=0.4751 norm_overlap=0.9944 corr_cb=-0.2677
[EPOCH 016/089] train: loss=0.6787 acc=64.56% | val: loss=0.6945 acc=55.42% f1=68.38% auc=55.58% val_score=31.7119 val_score_bestthr=59.8140 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.157, mb=0.475, no=0.994, corr=-0.268) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8030 -> 59.8140
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1494 mb_mean=0.4750 norm_overlap=0.9939 corr_cb=-0.2839 topkJ=0.0182
[TRAIN][ep=017] loss=0.6784 acc=62.55%
[TRAIN][ep=017] mask_avg: mc_mean=0.1594 mb_mean=0.4751 norm_overlap=0.9945 corr_cb=-0.2362
[EPOCH 017/089] train: loss=0.6784 acc=62.55% | val: loss=0.6885 acc=54.22% f1=69.35% auc=56.34% val_score=41.7995 val_score_bestthr=62.5593 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.159, mb=0.475, no=0.995, corr=-0.236) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8030 -> 62.5593
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1277 mb_mean=0.4762 norm_overlap=0.9942 corr_cb=-0.2173 topkJ=0.0205
[TRAIN][ep=018] loss=0.6750 acc=62.55%
[TRAIN][ep=018] mask_avg: mc_mean=0.1615 mb_mean=0.4751 norm_overlap=0.9942 corr_cb=-0.2403
[EPOCH 018/089] train: loss=0.6750 acc=62.55% | val: loss=0.6877 acc=55.42% f1=69.42% auc=56.74% val_score=45.6639 val_score_bestthr=60.8841 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.161, mb=0.475, no=0.994, corr=-0.240) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8030 -> 60.8841
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1349 mb_mean=0.4778 norm_overlap=0.9954 corr_cb=-0.2023 topkJ=0.0243
[TRAIN][ep=019] loss=0.6695 acc=63.09%
[TRAIN][ep=019] mask_avg: mc_mean=0.1681 mb_mean=0.4751 norm_overlap=0.9945 corr_cb=-0.2237
[EPOCH 019/089] train: loss=0.6695 acc=63.09% | val: loss=0.6941 acc=55.42% f1=69.42% auc=56.40% val_score=48.8085 val_score_bestthr=60.8841 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.168, mb=0.475, no=0.994, corr=-0.224) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8030 -> 60.8841
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1512 mb_mean=0.4735 norm_overlap=0.9968 corr_cb=-0.1347 topkJ=0.0218
[TRAIN][ep=020] loss=0.6651 acc=63.36%
[TRAIN][ep=020] mask_avg: mc_mean=0.1610 mb_mean=0.4751 norm_overlap=0.9938 corr_cb=-0.2350
[EPOCH 020/089] train: loss=0.6651 acc=63.36% | val: loss=0.7002 acc=55.42% f1=69.92% auc=55.93% val_score=31.9607 val_score_bestthr=61.9154 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.161, mb=0.475, no=0.994, corr=-0.235) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8030 -> 61.9154
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2117 mb_mean=0.4739 norm_overlap=0.9940 corr_cb=-0.2809 topkJ=0.0233
[TRAIN][ep=021] loss=0.6563 acc=64.43%
[TRAIN][ep=021] mask_avg: mc_mean=0.1782 mb_mean=0.4751 norm_overlap=0.9944 corr_cb=-0.2214
[EPOCH 021/089] train: loss=0.6563 acc=64.43% | val: loss=0.6928 acc=55.42% f1=69.92% auc=56.40% val_score=45.7852 val_score_bestthr=61.9154 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.178, mb=0.475, no=0.994, corr=-0.221) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8030 -> 61.9154
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1969 mb_mean=0.4744 norm_overlap=0.9945 corr_cb=-0.2467 topkJ=0.0141
[TRAIN][ep=022] loss=0.6559 acc=63.76%
[TRAIN][ep=022] mask_avg: mc_mean=0.1958 mb_mean=0.4751 norm_overlap=0.9948 corr_cb=-0.2076
[EPOCH 022/089] train: loss=0.6559 acc=63.76% | val: loss=0.6949 acc=55.42% f1=69.92% auc=57.15% val_score=41.1046 val_score_bestthr=61.9154 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.196, mb=0.475, no=0.995, corr=-0.208) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8030 -> 61.9154
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2082 mb_mean=0.4735 norm_overlap=0.9952 corr_cb=-0.2246 topkJ=0.0370
[TRAIN][ep=023] loss=0.6527 acc=65.64%
[TRAIN][ep=023] mask_avg: mc_mean=0.1904 mb_mean=0.4751 norm_overlap=0.9945 corr_cb=-0.2133
[EPOCH 023/089] train: loss=0.6527 acc=65.64% | val: loss=0.6974 acc=54.22% f1=68.85% auc=57.21% val_score=40.8623 val_score_bestthr=57.0648 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.475, no=0.995, corr=-0.213) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8030 -> 57.0648
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1886 mb_mean=0.4758 norm_overlap=0.9932 corr_cb=-0.2958 topkJ=0.0200
[TRAIN][ep=024] loss=0.6439 acc=66.71%
[TRAIN][ep=024] mask_avg: mc_mean=0.1960 mb_mean=0.4751 norm_overlap=0.9945 corr_cb=-0.2117
[EPOCH 024/089] train: loss=0.6439 acc=66.71% | val: loss=0.7198 acc=55.42% f1=69.92% auc=56.28% val_score=36.4069 val_score_bestthr=61.9154 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.196, mb=0.475, no=0.995, corr=-0.212) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8030 -> 61.9154
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1885 mb_mean=0.4754 norm_overlap=0.9969 corr_cb=-0.1379 topkJ=0.0423
[TRAIN][ep=025] loss=0.6432 acc=65.50%
[TRAIN][ep=025] mask_avg: mc_mean=0.1999 mb_mean=0.4751 norm_overlap=0.9946 corr_cb=-0.2080
[EPOCH 025/089] train: loss=0.6432 acc=65.50% | val: loss=0.6990 acc=55.42% f1=69.92% auc=56.98% val_score=47.2057 val_score_bestthr=61.9154 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.200, mb=0.475, no=0.995, corr=-0.208) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8030 -> 61.9154
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1990 mb_mean=0.4756 norm_overlap=0.9974 corr_cb=-0.1205 topkJ=0.0326
[TRAIN][ep=026] loss=0.6419 acc=64.70%
[TRAIN][ep=026] mask_avg: mc_mean=0.1985 mb_mean=0.4751 norm_overlap=0.9945 corr_cb=-0.2093
[EPOCH 026/089] train: loss=0.6419 acc=64.70% | val: loss=0.7039 acc=55.42% f1=69.92% auc=57.09% val_score=45.8546 val_score_bestthr=61.9154 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.199, mb=0.475, no=0.995, corr=-0.209) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8030 -> 61.9154
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2201 mb_mean=0.4761 norm_overlap=0.9901 corr_cb=-0.3604 topkJ=0.0126
[TRAIN][ep=027] loss=0.6376 acc=65.23%
[TRAIN][ep=027] mask_avg: mc_mean=0.1980 mb_mean=0.4751 norm_overlap=0.9943 corr_cb=-0.2159
[EPOCH 027/089] train: loss=0.6376 acc=65.23% | val: loss=0.6989 acc=55.42% f1=69.42% auc=57.15% val_score=46.6060 val_score_bestthr=58.5609 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.198, mb=0.475, no=0.994, corr=-0.216) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8030 -> 58.5609
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1768 mb_mean=0.4761 norm_overlap=0.9922 corr_cb=-0.2873 topkJ=0.0245
[TRAIN][ep=028] loss=0.6336 acc=66.98%
[TRAIN][ep=028] mask_avg: mc_mean=0.2019 mb_mean=0.4751 norm_overlap=0.9943 corr_cb=-0.2136
[EPOCH 028/089] train: loss=0.6336 acc=66.98% | val: loss=0.7022 acc=55.42% f1=69.42% auc=57.44% val_score=42.6307 val_score_bestthr=58.5609 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.202, mb=0.475, no=0.994, corr=-0.214) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8030 -> 58.5609
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2569 mb_mean=0.4731 norm_overlap=0.9958 corr_cb=-0.1889 topkJ=0.0190
[TRAIN][ep=029] loss=0.6349 acc=66.85%
[TRAIN][ep=029] mask_avg: mc_mean=0.1938 mb_mean=0.4751 norm_overlap=0.9939 corr_cb=-0.2193
[EPOCH 029/089] train: loss=0.6349 acc=66.85% | val: loss=0.7010 acc=55.42% f1=69.42% auc=57.56% val_score=45.4960 val_score_bestthr=58.5609 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.194, mb=0.475, no=0.994, corr=-0.219) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8030 -> 58.5609
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2106 mb_mean=0.4709 norm_overlap=0.9976 corr_cb=-0.1072 topkJ=0.0509
[TRAIN][ep=030] loss=0.6270 acc=66.58%
[TRAIN][ep=030] mask_avg: mc_mean=0.1867 mb_mean=0.4751 norm_overlap=0.9935 corr_cb=-0.2283
[EPOCH 030/089] train: loss=0.6270 acc=66.58% | val: loss=0.7098 acc=54.22% f1=68.85% auc=57.85% val_score=43.7342 val_score_bestthr=57.8426 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.187, mb=0.475, no=0.994, corr=-0.228) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8030 -> 57.8426
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.1897 mb_mean=0.4752 norm_overlap=0.9928 corr_cb=-0.2807 topkJ=0.0303
[TRAIN][ep=031] loss=0.6281 acc=67.11%
[TRAIN][ep=031] mask_avg: mc_mean=0.1978 mb_mean=0.4751 norm_overlap=0.9936 corr_cb=-0.2310
[EPOCH 031/089] train: loss=0.6281 acc=67.11% | val: loss=0.7135 acc=54.22% f1=68.85% auc=57.56% val_score=39.7568 val_score_bestthr=57.8426 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.198, mb=0.475, no=0.994, corr=-0.231) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8030 -> 57.8426
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2061 mb_mean=0.4761 norm_overlap=0.9935 corr_cb=-0.2478 topkJ=0.0132
[TRAIN][ep=032] loss=0.6250 acc=66.31%
[TRAIN][ep=032] mask_avg: mc_mean=0.1904 mb_mean=0.4751 norm_overlap=0.9933 corr_cb=-0.2370
[EPOCH 032/089] train: loss=0.6250 acc=66.31% | val: loss=0.7091 acc=54.22% f1=68.85% auc=59.53% val_score=42.6522 val_score_bestthr=57.0648 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.475, no=0.993, corr=-0.237) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8030 -> 57.0648
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2364 mb_mean=0.4763 norm_overlap=0.9927 corr_cb=-0.2699 topkJ=0.0083
[TRAIN][ep=033] loss=0.6145 acc=67.52%
[TRAIN][ep=033] mask_avg: mc_mean=0.2131 mb_mean=0.4751 norm_overlap=0.9937 corr_cb=-0.2386
[EPOCH 033/089] train: loss=0.6145 acc=67.52% | val: loss=0.7219 acc=54.22% f1=68.85% auc=58.20% val_score=39.7568 val_score_bestthr=57.8426 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.213, mb=0.475, no=0.994, corr=-0.239) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8030 -> 57.8426
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2053 mb_mean=0.4751 norm_overlap=0.9927 corr_cb=-0.2507 topkJ=0.0115
[TRAIN][ep=034] loss=0.6198 acc=67.38%
[TRAIN][ep=034] mask_avg: mc_mean=0.1934 mb_mean=0.4751 norm_overlap=0.9934 corr_cb=-0.2351
[EPOCH 034/089] train: loss=0.6198 acc=67.38% | val: loss=0.7147 acc=54.22% f1=68.85% auc=58.90% val_score=45.0694 val_score_bestthr=57.8426 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.193, mb=0.475, no=0.993, corr=-0.235) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8030 -> 57.8426
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.1888 mb_mean=0.4732 norm_overlap=0.9955 corr_cb=-0.1859 topkJ=0.0213
[TRAIN][ep=035] loss=0.6106 acc=68.32%
[TRAIN][ep=035] mask_avg: mc_mean=0.2073 mb_mean=0.4751 norm_overlap=0.9937 corr_cb=-0.2332
[EPOCH 035/089] train: loss=0.6106 acc=68.32% | val: loss=0.7120 acc=55.42% f1=69.42% auc=59.53% val_score=49.1091 val_score_bestthr=58.5609 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.207, mb=0.475, no=0.994, corr=-0.233) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8030 -> 58.5609
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2596 mb_mean=0.4753 norm_overlap=0.9947 corr_cb=-0.2112 topkJ=0.0149
[TRAIN][ep=036] loss=0.6133 acc=67.79%
[TRAIN][ep=036] mask_avg: mc_mean=0.2185 mb_mean=0.4751 norm_overlap=0.9938 corr_cb=-0.2337
[EPOCH 036/089] train: loss=0.6133 acc=67.79% | val: loss=0.7125 acc=55.42% f1=69.42% auc=59.13% val_score=53.6975 val_score_bestthr=58.5609 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.219, mb=0.475, no=0.994, corr=-0.234) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8030 -> 58.5609
[EARLY STOP] no improvement for 30 epochs. best_epoch=6
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/ckpt_best_fold_4.pt
=============== FIT DONE ===============
[BEST] epoch=6 | val_acc=57.83% | val_f1=70.09% | val_auc=56.34% | val_score=43.7627 | val_score_bestthr=63.8030
[TEST@BEST] thr_used=0.445 | acc=61.35% f1=69.47% auc=64.76% | SP_sex=8.15% EO_sex=8.72% SP_age=9.47% EO_age=13.75%
[TIME] 0.96 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/summary_fold_4.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4653 mb_mean=0.4746 norm_overlap=1.0000 corr_cb=0.0009 topkJ=0.0721
[TRAIN][ep=000] loss=0.6947 acc=50.60%
[TRAIN][ep=000] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0577
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4666 mb_mean=0.4760 norm_overlap=1.0000 corr_cb=-0.0804 topkJ=0.0394
[TRAIN][ep=001] loss=0.6935 acc=50.87%
[TRAIN][ep=001] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0520
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4641 mb_mean=0.4759 norm_overlap=0.9999 corr_cb=-0.1516 topkJ=0.0427
[TRAIN][ep=002] loss=0.6923 acc=51.81%
[TRAIN][ep=002] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0518
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4682 mb_mean=0.4728 norm_overlap=1.0000 corr_cb=0.0088 topkJ=0.0867
[TRAIN][ep=003] loss=0.6912 acc=52.21%
[TRAIN][ep=003] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0540
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4660 mb_mean=0.4754 norm_overlap=0.9999 corr_cb=-0.2222 topkJ=0.0188
[TRAIN][ep=004] loss=0.6907 acc=52.75%
[TRAIN][ep=004] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0496
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4691 mb_mean=0.4730 norm_overlap=1.0000 corr_cb=-0.0798 topkJ=0.0197
[TRAIN][ep=005] loss=0.6891 acc=54.23%
[TRAIN][ep=005] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0535
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4653 mb_mean=0.4739 norm_overlap=0.9999 corr_cb=-0.2608 topkJ=0.0412
[TRAIN][ep=006] loss=0.6870 acc=54.09%
[TRAIN][ep=006] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0534
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4637 mb_mean=0.4748 norm_overlap=1.0000 corr_cb=0.0031 topkJ=0.0692
[TRAIN][ep=007] loss=0.6869 acc=56.38%
[TRAIN][ep=007] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0487
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4635 mb_mean=0.4737 norm_overlap=1.0000 corr_cb=0.0553 topkJ=0.0628
[TRAIN][ep=008] loss=0.6844 acc=57.99%
[TRAIN][ep=008] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0575
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4622 mb_mean=0.4769 norm_overlap=1.0000 corr_cb=-0.0556 topkJ=0.0226
[TRAIN][ep=009] loss=0.6805 acc=58.52%
[TRAIN][ep=009] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0557
================= FIT START (fold=4) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4686 mb_mean=0.4721 norm_overlap=0.9999 corr_cb=-0.1822 topkJ=0.0197
[TRAIN][ep=000] loss=0.6785 acc=56.91%
[TRAIN][ep=000] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0534
[EPOCH 000/089] train: loss=0.6785 acc=56.91% | val: loss=0.6817 acc=56.63% f1=70.00% auc=56.98% val_score=42.4760 val_score_bestthr=61.2149 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.053) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 61.2149
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/ckpt_best_fold_4.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4665 mb_mean=0.4758 norm_overlap=0.9999 corr_cb=-0.1292 topkJ=0.0478
[TRAIN][ep=001] loss=0.6736 acc=61.07%
[TRAIN][ep=001] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0547
[EPOCH 001/089] train: loss=0.6736 acc=61.07% | val: loss=0.6806 acc=56.63% f1=68.97% auc=58.60% val_score=32.3874 val_score_bestthr=58.8798 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.055) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.2149 -> 58.8798
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4682 mb_mean=0.4745 norm_overlap=1.0000 corr_cb=0.0238 topkJ=0.0471
[TRAIN][ep=002] loss=0.6747 acc=58.66%
[TRAIN][ep=002] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0516
[EPOCH 002/089] train: loss=0.6747 acc=58.66% | val: loss=0.6787 acc=56.63% f1=69.49% auc=58.37% val_score=44.9760 val_score_bestthr=59.8032 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.052) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.2149 -> 59.8032
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4654 mb_mean=0.4739 norm_overlap=1.0000 corr_cb=0.0819 topkJ=0.0805
[TRAIN][ep=003] loss=0.6695 acc=61.61%
[TRAIN][ep=003] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0531
[EPOCH 003/089] train: loss=0.6695 acc=61.61% | val: loss=0.6781 acc=57.83% f1=70.09% auc=58.78% val_score=33.6681 val_score_bestthr=61.3697 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.053) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 61.2149 -> 61.3697
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/ckpt_best_fold_4.pt
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4650 mb_mean=0.4728 norm_overlap=0.9999 corr_cb=-0.1206 topkJ=0.0236
[TRAIN][ep=004] loss=0.6672 acc=60.40%
[TRAIN][ep=004] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0547
[EPOCH 004/089] train: loss=0.6672 acc=60.40% | val: loss=0.6774 acc=56.63% f1=69.49% auc=58.90% val_score=39.3246 val_score_bestthr=61.0366 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.055) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 61.0366
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4674 mb_mean=0.4747 norm_overlap=0.9999 corr_cb=-0.1348 topkJ=0.0317
[TRAIN][ep=005] loss=1.4425 acc=61.74%
[TRAIN][ep=005] mask_avg: mc_mean=0.3603 mb_mean=0.4751 norm_overlap=0.9989 corr_cb=-0.3262
[EPOCH 005/089] train: loss=1.4425 acc=61.74% | val: loss=0.6783 acc=56.63% f1=68.97% auc=57.91% val_score=37.0416 val_score_bestthr=58.8798 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.360, mb=0.475, no=0.999, corr=-0.326) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 58.8798
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2849 mb_mean=0.4698 norm_overlap=0.9973 corr_cb=-0.4638 topkJ=0.0210
[TRAIN][ep=006] loss=1.4256 acc=62.01%
[TRAIN][ep=006] mask_avg: mc_mean=0.2361 mb_mean=0.4751 norm_overlap=0.9974 corr_cb=-0.3515
[EPOCH 006/089] train: loss=1.4256 acc=62.01% | val: loss=0.6857 acc=56.63% f1=69.49% auc=57.85% val_score=42.2444 val_score_bestthr=60.9699 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.236, mb=0.475, no=0.997, corr=-0.351) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 60.9699
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2398 mb_mean=0.4739 norm_overlap=0.9972 corr_cb=-0.3791 topkJ=0.0126
[TRAIN][ep=007] loss=1.4259 acc=62.28%
[TRAIN][ep=007] mask_avg: mc_mean=0.1931 mb_mean=0.4751 norm_overlap=0.9966 corr_cb=-0.3373
[EPOCH 007/089] train: loss=1.4259 acc=62.28% | val: loss=0.6775 acc=56.63% f1=68.97% auc=58.31% val_score=37.7200 val_score_bestthr=58.8798 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.193, mb=0.475, no=0.997, corr=-0.337) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 58.8798
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1672 mb_mean=0.4764 norm_overlap=0.9955 corr_cb=-0.4074 topkJ=0.0192
[TRAIN][ep=008] loss=1.4282 acc=60.67%
[TRAIN][ep=008] mask_avg: mc_mean=0.1676 mb_mean=0.4751 norm_overlap=0.9959 corr_cb=-0.3363
[EPOCH 008/089] train: loss=1.4282 acc=60.67% | val: loss=0.6774 acc=56.63% f1=68.97% auc=59.07% val_score=44.8657 val_score_bestthr=58.8798 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.168, mb=0.475, no=0.996, corr=-0.336) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 58.8798
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1258 mb_mean=0.4786 norm_overlap=0.9940 corr_cb=-0.3974 topkJ=0.0089
[TRAIN][ep=009] loss=1.2037 acc=63.62%
[TRAIN][ep=009] mask_avg: mc_mean=0.1551 mb_mean=0.4751 norm_overlap=0.9955 corr_cb=-0.3324
[EPOCH 009/089] train: loss=1.2037 acc=63.62% | val: loss=0.6823 acc=55.42% f1=68.91% auc=57.33% val_score=38.6511 val_score_bestthr=59.4716 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.155, mb=0.475, no=0.995, corr=-0.332) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 59.4716
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1766 mb_mean=0.4729 norm_overlap=0.9950 corr_cb=-0.3967 topkJ=0.0081
[TRAIN][ep=010] loss=0.9921 acc=61.21%
[TRAIN][ep=010] mask_avg: mc_mean=0.1470 mb_mean=0.4751 norm_overlap=0.9950 corr_cb=-0.3375
[EPOCH 010/089] train: loss=0.9921 acc=61.21% | val: loss=0.6860 acc=54.22% f1=69.35% auc=57.33% val_score=35.8859 val_score_bestthr=62.5593 | dyn(w_pfs=0.190, w_sup=0.090, w_csuf=0.040, stage2=False) | mask(mc=0.147, mb=0.475, no=0.995, corr=-0.338) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 61.3697 -> 62.5593
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/ckpt_best_fold_4.pt
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1418 mb_mean=0.4768 norm_overlap=0.9898 corr_cb=-0.5235 topkJ=0.0012
[TRAIN][ep=011] loss=1.0690 acc=62.42%
[TRAIN][ep=011] mask_avg: mc_mean=0.1450 mb_mean=0.4751 norm_overlap=0.9944 corr_cb=-0.3615
[EPOCH 011/089] train: loss=1.0690 acc=62.42% | val: loss=0.6928 acc=54.22% f1=68.85% auc=57.27% val_score=35.0550 val_score_bestthr=57.8426 | dyn(w_pfs=0.230, w_sup=0.130, w_csuf=0.080, stage2=False) | mask(mc=0.145, mb=0.475, no=0.994, corr=-0.362) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.8426
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1319 mb_mean=0.4755 norm_overlap=0.9933 corr_cb=-0.3648 topkJ=0.0210
[TRAIN][ep=012] loss=1.1385 acc=65.91%
[TRAIN][ep=012] mask_avg: mc_mean=0.1403 mb_mean=0.4751 norm_overlap=0.9942 corr_cb=-0.3355
[EPOCH 012/089] train: loss=1.1385 acc=65.91% | val: loss=0.6825 acc=55.42% f1=69.42% auc=57.85% val_score=40.1820 val_score_bestthr=58.5609 | dyn(w_pfs=0.270, w_sup=0.170, w_csuf=0.120, stage2=False) | mask(mc=0.140, mb=0.475, no=0.994, corr=-0.335) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.5609
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1338 mb_mean=0.4743 norm_overlap=0.9926 corr_cb=-0.3828 topkJ=0.0119
[TRAIN][ep=013] loss=1.2323 acc=64.83%
[TRAIN][ep=013] mask_avg: mc_mean=0.1260 mb_mean=0.4751 norm_overlap=0.9933 corr_cb=-0.3431
[EPOCH 013/089] train: loss=1.2323 acc=64.83% | val: loss=0.6893 acc=57.83% f1=69.03% auc=58.31% val_score=46.8639 val_score_bestthr=58.1893 | dyn(w_pfs=0.310, w_sup=0.210, w_csuf=0.160, stage2=False) | mask(mc=0.126, mb=0.475, no=0.993, corr=-0.343) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.1893
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1433 mb_mean=0.4742 norm_overlap=0.9937 corr_cb=-0.3622 topkJ=0.0187
[TRAIN][ep=014] loss=1.3044 acc=62.82%
[TRAIN][ep=014] mask_avg: mc_mean=0.1360 mb_mean=0.4751 norm_overlap=0.9931 corr_cb=-0.3435
[EPOCH 014/089] train: loss=1.3044 acc=62.82% | val: loss=0.6840 acc=55.42% f1=69.92% auc=57.62% val_score=48.9204 val_score_bestthr=61.9154 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.136, mb=0.475, no=0.993, corr=-0.343) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.9154
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1808 mb_mean=0.4730 norm_overlap=0.9939 corr_cb=-0.3751 topkJ=0.0129
[TRAIN][ep=015] loss=1.3830 acc=65.10%
[TRAIN][ep=015] mask_avg: mc_mean=0.1426 mb_mean=0.4751 norm_overlap=0.9929 corr_cb=-0.3390
[EPOCH 015/089] train: loss=1.3830 acc=65.10% | val: loss=0.7287 acc=55.42% f1=69.92% auc=56.40% val_score=39.5653 val_score_bestthr=61.9154 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.143, mb=0.475, no=0.993, corr=-0.339) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.9154
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1556 mb_mean=0.4758 norm_overlap=0.9922 corr_cb=-0.3703 topkJ=0.0072
[TRAIN][ep=016] loss=1.1618 acc=67.11%
[TRAIN][ep=016] mask_avg: mc_mean=0.1520 mb_mean=0.4751 norm_overlap=0.9927 corr_cb=-0.3421
[EPOCH 016/089] train: loss=1.1618 acc=67.11% | val: loss=0.7023 acc=55.42% f1=69.92% auc=57.15% val_score=33.9623 val_score_bestthr=61.9154 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.152, mb=0.475, no=0.993, corr=-0.342) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.9154
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1314 mb_mean=0.4750 norm_overlap=0.9919 corr_cb=-0.3441 topkJ=0.0118
[TRAIN][ep=017] loss=0.9525 acc=65.23%
[TRAIN][ep=017] mask_avg: mc_mean=0.1488 mb_mean=0.4751 norm_overlap=0.9925 corr_cb=-0.3164
[EPOCH 017/089] train: loss=0.9525 acc=65.23% | val: loss=0.6988 acc=55.42% f1=69.92% auc=57.44% val_score=38.1290 val_score_bestthr=61.9154 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.149, mb=0.475, no=0.992, corr=-0.316) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.9154
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1044 mb_mean=0.4762 norm_overlap=0.9917 corr_cb=-0.2858 topkJ=0.0113
[TRAIN][ep=018] loss=0.9044 acc=64.56%
[TRAIN][ep=018] mask_avg: mc_mean=0.1297 mb_mean=0.4751 norm_overlap=0.9909 corr_cb=-0.3480
[EPOCH 018/089] train: loss=0.9044 acc=64.56% | val: loss=0.7112 acc=56.63% f1=68.42% auc=59.24% val_score=39.6418 val_score_bestthr=58.2662 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.130, mb=0.475, no=0.991, corr=-0.348) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.2662
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1246 mb_mean=0.4778 norm_overlap=0.9930 corr_cb=-0.3282 topkJ=0.0076
[TRAIN][ep=019] loss=0.8813 acc=65.37%
[TRAIN][ep=019] mask_avg: mc_mean=0.1628 mb_mean=0.4751 norm_overlap=0.9919 corr_cb=-0.3385
[EPOCH 019/089] train: loss=0.8813 acc=65.37% | val: loss=0.7238 acc=56.63% f1=68.42% auc=58.95% val_score=48.0737 val_score_bestthr=58.2662 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.163, mb=0.475, no=0.992, corr=-0.338) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.2662
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1159 mb_mean=0.4735 norm_overlap=0.9928 corr_cb=-0.2805 topkJ=0.0060
[TRAIN][ep=020] loss=0.8748 acc=66.98%
[TRAIN][ep=020] mask_avg: mc_mean=0.1382 mb_mean=0.4751 norm_overlap=0.9902 corr_cb=-0.3608
[EPOCH 020/089] train: loss=0.8748 acc=66.98% | val: loss=0.6951 acc=54.22% f1=68.85% auc=59.24% val_score=48.4594 val_score_bestthr=57.8426 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.138, mb=0.475, no=0.990, corr=-0.361) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.8426
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2058 mb_mean=0.4739 norm_overlap=0.9905 corr_cb=-0.4509 topkJ=0.0076
[TRAIN][ep=021] loss=0.8610 acc=67.11%
[TRAIN][ep=021] mask_avg: mc_mean=0.1651 mb_mean=0.4751 norm_overlap=0.9913 corr_cb=-0.3501
[EPOCH 021/089] train: loss=0.8610 acc=67.11% | val: loss=0.6980 acc=54.22% f1=68.85% auc=60.17% val_score=48.4902 val_score_bestthr=57.8426 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.165, mb=0.475, no=0.991, corr=-0.350) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.8426
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1782 mb_mean=0.4744 norm_overlap=0.9918 corr_cb=-0.3675 topkJ=0.0072
[TRAIN][ep=022] loss=0.8586 acc=65.91%
[TRAIN][ep=022] mask_avg: mc_mean=0.1638 mb_mean=0.4751 norm_overlap=0.9911 corr_cb=-0.3445
[EPOCH 022/089] train: loss=0.8586 acc=65.91% | val: loss=0.7039 acc=53.01% f1=68.80% auc=60.64% val_score=48.7400 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.164, mb=0.475, no=0.991, corr=-0.345) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1937 mb_mean=0.4735 norm_overlap=0.9925 corr_cb=-0.3652 topkJ=0.0190
[TRAIN][ep=023] loss=0.8558 acc=69.26%
[TRAIN][ep=023] mask_avg: mc_mean=0.1774 mb_mean=0.4751 norm_overlap=0.9914 corr_cb=-0.3466
[EPOCH 023/089] train: loss=0.8558 acc=69.26% | val: loss=0.7172 acc=54.22% f1=68.85% auc=61.05% val_score=41.7311 val_score_bestthr=57.0648 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.177, mb=0.475, no=0.991, corr=-0.347) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.0648
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1791 mb_mean=0.4758 norm_overlap=0.9890 corr_cb=-0.4937 topkJ=0.0024
[TRAIN][ep=024] loss=0.8431 acc=70.87%
[TRAIN][ep=024] mask_avg: mc_mean=0.1729 mb_mean=0.4751 norm_overlap=0.9909 corr_cb=-0.3556
[EPOCH 024/089] train: loss=0.8431 acc=70.87% | val: loss=0.7079 acc=54.22% f1=68.85% auc=60.41% val_score=46.1732 val_score_bestthr=57.8426 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.173, mb=0.475, no=0.991, corr=-0.356) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.8426
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1713 mb_mean=0.4754 norm_overlap=0.9939 corr_cb=-0.2745 topkJ=0.0203
[TRAIN][ep=025] loss=0.8448 acc=68.99%
[TRAIN][ep=025] mask_avg: mc_mean=0.1893 mb_mean=0.4751 norm_overlap=0.9914 corr_cb=-0.3486
[EPOCH 025/089] train: loss=0.8448 acc=68.99% | val: loss=0.7069 acc=54.22% f1=68.85% auc=61.34% val_score=49.1091 val_score_bestthr=57.8426 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.189, mb=0.475, no=0.991, corr=-0.349) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.8426
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1876 mb_mean=0.4756 norm_overlap=0.9942 corr_cb=-0.2909 topkJ=0.0079
[TRAIN][ep=026] loss=0.8416 acc=68.99%
[TRAIN][ep=026] mask_avg: mc_mean=0.1851 mb_mean=0.4751 norm_overlap=0.9911 corr_cb=-0.3555
[EPOCH 026/089] train: loss=0.8416 acc=68.99% | val: loss=0.7116 acc=54.22% f1=68.85% auc=60.93% val_score=45.8988 val_score_bestthr=57.8426 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.185, mb=0.475, no=0.991, corr=-0.355) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.8426
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1812 mb_mean=0.4761 norm_overlap=0.9849 corr_cb=-0.4847 topkJ=0.0032
[TRAIN][ep=027] loss=0.8301 acc=69.53%
[TRAIN][ep=027] mask_avg: mc_mean=0.1731 mb_mean=0.4751 norm_overlap=0.9904 corr_cb=-0.3624
[EPOCH 027/089] train: loss=0.8301 acc=69.53% | val: loss=0.7099 acc=54.22% f1=68.85% auc=61.34% val_score=47.1459 val_score_bestthr=57.0648 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.173, mb=0.475, no=0.990, corr=-0.362) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.0648
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1605 mb_mean=0.4761 norm_overlap=0.9888 corr_cb=-0.4089 topkJ=0.0150
[TRAIN][ep=028] loss=0.8273 acc=71.54%
[TRAIN][ep=028] mask_avg: mc_mean=0.1890 mb_mean=0.4751 norm_overlap=0.9909 corr_cb=-0.3606
[EPOCH 028/089] train: loss=0.8273 acc=71.54% | val: loss=0.7107 acc=65.06% f1=65.88% auc=61.63% val_score=48.0880 val_score_bestthr=56.8593 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.189, mb=0.475, no=0.991, corr=-0.361) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 56.8593
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2213 mb_mean=0.4731 norm_overlap=0.9928 corr_cb=-0.3041 topkJ=0.0072
[TRAIN][ep=029] loss=0.8334 acc=69.26%
[TRAIN][ep=029] mask_avg: mc_mean=0.1633 mb_mean=0.4751 norm_overlap=0.9898 corr_cb=-0.3628
[EPOCH 029/089] train: loss=0.8334 acc=69.26% | val: loss=0.7088 acc=54.22% f1=68.85% auc=61.34% val_score=48.9915 val_score_bestthr=57.0648 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.163, mb=0.475, no=0.990, corr=-0.363) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.0648
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.1926 mb_mean=0.4709 norm_overlap=0.9950 corr_cb=-0.2138 topkJ=0.0335
[TRAIN][ep=030] loss=0.8196 acc=70.20%
[TRAIN][ep=030] mask_avg: mc_mean=0.1703 mb_mean=0.4751 norm_overlap=0.9897 corr_cb=-0.3770
[EPOCH 030/089] train: loss=0.8196 acc=70.20% | val: loss=0.7149 acc=62.65% f1=63.53% auc=61.63% val_score=47.9018 val_score_bestthr=56.7985 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.170, mb=0.475, no=0.990, corr=-0.377) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 56.7985
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.1913 mb_mean=0.4752 norm_overlap=0.9903 corr_cb=-0.4312 topkJ=0.0079
[TRAIN][ep=031] loss=0.8151 acc=70.47%
[TRAIN][ep=031] mask_avg: mc_mean=0.1723 mb_mean=0.4751 norm_overlap=0.9896 corr_cb=-0.3758
[EPOCH 031/089] train: loss=0.8151 acc=70.47% | val: loss=0.7152 acc=53.01% f1=68.80% auc=61.80% val_score=53.0321 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.172, mb=0.475, no=0.990, corr=-0.376) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2045 mb_mean=0.4761 norm_overlap=0.9899 corr_cb=-0.4323 topkJ=0.0036
[TRAIN][ep=032] loss=0.8163 acc=70.60%
[TRAIN][ep=032] mask_avg: mc_mean=0.1935 mb_mean=0.4751 norm_overlap=0.9903 corr_cb=-0.3801
[EPOCH 032/089] train: loss=0.8163 acc=70.60% | val: loss=0.7174 acc=53.01% f1=68.80% auc=61.57% val_score=53.7446 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.194, mb=0.475, no=0.990, corr=-0.380) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2163 mb_mean=0.4763 norm_overlap=0.9897 corr_cb=-0.3969 topkJ=0.0020
[TRAIN][ep=033] loss=0.8032 acc=72.08%
[TRAIN][ep=033] mask_avg: mc_mean=0.1929 mb_mean=0.4751 norm_overlap=0.9899 corr_cb=-0.3936
[EPOCH 033/089] train: loss=0.8032 acc=72.08% | val: loss=0.7300 acc=53.01% f1=68.80% auc=61.05% val_score=42.6436 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.193, mb=0.475, no=0.990, corr=-0.394) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2033 mb_mean=0.4751 norm_overlap=0.9899 corr_cb=-0.3671 topkJ=0.0039
[TRAIN][ep=034] loss=0.8100 acc=72.21%
[TRAIN][ep=034] mask_avg: mc_mean=0.2023 mb_mean=0.4751 norm_overlap=0.9903 corr_cb=-0.3870
[EPOCH 034/089] train: loss=0.8100 acc=72.21% | val: loss=0.7405 acc=53.01% f1=68.80% auc=60.35% val_score=39.9707 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.202, mb=0.475, no=0.990, corr=-0.387) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.1247 mb_mean=0.4732 norm_overlap=0.9915 corr_cb=-0.3034 topkJ=0.0107
[TRAIN][ep=035] loss=0.7991 acc=72.48%
[TRAIN][ep=035] mask_avg: mc_mean=0.1949 mb_mean=0.4751 norm_overlap=0.9901 corr_cb=-0.3818
[EPOCH 035/089] train: loss=0.7991 acc=72.48% | val: loss=0.7230 acc=53.01% f1=68.80% auc=62.03% val_score=53.7446 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.195, mb=0.475, no=0.990, corr=-0.382) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2840 mb_mean=0.4753 norm_overlap=0.9927 corr_cb=-0.3325 topkJ=0.0121
[TRAIN][ep=036] loss=0.7995 acc=71.41%
[TRAIN][ep=036] mask_avg: mc_mean=0.2137 mb_mean=0.4751 norm_overlap=0.9905 corr_cb=-0.3959
[EPOCH 036/089] train: loss=0.7995 acc=71.41% | val: loss=0.7206 acc=53.01% f1=68.80% auc=62.15% val_score=53.7446 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.214, mb=0.475, no=0.991, corr=-0.396) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1661 mb_mean=0.4766 norm_overlap=0.9878 corr_cb=-0.4420 topkJ=0.0028
[TRAIN][ep=037] loss=0.7885 acc=72.62%
[TRAIN][ep=037] mask_avg: mc_mean=0.1938 mb_mean=0.4751 norm_overlap=0.9901 corr_cb=-0.3881
[EPOCH 037/089] train: loss=0.7885 acc=72.62% | val: loss=0.7417 acc=63.86% f1=66.67% auc=61.34% val_score=42.6436 val_score_bestthr=56.1453 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.194, mb=0.475, no=0.990, corr=-0.388) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 56.1453
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2192 mb_mean=0.4725 norm_overlap=0.9878 corr_cb=-0.4325 topkJ=0.0020
[TRAIN][ep=038] loss=0.7814 acc=73.42%
[TRAIN][ep=038] mask_avg: mc_mean=0.2014 mb_mean=0.4751 norm_overlap=0.9901 corr_cb=-0.3934
[EPOCH 038/089] train: loss=0.7814 acc=73.42% | val: loss=0.7370 acc=63.86% f1=66.67% auc=61.57% val_score=42.1702 val_score_bestthr=56.1453 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.201, mb=0.475, no=0.990, corr=-0.393) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 56.1453
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.1534 mb_mean=0.4760 norm_overlap=0.9879 corr_cb=-0.4045 topkJ=0.0028
[TRAIN][ep=039] loss=0.7766 acc=73.15%
[TRAIN][ep=039] mask_avg: mc_mean=0.1997 mb_mean=0.4751 norm_overlap=0.9901 corr_cb=-0.3928
[EPOCH 039/089] train: loss=0.7766 acc=73.15% | val: loss=0.7479 acc=63.86% f1=65.91% auc=61.10% val_score=42.6436 val_score_bestthr=55.4785 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.200, mb=0.475, no=0.990, corr=-0.393) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 55.4785
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.1996 mb_mean=0.4723 norm_overlap=0.9893 corr_cb=-0.4068 topkJ=0.0048
[TRAIN][ep=040] loss=0.7735 acc=73.29%
[TRAIN][ep=040] mask_avg: mc_mean=0.1840 mb_mean=0.4751 norm_overlap=0.9897 corr_cb=-0.3802
[EPOCH 040/089] train: loss=0.7735 acc=73.29% | val: loss=0.7333 acc=53.01% f1=68.80% auc=61.16% val_score=49.4280 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.184, mb=0.475, no=0.990, corr=-0.380) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[EARLY STOP] no improvement for 30 epochs. best_epoch=10
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/ckpt_best_fold_4.pt
=============== FIT DONE ===============
[BEST] epoch=10 | val_acc=54.22% | val_f1=69.35% | val_auc=57.33% | val_score=35.8859 | val_score_bestthr=62.5593
[TEST@BEST] thr_used=0.425 | acc=65.70% f1=71.26% auc=68.89% | SP_sex=16.30% EO_sex=12.01% SP_age=15.69% EO_age=20.07%
[TIME] 1.05 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/summary_fold_4.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4653 mb_mean=0.4746 norm_overlap=1.0000 corr_cb=0.0009 topkJ=0.0721
[TRAIN][ep=000] loss=0.6947 acc=50.60%
[TRAIN][ep=000] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0577
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4666 mb_mean=0.4760 norm_overlap=1.0000 corr_cb=-0.0804 topkJ=0.0394
[TRAIN][ep=001] loss=0.6935 acc=50.87%
[TRAIN][ep=001] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0520
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4641 mb_mean=0.4759 norm_overlap=0.9999 corr_cb=-0.1516 topkJ=0.0427
[TRAIN][ep=002] loss=0.6923 acc=51.81%
[TRAIN][ep=002] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0518
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4682 mb_mean=0.4728 norm_overlap=1.0000 corr_cb=0.0088 topkJ=0.0867
[TRAIN][ep=003] loss=0.6912 acc=52.21%
[TRAIN][ep=003] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0540
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4660 mb_mean=0.4754 norm_overlap=0.9999 corr_cb=-0.2222 topkJ=0.0188
[TRAIN][ep=004] loss=0.6907 acc=52.75%
[TRAIN][ep=004] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0496
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4691 mb_mean=0.4730 norm_overlap=1.0000 corr_cb=-0.0798 topkJ=0.0197
[TRAIN][ep=005] loss=0.6891 acc=54.09%
[TRAIN][ep=005] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0535
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4653 mb_mean=0.4739 norm_overlap=0.9999 corr_cb=-0.2608 topkJ=0.0412
[TRAIN][ep=006] loss=0.6870 acc=54.23%
[TRAIN][ep=006] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0534
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4637 mb_mean=0.4748 norm_overlap=1.0000 corr_cb=0.0031 topkJ=0.0692
[TRAIN][ep=007] loss=0.6869 acc=56.38%
[TRAIN][ep=007] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0487
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4635 mb_mean=0.4737 norm_overlap=1.0000 corr_cb=0.0553 topkJ=0.0628
[TRAIN][ep=008] loss=0.6844 acc=58.12%
[TRAIN][ep=008] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0575
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4622 mb_mean=0.4769 norm_overlap=1.0000 corr_cb=-0.0556 topkJ=0.0226
[TRAIN][ep=009] loss=0.6805 acc=58.52%
[TRAIN][ep=009] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0557
================= FIT START (fold=4) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.45 select_by=val_score_bestthr | eval_thr_mode=fixed eval_thr_grid=coarse | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4686 mb_mean=0.4721 norm_overlap=0.9999 corr_cb=-0.1822 topkJ=0.0197
[TRAIN][ep=000] loss=0.6784 acc=56.91%
[TRAIN][ep=000] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0534
[EPOCH 000/089] train: loss=0.6784 acc=56.91% | val: loss=0.6817 acc=51.81% f1=68.25% auc=56.98% val_score=62.0453 val_score_bestthr=62.0453 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.053) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 62.0453
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/ckpt_best_fold_4.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4665 mb_mean=0.4758 norm_overlap=0.9999 corr_cb=-0.1292 topkJ=0.0478
[TRAIN][ep=001] loss=0.6736 acc=61.07%
[TRAIN][ep=001] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0547
[EPOCH 001/089] train: loss=0.6736 acc=61.07% | val: loss=0.6806 acc=54.22% f1=69.35% auc=58.55% val_score=62.3371 val_score_bestthr=62.3371 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.055) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 62.0453 -> 62.3371
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/ckpt_best_fold_4.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4682 mb_mean=0.4745 norm_overlap=1.0000 corr_cb=0.0238 topkJ=0.0471
[TRAIN][ep=002] loss=0.6747 acc=58.52%
[TRAIN][ep=002] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0516
[EPOCH 002/089] train: loss=0.6747 acc=58.52% | val: loss=0.6787 acc=54.22% f1=69.35% auc=58.31% val_score=62.3371 val_score_bestthr=62.3371 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.052) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 62.3371
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4654 mb_mean=0.4739 norm_overlap=1.0000 corr_cb=0.0819 topkJ=0.0805
[TRAIN][ep=003] loss=0.6694 acc=61.61%
[TRAIN][ep=003] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0531
[EPOCH 003/089] train: loss=0.6694 acc=61.61% | val: loss=0.6781 acc=54.22% f1=68.33% auc=58.72% val_score=58.3637 val_score_bestthr=58.3637 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.053) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 58.3637
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4650 mb_mean=0.4728 norm_overlap=0.9999 corr_cb=-0.1206 topkJ=0.0236
[TRAIN][ep=004] loss=0.6672 acc=60.40%
[TRAIN][ep=004] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0547
[EPOCH 004/089] train: loss=0.6672 acc=60.40% | val: loss=0.6774 acc=55.42% f1=68.91% auc=58.78% val_score=59.9272 val_score_bestthr=59.9272 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.055) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 59.9272
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4674 mb_mean=0.4747 norm_overlap=0.9999 corr_cb=-0.1348 topkJ=0.0317
[TRAIN][ep=005] loss=1.4425 acc=61.74%
[TRAIN][ep=005] mask_avg: mc_mean=0.3604 mb_mean=0.4751 norm_overlap=0.9989 corr_cb=-0.3262
[EPOCH 005/089] train: loss=1.4425 acc=61.74% | val: loss=0.6783 acc=55.42% f1=68.38% auc=58.02% val_score=58.0473 val_score_bestthr=58.0473 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.360, mb=0.475, no=0.999, corr=-0.326) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 58.0473
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2851 mb_mean=0.4698 norm_overlap=0.9973 corr_cb=-0.4639 topkJ=0.0210
[TRAIN][ep=006] loss=1.4255 acc=62.15%
[TRAIN][ep=006] mask_avg: mc_mean=0.2362 mb_mean=0.4751 norm_overlap=0.9974 corr_cb=-0.3515
[EPOCH 006/089] train: loss=1.4255 acc=62.15% | val: loss=0.6858 acc=54.22% f1=59.57% auc=57.79% val_score=48.3973 val_score_bestthr=48.3973 | dyn(w_pfs=0.240, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.236, mb=0.475, no=0.997, corr=-0.352) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 48.3973
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2399 mb_mean=0.4739 norm_overlap=0.9972 corr_cb=-0.3792 topkJ=0.0126
[TRAIN][ep=007] loss=1.2065 acc=61.88%
[TRAIN][ep=007] mask_avg: mc_mean=0.1938 mb_mean=0.4751 norm_overlap=0.9967 corr_cb=-0.3353
[EPOCH 007/089] train: loss=1.2065 acc=61.88% | val: loss=0.6776 acc=55.42% f1=67.83% auc=58.08% val_score=55.7506 val_score_bestthr=55.7506 | dyn(w_pfs=0.140, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.194, mb=0.475, no=0.997, corr=-0.335) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 55.7506
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1683 mb_mean=0.4764 norm_overlap=0.9955 corr_cb=-0.4032 topkJ=0.0192
[TRAIN][ep=008] loss=0.9921 acc=60.81%
[TRAIN][ep=008] mask_avg: mc_mean=0.1697 mb_mean=0.4751 norm_overlap=0.9960 corr_cb=-0.3277
[EPOCH 008/089] train: loss=0.9921 acc=60.81% | val: loss=0.6775 acc=56.63% f1=68.97% auc=58.78% val_score=58.8798 val_score_bestthr=58.8798 | dyn(w_pfs=0.040, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.170, mb=0.475, no=0.996, corr=-0.328) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 58.8798
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1286 mb_mean=0.4786 norm_overlap=0.9942 corr_cb=-0.3866 topkJ=0.0097
[TRAIN][ep=009] loss=0.9387 acc=64.03%
[TRAIN][ep=009] mask_avg: mc_mean=0.1575 mb_mean=0.4751 norm_overlap=0.9956 corr_cb=-0.3189
[EPOCH 009/089] train: loss=0.9387 acc=64.03% | val: loss=0.6822 acc=54.22% f1=61.22% auc=57.62% val_score=47.7052 val_score_bestthr=47.7052 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.157, mb=0.475, no=0.996, corr=-0.319) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 47.7052
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1786 mb_mean=0.4729 norm_overlap=0.9952 corr_cb=-0.3821 topkJ=0.0110
[TRAIN][ep=010] loss=0.9303 acc=61.61%
[TRAIN][ep=010] mask_avg: mc_mean=0.1491 mb_mean=0.4751 norm_overlap=0.9951 corr_cb=-0.3246
[EPOCH 010/089] train: loss=0.9303 acc=61.61% | val: loss=0.6858 acc=55.42% f1=60.22% auc=57.33% val_score=49.9590 val_score_bestthr=49.9590 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.149, mb=0.475, no=0.995, corr=-0.325) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 49.9590
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1427 mb_mean=0.4768 norm_overlap=0.9898 corr_cb=-0.5150 topkJ=0.0012
[TRAIN][ep=011] loss=0.9211 acc=62.95%
[TRAIN][ep=011] mask_avg: mc_mean=0.1468 mb_mean=0.4751 norm_overlap=0.9946 corr_cb=-0.3498
[EPOCH 011/089] train: loss=0.9211 acc=62.95% | val: loss=0.6925 acc=53.01% f1=53.01% auc=56.80% val_score=43.5871 val_score_bestthr=43.5871 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.147, mb=0.475, no=0.995, corr=-0.350) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 43.5871
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1345 mb_mean=0.4755 norm_overlap=0.9934 corr_cb=-0.3568 topkJ=0.0214
[TRAIN][ep=012] loss=0.9063 acc=65.50%
[TRAIN][ep=012] mask_avg: mc_mean=0.1446 mb_mean=0.4751 norm_overlap=0.9944 corr_cb=-0.3233
[EPOCH 012/089] train: loss=0.9063 acc=65.50% | val: loss=0.6838 acc=54.22% f1=66.07% auc=57.79% val_score=48.8545 val_score_bestthr=48.8545 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.145, mb=0.475, no=0.994, corr=-0.323) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 48.8545
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1382 mb_mean=0.4743 norm_overlap=0.9929 corr_cb=-0.3669 topkJ=0.0139
[TRAIN][ep=013] loss=0.9128 acc=64.70%
[TRAIN][ep=013] mask_avg: mc_mean=0.1305 mb_mean=0.4751 norm_overlap=0.9935 corr_cb=-0.3293
[EPOCH 013/089] train: loss=0.9128 acc=64.70% | val: loss=0.6899 acc=55.42% f1=67.83% auc=58.26% val_score=55.7506 val_score_bestthr=55.7506 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.131, mb=0.475, no=0.994, corr=-0.329) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 55.7506
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1507 mb_mean=0.4742 norm_overlap=0.9940 corr_cb=-0.3441 topkJ=0.0191
[TRAIN][ep=014] loss=0.9005 acc=63.36%
[TRAIN][ep=014] mask_avg: mc_mean=0.1439 mb_mean=0.4751 norm_overlap=0.9935 corr_cb=-0.3262
[EPOCH 014/089] train: loss=0.9005 acc=63.36% | val: loss=0.6874 acc=57.83% f1=62.37% auc=57.62% val_score=47.2928 val_score_bestthr=47.2928 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.144, mb=0.475, no=0.994, corr=-0.326) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 47.2928
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1876 mb_mean=0.4730 norm_overlap=0.9942 corr_cb=-0.3596 topkJ=0.0150
[TRAIN][ep=015] loss=0.8960 acc=64.83%
[TRAIN][ep=015] mask_avg: mc_mean=0.1480 mb_mean=0.4751 norm_overlap=0.9932 corr_cb=-0.3215
[EPOCH 015/089] train: loss=0.8960 acc=64.83% | val: loss=0.7261 acc=50.60% f1=43.84% auc=56.28% val_score=37.6952 val_score_bestthr=37.6952 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.148, mb=0.475, no=0.993, corr=-0.322) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 37.6952
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1602 mb_mean=0.4758 norm_overlap=0.9925 corr_cb=-0.3556 topkJ=0.0072
[TRAIN][ep=016] loss=0.8887 acc=66.71%
[TRAIN][ep=016] mask_avg: mc_mean=0.1577 mb_mean=0.4751 norm_overlap=0.9930 corr_cb=-0.3331
[EPOCH 016/089] train: loss=0.8887 acc=66.71% | val: loss=0.7050 acc=56.63% f1=57.14% auc=57.03% val_score=48.9204 val_score_bestthr=48.9204 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.158, mb=0.475, no=0.993, corr=-0.333) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 48.9204
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1381 mb_mean=0.4750 norm_overlap=0.9922 corr_cb=-0.3393 topkJ=0.0118
[TRAIN][ep=017] loss=0.8936 acc=65.23%
[TRAIN][ep=017] mask_avg: mc_mean=0.1533 mb_mean=0.4751 norm_overlap=0.9926 corr_cb=-0.3155
[EPOCH 017/089] train: loss=0.8936 acc=65.23% | val: loss=0.6986 acc=57.83% f1=60.67% auc=57.50% val_score=48.5179 val_score_bestthr=48.5179 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.153, mb=0.475, no=0.993, corr=-0.316) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 48.5179
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1064 mb_mean=0.4762 norm_overlap=0.9917 corr_cb=-0.2932 topkJ=0.0105
[TRAIN][ep=018] loss=0.8894 acc=64.03%
[TRAIN][ep=018] mask_avg: mc_mean=0.1341 mb_mean=0.4751 norm_overlap=0.9910 corr_cb=-0.3536
[EPOCH 018/089] train: loss=0.8894 acc=64.03% | val: loss=0.7084 acc=55.42% f1=67.26% auc=58.72% val_score=53.7367 val_score_bestthr=53.7367 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.134, mb=0.475, no=0.991, corr=-0.354) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 53.7367
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1229 mb_mean=0.4778 norm_overlap=0.9929 corr_cb=-0.3354 topkJ=0.0076
[TRAIN][ep=019] loss=0.8820 acc=65.23%
[TRAIN][ep=019] mask_avg: mc_mean=0.1650 mb_mean=0.4751 norm_overlap=0.9919 corr_cb=-0.3462
[EPOCH 019/089] train: loss=0.8820 acc=65.23% | val: loss=0.7218 acc=54.22% f1=67.24% auc=58.72% val_score=54.2522 val_score_bestthr=54.2522 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.165, mb=0.475, no=0.992, corr=-0.346) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 54.2522
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1206 mb_mean=0.4735 norm_overlap=0.9929 corr_cb=-0.2894 topkJ=0.0056
[TRAIN][ep=020] loss=0.8754 acc=66.71%
[TRAIN][ep=020] mask_avg: mc_mean=0.1399 mb_mean=0.4751 norm_overlap=0.9902 corr_cb=-0.3721
[EPOCH 020/089] train: loss=0.8754 acc=66.71% | val: loss=0.6964 acc=61.45% f1=63.64% auc=59.71% val_score=48.2998 val_score_bestthr=48.2998 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.140, mb=0.475, no=0.990, corr=-0.372) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 48.2998
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2081 mb_mean=0.4739 norm_overlap=0.9905 corr_cb=-0.4607 topkJ=0.0072
[TRAIN][ep=021] loss=0.8619 acc=67.11%
[TRAIN][ep=021] mask_avg: mc_mean=0.1661 mb_mean=0.4751 norm_overlap=0.9912 corr_cb=-0.3629
[EPOCH 021/089] train: loss=0.8619 acc=67.11% | val: loss=0.6983 acc=57.83% f1=63.92% auc=59.65% val_score=49.0859 val_score_bestthr=49.0859 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.166, mb=0.475, no=0.991, corr=-0.363) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 49.0859
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1780 mb_mean=0.4744 norm_overlap=0.9917 corr_cb=-0.3814 topkJ=0.0072
[TRAIN][ep=022] loss=0.8593 acc=65.91%
[TRAIN][ep=022] mask_avg: mc_mean=0.1637 mb_mean=0.4751 norm_overlap=0.9909 corr_cb=-0.3588
[EPOCH 022/089] train: loss=0.8593 acc=65.91% | val: loss=0.7039 acc=50.60% f1=61.68% auc=60.64% val_score=41.9782 val_score_bestthr=41.9782 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.164, mb=0.475, no=0.991, corr=-0.359) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 41.9782
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1933 mb_mean=0.4735 norm_overlap=0.9923 corr_cb=-0.3835 topkJ=0.0182
[TRAIN][ep=023] loss=0.8564 acc=68.59%
[TRAIN][ep=023] mask_avg: mc_mean=0.1779 mb_mean=0.4751 norm_overlap=0.9912 corr_cb=-0.3618
[EPOCH 023/089] train: loss=0.8564 acc=68.59% | val: loss=0.7168 acc=50.60% f1=62.39% auc=60.87% val_score=38.5562 val_score_bestthr=38.5562 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.178, mb=0.475, no=0.991, corr=-0.362) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 38.5562
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1778 mb_mean=0.4758 norm_overlap=0.9889 corr_cb=-0.5066 topkJ=0.0016
[TRAIN][ep=024] loss=0.8436 acc=70.60%
[TRAIN][ep=024] mask_avg: mc_mean=0.1727 mb_mean=0.4751 norm_overlap=0.9907 corr_cb=-0.3718
[EPOCH 024/089] train: loss=0.8436 acc=70.60% | val: loss=0.7089 acc=60.24% f1=61.18% auc=60.29% val_score=50.7197 val_score_bestthr=50.7197 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.173, mb=0.475, no=0.991, corr=-0.372) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 50.7197
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1693 mb_mean=0.4754 norm_overlap=0.9937 corr_cb=-0.2901 topkJ=0.0199
[TRAIN][ep=025] loss=0.8450 acc=68.99%
[TRAIN][ep=025] mask_avg: mc_mean=0.1868 mb_mean=0.4751 norm_overlap=0.9911 corr_cb=-0.3656
[EPOCH 025/089] train: loss=0.8450 acc=68.99% | val: loss=0.7071 acc=62.65% f1=65.17% auc=61.05% val_score=52.2585 val_score_bestthr=52.2585 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.187, mb=0.475, no=0.991, corr=-0.366) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 52.2585
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1877 mb_mean=0.4756 norm_overlap=0.9940 corr_cb=-0.3102 topkJ=0.0071
[TRAIN][ep=026] loss=0.8414 acc=69.40%
[TRAIN][ep=026] mask_avg: mc_mean=0.1836 mb_mean=0.4751 norm_overlap=0.9909 corr_cb=-0.3734
[EPOCH 026/089] train: loss=0.8414 acc=69.40% | val: loss=0.7120 acc=62.65% f1=63.53% auc=60.76% val_score=48.9805 val_score_bestthr=48.9805 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.184, mb=0.475, no=0.991, corr=-0.373) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 48.9805
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1828 mb_mean=0.4761 norm_overlap=0.9848 corr_cb=-0.4989 topkJ=0.0028
[TRAIN][ep=027] loss=0.8299 acc=70.20%
[TRAIN][ep=027] mask_avg: mc_mean=0.1719 mb_mean=0.4751 norm_overlap=0.9902 corr_cb=-0.3796
[EPOCH 027/089] train: loss=0.8299 acc=70.20% | val: loss=0.7099 acc=55.42% f1=64.08% auc=61.74% val_score=43.4724 val_score_bestthr=43.4724 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.172, mb=0.475, no=0.990, corr=-0.380) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 43.4724
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1582 mb_mean=0.4761 norm_overlap=0.9885 corr_cb=-0.4263 topkJ=0.0134
[TRAIN][ep=028] loss=0.8269 acc=71.81%
[TRAIN][ep=028] mask_avg: mc_mean=0.1877 mb_mean=0.4751 norm_overlap=0.9907 corr_cb=-0.3780
[EPOCH 028/089] train: loss=0.8269 acc=71.81% | val: loss=0.7110 acc=60.24% f1=65.98% auc=61.34% val_score=49.0556 val_score_bestthr=49.0556 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.188, mb=0.475, no=0.991, corr=-0.378) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 49.0556
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2222 mb_mean=0.4731 norm_overlap=0.9926 corr_cb=-0.3203 topkJ=0.0068
[TRAIN][ep=029] loss=0.8326 acc=69.40%
[TRAIN][ep=029] mask_avg: mc_mean=0.1635 mb_mean=0.4751 norm_overlap=0.9896 corr_cb=-0.3798
[EPOCH 029/089] train: loss=0.8326 acc=69.40% | val: loss=0.7095 acc=55.42% f1=64.08% auc=61.45% val_score=43.4724 val_score_bestthr=43.4724 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.163, mb=0.475, no=0.990, corr=-0.380) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 43.4724
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.1938 mb_mean=0.4709 norm_overlap=0.9947 corr_cb=-0.2306 topkJ=0.0318
[TRAIN][ep=030] loss=0.8189 acc=70.34%
[TRAIN][ep=030] mask_avg: mc_mean=0.1705 mb_mean=0.4751 norm_overlap=0.9895 corr_cb=-0.3941
[EPOCH 030/089] train: loss=0.8189 acc=70.34% | val: loss=0.7157 acc=63.86% f1=65.91% auc=61.80% val_score=54.2058 val_score_bestthr=54.2058 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.171, mb=0.475, no=0.990, corr=-0.394) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 54.2058
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.1896 mb_mean=0.4752 norm_overlap=0.9901 corr_cb=-0.4459 topkJ=0.0067
[TRAIN][ep=031] loss=0.8144 acc=70.87%
[TRAIN][ep=031] mask_avg: mc_mean=0.1697 mb_mean=0.4751 norm_overlap=0.9893 corr_cb=-0.3918
[EPOCH 031/089] train: loss=0.8144 acc=70.87% | val: loss=0.7156 acc=59.04% f1=65.31% auc=61.74% val_score=46.1439 val_score_bestthr=46.1439 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.170, mb=0.475, no=0.989, corr=-0.392) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 46.1439
[EARLY STOP] no improvement for 30 epochs. best_epoch=1
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/ckpt_best_fold_4.pt
=============== FIT DONE ===============
[BEST] epoch=1 | val_acc=54.22% | val_f1=69.35% | val_auc=58.55% | val_score=62.3371 | val_score_bestthr=62.3371
[TEST@BEST] thr_used=0.450 | acc=52.17% f1=67.33% auc=61.18% | SP_sex=5.43% EO_sex=4.40% SP_age=10.00% EO_age=5.71%
[TIME] 0.72 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/summary_fold_4.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4653 mb_mean=0.4746 norm_overlap=1.0000 corr_cb=0.0009 topkJ=0.0721
[TRAIN][ep=000] loss=0.6948 acc=51.41%
[TRAIN][ep=000] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0577
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4666 mb_mean=0.4760 norm_overlap=1.0000 corr_cb=-0.0804 topkJ=0.0394
[TRAIN][ep=001] loss=0.6935 acc=51.54%
[TRAIN][ep=001] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0520
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4641 mb_mean=0.4759 norm_overlap=0.9999 corr_cb=-0.1516 topkJ=0.0427
[TRAIN][ep=002] loss=0.6919 acc=51.95%
[TRAIN][ep=002] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0518
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4682 mb_mean=0.4728 norm_overlap=1.0000 corr_cb=0.0088 topkJ=0.0867
[TRAIN][ep=003] loss=0.6903 acc=53.96%
[TRAIN][ep=003] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0540
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4660 mb_mean=0.4754 norm_overlap=0.9999 corr_cb=-0.2222 topkJ=0.0188
[TRAIN][ep=004] loss=0.6897 acc=55.03%
[TRAIN][ep=004] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0496
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4691 mb_mean=0.4730 norm_overlap=1.0000 corr_cb=-0.0798 topkJ=0.0197
[TRAIN][ep=005] loss=0.6875 acc=54.09%
[TRAIN][ep=005] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0535
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4653 mb_mean=0.4739 norm_overlap=0.9999 corr_cb=-0.2608 topkJ=0.0412
[TRAIN][ep=006] loss=0.6841 acc=54.36%
[TRAIN][ep=006] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0534
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4637 mb_mean=0.4748 norm_overlap=1.0000 corr_cb=0.0031 topkJ=0.0692
[TRAIN][ep=007] loss=0.6832 acc=56.38%
[TRAIN][ep=007] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0487
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4635 mb_mean=0.4737 norm_overlap=1.0000 corr_cb=0.0553 topkJ=0.0628
[TRAIN][ep=008] loss=0.6802 acc=58.12%
[TRAIN][ep=008] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0575
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4622 mb_mean=0.4769 norm_overlap=1.0000 corr_cb=-0.0556 topkJ=0.0226
[TRAIN][ep=009] loss=0.6747 acc=59.06%
[TRAIN][ep=009] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0557
================= FIT START (fold=4) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4686 mb_mean=0.4721 norm_overlap=0.9999 corr_cb=-0.1822 topkJ=0.0197
[TRAIN][ep=000] loss=0.6702 acc=59.73%
[TRAIN][ep=000] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0534
[EPOCH 000/089] train: loss=0.6702 acc=59.73% | val: loss=0.6786 acc=55.42% f1=69.42% auc=58.37% val_score=50.4958 val_score_bestthr=60.8841 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.053) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 60.8841
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/ckpt_best_fold_4.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4665 mb_mean=0.4758 norm_overlap=0.9999 corr_cb=-0.1292 topkJ=0.0478
[TRAIN][ep=001] loss=0.6624 acc=62.82%
[TRAIN][ep=001] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0547
[EPOCH 001/089] train: loss=0.6624 acc=62.82% | val: loss=0.6767 acc=57.83% f1=70.09% auc=59.13% val_score=39.3346 val_score_bestthr=61.3697 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.055) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 60.8841 -> 61.3697
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/ckpt_best_fold_4.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4682 mb_mean=0.4745 norm_overlap=1.0000 corr_cb=0.0238 topkJ=0.0471
[TRAIN][ep=002] loss=0.6633 acc=59.06%
[TRAIN][ep=002] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0516
[EPOCH 002/089] train: loss=0.6633 acc=59.06% | val: loss=0.6778 acc=56.63% f1=69.49% auc=58.08% val_score=40.6876 val_score_bestthr=61.0366 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.052) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 61.0366
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4654 mb_mean=0.4739 norm_overlap=1.0000 corr_cb=0.0819 topkJ=0.0805
[TRAIN][ep=003] loss=0.6575 acc=60.94%
[TRAIN][ep=003] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0531
[EPOCH 003/089] train: loss=0.6575 acc=60.94% | val: loss=0.6747 acc=56.63% f1=69.49% auc=58.43% val_score=37.5008 val_score_bestthr=61.0366 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.053) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 61.0366
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4650 mb_mean=0.4728 norm_overlap=0.9999 corr_cb=-0.1206 topkJ=0.0236
[TRAIN][ep=004] loss=0.6531 acc=61.74%
[TRAIN][ep=004] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0547
[EPOCH 004/089] train: loss=0.6531 acc=61.74% | val: loss=0.6755 acc=56.63% f1=69.49% auc=58.78% val_score=38.5869 val_score_bestthr=61.0366 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.055) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 61.0366
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4674 mb_mean=0.4747 norm_overlap=0.9999 corr_cb=-0.1348 topkJ=0.0317
[TRAIN][ep=005] loss=1.3611 acc=62.55%
[TRAIN][ep=005] mask_avg: mc_mean=0.3629 mb_mean=0.4751 norm_overlap=0.9989 corr_cb=-0.3382
[EPOCH 005/089] train: loss=1.3611 acc=62.55% | val: loss=0.6776 acc=56.63% f1=68.97% auc=59.13% val_score=51.9494 val_score_bestthr=58.8798 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.363, mb=0.475, no=0.999, corr=-0.338) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 58.8798
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2844 mb_mean=0.4698 norm_overlap=0.9972 corr_cb=-0.4730 topkJ=0.0194
[TRAIN][ep=006] loss=1.3360 acc=64.56%
[TRAIN][ep=006] mask_avg: mc_mean=0.2335 mb_mean=0.4751 norm_overlap=0.9973 corr_cb=-0.3634
[EPOCH 006/089] train: loss=1.3360 acc=64.56% | val: loss=0.6807 acc=55.42% f1=68.91% auc=58.02% val_score=41.3057 val_score_bestthr=59.4716 | dyn(w_pfs=0.240, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.234, mb=0.475, no=0.997, corr=-0.363) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 59.4716
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2364 mb_mean=0.4739 norm_overlap=0.9971 corr_cb=-0.3895 topkJ=0.0117
[TRAIN][ep=007] loss=1.1454 acc=62.55%
[TRAIN][ep=007] mask_avg: mc_mean=0.1886 mb_mean=0.4751 norm_overlap=0.9965 corr_cb=-0.3459
[EPOCH 007/089] train: loss=1.1454 acc=62.55% | val: loss=0.6778 acc=55.42% f1=68.91% auc=57.67% val_score=44.0337 val_score_bestthr=59.4716 | dyn(w_pfs=0.140, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.189, mb=0.475, no=0.996, corr=-0.346) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 59.4716
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1605 mb_mean=0.4764 norm_overlap=0.9953 corr_cb=-0.4072 topkJ=0.0180
[TRAIN][ep=008] loss=0.9600 acc=63.49%
[TRAIN][ep=008] mask_avg: mc_mean=0.1597 mb_mean=0.4751 norm_overlap=0.9955 corr_cb=-0.3475
[EPOCH 008/089] train: loss=0.9600 acc=63.49% | val: loss=0.6848 acc=57.83% f1=69.03% auc=59.48% val_score=49.4985 val_score_bestthr=58.1893 | dyn(w_pfs=0.040, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.160, mb=0.475, no=0.996, corr=-0.348) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 58.1893
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1187 mb_mean=0.4786 norm_overlap=0.9934 corr_cb=-0.4142 topkJ=0.0073
[TRAIN][ep=009] loss=0.9230 acc=65.23%
[TRAIN][ep=009] mask_avg: mc_mean=0.1456 mb_mean=0.4751 norm_overlap=0.9948 corr_cb=-0.3583
[EPOCH 009/089] train: loss=0.9230 acc=65.23% | val: loss=0.6790 acc=55.42% f1=68.91% auc=57.85% val_score=42.8608 val_score_bestthr=59.4716 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.146, mb=0.475, no=0.995, corr=-0.358) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 59.4716
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1640 mb_mean=0.4729 norm_overlap=0.9942 corr_cb=-0.4317 topkJ=0.0065
[TRAIN][ep=010] loss=0.9156 acc=64.16%
[TRAIN][ep=010] mask_avg: mc_mean=0.1391 mb_mean=0.4751 norm_overlap=0.9941 corr_cb=-0.3904
[EPOCH 010/089] train: loss=0.9156 acc=64.16% | val: loss=0.7115 acc=55.42% f1=68.38% auc=55.99% val_score=39.3776 val_score_bestthr=59.8140 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.139, mb=0.475, no=0.994, corr=-0.390) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 59.8140
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1381 mb_mean=0.4768 norm_overlap=0.9888 corr_cb=-0.5813 topkJ=0.0004
[TRAIN][ep=011] loss=0.9048 acc=64.56%
[TRAIN][ep=011] mask_avg: mc_mean=0.1441 mb_mean=0.4751 norm_overlap=0.9934 corr_cb=-0.4433
[EPOCH 011/089] train: loss=0.9048 acc=64.56% | val: loss=0.6961 acc=54.22% f1=68.85% auc=57.44% val_score=35.4943 val_score_bestthr=57.8426 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.144, mb=0.475, no=0.993, corr=-0.443) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 57.8426
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1304 mb_mean=0.4755 norm_overlap=0.9920 corr_cb=-0.4375 topkJ=0.0116
[TRAIN][ep=012] loss=0.8837 acc=66.85%
[TRAIN][ep=012] mask_avg: mc_mean=0.1366 mb_mean=0.4751 norm_overlap=0.9930 corr_cb=-0.4216
[EPOCH 012/089] train: loss=0.8837 acc=66.85% | val: loss=0.6833 acc=55.42% f1=69.42% auc=58.49% val_score=46.8304 val_score_bestthr=58.5609 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.137, mb=0.475, no=0.993, corr=-0.422) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 58.5609
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1353 mb_mean=0.4743 norm_overlap=0.9910 corr_cb=-0.4915 topkJ=0.0024
[TRAIN][ep=013] loss=0.8903 acc=66.98%
[TRAIN][ep=013] mask_avg: mc_mean=0.1218 mb_mean=0.4751 norm_overlap=0.9917 corr_cb=-0.4261
[EPOCH 013/089] train: loss=0.8903 acc=66.98% | val: loss=0.7089 acc=57.83% f1=69.03% auc=59.48% val_score=51.3428 val_score_bestthr=58.1893 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.122, mb=0.475, no=0.992, corr=-0.426) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 58.1893
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1408 mb_mean=0.4742 norm_overlap=0.9925 corr_cb=-0.4554 topkJ=0.0101
[TRAIN][ep=014] loss=0.8792 acc=66.17%
[TRAIN][ep=014] mask_avg: mc_mean=0.1356 mb_mean=0.4751 norm_overlap=0.9915 corr_cb=-0.4424
[EPOCH 014/089] train: loss=0.8792 acc=66.17% | val: loss=0.6830 acc=55.42% f1=69.92% auc=58.84% val_score=48.2392 val_score_bestthr=61.9154 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.136, mb=0.475, no=0.992, corr=-0.442) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 61.3697 -> 61.9154
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/ckpt_best_fold_4.pt
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1836 mb_mean=0.4730 norm_overlap=0.9927 corr_cb=-0.4690 topkJ=0.0036
[TRAIN][ep=015] loss=0.9490 acc=66.31%
[TRAIN][ep=015] mask_avg: mc_mean=0.1370 mb_mean=0.4751 norm_overlap=0.9907 corr_cb=-0.4582
[EPOCH 015/089] train: loss=0.9490 acc=66.31% | val: loss=0.7471 acc=54.22% f1=69.35% auc=57.27% val_score=36.9873 val_score_bestthr=62.5593 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.137, mb=0.475, no=0.991, corr=-0.458) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 61.9154 -> 62.5593
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/ckpt_best_fold_4.pt
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1421 mb_mean=0.4758 norm_overlap=0.9898 corr_cb=-0.4982 topkJ=0.0012
[TRAIN][ep=016] loss=1.0118 acc=69.40%
[TRAIN][ep=016] mask_avg: mc_mean=0.1389 mb_mean=0.4751 norm_overlap=0.9900 corr_cb=-0.4765
[EPOCH 016/089] train: loss=1.0118 acc=69.40% | val: loss=0.6982 acc=54.22% f1=69.35% auc=58.14% val_score=39.9967 val_score_bestthr=62.5593 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.139, mb=0.475, no=0.990, corr=-0.477) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 62.5593
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1209 mb_mean=0.4750 norm_overlap=0.9895 corr_cb=-0.4582 topkJ=0.0043
[TRAIN][ep=017] loss=1.0909 acc=67.79%
[TRAIN][ep=017] mask_avg: mc_mean=0.1387 mb_mean=0.4751 norm_overlap=0.9896 corr_cb=-0.4537
[EPOCH 017/089] train: loss=1.0909 acc=67.79% | val: loss=0.7353 acc=54.22% f1=69.35% auc=58.26% val_score=35.0647 val_score_bestthr=62.5593 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.139, mb=0.475, no=0.990, corr=-0.454) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 62.5593
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1028 mb_mean=0.4762 norm_overlap=0.9893 corr_cb=-0.4215 topkJ=0.0015
[TRAIN][ep=018] loss=1.1578 acc=69.80%
[TRAIN][ep=018] mask_avg: mc_mean=0.1264 mb_mean=0.4751 norm_overlap=0.9876 corr_cb=-0.5113
[EPOCH 018/089] train: loss=1.1578 acc=69.80% | val: loss=0.7283 acc=56.63% f1=68.42% auc=60.99% val_score=53.6131 val_score_bestthr=58.2662 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.126, mb=0.475, no=0.988, corr=-0.511) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.2662
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1376 mb_mean=0.4778 norm_overlap=0.9905 corr_cb=-0.5547 topkJ=0.0000
[TRAIN][ep=019] loss=1.2219 acc=67.65%
[TRAIN][ep=019] mask_avg: mc_mean=0.1740 mb_mean=0.4751 norm_overlap=0.9895 corr_cb=-0.5112
[EPOCH 019/089] train: loss=1.2219 acc=67.65% | val: loss=0.7474 acc=56.63% f1=68.42% auc=61.45% val_score=58.2662 val_score_bestthr=58.2662 | dyn(w_pfs=0.240, w_sup=0.240, w_csuf=0.200, stage2=False) | mask(mc=0.174, mb=0.475, no=0.990, corr=-0.511) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.2662
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1450 mb_mean=0.4735 norm_overlap=0.9897 corr_cb=-0.4988 topkJ=0.0016
[TRAIN][ep=020] loss=1.2263 acc=69.66%
[TRAIN][ep=020] mask_avg: mc_mean=0.1524 mb_mean=0.4751 norm_overlap=0.9880 corr_cb=-0.5313
[EPOCH 020/089] train: loss=1.2263 acc=69.66% | val: loss=0.6838 acc=62.65% f1=65.93% auc=61.80% val_score=45.3893 val_score_bestthr=54.6247 | dyn(w_pfs=0.140, w_sup=0.140, w_csuf=0.100, stage2=False) | mask(mc=0.152, mb=0.475, no=0.988, corr=-0.531) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 54.6247
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2253 mb_mean=0.4739 norm_overlap=0.9887 corr_cb=-0.6007 topkJ=0.0000
[TRAIN][ep=021] loss=1.0204 acc=70.34%
[TRAIN][ep=021] mask_avg: mc_mean=0.1765 mb_mean=0.4751 norm_overlap=0.9890 corr_cb=-0.5033
[EPOCH 021/089] train: loss=1.0204 acc=70.34% | val: loss=0.6978 acc=53.01% f1=68.80% auc=60.93% val_score=49.0933 val_score_bestthr=61.2320 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.000, stage2=False) | mask(mc=0.177, mb=0.475, no=0.989, corr=-0.503) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1596 mb_mean=0.4744 norm_overlap=0.9892 corr_cb=-0.4920 topkJ=0.0036
[TRAIN][ep=022] loss=0.8347 acc=68.99%
[TRAIN][ep=022] mask_avg: mc_mean=0.1472 mb_mean=0.4751 norm_overlap=0.9880 corr_cb=-0.4708
[EPOCH 022/089] train: loss=0.8347 acc=68.99% | val: loss=0.7044 acc=53.01% f1=68.80% auc=61.57% val_score=49.5005 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.147, mb=0.475, no=0.988, corr=-0.471) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2122 mb_mean=0.4735 norm_overlap=0.9911 corr_cb=-0.4914 topkJ=0.0084
[TRAIN][ep=023] loss=0.8168 acc=72.21%
[TRAIN][ep=023] mask_avg: mc_mean=0.1760 mb_mean=0.4751 norm_overlap=0.9892 corr_cb=-0.4641
[EPOCH 023/089] train: loss=0.8168 acc=72.21% | val: loss=0.7169 acc=53.01% f1=68.80% auc=61.63% val_score=48.6990 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.176, mb=0.475, no=0.989, corr=-0.464) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1912 mb_mean=0.4758 norm_overlap=0.9873 corr_cb=-0.6235 topkJ=0.0000
[TRAIN][ep=024] loss=0.8025 acc=73.29%
[TRAIN][ep=024] mask_avg: mc_mean=0.1755 mb_mean=0.4751 norm_overlap=0.9889 corr_cb=-0.4739
[EPOCH 024/089] train: loss=0.8025 acc=73.29% | val: loss=0.7087 acc=53.01% f1=68.80% auc=61.69% val_score=50.9204 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.175, mb=0.475, no=0.989, corr=-0.474) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1725 mb_mean=0.4754 norm_overlap=0.9919 corr_cb=-0.3864 topkJ=0.0137
[TRAIN][ep=025] loss=0.7979 acc=71.68%
[TRAIN][ep=025] mask_avg: mc_mean=0.1931 mb_mean=0.4751 norm_overlap=0.9897 corr_cb=-0.4544
[EPOCH 025/089] train: loss=0.7979 acc=71.68% | val: loss=0.7141 acc=53.01% f1=68.80% auc=61.63% val_score=51.2544 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.193, mb=0.475, no=0.990, corr=-0.454) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1862 mb_mean=0.4756 norm_overlap=0.9918 corr_cb=-0.4474 topkJ=0.0055
[TRAIN][ep=026] loss=0.7958 acc=72.21%
[TRAIN][ep=026] mask_avg: mc_mean=0.1874 mb_mean=0.4751 norm_overlap=0.9894 corr_cb=-0.4592
[EPOCH 026/089] train: loss=0.7958 acc=72.21% | val: loss=0.7151 acc=53.01% f1=68.80% auc=61.74% val_score=47.5643 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.187, mb=0.475, no=0.989, corr=-0.459) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1587 mb_mean=0.4761 norm_overlap=0.9817 corr_cb=-0.5454 topkJ=0.0036
[TRAIN][ep=027] loss=0.7848 acc=71.95%
[TRAIN][ep=027] mask_avg: mc_mean=0.1668 mb_mean=0.4751 norm_overlap=0.9885 corr_cb=-0.4538
[EPOCH 027/089] train: loss=0.7848 acc=71.95% | val: loss=0.7133 acc=54.22% f1=68.33% auc=61.86% val_score=51.1333 val_score_bestthr=55.6869 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.167, mb=0.475, no=0.989, corr=-0.454) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 55.6869
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1833 mb_mean=0.4761 norm_overlap=0.9886 corr_cb=-0.4773 topkJ=0.0113
[TRAIN][ep=028] loss=0.7769 acc=74.63%
[TRAIN][ep=028] mask_avg: mc_mean=0.2039 mb_mean=0.4751 norm_overlap=0.9899 corr_cb=-0.4578
[EPOCH 028/089] train: loss=0.7769 acc=74.63% | val: loss=0.7241 acc=55.42% f1=68.91% auc=61.80% val_score=53.4187 val_score_bestthr=57.1837 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.204, mb=0.475, no=0.990, corr=-0.458) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.1837
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2137 mb_mean=0.4731 norm_overlap=0.9909 corr_cb=-0.3900 topkJ=0.0044
[TRAIN][ep=029] loss=0.7833 acc=73.96%
[TRAIN][ep=029] mask_avg: mc_mean=0.1754 mb_mean=0.4751 norm_overlap=0.9886 corr_cb=-0.4548
[EPOCH 029/089] train: loss=0.7833 acc=73.96% | val: loss=0.7248 acc=63.86% f1=67.39% auc=61.28% val_score=42.6436 val_score_bestthr=56.9468 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.175, mb=0.475, no=0.989, corr=-0.455) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 56.9468
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2044 mb_mean=0.4709 norm_overlap=0.9936 corr_cb=-0.2934 topkJ=0.0238
[TRAIN][ep=030] loss=0.7724 acc=73.56%
[TRAIN][ep=030] mask_avg: mc_mean=0.1783 mb_mean=0.4751 norm_overlap=0.9885 corr_cb=-0.4660
[EPOCH 030/089] train: loss=0.7724 acc=73.56% | val: loss=0.7230 acc=62.65% f1=66.67% auc=61.51% val_score=44.0146 val_score_bestthr=57.0901 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.178, mb=0.475, no=0.989, corr=-0.466) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.0901
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2106 mb_mean=0.4752 norm_overlap=0.9900 corr_cb=-0.5230 topkJ=0.0051
[TRAIN][ep=031] loss=0.7568 acc=74.23%
[TRAIN][ep=031] mask_avg: mc_mean=0.1911 mb_mean=0.4751 norm_overlap=0.9891 corr_cb=-0.4566
[EPOCH 031/089] train: loss=0.7568 acc=74.23% | val: loss=0.7316 acc=62.65% f1=66.67% auc=61.22% val_score=38.1474 val_score_bestthr=57.0901 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.191, mb=0.475, no=0.989, corr=-0.457) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.0901
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2127 mb_mean=0.4761 norm_overlap=0.9892 corr_cb=-0.5123 topkJ=0.0008
[TRAIN][ep=032] loss=0.7631 acc=74.77%
[TRAIN][ep=032] mask_avg: mc_mean=0.1952 mb_mean=0.4751 norm_overlap=0.9895 corr_cb=-0.4473
[EPOCH 032/089] train: loss=0.7631 acc=74.77% | val: loss=0.7365 acc=65.06% f1=68.13% auc=61.10% val_score=41.6754 val_score_bestthr=58.0568 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.195, mb=0.475, no=0.989, corr=-0.447) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.0568
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1902 mb_mean=0.4763 norm_overlap=0.9887 corr_cb=-0.4510 topkJ=0.0004
[TRAIN][ep=033] loss=0.7446 acc=75.44%
[TRAIN][ep=033] mask_avg: mc_mean=0.2055 mb_mean=0.4751 norm_overlap=0.9897 corr_cb=-0.4528
[EPOCH 033/089] train: loss=0.7446 acc=75.44% | val: loss=0.7426 acc=65.06% f1=68.13% auc=61.16% val_score=41.4998 val_score_bestthr=58.0568 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.205, mb=0.475, no=0.990, corr=-0.453) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.0568
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2128 mb_mean=0.4751 norm_overlap=0.9886 corr_cb=-0.4491 topkJ=0.0020
[TRAIN][ep=034] loss=0.7520 acc=75.57%
[TRAIN][ep=034] mask_avg: mc_mean=0.1956 mb_mean=0.4751 norm_overlap=0.9893 corr_cb=-0.4348
[EPOCH 034/089] train: loss=0.7520 acc=75.57% | val: loss=0.7277 acc=56.63% f1=69.49% auc=61.22% val_score=45.7372 val_score_bestthr=60.0820 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.196, mb=0.475, no=0.989, corr=-0.435) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 60.0820
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.0790 mb_mean=0.4732 norm_overlap=0.9894 corr_cb=-0.3156 topkJ=0.0119
[TRAIN][ep=035] loss=0.7418 acc=75.57%
[TRAIN][ep=035] mask_avg: mc_mean=0.1976 mb_mean=0.4751 norm_overlap=0.9896 corr_cb=-0.4270
[EPOCH 035/089] train: loss=0.7418 acc=75.57% | val: loss=0.7406 acc=54.22% f1=68.85% auc=62.09% val_score=55.7455 val_score_bestthr=57.6940 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.198, mb=0.475, no=0.990, corr=-0.427) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.6940
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2890 mb_mean=0.4753 norm_overlap=0.9927 corr_cb=-0.3612 topkJ=0.0145
[TRAIN][ep=036] loss=0.7292 acc=75.03%
[TRAIN][ep=036] mask_avg: mc_mean=0.2183 mb_mean=0.4751 norm_overlap=0.9904 corr_cb=-0.4355
[EPOCH 036/089] train: loss=0.7292 acc=75.03% | val: loss=0.7415 acc=56.63% f1=69.49% auc=61.45% val_score=49.8969 val_score_bestthr=60.0820 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.218, mb=0.475, no=0.990, corr=-0.436) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 60.0820
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1453 mb_mean=0.4766 norm_overlap=0.9869 corr_cb=-0.4919 topkJ=0.0031
[TRAIN][ep=037] loss=0.7297 acc=75.57%
[TRAIN][ep=037] mask_avg: mc_mean=0.1879 mb_mean=0.4751 norm_overlap=0.9897 corr_cb=-0.4207
[EPOCH 037/089] train: loss=0.7297 acc=75.57% | val: loss=0.7653 acc=59.04% f1=70.69% auc=61.34% val_score=38.4759 val_score_bestthr=61.9165 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.188, mb=0.475, no=0.990, corr=-0.421) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.9165
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.1976 mb_mean=0.4725 norm_overlap=0.9888 corr_cb=-0.4051 topkJ=0.0044
[TRAIN][ep=038] loss=0.7177 acc=76.78%
[TRAIN][ep=038] mask_avg: mc_mean=0.1982 mb_mean=0.4751 norm_overlap=0.9899 corr_cb=-0.4299
[EPOCH 038/089] train: loss=0.7177 acc=76.78% | val: loss=0.7772 acc=56.63% f1=69.49% auc=61.69% val_score=38.5363 val_score_bestthr=58.1820 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.198, mb=0.475, no=0.990, corr=-0.430) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.1820
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.1518 mb_mean=0.4760 norm_overlap=0.9893 corr_cb=-0.3967 topkJ=0.0032
[TRAIN][ep=039] loss=0.7107 acc=78.52%
[TRAIN][ep=039] mask_avg: mc_mean=0.2077 mb_mean=0.4751 norm_overlap=0.9902 corr_cb=-0.4288
[EPOCH 039/089] train: loss=0.7107 acc=78.52% | val: loss=0.7745 acc=57.83% f1=70.09% auc=61.86% val_score=41.4861 val_score_bestthr=59.0151 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.208, mb=0.475, no=0.990, corr=-0.429) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 59.0151
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.1792 mb_mean=0.4723 norm_overlap=0.9881 corr_cb=-0.4590 topkJ=0.0028
[TRAIN][ep=040] loss=0.7216 acc=77.18%
[TRAIN][ep=040] mask_avg: mc_mean=0.1694 mb_mean=0.4751 norm_overlap=0.9891 corr_cb=-0.4062
[EPOCH 040/089] train: loss=0.7216 acc=77.18% | val: loss=0.7641 acc=65.06% f1=68.82% auc=62.27% val_score=33.9573 val_score_bestthr=60.1908 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.169, mb=0.475, no=0.989, corr=-0.406) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 60.1908
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.2113 mb_mean=0.4730 norm_overlap=0.9930 corr_cb=-0.3636 topkJ=0.0047
[TRAIN][ep=041] loss=0.7085 acc=77.85%
[TRAIN][ep=041] mask_avg: mc_mean=0.2165 mb_mean=0.4751 norm_overlap=0.9907 corr_cb=-0.4155
[EPOCH 041/089] train: loss=0.7085 acc=77.85% | val: loss=0.7862 acc=56.63% f1=67.86% auc=61.57% val_score=39.3645 val_score_bestthr=58.7637 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.216, mb=0.475, no=0.991, corr=-0.415) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.7637
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.1593 mb_mean=0.4770 norm_overlap=0.9884 corr_cb=-0.4567 topkJ=0.0019
[TRAIN][ep=042] loss=0.6919 acc=78.26%
[TRAIN][ep=042] mask_avg: mc_mean=0.2123 mb_mean=0.4751 norm_overlap=0.9905 corr_cb=-0.4126
[EPOCH 042/089] train: loss=0.6919 acc=78.26% | val: loss=0.7860 acc=57.83% f1=70.09% auc=61.22% val_score=33.9573 val_score_bestthr=57.5812 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.212, mb=0.475, no=0.990, corr=-0.413) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.5812
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.2277 mb_mean=0.4700 norm_overlap=0.9910 corr_cb=-0.3841 topkJ=0.0024
[TRAIN][ep=043] loss=0.6888 acc=79.60%
[TRAIN][ep=043] mask_avg: mc_mean=0.1892 mb_mean=0.4751 norm_overlap=0.9897 corr_cb=-0.4161
[EPOCH 043/089] train: loss=0.6888 acc=79.60% | val: loss=0.7874 acc=56.63% f1=69.49% auc=60.87% val_score=44.0146 val_score_bestthr=58.3873 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.189, mb=0.475, no=0.990, corr=-0.416) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.3873
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2213 mb_mean=0.4723 norm_overlap=0.9916 corr_cb=-0.3528 topkJ=0.0111
[TRAIN][ep=044] loss=0.6707 acc=80.94%
[TRAIN][ep=044] mask_avg: mc_mean=0.2239 mb_mean=0.4751 norm_overlap=0.9911 corr_cb=-0.3989
[EPOCH 044/089] train: loss=0.6707 acc=80.94% | val: loss=0.8002 acc=55.42% f1=69.42% auc=60.76% val_score=44.4332 val_score_bestthr=57.2175 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.224, mb=0.475, no=0.991, corr=-0.399) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.2175
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2112 mb_mean=0.4732 norm_overlap=0.9873 corr_cb=-0.4743 topkJ=0.0035
[TRAIN][ep=045] loss=0.6780 acc=79.46%
[TRAIN][ep=045] mask_avg: mc_mean=0.2044 mb_mean=0.4751 norm_overlap=0.9904 corr_cb=-0.4050
[EPOCH 045/089] train: loss=0.6780 acc=79.46% | val: loss=0.8906 acc=56.63% f1=69.49% auc=60.64% val_score=46.5553 val_score_bestthr=58.3873 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.204, mb=0.475, no=0.990, corr=-0.405) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.3873
[EARLY STOP] no improvement for 30 epochs. best_epoch=15
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/ckpt_best_fold_4.pt
=============== FIT DONE ===============
[BEST] epoch=15 | val_acc=54.22% | val_f1=69.35% | val_auc=57.27% | val_score=36.9873 | val_score_bestthr=62.5593
[TEST@BEST] thr_used=0.325 | acc=71.01% f1=72.22% auc=72.61% | SP_sex=13.59% EO_sex=7.47% SP_age=23.31% EO_age=22.11%
[TIME] 1.14 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/summary_fold_4.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4653 mb_mean=0.4746 norm_overlap=1.0000 corr_cb=0.0009 topkJ=0.0721
[TRAIN][ep=000] loss=0.6948 acc=51.41%
[TRAIN][ep=000] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0577
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4666 mb_mean=0.4760 norm_overlap=1.0000 corr_cb=-0.0804 topkJ=0.0394
[TRAIN][ep=001] loss=0.6935 acc=51.68%
[TRAIN][ep=001] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0520
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4641 mb_mean=0.4759 norm_overlap=0.9999 corr_cb=-0.1516 topkJ=0.0427
[TRAIN][ep=002] loss=0.6919 acc=51.95%
[TRAIN][ep=002] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0518
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4682 mb_mean=0.4728 norm_overlap=1.0000 corr_cb=0.0088 topkJ=0.0867
[TRAIN][ep=003] loss=0.6903 acc=53.96%
[TRAIN][ep=003] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0540
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4660 mb_mean=0.4754 norm_overlap=0.9999 corr_cb=-0.2222 topkJ=0.0188
[TRAIN][ep=004] loss=0.6897 acc=54.90%
[TRAIN][ep=004] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0496
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4691 mb_mean=0.4730 norm_overlap=1.0000 corr_cb=-0.0798 topkJ=0.0197
[TRAIN][ep=005] loss=0.6875 acc=54.09%
[TRAIN][ep=005] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0535
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4653 mb_mean=0.4739 norm_overlap=0.9999 corr_cb=-0.2608 topkJ=0.0412
[TRAIN][ep=006] loss=0.6841 acc=54.36%
[TRAIN][ep=006] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0534
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4637 mb_mean=0.4748 norm_overlap=1.0000 corr_cb=0.0031 topkJ=0.0692
[TRAIN][ep=007] loss=0.6832 acc=56.38%
[TRAIN][ep=007] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0487
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4635 mb_mean=0.4737 norm_overlap=1.0000 corr_cb=0.0553 topkJ=0.0628
[TRAIN][ep=008] loss=0.6802 acc=58.26%
[TRAIN][ep=008] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0575
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4622 mb_mean=0.4769 norm_overlap=1.0000 corr_cb=-0.0556 topkJ=0.0226
[TRAIN][ep=009] loss=0.6746 acc=59.06%
[TRAIN][ep=009] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0557
================= FIT START (fold=4) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4686 mb_mean=0.4721 norm_overlap=0.9999 corr_cb=-0.1822 topkJ=0.0197
[TRAIN][ep=000] loss=0.6702 acc=59.73%
[TRAIN][ep=000] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0534
[EPOCH 000/089] train: loss=0.6702 acc=59.73% | val: loss=0.6787 acc=55.42% f1=69.42% auc=58.37% val_score=50.4958 val_score_bestthr=60.8841 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.053) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 60.8841
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/ckpt_best_fold_4.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4665 mb_mean=0.4758 norm_overlap=0.9999 corr_cb=-0.1292 topkJ=0.0478
[TRAIN][ep=001] loss=0.6623 acc=62.68%
[TRAIN][ep=001] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0547
[EPOCH 001/089] train: loss=0.6623 acc=62.68% | val: loss=0.6767 acc=57.83% f1=70.09% auc=58.95% val_score=39.9204 val_score_bestthr=61.3697 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.055) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 60.8841 -> 61.3697
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/ckpt_best_fold_4.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4682 mb_mean=0.4745 norm_overlap=1.0000 corr_cb=0.0238 topkJ=0.0471
[TRAIN][ep=002] loss=0.6632 acc=59.06%
[TRAIN][ep=002] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0516
[EPOCH 002/089] train: loss=0.6632 acc=59.06% | val: loss=0.6778 acc=56.63% f1=69.49% auc=58.02% val_score=40.6876 val_score_bestthr=61.0366 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.052) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 61.0366
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4654 mb_mean=0.4739 norm_overlap=1.0000 corr_cb=0.0819 topkJ=0.0805
[TRAIN][ep=003] loss=0.6574 acc=61.07%
[TRAIN][ep=003] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0531
[EPOCH 003/089] train: loss=0.6574 acc=61.07% | val: loss=0.6747 acc=56.63% f1=69.49% auc=58.55% val_score=37.5008 val_score_bestthr=61.0366 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.053) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 61.0366
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4650 mb_mean=0.4728 norm_overlap=0.9999 corr_cb=-0.1206 topkJ=0.0236
[TRAIN][ep=004] loss=0.6530 acc=61.88%
[TRAIN][ep=004] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0547
[EPOCH 004/089] train: loss=0.6530 acc=61.88% | val: loss=0.6754 acc=56.63% f1=69.49% auc=58.84% val_score=38.5869 val_score_bestthr=61.0366 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.055) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 61.0366
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4674 mb_mean=0.4747 norm_overlap=0.9999 corr_cb=-0.1348 topkJ=0.0317
[TRAIN][ep=005] loss=1.5411 acc=62.95%
[TRAIN][ep=005] mask_avg: mc_mean=0.3671 mb_mean=0.4751 norm_overlap=0.9990 corr_cb=-0.3378
[EPOCH 005/089] train: loss=1.5411 acc=62.95% | val: loss=0.6773 acc=56.63% f1=68.97% auc=59.19% val_score=51.0255 val_score_bestthr=58.8798 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.367, mb=0.475, no=0.999, corr=-0.338) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 58.8798
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2896 mb_mean=0.4698 norm_overlap=0.9973 corr_cb=-0.4737 topkJ=0.0194
[TRAIN][ep=006] loss=1.5114 acc=64.83%
[TRAIN][ep=006] mask_avg: mc_mean=0.2371 mb_mean=0.4751 norm_overlap=0.9973 corr_cb=-0.3632
[EPOCH 006/089] train: loss=1.5114 acc=64.83% | val: loss=0.6806 acc=55.42% f1=68.91% auc=58.02% val_score=42.6715 val_score_bestthr=59.4716 | dyn(w_pfs=0.240, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.237, mb=0.475, no=0.997, corr=-0.363) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 59.4716
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2390 mb_mean=0.4739 norm_overlap=0.9971 corr_cb=-0.3902 topkJ=0.0117
[TRAIN][ep=007] loss=1.2510 acc=62.68%
[TRAIN][ep=007] mask_avg: mc_mean=0.1905 mb_mean=0.4751 norm_overlap=0.9965 corr_cb=-0.3456
[EPOCH 007/089] train: loss=1.2510 acc=62.68% | val: loss=0.6776 acc=55.42% f1=68.38% auc=57.73% val_score=44.0337 val_score_bestthr=58.0473 | dyn(w_pfs=0.140, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.475, no=0.997, corr=-0.346) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 58.0473
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1614 mb_mean=0.4764 norm_overlap=0.9953 corr_cb=-0.4079 topkJ=0.0180
[TRAIN][ep=008] loss=0.9956 acc=63.62%
[TRAIN][ep=008] mask_avg: mc_mean=0.1598 mb_mean=0.4751 norm_overlap=0.9955 corr_cb=-0.3470
[EPOCH 008/089] train: loss=0.9956 acc=63.62% | val: loss=0.6844 acc=57.83% f1=69.03% auc=59.36% val_score=49.4985 val_score_bestthr=58.1893 | dyn(w_pfs=0.040, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.160, mb=0.475, no=0.996, corr=-0.347) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 58.1893
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1187 mb_mean=0.4786 norm_overlap=0.9934 corr_cb=-0.4126 topkJ=0.0073
[TRAIN][ep=009] loss=0.9235 acc=64.97%
[TRAIN][ep=009] mask_avg: mc_mean=0.1452 mb_mean=0.4751 norm_overlap=0.9948 corr_cb=-0.3573
[EPOCH 009/089] train: loss=0.9235 acc=64.97% | val: loss=0.6787 acc=55.42% f1=68.91% auc=57.85% val_score=42.8608 val_score_bestthr=59.4716 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.145, mb=0.475, no=0.995, corr=-0.357) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 59.4716
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1634 mb_mean=0.4729 norm_overlap=0.9942 corr_cb=-0.4301 topkJ=0.0065
[TRAIN][ep=010] loss=0.9162 acc=64.30%
[TRAIN][ep=010] mask_avg: mc_mean=0.1384 mb_mean=0.4751 norm_overlap=0.9941 corr_cb=-0.3881
[EPOCH 010/089] train: loss=0.9162 acc=64.30% | val: loss=0.7115 acc=55.42% f1=68.38% auc=55.99% val_score=39.3776 val_score_bestthr=59.8140 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.138, mb=0.475, no=0.994, corr=-0.388) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 59.8140
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1374 mb_mean=0.4768 norm_overlap=0.9888 corr_cb=-0.5782 topkJ=0.0004
[TRAIN][ep=011] loss=0.9053 acc=64.43%
[TRAIN][ep=011] mask_avg: mc_mean=0.1439 mb_mean=0.4751 norm_overlap=0.9934 corr_cb=-0.4409
[EPOCH 011/089] train: loss=0.9053 acc=64.43% | val: loss=0.6959 acc=54.22% f1=69.35% auc=57.38% val_score=35.4943 val_score_bestthr=62.5593 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.144, mb=0.475, no=0.993, corr=-0.441) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 61.3697 -> 62.5593
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/ckpt_best_fold_4.pt
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1303 mb_mean=0.4755 norm_overlap=0.9920 corr_cb=-0.4347 topkJ=0.0116
[TRAIN][ep=012] loss=0.9879 acc=66.71%
[TRAIN][ep=012] mask_avg: mc_mean=0.1338 mb_mean=0.4751 norm_overlap=0.9929 corr_cb=-0.4237
[EPOCH 012/089] train: loss=0.9879 acc=66.71% | val: loss=0.6823 acc=55.42% f1=69.42% auc=58.43% val_score=46.8304 val_score_bestthr=58.5609 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.134, mb=0.475, no=0.993, corr=-0.424) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.5609
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1303 mb_mean=0.4743 norm_overlap=0.9907 corr_cb=-0.4988 topkJ=0.0024
[TRAIN][ep=013] loss=1.0980 acc=66.85%
[TRAIN][ep=013] mask_avg: mc_mean=0.1170 mb_mean=0.4751 norm_overlap=0.9914 corr_cb=-0.4358
[EPOCH 013/089] train: loss=1.0980 acc=66.85% | val: loss=0.7093 acc=57.83% f1=69.03% auc=59.59% val_score=58.1893 val_score_bestthr=58.1893 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.117, mb=0.475, no=0.991, corr=-0.436) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.1893
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1330 mb_mean=0.4742 norm_overlap=0.9920 corr_cb=-0.4715 topkJ=0.0093
[TRAIN][ep=014] loss=1.1882 acc=66.17%
[TRAIN][ep=014] mask_avg: mc_mean=0.1255 mb_mean=0.4751 norm_overlap=0.9909 corr_cb=-0.4595
[EPOCH 014/089] train: loss=1.1882 acc=66.17% | val: loss=0.6794 acc=54.22% f1=68.85% auc=59.13% val_score=47.3184 val_score_bestthr=57.8426 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.125, mb=0.475, no=0.991, corr=-0.460) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.8426
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1721 mb_mean=0.4730 norm_overlap=0.9922 corr_cb=-0.4886 topkJ=0.0040
[TRAIN][ep=015] loss=1.2799 acc=66.17%
[TRAIN][ep=015] mask_avg: mc_mean=0.1357 mb_mean=0.4751 norm_overlap=0.9905 corr_cb=-0.4801
[EPOCH 015/089] train: loss=1.2799 acc=66.17% | val: loss=0.7458 acc=54.22% f1=69.35% auc=57.09% val_score=39.5013 val_score_bestthr=62.5593 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.136, mb=0.475, no=0.990, corr=-0.480) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 62.5593
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1434 mb_mean=0.4758 norm_overlap=0.9897 corr_cb=-0.5150 topkJ=0.0012
[TRAIN][ep=016] loss=1.3707 acc=69.13%
[TRAIN][ep=016] mask_avg: mc_mean=0.1406 mb_mean=0.4751 norm_overlap=0.9900 corr_cb=-0.4860
[EPOCH 016/089] train: loss=1.3707 acc=69.13% | val: loss=0.6969 acc=54.22% f1=68.85% auc=58.43% val_score=41.1907 val_score_bestthr=57.8426 | dyn(w_pfs=0.100, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.141, mb=0.475, no=0.990, corr=-0.486) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.8426
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1210 mb_mean=0.4750 norm_overlap=0.9894 corr_cb=-0.4631 topkJ=0.0039
[TRAIN][ep=017] loss=1.1226 acc=67.52%
[TRAIN][ep=017] mask_avg: mc_mean=0.1421 mb_mean=0.4751 norm_overlap=0.9897 corr_cb=-0.4561
[EPOCH 017/089] train: loss=1.1226 acc=67.52% | val: loss=0.7369 acc=54.22% f1=69.35% auc=58.08% val_score=35.2367 val_score_bestthr=62.5593 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.142, mb=0.475, no=0.990, corr=-0.456) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 62.5593
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1088 mb_mean=0.4762 norm_overlap=0.9896 corr_cb=-0.4205 topkJ=0.0015
[TRAIN][ep=018] loss=0.8652 acc=69.40%
[TRAIN][ep=018] mask_avg: mc_mean=0.1306 mb_mean=0.4751 norm_overlap=0.9879 corr_cb=-0.5076
[EPOCH 018/089] train: loss=0.8652 acc=69.40% | val: loss=0.7286 acc=56.63% f1=68.42% auc=60.99% val_score=53.6131 val_score_bestthr=58.2662 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.131, mb=0.475, no=0.988, corr=-0.508) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.2662
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1439 mb_mean=0.4778 norm_overlap=0.9909 corr_cb=-0.5416 topkJ=0.0000
[TRAIN][ep=019] loss=0.8543 acc=67.92%
[TRAIN][ep=019] mask_avg: mc_mean=0.1781 mb_mean=0.4751 norm_overlap=0.9898 corr_cb=-0.4974
[EPOCH 019/089] train: loss=0.8543 acc=67.92% | val: loss=0.7489 acc=56.63% f1=68.42% auc=61.40% val_score=53.7367 val_score_bestthr=58.2662 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.178, mb=0.475, no=0.990, corr=-0.497) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.2662
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1442 mb_mean=0.4735 norm_overlap=0.9900 corr_cb=-0.4812 topkJ=0.0016
[TRAIN][ep=020] loss=0.8474 acc=70.60%
[TRAIN][ep=020] mask_avg: mc_mean=0.1572 mb_mean=0.4751 norm_overlap=0.9884 corr_cb=-0.5177
[EPOCH 020/089] train: loss=0.8474 acc=70.60% | val: loss=0.6877 acc=53.01% f1=68.80% auc=61.92% val_score=45.8690 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.157, mb=0.475, no=0.988, corr=-0.518) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2314 mb_mean=0.4739 norm_overlap=0.9890 corr_cb=-0.5916 topkJ=0.0000
[TRAIN][ep=021] loss=0.8282 acc=70.74%
[TRAIN][ep=021] mask_avg: mc_mean=0.1733 mb_mean=0.4751 norm_overlap=0.9890 corr_cb=-0.4886
[EPOCH 021/089] train: loss=0.8282 acc=70.74% | val: loss=0.7003 acc=53.01% f1=68.80% auc=60.93% val_score=48.9430 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.173, mb=0.475, no=0.989, corr=-0.489) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1581 mb_mean=0.4744 norm_overlap=0.9893 corr_cb=-0.4803 topkJ=0.0036
[TRAIN][ep=022] loss=0.8249 acc=68.72%
[TRAIN][ep=022] mask_avg: mc_mean=0.1470 mb_mean=0.4751 norm_overlap=0.9880 corr_cb=-0.4640
[EPOCH 022/089] train: loss=0.8249 acc=68.72% | val: loss=0.7062 acc=53.01% f1=68.80% auc=61.45% val_score=49.5005 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.147, mb=0.475, no=0.988, corr=-0.464) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2137 mb_mean=0.4735 norm_overlap=0.9912 corr_cb=-0.4874 topkJ=0.0092
[TRAIN][ep=023] loss=0.8189 acc=72.21%
[TRAIN][ep=023] mask_avg: mc_mean=0.1758 mb_mean=0.4751 norm_overlap=0.9893 corr_cb=-0.4602
[EPOCH 023/089] train: loss=0.8189 acc=72.21% | val: loss=0.7180 acc=53.01% f1=68.80% auc=61.51% val_score=48.6990 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.176, mb=0.475, no=0.989, corr=-0.460) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1923 mb_mean=0.4758 norm_overlap=0.9872 corr_cb=-0.6238 topkJ=0.0000
[TRAIN][ep=024] loss=0.8049 acc=73.42%
[TRAIN][ep=024] mask_avg: mc_mean=0.1763 mb_mean=0.4751 norm_overlap=0.9890 corr_cb=-0.4722
[EPOCH 024/089] train: loss=0.8049 acc=73.42% | val: loss=0.7089 acc=53.01% f1=68.80% auc=61.74% val_score=51.5606 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.176, mb=0.475, no=0.989, corr=-0.472) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1729 mb_mean=0.4754 norm_overlap=0.9919 corr_cb=-0.3852 topkJ=0.0137
[TRAIN][ep=025] loss=0.8010 acc=71.28%
[TRAIN][ep=025] mask_avg: mc_mean=0.1936 mb_mean=0.4751 norm_overlap=0.9898 corr_cb=-0.4521
[EPOCH 025/089] train: loss=0.8010 acc=71.28% | val: loss=0.7134 acc=53.01% f1=68.80% auc=61.51% val_score=51.2544 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.194, mb=0.475, no=0.990, corr=-0.452) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1868 mb_mean=0.4756 norm_overlap=0.9918 corr_cb=-0.4445 topkJ=0.0063
[TRAIN][ep=026] loss=0.7985 acc=72.75%
[TRAIN][ep=026] mask_avg: mc_mean=0.1876 mb_mean=0.4751 norm_overlap=0.9894 corr_cb=-0.4574
[EPOCH 026/089] train: loss=0.7985 acc=72.75% | val: loss=0.7142 acc=53.01% f1=68.80% auc=61.80% val_score=48.2047 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.188, mb=0.475, no=0.989, corr=-0.457) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1589 mb_mean=0.4761 norm_overlap=0.9817 corr_cb=-0.5440 topkJ=0.0036
[TRAIN][ep=027] loss=0.7869 acc=71.95%
[TRAIN][ep=027] mask_avg: mc_mean=0.1672 mb_mean=0.4751 norm_overlap=0.9886 corr_cb=-0.4519
[EPOCH 027/089] train: loss=0.7869 acc=71.95% | val: loss=0.7134 acc=54.22% f1=68.33% auc=61.92% val_score=51.1333 val_score_bestthr=55.6869 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.167, mb=0.475, no=0.989, corr=-0.452) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 55.6869
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1839 mb_mean=0.4761 norm_overlap=0.9886 corr_cb=-0.4756 topkJ=0.0113
[TRAIN][ep=028] loss=0.7796 acc=74.63%
[TRAIN][ep=028] mask_avg: mc_mean=0.2046 mb_mean=0.4751 norm_overlap=0.9900 corr_cb=-0.4560
[EPOCH 028/089] train: loss=0.7796 acc=74.63% | val: loss=0.7234 acc=55.42% f1=68.91% auc=61.92% val_score=53.4187 val_score_bestthr=57.1837 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.205, mb=0.475, no=0.990, corr=-0.456) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.1837
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2146 mb_mean=0.4731 norm_overlap=0.9910 corr_cb=-0.3860 topkJ=0.0048
[TRAIN][ep=029] loss=0.7863 acc=73.56%
[TRAIN][ep=029] mask_avg: mc_mean=0.1753 mb_mean=0.4751 norm_overlap=0.9887 corr_cb=-0.4526
[EPOCH 029/089] train: loss=0.7863 acc=73.56% | val: loss=0.7226 acc=63.86% f1=67.39% auc=61.40% val_score=42.6436 val_score_bestthr=56.9468 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.175, mb=0.475, no=0.989, corr=-0.453) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 56.9468
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2053 mb_mean=0.4709 norm_overlap=0.9937 corr_cb=-0.2906 topkJ=0.0238
[TRAIN][ep=030] loss=0.7747 acc=73.42%
[TRAIN][ep=030] mask_avg: mc_mean=0.1792 mb_mean=0.4751 norm_overlap=0.9886 corr_cb=-0.4647
[EPOCH 030/089] train: loss=0.7747 acc=73.42% | val: loss=0.7224 acc=62.65% f1=66.67% auc=61.63% val_score=51.9197 val_score_bestthr=57.0901 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.179, mb=0.475, no=0.989, corr=-0.465) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.0901
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2102 mb_mean=0.4752 norm_overlap=0.9900 corr_cb=-0.5222 topkJ=0.0039
[TRAIN][ep=031] loss=0.7591 acc=74.36%
[TRAIN][ep=031] mask_avg: mc_mean=0.1904 mb_mean=0.4751 norm_overlap=0.9891 corr_cb=-0.4545
[EPOCH 031/089] train: loss=0.7591 acc=74.36% | val: loss=0.7306 acc=62.65% f1=66.67% auc=61.57% val_score=39.0335 val_score_bestthr=57.0901 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.475, no=0.989, corr=-0.454) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.0901
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2123 mb_mean=0.4761 norm_overlap=0.9893 corr_cb=-0.5079 topkJ=0.0008
[TRAIN][ep=032] loss=0.7652 acc=74.50%
[TRAIN][ep=032] mask_avg: mc_mean=0.1963 mb_mean=0.4751 norm_overlap=0.9895 corr_cb=-0.4455
[EPOCH 032/089] train: loss=0.7652 acc=74.50% | val: loss=0.7355 acc=62.65% f1=66.67% auc=61.51% val_score=41.6754 val_score_bestthr=57.0901 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.196, mb=0.475, no=0.990, corr=-0.446) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.0901
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1932 mb_mean=0.4763 norm_overlap=0.9888 corr_cb=-0.4490 topkJ=0.0004
[TRAIN][ep=033] loss=0.7468 acc=75.44%
[TRAIN][ep=033] mask_avg: mc_mean=0.2054 mb_mean=0.4751 norm_overlap=0.9897 corr_cb=-0.4513
[EPOCH 033/089] train: loss=0.7468 acc=75.44% | val: loss=0.7414 acc=65.06% f1=68.13% auc=61.34% val_score=41.6754 val_score_bestthr=58.0568 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.205, mb=0.475, no=0.990, corr=-0.451) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.0568
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2130 mb_mean=0.4751 norm_overlap=0.9886 corr_cb=-0.4479 topkJ=0.0020
[TRAIN][ep=034] loss=0.7540 acc=75.57%
[TRAIN][ep=034] mask_avg: mc_mean=0.1954 mb_mean=0.4751 norm_overlap=0.9893 corr_cb=-0.4329
[EPOCH 034/089] train: loss=0.7540 acc=75.57% | val: loss=0.7266 acc=55.42% f1=69.42% auc=61.16% val_score=43.1041 val_score_bestthr=57.2175 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.195, mb=0.475, no=0.989, corr=-0.433) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.2175
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.0789 mb_mean=0.4732 norm_overlap=0.9895 corr_cb=-0.3134 topkJ=0.0123
[TRAIN][ep=035] loss=0.7437 acc=74.63%
[TRAIN][ep=035] mask_avg: mc_mean=0.1989 mb_mean=0.4751 norm_overlap=0.9896 corr_cb=-0.4250
[EPOCH 035/089] train: loss=0.7437 acc=74.63% | val: loss=0.7387 acc=57.83% f1=69.03% auc=62.38% val_score=51.9197 val_score_bestthr=56.7803 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.199, mb=0.475, no=0.990, corr=-0.425) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 56.7803
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2884 mb_mean=0.4753 norm_overlap=0.9927 corr_cb=-0.3618 topkJ=0.0145
[TRAIN][ep=036] loss=0.7312 acc=75.03%
[TRAIN][ep=036] mask_avg: mc_mean=0.2168 mb_mean=0.4751 norm_overlap=0.9903 corr_cb=-0.4338
[EPOCH 036/089] train: loss=0.7312 acc=75.03% | val: loss=0.7394 acc=56.63% f1=69.49% auc=61.22% val_score=49.8969 val_score_bestthr=60.0820 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.217, mb=0.475, no=0.990, corr=-0.434) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 60.0820
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1451 mb_mean=0.4766 norm_overlap=0.9869 corr_cb=-0.4886 topkJ=0.0031
[TRAIN][ep=037] loss=0.7314 acc=75.70%
[TRAIN][ep=037] mask_avg: mc_mean=0.1875 mb_mean=0.4751 norm_overlap=0.9897 corr_cb=-0.4194
[EPOCH 037/089] train: loss=0.7314 acc=75.70% | val: loss=0.7628 acc=57.83% f1=70.09% auc=61.57% val_score=38.4077 val_score_bestthr=61.0818 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.187, mb=0.475, no=0.990, corr=-0.419) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.0818
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.1955 mb_mean=0.4725 norm_overlap=0.9887 corr_cb=-0.4051 topkJ=0.0040
[TRAIN][ep=038] loss=0.7199 acc=76.64%
[TRAIN][ep=038] mask_avg: mc_mean=0.1983 mb_mean=0.4751 norm_overlap=0.9899 corr_cb=-0.4294
[EPOCH 038/089] train: loss=0.7199 acc=76.64% | val: loss=0.7739 acc=56.63% f1=69.49% auc=61.86% val_score=38.5363 val_score_bestthr=58.1820 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.198, mb=0.475, no=0.990, corr=-0.429) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.1820
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.1509 mb_mean=0.4760 norm_overlap=0.9892 corr_cb=-0.3979 topkJ=0.0032
[TRAIN][ep=039] loss=0.7122 acc=78.66%
[TRAIN][ep=039] mask_avg: mc_mean=0.2082 mb_mean=0.4751 norm_overlap=0.9902 corr_cb=-0.4279
[EPOCH 039/089] train: loss=0.7122 acc=78.66% | val: loss=0.7714 acc=56.63% f1=69.49% auc=61.74% val_score=41.4861 val_score_bestthr=57.5154 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.208, mb=0.475, no=0.990, corr=-0.428) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.5154
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.1801 mb_mean=0.4723 norm_overlap=0.9881 corr_cb=-0.4596 topkJ=0.0032
[TRAIN][ep=040] loss=0.7230 acc=77.18%
[TRAIN][ep=040] mask_avg: mc_mean=0.1703 mb_mean=0.4751 norm_overlap=0.9892 corr_cb=-0.4046
[EPOCH 040/089] train: loss=0.7230 acc=77.18% | val: loss=0.7614 acc=65.06% f1=68.82% auc=62.27% val_score=33.9573 val_score_bestthr=60.1908 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.170, mb=0.475, no=0.989, corr=-0.405) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 60.1908
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.2090 mb_mean=0.4730 norm_overlap=0.9930 corr_cb=-0.3612 topkJ=0.0043
[TRAIN][ep=041] loss=0.7102 acc=77.99%
[TRAIN][ep=041] mask_avg: mc_mean=0.2169 mb_mean=0.4751 norm_overlap=0.9907 corr_cb=-0.4140
[EPOCH 041/089] train: loss=0.7102 acc=77.99% | val: loss=0.7832 acc=56.63% f1=67.86% auc=61.51% val_score=40.0491 val_score_bestthr=58.7637 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.217, mb=0.475, no=0.991, corr=-0.414) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.7637
[EARLY STOP] no improvement for 30 epochs. best_epoch=11
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/ckpt_best_fold_4.pt
=============== FIT DONE ===============
[BEST] epoch=11 | val_acc=54.22% | val_f1=69.35% | val_auc=57.38% | val_score=35.4943 | val_score_bestthr=62.5593
[TEST@BEST] thr_used=0.375 | acc=68.60% f1=73.25% auc=71.31% | SP_sex=13.59% EO_sex=10.92% SP_age=18.59% EO_age=20.07%
[TIME] 0.99 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/summary_fold_4.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4653 mb_mean=0.4746 norm_overlap=1.0000 corr_cb=0.0009 topkJ=0.0721
[TRAIN][ep=000] loss=0.6948 acc=51.41%
[TRAIN][ep=000] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0577
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4666 mb_mean=0.4760 norm_overlap=1.0000 corr_cb=-0.0804 topkJ=0.0394
[TRAIN][ep=001] loss=0.6935 acc=51.54%
[TRAIN][ep=001] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0520
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4641 mb_mean=0.4759 norm_overlap=0.9999 corr_cb=-0.1516 topkJ=0.0427
[TRAIN][ep=002] loss=0.6919 acc=51.95%
[TRAIN][ep=002] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0518
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4682 mb_mean=0.4728 norm_overlap=1.0000 corr_cb=0.0088 topkJ=0.0867
[TRAIN][ep=003] loss=0.6903 acc=53.96%
[TRAIN][ep=003] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0540
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4660 mb_mean=0.4754 norm_overlap=0.9999 corr_cb=-0.2222 topkJ=0.0188
[TRAIN][ep=004] loss=0.6897 acc=55.03%
[TRAIN][ep=004] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0496
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4691 mb_mean=0.4730 norm_overlap=1.0000 corr_cb=-0.0798 topkJ=0.0197
[TRAIN][ep=005] loss=0.6875 acc=54.09%
[TRAIN][ep=005] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0535
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4653 mb_mean=0.4739 norm_overlap=0.9999 corr_cb=-0.2608 topkJ=0.0412
[TRAIN][ep=006] loss=0.6841 acc=54.36%
[TRAIN][ep=006] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0534
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4637 mb_mean=0.4748 norm_overlap=1.0000 corr_cb=0.0031 topkJ=0.0692
[TRAIN][ep=007] loss=0.6832 acc=56.38%
[TRAIN][ep=007] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0487
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4635 mb_mean=0.4737 norm_overlap=1.0000 corr_cb=0.0553 topkJ=0.0628
[TRAIN][ep=008] loss=0.6802 acc=58.12%
[TRAIN][ep=008] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0575
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4622 mb_mean=0.4769 norm_overlap=1.0000 corr_cb=-0.0556 topkJ=0.0226
[TRAIN][ep=009] loss=0.6747 acc=59.06%
[TRAIN][ep=009] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0557
================= FIT START (fold=4) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4686 mb_mean=0.4721 norm_overlap=0.9999 corr_cb=-0.1822 topkJ=0.0197
[TRAIN][ep=000] loss=0.6702 acc=59.73%
[TRAIN][ep=000] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0534
[EPOCH 000/089] train: loss=0.6702 acc=59.73% | val: loss=0.6786 acc=55.42% f1=69.42% auc=58.37% val_score=50.4958 val_score_bestthr=60.8841 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.053) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 60.8841
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/ckpt_best_fold_4.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4665 mb_mean=0.4758 norm_overlap=0.9999 corr_cb=-0.1292 topkJ=0.0478
[TRAIN][ep=001] loss=0.6624 acc=62.82%
[TRAIN][ep=001] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0547
[EPOCH 001/089] train: loss=0.6624 acc=62.82% | val: loss=0.6767 acc=57.83% f1=70.09% auc=59.13% val_score=39.3346 val_score_bestthr=61.3697 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.055) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 60.8841 -> 61.3697
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/ckpt_best_fold_4.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4682 mb_mean=0.4745 norm_overlap=1.0000 corr_cb=0.0238 topkJ=0.0471
[TRAIN][ep=002] loss=0.6633 acc=59.06%
[TRAIN][ep=002] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0516
[EPOCH 002/089] train: loss=0.6633 acc=59.06% | val: loss=0.6778 acc=56.63% f1=69.49% auc=58.08% val_score=40.6876 val_score_bestthr=61.0366 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.052) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 61.0366
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4654 mb_mean=0.4739 norm_overlap=1.0000 corr_cb=0.0819 topkJ=0.0805
[TRAIN][ep=003] loss=0.6575 acc=60.94%
[TRAIN][ep=003] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0531
[EPOCH 003/089] train: loss=0.6575 acc=60.94% | val: loss=0.6747 acc=56.63% f1=69.49% auc=58.43% val_score=37.5008 val_score_bestthr=61.0366 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.053) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 61.0366
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4650 mb_mean=0.4728 norm_overlap=0.9999 corr_cb=-0.1206 topkJ=0.0236
[TRAIN][ep=004] loss=0.6531 acc=61.74%
[TRAIN][ep=004] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0547
[EPOCH 004/089] train: loss=0.6531 acc=61.74% | val: loss=0.6755 acc=56.63% f1=69.49% auc=58.78% val_score=38.5869 val_score_bestthr=61.0366 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.055) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 61.0366
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4674 mb_mean=0.4747 norm_overlap=0.9999 corr_cb=-0.1348 topkJ=0.0317
[TRAIN][ep=005] loss=1.4813 acc=62.95%
[TRAIN][ep=005] mask_avg: mc_mean=0.3657 mb_mean=0.4751 norm_overlap=0.9990 corr_cb=-0.3380
[EPOCH 005/089] train: loss=1.4813 acc=62.95% | val: loss=0.6774 acc=56.63% f1=68.97% auc=59.30% val_score=51.0255 val_score_bestthr=58.8798 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.366, mb=0.475, no=0.999, corr=-0.338) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 58.8798
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2878 mb_mean=0.4698 norm_overlap=0.9973 corr_cb=-0.4735 topkJ=0.0194
[TRAIN][ep=006] loss=1.4531 acc=64.56%
[TRAIN][ep=006] mask_avg: mc_mean=0.2358 mb_mean=0.4751 norm_overlap=0.9973 corr_cb=-0.3634
[EPOCH 006/089] train: loss=1.4531 acc=64.56% | val: loss=0.6806 acc=55.42% f1=68.91% auc=58.02% val_score=41.5244 val_score_bestthr=59.4716 | dyn(w_pfs=0.240, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.236, mb=0.475, no=0.997, corr=-0.363) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 59.4716
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2380 mb_mean=0.4739 norm_overlap=0.9971 corr_cb=-0.3903 topkJ=0.0117
[TRAIN][ep=007] loss=1.2160 acc=62.82%
[TRAIN][ep=007] mask_avg: mc_mean=0.1898 mb_mean=0.4751 norm_overlap=0.9965 corr_cb=-0.3457
[EPOCH 007/089] train: loss=1.2160 acc=62.82% | val: loss=0.6777 acc=55.42% f1=68.38% auc=57.67% val_score=44.0337 val_score_bestthr=58.0473 | dyn(w_pfs=0.140, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.475, no=0.996, corr=-0.346) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 58.0473
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1613 mb_mean=0.4764 norm_overlap=0.9953 corr_cb=-0.4077 topkJ=0.0180
[TRAIN][ep=008] loss=0.9839 acc=63.76%
[TRAIN][ep=008] mask_avg: mc_mean=0.1598 mb_mean=0.4751 norm_overlap=0.9955 corr_cb=-0.3471
[EPOCH 008/089] train: loss=0.9839 acc=63.76% | val: loss=0.6845 acc=57.83% f1=69.03% auc=59.36% val_score=49.4985 val_score_bestthr=58.1893 | dyn(w_pfs=0.040, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.160, mb=0.475, no=0.996, corr=-0.347) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 58.1893
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1187 mb_mean=0.4786 norm_overlap=0.9934 corr_cb=-0.4131 topkJ=0.0073
[TRAIN][ep=009] loss=0.9235 acc=64.83%
[TRAIN][ep=009] mask_avg: mc_mean=0.1452 mb_mean=0.4751 norm_overlap=0.9948 corr_cb=-0.3576
[EPOCH 009/089] train: loss=0.9235 acc=64.83% | val: loss=0.6789 acc=55.42% f1=68.91% auc=57.91% val_score=42.8608 val_score_bestthr=59.4716 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.145, mb=0.475, no=0.995, corr=-0.358) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 59.4716
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1635 mb_mean=0.4729 norm_overlap=0.9942 corr_cb=-0.4306 topkJ=0.0065
[TRAIN][ep=010] loss=0.9162 acc=64.30%
[TRAIN][ep=010] mask_avg: mc_mean=0.1386 mb_mean=0.4751 norm_overlap=0.9941 corr_cb=-0.3887
[EPOCH 010/089] train: loss=0.9162 acc=64.30% | val: loss=0.7115 acc=55.42% f1=68.38% auc=55.99% val_score=39.3776 val_score_bestthr=59.8140 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.139, mb=0.475, no=0.994, corr=-0.389) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 59.8140
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1375 mb_mean=0.4768 norm_overlap=0.9888 corr_cb=-0.5788 topkJ=0.0004
[TRAIN][ep=011] loss=0.9053 acc=64.43%
[TRAIN][ep=011] mask_avg: mc_mean=0.1440 mb_mean=0.4751 norm_overlap=0.9934 corr_cb=-0.4414
[EPOCH 011/089] train: loss=0.9053 acc=64.43% | val: loss=0.6962 acc=54.22% f1=69.35% auc=57.44% val_score=35.4943 val_score_bestthr=62.5593 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.144, mb=0.475, no=0.993, corr=-0.441) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 61.3697 -> 62.5593
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/ckpt_best_fold_4.pt
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1306 mb_mean=0.4755 norm_overlap=0.9920 corr_cb=-0.4356 topkJ=0.0116
[TRAIN][ep=012] loss=0.9786 acc=66.85%
[TRAIN][ep=012] mask_avg: mc_mean=0.1347 mb_mean=0.4751 norm_overlap=0.9929 corr_cb=-0.4238
[EPOCH 012/089] train: loss=0.9786 acc=66.85% | val: loss=0.6827 acc=55.42% f1=69.42% auc=58.26% val_score=46.8304 val_score_bestthr=58.5609 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.135, mb=0.475, no=0.993, corr=-0.424) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.5609
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1311 mb_mean=0.4743 norm_overlap=0.9907 corr_cb=-0.4994 topkJ=0.0024
[TRAIN][ep=013] loss=1.0794 acc=66.71%
[TRAIN][ep=013] mask_avg: mc_mean=0.1174 mb_mean=0.4751 norm_overlap=0.9914 corr_cb=-0.4363
[EPOCH 013/089] train: loss=1.0794 acc=66.71% | val: loss=0.7096 acc=57.83% f1=69.03% auc=59.65% val_score=58.1893 val_score_bestthr=58.1893 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.117, mb=0.475, no=0.991, corr=-0.436) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.1893
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1331 mb_mean=0.4742 norm_overlap=0.9920 corr_cb=-0.4722 topkJ=0.0093
[TRAIN][ep=014] loss=1.1602 acc=66.31%
[TRAIN][ep=014] mask_avg: mc_mean=0.1257 mb_mean=0.4751 norm_overlap=0.9909 corr_cb=-0.4605
[EPOCH 014/089] train: loss=1.1602 acc=66.31% | val: loss=0.6798 acc=54.22% f1=68.85% auc=59.13% val_score=47.3184 val_score_bestthr=57.8426 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.126, mb=0.475, no=0.991, corr=-0.461) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.8426
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1723 mb_mean=0.4730 norm_overlap=0.9922 corr_cb=-0.4888 topkJ=0.0040
[TRAIN][ep=015] loss=1.2426 acc=66.17%
[TRAIN][ep=015] mask_avg: mc_mean=0.1361 mb_mean=0.4751 norm_overlap=0.9905 corr_cb=-0.4805
[EPOCH 015/089] train: loss=1.2426 acc=66.17% | val: loss=0.7467 acc=54.22% f1=69.35% auc=57.09% val_score=39.5013 val_score_bestthr=62.5593 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.136, mb=0.475, no=0.990, corr=-0.481) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 62.5593
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1438 mb_mean=0.4758 norm_overlap=0.9897 corr_cb=-0.5161 topkJ=0.0012
[TRAIN][ep=016] loss=1.3239 acc=69.26%
[TRAIN][ep=016] mask_avg: mc_mean=0.1408 mb_mean=0.4751 norm_overlap=0.9900 corr_cb=-0.4863
[EPOCH 016/089] train: loss=1.3239 acc=69.26% | val: loss=0.6976 acc=54.22% f1=69.35% auc=58.26% val_score=40.0945 val_score_bestthr=62.5593 | dyn(w_pfs=0.100, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.141, mb=0.475, no=0.990, corr=-0.486) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 62.5593
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1211 mb_mean=0.4750 norm_overlap=0.9894 corr_cb=-0.4631 topkJ=0.0039
[TRAIN][ep=017] loss=1.0993 acc=67.52%
[TRAIN][ep=017] mask_avg: mc_mean=0.1429 mb_mean=0.4751 norm_overlap=0.9897 corr_cb=-0.4571
[EPOCH 017/089] train: loss=1.0993 acc=67.52% | val: loss=0.7381 acc=54.22% f1=69.35% auc=58.08% val_score=35.2367 val_score_bestthr=62.5593 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.143, mb=0.475, no=0.990, corr=-0.457) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 62.5593
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1083 mb_mean=0.4762 norm_overlap=0.9896 corr_cb=-0.4217 topkJ=0.0015
[TRAIN][ep=018] loss=0.8650 acc=69.53%
[TRAIN][ep=018] mask_avg: mc_mean=0.1301 mb_mean=0.4751 norm_overlap=0.9878 corr_cb=-0.5081
[EPOCH 018/089] train: loss=0.8650 acc=69.53% | val: loss=0.7293 acc=56.63% f1=68.42% auc=60.87% val_score=53.6131 val_score_bestthr=58.2662 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.130, mb=0.475, no=0.988, corr=-0.508) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.2662
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1437 mb_mean=0.4778 norm_overlap=0.9909 corr_cb=-0.5436 topkJ=0.0000
[TRAIN][ep=019] loss=0.8540 acc=67.79%
[TRAIN][ep=019] mask_avg: mc_mean=0.1782 mb_mean=0.4751 norm_overlap=0.9898 corr_cb=-0.4982
[EPOCH 019/089] train: loss=0.8540 acc=67.79% | val: loss=0.7491 acc=56.63% f1=68.42% auc=61.34% val_score=53.7367 val_score_bestthr=58.2662 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.178, mb=0.475, no=0.990, corr=-0.498) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.2662
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1447 mb_mean=0.4735 norm_overlap=0.9899 corr_cb=-0.4829 topkJ=0.0016
[TRAIN][ep=020] loss=0.8470 acc=70.47%
[TRAIN][ep=020] mask_avg: mc_mean=0.1579 mb_mean=0.4751 norm_overlap=0.9884 corr_cb=-0.5187
[EPOCH 020/089] train: loss=0.8470 acc=70.47% | val: loss=0.6881 acc=53.01% f1=68.80% auc=61.92% val_score=45.3893 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.158, mb=0.475, no=0.988, corr=-0.519) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2321 mb_mean=0.4739 norm_overlap=0.9890 corr_cb=-0.5925 topkJ=0.0000
[TRAIN][ep=021] loss=0.8276 acc=70.60%
[TRAIN][ep=021] mask_avg: mc_mean=0.1740 mb_mean=0.4751 norm_overlap=0.9891 corr_cb=-0.4897
[EPOCH 021/089] train: loss=0.8276 acc=70.60% | val: loss=0.7014 acc=53.01% f1=68.80% auc=61.05% val_score=48.9430 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.174, mb=0.475, no=0.989, corr=-0.490) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1594 mb_mean=0.4744 norm_overlap=0.9894 corr_cb=-0.4821 topkJ=0.0036
[TRAIN][ep=022] loss=0.8245 acc=68.72%
[TRAIN][ep=022] mask_avg: mc_mean=0.1472 mb_mean=0.4751 norm_overlap=0.9880 corr_cb=-0.4648
[EPOCH 022/089] train: loss=0.8245 acc=68.72% | val: loss=0.7065 acc=53.01% f1=68.80% auc=61.63% val_score=50.9811 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.147, mb=0.475, no=0.988, corr=-0.465) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2124 mb_mean=0.4735 norm_overlap=0.9912 corr_cb=-0.4872 topkJ=0.0088
[TRAIN][ep=023] loss=0.8182 acc=72.21%
[TRAIN][ep=023] mask_avg: mc_mean=0.1752 mb_mean=0.4751 norm_overlap=0.9892 corr_cb=-0.4608
[EPOCH 023/089] train: loss=0.8182 acc=72.21% | val: loss=0.7183 acc=53.01% f1=68.80% auc=61.40% val_score=48.4607 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.175, mb=0.475, no=0.989, corr=-0.461) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1920 mb_mean=0.4758 norm_overlap=0.9872 corr_cb=-0.6239 topkJ=0.0000
[TRAIN][ep=024] loss=0.8041 acc=73.42%
[TRAIN][ep=024] mask_avg: mc_mean=0.1758 mb_mean=0.4751 norm_overlap=0.9889 corr_cb=-0.4725
[EPOCH 024/089] train: loss=0.8041 acc=73.42% | val: loss=0.7095 acc=53.01% f1=68.80% auc=61.63% val_score=50.9204 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.176, mb=0.475, no=0.989, corr=-0.472) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1716 mb_mean=0.4754 norm_overlap=0.9919 corr_cb=-0.3845 topkJ=0.0137
[TRAIN][ep=025] loss=0.8000 acc=71.54%
[TRAIN][ep=025] mask_avg: mc_mean=0.1927 mb_mean=0.4751 norm_overlap=0.9897 corr_cb=-0.4526
[EPOCH 025/089] train: loss=0.8000 acc=71.54% | val: loss=0.7143 acc=53.01% f1=68.80% auc=61.63% val_score=51.2544 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.193, mb=0.475, no=0.990, corr=-0.453) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1868 mb_mean=0.4756 norm_overlap=0.9918 corr_cb=-0.4458 topkJ=0.0063
[TRAIN][ep=026] loss=0.7973 acc=72.62%
[TRAIN][ep=026] mask_avg: mc_mean=0.1869 mb_mean=0.4751 norm_overlap=0.9894 corr_cb=-0.4579
[EPOCH 026/089] train: loss=0.7973 acc=72.62% | val: loss=0.7149 acc=53.01% f1=68.80% auc=61.86% val_score=48.2047 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.187, mb=0.475, no=0.989, corr=-0.458) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1597 mb_mean=0.4761 norm_overlap=0.9818 corr_cb=-0.5435 topkJ=0.0036
[TRAIN][ep=027] loss=0.7857 acc=72.08%
[TRAIN][ep=027] mask_avg: mc_mean=0.1670 mb_mean=0.4751 norm_overlap=0.9886 corr_cb=-0.4524
[EPOCH 027/089] train: loss=0.7857 acc=72.08% | val: loss=0.7142 acc=53.01% f1=68.80% auc=61.63% val_score=51.1333 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.167, mb=0.475, no=0.989, corr=-0.452) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1834 mb_mean=0.4761 norm_overlap=0.9886 corr_cb=-0.4757 topkJ=0.0109
[TRAIN][ep=028] loss=0.7782 acc=74.63%
[TRAIN][ep=028] mask_avg: mc_mean=0.2037 mb_mean=0.4751 norm_overlap=0.9900 corr_cb=-0.4563
[EPOCH 028/089] train: loss=0.7782 acc=74.63% | val: loss=0.7245 acc=55.42% f1=68.91% auc=61.92% val_score=50.0373 val_score_bestthr=57.1837 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.204, mb=0.475, no=0.990, corr=-0.456) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.1837
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2144 mb_mean=0.4731 norm_overlap=0.9910 corr_cb=-0.3867 topkJ=0.0044
[TRAIN][ep=029] loss=0.7844 acc=73.69%
[TRAIN][ep=029] mask_avg: mc_mean=0.1754 mb_mean=0.4751 norm_overlap=0.9887 corr_cb=-0.4528
[EPOCH 029/089] train: loss=0.7844 acc=73.69% | val: loss=0.7246 acc=63.86% f1=67.39% auc=61.34% val_score=42.6436 val_score_bestthr=56.9468 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.175, mb=0.475, no=0.989, corr=-0.453) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 56.9468
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2051 mb_mean=0.4709 norm_overlap=0.9937 corr_cb=-0.2903 topkJ=0.0246
[TRAIN][ep=030] loss=0.7734 acc=73.15%
[TRAIN][ep=030] mask_avg: mc_mean=0.1781 mb_mean=0.4751 norm_overlap=0.9886 corr_cb=-0.4644
[EPOCH 030/089] train: loss=0.7734 acc=73.15% | val: loss=0.7239 acc=62.65% f1=66.67% auc=61.40% val_score=51.8000 val_score_bestthr=57.0901 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.178, mb=0.475, no=0.989, corr=-0.464) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.0901
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2094 mb_mean=0.4752 norm_overlap=0.9900 corr_cb=-0.5226 topkJ=0.0039
[TRAIN][ep=031] loss=0.7575 acc=74.77%
[TRAIN][ep=031] mask_avg: mc_mean=0.1902 mb_mean=0.4751 norm_overlap=0.9891 corr_cb=-0.4541
[EPOCH 031/089] train: loss=0.7575 acc=74.77% | val: loss=0.7322 acc=61.45% f1=65.96% auc=61.40% val_score=44.8736 val_score_bestthr=56.2613 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.475, no=0.989, corr=-0.454) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 56.2613
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2095 mb_mean=0.4761 norm_overlap=0.9892 corr_cb=-0.5083 topkJ=0.0008
[TRAIN][ep=032] loss=0.7633 acc=74.23%
[TRAIN][ep=032] mask_avg: mc_mean=0.1952 mb_mean=0.4751 norm_overlap=0.9895 corr_cb=-0.4455
[EPOCH 032/089] train: loss=0.7633 acc=74.23% | val: loss=0.7361 acc=61.45% f1=65.96% auc=61.22% val_score=40.1527 val_score_bestthr=56.9064 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.195, mb=0.475, no=0.989, corr=-0.446) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 56.9064
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1896 mb_mean=0.4763 norm_overlap=0.9887 corr_cb=-0.4489 topkJ=0.0004
[TRAIN][ep=033] loss=0.7452 acc=75.57%
[TRAIN][ep=033] mask_avg: mc_mean=0.2048 mb_mean=0.4751 norm_overlap=0.9897 corr_cb=-0.4517
[EPOCH 033/089] train: loss=0.7452 acc=75.57% | val: loss=0.7434 acc=63.86% f1=67.39% auc=61.10% val_score=41.4998 val_score_bestthr=56.9468 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.205, mb=0.475, no=0.990, corr=-0.452) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 56.9468
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2164 mb_mean=0.4751 norm_overlap=0.9887 corr_cb=-0.4491 topkJ=0.0020
[TRAIN][ep=034] loss=0.7525 acc=75.70%
[TRAIN][ep=034] mask_avg: mc_mean=0.1963 mb_mean=0.4751 norm_overlap=0.9894 corr_cb=-0.4328
[EPOCH 034/089] train: loss=0.7525 acc=75.70% | val: loss=0.7280 acc=55.42% f1=69.42% auc=61.22% val_score=45.7372 val_score_bestthr=57.2175 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.196, mb=0.475, no=0.989, corr=-0.433) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.2175
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.0795 mb_mean=0.4732 norm_overlap=0.9895 corr_cb=-0.3129 topkJ=0.0119
[TRAIN][ep=035] loss=0.7416 acc=75.17%
[TRAIN][ep=035] mask_avg: mc_mean=0.2004 mb_mean=0.4751 norm_overlap=0.9897 corr_cb=-0.4248
[EPOCH 035/089] train: loss=0.7416 acc=75.17% | val: loss=0.7400 acc=63.86% f1=66.67% auc=62.15% val_score=46.9772 val_score_bestthr=56.1453 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.200, mb=0.475, no=0.990, corr=-0.425) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 56.1453
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2905 mb_mean=0.4753 norm_overlap=0.9927 corr_cb=-0.3621 topkJ=0.0145
[TRAIN][ep=036] loss=0.7294 acc=74.90%
[TRAIN][ep=036] mask_avg: mc_mean=0.2170 mb_mean=0.4751 norm_overlap=0.9903 corr_cb=-0.4343
[EPOCH 036/089] train: loss=0.7294 acc=74.90% | val: loss=0.7410 acc=56.63% f1=69.49% auc=61.45% val_score=49.8969 val_score_bestthr=60.0820 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.217, mb=0.475, no=0.990, corr=-0.434) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 60.0820
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1445 mb_mean=0.4766 norm_overlap=0.9868 corr_cb=-0.4891 topkJ=0.0031
[TRAIN][ep=037] loss=0.7293 acc=75.70%
[TRAIN][ep=037] mask_avg: mc_mean=0.1885 mb_mean=0.4751 norm_overlap=0.9897 corr_cb=-0.4203
[EPOCH 037/089] train: loss=0.7293 acc=75.70% | val: loss=0.7649 acc=62.65% f1=66.67% auc=61.63% val_score=38.4759 val_score_bestthr=56.0333 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.188, mb=0.475, no=0.990, corr=-0.420) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 56.0333
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.1979 mb_mean=0.4725 norm_overlap=0.9887 corr_cb=-0.4063 topkJ=0.0040
[TRAIN][ep=038] loss=0.7176 acc=77.05%
[TRAIN][ep=038] mask_avg: mc_mean=0.1986 mb_mean=0.4751 norm_overlap=0.9900 corr_cb=-0.4293
[EPOCH 038/089] train: loss=0.7176 acc=77.05% | val: loss=0.7779 acc=59.04% f1=70.18% auc=61.86% val_score=36.9073 val_score_bestthr=57.3317 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.199, mb=0.475, no=0.990, corr=-0.429) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.3317
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.1538 mb_mean=0.4760 norm_overlap=0.9893 corr_cb=-0.3974 topkJ=0.0032
[TRAIN][ep=039] loss=0.7102 acc=78.66%
[TRAIN][ep=039] mask_avg: mc_mean=0.2086 mb_mean=0.4751 norm_overlap=0.9902 corr_cb=-0.4279
[EPOCH 039/089] train: loss=0.7102 acc=78.66% | val: loss=0.7753 acc=55.42% f1=69.42% auc=61.63% val_score=41.4861 val_score_bestthr=57.2175 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.209, mb=0.475, no=0.990, corr=-0.428) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.2175
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.1838 mb_mean=0.4723 norm_overlap=0.9884 corr_cb=-0.4576 topkJ=0.0032
[TRAIN][ep=040] loss=0.7209 acc=76.91%
[TRAIN][ep=040] mask_avg: mc_mean=0.1707 mb_mean=0.4751 norm_overlap=0.9892 corr_cb=-0.4041
[EPOCH 040/089] train: loss=0.7209 acc=76.91% | val: loss=0.7629 acc=56.63% f1=70.00% auc=62.03% val_score=32.8519 val_score_bestthr=57.5483 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.171, mb=0.475, no=0.989, corr=-0.404) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.5483
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.2108 mb_mean=0.4730 norm_overlap=0.9931 corr_cb=-0.3606 topkJ=0.0043
[TRAIN][ep=041] loss=0.7077 acc=77.58%
[TRAIN][ep=041] mask_avg: mc_mean=0.2169 mb_mean=0.4751 norm_overlap=0.9907 corr_cb=-0.4143
[EPOCH 041/089] train: loss=0.7077 acc=77.58% | val: loss=0.7846 acc=56.63% f1=70.00% auc=61.80% val_score=33.9573 val_score_bestthr=58.7149 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.217, mb=0.475, no=0.991, corr=-0.414) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.7149
[EARLY STOP] no improvement for 30 epochs. best_epoch=11
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/ckpt_best_fold_4.pt
=============== FIT DONE ===============
[BEST] epoch=11 | val_acc=54.22% | val_f1=69.35% | val_auc=57.44% | val_score=35.4943 | val_score_bestthr=62.5593
[TEST@BEST] thr_used=0.375 | acc=69.08% f1=73.55% auc=71.29% | SP_sex=14.13% EO_sex=10.92% SP_age=16.95% EO_age=20.07%
[TIME] 0.96 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/summary_fold_4.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4653 mb_mean=0.4746 norm_overlap=1.0000 corr_cb=0.0009 topkJ=0.0721
[TRAIN][ep=000] loss=0.6948 acc=51.41%
[TRAIN][ep=000] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0577
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4666 mb_mean=0.4760 norm_overlap=1.0000 corr_cb=-0.0804 topkJ=0.0394
[TRAIN][ep=001] loss=0.6935 acc=51.54%
[TRAIN][ep=001] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0520
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4641 mb_mean=0.4759 norm_overlap=0.9999 corr_cb=-0.1516 topkJ=0.0427
[TRAIN][ep=002] loss=0.6919 acc=51.95%
[TRAIN][ep=002] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0518
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4682 mb_mean=0.4728 norm_overlap=1.0000 corr_cb=0.0088 topkJ=0.0867
[TRAIN][ep=003] loss=0.6903 acc=53.96%
[TRAIN][ep=003] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0540
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4660 mb_mean=0.4754 norm_overlap=0.9999 corr_cb=-0.2222 topkJ=0.0188
[TRAIN][ep=004] loss=0.6897 acc=55.03%
[TRAIN][ep=004] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0496
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4691 mb_mean=0.4730 norm_overlap=1.0000 corr_cb=-0.0798 topkJ=0.0197
[TRAIN][ep=005] loss=0.6875 acc=54.09%
[TRAIN][ep=005] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0535
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4653 mb_mean=0.4739 norm_overlap=0.9999 corr_cb=-0.2608 topkJ=0.0412
[TRAIN][ep=006] loss=0.6841 acc=54.36%
[TRAIN][ep=006] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0534
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4637 mb_mean=0.4748 norm_overlap=1.0000 corr_cb=0.0031 topkJ=0.0692
[TRAIN][ep=007] loss=0.6832 acc=56.38%
[TRAIN][ep=007] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0487
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4635 mb_mean=0.4737 norm_overlap=1.0000 corr_cb=0.0553 topkJ=0.0628
[TRAIN][ep=008] loss=0.6802 acc=58.12%
[TRAIN][ep=008] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0575
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4622 mb_mean=0.4769 norm_overlap=1.0000 corr_cb=-0.0556 topkJ=0.0226
[TRAIN][ep=009] loss=0.6747 acc=59.06%
[TRAIN][ep=009] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0557
================= FIT START (fold=4) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4686 mb_mean=0.4721 norm_overlap=0.9999 corr_cb=-0.1822 topkJ=0.0197
[TRAIN][ep=000] loss=0.6702 acc=59.73%
[TRAIN][ep=000] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0534
[EPOCH 000/089] train: loss=0.6702 acc=59.73% | val: loss=0.6786 acc=55.42% f1=69.42% auc=58.37% val_score=50.4958 val_score_bestthr=60.8841 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.053) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 60.8841
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/ckpt_best_fold_4.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4665 mb_mean=0.4758 norm_overlap=0.9999 corr_cb=-0.1292 topkJ=0.0478
[TRAIN][ep=001] loss=0.6624 acc=62.82%
[TRAIN][ep=001] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0547
[EPOCH 001/089] train: loss=0.6624 acc=62.82% | val: loss=0.6767 acc=57.83% f1=70.09% auc=59.13% val_score=39.3346 val_score_bestthr=61.3697 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.055) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 60.8841 -> 61.3697
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/ckpt_best_fold_4.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4682 mb_mean=0.4745 norm_overlap=1.0000 corr_cb=0.0238 topkJ=0.0471
[TRAIN][ep=002] loss=0.6633 acc=59.06%
[TRAIN][ep=002] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0516
[EPOCH 002/089] train: loss=0.6633 acc=59.06% | val: loss=0.6778 acc=56.63% f1=69.49% auc=58.08% val_score=40.6876 val_score_bestthr=61.0366 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.052) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 61.0366
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4654 mb_mean=0.4739 norm_overlap=1.0000 corr_cb=0.0819 topkJ=0.0805
[TRAIN][ep=003] loss=0.6575 acc=60.94%
[TRAIN][ep=003] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0531
[EPOCH 003/089] train: loss=0.6575 acc=60.94% | val: loss=0.6747 acc=56.63% f1=69.49% auc=58.43% val_score=37.5008 val_score_bestthr=61.0366 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.053) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 61.0366
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4650 mb_mean=0.4728 norm_overlap=0.9999 corr_cb=-0.1206 topkJ=0.0236
[TRAIN][ep=004] loss=0.6531 acc=61.74%
[TRAIN][ep=004] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0547
[EPOCH 004/089] train: loss=0.6531 acc=61.74% | val: loss=0.6755 acc=56.63% f1=69.49% auc=58.78% val_score=38.5869 val_score_bestthr=61.0366 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.055) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 61.0366
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4674 mb_mean=0.4747 norm_overlap=0.9999 corr_cb=-0.1348 topkJ=0.0317
[TRAIN][ep=005] loss=1.2407 acc=62.82%
[TRAIN][ep=005] mask_avg: mc_mean=0.3635 mb_mean=0.4751 norm_overlap=0.9989 corr_cb=-0.3381
[EPOCH 005/089] train: loss=1.2407 acc=62.82% | val: loss=0.6772 acc=56.63% f1=68.97% auc=59.24% val_score=51.9494 val_score_bestthr=58.8798 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.364, mb=0.475, no=0.999, corr=-0.338) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 58.8798
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2853 mb_mean=0.4698 norm_overlap=0.9973 corr_cb=-0.4732 topkJ=0.0194
[TRAIN][ep=006] loss=1.2193 acc=64.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.2342 mb_mean=0.4751 norm_overlap=0.9973 corr_cb=-0.3633
[EPOCH 006/089] train: loss=1.2193 acc=64.70% | val: loss=0.6808 acc=55.42% f1=68.91% auc=57.85% val_score=41.5244 val_score_bestthr=59.4716 | dyn(w_pfs=0.240, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.234, mb=0.475, no=0.997, corr=-0.363) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 59.4716
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2370 mb_mean=0.4739 norm_overlap=0.9971 corr_cb=-0.3896 topkJ=0.0117
[TRAIN][ep=007] loss=1.0171 acc=62.68%
[TRAIN][ep=007] mask_avg: mc_mean=0.1890 mb_mean=0.4751 norm_overlap=0.9965 corr_cb=-0.3456
[EPOCH 007/089] train: loss=1.0171 acc=62.68% | val: loss=0.6780 acc=55.42% f1=68.38% auc=57.56% val_score=44.0337 val_score_bestthr=58.0473 | dyn(w_pfs=0.140, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.189, mb=0.475, no=0.996, corr=-0.346) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 58.0473
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1603 mb_mean=0.4764 norm_overlap=0.9953 corr_cb=-0.4070 topkJ=0.0180
[TRAIN][ep=008] loss=0.8202 acc=63.62%
[TRAIN][ep=008] mask_avg: mc_mean=0.1593 mb_mean=0.4751 norm_overlap=0.9955 corr_cb=-0.3471
[EPOCH 008/089] train: loss=0.8202 acc=63.62% | val: loss=0.6845 acc=57.83% f1=69.03% auc=59.42% val_score=49.4985 val_score_bestthr=58.1893 | dyn(w_pfs=0.040, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.159, mb=0.475, no=0.996, corr=-0.347) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 58.1893
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1186 mb_mean=0.4786 norm_overlap=0.9934 corr_cb=-0.4132 topkJ=0.0073
[TRAIN][ep=009] loss=0.7775 acc=65.23%
[TRAIN][ep=009] mask_avg: mc_mean=0.1450 mb_mean=0.4751 norm_overlap=0.9948 corr_cb=-0.3578
[EPOCH 009/089] train: loss=0.7775 acc=65.23% | val: loss=0.6795 acc=55.42% f1=68.91% auc=57.91% val_score=41.5605 val_score_bestthr=59.4716 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.145, mb=0.475, no=0.995, corr=-0.358) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 59.4716
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1632 mb_mean=0.4729 norm_overlap=0.9942 corr_cb=-0.4309 topkJ=0.0065
[TRAIN][ep=010] loss=0.7701 acc=63.89%
[TRAIN][ep=010] mask_avg: mc_mean=0.1383 mb_mean=0.4751 norm_overlap=0.9940 corr_cb=-0.3893
[EPOCH 010/089] train: loss=0.7701 acc=63.89% | val: loss=0.7103 acc=55.42% f1=68.38% auc=55.87% val_score=39.3776 val_score_bestthr=59.8140 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.138, mb=0.475, no=0.994, corr=-0.389) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 59.8140
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1374 mb_mean=0.4768 norm_overlap=0.9887 corr_cb=-0.5803 topkJ=0.0004
[TRAIN][ep=011] loss=0.7595 acc=64.83%
[TRAIN][ep=011] mask_avg: mc_mean=0.1435 mb_mean=0.4751 norm_overlap=0.9934 corr_cb=-0.4425
[EPOCH 011/089] train: loss=0.7595 acc=64.83% | val: loss=0.6966 acc=54.22% f1=68.85% auc=57.56% val_score=35.4943 val_score_bestthr=57.8426 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.144, mb=0.475, no=0.993, corr=-0.442) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 57.8426
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1298 mb_mean=0.4755 norm_overlap=0.9920 corr_cb=-0.4363 topkJ=0.0116
[TRAIN][ep=012] loss=0.7387 acc=66.85%
[TRAIN][ep=012] mask_avg: mc_mean=0.1358 mb_mean=0.4751 norm_overlap=0.9930 corr_cb=-0.4204
[EPOCH 012/089] train: loss=0.7387 acc=66.85% | val: loss=0.6837 acc=55.42% f1=69.42% auc=58.31% val_score=47.9255 val_score_bestthr=58.5609 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.136, mb=0.475, no=0.993, corr=-0.420) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 58.5609
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1346 mb_mean=0.4743 norm_overlap=0.9910 corr_cb=-0.4895 topkJ=0.0024
[TRAIN][ep=013] loss=0.7456 acc=66.98%
[TRAIN][ep=013] mask_avg: mc_mean=0.1210 mb_mean=0.4751 norm_overlap=0.9917 corr_cb=-0.4246
[EPOCH 013/089] train: loss=0.7456 acc=66.98% | val: loss=0.7085 acc=57.83% f1=69.03% auc=59.30% val_score=51.3428 val_score_bestthr=58.1893 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.121, mb=0.475, no=0.992, corr=-0.425) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 58.1893
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1403 mb_mean=0.4742 norm_overlap=0.9925 corr_cb=-0.4526 topkJ=0.0101
[TRAIN][ep=014] loss=0.7346 acc=66.31%
[TRAIN][ep=014] mask_avg: mc_mean=0.1355 mb_mean=0.4751 norm_overlap=0.9915 corr_cb=-0.4399
[EPOCH 014/089] train: loss=0.7346 acc=66.31% | val: loss=0.6834 acc=54.22% f1=68.85% auc=58.95% val_score=48.2392 val_score_bestthr=57.8426 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.135, mb=0.475, no=0.992, corr=-0.440) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 57.8426
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1836 mb_mean=0.4730 norm_overlap=0.9927 corr_cb=-0.4674 topkJ=0.0040
[TRAIN][ep=015] loss=0.7271 acc=66.98%
[TRAIN][ep=015] mask_avg: mc_mean=0.1426 mb_mean=0.4751 norm_overlap=0.9910 corr_cb=-0.4539
[EPOCH 015/089] train: loss=0.7271 acc=66.98% | val: loss=0.7464 acc=54.22% f1=69.35% auc=57.62% val_score=38.2867 val_score_bestthr=62.5593 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.143, mb=0.475, no=0.991, corr=-0.454) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 61.3697 -> 62.5593
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/ckpt_best_fold_4.pt
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1510 mb_mean=0.4758 norm_overlap=0.9902 corr_cb=-0.4898 topkJ=0.0012
[TRAIN][ep=016] loss=0.7987 acc=68.99%
[TRAIN][ep=016] mask_avg: mc_mean=0.1415 mb_mean=0.4751 norm_overlap=0.9902 corr_cb=-0.4688
[EPOCH 016/089] train: loss=0.7987 acc=68.99% | val: loss=0.6996 acc=54.22% f1=69.35% auc=58.02% val_score=39.6854 val_score_bestthr=62.5593 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.142, mb=0.475, no=0.990, corr=-0.469) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 62.5593
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1198 mb_mean=0.4750 norm_overlap=0.9895 corr_cb=-0.4518 topkJ=0.0043
[TRAIN][ep=017] loss=0.8837 acc=68.19%
[TRAIN][ep=017] mask_avg: mc_mean=0.1373 mb_mean=0.4751 norm_overlap=0.9896 corr_cb=-0.4478
[EPOCH 017/089] train: loss=0.8837 acc=68.19% | val: loss=0.7332 acc=54.22% f1=69.35% auc=58.26% val_score=35.8144 val_score_bestthr=62.5593 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.137, mb=0.475, no=0.990, corr=-0.448) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 62.5593
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1006 mb_mean=0.4762 norm_overlap=0.9892 corr_cb=-0.4142 topkJ=0.0012
[TRAIN][ep=018] loss=0.9562 acc=69.53%
[TRAIN][ep=018] mask_avg: mc_mean=0.1237 mb_mean=0.4751 norm_overlap=0.9875 corr_cb=-0.5056
[EPOCH 018/089] train: loss=0.9562 acc=69.53% | val: loss=0.7286 acc=56.63% f1=68.42% auc=60.81% val_score=53.6131 val_score_bestthr=58.2662 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.124, mb=0.475, no=0.988, corr=-0.506) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.2662
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1350 mb_mean=0.4778 norm_overlap=0.9904 corr_cb=-0.5498 topkJ=0.0004
[TRAIN][ep=019] loss=1.0256 acc=67.65%
[TRAIN][ep=019] mask_avg: mc_mean=0.1721 mb_mean=0.4751 norm_overlap=0.9895 corr_cb=-0.5076
[EPOCH 019/089] train: loss=1.0256 acc=67.65% | val: loss=0.7477 acc=56.63% f1=68.42% auc=61.28% val_score=58.2662 val_score_bestthr=58.2662 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.172, mb=0.475, no=0.989, corr=-0.508) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.2662
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1437 mb_mean=0.4735 norm_overlap=0.9897 corr_cb=-0.4950 topkJ=0.0016
[TRAIN][ep=020] loss=1.0967 acc=69.40%
[TRAIN][ep=020] mask_avg: mc_mean=0.1507 mb_mean=0.4751 norm_overlap=0.9879 corr_cb=-0.5291
[EPOCH 020/089] train: loss=1.0967 acc=69.40% | val: loss=0.6840 acc=62.65% f1=65.93% auc=61.80% val_score=45.3893 val_score_bestthr=54.6247 | dyn(w_pfs=0.100, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.151, mb=0.475, no=0.988, corr=-0.529) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 54.6247
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2227 mb_mean=0.4739 norm_overlap=0.9886 corr_cb=-0.5992 topkJ=0.0000
[TRAIN][ep=021] loss=0.8792 acc=70.47%
[TRAIN][ep=021] mask_avg: mc_mean=0.1757 mb_mean=0.4751 norm_overlap=0.9890 corr_cb=-0.5025
[EPOCH 021/089] train: loss=0.8792 acc=70.47% | val: loss=0.6980 acc=53.01% f1=68.80% auc=60.87% val_score=51.2162 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.176, mb=0.475, no=0.989, corr=-0.502) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1587 mb_mean=0.4744 norm_overlap=0.9892 corr_cb=-0.4913 topkJ=0.0036
[TRAIN][ep=022] loss=0.6822 acc=68.99%
[TRAIN][ep=022] mask_avg: mc_mean=0.1465 mb_mean=0.4751 norm_overlap=0.9879 corr_cb=-0.4699
[EPOCH 022/089] train: loss=0.6822 acc=68.99% | val: loss=0.7049 acc=53.01% f1=68.80% auc=61.51% val_score=51.6211 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.147, mb=0.475, no=0.988, corr=-0.470) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2113 mb_mean=0.4735 norm_overlap=0.9911 corr_cb=-0.4914 topkJ=0.0084
[TRAIN][ep=023] loss=0.6763 acc=72.21%
[TRAIN][ep=023] mask_avg: mc_mean=0.1750 mb_mean=0.4751 norm_overlap=0.9892 corr_cb=-0.4632
[EPOCH 023/089] train: loss=0.6763 acc=72.21% | val: loss=0.7168 acc=53.01% f1=68.80% auc=61.40% val_score=48.4607 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.175, mb=0.475, no=0.989, corr=-0.463) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1905 mb_mean=0.4758 norm_overlap=0.9872 corr_cb=-0.6234 topkJ=0.0000
[TRAIN][ep=024] loss=0.6622 acc=73.56%
[TRAIN][ep=024] mask_avg: mc_mean=0.1753 mb_mean=0.4751 norm_overlap=0.9889 corr_cb=-0.4737
[EPOCH 024/089] train: loss=0.6622 acc=73.56% | val: loss=0.7086 acc=53.01% f1=68.80% auc=61.74% val_score=51.5606 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.175, mb=0.475, no=0.989, corr=-0.474) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1716 mb_mean=0.4754 norm_overlap=0.9919 corr_cb=-0.3863 topkJ=0.0137
[TRAIN][ep=025] loss=0.6587 acc=71.28%
[TRAIN][ep=025] mask_avg: mc_mean=0.1927 mb_mean=0.4751 norm_overlap=0.9897 corr_cb=-0.4544
[EPOCH 025/089] train: loss=0.6587 acc=71.28% | val: loss=0.7142 acc=53.01% f1=68.80% auc=61.63% val_score=49.8969 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.193, mb=0.475, no=0.990, corr=-0.454) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1852 mb_mean=0.4756 norm_overlap=0.9917 corr_cb=-0.4473 topkJ=0.0055
[TRAIN][ep=026] loss=0.6567 acc=72.48%
[TRAIN][ep=026] mask_avg: mc_mean=0.1869 mb_mean=0.4751 norm_overlap=0.9894 corr_cb=-0.4595
[EPOCH 026/089] train: loss=0.6567 acc=72.48% | val: loss=0.7152 acc=53.01% f1=68.80% auc=61.74% val_score=51.3791 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.187, mb=0.475, no=0.989, corr=-0.460) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1580 mb_mean=0.4761 norm_overlap=0.9816 corr_cb=-0.5457 topkJ=0.0036
[TRAIN][ep=027] loss=0.6468 acc=72.08%
[TRAIN][ep=027] mask_avg: mc_mean=0.1658 mb_mean=0.4751 norm_overlap=0.9885 corr_cb=-0.4538
[EPOCH 027/089] train: loss=0.6468 acc=72.08% | val: loss=0.7136 acc=53.01% f1=68.80% auc=61.80% val_score=51.1333 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.166, mb=0.475, no=0.988, corr=-0.454) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1817 mb_mean=0.4761 norm_overlap=0.9885 corr_cb=-0.4778 topkJ=0.0113
[TRAIN][ep=028] loss=0.6393 acc=74.63%
[TRAIN][ep=028] mask_avg: mc_mean=0.2029 mb_mean=0.4751 norm_overlap=0.9899 corr_cb=-0.4583
[EPOCH 028/089] train: loss=0.6393 acc=74.63% | val: loss=0.7248 acc=55.42% f1=68.91% auc=61.63% val_score=52.0812 val_score_bestthr=57.1837 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.203, mb=0.475, no=0.990, corr=-0.458) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.1837
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2129 mb_mean=0.4731 norm_overlap=0.9909 corr_cb=-0.3919 topkJ=0.0044
[TRAIN][ep=029] loss=0.6464 acc=74.23%
[TRAIN][ep=029] mask_avg: mc_mean=0.1751 mb_mean=0.4751 norm_overlap=0.9886 corr_cb=-0.4554
[EPOCH 029/089] train: loss=0.6464 acc=74.23% | val: loss=0.7252 acc=63.86% f1=67.39% auc=61.45% val_score=42.6436 val_score_bestthr=56.9468 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.175, mb=0.475, no=0.989, corr=-0.455) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 56.9468
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2033 mb_mean=0.4709 norm_overlap=0.9936 corr_cb=-0.2940 topkJ=0.0238
[TRAIN][ep=030] loss=0.6363 acc=73.15%
[TRAIN][ep=030] mask_avg: mc_mean=0.1773 mb_mean=0.4751 norm_overlap=0.9885 corr_cb=-0.4664
[EPOCH 030/089] train: loss=0.6363 acc=73.15% | val: loss=0.7235 acc=62.65% f1=66.67% auc=61.51% val_score=44.0146 val_score_bestthr=57.0901 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.177, mb=0.475, no=0.988, corr=-0.466) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.0901
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2099 mb_mean=0.4752 norm_overlap=0.9899 corr_cb=-0.5236 topkJ=0.0051
[TRAIN][ep=031] loss=0.6218 acc=74.63%
[TRAIN][ep=031] mask_avg: mc_mean=0.1896 mb_mean=0.4751 norm_overlap=0.9890 corr_cb=-0.4570
[EPOCH 031/089] train: loss=0.6218 acc=74.63% | val: loss=0.7325 acc=62.65% f1=66.67% auc=61.10% val_score=38.1474 val_score_bestthr=57.0901 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.475, no=0.989, corr=-0.457) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.0901
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2118 mb_mean=0.4761 norm_overlap=0.9891 corr_cb=-0.5140 topkJ=0.0008
[TRAIN][ep=032] loss=0.6281 acc=74.77%
[TRAIN][ep=032] mask_avg: mc_mean=0.1946 mb_mean=0.4751 norm_overlap=0.9894 corr_cb=-0.4477
[EPOCH 032/089] train: loss=0.6281 acc=74.77% | val: loss=0.7347 acc=62.65% f1=66.67% auc=61.45% val_score=40.3917 val_score_bestthr=57.0901 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.195, mb=0.475, no=0.989, corr=-0.448) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.0901
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1908 mb_mean=0.4763 norm_overlap=0.9887 corr_cb=-0.4519 topkJ=0.0004
[TRAIN][ep=033] loss=0.6096 acc=75.70%
[TRAIN][ep=033] mask_avg: mc_mean=0.2050 mb_mean=0.4751 norm_overlap=0.9896 corr_cb=-0.4533
[EPOCH 033/089] train: loss=0.6096 acc=75.70% | val: loss=0.7447 acc=55.42% f1=68.91% auc=61.10% val_score=41.6754 val_score_bestthr=56.6837 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.205, mb=0.475, no=0.990, corr=-0.453) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 56.6837
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2128 mb_mean=0.4751 norm_overlap=0.9886 corr_cb=-0.4501 topkJ=0.0020
[TRAIN][ep=034] loss=0.6169 acc=75.44%
[TRAIN][ep=034] mask_avg: mc_mean=0.1957 mb_mean=0.4751 norm_overlap=0.9893 corr_cb=-0.4353
[EPOCH 034/089] train: loss=0.6169 acc=75.44% | val: loss=0.7292 acc=55.42% f1=68.91% auc=61.16% val_score=45.7372 val_score_bestthr=57.1837 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.196, mb=0.475, no=0.989, corr=-0.435) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.1837
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.0814 mb_mean=0.4732 norm_overlap=0.9896 corr_cb=-0.3158 topkJ=0.0115
[TRAIN][ep=035] loss=0.6062 acc=75.03%
[TRAIN][ep=035] mask_avg: mc_mean=0.1992 mb_mean=0.4751 norm_overlap=0.9897 corr_cb=-0.4271
[EPOCH 035/089] train: loss=0.6062 acc=75.03% | val: loss=0.7423 acc=59.04% f1=70.18% auc=62.03% val_score=51.9197 val_score_bestthr=57.3317 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.199, mb=0.475, no=0.990, corr=-0.427) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.3317
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2896 mb_mean=0.4753 norm_overlap=0.9927 corr_cb=-0.3606 topkJ=0.0145
[TRAIN][ep=036] loss=0.5972 acc=75.03%
[TRAIN][ep=036] mask_avg: mc_mean=0.2162 mb_mean=0.4751 norm_overlap=0.9903 corr_cb=-0.4359
[EPOCH 036/089] train: loss=0.5972 acc=75.03% | val: loss=0.7426 acc=56.63% f1=69.49% auc=61.34% val_score=49.8969 val_score_bestthr=60.0820 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.216, mb=0.475, no=0.990, corr=-0.436) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 60.0820
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1431 mb_mean=0.4766 norm_overlap=0.9867 corr_cb=-0.4914 topkJ=0.0031
[TRAIN][ep=037] loss=0.5982 acc=75.57%
[TRAIN][ep=037] mask_avg: mc_mean=0.1866 mb_mean=0.4751 norm_overlap=0.9896 corr_cb=-0.4217
[EPOCH 037/089] train: loss=0.5982 acc=75.57% | val: loss=0.7634 acc=55.42% f1=68.91% auc=61.63% val_score=38.0025 val_score_bestthr=56.6837 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.187, mb=0.475, no=0.990, corr=-0.422) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 56.6837
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.1946 mb_mean=0.4725 norm_overlap=0.9887 corr_cb=-0.4045 topkJ=0.0044
[TRAIN][ep=038] loss=0.5880 acc=77.18%
[TRAIN][ep=038] mask_avg: mc_mean=0.1966 mb_mean=0.4751 norm_overlap=0.9898 corr_cb=-0.4313
[EPOCH 038/089] train: loss=0.5880 acc=77.18% | val: loss=0.7742 acc=55.42% f1=68.91% auc=61.63% val_score=39.5220 val_score_bestthr=56.6837 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.197, mb=0.475, no=0.990, corr=-0.431) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 56.6837
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.1470 mb_mean=0.4760 norm_overlap=0.9891 corr_cb=-0.3953 topkJ=0.0032
[TRAIN][ep=039] loss=0.5798 acc=78.66%
[TRAIN][ep=039] mask_avg: mc_mean=0.2058 mb_mean=0.4751 norm_overlap=0.9901 corr_cb=-0.4301
[EPOCH 039/089] train: loss=0.5798 acc=78.66% | val: loss=0.7710 acc=55.42% f1=69.42% auc=61.34% val_score=35.0517 val_score_bestthr=57.2175 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.206, mb=0.475, no=0.990, corr=-0.430) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.2175
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.1793 mb_mean=0.4723 norm_overlap=0.9881 corr_cb=-0.4619 topkJ=0.0028
[TRAIN][ep=040] loss=0.5892 acc=76.64%
[TRAIN][ep=040] mask_avg: mc_mean=0.1698 mb_mean=0.4751 norm_overlap=0.9891 corr_cb=-0.4080
[EPOCH 040/089] train: loss=0.5892 acc=76.64% | val: loss=0.7656 acc=63.86% f1=66.67% auc=61.80% val_score=33.9573 val_score_bestthr=56.1453 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.170, mb=0.475, no=0.989, corr=-0.408) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 56.1453
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.2075 mb_mean=0.4730 norm_overlap=0.9930 corr_cb=-0.3637 topkJ=0.0047
[TRAIN][ep=041] loss=0.5752 acc=77.72%
[TRAIN][ep=041] mask_avg: mc_mean=0.2140 mb_mean=0.4751 norm_overlap=0.9906 corr_cb=-0.4169
[EPOCH 041/089] train: loss=0.5752 acc=77.72% | val: loss=0.7858 acc=61.45% f1=65.96% auc=61.57% val_score=33.9573 val_score_bestthr=56.9064 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.214, mb=0.475, no=0.991, corr=-0.417) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 56.9064
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.1611 mb_mean=0.4770 norm_overlap=0.9885 corr_cb=-0.4577 topkJ=0.0019
[TRAIN][ep=042] loss=0.5588 acc=78.39%
[TRAIN][ep=042] mask_avg: mc_mean=0.2104 mb_mean=0.4751 norm_overlap=0.9904 corr_cb=-0.4129
[EPOCH 042/089] train: loss=0.5588 acc=78.39% | val: loss=0.7878 acc=54.22% f1=68.85% auc=61.16% val_score=35.2635 val_score_bestthr=57.6940 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.210, mb=0.475, no=0.990, corr=-0.413) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.6940
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.2297 mb_mean=0.4700 norm_overlap=0.9911 corr_cb=-0.3844 topkJ=0.0024
[TRAIN][ep=043] loss=0.5582 acc=79.73%
[TRAIN][ep=043] mask_avg: mc_mean=0.1889 mb_mean=0.4751 norm_overlap=0.9897 corr_cb=-0.4163
[EPOCH 043/089] train: loss=0.5582 acc=79.73% | val: loss=0.7896 acc=55.42% f1=69.42% auc=60.41% val_score=51.9197 val_score_bestthr=58.3567 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.189, mb=0.475, no=0.990, corr=-0.416) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.3567
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2162 mb_mean=0.4723 norm_overlap=0.9915 corr_cb=-0.3517 topkJ=0.0111
[TRAIN][ep=044] loss=0.5407 acc=80.54%
[TRAIN][ep=044] mask_avg: mc_mean=0.2234 mb_mean=0.4751 norm_overlap=0.9910 corr_cb=-0.4016
[EPOCH 044/089] train: loss=0.5407 acc=80.54% | val: loss=0.8022 acc=55.42% f1=69.42% auc=61.05% val_score=33.9573 val_score_bestthr=57.2175 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.223, mb=0.475, no=0.991, corr=-0.402) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.2175
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2117 mb_mean=0.4732 norm_overlap=0.9871 corr_cb=-0.4788 topkJ=0.0035
[TRAIN][ep=045] loss=0.5469 acc=80.27%
[TRAIN][ep=045] mask_avg: mc_mean=0.2029 mb_mean=0.4751 norm_overlap=0.9903 corr_cb=-0.4073
[EPOCH 045/089] train: loss=0.5469 acc=80.27% | val: loss=0.8947 acc=56.63% f1=69.49% auc=60.41% val_score=47.4111 val_score_bestthr=58.3873 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.203, mb=0.475, no=0.990, corr=-0.407) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.3873
[EARLY STOP] no improvement for 30 epochs. best_epoch=15
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/ckpt_best_fold_4.pt
=============== FIT DONE ===============
[BEST] epoch=15 | val_acc=54.22% | val_f1=69.35% | val_auc=57.62% | val_score=38.2867 | val_score_bestthr=62.5593
[TEST@BEST] thr_used=0.340 | acc=71.01% f1=71.43% auc=72.54% | SP_sex=16.85% EO_sex=10.77% SP_age=23.97% EO_age=22.37%
[TIME] 1.30 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/summary_fold_4.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4653 mb_mean=0.4746 norm_overlap=1.0000 corr_cb=0.0009 topkJ=0.0721
[TRAIN][ep=000] loss=0.6948 acc=51.41%
[TRAIN][ep=000] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0577
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4666 mb_mean=0.4760 norm_overlap=1.0000 corr_cb=-0.0804 topkJ=0.0394
[TRAIN][ep=001] loss=0.6935 acc=51.68%
[TRAIN][ep=001] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0520
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4641 mb_mean=0.4759 norm_overlap=0.9999 corr_cb=-0.1516 topkJ=0.0427
[TRAIN][ep=002] loss=0.6919 acc=51.95%
[TRAIN][ep=002] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0518
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4682 mb_mean=0.4728 norm_overlap=1.0000 corr_cb=0.0088 topkJ=0.0867
[TRAIN][ep=003] loss=0.6903 acc=53.96%
[TRAIN][ep=003] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0540
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4660 mb_mean=0.4754 norm_overlap=0.9999 corr_cb=-0.2222 topkJ=0.0188
[TRAIN][ep=004] loss=0.6897 acc=55.17%
[TRAIN][ep=004] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0496
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4691 mb_mean=0.4730 norm_overlap=1.0000 corr_cb=-0.0798 topkJ=0.0197
[TRAIN][ep=005] loss=0.6875 acc=54.09%
[TRAIN][ep=005] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0535
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4653 mb_mean=0.4739 norm_overlap=0.9999 corr_cb=-0.2608 topkJ=0.0412
[TRAIN][ep=006] loss=0.6841 acc=54.36%
[TRAIN][ep=006] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0534
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4637 mb_mean=0.4748 norm_overlap=1.0000 corr_cb=0.0031 topkJ=0.0692
[TRAIN][ep=007] loss=0.6832 acc=56.51%
[TRAIN][ep=007] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0487
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4635 mb_mean=0.4737 norm_overlap=1.0000 corr_cb=0.0553 topkJ=0.0628
[TRAIN][ep=008] loss=0.6801 acc=58.12%
[TRAIN][ep=008] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0575
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4622 mb_mean=0.4769 norm_overlap=1.0000 corr_cb=-0.0556 topkJ=0.0226
[TRAIN][ep=009] loss=0.6746 acc=59.06%
[TRAIN][ep=009] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0557
================= FIT START (fold=4) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4686 mb_mean=0.4721 norm_overlap=0.9999 corr_cb=-0.1822 topkJ=0.0197
[TRAIN][ep=000] loss=0.6701 acc=59.73%
[TRAIN][ep=000] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0534
[EPOCH 000/089] train: loss=0.6701 acc=59.73% | val: loss=0.6787 acc=55.42% f1=69.42% auc=58.20% val_score=50.4958 val_score_bestthr=60.8841 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.053) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 60.8841
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/ckpt_best_fold_4.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4665 mb_mean=0.4758 norm_overlap=0.9999 corr_cb=-0.1292 topkJ=0.0478
[TRAIN][ep=001] loss=0.6622 acc=62.55%
[TRAIN][ep=001] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0547
[EPOCH 001/089] train: loss=0.6622 acc=62.55% | val: loss=0.6768 acc=57.83% f1=70.09% auc=58.90% val_score=39.9204 val_score_bestthr=61.3697 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.055) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 60.8841 -> 61.3697
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/ckpt_best_fold_4.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4682 mb_mean=0.4745 norm_overlap=1.0000 corr_cb=0.0238 topkJ=0.0471
[TRAIN][ep=002] loss=0.6632 acc=59.33%
[TRAIN][ep=002] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0516
[EPOCH 002/089] train: loss=0.6632 acc=59.33% | val: loss=0.6778 acc=56.63% f1=69.49% auc=57.97% val_score=40.6876 val_score_bestthr=61.0366 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.052) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 61.0366
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4654 mb_mean=0.4739 norm_overlap=1.0000 corr_cb=0.0819 topkJ=0.0805
[TRAIN][ep=003] loss=0.6574 acc=61.07%
[TRAIN][ep=003] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0531
[EPOCH 003/089] train: loss=0.6574 acc=61.07% | val: loss=0.6748 acc=56.63% f1=69.49% auc=58.49% val_score=37.5008 val_score_bestthr=61.0366 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.053) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 61.0366
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4650 mb_mean=0.4728 norm_overlap=0.9999 corr_cb=-0.1206 topkJ=0.0236
[TRAIN][ep=004] loss=0.6530 acc=61.74%
[TRAIN][ep=004] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0547
[EPOCH 004/089] train: loss=0.6530 acc=61.74% | val: loss=0.6756 acc=56.63% f1=69.49% auc=58.72% val_score=38.5869 val_score_bestthr=61.0366 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.055) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 61.0366
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4674 mb_mean=0.4747 norm_overlap=0.9999 corr_cb=-0.1348 topkJ=0.0317
[TRAIN][ep=005] loss=1.2969 acc=63.09%
[TRAIN][ep=005] mask_avg: mc_mean=0.3637 mb_mean=0.4751 norm_overlap=0.9989 corr_cb=-0.3381
[EPOCH 005/089] train: loss=1.2969 acc=63.09% | val: loss=0.6775 acc=56.63% f1=68.97% auc=59.24% val_score=51.0255 val_score_bestthr=58.8798 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.364, mb=0.475, no=0.999, corr=-0.338) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 58.8798
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2854 mb_mean=0.4698 norm_overlap=0.9973 corr_cb=-0.4732 topkJ=0.0194
[TRAIN][ep=006] loss=1.2739 acc=64.56%
[TRAIN][ep=006] mask_avg: mc_mean=0.2342 mb_mean=0.4751 norm_overlap=0.9973 corr_cb=-0.3633
[EPOCH 006/089] train: loss=1.2739 acc=64.56% | val: loss=0.6809 acc=55.42% f1=68.38% auc=57.97% val_score=41.5244 val_score_bestthr=58.0473 | dyn(w_pfs=0.240, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.234, mb=0.475, no=0.997, corr=-0.363) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 58.0473
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2370 mb_mean=0.4739 norm_overlap=0.9971 corr_cb=-0.3896 topkJ=0.0117
[TRAIN][ep=007] loss=1.0718 acc=62.42%
[TRAIN][ep=007] mask_avg: mc_mean=0.1893 mb_mean=0.4751 norm_overlap=0.9965 corr_cb=-0.3456
[EPOCH 007/089] train: loss=1.0718 acc=62.42% | val: loss=0.6780 acc=55.42% f1=68.38% auc=57.67% val_score=44.0337 val_score_bestthr=58.0473 | dyn(w_pfs=0.140, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.189, mb=0.475, no=0.996, corr=-0.346) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 58.0473
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1609 mb_mean=0.4764 norm_overlap=0.9953 corr_cb=-0.4071 topkJ=0.0180
[TRAIN][ep=008] loss=0.8749 acc=63.49%
[TRAIN][ep=008] mask_avg: mc_mean=0.1590 mb_mean=0.4751 norm_overlap=0.9955 corr_cb=-0.3470
[EPOCH 008/089] train: loss=0.8749 acc=63.49% | val: loss=0.6850 acc=57.83% f1=69.03% auc=59.42% val_score=49.4985 val_score_bestthr=58.1893 | dyn(w_pfs=0.040, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.159, mb=0.475, no=0.996, corr=-0.347) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 58.1893
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1180 mb_mean=0.4786 norm_overlap=0.9933 corr_cb=-0.4132 topkJ=0.0073
[TRAIN][ep=009] loss=0.8322 acc=65.23%
[TRAIN][ep=009] mask_avg: mc_mean=0.1449 mb_mean=0.4751 norm_overlap=0.9948 corr_cb=-0.3580
[EPOCH 009/089] train: loss=0.8322 acc=65.23% | val: loss=0.6792 acc=55.42% f1=68.91% auc=57.79% val_score=42.8608 val_score_bestthr=59.4716 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.145, mb=0.475, no=0.995, corr=-0.358) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 59.4716
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1634 mb_mean=0.4729 norm_overlap=0.9942 corr_cb=-0.4317 topkJ=0.0065
[TRAIN][ep=010] loss=0.8250 acc=64.30%
[TRAIN][ep=010] mask_avg: mc_mean=0.1386 mb_mean=0.4751 norm_overlap=0.9941 corr_cb=-0.3902
[EPOCH 010/089] train: loss=0.8250 acc=64.30% | val: loss=0.7111 acc=55.42% f1=68.38% auc=55.93% val_score=39.3776 val_score_bestthr=59.8140 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.139, mb=0.475, no=0.994, corr=-0.390) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 59.8140
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1372 mb_mean=0.4768 norm_overlap=0.9888 corr_cb=-0.5795 topkJ=0.0004
[TRAIN][ep=011] loss=0.8142 acc=64.43%
[TRAIN][ep=011] mask_avg: mc_mean=0.1435 mb_mean=0.4751 norm_overlap=0.9934 corr_cb=-0.4428
[EPOCH 011/089] train: loss=0.8142 acc=64.43% | val: loss=0.6964 acc=54.22% f1=68.85% auc=57.44% val_score=35.4943 val_score_bestthr=57.8426 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.144, mb=0.475, no=0.993, corr=-0.443) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 57.8426
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1303 mb_mean=0.4755 norm_overlap=0.9920 corr_cb=-0.4371 topkJ=0.0112
[TRAIN][ep=012] loss=0.7934 acc=67.11%
[TRAIN][ep=012] mask_avg: mc_mean=0.1363 mb_mean=0.4751 norm_overlap=0.9930 corr_cb=-0.4211
[EPOCH 012/089] train: loss=0.7934 acc=67.11% | val: loss=0.6834 acc=55.42% f1=69.42% auc=58.31% val_score=46.8304 val_score_bestthr=58.5609 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.136, mb=0.475, no=0.993, corr=-0.421) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 58.5609
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1348 mb_mean=0.4743 norm_overlap=0.9910 corr_cb=-0.4903 topkJ=0.0024
[TRAIN][ep=013] loss=0.8003 acc=66.98%
[TRAIN][ep=013] mask_avg: mc_mean=0.1213 mb_mean=0.4751 norm_overlap=0.9917 corr_cb=-0.4253
[EPOCH 013/089] train: loss=0.8003 acc=66.98% | val: loss=0.7088 acc=57.83% f1=69.03% auc=59.36% val_score=51.3428 val_score_bestthr=58.1893 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.121, mb=0.475, no=0.992, corr=-0.425) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 58.1893
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1406 mb_mean=0.4742 norm_overlap=0.9925 corr_cb=-0.4539 topkJ=0.0101
[TRAIN][ep=014] loss=0.7894 acc=66.17%
[TRAIN][ep=014] mask_avg: mc_mean=0.1355 mb_mean=0.4751 norm_overlap=0.9915 corr_cb=-0.4413
[EPOCH 014/089] train: loss=0.7894 acc=66.17% | val: loss=0.6832 acc=54.22% f1=68.85% auc=58.90% val_score=48.2392 val_score_bestthr=57.8426 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.136, mb=0.475, no=0.992, corr=-0.441) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 57.8426
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1836 mb_mean=0.4730 norm_overlap=0.9927 corr_cb=-0.4681 topkJ=0.0036
[TRAIN][ep=015] loss=0.7817 acc=66.98%
[TRAIN][ep=015] mask_avg: mc_mean=0.1424 mb_mean=0.4751 norm_overlap=0.9910 corr_cb=-0.4554
[EPOCH 015/089] train: loss=0.7817 acc=66.98% | val: loss=0.7466 acc=54.22% f1=69.35% auc=57.62% val_score=35.8005 val_score_bestthr=62.5593 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.142, mb=0.475, no=0.991, corr=-0.455) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 61.3697 -> 62.5593
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/ckpt_best_fold_4.pt
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1511 mb_mean=0.4758 norm_overlap=0.9902 corr_cb=-0.4916 topkJ=0.0012
[TRAIN][ep=016] loss=0.8533 acc=68.99%
[TRAIN][ep=016] mask_avg: mc_mean=0.1418 mb_mean=0.4751 norm_overlap=0.9902 corr_cb=-0.4706
[EPOCH 016/089] train: loss=0.8533 acc=68.99% | val: loss=0.6992 acc=54.22% f1=69.35% auc=57.97% val_score=39.6854 val_score_bestthr=62.5593 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.142, mb=0.475, no=0.990, corr=-0.471) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 62.5593
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1210 mb_mean=0.4750 norm_overlap=0.9896 corr_cb=-0.4531 topkJ=0.0043
[TRAIN][ep=017] loss=0.9382 acc=68.19%
[TRAIN][ep=017] mask_avg: mc_mean=0.1378 mb_mean=0.4751 norm_overlap=0.9896 corr_cb=-0.4490
[EPOCH 017/089] train: loss=0.9382 acc=68.19% | val: loss=0.7326 acc=54.22% f1=69.35% auc=58.20% val_score=35.8144 val_score_bestthr=62.5593 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.138, mb=0.475, no=0.990, corr=-0.449) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 62.5593
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1007 mb_mean=0.4762 norm_overlap=0.9892 corr_cb=-0.4163 topkJ=0.0012
[TRAIN][ep=018] loss=1.0107 acc=69.53%
[TRAIN][ep=018] mask_avg: mc_mean=0.1240 mb_mean=0.4751 norm_overlap=0.9875 corr_cb=-0.5066
[EPOCH 018/089] train: loss=1.0107 acc=69.53% | val: loss=0.7288 acc=56.63% f1=68.42% auc=60.87% val_score=53.6131 val_score_bestthr=58.2662 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.124, mb=0.475, no=0.988, corr=-0.507) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.2662
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1350 mb_mean=0.4778 norm_overlap=0.9904 corr_cb=-0.5505 topkJ=0.0004
[TRAIN][ep=019] loss=1.0801 acc=67.65%
[TRAIN][ep=019] mask_avg: mc_mean=0.1728 mb_mean=0.4751 norm_overlap=0.9895 corr_cb=-0.5090
[EPOCH 019/089] train: loss=1.0801 acc=67.65% | val: loss=0.7477 acc=56.63% f1=68.42% auc=61.40% val_score=58.2662 val_score_bestthr=58.2662 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.173, mb=0.475, no=0.989, corr=-0.509) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.2662
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1436 mb_mean=0.4735 norm_overlap=0.9897 corr_cb=-0.4956 topkJ=0.0016
[TRAIN][ep=020] loss=1.1513 acc=69.40%
[TRAIN][ep=020] mask_avg: mc_mean=0.1506 mb_mean=0.4751 norm_overlap=0.9879 corr_cb=-0.5301
[EPOCH 020/089] train: loss=1.1513 acc=69.40% | val: loss=0.6840 acc=62.65% f1=65.93% auc=61.86% val_score=45.3893 val_score_bestthr=54.6247 | dyn(w_pfs=0.100, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.151, mb=0.475, no=0.988, corr=-0.530) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 54.6247
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2226 mb_mean=0.4739 norm_overlap=0.9886 corr_cb=-0.6001 topkJ=0.0000
[TRAIN][ep=021] loss=0.9338 acc=70.47%
[TRAIN][ep=021] mask_avg: mc_mean=0.1755 mb_mean=0.4751 norm_overlap=0.9889 corr_cb=-0.5035
[EPOCH 021/089] train: loss=0.9338 acc=70.47% | val: loss=0.6979 acc=53.01% f1=68.80% auc=60.87% val_score=48.9164 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.175, mb=0.475, no=0.989, corr=-0.504) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1593 mb_mean=0.4744 norm_overlap=0.9892 corr_cb=-0.4921 topkJ=0.0036
[TRAIN][ep=022] loss=0.7366 acc=68.99%
[TRAIN][ep=022] mask_avg: mc_mean=0.1470 mb_mean=0.4751 norm_overlap=0.9879 corr_cb=-0.4710
[EPOCH 022/089] train: loss=0.7366 acc=68.99% | val: loss=0.7046 acc=53.01% f1=68.80% auc=61.45% val_score=51.6211 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.147, mb=0.475, no=0.988, corr=-0.471) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2121 mb_mean=0.4735 norm_overlap=0.9911 corr_cb=-0.4921 topkJ=0.0084
[TRAIN][ep=023] loss=0.7307 acc=72.35%
[TRAIN][ep=023] mask_avg: mc_mean=0.1756 mb_mean=0.4751 norm_overlap=0.9892 corr_cb=-0.4643
[EPOCH 023/089] train: loss=0.7307 acc=72.35% | val: loss=0.7164 acc=53.01% f1=68.80% auc=61.57% val_score=48.4607 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.176, mb=0.475, no=0.989, corr=-0.464) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1914 mb_mean=0.4758 norm_overlap=0.9873 corr_cb=-0.6239 topkJ=0.0000
[TRAIN][ep=024] loss=0.7166 acc=73.29%
[TRAIN][ep=024] mask_avg: mc_mean=0.1759 mb_mean=0.4751 norm_overlap=0.9889 corr_cb=-0.4747
[EPOCH 024/089] train: loss=0.7166 acc=73.29% | val: loss=0.7084 acc=53.01% f1=68.80% auc=61.69% val_score=51.5606 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.176, mb=0.475, no=0.989, corr=-0.475) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1719 mb_mean=0.4754 norm_overlap=0.9919 corr_cb=-0.3868 topkJ=0.0137
[TRAIN][ep=025] loss=0.7131 acc=71.41%
[TRAIN][ep=025] mask_avg: mc_mean=0.1925 mb_mean=0.4751 norm_overlap=0.9897 corr_cb=-0.4551
[EPOCH 025/089] train: loss=0.7131 acc=71.41% | val: loss=0.7140 acc=53.01% f1=68.80% auc=61.57% val_score=49.8969 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.192, mb=0.475, no=0.990, corr=-0.455) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1848 mb_mean=0.4756 norm_overlap=0.9917 corr_cb=-0.4469 topkJ=0.0055
[TRAIN][ep=026] loss=0.7111 acc=72.35%
[TRAIN][ep=026] mask_avg: mc_mean=0.1871 mb_mean=0.4751 norm_overlap=0.9894 corr_cb=-0.4600
[EPOCH 026/089] train: loss=0.7111 acc=72.35% | val: loss=0.7151 acc=53.01% f1=68.80% auc=61.74% val_score=47.5643 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.187, mb=0.475, no=0.989, corr=-0.460) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1582 mb_mean=0.4761 norm_overlap=0.9816 corr_cb=-0.5458 topkJ=0.0036
[TRAIN][ep=027] loss=0.7012 acc=72.08%
[TRAIN][ep=027] mask_avg: mc_mean=0.1661 mb_mean=0.4751 norm_overlap=0.9885 corr_cb=-0.4543
[EPOCH 027/089] train: loss=0.7012 acc=72.08% | val: loss=0.7134 acc=54.22% f1=68.33% auc=61.80% val_score=51.1333 val_score_bestthr=55.6869 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.166, mb=0.475, no=0.989, corr=-0.454) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 55.6869
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1819 mb_mean=0.4761 norm_overlap=0.9885 corr_cb=-0.4784 topkJ=0.0113
[TRAIN][ep=028] loss=0.6937 acc=74.50%
[TRAIN][ep=028] mask_avg: mc_mean=0.2030 mb_mean=0.4751 norm_overlap=0.9899 corr_cb=-0.4586
[EPOCH 028/089] train: loss=0.6937 acc=74.50% | val: loss=0.7248 acc=55.42% f1=68.91% auc=61.69% val_score=52.0812 val_score_bestthr=57.1837 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.203, mb=0.475, no=0.990, corr=-0.459) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.1837
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2129 mb_mean=0.4731 norm_overlap=0.9909 corr_cb=-0.3911 topkJ=0.0044
[TRAIN][ep=029] loss=0.7009 acc=74.36%
[TRAIN][ep=029] mask_avg: mc_mean=0.1744 mb_mean=0.4751 norm_overlap=0.9886 corr_cb=-0.4553
[EPOCH 029/089] train: loss=0.7009 acc=74.36% | val: loss=0.7255 acc=63.86% f1=67.39% auc=61.45% val_score=42.6436 val_score_bestthr=56.9468 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.174, mb=0.475, no=0.989, corr=-0.455) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 56.9468
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2039 mb_mean=0.4709 norm_overlap=0.9936 corr_cb=-0.2942 topkJ=0.0238
[TRAIN][ep=030] loss=0.6908 acc=72.89%
[TRAIN][ep=030] mask_avg: mc_mean=0.1772 mb_mean=0.4751 norm_overlap=0.9885 corr_cb=-0.4664
[EPOCH 030/089] train: loss=0.6908 acc=72.89% | val: loss=0.7235 acc=62.65% f1=66.67% auc=61.69% val_score=51.9197 val_score_bestthr=57.0901 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.177, mb=0.475, no=0.988, corr=-0.466) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.0901
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2104 mb_mean=0.4752 norm_overlap=0.9900 corr_cb=-0.5238 topkJ=0.0051
[TRAIN][ep=031] loss=0.6762 acc=74.50%
[TRAIN][ep=031] mask_avg: mc_mean=0.1896 mb_mean=0.4751 norm_overlap=0.9890 corr_cb=-0.4570
[EPOCH 031/089] train: loss=0.6762 acc=74.50% | val: loss=0.7325 acc=62.65% f1=66.67% auc=61.28% val_score=39.0335 val_score_bestthr=57.0901 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.475, no=0.989, corr=-0.457) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.0901
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2122 mb_mean=0.4761 norm_overlap=0.9892 corr_cb=-0.5135 topkJ=0.0008
[TRAIN][ep=032] loss=0.6826 acc=74.77%
[TRAIN][ep=032] mask_avg: mc_mean=0.1946 mb_mean=0.4751 norm_overlap=0.9894 corr_cb=-0.4477
[EPOCH 032/089] train: loss=0.6826 acc=74.77% | val: loss=0.7348 acc=62.65% f1=66.67% auc=61.40% val_score=40.1527 val_score_bestthr=57.0901 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.195, mb=0.475, no=0.989, corr=-0.448) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.0901
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1922 mb_mean=0.4763 norm_overlap=0.9887 corr_cb=-0.4521 topkJ=0.0004
[TRAIN][ep=033] loss=0.6643 acc=75.57%
[TRAIN][ep=033] mask_avg: mc_mean=0.2047 mb_mean=0.4751 norm_overlap=0.9896 corr_cb=-0.4535
[EPOCH 033/089] train: loss=0.6643 acc=75.57% | val: loss=0.7444 acc=62.65% f1=66.67% auc=61.22% val_score=41.6754 val_score_bestthr=56.0333 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.205, mb=0.475, no=0.990, corr=-0.453) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 56.0333
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2135 mb_mean=0.4751 norm_overlap=0.9886 corr_cb=-0.4507 topkJ=0.0020
[TRAIN][ep=034] loss=0.6712 acc=75.57%
[TRAIN][ep=034] mask_avg: mc_mean=0.1956 mb_mean=0.4751 norm_overlap=0.9893 corr_cb=-0.4356
[EPOCH 034/089] train: loss=0.6712 acc=75.57% | val: loss=0.7288 acc=56.63% f1=69.49% auc=60.99% val_score=45.7372 val_score_bestthr=60.0820 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.196, mb=0.475, no=0.989, corr=-0.436) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 60.0820
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.0805 mb_mean=0.4732 norm_overlap=0.9895 corr_cb=-0.3165 topkJ=0.0119
[TRAIN][ep=035] loss=0.6612 acc=75.30%
[TRAIN][ep=035] mask_avg: mc_mean=0.1978 mb_mean=0.4751 norm_overlap=0.9896 corr_cb=-0.4274
[EPOCH 035/089] train: loss=0.6612 acc=75.30% | val: loss=0.7420 acc=63.86% f1=66.67% auc=62.15% val_score=51.9197 val_score_bestthr=56.1316 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.198, mb=0.475, no=0.990, corr=-0.427) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 56.1316
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2895 mb_mean=0.4753 norm_overlap=0.9927 corr_cb=-0.3615 topkJ=0.0145
[TRAIN][ep=036] loss=0.6520 acc=74.63%
[TRAIN][ep=036] mask_avg: mc_mean=0.2158 mb_mean=0.4751 norm_overlap=0.9903 corr_cb=-0.4365
[EPOCH 036/089] train: loss=0.6520 acc=74.63% | val: loss=0.7420 acc=56.63% f1=69.49% auc=61.22% val_score=49.8969 val_score_bestthr=60.0820 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.216, mb=0.475, no=0.990, corr=-0.436) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 60.0820
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1423 mb_mean=0.4766 norm_overlap=0.9867 corr_cb=-0.4919 topkJ=0.0031
[TRAIN][ep=037] loss=0.6534 acc=75.44%
[TRAIN][ep=037] mask_avg: mc_mean=0.1870 mb_mean=0.4751 norm_overlap=0.9896 corr_cb=-0.4220
[EPOCH 037/089] train: loss=0.6534 acc=75.44% | val: loss=0.7629 acc=56.63% f1=69.49% auc=61.63% val_score=38.0025 val_score_bestthr=59.5820 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.187, mb=0.475, no=0.990, corr=-0.422) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 59.5820
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.1938 mb_mean=0.4725 norm_overlap=0.9887 corr_cb=-0.4043 topkJ=0.0044
[TRAIN][ep=038] loss=0.6432 acc=76.78%
[TRAIN][ep=038] mask_avg: mc_mean=0.1970 mb_mean=0.4751 norm_overlap=0.9898 corr_cb=-0.4316
[EPOCH 038/089] train: loss=0.6432 acc=76.78% | val: loss=0.7735 acc=56.63% f1=69.49% auc=62.03% val_score=38.4759 val_score_bestthr=58.1820 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.197, mb=0.475, no=0.990, corr=-0.432) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.1820
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.1455 mb_mean=0.4760 norm_overlap=0.9891 corr_cb=-0.3951 topkJ=0.0032
[TRAIN][ep=039] loss=0.6355 acc=78.79%
[TRAIN][ep=039] mask_avg: mc_mean=0.2062 mb_mean=0.4751 norm_overlap=0.9901 corr_cb=-0.4303
[EPOCH 039/089] train: loss=0.6355 acc=78.79% | val: loss=0.7702 acc=55.42% f1=69.42% auc=62.03% val_score=35.0517 val_score_bestthr=57.2175 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.206, mb=0.475, no=0.990, corr=-0.430) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.2175
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.1775 mb_mean=0.4723 norm_overlap=0.9880 corr_cb=-0.4635 topkJ=0.0028
[TRAIN][ep=040] loss=0.6448 acc=76.78%
[TRAIN][ep=040] mask_avg: mc_mean=0.1697 mb_mean=0.4751 norm_overlap=0.9891 corr_cb=-0.4082
[EPOCH 040/089] train: loss=0.6448 acc=76.78% | val: loss=0.7652 acc=63.86% f1=67.39% auc=62.15% val_score=33.9573 val_score_bestthr=58.2801 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.170, mb=0.475, no=0.989, corr=-0.408) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.2801
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.2062 mb_mean=0.4730 norm_overlap=0.9929 corr_cb=-0.3641 topkJ=0.0043
[TRAIN][ep=041] loss=0.6311 acc=77.58%
[TRAIN][ep=041] mask_avg: mc_mean=0.2134 mb_mean=0.4751 norm_overlap=0.9906 corr_cb=-0.4171
[EPOCH 041/089] train: loss=0.6311 acc=77.58% | val: loss=0.7853 acc=62.65% f1=67.37% auc=61.74% val_score=33.9573 val_score_bestthr=58.4854 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.213, mb=0.475, no=0.991, corr=-0.417) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.4854
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.1621 mb_mean=0.4770 norm_overlap=0.9885 corr_cb=-0.4579 topkJ=0.0019
[TRAIN][ep=042] loss=0.6148 acc=78.93%
[TRAIN][ep=042] mask_avg: mc_mean=0.2112 mb_mean=0.4751 norm_overlap=0.9905 corr_cb=-0.4131
[EPOCH 042/089] train: loss=0.6148 acc=78.93% | val: loss=0.7854 acc=54.22% f1=68.85% auc=61.57% val_score=35.2635 val_score_bestthr=57.6940 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.211, mb=0.475, no=0.990, corr=-0.413) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.6940
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.2298 mb_mean=0.4700 norm_overlap=0.9911 corr_cb=-0.3826 topkJ=0.0024
[TRAIN][ep=043] loss=0.6139 acc=79.60%
[TRAIN][ep=043] mask_avg: mc_mean=0.1882 mb_mean=0.4751 norm_overlap=0.9897 corr_cb=-0.4162
[EPOCH 043/089] train: loss=0.6139 acc=79.60% | val: loss=0.7883 acc=56.63% f1=69.49% auc=60.70% val_score=44.0146 val_score_bestthr=58.3873 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.188, mb=0.475, no=0.990, corr=-0.416) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.3873
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2173 mb_mean=0.4723 norm_overlap=0.9915 corr_cb=-0.3511 topkJ=0.0107
[TRAIN][ep=044] loss=0.5969 acc=80.94%
[TRAIN][ep=044] mask_avg: mc_mean=0.2229 mb_mean=0.4751 norm_overlap=0.9910 corr_cb=-0.4004
[EPOCH 044/089] train: loss=0.5969 acc=80.94% | val: loss=0.8011 acc=55.42% f1=69.42% auc=61.16% val_score=39.3645 val_score_bestthr=57.2175 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.223, mb=0.475, no=0.991, corr=-0.400) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.2175
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2142 mb_mean=0.4732 norm_overlap=0.9874 corr_cb=-0.4734 topkJ=0.0031
[TRAIN][ep=045] loss=0.6031 acc=79.73%
[TRAIN][ep=045] mask_avg: mc_mean=0.2035 mb_mean=0.4751 norm_overlap=0.9903 corr_cb=-0.4065
[EPOCH 045/089] train: loss=0.6031 acc=79.73% | val: loss=0.8919 acc=56.63% f1=68.97% auc=60.76% val_score=47.6719 val_score_bestthr=58.0494 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.203, mb=0.475, no=0.990, corr=-0.406) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.0494
[EARLY STOP] no improvement for 30 epochs. best_epoch=15
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/ckpt_best_fold_4.pt
=============== FIT DONE ===============
[BEST] epoch=15 | val_acc=54.22% | val_f1=69.35% | val_auc=57.62% | val_score=35.8005 | val_score_bestthr=62.5593
[TEST@BEST] thr_used=0.290 | acc=69.57% f1=73.19% auc=72.49% | SP_sex=17.93% EO_sex=14.21% SP_age=18.85% EO_age=22.20%
[TIME] 1.25 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/summary_fold_4.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4653 mb_mean=0.4746 norm_overlap=1.0000 corr_cb=0.0009 topkJ=0.0721
[TRAIN][ep=000] loss=0.6948 acc=51.41%
[TRAIN][ep=000] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0577
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4666 mb_mean=0.4760 norm_overlap=1.0000 corr_cb=-0.0804 topkJ=0.0394
[TRAIN][ep=001] loss=0.6935 acc=51.68%
[TRAIN][ep=001] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0520
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4641 mb_mean=0.4759 norm_overlap=0.9999 corr_cb=-0.1516 topkJ=0.0427
[TRAIN][ep=002] loss=0.6919 acc=51.95%
[TRAIN][ep=002] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0518
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4682 mb_mean=0.4728 norm_overlap=1.0000 corr_cb=0.0088 topkJ=0.0867
[TRAIN][ep=003] loss=0.6903 acc=54.09%
[TRAIN][ep=003] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0540
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4660 mb_mean=0.4754 norm_overlap=0.9999 corr_cb=-0.2222 topkJ=0.0188
[TRAIN][ep=004] loss=0.6897 acc=55.03%
[TRAIN][ep=004] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0496
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4691 mb_mean=0.4730 norm_overlap=1.0000 corr_cb=-0.0798 topkJ=0.0197
[TRAIN][ep=005] loss=0.6875 acc=54.09%
[TRAIN][ep=005] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0535
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4653 mb_mean=0.4739 norm_overlap=0.9999 corr_cb=-0.2608 topkJ=0.0412
[TRAIN][ep=006] loss=0.6841 acc=54.36%
[TRAIN][ep=006] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0534
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4637 mb_mean=0.4748 norm_overlap=1.0000 corr_cb=0.0031 topkJ=0.0692
[TRAIN][ep=007] loss=0.6832 acc=56.24%
[TRAIN][ep=007] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0487
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4635 mb_mean=0.4737 norm_overlap=1.0000 corr_cb=0.0553 topkJ=0.0628
[TRAIN][ep=008] loss=0.6802 acc=57.99%
[TRAIN][ep=008] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0575
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4622 mb_mean=0.4769 norm_overlap=1.0000 corr_cb=-0.0556 topkJ=0.0226
[TRAIN][ep=009] loss=0.6746 acc=59.06%
[TRAIN][ep=009] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0557
================= FIT START (fold=4) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4686 mb_mean=0.4721 norm_overlap=0.9999 corr_cb=-0.1822 topkJ=0.0197
[TRAIN][ep=000] loss=0.6702 acc=59.73%
[TRAIN][ep=000] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0534
[EPOCH 000/089] train: loss=0.6702 acc=59.73% | val: loss=0.6786 acc=55.42% f1=69.42% auc=58.37% val_score=50.4958 val_score_bestthr=60.8841 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.053) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 60.8841
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/ckpt_best_fold_4.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4665 mb_mean=0.4758 norm_overlap=0.9999 corr_cb=-0.1292 topkJ=0.0478
[TRAIN][ep=001] loss=0.6624 acc=62.68%
[TRAIN][ep=001] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0547
[EPOCH 001/089] train: loss=0.6624 acc=62.68% | val: loss=0.6767 acc=57.83% f1=70.09% auc=59.13% val_score=39.9204 val_score_bestthr=61.3697 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.055) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 60.8841 -> 61.3697
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/ckpt_best_fold_4.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4682 mb_mean=0.4745 norm_overlap=1.0000 corr_cb=0.0238 topkJ=0.0471
[TRAIN][ep=002] loss=0.6633 acc=59.06%
[TRAIN][ep=002] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0516
[EPOCH 002/089] train: loss=0.6633 acc=59.06% | val: loss=0.6778 acc=56.63% f1=69.49% auc=58.14% val_score=40.6876 val_score_bestthr=61.0366 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.052) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 61.0366
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4654 mb_mean=0.4739 norm_overlap=1.0000 corr_cb=0.0819 topkJ=0.0805
[TRAIN][ep=003] loss=0.6575 acc=60.94%
[TRAIN][ep=003] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0531
[EPOCH 003/089] train: loss=0.6575 acc=60.94% | val: loss=0.6748 acc=56.63% f1=69.49% auc=58.37% val_score=37.5008 val_score_bestthr=61.0366 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.053) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 61.0366
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4650 mb_mean=0.4728 norm_overlap=0.9999 corr_cb=-0.1206 topkJ=0.0236
[TRAIN][ep=004] loss=0.6531 acc=61.74%
[TRAIN][ep=004] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0547
[EPOCH 004/089] train: loss=0.6531 acc=61.74% | val: loss=0.6755 acc=56.63% f1=69.49% auc=58.72% val_score=38.5869 val_score_bestthr=61.0366 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.055) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 61.0366
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4674 mb_mean=0.4747 norm_overlap=0.9999 corr_cb=-0.1348 topkJ=0.0317
[TRAIN][ep=005] loss=1.4665 acc=62.55%
[TRAIN][ep=005] mask_avg: mc_mean=0.3637 mb_mean=0.4751 norm_overlap=0.9989 corr_cb=-0.3382
[EPOCH 005/089] train: loss=1.4665 acc=62.55% | val: loss=0.6776 acc=56.63% f1=68.97% auc=59.24% val_score=51.9494 val_score_bestthr=58.8798 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.364, mb=0.475, no=0.999, corr=-0.338) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 58.8798
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2854 mb_mean=0.4698 norm_overlap=0.9973 corr_cb=-0.4732 topkJ=0.0194
[TRAIN][ep=006] loss=1.4385 acc=64.56%
[TRAIN][ep=006] mask_avg: mc_mean=0.2341 mb_mean=0.4751 norm_overlap=0.9973 corr_cb=-0.3635
[EPOCH 006/089] train: loss=1.4385 acc=64.56% | val: loss=0.6808 acc=55.42% f1=68.91% auc=57.91% val_score=41.3057 val_score_bestthr=59.4716 | dyn(w_pfs=0.240, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.234, mb=0.475, no=0.997, corr=-0.363) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 59.4716
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2369 mb_mean=0.4739 norm_overlap=0.9971 corr_cb=-0.3898 topkJ=0.0117
[TRAIN][ep=007] loss=1.2361 acc=62.55%
[TRAIN][ep=007] mask_avg: mc_mean=0.1891 mb_mean=0.4751 norm_overlap=0.9965 corr_cb=-0.3457
[EPOCH 007/089] train: loss=1.2361 acc=62.55% | val: loss=0.6779 acc=55.42% f1=68.91% auc=57.56% val_score=44.0337 val_score_bestthr=59.4716 | dyn(w_pfs=0.140, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.189, mb=0.475, no=0.996, corr=-0.346) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 59.4716
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1606 mb_mean=0.4764 norm_overlap=0.9953 corr_cb=-0.4072 topkJ=0.0180
[TRAIN][ep=008] loss=1.0388 acc=63.62%
[TRAIN][ep=008] mask_avg: mc_mean=0.1594 mb_mean=0.4751 norm_overlap=0.9955 corr_cb=-0.3470
[EPOCH 008/089] train: loss=1.0388 acc=63.62% | val: loss=0.6848 acc=57.83% f1=69.03% auc=59.42% val_score=49.4985 val_score_bestthr=58.1893 | dyn(w_pfs=0.040, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.159, mb=0.475, no=0.996, corr=-0.347) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 58.1893
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1187 mb_mean=0.4786 norm_overlap=0.9934 corr_cb=-0.4135 topkJ=0.0073
[TRAIN][ep=009] loss=0.9958 acc=65.23%
[TRAIN][ep=009] mask_avg: mc_mean=0.1456 mb_mean=0.4751 norm_overlap=0.9948 corr_cb=-0.3578
[EPOCH 009/089] train: loss=0.9958 acc=65.23% | val: loss=0.6791 acc=55.42% f1=68.91% auc=57.85% val_score=42.8608 val_score_bestthr=59.4716 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.146, mb=0.475, no=0.995, corr=-0.358) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 59.4716
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1642 mb_mean=0.4729 norm_overlap=0.9942 corr_cb=-0.4312 topkJ=0.0065
[TRAIN][ep=010] loss=0.9883 acc=64.03%
[TRAIN][ep=010] mask_avg: mc_mean=0.1393 mb_mean=0.4751 norm_overlap=0.9941 corr_cb=-0.3899
[EPOCH 010/089] train: loss=0.9883 acc=64.03% | val: loss=0.7119 acc=55.42% f1=68.38% auc=55.87% val_score=39.3776 val_score_bestthr=59.8140 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.139, mb=0.475, no=0.994, corr=-0.390) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 59.8140
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1386 mb_mean=0.4768 norm_overlap=0.9888 corr_cb=-0.5814 topkJ=0.0004
[TRAIN][ep=011] loss=0.9774 acc=64.56%
[TRAIN][ep=011] mask_avg: mc_mean=0.1445 mb_mean=0.4751 norm_overlap=0.9934 corr_cb=-0.4436
[EPOCH 011/089] train: loss=0.9774 acc=64.56% | val: loss=0.6961 acc=54.22% f1=69.35% auc=57.38% val_score=35.4943 val_score_bestthr=62.5593 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.144, mb=0.475, no=0.993, corr=-0.444) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 61.3697 -> 62.5593
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/ckpt_best_fold_4.pt
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1307 mb_mean=0.4755 norm_overlap=0.9920 corr_cb=-0.4371 topkJ=0.0116
[TRAIN][ep=012] loss=1.0365 acc=66.71%
[TRAIN][ep=012] mask_avg: mc_mean=0.1347 mb_mean=0.4751 norm_overlap=0.9929 corr_cb=-0.4253
[EPOCH 012/089] train: loss=1.0365 acc=66.71% | val: loss=0.6827 acc=55.42% f1=69.42% auc=58.31% val_score=44.3374 val_score_bestthr=58.5609 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.135, mb=0.475, no=0.993, corr=-0.425) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.5609
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1318 mb_mean=0.4743 norm_overlap=0.9908 corr_cb=-0.5013 topkJ=0.0024
[TRAIN][ep=013] loss=1.1230 acc=66.85%
[TRAIN][ep=013] mask_avg: mc_mean=0.1186 mb_mean=0.4751 norm_overlap=0.9915 corr_cb=-0.4385
[EPOCH 013/089] train: loss=1.1230 acc=66.85% | val: loss=0.7096 acc=57.83% f1=69.03% auc=59.65% val_score=58.1893 val_score_bestthr=58.1893 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.119, mb=0.475, no=0.991, corr=-0.438) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.1893
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1348 mb_mean=0.4742 norm_overlap=0.9921 corr_cb=-0.4749 topkJ=0.0093
[TRAIN][ep=014] loss=1.1895 acc=66.17%
[TRAIN][ep=014] mask_avg: mc_mean=0.1272 mb_mean=0.4751 norm_overlap=0.9910 corr_cb=-0.4631
[EPOCH 014/089] train: loss=1.1895 acc=66.17% | val: loss=0.6797 acc=54.22% f1=68.85% auc=59.01% val_score=47.3184 val_score_bestthr=57.8426 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.127, mb=0.475, no=0.991, corr=-0.463) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.8426
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1739 mb_mean=0.4730 norm_overlap=0.9922 corr_cb=-0.4899 topkJ=0.0040
[TRAIN][ep=015] loss=1.2582 acc=65.91%
[TRAIN][ep=015] mask_avg: mc_mean=0.1371 mb_mean=0.4751 norm_overlap=0.9905 corr_cb=-0.4826
[EPOCH 015/089] train: loss=1.2582 acc=65.91% | val: loss=0.7466 acc=54.22% f1=69.35% auc=57.15% val_score=39.5013 val_score_bestthr=62.5593 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.137, mb=0.475, no=0.991, corr=-0.483) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 62.5593
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1450 mb_mean=0.4758 norm_overlap=0.9897 corr_cb=-0.5188 topkJ=0.0012
[TRAIN][ep=016] loss=1.3249 acc=69.13%
[TRAIN][ep=016] mask_avg: mc_mean=0.1408 mb_mean=0.4751 norm_overlap=0.9900 corr_cb=-0.4881
[EPOCH 016/089] train: loss=1.3249 acc=69.13% | val: loss=0.6974 acc=54.22% f1=69.35% auc=58.20% val_score=40.0945 val_score_bestthr=62.5593 | dyn(w_pfs=0.100, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.141, mb=0.475, no=0.990, corr=-0.488) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 62.5593
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1211 mb_mean=0.4750 norm_overlap=0.9894 corr_cb=-0.4650 topkJ=0.0039
[TRAIN][ep=017] loss=1.1348 acc=67.52%
[TRAIN][ep=017] mask_avg: mc_mean=0.1432 mb_mean=0.4751 norm_overlap=0.9897 corr_cb=-0.4585
[EPOCH 017/089] train: loss=1.1348 acc=67.52% | val: loss=0.7374 acc=54.22% f1=69.35% auc=57.97% val_score=35.2367 val_score_bestthr=62.5593 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.143, mb=0.475, no=0.990, corr=-0.459) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 62.5593
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1091 mb_mean=0.4762 norm_overlap=0.9896 corr_cb=-0.4237 topkJ=0.0015
[TRAIN][ep=018] loss=0.9352 acc=69.66%
[TRAIN][ep=018] mask_avg: mc_mean=0.1310 mb_mean=0.4751 norm_overlap=0.9879 corr_cb=-0.5101
[EPOCH 018/089] train: loss=0.9352 acc=69.66% | val: loss=0.7292 acc=56.63% f1=68.42% auc=60.87% val_score=53.6131 val_score_bestthr=58.2662 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.131, mb=0.475, no=0.988, corr=-0.510) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.2662
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1432 mb_mean=0.4778 norm_overlap=0.9908 corr_cb=-0.5464 topkJ=0.0000
[TRAIN][ep=019] loss=0.9236 acc=67.65%
[TRAIN][ep=019] mask_avg: mc_mean=0.1777 mb_mean=0.4751 norm_overlap=0.9898 corr_cb=-0.4999
[EPOCH 019/089] train: loss=0.9236 acc=67.65% | val: loss=0.7491 acc=56.63% f1=68.42% auc=61.40% val_score=53.7367 val_score_bestthr=58.2662 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.178, mb=0.475, no=0.990, corr=-0.500) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.2662
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1443 mb_mean=0.4735 norm_overlap=0.9899 corr_cb=-0.4857 topkJ=0.0016
[TRAIN][ep=020] loss=0.9160 acc=70.47%
[TRAIN][ep=020] mask_avg: mc_mean=0.1573 mb_mean=0.4751 norm_overlap=0.9884 corr_cb=-0.5203
[EPOCH 020/089] train: loss=0.9160 acc=70.47% | val: loss=0.6881 acc=53.01% f1=68.80% auc=61.86% val_score=45.3893 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.157, mb=0.475, no=0.988, corr=-0.520) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2318 mb_mean=0.4739 norm_overlap=0.9890 corr_cb=-0.5944 topkJ=0.0000
[TRAIN][ep=021] loss=0.8964 acc=70.74%
[TRAIN][ep=021] mask_avg: mc_mean=0.1739 mb_mean=0.4751 norm_overlap=0.9890 corr_cb=-0.4916
[EPOCH 021/089] train: loss=0.8964 acc=70.74% | val: loss=0.7005 acc=53.01% f1=68.80% auc=60.87% val_score=45.1295 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.174, mb=0.475, no=0.989, corr=-0.492) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1590 mb_mean=0.4744 norm_overlap=0.9894 corr_cb=-0.4835 topkJ=0.0036
[TRAIN][ep=022] loss=0.8920 acc=68.72%
[TRAIN][ep=022] mask_avg: mc_mean=0.1468 mb_mean=0.4751 norm_overlap=0.9880 corr_cb=-0.4663
[EPOCH 022/089] train: loss=0.8920 acc=68.72% | val: loss=0.7064 acc=53.01% f1=68.80% auc=61.57% val_score=50.9811 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.147, mb=0.475, no=0.988, corr=-0.466) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2133 mb_mean=0.4735 norm_overlap=0.9912 corr_cb=-0.4884 topkJ=0.0088
[TRAIN][ep=023] loss=0.8850 acc=72.21%
[TRAIN][ep=023] mask_avg: mc_mean=0.1754 mb_mean=0.4751 norm_overlap=0.9893 corr_cb=-0.4624
[EPOCH 023/089] train: loss=0.8850 acc=72.21% | val: loss=0.7191 acc=53.01% f1=68.80% auc=61.45% val_score=48.6990 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.175, mb=0.475, no=0.989, corr=-0.462) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1918 mb_mean=0.4758 norm_overlap=0.9873 corr_cb=-0.6248 topkJ=0.0000
[TRAIN][ep=024] loss=0.8705 acc=73.15%
[TRAIN][ep=024] mask_avg: mc_mean=0.1759 mb_mean=0.4751 norm_overlap=0.9890 corr_cb=-0.4741
[EPOCH 024/089] train: loss=0.8705 acc=73.15% | val: loss=0.7091 acc=53.01% f1=68.80% auc=61.74% val_score=50.0017 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.176, mb=0.475, no=0.989, corr=-0.474) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1727 mb_mean=0.4754 norm_overlap=0.9920 corr_cb=-0.3868 topkJ=0.0137
[TRAIN][ep=025] loss=0.8651 acc=71.68%
[TRAIN][ep=025] mask_avg: mc_mean=0.1937 mb_mean=0.4751 norm_overlap=0.9898 corr_cb=-0.4540
[EPOCH 025/089] train: loss=0.8651 acc=71.68% | val: loss=0.7143 acc=53.01% f1=68.80% auc=61.57% val_score=51.2544 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.194, mb=0.475, no=0.990, corr=-0.454) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1886 mb_mean=0.4756 norm_overlap=0.9919 corr_cb=-0.4471 topkJ=0.0063
[TRAIN][ep=026] loss=0.8629 acc=72.62%
[TRAIN][ep=026] mask_avg: mc_mean=0.1879 mb_mean=0.4751 norm_overlap=0.9895 corr_cb=-0.4592
[EPOCH 026/089] train: loss=0.8629 acc=72.62% | val: loss=0.7147 acc=53.01% f1=68.80% auc=61.86% val_score=48.2047 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.188, mb=0.475, no=0.989, corr=-0.459) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1602 mb_mean=0.4761 norm_overlap=0.9819 corr_cb=-0.5444 topkJ=0.0036
[TRAIN][ep=027] loss=0.8502 acc=72.08%
[TRAIN][ep=027] mask_avg: mc_mean=0.1678 mb_mean=0.4751 norm_overlap=0.9886 corr_cb=-0.4539
[EPOCH 027/089] train: loss=0.8502 acc=72.08% | val: loss=0.7136 acc=54.22% f1=68.33% auc=61.92% val_score=51.1333 val_score_bestthr=55.6869 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.168, mb=0.475, no=0.989, corr=-0.454) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 55.6869
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1847 mb_mean=0.4761 norm_overlap=0.9887 corr_cb=-0.4771 topkJ=0.0101
[TRAIN][ep=028] loss=0.8423 acc=75.03%
[TRAIN][ep=028] mask_avg: mc_mean=0.2045 mb_mean=0.4751 norm_overlap=0.9900 corr_cb=-0.4575
[EPOCH 028/089] train: loss=0.8423 acc=75.03% | val: loss=0.7239 acc=55.42% f1=68.91% auc=61.57% val_score=53.4187 val_score_bestthr=57.1837 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.204, mb=0.475, no=0.990, corr=-0.457) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.1837
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2144 mb_mean=0.4731 norm_overlap=0.9911 corr_cb=-0.3857 topkJ=0.0044
[TRAIN][ep=029] loss=0.8486 acc=73.42%
[TRAIN][ep=029] mask_avg: mc_mean=0.1758 mb_mean=0.4751 norm_overlap=0.9887 corr_cb=-0.4543
[EPOCH 029/089] train: loss=0.8486 acc=73.42% | val: loss=0.7230 acc=63.86% f1=67.39% auc=61.40% val_score=42.6436 val_score_bestthr=56.9468 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.176, mb=0.475, no=0.989, corr=-0.454) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 56.9468
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2065 mb_mean=0.4709 norm_overlap=0.9937 corr_cb=-0.2916 topkJ=0.0246
[TRAIN][ep=030] loss=0.8365 acc=73.15%
[TRAIN][ep=030] mask_avg: mc_mean=0.1797 mb_mean=0.4751 norm_overlap=0.9887 corr_cb=-0.4658
[EPOCH 030/089] train: loss=0.8365 acc=73.15% | val: loss=0.7231 acc=62.65% f1=66.67% auc=61.45% val_score=44.0146 val_score_bestthr=57.0901 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.180, mb=0.475, no=0.989, corr=-0.466) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.0901
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2112 mb_mean=0.4752 norm_overlap=0.9901 corr_cb=-0.5218 topkJ=0.0039
[TRAIN][ep=031] loss=0.8207 acc=74.23%
[TRAIN][ep=031] mask_avg: mc_mean=0.1915 mb_mean=0.4751 norm_overlap=0.9892 corr_cb=-0.4554
[EPOCH 031/089] train: loss=0.8207 acc=74.23% | val: loss=0.7312 acc=61.45% f1=65.96% auc=61.45% val_score=38.1474 val_score_bestthr=56.9064 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.192, mb=0.475, no=0.989, corr=-0.455) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 56.9064
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2150 mb_mean=0.4761 norm_overlap=0.9894 corr_cb=-0.5085 topkJ=0.0008
[TRAIN][ep=032] loss=0.8268 acc=74.90%
[TRAIN][ep=032] mask_avg: mc_mean=0.1972 mb_mean=0.4751 norm_overlap=0.9896 corr_cb=-0.4461
[EPOCH 032/089] train: loss=0.8268 acc=74.90% | val: loss=0.7371 acc=62.65% f1=66.67% auc=61.40% val_score=41.6754 val_score_bestthr=57.0901 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.197, mb=0.475, no=0.990, corr=-0.446) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.0901
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1939 mb_mean=0.4763 norm_overlap=0.9889 corr_cb=-0.4488 topkJ=0.0004
[TRAIN][ep=033] loss=0.8084 acc=75.57%
[TRAIN][ep=033] mask_avg: mc_mean=0.2058 mb_mean=0.4751 norm_overlap=0.9898 corr_cb=-0.4513
[EPOCH 033/089] train: loss=0.8084 acc=75.57% | val: loss=0.7418 acc=65.06% f1=68.13% auc=61.34% val_score=41.4998 val_score_bestthr=58.0568 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.206, mb=0.475, no=0.990, corr=-0.451) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.0568
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2136 mb_mean=0.4751 norm_overlap=0.9887 corr_cb=-0.4457 topkJ=0.0020
[TRAIN][ep=034] loss=0.8150 acc=75.30%
[TRAIN][ep=034] mask_avg: mc_mean=0.1964 mb_mean=0.4751 norm_overlap=0.9894 corr_cb=-0.4329
[EPOCH 034/089] train: loss=0.8150 acc=75.30% | val: loss=0.7262 acc=55.42% f1=69.42% auc=61.22% val_score=45.7372 val_score_bestthr=57.2175 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.196, mb=0.475, no=0.989, corr=-0.433) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.2175
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.0779 mb_mean=0.4732 norm_overlap=0.9895 corr_cb=-0.3128 topkJ=0.0119
[TRAIN][ep=035] loss=0.8056 acc=75.30%
[TRAIN][ep=035] mask_avg: mc_mean=0.1981 mb_mean=0.4751 norm_overlap=0.9897 corr_cb=-0.4250
[EPOCH 035/089] train: loss=0.8056 acc=75.30% | val: loss=0.7392 acc=54.22% f1=68.85% auc=62.27% val_score=51.9197 val_score_bestthr=57.6940 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.198, mb=0.475, no=0.990, corr=-0.425) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.6940
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2861 mb_mean=0.4753 norm_overlap=0.9927 corr_cb=-0.3610 topkJ=0.0145
[TRAIN][ep=036] loss=0.7908 acc=75.30%
[TRAIN][ep=036] mask_avg: mc_mean=0.2181 mb_mean=0.4751 norm_overlap=0.9904 corr_cb=-0.4340
[EPOCH 036/089] train: loss=0.7908 acc=75.30% | val: loss=0.7407 acc=56.63% f1=69.49% auc=61.34% val_score=49.8969 val_score_bestthr=60.0820 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.218, mb=0.475, no=0.990, corr=-0.434) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 60.0820
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1463 mb_mean=0.4766 norm_overlap=0.9870 corr_cb=-0.4905 topkJ=0.0031
[TRAIN][ep=037] loss=0.7911 acc=75.97%
[TRAIN][ep=037] mask_avg: mc_mean=0.1898 mb_mean=0.4751 norm_overlap=0.9899 corr_cb=-0.4196
[EPOCH 037/089] train: loss=0.7911 acc=75.97% | val: loss=0.7653 acc=59.04% f1=70.69% auc=61.45% val_score=38.4759 val_score_bestthr=61.9165 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.475, no=0.990, corr=-0.420) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.9165
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.1970 mb_mean=0.4725 norm_overlap=0.9889 corr_cb=-0.4026 topkJ=0.0040
[TRAIN][ep=038] loss=0.7790 acc=76.78%
[TRAIN][ep=038] mask_avg: mc_mean=0.1996 mb_mean=0.4751 norm_overlap=0.9900 corr_cb=-0.4286
[EPOCH 038/089] train: loss=0.7790 acc=76.78% | val: loss=0.7778 acc=56.63% f1=69.49% auc=61.51% val_score=36.0775 val_score_bestthr=58.1820 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.200, mb=0.475, no=0.990, corr=-0.429) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.1820
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.1536 mb_mean=0.4760 norm_overlap=0.9894 corr_cb=-0.3980 topkJ=0.0032
[TRAIN][ep=039] loss=0.7717 acc=78.39%
[TRAIN][ep=039] mask_avg: mc_mean=0.2083 mb_mean=0.4751 norm_overlap=0.9902 corr_cb=-0.4271
[EPOCH 039/089] train: loss=0.7717 acc=78.39% | val: loss=0.7746 acc=56.63% f1=70.00% auc=61.57% val_score=36.4819 val_score_bestthr=58.7149 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.208, mb=0.475, no=0.990, corr=-0.427) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.7149
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.1799 mb_mean=0.4723 norm_overlap=0.9882 corr_cb=-0.4584 topkJ=0.0032
[TRAIN][ep=040] loss=0.7830 acc=77.18%
[TRAIN][ep=040] mask_avg: mc_mean=0.1708 mb_mean=0.4751 norm_overlap=0.9893 corr_cb=-0.4042
[EPOCH 040/089] train: loss=0.7830 acc=77.18% | val: loss=0.7630 acc=63.86% f1=67.39% auc=62.38% val_score=33.9573 val_score_bestthr=58.2801 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.171, mb=0.475, no=0.989, corr=-0.404) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.2801
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.2104 mb_mean=0.4730 norm_overlap=0.9931 corr_cb=-0.3611 topkJ=0.0039
[TRAIN][ep=041] loss=0.7687 acc=78.12%
[TRAIN][ep=041] mask_avg: mc_mean=0.2162 mb_mean=0.4751 norm_overlap=0.9908 corr_cb=-0.4133
[EPOCH 041/089] train: loss=0.7687 acc=78.12% | val: loss=0.7851 acc=56.63% f1=67.86% auc=61.63% val_score=39.3645 val_score_bestthr=58.7637 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.216, mb=0.475, no=0.991, corr=-0.413) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.7637
[EARLY STOP] no improvement for 30 epochs. best_epoch=11
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/ckpt_best_fold_4.pt
=============== FIT DONE ===============
[BEST] epoch=11 | val_acc=54.22% | val_f1=69.35% | val_auc=57.38% | val_score=35.4943 | val_score_bestthr=62.5593
[TEST@BEST] thr_used=0.375 | acc=68.60% f1=73.25% auc=71.28% | SP_sex=13.59% EO_sex=10.92% SP_age=18.59% EO_age=20.07%
[TIME] 1.11 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/summary_fold_4.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4653 mb_mean=0.4746 norm_overlap=1.0000 corr_cb=0.0009 topkJ=0.0721
[TRAIN][ep=000] loss=0.6948 acc=51.41%
[TRAIN][ep=000] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0577
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4666 mb_mean=0.4760 norm_overlap=1.0000 corr_cb=-0.0804 topkJ=0.0394
[TRAIN][ep=001] loss=0.6935 acc=51.54%
[TRAIN][ep=001] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0520
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4641 mb_mean=0.4759 norm_overlap=0.9999 corr_cb=-0.1516 topkJ=0.0427
[TRAIN][ep=002] loss=0.6919 acc=51.95%
[TRAIN][ep=002] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0518
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4682 mb_mean=0.4728 norm_overlap=1.0000 corr_cb=0.0088 topkJ=0.0867
[TRAIN][ep=003] loss=0.6903 acc=53.96%
[TRAIN][ep=003] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0540
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4660 mb_mean=0.4754 norm_overlap=0.9999 corr_cb=-0.2222 topkJ=0.0188
[TRAIN][ep=004] loss=0.6897 acc=55.03%
[TRAIN][ep=004] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0496
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4691 mb_mean=0.4730 norm_overlap=1.0000 corr_cb=-0.0798 topkJ=0.0197
[TRAIN][ep=005] loss=0.6875 acc=54.09%
[TRAIN][ep=005] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0535
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4653 mb_mean=0.4739 norm_overlap=0.9999 corr_cb=-0.2608 topkJ=0.0412
[TRAIN][ep=006] loss=0.6841 acc=54.36%
[TRAIN][ep=006] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0534
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4637 mb_mean=0.4748 norm_overlap=1.0000 corr_cb=0.0031 topkJ=0.0692
[TRAIN][ep=007] loss=0.6832 acc=56.24%
[TRAIN][ep=007] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0487
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4635 mb_mean=0.4737 norm_overlap=1.0000 corr_cb=0.0553 topkJ=0.0628
[TRAIN][ep=008] loss=0.6802 acc=58.12%
[TRAIN][ep=008] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0575
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4622 mb_mean=0.4769 norm_overlap=1.0000 corr_cb=-0.0556 topkJ=0.0226
[TRAIN][ep=009] loss=0.6747 acc=59.06%
[TRAIN][ep=009] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0557
================= FIT START (fold=4) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4686 mb_mean=0.4721 norm_overlap=0.9999 corr_cb=-0.1822 topkJ=0.0197
[TRAIN][ep=000] loss=0.6702 acc=59.73%
[TRAIN][ep=000] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0534
[EPOCH 000/089] train: loss=0.6702 acc=59.73% | val: loss=0.6786 acc=55.42% f1=69.42% auc=58.31% val_score=50.4958 val_score_bestthr=60.8841 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.053) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 60.8841
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/ckpt_best_fold_4.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4665 mb_mean=0.4758 norm_overlap=0.9999 corr_cb=-0.1292 topkJ=0.0478
[TRAIN][ep=001] loss=0.6624 acc=62.82%
[TRAIN][ep=001] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0547
[EPOCH 001/089] train: loss=0.6624 acc=62.82% | val: loss=0.6767 acc=56.63% f1=69.49% auc=59.07% val_score=39.3346 val_score_bestthr=61.0366 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.055) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 60.8841 -> 61.0366
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/ckpt_best_fold_4.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4682 mb_mean=0.4745 norm_overlap=1.0000 corr_cb=0.0238 topkJ=0.0471
[TRAIN][ep=002] loss=0.6633 acc=59.06%
[TRAIN][ep=002] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0516
[EPOCH 002/089] train: loss=0.6633 acc=59.06% | val: loss=0.6777 acc=56.63% f1=69.49% auc=58.02% val_score=40.6876 val_score_bestthr=61.0366 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.052) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.0366 -> 61.0366
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4654 mb_mean=0.4739 norm_overlap=1.0000 corr_cb=0.0819 topkJ=0.0805
[TRAIN][ep=003] loss=0.6575 acc=61.07%
[TRAIN][ep=003] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0531
[EPOCH 003/089] train: loss=0.6575 acc=61.07% | val: loss=0.6747 acc=56.63% f1=69.49% auc=58.43% val_score=37.5008 val_score_bestthr=61.0366 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.053) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.0366 -> 61.0366
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4650 mb_mean=0.4728 norm_overlap=0.9999 corr_cb=-0.1206 topkJ=0.0236
[TRAIN][ep=004] loss=0.6531 acc=61.74%
[TRAIN][ep=004] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0547
[EPOCH 004/089] train: loss=0.6531 acc=61.74% | val: loss=0.6755 acc=56.63% f1=69.49% auc=58.78% val_score=38.5869 val_score_bestthr=61.0366 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.055) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.0366 -> 61.0366
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4674 mb_mean=0.4747 norm_overlap=0.9999 corr_cb=-0.1348 topkJ=0.0317
[TRAIN][ep=005] loss=1.2594 acc=62.68%
[TRAIN][ep=005] mask_avg: mc_mean=0.3635 mb_mean=0.4751 norm_overlap=0.9989 corr_cb=-0.3381
[EPOCH 005/089] train: loss=1.2594 acc=62.68% | val: loss=0.6773 acc=56.63% f1=68.97% auc=59.24% val_score=51.9494 val_score_bestthr=58.8798 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.364, mb=0.475, no=0.999, corr=-0.338) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.0366 -> 58.8798
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2852 mb_mean=0.4698 norm_overlap=0.9973 corr_cb=-0.4731 topkJ=0.0194
[TRAIN][ep=006] loss=1.2375 acc=64.56%
[TRAIN][ep=006] mask_avg: mc_mean=0.2341 mb_mean=0.4751 norm_overlap=0.9973 corr_cb=-0.3634
[EPOCH 006/089] train: loss=1.2375 acc=64.56% | val: loss=0.6808 acc=55.42% f1=68.91% auc=57.91% val_score=41.5244 val_score_bestthr=59.4716 | dyn(w_pfs=0.240, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.234, mb=0.475, no=0.997, corr=-0.363) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.0366 -> 59.4716
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2370 mb_mean=0.4739 norm_overlap=0.9971 corr_cb=-0.3898 topkJ=0.0117
[TRAIN][ep=007] loss=1.0353 acc=62.55%
[TRAIN][ep=007] mask_avg: mc_mean=0.1891 mb_mean=0.4751 norm_overlap=0.9965 corr_cb=-0.3457
[EPOCH 007/089] train: loss=1.0353 acc=62.55% | val: loss=0.6779 acc=55.42% f1=68.38% auc=57.56% val_score=44.0337 val_score_bestthr=58.0473 | dyn(w_pfs=0.140, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.189, mb=0.475, no=0.996, corr=-0.346) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.0366 -> 58.0473
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1607 mb_mean=0.4764 norm_overlap=0.9953 corr_cb=-0.4068 topkJ=0.0180
[TRAIN][ep=008] loss=0.8385 acc=63.62%
[TRAIN][ep=008] mask_avg: mc_mean=0.1599 mb_mean=0.4751 norm_overlap=0.9955 corr_cb=-0.3471
[EPOCH 008/089] train: loss=0.8385 acc=63.62% | val: loss=0.6847 acc=57.83% f1=69.03% auc=59.59% val_score=49.4985 val_score_bestthr=58.1893 | dyn(w_pfs=0.040, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.160, mb=0.475, no=0.996, corr=-0.347) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.0366 -> 58.1893
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1189 mb_mean=0.4786 norm_overlap=0.9934 corr_cb=-0.4143 topkJ=0.0073
[TRAIN][ep=009] loss=0.7958 acc=65.23%
[TRAIN][ep=009] mask_avg: mc_mean=0.1448 mb_mean=0.4751 norm_overlap=0.9948 corr_cb=-0.3584
[EPOCH 009/089] train: loss=0.7958 acc=65.23% | val: loss=0.6794 acc=55.42% f1=68.91% auc=57.91% val_score=41.5605 val_score_bestthr=59.4716 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.145, mb=0.475, no=0.995, corr=-0.358) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.0366 -> 59.4716
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1631 mb_mean=0.4729 norm_overlap=0.9942 corr_cb=-0.4315 topkJ=0.0065
[TRAIN][ep=010] loss=0.7885 acc=64.03%
[TRAIN][ep=010] mask_avg: mc_mean=0.1387 mb_mean=0.4751 norm_overlap=0.9940 corr_cb=-0.3902
[EPOCH 010/089] train: loss=0.7885 acc=64.03% | val: loss=0.7105 acc=55.42% f1=68.38% auc=55.76% val_score=39.3776 val_score_bestthr=59.8140 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.139, mb=0.475, no=0.994, corr=-0.390) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.0366 -> 59.8140
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1379 mb_mean=0.4768 norm_overlap=0.9888 corr_cb=-0.5809 topkJ=0.0004
[TRAIN][ep=011] loss=0.7778 acc=64.83%
[TRAIN][ep=011] mask_avg: mc_mean=0.1439 mb_mean=0.4751 norm_overlap=0.9934 corr_cb=-0.4429
[EPOCH 011/089] train: loss=0.7778 acc=64.83% | val: loss=0.6966 acc=54.22% f1=68.85% auc=57.50% val_score=35.4943 val_score_bestthr=57.8426 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.144, mb=0.475, no=0.993, corr=-0.443) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.0366 -> 57.8426
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1302 mb_mean=0.4755 norm_overlap=0.9920 corr_cb=-0.4369 topkJ=0.0116
[TRAIN][ep=012] loss=0.7570 acc=66.85%
[TRAIN][ep=012] mask_avg: mc_mean=0.1364 mb_mean=0.4751 norm_overlap=0.9930 corr_cb=-0.4209
[EPOCH 012/089] train: loss=0.7570 acc=66.85% | val: loss=0.6836 acc=55.42% f1=69.42% auc=58.26% val_score=47.9255 val_score_bestthr=58.5609 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.136, mb=0.475, no=0.993, corr=-0.421) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.0366 -> 58.5609
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1352 mb_mean=0.4743 norm_overlap=0.9910 corr_cb=-0.4902 topkJ=0.0024
[TRAIN][ep=013] loss=0.7639 acc=66.98%
[TRAIN][ep=013] mask_avg: mc_mean=0.1214 mb_mean=0.4751 norm_overlap=0.9917 corr_cb=-0.4248
[EPOCH 013/089] train: loss=0.7639 acc=66.98% | val: loss=0.7087 acc=57.83% f1=69.03% auc=59.36% val_score=51.3428 val_score_bestthr=58.1893 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.121, mb=0.475, no=0.992, corr=-0.425) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.0366 -> 58.1893
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1406 mb_mean=0.4742 norm_overlap=0.9925 corr_cb=-0.4530 topkJ=0.0101
[TRAIN][ep=014] loss=0.7530 acc=66.31%
[TRAIN][ep=014] mask_avg: mc_mean=0.1358 mb_mean=0.4751 norm_overlap=0.9916 corr_cb=-0.4404
[EPOCH 014/089] train: loss=0.7530 acc=66.31% | val: loss=0.6834 acc=55.42% f1=69.92% auc=58.95% val_score=48.2392 val_score_bestthr=61.9154 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.136, mb=0.475, no=0.992, corr=-0.440) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 61.0366 -> 61.9154
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/ckpt_best_fold_4.pt
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1837 mb_mean=0.4730 norm_overlap=0.9927 corr_cb=-0.4672 topkJ=0.0040
[TRAIN][ep=015] loss=0.8274 acc=66.44%
[TRAIN][ep=015] mask_avg: mc_mean=0.1369 mb_mean=0.4751 norm_overlap=0.9908 corr_cb=-0.4563
[EPOCH 015/089] train: loss=0.8274 acc=66.44% | val: loss=0.7472 acc=54.22% f1=69.35% auc=57.27% val_score=36.9873 val_score_bestthr=62.5593 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.137, mb=0.475, no=0.991, corr=-0.456) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 61.9154 -> 62.5593
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/ckpt_best_fold_4.pt
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1420 mb_mean=0.4758 norm_overlap=0.9898 corr_cb=-0.4958 topkJ=0.0012
[TRAIN][ep=016] loss=0.8952 acc=69.13%
[TRAIN][ep=016] mask_avg: mc_mean=0.1390 mb_mean=0.4751 norm_overlap=0.9900 corr_cb=-0.4739
[EPOCH 016/089] train: loss=0.8952 acc=69.13% | val: loss=0.6986 acc=54.22% f1=69.35% auc=58.08% val_score=39.9967 val_score_bestthr=62.5593 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.139, mb=0.475, no=0.990, corr=-0.474) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 62.5593
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1204 mb_mean=0.4750 norm_overlap=0.9895 corr_cb=-0.4555 topkJ=0.0043
[TRAIN][ep=017] loss=0.9793 acc=67.52%
[TRAIN][ep=017] mask_avg: mc_mean=0.1388 mb_mean=0.4751 norm_overlap=0.9896 corr_cb=-0.4514
[EPOCH 017/089] train: loss=0.9793 acc=67.52% | val: loss=0.7362 acc=54.22% f1=69.35% auc=58.14% val_score=35.2367 val_score_bestthr=62.5593 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.139, mb=0.475, no=0.990, corr=-0.451) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 62.5593
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1023 mb_mean=0.4762 norm_overlap=0.9893 corr_cb=-0.4177 topkJ=0.0015
[TRAIN][ep=018] loss=1.0512 acc=69.66%
[TRAIN][ep=018] mask_avg: mc_mean=0.1262 mb_mean=0.4751 norm_overlap=0.9876 corr_cb=-0.5093
[EPOCH 018/089] train: loss=1.0512 acc=69.66% | val: loss=0.7285 acc=56.63% f1=68.42% auc=60.87% val_score=53.6131 val_score_bestthr=58.2662 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.126, mb=0.475, no=0.988, corr=-0.509) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.2662
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1382 mb_mean=0.4778 norm_overlap=0.9905 corr_cb=-0.5521 topkJ=0.0000
[TRAIN][ep=019] loss=1.1203 acc=67.65%
[TRAIN][ep=019] mask_avg: mc_mean=0.1742 mb_mean=0.4751 norm_overlap=0.9896 corr_cb=-0.5087
[EPOCH 019/089] train: loss=1.1203 acc=67.65% | val: loss=0.7478 acc=56.63% f1=68.42% auc=61.28% val_score=58.2662 val_score_bestthr=58.2662 | dyn(w_pfs=0.240, w_sup=0.240, w_csuf=0.200, stage2=False) | mask(mc=0.174, mb=0.475, no=0.990, corr=-0.509) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.2662
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1462 mb_mean=0.4735 norm_overlap=0.9898 corr_cb=-0.4973 topkJ=0.0016
[TRAIN][ep=020] loss=1.1298 acc=69.40%
[TRAIN][ep=020] mask_avg: mc_mean=0.1532 mb_mean=0.4751 norm_overlap=0.9881 corr_cb=-0.5294
[EPOCH 020/089] train: loss=1.1298 acc=69.40% | val: loss=0.6841 acc=62.65% f1=65.93% auc=61.80% val_score=45.3893 val_score_bestthr=54.6247 | dyn(w_pfs=0.140, w_sup=0.140, w_csuf=0.100, stage2=False) | mask(mc=0.153, mb=0.475, no=0.988, corr=-0.529) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 54.6247
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2260 mb_mean=0.4739 norm_overlap=0.9888 corr_cb=-0.5984 topkJ=0.0000
[TRAIN][ep=021] loss=0.9125 acc=70.34%
[TRAIN][ep=021] mask_avg: mc_mean=0.1768 mb_mean=0.4751 norm_overlap=0.9890 corr_cb=-0.5008
[EPOCH 021/089] train: loss=0.9125 acc=70.34% | val: loss=0.6984 acc=53.01% f1=68.80% auc=60.93% val_score=49.0933 val_score_bestthr=61.2320 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.000, stage2=False) | mask(mc=0.177, mb=0.475, no=0.989, corr=-0.501) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1602 mb_mean=0.4744 norm_overlap=0.9893 corr_cb=-0.4904 topkJ=0.0036
[TRAIN][ep=022] loss=0.7156 acc=69.13%
[TRAIN][ep=022] mask_avg: mc_mean=0.1478 mb_mean=0.4751 norm_overlap=0.9880 corr_cb=-0.4687
[EPOCH 022/089] train: loss=0.7156 acc=69.13% | val: loss=0.7050 acc=53.01% f1=68.80% auc=61.45% val_score=51.6211 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.148, mb=0.475, no=0.988, corr=-0.469) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2124 mb_mean=0.4735 norm_overlap=0.9911 corr_cb=-0.4890 topkJ=0.0084
[TRAIN][ep=023] loss=0.6938 acc=72.35%
[TRAIN][ep=023] mask_avg: mc_mean=0.1761 mb_mean=0.4751 norm_overlap=0.9893 corr_cb=-0.4613
[EPOCH 023/089] train: loss=0.6938 acc=72.35% | val: loss=0.7173 acc=53.01% f1=68.80% auc=61.45% val_score=48.4607 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.176, mb=0.475, no=0.989, corr=-0.461) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1919 mb_mean=0.4758 norm_overlap=0.9873 corr_cb=-0.6224 topkJ=0.0000
[TRAIN][ep=024] loss=0.6799 acc=73.69%
[TRAIN][ep=024] mask_avg: mc_mean=0.1764 mb_mean=0.4751 norm_overlap=0.9890 corr_cb=-0.4714
[EPOCH 024/089] train: loss=0.6799 acc=73.69% | val: loss=0.7089 acc=53.01% f1=68.80% auc=61.63% val_score=51.5606 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.176, mb=0.475, no=0.989, corr=-0.471) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1722 mb_mean=0.4754 norm_overlap=0.9920 corr_cb=-0.3841 topkJ=0.0137
[TRAIN][ep=025] loss=0.6765 acc=71.14%
[TRAIN][ep=025] mask_avg: mc_mean=0.1933 mb_mean=0.4751 norm_overlap=0.9898 corr_cb=-0.4519
[EPOCH 025/089] train: loss=0.6765 acc=71.14% | val: loss=0.7145 acc=53.01% f1=68.80% auc=61.63% val_score=51.2544 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.193, mb=0.475, no=0.990, corr=-0.452) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1867 mb_mean=0.4756 norm_overlap=0.9918 corr_cb=-0.4445 topkJ=0.0063
[TRAIN][ep=026] loss=0.6744 acc=72.48%
[TRAIN][ep=026] mask_avg: mc_mean=0.1878 mb_mean=0.4751 norm_overlap=0.9895 corr_cb=-0.4567
[EPOCH 026/089] train: loss=0.6744 acc=72.48% | val: loss=0.7155 acc=53.01% f1=68.80% auc=61.80% val_score=47.5643 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.188, mb=0.475, no=0.989, corr=-0.457) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1586 mb_mean=0.4761 norm_overlap=0.9817 corr_cb=-0.5433 topkJ=0.0036
[TRAIN][ep=027] loss=0.6645 acc=71.95%
[TRAIN][ep=027] mask_avg: mc_mean=0.1667 mb_mean=0.4751 norm_overlap=0.9886 corr_cb=-0.4513
[EPOCH 027/089] train: loss=0.6645 acc=71.95% | val: loss=0.7140 acc=54.22% f1=68.33% auc=61.80% val_score=51.1333 val_score_bestthr=55.6869 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.167, mb=0.475, no=0.989, corr=-0.451) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 55.6869
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1838 mb_mean=0.4761 norm_overlap=0.9886 corr_cb=-0.4751 topkJ=0.0113
[TRAIN][ep=028] loss=0.6572 acc=74.50%
[TRAIN][ep=028] mask_avg: mc_mean=0.2042 mb_mean=0.4751 norm_overlap=0.9900 corr_cb=-0.4554
[EPOCH 028/089] train: loss=0.6572 acc=74.50% | val: loss=0.7250 acc=55.42% f1=68.91% auc=61.69% val_score=53.4187 val_score_bestthr=57.1837 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.204, mb=0.475, no=0.990, corr=-0.455) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.1837
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2144 mb_mean=0.4731 norm_overlap=0.9910 corr_cb=-0.3879 topkJ=0.0044
[TRAIN][ep=029] loss=0.6644 acc=74.09%
[TRAIN][ep=029] mask_avg: mc_mean=0.1760 mb_mean=0.4751 norm_overlap=0.9887 corr_cb=-0.4526
[EPOCH 029/089] train: loss=0.6644 acc=74.09% | val: loss=0.7252 acc=63.86% f1=67.39% auc=61.40% val_score=42.6436 val_score_bestthr=56.9468 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.176, mb=0.475, no=0.989, corr=-0.453) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 56.9468
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2045 mb_mean=0.4709 norm_overlap=0.9937 corr_cb=-0.2908 topkJ=0.0246
[TRAIN][ep=030] loss=0.6542 acc=73.15%
[TRAIN][ep=030] mask_avg: mc_mean=0.1782 mb_mean=0.4751 norm_overlap=0.9886 corr_cb=-0.4636
[EPOCH 030/089] train: loss=0.6542 acc=73.15% | val: loss=0.7240 acc=62.65% f1=66.67% auc=61.51% val_score=44.0146 val_score_bestthr=57.0901 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.178, mb=0.475, no=0.989, corr=-0.464) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.0901
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2110 mb_mean=0.4752 norm_overlap=0.9900 corr_cb=-0.5209 topkJ=0.0047
[TRAIN][ep=031] loss=0.6399 acc=74.50%
[TRAIN][ep=031] mask_avg: mc_mean=0.1905 mb_mean=0.4751 norm_overlap=0.9891 corr_cb=-0.4540
[EPOCH 031/089] train: loss=0.6399 acc=74.50% | val: loss=0.7330 acc=62.65% f1=66.67% auc=61.16% val_score=38.1474 val_score_bestthr=57.0901 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.475, no=0.989, corr=-0.454) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.0901
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2125 mb_mean=0.4761 norm_overlap=0.9892 corr_cb=-0.5097 topkJ=0.0008
[TRAIN][ep=032] loss=0.6465 acc=74.90%
[TRAIN][ep=032] mask_avg: mc_mean=0.1955 mb_mean=0.4751 norm_overlap=0.9895 corr_cb=-0.4448
[EPOCH 032/089] train: loss=0.6465 acc=74.90% | val: loss=0.7357 acc=62.65% f1=66.67% auc=61.34% val_score=40.1527 val_score_bestthr=57.0901 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.195, mb=0.475, no=0.990, corr=-0.445) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.0901
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1922 mb_mean=0.4763 norm_overlap=0.9888 corr_cb=-0.4485 topkJ=0.0004
[TRAIN][ep=033] loss=0.6280 acc=75.70%
[TRAIN][ep=033] mask_avg: mc_mean=0.2056 mb_mean=0.4751 norm_overlap=0.9897 corr_cb=-0.4505
[EPOCH 033/089] train: loss=0.6280 acc=75.70% | val: loss=0.7452 acc=55.42% f1=68.91% auc=61.05% val_score=41.6754 val_score_bestthr=56.6837 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.206, mb=0.475, no=0.990, corr=-0.450) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 56.6837
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2128 mb_mean=0.4751 norm_overlap=0.9886 corr_cb=-0.4473 topkJ=0.0020
[TRAIN][ep=034] loss=0.6354 acc=75.30%
[TRAIN][ep=034] mask_avg: mc_mean=0.1961 mb_mean=0.4751 norm_overlap=0.9894 corr_cb=-0.4324
[EPOCH 034/089] train: loss=0.6354 acc=75.30% | val: loss=0.7295 acc=56.63% f1=69.49% auc=61.10% val_score=45.7372 val_score_bestthr=60.0820 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.196, mb=0.475, no=0.989, corr=-0.432) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 60.0820
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.0809 mb_mean=0.4732 norm_overlap=0.9897 corr_cb=-0.3138 topkJ=0.0119
[TRAIN][ep=035] loss=0.6251 acc=75.17%
[TRAIN][ep=035] mask_avg: mc_mean=0.1988 mb_mean=0.4751 norm_overlap=0.9897 corr_cb=-0.4243
[EPOCH 035/089] train: loss=0.6251 acc=75.17% | val: loss=0.7430 acc=65.06% f1=67.42% auc=62.09% val_score=51.9197 val_score_bestthr=57.6684 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.199, mb=0.475, no=0.990, corr=-0.424) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.6684
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2894 mb_mean=0.4753 norm_overlap=0.9928 corr_cb=-0.3584 topkJ=0.0145
[TRAIN][ep=036] loss=0.6160 acc=74.77%
[TRAIN][ep=036] mask_avg: mc_mean=0.2170 mb_mean=0.4751 norm_overlap=0.9904 corr_cb=-0.4331
[EPOCH 036/089] train: loss=0.6160 acc=74.77% | val: loss=0.7434 acc=56.63% f1=69.49% auc=61.05% val_score=49.8969 val_score_bestthr=60.0820 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.217, mb=0.475, no=0.990, corr=-0.433) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 60.0820
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1444 mb_mean=0.4766 norm_overlap=0.9869 corr_cb=-0.4898 topkJ=0.0031
[TRAIN][ep=037] loss=0.6171 acc=75.70%
[TRAIN][ep=037] mask_avg: mc_mean=0.1871 mb_mean=0.4751 norm_overlap=0.9897 corr_cb=-0.4192
[EPOCH 037/089] train: loss=0.6171 acc=75.70% | val: loss=0.7643 acc=55.42% f1=68.91% auc=61.57% val_score=38.0025 val_score_bestthr=56.6837 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.187, mb=0.475, no=0.990, corr=-0.419) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 56.6837
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.1943 mb_mean=0.4725 norm_overlap=0.9887 corr_cb=-0.4019 topkJ=0.0044
[TRAIN][ep=038] loss=0.6070 acc=76.78%
[TRAIN][ep=038] mask_avg: mc_mean=0.1973 mb_mean=0.4751 norm_overlap=0.9899 corr_cb=-0.4290
[EPOCH 038/089] train: loss=0.6070 acc=76.78% | val: loss=0.7747 acc=63.86% f1=67.39% auc=61.80% val_score=38.4759 val_score_bestthr=55.8076 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.197, mb=0.475, no=0.990, corr=-0.429) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 55.8076
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.1465 mb_mean=0.4760 norm_overlap=0.9892 corr_cb=-0.3938 topkJ=0.0032
[TRAIN][ep=039] loss=0.5994 acc=78.79%
[TRAIN][ep=039] mask_avg: mc_mean=0.2062 mb_mean=0.4751 norm_overlap=0.9901 corr_cb=-0.4277
[EPOCH 039/089] train: loss=0.5994 acc=78.79% | val: loss=0.7713 acc=55.42% f1=69.42% auc=61.63% val_score=40.0491 val_score_bestthr=57.2175 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.206, mb=0.475, no=0.990, corr=-0.428) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.2175
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.1785 mb_mean=0.4723 norm_overlap=0.9881 corr_cb=-0.4613 topkJ=0.0028
[TRAIN][ep=040] loss=0.6091 acc=76.64%
[TRAIN][ep=040] mask_avg: mc_mean=0.1697 mb_mean=0.4751 norm_overlap=0.9891 corr_cb=-0.4059
[EPOCH 040/089] train: loss=0.6091 acc=76.64% | val: loss=0.7664 acc=62.65% f1=66.67% auc=61.80% val_score=33.9573 val_score_bestthr=56.0333 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.170, mb=0.475, no=0.989, corr=-0.406) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 56.0333
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.2036 mb_mean=0.4730 norm_overlap=0.9929 corr_cb=-0.3618 topkJ=0.0047
[TRAIN][ep=041] loss=0.5948 acc=77.72%
[TRAIN][ep=041] mask_avg: mc_mean=0.2135 mb_mean=0.4751 norm_overlap=0.9906 corr_cb=-0.4150
[EPOCH 041/089] train: loss=0.5948 acc=77.72% | val: loss=0.7874 acc=62.65% f1=67.37% auc=61.28% val_score=33.9573 val_score_bestthr=58.4854 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.213, mb=0.475, no=0.991, corr=-0.415) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.4854
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.1642 mb_mean=0.4770 norm_overlap=0.9887 corr_cb=-0.4563 topkJ=0.0019
[TRAIN][ep=042] loss=0.5784 acc=78.93%
[TRAIN][ep=042] mask_avg: mc_mean=0.2111 mb_mean=0.4751 norm_overlap=0.9905 corr_cb=-0.4112
[EPOCH 042/089] train: loss=0.5784 acc=78.93% | val: loss=0.7876 acc=57.83% f1=70.09% auc=61.34% val_score=35.2635 val_score_bestthr=57.5812 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.211, mb=0.475, no=0.990, corr=-0.411) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.5812
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.2282 mb_mean=0.4700 norm_overlap=0.9911 corr_cb=-0.3812 topkJ=0.0024
[TRAIN][ep=043] loss=0.5777 acc=79.60%
[TRAIN][ep=043] mask_avg: mc_mean=0.1884 mb_mean=0.4751 norm_overlap=0.9897 corr_cb=-0.4145
[EPOCH 043/089] train: loss=0.5777 acc=79.60% | val: loss=0.7906 acc=56.63% f1=69.49% auc=60.41% val_score=44.0146 val_score_bestthr=58.3873 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.188, mb=0.475, no=0.990, corr=-0.414) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.3873
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2176 mb_mean=0.4723 norm_overlap=0.9916 corr_cb=-0.3501 topkJ=0.0111
[TRAIN][ep=044] loss=0.5601 acc=80.67%
[TRAIN][ep=044] mask_avg: mc_mean=0.2225 mb_mean=0.4751 norm_overlap=0.9911 corr_cb=-0.3992
[EPOCH 044/089] train: loss=0.5601 acc=80.67% | val: loss=0.8040 acc=55.42% f1=69.42% auc=60.93% val_score=39.3645 val_score_bestthr=57.2175 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.222, mb=0.475, no=0.991, corr=-0.399) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.2175
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2123 mb_mean=0.4732 norm_overlap=0.9874 corr_cb=-0.4712 topkJ=0.0035
[TRAIN][ep=045] loss=0.5667 acc=79.87%
[TRAIN][ep=045] mask_avg: mc_mean=0.2033 mb_mean=0.4751 norm_overlap=0.9904 corr_cb=-0.4049
[EPOCH 045/089] train: loss=0.5667 acc=79.87% | val: loss=0.8952 acc=56.63% f1=69.49% auc=60.52% val_score=47.6719 val_score_bestthr=58.3873 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.203, mb=0.475, no=0.990, corr=-0.405) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.3873
[EARLY STOP] no improvement for 30 epochs. best_epoch=15
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/ckpt_best_fold_4.pt
=============== FIT DONE ===============
[BEST] epoch=15 | val_acc=54.22% | val_f1=69.35% | val_auc=57.27% | val_score=36.9873 | val_score_bestthr=62.5593
[TEST@BEST] thr_used=0.325 | acc=70.53% f1=71.89% auc=72.59% | SP_sex=13.04% EO_sex=7.47% SP_age=23.31% EO_age=22.11%
[TIME] 1.16 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/summary_fold_4.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4653 mb_mean=0.4746 norm_overlap=1.0000 corr_cb=0.0009 topkJ=0.0721
[TRAIN][ep=000] loss=0.6948 acc=51.41%
[TRAIN][ep=000] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0577
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4666 mb_mean=0.4760 norm_overlap=1.0000 corr_cb=-0.0804 topkJ=0.0394
[TRAIN][ep=001] loss=0.6935 acc=51.68%
[TRAIN][ep=001] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0520
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4641 mb_mean=0.4759 norm_overlap=0.9999 corr_cb=-0.1516 topkJ=0.0427
[TRAIN][ep=002] loss=0.6919 acc=51.95%
[TRAIN][ep=002] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0518
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4682 mb_mean=0.4728 norm_overlap=1.0000 corr_cb=0.0088 topkJ=0.0867
[TRAIN][ep=003] loss=0.6903 acc=54.09%
[TRAIN][ep=003] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0540
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4660 mb_mean=0.4754 norm_overlap=0.9999 corr_cb=-0.2222 topkJ=0.0188
[TRAIN][ep=004] loss=0.6897 acc=54.90%
[TRAIN][ep=004] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0496
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4691 mb_mean=0.4730 norm_overlap=1.0000 corr_cb=-0.0798 topkJ=0.0197
[TRAIN][ep=005] loss=0.6875 acc=54.09%
[TRAIN][ep=005] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0535
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4653 mb_mean=0.4739 norm_overlap=0.9999 corr_cb=-0.2608 topkJ=0.0412
[TRAIN][ep=006] loss=0.6841 acc=54.36%
[TRAIN][ep=006] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0534
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4637 mb_mean=0.4748 norm_overlap=1.0000 corr_cb=0.0031 topkJ=0.0692
[TRAIN][ep=007] loss=0.6832 acc=56.11%
[TRAIN][ep=007] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0487
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4635 mb_mean=0.4737 norm_overlap=1.0000 corr_cb=0.0553 topkJ=0.0628
[TRAIN][ep=008] loss=0.6802 acc=58.26%
[TRAIN][ep=008] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0575
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4622 mb_mean=0.4769 norm_overlap=1.0000 corr_cb=-0.0556 topkJ=0.0226
[TRAIN][ep=009] loss=0.6746 acc=59.06%
[TRAIN][ep=009] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0557
================= FIT START (fold=4) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4686 mb_mean=0.4721 norm_overlap=0.9999 corr_cb=-0.1822 topkJ=0.0197
[TRAIN][ep=000] loss=0.6702 acc=59.73%
[TRAIN][ep=000] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0534
[EPOCH 000/089] train: loss=0.6702 acc=59.73% | val: loss=0.6787 acc=55.42% f1=69.42% auc=58.37% val_score=50.4958 val_score_bestthr=60.8841 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.053) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 60.8841
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/ckpt_best_fold_4.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4665 mb_mean=0.4758 norm_overlap=0.9999 corr_cb=-0.1292 topkJ=0.0478
[TRAIN][ep=001] loss=0.6623 acc=62.68%
[TRAIN][ep=001] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0547
[EPOCH 001/089] train: loss=0.6623 acc=62.68% | val: loss=0.6767 acc=57.83% f1=70.09% auc=59.13% val_score=39.9204 val_score_bestthr=61.3697 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.055) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 60.8841 -> 61.3697
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/ckpt_best_fold_4.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4682 mb_mean=0.4745 norm_overlap=1.0000 corr_cb=0.0238 topkJ=0.0471
[TRAIN][ep=002] loss=0.6633 acc=59.06%
[TRAIN][ep=002] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0516
[EPOCH 002/089] train: loss=0.6633 acc=59.06% | val: loss=0.6778 acc=56.63% f1=69.49% auc=58.20% val_score=40.6876 val_score_bestthr=61.0366 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.052) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 61.0366
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4654 mb_mean=0.4739 norm_overlap=1.0000 corr_cb=0.0819 topkJ=0.0805
[TRAIN][ep=003] loss=0.6574 acc=60.94%
[TRAIN][ep=003] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0531
[EPOCH 003/089] train: loss=0.6574 acc=60.94% | val: loss=0.6747 acc=56.63% f1=69.49% auc=58.43% val_score=37.5008 val_score_bestthr=61.0366 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.053) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 61.0366
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4650 mb_mean=0.4728 norm_overlap=0.9999 corr_cb=-0.1206 topkJ=0.0236
[TRAIN][ep=004] loss=0.6530 acc=61.88%
[TRAIN][ep=004] mask_avg: mc_mean=0.4658 mb_mean=0.4751 norm_overlap=1.0000 corr_cb=-0.0547
[EPOCH 004/089] train: loss=0.6530 acc=61.88% | val: loss=0.6754 acc=56.63% f1=69.49% auc=58.78% val_score=38.5869 val_score_bestthr=61.0366 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.466, mb=0.475, no=1.000, corr=-0.055) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 61.0366
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4674 mb_mean=0.4747 norm_overlap=0.9999 corr_cb=-0.1348 topkJ=0.0317
[TRAIN][ep=005] loss=1.3760 acc=62.55%
[TRAIN][ep=005] mask_avg: mc_mean=0.3633 mb_mean=0.4751 norm_overlap=0.9989 corr_cb=-0.3382
[EPOCH 005/089] train: loss=1.3760 acc=62.55% | val: loss=0.6775 acc=56.63% f1=68.97% auc=59.19% val_score=51.0255 val_score_bestthr=58.8798 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.363, mb=0.475, no=0.999, corr=-0.338) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 58.8798
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2850 mb_mean=0.4698 norm_overlap=0.9972 corr_cb=-0.4730 topkJ=0.0194
[TRAIN][ep=006] loss=1.3506 acc=64.56%
[TRAIN][ep=006] mask_avg: mc_mean=0.2339 mb_mean=0.4751 norm_overlap=0.9973 corr_cb=-0.3634
[EPOCH 006/089] train: loss=1.3506 acc=64.56% | val: loss=0.6806 acc=55.42% f1=68.91% auc=58.02% val_score=41.3057 val_score_bestthr=59.4716 | dyn(w_pfs=0.240, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.234, mb=0.475, no=0.997, corr=-0.363) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 59.4716
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2368 mb_mean=0.4739 norm_overlap=0.9971 corr_cb=-0.3897 topkJ=0.0117
[TRAIN][ep=007] loss=1.1542 acc=62.55%
[TRAIN][ep=007] mask_avg: mc_mean=0.1889 mb_mean=0.4751 norm_overlap=0.9965 corr_cb=-0.3459
[EPOCH 007/089] train: loss=1.1542 acc=62.55% | val: loss=0.6778 acc=55.42% f1=68.91% auc=57.62% val_score=44.0337 val_score_bestthr=59.4716 | dyn(w_pfs=0.140, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.189, mb=0.475, no=0.996, corr=-0.346) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 59.4716
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1605 mb_mean=0.4764 norm_overlap=0.9953 corr_cb=-0.4074 topkJ=0.0180
[TRAIN][ep=008] loss=0.9629 acc=63.36%
[TRAIN][ep=008] mask_avg: mc_mean=0.1592 mb_mean=0.4751 norm_overlap=0.9955 corr_cb=-0.3475
[EPOCH 008/089] train: loss=0.9629 acc=63.36% | val: loss=0.6848 acc=57.83% f1=69.03% auc=59.42% val_score=49.4985 val_score_bestthr=58.1893 | dyn(w_pfs=0.040, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.159, mb=0.475, no=0.996, corr=-0.347) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 58.1893
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1184 mb_mean=0.4786 norm_overlap=0.9934 corr_cb=-0.4138 topkJ=0.0073
[TRAIN][ep=009] loss=0.9230 acc=65.10%
[TRAIN][ep=009] mask_avg: mc_mean=0.1452 mb_mean=0.4751 norm_overlap=0.9948 corr_cb=-0.3586
[EPOCH 009/089] train: loss=0.9230 acc=65.10% | val: loss=0.6789 acc=55.42% f1=68.91% auc=57.79% val_score=42.8608 val_score_bestthr=59.4716 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.145, mb=0.475, no=0.995, corr=-0.359) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 59.4716
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1640 mb_mean=0.4729 norm_overlap=0.9942 corr_cb=-0.4322 topkJ=0.0065
[TRAIN][ep=010] loss=0.9156 acc=64.16%
[TRAIN][ep=010] mask_avg: mc_mean=0.1390 mb_mean=0.4751 norm_overlap=0.9941 corr_cb=-0.3910
[EPOCH 010/089] train: loss=0.9156 acc=64.16% | val: loss=0.7115 acc=55.42% f1=68.38% auc=55.93% val_score=39.3776 val_score_bestthr=59.8140 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.139, mb=0.475, no=0.994, corr=-0.391) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.3697 -> 59.8140
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1378 mb_mean=0.4768 norm_overlap=0.9888 corr_cb=-0.5809 topkJ=0.0004
[TRAIN][ep=011] loss=0.9048 acc=64.70%
[TRAIN][ep=011] mask_avg: mc_mean=0.1440 mb_mean=0.4751 norm_overlap=0.9934 corr_cb=-0.4440
[EPOCH 011/089] train: loss=0.9048 acc=64.70% | val: loss=0.6960 acc=54.22% f1=69.35% auc=57.50% val_score=35.4943 val_score_bestthr=62.5593 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.144, mb=0.475, no=0.993, corr=-0.444) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 61.3697 -> 62.5593
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/ckpt_best_fold_4.pt
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1305 mb_mean=0.4755 norm_overlap=0.9920 corr_cb=-0.4379 topkJ=0.0112
[TRAIN][ep=012] loss=0.9618 acc=66.58%
[TRAIN][ep=012] mask_avg: mc_mean=0.1343 mb_mean=0.4751 norm_overlap=0.9928 corr_cb=-0.4266
[EPOCH 012/089] train: loss=0.9618 acc=66.58% | val: loss=0.6826 acc=55.42% f1=69.42% auc=58.31% val_score=46.8304 val_score_bestthr=58.5609 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.134, mb=0.475, no=0.993, corr=-0.427) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.5609
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1313 mb_mean=0.4743 norm_overlap=0.9907 corr_cb=-0.5030 topkJ=0.0024
[TRAIN][ep=013] loss=1.0462 acc=66.71%
[TRAIN][ep=013] mask_avg: mc_mean=0.1182 mb_mean=0.4751 norm_overlap=0.9914 corr_cb=-0.4395
[EPOCH 013/089] train: loss=1.0462 acc=66.71% | val: loss=0.7095 acc=57.83% f1=69.03% auc=59.65% val_score=58.1893 val_score_bestthr=58.1893 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.118, mb=0.475, no=0.991, corr=-0.440) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.1893
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1340 mb_mean=0.4742 norm_overlap=0.9921 corr_cb=-0.4755 topkJ=0.0093
[TRAIN][ep=014] loss=1.1107 acc=66.44%
[TRAIN][ep=014] mask_avg: mc_mean=0.1267 mb_mean=0.4751 norm_overlap=0.9909 corr_cb=-0.4637
[EPOCH 014/089] train: loss=1.1107 acc=66.44% | val: loss=0.6796 acc=54.22% f1=68.85% auc=59.24% val_score=47.3184 val_score_bestthr=57.8426 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.127, mb=0.475, no=0.991, corr=-0.464) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.8426
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1731 mb_mean=0.4730 norm_overlap=0.9922 corr_cb=-0.4908 topkJ=0.0040
[TRAIN][ep=015] loss=1.1771 acc=66.04%
[TRAIN][ep=015] mask_avg: mc_mean=0.1364 mb_mean=0.4751 norm_overlap=0.9905 corr_cb=-0.4835
[EPOCH 015/089] train: loss=1.1771 acc=66.04% | val: loss=0.7464 acc=54.22% f1=69.35% auc=57.21% val_score=39.5013 val_score_bestthr=62.5593 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.136, mb=0.475, no=0.990, corr=-0.483) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 62.5593
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1443 mb_mean=0.4758 norm_overlap=0.9897 corr_cb=-0.5197 topkJ=0.0012
[TRAIN][ep=016] loss=1.2416 acc=68.99%
[TRAIN][ep=016] mask_avg: mc_mean=0.1406 mb_mean=0.4751 norm_overlap=0.9899 corr_cb=-0.4896
[EPOCH 016/089] train: loss=1.2416 acc=68.99% | val: loss=0.6974 acc=54.22% f1=69.35% auc=58.26% val_score=40.0945 val_score_bestthr=62.5593 | dyn(w_pfs=0.100, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.141, mb=0.475, no=0.990, corr=-0.490) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 62.5593
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1210 mb_mean=0.4750 norm_overlap=0.9894 corr_cb=-0.4665 topkJ=0.0039
[TRAIN][ep=017] loss=1.0578 acc=67.52%
[TRAIN][ep=017] mask_avg: mc_mean=0.1428 mb_mean=0.4751 norm_overlap=0.9897 corr_cb=-0.4600
[EPOCH 017/089] train: loss=1.0578 acc=67.52% | val: loss=0.7373 acc=54.22% f1=69.35% auc=58.02% val_score=35.2367 val_score_bestthr=62.5593 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.143, mb=0.475, no=0.990, corr=-0.460) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 62.5593
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1092 mb_mean=0.4762 norm_overlap=0.9896 corr_cb=-0.4252 topkJ=0.0015
[TRAIN][ep=018] loss=0.8642 acc=69.66%
[TRAIN][ep=018] mask_avg: mc_mean=0.1312 mb_mean=0.4751 norm_overlap=0.9879 corr_cb=-0.5118
[EPOCH 018/089] train: loss=0.8642 acc=69.66% | val: loss=0.7283 acc=56.63% f1=68.42% auc=60.87% val_score=50.6278 val_score_bestthr=58.2662 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.131, mb=0.475, no=0.988, corr=-0.512) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.2662
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1438 mb_mean=0.4778 norm_overlap=0.9908 corr_cb=-0.5490 topkJ=0.0000
[TRAIN][ep=019] loss=0.8532 acc=67.92%
[TRAIN][ep=019] mask_avg: mc_mean=0.1778 mb_mean=0.4751 norm_overlap=0.9898 corr_cb=-0.5016
[EPOCH 019/089] train: loss=0.8532 acc=67.92% | val: loss=0.7484 acc=56.63% f1=68.42% auc=61.45% val_score=53.7367 val_score_bestthr=58.2662 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.178, mb=0.475, no=0.990, corr=-0.502) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.2662
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1441 mb_mean=0.4735 norm_overlap=0.9899 corr_cb=-0.4864 topkJ=0.0016
[TRAIN][ep=020] loss=0.8462 acc=70.60%
[TRAIN][ep=020] mask_avg: mc_mean=0.1571 mb_mean=0.4751 norm_overlap=0.9884 corr_cb=-0.5209
[EPOCH 020/089] train: loss=0.8462 acc=70.60% | val: loss=0.6878 acc=53.01% f1=68.80% auc=61.92% val_score=45.3893 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.157, mb=0.475, no=0.988, corr=-0.521) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2319 mb_mean=0.4739 norm_overlap=0.9890 corr_cb=-0.5947 topkJ=0.0000
[TRAIN][ep=021] loss=0.8269 acc=70.74%
[TRAIN][ep=021] mask_avg: mc_mean=0.1740 mb_mean=0.4751 norm_overlap=0.9890 corr_cb=-0.4924
[EPOCH 021/089] train: loss=0.8269 acc=70.74% | val: loss=0.7001 acc=53.01% f1=68.80% auc=61.05% val_score=45.1295 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.174, mb=0.475, no=0.989, corr=-0.492) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1590 mb_mean=0.4744 norm_overlap=0.9894 corr_cb=-0.4839 topkJ=0.0036
[TRAIN][ep=022] loss=0.8234 acc=68.86%
[TRAIN][ep=022] mask_avg: mc_mean=0.1468 mb_mean=0.4751 norm_overlap=0.9880 corr_cb=-0.4668
[EPOCH 022/089] train: loss=0.8234 acc=68.86% | val: loss=0.7060 acc=53.01% f1=68.80% auc=61.57% val_score=50.9811 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.147, mb=0.475, no=0.988, corr=-0.467) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2126 mb_mean=0.4735 norm_overlap=0.9912 corr_cb=-0.4894 topkJ=0.0092
[TRAIN][ep=023] loss=0.8172 acc=72.21%
[TRAIN][ep=023] mask_avg: mc_mean=0.1755 mb_mean=0.4751 norm_overlap=0.9892 corr_cb=-0.4633
[EPOCH 023/089] train: loss=0.8172 acc=72.21% | val: loss=0.7182 acc=53.01% f1=68.80% auc=61.51% val_score=48.6990 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.175, mb=0.475, no=0.989, corr=-0.463) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1919 mb_mean=0.4758 norm_overlap=0.9873 corr_cb=-0.6255 topkJ=0.0000
[TRAIN][ep=024] loss=0.8030 acc=73.29%
[TRAIN][ep=024] mask_avg: mc_mean=0.1761 mb_mean=0.4751 norm_overlap=0.9889 corr_cb=-0.4749
[EPOCH 024/089] train: loss=0.8030 acc=73.29% | val: loss=0.7089 acc=53.01% f1=68.80% auc=61.69% val_score=50.0017 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.176, mb=0.475, no=0.989, corr=-0.475) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1729 mb_mean=0.4754 norm_overlap=0.9919 corr_cb=-0.3876 topkJ=0.0137
[TRAIN][ep=025] loss=0.7988 acc=71.81%
[TRAIN][ep=025] mask_avg: mc_mean=0.1935 mb_mean=0.4751 norm_overlap=0.9898 corr_cb=-0.4545
[EPOCH 025/089] train: loss=0.7988 acc=71.81% | val: loss=0.7137 acc=53.01% f1=68.80% auc=61.57% val_score=51.2544 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.194, mb=0.475, no=0.990, corr=-0.455) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1882 mb_mean=0.4756 norm_overlap=0.9918 corr_cb=-0.4481 topkJ=0.0063
[TRAIN][ep=026] loss=0.7966 acc=72.89%
[TRAIN][ep=026] mask_avg: mc_mean=0.1878 mb_mean=0.4751 norm_overlap=0.9895 corr_cb=-0.4599
[EPOCH 026/089] train: loss=0.7966 acc=72.89% | val: loss=0.7141 acc=53.01% f1=68.80% auc=61.92% val_score=48.2047 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.188, mb=0.475, no=0.989, corr=-0.460) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.2320
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1595 mb_mean=0.4761 norm_overlap=0.9818 corr_cb=-0.5449 topkJ=0.0036
[TRAIN][ep=027] loss=0.7849 acc=72.08%
[TRAIN][ep=027] mask_avg: mc_mean=0.1672 mb_mean=0.4751 norm_overlap=0.9886 corr_cb=-0.4542
[EPOCH 027/089] train: loss=0.7849 acc=72.08% | val: loss=0.7131 acc=54.22% f1=68.33% auc=62.15% val_score=51.1333 val_score_bestthr=55.6869 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.167, mb=0.475, no=0.989, corr=-0.454) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 55.6869
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1846 mb_mean=0.4761 norm_overlap=0.9887 corr_cb=-0.4773 topkJ=0.0101
[TRAIN][ep=028] loss=0.7775 acc=74.77%
[TRAIN][ep=028] mask_avg: mc_mean=0.2044 mb_mean=0.4751 norm_overlap=0.9900 corr_cb=-0.4578
[EPOCH 028/089] train: loss=0.7775 acc=74.77% | val: loss=0.7239 acc=55.42% f1=68.91% auc=61.86% val_score=53.4187 val_score_bestthr=57.1837 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.204, mb=0.475, no=0.990, corr=-0.458) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.1837
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2141 mb_mean=0.4731 norm_overlap=0.9910 corr_cb=-0.3868 topkJ=0.0044
[TRAIN][ep=029] loss=0.7840 acc=73.42%
[TRAIN][ep=029] mask_avg: mc_mean=0.1756 mb_mean=0.4751 norm_overlap=0.9887 corr_cb=-0.4547
[EPOCH 029/089] train: loss=0.7840 acc=73.42% | val: loss=0.7226 acc=63.86% f1=67.39% auc=61.45% val_score=42.6436 val_score_bestthr=56.9468 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.176, mb=0.475, no=0.989, corr=-0.455) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 56.9468
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2056 mb_mean=0.4709 norm_overlap=0.9937 corr_cb=-0.2918 topkJ=0.0242
[TRAIN][ep=030] loss=0.7727 acc=73.15%
[TRAIN][ep=030] mask_avg: mc_mean=0.1794 mb_mean=0.4751 norm_overlap=0.9886 corr_cb=-0.4659
[EPOCH 030/089] train: loss=0.7727 acc=73.15% | val: loss=0.7224 acc=62.65% f1=66.67% auc=61.57% val_score=51.9197 val_score_bestthr=57.0901 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.179, mb=0.475, no=0.989, corr=-0.466) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.0901
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2100 mb_mean=0.4752 norm_overlap=0.9900 corr_cb=-0.5226 topkJ=0.0039
[TRAIN][ep=031] loss=0.7572 acc=74.23%
[TRAIN][ep=031] mask_avg: mc_mean=0.1912 mb_mean=0.4751 norm_overlap=0.9892 corr_cb=-0.4561
[EPOCH 031/089] train: loss=0.7572 acc=74.23% | val: loss=0.7310 acc=62.65% f1=66.67% auc=61.45% val_score=38.1474 val_score_bestthr=57.0901 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.191, mb=0.475, no=0.989, corr=-0.456) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.0901
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2138 mb_mean=0.4761 norm_overlap=0.9893 corr_cb=-0.5093 topkJ=0.0008
[TRAIN][ep=032] loss=0.7634 acc=74.77%
[TRAIN][ep=032] mask_avg: mc_mean=0.1961 mb_mean=0.4751 norm_overlap=0.9895 corr_cb=-0.4467
[EPOCH 032/089] train: loss=0.7634 acc=74.77% | val: loss=0.7357 acc=61.45% f1=65.96% auc=61.51% val_score=41.6754 val_score_bestthr=56.9064 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.196, mb=0.475, no=0.990, corr=-0.447) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 56.9064
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1922 mb_mean=0.4763 norm_overlap=0.9888 corr_cb=-0.4503 topkJ=0.0004
[TRAIN][ep=033] loss=0.7448 acc=75.57%
[TRAIN][ep=033] mask_avg: mc_mean=0.2057 mb_mean=0.4751 norm_overlap=0.9897 corr_cb=-0.4522
[EPOCH 033/089] train: loss=0.7448 acc=75.57% | val: loss=0.7418 acc=65.06% f1=68.13% auc=61.34% val_score=41.4998 val_score_bestthr=58.0568 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.206, mb=0.475, no=0.990, corr=-0.452) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.0568
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2119 mb_mean=0.4751 norm_overlap=0.9886 corr_cb=-0.4477 topkJ=0.0020
[TRAIN][ep=034] loss=0.7525 acc=75.70%
[TRAIN][ep=034] mask_avg: mc_mean=0.1955 mb_mean=0.4751 norm_overlap=0.9893 corr_cb=-0.4341
[EPOCH 034/089] train: loss=0.7525 acc=75.70% | val: loss=0.7270 acc=55.42% f1=69.42% auc=61.40% val_score=45.7372 val_score_bestthr=57.2175 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.196, mb=0.475, no=0.989, corr=-0.434) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.2175
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.0781 mb_mean=0.4732 norm_overlap=0.9895 corr_cb=-0.3142 topkJ=0.0119
[TRAIN][ep=035] loss=0.7419 acc=75.03%
[TRAIN][ep=035] mask_avg: mc_mean=0.1980 mb_mean=0.4751 norm_overlap=0.9897 corr_cb=-0.4262
[EPOCH 035/089] train: loss=0.7419 acc=75.03% | val: loss=0.7396 acc=54.22% f1=68.85% auc=62.33% val_score=51.2544 val_score_bestthr=57.6940 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.198, mb=0.475, no=0.990, corr=-0.426) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 57.6940
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2866 mb_mean=0.4753 norm_overlap=0.9927 corr_cb=-0.3619 topkJ=0.0145
[TRAIN][ep=036] loss=0.7292 acc=75.03%
[TRAIN][ep=036] mask_avg: mc_mean=0.2175 mb_mean=0.4751 norm_overlap=0.9904 corr_cb=-0.4347
[EPOCH 036/089] train: loss=0.7292 acc=75.03% | val: loss=0.7397 acc=56.63% f1=69.49% auc=61.22% val_score=49.8969 val_score_bestthr=60.0820 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.217, mb=0.475, no=0.990, corr=-0.435) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 60.0820
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1447 mb_mean=0.4766 norm_overlap=0.9869 corr_cb=-0.4901 topkJ=0.0031
[TRAIN][ep=037] loss=0.7295 acc=75.70%
[TRAIN][ep=037] mask_avg: mc_mean=0.1878 mb_mean=0.4751 norm_overlap=0.9898 corr_cb=-0.4201
[EPOCH 037/089] train: loss=0.7295 acc=75.70% | val: loss=0.7643 acc=59.04% f1=70.69% auc=61.51% val_score=38.4759 val_score_bestthr=61.9165 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.188, mb=0.475, no=0.990, corr=-0.420) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 61.9165
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.1949 mb_mean=0.4725 norm_overlap=0.9888 corr_cb=-0.4024 topkJ=0.0040
[TRAIN][ep=038] loss=0.7177 acc=76.78%
[TRAIN][ep=038] mask_avg: mc_mean=0.1988 mb_mean=0.4751 norm_overlap=0.9900 corr_cb=-0.4294
[EPOCH 038/089] train: loss=0.7177 acc=76.78% | val: loss=0.7771 acc=56.63% f1=69.49% auc=61.74% val_score=36.9073 val_score_bestthr=58.1820 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.199, mb=0.475, no=0.990, corr=-0.429) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.1820
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.1517 mb_mean=0.4760 norm_overlap=0.9893 corr_cb=-0.3976 topkJ=0.0032
[TRAIN][ep=039] loss=0.7104 acc=78.66%
[TRAIN][ep=039] mask_avg: mc_mean=0.2084 mb_mean=0.4751 norm_overlap=0.9902 corr_cb=-0.4280
[EPOCH 039/089] train: loss=0.7104 acc=78.66% | val: loss=0.7745 acc=57.83% f1=70.09% auc=61.69% val_score=36.4819 val_score_bestthr=59.0151 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.208, mb=0.475, no=0.990, corr=-0.428) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 59.0151
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.1812 mb_mean=0.4723 norm_overlap=0.9883 corr_cb=-0.4592 topkJ=0.0032
[TRAIN][ep=040] loss=0.7222 acc=76.91%
[TRAIN][ep=040] mask_avg: mc_mean=0.1699 mb_mean=0.4751 norm_overlap=0.9892 corr_cb=-0.4052
[EPOCH 040/089] train: loss=0.7222 acc=76.91% | val: loss=0.7622 acc=63.86% f1=67.39% auc=62.15% val_score=33.9573 val_score_bestthr=58.2801 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.170, mb=0.475, no=0.989, corr=-0.405) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.2801
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.2087 mb_mean=0.4730 norm_overlap=0.9930 corr_cb=-0.3636 topkJ=0.0039
[TRAIN][ep=041] loss=0.7080 acc=77.85%
[TRAIN][ep=041] mask_avg: mc_mean=0.2158 mb_mean=0.4751 norm_overlap=0.9907 corr_cb=-0.4147
[EPOCH 041/089] train: loss=0.7080 acc=77.85% | val: loss=0.7853 acc=56.63% f1=67.86% auc=61.63% val_score=33.9573 val_score_bestthr=58.7637 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.216, mb=0.475, no=0.991, corr=-0.415) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.5593 -> 58.7637
[EARLY STOP] no improvement for 30 epochs. best_epoch=11
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/ckpt_best_fold_4.pt
=============== FIT DONE ===============
[BEST] epoch=11 | val_acc=54.22% | val_f1=69.35% | val_auc=57.50% | val_score=35.4943 | val_score_bestthr=62.5593
[TEST@BEST] thr_used=0.375 | acc=69.08% f1=73.55% auc=71.30% | SP_sex=14.13% EO_sex=10.92% SP_age=16.95% EO_age=20.07%
[TIME] 1.18 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold4_rep2_seed2004/summary_fold_4.json
