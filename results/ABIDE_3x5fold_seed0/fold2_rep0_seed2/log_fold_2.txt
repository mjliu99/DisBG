[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4477 mb_mean=0.4964 norm_overlap=1.0006 corr_cb=0.6199 topkJ=0.1849
[TRAIN][ep=000] loss=0.6950 acc=48.86%
[TRAIN][ep=000] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5111
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4378 mb_mean=0.4940 norm_overlap=1.0005 corr_cb=0.5338 topkJ=0.1816
[TRAIN][ep=001] loss=0.6931 acc=52.48%
[TRAIN][ep=001] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5175
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4517 mb_mean=0.4988 norm_overlap=1.0004 corr_cb=0.4909 topkJ=0.1226
[TRAIN][ep=002] loss=0.6932 acc=51.68%
[TRAIN][ep=002] mask_avg: mc_mean=0.4463 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5077
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4474 mb_mean=0.4963 norm_overlap=1.0004 corr_cb=0.4696 topkJ=0.1653
[TRAIN][ep=003] loss=0.6931 acc=49.93%
[TRAIN][ep=003] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5044
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4425 mb_mean=0.4921 norm_overlap=1.0010 corr_cb=0.7152 topkJ=0.2130
[TRAIN][ep=004] loss=0.6922 acc=51.95%
[TRAIN][ep=004] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5027
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4529 mb_mean=0.4986 norm_overlap=1.0003 corr_cb=0.4542 topkJ=0.1703
[TRAIN][ep=005] loss=0.6905 acc=55.03%
[TRAIN][ep=005] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5020
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4536 mb_mean=0.4984 norm_overlap=1.0003 corr_cb=0.3933 topkJ=0.1356
[TRAIN][ep=006] loss=0.6899 acc=56.51%
[TRAIN][ep=006] mask_avg: mc_mean=0.4463 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5030
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4543 mb_mean=0.4986 norm_overlap=1.0005 corr_cb=0.5123 topkJ=0.1231
[TRAIN][ep=007] loss=0.6890 acc=55.30%
[TRAIN][ep=007] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5158
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4444 mb_mean=0.4958 norm_overlap=1.0005 corr_cb=0.5646 topkJ=0.1270
[TRAIN][ep=008] loss=0.6884 acc=53.83%
[TRAIN][ep=008] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5070
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4465 mb_mean=0.4969 norm_overlap=1.0003 corr_cb=0.4721 topkJ=0.1699
[TRAIN][ep=009] loss=0.6878 acc=53.29%
[TRAIN][ep=009] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5069
================= FIT START (fold=2) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4558 mb_mean=0.5004 norm_overlap=1.0002 corr_cb=0.3859 topkJ=0.1398
[TRAIN][ep=000] loss=0.6860 acc=56.51%
[TRAIN][ep=000] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5085
[EPOCH 000/089] train: loss=0.6860 acc=56.51% | val: loss=0.6850 acc=67.47% f1=68.24% auc=68.84% val_score=59.2537 val_score_bestthr=66.5634 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.446, mb=0.496, no=1.000, corr=0.509) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 66.5634
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4538 mb_mean=0.4979 norm_overlap=1.0003 corr_cb=0.4016 topkJ=0.2040
[TRAIN][ep=001] loss=0.6844 acc=60.54%
[TRAIN][ep=001] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5121
[EPOCH 001/089] train: loss=0.6844 acc=60.54% | val: loss=0.6827 acc=61.45% f1=69.23% auc=70.00% val_score=62.2213 val_score_bestthr=62.2213 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.446, mb=0.496, no=1.001, corr=0.512) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.5634 -> 62.2213
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4475 mb_mean=0.4963 norm_overlap=1.0004 corr_cb=0.4390 topkJ=0.0795
[TRAIN][ep=002] loss=0.6830 acc=62.28%
[TRAIN][ep=002] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5046
[EPOCH 002/089] train: loss=0.6830 acc=62.28% | val: loss=0.6808 acc=66.27% f1=72.00% auc=70.00% val_score=59.0699 val_score_bestthr=70.1698 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.446, mb=0.496, no=1.000, corr=0.505) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 66.5634 -> 70.1698
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4442 mb_mean=0.4982 norm_overlap=1.0006 corr_cb=0.5457 topkJ=0.1279
[TRAIN][ep=003] loss=0.6828 acc=61.74%
[TRAIN][ep=003] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5061
[EPOCH 003/089] train: loss=0.6828 acc=61.74% | val: loss=0.6800 acc=61.45% f1=70.37% auc=69.77% val_score=62.2804 val_score_bestthr=64.1554 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.446, mb=0.496, no=1.000, corr=0.506) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.1698 -> 64.1554
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4474 mb_mean=0.4978 norm_overlap=1.0003 corr_cb=0.4220 topkJ=0.0832
[TRAIN][ep=004] loss=0.6802 acc=61.88%
[TRAIN][ep=004] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5086
[EPOCH 004/089] train: loss=0.6802 acc=61.88% | val: loss=0.6789 acc=67.47% f1=70.33% auc=68.78% val_score=58.1944 val_score_bestthr=66.4456 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.446, mb=0.496, no=1.001, corr=0.509) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.1698 -> 66.4456
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4503 mb_mean=0.4974 norm_overlap=1.0004 corr_cb=0.4973 topkJ=0.1639
[TRAIN][ep=005] loss=1.2728 acc=57.05%
[TRAIN][ep=005] mask_avg: mc_mean=0.3342 mb_mean=0.4961 norm_overlap=1.0020 corr_cb=0.5121
[EPOCH 005/089] train: loss=1.2728 acc=57.05% | val: loss=0.6799 acc=67.47% f1=69.66% auc=69.42% val_score=55.8830 val_score_bestthr=66.6588 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.334, mb=0.496, no=1.002, corr=0.512) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.1698 -> 66.6588
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2701 mb_mean=0.4955 norm_overlap=1.0031 corr_cb=0.4723 topkJ=0.1449
[TRAIN][ep=006] loss=1.2619 acc=63.49%
[TRAIN][ep=006] mask_avg: mc_mean=0.2604 mb_mean=0.4961 norm_overlap=1.0027 corr_cb=0.4033
[EPOCH 006/089] train: loss=1.2619 acc=63.49% | val: loss=0.6762 acc=66.27% f1=70.83% auc=69.94% val_score=64.7264 val_score_bestthr=68.2710 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.260, mb=0.496, no=1.003, corr=0.403) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.1698 -> 68.2710
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2340 mb_mean=0.4933 norm_overlap=1.0031 corr_cb=0.4404 topkJ=0.2093
[TRAIN][ep=007] loss=1.2554 acc=60.54%
[TRAIN][ep=007] mask_avg: mc_mean=0.2516 mb_mean=0.4961 norm_overlap=1.0019 corr_cb=0.2630
[EPOCH 007/089] train: loss=1.2554 acc=60.54% | val: loss=0.6794 acc=67.47% f1=66.67% auc=69.01% val_score=39.8133 val_score_bestthr=64.6032 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.252, mb=0.496, no=1.002, corr=0.263) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.1698 -> 64.6032
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1927 mb_mean=0.4919 norm_overlap=1.0011 corr_cb=0.1827 topkJ=0.1383
[TRAIN][ep=008] loss=1.0127 acc=61.34%
[TRAIN][ep=008] mask_avg: mc_mean=0.2405 mb_mean=0.4961 norm_overlap=1.0012 corr_cb=0.1473
[EPOCH 008/089] train: loss=1.0127 acc=61.34% | val: loss=0.6738 acc=67.47% f1=67.47% auc=69.53% val_score=62.7288 val_score_bestthr=66.3796 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.241, mb=0.496, no=1.001, corr=0.147) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.1698 -> 66.3796
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2545 mb_mean=0.4948 norm_overlap=1.0029 corr_cb=0.2992 topkJ=0.0563
[TRAIN][ep=009] loss=0.7689 acc=62.55%
[TRAIN][ep=009] mask_avg: mc_mean=0.2315 mb_mean=0.4961 norm_overlap=1.0002 corr_cb=0.0181
[EPOCH 009/089] train: loss=0.7689 acc=62.55% | val: loss=0.6675 acc=66.27% f1=71.43% auc=70.29% val_score=65.7214 val_score_bestthr=72.7306 | dyn(w_pfs=0.190, w_sup=0.090, w_csuf=0.040, stage2=False) | mask(mc=0.232, mb=0.496, no=1.000, corr=0.018) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 70.1698 -> 72.7306
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.2309 mb_mean=0.4972 norm_overlap=0.9985 corr_cb=-0.1821 topkJ=0.0373
[TRAIN][ep=010] loss=0.8624 acc=62.95%
[TRAIN][ep=010] mask_avg: mc_mean=0.2251 mb_mean=0.4961 norm_overlap=0.9991 corr_cb=-0.0895
[EPOCH 010/089] train: loss=0.8624 acc=62.95% | val: loss=0.6648 acc=66.27% f1=72.00% auc=69.94% val_score=60.7744 val_score_bestthr=70.7874 | dyn(w_pfs=0.230, w_sup=0.130, w_csuf=0.080, stage2=False) | mask(mc=0.225, mb=0.496, no=0.999, corr=-0.089) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7306 -> 70.7874
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.2034 mb_mean=0.4971 norm_overlap=1.0005 corr_cb=0.0390 topkJ=0.0310
[TRAIN][ep=011] loss=0.9488 acc=65.37%
[TRAIN][ep=011] mask_avg: mc_mean=0.2099 mb_mean=0.4961 norm_overlap=0.9984 corr_cb=-0.1270
[EPOCH 011/089] train: loss=0.9488 acc=65.37% | val: loss=0.6774 acc=66.27% f1=65.85% auc=66.74% val_score=39.4002 val_score_bestthr=64.5354 | dyn(w_pfs=0.270, w_sup=0.170, w_csuf=0.120, stage2=False) | mask(mc=0.210, mb=0.496, no=0.998, corr=-0.127) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7306 -> 64.5354
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1925 mb_mean=0.4951 norm_overlap=0.9965 corr_cb=-0.2488 topkJ=0.0142
[TRAIN][ep=012] loss=1.0494 acc=60.54%
[TRAIN][ep=012] mask_avg: mc_mean=0.1876 mb_mean=0.4961 norm_overlap=0.9979 corr_cb=-0.1357
[EPOCH 012/089] train: loss=1.0494 acc=60.54% | val: loss=0.6618 acc=66.27% f1=65.00% auc=69.65% val_score=63.2481 val_score_bestthr=68.6547 | dyn(w_pfs=0.310, w_sup=0.210, w_csuf=0.160, stage2=False) | mask(mc=0.188, mb=0.496, no=0.998, corr=-0.136) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7306 -> 68.6547
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.2057 mb_mean=0.4969 norm_overlap=0.9954 corr_cb=-0.3192 topkJ=0.0226
[TRAIN][ep=013] loss=1.1370 acc=62.01%
[TRAIN][ep=013] mask_avg: mc_mean=0.1851 mb_mean=0.4961 norm_overlap=0.9970 corr_cb=-0.1818
[EPOCH 013/089] train: loss=1.1370 acc=62.01% | val: loss=0.6632 acc=66.27% f1=64.10% auc=69.30% val_score=56.2002 val_score_bestthr=67.3925 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.185, mb=0.496, no=0.997, corr=-0.182) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7306 -> 67.3925
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.2051 mb_mean=0.4985 norm_overlap=0.9955 corr_cb=-0.2807 topkJ=0.0219
[TRAIN][ep=014] loss=1.2201 acc=64.70%
[TRAIN][ep=014] mask_avg: mc_mean=0.1820 mb_mean=0.4961 norm_overlap=0.9963 corr_cb=-0.2032
[EPOCH 014/089] train: loss=1.2201 acc=64.70% | val: loss=0.6515 acc=69.88% f1=76.64% auc=70.87% val_score=75.0615 val_score_bestthr=75.0615 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.182, mb=0.496, no=0.996, corr=-0.203) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 72.7306 -> 75.0615
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.2078 mb_mean=0.4977 norm_overlap=0.9954 corr_cb=-0.2157 topkJ=0.0336
[TRAIN][ep=015] loss=1.2134 acc=64.70%
[TRAIN][ep=015] mask_avg: mc_mean=0.1579 mb_mean=0.4961 norm_overlap=0.9965 corr_cb=-0.1572
[EPOCH 015/089] train: loss=1.2134 acc=64.70% | val: loss=0.6461 acc=63.86% f1=69.39% auc=70.52% val_score=63.5809 val_score_bestthr=68.2118 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.158, mb=0.496, no=0.996, corr=-0.157) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.0615 -> 68.2118
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1625 mb_mean=0.4984 norm_overlap=0.9907 corr_cb=-0.3765 topkJ=0.0133
[TRAIN][ep=016] loss=1.2059 acc=67.92%
[TRAIN][ep=016] mask_avg: mc_mean=0.1595 mb_mean=0.4961 norm_overlap=0.9961 corr_cb=-0.1634
[EPOCH 016/089] train: loss=1.2059 acc=67.92% | val: loss=0.6595 acc=67.47% f1=74.77% auc=69.59% val_score=61.6970 val_score_bestthr=71.9826 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.159, mb=0.496, no=0.996, corr=-0.163) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.0615 -> 71.9826
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1392 mb_mean=0.4972 norm_overlap=0.9976 corr_cb=-0.1067 topkJ=0.0474
[TRAIN][ep=017] loss=1.2056 acc=64.16%
[TRAIN][ep=017] mask_avg: mc_mean=0.1604 mb_mean=0.4961 norm_overlap=0.9959 corr_cb=-0.1606
[EPOCH 017/089] train: loss=1.2056 acc=64.16% | val: loss=0.6401 acc=66.27% f1=70.21% auc=71.05% val_score=65.3386 val_score_bestthr=67.1575 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.160, mb=0.496, no=0.996, corr=-0.161) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.0615 -> 67.1575
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1713 mb_mean=0.4952 norm_overlap=0.9953 corr_cb=-0.1744 topkJ=0.0271
[TRAIN][ep=018] loss=1.1966 acc=66.71%
[TRAIN][ep=018] mask_avg: mc_mean=0.1716 mb_mean=0.4961 norm_overlap=0.9955 corr_cb=-0.1769
[EPOCH 018/089] train: loss=1.1966 acc=66.71% | val: loss=0.6418 acc=68.67% f1=65.79% auc=71.10% val_score=64.9076 val_score_bestthr=70.1727 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.172, mb=0.496, no=0.996, corr=-0.177) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.0615 -> 70.1727
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1685 mb_mean=0.4952 norm_overlap=0.9951 corr_cb=-0.1557 topkJ=0.0198
[TRAIN][ep=019] loss=1.1910 acc=68.32%
[TRAIN][ep=019] mask_avg: mc_mean=0.1586 mb_mean=0.4961 norm_overlap=0.9959 corr_cb=-0.1494
[EPOCH 019/089] train: loss=1.1910 acc=68.32% | val: loss=0.6372 acc=68.67% f1=75.47% auc=71.74% val_score=70.4050 val_score_bestthr=72.0299 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.159, mb=0.496, no=0.996, corr=-0.149) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.0615 -> 72.0299
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1666 mb_mean=0.4987 norm_overlap=0.9954 corr_cb=-0.1874 topkJ=0.0393
[TRAIN][ep=020] loss=0.9542 acc=66.44%
[TRAIN][ep=020] mask_avg: mc_mean=0.1793 mb_mean=0.4961 norm_overlap=0.9955 corr_cb=-0.1721
[EPOCH 020/089] train: loss=0.9542 acc=66.44% | val: loss=0.6670 acc=69.88% f1=67.53% auc=69.77% val_score=35.9443 val_score_bestthr=71.3415 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.179, mb=0.496, no=0.996, corr=-0.172) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.0615 -> 71.3415
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.1923 mb_mean=0.5007 norm_overlap=0.9940 corr_cb=-0.2542 topkJ=0.0128
[TRAIN][ep=021] loss=0.7080 acc=66.31%
[TRAIN][ep=021] mask_avg: mc_mean=0.1880 mb_mean=0.4961 norm_overlap=0.9953 corr_cb=-0.1821
[EPOCH 021/089] train: loss=0.7080 acc=66.31% | val: loss=0.6267 acc=67.47% f1=65.82% auc=72.67% val_score=66.2655 val_score_bestthr=66.7053 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.188, mb=0.496, no=0.995, corr=-0.182) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.0615 -> 66.7053
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1550 mb_mean=0.4922 norm_overlap=1.0011 corr_cb=0.0355 topkJ=0.0723
[TRAIN][ep=022] loss=0.6469 acc=68.19%
[TRAIN][ep=022] mask_avg: mc_mean=0.1849 mb_mean=0.4961 norm_overlap=0.9956 corr_cb=-0.1669
[EPOCH 022/089] train: loss=0.6469 acc=68.19% | val: loss=0.6293 acc=68.67% f1=66.67% auc=73.02% val_score=63.9601 val_score_bestthr=68.7177 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.185, mb=0.496, no=0.996, corr=-0.167) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.0615 -> 68.7177
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2004 mb_mean=0.4973 norm_overlap=0.9941 corr_cb=-0.2359 topkJ=0.0214
[TRAIN][ep=023] loss=0.6311 acc=68.32%
[TRAIN][ep=023] mask_avg: mc_mean=0.1847 mb_mean=0.4961 norm_overlap=0.9955 corr_cb=-0.1659
[EPOCH 023/089] train: loss=0.6311 acc=68.32% | val: loss=0.6405 acc=71.08% f1=69.23% auc=71.57% val_score=55.5379 val_score_bestthr=73.5563 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.185, mb=0.496, no=0.996, corr=-0.166) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.0615 -> 73.5563
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1801 mb_mean=0.4928 norm_overlap=0.9965 corr_cb=-0.1084 topkJ=0.0690
[TRAIN][ep=024] loss=0.6283 acc=68.05%
[TRAIN][ep=024] mask_avg: mc_mean=0.1813 mb_mean=0.4961 norm_overlap=0.9959 corr_cb=-0.1458
[EPOCH 024/089] train: loss=0.6283 acc=68.05% | val: loss=0.6247 acc=71.08% f1=70.00% auc=72.62% val_score=70.4731 val_score_bestthr=71.8579 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.181, mb=0.496, no=0.996, corr=-0.146) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.0615 -> 71.8579
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1675 mb_mean=0.4964 norm_overlap=0.9951 corr_cb=-0.1421 topkJ=0.0319
[TRAIN][ep=025] loss=0.6204 acc=68.19%
[TRAIN][ep=025] mask_avg: mc_mean=0.1858 mb_mean=0.4961 norm_overlap=0.9958 corr_cb=-0.1476
[EPOCH 025/089] train: loss=0.6204 acc=68.19% | val: loss=0.6191 acc=71.08% f1=69.23% auc=73.08% val_score=73.6960 val_score_bestthr=71.9009 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.186, mb=0.496, no=0.996, corr=-0.148) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.0615 -> 71.9009
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1828 mb_mean=0.4934 norm_overlap=1.0004 corr_cb=0.0115 topkJ=0.0315
[TRAIN][ep=026] loss=0.6121 acc=68.86%
[TRAIN][ep=026] mask_avg: mc_mean=0.1986 mb_mean=0.4961 norm_overlap=0.9959 corr_cb=-0.1490
[EPOCH 026/089] train: loss=0.6121 acc=68.86% | val: loss=0.6119 acc=69.88% f1=69.14% auc=73.90% val_score=63.3692 val_score_bestthr=69.0433 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.199, mb=0.496, no=0.996, corr=-0.149) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.0615 -> 69.0433
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2093 mb_mean=0.4995 norm_overlap=0.9970 corr_cb=-0.1168 topkJ=0.0297
[TRAIN][ep=027] loss=0.6115 acc=68.46%
[TRAIN][ep=027] mask_avg: mc_mean=0.2020 mb_mean=0.4961 norm_overlap=0.9962 corr_cb=-0.1388
[EPOCH 027/089] train: loss=0.6115 acc=68.46% | val: loss=0.6214 acc=73.49% f1=73.17% auc=73.55% val_score=69.9629 val_score_bestthr=78.7684 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.202, mb=0.496, no=0.996, corr=-0.139) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 75.0615 -> 78.7684
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1616 mb_mean=0.4920 norm_overlap=1.0010 corr_cb=0.0309 topkJ=0.0630
[TRAIN][ep=028] loss=0.7021 acc=69.80%
[TRAIN][ep=028] mask_avg: mc_mean=0.1992 mb_mean=0.4961 norm_overlap=0.9963 corr_cb=-0.1310
[EPOCH 028/089] train: loss=0.7021 acc=69.80% | val: loss=0.6155 acc=67.47% f1=68.97% auc=73.78% val_score=62.5814 val_score_bestthr=69.7727 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.199, mb=0.496, no=0.996, corr=-0.131) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 78.7684 -> 69.7727
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.1909 mb_mean=0.4915 norm_overlap=0.9999 corr_cb=-0.0020 topkJ=0.0637
[TRAIN][ep=029] loss=0.7865 acc=69.53%
[TRAIN][ep=029] mask_avg: mc_mean=0.2054 mb_mean=0.4961 norm_overlap=0.9963 corr_cb=-0.1355
[EPOCH 029/089] train: loss=0.7865 acc=69.53% | val: loss=0.6294 acc=73.49% f1=72.50% auc=73.78% val_score=57.4308 val_score_bestthr=78.2132 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.205, mb=0.496, no=0.996, corr=-0.135) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 78.7684 -> 78.2132
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2232 mb_mean=0.4964 norm_overlap=0.9973 corr_cb=-0.1025 topkJ=0.0412
[TRAIN][ep=030] loss=0.8716 acc=70.74%
[TRAIN][ep=030] mask_avg: mc_mean=0.2007 mb_mean=0.4961 norm_overlap=0.9965 corr_cb=-0.1218
[EPOCH 030/089] train: loss=0.8716 acc=70.74% | val: loss=0.6181 acc=66.27% f1=69.57% auc=72.67% val_score=64.7308 val_score_bestthr=69.2300 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.201, mb=0.496, no=0.996, corr=-0.122) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 78.7684 -> 69.2300
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.1874 mb_mean=0.4928 norm_overlap=0.9976 corr_cb=-0.0623 topkJ=0.0290
[TRAIN][ep=031] loss=0.9657 acc=70.20%
[TRAIN][ep=031] mask_avg: mc_mean=0.1870 mb_mean=0.4961 norm_overlap=0.9968 corr_cb=-0.1073
[EPOCH 031/089] train: loss=0.9657 acc=70.20% | val: loss=0.6270 acc=73.49% f1=73.17% auc=74.07% val_score=57.7505 val_score_bestthr=77.0184 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.187, mb=0.496, no=0.997, corr=-0.107) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 78.7684 -> 77.0184
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2042 mb_mean=0.4973 norm_overlap=0.9993 corr_cb=-0.0252 topkJ=0.0585
[TRAIN][ep=032] loss=1.0687 acc=70.47%
[TRAIN][ep=032] mask_avg: mc_mean=0.2170 mb_mean=0.4961 norm_overlap=0.9964 corr_cb=-0.1331
[EPOCH 032/089] train: loss=1.0687 acc=70.47% | val: loss=0.6163 acc=71.08% f1=70.73% auc=74.24% val_score=66.1186 val_score_bestthr=73.0635 | dyn(w_pfs=0.100, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.217, mb=0.496, no=0.996, corr=-0.133) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 78.7684 -> 73.0635
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1633 mb_mean=0.4971 norm_overlap=0.9979 corr_cb=-0.0825 topkJ=0.0419
[TRAIN][ep=033] loss=0.8159 acc=70.87%
[TRAIN][ep=033] mask_avg: mc_mean=0.1997 mb_mean=0.4961 norm_overlap=0.9965 corr_cb=-0.1191
[EPOCH 033/089] train: loss=0.8159 acc=70.87% | val: loss=0.6105 acc=71.08% f1=73.91% auc=73.55% val_score=70.2228 val_score_bestthr=71.7570 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.200, mb=0.496, no=0.997, corr=-0.119) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 78.7684 -> 71.7570
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1656 mb_mean=0.4943 norm_overlap=0.9958 corr_cb=-0.1400 topkJ=0.0310
[TRAIN][ep=034] loss=0.5747 acc=72.75%
[TRAIN][ep=034] mask_avg: mc_mean=0.2080 mb_mean=0.4961 norm_overlap=0.9964 corr_cb=-0.1255
[EPOCH 034/089] train: loss=0.5747 acc=72.75% | val: loss=0.6128 acc=71.08% f1=72.73% auc=73.49% val_score=71.7570 val_score_bestthr=72.0715 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.208, mb=0.496, no=0.996, corr=-0.126) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 78.7684 -> 72.0715
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.1899 mb_mean=0.4949 norm_overlap=0.9972 corr_cb=-0.0906 topkJ=0.0401
[TRAIN][ep=035] loss=0.5674 acc=71.81%
[TRAIN][ep=035] mask_avg: mc_mean=0.2285 mb_mean=0.4961 norm_overlap=0.9966 corr_cb=-0.1254
[EPOCH 035/089] train: loss=0.5674 acc=71.81% | val: loss=0.6090 acc=72.29% f1=75.27% auc=73.26% val_score=68.5715 val_score_bestthr=73.2921 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.228, mb=0.496, no=0.997, corr=-0.125) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 78.7684 -> 73.2921
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2087 mb_mean=0.4988 norm_overlap=0.9967 corr_cb=-0.1233 topkJ=0.0274
[TRAIN][ep=036] loss=0.5732 acc=71.95%
[TRAIN][ep=036] mask_avg: mc_mean=0.2302 mb_mean=0.4961 norm_overlap=0.9965 corr_cb=-0.1296
[EPOCH 036/089] train: loss=0.5732 acc=71.95% | val: loss=0.6114 acc=73.49% f1=76.60% auc=73.60% val_score=61.8249 val_score_bestthr=75.6664 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.230, mb=0.496, no=0.996, corr=-0.130) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 78.7684 -> 75.6664
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.2233 mb_mean=0.4955 norm_overlap=0.9978 corr_cb=-0.0731 topkJ=0.0553
[TRAIN][ep=037] loss=0.5679 acc=72.89%
[TRAIN][ep=037] mask_avg: mc_mean=0.2165 mb_mean=0.4961 norm_overlap=0.9968 corr_cb=-0.1107
[EPOCH 037/089] train: loss=0.5679 acc=72.89% | val: loss=0.6076 acc=71.08% f1=74.47% auc=73.60% val_score=67.5266 val_score_bestthr=71.7582 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.216, mb=0.496, no=0.997, corr=-0.111) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 78.7684 -> 71.7582
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2432 mb_mean=0.4959 norm_overlap=0.9962 corr_cb=-0.1567 topkJ=0.0280
[TRAIN][ep=038] loss=0.5601 acc=73.15%
[TRAIN][ep=038] mask_avg: mc_mean=0.2419 mb_mean=0.4961 norm_overlap=0.9964 corr_cb=-0.1348
[EPOCH 038/089] train: loss=0.5601 acc=73.15% | val: loss=0.6076 acc=69.88% f1=73.12% auc=73.37% val_score=58.9221 val_score_bestthr=72.5043 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.242, mb=0.496, no=0.996, corr=-0.135) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 78.7684 -> 72.5043
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2655 mb_mean=0.4995 norm_overlap=0.9925 corr_cb=-0.2688 topkJ=0.0186
[TRAIN][ep=039] loss=0.5571 acc=73.42%
[TRAIN][ep=039] mask_avg: mc_mean=0.2197 mb_mean=0.4961 norm_overlap=0.9968 corr_cb=-0.1116
[EPOCH 039/089] train: loss=0.5571 acc=73.42% | val: loss=0.6081 acc=68.67% f1=72.34% auc=73.78% val_score=70.0854 val_score_bestthr=70.9738 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.220, mb=0.496, no=0.997, corr=-0.112) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 78.7684 -> 70.9738
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.2372 mb_mean=0.4932 norm_overlap=0.9962 corr_cb=-0.1483 topkJ=0.0260
[TRAIN][ep=040] loss=0.5511 acc=72.48%
[TRAIN][ep=040] mask_avg: mc_mean=0.2253 mb_mean=0.4961 norm_overlap=0.9968 corr_cb=-0.1152
[EPOCH 040/089] train: loss=0.5511 acc=72.48% | val: loss=0.6655 acc=73.49% f1=74.42% auc=74.01% val_score=49.4619 val_score_bestthr=74.1934 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.225, mb=0.496, no=0.997, corr=-0.115) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 78.7684 -> 74.1934
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.2105 mb_mean=0.4935 norm_overlap=0.9995 corr_cb=-0.0143 topkJ=0.0508
[TRAIN][ep=041] loss=0.5526 acc=73.15%
[TRAIN][ep=041] mask_avg: mc_mean=0.2211 mb_mean=0.4961 norm_overlap=0.9968 corr_cb=-0.1120
[EPOCH 041/089] train: loss=0.5526 acc=73.15% | val: loss=0.6066 acc=71.08% f1=73.91% auc=73.95% val_score=58.8567 val_score_bestthr=74.0373 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.221, mb=0.496, no=0.997, corr=-0.112) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 78.7684 -> 74.0373
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.2344 mb_mean=0.4948 norm_overlap=0.9992 corr_cb=-0.0262 topkJ=0.0292
[TRAIN][ep=042] loss=0.5437 acc=74.90%
[TRAIN][ep=042] mask_avg: mc_mean=0.2374 mb_mean=0.4961 norm_overlap=0.9965 corr_cb=-0.1243
[EPOCH 042/089] train: loss=0.5437 acc=74.90% | val: loss=0.6592 acc=73.49% f1=73.17% auc=74.07% val_score=48.0204 val_score_bestthr=76.2278 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.237, mb=0.496, no=0.997, corr=-0.124) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 78.7684 -> 76.2278
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.2216 mb_mean=0.4973 norm_overlap=0.9979 corr_cb=-0.0687 topkJ=0.0162
[TRAIN][ep=043] loss=0.5391 acc=73.56%
[TRAIN][ep=043] mask_avg: mc_mean=0.2293 mb_mean=0.4961 norm_overlap=0.9967 corr_cb=-0.1159
[EPOCH 043/089] train: loss=0.5391 acc=73.56% | val: loss=0.6191 acc=72.29% f1=75.27% auc=74.01% val_score=61.9644 val_score_bestthr=73.5042 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.229, mb=0.496, no=0.997, corr=-0.116) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 78.7684 -> 73.5042
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2270 mb_mean=0.4990 norm_overlap=0.9959 corr_cb=-0.1599 topkJ=0.0371
[TRAIN][ep=044] loss=0.5453 acc=74.77%
[TRAIN][ep=044] mask_avg: mc_mean=0.2313 mb_mean=0.4961 norm_overlap=0.9968 corr_cb=-0.1142
[EPOCH 044/089] train: loss=0.5453 acc=74.77% | val: loss=0.6125 acc=68.67% f1=72.34% auc=73.95% val_score=69.3198 val_score_bestthr=70.9738 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.231, mb=0.496, no=0.997, corr=-0.114) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 78.7684 -> 70.9738
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2389 mb_mean=0.4928 norm_overlap=0.9978 corr_cb=-0.0745 topkJ=0.0386
[TRAIN][ep=045] loss=0.5341 acc=75.97%
[TRAIN][ep=045] mask_avg: mc_mean=0.2404 mb_mean=0.4961 norm_overlap=0.9965 corr_cb=-0.1276
[EPOCH 045/089] train: loss=0.5341 acc=75.97% | val: loss=0.6520 acc=69.88% f1=73.12% auc=73.60% val_score=65.8314 val_score_bestthr=71.4203 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.240, mb=0.496, no=0.997, corr=-0.128) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 78.7684 -> 71.4203
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.2180 mb_mean=0.4987 norm_overlap=0.9962 corr_cb=-0.1361 topkJ=0.0444
[TRAIN][ep=046] loss=0.5416 acc=73.69%
[TRAIN][ep=046] mask_avg: mc_mean=0.2297 mb_mean=0.4961 norm_overlap=0.9967 corr_cb=-0.1133
[EPOCH 046/089] train: loss=0.5416 acc=73.69% | val: loss=0.6162 acc=69.88% f1=73.12% auc=73.95% val_score=71.0743 val_score_bestthr=72.5043 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.230, mb=0.496, no=0.997, corr=-0.113) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 78.7684 -> 72.5043
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.2312 mb_mean=0.4993 norm_overlap=0.9965 corr_cb=-0.1248 topkJ=0.0361
[TRAIN][ep=047] loss=0.5261 acc=74.90%
[TRAIN][ep=047] mask_avg: mc_mean=0.2053 mb_mean=0.4961 norm_overlap=0.9970 corr_cb=-0.0983
[EPOCH 047/089] train: loss=0.5261 acc=74.90% | val: loss=0.6184 acc=69.88% f1=73.12% auc=74.07% val_score=71.4203 val_score_bestthr=71.4203 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.205, mb=0.496, no=0.997, corr=-0.098) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 78.7684 -> 71.4203
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.2420 mb_mean=0.4911 norm_overlap=0.9949 corr_cb=-0.1742 topkJ=0.0231
[TRAIN][ep=048] loss=0.5260 acc=74.23%
[TRAIN][ep=048] mask_avg: mc_mean=0.2377 mb_mean=0.4961 norm_overlap=0.9964 corr_cb=-0.1267
[EPOCH 048/089] train: loss=0.5260 acc=74.23% | val: loss=0.6223 acc=68.67% f1=72.34% auc=73.66% val_score=70.9738 val_score_bestthr=70.9738 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.238, mb=0.496, no=0.996, corr=-0.127) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 78.7684 -> 70.9738
[DBG][ep=049] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.2546 mb_mean=0.4972 norm_overlap=0.9964 corr_cb=-0.1185 topkJ=0.0195
[TRAIN][ep=049] loss=0.5099 acc=77.32%
[TRAIN][ep=049] mask_avg: mc_mean=0.2445 mb_mean=0.4961 norm_overlap=0.9963 corr_cb=-0.1339
[EPOCH 049/089] train: loss=0.5099 acc=77.32% | val: loss=0.6483 acc=68.67% f1=71.74% auc=73.55% val_score=56.2328 val_score_bestthr=70.8641 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.245, mb=0.496, no=0.996, corr=-0.134) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 78.7684 -> 70.8641
[DBG][ep=050] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.2345 mb_mean=0.4927 norm_overlap=0.9950 corr_cb=-0.1450 topkJ=0.0175
[TRAIN][ep=050] loss=0.5027 acc=78.39%
[TRAIN][ep=050] mask_avg: mc_mean=0.2377 mb_mean=0.4961 norm_overlap=0.9964 corr_cb=-0.1266
[EPOCH 050/089] train: loss=0.5027 acc=78.39% | val: loss=0.6197 acc=71.08% f1=71.43% auc=74.36% val_score=60.7228 val_score_bestthr=72.0550 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.238, mb=0.496, no=0.996, corr=-0.127) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 78.7684 -> 72.0550
[DBG][ep=051] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.2411 mb_mean=0.5002 norm_overlap=0.9960 corr_cb=-0.1691 topkJ=0.0521
[TRAIN][ep=051] loss=0.4915 acc=77.99%
[TRAIN][ep=051] mask_avg: mc_mean=0.2377 mb_mean=0.4961 norm_overlap=0.9964 corr_cb=-0.1287
[EPOCH 051/089] train: loss=0.4915 acc=77.99% | val: loss=0.6158 acc=68.67% f1=72.34% auc=73.90% val_score=66.4629 val_score_bestthr=70.9738 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.238, mb=0.496, no=0.996, corr=-0.129) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 78.7684 -> 70.9738
[DBG][ep=052] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.2450 mb_mean=0.4969 norm_overlap=0.9968 corr_cb=-0.1084 topkJ=0.0336
[TRAIN][ep=052] loss=0.4966 acc=77.18%
[TRAIN][ep=052] mask_avg: mc_mean=0.2377 mb_mean=0.4961 norm_overlap=0.9964 corr_cb=-0.1275
[EPOCH 052/089] train: loss=0.4966 acc=77.18% | val: loss=0.6154 acc=68.67% f1=72.34% auc=73.95% val_score=66.4629 val_score_bestthr=70.9738 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.238, mb=0.496, no=0.996, corr=-0.127) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 78.7684 -> 70.9738
[DBG][ep=053] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.2372 mb_mean=0.4951 norm_overlap=0.9971 corr_cb=-0.1012 topkJ=0.0350
[TRAIN][ep=053] loss=0.4948 acc=77.58%
[TRAIN][ep=053] mask_avg: mc_mean=0.2377 mb_mean=0.4961 norm_overlap=0.9964 corr_cb=-0.1265
[EPOCH 053/089] train: loss=0.4948 acc=77.58% | val: loss=0.6165 acc=68.67% f1=72.34% auc=74.07% val_score=66.3476 val_score_bestthr=70.9738 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.238, mb=0.496, no=0.996, corr=-0.127) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 78.7684 -> 70.9738
[DBG][ep=054] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=054] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=054] mask(step0): mc_mean=0.2447 mb_mean=0.4949 norm_overlap=0.9977 corr_cb=-0.0839 topkJ=0.0348
[TRAIN][ep=054] loss=0.4890 acc=78.26%
[TRAIN][ep=054] mask_avg: mc_mean=0.2377 mb_mean=0.4961 norm_overlap=0.9964 corr_cb=-0.1267
[EPOCH 054/089] train: loss=0.4890 acc=78.26% | val: loss=0.6163 acc=68.67% f1=72.34% auc=74.13% val_score=66.4629 val_score_bestthr=70.9738 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.238, mb=0.496, no=0.996, corr=-0.127) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 78.7684 -> 70.9738
[DBG][ep=055] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=055] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=055] mask(step0): mc_mean=0.2355 mb_mean=0.4943 norm_overlap=0.9972 corr_cb=-0.0852 topkJ=0.0330
[TRAIN][ep=055] loss=0.4898 acc=78.66%
[TRAIN][ep=055] mask_avg: mc_mean=0.2377 mb_mean=0.4961 norm_overlap=0.9965 corr_cb=-0.1261
[EPOCH 055/089] train: loss=0.4898 acc=78.66% | val: loss=0.6229 acc=67.47% f1=72.73% auc=74.13% val_score=58.5871 val_score_bestthr=70.4269 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.238, mb=0.496, no=0.996, corr=-0.126) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 78.7684 -> 70.4269
[DBG][ep=056] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=056] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=056] mask(step0): mc_mean=0.2242 mb_mean=0.4941 norm_overlap=0.9960 corr_cb=-0.1417 topkJ=0.0338
[TRAIN][ep=056] loss=0.4914 acc=77.72%
[TRAIN][ep=056] mask_avg: mc_mean=0.2377 mb_mean=0.4961 norm_overlap=0.9964 corr_cb=-0.1262
[EPOCH 056/089] train: loss=0.4914 acc=77.72% | val: loss=0.6201 acc=67.47% f1=71.58% auc=74.13% val_score=67.9666 val_score_bestthr=71.6498 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.238, mb=0.496, no=0.996, corr=-0.126) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 78.7684 -> 71.6498
[DBG][ep=057] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=057] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=057] mask(step0): mc_mean=0.2613 mb_mean=0.4963 norm_overlap=0.9940 corr_cb=-0.2147 topkJ=0.0160
[TRAIN][ep=057] loss=0.4893 acc=78.12%
[TRAIN][ep=057] mask_avg: mc_mean=0.2377 mb_mean=0.4961 norm_overlap=0.9965 corr_cb=-0.1239
[EPOCH 057/089] train: loss=0.4893 acc=78.12% | val: loss=0.6213 acc=72.29% f1=72.94% auc=74.30% val_score=67.9666 val_score_bestthr=70.9166 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.238, mb=0.496, no=0.996, corr=-0.124) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 78.7684 -> 70.9166
[EARLY STOP] no improvement for 30 epochs. best_epoch=27
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
=============== FIT DONE ===============
[BEST] epoch=27 | val_acc=73.49% | val_f1=73.17% | val_auc=73.55% | val_score=69.9629 | val_score_bestthr=78.7684
[TEST@BEST] thr_used=0.320 | acc=57.00% f1=67.40% auc=61.34% | SP_sex=6.06% EO_sex=10.53% SP_age=12.28% EO_age=8.05%
[TIME] 1.37 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/summary_fold_2.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4477 mb_mean=0.4964 norm_overlap=1.0006 corr_cb=0.6199 topkJ=0.1849
[TRAIN][ep=000] loss=0.6950 acc=48.32%
[TRAIN][ep=000] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5111
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4378 mb_mean=0.4940 norm_overlap=1.0005 corr_cb=0.5338 topkJ=0.1816
[TRAIN][ep=001] loss=0.6928 acc=52.62%
[TRAIN][ep=001] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5175
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4517 mb_mean=0.4988 norm_overlap=1.0004 corr_cb=0.4909 topkJ=0.1226
[TRAIN][ep=002] loss=0.6930 acc=52.35%
[TRAIN][ep=002] mask_avg: mc_mean=0.4463 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5077
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4474 mb_mean=0.4963 norm_overlap=1.0004 corr_cb=0.4696 topkJ=0.1653
[TRAIN][ep=003] loss=0.6928 acc=51.01%
[TRAIN][ep=003] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5044
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4425 mb_mean=0.4921 norm_overlap=1.0010 corr_cb=0.7152 topkJ=0.2130
[TRAIN][ep=004] loss=0.6915 acc=51.68%
[TRAIN][ep=004] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5027
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4529 mb_mean=0.4986 norm_overlap=1.0003 corr_cb=0.4542 topkJ=0.1703
[TRAIN][ep=005] loss=0.6890 acc=56.78%
[TRAIN][ep=005] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5020
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4536 mb_mean=0.4984 norm_overlap=1.0003 corr_cb=0.3933 topkJ=0.1356
[TRAIN][ep=006] loss=0.6879 acc=59.87%
[TRAIN][ep=006] mask_avg: mc_mean=0.4463 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5030
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4543 mb_mean=0.4986 norm_overlap=1.0005 corr_cb=0.5123 topkJ=0.1231
[TRAIN][ep=007] loss=0.6863 acc=55.57%
[TRAIN][ep=007] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5158
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4444 mb_mean=0.4958 norm_overlap=1.0005 corr_cb=0.5646 topkJ=0.1270
[TRAIN][ep=008] loss=0.6843 acc=54.63%
[TRAIN][ep=008] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5070
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4465 mb_mean=0.4969 norm_overlap=1.0003 corr_cb=0.4721 topkJ=0.1699
[TRAIN][ep=009] loss=0.6824 acc=55.57%
[TRAIN][ep=009] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5069
================= FIT START (fold=2) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4558 mb_mean=0.5004 norm_overlap=1.0002 corr_cb=0.3859 topkJ=0.1398
[TRAIN][ep=000] loss=0.6801 acc=57.58%
[TRAIN][ep=000] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5085
[EPOCH 000/089] train: loss=0.6801 acc=57.58% | val: loss=0.6815 acc=66.27% f1=67.44% auc=67.67% val_score=47.0502 val_score_bestthr=64.4459 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.446, mb=0.496, no=1.000, corr=0.509) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 64.4459
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4538 mb_mean=0.4979 norm_overlap=1.0003 corr_cb=0.4016 topkJ=0.2040
[TRAIN][ep=001] loss=0.6767 acc=62.15%
[TRAIN][ep=001] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5121
[EPOCH 001/089] train: loss=0.6767 acc=62.15% | val: loss=0.6748 acc=65.06% f1=68.13% auc=69.71% val_score=60.6715 val_score_bestthr=64.0009 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.446, mb=0.496, no=1.001, corr=0.512) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.4459 -> 64.0009
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4475 mb_mean=0.4963 norm_overlap=1.0004 corr_cb=0.4390 topkJ=0.0795
[TRAIN][ep=002] loss=0.6743 acc=61.34%
[TRAIN][ep=002] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5046
[EPOCH 002/089] train: loss=0.6743 acc=61.34% | val: loss=0.6723 acc=66.27% f1=69.57% auc=68.66% val_score=59.1511 val_score_bestthr=65.5986 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.446, mb=0.496, no=1.000, corr=0.505) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 64.4459 -> 65.5986
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4442 mb_mean=0.4982 norm_overlap=1.0006 corr_cb=0.5457 topkJ=0.1279
[TRAIN][ep=003] loss=0.6738 acc=60.67%
[TRAIN][ep=003] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5061
[EPOCH 003/089] train: loss=0.6738 acc=60.67% | val: loss=0.6705 acc=66.27% f1=68.89% auc=69.01% val_score=56.1017 val_score_bestthr=64.8468 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.446, mb=0.496, no=1.000, corr=0.506) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 65.5986 -> 64.8468
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4474 mb_mean=0.4978 norm_overlap=1.0003 corr_cb=0.4220 topkJ=0.0832
[TRAIN][ep=004] loss=0.6674 acc=61.34%
[TRAIN][ep=004] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5086
[EPOCH 004/089] train: loss=0.6674 acc=61.34% | val: loss=0.6666 acc=68.67% f1=71.11% auc=69.13% val_score=58.2176 val_score_bestthr=67.9787 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.446, mb=0.496, no=1.001, corr=0.509) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 65.5986 -> 67.9787
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4503 mb_mean=0.4974 norm_overlap=1.0004 corr_cb=0.4973 topkJ=0.1639
[TRAIN][ep=005] loss=1.4432 acc=59.06%
[TRAIN][ep=005] mask_avg: mc_mean=0.3251 mb_mean=0.4961 norm_overlap=1.0022 corr_cb=0.5042
[EPOCH 005/089] train: loss=1.4432 acc=59.06% | val: loss=0.6847 acc=63.86% f1=64.29% auc=66.45% val_score=34.0792 val_score_bestthr=65.1254 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.325, mb=0.496, no=1.002, corr=0.504) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9787 -> 65.1254
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2623 mb_mean=0.4955 norm_overlap=1.0031 corr_cb=0.4564 topkJ=0.1342
[TRAIN][ep=006] loss=1.4293 acc=64.03%
[TRAIN][ep=006] mask_avg: mc_mean=0.2495 mb_mean=0.4961 norm_overlap=1.0028 corr_cb=0.3834
[EPOCH 006/089] train: loss=1.4293 acc=64.03% | val: loss=0.6619 acc=67.47% f1=72.16% auc=71.34% val_score=60.7744 val_score_bestthr=70.0894 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.249, mb=0.496, no=1.003, corr=0.383) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 67.9787 -> 70.0894
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2153 mb_mean=0.4933 norm_overlap=1.0034 corr_cb=0.4236 topkJ=0.2023
[TRAIN][ep=007] loss=1.4224 acc=61.88%
[TRAIN][ep=007] mask_avg: mc_mean=0.2356 mb_mean=0.4961 norm_overlap=1.0021 corr_cb=0.2488
[EPOCH 007/089] train: loss=1.4224 acc=61.88% | val: loss=0.6570 acc=68.67% f1=67.50% auc=70.76% val_score=62.6785 val_score_bestthr=65.9246 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.236, mb=0.496, no=1.002, corr=0.249) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.0894 -> 65.9246
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1644 mb_mean=0.4919 norm_overlap=1.0013 corr_cb=0.1698 topkJ=0.1271
[TRAIN][ep=008] loss=1.4146 acc=64.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.2166 mb_mean=0.4961 norm_overlap=1.0015 corr_cb=0.1491
[EPOCH 008/089] train: loss=1.4146 acc=64.70% | val: loss=0.6558 acc=68.67% f1=67.50% auc=70.76% val_score=70.2210 val_score_bestthr=70.2210 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.217, mb=0.496, no=1.001, corr=0.149) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 70.0894 -> 70.2210
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2279 mb_mean=0.4948 norm_overlap=1.0033 corr_cb=0.2854 topkJ=0.0599
[TRAIN][ep=009] loss=1.4074 acc=64.03%
[TRAIN][ep=009] mask_avg: mc_mean=0.1955 mb_mean=0.4961 norm_overlap=1.0006 corr_cb=0.0462
[EPOCH 009/089] train: loss=1.4074 acc=64.03% | val: loss=0.6482 acc=66.27% f1=69.57% auc=71.22% val_score=63.5809 val_score_bestthr=67.3035 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.196, mb=0.496, no=1.001, corr=0.046) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.2210 -> 67.3035
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1985 mb_mean=0.4972 norm_overlap=0.9986 corr_cb=-0.1381 topkJ=0.0445
[TRAIN][ep=010] loss=1.3984 acc=66.31%
[TRAIN][ep=010] mask_avg: mc_mean=0.1944 mb_mean=0.4961 norm_overlap=0.9996 corr_cb=-0.0423
[EPOCH 010/089] train: loss=1.3984 acc=66.31% | val: loss=0.6484 acc=66.27% f1=73.58% auc=70.17% val_score=65.8299 val_score_bestthr=69.7261 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.194, mb=0.496, no=1.000, corr=-0.042) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.2210 -> 69.7261
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1725 mb_mean=0.4971 norm_overlap=1.0012 corr_cb=0.0779 topkJ=0.0405
[TRAIN][ep=011] loss=1.3823 acc=67.79%
[TRAIN][ep=011] mask_avg: mc_mean=0.1718 mb_mean=0.4961 norm_overlap=0.9992 corr_cb=-0.0512
[EPOCH 011/089] train: loss=1.3823 acc=67.79% | val: loss=0.6905 acc=66.27% f1=63.16% auc=67.21% val_score=37.1849 val_score_bestthr=65.0677 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.172, mb=0.496, no=0.999, corr=-0.051) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.2210 -> 65.0677
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1475 mb_mean=0.4951 norm_overlap=0.9970 corr_cb=-0.1637 topkJ=0.0203
[TRAIN][ep=012] loss=1.3945 acc=64.43%
[TRAIN][ep=012] mask_avg: mc_mean=0.1366 mb_mean=0.4961 norm_overlap=0.9997 corr_cb=-0.0283
[EPOCH 012/089] train: loss=1.3945 acc=64.43% | val: loss=0.6425 acc=71.08% f1=71.43% auc=70.87% val_score=57.1789 val_score_bestthr=69.3978 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.137, mb=0.496, no=1.000, corr=-0.028) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.2210 -> 69.3978
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.0962 mb_mean=0.4969 norm_overlap=0.9988 corr_cb=-0.0505 topkJ=0.0414
[TRAIN][ep=013] loss=1.3763 acc=65.37%
[TRAIN][ep=013] mask_avg: mc_mean=0.1084 mb_mean=0.4961 norm_overlap=0.9995 corr_cb=-0.0282
[EPOCH 013/089] train: loss=1.3763 acc=65.37% | val: loss=0.6472 acc=69.88% f1=69.14% auc=70.76% val_score=55.5379 val_score_bestthr=70.2651 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.108, mb=0.496, no=1.000, corr=-0.028) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 70.2210 -> 70.2651
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1470 mb_mean=0.4985 norm_overlap=0.9965 corr_cb=-0.1628 topkJ=0.0314
[TRAIN][ep=014] loss=1.3635 acc=68.19%
[TRAIN][ep=014] mask_avg: mc_mean=0.1560 mb_mean=0.4961 norm_overlap=0.9972 corr_cb=-0.1355
[EPOCH 014/089] train: loss=1.3635 acc=68.19% | val: loss=0.6260 acc=66.27% f1=65.00% auc=71.63% val_score=63.5809 val_score_bestthr=68.1735 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.156, mb=0.496, no=0.997, corr=-0.136) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.2651 -> 68.1735
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1725 mb_mean=0.4977 norm_overlap=0.9987 corr_cb=-0.0500 topkJ=0.0699
[TRAIN][ep=015] loss=1.3563 acc=67.79%
[TRAIN][ep=015] mask_avg: mc_mean=0.1269 mb_mean=0.4961 norm_overlap=0.9980 corr_cb=-0.0799
[EPOCH 015/089] train: loss=1.3563 acc=67.79% | val: loss=0.6460 acc=68.67% f1=69.05% auc=71.51% val_score=52.9886 val_score_bestthr=73.6953 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.127, mb=0.496, no=0.998, corr=-0.080) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 70.2651 -> 73.6953
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1516 mb_mean=0.4984 norm_overlap=0.9912 corr_cb=-0.3361 topkJ=0.0157
[TRAIN][ep=016] loss=1.3419 acc=67.79%
[TRAIN][ep=016] mask_avg: mc_mean=0.1392 mb_mean=0.4961 norm_overlap=0.9973 corr_cb=-0.1029
[EPOCH 016/089] train: loss=1.3419 acc=67.79% | val: loss=0.6205 acc=71.08% f1=68.42% auc=72.67% val_score=68.2093 val_score_bestthr=68.4845 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.139, mb=0.496, no=0.997, corr=-0.103) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6953 -> 68.4845
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1265 mb_mean=0.4972 norm_overlap=0.9989 corr_cb=-0.0444 topkJ=0.0561
[TRAIN][ep=017] loss=1.3402 acc=69.93%
[TRAIN][ep=017] mask_avg: mc_mean=0.1395 mb_mean=0.4961 norm_overlap=0.9974 corr_cb=-0.0946
[EPOCH 017/089] train: loss=1.3402 acc=69.93% | val: loss=0.6565 acc=69.88% f1=69.14% auc=71.80% val_score=49.2347 val_score_bestthr=76.3132 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.140, mb=0.496, no=0.997, corr=-0.095) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 73.6953 -> 76.3132
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1287 mb_mean=0.4952 norm_overlap=0.9990 corr_cb=-0.0321 topkJ=0.0527
[TRAIN][ep=018] loss=1.3348 acc=70.07%
[TRAIN][ep=018] mask_avg: mc_mean=0.1451 mb_mean=0.4961 norm_overlap=0.9969 corr_cb=-0.1098
[EPOCH 018/089] train: loss=1.3348 acc=70.07% | val: loss=0.6395 acc=69.88% f1=72.53% auc=72.56% val_score=56.1393 val_score_bestthr=71.3777 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.145, mb=0.496, no=0.997, corr=-0.110) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.3132 -> 71.3777
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1531 mb_mean=0.4952 norm_overlap=0.9968 corr_cb=-0.0966 topkJ=0.0296
[TRAIN][ep=019] loss=1.3224 acc=69.53%
[TRAIN][ep=019] mask_avg: mc_mean=0.1412 mb_mean=0.4961 norm_overlap=0.9971 corr_cb=-0.0992
[EPOCH 019/089] train: loss=1.3224 acc=69.53% | val: loss=0.6358 acc=67.47% f1=72.73% auc=71.51% val_score=61.0198 val_score_bestthr=67.3073 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.141, mb=0.496, no=0.997, corr=-0.099) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.3132 -> 67.3073
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1555 mb_mean=0.4987 norm_overlap=0.9959 corr_cb=-0.1623 topkJ=0.0431
[TRAIN][ep=020] loss=1.3184 acc=70.87%
[TRAIN][ep=020] mask_avg: mc_mean=0.1619 mb_mean=0.4961 norm_overlap=0.9968 corr_cb=-0.1200
[EPOCH 020/089] train: loss=1.3184 acc=70.87% | val: loss=0.6195 acc=72.29% f1=74.73% auc=73.49% val_score=58.3191 val_score_bestthr=74.7164 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.162, mb=0.496, no=0.997, corr=-0.120) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.3132 -> 74.7164
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.1337 mb_mean=0.5007 norm_overlap=0.9950 corr_cb=-0.1703 topkJ=0.0222
[TRAIN][ep=021] loss=1.3029 acc=71.41%
[TRAIN][ep=021] mask_avg: mc_mean=0.1654 mb_mean=0.4961 norm_overlap=0.9967 corr_cb=-0.1250
[EPOCH 021/089] train: loss=1.3029 acc=71.41% | val: loss=0.6459 acc=68.67% f1=72.34% auc=72.38% val_score=63.4226 val_score_bestthr=69.8899 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.165, mb=0.496, no=0.997, corr=-0.125) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.3132 -> 69.8899
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1450 mb_mean=0.4922 norm_overlap=1.0023 corr_cb=0.0711 topkJ=0.0804
[TRAIN][ep=022] loss=1.2941 acc=74.23%
[TRAIN][ep=022] mask_avg: mc_mean=0.1515 mb_mean=0.4961 norm_overlap=0.9969 corr_cb=-0.1064
[EPOCH 022/089] train: loss=1.2941 acc=74.23% | val: loss=0.6207 acc=69.88% f1=74.23% auc=73.49% val_score=66.5474 val_score_bestthr=72.4831 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.151, mb=0.496, no=0.997, corr=-0.106) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.3132 -> 72.4831
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1554 mb_mean=0.4973 norm_overlap=0.9950 corr_cb=-0.1697 topkJ=0.0244
[TRAIN][ep=023] loss=1.0829 acc=71.41%
[TRAIN][ep=023] mask_avg: mc_mean=0.1450 mb_mean=0.4961 norm_overlap=0.9969 corr_cb=-0.1006
[EPOCH 023/089] train: loss=1.0829 acc=71.41% | val: loss=0.6524 acc=72.29% f1=75.79% auc=73.20% val_score=49.8710 val_score_bestthr=74.4611 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.145, mb=0.496, no=0.997, corr=-0.101) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.3132 -> 74.4611
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1654 mb_mean=0.4928 norm_overlap=0.9972 corr_cb=-0.0864 topkJ=0.0787
[TRAIN][ep=024] loss=0.8863 acc=72.08%
[TRAIN][ep=024] mask_avg: mc_mean=0.1594 mb_mean=0.4961 norm_overlap=0.9967 corr_cb=-0.1117
[EPOCH 024/089] train: loss=0.8863 acc=72.08% | val: loss=0.6078 acc=72.29% f1=74.73% auc=73.37% val_score=68.4252 val_score_bestthr=73.6325 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.159, mb=0.496, no=0.997, corr=-0.112) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.3132 -> 73.6325
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1406 mb_mean=0.4964 norm_overlap=0.9954 corr_cb=-0.1242 topkJ=0.0361
[TRAIN][ep=025] loss=0.8348 acc=73.02%
[TRAIN][ep=025] mask_avg: mc_mean=0.1334 mb_mean=0.4961 norm_overlap=0.9971 corr_cb=-0.0902
[EPOCH 025/089] train: loss=0.8348 acc=73.02% | val: loss=0.6078 acc=69.88% f1=73.12% auc=73.60% val_score=67.1176 val_score_bestthr=72.5043 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.133, mb=0.496, no=0.997, corr=-0.090) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.3132 -> 72.5043
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1558 mb_mean=0.4934 norm_overlap=1.0016 corr_cb=0.0428 topkJ=0.0381
[TRAIN][ep=026] loss=0.8030 acc=73.69%
[TRAIN][ep=026] mask_avg: mc_mean=0.1749 mb_mean=0.4961 norm_overlap=0.9962 corr_cb=-0.1322
[EPOCH 026/089] train: loss=0.8030 acc=73.69% | val: loss=0.6156 acc=72.29% f1=74.73% auc=73.72% val_score=66.5709 val_score_bestthr=73.6325 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.175, mb=0.496, no=0.996, corr=-0.132) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.3132 -> 73.6325
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1901 mb_mean=0.4995 norm_overlap=0.9968 corr_cb=-0.1236 topkJ=0.0284
[TRAIN][ep=027] loss=0.8043 acc=72.35%
[TRAIN][ep=027] mask_avg: mc_mean=0.1755 mb_mean=0.4961 norm_overlap=0.9965 corr_cb=-0.1194
[EPOCH 027/089] train: loss=0.8043 acc=72.35% | val: loss=0.6235 acc=73.49% f1=76.60% auc=73.66% val_score=57.2874 val_score_bestthr=75.6664 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.176, mb=0.496, no=0.997, corr=-0.119) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.3132 -> 75.6664
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1391 mb_mean=0.4920 norm_overlap=1.0018 corr_cb=0.0526 topkJ=0.0757
[TRAIN][ep=028] loss=0.7963 acc=73.83%
[TRAIN][ep=028] mask_avg: mc_mean=0.1715 mb_mean=0.4961 norm_overlap=0.9967 corr_cb=-0.1134
[EPOCH 028/089] train: loss=0.7963 acc=73.83% | val: loss=0.6166 acc=69.88% f1=73.12% auc=72.85% val_score=72.5043 val_score_bestthr=72.5043 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.171, mb=0.496, no=0.997, corr=-0.113) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.3132 -> 72.5043
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.1671 mb_mean=0.4915 norm_overlap=1.0004 corr_cb=0.0143 topkJ=0.0637
[TRAIN][ep=029] loss=0.7846 acc=74.77%
[TRAIN][ep=029] mask_avg: mc_mean=0.1791 mb_mean=0.4961 norm_overlap=0.9965 corr_cb=-0.1222
[EPOCH 029/089] train: loss=0.7846 acc=74.77% | val: loss=0.6128 acc=68.67% f1=72.34% auc=72.56% val_score=67.7346 val_score_bestthr=70.9738 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.179, mb=0.496, no=0.997, corr=-0.122) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.3132 -> 70.9738
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2027 mb_mean=0.4964 norm_overlap=0.9970 corr_cb=-0.1126 topkJ=0.0515
[TRAIN][ep=030] loss=0.7823 acc=74.90%
[TRAIN][ep=030] mask_avg: mc_mean=0.1829 mb_mean=0.4961 norm_overlap=0.9966 corr_cb=-0.1190
[EPOCH 030/089] train: loss=0.7823 acc=74.90% | val: loss=0.6125 acc=71.08% f1=73.91% auc=73.43% val_score=67.2833 val_score_bestthr=74.0373 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.183, mb=0.496, no=0.997, corr=-0.119) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.3132 -> 74.0373
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.1503 mb_mean=0.4928 norm_overlap=0.9999 corr_cb=-0.0022 topkJ=0.0453
[TRAIN][ep=031] loss=0.7766 acc=75.70%
[TRAIN][ep=031] mask_avg: mc_mean=0.1621 mb_mean=0.4961 norm_overlap=0.9970 corr_cb=-0.0960
[EPOCH 031/089] train: loss=0.7766 acc=75.70% | val: loss=0.6259 acc=71.08% f1=74.47% auc=73.49% val_score=59.2734 val_score_bestthr=71.9703 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.162, mb=0.496, no=0.997, corr=-0.096) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.3132 -> 71.9703
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1870 mb_mean=0.4973 norm_overlap=0.9999 corr_cb=-0.0039 topkJ=0.0629
[TRAIN][ep=032] loss=0.7748 acc=74.50%
[TRAIN][ep=032] mask_avg: mc_mean=0.1931 mb_mean=0.4961 norm_overlap=0.9966 corr_cb=-0.1208
[EPOCH 032/089] train: loss=0.7748 acc=74.50% | val: loss=0.7159 acc=68.67% f1=67.50% auc=72.79% val_score=41.5713 val_score_bestthr=67.9500 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.193, mb=0.496, no=0.997, corr=-0.121) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.3132 -> 67.9500
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1603 mb_mean=0.4971 norm_overlap=0.9986 corr_cb=-0.0577 topkJ=0.0485
[TRAIN][ep=033] loss=0.7722 acc=75.97%
[TRAIN][ep=033] mask_avg: mc_mean=0.1845 mb_mean=0.4961 norm_overlap=0.9965 corr_cb=-0.1190
[EPOCH 033/089] train: loss=0.7722 acc=75.97% | val: loss=0.6229 acc=67.47% f1=75.23% auc=73.14% val_score=62.3142 val_score_bestthr=72.3030 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.184, mb=0.496, no=0.997, corr=-0.119) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.3132 -> 72.3030
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1423 mb_mean=0.4943 norm_overlap=0.9963 corr_cb=-0.1195 topkJ=0.0373
[TRAIN][ep=034] loss=0.7559 acc=75.30%
[TRAIN][ep=034] mask_avg: mc_mean=0.1913 mb_mean=0.4961 norm_overlap=0.9966 corr_cb=-0.1222
[EPOCH 034/089] train: loss=0.7559 acc=75.30% | val: loss=0.6466 acc=69.88% f1=73.68% auc=72.33% val_score=71.5242 val_score_bestthr=74.0103 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.191, mb=0.496, no=0.997, corr=-0.122) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.3132 -> 74.0103
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.1730 mb_mean=0.4949 norm_overlap=0.9971 corr_cb=-0.0978 topkJ=0.0434
[TRAIN][ep=035] loss=0.7480 acc=76.78%
[TRAIN][ep=035] mask_avg: mc_mean=0.1905 mb_mean=0.4961 norm_overlap=0.9972 corr_cb=-0.0974
[EPOCH 035/089] train: loss=0.7480 acc=76.78% | val: loss=0.6321 acc=68.67% f1=73.47% auc=72.56% val_score=66.4268 val_score_bestthr=69.7481 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.496, no=0.997, corr=-0.097) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.3132 -> 69.7481
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.1774 mb_mean=0.4988 norm_overlap=0.9972 corr_cb=-0.0946 topkJ=0.0312
[TRAIN][ep=036] loss=0.7644 acc=74.90%
[TRAIN][ep=036] mask_avg: mc_mean=0.2138 mb_mean=0.4961 norm_overlap=0.9963 corr_cb=-0.1389
[EPOCH 036/089] train: loss=0.7644 acc=74.90% | val: loss=0.6206 acc=69.88% f1=74.23% auc=73.72% val_score=67.7346 val_score_bestthr=72.5107 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.214, mb=0.496, no=0.996, corr=-0.139) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.3132 -> 72.5107
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1911 mb_mean=0.4955 norm_overlap=0.9975 corr_cb=-0.0783 topkJ=0.0544
[TRAIN][ep=037] loss=0.7457 acc=77.72%
[TRAIN][ep=037] mask_avg: mc_mean=0.1921 mb_mean=0.4961 norm_overlap=0.9968 corr_cb=-0.1122
[EPOCH 037/089] train: loss=0.7457 acc=77.72% | val: loss=0.6276 acc=68.67% f1=75.47% auc=73.26% val_score=60.5405 val_score_bestthr=71.5782 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.192, mb=0.496, no=0.997, corr=-0.112) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.3132 -> 71.5782
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.1850 mb_mean=0.4959 norm_overlap=0.9966 corr_cb=-0.1252 topkJ=0.0336
[TRAIN][ep=038] loss=0.7309 acc=77.18%
[TRAIN][ep=038] mask_avg: mc_mean=0.2215 mb_mean=0.4961 norm_overlap=0.9960 corr_cb=-0.1488
[EPOCH 038/089] train: loss=0.7309 acc=77.18% | val: loss=0.6326 acc=69.88% f1=74.23% auc=73.55% val_score=65.3190 val_score_bestthr=72.5107 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.222, mb=0.496, no=0.996, corr=-0.149) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.3132 -> 72.5107
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2631 mb_mean=0.4995 norm_overlap=0.9911 corr_cb=-0.3298 topkJ=0.0163
[TRAIN][ep=039] loss=0.7418 acc=78.52%
[TRAIN][ep=039] mask_avg: mc_mean=0.1921 mb_mean=0.4961 norm_overlap=0.9967 corr_cb=-0.1116
[EPOCH 039/089] train: loss=0.7418 acc=78.52% | val: loss=0.6307 acc=67.47% f1=74.77% auc=72.97% val_score=66.3476 val_score_bestthr=70.0586 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.192, mb=0.496, no=0.997, corr=-0.112) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.3132 -> 70.0586
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.2138 mb_mean=0.4932 norm_overlap=0.9958 corr_cb=-0.1685 topkJ=0.0260
[TRAIN][ep=040] loss=0.7277 acc=77.45%
[TRAIN][ep=040] mask_avg: mc_mean=0.1978 mb_mean=0.4961 norm_overlap=0.9969 corr_cb=-0.1103
[EPOCH 040/089] train: loss=0.7277 acc=77.45% | val: loss=0.7022 acc=67.47% f1=74.77% auc=73.37% val_score=45.8252 val_score_bestthr=71.1426 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.198, mb=0.496, no=0.997, corr=-0.110) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.3132 -> 71.1426
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.1103 mb_mean=0.4935 norm_overlap=1.0042 corr_cb=0.0857 topkJ=0.0793
[TRAIN][ep=041] loss=0.7256 acc=77.18%
[TRAIN][ep=041] mask_avg: mc_mean=0.1753 mb_mean=0.4961 norm_overlap=0.9973 corr_cb=-0.0902
[EPOCH 041/089] train: loss=0.7256 acc=77.18% | val: loss=0.6357 acc=68.67% f1=74.00% auc=73.14% val_score=62.3917 val_score_bestthr=70.2598 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.175, mb=0.496, no=0.997, corr=-0.090) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.3132 -> 70.2598
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.1919 mb_mean=0.4948 norm_overlap=1.0005 corr_cb=0.0146 topkJ=0.0385
[TRAIN][ep=042] loss=0.7208 acc=78.52%
[TRAIN][ep=042] mask_avg: mc_mean=0.2060 mb_mean=0.4961 norm_overlap=0.9966 corr_cb=-0.1190
[EPOCH 042/089] train: loss=0.7208 acc=78.52% | val: loss=0.7016 acc=67.47% f1=72.73% auc=73.78% val_score=45.0962 val_score_bestthr=70.4269 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.206, mb=0.496, no=0.997, corr=-0.119) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.3132 -> 70.4269
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.1650 mb_mean=0.4973 norm_overlap=0.9990 corr_cb=-0.0271 topkJ=0.0266
[TRAIN][ep=043] loss=0.7078 acc=80.54%
[TRAIN][ep=043] mask_avg: mc_mean=0.1933 mb_mean=0.4961 norm_overlap=0.9967 corr_cb=-0.1115
[EPOCH 043/089] train: loss=0.7078 acc=80.54% | val: loss=0.7033 acc=68.67% f1=74.00% auc=73.31% val_score=58.3347 val_score_bestthr=69.3460 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.193, mb=0.496, no=0.997, corr=-0.111) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.3132 -> 69.3460
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2045 mb_mean=0.4990 norm_overlap=0.9961 corr_cb=-0.1542 topkJ=0.0426
[TRAIN][ep=044] loss=0.7248 acc=79.19%
[TRAIN][ep=044] mask_avg: mc_mean=0.1971 mb_mean=0.4961 norm_overlap=0.9968 corr_cb=-0.1093
[EPOCH 044/089] train: loss=0.7248 acc=79.19% | val: loss=0.6546 acc=68.67% f1=73.47% auc=72.79% val_score=68.6839 val_score_bestthr=73.1873 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.197, mb=0.496, no=0.997, corr=-0.109) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.3132 -> 73.1873
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2334 mb_mean=0.4928 norm_overlap=0.9963 corr_cb=-0.1305 topkJ=0.0382
[TRAIN][ep=045] loss=0.7185 acc=79.60%
[TRAIN][ep=045] mask_avg: mc_mean=0.2344 mb_mean=0.4961 norm_overlap=0.9958 corr_cb=-0.1595
[EPOCH 045/089] train: loss=0.7185 acc=79.60% | val: loss=0.7137 acc=69.88% f1=74.23% auc=72.56% val_score=67.2407 val_score_bestthr=72.5107 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.234, mb=0.496, no=0.996, corr=-0.160) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.3132 -> 72.5107
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.1726 mb_mean=0.4987 norm_overlap=0.9959 corr_cb=-0.1389 topkJ=0.0505
[TRAIN][ep=046] loss=0.7141 acc=78.12%
[TRAIN][ep=046] mask_avg: mc_mean=0.1882 mb_mean=0.4961 norm_overlap=0.9970 corr_cb=-0.0977
[EPOCH 046/089] train: loss=0.7141 acc=78.12% | val: loss=0.6669 acc=67.47% f1=72.73% auc=73.08% val_score=56.1761 val_score_bestthr=70.4269 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.188, mb=0.496, no=0.997, corr=-0.098) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.3132 -> 70.4269
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.2063 mb_mean=0.4993 norm_overlap=0.9974 corr_cb=-0.0925 topkJ=0.0480
[TRAIN][ep=047] loss=0.6964 acc=79.73%
[TRAIN][ep=047] mask_avg: mc_mean=0.1897 mb_mean=0.4961 norm_overlap=0.9968 corr_cb=-0.1049
[EPOCH 047/089] train: loss=0.6964 acc=79.73% | val: loss=0.6983 acc=67.47% f1=74.77% auc=72.27% val_score=69.1832 val_score_bestthr=70.0586 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.496, no=0.997, corr=-0.105) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.3132 -> 70.0586
[EARLY STOP] no improvement for 30 epochs. best_epoch=17
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
=============== FIT DONE ===============
[BEST] epoch=17 | val_acc=69.88% | val_f1=69.14% | val_auc=71.80% | val_score=49.2347 | val_score_bestthr=76.3132
[TEST@BEST] thr_used=0.195 | acc=55.56% f1=68.71% auc=60.92% | SP_sex=2.71% EO_sex=0.06% SP_age=10.83% EO_age=8.57%
[TIME] 1.17 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/summary_fold_2.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4477 mb_mean=0.4964 norm_overlap=1.0006 corr_cb=0.6199 topkJ=0.1849
[TRAIN][ep=000] loss=0.6950 acc=48.32%
[TRAIN][ep=000] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5111
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4378 mb_mean=0.4940 norm_overlap=1.0005 corr_cb=0.5338 topkJ=0.1816
[TRAIN][ep=001] loss=0.6928 acc=52.62%
[TRAIN][ep=001] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5175
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4517 mb_mean=0.4988 norm_overlap=1.0004 corr_cb=0.4909 topkJ=0.1226
[TRAIN][ep=002] loss=0.6930 acc=52.35%
[TRAIN][ep=002] mask_avg: mc_mean=0.4463 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5077
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4474 mb_mean=0.4963 norm_overlap=1.0004 corr_cb=0.4696 topkJ=0.1653
[TRAIN][ep=003] loss=0.6928 acc=51.01%
[TRAIN][ep=003] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5044
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4425 mb_mean=0.4921 norm_overlap=1.0010 corr_cb=0.7152 topkJ=0.2130
[TRAIN][ep=004] loss=0.6915 acc=51.68%
[TRAIN][ep=004] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5027
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4529 mb_mean=0.4986 norm_overlap=1.0003 corr_cb=0.4542 topkJ=0.1703
[TRAIN][ep=005] loss=0.6890 acc=56.78%
[TRAIN][ep=005] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5020
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4536 mb_mean=0.4984 norm_overlap=1.0003 corr_cb=0.3933 topkJ=0.1356
[TRAIN][ep=006] loss=0.6879 acc=59.87%
[TRAIN][ep=006] mask_avg: mc_mean=0.4463 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5030
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4543 mb_mean=0.4986 norm_overlap=1.0005 corr_cb=0.5123 topkJ=0.1231
[TRAIN][ep=007] loss=0.6863 acc=55.57%
[TRAIN][ep=007] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5158
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4444 mb_mean=0.4958 norm_overlap=1.0005 corr_cb=0.5646 topkJ=0.1270
[TRAIN][ep=008] loss=0.6843 acc=54.63%
[TRAIN][ep=008] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5070
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4465 mb_mean=0.4969 norm_overlap=1.0003 corr_cb=0.4721 topkJ=0.1699
[TRAIN][ep=009] loss=0.6824 acc=55.57%
[TRAIN][ep=009] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5069
================= FIT START (fold=2) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.45 select_by=val_score_bestthr | eval_thr_mode=fixed eval_thr_grid=coarse | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4558 mb_mean=0.5004 norm_overlap=1.0002 corr_cb=0.3859 topkJ=0.1398
[TRAIN][ep=000] loss=0.6801 acc=57.58%
[TRAIN][ep=000] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5085
[EPOCH 000/089] train: loss=0.6801 acc=57.58% | val: loss=0.6815 acc=55.42% f1=69.42% auc=67.67% val_score=59.5014 val_score_bestthr=59.5014 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.446, mb=0.496, no=1.000, corr=0.509) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 59.5014
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4538 mb_mean=0.4979 norm_overlap=1.0003 corr_cb=0.4016 topkJ=0.2040
[TRAIN][ep=001] loss=0.6767 acc=62.15%
[TRAIN][ep=001] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5121
[EPOCH 001/089] train: loss=0.6767 acc=62.15% | val: loss=0.6748 acc=51.81% f1=68.25% auc=69.65% val_score=62.0453 val_score_bestthr=62.0453 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.446, mb=0.496, no=1.001, corr=0.512) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 59.5014 -> 62.0453
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4475 mb_mean=0.4963 norm_overlap=1.0004 corr_cb=0.4390 topkJ=0.0795
[TRAIN][ep=002] loss=0.6743 acc=61.34%
[TRAIN][ep=002] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5046
[EPOCH 002/089] train: loss=0.6743 acc=61.34% | val: loss=0.6723 acc=53.01% f1=68.80% auc=68.72% val_score=61.3370 val_score_bestthr=61.3370 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.446, mb=0.496, no=1.000, corr=0.505) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 61.3370
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4442 mb_mean=0.4982 norm_overlap=1.0006 corr_cb=0.5457 topkJ=0.1279
[TRAIN][ep=003] loss=0.6738 acc=60.81%
[TRAIN][ep=003] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5061
[EPOCH 003/089] train: loss=0.6738 acc=60.81% | val: loss=0.6705 acc=53.01% f1=68.80% auc=69.07% val_score=61.3370 val_score_bestthr=61.3370 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.446, mb=0.496, no=1.000, corr=0.506) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 61.3370
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4474 mb_mean=0.4978 norm_overlap=1.0003 corr_cb=0.4220 topkJ=0.0832
[TRAIN][ep=004] loss=0.6674 acc=61.21%
[TRAIN][ep=004] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5086
[EPOCH 004/089] train: loss=0.6674 acc=61.21% | val: loss=0.6666 acc=54.22% f1=68.85% auc=69.13% val_score=58.0383 val_score_bestthr=58.0383 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.446, mb=0.496, no=1.001, corr=0.509) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 58.0383
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4503 mb_mean=0.4974 norm_overlap=1.0004 corr_cb=0.4973 topkJ=0.1639
[TRAIN][ep=005] loss=1.4432 acc=59.06%
[TRAIN][ep=005] mask_avg: mc_mean=0.3251 mb_mean=0.4961 norm_overlap=1.0022 corr_cb=0.5043
[EPOCH 005/089] train: loss=1.4432 acc=59.06% | val: loss=0.6846 acc=63.86% f1=60.53% auc=66.34% val_score=58.1181 val_score_bestthr=58.1181 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.325, mb=0.496, no=1.002, corr=0.504) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 58.1181
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2623 mb_mean=0.4955 norm_overlap=1.0031 corr_cb=0.4566 topkJ=0.1342
[TRAIN][ep=006] loss=1.4293 acc=64.03%
[TRAIN][ep=006] mask_avg: mc_mean=0.2496 mb_mean=0.4961 norm_overlap=1.0028 corr_cb=0.3837
[EPOCH 006/089] train: loss=1.4293 acc=64.03% | val: loss=0.6619 acc=54.22% f1=69.35% auc=71.45% val_score=61.7501 val_score_bestthr=61.7501 | dyn(w_pfs=0.240, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.250, mb=0.496, no=1.003, corr=0.384) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 61.7501
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2157 mb_mean=0.4933 norm_overlap=1.0034 corr_cb=0.4237 topkJ=0.2023
[TRAIN][ep=007] loss=1.2046 acc=61.61%
[TRAIN][ep=007] mask_avg: mc_mean=0.2365 mb_mean=0.4961 norm_overlap=1.0020 corr_cb=0.2467
[EPOCH 007/089] train: loss=1.2046 acc=61.61% | val: loss=0.6572 acc=60.24% f1=70.80% auc=70.58% val_score=57.0057 val_score_bestthr=57.0057 | dyn(w_pfs=0.140, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.237, mb=0.496, no=1.002, corr=0.247) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 57.0057
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1649 mb_mean=0.4919 norm_overlap=1.0013 corr_cb=0.1637 topkJ=0.1247
[TRAIN][ep=008] loss=0.9828 acc=65.10%
[TRAIN][ep=008] mask_avg: mc_mean=0.2185 mb_mean=0.4961 norm_overlap=1.0014 corr_cb=0.1356
[EPOCH 008/089] train: loss=0.9828 acc=65.10% | val: loss=0.6572 acc=56.63% f1=63.27% auc=69.53% val_score=56.3524 val_score_bestthr=56.3524 | dyn(w_pfs=0.040, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.219, mb=0.496, no=1.001, corr=0.136) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 56.3524
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2310 mb_mean=0.4948 norm_overlap=1.0031 corr_cb=0.2683 topkJ=0.0577
[TRAIN][ep=009] loss=0.9300 acc=64.03%
[TRAIN][ep=009] mask_avg: mc_mean=0.2005 mb_mean=0.4961 norm_overlap=1.0004 corr_cb=0.0265
[EPOCH 009/089] train: loss=0.9300 acc=64.03% | val: loss=0.6471 acc=59.04% f1=68.52% auc=69.94% val_score=53.4781 val_score_bestthr=53.4781 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.201, mb=0.496, no=1.000, corr=0.026) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 53.4781
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.2050 mb_mean=0.4972 norm_overlap=0.9983 corr_cb=-0.1584 topkJ=0.0398
[TRAIN][ep=010] loss=0.9129 acc=65.50%
[TRAIN][ep=010] mask_avg: mc_mean=0.1998 mb_mean=0.4961 norm_overlap=0.9992 corr_cb=-0.0688
[EPOCH 010/089] train: loss=0.9129 acc=65.50% | val: loss=0.6485 acc=55.42% f1=68.91% auc=70.12% val_score=58.3668 val_score_bestthr=58.3668 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.200, mb=0.496, no=0.999, corr=-0.069) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 58.3668
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1801 mb_mean=0.4971 norm_overlap=1.0007 corr_cb=0.0444 topkJ=0.0380
[TRAIN][ep=011] loss=0.8959 acc=66.98%
[TRAIN][ep=011] mask_avg: mc_mean=0.1804 mb_mean=0.4961 norm_overlap=0.9987 corr_cb=-0.0822
[EPOCH 011/089] train: loss=0.8959 acc=66.98% | val: loss=0.6934 acc=59.04% f1=48.48% auc=66.86% val_score=43.7028 val_score_bestthr=43.7028 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.180, mb=0.496, no=0.999, corr=-0.082) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 43.7028
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1577 mb_mean=0.4951 norm_overlap=0.9965 corr_cb=-0.1888 topkJ=0.0174
[TRAIN][ep=012] loss=0.9088 acc=63.49%
[TRAIN][ep=012] mask_avg: mc_mean=0.1426 mb_mean=0.4961 norm_overlap=0.9991 corr_cb=-0.0535
[EPOCH 012/089] train: loss=0.9088 acc=63.49% | val: loss=0.6447 acc=67.47% f1=69.66% auc=69.59% val_score=66.0988 val_score_bestthr=66.0988 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.143, mb=0.496, no=0.999, corr=-0.054) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 62.0453 -> 66.0988
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1041 mb_mean=0.4969 norm_overlap=0.9979 corr_cb=-0.0853 topkJ=0.0379
[TRAIN][ep=013] loss=0.9812 acc=64.97%
[TRAIN][ep=013] mask_avg: mc_mean=0.1122 mb_mean=0.4961 norm_overlap=0.9989 corr_cb=-0.0507
[EPOCH 013/089] train: loss=0.9812 acc=64.97% | val: loss=0.6501 acc=67.47% f1=66.67% auc=70.41% val_score=66.3279 val_score_bestthr=66.3279 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.112, mb=0.496, no=0.999, corr=-0.051) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 66.0988 -> 66.3279
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1525 mb_mean=0.4985 norm_overlap=0.9960 corr_cb=-0.1840 topkJ=0.0301
[TRAIN][ep=014] loss=1.0549 acc=68.32%
[TRAIN][ep=014] mask_avg: mc_mean=0.1609 mb_mean=0.4961 norm_overlap=0.9966 corr_cb=-0.1582
[EPOCH 014/089] train: loss=1.0549 acc=68.32% | val: loss=0.6256 acc=62.65% f1=69.31% auc=71.86% val_score=59.0152 val_score_bestthr=59.0152 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.161, mb=0.496, no=0.997, corr=-0.158) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.3279 -> 59.0152
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1771 mb_mean=0.4977 norm_overlap=0.9975 corr_cb=-0.0964 topkJ=0.0578
[TRAIN][ep=015] loss=1.1341 acc=67.65%
[TRAIN][ep=015] mask_avg: mc_mean=0.1253 mb_mean=0.4961 norm_overlap=0.9975 corr_cb=-0.0955
[EPOCH 015/089] train: loss=1.1341 acc=67.65% | val: loss=0.6431 acc=67.47% f1=64.94% auc=71.57% val_score=67.1908 val_score_bestthr=67.1908 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.125, mb=0.496, no=0.997, corr=-0.095) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 66.3279 -> 67.1908
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1446 mb_mean=0.4984 norm_overlap=0.9905 corr_cb=-0.3436 topkJ=0.0137
[TRAIN][ep=016] loss=1.2061 acc=68.05%
[TRAIN][ep=016] mask_avg: mc_mean=0.1342 mb_mean=0.4961 norm_overlap=0.9968 corr_cb=-0.1164
[EPOCH 016/089] train: loss=1.2061 acc=68.05% | val: loss=0.6207 acc=62.65% f1=68.04% auc=72.62% val_score=62.3728 val_score_bestthr=62.3728 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.134, mb=0.496, no=0.997, corr=-0.116) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.1908 -> 62.3728
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1230 mb_mean=0.4972 norm_overlap=0.9984 corr_cb=-0.0621 topkJ=0.0535
[TRAIN][ep=017] loss=1.2889 acc=69.66%
[TRAIN][ep=017] mask_avg: mc_mean=0.1373 mb_mean=0.4961 norm_overlap=0.9967 corr_cb=-0.1152
[EPOCH 017/089] train: loss=1.2889 acc=69.66% | val: loss=0.6542 acc=66.27% f1=61.11% auc=71.86% val_score=58.4388 val_score_bestthr=58.4388 | dyn(w_pfs=0.240, w_sup=0.240, w_csuf=0.200, stage2=False) | mask(mc=0.137, mb=0.496, no=0.997, corr=-0.115) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.1908 -> 58.4388
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1238 mb_mean=0.4952 norm_overlap=0.9979 corr_cb=-0.0640 topkJ=0.0443
[TRAIN][ep=018] loss=1.3065 acc=68.99%
[TRAIN][ep=018] mask_avg: mc_mean=0.1372 mb_mean=0.4961 norm_overlap=0.9964 corr_cb=-0.1235
[EPOCH 018/089] train: loss=1.3065 acc=68.99% | val: loss=0.6391 acc=66.27% f1=62.16% auc=72.79% val_score=60.4999 val_score_bestthr=60.4999 | dyn(w_pfs=0.280, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.137, mb=0.496, no=0.996, corr=-0.123) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.1908 -> 60.4999
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1503 mb_mean=0.4952 norm_overlap=0.9957 corr_cb=-0.1266 topkJ=0.0231
[TRAIN][ep=019] loss=1.3086 acc=69.53%
[TRAIN][ep=019] mask_avg: mc_mean=0.1362 mb_mean=0.4961 norm_overlap=0.9965 corr_cb=-0.1178
[EPOCH 019/089] train: loss=1.3086 acc=69.53% | val: loss=0.6355 acc=62.65% f1=72.57% auc=71.74% val_score=65.7214 val_score_bestthr=65.7214 | dyn(w_pfs=0.320, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.136, mb=0.496, no=0.996, corr=-0.118) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.1908 -> 65.7214
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1480 mb_mean=0.4987 norm_overlap=0.9954 corr_cb=-0.1770 topkJ=0.0431
[TRAIN][ep=020] loss=1.3159 acc=70.47%
[TRAIN][ep=020] mask_avg: mc_mean=0.1567 mb_mean=0.4961 norm_overlap=0.9961 corr_cb=-0.1403
[EPOCH 020/089] train: loss=1.3159 acc=70.47% | val: loss=0.6207 acc=69.88% f1=71.26% auc=73.60% val_score=67.8911 val_score_bestthr=67.8911 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.157, mb=0.496, no=0.996, corr=-0.140) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 67.1908 -> 67.8911
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.1288 mb_mean=0.5007 norm_overlap=0.9944 corr_cb=-0.1838 topkJ=0.0197
[TRAIN][ep=021] loss=1.3082 acc=71.14%
[TRAIN][ep=021] mask_avg: mc_mean=0.1586 mb_mean=0.4961 norm_overlap=0.9960 corr_cb=-0.1439
[EPOCH 021/089] train: loss=1.3082 acc=71.14% | val: loss=0.6448 acc=62.65% f1=72.57% auc=72.27% val_score=65.7214 val_score_bestthr=65.7214 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.159, mb=0.496, no=0.996, corr=-0.144) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.8911 -> 65.7214
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1363 mb_mean=0.4922 norm_overlap=1.0019 corr_cb=0.0553 topkJ=0.0723
[TRAIN][ep=022] loss=1.2996 acc=73.96%
[TRAIN][ep=022] mask_avg: mc_mean=0.1461 mb_mean=0.4961 norm_overlap=0.9962 corr_cb=-0.1265
[EPOCH 022/089] train: loss=1.2996 acc=73.96% | val: loss=0.6201 acc=71.08% f1=72.09% auc=73.66% val_score=69.4684 val_score_bestthr=69.4684 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.146, mb=0.496, no=0.996, corr=-0.126) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 67.8911 -> 69.4684
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1530 mb_mean=0.4973 norm_overlap=0.9941 corr_cb=-0.1974 topkJ=0.0202
[TRAIN][ep=023] loss=1.2969 acc=70.87%
[TRAIN][ep=023] mask_avg: mc_mean=0.1374 mb_mean=0.4961 norm_overlap=0.9963 corr_cb=-0.1160
[EPOCH 023/089] train: loss=1.2969 acc=70.87% | val: loss=0.6494 acc=65.06% f1=57.97% auc=73.55% val_score=57.8239 val_score_bestthr=57.8239 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.137, mb=0.496, no=0.996, corr=-0.116) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.4684 -> 57.8239
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1590 mb_mean=0.4928 norm_overlap=0.9969 corr_cb=-0.0908 topkJ=0.0834
[TRAIN][ep=024] loss=1.3105 acc=71.14%
[TRAIN][ep=024] mask_avg: mc_mean=0.1452 mb_mean=0.4961 norm_overlap=0.9962 corr_cb=-0.1198
[EPOCH 024/089] train: loss=1.3105 acc=71.14% | val: loss=0.6073 acc=68.67% f1=72.92% auc=73.55% val_score=70.5725 val_score_bestthr=70.5725 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.145, mb=0.496, no=0.996, corr=-0.120) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 69.4684 -> 70.5725
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1215 mb_mean=0.4964 norm_overlap=0.9947 corr_cb=-0.1296 topkJ=0.0369
[TRAIN][ep=025] loss=1.3011 acc=72.48%
[TRAIN][ep=025] mask_avg: mc_mean=0.1150 mb_mean=0.4961 norm_overlap=0.9968 corr_cb=-0.0916
[EPOCH 025/089] train: loss=1.3011 acc=72.48% | val: loss=0.6062 acc=69.88% f1=73.12% auc=73.84% val_score=71.6478 val_score_bestthr=71.6478 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.115, mb=0.496, no=0.997, corr=-0.092) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 70.5725 -> 71.6478
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1462 mb_mean=0.4934 norm_overlap=1.0016 corr_cb=0.0412 topkJ=0.0340
[TRAIN][ep=026] loss=1.2774 acc=73.15%
[TRAIN][ep=026] mask_avg: mc_mean=0.1665 mb_mean=0.4961 norm_overlap=0.9955 corr_cb=-0.1505
[EPOCH 026/089] train: loss=1.2774 acc=73.15% | val: loss=0.6156 acc=63.86% f1=71.15% auc=73.49% val_score=64.1822 val_score_bestthr=64.1822 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.166, mb=0.496, no=0.996, corr=-0.151) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.6478 -> 64.1822
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1803 mb_mean=0.4995 norm_overlap=0.9961 corr_cb=-0.1448 topkJ=0.0246
[TRAIN][ep=027] loss=1.2786 acc=72.35%
[TRAIN][ep=027] mask_avg: mc_mean=0.1598 mb_mean=0.4961 norm_overlap=0.9961 corr_cb=-0.1268
[EPOCH 027/089] train: loss=1.2786 acc=72.35% | val: loss=0.6261 acc=68.67% f1=66.67% auc=73.78% val_score=65.6950 val_score_bestthr=65.6950 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.160, mb=0.496, no=0.996, corr=-0.127) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.6478 -> 65.6950
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1277 mb_mean=0.4920 norm_overlap=1.0019 corr_cb=0.0534 topkJ=0.0796
[TRAIN][ep=028] loss=1.2662 acc=72.89%
[TRAIN][ep=028] mask_avg: mc_mean=0.1607 mb_mean=0.4961 norm_overlap=0.9962 corr_cb=-0.1242
[EPOCH 028/089] train: loss=1.2662 acc=72.89% | val: loss=0.6181 acc=65.06% f1=72.38% auc=72.97% val_score=65.8833 val_score_bestthr=65.8833 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.161, mb=0.496, no=0.996, corr=-0.124) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.6478 -> 65.8833
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.1556 mb_mean=0.4915 norm_overlap=1.0003 corr_cb=0.0104 topkJ=0.0620
[TRAIN][ep=029] loss=1.2534 acc=74.77%
[TRAIN][ep=029] mask_avg: mc_mean=0.1631 mb_mean=0.4961 norm_overlap=0.9961 corr_cb=-0.1272
[EPOCH 029/089] train: loss=1.2534 acc=74.77% | val: loss=0.6116 acc=69.88% f1=72.53% auc=73.08% val_score=66.3117 val_score_bestthr=66.3117 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.163, mb=0.496, no=0.996, corr=-0.127) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.6478 -> 66.3117
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.1968 mb_mean=0.4964 norm_overlap=0.9965 corr_cb=-0.1289 topkJ=0.0498
[TRAIN][ep=030] loss=1.2511 acc=74.63%
[TRAIN][ep=030] mask_avg: mc_mean=0.1760 mb_mean=0.4961 norm_overlap=0.9960 corr_cb=-0.1328
[EPOCH 030/089] train: loss=1.2511 acc=74.63% | val: loss=0.6115 acc=69.88% f1=73.12% auc=73.49% val_score=72.5043 val_score_bestthr=72.5043 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.176, mb=0.496, no=0.996, corr=-0.133) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 71.6478 -> 72.5043
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.1346 mb_mean=0.4928 norm_overlap=1.0004 corr_cb=0.0087 topkJ=0.0461
[TRAIN][ep=031] loss=1.2436 acc=75.57%
[TRAIN][ep=031] mask_avg: mc_mean=0.1485 mb_mean=0.4961 norm_overlap=0.9968 corr_cb=-0.0987
[EPOCH 031/089] train: loss=1.2436 acc=75.57% | val: loss=0.6259 acc=67.47% f1=67.47% auc=73.37% val_score=64.6794 val_score_bestthr=64.6794 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.148, mb=0.496, no=0.997, corr=-0.099) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.5043 -> 64.6794
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1787 mb_mean=0.4973 norm_overlap=0.9996 corr_cb=-0.0125 topkJ=0.0638
[TRAIN][ep=032] loss=1.2371 acc=74.63%
[TRAIN][ep=032] mask_avg: mc_mean=0.1850 mb_mean=0.4961 norm_overlap=0.9962 corr_cb=-0.1298
[EPOCH 032/089] train: loss=1.2371 acc=74.63% | val: loss=0.7304 acc=60.24% f1=49.23% auc=72.73% val_score=42.4217 val_score_bestthr=42.4217 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.185, mb=0.496, no=0.996, corr=-0.130) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.5043 -> 42.4217
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1452 mb_mean=0.4971 norm_overlap=0.9985 corr_cb=-0.0573 topkJ=0.0493
[TRAIN][ep=033] loss=1.2363 acc=75.30%
[TRAIN][ep=033] mask_avg: mc_mean=0.1674 mb_mean=0.4961 norm_overlap=0.9965 corr_cb=-0.1139
[EPOCH 033/089] train: loss=1.2363 acc=75.30% | val: loss=0.6246 acc=67.47% f1=68.24% auc=73.43% val_score=61.6244 val_score_bestthr=61.6244 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.167, mb=0.496, no=0.996, corr=-0.114) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.5043 -> 61.6244
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1378 mb_mean=0.4943 norm_overlap=0.9960 corr_cb=-0.1248 topkJ=0.0360
[TRAIN][ep=034] loss=1.2188 acc=75.30%
[TRAIN][ep=034] mask_avg: mc_mean=0.1849 mb_mean=0.4961 norm_overlap=0.9962 corr_cb=-0.1300
[EPOCH 034/089] train: loss=1.2188 acc=75.30% | val: loss=0.6454 acc=62.65% f1=69.90% auc=72.15% val_score=65.0564 val_score_bestthr=65.0564 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.185, mb=0.496, no=0.996, corr=-0.130) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.5043 -> 65.0564
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.1616 mb_mean=0.4949 norm_overlap=0.9966 corr_cb=-0.1098 topkJ=0.0410
[TRAIN][ep=035] loss=1.2086 acc=77.32%
[TRAIN][ep=035] mask_avg: mc_mean=0.1774 mb_mean=0.4961 norm_overlap=0.9971 corr_cb=-0.0970
[EPOCH 035/089] train: loss=1.2086 acc=77.32% | val: loss=0.6325 acc=67.47% f1=72.16% auc=72.56% val_score=66.7535 val_score_bestthr=66.7535 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.177, mb=0.496, no=0.997, corr=-0.097) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.5043 -> 66.7535
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.1677 mb_mean=0.4988 norm_overlap=0.9969 corr_cb=-0.1012 topkJ=0.0295
[TRAIN][ep=036] loss=1.0209 acc=75.70%
[TRAIN][ep=036] mask_avg: mc_mean=0.1944 mb_mean=0.4961 norm_overlap=0.9962 corr_cb=-0.1301
[EPOCH 036/089] train: loss=1.0209 acc=75.70% | val: loss=0.6198 acc=67.47% f1=70.33% auc=73.84% val_score=65.1355 val_score_bestthr=65.1355 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.194, mb=0.496, no=0.996, corr=-0.130) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.5043 -> 65.1355
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1879 mb_mean=0.4955 norm_overlap=0.9972 corr_cb=-0.0840 topkJ=0.0561
[TRAIN][ep=037] loss=0.7948 acc=77.72%
[TRAIN][ep=037] mask_avg: mc_mean=0.1856 mb_mean=0.4961 norm_overlap=0.9965 corr_cb=-0.1168
[EPOCH 037/089] train: loss=0.7948 acc=77.72% | val: loss=0.6285 acc=67.47% f1=69.66% auc=73.20% val_score=67.1344 val_score_bestthr=67.1344 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.186, mb=0.496, no=0.997, corr=-0.117) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.5043 -> 67.1344
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.1803 mb_mean=0.4959 norm_overlap=0.9962 corr_cb=-0.1371 topkJ=0.0323
[TRAIN][ep=038] loss=0.7412 acc=77.05%
[TRAIN][ep=038] mask_avg: mc_mean=0.2100 mb_mean=0.4961 norm_overlap=0.9959 corr_cb=-0.1438
[EPOCH 038/089] train: loss=0.7412 acc=77.05% | val: loss=0.6316 acc=68.67% f1=72.34% auc=73.43% val_score=70.6805 val_score_bestthr=70.6805 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.210, mb=0.496, no=0.996, corr=-0.144) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.5043 -> 70.6805
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2634 mb_mean=0.4995 norm_overlap=0.9905 corr_cb=-0.3469 topkJ=0.0151
[TRAIN][ep=039] loss=0.7385 acc=79.06%
[TRAIN][ep=039] mask_avg: mc_mean=0.1881 mb_mean=0.4961 norm_overlap=0.9966 corr_cb=-0.1145
[EPOCH 039/089] train: loss=0.7385 acc=79.06% | val: loss=0.6313 acc=67.47% f1=69.66% auc=73.26% val_score=66.0504 val_score_bestthr=66.0504 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.188, mb=0.496, no=0.997, corr=-0.114) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.5043 -> 66.0504
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.1937 mb_mean=0.4932 norm_overlap=0.9957 corr_cb=-0.1603 topkJ=0.0260
[TRAIN][ep=040] loss=0.7244 acc=77.85%
[TRAIN][ep=040] mask_avg: mc_mean=0.1913 mb_mean=0.4961 norm_overlap=0.9968 corr_cb=-0.1109
[EPOCH 040/089] train: loss=0.7244 acc=77.85% | val: loss=0.7070 acc=60.24% f1=52.17% auc=73.60% val_score=45.0962 val_score_bestthr=45.0962 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.191, mb=0.496, no=0.997, corr=-0.111) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.5043 -> 45.0962
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.1123 mb_mean=0.4935 norm_overlap=1.0039 corr_cb=0.0804 topkJ=0.0761
[TRAIN][ep=041] loss=0.7224 acc=77.72%
[TRAIN][ep=041] mask_avg: mc_mean=0.1692 mb_mean=0.4961 norm_overlap=0.9972 corr_cb=-0.0896
[EPOCH 041/089] train: loss=0.7224 acc=77.72% | val: loss=0.6368 acc=69.88% f1=71.26% auc=73.43% val_score=67.7346 val_score_bestthr=67.7346 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.169, mb=0.496, no=0.997, corr=-0.090) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.5043 -> 67.7346
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.1877 mb_mean=0.4948 norm_overlap=1.0007 corr_cb=0.0219 topkJ=0.0377
[TRAIN][ep=042] loss=0.7183 acc=78.79%
[TRAIN][ep=042] mask_avg: mc_mean=0.1972 mb_mean=0.4961 norm_overlap=0.9966 corr_cb=-0.1156
[EPOCH 042/089] train: loss=0.7183 acc=78.79% | val: loss=0.7035 acc=62.65% f1=56.34% auc=73.60% val_score=52.7794 val_score_bestthr=52.7794 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.197, mb=0.496, no=0.997, corr=-0.116) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.5043 -> 52.7794
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.1728 mb_mean=0.4973 norm_overlap=0.9985 corr_cb=-0.0412 topkJ=0.0220
[TRAIN][ep=043] loss=0.7046 acc=80.54%
[TRAIN][ep=043] mask_avg: mc_mean=0.1893 mb_mean=0.4961 norm_overlap=0.9966 corr_cb=-0.1123
[EPOCH 043/089] train: loss=0.7046 acc=80.54% | val: loss=0.7033 acc=63.86% f1=59.46% auc=73.66% val_score=60.7663 val_score_bestthr=60.7663 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.189, mb=0.496, no=0.997, corr=-0.112) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.5043 -> 60.7663
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.1902 mb_mean=0.4990 norm_overlap=0.9965 corr_cb=-0.1307 topkJ=0.0456
[TRAIN][ep=044] loss=0.7220 acc=80.13%
[TRAIN][ep=044] mask_avg: mc_mean=0.1870 mb_mean=0.4961 norm_overlap=0.9968 corr_cb=-0.1035
[EPOCH 044/089] train: loss=0.7220 acc=80.13% | val: loss=0.6544 acc=68.67% f1=72.92% auc=72.67% val_score=69.7006 val_score_bestthr=69.7006 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.187, mb=0.496, no=0.997, corr=-0.104) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.5043 -> 69.7006
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2228 mb_mean=0.4928 norm_overlap=0.9962 corr_cb=-0.1273 topkJ=0.0403
[TRAIN][ep=045] loss=0.7155 acc=79.60%
[TRAIN][ep=045] mask_avg: mc_mean=0.2186 mb_mean=0.4961 norm_overlap=0.9959 corr_cb=-0.1475
[EPOCH 045/089] train: loss=0.7155 acc=79.60% | val: loss=0.7104 acc=66.27% f1=73.08% auc=72.56% val_score=65.8654 val_score_bestthr=65.8654 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.219, mb=0.496, no=0.996, corr=-0.148) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.5043 -> 65.8654
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.1704 mb_mean=0.4987 norm_overlap=0.9955 corr_cb=-0.1485 topkJ=0.0509
[TRAIN][ep=046] loss=0.7113 acc=78.52%
[TRAIN][ep=046] mask_avg: mc_mean=0.1830 mb_mean=0.4961 norm_overlap=0.9969 corr_cb=-0.0984
[EPOCH 046/089] train: loss=0.7113 acc=78.52% | val: loss=0.6659 acc=67.47% f1=68.24% auc=73.26% val_score=60.5405 val_score_bestthr=60.5405 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.183, mb=0.496, no=0.997, corr=-0.098) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.5043 -> 60.5405
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.1959 mb_mean=0.4993 norm_overlap=0.9974 corr_cb=-0.0878 topkJ=0.0514
[TRAIN][ep=047] loss=0.6934 acc=80.13%
[TRAIN][ep=047] mask_avg: mc_mean=0.1741 mb_mean=0.4961 norm_overlap=0.9970 corr_cb=-0.0956
[EPOCH 047/089] train: loss=0.6934 acc=80.13% | val: loss=0.7001 acc=66.27% f1=72.00% auc=72.15% val_score=68.9041 val_score_bestthr=68.9041 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.174, mb=0.496, no=0.997, corr=-0.096) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.5043 -> 68.9041
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.2130 mb_mean=0.4911 norm_overlap=0.9940 corr_cb=-0.2026 topkJ=0.0203
[TRAIN][ep=048] loss=0.6999 acc=78.52%
[TRAIN][ep=048] mask_avg: mc_mean=0.2021 mb_mean=0.4961 norm_overlap=0.9964 corr_cb=-0.1221
[EPOCH 048/089] train: loss=0.6999 acc=78.52% | val: loss=0.6651 acc=66.27% f1=67.44% auc=72.85% val_score=59.0077 val_score_bestthr=59.0077 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.202, mb=0.496, no=0.996, corr=-0.122) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.5043 -> 59.0077
[DBG][ep=049] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.2297 mb_mean=0.4972 norm_overlap=0.9957 corr_cb=-0.1340 topkJ=0.0208
[TRAIN][ep=049] loss=0.6786 acc=82.42%
[TRAIN][ep=049] mask_avg: mc_mean=0.2021 mb_mean=0.4961 norm_overlap=0.9963 corr_cb=-0.1258
[EPOCH 049/089] train: loss=0.6786 acc=82.42% | val: loss=0.7531 acc=63.86% f1=58.33% auc=72.67% val_score=50.0203 val_score_bestthr=50.0203 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.202, mb=0.496, no=0.996, corr=-0.126) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.5043 -> 50.0203
[DBG][ep=050] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.1811 mb_mean=0.4927 norm_overlap=0.9951 corr_cb=-0.1248 topkJ=0.0370
[TRAIN][ep=050] loss=0.6688 acc=81.61%
[TRAIN][ep=050] mask_avg: mc_mean=0.1887 mb_mean=0.4961 norm_overlap=0.9967 corr_cb=-0.1074
[EPOCH 050/089] train: loss=0.6688 acc=81.61% | val: loss=0.6769 acc=67.47% f1=68.24% auc=72.73% val_score=60.5405 val_score_bestthr=60.5405 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.189, mb=0.496, no=0.997, corr=-0.107) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.5043 -> 60.5405
[DBG][ep=051] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.1963 mb_mean=0.5002 norm_overlap=0.9955 corr_cb=-0.1749 topkJ=0.0526
[TRAIN][ep=051] loss=0.6495 acc=83.22%
[TRAIN][ep=051] mask_avg: mc_mean=0.1887 mb_mean=0.4961 norm_overlap=0.9965 corr_cb=-0.1113
[EPOCH 051/089] train: loss=0.6495 acc=83.22% | val: loss=0.6746 acc=68.67% f1=72.34% auc=72.56% val_score=70.5138 val_score_bestthr=70.5138 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.189, mb=0.496, no=0.997, corr=-0.111) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.5043 -> 70.5138
[DBG][ep=052] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.2031 mb_mean=0.4969 norm_overlap=0.9979 corr_cb=-0.0678 topkJ=0.0469
[TRAIN][ep=052] loss=0.6552 acc=83.22%
[TRAIN][ep=052] mask_avg: mc_mean=0.1888 mb_mean=0.4961 norm_overlap=0.9966 corr_cb=-0.1093
[EPOCH 052/089] train: loss=0.6552 acc=83.22% | val: loss=0.6746 acc=71.08% f1=73.91% auc=73.02% val_score=70.6187 val_score_bestthr=70.6187 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.189, mb=0.496, no=0.997, corr=-0.109) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.5043 -> 70.6187
[DBG][ep=053] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.1922 mb_mean=0.4951 norm_overlap=0.9968 corr_cb=-0.0997 topkJ=0.0451
[TRAIN][ep=053] loss=0.6534 acc=82.55%
[TRAIN][ep=053] mask_avg: mc_mean=0.1887 mb_mean=0.4961 norm_overlap=0.9966 corr_cb=-0.1090
[EPOCH 053/089] train: loss=0.6534 acc=82.55% | val: loss=0.6770 acc=68.67% f1=71.11% auc=72.56% val_score=65.7433 val_score_bestthr=65.7433 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.189, mb=0.496, no=0.997, corr=-0.109) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.5043 -> 65.7433
[DBG][ep=054] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=054] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=054] mask(step0): mc_mean=0.1948 mb_mean=0.4949 norm_overlap=0.9990 corr_cb=-0.0308 topkJ=0.0595
[TRAIN][ep=054] loss=0.6482 acc=83.22%
[TRAIN][ep=054] mask_avg: mc_mean=0.1887 mb_mean=0.4961 norm_overlap=0.9966 corr_cb=-0.1085
[EPOCH 054/089] train: loss=0.6482 acc=83.22% | val: loss=0.6784 acc=68.67% f1=71.11% auc=72.67% val_score=65.7433 val_score_bestthr=65.7433 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.189, mb=0.496, no=0.997, corr=-0.109) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.5043 -> 65.7433
[DBG][ep=055] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=055] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=055] mask(step0): mc_mean=0.1889 mb_mean=0.4943 norm_overlap=0.9984 corr_cb=-0.0439 topkJ=0.0466
[TRAIN][ep=055] loss=0.6493 acc=82.42%
[TRAIN][ep=055] mask_avg: mc_mean=0.1887 mb_mean=0.4961 norm_overlap=0.9967 corr_cb=-0.1077
[EPOCH 055/089] train: loss=0.6493 acc=82.42% | val: loss=0.6885 acc=66.27% f1=66.67% auc=73.37% val_score=58.9204 val_score_bestthr=58.9204 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.189, mb=0.496, no=0.997, corr=-0.108) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.5043 -> 58.9204
[DBG][ep=056] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=056] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=056] mask(step0): mc_mean=0.1652 mb_mean=0.4941 norm_overlap=0.9970 corr_cb=-0.0908 topkJ=0.0465
[TRAIN][ep=056] loss=0.6496 acc=83.09%
[TRAIN][ep=056] mask_avg: mc_mean=0.1888 mb_mean=0.4961 norm_overlap=0.9967 corr_cb=-0.1065
[EPOCH 056/089] train: loss=0.6496 acc=83.09% | val: loss=0.6824 acc=67.47% f1=69.66% auc=72.85% val_score=66.0504 val_score_bestthr=66.0504 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.189, mb=0.496, no=0.997, corr=-0.107) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.5043 -> 66.0504
[DBG][ep=057] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=057] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=057] mask(step0): mc_mean=0.2158 mb_mean=0.4963 norm_overlap=0.9932 corr_cb=-0.2286 topkJ=0.0197
[TRAIN][ep=057] loss=0.6476 acc=82.28%
[TRAIN][ep=057] mask_avg: mc_mean=0.1887 mb_mean=0.4961 norm_overlap=0.9967 corr_cb=-0.1048
[EPOCH 057/089] train: loss=0.6476 acc=82.28% | val: loss=0.6909 acc=66.27% f1=66.67% auc=73.02% val_score=58.9204 val_score_bestthr=58.9204 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.189, mb=0.496, no=0.997, corr=-0.105) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.5043 -> 58.9204
[DBG][ep=058] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=058] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=058] mask(step0): mc_mean=0.1798 mb_mean=0.4953 norm_overlap=0.9971 corr_cb=-0.0797 topkJ=0.0436
[TRAIN][ep=058] loss=0.6477 acc=83.22%
[TRAIN][ep=058] mask_avg: mc_mean=0.1887 mb_mean=0.4961 norm_overlap=0.9966 corr_cb=-0.1079
[EPOCH 058/089] train: loss=0.6477 acc=83.22% | val: loss=0.6873 acc=68.67% f1=71.11% auc=72.44% val_score=65.7433 val_score_bestthr=65.7433 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.189, mb=0.496, no=0.997, corr=-0.108) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.5043 -> 65.7433
[DBG][ep=059] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=059] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=059] mask(step0): mc_mean=0.1601 mb_mean=0.4976 norm_overlap=0.9990 corr_cb=-0.0259 topkJ=0.0580
[TRAIN][ep=059] loss=0.6495 acc=82.82%
[TRAIN][ep=059] mask_avg: mc_mean=0.1887 mb_mean=0.4961 norm_overlap=0.9966 corr_cb=-0.1090
[EPOCH 059/089] train: loss=0.6495 acc=82.82% | val: loss=0.6897 acc=67.47% f1=70.33% auc=72.44% val_score=65.5598 val_score_bestthr=65.5598 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.189, mb=0.496, no=0.997, corr=-0.109) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.5043 -> 65.5598
[DBG][ep=060] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=060] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=060] mask(step0): mc_mean=0.1884 mb_mean=0.4940 norm_overlap=0.9955 corr_cb=-0.1515 topkJ=0.0421
[TRAIN][ep=060] loss=0.6390 acc=82.55%
[TRAIN][ep=060] mask_avg: mc_mean=0.1887 mb_mean=0.4961 norm_overlap=0.9966 corr_cb=-0.1072
[EPOCH 060/089] train: loss=0.6390 acc=82.55% | val: loss=0.6919 acc=67.47% f1=70.97% auc=72.62% val_score=65.5084 val_score_bestthr=65.5084 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.189, mb=0.496, no=0.997, corr=-0.107) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.5043 -> 65.5084
[EARLY STOP] no improvement for 30 epochs. best_epoch=30
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
=============== FIT DONE ===============
[BEST] epoch=30 | val_acc=69.88% | val_f1=73.12% | val_auc=73.49% | val_score=72.5043 | val_score_bestthr=72.5043
[TEST@BEST] thr_used=0.450 | acc=61.35% f1=66.39% auc=63.51% | SP_sex=26.41% EO_sex=25.83% SP_age=16.73% EO_age=16.89%
[TIME] 1.40 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/summary_fold_2.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4477 mb_mean=0.4964 norm_overlap=1.0006 corr_cb=0.6199 topkJ=0.1849
[TRAIN][ep=000] loss=0.6951 acc=47.25%
[TRAIN][ep=000] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5111
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4378 mb_mean=0.4940 norm_overlap=1.0005 corr_cb=0.5338 topkJ=0.1816
[TRAIN][ep=001] loss=0.6926 acc=50.74%
[TRAIN][ep=001] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5175
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4517 mb_mean=0.4988 norm_overlap=1.0004 corr_cb=0.4909 topkJ=0.1226
[TRAIN][ep=002] loss=0.6926 acc=52.21%
[TRAIN][ep=002] mask_avg: mc_mean=0.4463 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5077
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4474 mb_mean=0.4963 norm_overlap=1.0004 corr_cb=0.4696 topkJ=0.1653
[TRAIN][ep=003] loss=0.6924 acc=52.75%
[TRAIN][ep=003] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5044
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4425 mb_mean=0.4921 norm_overlap=1.0010 corr_cb=0.7152 topkJ=0.2130
[TRAIN][ep=004] loss=0.6910 acc=52.62%
[TRAIN][ep=004] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5027
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4529 mb_mean=0.4986 norm_overlap=1.0003 corr_cb=0.4542 topkJ=0.1703
[TRAIN][ep=005] loss=0.6877 acc=57.58%
[TRAIN][ep=005] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5020
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4536 mb_mean=0.4984 norm_overlap=1.0003 corr_cb=0.3933 topkJ=0.1356
[TRAIN][ep=006] loss=0.6858 acc=57.99%
[TRAIN][ep=006] mask_avg: mc_mean=0.4463 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5030
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4543 mb_mean=0.4986 norm_overlap=1.0005 corr_cb=0.5123 topkJ=0.1231
[TRAIN][ep=007] loss=0.6832 acc=55.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5158
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4444 mb_mean=0.4958 norm_overlap=1.0005 corr_cb=0.5646 topkJ=0.1270
[TRAIN][ep=008] loss=0.6779 acc=56.38%
[TRAIN][ep=008] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5070
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4465 mb_mean=0.4969 norm_overlap=1.0003 corr_cb=0.4721 topkJ=0.1699
[TRAIN][ep=009] loss=0.6742 acc=62.01%
[TRAIN][ep=009] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5069
================= FIT START (fold=2) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4558 mb_mean=0.5004 norm_overlap=1.0002 corr_cb=0.3859 topkJ=0.1398
[TRAIN][ep=000] loss=0.6720 acc=59.46%
[TRAIN][ep=000] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5085
[EPOCH 000/089] train: loss=0.6720 acc=59.46% | val: loss=0.6776 acc=66.27% f1=67.44% auc=65.12% val_score=46.1149 val_score_bestthr=65.4959 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.446, mb=0.496, no=1.000, corr=0.509) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 65.4959
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4538 mb_mean=0.4979 norm_overlap=1.0003 corr_cb=0.4016 topkJ=0.2040
[TRAIN][ep=001] loss=0.6663 acc=62.95%
[TRAIN][ep=001] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5121
[EPOCH 001/089] train: loss=0.6663 acc=62.95% | val: loss=0.6657 acc=66.27% f1=69.57% auc=68.84% val_score=57.5615 val_score_bestthr=65.5986 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.446, mb=0.496, no=1.001, corr=0.512) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 65.4959 -> 65.5986
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4475 mb_mean=0.4963 norm_overlap=1.0004 corr_cb=0.4390 topkJ=0.0795
[TRAIN][ep=002] loss=0.6612 acc=63.36%
[TRAIN][ep=002] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5046
[EPOCH 002/089] train: loss=0.6612 acc=63.36% | val: loss=0.6614 acc=69.88% f1=70.59% auc=68.84% val_score=57.5322 val_score_bestthr=68.8390 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.446, mb=0.496, no=1.000, corr=0.505) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 65.5986 -> 68.8390
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4442 mb_mean=0.4982 norm_overlap=1.0006 corr_cb=0.5457 topkJ=0.1279
[TRAIN][ep=003] loss=0.6621 acc=61.61%
[TRAIN][ep=003] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5061
[EPOCH 003/089] train: loss=0.6621 acc=61.61% | val: loss=0.6595 acc=67.47% f1=69.66% auc=69.07% val_score=50.4387 val_score_bestthr=66.0988 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.446, mb=0.496, no=1.000, corr=0.506) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 66.0988
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4474 mb_mean=0.4978 norm_overlap=1.0003 corr_cb=0.4220 topkJ=0.0832
[TRAIN][ep=004] loss=0.6505 acc=62.28%
[TRAIN][ep=004] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5086
[EPOCH 004/089] train: loss=0.6505 acc=62.28% | val: loss=0.6534 acc=66.27% f1=67.44% auc=69.65% val_score=54.9266 val_score_bestthr=66.0495 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.446, mb=0.496, no=1.001, corr=0.509) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 66.0495
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4503 mb_mean=0.4974 norm_overlap=1.0004 corr_cb=0.4973 topkJ=0.1639
[TRAIN][ep=005] loss=1.3547 acc=62.55%
[TRAIN][ep=005] mask_avg: mc_mean=0.3249 mb_mean=0.4961 norm_overlap=1.0022 corr_cb=0.5169
[EPOCH 005/089] train: loss=1.3547 acc=62.55% | val: loss=0.6929 acc=63.86% f1=64.29% auc=66.86% val_score=36.2032 val_score_bestthr=64.3348 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.325, mb=0.496, no=1.002, corr=0.517) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 64.3348
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2590 mb_mean=0.4955 norm_overlap=1.0033 corr_cb=0.4750 topkJ=0.1444
[TRAIN][ep=006] loss=1.3337 acc=64.56%
[TRAIN][ep=006] mask_avg: mc_mean=0.2442 mb_mean=0.4961 norm_overlap=1.0030 corr_cb=0.4036
[EPOCH 006/089] train: loss=1.3337 acc=64.56% | val: loss=0.6479 acc=65.06% f1=72.90% auc=70.99% val_score=67.2210 val_score_bestthr=67.2210 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.244, mb=0.496, no=1.003, corr=0.404) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 67.2210
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2052 mb_mean=0.4933 norm_overlap=1.0038 corr_cb=0.4494 topkJ=0.2075
[TRAIN][ep=007] loss=1.3214 acc=64.03%
[TRAIN][ep=007] mask_avg: mc_mean=0.2238 mb_mean=0.4961 norm_overlap=1.0025 corr_cb=0.2812
[EPOCH 007/089] train: loss=1.3214 acc=64.03% | val: loss=0.6514 acc=66.27% f1=73.08% auc=70.76% val_score=64.2121 val_score_bestthr=68.4967 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.224, mb=0.496, no=1.002, corr=0.281) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 68.4967
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1445 mb_mean=0.4919 norm_overlap=1.0018 corr_cb=0.2057 topkJ=0.1373
[TRAIN][ep=008] loss=1.1277 acc=67.92%
[TRAIN][ep=008] mask_avg: mc_mean=0.2013 mb_mean=0.4961 norm_overlap=1.0019 corr_cb=0.1830
[EPOCH 008/089] train: loss=1.1277 acc=67.92% | val: loss=0.6386 acc=65.06% f1=72.90% auc=70.64% val_score=59.8879 val_score_bestthr=67.2210 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.201, mb=0.496, no=1.002, corr=0.183) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 67.2210
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2090 mb_mean=0.4948 norm_overlap=1.0039 corr_cb=0.3106 topkJ=0.0730
[TRAIN][ep=009] loss=0.9395 acc=65.77%
[TRAIN][ep=009] mask_avg: mc_mean=0.1828 mb_mean=0.4961 norm_overlap=1.0011 corr_cb=0.0817
[EPOCH 009/089] train: loss=0.9395 acc=65.77% | val: loss=0.6402 acc=65.06% f1=73.39% auc=70.64% val_score=65.0471 val_score_bestthr=65.8299 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.183, mb=0.496, no=1.001, corr=0.082) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 65.8299
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1782 mb_mean=0.4972 norm_overlap=0.9992 corr_cb=-0.0743 topkJ=0.0544
[TRAIN][ep=010] loss=0.9029 acc=66.31%
[TRAIN][ep=010] mask_avg: mc_mean=0.1896 mb_mean=0.4961 norm_overlap=1.0001 corr_cb=-0.0037
[EPOCH 010/089] train: loss=0.9029 acc=66.31% | val: loss=0.6288 acc=67.47% f1=68.97% auc=70.99% val_score=65.1939 val_score_bestthr=66.3074 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.496, no=1.000, corr=-0.004) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 66.3074
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1747 mb_mean=0.4971 norm_overlap=1.0016 corr_cb=0.1126 topkJ=0.0468
[TRAIN][ep=011] loss=0.8674 acc=70.07%
[TRAIN][ep=011] mask_avg: mc_mean=0.1765 mb_mean=0.4961 norm_overlap=0.9996 corr_cb=-0.0316
[EPOCH 011/089] train: loss=0.8674 acc=70.07% | val: loss=0.7320 acc=67.47% f1=64.94% auc=67.38% val_score=37.1849 val_score_bestthr=67.1908 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.176, mb=0.496, no=1.000, corr=-0.032) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 67.1908
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1587 mb_mean=0.4951 norm_overlap=0.9974 corr_cb=-0.1601 topkJ=0.0231
[TRAIN][ep=012] loss=0.8809 acc=68.32%
[TRAIN][ep=012] mask_avg: mc_mean=0.1465 mb_mean=0.4961 norm_overlap=0.9999 corr_cb=-0.0232
[EPOCH 012/089] train: loss=0.8809 acc=68.32% | val: loss=0.6258 acc=65.06% f1=73.87% auc=71.63% val_score=59.9164 val_score_bestthr=68.7451 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.147, mb=0.496, no=1.000, corr=-0.023) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 68.7451
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.0880 mb_mean=0.4969 norm_overlap=0.9998 corr_cb=-0.0088 topkJ=0.0462
[TRAIN][ep=013] loss=0.8544 acc=70.20%
[TRAIN][ep=013] mask_avg: mc_mean=0.1157 mb_mean=0.4961 norm_overlap=0.9997 corr_cb=-0.0269
[EPOCH 013/089] train: loss=0.8544 acc=70.20% | val: loss=0.6222 acc=68.67% f1=69.77% auc=72.15% val_score=68.8973 val_score_bestthr=68.8973 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.116, mb=0.496, no=1.000, corr=-0.027) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 68.8390 -> 68.8973
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1618 mb_mean=0.4985 norm_overlap=0.9965 corr_cb=-0.1871 topkJ=0.0280
[TRAIN][ep=014] loss=0.9270 acc=70.34%
[TRAIN][ep=014] mask_avg: mc_mean=0.1470 mb_mean=0.4961 norm_overlap=0.9976 corr_cb=-0.1186
[EPOCH 014/089] train: loss=0.9270 acc=70.34% | val: loss=0.6148 acc=67.47% f1=70.33% auc=72.09% val_score=63.6411 val_score_bestthr=69.5341 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.147, mb=0.496, no=0.998, corr=-0.119) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 68.8973 -> 69.5341
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1686 mb_mean=0.4977 norm_overlap=0.9989 corr_cb=-0.0420 topkJ=0.0736
[TRAIN][ep=015] loss=0.9937 acc=67.79%
[TRAIN][ep=015] mask_avg: mc_mean=0.1347 mb_mean=0.4961 norm_overlap=0.9978 corr_cb=-0.0991
[EPOCH 015/089] train: loss=0.9937 acc=67.79% | val: loss=0.6341 acc=71.08% f1=70.73% auc=72.79% val_score=52.5831 val_score_bestthr=73.8907 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.135, mb=0.496, no=0.998, corr=-0.099) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 69.5341 -> 73.8907
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1787 mb_mean=0.4984 norm_overlap=0.9909 corr_cb=-0.4171 topkJ=0.0104
[TRAIN][ep=016] loss=1.0502 acc=72.62%
[TRAIN][ep=016] mask_avg: mc_mean=0.1498 mb_mean=0.4961 norm_overlap=0.9968 corr_cb=-0.1397
[EPOCH 016/089] train: loss=1.0502 acc=72.62% | val: loss=0.6115 acc=69.88% f1=71.26% auc=73.26% val_score=67.4883 val_score_bestthr=71.3757 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.150, mb=0.496, no=0.997, corr=-0.140) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.8907 -> 71.3757
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1236 mb_mean=0.4972 norm_overlap=0.9987 corr_cb=-0.0575 topkJ=0.0583
[TRAIN][ep=017] loss=1.1231 acc=72.08%
[TRAIN][ep=017] mask_avg: mc_mean=0.1329 mb_mean=0.4961 norm_overlap=0.9971 corr_cb=-0.1114
[EPOCH 017/089] train: loss=1.1231 acc=72.08% | val: loss=0.7321 acc=67.47% f1=71.58% auc=72.62% val_score=46.9534 val_score_bestthr=70.0151 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.133, mb=0.496, no=0.997, corr=-0.111) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.8907 -> 70.0151
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1399 mb_mean=0.4952 norm_overlap=0.9977 corr_cb=-0.0844 topkJ=0.0387
[TRAIN][ep=018] loss=1.1871 acc=71.41%
[TRAIN][ep=018] mask_avg: mc_mean=0.1511 mb_mean=0.4961 norm_overlap=0.9962 corr_cb=-0.1520
[EPOCH 018/089] train: loss=1.1871 acc=71.41% | val: loss=0.6355 acc=72.29% f1=75.79% auc=73.66% val_score=53.6088 val_score_bestthr=74.1317 | dyn(w_pfs=0.240, w_sup=0.240, w_csuf=0.200, stage2=False) | mask(mc=0.151, mb=0.496, no=0.996, corr=-0.152) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 73.8907 -> 74.1317
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1494 mb_mean=0.4952 norm_overlap=0.9961 corr_cb=-0.1264 topkJ=0.0239
[TRAIN][ep=019] loss=1.1913 acc=71.41%
[TRAIN][ep=019] mask_avg: mc_mean=0.1341 mb_mean=0.4961 norm_overlap=0.9968 corr_cb=-0.1188
[EPOCH 019/089] train: loss=1.1913 acc=71.41% | val: loss=0.6236 acc=65.06% f1=70.71% auc=72.27% val_score=67.0091 val_score_bestthr=69.1666 | dyn(w_pfs=0.280, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.134, mb=0.496, no=0.997, corr=-0.119) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 69.1666
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1595 mb_mean=0.4987 norm_overlap=0.9951 corr_cb=-0.2257 topkJ=0.0343
[TRAIN][ep=020] loss=1.1862 acc=73.83%
[TRAIN][ep=020] mask_avg: mc_mean=0.1550 mb_mean=0.4961 norm_overlap=0.9964 corr_cb=-0.1445
[EPOCH 020/089] train: loss=1.1862 acc=73.83% | val: loss=0.6113 acc=67.47% f1=71.58% auc=73.26% val_score=67.9202 val_score_bestthr=69.4458 | dyn(w_pfs=0.320, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.155, mb=0.496, no=0.996, corr=-0.144) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 69.4458
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.1371 mb_mean=0.5007 norm_overlap=0.9944 corr_cb=-0.2052 topkJ=0.0193
[TRAIN][ep=021] loss=1.1832 acc=73.15%
[TRAIN][ep=021] mask_avg: mc_mean=0.1643 mb_mean=0.4961 norm_overlap=0.9962 corr_cb=-0.1547
[EPOCH 021/089] train: loss=1.1832 acc=73.15% | val: loss=0.6269 acc=69.88% f1=73.12% auc=73.08% val_score=67.0091 val_score_bestthr=70.3364 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.164, mb=0.496, no=0.996, corr=-0.155) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 70.3364
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1699 mb_mean=0.4922 norm_overlap=1.0001 corr_cb=0.0047 topkJ=0.0656
[TRAIN][ep=022] loss=1.1875 acc=76.38%
[TRAIN][ep=022] mask_avg: mc_mean=0.1457 mb_mean=0.4961 norm_overlap=0.9967 corr_cb=-0.1238
[EPOCH 022/089] train: loss=1.1875 acc=76.38% | val: loss=0.6206 acc=69.88% f1=73.12% auc=73.02% val_score=65.6950 val_score_bestthr=71.4203 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.146, mb=0.496, no=0.997, corr=-0.124) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 71.4203
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1587 mb_mean=0.4973 norm_overlap=0.9945 corr_cb=-0.2108 topkJ=0.0182
[TRAIN][ep=023] loss=1.1841 acc=74.23%
[TRAIN][ep=023] mask_avg: mc_mean=0.1399 mb_mean=0.4961 norm_overlap=0.9965 corr_cb=-0.1240
[EPOCH 023/089] train: loss=1.1841 acc=74.23% | val: loss=0.6372 acc=72.29% f1=74.73% auc=72.73% val_score=58.3781 val_score_bestthr=73.6325 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.140, mb=0.496, no=0.996, corr=-0.124) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 73.6325
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1660 mb_mean=0.4928 norm_overlap=0.9972 corr_cb=-0.0995 topkJ=0.0858
[TRAIN][ep=024] loss=1.0330 acc=71.95%
[TRAIN][ep=024] mask_avg: mc_mean=0.1523 mb_mean=0.4961 norm_overlap=0.9963 corr_cb=-0.1338
[EPOCH 024/089] train: loss=1.0330 acc=71.95% | val: loss=0.6182 acc=69.88% f1=73.12% auc=73.37% val_score=68.3529 val_score_bestthr=71.4203 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.152, mb=0.496, no=0.996, corr=-0.134) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 71.4203
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1190 mb_mean=0.4964 norm_overlap=0.9950 corr_cb=-0.1373 topkJ=0.0323
[TRAIN][ep=025] loss=0.8372 acc=74.36%
[TRAIN][ep=025] mask_avg: mc_mean=0.1420 mb_mean=0.4961 norm_overlap=0.9961 corr_cb=-0.1391
[EPOCH 025/089] train: loss=0.8372 acc=74.36% | val: loss=0.6060 acc=69.88% f1=73.12% auc=73.26% val_score=65.3226 val_score_bestthr=71.4203 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.142, mb=0.496, no=0.996, corr=-0.139) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 71.4203
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1405 mb_mean=0.4934 norm_overlap=1.0021 corr_cb=0.0608 topkJ=0.0381
[TRAIN][ep=026] loss=0.7853 acc=76.51%
[TRAIN][ep=026] mask_avg: mc_mean=0.1683 mb_mean=0.4961 norm_overlap=0.9961 corr_cb=-0.1532
[EPOCH 026/089] train: loss=0.7853 acc=76.51% | val: loss=0.6209 acc=67.47% f1=71.58% auc=73.08% val_score=66.4268 val_score_bestthr=69.1525 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.168, mb=0.496, no=0.996, corr=-0.153) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 69.1525
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1717 mb_mean=0.4995 norm_overlap=0.9964 corr_cb=-0.1465 topkJ=0.0259
[TRAIN][ep=027] loss=0.7710 acc=75.57%
[TRAIN][ep=027] mask_avg: mc_mean=0.1630 mb_mean=0.4961 norm_overlap=0.9965 corr_cb=-0.1308
[EPOCH 027/089] train: loss=0.7710 acc=75.57% | val: loss=0.6380 acc=72.29% f1=74.16% auc=73.66% val_score=54.8446 val_score_bestthr=69.3838 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.163, mb=0.496, no=0.997, corr=-0.131) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 69.3838
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1861 mb_mean=0.4920 norm_overlap=0.9992 corr_cb=-0.0358 topkJ=0.0497
[TRAIN][ep=028] loss=0.7566 acc=76.24%
[TRAIN][ep=028] mask_avg: mc_mean=0.1803 mb_mean=0.4961 norm_overlap=0.9963 corr_cb=-0.1471
[EPOCH 028/089] train: loss=0.7566 acc=76.24% | val: loss=0.6514 acc=67.47% f1=74.77% auc=72.85% val_score=64.9112 val_score_bestthr=68.9386 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.180, mb=0.496, no=0.996, corr=-0.147) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 68.9386
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.1641 mb_mean=0.4915 norm_overlap=0.9996 corr_cb=-0.0148 topkJ=0.0593
[TRAIN][ep=029] loss=0.7478 acc=77.05%
[TRAIN][ep=029] mask_avg: mc_mean=0.1785 mb_mean=0.4961 norm_overlap=0.9966 corr_cb=-0.1384
[EPOCH 029/089] train: loss=0.7478 acc=77.05% | val: loss=0.6330 acc=68.67% f1=72.34% auc=73.08% val_score=64.8973 val_score_bestthr=70.6805 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.178, mb=0.496, no=0.997, corr=-0.138) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 70.6805
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2150 mb_mean=0.4964 norm_overlap=0.9957 corr_cb=-0.1950 topkJ=0.0502
[TRAIN][ep=030] loss=0.7397 acc=78.12%
[TRAIN][ep=030] mask_avg: mc_mean=0.2061 mb_mean=0.4961 norm_overlap=0.9961 corr_cb=-0.1666
[EPOCH 030/089] train: loss=0.7397 acc=78.12% | val: loss=0.6316 acc=68.67% f1=75.93% auc=73.90% val_score=60.7322 val_score_bestthr=71.6173 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.206, mb=0.496, no=0.996, corr=-0.167) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 71.6173
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.1484 mb_mean=0.4928 norm_overlap=0.9998 corr_cb=-0.0063 topkJ=0.0620
[TRAIN][ep=031] loss=0.7369 acc=78.26%
[TRAIN][ep=031] mask_avg: mc_mean=0.1654 mb_mean=0.4961 norm_overlap=0.9970 corr_cb=-0.1122
[EPOCH 031/089] train: loss=0.7369 acc=78.26% | val: loss=0.6356 acc=66.27% f1=74.07% auc=73.02% val_score=57.4434 val_score_bestthr=69.6610 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.165, mb=0.496, no=0.997, corr=-0.112) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 69.6610
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1764 mb_mean=0.4973 norm_overlap=1.0005 corr_cb=0.0185 topkJ=0.0666
[TRAIN][ep=032] loss=0.7239 acc=77.85%
[TRAIN][ep=032] mask_avg: mc_mean=0.1814 mb_mean=0.4961 norm_overlap=0.9969 corr_cb=-0.1200
[EPOCH 032/089] train: loss=0.7239 acc=77.85% | val: loss=0.7651 acc=67.47% f1=75.23% auc=72.85% val_score=40.4927 val_score_bestthr=68.6579 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.181, mb=0.496, no=0.997, corr=-0.120) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 68.6579
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2296 mb_mean=0.4971 norm_overlap=0.9982 corr_cb=-0.0995 topkJ=0.0406
[TRAIN][ep=033] loss=0.7310 acc=78.12%
[TRAIN][ep=033] mask_avg: mc_mean=0.2038 mb_mean=0.4961 norm_overlap=0.9962 corr_cb=-0.1551
[EPOCH 033/089] train: loss=0.7310 acc=78.12% | val: loss=0.6596 acc=66.27% f1=72.00% auc=73.02% val_score=56.6749 val_score_bestthr=68.4923 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.204, mb=0.496, no=0.996, corr=-0.155) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 68.4923
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1391 mb_mean=0.4943 norm_overlap=0.9969 corr_cb=-0.1169 topkJ=0.0453
[TRAIN][ep=034] loss=0.7086 acc=79.06%
[TRAIN][ep=034] mask_avg: mc_mean=0.1949 mb_mean=0.4961 norm_overlap=0.9968 corr_cb=-0.1296
[EPOCH 034/089] train: loss=0.7086 acc=79.06% | val: loss=0.6869 acc=71.08% f1=75.00% auc=71.80% val_score=73.4713 val_score_bestthr=73.4713 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.195, mb=0.496, no=0.997, corr=-0.130) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 73.4713
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.1975 mb_mean=0.4949 norm_overlap=0.9962 corr_cb=-0.1661 topkJ=0.0510
[TRAIN][ep=035] loss=0.6992 acc=80.54%
[TRAIN][ep=035] mask_avg: mc_mean=0.1869 mb_mean=0.4961 norm_overlap=0.9974 corr_cb=-0.1009
[EPOCH 035/089] train: loss=0.6992 acc=80.54% | val: loss=0.6942 acc=68.67% f1=75.47% auc=72.33% val_score=66.7535 val_score_bestthr=70.4582 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.187, mb=0.496, no=0.997, corr=-0.101) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 70.4582
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2041 mb_mean=0.4988 norm_overlap=0.9973 corr_cb=-0.1089 topkJ=0.0341
[TRAIN][ep=036] loss=0.7189 acc=77.85%
[TRAIN][ep=036] mask_avg: mc_mean=0.2410 mb_mean=0.4961 norm_overlap=0.9958 corr_cb=-0.1870
[EPOCH 036/089] train: loss=0.7189 acc=77.85% | val: loss=0.6536 acc=71.08% f1=75.00% auc=72.38% val_score=65.2963 val_score_bestthr=73.4713 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.241, mb=0.496, no=0.996, corr=-0.187) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 73.4713
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1946 mb_mean=0.4955 norm_overlap=0.9963 corr_cb=-0.1267 topkJ=0.0553
[TRAIN][ep=037] loss=0.7000 acc=80.00%
[TRAIN][ep=037] mask_avg: mc_mean=0.1920 mb_mean=0.4961 norm_overlap=0.9967 corr_cb=-0.1242
[EPOCH 037/089] train: loss=0.7000 acc=80.00% | val: loss=0.6890 acc=66.27% f1=74.07% auc=73.02% val_score=50.0246 val_score_bestthr=67.0998 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.192, mb=0.496, no=0.997, corr=-0.124) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 67.0998
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.1517 mb_mean=0.4959 norm_overlap=0.9978 corr_cb=-0.0809 topkJ=0.0453
[TRAIN][ep=038] loss=0.6803 acc=80.40%
[TRAIN][ep=038] mask_avg: mc_mean=0.2157 mb_mean=0.4961 norm_overlap=0.9959 corr_cb=-0.1615
[EPOCH 038/089] train: loss=0.6803 acc=80.40% | val: loss=0.6805 acc=71.08% f1=74.47% auc=71.86% val_score=70.1456 val_score_bestthr=70.8863 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.216, mb=0.496, no=0.996, corr=-0.162) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 70.8863
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2555 mb_mean=0.4995 norm_overlap=0.9915 corr_cb=-0.3356 topkJ=0.0198
[TRAIN][ep=039] loss=0.6948 acc=79.06%
[TRAIN][ep=039] mask_avg: mc_mean=0.1909 mb_mean=0.4961 norm_overlap=0.9967 corr_cb=-0.1234
[EPOCH 039/089] train: loss=0.6948 acc=79.06% | val: loss=0.6621 acc=67.47% f1=74.77% auc=72.79% val_score=65.7433 val_score_bestthr=70.0586 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.191, mb=0.496, no=0.997, corr=-0.123) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 70.0586
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.2151 mb_mean=0.4932 norm_overlap=0.9954 corr_cb=-0.2159 topkJ=0.0264
[TRAIN][ep=040] loss=0.6745 acc=80.54%
[TRAIN][ep=040] mask_avg: mc_mean=0.1971 mb_mean=0.4961 norm_overlap=0.9970 corr_cb=-0.1204
[EPOCH 040/089] train: loss=0.6745 acc=80.54% | val: loss=0.6865 acc=67.47% f1=74.77% auc=72.73% val_score=59.6113 val_score_bestthr=68.6174 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.197, mb=0.496, no=0.997, corr=-0.120) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 68.6174
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.0899 mb_mean=0.4935 norm_overlap=1.0066 corr_cb=0.1348 topkJ=0.1027
[TRAIN][ep=041] loss=0.6723 acc=79.73%
[TRAIN][ep=041] mask_avg: mc_mean=0.1940 mb_mean=0.4961 norm_overlap=0.9969 corr_cb=-0.1220
[EPOCH 041/089] train: loss=0.6723 acc=79.73% | val: loss=0.6755 acc=69.88% f1=73.12% auc=72.79% val_score=70.1697 val_score_bestthr=70.1697 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.194, mb=0.496, no=0.997, corr=-0.122) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 70.1697
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.1905 mb_mean=0.4948 norm_overlap=1.0002 corr_cb=0.0061 topkJ=0.0424
[TRAIN][ep=042] loss=0.6750 acc=81.34%
[TRAIN][ep=042] mask_avg: mc_mean=0.2145 mb_mean=0.4961 norm_overlap=0.9966 corr_cb=-0.1370
[EPOCH 042/089] train: loss=0.6750 acc=81.34% | val: loss=0.7163 acc=69.88% f1=73.12% auc=72.38% val_score=46.1697 val_score_bestthr=68.1791 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.215, mb=0.496, no=0.997, corr=-0.137) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 68.1791
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.1621 mb_mean=0.4973 norm_overlap=0.9984 corr_cb=-0.0458 topkJ=0.0296
[TRAIN][ep=043] loss=0.6529 acc=82.95%
[TRAIN][ep=043] mask_avg: mc_mean=0.2022 mb_mean=0.4961 norm_overlap=0.9962 corr_cb=-0.1437
[EPOCH 043/089] train: loss=0.6529 acc=82.95% | val: loss=0.7499 acc=67.47% f1=75.23% auc=72.62% val_score=50.0246 val_score_bestthr=66.9079 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.202, mb=0.496, no=0.996, corr=-0.144) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 66.9079
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2490 mb_mean=0.4990 norm_overlap=0.9959 corr_cb=-0.2038 topkJ=0.0384
[TRAIN][ep=044] loss=0.6674 acc=81.74%
[TRAIN][ep=044] mask_avg: mc_mean=0.2055 mb_mean=0.4961 norm_overlap=0.9965 corr_cb=-0.1333
[EPOCH 044/089] train: loss=0.6674 acc=81.74% | val: loss=0.6878 acc=69.88% f1=74.23% auc=71.28% val_score=63.2216 val_score_bestthr=74.1455 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.206, mb=0.496, no=0.997, corr=-0.133) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 74.1317 -> 74.1455
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2914 mb_mean=0.4928 norm_overlap=0.9942 corr_cb=-0.2737 topkJ=0.0249
[TRAIN][ep=045] loss=0.7344 acc=81.48%
[TRAIN][ep=045] mask_avg: mc_mean=0.2553 mb_mean=0.4961 norm_overlap=0.9954 corr_cb=-0.2022
[EPOCH 045/089] train: loss=0.7344 acc=81.48% | val: loss=0.7667 acc=67.47% f1=74.77% auc=71.63% val_score=67.5730 val_score_bestthr=70.0586 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.255, mb=0.496, no=0.995, corr=-0.202) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1455 -> 70.0586
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.1676 mb_mean=0.4987 norm_overlap=0.9948 corr_cb=-0.1859 topkJ=0.0536
[TRAIN][ep=046] loss=0.7965 acc=80.67%
[TRAIN][ep=046] mask_avg: mc_mean=0.1898 mb_mean=0.4961 norm_overlap=0.9971 corr_cb=-0.1068
[EPOCH 046/089] train: loss=0.7965 acc=80.67% | val: loss=0.7275 acc=67.47% f1=75.23% auc=72.67% val_score=47.8334 val_score_bestthr=69.7779 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.190, mb=0.496, no=0.997, corr=-0.107) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1455 -> 69.7779
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.2510 mb_mean=0.4993 norm_overlap=0.9979 corr_cb=-0.0927 topkJ=0.0540
[TRAIN][ep=047] loss=0.8394 acc=82.55%
[TRAIN][ep=047] mask_avg: mc_mean=0.2236 mb_mean=0.4961 norm_overlap=0.9964 corr_cb=-0.1432
[EPOCH 047/089] train: loss=0.8394 acc=82.55% | val: loss=0.7903 acc=69.88% f1=73.68% auc=70.00% val_score=65.7399 val_score_bestthr=70.1456 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.224, mb=0.496, no=0.996, corr=-0.143) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1455 -> 70.1456
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.1961 mb_mean=0.4911 norm_overlap=0.9956 corr_cb=-0.1602 topkJ=0.0279
[TRAIN][ep=048] loss=0.9048 acc=83.09%
[TRAIN][ep=048] mask_avg: mc_mean=0.2190 mb_mean=0.4961 norm_overlap=0.9965 corr_cb=-0.1376
[EPOCH 048/089] train: loss=0.9048 acc=83.09% | val: loss=0.7250 acc=67.47% f1=75.68% auc=72.09% val_score=50.2896 val_score_bestthr=70.6939 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.219, mb=0.496, no=0.996, corr=-0.138) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1455 -> 70.6939
[DBG][ep=049] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.2996 mb_mean=0.4972 norm_overlap=0.9926 corr_cb=-0.3048 topkJ=0.0170
[TRAIN][ep=049] loss=0.9556 acc=84.70%
[TRAIN][ep=049] mask_avg: mc_mean=0.2257 mb_mean=0.4961 norm_overlap=0.9962 corr_cb=-0.1532
[EPOCH 049/089] train: loss=0.9556 acc=84.70% | val: loss=0.8562 acc=66.27% f1=74.07% auc=72.09% val_score=42.3631 val_score_bestthr=68.1838 | dyn(w_pfs=0.100, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.226, mb=0.496, no=0.996, corr=-0.153) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1455 -> 68.1838
[DBG][ep=050] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.1703 mb_mean=0.4927 norm_overlap=0.9946 corr_cb=-0.1421 topkJ=0.0433
[TRAIN][ep=050] loss=0.6239 acc=85.77%
[TRAIN][ep=050] mask_avg: mc_mean=0.1744 mb_mean=0.4961 norm_overlap=0.9975 corr_cb=-0.0848
[EPOCH 050/089] train: loss=0.6239 acc=85.77% | val: loss=0.7313 acc=67.47% f1=75.23% auc=71.51% val_score=51.5249 val_score_bestthr=68.4520 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.174, mb=0.496, no=0.998, corr=-0.085) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1455 -> 68.4520
[DBG][ep=051] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.1905 mb_mean=0.5002 norm_overlap=0.9963 corr_cb=-0.1497 topkJ=0.0504
[TRAIN][ep=051] loss=0.5800 acc=87.52%
[TRAIN][ep=051] mask_avg: mc_mean=0.1744 mb_mean=0.4961 norm_overlap=0.9974 corr_cb=-0.0895
[EPOCH 051/089] train: loss=0.5800 acc=87.52% | val: loss=0.7343 acc=71.08% f1=74.47% auc=71.22% val_score=68.6601 val_score_bestthr=70.8863 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.174, mb=0.496, no=0.997, corr=-0.089) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1455 -> 70.8863
[DBG][ep=052] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.1851 mb_mean=0.4969 norm_overlap=1.0004 corr_cb=0.0123 topkJ=0.0709
[TRAIN][ep=052] loss=0.5837 acc=86.31%
[TRAIN][ep=052] mask_avg: mc_mean=0.1744 mb_mean=0.4961 norm_overlap=0.9974 corr_cb=-0.0881
[EPOCH 052/089] train: loss=0.5837 acc=86.31% | val: loss=0.7374 acc=71.08% f1=74.47% auc=71.22% val_score=65.2963 val_score_bestthr=70.8863 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.174, mb=0.496, no=0.997, corr=-0.088) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1455 -> 70.8863
[DBG][ep=053] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.1729 mb_mean=0.4951 norm_overlap=0.9982 corr_cb=-0.0578 topkJ=0.0584
[TRAIN][ep=053] loss=0.5805 acc=87.11%
[TRAIN][ep=053] mask_avg: mc_mean=0.1744 mb_mean=0.4961 norm_overlap=0.9974 corr_cb=-0.0891
[EPOCH 053/089] train: loss=0.5805 acc=87.11% | val: loss=0.7382 acc=71.08% f1=74.47% auc=71.74% val_score=59.1607 val_score_bestthr=70.8863 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.174, mb=0.496, no=0.997, corr=-0.089) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1455 -> 70.8863
[DBG][ep=054] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=054] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=054] mask(step0): mc_mean=0.1894 mb_mean=0.4949 norm_overlap=0.9995 corr_cb=-0.0162 topkJ=0.0600
[TRAIN][ep=054] loss=0.5767 acc=86.85%
[TRAIN][ep=054] mask_avg: mc_mean=0.1744 mb_mean=0.4961 norm_overlap=0.9974 corr_cb=-0.0872
[EPOCH 054/089] train: loss=0.5767 acc=86.85% | val: loss=0.7400 acc=71.08% f1=74.47% auc=71.45% val_score=59.1607 val_score_bestthr=70.8863 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.174, mb=0.496, no=0.997, corr=-0.087) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1455 -> 70.8863
[DBG][ep=055] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=055] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=055] mask(step0): mc_mean=0.1755 mb_mean=0.4943 norm_overlap=0.9974 corr_cb=-0.0745 topkJ=0.0475
[TRAIN][ep=055] loss=0.5775 acc=86.85%
[TRAIN][ep=055] mask_avg: mc_mean=0.1743 mb_mean=0.4961 norm_overlap=0.9975 corr_cb=-0.0845
[EPOCH 055/089] train: loss=0.5775 acc=86.85% | val: loss=0.7465 acc=69.88% f1=73.12% auc=71.80% val_score=52.6562 val_score_bestthr=70.1697 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.174, mb=0.496, no=0.998, corr=-0.085) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1455 -> 70.1697
[DBG][ep=056] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=056] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=056] mask(step0): mc_mean=0.1524 mb_mean=0.4941 norm_overlap=0.9978 corr_cb=-0.0741 topkJ=0.0578
[TRAIN][ep=056] loss=0.5747 acc=86.98%
[TRAIN][ep=056] mask_avg: mc_mean=0.1745 mb_mean=0.4961 norm_overlap=0.9975 corr_cb=-0.0848
[EPOCH 056/089] train: loss=0.5747 acc=86.98% | val: loss=0.7462 acc=69.88% f1=73.12% auc=71.69% val_score=59.0423 val_score_bestthr=70.1697 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.175, mb=0.496, no=0.997, corr=-0.085) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1455 -> 70.1697
[DBG][ep=057] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=057] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=057] mask(step0): mc_mean=0.2018 mb_mean=0.4963 norm_overlap=0.9952 corr_cb=-0.1669 topkJ=0.0283
[TRAIN][ep=057] loss=0.5740 acc=87.25%
[TRAIN][ep=057] mask_avg: mc_mean=0.1743 mb_mean=0.4961 norm_overlap=0.9975 corr_cb=-0.0839
[EPOCH 057/089] train: loss=0.5740 acc=87.25% | val: loss=0.7583 acc=67.47% f1=75.23% auc=71.80% val_score=51.0262 val_score_bestthr=68.4520 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.174, mb=0.496, no=0.997, corr=-0.084) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1455 -> 68.4520
[DBG][ep=058] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=058] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=058] mask(step0): mc_mean=0.1767 mb_mean=0.4953 norm_overlap=0.9983 corr_cb=-0.0529 topkJ=0.0561
[TRAIN][ep=058] loss=0.5721 acc=87.52%
[TRAIN][ep=058] mask_avg: mc_mean=0.1744 mb_mean=0.4961 norm_overlap=0.9975 corr_cb=-0.0856
[EPOCH 058/089] train: loss=0.5721 acc=87.52% | val: loss=0.7583 acc=71.08% f1=74.47% auc=71.34% val_score=59.1607 val_score_bestthr=70.8863 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.174, mb=0.496, no=0.997, corr=-0.086) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1455 -> 70.8863
[DBG][ep=059] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=059] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=059] mask(step0): mc_mean=0.1611 mb_mean=0.4976 norm_overlap=1.0026 corr_cb=0.0712 topkJ=0.0876
[TRAIN][ep=059] loss=0.5784 acc=86.58%
[TRAIN][ep=059] mask_avg: mc_mean=0.1744 mb_mean=0.4961 norm_overlap=0.9974 corr_cb=-0.0870
[EPOCH 059/089] train: loss=0.5784 acc=86.58% | val: loss=0.7651 acc=69.88% f1=73.12% auc=71.05% val_score=65.2963 val_score_bestthr=70.1697 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.174, mb=0.496, no=0.997, corr=-0.087) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1455 -> 70.1697
[DBG][ep=060] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=060] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=060] mask(step0): mc_mean=0.1712 mb_mean=0.4940 norm_overlap=0.9965 corr_cb=-0.1184 topkJ=0.0439
[TRAIN][ep=060] loss=0.5636 acc=87.25%
[TRAIN][ep=060] mask_avg: mc_mean=0.1744 mb_mean=0.4961 norm_overlap=0.9974 corr_cb=-0.0849
[EPOCH 060/089] train: loss=0.5636 acc=87.25% | val: loss=0.7658 acc=71.08% f1=74.47% auc=71.45% val_score=63.3532 val_score_bestthr=70.8863 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.174, mb=0.496, no=0.997, corr=-0.085) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1455 -> 70.8863
[DBG][ep=061] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=061] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=061] mask(step0): mc_mean=0.1660 mb_mean=0.4979 norm_overlap=0.9970 corr_cb=-0.0912 topkJ=0.0286
[TRAIN][ep=061] loss=0.5663 acc=87.92%
[TRAIN][ep=061] mask_avg: mc_mean=0.1743 mb_mean=0.4961 norm_overlap=0.9975 corr_cb=-0.0856
[EPOCH 061/089] train: loss=0.5663 acc=87.92% | val: loss=0.7775 acc=71.08% f1=74.47% auc=70.99% val_score=70.1697 val_score_bestthr=70.8863 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.174, mb=0.496, no=0.997, corr=-0.086) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1455 -> 70.8863
[DBG][ep=062] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=062] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=062] mask(step0): mc_mean=0.1842 mb_mean=0.4976 norm_overlap=0.9981 corr_cb=-0.0693 topkJ=0.0477
[TRAIN][ep=062] loss=0.5693 acc=88.46%
[TRAIN][ep=062] mask_avg: mc_mean=0.1743 mb_mean=0.4961 norm_overlap=0.9975 corr_cb=-0.0857
[EPOCH 062/089] train: loss=0.5693 acc=88.46% | val: loss=0.7646 acc=71.08% f1=74.47% auc=71.63% val_score=59.0423 val_score_bestthr=70.8863 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.174, mb=0.496, no=0.998, corr=-0.086) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1455 -> 70.8863
[DBG][ep=063] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=063] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=063] mask(step0): mc_mean=0.1524 mb_mean=0.4929 norm_overlap=0.9990 corr_cb=-0.0282 topkJ=0.0377
[TRAIN][ep=063] loss=0.5645 acc=88.46%
[TRAIN][ep=063] mask_avg: mc_mean=0.1744 mb_mean=0.4961 norm_overlap=0.9974 corr_cb=-0.0867
[EPOCH 063/089] train: loss=0.5645 acc=88.46% | val: loss=0.7689 acc=69.88% f1=73.12% auc=71.34% val_score=63.3532 val_score_bestthr=70.1697 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.174, mb=0.496, no=0.997, corr=-0.087) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1455 -> 70.1697
[DBG][ep=064] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=064] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=064] mask(step0): mc_mean=0.1828 mb_mean=0.4956 norm_overlap=0.9988 corr_cb=-0.0446 topkJ=0.0571
[TRAIN][ep=064] loss=0.5662 acc=87.38%
[TRAIN][ep=064] mask_avg: mc_mean=0.1744 mb_mean=0.4961 norm_overlap=0.9974 corr_cb=-0.0853
[EPOCH 064/089] train: loss=0.5662 acc=87.38% | val: loss=0.7761 acc=69.88% f1=73.12% auc=70.87% val_score=70.1697 val_score_bestthr=70.1697 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.174, mb=0.496, no=0.997, corr=-0.085) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1455 -> 70.1697
[DBG][ep=065] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=065] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=065] mask(step0): mc_mean=0.1716 mb_mean=0.4990 norm_overlap=0.9981 corr_cb=-0.0615 topkJ=0.0604
[TRAIN][ep=065] loss=0.5638 acc=87.52%
[TRAIN][ep=065] mask_avg: mc_mean=0.1744 mb_mean=0.4961 norm_overlap=0.9974 corr_cb=-0.0887
[EPOCH 065/089] train: loss=0.5638 acc=87.52% | val: loss=0.7708 acc=71.08% f1=74.47% auc=71.40% val_score=59.0423 val_score_bestthr=70.8863 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.174, mb=0.496, no=0.997, corr=-0.089) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1455 -> 70.8863
[DBG][ep=066] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=066] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=066] mask(step0): mc_mean=0.1898 mb_mean=0.4943 norm_overlap=0.9952 corr_cb=-0.1562 topkJ=0.0323
[TRAIN][ep=066] loss=0.5599 acc=86.98%
[TRAIN][ep=066] mask_avg: mc_mean=0.1744 mb_mean=0.4961 norm_overlap=0.9975 corr_cb=-0.0823
[EPOCH 066/089] train: loss=0.5599 acc=86.98% | val: loss=0.7826 acc=67.47% f1=70.97% auc=71.22% val_score=51.0262 val_score_bestthr=69.3346 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.174, mb=0.496, no=0.998, corr=-0.082) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1455 -> 69.3346
[DBG][ep=067] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=067] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=067] mask(step0): mc_mean=0.1911 mb_mean=0.4977 norm_overlap=0.9968 corr_cb=-0.1232 topkJ=0.0559
[TRAIN][ep=067] loss=0.5611 acc=87.52%
[TRAIN][ep=067] mask_avg: mc_mean=0.1744 mb_mean=0.4961 norm_overlap=0.9975 corr_cb=-0.0847
[EPOCH 067/089] train: loss=0.5611 acc=87.52% | val: loss=0.7820 acc=69.88% f1=73.68% auc=71.45% val_score=51.0262 val_score_bestthr=71.2295 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.174, mb=0.496, no=0.997, corr=-0.085) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1455 -> 71.2295
[DBG][ep=068] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=068] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=068] mask(step0): mc_mean=0.1798 mb_mean=0.4924 norm_overlap=0.9981 corr_cb=-0.0533 topkJ=0.0362
[TRAIN][ep=068] loss=0.5537 acc=87.38%
[TRAIN][ep=068] mask_avg: mc_mean=0.1744 mb_mean=0.4961 norm_overlap=0.9974 corr_cb=-0.0859
[EPOCH 068/089] train: loss=0.5537 acc=87.38% | val: loss=0.7920 acc=67.47% f1=70.97% auc=71.80% val_score=54.1887 val_score_bestthr=69.3346 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.174, mb=0.496, no=0.997, corr=-0.086) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1455 -> 69.3346
[DBG][ep=069] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=069] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=069] mask(step0): mc_mean=0.1781 mb_mean=0.4951 norm_overlap=1.0018 corr_cb=0.0562 topkJ=0.0908
[TRAIN][ep=069] loss=0.5576 acc=87.65%
[TRAIN][ep=069] mask_avg: mc_mean=0.1744 mb_mean=0.4961 norm_overlap=0.9975 corr_cb=-0.0855
[EPOCH 069/089] train: loss=0.5576 acc=87.65% | val: loss=0.7852 acc=68.67% f1=71.74% auc=71.34% val_score=51.0262 val_score_bestthr=68.6601 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.174, mb=0.496, no=0.997, corr=-0.086) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1455 -> 68.6601
[DBG][ep=070] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=070] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=070] mask(step0): mc_mean=0.1776 mb_mean=0.4997 norm_overlap=0.9982 corr_cb=-0.0619 topkJ=0.0538
[TRAIN][ep=070] loss=0.5600 acc=87.25%
[TRAIN][ep=070] mask_avg: mc_mean=0.1744 mb_mean=0.4961 norm_overlap=0.9974 corr_cb=-0.0864
[EPOCH 070/089] train: loss=0.5600 acc=87.25% | val: loss=0.8003 acc=71.08% f1=74.47% auc=70.64% val_score=70.8863 val_score_bestthr=70.8863 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.174, mb=0.496, no=0.997, corr=-0.086) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1455 -> 70.8863
[DBG][ep=071] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=071] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=071] mask(step0): mc_mean=0.1369 mb_mean=0.4955 norm_overlap=0.9957 corr_cb=-0.1463 topkJ=0.0392
[TRAIN][ep=071] loss=0.5586 acc=86.98%
[TRAIN][ep=071] mask_avg: mc_mean=0.1744 mb_mean=0.4961 norm_overlap=0.9974 corr_cb=-0.0865
[EPOCH 071/089] train: loss=0.5586 acc=86.98% | val: loss=0.7849 acc=71.08% f1=74.47% auc=71.40% val_score=59.0423 val_score_bestthr=70.8863 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.174, mb=0.496, no=0.997, corr=-0.086) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1455 -> 70.8863
[DBG][ep=072] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=072] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=072] mask(step0): mc_mean=0.1572 mb_mean=0.4934 norm_overlap=0.9921 corr_cb=-0.2713 topkJ=0.0181
[TRAIN][ep=072] loss=0.5420 acc=88.19%
[TRAIN][ep=072] mask_avg: mc_mean=0.1744 mb_mean=0.4961 norm_overlap=0.9975 corr_cb=-0.0853
[EPOCH 072/089] train: loss=0.5420 acc=88.19% | val: loss=0.7977 acc=69.88% f1=73.68% auc=71.40% val_score=50.9075 val_score_bestthr=71.2295 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.174, mb=0.496, no=0.997, corr=-0.085) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1455 -> 71.2295
[DBG][ep=073] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=073] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=073] mask(step0): mc_mean=0.1622 mb_mean=0.4953 norm_overlap=0.9988 corr_cb=-0.0419 topkJ=0.0459
[TRAIN][ep=073] loss=0.5456 acc=88.05%
[TRAIN][ep=073] mask_avg: mc_mean=0.1744 mb_mean=0.4961 norm_overlap=0.9975 corr_cb=-0.0856
[EPOCH 073/089] train: loss=0.5456 acc=88.05% | val: loss=0.7971 acc=69.88% f1=73.68% auc=71.34% val_score=59.0423 val_score_bestthr=71.2295 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.174, mb=0.496, no=0.997, corr=-0.086) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1455 -> 71.2295
[DBG][ep=074] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=074] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=074] mask(step0): mc_mean=0.1792 mb_mean=0.4948 norm_overlap=0.9952 corr_cb=-0.1395 topkJ=0.0428
[TRAIN][ep=074] loss=0.5574 acc=87.38%
[TRAIN][ep=074] mask_avg: mc_mean=0.1743 mb_mean=0.4961 norm_overlap=0.9975 corr_cb=-0.0866
[EPOCH 074/089] train: loss=0.5574 acc=87.38% | val: loss=0.8208 acc=71.08% f1=74.47% auc=70.23% val_score=70.1456 val_score_bestthr=70.8863 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.174, mb=0.496, no=0.997, corr=-0.087) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1455 -> 70.8863
[EARLY STOP] no improvement for 30 epochs. best_epoch=44
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
=============== FIT DONE ===============
[BEST] epoch=44 | val_acc=69.88% | val_f1=74.23% | val_auc=71.28% | val_score=63.2216 | val_score_bestthr=74.1455
[TEST@BEST] thr_used=0.325 | acc=62.80% f1=69.80% auc=64.01% | SP_sex=19.97% EO_sex=14.06% SP_age=13.69% EO_age=14.16%
[TIME] 1.72 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/summary_fold_2.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4477 mb_mean=0.4964 norm_overlap=1.0006 corr_cb=0.6199 topkJ=0.1849
[TRAIN][ep=000] loss=0.6951 acc=47.25%
[TRAIN][ep=000] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5111
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4378 mb_mean=0.4940 norm_overlap=1.0005 corr_cb=0.5338 topkJ=0.1816
[TRAIN][ep=001] loss=0.6926 acc=50.74%
[TRAIN][ep=001] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5175
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4517 mb_mean=0.4988 norm_overlap=1.0004 corr_cb=0.4909 topkJ=0.1226
[TRAIN][ep=002] loss=0.6926 acc=52.21%
[TRAIN][ep=002] mask_avg: mc_mean=0.4463 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5077
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4474 mb_mean=0.4963 norm_overlap=1.0004 corr_cb=0.4696 topkJ=0.1653
[TRAIN][ep=003] loss=0.6924 acc=52.75%
[TRAIN][ep=003] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5044
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4425 mb_mean=0.4921 norm_overlap=1.0010 corr_cb=0.7152 topkJ=0.2130
[TRAIN][ep=004] loss=0.6910 acc=52.62%
[TRAIN][ep=004] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5027
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4529 mb_mean=0.4986 norm_overlap=1.0003 corr_cb=0.4542 topkJ=0.1703
[TRAIN][ep=005] loss=0.6877 acc=57.58%
[TRAIN][ep=005] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5020
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4536 mb_mean=0.4984 norm_overlap=1.0003 corr_cb=0.3933 topkJ=0.1356
[TRAIN][ep=006] loss=0.6858 acc=57.99%
[TRAIN][ep=006] mask_avg: mc_mean=0.4463 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5030
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4543 mb_mean=0.4986 norm_overlap=1.0005 corr_cb=0.5123 topkJ=0.1231
[TRAIN][ep=007] loss=0.6832 acc=55.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5158
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4444 mb_mean=0.4958 norm_overlap=1.0005 corr_cb=0.5646 topkJ=0.1270
[TRAIN][ep=008] loss=0.6779 acc=56.51%
[TRAIN][ep=008] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5070
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4465 mb_mean=0.4969 norm_overlap=1.0003 corr_cb=0.4721 topkJ=0.1699
[TRAIN][ep=009] loss=0.6742 acc=62.01%
[TRAIN][ep=009] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5069
================= FIT START (fold=2) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4558 mb_mean=0.5004 norm_overlap=1.0002 corr_cb=0.3859 topkJ=0.1398
[TRAIN][ep=000] loss=0.6720 acc=59.33%
[TRAIN][ep=000] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5085
[EPOCH 000/089] train: loss=0.6720 acc=59.33% | val: loss=0.6776 acc=66.27% f1=67.44% auc=65.12% val_score=46.1149 val_score_bestthr=65.4959 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.446, mb=0.496, no=1.000, corr=0.509) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 65.4959
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4538 mb_mean=0.4979 norm_overlap=1.0003 corr_cb=0.4016 topkJ=0.2040
[TRAIN][ep=001] loss=0.6663 acc=62.95%
[TRAIN][ep=001] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5121
[EPOCH 001/089] train: loss=0.6663 acc=62.95% | val: loss=0.6657 acc=66.27% f1=69.57% auc=68.90% val_score=57.5615 val_score_bestthr=65.5986 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.446, mb=0.496, no=1.001, corr=0.512) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 65.4959 -> 65.5986
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4475 mb_mean=0.4963 norm_overlap=1.0004 corr_cb=0.4390 topkJ=0.0795
[TRAIN][ep=002] loss=0.6612 acc=63.49%
[TRAIN][ep=002] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5046
[EPOCH 002/089] train: loss=0.6612 acc=63.49% | val: loss=0.6613 acc=69.88% f1=70.59% auc=69.01% val_score=55.2066 val_score_bestthr=68.8390 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.446, mb=0.496, no=1.000, corr=0.505) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 65.5986 -> 68.8390
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4442 mb_mean=0.4982 norm_overlap=1.0006 corr_cb=0.5457 topkJ=0.1279
[TRAIN][ep=003] loss=0.6621 acc=61.88%
[TRAIN][ep=003] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5061
[EPOCH 003/089] train: loss=0.6621 acc=61.88% | val: loss=0.6595 acc=67.47% f1=69.66% auc=69.07% val_score=50.4387 val_score_bestthr=66.0988 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.446, mb=0.496, no=1.000, corr=0.506) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 66.0988
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4474 mb_mean=0.4978 norm_overlap=1.0003 corr_cb=0.4220 topkJ=0.0832
[TRAIN][ep=004] loss=0.6506 acc=62.01%
[TRAIN][ep=004] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5086
[EPOCH 004/089] train: loss=0.6506 acc=62.01% | val: loss=0.6534 acc=67.47% f1=68.97% auc=69.83% val_score=54.9266 val_score_bestthr=66.3074 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.446, mb=0.496, no=1.001, corr=0.509) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 66.3074
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4503 mb_mean=0.4974 norm_overlap=1.0004 corr_cb=0.4973 topkJ=0.1639
[TRAIN][ep=005] loss=1.5334 acc=62.55%
[TRAIN][ep=005] mask_avg: mc_mean=0.3280 mb_mean=0.4961 norm_overlap=1.0022 corr_cb=0.5215
[EPOCH 005/089] train: loss=1.5334 acc=62.55% | val: loss=0.6934 acc=68.67% f1=65.79% auc=66.74% val_score=39.9279 val_score_bestthr=65.8721 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.328, mb=0.496, no=1.002, corr=0.521) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 65.8721
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2605 mb_mean=0.4955 norm_overlap=1.0033 corr_cb=0.4789 topkJ=0.1464
[TRAIN][ep=006] loss=1.5088 acc=64.56%
[TRAIN][ep=006] mask_avg: mc_mean=0.2453 mb_mean=0.4961 norm_overlap=1.0030 corr_cb=0.4095
[EPOCH 006/089] train: loss=1.5088 acc=64.56% | val: loss=0.6484 acc=66.27% f1=64.10% auc=70.99% val_score=65.8299 val_score_bestthr=66.8936 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.245, mb=0.496, no=1.003, corr=0.410) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 66.8936
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2066 mb_mean=0.4933 norm_overlap=1.0038 corr_cb=0.4542 topkJ=0.2116
[TRAIN][ep=007] loss=1.4967 acc=64.30%
[TRAIN][ep=007] mask_avg: mc_mean=0.2247 mb_mean=0.4961 norm_overlap=1.0025 corr_cb=0.2874
[EPOCH 007/089] train: loss=1.4967 acc=64.30% | val: loss=0.6515 acc=66.27% f1=73.08% auc=70.87% val_score=61.6504 val_score_bestthr=68.4967 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.225, mb=0.496, no=1.002, corr=0.287) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 68.4967
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1463 mb_mean=0.4919 norm_overlap=1.0018 corr_cb=0.2097 topkJ=0.1383
[TRAIN][ep=008] loss=1.2332 acc=68.05%
[TRAIN][ep=008] mask_avg: mc_mean=0.2017 mb_mean=0.4961 norm_overlap=1.0020 corr_cb=0.1933
[EPOCH 008/089] train: loss=1.2332 acc=68.05% | val: loss=0.6387 acc=65.06% f1=65.06% auc=70.76% val_score=62.5225 val_score_bestthr=65.7804 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.202, mb=0.496, no=1.002, corr=0.193) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 65.7804
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2080 mb_mean=0.4948 norm_overlap=1.0040 corr_cb=0.3211 topkJ=0.0749
[TRAIN][ep=009] loss=0.9752 acc=65.91%
[TRAIN][ep=009] mask_avg: mc_mean=0.1833 mb_mean=0.4961 norm_overlap=1.0012 corr_cb=0.0873
[EPOCH 009/089] train: loss=0.9752 acc=65.91% | val: loss=0.6408 acc=65.06% f1=73.39% auc=70.76% val_score=65.0471 val_score_bestthr=65.8299 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.183, mb=0.496, no=1.001, corr=0.087) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 65.8299
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1792 mb_mean=0.4972 norm_overlap=0.9992 corr_cb=-0.0710 topkJ=0.0544
[TRAIN][ep=010] loss=0.9038 acc=66.31%
[TRAIN][ep=010] mask_avg: mc_mean=0.1898 mb_mean=0.4961 norm_overlap=1.0001 corr_cb=0.0002
[EPOCH 010/089] train: loss=0.9038 acc=66.31% | val: loss=0.6287 acc=67.47% f1=68.97% auc=71.22% val_score=65.1939 val_score_bestthr=66.3074 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.496, no=1.000, corr=0.000) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 66.3074
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1750 mb_mean=0.4971 norm_overlap=1.0016 corr_cb=0.1146 topkJ=0.0473
[TRAIN][ep=011] loss=0.8682 acc=69.66%
[TRAIN][ep=011] mask_avg: mc_mean=0.1764 mb_mean=0.4961 norm_overlap=0.9996 corr_cb=-0.0297
[EPOCH 011/089] train: loss=0.8682 acc=69.66% | val: loss=0.7318 acc=67.47% f1=64.94% auc=67.21% val_score=37.1849 val_score_bestthr=67.1908 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.176, mb=0.496, no=1.000, corr=-0.030) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 67.1908
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1580 mb_mean=0.4951 norm_overlap=0.9974 corr_cb=-0.1579 topkJ=0.0244
[TRAIN][ep=012] loss=0.8816 acc=68.05%
[TRAIN][ep=012] mask_avg: mc_mean=0.1451 mb_mean=0.4961 norm_overlap=1.0000 corr_cb=-0.0194
[EPOCH 012/089] train: loss=0.8816 acc=68.05% | val: loss=0.6258 acc=65.06% f1=73.87% auc=71.69% val_score=61.4342 val_score_bestthr=68.7451 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.145, mb=0.496, no=1.000, corr=-0.019) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 68.7451
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.0861 mb_mean=0.4969 norm_overlap=0.9999 corr_cb=-0.0024 topkJ=0.0467
[TRAIN][ep=013] loss=0.8550 acc=70.34%
[TRAIN][ep=013] mask_avg: mc_mean=0.1144 mb_mean=0.4961 norm_overlap=0.9997 corr_cb=-0.0244
[EPOCH 013/089] train: loss=0.8550 acc=70.34% | val: loss=0.6224 acc=68.67% f1=70.45% auc=72.09% val_score=69.8352 val_score_bestthr=69.8352 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.114, mb=0.496, no=1.000, corr=-0.024) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 68.8390 -> 69.8352
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1618 mb_mean=0.4985 norm_overlap=0.9965 corr_cb=-0.1873 topkJ=0.0289
[TRAIN][ep=014] loss=0.9560 acc=70.20%
[TRAIN][ep=014] mask_avg: mc_mean=0.1470 mb_mean=0.4961 norm_overlap=0.9976 corr_cb=-0.1183
[EPOCH 014/089] train: loss=0.9560 acc=70.20% | val: loss=0.6151 acc=66.27% f1=68.89% auc=72.15% val_score=63.6411 val_score_bestthr=68.7286 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.147, mb=0.496, no=0.998, corr=-0.118) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.8352 -> 68.7286
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1669 mb_mean=0.4977 norm_overlap=0.9990 corr_cb=-0.0382 topkJ=0.0759
[TRAIN][ep=015] loss=1.0504 acc=68.05%
[TRAIN][ep=015] mask_avg: mc_mean=0.1345 mb_mean=0.4961 norm_overlap=0.9978 corr_cb=-0.0988
[EPOCH 015/089] train: loss=1.0504 acc=68.05% | val: loss=0.6355 acc=71.08% f1=71.43% auc=72.67% val_score=52.5831 val_score_bestthr=73.3782 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.134, mb=0.496, no=0.998, corr=-0.099) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 69.8352 -> 73.3782
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1794 mb_mean=0.4984 norm_overlap=0.9908 corr_cb=-0.4175 topkJ=0.0100
[TRAIN][ep=016] loss=1.1350 acc=72.35%
[TRAIN][ep=016] mask_avg: mc_mean=0.1487 mb_mean=0.4961 norm_overlap=0.9968 corr_cb=-0.1380
[EPOCH 016/089] train: loss=1.1350 acc=72.35% | val: loss=0.6124 acc=69.88% f1=71.26% auc=73.26% val_score=69.0239 val_score_bestthr=71.3757 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.149, mb=0.496, no=0.997, corr=-0.138) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.3782 -> 71.3757
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1230 mb_mean=0.4972 norm_overlap=0.9987 corr_cb=-0.0561 topkJ=0.0588
[TRAIN][ep=017] loss=1.2354 acc=72.35%
[TRAIN][ep=017] mask_avg: mc_mean=0.1323 mb_mean=0.4961 norm_overlap=0.9971 corr_cb=-0.1095
[EPOCH 017/089] train: loss=1.2354 acc=72.35% | val: loss=0.7315 acc=71.08% f1=72.73% auc=72.67% val_score=46.9534 val_score_bestthr=70.9180 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.132, mb=0.496, no=0.997, corr=-0.109) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.3782 -> 70.9180
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1381 mb_mean=0.4952 norm_overlap=0.9978 corr_cb=-0.0803 topkJ=0.0391
[TRAIN][ep=018] loss=1.3275 acc=71.28%
[TRAIN][ep=018] mask_avg: mc_mean=0.1497 mb_mean=0.4961 norm_overlap=0.9963 corr_cb=-0.1484
[EPOCH 018/089] train: loss=1.3275 acc=71.28% | val: loss=0.6359 acc=72.29% f1=75.79% auc=73.72% val_score=50.8730 val_score_bestthr=74.1317 | dyn(w_pfs=0.240, w_sup=0.240, w_csuf=0.200, stage2=False) | mask(mc=0.150, mb=0.496, no=0.996, corr=-0.148) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 73.3782 -> 74.1317
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1490 mb_mean=0.4952 norm_overlap=0.9961 corr_cb=-0.1250 topkJ=0.0243
[TRAIN][ep=019] loss=1.3588 acc=71.14%
[TRAIN][ep=019] mask_avg: mc_mean=0.1326 mb_mean=0.4961 norm_overlap=0.9969 corr_cb=-0.1152
[EPOCH 019/089] train: loss=1.3588 acc=71.14% | val: loss=0.6241 acc=66.27% f1=72.00% auc=72.50% val_score=67.0091 val_score_bestthr=69.5319 | dyn(w_pfs=0.280, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.133, mb=0.496, no=0.997, corr=-0.115) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 69.5319
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1627 mb_mean=0.4987 norm_overlap=0.9950 corr_cb=-0.2279 topkJ=0.0335
[TRAIN][ep=020] loss=1.3613 acc=73.69%
[TRAIN][ep=020] mask_avg: mc_mean=0.1553 mb_mean=0.4961 norm_overlap=0.9964 corr_cb=-0.1434
[EPOCH 020/089] train: loss=1.3613 acc=73.69% | val: loss=0.6112 acc=67.47% f1=71.58% auc=73.14% val_score=67.9202 val_score_bestthr=69.4458 | dyn(w_pfs=0.320, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.155, mb=0.496, no=0.996, corr=-0.143) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 69.4458
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.1345 mb_mean=0.5007 norm_overlap=0.9944 corr_cb=-0.2008 topkJ=0.0193
[TRAIN][ep=021] loss=1.3578 acc=72.89%
[TRAIN][ep=021] mask_avg: mc_mean=0.1631 mb_mean=0.4961 norm_overlap=0.9962 corr_cb=-0.1518
[EPOCH 021/089] train: loss=1.3578 acc=72.89% | val: loss=0.6279 acc=69.88% f1=73.12% auc=72.91% val_score=67.0091 val_score_bestthr=70.3364 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.163, mb=0.496, no=0.996, corr=-0.152) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 70.3364
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1645 mb_mean=0.4922 norm_overlap=1.0004 corr_cb=0.0133 topkJ=0.0678
[TRAIN][ep=022] loss=1.3621 acc=76.64%
[TRAIN][ep=022] mask_avg: mc_mean=0.1453 mb_mean=0.4961 norm_overlap=0.9967 corr_cb=-0.1232
[EPOCH 022/089] train: loss=1.3621 acc=76.64% | val: loss=0.6206 acc=68.67% f1=72.34% auc=72.97% val_score=65.6950 val_score_bestthr=69.8899 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.145, mb=0.496, no=0.997, corr=-0.123) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 69.8899
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1609 mb_mean=0.4973 norm_overlap=0.9944 corr_cb=-0.2133 topkJ=0.0182
[TRAIN][ep=023] loss=1.3587 acc=73.69%
[TRAIN][ep=023] mask_avg: mc_mean=0.1394 mb_mean=0.4961 norm_overlap=0.9965 corr_cb=-0.1224
[EPOCH 023/089] train: loss=1.3587 acc=73.69% | val: loss=0.6377 acc=72.29% f1=74.73% auc=73.08% val_score=53.5389 val_score_bestthr=73.6325 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.139, mb=0.496, no=0.996, corr=-0.122) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 73.6325
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1691 mb_mean=0.4928 norm_overlap=0.9970 corr_cb=-0.1057 topkJ=0.0816
[TRAIN][ep=024] loss=1.1387 acc=71.68%
[TRAIN][ep=024] mask_avg: mc_mean=0.1509 mb_mean=0.4961 norm_overlap=0.9964 corr_cb=-0.1305
[EPOCH 024/089] train: loss=1.1387 acc=71.68% | val: loss=0.6182 acc=69.88% f1=73.12% auc=73.14% val_score=67.5169 val_score_bestthr=71.4203 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.151, mb=0.496, no=0.996, corr=-0.131) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 71.4203
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1175 mb_mean=0.4964 norm_overlap=0.9950 corr_cb=-0.1345 topkJ=0.0336
[TRAIN][ep=025] loss=0.8741 acc=73.96%
[TRAIN][ep=025] mask_avg: mc_mean=0.1378 mb_mean=0.4961 norm_overlap=0.9962 corr_cb=-0.1330
[EPOCH 025/089] train: loss=0.8741 acc=73.96% | val: loss=0.6052 acc=69.88% f1=73.12% auc=73.49% val_score=65.3226 val_score_bestthr=71.4203 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.138, mb=0.496, no=0.996, corr=-0.133) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 71.4203
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1406 mb_mean=0.4934 norm_overlap=1.0021 corr_cb=0.0586 topkJ=0.0373
[TRAIN][ep=026] loss=0.7870 acc=76.64%
[TRAIN][ep=026] mask_avg: mc_mean=0.1688 mb_mean=0.4961 norm_overlap=0.9960 corr_cb=-0.1539
[EPOCH 026/089] train: loss=0.7870 acc=76.64% | val: loss=0.6205 acc=67.47% f1=71.58% auc=72.97% val_score=66.4268 val_score_bestthr=69.1525 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.169, mb=0.496, no=0.996, corr=-0.154) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 69.1525
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1718 mb_mean=0.4995 norm_overlap=0.9964 corr_cb=-0.1431 topkJ=0.0250
[TRAIN][ep=027] loss=0.7729 acc=75.30%
[TRAIN][ep=027] mask_avg: mc_mean=0.1631 mb_mean=0.4961 norm_overlap=0.9965 corr_cb=-0.1305
[EPOCH 027/089] train: loss=0.7729 acc=75.30% | val: loss=0.6358 acc=69.88% f1=73.68% auc=73.55% val_score=54.8446 val_score_bestthr=70.1456 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.163, mb=0.496, no=0.996, corr=-0.130) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 70.1456
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1855 mb_mean=0.4920 norm_overlap=0.9992 corr_cb=-0.0341 topkJ=0.0520
[TRAIN][ep=028] loss=0.7584 acc=75.70%
[TRAIN][ep=028] mask_avg: mc_mean=0.1812 mb_mean=0.4961 norm_overlap=0.9962 corr_cb=-0.1477
[EPOCH 028/089] train: loss=0.7584 acc=75.70% | val: loss=0.6494 acc=67.47% f1=74.77% auc=72.91% val_score=64.9112 val_score_bestthr=68.9386 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.181, mb=0.496, no=0.996, corr=-0.148) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 68.9386
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.1651 mb_mean=0.4915 norm_overlap=0.9996 corr_cb=-0.0145 topkJ=0.0593
[TRAIN][ep=029] loss=0.7501 acc=77.18%
[TRAIN][ep=029] mask_avg: mc_mean=0.1782 mb_mean=0.4961 norm_overlap=0.9966 corr_cb=-0.1371
[EPOCH 029/089] train: loss=0.7501 acc=77.18% | val: loss=0.6303 acc=68.67% f1=72.34% auc=72.91% val_score=64.8973 val_score_bestthr=70.6805 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.178, mb=0.496, no=0.997, corr=-0.137) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 70.6805
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2144 mb_mean=0.4964 norm_overlap=0.9958 corr_cb=-0.1893 topkJ=0.0498
[TRAIN][ep=030] loss=0.7424 acc=77.58%
[TRAIN][ep=030] mask_avg: mc_mean=0.2055 mb_mean=0.4961 norm_overlap=0.9961 corr_cb=-0.1649
[EPOCH 030/089] train: loss=0.7424 acc=77.58% | val: loss=0.6284 acc=68.67% f1=75.93% auc=74.13% val_score=60.7322 val_score_bestthr=71.6173 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.206, mb=0.496, no=0.996, corr=-0.165) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 71.6173
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.1480 mb_mean=0.4928 norm_overlap=0.9998 corr_cb=-0.0054 topkJ=0.0603
[TRAIN][ep=031] loss=0.7381 acc=77.85%
[TRAIN][ep=031] mask_avg: mc_mean=0.1652 mb_mean=0.4961 norm_overlap=0.9969 corr_cb=-0.1117
[EPOCH 031/089] train: loss=0.7381 acc=77.85% | val: loss=0.6335 acc=66.27% f1=74.07% auc=73.08% val_score=57.4434 val_score_bestthr=69.6610 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.165, mb=0.496, no=0.997, corr=-0.112) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 69.6610
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1781 mb_mean=0.4973 norm_overlap=1.0004 corr_cb=0.0164 topkJ=0.0666
[TRAIN][ep=032] loss=0.7257 acc=77.85%
[TRAIN][ep=032] mask_avg: mc_mean=0.1815 mb_mean=0.4961 norm_overlap=0.9969 corr_cb=-0.1192
[EPOCH 032/089] train: loss=0.7257 acc=77.85% | val: loss=0.7684 acc=67.47% f1=75.23% auc=72.97% val_score=40.4927 val_score_bestthr=68.6579 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.181, mb=0.496, no=0.997, corr=-0.119) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 68.6579
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2205 mb_mean=0.4971 norm_overlap=0.9982 corr_cb=-0.0935 topkJ=0.0415
[TRAIN][ep=033] loss=0.7323 acc=77.99%
[TRAIN][ep=033] mask_avg: mc_mean=0.2025 mb_mean=0.4961 norm_overlap=0.9962 corr_cb=-0.1530
[EPOCH 033/089] train: loss=0.7323 acc=77.99% | val: loss=0.6550 acc=67.47% f1=74.77% auc=73.31% val_score=56.6749 val_score_bestthr=70.0586 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.202, mb=0.496, no=0.996, corr=-0.153) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 70.0586
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1380 mb_mean=0.4943 norm_overlap=0.9969 corr_cb=-0.1137 topkJ=0.0462
[TRAIN][ep=034] loss=0.7094 acc=78.66%
[TRAIN][ep=034] mask_avg: mc_mean=0.1931 mb_mean=0.4961 norm_overlap=0.9968 corr_cb=-0.1263
[EPOCH 034/089] train: loss=0.7094 acc=78.66% | val: loss=0.6834 acc=71.08% f1=75.00% auc=72.03% val_score=73.4713 val_score_bestthr=73.4713 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.193, mb=0.496, no=0.997, corr=-0.126) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 73.4713
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.1904 mb_mean=0.4949 norm_overlap=0.9964 corr_cb=-0.1503 topkJ=0.0514
[TRAIN][ep=035] loss=0.7008 acc=80.13%
[TRAIN][ep=035] mask_avg: mc_mean=0.1863 mb_mean=0.4961 norm_overlap=0.9974 corr_cb=-0.0984
[EPOCH 035/089] train: loss=0.7008 acc=80.13% | val: loss=0.6892 acc=68.67% f1=75.47% auc=72.56% val_score=66.7535 val_score_bestthr=70.4582 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.186, mb=0.496, no=0.997, corr=-0.098) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 70.4582
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2013 mb_mean=0.4988 norm_overlap=0.9973 corr_cb=-0.1056 topkJ=0.0341
[TRAIN][ep=036] loss=0.7207 acc=77.45%
[TRAIN][ep=036] mask_avg: mc_mean=0.2417 mb_mean=0.4961 norm_overlap=0.9958 corr_cb=-0.1860
[EPOCH 036/089] train: loss=0.7207 acc=77.45% | val: loss=0.6490 acc=69.88% f1=73.12% auc=72.33% val_score=65.9539 val_score_bestthr=70.1697 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.242, mb=0.496, no=0.996, corr=-0.186) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 70.1697
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1924 mb_mean=0.4955 norm_overlap=0.9964 corr_cb=-0.1203 topkJ=0.0566
[TRAIN][ep=037] loss=0.7008 acc=79.60%
[TRAIN][ep=037] mask_avg: mc_mean=0.1911 mb_mean=0.4961 norm_overlap=0.9968 corr_cb=-0.1217
[EPOCH 037/089] train: loss=0.7008 acc=79.60% | val: loss=0.6821 acc=67.47% f1=73.79% auc=73.37% val_score=50.0246 val_score_bestthr=68.7196 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.191, mb=0.496, no=0.997, corr=-0.122) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 68.7196
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.1483 mb_mean=0.4959 norm_overlap=0.9979 corr_cb=-0.0750 topkJ=0.0440
[TRAIN][ep=038] loss=0.6812 acc=80.54%
[TRAIN][ep=038] mask_avg: mc_mean=0.2157 mb_mean=0.4961 norm_overlap=0.9959 corr_cb=-0.1615
[EPOCH 038/089] train: loss=0.6812 acc=80.54% | val: loss=0.6741 acc=69.88% f1=73.12% auc=72.09% val_score=70.1456 val_score_bestthr=71.4203 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.216, mb=0.496, no=0.996, corr=-0.161) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 71.4203
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2565 mb_mean=0.4995 norm_overlap=0.9914 corr_cb=-0.3356 topkJ=0.0202
[TRAIN][ep=039] loss=0.6952 acc=79.19%
[TRAIN][ep=039] mask_avg: mc_mean=0.1906 mb_mean=0.4961 norm_overlap=0.9967 corr_cb=-0.1222
[EPOCH 039/089] train: loss=0.6952 acc=79.19% | val: loss=0.6575 acc=67.47% f1=74.77% auc=72.79% val_score=65.7433 val_score_bestthr=70.0586 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.191, mb=0.496, no=0.997, corr=-0.122) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 70.0586
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.2169 mb_mean=0.4932 norm_overlap=0.9953 corr_cb=-0.2155 topkJ=0.0264
[TRAIN][ep=040] loss=0.6755 acc=80.67%
[TRAIN][ep=040] mask_avg: mc_mean=0.1966 mb_mean=0.4961 norm_overlap=0.9970 corr_cb=-0.1183
[EPOCH 040/089] train: loss=0.6755 acc=80.67% | val: loss=0.6787 acc=68.67% f1=75.47% auc=73.26% val_score=61.2575 val_score_bestthr=69.0170 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.197, mb=0.496, no=0.997, corr=-0.118) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 69.0170
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.0890 mb_mean=0.4935 norm_overlap=1.0068 corr_cb=0.1355 topkJ=0.1008
[TRAIN][ep=041] loss=0.6740 acc=80.00%
[TRAIN][ep=041] mask_avg: mc_mean=0.1948 mb_mean=0.4961 norm_overlap=0.9970 corr_cb=-0.1213
[EPOCH 041/089] train: loss=0.6740 acc=80.00% | val: loss=0.6698 acc=71.08% f1=74.47% auc=72.79% val_score=70.1697 val_score_bestthr=70.8863 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.195, mb=0.496, no=0.997, corr=-0.121) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 70.8863
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.1910 mb_mean=0.4948 norm_overlap=1.0002 corr_cb=0.0062 topkJ=0.0424
[TRAIN][ep=042] loss=0.6750 acc=81.07%
[TRAIN][ep=042] mask_avg: mc_mean=0.2123 mb_mean=0.4961 norm_overlap=0.9967 corr_cb=-0.1327
[EPOCH 042/089] train: loss=0.6750 acc=81.07% | val: loss=0.7107 acc=67.47% f1=73.27% auc=72.62% val_score=47.2549 val_score_bestthr=68.7622 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.212, mb=0.496, no=0.997, corr=-0.133) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 68.7622
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.1558 mb_mean=0.4973 norm_overlap=0.9988 corr_cb=-0.0341 topkJ=0.0304
[TRAIN][ep=043] loss=0.6538 acc=82.95%
[TRAIN][ep=043] mask_avg: mc_mean=0.2007 mb_mean=0.4961 norm_overlap=0.9963 corr_cb=-0.1406
[EPOCH 043/089] train: loss=0.6538 acc=82.95% | val: loss=0.7515 acc=67.47% f1=74.77% auc=72.56% val_score=44.4718 val_score_bestthr=68.6174 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.201, mb=0.496, no=0.996, corr=-0.141) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 68.6174
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2499 mb_mean=0.4990 norm_overlap=0.9958 corr_cb=-0.2045 topkJ=0.0384
[TRAIN][ep=044] loss=0.6683 acc=81.74%
[TRAIN][ep=044] mask_avg: mc_mean=0.2055 mb_mean=0.4961 norm_overlap=0.9965 corr_cb=-0.1320
[EPOCH 044/089] train: loss=0.6683 acc=81.74% | val: loss=0.6830 acc=69.88% f1=73.68% auc=71.45% val_score=63.2216 val_score_bestthr=70.1456 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.206, mb=0.496, no=0.997, corr=-0.132) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 70.1456
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2867 mb_mean=0.4928 norm_overlap=0.9943 corr_cb=-0.2650 topkJ=0.0273
[TRAIN][ep=045] loss=0.6654 acc=81.21%
[TRAIN][ep=045] mask_avg: mc_mean=0.2558 mb_mean=0.4961 norm_overlap=0.9954 corr_cb=-0.2014
[EPOCH 045/089] train: loss=0.6654 acc=81.21% | val: loss=0.7626 acc=71.08% f1=74.47% auc=71.98% val_score=66.9180 val_score_bestthr=70.5930 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.256, mb=0.496, no=0.995, corr=-0.201) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 70.5930
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.1685 mb_mean=0.4987 norm_overlap=0.9949 corr_cb=-0.1830 topkJ=0.0541
[TRAIN][ep=046] loss=0.6599 acc=80.94%
[TRAIN][ep=046] mask_avg: mc_mean=0.1920 mb_mean=0.4961 norm_overlap=0.9971 corr_cb=-0.1078
[EPOCH 046/089] train: loss=0.6599 acc=80.94% | val: loss=0.7212 acc=67.47% f1=75.23% auc=72.97% val_score=47.8334 val_score_bestthr=69.7779 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.192, mb=0.496, no=0.997, corr=-0.108) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 69.7779
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.2549 mb_mean=0.4993 norm_overlap=0.9977 corr_cb=-0.1014 topkJ=0.0523
[TRAIN][ep=047] loss=0.6378 acc=82.55%
[TRAIN][ep=047] mask_avg: mc_mean=0.2289 mb_mean=0.4961 norm_overlap=0.9963 corr_cb=-0.1464
[EPOCH 047/089] train: loss=0.6378 acc=82.55% | val: loss=0.7880 acc=69.88% f1=73.68% auc=70.23% val_score=65.9112 val_score_bestthr=70.1456 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.229, mb=0.496, no=0.996, corr=-0.146) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 70.1456
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.2033 mb_mean=0.4911 norm_overlap=0.9956 corr_cb=-0.1646 topkJ=0.0275
[TRAIN][ep=048] loss=0.6348 acc=83.22%
[TRAIN][ep=048] mask_avg: mc_mean=0.2214 mb_mean=0.4961 norm_overlap=0.9966 corr_cb=-0.1330
[EPOCH 048/089] train: loss=0.6348 acc=83.22% | val: loss=0.7239 acc=69.88% f1=75.73% auc=72.03% val_score=53.5843 val_score_bestthr=69.5727 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.221, mb=0.496, no=0.997, corr=-0.133) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 69.5727
[EARLY STOP] no improvement for 30 epochs. best_epoch=18
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
=============== FIT DONE ===============
[BEST] epoch=18 | val_acc=72.29% | val_f1=75.79% | val_auc=73.72% | val_score=50.8730 | val_score_bestthr=74.1317
[TEST@BEST] thr_used=0.260 | acc=58.45% f1=67.91% auc=61.67% | SP_sex=12.41% EO_sex=11.71% SP_age=15.30% EO_age=15.45%
[TIME] 1.30 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/summary_fold_2.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4477 mb_mean=0.4964 norm_overlap=1.0006 corr_cb=0.6199 topkJ=0.1849
[TRAIN][ep=000] loss=0.6951 acc=47.25%
[TRAIN][ep=000] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5111
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4378 mb_mean=0.4940 norm_overlap=1.0005 corr_cb=0.5338 topkJ=0.1816
[TRAIN][ep=001] loss=0.6926 acc=50.74%
[TRAIN][ep=001] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5175
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4517 mb_mean=0.4988 norm_overlap=1.0004 corr_cb=0.4909 topkJ=0.1226
[TRAIN][ep=002] loss=0.6926 acc=52.21%
[TRAIN][ep=002] mask_avg: mc_mean=0.4463 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5077
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4474 mb_mean=0.4963 norm_overlap=1.0004 corr_cb=0.4696 topkJ=0.1653
[TRAIN][ep=003] loss=0.6924 acc=52.75%
[TRAIN][ep=003] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5044
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4425 mb_mean=0.4921 norm_overlap=1.0010 corr_cb=0.7152 topkJ=0.2130
[TRAIN][ep=004] loss=0.6910 acc=52.48%
[TRAIN][ep=004] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5027
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4529 mb_mean=0.4986 norm_overlap=1.0003 corr_cb=0.4542 topkJ=0.1703
[TRAIN][ep=005] loss=0.6877 acc=57.58%
[TRAIN][ep=005] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5020
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4536 mb_mean=0.4984 norm_overlap=1.0003 corr_cb=0.3933 topkJ=0.1356
[TRAIN][ep=006] loss=0.6858 acc=57.99%
[TRAIN][ep=006] mask_avg: mc_mean=0.4463 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5030
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4543 mb_mean=0.4986 norm_overlap=1.0005 corr_cb=0.5123 topkJ=0.1231
[TRAIN][ep=007] loss=0.6832 acc=55.84%
[TRAIN][ep=007] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5158
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4444 mb_mean=0.4958 norm_overlap=1.0005 corr_cb=0.5646 topkJ=0.1270
[TRAIN][ep=008] loss=0.6779 acc=56.51%
[TRAIN][ep=008] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5070
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4465 mb_mean=0.4969 norm_overlap=1.0003 corr_cb=0.4721 topkJ=0.1699
[TRAIN][ep=009] loss=0.6742 acc=61.74%
[TRAIN][ep=009] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5069
================= FIT START (fold=2) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4558 mb_mean=0.5004 norm_overlap=1.0002 corr_cb=0.3859 topkJ=0.1398
[TRAIN][ep=000] loss=0.6720 acc=59.06%
[TRAIN][ep=000] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5085
[EPOCH 000/089] train: loss=0.6720 acc=59.06% | val: loss=0.6777 acc=66.27% f1=67.44% auc=65.17% val_score=46.1149 val_score_bestthr=65.4959 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.446, mb=0.496, no=1.000, corr=0.509) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 65.4959
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4538 mb_mean=0.4979 norm_overlap=1.0003 corr_cb=0.4016 topkJ=0.2040
[TRAIN][ep=001] loss=0.6664 acc=63.09%
[TRAIN][ep=001] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5121
[EPOCH 001/089] train: loss=0.6664 acc=63.09% | val: loss=0.6657 acc=66.27% f1=69.57% auc=68.90% val_score=56.9781 val_score_bestthr=65.5986 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.446, mb=0.496, no=1.001, corr=0.512) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 65.4959 -> 65.5986
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4475 mb_mean=0.4963 norm_overlap=1.0004 corr_cb=0.4390 topkJ=0.0795
[TRAIN][ep=002] loss=0.6612 acc=63.49%
[TRAIN][ep=002] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5046
[EPOCH 002/089] train: loss=0.6612 acc=63.49% | val: loss=0.6613 acc=69.88% f1=70.59% auc=68.84% val_score=57.5322 val_score_bestthr=68.8390 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.446, mb=0.496, no=1.000, corr=0.505) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 65.5986 -> 68.8390
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4442 mb_mean=0.4982 norm_overlap=1.0006 corr_cb=0.5457 topkJ=0.1279
[TRAIN][ep=003] loss=0.6622 acc=61.48%
[TRAIN][ep=003] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5061
[EPOCH 003/089] train: loss=0.6622 acc=61.48% | val: loss=0.6594 acc=67.47% f1=69.66% auc=69.07% val_score=50.4387 val_score_bestthr=66.0988 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.446, mb=0.496, no=1.000, corr=0.506) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 66.0988
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4474 mb_mean=0.4978 norm_overlap=1.0003 corr_cb=0.4220 topkJ=0.0832
[TRAIN][ep=004] loss=0.6505 acc=62.01%
[TRAIN][ep=004] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5086
[EPOCH 004/089] train: loss=0.6505 acc=62.01% | val: loss=0.6534 acc=67.47% f1=68.97% auc=69.59% val_score=54.9266 val_score_bestthr=66.3074 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.446, mb=0.496, no=1.001, corr=0.509) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 66.3074
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4503 mb_mean=0.4974 norm_overlap=1.0004 corr_cb=0.4973 topkJ=0.1639
[TRAIN][ep=005] loss=1.4738 acc=62.82%
[TRAIN][ep=005] mask_avg: mc_mean=0.3271 mb_mean=0.4961 norm_overlap=1.0022 corr_cb=0.5201
[EPOCH 005/089] train: loss=1.4738 acc=62.82% | val: loss=0.6933 acc=65.06% f1=64.20% auc=66.92% val_score=39.9279 val_score_bestthr=63.4400 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.327, mb=0.496, no=1.002, corr=0.520) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 63.4400
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2599 mb_mean=0.4955 norm_overlap=1.0033 corr_cb=0.4769 topkJ=0.1454
[TRAIN][ep=006] loss=1.4505 acc=64.83%
[TRAIN][ep=006] mask_avg: mc_mean=0.2448 mb_mean=0.4961 norm_overlap=1.0030 corr_cb=0.4064
[EPOCH 006/089] train: loss=1.4505 acc=64.83% | val: loss=0.6484 acc=66.27% f1=64.10% auc=70.87% val_score=65.8299 val_score_bestthr=66.8936 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.245, mb=0.496, no=1.003, corr=0.406) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 66.8936
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2057 mb_mean=0.4933 norm_overlap=1.0038 corr_cb=0.4513 topkJ=0.2099
[TRAIN][ep=007] loss=1.4383 acc=64.16%
[TRAIN][ep=007] mask_avg: mc_mean=0.2242 mb_mean=0.4961 norm_overlap=1.0025 corr_cb=0.2841
[EPOCH 007/089] train: loss=1.4383 acc=64.16% | val: loss=0.6517 acc=66.27% f1=73.08% auc=70.87% val_score=61.6504 val_score_bestthr=68.4967 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.224, mb=0.496, no=1.002, corr=0.284) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 68.4967
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1454 mb_mean=0.4919 norm_overlap=1.0018 corr_cb=0.2064 topkJ=0.1383
[TRAIN][ep=008] loss=1.1982 acc=67.92%
[TRAIN][ep=008] mask_avg: mc_mean=0.2008 mb_mean=0.4961 norm_overlap=1.0020 corr_cb=0.1903
[EPOCH 008/089] train: loss=1.1982 acc=67.92% | val: loss=0.6389 acc=65.06% f1=72.90% auc=70.58% val_score=62.5225 val_score_bestthr=67.2210 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.201, mb=0.496, no=1.002, corr=0.190) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 67.2210
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2076 mb_mean=0.4948 norm_overlap=1.0040 corr_cb=0.3180 topkJ=0.0744
[TRAIN][ep=009] loss=0.9633 acc=65.64%
[TRAIN][ep=009] mask_avg: mc_mean=0.1825 mb_mean=0.4961 norm_overlap=1.0012 corr_cb=0.0855
[EPOCH 009/089] train: loss=0.9633 acc=65.64% | val: loss=0.6399 acc=65.06% f1=73.39% auc=70.52% val_score=65.0471 val_score_bestthr=65.8299 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.183, mb=0.496, no=1.001, corr=0.086) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 65.8299
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1772 mb_mean=0.4972 norm_overlap=0.9992 corr_cb=-0.0699 topkJ=0.0548
[TRAIN][ep=010] loss=0.9034 acc=66.58%
[TRAIN][ep=010] mask_avg: mc_mean=0.1878 mb_mean=0.4961 norm_overlap=1.0001 corr_cb=0.0006
[EPOCH 010/089] train: loss=0.9034 acc=66.58% | val: loss=0.6291 acc=67.47% f1=68.97% auc=71.05% val_score=65.1939 val_score_bestthr=66.3074 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.188, mb=0.496, no=1.000, corr=0.001) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 66.3074
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1738 mb_mean=0.4971 norm_overlap=1.0016 corr_cb=0.1125 topkJ=0.0473
[TRAIN][ep=011] loss=0.8680 acc=70.07%
[TRAIN][ep=011] mask_avg: mc_mean=0.1761 mb_mean=0.4961 norm_overlap=0.9996 corr_cb=-0.0311
[EPOCH 011/089] train: loss=0.8680 acc=70.07% | val: loss=0.7322 acc=67.47% f1=64.94% auc=67.15% val_score=37.1849 val_score_bestthr=67.1908 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.176, mb=0.496, no=1.000, corr=-0.031) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 67.1908
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1570 mb_mean=0.4951 norm_overlap=0.9974 corr_cb=-0.1577 topkJ=0.0244
[TRAIN][ep=012] loss=0.8817 acc=68.05%
[TRAIN][ep=012] mask_avg: mc_mean=0.1450 mb_mean=0.4961 norm_overlap=1.0000 corr_cb=-0.0198
[EPOCH 012/089] train: loss=0.8817 acc=68.05% | val: loss=0.6260 acc=65.06% f1=73.87% auc=71.80% val_score=61.4342 val_score_bestthr=68.7451 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.145, mb=0.496, no=1.000, corr=-0.020) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 68.7451
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.0855 mb_mean=0.4969 norm_overlap=1.0000 corr_cb=-0.0004 topkJ=0.0480
[TRAIN][ep=013] loss=0.8545 acc=70.20%
[TRAIN][ep=013] mask_avg: mc_mean=0.1148 mb_mean=0.4961 norm_overlap=0.9997 corr_cb=-0.0245
[EPOCH 013/089] train: loss=0.8545 acc=70.20% | val: loss=0.6224 acc=68.67% f1=69.05% auc=71.98% val_score=68.7206 val_score_bestthr=68.8824 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.115, mb=0.496, no=1.000, corr=-0.025) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 68.8390 -> 68.8824
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1643 mb_mean=0.4985 norm_overlap=0.9965 corr_cb=-0.1916 topkJ=0.0285
[TRAIN][ep=014] loss=0.9464 acc=69.40%
[TRAIN][ep=014] mask_avg: mc_mean=0.1482 mb_mean=0.4961 norm_overlap=0.9976 corr_cb=-0.1190
[EPOCH 014/089] train: loss=0.9464 acc=69.40% | val: loss=0.6155 acc=66.27% f1=68.89% auc=71.86% val_score=66.7126 val_score_bestthr=68.7286 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.148, mb=0.496, no=0.998, corr=-0.119) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8824 -> 68.7286
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1672 mb_mean=0.4977 norm_overlap=0.9990 corr_cb=-0.0375 topkJ=0.0763
[TRAIN][ep=015] loss=1.0317 acc=67.92%
[TRAIN][ep=015] mask_avg: mc_mean=0.1350 mb_mean=0.4961 norm_overlap=0.9978 corr_cb=-0.0980
[EPOCH 015/089] train: loss=1.0317 acc=67.92% | val: loss=0.6337 acc=71.08% f1=72.09% auc=72.73% val_score=52.5831 val_score_bestthr=74.6637 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.135, mb=0.496, no=0.998, corr=-0.098) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 68.8824 -> 74.6637
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1802 mb_mean=0.4984 norm_overlap=0.9909 corr_cb=-0.4160 topkJ=0.0100
[TRAIN][ep=016] loss=1.1068 acc=72.21%
[TRAIN][ep=016] mask_avg: mc_mean=0.1504 mb_mean=0.4961 norm_overlap=0.9968 corr_cb=-0.1384
[EPOCH 016/089] train: loss=1.1068 acc=72.21% | val: loss=0.6126 acc=69.88% f1=71.26% auc=72.85% val_score=63.8228 val_score_bestthr=71.3757 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.150, mb=0.496, no=0.997, corr=-0.138) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 71.3757
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1261 mb_mean=0.4972 norm_overlap=0.9987 corr_cb=-0.0613 topkJ=0.0570
[TRAIN][ep=017] loss=1.1982 acc=72.08%
[TRAIN][ep=017] mask_avg: mc_mean=0.1342 mb_mean=0.4961 norm_overlap=0.9972 corr_cb=-0.1102
[EPOCH 017/089] train: loss=1.1982 acc=72.08% | val: loss=0.7303 acc=72.29% f1=72.94% auc=72.67% val_score=46.9534 val_score_bestthr=71.9029 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.134, mb=0.496, no=0.997, corr=-0.110) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 71.9029
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1387 mb_mean=0.4952 norm_overlap=0.9979 corr_cb=-0.0775 topkJ=0.0404
[TRAIN][ep=018] loss=1.2808 acc=71.28%
[TRAIN][ep=018] mask_avg: mc_mean=0.1501 mb_mean=0.4961 norm_overlap=0.9963 corr_cb=-0.1467
[EPOCH 018/089] train: loss=1.2808 acc=71.28% | val: loss=0.6368 acc=72.29% f1=75.79% auc=73.55% val_score=50.8730 val_score_bestthr=74.1317 | dyn(w_pfs=0.240, w_sup=0.240, w_csuf=0.200, stage2=False) | mask(mc=0.150, mb=0.496, no=0.996, corr=-0.147) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 74.1317
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1475 mb_mean=0.4952 norm_overlap=0.9963 corr_cb=-0.1185 topkJ=0.0239
[TRAIN][ep=019] loss=1.3036 acc=71.54%
[TRAIN][ep=019] mask_avg: mc_mean=0.1323 mb_mean=0.4961 norm_overlap=0.9969 corr_cb=-0.1128
[EPOCH 019/089] train: loss=1.3036 acc=71.54% | val: loss=0.6244 acc=66.27% f1=72.00% auc=72.62% val_score=66.7595 val_score_bestthr=69.5319 | dyn(w_pfs=0.280, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.132, mb=0.496, no=0.997, corr=-0.113) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 69.5319
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1609 mb_mean=0.4987 norm_overlap=0.9951 corr_cb=-0.2241 topkJ=0.0335
[TRAIN][ep=020] loss=1.3033 acc=73.69%
[TRAIN][ep=020] mask_avg: mc_mean=0.1556 mb_mean=0.4961 norm_overlap=0.9965 corr_cb=-0.1418
[EPOCH 020/089] train: loss=1.3033 acc=73.69% | val: loss=0.6120 acc=67.47% f1=71.58% auc=73.26% val_score=69.4458 val_score_bestthr=69.4458 | dyn(w_pfs=0.180, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.156, mb=0.496, no=0.996, corr=-0.142) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 69.4458
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.1354 mb_mean=0.5007 norm_overlap=0.9945 corr_cb=-0.2011 topkJ=0.0189
[TRAIN][ep=021] loss=1.0647 acc=73.02%
[TRAIN][ep=021] mask_avg: mc_mean=0.1639 mb_mean=0.4961 norm_overlap=0.9962 corr_cb=-0.1510
[EPOCH 021/089] train: loss=1.0647 acc=73.02% | val: loss=0.6305 acc=69.88% f1=73.12% auc=73.31% val_score=67.0091 val_score_bestthr=70.3364 | dyn(w_pfs=0.080, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.164, mb=0.496, no=0.996, corr=-0.151) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 70.3364
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1677 mb_mean=0.4922 norm_overlap=1.0004 corr_cb=0.0147 topkJ=0.0669
[TRAIN][ep=022] loss=0.8349 acc=76.24%
[TRAIN][ep=022] mask_avg: mc_mean=0.1498 mb_mean=0.4961 norm_overlap=0.9967 corr_cb=-0.1270
[EPOCH 022/089] train: loss=0.8349 acc=76.24% | val: loss=0.6217 acc=71.08% f1=73.91% auc=72.97% val_score=64.0505 val_score_bestthr=72.0969 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.150, mb=0.496, no=0.997, corr=-0.127) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 72.0969
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1547 mb_mean=0.4973 norm_overlap=0.9948 corr_cb=-0.1980 topkJ=0.0210
[TRAIN][ep=023] loss=0.7890 acc=74.09%
[TRAIN][ep=023] mask_avg: mc_mean=0.1425 mb_mean=0.4961 norm_overlap=0.9964 corr_cb=-0.1262
[EPOCH 023/089] train: loss=0.7890 acc=74.09% | val: loss=0.6373 acc=73.49% f1=76.09% auc=72.56% val_score=52.4288 val_score_bestthr=73.1003 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.142, mb=0.496, no=0.996, corr=-0.126) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 73.1003
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1654 mb_mean=0.4928 norm_overlap=0.9971 corr_cb=-0.1022 topkJ=0.0853
[TRAIN][ep=024] loss=0.8155 acc=71.81%
[TRAIN][ep=024] mask_avg: mc_mean=0.1561 mb_mean=0.4961 norm_overlap=0.9962 corr_cb=-0.1411
[EPOCH 024/089] train: loss=0.8155 acc=71.81% | val: loss=0.6172 acc=69.88% f1=73.12% auc=73.72% val_score=69.0402 val_score_bestthr=71.4203 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.156, mb=0.496, no=0.996, corr=-0.141) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 71.4203
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1239 mb_mean=0.4964 norm_overlap=0.9949 corr_cb=-0.1440 topkJ=0.0327
[TRAIN][ep=025] loss=0.7997 acc=74.36%
[TRAIN][ep=025] mask_avg: mc_mean=0.1487 mb_mean=0.4961 norm_overlap=0.9958 corr_cb=-0.1537
[EPOCH 025/089] train: loss=0.7997 acc=74.36% | val: loss=0.6064 acc=73.49% f1=75.56% auc=73.31% val_score=65.4911 val_score_bestthr=73.8233 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.149, mb=0.496, no=0.996, corr=-0.154) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 73.8233
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1416 mb_mean=0.4934 norm_overlap=1.0019 corr_cb=0.0557 topkJ=0.0352
[TRAIN][ep=026] loss=0.7770 acc=76.24%
[TRAIN][ep=026] mask_avg: mc_mean=0.1675 mb_mean=0.4961 norm_overlap=0.9960 corr_cb=-0.1570
[EPOCH 026/089] train: loss=0.7770 acc=76.24% | val: loss=0.6219 acc=68.67% f1=72.34% auc=73.26% val_score=70.6805 val_score_bestthr=70.6805 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.168, mb=0.496, no=0.996, corr=-0.157) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 70.6805
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1722 mb_mean=0.4995 norm_overlap=0.9962 corr_cb=-0.1530 topkJ=0.0246
[TRAIN][ep=027] loss=0.7769 acc=75.57%
[TRAIN][ep=027] mask_avg: mc_mean=0.1625 mb_mean=0.4961 norm_overlap=0.9963 corr_cb=-0.1368
[EPOCH 027/089] train: loss=0.7769 acc=75.57% | val: loss=0.6377 acc=72.29% f1=74.16% auc=73.55% val_score=54.8446 val_score_bestthr=69.3838 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.162, mb=0.496, no=0.996, corr=-0.137) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 69.3838
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1855 mb_mean=0.4920 norm_overlap=0.9991 corr_cb=-0.0388 topkJ=0.0501
[TRAIN][ep=028] loss=0.7621 acc=75.44%
[TRAIN][ep=028] mask_avg: mc_mean=0.1799 mb_mean=0.4961 norm_overlap=0.9961 corr_cb=-0.1537
[EPOCH 028/089] train: loss=0.7621 acc=75.44% | val: loss=0.6469 acc=67.47% f1=74.77% auc=73.02% val_score=66.2883 val_score_bestthr=68.9386 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.180, mb=0.496, no=0.996, corr=-0.154) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 68.9386
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.1550 mb_mean=0.4915 norm_overlap=0.9998 corr_cb=-0.0050 topkJ=0.0562
[TRAIN][ep=029] loss=0.7523 acc=77.32%
[TRAIN][ep=029] mask_avg: mc_mean=0.1753 mb_mean=0.4961 norm_overlap=0.9965 corr_cb=-0.1409
[EPOCH 029/089] train: loss=0.7523 acc=77.32% | val: loss=0.6309 acc=69.88% f1=74.23% auc=73.02% val_score=64.8973 val_score_bestthr=72.5107 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.175, mb=0.496, no=0.996, corr=-0.141) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 72.5107
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2168 mb_mean=0.4964 norm_overlap=0.9955 corr_cb=-0.2027 topkJ=0.0494
[TRAIN][ep=030] loss=0.7459 acc=77.99%
[TRAIN][ep=030] mask_avg: mc_mean=0.2095 mb_mean=0.4961 norm_overlap=0.9959 corr_cb=-0.1793
[EPOCH 030/089] train: loss=0.7459 acc=77.99% | val: loss=0.6306 acc=68.67% f1=75.47% auc=73.95% val_score=62.2600 val_score_bestthr=71.5782 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.209, mb=0.496, no=0.996, corr=-0.179) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 71.5782
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.1481 mb_mean=0.4928 norm_overlap=0.9996 corr_cb=-0.0123 topkJ=0.0594
[TRAIN][ep=031] loss=0.7425 acc=78.12%
[TRAIN][ep=031] mask_avg: mc_mean=0.1635 mb_mean=0.4961 norm_overlap=0.9968 corr_cb=-0.1183
[EPOCH 031/089] train: loss=0.7425 acc=78.12% | val: loss=0.6340 acc=66.27% f1=74.07% auc=73.31% val_score=51.8343 val_score_bestthr=69.6610 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.164, mb=0.496, no=0.997, corr=-0.118) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 69.6610
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1772 mb_mean=0.4973 norm_overlap=1.0000 corr_cb=-0.0003 topkJ=0.0621
[TRAIN][ep=032] loss=0.7290 acc=77.58%
[TRAIN][ep=032] mask_avg: mc_mean=0.1823 mb_mean=0.4961 norm_overlap=0.9967 corr_cb=-0.1286
[EPOCH 032/089] train: loss=0.7290 acc=77.58% | val: loss=0.7677 acc=67.47% f1=75.23% auc=72.85% val_score=40.4927 val_score_bestthr=68.6579 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.182, mb=0.496, no=0.997, corr=-0.129) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 68.6579
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2322 mb_mean=0.4971 norm_overlap=0.9980 corr_cb=-0.1130 topkJ=0.0385
[TRAIN][ep=033] loss=0.7366 acc=77.32%
[TRAIN][ep=033] mask_avg: mc_mean=0.2044 mb_mean=0.4961 norm_overlap=0.9961 corr_cb=-0.1620
[EPOCH 033/089] train: loss=0.7366 acc=77.32% | val: loss=0.6543 acc=67.47% f1=74.77% auc=73.26% val_score=56.6749 val_score_bestthr=70.0586 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.204, mb=0.496, no=0.996, corr=-0.162) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 70.0586
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1404 mb_mean=0.4943 norm_overlap=0.9967 corr_cb=-0.1245 topkJ=0.0428
[TRAIN][ep=034] loss=0.7141 acc=78.39%
[TRAIN][ep=034] mask_avg: mc_mean=0.1919 mb_mean=0.4961 norm_overlap=0.9967 corr_cb=-0.1315
[EPOCH 034/089] train: loss=0.7141 acc=78.39% | val: loss=0.6818 acc=71.08% f1=75.00% auc=72.15% val_score=73.4713 val_score_bestthr=73.4713 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.192, mb=0.496, no=0.997, corr=-0.131) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 73.4713
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.1880 mb_mean=0.4949 norm_overlap=0.9965 corr_cb=-0.1472 topkJ=0.0510
[TRAIN][ep=035] loss=0.7045 acc=80.27%
[TRAIN][ep=035] mask_avg: mc_mean=0.1847 mb_mean=0.4961 norm_overlap=0.9973 corr_cb=-0.1019
[EPOCH 035/089] train: loss=0.7045 acc=80.27% | val: loss=0.6896 acc=68.67% f1=75.47% auc=72.56% val_score=66.7535 val_score_bestthr=70.4582 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.185, mb=0.496, no=0.997, corr=-0.102) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 70.4582
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.1997 mb_mean=0.4988 norm_overlap=0.9972 corr_cb=-0.1116 topkJ=0.0333
[TRAIN][ep=036] loss=0.7259 acc=77.18%
[TRAIN][ep=036] mask_avg: mc_mean=0.2441 mb_mean=0.4961 norm_overlap=0.9957 corr_cb=-0.1951
[EPOCH 036/089] train: loss=0.7259 acc=77.18% | val: loss=0.6515 acc=71.08% f1=75.00% auc=72.62% val_score=68.6601 val_score_bestthr=73.4713 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.244, mb=0.496, no=0.996, corr=-0.195) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 73.4713
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1913 mb_mean=0.4955 norm_overlap=0.9963 corr_cb=-0.1239 topkJ=0.0553
[TRAIN][ep=037] loss=0.7055 acc=78.79%
[TRAIN][ep=037] mask_avg: mc_mean=0.1908 mb_mean=0.4961 norm_overlap=0.9966 corr_cb=-0.1278
[EPOCH 037/089] train: loss=0.7055 acc=78.79% | val: loss=0.6847 acc=68.67% f1=75.00% auc=73.02% val_score=50.0246 val_score_bestthr=67.7409 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.191, mb=0.496, no=0.997, corr=-0.128) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 67.7409
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.1601 mb_mean=0.4959 norm_overlap=0.9974 corr_cb=-0.1007 topkJ=0.0409
[TRAIN][ep=038] loss=0.6866 acc=80.13%
[TRAIN][ep=038] mask_avg: mc_mean=0.2129 mb_mean=0.4961 norm_overlap=0.9959 corr_cb=-0.1630
[EPOCH 038/089] train: loss=0.6866 acc=80.13% | val: loss=0.6740 acc=71.08% f1=75.00% auc=72.27% val_score=70.1456 val_score_bestthr=73.4713 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.213, mb=0.496, no=0.996, corr=-0.163) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 73.4713
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2514 mb_mean=0.4995 norm_overlap=0.9914 corr_cb=-0.3359 topkJ=0.0186
[TRAIN][ep=039] loss=0.7011 acc=79.46%
[TRAIN][ep=039] mask_avg: mc_mean=0.1917 mb_mean=0.4961 norm_overlap=0.9966 corr_cb=-0.1284
[EPOCH 039/089] train: loss=0.7011 acc=79.46% | val: loss=0.6575 acc=67.47% f1=74.77% auc=72.85% val_score=65.7433 val_score_bestthr=70.0586 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.192, mb=0.496, no=0.997, corr=-0.128) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 70.0586
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.2225 mb_mean=0.4932 norm_overlap=0.9953 corr_cb=-0.2254 topkJ=0.0252
[TRAIN][ep=040] loss=0.6799 acc=80.00%
[TRAIN][ep=040] mask_avg: mc_mean=0.1972 mb_mean=0.4961 norm_overlap=0.9969 corr_cb=-0.1233
[EPOCH 040/089] train: loss=0.6799 acc=80.00% | val: loss=0.6837 acc=68.67% f1=75.47% auc=73.08% val_score=47.2529 val_score_bestthr=69.0170 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.197, mb=0.496, no=0.997, corr=-0.123) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 69.0170
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.0932 mb_mean=0.4935 norm_overlap=1.0061 corr_cb=0.1266 topkJ=0.0975
[TRAIN][ep=041] loss=0.6780 acc=80.27%
[TRAIN][ep=041] mask_avg: mc_mean=0.1945 mb_mean=0.4961 norm_overlap=0.9969 corr_cb=-0.1245
[EPOCH 041/089] train: loss=0.6780 acc=80.27% | val: loss=0.6697 acc=69.88% f1=73.12% auc=72.56% val_score=65.9539 val_score_bestthr=70.1697 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.194, mb=0.496, no=0.997, corr=-0.125) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 70.1697
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.1953 mb_mean=0.4948 norm_overlap=1.0000 corr_cb=0.0018 topkJ=0.0433
[TRAIN][ep=042] loss=0.6802 acc=80.81%
[TRAIN][ep=042] mask_avg: mc_mean=0.2116 mb_mean=0.4961 norm_overlap=0.9967 corr_cb=-0.1343
[EPOCH 042/089] train: loss=0.6802 acc=80.81% | val: loss=0.7113 acc=67.47% f1=72.73% auc=72.44% val_score=47.2549 val_score_bestthr=69.3430 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.212, mb=0.496, no=0.997, corr=-0.134) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 69.3430
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.1566 mb_mean=0.4973 norm_overlap=0.9985 corr_cb=-0.0430 topkJ=0.0296
[TRAIN][ep=043] loss=0.6594 acc=82.82%
[TRAIN][ep=043] mask_avg: mc_mean=0.1998 mb_mean=0.4961 norm_overlap=0.9962 corr_cb=-0.1428
[EPOCH 043/089] train: loss=0.6594 acc=82.82% | val: loss=0.7539 acc=68.67% f1=75.00% auc=72.79% val_score=44.4718 val_score_bestthr=66.2997 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.200, mb=0.496, no=0.996, corr=-0.143) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 66.2997
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2561 mb_mean=0.4990 norm_overlap=0.9957 corr_cb=-0.2158 topkJ=0.0342
[TRAIN][ep=044] loss=0.6732 acc=81.34%
[TRAIN][ep=044] mask_avg: mc_mean=0.2072 mb_mean=0.4961 norm_overlap=0.9965 corr_cb=-0.1366
[EPOCH 044/089] train: loss=0.6732 acc=81.34% | val: loss=0.6856 acc=68.67% f1=73.47% auc=71.22% val_score=61.3619 val_score_bestthr=72.6181 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.207, mb=0.496, no=0.996, corr=-0.137) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 72.6181
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.3038 mb_mean=0.4928 norm_overlap=0.9941 corr_cb=-0.2881 topkJ=0.0236
[TRAIN][ep=045] loss=0.6715 acc=80.94%
[TRAIN][ep=045] mask_avg: mc_mean=0.2580 mb_mean=0.4961 norm_overlap=0.9954 corr_cb=-0.2058
[EPOCH 045/089] train: loss=0.6715 acc=80.94% | val: loss=0.7645 acc=69.88% f1=73.68% auc=71.86% val_score=67.2407 val_score_bestthr=70.1456 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.258, mb=0.496, no=0.995, corr=-0.206) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 70.1456
[EARLY STOP] no improvement for 30 epochs. best_epoch=15
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
=============== FIT DONE ===============
[BEST] epoch=15 | val_acc=71.08% | val_f1=72.09% | val_auc=72.73% | val_score=52.5831 | val_score_bestthr=74.6637
[TEST@BEST] thr_used=0.475 | acc=61.84% f1=58.20% auc=62.59% | SP_sex=10.20% EO_sex=18.43% SP_age=13.72% EO_age=16.23%
[TIME] 1.24 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/summary_fold_2.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4477 mb_mean=0.4964 norm_overlap=1.0006 corr_cb=0.6199 topkJ=0.1849
[TRAIN][ep=000] loss=0.6951 acc=47.25%
[TRAIN][ep=000] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5111
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4378 mb_mean=0.4940 norm_overlap=1.0005 corr_cb=0.5338 topkJ=0.1816
[TRAIN][ep=001] loss=0.6926 acc=50.74%
[TRAIN][ep=001] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5175
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4517 mb_mean=0.4988 norm_overlap=1.0004 corr_cb=0.4909 topkJ=0.1226
[TRAIN][ep=002] loss=0.6926 acc=52.21%
[TRAIN][ep=002] mask_avg: mc_mean=0.4463 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5077
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4474 mb_mean=0.4963 norm_overlap=1.0004 corr_cb=0.4696 topkJ=0.1653
[TRAIN][ep=003] loss=0.6924 acc=52.75%
[TRAIN][ep=003] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5044
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4425 mb_mean=0.4921 norm_overlap=1.0010 corr_cb=0.7152 topkJ=0.2130
[TRAIN][ep=004] loss=0.6910 acc=52.62%
[TRAIN][ep=004] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5027
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4529 mb_mean=0.4986 norm_overlap=1.0003 corr_cb=0.4542 topkJ=0.1703
[TRAIN][ep=005] loss=0.6877 acc=57.58%
[TRAIN][ep=005] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5020
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4536 mb_mean=0.4984 norm_overlap=1.0003 corr_cb=0.3933 topkJ=0.1356
[TRAIN][ep=006] loss=0.6858 acc=57.99%
[TRAIN][ep=006] mask_avg: mc_mean=0.4463 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5030
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4543 mb_mean=0.4986 norm_overlap=1.0005 corr_cb=0.5123 topkJ=0.1231
[TRAIN][ep=007] loss=0.6832 acc=55.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5158
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4444 mb_mean=0.4958 norm_overlap=1.0005 corr_cb=0.5646 topkJ=0.1270
[TRAIN][ep=008] loss=0.6779 acc=56.38%
[TRAIN][ep=008] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5070
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4465 mb_mean=0.4969 norm_overlap=1.0003 corr_cb=0.4721 topkJ=0.1699
[TRAIN][ep=009] loss=0.6742 acc=62.01%
[TRAIN][ep=009] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5069
================= FIT START (fold=2) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4558 mb_mean=0.5004 norm_overlap=1.0002 corr_cb=0.3859 topkJ=0.1398
[TRAIN][ep=000] loss=0.6720 acc=59.33%
[TRAIN][ep=000] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5085
[EPOCH 000/089] train: loss=0.6720 acc=59.33% | val: loss=0.6776 acc=66.27% f1=67.44% auc=65.17% val_score=46.1149 val_score_bestthr=65.4959 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.446, mb=0.496, no=1.000, corr=0.509) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 65.4959
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4538 mb_mean=0.4979 norm_overlap=1.0003 corr_cb=0.4016 topkJ=0.2040
[TRAIN][ep=001] loss=0.6664 acc=62.68%
[TRAIN][ep=001] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5121
[EPOCH 001/089] train: loss=0.6664 acc=62.68% | val: loss=0.6657 acc=66.27% f1=69.57% auc=68.84% val_score=56.0160 val_score_bestthr=65.5986 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.446, mb=0.496, no=1.001, corr=0.512) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 65.4959 -> 65.5986
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4475 mb_mean=0.4963 norm_overlap=1.0004 corr_cb=0.4390 topkJ=0.0795
[TRAIN][ep=002] loss=0.6612 acc=63.36%
[TRAIN][ep=002] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5046
[EPOCH 002/089] train: loss=0.6612 acc=63.36% | val: loss=0.6613 acc=69.88% f1=70.59% auc=68.78% val_score=57.5322 val_score_bestthr=68.8390 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.446, mb=0.496, no=1.000, corr=0.505) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 65.5986 -> 68.8390
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4442 mb_mean=0.4982 norm_overlap=1.0006 corr_cb=0.5457 topkJ=0.1279
[TRAIN][ep=003] loss=0.6621 acc=61.61%
[TRAIN][ep=003] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5061
[EPOCH 003/089] train: loss=0.6621 acc=61.61% | val: loss=0.6595 acc=67.47% f1=69.66% auc=69.07% val_score=50.4387 val_score_bestthr=66.0988 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.446, mb=0.496, no=1.000, corr=0.506) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 66.0988
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4474 mb_mean=0.4978 norm_overlap=1.0003 corr_cb=0.4220 topkJ=0.0832
[TRAIN][ep=004] loss=0.6505 acc=62.15%
[TRAIN][ep=004] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5086
[EPOCH 004/089] train: loss=0.6505 acc=62.15% | val: loss=0.6535 acc=66.27% f1=67.44% auc=69.71% val_score=54.9266 val_score_bestthr=66.0495 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.446, mb=0.496, no=1.001, corr=0.509) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 66.0495
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4503 mb_mean=0.4974 norm_overlap=1.0004 corr_cb=0.4973 topkJ=0.1639
[TRAIN][ep=005] loss=1.2348 acc=62.68%
[TRAIN][ep=005] mask_avg: mc_mean=0.3255 mb_mean=0.4961 norm_overlap=1.0022 corr_cb=0.5175
[EPOCH 005/089] train: loss=1.2348 acc=62.68% | val: loss=0.6930 acc=66.27% f1=65.00% auc=66.98% val_score=36.7053 val_score_bestthr=64.9741 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.326, mb=0.496, no=1.002, corr=0.517) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 64.9741
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2592 mb_mean=0.4955 norm_overlap=1.0033 corr_cb=0.4729 topkJ=0.1423
[TRAIN][ep=006] loss=1.2203 acc=64.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.2439 mb_mean=0.4961 norm_overlap=1.0030 corr_cb=0.4023
[EPOCH 006/089] train: loss=1.2203 acc=64.70% | val: loss=0.6486 acc=65.06% f1=73.87% auc=70.87% val_score=65.8299 val_score_bestthr=67.3451 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.244, mb=0.496, no=1.003, corr=0.402) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 67.3451
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2051 mb_mean=0.4933 norm_overlap=1.0038 corr_cb=0.4461 topkJ=0.2069
[TRAIN][ep=007] loss=1.2084 acc=63.89%
[TRAIN][ep=007] mask_avg: mc_mean=0.2223 mb_mean=0.4961 norm_overlap=1.0024 corr_cb=0.2764
[EPOCH 007/089] train: loss=1.2084 acc=63.89% | val: loss=0.6504 acc=66.27% f1=73.08% auc=70.93% val_score=65.7214 val_score_bestthr=68.4967 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.222, mb=0.496, no=1.002, corr=0.276) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 68.4967
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1425 mb_mean=0.4919 norm_overlap=1.0018 corr_cb=0.2018 topkJ=0.1358
[TRAIN][ep=008] loss=1.0023 acc=67.92%
[TRAIN][ep=008] mask_avg: mc_mean=0.1987 mb_mean=0.4961 norm_overlap=1.0019 corr_cb=0.1788
[EPOCH 008/089] train: loss=1.0023 acc=67.92% | val: loss=0.6381 acc=65.06% f1=73.39% auc=70.81% val_score=63.8291 val_score_bestthr=65.8299 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.199, mb=0.496, no=1.002, corr=0.179) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 65.8299
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2047 mb_mean=0.4948 norm_overlap=1.0040 corr_cb=0.3060 topkJ=0.0735
[TRAIN][ep=009] loss=0.8027 acc=65.23%
[TRAIN][ep=009] mask_avg: mc_mean=0.1793 mb_mean=0.4961 norm_overlap=1.0011 corr_cb=0.0757
[EPOCH 009/089] train: loss=0.8027 acc=65.23% | val: loss=0.6395 acc=65.06% f1=73.39% auc=70.81% val_score=65.0471 val_score_bestthr=65.8299 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.179, mb=0.496, no=1.001, corr=0.076) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 65.8299
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1784 mb_mean=0.4972 norm_overlap=0.9990 corr_cb=-0.0873 topkJ=0.0522
[TRAIN][ep=010] loss=0.7602 acc=66.44%
[TRAIN][ep=010] mask_avg: mc_mean=0.1876 mb_mean=0.4961 norm_overlap=1.0000 corr_cb=-0.0135
[EPOCH 010/089] train: loss=0.7602 acc=66.44% | val: loss=0.6287 acc=67.47% f1=69.66% auc=71.22% val_score=65.1939 val_score_bestthr=66.0988 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.188, mb=0.496, no=1.000, corr=-0.013) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 66.0988
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1702 mb_mean=0.4971 norm_overlap=1.0015 corr_cb=0.1026 topkJ=0.0456
[TRAIN][ep=011] loss=0.7255 acc=70.07%
[TRAIN][ep=011] mask_avg: mc_mean=0.1718 mb_mean=0.4961 norm_overlap=0.9995 corr_cb=-0.0366
[EPOCH 011/089] train: loss=0.7255 acc=70.07% | val: loss=0.7334 acc=66.27% f1=64.10% auc=67.38% val_score=37.1849 val_score_bestthr=64.3200 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.172, mb=0.496, no=0.999, corr=-0.037) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 64.3200
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1520 mb_mean=0.4951 norm_overlap=0.9973 corr_cb=-0.1559 topkJ=0.0244
[TRAIN][ep=012] loss=0.7392 acc=68.32%
[TRAIN][ep=012] mask_avg: mc_mean=0.1397 mb_mean=0.4961 norm_overlap=0.9999 corr_cb=-0.0222
[EPOCH 012/089] train: loss=0.7392 acc=68.32% | val: loss=0.6260 acc=65.06% f1=73.87% auc=71.86% val_score=61.4342 val_score_bestthr=68.7451 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.140, mb=0.496, no=1.000, corr=-0.022) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 68.7451
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.0790 mb_mean=0.4969 norm_overlap=0.9999 corr_cb=-0.0029 topkJ=0.0467
[TRAIN][ep=013] loss=0.7129 acc=69.93%
[TRAIN][ep=013] mask_avg: mc_mean=0.1091 mb_mean=0.4961 norm_overlap=0.9996 corr_cb=-0.0280
[EPOCH 013/089] train: loss=0.7129 acc=69.93% | val: loss=0.6224 acc=69.88% f1=70.59% auc=72.15% val_score=71.1363 val_score_bestthr=71.1363 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.109, mb=0.496, no=1.000, corr=-0.028) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 68.8390 -> 71.1363
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1573 mb_mean=0.4985 norm_overlap=0.9964 corr_cb=-0.1864 topkJ=0.0293
[TRAIN][ep=014] loss=0.7905 acc=69.80%
[TRAIN][ep=014] mask_avg: mc_mean=0.1434 mb_mean=0.4961 norm_overlap=0.9975 corr_cb=-0.1196
[EPOCH 014/089] train: loss=0.7905 acc=69.80% | val: loss=0.6150 acc=67.47% f1=65.82% auc=71.98% val_score=63.6411 val_score_bestthr=69.2507 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.143, mb=0.496, no=0.997, corr=-0.120) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.1363 -> 69.2507
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1639 mb_mean=0.4977 norm_overlap=0.9990 corr_cb=-0.0389 topkJ=0.0754
[TRAIN][ep=015] loss=0.8620 acc=68.05%
[TRAIN][ep=015] mask_avg: mc_mean=0.1310 mb_mean=0.4961 norm_overlap=0.9977 corr_cb=-0.0988
[EPOCH 015/089] train: loss=0.8620 acc=68.05% | val: loss=0.6345 acc=71.08% f1=72.09% auc=73.08% val_score=52.5831 val_score_bestthr=74.2067 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.131, mb=0.496, no=0.998, corr=-0.099) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 71.1363 -> 74.2067
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1743 mb_mean=0.4984 norm_overlap=0.9905 corr_cb=-0.4118 topkJ=0.0104
[TRAIN][ep=016] loss=0.9236 acc=72.48%
[TRAIN][ep=016] mask_avg: mc_mean=0.1467 mb_mean=0.4961 norm_overlap=0.9966 corr_cb=-0.1404
[EPOCH 016/089] train: loss=0.9236 acc=72.48% | val: loss=0.6116 acc=68.67% f1=70.45% auc=73.31% val_score=63.7370 val_score_bestthr=71.3392 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.147, mb=0.496, no=0.997, corr=-0.140) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.2067 -> 71.3392
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1213 mb_mean=0.4972 norm_overlap=0.9987 corr_cb=-0.0571 topkJ=0.0583
[TRAIN][ep=017] loss=1.0012 acc=72.08%
[TRAIN][ep=017] mask_avg: mc_mean=0.1325 mb_mean=0.4961 norm_overlap=0.9969 corr_cb=-0.1146
[EPOCH 017/089] train: loss=1.0012 acc=72.08% | val: loss=0.7344 acc=71.08% f1=72.09% auc=72.62% val_score=46.9534 val_score_bestthr=71.2875 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.133, mb=0.496, no=0.997, corr=-0.115) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.2067 -> 71.2875
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1339 mb_mean=0.4952 norm_overlap=0.9980 corr_cb=-0.0703 topkJ=0.0417
[TRAIN][ep=018] loss=1.0706 acc=71.28%
[TRAIN][ep=018] mask_avg: mc_mean=0.1478 mb_mean=0.4961 norm_overlap=0.9961 corr_cb=-0.1486
[EPOCH 018/089] train: loss=1.0706 acc=71.28% | val: loss=0.6360 acc=74.70% f1=76.92% auc=73.55% val_score=53.6088 val_score_bestthr=74.1638 | dyn(w_pfs=0.240, w_sup=0.240, w_csuf=0.200, stage2=False) | mask(mc=0.148, mb=0.496, no=0.996, corr=-0.149) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.2067 -> 74.1638
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1508 mb_mean=0.4952 norm_overlap=0.9958 corr_cb=-0.1314 topkJ=0.0231
[TRAIN][ep=019] loss=1.0792 acc=71.68%
[TRAIN][ep=019] mask_avg: mc_mean=0.1330 mb_mean=0.4961 norm_overlap=0.9967 corr_cb=-0.1180
[EPOCH 019/089] train: loss=1.0792 acc=71.68% | val: loss=0.6244 acc=65.06% f1=70.71% auc=72.09% val_score=66.7595 val_score_bestthr=69.1666 | dyn(w_pfs=0.280, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.133, mb=0.496, no=0.997, corr=-0.118) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.2067 -> 69.1666
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1617 mb_mean=0.4987 norm_overlap=0.9949 corr_cb=-0.2266 topkJ=0.0339
[TRAIN][ep=020] loss=1.0755 acc=73.42%
[TRAIN][ep=020] mask_avg: mc_mean=0.1556 mb_mean=0.4961 norm_overlap=0.9964 corr_cb=-0.1430
[EPOCH 020/089] train: loss=1.0755 acc=73.42% | val: loss=0.6117 acc=67.47% f1=71.58% auc=73.49% val_score=69.4458 val_score_bestthr=69.4458 | dyn(w_pfs=0.180, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.156, mb=0.496, no=0.996, corr=-0.143) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.2067 -> 69.4458
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.1334 mb_mean=0.5007 norm_overlap=0.9944 corr_cb=-0.1961 topkJ=0.0189
[TRAIN][ep=021] loss=0.8722 acc=73.15%
[TRAIN][ep=021] mask_avg: mc_mean=0.1651 mb_mean=0.4961 norm_overlap=0.9961 corr_cb=-0.1531
[EPOCH 021/089] train: loss=0.8722 acc=73.15% | val: loss=0.6306 acc=67.47% f1=71.58% auc=73.26% val_score=67.0091 val_score_bestthr=69.4458 | dyn(w_pfs=0.080, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.165, mb=0.496, no=0.996, corr=-0.153) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.2067 -> 69.4458
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1723 mb_mean=0.4922 norm_overlap=1.0000 corr_cb=0.0012 topkJ=0.0647
[TRAIN][ep=022] loss=0.6776 acc=76.38%
[TRAIN][ep=022] mask_avg: mc_mean=0.1475 mb_mean=0.4961 norm_overlap=0.9966 corr_cb=-0.1253
[EPOCH 022/089] train: loss=0.6776 acc=76.38% | val: loss=0.6223 acc=73.49% f1=75.56% auc=73.37% val_score=57.2874 val_score_bestthr=74.9072 | dyn(w_pfs=0.120, w_sup=0.090, w_csuf=0.040, stage2=False) | mask(mc=0.148, mb=0.496, no=0.997, corr=-0.125) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 74.2067 -> 74.9072
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1582 mb_mean=0.4973 norm_overlap=0.9944 corr_cb=-0.2102 topkJ=0.0182
[TRAIN][ep=023] loss=0.7510 acc=74.09%
[TRAIN][ep=023] mask_avg: mc_mean=0.1389 mb_mean=0.4961 norm_overlap=0.9965 corr_cb=-0.1199
[EPOCH 023/089] train: loss=0.7510 acc=74.09% | val: loss=0.6368 acc=73.49% f1=76.09% auc=73.08% val_score=53.5389 val_score_bestthr=73.1003 | dyn(w_pfs=0.160, w_sup=0.130, w_csuf=0.080, stage2=False) | mask(mc=0.139, mb=0.496, no=0.996, corr=-0.120) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.9072 -> 73.1003
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1697 mb_mean=0.4928 norm_overlap=0.9970 corr_cb=-0.1036 topkJ=0.0811
[TRAIN][ep=024] loss=0.8575 acc=72.08%
[TRAIN][ep=024] mask_avg: mc_mean=0.1498 mb_mean=0.4961 norm_overlap=0.9963 corr_cb=-0.1292
[EPOCH 024/089] train: loss=0.8575 acc=72.08% | val: loss=0.6158 acc=71.08% f1=73.91% auc=73.43% val_score=68.7108 val_score_bestthr=72.9533 | dyn(w_pfs=0.200, w_sup=0.170, w_csuf=0.120, stage2=False) | mask(mc=0.150, mb=0.496, no=0.996, corr=-0.129) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.9072 -> 72.9533
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1125 mb_mean=0.4964 norm_overlap=0.9948 corr_cb=-0.1338 topkJ=0.0336
[TRAIN][ep=025] loss=0.9182 acc=73.96%
[TRAIN][ep=025] mask_avg: mc_mean=0.1322 mb_mean=0.4961 norm_overlap=0.9963 corr_cb=-0.1273
[EPOCH 025/089] train: loss=0.9182 acc=73.96% | val: loss=0.6047 acc=71.08% f1=73.91% auc=73.31% val_score=65.3226 val_score_bestthr=72.9533 | dyn(w_pfs=0.240, w_sup=0.210, w_csuf=0.160, stage2=False) | mask(mc=0.132, mb=0.496, no=0.996, corr=-0.127) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.9072 -> 72.9533
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1361 mb_mean=0.4934 norm_overlap=1.0022 corr_cb=0.0586 topkJ=0.0406
[TRAIN][ep=026] loss=0.9677 acc=75.97%
[TRAIN][ep=026] mask_avg: mc_mean=0.1663 mb_mean=0.4961 norm_overlap=0.9959 corr_cb=-0.1525
[EPOCH 026/089] train: loss=0.9677 acc=75.97% | val: loss=0.6174 acc=72.29% f1=74.16% auc=73.55% val_score=66.4268 val_score_bestthr=68.2998 | dyn(w_pfs=0.280, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.166, mb=0.496, no=0.996, corr=-0.153) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.9072 -> 68.2998
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1617 mb_mean=0.4995 norm_overlap=0.9963 corr_cb=-0.1406 topkJ=0.0263
[TRAIN][ep=027] loss=1.0409 acc=75.57%
[TRAIN][ep=027] mask_avg: mc_mean=0.1531 mb_mean=0.4961 norm_overlap=0.9966 corr_cb=-0.1177
[EPOCH 027/089] train: loss=1.0409 acc=75.57% | val: loss=0.6413 acc=69.88% f1=73.68% auc=73.90% val_score=57.6143 val_score_bestthr=70.1456 | dyn(w_pfs=0.180, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.153, mb=0.496, no=0.997, corr=-0.118) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.9072 -> 70.1456
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1896 mb_mean=0.4920 norm_overlap=0.9990 corr_cb=-0.0441 topkJ=0.0473
[TRAIN][ep=028] loss=0.8360 acc=75.84%
[TRAIN][ep=028] mask_avg: mc_mean=0.1780 mb_mean=0.4961 norm_overlap=0.9962 corr_cb=-0.1429
[EPOCH 028/089] train: loss=0.8360 acc=75.84% | val: loss=0.6557 acc=67.47% f1=74.77% auc=72.67% val_score=64.9112 val_score_bestthr=68.9386 | dyn(w_pfs=0.080, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.178, mb=0.496, no=0.996, corr=-0.143) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.9072 -> 68.9386
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.1611 mb_mean=0.4915 norm_overlap=0.9998 corr_cb=-0.0077 topkJ=0.0584
[TRAIN][ep=029] loss=0.6386 acc=77.05%
[TRAIN][ep=029] mask_avg: mc_mean=0.1756 mb_mean=0.4961 norm_overlap=0.9966 corr_cb=-0.1321
[EPOCH 029/089] train: loss=0.6386 acc=77.05% | val: loss=0.6310 acc=68.67% f1=72.34% auc=73.20% val_score=64.8973 val_score_bestthr=70.6805 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.176, mb=0.496, no=0.997, corr=-0.132) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.9072 -> 70.6805
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2167 mb_mean=0.4964 norm_overlap=0.9956 corr_cb=-0.1942 topkJ=0.0485
[TRAIN][ep=030] loss=0.6065 acc=77.45%
[TRAIN][ep=030] mask_avg: mc_mean=0.2055 mb_mean=0.4961 norm_overlap=0.9962 corr_cb=-0.1588
[EPOCH 030/089] train: loss=0.6065 acc=77.45% | val: loss=0.6319 acc=67.47% f1=74.77% auc=73.90% val_score=60.2774 val_score_bestthr=70.0586 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.206, mb=0.496, no=0.996, corr=-0.159) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.9072 -> 70.0586
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.1459 mb_mean=0.4928 norm_overlap=1.0005 corr_cb=0.0137 topkJ=0.0695
[TRAIN][ep=031] loss=0.6035 acc=78.12%
[TRAIN][ep=031] mask_avg: mc_mean=0.1646 mb_mean=0.4961 norm_overlap=0.9971 corr_cb=-0.1041
[EPOCH 031/089] train: loss=0.6035 acc=78.12% | val: loss=0.6372 acc=66.27% f1=74.07% auc=73.14% val_score=57.4434 val_score_bestthr=69.6610 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.165, mb=0.496, no=0.997, corr=-0.104) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.9072 -> 69.6610
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1774 mb_mean=0.4973 norm_overlap=1.0007 corr_cb=0.0271 topkJ=0.0711
[TRAIN][ep=032] loss=0.5908 acc=78.12%
[TRAIN][ep=032] mask_avg: mc_mean=0.1812 mb_mean=0.4961 norm_overlap=0.9970 corr_cb=-0.1130
[EPOCH 032/089] train: loss=0.5908 acc=78.12% | val: loss=0.7729 acc=67.47% f1=74.77% auc=73.14% val_score=42.0737 val_score_bestthr=67.4974 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.181, mb=0.496, no=0.997, corr=-0.113) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.9072 -> 67.4974
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2151 mb_mean=0.4971 norm_overlap=0.9985 corr_cb=-0.0769 topkJ=0.0432
[TRAIN][ep=033] loss=0.5994 acc=77.99%
[TRAIN][ep=033] mask_avg: mc_mean=0.2009 mb_mean=0.4961 norm_overlap=0.9964 corr_cb=-0.1448
[EPOCH 033/089] train: loss=0.5994 acc=77.99% | val: loss=0.6628 acc=68.67% f1=74.51% auc=73.20% val_score=53.3642 val_score_bestthr=70.2418 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.201, mb=0.496, no=0.996, corr=-0.145) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.9072 -> 70.2418
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1404 mb_mean=0.4943 norm_overlap=0.9970 corr_cb=-0.1103 topkJ=0.0466
[TRAIN][ep=034] loss=0.5780 acc=79.06%
[TRAIN][ep=034] mask_avg: mc_mean=0.1944 mb_mean=0.4961 norm_overlap=0.9969 corr_cb=-0.1222
[EPOCH 034/089] train: loss=0.5780 acc=79.06% | val: loss=0.6863 acc=71.08% f1=75.00% auc=71.74% val_score=70.1456 val_score_bestthr=73.4713 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.194, mb=0.496, no=0.997, corr=-0.122) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.9072 -> 73.4713
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.1904 mb_mean=0.4949 norm_overlap=0.9963 corr_cb=-0.1553 topkJ=0.0523
[TRAIN][ep=035] loss=0.5685 acc=80.27%
[TRAIN][ep=035] mask_avg: mc_mean=0.1858 mb_mean=0.4961 norm_overlap=0.9975 corr_cb=-0.0930
[EPOCH 035/089] train: loss=0.5685 acc=80.27% | val: loss=0.6956 acc=68.67% f1=75.47% auc=72.44% val_score=66.7535 val_score_bestthr=70.4582 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.186, mb=0.496, no=0.998, corr=-0.093) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.9072 -> 70.4582
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.1993 mb_mean=0.4988 norm_overlap=0.9975 corr_cb=-0.0958 topkJ=0.0354
[TRAIN][ep=036] loss=0.5881 acc=78.12%
[TRAIN][ep=036] mask_avg: mc_mean=0.2402 mb_mean=0.4961 norm_overlap=0.9959 corr_cb=-0.1793
[EPOCH 036/089] train: loss=0.5881 acc=78.12% | val: loss=0.6572 acc=69.88% f1=73.12% auc=72.50% val_score=70.1697 val_score_bestthr=70.1697 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.240, mb=0.496, no=0.996, corr=-0.179) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.9072 -> 70.1697
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1919 mb_mean=0.4955 norm_overlap=0.9966 corr_cb=-0.1133 topkJ=0.0570
[TRAIN][ep=037] loss=0.5706 acc=80.13%
[TRAIN][ep=037] mask_avg: mc_mean=0.1923 mb_mean=0.4961 norm_overlap=0.9968 corr_cb=-0.1189
[EPOCH 037/089] train: loss=0.5706 acc=80.13% | val: loss=0.6952 acc=66.27% f1=74.07% auc=73.20% val_score=50.0246 val_score_bestthr=67.0998 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.192, mb=0.496, no=0.997, corr=-0.119) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.9072 -> 67.0998
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.1469 mb_mean=0.4959 norm_overlap=0.9980 corr_cb=-0.0726 topkJ=0.0466
[TRAIN][ep=038] loss=0.5524 acc=80.40%
[TRAIN][ep=038] mask_avg: mc_mean=0.2161 mb_mean=0.4961 norm_overlap=0.9960 corr_cb=-0.1565
[EPOCH 038/089] train: loss=0.5524 acc=80.40% | val: loss=0.6807 acc=71.08% f1=74.47% auc=71.98% val_score=70.1456 val_score_bestthr=70.8863 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.216, mb=0.496, no=0.996, corr=-0.157) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.9072 -> 70.8863
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2646 mb_mean=0.4995 norm_overlap=0.9913 corr_cb=-0.3440 topkJ=0.0194
[TRAIN][ep=039] loss=0.5672 acc=79.73%
[TRAIN][ep=039] mask_avg: mc_mean=0.1911 mb_mean=0.4961 norm_overlap=0.9968 corr_cb=-0.1188
[EPOCH 039/089] train: loss=0.5672 acc=79.73% | val: loss=0.6651 acc=67.47% f1=74.77% auc=72.91% val_score=63.7991 val_score_bestthr=68.6174 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.191, mb=0.496, no=0.997, corr=-0.119) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.9072 -> 68.6174
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.2073 mb_mean=0.4932 norm_overlap=0.9954 corr_cb=-0.2021 topkJ=0.0268
[TRAIN][ep=040] loss=0.5474 acc=80.27%
[TRAIN][ep=040] mask_avg: mc_mean=0.1949 mb_mean=0.4961 norm_overlap=0.9971 corr_cb=-0.1130
[EPOCH 040/089] train: loss=0.5474 acc=80.27% | val: loss=0.6921 acc=67.47% f1=74.77% auc=72.50% val_score=54.1203 val_score_bestthr=68.6174 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.195, mb=0.496, no=0.997, corr=-0.113) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.9072 -> 68.6174
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.0852 mb_mean=0.4935 norm_overlap=1.0075 corr_cb=0.1430 topkJ=0.1056
[TRAIN][ep=041] loss=0.5446 acc=80.00%
[TRAIN][ep=041] mask_avg: mc_mean=0.1900 mb_mean=0.4961 norm_overlap=0.9971 corr_cb=-0.1132
[EPOCH 041/089] train: loss=0.5446 acc=80.00% | val: loss=0.6786 acc=69.88% f1=73.12% auc=72.56% val_score=70.1697 val_score_bestthr=70.1697 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.496, no=0.997, corr=-0.113) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.9072 -> 70.1697
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.1832 mb_mean=0.4948 norm_overlap=1.0006 corr_cb=0.0176 topkJ=0.0442
[TRAIN][ep=042] loss=0.5479 acc=81.07%
[TRAIN][ep=042] mask_avg: mc_mean=0.2115 mb_mean=0.4961 norm_overlap=0.9967 corr_cb=-0.1291
[EPOCH 042/089] train: loss=0.5479 acc=81.07% | val: loss=0.7123 acc=69.88% f1=73.68% auc=72.62% val_score=46.1697 val_score_bestthr=70.1456 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.211, mb=0.496, no=0.997, corr=-0.129) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.9072 -> 70.1456
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.1628 mb_mean=0.4973 norm_overlap=0.9987 corr_cb=-0.0388 topkJ=0.0313
[TRAIN][ep=043] loss=0.5274 acc=83.36%
[TRAIN][ep=043] mask_avg: mc_mean=0.2005 mb_mean=0.4961 norm_overlap=0.9963 corr_cb=-0.1360
[EPOCH 043/089] train: loss=0.5274 acc=83.36% | val: loss=0.7483 acc=67.47% f1=75.23% auc=72.44% val_score=50.0246 val_score_bestthr=66.9079 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.201, mb=0.496, no=0.996, corr=-0.136) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.9072 -> 66.9079
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2416 mb_mean=0.4990 norm_overlap=0.9961 corr_cb=-0.1845 topkJ=0.0405
[TRAIN][ep=044] loss=0.5390 acc=82.01%
[TRAIN][ep=044] mask_avg: mc_mean=0.2047 mb_mean=0.4961 norm_overlap=0.9966 corr_cb=-0.1275
[EPOCH 044/089] train: loss=0.5390 acc=82.01% | val: loss=0.6898 acc=69.88% f1=73.68% auc=71.51% val_score=64.4901 val_score_bestthr=70.1456 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.205, mb=0.496, no=0.997, corr=-0.127) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.9072 -> 70.1456
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2812 mb_mean=0.4928 norm_overlap=0.9944 corr_cb=-0.2513 topkJ=0.0286
[TRAIN][ep=045] loss=0.5384 acc=81.74%
[TRAIN][ep=045] mask_avg: mc_mean=0.2575 mb_mean=0.4961 norm_overlap=0.9954 corr_cb=-0.1983
[EPOCH 045/089] train: loss=0.5384 acc=81.74% | val: loss=0.7666 acc=69.88% f1=73.68% auc=72.21% val_score=65.2293 val_score_bestthr=70.1456 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.258, mb=0.496, no=0.995, corr=-0.198) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.9072 -> 70.1456
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.1685 mb_mean=0.4987 norm_overlap=0.9950 corr_cb=-0.1772 topkJ=0.0558
[TRAIN][ep=046] loss=0.5351 acc=80.67%
[TRAIN][ep=046] mask_avg: mc_mean=0.1894 mb_mean=0.4961 norm_overlap=0.9972 corr_cb=-0.1024
[EPOCH 046/089] train: loss=0.5351 acc=80.67% | val: loss=0.7282 acc=67.47% f1=75.23% auc=72.91% val_score=51.8232 val_score_bestthr=69.7779 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.189, mb=0.496, no=0.997, corr=-0.102) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.9072 -> 69.7779
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.2601 mb_mean=0.4993 norm_overlap=0.9976 corr_cb=-0.1047 topkJ=0.0519
[TRAIN][ep=047] loss=0.5133 acc=82.55%
[TRAIN][ep=047] mask_avg: mc_mean=0.2292 mb_mean=0.4961 norm_overlap=0.9963 corr_cb=-0.1462
[EPOCH 047/089] train: loss=0.5133 acc=82.55% | val: loss=0.7816 acc=69.88% f1=73.68% auc=70.52% val_score=65.9112 val_score_bestthr=70.1456 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.229, mb=0.496, no=0.996, corr=-0.146) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.9072 -> 70.1456
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.1993 mb_mean=0.4911 norm_overlap=0.9956 corr_cb=-0.1585 topkJ=0.0316
[TRAIN][ep=048] loss=0.5079 acc=83.36%
[TRAIN][ep=048] mask_avg: mc_mean=0.2188 mb_mean=0.4961 norm_overlap=0.9966 corr_cb=-0.1291
[EPOCH 048/089] train: loss=0.5079 acc=83.36% | val: loss=0.7392 acc=68.67% f1=76.36% auc=71.98% val_score=48.7589 val_score_bestthr=71.0908 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.219, mb=0.496, no=0.997, corr=-0.129) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.9072 -> 71.0908
[DBG][ep=049] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.2884 mb_mean=0.4972 norm_overlap=0.9931 corr_cb=-0.2688 topkJ=0.0191
[TRAIN][ep=049] loss=0.5005 acc=84.70%
[TRAIN][ep=049] mask_avg: mc_mean=0.2259 mb_mean=0.4961 norm_overlap=0.9963 corr_cb=-0.1442
[EPOCH 049/089] train: loss=0.5005 acc=84.70% | val: loss=0.8627 acc=68.67% f1=75.00% auc=72.15% val_score=42.3631 val_score_bestthr=66.2997 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.226, mb=0.496, no=0.996, corr=-0.144) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.9072 -> 66.2997
[DBG][ep=050] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.1682 mb_mean=0.4927 norm_overlap=0.9949 corr_cb=-0.1311 topkJ=0.0433
[TRAIN][ep=050] loss=0.4827 acc=85.77%
[TRAIN][ep=050] mask_avg: mc_mean=0.1730 mb_mean=0.4961 norm_overlap=0.9977 corr_cb=-0.0767
[EPOCH 050/089] train: loss=0.4827 acc=85.77% | val: loss=0.7360 acc=71.08% f1=74.47% auc=72.15% val_score=52.6562 val_score_bestthr=70.8863 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.173, mb=0.496, no=0.998, corr=-0.077) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.9072 -> 70.8863
[DBG][ep=051] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.1897 mb_mean=0.5002 norm_overlap=0.9964 corr_cb=-0.1457 topkJ=0.0521
[TRAIN][ep=051] loss=0.4589 acc=87.38%
[TRAIN][ep=051] mask_avg: mc_mean=0.1730 mb_mean=0.4961 norm_overlap=0.9975 corr_cb=-0.0812
[EPOCH 051/089] train: loss=0.4589 acc=87.38% | val: loss=0.7389 acc=71.08% f1=74.47% auc=71.57% val_score=65.2963 val_score_bestthr=70.8863 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.173, mb=0.496, no=0.998, corr=-0.081) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.9072 -> 70.8863
[DBG][ep=052] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.1853 mb_mean=0.4969 norm_overlap=1.0003 corr_cb=0.0104 topkJ=0.0705
[TRAIN][ep=052] loss=0.4630 acc=86.71%
[TRAIN][ep=052] mask_avg: mc_mean=0.1731 mb_mean=0.4961 norm_overlap=0.9976 corr_cb=-0.0797
[EPOCH 052/089] train: loss=0.4630 acc=86.71% | val: loss=0.7425 acc=71.08% f1=74.47% auc=71.74% val_score=65.8972 val_score_bestthr=70.8863 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.173, mb=0.496, no=0.998, corr=-0.080) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.9072 -> 70.8863
[EARLY STOP] no improvement for 30 epochs. best_epoch=22
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
=============== FIT DONE ===============
[BEST] epoch=22 | val_acc=73.49% | val_f1=75.56% | val_auc=73.37% | val_score=57.2874 | val_score_bestthr=74.9072
[TEST@BEST] thr_used=0.345 | acc=62.80% f1=69.08% auc=63.12% | SP_sex=20.02% EO_sex=17.59% SP_age=15.61% EO_age=16.62%
[TIME] 1.52 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/summary_fold_2.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4477 mb_mean=0.4964 norm_overlap=1.0006 corr_cb=0.6199 topkJ=0.1849
[TRAIN][ep=000] loss=0.6951 acc=47.25%
[TRAIN][ep=000] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5111
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4378 mb_mean=0.4940 norm_overlap=1.0005 corr_cb=0.5338 topkJ=0.1816
[TRAIN][ep=001] loss=0.6926 acc=50.74%
[TRAIN][ep=001] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5175
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4517 mb_mean=0.4988 norm_overlap=1.0004 corr_cb=0.4909 topkJ=0.1226
[TRAIN][ep=002] loss=0.6926 acc=52.21%
[TRAIN][ep=002] mask_avg: mc_mean=0.4463 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5077
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4474 mb_mean=0.4963 norm_overlap=1.0004 corr_cb=0.4696 topkJ=0.1653
[TRAIN][ep=003] loss=0.6924 acc=52.75%
[TRAIN][ep=003] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5044
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4425 mb_mean=0.4921 norm_overlap=1.0010 corr_cb=0.7152 topkJ=0.2130
[TRAIN][ep=004] loss=0.6910 acc=52.62%
[TRAIN][ep=004] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5027
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4529 mb_mean=0.4986 norm_overlap=1.0003 corr_cb=0.4542 topkJ=0.1703
[TRAIN][ep=005] loss=0.6877 acc=57.58%
[TRAIN][ep=005] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5020
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4536 mb_mean=0.4984 norm_overlap=1.0003 corr_cb=0.3933 topkJ=0.1356
[TRAIN][ep=006] loss=0.6858 acc=57.99%
[TRAIN][ep=006] mask_avg: mc_mean=0.4463 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5030
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4543 mb_mean=0.4986 norm_overlap=1.0005 corr_cb=0.5123 topkJ=0.1231
[TRAIN][ep=007] loss=0.6832 acc=55.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5158
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4444 mb_mean=0.4958 norm_overlap=1.0005 corr_cb=0.5646 topkJ=0.1270
[TRAIN][ep=008] loss=0.6779 acc=56.38%
[TRAIN][ep=008] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5070
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4465 mb_mean=0.4969 norm_overlap=1.0003 corr_cb=0.4721 topkJ=0.1699
[TRAIN][ep=009] loss=0.6742 acc=62.01%
[TRAIN][ep=009] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5069
================= FIT START (fold=2) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4558 mb_mean=0.5004 norm_overlap=1.0002 corr_cb=0.3859 topkJ=0.1398
[TRAIN][ep=000] loss=0.6720 acc=59.46%
[TRAIN][ep=000] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5085
[EPOCH 000/089] train: loss=0.6720 acc=59.46% | val: loss=0.6776 acc=65.06% f1=66.67% auc=65.06% val_score=46.1149 val_score_bestthr=63.3337 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.446, mb=0.496, no=1.000, corr=0.509) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 63.3337
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4538 mb_mean=0.4979 norm_overlap=1.0003 corr_cb=0.4016 topkJ=0.2040
[TRAIN][ep=001] loss=0.6663 acc=62.95%
[TRAIN][ep=001] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5121
[EPOCH 001/089] train: loss=0.6663 acc=62.95% | val: loss=0.6657 acc=66.27% f1=69.57% auc=68.90% val_score=57.5615 val_score_bestthr=65.5986 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.446, mb=0.496, no=1.001, corr=0.512) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 63.3337 -> 65.5986
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4475 mb_mean=0.4963 norm_overlap=1.0004 corr_cb=0.4390 topkJ=0.0795
[TRAIN][ep=002] loss=0.6613 acc=63.22%
[TRAIN][ep=002] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5046
[EPOCH 002/089] train: loss=0.6613 acc=63.22% | val: loss=0.6614 acc=69.88% f1=70.59% auc=68.78% val_score=57.5322 val_score_bestthr=68.8390 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.446, mb=0.496, no=1.000, corr=0.505) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 65.5986 -> 68.8390
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4442 mb_mean=0.4982 norm_overlap=1.0006 corr_cb=0.5457 topkJ=0.1279
[TRAIN][ep=003] loss=0.6621 acc=61.34%
[TRAIN][ep=003] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5061
[EPOCH 003/089] train: loss=0.6621 acc=61.34% | val: loss=0.6594 acc=67.47% f1=69.66% auc=69.13% val_score=50.4387 val_score_bestthr=66.0988 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.446, mb=0.496, no=1.000, corr=0.506) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 66.0988
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4474 mb_mean=0.4978 norm_overlap=1.0003 corr_cb=0.4220 topkJ=0.0832
[TRAIN][ep=004] loss=0.6505 acc=62.15%
[TRAIN][ep=004] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5086
[EPOCH 004/089] train: loss=0.6505 acc=62.15% | val: loss=0.6536 acc=67.47% f1=68.97% auc=69.65% val_score=54.9266 val_score_bestthr=66.3074 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.446, mb=0.496, no=1.001, corr=0.509) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 66.3074
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4503 mb_mean=0.4974 norm_overlap=1.0004 corr_cb=0.4973 topkJ=0.1639
[TRAIN][ep=005] loss=1.2896 acc=62.95%
[TRAIN][ep=005] mask_avg: mc_mean=0.3253 mb_mean=0.4961 norm_overlap=1.0022 corr_cb=0.5174
[EPOCH 005/089] train: loss=1.2896 acc=62.95% | val: loss=0.6929 acc=65.06% f1=64.20% auc=66.74% val_score=36.7053 val_score_bestthr=63.4400 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.325, mb=0.496, no=1.002, corr=0.517) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 63.4400
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2592 mb_mean=0.4955 norm_overlap=1.0033 corr_cb=0.4745 topkJ=0.1429
[TRAIN][ep=006] loss=1.2729 acc=64.56%
[TRAIN][ep=006] mask_avg: mc_mean=0.2443 mb_mean=0.4961 norm_overlap=1.0030 corr_cb=0.4036
[EPOCH 006/089] train: loss=1.2729 acc=64.56% | val: loss=0.6479 acc=66.27% f1=74.07% auc=70.81% val_score=68.0045 val_score_bestthr=68.0045 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.244, mb=0.496, no=1.003, corr=0.404) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 68.0045
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2056 mb_mean=0.4933 norm_overlap=1.0038 corr_cb=0.4480 topkJ=0.2075
[TRAIN][ep=007] loss=1.2611 acc=64.16%
[TRAIN][ep=007] mask_avg: mc_mean=0.2238 mb_mean=0.4961 norm_overlap=1.0024 corr_cb=0.2794
[EPOCH 007/089] train: loss=1.2611 acc=64.16% | val: loss=0.6512 acc=66.27% f1=73.08% auc=70.87% val_score=64.2121 val_score_bestthr=68.4967 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.224, mb=0.496, no=1.002, corr=0.279) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 68.4967
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1447 mb_mean=0.4919 norm_overlap=1.0018 corr_cb=0.2027 topkJ=0.1368
[TRAIN][ep=008] loss=1.0556 acc=67.92%
[TRAIN][ep=008] mask_avg: mc_mean=0.2009 mb_mean=0.4961 norm_overlap=1.0019 corr_cb=0.1819
[EPOCH 008/089] train: loss=1.0556 acc=67.92% | val: loss=0.6389 acc=65.06% f1=73.87% auc=70.87% val_score=61.8631 val_score_bestthr=67.3451 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.201, mb=0.496, no=1.002, corr=0.182) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 67.3451
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2074 mb_mean=0.4948 norm_overlap=1.0039 corr_cb=0.3106 topkJ=0.0740
[TRAIN][ep=009] loss=0.8561 acc=65.37%
[TRAIN][ep=009] mask_avg: mc_mean=0.1819 mb_mean=0.4961 norm_overlap=1.0011 corr_cb=0.0800
[EPOCH 009/089] train: loss=0.8561 acc=65.37% | val: loss=0.6397 acc=65.06% f1=73.39% auc=70.81% val_score=65.0471 val_score_bestthr=65.8299 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.182, mb=0.496, no=1.001, corr=0.080) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 65.8299
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1784 mb_mean=0.4972 norm_overlap=0.9991 corr_cb=-0.0783 topkJ=0.0544
[TRAIN][ep=010] loss=0.8135 acc=66.04%
[TRAIN][ep=010] mask_avg: mc_mean=0.1889 mb_mean=0.4961 norm_overlap=1.0000 corr_cb=-0.0071
[EPOCH 010/089] train: loss=0.8135 acc=66.04% | val: loss=0.6285 acc=67.47% f1=68.97% auc=71.10% val_score=65.1939 val_score_bestthr=66.3074 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.189, mb=0.496, no=1.000, corr=-0.007) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 66.3074
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1726 mb_mean=0.4971 norm_overlap=1.0016 corr_cb=0.1094 topkJ=0.0464
[TRAIN][ep=011] loss=0.7786 acc=70.07%
[TRAIN][ep=011] mask_avg: mc_mean=0.1749 mb_mean=0.4961 norm_overlap=0.9996 corr_cb=-0.0333
[EPOCH 011/089] train: loss=0.7786 acc=70.07% | val: loss=0.7327 acc=66.27% f1=64.10% auc=67.50% val_score=37.1849 val_score_bestthr=64.3200 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.175, mb=0.496, no=1.000, corr=-0.033) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 64.3200
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1564 mb_mean=0.4951 norm_overlap=0.9974 corr_cb=-0.1579 topkJ=0.0239
[TRAIN][ep=012] loss=0.7920 acc=68.46%
[TRAIN][ep=012] mask_avg: mc_mean=0.1432 mb_mean=0.4961 norm_overlap=1.0000 corr_cb=-0.0199
[EPOCH 012/089] train: loss=0.7920 acc=68.46% | val: loss=0.6257 acc=65.06% f1=73.87% auc=71.86% val_score=59.9164 val_score_bestthr=68.7451 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.143, mb=0.496, no=1.000, corr=-0.020) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 68.7451
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.0832 mb_mean=0.4969 norm_overlap=1.0000 corr_cb=-0.0008 topkJ=0.0471
[TRAIN][ep=013] loss=0.7655 acc=70.34%
[TRAIN][ep=013] mask_avg: mc_mean=0.1122 mb_mean=0.4961 norm_overlap=0.9997 corr_cb=-0.0240
[EPOCH 013/089] train: loss=0.7655 acc=70.34% | val: loss=0.6217 acc=69.88% f1=71.26% auc=72.09% val_score=72.0365 val_score_bestthr=72.0365 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.112, mb=0.496, no=1.000, corr=-0.024) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 68.8390 -> 72.0365
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1601 mb_mean=0.4985 norm_overlap=0.9965 corr_cb=-0.1860 topkJ=0.0293
[TRAIN][ep=014] loss=0.8433 acc=69.93%
[TRAIN][ep=014] mask_avg: mc_mean=0.1444 mb_mean=0.4961 norm_overlap=0.9977 corr_cb=-0.1156
[EPOCH 014/089] train: loss=0.8433 acc=69.93% | val: loss=0.6145 acc=68.67% f1=71.74% auc=72.03% val_score=63.6411 val_score_bestthr=69.2848 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.144, mb=0.496, no=0.998, corr=-0.116) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.0365 -> 69.2848
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1668 mb_mean=0.4977 norm_overlap=0.9990 corr_cb=-0.0383 topkJ=0.0759
[TRAIN][ep=015] loss=0.9148 acc=68.19%
[TRAIN][ep=015] mask_avg: mc_mean=0.1321 mb_mean=0.4961 norm_overlap=0.9978 corr_cb=-0.0960
[EPOCH 015/089] train: loss=0.9148 acc=68.19% | val: loss=0.6335 acc=72.29% f1=72.29% auc=73.08% val_score=52.5831 val_score_bestthr=76.1471 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.132, mb=0.496, no=0.998, corr=-0.096) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 72.0365 -> 76.1471
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1737 mb_mean=0.4984 norm_overlap=0.9908 corr_cb=-0.4091 topkJ=0.0108
[TRAIN][ep=016] loss=0.9758 acc=72.35%
[TRAIN][ep=016] mask_avg: mc_mean=0.1471 mb_mean=0.4961 norm_overlap=0.9968 corr_cb=-0.1369
[EPOCH 016/089] train: loss=0.9758 acc=72.35% | val: loss=0.6112 acc=68.67% f1=70.45% auc=73.26% val_score=65.3584 val_score_bestthr=71.3392 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.147, mb=0.496, no=0.997, corr=-0.137) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.1471 -> 71.3392
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1211 mb_mean=0.4972 norm_overlap=0.9988 corr_cb=-0.0535 topkJ=0.0592
[TRAIN][ep=017] loss=1.0539 acc=71.95%
[TRAIN][ep=017] mask_avg: mc_mean=0.1325 mb_mean=0.4961 norm_overlap=0.9971 corr_cb=-0.1120
[EPOCH 017/089] train: loss=1.0539 acc=71.95% | val: loss=0.7317 acc=71.08% f1=72.09% auc=72.56% val_score=46.9534 val_score_bestthr=71.2875 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.132, mb=0.496, no=0.997, corr=-0.112) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.1471 -> 71.2875
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1387 mb_mean=0.4952 norm_overlap=0.9978 corr_cb=-0.0799 topkJ=0.0395
[TRAIN][ep=018] loss=1.1228 acc=71.81%
[TRAIN][ep=018] mask_avg: mc_mean=0.1497 mb_mean=0.4961 norm_overlap=0.9962 corr_cb=-0.1502
[EPOCH 018/089] train: loss=1.1228 acc=71.81% | val: loss=0.6357 acc=74.70% f1=76.92% auc=73.72% val_score=53.6088 val_score_bestthr=74.1638 | dyn(w_pfs=0.240, w_sup=0.240, w_csuf=0.200, stage2=False) | mask(mc=0.150, mb=0.496, no=0.996, corr=-0.150) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.1471 -> 74.1638
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1494 mb_mean=0.4952 norm_overlap=0.9960 corr_cb=-0.1270 topkJ=0.0239
[TRAIN][ep=019] loss=1.1317 acc=71.68%
[TRAIN][ep=019] mask_avg: mc_mean=0.1334 mb_mean=0.4961 norm_overlap=0.9968 corr_cb=-0.1178
[EPOCH 019/089] train: loss=1.1317 acc=71.68% | val: loss=0.6238 acc=65.06% f1=70.71% auc=72.33% val_score=67.0091 val_score_bestthr=69.1666 | dyn(w_pfs=0.280, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.133, mb=0.496, no=0.997, corr=-0.118) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.1471 -> 69.1666
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1599 mb_mean=0.4987 norm_overlap=0.9950 corr_cb=-0.2248 topkJ=0.0339
[TRAIN][ep=020] loss=1.1277 acc=73.56%
[TRAIN][ep=020] mask_avg: mc_mean=0.1545 mb_mean=0.4961 norm_overlap=0.9964 corr_cb=-0.1430
[EPOCH 020/089] train: loss=1.1277 acc=73.56% | val: loss=0.6111 acc=68.67% f1=72.34% auc=73.20% val_score=67.9202 val_score_bestthr=70.9738 | dyn(w_pfs=0.180, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.155, mb=0.496, no=0.996, corr=-0.143) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.1471 -> 70.9738
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.1348 mb_mean=0.5007 norm_overlap=0.9944 corr_cb=-0.2007 topkJ=0.0189
[TRAIN][ep=021] loss=0.9245 acc=73.15%
[TRAIN][ep=021] mask_avg: mc_mean=0.1635 mb_mean=0.4961 norm_overlap=0.9961 corr_cb=-0.1535
[EPOCH 021/089] train: loss=0.9245 acc=73.15% | val: loss=0.6310 acc=69.88% f1=73.12% auc=73.02% val_score=67.0091 val_score_bestthr=70.3364 | dyn(w_pfs=0.080, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.163, mb=0.496, no=0.996, corr=-0.154) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.1471 -> 70.3364
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1708 mb_mean=0.4922 norm_overlap=1.0001 corr_cb=0.0027 topkJ=0.0647
[TRAIN][ep=022] loss=0.7305 acc=76.51%
[TRAIN][ep=022] mask_avg: mc_mean=0.1477 mb_mean=0.4961 norm_overlap=0.9966 corr_cb=-0.1274
[EPOCH 022/089] train: loss=0.7305 acc=76.51% | val: loss=0.6214 acc=73.49% f1=75.56% auc=73.14% val_score=62.2015 val_score_bestthr=74.9072 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.148, mb=0.496, no=0.997, corr=-0.127) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.1471 -> 74.9072
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1548 mb_mean=0.4973 norm_overlap=0.9945 corr_cb=-0.2054 topkJ=0.0190
[TRAIN][ep=023] loss=0.7010 acc=74.36%
[TRAIN][ep=023] mask_avg: mc_mean=0.1396 mb_mean=0.4961 norm_overlap=0.9964 corr_cb=-0.1240
[EPOCH 023/089] train: loss=0.7010 acc=74.36% | val: loss=0.6362 acc=73.49% f1=76.09% auc=73.08% val_score=53.5389 val_score_bestthr=73.1003 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.140, mb=0.496, no=0.996, corr=-0.124) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.1471 -> 73.1003
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1640 mb_mean=0.4928 norm_overlap=0.9972 corr_cb=-0.0969 topkJ=0.0872
[TRAIN][ep=024] loss=0.7278 acc=72.21%
[TRAIN][ep=024] mask_avg: mc_mean=0.1559 mb_mean=0.4961 norm_overlap=0.9961 corr_cb=-0.1421
[EPOCH 024/089] train: loss=0.7278 acc=72.21% | val: loss=0.6147 acc=69.88% f1=73.12% auc=73.49% val_score=69.8899 val_score_bestthr=71.4203 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.156, mb=0.496, no=0.996, corr=-0.142) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.1471 -> 71.4203
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1213 mb_mean=0.4964 norm_overlap=0.9948 corr_cb=-0.1431 topkJ=0.0327
[TRAIN][ep=025] loss=0.7127 acc=74.09%
[TRAIN][ep=025] mask_avg: mc_mean=0.1416 mb_mean=0.4961 norm_overlap=0.9959 corr_cb=-0.1435
[EPOCH 025/089] train: loss=0.7127 acc=74.09% | val: loss=0.6054 acc=69.88% f1=73.12% auc=73.37% val_score=65.3226 val_score_bestthr=71.4203 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.142, mb=0.496, no=0.996, corr=-0.144) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.1471 -> 71.4203
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1397 mb_mean=0.4934 norm_overlap=1.0019 corr_cb=0.0539 topkJ=0.0356
[TRAIN][ep=026] loss=0.6916 acc=75.70%
[TRAIN][ep=026] mask_avg: mc_mean=0.1685 mb_mean=0.4961 norm_overlap=0.9959 corr_cb=-0.1596
[EPOCH 026/089] train: loss=0.6916 acc=75.70% | val: loss=0.6198 acc=67.47% f1=71.58% auc=73.43% val_score=63.3703 val_score_bestthr=69.1525 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.169, mb=0.496, no=0.996, corr=-0.160) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.1471 -> 69.1525
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1672 mb_mean=0.4995 norm_overlap=0.9962 corr_cb=-0.1513 topkJ=0.0250
[TRAIN][ep=027] loss=0.6904 acc=75.30%
[TRAIN][ep=027] mask_avg: mc_mean=0.1604 mb_mean=0.4961 norm_overlap=0.9963 corr_cb=-0.1349
[EPOCH 027/089] train: loss=0.6904 acc=75.30% | val: loss=0.6394 acc=69.88% f1=73.68% auc=73.84% val_score=54.8446 val_score_bestthr=70.1456 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.160, mb=0.496, no=0.996, corr=-0.135) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.1471 -> 70.1456
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1818 mb_mean=0.4920 norm_overlap=0.9991 corr_cb=-0.0360 topkJ=0.0497
[TRAIN][ep=028] loss=0.6771 acc=75.44%
[TRAIN][ep=028] mask_avg: mc_mean=0.1777 mb_mean=0.4961 norm_overlap=0.9960 corr_cb=-0.1528
[EPOCH 028/089] train: loss=0.6771 acc=75.44% | val: loss=0.6458 acc=67.47% f1=75.23% auc=72.73% val_score=66.2883 val_score_bestthr=71.2190 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.178, mb=0.496, no=0.996, corr=-0.153) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.1471 -> 71.2190
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.1600 mb_mean=0.4915 norm_overlap=0.9996 corr_cb=-0.0158 topkJ=0.0576
[TRAIN][ep=029] loss=0.6683 acc=77.32%
[TRAIN][ep=029] mask_avg: mc_mean=0.1773 mb_mean=0.4961 norm_overlap=0.9963 corr_cb=-0.1457
[EPOCH 029/089] train: loss=0.6683 acc=77.32% | val: loss=0.6332 acc=68.67% f1=72.34% auc=72.91% val_score=70.6805 val_score_bestthr=70.6805 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.177, mb=0.496, no=0.996, corr=-0.146) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.1471 -> 70.6805
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2137 mb_mean=0.4964 norm_overlap=0.9955 corr_cb=-0.2022 topkJ=0.0481
[TRAIN][ep=030] loss=0.6628 acc=77.85%
[TRAIN][ep=030] mask_avg: mc_mean=0.2056 mb_mean=0.4961 norm_overlap=0.9959 corr_cb=-0.1750
[EPOCH 030/089] train: loss=0.6628 acc=77.85% | val: loss=0.6314 acc=68.67% f1=75.93% auc=73.72% val_score=62.2600 val_score_bestthr=71.6173 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.206, mb=0.496, no=0.996, corr=-0.175) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.1471 -> 71.6173
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.1454 mb_mean=0.4928 norm_overlap=0.9998 corr_cb=-0.0056 topkJ=0.0616
[TRAIN][ep=031] loss=0.6607 acc=78.12%
[TRAIN][ep=031] mask_avg: mc_mean=0.1626 mb_mean=0.4961 norm_overlap=0.9968 corr_cb=-0.1169
[EPOCH 031/089] train: loss=0.6607 acc=78.12% | val: loss=0.6351 acc=66.27% f1=74.07% auc=73.14% val_score=57.4434 val_score_bestthr=69.6610 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.163, mb=0.496, no=0.997, corr=-0.117) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.1471 -> 69.6610
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1758 mb_mean=0.4973 norm_overlap=1.0001 corr_cb=0.0049 topkJ=0.0647
[TRAIN][ep=032] loss=0.6475 acc=77.72%
[TRAIN][ep=032] mask_avg: mc_mean=0.1798 mb_mean=0.4961 norm_overlap=0.9967 corr_cb=-0.1259
[EPOCH 032/089] train: loss=0.6475 acc=77.72% | val: loss=0.7655 acc=67.47% f1=75.23% auc=72.85% val_score=40.4927 val_score_bestthr=68.6579 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.180, mb=0.496, no=0.997, corr=-0.126) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.1471 -> 68.6579
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2250 mb_mean=0.4971 norm_overlap=0.9981 corr_cb=-0.1042 topkJ=0.0402
[TRAIN][ep=033] loss=0.6559 acc=78.26%
[TRAIN][ep=033] mask_avg: mc_mean=0.2019 mb_mean=0.4961 norm_overlap=0.9961 corr_cb=-0.1604
[EPOCH 033/089] train: loss=0.6559 acc=78.26% | val: loss=0.6586 acc=66.27% f1=72.00% auc=73.02% val_score=56.6749 val_score_bestthr=68.4923 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.202, mb=0.496, no=0.996, corr=-0.160) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.1471 -> 68.4923
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1415 mb_mean=0.4943 norm_overlap=0.9966 corr_cb=-0.1258 topkJ=0.0440
[TRAIN][ep=034] loss=0.6351 acc=78.93%
[TRAIN][ep=034] mask_avg: mc_mean=0.1940 mb_mean=0.4961 norm_overlap=0.9966 corr_cb=-0.1358
[EPOCH 034/089] train: loss=0.6351 acc=78.93% | val: loss=0.6858 acc=71.08% f1=75.00% auc=71.74% val_score=73.4713 val_score_bestthr=73.4713 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.194, mb=0.496, no=0.997, corr=-0.136) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.1471 -> 73.4713
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.1959 mb_mean=0.4949 norm_overlap=0.9960 corr_cb=-0.1739 topkJ=0.0489
[TRAIN][ep=035] loss=0.6256 acc=80.54%
[TRAIN][ep=035] mask_avg: mc_mean=0.1845 mb_mean=0.4961 norm_overlap=0.9973 corr_cb=-0.1040
[EPOCH 035/089] train: loss=0.6256 acc=80.54% | val: loss=0.6945 acc=68.67% f1=75.47% auc=72.38% val_score=66.7535 val_score_bestthr=70.4582 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.185, mb=0.496, no=0.997, corr=-0.104) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.1471 -> 70.4582
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.1967 mb_mean=0.4988 norm_overlap=0.9972 corr_cb=-0.1101 topkJ=0.0333
[TRAIN][ep=036] loss=0.6442 acc=77.99%
[TRAIN][ep=036] mask_avg: mc_mean=0.2392 mb_mean=0.4961 norm_overlap=0.9956 corr_cb=-0.1911
[EPOCH 036/089] train: loss=0.6442 acc=77.99% | val: loss=0.6548 acc=69.88% f1=73.12% auc=72.62% val_score=70.1697 val_score_bestthr=70.1697 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.239, mb=0.496, no=0.996, corr=-0.191) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.1471 -> 70.1697
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1911 mb_mean=0.4955 norm_overlap=0.9963 corr_cb=-0.1241 topkJ=0.0561
[TRAIN][ep=037] loss=0.6275 acc=80.13%
[TRAIN][ep=037] mask_avg: mc_mean=0.1914 mb_mean=0.4961 norm_overlap=0.9966 corr_cb=-0.1285
[EPOCH 037/089] train: loss=0.6275 acc=80.13% | val: loss=0.6922 acc=66.27% f1=74.07% auc=73.08% val_score=50.0246 val_score_bestthr=67.0998 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.191, mb=0.496, no=0.997, corr=-0.129) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.1471 -> 67.0998
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.1484 mb_mean=0.4959 norm_overlap=0.9977 corr_cb=-0.0845 topkJ=0.0431
[TRAIN][ep=038] loss=0.6090 acc=80.27%
[TRAIN][ep=038] mask_avg: mc_mean=0.2145 mb_mean=0.4961 norm_overlap=0.9958 corr_cb=-0.1653
[EPOCH 038/089] train: loss=0.6090 acc=80.27% | val: loss=0.6801 acc=71.08% f1=75.00% auc=71.86% val_score=70.1456 val_score_bestthr=73.4713 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.215, mb=0.496, no=0.996, corr=-0.165) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.1471 -> 73.4713
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2558 mb_mean=0.4995 norm_overlap=0.9912 corr_cb=-0.3432 topkJ=0.0198
[TRAIN][ep=039] loss=0.6247 acc=79.06%
[TRAIN][ep=039] mask_avg: mc_mean=0.1897 mb_mean=0.4961 norm_overlap=0.9966 corr_cb=-0.1271
[EPOCH 039/089] train: loss=0.6247 acc=79.06% | val: loss=0.6628 acc=68.67% f1=74.51% auc=72.85% val_score=63.3532 val_score_bestthr=70.2418 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.496, no=0.997, corr=-0.127) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.1471 -> 70.2418
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.2117 mb_mean=0.4932 norm_overlap=0.9953 corr_cb=-0.2165 topkJ=0.0260
[TRAIN][ep=040] loss=0.6047 acc=80.00%
[TRAIN][ep=040] mask_avg: mc_mean=0.1947 mb_mean=0.4961 norm_overlap=0.9969 corr_cb=-0.1228
[EPOCH 040/089] train: loss=0.6047 acc=80.00% | val: loss=0.6896 acc=67.47% f1=74.77% auc=72.73% val_score=58.1869 val_score_bestthr=68.6174 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.195, mb=0.496, no=0.997, corr=-0.123) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.1471 -> 68.6174
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.0866 mb_mean=0.4935 norm_overlap=1.0068 corr_cb=0.1334 topkJ=0.1008
[TRAIN][ep=041] loss=0.6009 acc=79.87%
[TRAIN][ep=041] mask_avg: mc_mean=0.1902 mb_mean=0.4961 norm_overlap=0.9968 corr_cb=-0.1240
[EPOCH 041/089] train: loss=0.6009 acc=79.87% | val: loss=0.6777 acc=69.88% f1=73.12% auc=72.56% val_score=70.1697 val_score_bestthr=70.1697 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.496, no=0.997, corr=-0.124) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.1471 -> 70.1697
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.1882 mb_mean=0.4948 norm_overlap=1.0001 corr_cb=0.0051 topkJ=0.0411
[TRAIN][ep=042] loss=0.6048 acc=80.94%
[TRAIN][ep=042] mask_avg: mc_mean=0.2122 mb_mean=0.4961 norm_overlap=0.9965 corr_cb=-0.1413
[EPOCH 042/089] train: loss=0.6048 acc=80.94% | val: loss=0.7141 acc=67.47% f1=73.27% auc=72.62% val_score=47.2549 val_score_bestthr=68.7622 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.212, mb=0.496, no=0.996, corr=-0.141) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.1471 -> 68.7622
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.1555 mb_mean=0.4973 norm_overlap=0.9986 corr_cb=-0.0413 topkJ=0.0296
[TRAIN][ep=043] loss=0.5838 acc=83.09%
[TRAIN][ep=043] mask_avg: mc_mean=0.1998 mb_mean=0.4961 norm_overlap=0.9961 corr_cb=-0.1457
[EPOCH 043/089] train: loss=0.5838 acc=83.09% | val: loss=0.7469 acc=67.47% f1=75.23% auc=72.44% val_score=52.1160 val_score_bestthr=66.9079 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.200, mb=0.496, no=0.996, corr=-0.146) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.1471 -> 66.9079
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2409 mb_mean=0.4990 norm_overlap=0.9958 corr_cb=-0.2031 topkJ=0.0384
[TRAIN][ep=044] loss=0.5967 acc=82.01%
[TRAIN][ep=044] mask_avg: mc_mean=0.2032 mb_mean=0.4961 norm_overlap=0.9964 corr_cb=-0.1357
[EPOCH 044/089] train: loss=0.5967 acc=82.01% | val: loss=0.6908 acc=69.88% f1=73.68% auc=70.93% val_score=64.4758 val_score_bestthr=70.1456 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.203, mb=0.496, no=0.996, corr=-0.136) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.1471 -> 70.1456
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2884 mb_mean=0.4928 norm_overlap=0.9941 corr_cb=-0.2701 topkJ=0.0261
[TRAIN][ep=045] loss=0.5968 acc=80.94%
[TRAIN][ep=045] mask_avg: mc_mean=0.2588 mb_mean=0.4961 norm_overlap=0.9952 corr_cb=-0.2099
[EPOCH 045/089] train: loss=0.5968 acc=80.94% | val: loss=0.7701 acc=69.88% f1=73.68% auc=71.63% val_score=65.2293 val_score_bestthr=70.1456 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.259, mb=0.496, no=0.995, corr=-0.210) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 76.1471 -> 70.1456
[EARLY STOP] no improvement for 30 epochs. best_epoch=15
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
=============== FIT DONE ===============
[BEST] epoch=15 | val_acc=72.29% | val_f1=72.29% | val_auc=73.08% | val_score=52.5831 | val_score_bestthr=76.1471
[TEST@BEST] thr_used=0.200 | acc=57.00% f1=69.62% auc=62.55% | SP_sex=2.13% EO_sex=1.23% SP_age=12.47% EO_age=11.43%
[TIME] 1.29 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/summary_fold_2.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4477 mb_mean=0.4964 norm_overlap=1.0006 corr_cb=0.6199 topkJ=0.1849
[TRAIN][ep=000] loss=0.6951 acc=47.25%
[TRAIN][ep=000] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5111
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4378 mb_mean=0.4940 norm_overlap=1.0005 corr_cb=0.5338 topkJ=0.1816
[TRAIN][ep=001] loss=0.6926 acc=50.74%
[TRAIN][ep=001] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5175
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4517 mb_mean=0.4988 norm_overlap=1.0004 corr_cb=0.4909 topkJ=0.1226
[TRAIN][ep=002] loss=0.6926 acc=52.21%
[TRAIN][ep=002] mask_avg: mc_mean=0.4463 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5077
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4474 mb_mean=0.4963 norm_overlap=1.0004 corr_cb=0.4696 topkJ=0.1653
[TRAIN][ep=003] loss=0.6924 acc=52.75%
[TRAIN][ep=003] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5044
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4425 mb_mean=0.4921 norm_overlap=1.0010 corr_cb=0.7152 topkJ=0.2130
[TRAIN][ep=004] loss=0.6910 acc=52.62%
[TRAIN][ep=004] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5027
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4529 mb_mean=0.4986 norm_overlap=1.0003 corr_cb=0.4542 topkJ=0.1703
[TRAIN][ep=005] loss=0.6877 acc=57.58%
[TRAIN][ep=005] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5020
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4536 mb_mean=0.4984 norm_overlap=1.0003 corr_cb=0.3933 topkJ=0.1356
[TRAIN][ep=006] loss=0.6858 acc=57.99%
[TRAIN][ep=006] mask_avg: mc_mean=0.4463 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5030
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4543 mb_mean=0.4986 norm_overlap=1.0005 corr_cb=0.5123 topkJ=0.1231
[TRAIN][ep=007] loss=0.6832 acc=55.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5158
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4444 mb_mean=0.4958 norm_overlap=1.0005 corr_cb=0.5646 topkJ=0.1270
[TRAIN][ep=008] loss=0.6779 acc=56.51%
[TRAIN][ep=008] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5070
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4465 mb_mean=0.4969 norm_overlap=1.0003 corr_cb=0.4721 topkJ=0.1699
[TRAIN][ep=009] loss=0.6742 acc=62.01%
[TRAIN][ep=009] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5069
================= FIT START (fold=2) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4558 mb_mean=0.5004 norm_overlap=1.0002 corr_cb=0.3859 topkJ=0.1398
[TRAIN][ep=000] loss=0.6720 acc=59.33%
[TRAIN][ep=000] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5085
[EPOCH 000/089] train: loss=0.6720 acc=59.33% | val: loss=0.6776 acc=66.27% f1=67.44% auc=65.12% val_score=46.1149 val_score_bestthr=65.4959 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.446, mb=0.496, no=1.000, corr=0.509) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 65.4959
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4538 mb_mean=0.4979 norm_overlap=1.0003 corr_cb=0.4016 topkJ=0.2040
[TRAIN][ep=001] loss=0.6664 acc=62.68%
[TRAIN][ep=001] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5121
[EPOCH 001/089] train: loss=0.6664 acc=62.68% | val: loss=0.6657 acc=66.27% f1=69.57% auc=68.84% val_score=56.0160 val_score_bestthr=65.5986 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.446, mb=0.496, no=1.001, corr=0.512) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 65.4959 -> 65.5986
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4475 mb_mean=0.4963 norm_overlap=1.0004 corr_cb=0.4390 topkJ=0.0795
[TRAIN][ep=002] loss=0.6613 acc=63.36%
[TRAIN][ep=002] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5046
[EPOCH 002/089] train: loss=0.6613 acc=63.36% | val: loss=0.6613 acc=69.88% f1=70.59% auc=68.90% val_score=57.5322 val_score_bestthr=68.8390 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.446, mb=0.496, no=1.000, corr=0.505) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 65.5986 -> 68.8390
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4442 mb_mean=0.4982 norm_overlap=1.0006 corr_cb=0.5457 topkJ=0.1279
[TRAIN][ep=003] loss=0.6621 acc=61.34%
[TRAIN][ep=003] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5061
[EPOCH 003/089] train: loss=0.6621 acc=61.34% | val: loss=0.6595 acc=67.47% f1=69.66% auc=69.07% val_score=50.4387 val_score_bestthr=66.0988 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.446, mb=0.496, no=1.000, corr=0.506) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 66.0988
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4474 mb_mean=0.4978 norm_overlap=1.0003 corr_cb=0.4220 topkJ=0.0832
[TRAIN][ep=004] loss=0.6505 acc=62.15%
[TRAIN][ep=004] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5086
[EPOCH 004/089] train: loss=0.6505 acc=62.15% | val: loss=0.6536 acc=66.27% f1=67.44% auc=69.65% val_score=54.9266 val_score_bestthr=66.0495 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.446, mb=0.496, no=1.001, corr=0.509) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 66.0495
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4503 mb_mean=0.4974 norm_overlap=1.0004 corr_cb=0.4973 topkJ=0.1639
[TRAIN][ep=005] loss=1.4605 acc=62.82%
[TRAIN][ep=005] mask_avg: mc_mean=0.3252 mb_mean=0.4961 norm_overlap=1.0022 corr_cb=0.5182
[EPOCH 005/089] train: loss=1.4605 acc=62.82% | val: loss=0.6931 acc=65.06% f1=65.06% auc=66.63% val_score=36.2032 val_score_bestthr=65.1175 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.325, mb=0.496, no=1.002, corr=0.518) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 65.1175
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2593 mb_mean=0.4955 norm_overlap=1.0033 corr_cb=0.4761 topkJ=0.1449
[TRAIN][ep=006] loss=1.4348 acc=64.56%
[TRAIN][ep=006] mask_avg: mc_mean=0.2445 mb_mean=0.4961 norm_overlap=1.0030 corr_cb=0.4050
[EPOCH 006/089] train: loss=1.4348 acc=64.56% | val: loss=0.6484 acc=65.06% f1=73.39% auc=70.81% val_score=65.8299 val_score_bestthr=65.8299 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.244, mb=0.496, no=1.003, corr=0.405) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 65.8299
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2051 mb_mean=0.4933 norm_overlap=1.0038 corr_cb=0.4507 topkJ=0.2081
[TRAIN][ep=007] loss=1.4224 acc=64.03%
[TRAIN][ep=007] mask_avg: mc_mean=0.2238 mb_mean=0.4961 norm_overlap=1.0025 corr_cb=0.2831
[EPOCH 007/089] train: loss=1.4224 acc=64.03% | val: loss=0.6514 acc=66.27% f1=73.08% auc=70.70% val_score=64.2121 val_score_bestthr=68.4967 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.224, mb=0.496, no=1.002, corr=0.283) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 68.4967
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1446 mb_mean=0.4919 norm_overlap=1.0018 corr_cb=0.2068 topkJ=0.1378
[TRAIN][ep=008] loss=1.2170 acc=67.79%
[TRAIN][ep=008] mask_avg: mc_mean=0.2014 mb_mean=0.4961 norm_overlap=1.0020 corr_cb=0.1860
[EPOCH 008/089] train: loss=1.2170 acc=67.79% | val: loss=0.6388 acc=65.06% f1=72.90% auc=70.52% val_score=59.8879 val_score_bestthr=67.2210 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.201, mb=0.496, no=1.002, corr=0.186) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 67.2210
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2086 mb_mean=0.4948 norm_overlap=1.0039 corr_cb=0.3133 topkJ=0.0740
[TRAIN][ep=009] loss=1.0169 acc=65.37%
[TRAIN][ep=009] mask_avg: mc_mean=0.1834 mb_mean=0.4961 norm_overlap=1.0012 corr_cb=0.0824
[EPOCH 009/089] train: loss=1.0169 acc=65.37% | val: loss=0.6402 acc=65.06% f1=73.39% auc=70.47% val_score=65.0471 val_score_bestthr=65.8299 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.183, mb=0.496, no=1.001, corr=0.082) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 65.8299
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1786 mb_mean=0.4972 norm_overlap=0.9992 corr_cb=-0.0738 topkJ=0.0544
[TRAIN][ep=010] loss=0.9744 acc=66.31%
[TRAIN][ep=010] mask_avg: mc_mean=0.1892 mb_mean=0.4961 norm_overlap=1.0001 corr_cb=-0.0016
[EPOCH 010/089] train: loss=0.9744 acc=66.31% | val: loss=0.6293 acc=67.47% f1=68.97% auc=70.93% val_score=65.1939 val_score_bestthr=66.3074 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.189, mb=0.496, no=1.000, corr=-0.002) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 66.3074
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1745 mb_mean=0.4971 norm_overlap=1.0016 corr_cb=0.1138 topkJ=0.0473
[TRAIN][ep=011] loss=0.9386 acc=69.80%
[TRAIN][ep=011] mask_avg: mc_mean=0.1771 mb_mean=0.4961 norm_overlap=0.9996 corr_cb=-0.0315
[EPOCH 011/089] train: loss=0.9386 acc=69.80% | val: loss=0.7330 acc=67.47% f1=64.94% auc=67.15% val_score=37.1849 val_score_bestthr=67.1908 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.177, mb=0.496, no=1.000, corr=-0.031) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 67.1908
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1591 mb_mean=0.4951 norm_overlap=0.9974 corr_cb=-0.1594 topkJ=0.0235
[TRAIN][ep=012] loss=0.9522 acc=68.05%
[TRAIN][ep=012] mask_avg: mc_mean=0.1460 mb_mean=0.4961 norm_overlap=1.0000 corr_cb=-0.0200
[EPOCH 012/089] train: loss=0.9522 acc=68.05% | val: loss=0.6263 acc=65.06% f1=73.87% auc=71.80% val_score=61.4342 val_score_bestthr=68.7451 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.146, mb=0.496, no=1.000, corr=-0.020) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 68.7451
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.0873 mb_mean=0.4969 norm_overlap=0.9999 corr_cb=-0.0037 topkJ=0.0467
[TRAIN][ep=013] loss=0.9251 acc=70.20%
[TRAIN][ep=013] mask_avg: mc_mean=0.1157 mb_mean=0.4961 norm_overlap=0.9997 corr_cb=-0.0248
[EPOCH 013/089] train: loss=0.9251 acc=70.20% | val: loss=0.6226 acc=68.67% f1=70.45% auc=72.03% val_score=69.8352 val_score_bestthr=69.8352 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.116, mb=0.496, no=1.000, corr=-0.025) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 68.8390 -> 69.8352
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1641 mb_mean=0.4985 norm_overlap=0.9965 corr_cb=-0.1903 topkJ=0.0276
[TRAIN][ep=014] loss=1.0023 acc=69.66%
[TRAIN][ep=014] mask_avg: mc_mean=0.1490 mb_mean=0.4961 norm_overlap=0.9976 corr_cb=-0.1199
[EPOCH 014/089] train: loss=1.0023 acc=69.66% | val: loss=0.6157 acc=66.27% f1=68.89% auc=71.92% val_score=63.6411 val_score_bestthr=68.7286 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.149, mb=0.496, no=0.998, corr=-0.120) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.8352 -> 68.7286
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1692 mb_mean=0.4977 norm_overlap=0.9990 corr_cb=-0.0393 topkJ=0.0750
[TRAIN][ep=015] loss=1.0737 acc=67.92%
[TRAIN][ep=015] mask_avg: mc_mean=0.1355 mb_mean=0.4961 norm_overlap=0.9978 corr_cb=-0.0982
[EPOCH 015/089] train: loss=1.0737 acc=67.92% | val: loss=0.6348 acc=71.08% f1=72.09% auc=72.62% val_score=52.5831 val_score_bestthr=74.6637 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.136, mb=0.496, no=0.998, corr=-0.098) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 69.8352 -> 74.6637
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1788 mb_mean=0.4984 norm_overlap=0.9909 corr_cb=-0.4145 topkJ=0.0100
[TRAIN][ep=016] loss=1.1346 acc=72.48%
[TRAIN][ep=016] mask_avg: mc_mean=0.1511 mb_mean=0.4961 norm_overlap=0.9968 corr_cb=-0.1393
[EPOCH 016/089] train: loss=1.1346 acc=72.48% | val: loss=0.6128 acc=68.67% f1=70.45% auc=73.02% val_score=67.4883 val_score_bestthr=70.9604 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.151, mb=0.496, no=0.997, corr=-0.139) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 70.9604
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1274 mb_mean=0.4972 norm_overlap=0.9987 corr_cb=-0.0626 topkJ=0.0575
[TRAIN][ep=017] loss=1.2118 acc=72.21%
[TRAIN][ep=017] mask_avg: mc_mean=0.1352 mb_mean=0.4961 norm_overlap=0.9971 corr_cb=-0.1122
[EPOCH 017/089] train: loss=1.2118 acc=72.21% | val: loss=0.7309 acc=72.29% f1=72.94% auc=72.21% val_score=46.9534 val_score_bestthr=71.9029 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.135, mb=0.496, no=0.997, corr=-0.112) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 71.9029
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1426 mb_mean=0.4952 norm_overlap=0.9977 corr_cb=-0.0856 topkJ=0.0382
[TRAIN][ep=018] loss=1.2801 acc=71.41%
[TRAIN][ep=018] mask_avg: mc_mean=0.1530 mb_mean=0.4961 norm_overlap=0.9963 corr_cb=-0.1518
[EPOCH 018/089] train: loss=1.2801 acc=71.41% | val: loss=0.6363 acc=72.29% f1=75.79% auc=73.49% val_score=50.8730 val_score_bestthr=74.1317 | dyn(w_pfs=0.240, w_sup=0.240, w_csuf=0.200, stage2=False) | mask(mc=0.153, mb=0.496, no=0.996, corr=-0.152) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 74.1317
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1485 mb_mean=0.4952 norm_overlap=0.9962 corr_cb=-0.1206 topkJ=0.0247
[TRAIN][ep=019] loss=1.2887 acc=71.68%
[TRAIN][ep=019] mask_avg: mc_mean=0.1343 mb_mean=0.4961 norm_overlap=0.9969 corr_cb=-0.1162
[EPOCH 019/089] train: loss=1.2887 acc=71.68% | val: loss=0.6252 acc=66.27% f1=72.00% auc=72.50% val_score=67.0091 val_score_bestthr=69.5319 | dyn(w_pfs=0.280, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.134, mb=0.496, no=0.997, corr=-0.116) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 69.5319
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1598 mb_mean=0.4987 norm_overlap=0.9951 corr_cb=-0.2240 topkJ=0.0348
[TRAIN][ep=020] loss=1.2845 acc=73.83%
[TRAIN][ep=020] mask_avg: mc_mean=0.1572 mb_mean=0.4961 norm_overlap=0.9964 corr_cb=-0.1447
[EPOCH 020/089] train: loss=1.2845 acc=73.83% | val: loss=0.6122 acc=67.47% f1=71.58% auc=73.20% val_score=69.4458 val_score_bestthr=69.4458 | dyn(w_pfs=0.180, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.157, mb=0.496, no=0.996, corr=-0.145) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 69.4458
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.1426 mb_mean=0.5007 norm_overlap=0.9944 corr_cb=-0.2114 topkJ=0.0172
[TRAIN][ep=021] loss=1.0808 acc=73.15%
[TRAIN][ep=021] mask_avg: mc_mean=0.1655 mb_mean=0.4961 norm_overlap=0.9962 corr_cb=-0.1530
[EPOCH 021/089] train: loss=1.0808 acc=73.15% | val: loss=0.6320 acc=69.88% f1=73.12% auc=72.97% val_score=67.0091 val_score_bestthr=70.3364 | dyn(w_pfs=0.080, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.165, mb=0.496, no=0.996, corr=-0.153) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 70.3364
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1691 mb_mean=0.4922 norm_overlap=1.0003 corr_cb=0.0126 topkJ=0.0673
[TRAIN][ep=022] loss=0.8845 acc=76.38%
[TRAIN][ep=022] mask_avg: mc_mean=0.1513 mb_mean=0.4961 norm_overlap=0.9967 corr_cb=-0.1280
[EPOCH 022/089] train: loss=0.8845 acc=76.38% | val: loss=0.6213 acc=72.29% f1=74.73% auc=73.26% val_score=64.0505 val_score_bestthr=73.6325 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.151, mb=0.496, no=0.997, corr=-0.128) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 73.6325
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1575 mb_mean=0.4973 norm_overlap=0.9948 corr_cb=-0.2016 topkJ=0.0206
[TRAIN][ep=023] loss=0.8546 acc=74.36%
[TRAIN][ep=023] mask_avg: mc_mean=0.1459 mb_mean=0.4961 norm_overlap=0.9964 corr_cb=-0.1301
[EPOCH 023/089] train: loss=0.8546 acc=74.36% | val: loss=0.6386 acc=72.29% f1=75.27% auc=72.56% val_score=55.7106 val_score_bestthr=72.4202 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.146, mb=0.496, no=0.996, corr=-0.130) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 72.4202
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1674 mb_mean=0.4928 norm_overlap=0.9971 corr_cb=-0.1049 topkJ=0.0844
[TRAIN][ep=024] loss=0.8802 acc=71.68%
[TRAIN][ep=024] mask_avg: mc_mean=0.1583 mb_mean=0.4961 norm_overlap=0.9962 corr_cb=-0.1423
[EPOCH 024/089] train: loss=0.8802 acc=71.68% | val: loss=0.6166 acc=69.88% f1=73.12% auc=73.43% val_score=69.0402 val_score_bestthr=71.4203 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.158, mb=0.496, no=0.996, corr=-0.142) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 71.4203
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1258 mb_mean=0.4964 norm_overlap=0.9950 corr_cb=-0.1445 topkJ=0.0323
[TRAIN][ep=025] loss=0.8623 acc=74.36%
[TRAIN][ep=025] mask_avg: mc_mean=0.1570 mb_mean=0.4961 norm_overlap=0.9957 corr_cb=-0.1631
[EPOCH 025/089] train: loss=0.8623 acc=74.36% | val: loss=0.6071 acc=71.08% f1=73.91% auc=73.20% val_score=65.4911 val_score_bestthr=72.9533 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.157, mb=0.496, no=0.996, corr=-0.163) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 72.9533
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1442 mb_mean=0.4934 norm_overlap=1.0018 corr_cb=0.0544 topkJ=0.0360
[TRAIN][ep=026] loss=0.8396 acc=76.38%
[TRAIN][ep=026] mask_avg: mc_mean=0.1685 mb_mean=0.4961 norm_overlap=0.9961 corr_cb=-0.1549
[EPOCH 026/089] train: loss=0.8396 acc=76.38% | val: loss=0.6221 acc=68.67% f1=72.34% auc=73.02% val_score=70.6805 val_score_bestthr=70.6805 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.169, mb=0.496, no=0.996, corr=-0.155) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 70.6805
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1732 mb_mean=0.4995 norm_overlap=0.9964 corr_cb=-0.1507 topkJ=0.0246
[TRAIN][ep=027] loss=0.8404 acc=75.57%
[TRAIN][ep=027] mask_avg: mc_mean=0.1645 mb_mean=0.4961 norm_overlap=0.9964 corr_cb=-0.1360
[EPOCH 027/089] train: loss=0.8404 acc=75.57% | val: loss=0.6380 acc=69.88% f1=73.68% auc=73.37% val_score=53.3642 val_score_bestthr=70.1456 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.165, mb=0.496, no=0.996, corr=-0.136) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 70.1456
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1905 mb_mean=0.4920 norm_overlap=0.9990 corr_cb=-0.0445 topkJ=0.0469
[TRAIN][ep=028] loss=0.8231 acc=75.30%
[TRAIN][ep=028] mask_avg: mc_mean=0.1832 mb_mean=0.4961 norm_overlap=0.9962 corr_cb=-0.1546
[EPOCH 028/089] train: loss=0.8231 acc=75.30% | val: loss=0.6465 acc=67.47% f1=74.77% auc=72.85% val_score=66.2883 val_score_bestthr=68.9386 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.183, mb=0.496, no=0.996, corr=-0.155) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 68.9386
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.1582 mb_mean=0.4915 norm_overlap=0.9998 corr_cb=-0.0085 topkJ=0.0580
[TRAIN][ep=029] loss=0.8137 acc=77.32%
[TRAIN][ep=029] mask_avg: mc_mean=0.1787 mb_mean=0.4961 norm_overlap=0.9965 corr_cb=-0.1415
[EPOCH 029/089] train: loss=0.8137 acc=77.32% | val: loss=0.6310 acc=69.88% f1=74.23% auc=72.97% val_score=64.8973 val_score_bestthr=72.5107 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.179, mb=0.496, no=0.997, corr=-0.142) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 72.5107
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2175 mb_mean=0.4964 norm_overlap=0.9956 corr_cb=-0.2040 topkJ=0.0494
[TRAIN][ep=030] loss=0.8058 acc=77.99%
[TRAIN][ep=030] mask_avg: mc_mean=0.2112 mb_mean=0.4961 norm_overlap=0.9960 corr_cb=-0.1787
[EPOCH 030/089] train: loss=0.8058 acc=77.99% | val: loss=0.6321 acc=68.67% f1=75.47% auc=73.78% val_score=60.7322 val_score_bestthr=71.5782 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.211, mb=0.496, no=0.996, corr=-0.179) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 71.5782
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.1501 mb_mean=0.4928 norm_overlap=0.9995 corr_cb=-0.0146 topkJ=0.0607
[TRAIN][ep=031] loss=0.8022 acc=77.99%
[TRAIN][ep=031] mask_avg: mc_mean=0.1668 mb_mean=0.4961 norm_overlap=0.9968 corr_cb=-0.1191
[EPOCH 031/089] train: loss=0.8022 acc=77.99% | val: loss=0.6352 acc=66.27% f1=74.07% auc=72.97% val_score=55.9077 val_score_bestthr=69.6610 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.167, mb=0.496, no=0.997, corr=-0.119) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 69.6610
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1783 mb_mean=0.4973 norm_overlap=1.0001 corr_cb=0.0052 topkJ=0.0629
[TRAIN][ep=032] loss=0.7894 acc=77.58%
[TRAIN][ep=032] mask_avg: mc_mean=0.1841 mb_mean=0.4961 norm_overlap=0.9967 corr_cb=-0.1283
[EPOCH 032/089] train: loss=0.7894 acc=77.58% | val: loss=0.7688 acc=67.47% f1=75.23% auc=72.97% val_score=40.4927 val_score_bestthr=68.6579 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.184, mb=0.496, no=0.997, corr=-0.128) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 68.6579
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2451 mb_mean=0.4971 norm_overlap=0.9979 corr_cb=-0.1196 topkJ=0.0385
[TRAIN][ep=033] loss=0.7964 acc=77.85%
[TRAIN][ep=033] mask_avg: mc_mean=0.2080 mb_mean=0.4961 norm_overlap=0.9961 corr_cb=-0.1647
[EPOCH 033/089] train: loss=0.7964 acc=77.85% | val: loss=0.6586 acc=68.67% f1=74.51% auc=73.31% val_score=56.6749 val_score_bestthr=70.2418 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.208, mb=0.496, no=0.996, corr=-0.165) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 70.2418
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1397 mb_mean=0.4943 norm_overlap=0.9967 corr_cb=-0.1248 topkJ=0.0432
[TRAIN][ep=034] loss=0.7723 acc=78.93%
[TRAIN][ep=034] mask_avg: mc_mean=0.1937 mb_mean=0.4961 norm_overlap=0.9967 corr_cb=-0.1320
[EPOCH 034/089] train: loss=0.7723 acc=78.93% | val: loss=0.6847 acc=71.08% f1=75.00% auc=72.44% val_score=73.4713 val_score_bestthr=73.4713 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.194, mb=0.496, no=0.997, corr=-0.132) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 73.4713
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.1914 mb_mean=0.4949 norm_overlap=0.9965 corr_cb=-0.1521 topkJ=0.0514
[TRAIN][ep=035] loss=0.7635 acc=80.40%
[TRAIN][ep=035] mask_avg: mc_mean=0.1881 mb_mean=0.4961 norm_overlap=0.9973 corr_cb=-0.1058
[EPOCH 035/089] train: loss=0.7635 acc=80.40% | val: loss=0.6918 acc=68.67% f1=75.47% auc=72.09% val_score=66.7535 val_score_bestthr=70.4582 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.188, mb=0.496, no=0.997, corr=-0.106) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 70.4582
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2034 mb_mean=0.4988 norm_overlap=0.9972 corr_cb=-0.1127 topkJ=0.0333
[TRAIN][ep=036] loss=0.7841 acc=77.32%
[TRAIN][ep=036] mask_avg: mc_mean=0.2420 mb_mean=0.4961 norm_overlap=0.9957 corr_cb=-0.1923
[EPOCH 036/089] train: loss=0.7841 acc=77.32% | val: loss=0.6546 acc=71.08% f1=75.00% auc=72.44% val_score=68.2506 val_score_bestthr=73.4713 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.242, mb=0.496, no=0.996, corr=-0.192) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 73.4713
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1939 mb_mean=0.4955 norm_overlap=0.9963 corr_cb=-0.1284 topkJ=0.0540
[TRAIN][ep=037] loss=0.7632 acc=79.73%
[TRAIN][ep=037] mask_avg: mc_mean=0.1922 mb_mean=0.4961 norm_overlap=0.9966 corr_cb=-0.1288
[EPOCH 037/089] train: loss=0.7632 acc=79.73% | val: loss=0.6882 acc=68.67% f1=75.00% auc=72.79% val_score=49.3074 val_score_bestthr=67.7409 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.192, mb=0.496, no=0.997, corr=-0.129) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 67.7409
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.1623 mb_mean=0.4959 norm_overlap=0.9975 corr_cb=-0.0994 topkJ=0.0435
[TRAIN][ep=038] loss=0.7438 acc=80.27%
[TRAIN][ep=038] mask_avg: mc_mean=0.2146 mb_mean=0.4961 norm_overlap=0.9959 corr_cb=-0.1641
[EPOCH 038/089] train: loss=0.7438 acc=80.27% | val: loss=0.6777 acc=71.08% f1=75.00% auc=71.92% val_score=70.1456 val_score_bestthr=73.4713 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.215, mb=0.496, no=0.996, corr=-0.164) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 73.4713
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2513 mb_mean=0.4995 norm_overlap=0.9915 corr_cb=-0.3351 topkJ=0.0194
[TRAIN][ep=039] loss=0.7581 acc=79.60%
[TRAIN][ep=039] mask_avg: mc_mean=0.1941 mb_mean=0.4961 norm_overlap=0.9966 corr_cb=-0.1307
[EPOCH 039/089] train: loss=0.7581 acc=79.60% | val: loss=0.6619 acc=67.47% f1=74.77% auc=72.50% val_score=65.2963 val_score_bestthr=70.0586 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.194, mb=0.496, no=0.997, corr=-0.131) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 70.0586
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.2188 mb_mean=0.4932 norm_overlap=0.9954 corr_cb=-0.2213 topkJ=0.0260
[TRAIN][ep=040] loss=0.7360 acc=80.40%
[TRAIN][ep=040] mask_avg: mc_mean=0.1974 mb_mean=0.4961 norm_overlap=0.9969 corr_cb=-0.1229
[EPOCH 040/089] train: loss=0.7360 acc=80.40% | val: loss=0.6827 acc=69.88% f1=75.73% auc=73.08% val_score=60.2493 val_score_bestthr=69.2639 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.197, mb=0.496, no=0.997, corr=-0.123) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 69.2639
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.0978 mb_mean=0.4935 norm_overlap=1.0056 corr_cb=0.1225 topkJ=0.0980
[TRAIN][ep=041] loss=0.7360 acc=79.87%
[TRAIN][ep=041] mask_avg: mc_mean=0.2000 mb_mean=0.4961 norm_overlap=0.9968 corr_cb=-0.1308
[EPOCH 041/089] train: loss=0.7360 acc=79.87% | val: loss=0.6748 acc=69.88% f1=73.12% auc=72.50% val_score=70.1697 val_score_bestthr=70.1697 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.200, mb=0.496, no=0.997, corr=-0.131) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 70.1697
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.2024 mb_mean=0.4948 norm_overlap=0.9997 corr_cb=-0.0095 topkJ=0.0416
[TRAIN][ep=042] loss=0.7369 acc=80.67%
[TRAIN][ep=042] mask_avg: mc_mean=0.2155 mb_mean=0.4961 norm_overlap=0.9966 corr_cb=-0.1396
[EPOCH 042/089] train: loss=0.7369 acc=80.67% | val: loss=0.7163 acc=67.47% f1=72.73% auc=72.27% val_score=46.1697 val_score_bestthr=70.4269 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.215, mb=0.496, no=0.997, corr=-0.140) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 70.4269
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.1692 mb_mean=0.4973 norm_overlap=0.9980 corr_cb=-0.0620 topkJ=0.0283
[TRAIN][ep=043] loss=0.7140 acc=82.68%
[TRAIN][ep=043] mask_avg: mc_mean=0.2060 mb_mean=0.4961 norm_overlap=0.9961 corr_cb=-0.1492
[EPOCH 043/089] train: loss=0.7140 acc=82.68% | val: loss=0.7541 acc=68.67% f1=75.00% auc=72.44% val_score=44.4718 val_score_bestthr=66.2997 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.206, mb=0.496, no=0.996, corr=-0.149) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 66.2997
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2522 mb_mean=0.4990 norm_overlap=0.9959 corr_cb=-0.2052 topkJ=0.0380
[TRAIN][ep=044] loss=0.7291 acc=81.21%
[TRAIN][ep=044] mask_avg: mc_mean=0.2100 mb_mean=0.4961 norm_overlap=0.9965 corr_cb=-0.1387
[EPOCH 044/089] train: loss=0.7291 acc=81.21% | val: loss=0.6880 acc=68.67% f1=73.47% auc=70.81% val_score=61.3619 val_score_bestthr=72.6181 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.210, mb=0.496, no=0.996, corr=-0.139) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 72.6181
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.3112 mb_mean=0.4928 norm_overlap=0.9940 corr_cb=-0.2984 topkJ=0.0216
[TRAIN][ep=045] loss=0.7253 acc=80.67%
[TRAIN][ep=045] mask_avg: mc_mean=0.2579 mb_mean=0.4961 norm_overlap=0.9954 corr_cb=-0.2047
[EPOCH 045/089] train: loss=0.7253 acc=80.67% | val: loss=0.7725 acc=67.47% f1=74.77% auc=71.57% val_score=65.3952 val_score_bestthr=70.0586 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.258, mb=0.496, no=0.995, corr=-0.205) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 70.0586
[EARLY STOP] no improvement for 30 epochs. best_epoch=15
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
=============== FIT DONE ===============
[BEST] epoch=15 | val_acc=71.08% | val_f1=72.09% | val_auc=72.62% | val_score=52.5831 | val_score_bestthr=74.6637
[TEST@BEST] thr_used=0.205 | acc=57.00% f1=69.62% auc=62.53% | SP_sex=2.13% EO_sex=1.23% SP_age=12.47% EO_age=11.43%
[TIME] 1.25 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/summary_fold_2.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4477 mb_mean=0.4964 norm_overlap=1.0006 corr_cb=0.6199 topkJ=0.1849
[TRAIN][ep=000] loss=0.6951 acc=47.25%
[TRAIN][ep=000] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5111
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4378 mb_mean=0.4940 norm_overlap=1.0005 corr_cb=0.5338 topkJ=0.1816
[TRAIN][ep=001] loss=0.6926 acc=50.74%
[TRAIN][ep=001] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5175
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4517 mb_mean=0.4988 norm_overlap=1.0004 corr_cb=0.4909 topkJ=0.1226
[TRAIN][ep=002] loss=0.6926 acc=52.21%
[TRAIN][ep=002] mask_avg: mc_mean=0.4463 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5077
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4474 mb_mean=0.4963 norm_overlap=1.0004 corr_cb=0.4696 topkJ=0.1653
[TRAIN][ep=003] loss=0.6924 acc=52.75%
[TRAIN][ep=003] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5044
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4425 mb_mean=0.4921 norm_overlap=1.0010 corr_cb=0.7152 topkJ=0.2130
[TRAIN][ep=004] loss=0.6910 acc=52.62%
[TRAIN][ep=004] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5027
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4529 mb_mean=0.4986 norm_overlap=1.0003 corr_cb=0.4542 topkJ=0.1703
[TRAIN][ep=005] loss=0.6877 acc=57.58%
[TRAIN][ep=005] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5020
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4536 mb_mean=0.4984 norm_overlap=1.0003 corr_cb=0.3933 topkJ=0.1356
[TRAIN][ep=006] loss=0.6858 acc=57.99%
[TRAIN][ep=006] mask_avg: mc_mean=0.4463 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5030
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4543 mb_mean=0.4986 norm_overlap=1.0005 corr_cb=0.5123 topkJ=0.1231
[TRAIN][ep=007] loss=0.6832 acc=55.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5158
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4444 mb_mean=0.4958 norm_overlap=1.0005 corr_cb=0.5646 topkJ=0.1270
[TRAIN][ep=008] loss=0.6779 acc=56.38%
[TRAIN][ep=008] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5070
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4465 mb_mean=0.4969 norm_overlap=1.0003 corr_cb=0.4721 topkJ=0.1699
[TRAIN][ep=009] loss=0.6742 acc=62.01%
[TRAIN][ep=009] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5069
================= FIT START (fold=2) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4558 mb_mean=0.5004 norm_overlap=1.0002 corr_cb=0.3859 topkJ=0.1398
[TRAIN][ep=000] loss=0.6720 acc=59.46%
[TRAIN][ep=000] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5085
[EPOCH 000/089] train: loss=0.6720 acc=59.46% | val: loss=0.6776 acc=66.27% f1=67.44% auc=65.12% val_score=46.1149 val_score_bestthr=65.4959 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.446, mb=0.496, no=1.000, corr=0.509) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 65.4959
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4538 mb_mean=0.4979 norm_overlap=1.0003 corr_cb=0.4016 topkJ=0.2040
[TRAIN][ep=001] loss=0.6663 acc=63.09%
[TRAIN][ep=001] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5121
[EPOCH 001/089] train: loss=0.6663 acc=63.09% | val: loss=0.6657 acc=66.27% f1=69.57% auc=68.84% val_score=57.8535 val_score_bestthr=65.5986 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.446, mb=0.496, no=1.001, corr=0.512) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 65.4959 -> 65.5986
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4475 mb_mean=0.4963 norm_overlap=1.0004 corr_cb=0.4390 topkJ=0.0795
[TRAIN][ep=002] loss=0.6612 acc=63.49%
[TRAIN][ep=002] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5046
[EPOCH 002/089] train: loss=0.6612 acc=63.49% | val: loss=0.6612 acc=69.88% f1=70.59% auc=69.07% val_score=57.5322 val_score_bestthr=68.8390 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.446, mb=0.496, no=1.000, corr=0.505) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 65.5986 -> 68.8390
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4442 mb_mean=0.4982 norm_overlap=1.0006 corr_cb=0.5457 topkJ=0.1279
[TRAIN][ep=003] loss=0.6620 acc=61.61%
[TRAIN][ep=003] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5061
[EPOCH 003/089] train: loss=0.6620 acc=61.61% | val: loss=0.6594 acc=67.47% f1=69.66% auc=69.07% val_score=50.4387 val_score_bestthr=66.0988 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.446, mb=0.496, no=1.000, corr=0.506) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 66.0988
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4474 mb_mean=0.4978 norm_overlap=1.0003 corr_cb=0.4220 topkJ=0.0832
[TRAIN][ep=004] loss=0.6505 acc=62.15%
[TRAIN][ep=004] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5086
[EPOCH 004/089] train: loss=0.6505 acc=62.15% | val: loss=0.6533 acc=66.27% f1=67.44% auc=69.71% val_score=54.9266 val_score_bestthr=66.0495 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.446, mb=0.496, no=1.001, corr=0.509) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 66.0495
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4503 mb_mean=0.4974 norm_overlap=1.0004 corr_cb=0.4973 topkJ=0.1639
[TRAIN][ep=005] loss=1.2525 acc=62.55%
[TRAIN][ep=005] mask_avg: mc_mean=0.3254 mb_mean=0.4961 norm_overlap=1.0022 corr_cb=0.5176
[EPOCH 005/089] train: loss=1.2525 acc=62.55% | val: loss=0.6933 acc=66.27% f1=65.85% auc=66.74% val_score=39.9279 val_score_bestthr=66.1932 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.325, mb=0.496, no=1.002, corr=0.518) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 66.1932
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2591 mb_mean=0.4955 norm_overlap=1.0033 corr_cb=0.4740 topkJ=0.1423
[TRAIN][ep=006] loss=1.2371 acc=64.56%
[TRAIN][ep=006] mask_avg: mc_mean=0.2439 mb_mean=0.4961 norm_overlap=1.0030 corr_cb=0.4027
[EPOCH 006/089] train: loss=1.2371 acc=64.56% | val: loss=0.6480 acc=66.27% f1=64.10% auc=71.05% val_score=65.8299 val_score_bestthr=66.8936 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.244, mb=0.496, no=1.003, corr=0.403) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 66.8936
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2051 mb_mean=0.4933 norm_overlap=1.0038 corr_cb=0.4470 topkJ=0.2081
[TRAIN][ep=007] loss=1.2256 acc=64.30%
[TRAIN][ep=007] mask_avg: mc_mean=0.2228 mb_mean=0.4961 norm_overlap=1.0025 corr_cb=0.2783
[EPOCH 007/089] train: loss=1.2256 acc=64.30% | val: loss=0.6509 acc=66.27% f1=73.08% auc=70.99% val_score=64.2121 val_score_bestthr=68.4967 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.223, mb=0.496, no=1.002, corr=0.278) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 68.4967
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1433 mb_mean=0.4919 norm_overlap=1.0018 corr_cb=0.2019 topkJ=0.1363
[TRAIN][ep=008] loss=1.0198 acc=67.79%
[TRAIN][ep=008] mask_avg: mc_mean=0.1996 mb_mean=0.4961 norm_overlap=1.0020 corr_cb=0.1807
[EPOCH 008/089] train: loss=1.0198 acc=67.79% | val: loss=0.6384 acc=66.27% f1=65.85% auc=70.99% val_score=59.8879 val_score_bestthr=66.1932 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.200, mb=0.496, no=1.002, corr=0.181) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 66.1932
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2059 mb_mean=0.4948 norm_overlap=1.0040 corr_cb=0.3080 topkJ=0.0735
[TRAIN][ep=009] loss=0.8207 acc=65.64%
[TRAIN][ep=009] mask_avg: mc_mean=0.1805 mb_mean=0.4961 norm_overlap=1.0011 corr_cb=0.0773
[EPOCH 009/089] train: loss=0.8207 acc=65.64% | val: loss=0.6412 acc=65.06% f1=73.39% auc=70.76% val_score=65.0471 val_score_bestthr=65.8299 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.181, mb=0.496, no=1.001, corr=0.077) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 65.8299
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1788 mb_mean=0.4972 norm_overlap=0.9990 corr_cb=-0.0849 topkJ=0.0527
[TRAIN][ep=010] loss=0.7785 acc=66.04%
[TRAIN][ep=010] mask_avg: mc_mean=0.1896 mb_mean=0.4961 norm_overlap=1.0000 corr_cb=-0.0130
[EPOCH 010/089] train: loss=0.7785 acc=66.04% | val: loss=0.6282 acc=67.47% f1=68.97% auc=71.28% val_score=65.1939 val_score_bestthr=66.3074 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.496, no=1.000, corr=-0.013) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 66.3074
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1728 mb_mean=0.4971 norm_overlap=1.0015 corr_cb=0.1047 topkJ=0.0456
[TRAIN][ep=011] loss=0.7432 acc=70.20%
[TRAIN][ep=011] mask_avg: mc_mean=0.1742 mb_mean=0.4961 norm_overlap=0.9995 corr_cb=-0.0366
[EPOCH 011/089] train: loss=0.7432 acc=70.20% | val: loss=0.7333 acc=67.47% f1=64.94% auc=67.27% val_score=37.1849 val_score_bestthr=67.1908 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.174, mb=0.496, no=0.999, corr=-0.037) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 67.1908
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1550 mb_mean=0.4951 norm_overlap=0.9973 corr_cb=-0.1591 topkJ=0.0239
[TRAIN][ep=012] loss=0.7568 acc=68.46%
[TRAIN][ep=012] mask_avg: mc_mean=0.1435 mb_mean=0.4961 norm_overlap=0.9999 corr_cb=-0.0253
[EPOCH 012/089] train: loss=0.7568 acc=68.46% | val: loss=0.6254 acc=65.06% f1=73.87% auc=71.92% val_score=61.4342 val_score_bestthr=68.7451 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.144, mb=0.496, no=1.000, corr=-0.025) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 68.7451
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.0835 mb_mean=0.4969 norm_overlap=0.9998 corr_cb=-0.0084 topkJ=0.0462
[TRAIN][ep=013] loss=0.7306 acc=70.07%
[TRAIN][ep=013] mask_avg: mc_mean=0.1130 mb_mean=0.4961 norm_overlap=0.9996 corr_cb=-0.0308
[EPOCH 013/089] train: loss=0.7306 acc=70.07% | val: loss=0.6221 acc=69.88% f1=70.59% auc=72.21% val_score=71.1363 val_score_bestthr=71.1363 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.113, mb=0.496, no=1.000, corr=-0.031) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 68.8390 -> 71.1363
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1598 mb_mean=0.4985 norm_overlap=0.9964 corr_cb=-0.1888 topkJ=0.0293
[TRAIN][ep=014] loss=0.8083 acc=69.93%
[TRAIN][ep=014] mask_avg: mc_mean=0.1451 mb_mean=0.4961 norm_overlap=0.9975 corr_cb=-0.1202
[EPOCH 014/089] train: loss=0.8083 acc=69.93% | val: loss=0.6143 acc=67.47% f1=70.33% auc=72.27% val_score=63.6411 val_score_bestthr=69.5341 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.145, mb=0.496, no=0.998, corr=-0.120) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.1363 -> 69.5341
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1657 mb_mean=0.4977 norm_overlap=0.9989 corr_cb=-0.0409 topkJ=0.0754
[TRAIN][ep=015] loss=0.8798 acc=68.05%
[TRAIN][ep=015] mask_avg: mc_mean=0.1332 mb_mean=0.4961 norm_overlap=0.9977 corr_cb=-0.1009
[EPOCH 015/089] train: loss=0.8798 acc=68.05% | val: loss=0.6343 acc=71.08% f1=71.43% auc=72.97% val_score=52.5831 val_score_bestthr=73.2721 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.133, mb=0.496, no=0.998, corr=-0.101) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 71.1363 -> 73.2721
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1792 mb_mean=0.4984 norm_overlap=0.9906 corr_cb=-0.4201 topkJ=0.0104
[TRAIN][ep=016] loss=0.9413 acc=72.62%
[TRAIN][ep=016] mask_avg: mc_mean=0.1492 mb_mean=0.4961 norm_overlap=0.9966 corr_cb=-0.1431
[EPOCH 016/089] train: loss=0.9413 acc=72.62% | val: loss=0.6114 acc=69.88% f1=71.26% auc=73.26% val_score=67.4883 val_score_bestthr=71.3757 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.149, mb=0.496, no=0.997, corr=-0.143) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.2721 -> 71.3757
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1225 mb_mean=0.4972 norm_overlap=0.9987 corr_cb=-0.0587 topkJ=0.0592
[TRAIN][ep=017] loss=1.0192 acc=72.08%
[TRAIN][ep=017] mask_avg: mc_mean=0.1322 mb_mean=0.4961 norm_overlap=0.9970 corr_cb=-0.1134
[EPOCH 017/089] train: loss=1.0192 acc=72.08% | val: loss=0.7339 acc=68.67% f1=72.34% auc=72.67% val_score=46.9534 val_score_bestthr=70.4591 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.132, mb=0.496, no=0.997, corr=-0.113) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.2721 -> 70.4591
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1369 mb_mean=0.4952 norm_overlap=0.9978 corr_cb=-0.0781 topkJ=0.0400
[TRAIN][ep=018] loss=1.0883 acc=71.54%
[TRAIN][ep=018] mask_avg: mc_mean=0.1498 mb_mean=0.4961 norm_overlap=0.9961 corr_cb=-0.1517
[EPOCH 018/089] train: loss=1.0883 acc=71.54% | val: loss=0.6350 acc=72.29% f1=75.79% auc=73.90% val_score=53.6088 val_score_bestthr=74.1317 | dyn(w_pfs=0.240, w_sup=0.240, w_csuf=0.200, stage2=False) | mask(mc=0.150, mb=0.496, no=0.996, corr=-0.152) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 73.2721 -> 74.1317
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1520 mb_mean=0.4952 norm_overlap=0.9958 corr_cb=-0.1334 topkJ=0.0231
[TRAIN][ep=019] loss=1.0974 acc=71.54%
[TRAIN][ep=019] mask_avg: mc_mean=0.1344 mb_mean=0.4961 norm_overlap=0.9967 corr_cb=-0.1203
[EPOCH 019/089] train: loss=1.0974 acc=71.54% | val: loss=0.6238 acc=65.06% f1=70.71% auc=72.56% val_score=67.0091 val_score_bestthr=69.1666 | dyn(w_pfs=0.280, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.134, mb=0.496, no=0.997, corr=-0.120) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 69.1666
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1588 mb_mean=0.4987 norm_overlap=0.9950 corr_cb=-0.2235 topkJ=0.0339
[TRAIN][ep=020] loss=1.0941 acc=73.69%
[TRAIN][ep=020] mask_avg: mc_mean=0.1555 mb_mean=0.4961 norm_overlap=0.9963 corr_cb=-0.1454
[EPOCH 020/089] train: loss=1.0941 acc=73.69% | val: loss=0.6107 acc=67.47% f1=71.58% auc=73.26% val_score=69.4458 val_score_bestthr=69.4458 | dyn(w_pfs=0.320, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.155, mb=0.496, no=0.996, corr=-0.145) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 69.4458
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.1346 mb_mean=0.5007 norm_overlap=0.9944 corr_cb=-0.2005 topkJ=0.0193
[TRAIN][ep=021] loss=1.0914 acc=72.89%
[TRAIN][ep=021] mask_avg: mc_mean=0.1648 mb_mean=0.4961 norm_overlap=0.9961 corr_cb=-0.1562
[EPOCH 021/089] train: loss=1.0914 acc=72.89% | val: loss=0.6274 acc=69.88% f1=73.12% auc=73.08% val_score=67.0091 val_score_bestthr=70.3364 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.165, mb=0.496, no=0.996, corr=-0.156) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 70.3364
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1688 mb_mean=0.4922 norm_overlap=1.0001 corr_cb=0.0044 topkJ=0.0651
[TRAIN][ep=022] loss=1.0959 acc=76.78%
[TRAIN][ep=022] mask_avg: mc_mean=0.1455 mb_mean=0.4961 norm_overlap=0.9966 corr_cb=-0.1255
[EPOCH 022/089] train: loss=1.0959 acc=76.78% | val: loss=0.6208 acc=69.88% f1=73.12% auc=72.79% val_score=65.6950 val_score_bestthr=71.4203 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.146, mb=0.496, no=0.997, corr=-0.125) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 71.4203
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1618 mb_mean=0.4973 norm_overlap=0.9943 corr_cb=-0.2181 topkJ=0.0173
[TRAIN][ep=023] loss=1.0931 acc=73.56%
[TRAIN][ep=023] mask_avg: mc_mean=0.1381 mb_mean=0.4961 norm_overlap=0.9964 corr_cb=-0.1223
[EPOCH 023/089] train: loss=1.0931 acc=73.56% | val: loss=0.6374 acc=72.29% f1=74.73% auc=72.85% val_score=53.5389 val_score_bestthr=73.6325 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.138, mb=0.496, no=0.996, corr=-0.122) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 73.6325
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1693 mb_mean=0.4928 norm_overlap=0.9970 corr_cb=-0.1035 topkJ=0.0820
[TRAIN][ep=024] loss=0.9307 acc=71.68%
[TRAIN][ep=024] mask_avg: mc_mean=0.1521 mb_mean=0.4961 norm_overlap=0.9962 corr_cb=-0.1339
[EPOCH 024/089] train: loss=0.9307 acc=71.68% | val: loss=0.6171 acc=69.88% f1=73.12% auc=73.14% val_score=69.1525 val_score_bestthr=71.4203 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.152, mb=0.496, no=0.996, corr=-0.134) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 71.4203
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1159 mb_mean=0.4964 norm_overlap=0.9949 corr_cb=-0.1356 topkJ=0.0327
[TRAIN][ep=025] loss=0.7247 acc=74.09%
[TRAIN][ep=025] mask_avg: mc_mean=0.1345 mb_mean=0.4961 norm_overlap=0.9963 corr_cb=-0.1292
[EPOCH 025/089] train: loss=0.7247 acc=74.09% | val: loss=0.6054 acc=69.88% f1=73.12% auc=73.43% val_score=65.3226 val_score_bestthr=71.4203 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.134, mb=0.496, no=0.996, corr=-0.129) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 71.4203
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1405 mb_mean=0.4934 norm_overlap=1.0020 corr_cb=0.0550 topkJ=0.0373
[TRAIN][ep=026] loss=0.6672 acc=76.38%
[TRAIN][ep=026] mask_avg: mc_mean=0.1687 mb_mean=0.4961 norm_overlap=0.9960 corr_cb=-0.1549
[EPOCH 026/089] train: loss=0.6672 acc=76.38% | val: loss=0.6212 acc=67.47% f1=71.58% auc=73.14% val_score=63.3703 val_score_bestthr=69.1525 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.169, mb=0.496, no=0.996, corr=-0.155) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 69.1525
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1715 mb_mean=0.4995 norm_overlap=0.9963 corr_cb=-0.1490 topkJ=0.0255
[TRAIN][ep=027] loss=0.6531 acc=75.57%
[TRAIN][ep=027] mask_avg: mc_mean=0.1619 mb_mean=0.4961 norm_overlap=0.9964 corr_cb=-0.1304
[EPOCH 027/089] train: loss=0.6531 acc=75.57% | val: loss=0.6359 acc=72.29% f1=74.16% auc=73.49% val_score=54.8446 val_score_bestthr=69.3838 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.162, mb=0.496, no=0.996, corr=-0.130) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 69.3838
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1856 mb_mean=0.4920 norm_overlap=0.9991 corr_cb=-0.0388 topkJ=0.0501
[TRAIN][ep=028] loss=0.6407 acc=75.70%
[TRAIN][ep=028] mask_avg: mc_mean=0.1800 mb_mean=0.4961 norm_overlap=0.9962 corr_cb=-0.1479
[EPOCH 028/089] train: loss=0.6407 acc=75.70% | val: loss=0.6481 acc=67.47% f1=74.77% auc=72.97% val_score=64.9112 val_score_bestthr=68.9386 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.180, mb=0.496, no=0.996, corr=-0.148) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 68.9386
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.1638 mb_mean=0.4915 norm_overlap=0.9996 corr_cb=-0.0141 topkJ=0.0593
[TRAIN][ep=029] loss=0.6321 acc=77.58%
[TRAIN][ep=029] mask_avg: mc_mean=0.1785 mb_mean=0.4961 norm_overlap=0.9965 corr_cb=-0.1394
[EPOCH 029/089] train: loss=0.6321 acc=77.58% | val: loss=0.6301 acc=68.67% f1=72.34% auc=73.02% val_score=64.8973 val_score_bestthr=70.6805 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.178, mb=0.496, no=0.996, corr=-0.139) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 70.6805
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2156 mb_mean=0.4964 norm_overlap=0.9956 corr_cb=-0.1967 topkJ=0.0494
[TRAIN][ep=030] loss=0.6269 acc=77.85%
[TRAIN][ep=030] mask_avg: mc_mean=0.2053 mb_mean=0.4961 norm_overlap=0.9961 corr_cb=-0.1661
[EPOCH 030/089] train: loss=0.6269 acc=77.85% | val: loss=0.6297 acc=67.47% f1=74.77% auc=73.95% val_score=60.7322 val_score_bestthr=70.0586 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.205, mb=0.496, no=0.996, corr=-0.166) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 70.0586
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.1449 mb_mean=0.4928 norm_overlap=1.0001 corr_cb=0.0023 topkJ=0.0642
[TRAIN][ep=031] loss=0.6243 acc=78.12%
[TRAIN][ep=031] mask_avg: mc_mean=0.1645 mb_mean=0.4961 norm_overlap=0.9969 corr_cb=-0.1122
[EPOCH 031/089] train: loss=0.6243 acc=78.12% | val: loss=0.6343 acc=66.27% f1=74.07% auc=73.02% val_score=57.4434 val_score_bestthr=69.6610 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.165, mb=0.496, no=0.997, corr=-0.112) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 69.6610
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1764 mb_mean=0.4973 norm_overlap=1.0004 corr_cb=0.0152 topkJ=0.0666
[TRAIN][ep=032] loss=0.6120 acc=77.85%
[TRAIN][ep=032] mask_avg: mc_mean=0.1806 mb_mean=0.4961 norm_overlap=0.9968 corr_cb=-0.1195
[EPOCH 032/089] train: loss=0.6120 acc=77.85% | val: loss=0.7635 acc=67.47% f1=75.23% auc=72.85% val_score=40.4927 val_score_bestthr=68.6579 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.181, mb=0.496, no=0.997, corr=-0.120) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 68.6579
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2188 mb_mean=0.4971 norm_overlap=0.9982 corr_cb=-0.0924 topkJ=0.0415
[TRAIN][ep=033] loss=0.6206 acc=77.58%
[TRAIN][ep=033] mask_avg: mc_mean=0.2017 mb_mean=0.4961 norm_overlap=0.9962 corr_cb=-0.1534
[EPOCH 033/089] train: loss=0.6206 acc=77.58% | val: loss=0.6539 acc=67.47% f1=74.77% auc=73.37% val_score=60.6647 val_score_bestthr=70.0586 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.202, mb=0.496, no=0.996, corr=-0.153) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 70.0586
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1398 mb_mean=0.4943 norm_overlap=0.9969 corr_cb=-0.1152 topkJ=0.0462
[TRAIN][ep=034] loss=0.5996 acc=78.52%
[TRAIN][ep=034] mask_avg: mc_mean=0.1944 mb_mean=0.4961 norm_overlap=0.9967 corr_cb=-0.1292
[EPOCH 034/089] train: loss=0.5996 acc=78.52% | val: loss=0.6843 acc=71.08% f1=75.00% auc=71.86% val_score=70.1456 val_score_bestthr=73.4713 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.194, mb=0.496, no=0.997, corr=-0.129) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 73.4713
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.1899 mb_mean=0.4949 norm_overlap=0.9963 corr_cb=-0.1552 topkJ=0.0514
[TRAIN][ep=035] loss=0.5903 acc=80.40%
[TRAIN][ep=035] mask_avg: mc_mean=0.1852 mb_mean=0.4961 norm_overlap=0.9974 corr_cb=-0.0986
[EPOCH 035/089] train: loss=0.5903 acc=80.40% | val: loss=0.6887 acc=68.67% f1=75.47% auc=72.56% val_score=66.7535 val_score_bestthr=70.4582 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.185, mb=0.496, no=0.997, corr=-0.099) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 70.4582
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2004 mb_mean=0.4988 norm_overlap=0.9973 corr_cb=-0.1058 topkJ=0.0341
[TRAIN][ep=036] loss=0.6096 acc=77.72%
[TRAIN][ep=036] mask_avg: mc_mean=0.2403 mb_mean=0.4961 norm_overlap=0.9958 corr_cb=-0.1851
[EPOCH 036/089] train: loss=0.6096 acc=77.72% | val: loss=0.6524 acc=69.88% f1=73.12% auc=72.67% val_score=65.9539 val_score_bestthr=70.1697 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.240, mb=0.496, no=0.996, corr=-0.185) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 70.1697
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1885 mb_mean=0.4955 norm_overlap=0.9966 corr_cb=-0.1132 topkJ=0.0566
[TRAIN][ep=037] loss=0.5923 acc=79.87%
[TRAIN][ep=037] mask_avg: mc_mean=0.1908 mb_mean=0.4961 norm_overlap=0.9967 corr_cb=-0.1216
[EPOCH 037/089] train: loss=0.5923 acc=79.87% | val: loss=0.6840 acc=67.47% f1=73.79% auc=73.26% val_score=50.0246 val_score_bestthr=68.7196 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.191, mb=0.496, no=0.997, corr=-0.122) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 68.7196
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.1430 mb_mean=0.4959 norm_overlap=0.9980 corr_cb=-0.0718 topkJ=0.0444
[TRAIN][ep=038] loss=0.5741 acc=80.40%
[TRAIN][ep=038] mask_avg: mc_mean=0.2138 mb_mean=0.4961 norm_overlap=0.9959 corr_cb=-0.1592
[EPOCH 038/089] train: loss=0.5741 acc=80.40% | val: loss=0.6749 acc=69.88% f1=73.12% auc=72.21% val_score=70.8863 val_score_bestthr=71.4203 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.214, mb=0.496, no=0.996, corr=-0.159) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 71.4203
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2609 mb_mean=0.4995 norm_overlap=0.9913 corr_cb=-0.3449 topkJ=0.0194
[TRAIN][ep=039] loss=0.5884 acc=79.33%
[TRAIN][ep=039] mask_avg: mc_mean=0.1911 mb_mean=0.4961 norm_overlap=0.9967 corr_cb=-0.1235
[EPOCH 039/089] train: loss=0.5884 acc=79.33% | val: loss=0.6583 acc=67.47% f1=74.77% auc=72.91% val_score=65.7433 val_score_bestthr=70.0586 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.191, mb=0.496, no=0.997, corr=-0.123) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 70.0586
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.2116 mb_mean=0.4932 norm_overlap=0.9954 corr_cb=-0.2109 topkJ=0.0268
[TRAIN][ep=040] loss=0.5697 acc=80.13%
[TRAIN][ep=040] mask_avg: mc_mean=0.1953 mb_mean=0.4961 norm_overlap=0.9970 corr_cb=-0.1169
[EPOCH 040/089] train: loss=0.5697 acc=80.13% | val: loss=0.6846 acc=68.67% f1=75.47% auc=72.97% val_score=47.2529 val_score_bestthr=69.0170 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.195, mb=0.496, no=0.997, corr=-0.117) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 69.0170
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.0862 mb_mean=0.4935 norm_overlap=1.0072 corr_cb=0.1401 topkJ=0.1023
[TRAIN][ep=041] loss=0.5654 acc=80.40%
[TRAIN][ep=041] mask_avg: mc_mean=0.1901 mb_mean=0.4961 norm_overlap=0.9971 corr_cb=-0.1160
[EPOCH 041/089] train: loss=0.5654 acc=80.40% | val: loss=0.6738 acc=71.08% f1=74.47% auc=72.50% val_score=70.1697 val_score_bestthr=70.8863 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.496, no=0.997, corr=-0.116) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 70.8863
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.1838 mb_mean=0.4948 norm_overlap=1.0005 corr_cb=0.0170 topkJ=0.0442
[TRAIN][ep=042] loss=0.5693 acc=81.07%
[TRAIN][ep=042] mask_avg: mc_mean=0.2098 mb_mean=0.4961 norm_overlap=0.9968 corr_cb=-0.1289
[EPOCH 042/089] train: loss=0.5693 acc=81.07% | val: loss=0.7068 acc=68.67% f1=74.51% auc=72.50% val_score=46.1697 val_score_bestthr=70.5507 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.210, mb=0.496, no=0.997, corr=-0.129) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 70.5507
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.1568 mb_mean=0.4973 norm_overlap=0.9988 corr_cb=-0.0345 topkJ=0.0309
[TRAIN][ep=043] loss=0.5492 acc=83.36%
[TRAIN][ep=043] mask_avg: mc_mean=0.1996 mb_mean=0.4961 norm_overlap=0.9963 corr_cb=-0.1381
[EPOCH 043/089] train: loss=0.5492 acc=83.36% | val: loss=0.7446 acc=67.47% f1=75.23% auc=72.62% val_score=50.0246 val_score_bestthr=66.9079 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.200, mb=0.496, no=0.996, corr=-0.138) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 66.9079
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2500 mb_mean=0.4990 norm_overlap=0.9959 corr_cb=-0.2015 topkJ=0.0388
[TRAIN][ep=044] loss=0.5614 acc=82.15%
[TRAIN][ep=044] mask_avg: mc_mean=0.2057 mb_mean=0.4961 norm_overlap=0.9966 corr_cb=-0.1309
[EPOCH 044/089] train: loss=0.5614 acc=82.15% | val: loss=0.6868 acc=71.08% f1=74.47% auc=71.16% val_score=61.3619 val_score_bestthr=70.5930 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.206, mb=0.496, no=0.997, corr=-0.131) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 70.5930
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2834 mb_mean=0.4928 norm_overlap=0.9943 corr_cb=-0.2590 topkJ=0.0282
[TRAIN][ep=045] loss=0.5613 acc=81.07%
[TRAIN][ep=045] mask_avg: mc_mean=0.2556 mb_mean=0.4961 norm_overlap=0.9955 corr_cb=-0.1985
[EPOCH 045/089] train: loss=0.5613 acc=81.07% | val: loss=0.7626 acc=67.47% f1=74.77% auc=71.63% val_score=65.3952 val_score_bestthr=70.0586 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.256, mb=0.496, no=0.995, corr=-0.199) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 70.0586
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.1650 mb_mean=0.4987 norm_overlap=0.9950 corr_cb=-0.1770 topkJ=0.0558
[TRAIN][ep=046] loss=0.5564 acc=80.67%
[TRAIN][ep=046] mask_avg: mc_mean=0.1882 mb_mean=0.4961 norm_overlap=0.9972 corr_cb=-0.1022
[EPOCH 046/089] train: loss=0.5564 acc=80.67% | val: loss=0.7240 acc=67.47% f1=75.23% auc=72.73% val_score=47.8334 val_score_bestthr=69.7779 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.188, mb=0.496, no=0.997, corr=-0.102) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 69.7779
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.2534 mb_mean=0.4993 norm_overlap=0.9977 corr_cb=-0.1000 topkJ=0.0536
[TRAIN][ep=047] loss=0.5353 acc=82.42%
[TRAIN][ep=047] mask_avg: mc_mean=0.2274 mb_mean=0.4961 norm_overlap=0.9963 corr_cb=-0.1453
[EPOCH 047/089] train: loss=0.5353 acc=82.42% | val: loss=0.7792 acc=69.88% f1=73.68% auc=70.23% val_score=65.9112 val_score_bestthr=70.1456 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.227, mb=0.496, no=0.996, corr=-0.145) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 70.1456
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.1942 mb_mean=0.4911 norm_overlap=0.9958 corr_cb=-0.1524 topkJ=0.0308
[TRAIN][ep=048] loss=0.5306 acc=83.49%
[TRAIN][ep=048] mask_avg: mc_mean=0.2188 mb_mean=0.4961 norm_overlap=0.9967 corr_cb=-0.1294
[EPOCH 048/089] train: loss=0.5306 acc=83.49% | val: loss=0.7303 acc=69.88% f1=75.73% auc=72.21% val_score=50.2896 val_score_bestthr=69.5727 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.219, mb=0.496, no=0.997, corr=-0.129) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1317 -> 69.5727
[EARLY STOP] no improvement for 30 epochs. best_epoch=18
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
=============== FIT DONE ===============
[BEST] epoch=18 | val_acc=72.29% | val_f1=75.79% | val_auc=73.90% | val_score=53.6088 | val_score_bestthr=74.1317
[TEST@BEST] thr_used=0.260 | acc=57.49% f1=67.16% auc=61.76% | SP_sex=12.41% EO_sex=12.89% SP_age=12.97% EO_age=10.91%
[TIME] 1.31 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/summary_fold_2.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4477 mb_mean=0.4964 norm_overlap=1.0006 corr_cb=0.6199 topkJ=0.1849
[TRAIN][ep=000] loss=0.6951 acc=47.25%
[TRAIN][ep=000] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5111
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4378 mb_mean=0.4940 norm_overlap=1.0005 corr_cb=0.5338 topkJ=0.1816
[TRAIN][ep=001] loss=0.6926 acc=50.74%
[TRAIN][ep=001] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5175
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4517 mb_mean=0.4988 norm_overlap=1.0004 corr_cb=0.4909 topkJ=0.1226
[TRAIN][ep=002] loss=0.6926 acc=52.21%
[TRAIN][ep=002] mask_avg: mc_mean=0.4463 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5077
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4474 mb_mean=0.4963 norm_overlap=1.0004 corr_cb=0.4696 topkJ=0.1653
[TRAIN][ep=003] loss=0.6924 acc=52.75%
[TRAIN][ep=003] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5044
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4425 mb_mean=0.4921 norm_overlap=1.0010 corr_cb=0.7152 topkJ=0.2130
[TRAIN][ep=004] loss=0.6910 acc=52.62%
[TRAIN][ep=004] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5027
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4529 mb_mean=0.4986 norm_overlap=1.0003 corr_cb=0.4542 topkJ=0.1703
[TRAIN][ep=005] loss=0.6877 acc=57.58%
[TRAIN][ep=005] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5020
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4536 mb_mean=0.4984 norm_overlap=1.0003 corr_cb=0.3933 topkJ=0.1356
[TRAIN][ep=006] loss=0.6858 acc=57.99%
[TRAIN][ep=006] mask_avg: mc_mean=0.4463 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5030
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4543 mb_mean=0.4986 norm_overlap=1.0005 corr_cb=0.5123 topkJ=0.1231
[TRAIN][ep=007] loss=0.6832 acc=55.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5158
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4444 mb_mean=0.4958 norm_overlap=1.0005 corr_cb=0.5646 topkJ=0.1270
[TRAIN][ep=008] loss=0.6779 acc=56.51%
[TRAIN][ep=008] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5070
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4465 mb_mean=0.4969 norm_overlap=1.0003 corr_cb=0.4721 topkJ=0.1699
[TRAIN][ep=009] loss=0.6742 acc=61.88%
[TRAIN][ep=009] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5069
================= FIT START (fold=2) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4558 mb_mean=0.5004 norm_overlap=1.0002 corr_cb=0.3859 topkJ=0.1398
[TRAIN][ep=000] loss=0.6720 acc=59.33%
[TRAIN][ep=000] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5085
[EPOCH 000/089] train: loss=0.6720 acc=59.33% | val: loss=0.6777 acc=66.27% f1=67.44% auc=65.06% val_score=46.1149 val_score_bestthr=65.4959 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.446, mb=0.496, no=1.000, corr=0.509) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 65.4959
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4538 mb_mean=0.4979 norm_overlap=1.0003 corr_cb=0.4016 topkJ=0.2040
[TRAIN][ep=001] loss=0.6664 acc=62.68%
[TRAIN][ep=001] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5121
[EPOCH 001/089] train: loss=0.6664 acc=62.68% | val: loss=0.6657 acc=66.27% f1=69.57% auc=68.90% val_score=56.0160 val_score_bestthr=65.5986 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.446, mb=0.496, no=1.001, corr=0.512) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 65.4959 -> 65.5986
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4475 mb_mean=0.4963 norm_overlap=1.0004 corr_cb=0.4390 topkJ=0.0795
[TRAIN][ep=002] loss=0.6613 acc=63.36%
[TRAIN][ep=002] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5046
[EPOCH 002/089] train: loss=0.6613 acc=63.36% | val: loss=0.6613 acc=69.88% f1=70.59% auc=68.90% val_score=57.5322 val_score_bestthr=68.8390 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.446, mb=0.496, no=1.000, corr=0.505) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 65.5986 -> 68.8390
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4442 mb_mean=0.4982 norm_overlap=1.0006 corr_cb=0.5457 topkJ=0.1279
[TRAIN][ep=003] loss=0.6622 acc=61.61%
[TRAIN][ep=003] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5061
[EPOCH 003/089] train: loss=0.6622 acc=61.61% | val: loss=0.6596 acc=67.47% f1=69.66% auc=69.01% val_score=50.4387 val_score_bestthr=66.0988 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.446, mb=0.496, no=1.000, corr=0.506) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 66.0988
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4474 mb_mean=0.4978 norm_overlap=1.0003 corr_cb=0.4220 topkJ=0.0832
[TRAIN][ep=004] loss=0.6506 acc=62.15%
[TRAIN][ep=004] mask_avg: mc_mean=0.4462 mb_mean=0.4961 norm_overlap=1.0005 corr_cb=0.5086
[EPOCH 004/089] train: loss=0.6506 acc=62.15% | val: loss=0.6535 acc=67.47% f1=68.97% auc=69.65% val_score=54.9266 val_score_bestthr=66.3074 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.446, mb=0.496, no=1.001, corr=0.509) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 66.3074
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4503 mb_mean=0.4974 norm_overlap=1.0004 corr_cb=0.4973 topkJ=0.1639
[TRAIN][ep=005] loss=1.3697 acc=62.68%
[TRAIN][ep=005] mask_avg: mc_mean=0.3251 mb_mean=0.4961 norm_overlap=1.0022 corr_cb=0.5177
[EPOCH 005/089] train: loss=1.3697 acc=62.68% | val: loss=0.6933 acc=65.06% f1=65.06% auc=66.63% val_score=39.9279 val_score_bestthr=65.1175 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.325, mb=0.496, no=1.002, corr=0.518) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 65.1175
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2593 mb_mean=0.4955 norm_overlap=1.0033 corr_cb=0.4754 topkJ=0.1444
[TRAIN][ep=006] loss=1.3484 acc=64.56%
[TRAIN][ep=006] mask_avg: mc_mean=0.2445 mb_mean=0.4961 norm_overlap=1.0030 corr_cb=0.4042
[EPOCH 006/089] train: loss=1.3484 acc=64.56% | val: loss=0.6483 acc=65.06% f1=73.39% auc=70.87% val_score=65.8299 val_score_bestthr=65.8299 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.244, mb=0.496, no=1.003, corr=0.404) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 65.8299
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2051 mb_mean=0.4933 norm_overlap=1.0038 corr_cb=0.4500 topkJ=0.2081
[TRAIN][ep=007] loss=1.3362 acc=63.89%
[TRAIN][ep=007] mask_avg: mc_mean=0.2236 mb_mean=0.4961 norm_overlap=1.0025 corr_cb=0.2827
[EPOCH 007/089] train: loss=1.3362 acc=63.89% | val: loss=0.6515 acc=66.27% f1=73.08% auc=70.76% val_score=64.2121 val_score_bestthr=68.4967 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.224, mb=0.496, no=1.002, corr=0.283) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 68.4967
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1443 mb_mean=0.4919 norm_overlap=1.0018 corr_cb=0.2064 topkJ=0.1378
[TRAIN][ep=008] loss=1.1366 acc=67.79%
[TRAIN][ep=008] mask_avg: mc_mean=0.2011 mb_mean=0.4961 norm_overlap=1.0020 corr_cb=0.1846
[EPOCH 008/089] train: loss=1.1366 acc=67.79% | val: loss=0.6389 acc=65.06% f1=72.90% auc=70.58% val_score=59.8879 val_score_bestthr=67.2210 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.201, mb=0.496, no=1.002, corr=0.185) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 67.2210
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2084 mb_mean=0.4948 norm_overlap=1.0039 corr_cb=0.3121 topkJ=0.0740
[TRAIN][ep=009] loss=0.9425 acc=65.37%
[TRAIN][ep=009] mask_avg: mc_mean=0.1829 mb_mean=0.4961 norm_overlap=1.0011 corr_cb=0.0818
[EPOCH 009/089] train: loss=0.9425 acc=65.37% | val: loss=0.6402 acc=65.06% f1=73.39% auc=70.47% val_score=65.0471 val_score_bestthr=65.8299 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.183, mb=0.496, no=1.001, corr=0.082) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 65.8299
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1779 mb_mean=0.4972 norm_overlap=0.9992 corr_cb=-0.0738 topkJ=0.0544
[TRAIN][ep=010] loss=0.9031 acc=66.17%
[TRAIN][ep=010] mask_avg: mc_mean=0.1887 mb_mean=0.4961 norm_overlap=1.0001 corr_cb=-0.0021
[EPOCH 010/089] train: loss=0.9031 acc=66.17% | val: loss=0.6294 acc=67.47% f1=68.97% auc=70.99% val_score=65.1939 val_score_bestthr=66.3074 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.189, mb=0.496, no=1.000, corr=-0.002) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 66.3074
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1741 mb_mean=0.4971 norm_overlap=1.0016 corr_cb=0.1128 topkJ=0.0473
[TRAIN][ep=011] loss=0.8677 acc=70.07%
[TRAIN][ep=011] mask_avg: mc_mean=0.1765 mb_mean=0.4961 norm_overlap=0.9996 corr_cb=-0.0312
[EPOCH 011/089] train: loss=0.8677 acc=70.07% | val: loss=0.7327 acc=67.47% f1=64.94% auc=67.21% val_score=37.1849 val_score_bestthr=67.1908 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.176, mb=0.496, no=1.000, corr=-0.031) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 67.1908
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1588 mb_mean=0.4951 norm_overlap=0.9974 corr_cb=-0.1592 topkJ=0.0231
[TRAIN][ep=012] loss=0.8815 acc=68.19%
[TRAIN][ep=012] mask_avg: mc_mean=0.1460 mb_mean=0.4961 norm_overlap=1.0000 corr_cb=-0.0204
[EPOCH 012/089] train: loss=0.8815 acc=68.19% | val: loss=0.6265 acc=65.06% f1=73.87% auc=71.63% val_score=61.4342 val_score_bestthr=68.7451 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.146, mb=0.496, no=1.000, corr=-0.020) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8390 -> 68.7451
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.0883 mb_mean=0.4969 norm_overlap=0.9998 corr_cb=-0.0077 topkJ=0.0467
[TRAIN][ep=013] loss=0.8545 acc=70.20%
[TRAIN][ep=013] mask_avg: mc_mean=0.1170 mb_mean=0.4961 norm_overlap=0.9996 corr_cb=-0.0283
[EPOCH 013/089] train: loss=0.8545 acc=70.20% | val: loss=0.6228 acc=68.67% f1=69.77% auc=72.03% val_score=68.8973 val_score_bestthr=68.8973 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.117, mb=0.496, no=1.000, corr=-0.028) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 68.8390 -> 68.8973
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1648 mb_mean=0.4985 norm_overlap=0.9965 corr_cb=-0.1922 topkJ=0.0276
[TRAIN][ep=014] loss=0.9297 acc=69.66%
[TRAIN][ep=014] mask_avg: mc_mean=0.1486 mb_mean=0.4961 norm_overlap=0.9976 corr_cb=-0.1199
[EPOCH 014/089] train: loss=0.9297 acc=69.66% | val: loss=0.6156 acc=66.27% f1=68.89% auc=71.98% val_score=63.6411 val_score_bestthr=68.7286 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.149, mb=0.496, no=0.998, corr=-0.120) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8973 -> 68.7286
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1693 mb_mean=0.4977 norm_overlap=0.9990 corr_cb=-0.0406 topkJ=0.0745
[TRAIN][ep=015] loss=0.9989 acc=67.79%
[TRAIN][ep=015] mask_avg: mc_mean=0.1360 mb_mean=0.4961 norm_overlap=0.9978 corr_cb=-0.0997
[EPOCH 015/089] train: loss=0.9989 acc=67.79% | val: loss=0.6349 acc=71.08% f1=72.09% auc=72.62% val_score=52.5831 val_score_bestthr=74.6637 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.136, mb=0.496, no=0.998, corr=-0.100) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 68.8973 -> 74.6637
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1803 mb_mean=0.4984 norm_overlap=0.9909 corr_cb=-0.4176 topkJ=0.0100
[TRAIN][ep=016] loss=1.0578 acc=72.48%
[TRAIN][ep=016] mask_avg: mc_mean=0.1516 mb_mean=0.4961 norm_overlap=0.9968 corr_cb=-0.1409
[EPOCH 016/089] train: loss=1.0578 acc=72.48% | val: loss=0.6126 acc=68.67% f1=70.45% auc=73.08% val_score=67.4883 val_score_bestthr=70.9604 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.152, mb=0.496, no=0.997, corr=-0.141) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 70.9604
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1270 mb_mean=0.4972 norm_overlap=0.9986 corr_cb=-0.0627 topkJ=0.0579
[TRAIN][ep=017] loss=1.1330 acc=71.95%
[TRAIN][ep=017] mask_avg: mc_mean=0.1347 mb_mean=0.4961 norm_overlap=0.9971 corr_cb=-0.1121
[EPOCH 017/089] train: loss=1.1330 acc=71.95% | val: loss=0.7303 acc=72.29% f1=72.94% auc=72.38% val_score=46.9534 val_score_bestthr=71.9029 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.135, mb=0.496, no=0.997, corr=-0.112) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 71.9029
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1418 mb_mean=0.4952 norm_overlap=0.9977 corr_cb=-0.0841 topkJ=0.0382
[TRAIN][ep=018] loss=1.1993 acc=71.54%
[TRAIN][ep=018] mask_avg: mc_mean=0.1530 mb_mean=0.4961 norm_overlap=0.9963 corr_cb=-0.1523
[EPOCH 018/089] train: loss=1.1993 acc=71.54% | val: loss=0.6361 acc=72.29% f1=75.79% auc=73.60% val_score=50.8730 val_score_bestthr=74.1317 | dyn(w_pfs=0.240, w_sup=0.240, w_csuf=0.200, stage2=False) | mask(mc=0.153, mb=0.496, no=0.996, corr=-0.152) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 74.1317
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1488 mb_mean=0.4952 norm_overlap=0.9962 corr_cb=-0.1218 topkJ=0.0243
[TRAIN][ep=019] loss=1.2058 acc=71.95%
[TRAIN][ep=019] mask_avg: mc_mean=0.1343 mb_mean=0.4961 norm_overlap=0.9969 corr_cb=-0.1164
[EPOCH 019/089] train: loss=1.2058 acc=71.95% | val: loss=0.6245 acc=66.27% f1=72.00% auc=72.62% val_score=66.7595 val_score_bestthr=69.5319 | dyn(w_pfs=0.280, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.134, mb=0.496, no=0.997, corr=-0.116) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 69.5319
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1596 mb_mean=0.4987 norm_overlap=0.9951 corr_cb=-0.2235 topkJ=0.0348
[TRAIN][ep=020] loss=1.2017 acc=73.96%
[TRAIN][ep=020] mask_avg: mc_mean=0.1570 mb_mean=0.4961 norm_overlap=0.9965 corr_cb=-0.1443
[EPOCH 020/089] train: loss=1.2017 acc=73.96% | val: loss=0.6123 acc=68.67% f1=71.74% auc=73.20% val_score=69.4458 val_score_bestthr=70.2169 | dyn(w_pfs=0.180, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.157, mb=0.496, no=0.996, corr=-0.144) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 70.2169
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.1411 mb_mean=0.5007 norm_overlap=0.9944 corr_cb=-0.2088 topkJ=0.0177
[TRAIN][ep=021] loss=1.0037 acc=73.02%
[TRAIN][ep=021] mask_avg: mc_mean=0.1655 mb_mean=0.4961 norm_overlap=0.9962 corr_cb=-0.1528
[EPOCH 021/089] train: loss=1.0037 acc=73.02% | val: loss=0.6320 acc=69.88% f1=73.12% auc=72.85% val_score=67.0091 val_score_bestthr=70.3364 | dyn(w_pfs=0.080, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.165, mb=0.496, no=0.996, corr=-0.153) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 70.3364
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1710 mb_mean=0.4922 norm_overlap=1.0002 corr_cb=0.0090 topkJ=0.0669
[TRAIN][ep=022] loss=0.8142 acc=76.38%
[TRAIN][ep=022] mask_avg: mc_mean=0.1507 mb_mean=0.4961 norm_overlap=0.9967 corr_cb=-0.1272
[EPOCH 022/089] train: loss=0.8142 acc=76.38% | val: loss=0.6218 acc=72.29% f1=74.73% auc=73.08% val_score=64.0505 val_score_bestthr=73.6325 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.151, mb=0.496, no=0.997, corr=-0.127) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 73.6325
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1575 mb_mean=0.4973 norm_overlap=0.9948 corr_cb=-0.2023 topkJ=0.0194
[TRAIN][ep=023] loss=0.7882 acc=74.50%
[TRAIN][ep=023] mask_avg: mc_mean=0.1448 mb_mean=0.4961 norm_overlap=0.9965 corr_cb=-0.1283
[EPOCH 023/089] train: loss=0.7882 acc=74.50% | val: loss=0.6380 acc=72.29% f1=75.27% auc=72.62% val_score=59.7393 val_score_bestthr=72.4202 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.145, mb=0.496, no=0.996, corr=-0.128) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 72.4202
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1683 mb_mean=0.4928 norm_overlap=0.9971 corr_cb=-0.1046 topkJ=0.0839
[TRAIN][ep=024] loss=0.8148 acc=72.08%
[TRAIN][ep=024] mask_avg: mc_mean=0.1583 mb_mean=0.4961 norm_overlap=0.9962 corr_cb=-0.1420
[EPOCH 024/089] train: loss=0.8148 acc=72.08% | val: loss=0.6172 acc=69.88% f1=73.12% auc=73.49% val_score=69.0402 val_score_bestthr=71.4203 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.158, mb=0.496, no=0.996, corr=-0.142) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 71.4203
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1253 mb_mean=0.4964 norm_overlap=0.9949 corr_cb=-0.1443 topkJ=0.0319
[TRAIN][ep=025] loss=0.7987 acc=74.50%
[TRAIN][ep=025] mask_avg: mc_mean=0.1551 mb_mean=0.4961 norm_overlap=0.9958 corr_cb=-0.1601
[EPOCH 025/089] train: loss=0.7987 acc=74.50% | val: loss=0.6074 acc=71.08% f1=73.91% auc=73.26% val_score=65.4911 val_score_bestthr=72.9533 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.155, mb=0.496, no=0.996, corr=-0.160) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 72.9533
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1431 mb_mean=0.4934 norm_overlap=1.0019 corr_cb=0.0564 topkJ=0.0360
[TRAIN][ep=026] loss=0.7766 acc=76.51%
[TRAIN][ep=026] mask_avg: mc_mean=0.1689 mb_mean=0.4961 norm_overlap=0.9961 corr_cb=-0.1549
[EPOCH 026/089] train: loss=0.7766 acc=76.51% | val: loss=0.6220 acc=68.67% f1=72.34% auc=73.08% val_score=70.6805 val_score_bestthr=70.6805 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.169, mb=0.496, no=0.996, corr=-0.155) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 70.6805
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1729 mb_mean=0.4995 norm_overlap=0.9963 corr_cb=-0.1511 topkJ=0.0250
[TRAIN][ep=027] loss=0.7758 acc=75.44%
[TRAIN][ep=027] mask_avg: mc_mean=0.1642 mb_mean=0.4961 norm_overlap=0.9964 corr_cb=-0.1350
[EPOCH 027/089] train: loss=0.7758 acc=75.44% | val: loss=0.6385 acc=69.88% f1=73.68% auc=73.66% val_score=53.3642 val_score_bestthr=70.1456 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.164, mb=0.496, no=0.996, corr=-0.135) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 70.1456
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1920 mb_mean=0.4920 norm_overlap=0.9989 corr_cb=-0.0477 topkJ=0.0455
[TRAIN][ep=028] loss=0.7611 acc=75.57%
[TRAIN][ep=028] mask_avg: mc_mean=0.1833 mb_mean=0.4961 norm_overlap=0.9962 corr_cb=-0.1541
[EPOCH 028/089] train: loss=0.7611 acc=75.57% | val: loss=0.6493 acc=67.47% f1=74.77% auc=73.08% val_score=64.9112 val_score_bestthr=68.9386 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.183, mb=0.496, no=0.996, corr=-0.154) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 68.9386
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.1566 mb_mean=0.4915 norm_overlap=0.9998 corr_cb=-0.0051 topkJ=0.0598
[TRAIN][ep=029] loss=0.7513 acc=77.18%
[TRAIN][ep=029] mask_avg: mc_mean=0.1776 mb_mean=0.4961 norm_overlap=0.9966 corr_cb=-0.1392
[EPOCH 029/089] train: loss=0.7513 acc=77.18% | val: loss=0.6334 acc=69.88% f1=74.23% auc=72.91% val_score=64.8973 val_score_bestthr=72.5107 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.178, mb=0.496, no=0.997, corr=-0.139) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 72.5107
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2189 mb_mean=0.4964 norm_overlap=0.9955 corr_cb=-0.2059 topkJ=0.0481
[TRAIN][ep=030] loss=0.7447 acc=77.85%
[TRAIN][ep=030] mask_avg: mc_mean=0.2123 mb_mean=0.4961 norm_overlap=0.9960 corr_cb=-0.1786
[EPOCH 030/089] train: loss=0.7447 acc=77.85% | val: loss=0.6325 acc=68.67% f1=75.47% auc=73.78% val_score=60.7322 val_score_bestthr=71.5782 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.212, mb=0.496, no=0.996, corr=-0.179) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 71.5782
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.1499 mb_mean=0.4928 norm_overlap=0.9996 corr_cb=-0.0117 topkJ=0.0629
[TRAIN][ep=031] loss=0.7419 acc=77.99%
[TRAIN][ep=031] mask_avg: mc_mean=0.1660 mb_mean=0.4961 norm_overlap=0.9969 corr_cb=-0.1168
[EPOCH 031/089] train: loss=0.7419 acc=77.99% | val: loss=0.6353 acc=66.27% f1=74.07% auc=73.02% val_score=57.4434 val_score_bestthr=69.6610 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.166, mb=0.496, no=0.997, corr=-0.117) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 69.6610
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1762 mb_mean=0.4973 norm_overlap=1.0002 corr_cb=0.0099 topkJ=0.0638
[TRAIN][ep=032] loss=0.7278 acc=77.45%
[TRAIN][ep=032] mask_avg: mc_mean=0.1841 mb_mean=0.4961 norm_overlap=0.9968 corr_cb=-0.1271
[EPOCH 032/089] train: loss=0.7278 acc=77.45% | val: loss=0.7685 acc=67.47% f1=75.23% auc=72.91% val_score=40.4927 val_score_bestthr=68.6579 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.184, mb=0.496, no=0.997, corr=-0.127) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 68.6579
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2416 mb_mean=0.4971 norm_overlap=0.9980 corr_cb=-0.1139 topkJ=0.0389
[TRAIN][ep=033] loss=0.7357 acc=78.12%
[TRAIN][ep=033] mask_avg: mc_mean=0.2065 mb_mean=0.4961 norm_overlap=0.9962 corr_cb=-0.1610
[EPOCH 033/089] train: loss=0.7357 acc=78.12% | val: loss=0.6583 acc=67.47% f1=74.77% auc=73.31% val_score=56.6749 val_score_bestthr=70.0586 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.206, mb=0.496, no=0.996, corr=-0.161) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 70.0586
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1400 mb_mean=0.4943 norm_overlap=0.9968 corr_cb=-0.1223 topkJ=0.0440
[TRAIN][ep=034] loss=0.7128 acc=78.52%
[TRAIN][ep=034] mask_avg: mc_mean=0.1938 mb_mean=0.4961 norm_overlap=0.9968 corr_cb=-0.1300
[EPOCH 034/089] train: loss=0.7128 acc=78.52% | val: loss=0.6840 acc=71.08% f1=75.00% auc=72.21% val_score=73.4713 val_score_bestthr=73.4713 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.194, mb=0.496, no=0.997, corr=-0.130) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 73.4713
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.1939 mb_mean=0.4949 norm_overlap=0.9964 corr_cb=-0.1572 topkJ=0.0514
[TRAIN][ep=035] loss=0.7032 acc=80.00%
[TRAIN][ep=035] mask_avg: mc_mean=0.1877 mb_mean=0.4961 norm_overlap=0.9974 corr_cb=-0.1032
[EPOCH 035/089] train: loss=0.7032 acc=80.00% | val: loss=0.6915 acc=68.67% f1=75.47% auc=72.09% val_score=66.7535 val_score_bestthr=70.4582 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.188, mb=0.496, no=0.997, corr=-0.103) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 70.4582
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2026 mb_mean=0.4988 norm_overlap=0.9973 corr_cb=-0.1096 topkJ=0.0337
[TRAIN][ep=036] loss=0.7234 acc=77.32%
[TRAIN][ep=036] mask_avg: mc_mean=0.2417 mb_mean=0.4961 norm_overlap=0.9958 corr_cb=-0.1901
[EPOCH 036/089] train: loss=0.7234 acc=77.32% | val: loss=0.6553 acc=71.08% f1=75.00% auc=72.50% val_score=68.6601 val_score_bestthr=73.4713 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.242, mb=0.496, no=0.996, corr=-0.190) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 73.4713
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1919 mb_mean=0.4955 norm_overlap=0.9964 corr_cb=-0.1237 topkJ=0.0544
[TRAIN][ep=037] loss=0.7042 acc=79.60%
[TRAIN][ep=037] mask_avg: mc_mean=0.1916 mb_mean=0.4961 norm_overlap=0.9967 corr_cb=-0.1262
[EPOCH 037/089] train: loss=0.7042 acc=79.60% | val: loss=0.6916 acc=68.67% f1=75.00% auc=72.91% val_score=50.0246 val_score_bestthr=67.7409 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.192, mb=0.496, no=0.997, corr=-0.126) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 67.7409
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.1580 mb_mean=0.4959 norm_overlap=0.9976 corr_cb=-0.0932 topkJ=0.0435
[TRAIN][ep=038] loss=0.6845 acc=80.67%
[TRAIN][ep=038] mask_avg: mc_mean=0.2152 mb_mean=0.4961 norm_overlap=0.9959 corr_cb=-0.1637
[EPOCH 038/089] train: loss=0.6845 acc=80.67% | val: loss=0.6786 acc=71.08% f1=75.00% auc=72.03% val_score=70.1456 val_score_bestthr=73.4713 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.215, mb=0.496, no=0.996, corr=-0.164) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 73.4713
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2523 mb_mean=0.4995 norm_overlap=0.9915 corr_cb=-0.3356 topkJ=0.0202
[TRAIN][ep=039] loss=0.6993 acc=79.60%
[TRAIN][ep=039] mask_avg: mc_mean=0.1940 mb_mean=0.4961 norm_overlap=0.9966 corr_cb=-0.1293
[EPOCH 039/089] train: loss=0.6993 acc=79.60% | val: loss=0.6611 acc=67.47% f1=74.77% auc=72.85% val_score=65.7433 val_score_bestthr=70.0586 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.194, mb=0.496, no=0.997, corr=-0.129) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 70.0586
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.2186 mb_mean=0.4932 norm_overlap=0.9954 corr_cb=-0.2203 topkJ=0.0260
[TRAIN][ep=040] loss=0.6781 acc=80.27%
[TRAIN][ep=040] mask_avg: mc_mean=0.1986 mb_mean=0.4961 norm_overlap=0.9969 corr_cb=-0.1229
[EPOCH 040/089] train: loss=0.6781 acc=80.27% | val: loss=0.6836 acc=69.88% f1=75.73% auc=72.97% val_score=60.0492 val_score_bestthr=69.2639 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.199, mb=0.496, no=0.997, corr=-0.123) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 69.2639
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.0984 mb_mean=0.4935 norm_overlap=1.0056 corr_cb=0.1224 topkJ=0.0984
[TRAIN][ep=041] loss=0.6763 acc=80.13%
[TRAIN][ep=041] mask_avg: mc_mean=0.1985 mb_mean=0.4961 norm_overlap=0.9968 corr_cb=-0.1272
[EPOCH 041/089] train: loss=0.6763 acc=80.13% | val: loss=0.6739 acc=69.88% f1=73.12% auc=72.56% val_score=70.1697 val_score_bestthr=70.1697 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.198, mb=0.496, no=0.997, corr=-0.127) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 70.1697
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.1975 mb_mean=0.4948 norm_overlap=0.9999 corr_cb=-0.0018 topkJ=0.0433
[TRAIN][ep=042] loss=0.6779 acc=80.94%
[TRAIN][ep=042] mask_avg: mc_mean=0.2142 mb_mean=0.4961 norm_overlap=0.9967 corr_cb=-0.1350
[EPOCH 042/089] train: loss=0.6779 acc=80.94% | val: loss=0.7136 acc=68.67% f1=73.47% auc=72.38% val_score=46.1697 val_score_bestthr=70.8681 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.214, mb=0.496, no=0.997, corr=-0.135) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 70.8681
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.1679 mb_mean=0.4973 norm_overlap=0.9981 corr_cb=-0.0573 topkJ=0.0292
[TRAIN][ep=043] loss=0.6575 acc=82.55%
[TRAIN][ep=043] mask_avg: mc_mean=0.2051 mb_mean=0.4961 norm_overlap=0.9962 corr_cb=-0.1467
[EPOCH 043/089] train: loss=0.6575 acc=82.55% | val: loss=0.7595 acc=67.47% f1=75.23% auc=72.44% val_score=44.4718 val_score_bestthr=66.9079 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.205, mb=0.496, no=0.996, corr=-0.147) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 66.9079
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2549 mb_mean=0.4990 norm_overlap=0.9959 corr_cb=-0.2056 topkJ=0.0388
[TRAIN][ep=044] loss=0.6713 acc=81.34%
[TRAIN][ep=044] mask_avg: mc_mean=0.2094 mb_mean=0.4961 norm_overlap=0.9965 corr_cb=-0.1368
[EPOCH 044/089] train: loss=0.6713 acc=81.34% | val: loss=0.6879 acc=68.67% f1=73.47% auc=70.99% val_score=61.3619 val_score_bestthr=72.6181 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.209, mb=0.496, no=0.997, corr=-0.137) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 72.6181
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.3072 mb_mean=0.4928 norm_overlap=0.9941 corr_cb=-0.2930 topkJ=0.0220
[TRAIN][ep=045] loss=0.6682 acc=81.07%
[TRAIN][ep=045] mask_avg: mc_mean=0.2581 mb_mean=0.4961 norm_overlap=0.9954 corr_cb=-0.2039
[EPOCH 045/089] train: loss=0.6682 acc=81.07% | val: loss=0.7680 acc=67.47% f1=74.77% auc=71.74% val_score=65.3952 val_score_bestthr=70.0586 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.258, mb=0.496, no=0.995, corr=-0.204) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.6637 -> 70.0586
[EARLY STOP] no improvement for 30 epochs. best_epoch=15
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
=============== FIT DONE ===============
[BEST] epoch=15 | val_acc=71.08% | val_f1=72.09% | val_auc=72.62% | val_score=52.5831 | val_score_bestthr=74.6637
[TEST@BEST] thr_used=0.205 | acc=57.00% f1=69.62% auc=62.65% | SP_sex=2.13% EO_sex=1.23% SP_age=12.47% EO_age=11.43%
[TIME] 1.21 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold2_rep0_seed2/summary_fold_2.json
