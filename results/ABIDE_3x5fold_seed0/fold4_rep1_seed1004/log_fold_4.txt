[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4721 mb_mean=0.5002 norm_overlap=0.9999 corr_cb=-0.1647 topkJ=0.0157
[TRAIN][ep=000] loss=0.6976 acc=50.74%
[TRAIN][ep=000] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1975
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4770 mb_mean=0.4998 norm_overlap=0.9998 corr_cb=-0.3436 topkJ=0.0036
[TRAIN][ep=001] loss=0.6955 acc=49.53%
[TRAIN][ep=001] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1999
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4738 mb_mean=0.5016 norm_overlap=0.9996 corr_cb=-0.4790 topkJ=0.0004
[TRAIN][ep=002] loss=0.6942 acc=51.41%
[TRAIN][ep=002] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2027
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4776 mb_mean=0.5006 norm_overlap=0.9998 corr_cb=-0.3552 topkJ=0.0111
[TRAIN][ep=003] loss=0.6943 acc=48.99%
[TRAIN][ep=003] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2020
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4748 mb_mean=0.5000 norm_overlap=0.9999 corr_cb=-0.1629 topkJ=0.0285
[TRAIN][ep=004] loss=0.6926 acc=51.14%
[TRAIN][ep=004] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2047
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4745 mb_mean=0.4997 norm_overlap=0.9999 corr_cb=-0.1323 topkJ=0.0316
[TRAIN][ep=005] loss=0.6920 acc=51.54%
[TRAIN][ep=005] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1977
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4771 mb_mean=0.4972 norm_overlap=0.9998 corr_cb=-0.2743 topkJ=0.0103
[TRAIN][ep=006] loss=0.6907 acc=55.30%
[TRAIN][ep=006] mask_avg: mc_mean=0.4756 mb_mean=0.4992 norm_overlap=0.9999 corr_cb=-0.1986
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4738 mb_mean=0.4973 norm_overlap=0.9999 corr_cb=-0.1266 topkJ=0.0306
[TRAIN][ep=007] loss=0.6909 acc=53.56%
[TRAIN][ep=007] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2027
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4717 mb_mean=0.5007 norm_overlap=0.9998 corr_cb=-0.2901 topkJ=0.0142
[TRAIN][ep=008] loss=0.6896 acc=56.78%
[TRAIN][ep=008] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1953
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4772 mb_mean=0.5007 norm_overlap=0.9999 corr_cb=-0.2881 topkJ=0.0134
[TRAIN][ep=009] loss=0.6880 acc=54.09%
[TRAIN][ep=009] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1962
================= FIT START (fold=4) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4762 mb_mean=0.4988 norm_overlap=0.9999 corr_cb=-0.2022 topkJ=0.0282
[TRAIN][ep=000] loss=0.6871 acc=56.11%
[TRAIN][ep=000] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1983
[EPOCH 000/089] train: loss=0.6871 acc=56.11% | val: loss=0.6933 acc=53.01% f1=66.67% auc=49.19% val_score=52.7169 val_score_bestthr=56.4585 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.198) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 56.4585
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/ckpt_best_fold_4.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4752 mb_mean=0.4988 norm_overlap=0.9999 corr_cb=-0.2582 topkJ=0.0120
[TRAIN][ep=001] loss=0.6859 acc=55.17%
[TRAIN][ep=001] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2040
[EPOCH 001/089] train: loss=0.6859 acc=55.17% | val: loss=0.6961 acc=54.22% f1=64.81% auc=47.67% val_score=34.1361 val_score_bestthr=57.0337 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.204) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 56.4585 -> 57.0337
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/ckpt_best_fold_4.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4765 mb_mean=0.4979 norm_overlap=0.9999 corr_cb=-0.1296 topkJ=0.0093
[TRAIN][ep=002] loss=0.6846 acc=60.67%
[TRAIN][ep=002] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1937
[EPOCH 002/089] train: loss=0.6846 acc=60.67% | val: loss=0.6929 acc=51.81% f1=68.25% auc=51.16% val_score=46.8735 val_score_bestthr=62.0453 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.194) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 57.0337 -> 62.0453
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/ckpt_best_fold_4.pt
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4731 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2435 topkJ=0.0106
[TRAIN][ep=003] loss=0.6846 acc=57.32%
[TRAIN][ep=003] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2014
[EPOCH 003/089] train: loss=0.6846 acc=57.32% | val: loss=0.6913 acc=51.81% f1=68.25% auc=53.14% val_score=49.5248 val_score_bestthr=62.0453 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.201) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 62.0453
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4765 mb_mean=0.4969 norm_overlap=0.9999 corr_cb=-0.2336 topkJ=0.0250
[TRAIN][ep=004] loss=0.6829 acc=56.64%
[TRAIN][ep=004] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2016
[EPOCH 004/089] train: loss=0.6829 acc=56.64% | val: loss=0.6900 acc=51.81% f1=68.25% auc=54.88% val_score=52.2830 val_score_bestthr=62.0453 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.202) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 62.0453
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4758 mb_mean=0.4977 norm_overlap=0.9998 corr_cb=-0.3229 topkJ=0.0168
[TRAIN][ep=005] loss=1.2676 acc=61.48%
[TRAIN][ep=005] mask_avg: mc_mean=0.3413 mb_mean=0.4991 norm_overlap=0.9989 corr_cb=-0.2563
[EPOCH 005/089] train: loss=1.2676 acc=61.48% | val: loss=0.6985 acc=54.22% f1=67.24% auc=49.36% val_score=32.4196 val_score_bestthr=57.0098 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.341, mb=0.499, no=0.999, corr=-0.256) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 57.0098
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2305 mb_mean=0.5012 norm_overlap=0.9978 corr_cb=-0.3191 topkJ=0.0062
[TRAIN][ep=006] loss=1.2615 acc=57.32%
[TRAIN][ep=006] mask_avg: mc_mean=0.2238 mb_mean=0.4991 norm_overlap=0.9974 corr_cb=-0.2854
[EPOCH 006/089] train: loss=1.2615 acc=57.32% | val: loss=0.6901 acc=51.81% f1=68.25% auc=54.53% val_score=54.1965 val_score_bestthr=62.0453 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.224, mb=0.499, no=0.997, corr=-0.285) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 62.0453
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.1812 mb_mean=0.5002 norm_overlap=0.9953 corr_cb=-0.3991 topkJ=0.0068
[TRAIN][ep=007] loss=1.2612 acc=60.00%
[TRAIN][ep=007] mask_avg: mc_mean=0.1971 mb_mean=0.4991 norm_overlap=0.9963 corr_cb=-0.3368
[EPOCH 007/089] train: loss=1.2612 acc=60.00% | val: loss=0.6938 acc=55.42% f1=67.26% auc=51.57% val_score=46.6129 val_score_bestthr=57.6518 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.197, mb=0.499, no=0.996, corr=-0.337) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 57.6518
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2188 mb_mean=0.4990 norm_overlap=0.9959 corr_cb=-0.3944 topkJ=0.0065
[TRAIN][ep=008] loss=1.0211 acc=58.66%
[TRAIN][ep=008] mask_avg: mc_mean=0.1829 mb_mean=0.4991 norm_overlap=0.9952 corr_cb=-0.3766
[EPOCH 008/089] train: loss=1.0211 acc=58.66% | val: loss=0.6898 acc=51.81% f1=68.25% auc=55.06% val_score=53.1306 val_score_bestthr=62.0453 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.183, mb=0.499, no=0.995, corr=-0.377) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 62.0453
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1626 mb_mean=0.4992 norm_overlap=0.9938 corr_cb=-0.4670 topkJ=0.0062
[TRAIN][ep=009] loss=0.7795 acc=59.46%
[TRAIN][ep=009] mask_avg: mc_mean=0.1833 mb_mean=0.4991 norm_overlap=0.9943 corr_cb=-0.4267
[EPOCH 009/089] train: loss=0.7795 acc=59.46% | val: loss=0.6919 acc=51.81% f1=68.25% auc=56.34% val_score=57.2994 val_score_bestthr=62.0453 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.183, mb=0.499, no=0.994, corr=-0.427) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 62.0453
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1582 mb_mean=0.5005 norm_overlap=0.9961 corr_cb=-0.3390 topkJ=0.0129
[TRAIN][ep=010] loss=0.7181 acc=62.55%
[TRAIN][ep=010] mask_avg: mc_mean=0.1801 mb_mean=0.4991 norm_overlap=0.9933 corr_cb=-0.4539
[EPOCH 010/089] train: loss=0.7181 acc=62.55% | val: loss=0.6883 acc=51.81% f1=68.25% auc=56.63% val_score=47.3014 val_score_bestthr=62.0453 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.180, mb=0.499, no=0.993, corr=-0.454) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 62.0453
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1529 mb_mean=0.5000 norm_overlap=0.9935 corr_cb=-0.4487 topkJ=0.0051
[TRAIN][ep=011] loss=0.7009 acc=61.34%
[TRAIN][ep=011] mask_avg: mc_mean=0.1715 mb_mean=0.4992 norm_overlap=0.9922 corr_cb=-0.4627
[EPOCH 011/089] train: loss=0.7009 acc=61.34% | val: loss=0.6890 acc=54.22% f1=66.07% auc=56.22% val_score=50.8338 val_score_bestthr=56.1344 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.172, mb=0.499, no=0.992, corr=-0.463) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 56.1344
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.2174 mb_mean=0.4969 norm_overlap=0.9949 corr_cb=-0.4003 topkJ=0.0106
[TRAIN][ep=012] loss=0.6969 acc=61.74%
[TRAIN][ep=012] mask_avg: mc_mean=0.1744 mb_mean=0.4991 norm_overlap=0.9915 corr_cb=-0.4560
[EPOCH 012/089] train: loss=0.6969 acc=61.74% | val: loss=0.6881 acc=51.81% f1=68.25% auc=56.57% val_score=49.9350 val_score_bestthr=62.0453 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.174, mb=0.499, no=0.992, corr=-0.456) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 62.0453
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.2018 mb_mean=0.4960 norm_overlap=0.9924 corr_cb=-0.4214 topkJ=0.0024
[TRAIN][ep=013] loss=0.6914 acc=62.15%
[TRAIN][ep=013] mask_avg: mc_mean=0.1726 mb_mean=0.4991 norm_overlap=0.9909 corr_cb=-0.4425
[EPOCH 013/089] train: loss=0.6914 acc=62.15% | val: loss=0.6898 acc=59.04% f1=63.04% auc=56.63% val_score=49.0716 val_score_bestthr=54.7445 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.173, mb=0.499, no=0.991, corr=-0.442) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 54.7445
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1455 mb_mean=0.5003 norm_overlap=0.9913 corr_cb=-0.3726 topkJ=0.0055
[TRAIN][ep=014] loss=0.6894 acc=60.67%
[TRAIN][ep=014] mask_avg: mc_mean=0.1736 mb_mean=0.4991 norm_overlap=0.9903 corr_cb=-0.4378
[EPOCH 014/089] train: loss=0.6894 acc=60.67% | val: loss=0.6906 acc=59.04% f1=63.04% auc=56.51% val_score=52.8404 val_score_bestthr=54.7445 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.174, mb=0.499, no=0.990, corr=-0.438) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 54.7445
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.2053 mb_mean=0.4990 norm_overlap=0.9892 corr_cb=-0.5379 topkJ=0.0036
[TRAIN][ep=015] loss=0.6875 acc=61.48%
[TRAIN][ep=015] mask_avg: mc_mean=0.1749 mb_mean=0.4991 norm_overlap=0.9900 corr_cb=-0.4229
[EPOCH 015/089] train: loss=0.6875 acc=61.48% | val: loss=0.6909 acc=60.24% f1=63.74% auc=56.34% val_score=53.0177 val_score_bestthr=58.1807 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.175, mb=0.499, no=0.990, corr=-0.423) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 58.1807
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1294 mb_mean=0.5034 norm_overlap=0.9866 corr_cb=-0.4100 topkJ=0.0059
[TRAIN][ep=016] loss=0.6816 acc=62.95%
[TRAIN][ep=016] mask_avg: mc_mean=0.1786 mb_mean=0.4991 norm_overlap=0.9901 corr_cb=-0.3973
[EPOCH 016/089] train: loss=0.6816 acc=62.95% | val: loss=0.6921 acc=60.24% f1=63.74% auc=56.16% val_score=58.1807 val_score_bestthr=58.1807 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.179, mb=0.499, no=0.990, corr=-0.397) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 58.1807
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1699 mb_mean=0.4979 norm_overlap=0.9912 corr_cb=-0.3598 topkJ=0.0137
[TRAIN][ep=017] loss=0.6738 acc=62.28%
[TRAIN][ep=017] mask_avg: mc_mean=0.1779 mb_mean=0.4991 norm_overlap=0.9899 corr_cb=-0.3928
[EPOCH 017/089] train: loss=0.6738 acc=62.28% | val: loss=0.6943 acc=53.01% f1=67.23% auc=57.27% val_score=49.9350 val_score_bestthr=54.3202 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.178, mb=0.499, no=0.990, corr=-0.393) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 54.3202
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1765 mb_mean=0.5000 norm_overlap=0.9939 corr_cb=-0.2673 topkJ=0.0188
[TRAIN][ep=018] loss=0.6739 acc=63.09%
[TRAIN][ep=018] mask_avg: mc_mean=0.1748 mb_mean=0.4992 norm_overlap=0.9898 corr_cb=-0.3730
[EPOCH 018/089] train: loss=0.6739 acc=63.09% | val: loss=0.6945 acc=51.81% f1=68.25% auc=57.15% val_score=49.8612 val_score_bestthr=62.0453 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.175, mb=0.499, no=0.990, corr=-0.373) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 62.0453
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.2484 mb_mean=0.4994 norm_overlap=0.9877 corr_cb=-0.5201 topkJ=0.0041
[TRAIN][ep=019] loss=0.6731 acc=63.36%
[TRAIN][ep=019] mask_avg: mc_mean=0.2007 mb_mean=0.4991 norm_overlap=0.9905 corr_cb=-0.3706
[EPOCH 019/089] train: loss=0.6731 acc=63.36% | val: loss=0.7078 acc=53.01% f1=66.67% auc=56.10% val_score=42.5726 val_score_bestthr=56.6795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.201, mb=0.499, no=0.991, corr=-0.371) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 56.6795
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1774 mb_mean=0.4995 norm_overlap=0.9896 corr_cb=-0.3747 topkJ=0.0047
[TRAIN][ep=020] loss=0.6716 acc=62.28%
[TRAIN][ep=020] mask_avg: mc_mean=0.1800 mb_mean=0.4991 norm_overlap=0.9902 corr_cb=-0.3499
[EPOCH 020/089] train: loss=0.6716 acc=62.28% | val: loss=0.6976 acc=59.04% f1=61.36% auc=56.69% val_score=49.9350 val_score_bestthr=54.0595 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.180, mb=0.499, no=0.990, corr=-0.350) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 54.0595
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.1844 mb_mean=0.4957 norm_overlap=0.9928 corr_cb=-0.2594 topkJ=0.0231
[TRAIN][ep=021] loss=0.6554 acc=63.22%
[TRAIN][ep=021] mask_avg: mc_mean=0.1881 mb_mean=0.4991 norm_overlap=0.9903 corr_cb=-0.3495
[EPOCH 021/089] train: loss=0.6554 acc=63.22% | val: loss=0.7022 acc=59.04% f1=61.36% auc=57.38% val_score=49.9350 val_score_bestthr=54.0595 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.188, mb=0.499, no=0.990, corr=-0.350) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 54.0595
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2510 mb_mean=0.4965 norm_overlap=0.9918 corr_cb=-0.3619 topkJ=0.0048
[TRAIN][ep=022] loss=0.6584 acc=63.62%
[TRAIN][ep=022] mask_avg: mc_mean=0.2059 mb_mean=0.4991 norm_overlap=0.9911 corr_cb=-0.3364
[EPOCH 022/089] train: loss=0.6584 acc=63.62% | val: loss=0.7091 acc=53.01% f1=67.23% auc=56.05% val_score=39.5964 val_score_bestthr=55.4869 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.206, mb=0.499, no=0.991, corr=-0.336) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 55.4869
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1984 mb_mean=0.4979 norm_overlap=0.9923 corr_cb=-0.3228 topkJ=0.0100
[TRAIN][ep=023] loss=0.6576 acc=63.22%
[TRAIN][ep=023] mask_avg: mc_mean=0.2090 mb_mean=0.4992 norm_overlap=0.9911 corr_cb=-0.3344
[EPOCH 023/089] train: loss=0.6576 acc=63.22% | val: loss=0.7163 acc=53.01% f1=67.23% auc=55.81% val_score=42.5726 val_score_bestthr=55.4869 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.209, mb=0.499, no=0.991, corr=-0.334) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 55.4869
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1526 mb_mean=0.5023 norm_overlap=0.9882 corr_cb=-0.4008 topkJ=0.0086
[TRAIN][ep=024] loss=0.6507 acc=65.64%
[TRAIN][ep=024] mask_avg: mc_mean=0.2013 mb_mean=0.4991 norm_overlap=0.9909 corr_cb=-0.3302
[EPOCH 024/089] train: loss=0.6507 acc=65.64% | val: loss=0.7105 acc=51.81% f1=68.25% auc=55.93% val_score=46.0904 val_score_bestthr=62.0453 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.201, mb=0.499, no=0.991, corr=-0.330) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 62.0453
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1723 mb_mean=0.4994 norm_overlap=0.9895 corr_cb=-0.3542 topkJ=0.0414
[TRAIN][ep=025] loss=0.6467 acc=64.56%
[TRAIN][ep=025] mask_avg: mc_mean=0.2024 mb_mean=0.4991 norm_overlap=0.9914 corr_cb=-0.3095
[EPOCH 025/089] train: loss=0.6467 acc=64.56% | val: loss=0.7112 acc=57.83% f1=58.82% auc=56.86% val_score=52.8312 val_score_bestthr=55.1541 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.202, mb=0.499, no=0.991, corr=-0.309) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 55.1541
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2911 mb_mean=0.4956 norm_overlap=0.9929 corr_cb=-0.3179 topkJ=0.0065
[TRAIN][ep=026] loss=0.6373 acc=65.77%
[TRAIN][ep=026] mask_avg: mc_mean=0.2134 mb_mean=0.4991 norm_overlap=0.9918 corr_cb=-0.3049
[EPOCH 026/089] train: loss=0.6373 acc=65.77% | val: loss=0.7109 acc=51.81% f1=68.25% auc=56.74% val_score=48.1555 val_score_bestthr=62.0453 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.213, mb=0.499, no=0.992, corr=-0.305) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 62.0453
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1318 mb_mean=0.5030 norm_overlap=0.9940 corr_cb=-0.2076 topkJ=0.0205
[TRAIN][ep=027] loss=0.6381 acc=66.58%
[TRAIN][ep=027] mask_avg: mc_mean=0.2014 mb_mean=0.4991 norm_overlap=0.9919 corr_cb=-0.2847
[EPOCH 027/089] train: loss=0.6381 acc=66.58% | val: loss=0.7137 acc=55.42% f1=66.06% auc=56.69% val_score=50.8482 val_score_bestthr=56.5551 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.201, mb=0.499, no=0.992, corr=-0.285) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 56.5551
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2287 mb_mean=0.4994 norm_overlap=0.9919 corr_cb=-0.2858 topkJ=0.0128
[TRAIN][ep=028] loss=0.6348 acc=66.58%
[TRAIN][ep=028] mask_avg: mc_mean=0.2155 mb_mean=0.4991 norm_overlap=0.9924 corr_cb=-0.2794
[EPOCH 028/089] train: loss=0.6348 acc=66.58% | val: loss=0.7175 acc=54.22% f1=65.45% auc=57.09% val_score=46.6453 val_score_bestthr=55.0190 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.216, mb=0.499, no=0.992, corr=-0.279) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 55.0190
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2410 mb_mean=0.4979 norm_overlap=0.9918 corr_cb=-0.3464 topkJ=0.0094
[TRAIN][ep=029] loss=0.6332 acc=66.17%
[TRAIN][ep=029] mask_avg: mc_mean=0.2044 mb_mean=0.4991 norm_overlap=0.9926 corr_cb=-0.2614
[EPOCH 029/089] train: loss=0.6332 acc=66.17% | val: loss=0.7190 acc=51.81% f1=68.25% auc=57.44% val_score=48.1555 val_score_bestthr=62.0453 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.204, mb=0.499, no=0.993, corr=-0.261) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 62.0453
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2094 mb_mean=0.4970 norm_overlap=0.9935 corr_cb=-0.2475 topkJ=0.0200
[TRAIN][ep=030] loss=0.6302 acc=68.32%
[TRAIN][ep=030] mask_avg: mc_mean=0.2044 mb_mean=0.4992 norm_overlap=0.9924 corr_cb=-0.2648
[EPOCH 030/089] train: loss=0.6302 acc=68.32% | val: loss=0.7196 acc=55.42% f1=66.06% auc=57.03% val_score=44.5771 val_score_bestthr=56.5551 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.204, mb=0.499, no=0.992, corr=-0.265) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 56.5551
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2415 mb_mean=0.4980 norm_overlap=0.9912 corr_cb=-0.3326 topkJ=0.0085
[TRAIN][ep=031] loss=0.6266 acc=65.23%
[TRAIN][ep=031] mask_avg: mc_mean=0.2111 mb_mean=0.4991 norm_overlap=0.9927 corr_cb=-0.2607
[EPOCH 031/089] train: loss=0.6266 acc=65.23% | val: loss=0.7324 acc=51.81% f1=68.25% auc=55.93% val_score=46.7191 val_score_bestthr=62.0453 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.211, mb=0.499, no=0.993, corr=-0.261) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 62.0453
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1898 mb_mean=0.4981 norm_overlap=0.9944 corr_cb=-0.2243 topkJ=0.0503
[TRAIN][ep=032] loss=0.6214 acc=67.92%
[TRAIN][ep=032] mask_avg: mc_mean=0.2131 mb_mean=0.4991 norm_overlap=0.9931 corr_cb=-0.2443
[EPOCH 032/089] train: loss=0.6214 acc=67.92% | val: loss=0.7268 acc=51.81% f1=68.25% auc=57.67% val_score=48.1555 val_score_bestthr=62.0453 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.213, mb=0.499, no=0.993, corr=-0.244) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 62.0453
[EARLY STOP] no improvement for 30 epochs. best_epoch=2
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/ckpt_best_fold_4.pt
=============== FIT DONE ===============
[BEST] epoch=2 | val_acc=51.81% | val_f1=68.25% | val_auc=51.16% | val_score=46.8735 | val_score_bestthr=62.0453
[TEST@BEST] thr_used=0.500 | acc=58.94% f1=64.73% auc=61.46% | SP_sex=19.57% EO_sex=15.24% SP_age=14.68% EO_age=9.70%
[TIME] 0.85 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/summary_fold_4.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4721 mb_mean=0.5002 norm_overlap=0.9999 corr_cb=-0.1647 topkJ=0.0157
[TRAIN][ep=000] loss=0.6976 acc=49.40%
[TRAIN][ep=000] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1975
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4770 mb_mean=0.4998 norm_overlap=0.9998 corr_cb=-0.3436 topkJ=0.0036
[TRAIN][ep=001] loss=0.6952 acc=49.13%
[TRAIN][ep=001] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1999
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4738 mb_mean=0.5016 norm_overlap=0.9996 corr_cb=-0.4790 topkJ=0.0004
[TRAIN][ep=002] loss=0.6936 acc=51.28%
[TRAIN][ep=002] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2027
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4776 mb_mean=0.5006 norm_overlap=0.9998 corr_cb=-0.3552 topkJ=0.0111
[TRAIN][ep=003] loss=0.6935 acc=50.87%
[TRAIN][ep=003] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2020
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4748 mb_mean=0.5000 norm_overlap=0.9999 corr_cb=-0.1629 topkJ=0.0285
[TRAIN][ep=004] loss=0.6915 acc=52.08%
[TRAIN][ep=004] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2047
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4745 mb_mean=0.4997 norm_overlap=0.9999 corr_cb=-0.1323 topkJ=0.0316
[TRAIN][ep=005] loss=0.6905 acc=52.35%
[TRAIN][ep=005] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1977
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4771 mb_mean=0.4972 norm_overlap=0.9998 corr_cb=-0.2743 topkJ=0.0103
[TRAIN][ep=006] loss=0.6881 acc=58.12%
[TRAIN][ep=006] mask_avg: mc_mean=0.4756 mb_mean=0.4992 norm_overlap=0.9999 corr_cb=-0.1986
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4738 mb_mean=0.4973 norm_overlap=0.9999 corr_cb=-0.1266 topkJ=0.0306
[TRAIN][ep=007] loss=0.6889 acc=56.64%
[TRAIN][ep=007] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2027
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4717 mb_mean=0.5007 norm_overlap=0.9998 corr_cb=-0.2901 topkJ=0.0142
[TRAIN][ep=008] loss=0.6861 acc=58.79%
[TRAIN][ep=008] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1953
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4772 mb_mean=0.5007 norm_overlap=0.9999 corr_cb=-0.2881 topkJ=0.0134
[TRAIN][ep=009] loss=0.6834 acc=59.60%
[TRAIN][ep=009] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1962
================= FIT START (fold=4) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4762 mb_mean=0.4988 norm_overlap=0.9999 corr_cb=-0.2022 topkJ=0.0282
[TRAIN][ep=000] loss=0.6813 acc=56.91%
[TRAIN][ep=000] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1983
[EPOCH 000/089] train: loss=0.6813 acc=56.91% | val: loss=0.6914 acc=51.81% f1=68.25% auc=53.72% val_score=45.7605 val_score_bestthr=62.0453 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.198) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 62.0453
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/ckpt_best_fold_4.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4752 mb_mean=0.4988 norm_overlap=0.9999 corr_cb=-0.2582 topkJ=0.0120
[TRAIN][ep=001] loss=0.6782 acc=58.26%
[TRAIN][ep=001] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2040
[EPOCH 001/089] train: loss=0.6782 acc=58.26% | val: loss=0.6963 acc=54.22% f1=65.45% auc=52.56% val_score=35.4744 val_score_bestthr=55.8554 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.204) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 55.8554
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4765 mb_mean=0.4979 norm_overlap=0.9999 corr_cb=-0.1296 topkJ=0.0093
[TRAIN][ep=002] loss=0.6756 acc=60.67%
[TRAIN][ep=002] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1937
[EPOCH 002/089] train: loss=0.6756 acc=60.67% | val: loss=0.6911 acc=51.81% f1=68.25% auc=55.06% val_score=44.2125 val_score_bestthr=62.0453 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.194) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 62.0453
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4731 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2435 topkJ=0.0106
[TRAIN][ep=003] loss=0.6748 acc=59.19%
[TRAIN][ep=003] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2014
[EPOCH 003/089] train: loss=0.6748 acc=59.19% | val: loss=0.6879 acc=57.83% f1=55.70% auc=56.51% val_score=47.3014 val_score_bestthr=53.9034 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.201) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 53.9034
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4765 mb_mean=0.4969 norm_overlap=0.9999 corr_cb=-0.2336 topkJ=0.0250
[TRAIN][ep=004] loss=0.6728 acc=57.05%
[TRAIN][ep=004] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2016
[EPOCH 004/089] train: loss=0.6728 acc=57.05% | val: loss=0.6867 acc=51.81% f1=68.25% auc=57.21% val_score=48.8440 val_score_bestthr=62.0453 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.202) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 62.0453
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4758 mb_mean=0.4977 norm_overlap=0.9998 corr_cb=-0.3229 topkJ=0.0168
[TRAIN][ep=005] loss=1.4435 acc=60.00%
[TRAIN][ep=005] mask_avg: mc_mean=0.3380 mb_mean=0.4991 norm_overlap=0.9988 corr_cb=-0.2717
[EPOCH 005/089] train: loss=1.4435 acc=60.00% | val: loss=0.7086 acc=55.42% f1=67.83% auc=51.86% val_score=42.8107 val_score_bestthr=58.6637 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.338, mb=0.499, no=0.999, corr=-0.272) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 58.6637
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2251 mb_mean=0.5012 norm_overlap=0.9976 corr_cb=-0.3275 topkJ=0.0062
[TRAIN][ep=006] loss=1.2073 acc=62.82%
[TRAIN][ep=006] mask_avg: mc_mean=0.2190 mb_mean=0.4991 norm_overlap=0.9973 corr_cb=-0.2911
[EPOCH 006/089] train: loss=1.2073 acc=62.82% | val: loss=0.6897 acc=54.22% f1=66.07% auc=55.70% val_score=49.2965 val_score_bestthr=54.9344 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.219, mb=0.499, no=0.997, corr=-0.291) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 54.9344
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.1758 mb_mean=0.5002 norm_overlap=0.9951 corr_cb=-0.3949 topkJ=0.0056
[TRAIN][ep=007] loss=0.9848 acc=60.54%
[TRAIN][ep=007] mask_avg: mc_mean=0.1929 mb_mean=0.4991 norm_overlap=0.9963 corr_cb=-0.3240
[EPOCH 007/089] train: loss=0.9848 acc=60.54% | val: loss=0.6918 acc=56.63% f1=67.27% auc=55.93% val_score=40.3938 val_score_bestthr=58.1693 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.193, mb=0.499, no=0.996, corr=-0.324) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 58.1693
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2146 mb_mean=0.4990 norm_overlap=0.9958 corr_cb=-0.3845 topkJ=0.0106
[TRAIN][ep=008] loss=0.9364 acc=61.61%
[TRAIN][ep=008] mask_avg: mc_mean=0.1782 mb_mean=0.4991 norm_overlap=0.9952 corr_cb=-0.3519
[EPOCH 008/089] train: loss=0.9364 acc=61.61% | val: loss=0.6900 acc=51.81% f1=68.25% auc=57.15% val_score=47.3014 val_score_bestthr=62.0453 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.178, mb=0.499, no=0.995, corr=-0.352) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 62.0453
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1611 mb_mean=0.4992 norm_overlap=0.9940 corr_cb=-0.4132 topkJ=0.0078
[TRAIN][ep=009] loss=0.9341 acc=58.93%
[TRAIN][ep=009] mask_avg: mc_mean=0.1792 mb_mean=0.4991 norm_overlap=0.9943 corr_cb=-0.3836
[EPOCH 009/089] train: loss=0.9341 acc=58.93% | val: loss=0.6954 acc=51.81% f1=68.25% auc=57.73% val_score=47.3014 val_score_bestthr=62.0453 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.179, mb=0.499, no=0.994, corr=-0.384) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 62.0453
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1488 mb_mean=0.5005 norm_overlap=0.9963 corr_cb=-0.2742 topkJ=0.0137
[TRAIN][ep=010] loss=0.9271 acc=62.55%
[TRAIN][ep=010] mask_avg: mc_mean=0.1742 mb_mean=0.4991 norm_overlap=0.9933 corr_cb=-0.4084
[EPOCH 010/089] train: loss=0.9271 acc=62.55% | val: loss=0.6890 acc=59.04% f1=62.22% auc=58.31% val_score=42.7427 val_score_bestthr=57.5882 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.174, mb=0.499, no=0.993, corr=-0.408) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 57.5882
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1432 mb_mean=0.5000 norm_overlap=0.9935 corr_cb=-0.3963 topkJ=0.0059
[TRAIN][ep=011] loss=0.9189 acc=62.95%
[TRAIN][ep=011] mask_avg: mc_mean=0.1639 mb_mean=0.4992 norm_overlap=0.9923 corr_cb=-0.4054
[EPOCH 011/089] train: loss=0.9189 acc=62.95% | val: loss=0.6893 acc=62.65% f1=65.17% auc=57.85% val_score=53.9309 val_score_bestthr=59.0601 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.164, mb=0.499, no=0.992, corr=-0.405) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 59.0601
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.2150 mb_mean=0.4969 norm_overlap=0.9954 corr_cb=-0.3265 topkJ=0.0122
[TRAIN][ep=012] loss=0.9140 acc=63.62%
[TRAIN][ep=012] mask_avg: mc_mean=0.1728 mb_mean=0.4991 norm_overlap=0.9920 corr_cb=-0.3954
[EPOCH 012/089] train: loss=0.9140 acc=63.62% | val: loss=0.6931 acc=61.45% f1=63.64% auc=56.98% val_score=57.0512 val_score_bestthr=57.0512 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.173, mb=0.499, no=0.992, corr=-0.395) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 57.0512
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1959 mb_mean=0.4960 norm_overlap=0.9928 corr_cb=-0.3674 topkJ=0.0036
[TRAIN][ep=013] loss=0.9053 acc=64.16%
[TRAIN][ep=013] mask_avg: mc_mean=0.1759 mb_mean=0.4991 norm_overlap=0.9917 corr_cb=-0.3883
[EPOCH 013/089] train: loss=0.9053 acc=64.16% | val: loss=0.6969 acc=59.04% f1=63.04% auc=57.56% val_score=48.8440 val_score_bestthr=57.0779 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.176, mb=0.499, no=0.992, corr=-0.388) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 57.0779
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1406 mb_mean=0.5003 norm_overlap=0.9919 corr_cb=-0.3233 topkJ=0.0066
[TRAIN][ep=014] loss=0.9008 acc=64.56%
[TRAIN][ep=014] mask_avg: mc_mean=0.1730 mb_mean=0.4991 norm_overlap=0.9910 corr_cb=-0.3908
[EPOCH 014/089] train: loss=0.9008 acc=64.56% | val: loss=0.6984 acc=61.45% f1=63.64% auc=57.67% val_score=52.8455 val_score_bestthr=56.6157 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.173, mb=0.499, no=0.991, corr=-0.391) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 56.6157
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.2077 mb_mean=0.4990 norm_overlap=0.9899 corr_cb=-0.5024 topkJ=0.0048
[TRAIN][ep=015] loss=0.9024 acc=63.62%
[TRAIN][ep=015] mask_avg: mc_mean=0.1731 mb_mean=0.4991 norm_overlap=0.9908 corr_cb=-0.3811
[EPOCH 015/089] train: loss=0.9024 acc=63.62% | val: loss=0.7090 acc=61.45% f1=64.44% auc=56.92% val_score=39.9453 val_score_bestthr=54.2192 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.173, mb=0.499, no=0.991, corr=-0.381) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 54.2192
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1239 mb_mean=0.5034 norm_overlap=0.9869 corr_cb=-0.3930 topkJ=0.0055
[TRAIN][ep=016] loss=0.8943 acc=66.04%
[TRAIN][ep=016] mask_avg: mc_mean=0.1779 mb_mean=0.4991 norm_overlap=0.9909 corr_cb=-0.3706
[EPOCH 016/089] train: loss=0.8943 acc=66.04% | val: loss=0.6993 acc=54.22% f1=65.45% auc=58.14% val_score=51.8413 val_score_bestthr=55.9968 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.178, mb=0.499, no=0.991, corr=-0.371) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 55.9968
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1839 mb_mean=0.4979 norm_overlap=0.9923 corr_cb=-0.3427 topkJ=0.0149
[TRAIN][ep=017] loss=0.8854 acc=66.98%
[TRAIN][ep=017] mask_avg: mc_mean=0.1827 mb_mean=0.4991 norm_overlap=0.9908 corr_cb=-0.3816
[EPOCH 017/089] train: loss=0.8854 acc=66.98% | val: loss=0.7079 acc=51.81% f1=68.25% auc=58.90% val_score=50.8550 val_score_bestthr=62.0453 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.183, mb=0.499, no=0.991, corr=-0.382) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 62.0453
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1832 mb_mean=0.5000 norm_overlap=0.9948 corr_cb=-0.2454 topkJ=0.0216
[TRAIN][ep=018] loss=0.8850 acc=66.17%
[TRAIN][ep=018] mask_avg: mc_mean=0.1805 mb_mean=0.4992 norm_overlap=0.9905 corr_cb=-0.3729
[EPOCH 018/089] train: loss=0.8850 acc=66.17% | val: loss=0.7142 acc=54.22% f1=69.35% auc=59.59% val_score=43.4695 val_score_bestthr=62.3371 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.180, mb=0.499, no=0.991, corr=-0.373) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 62.0453 -> 62.3371
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/ckpt_best_fold_4.pt
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.2511 mb_mean=0.4994 norm_overlap=0.9883 corr_cb=-0.5251 topkJ=0.0037
[TRAIN][ep=019] loss=0.9812 acc=64.97%
[TRAIN][ep=019] mask_avg: mc_mean=0.1877 mb_mean=0.4991 norm_overlap=0.9908 corr_cb=-0.3688
[EPOCH 019/089] train: loss=0.9812 acc=64.97% | val: loss=0.7078 acc=57.83% f1=67.29% auc=57.62% val_score=47.6062 val_score_bestthr=57.8094 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.188, mb=0.499, no=0.991, corr=-0.369) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 57.8094
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1584 mb_mean=0.4995 norm_overlap=0.9891 corr_cb=-0.3948 topkJ=0.0047
[TRAIN][ep=020] loss=1.0579 acc=67.25%
[TRAIN][ep=020] mask_avg: mc_mean=0.1679 mb_mean=0.4991 norm_overlap=0.9902 corr_cb=-0.3634
[EPOCH 020/089] train: loss=1.0579 acc=67.25% | val: loss=0.7085 acc=59.04% f1=67.92% auc=58.31% val_score=42.9367 val_score_bestthr=57.9539 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.168, mb=0.499, no=0.990, corr=-0.363) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 57.9539
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2133 mb_mean=0.4957 norm_overlap=0.9926 corr_cb=-0.3229 topkJ=0.0231
[TRAIN][ep=021] loss=1.1250 acc=67.79%
[TRAIN][ep=021] mask_avg: mc_mean=0.1854 mb_mean=0.4991 norm_overlap=0.9906 corr_cb=-0.3689
[EPOCH 021/089] train: loss=1.1250 acc=67.79% | val: loss=0.7170 acc=53.01% f1=68.80% auc=59.83% val_score=46.4739 val_score_bestthr=61.2320 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.185, mb=0.499, no=0.991, corr=-0.369) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 61.2320
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2307 mb_mean=0.4965 norm_overlap=0.9927 corr_cb=-0.3320 topkJ=0.0044
[TRAIN][ep=022] loss=1.2114 acc=66.31%
[TRAIN][ep=022] mask_avg: mc_mean=0.1800 mb_mean=0.4991 norm_overlap=0.9911 corr_cb=-0.3360
[EPOCH 022/089] train: loss=1.2114 acc=66.31% | val: loss=0.7208 acc=59.04% f1=67.92% auc=58.08% val_score=49.0091 val_score_bestthr=57.9539 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.180, mb=0.499, no=0.991, corr=-0.336) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 57.9539
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1791 mb_mean=0.4979 norm_overlap=0.9920 corr_cb=-0.3516 topkJ=0.0092
[TRAIN][ep=023] loss=1.2785 acc=68.99%
[TRAIN][ep=023] mask_avg: mc_mean=0.1994 mb_mean=0.4992 norm_overlap=0.9915 corr_cb=-0.3402
[EPOCH 023/089] train: loss=1.2785 acc=68.99% | val: loss=0.7442 acc=59.04% f1=67.92% auc=57.50% val_score=36.5939 val_score_bestthr=57.9539 | dyn(w_pfs=0.100, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.199, mb=0.499, no=0.991, corr=-0.340) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 57.9539
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1559 mb_mean=0.5023 norm_overlap=0.9894 corr_cb=-0.4038 topkJ=0.0082
[TRAIN][ep=024] loss=1.0654 acc=69.13%
[TRAIN][ep=024] mask_avg: mc_mean=0.1900 mb_mean=0.4991 norm_overlap=0.9914 corr_cb=-0.3312
[EPOCH 024/089] train: loss=1.0654 acc=69.13% | val: loss=0.7276 acc=59.04% f1=68.52% auc=58.90% val_score=40.2063 val_score_bestthr=55.1517 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.499, no=0.991, corr=-0.331) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 55.1517
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1636 mb_mean=0.4994 norm_overlap=0.9889 corr_cb=-0.3857 topkJ=0.0379
[TRAIN][ep=025] loss=0.8485 acc=69.66%
[TRAIN][ep=025] mask_avg: mc_mean=0.1872 mb_mean=0.4991 norm_overlap=0.9919 corr_cb=-0.3044
[EPOCH 025/089] train: loss=0.8485 acc=69.66% | val: loss=0.7319 acc=60.24% f1=69.16% auc=58.78% val_score=40.2063 val_score_bestthr=56.4362 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.187, mb=0.499, no=0.992, corr=-0.304) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 56.4362
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2877 mb_mean=0.4956 norm_overlap=0.9932 corr_cb=-0.3293 topkJ=0.0052
[TRAIN][ep=026] loss=0.8319 acc=69.66%
[TRAIN][ep=026] mask_avg: mc_mean=0.1994 mb_mean=0.4991 norm_overlap=0.9922 corr_cb=-0.3017
[EPOCH 026/089] train: loss=0.8319 acc=69.66% | val: loss=0.7472 acc=60.24% f1=69.16% auc=58.43% val_score=47.7911 val_score_bestthr=56.4362 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.199, mb=0.499, no=0.992, corr=-0.302) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 56.4362
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.0966 mb_mean=0.5030 norm_overlap=0.9938 corr_cb=-0.2001 topkJ=0.0205
[TRAIN][ep=027] loss=0.8367 acc=70.87%
[TRAIN][ep=027] mask_avg: mc_mean=0.1770 mb_mean=0.4991 norm_overlap=0.9923 corr_cb=-0.2731
[EPOCH 027/089] train: loss=0.8367 acc=70.87% | val: loss=0.7473 acc=57.83% f1=67.89% auc=59.88% val_score=48.0550 val_score_bestthr=53.6467 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.177, mb=0.499, no=0.992, corr=-0.273) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 53.6467
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1968 mb_mean=0.4994 norm_overlap=0.9916 corr_cb=-0.2920 topkJ=0.0116
[TRAIN][ep=028] loss=0.8339 acc=70.60%
[TRAIN][ep=028] mask_avg: mc_mean=0.1832 mb_mean=0.4991 norm_overlap=0.9926 corr_cb=-0.2701
[EPOCH 028/089] train: loss=0.8339 acc=70.60% | val: loss=0.7497 acc=57.83% f1=67.89% auc=59.36% val_score=45.6992 val_score_bestthr=53.6467 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.183, mb=0.499, no=0.993, corr=-0.270) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 53.6467
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2073 mb_mean=0.4979 norm_overlap=0.9921 corr_cb=-0.3298 topkJ=0.0074
[TRAIN][ep=029] loss=0.8232 acc=71.68%
[TRAIN][ep=029] mask_avg: mc_mean=0.1872 mb_mean=0.4991 norm_overlap=0.9932 corr_cb=-0.2501
[EPOCH 029/089] train: loss=0.8232 acc=71.68% | val: loss=0.7831 acc=53.01% f1=68.29% auc=59.65% val_score=43.1946 val_score_bestthr=56.7094 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.187, mb=0.499, no=0.993, corr=-0.250) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 56.7094
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2373 mb_mean=0.4970 norm_overlap=0.9950 corr_cb=-0.2265 topkJ=0.0242
[TRAIN][ep=030] loss=0.8294 acc=71.68%
[TRAIN][ep=030] mask_avg: mc_mean=0.1857 mb_mean=0.4992 norm_overlap=0.9927 corr_cb=-0.2659
[EPOCH 030/089] train: loss=0.8294 acc=71.68% | val: loss=0.7615 acc=51.81% f1=67.74% auc=59.19% val_score=42.5962 val_score_bestthr=56.7716 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.186, mb=0.499, no=0.993, corr=-0.266) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 56.7716
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2226 mb_mean=0.4980 norm_overlap=0.9922 corr_cb=-0.3123 topkJ=0.0093
[TRAIN][ep=031] loss=0.8188 acc=70.07%
[TRAIN][ep=031] mask_avg: mc_mean=0.1934 mb_mean=0.4991 norm_overlap=0.9930 corr_cb=-0.2632
[EPOCH 031/089] train: loss=0.8188 acc=70.07% | val: loss=0.7599 acc=51.81% f1=68.25% auc=59.13% val_score=45.6339 val_score_bestthr=62.0453 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.193, mb=0.499, no=0.993, corr=-0.263) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 62.0453
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1679 mb_mean=0.4981 norm_overlap=0.9949 corr_cb=-0.2151 topkJ=0.0478
[TRAIN][ep=032] loss=0.8118 acc=72.08%
[TRAIN][ep=032] mask_avg: mc_mean=0.1870 mb_mean=0.4991 norm_overlap=0.9935 corr_cb=-0.2390
[EPOCH 032/089] train: loss=0.8118 acc=72.08% | val: loss=0.7658 acc=51.81% f1=68.25% auc=59.24% val_score=48.2478 val_score_bestthr=62.0453 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.187, mb=0.499, no=0.993, corr=-0.239) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 62.0453
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2198 mb_mean=0.4969 norm_overlap=0.9934 corr_cb=-0.2714 topkJ=0.0205
[TRAIN][ep=033] loss=0.8019 acc=71.14%
[TRAIN][ep=033] mask_avg: mc_mean=0.1805 mb_mean=0.4991 norm_overlap=0.9937 corr_cb=-0.2232
[EPOCH 033/089] train: loss=0.8019 acc=71.14% | val: loss=0.7730 acc=51.81% f1=67.74% auc=59.19% val_score=44.2339 val_score_bestthr=56.7716 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.180, mb=0.499, no=0.994, corr=-0.223) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 56.7716
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2040 mb_mean=0.4955 norm_overlap=0.9958 corr_cb=-0.1610 topkJ=0.0316
[TRAIN][ep=034] loss=0.7941 acc=72.48%
[TRAIN][ep=034] mask_avg: mc_mean=0.1734 mb_mean=0.4991 norm_overlap=0.9939 corr_cb=-0.2126
[EPOCH 034/089] train: loss=0.7941 acc=72.48% | val: loss=0.7954 acc=51.81% f1=68.25% auc=59.77% val_score=48.9439 val_score_bestthr=62.0453 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.173, mb=0.499, no=0.994, corr=-0.213) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 62.0453
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.1920 mb_mean=0.4987 norm_overlap=0.9950 corr_cb=-0.1844 topkJ=0.0273
[TRAIN][ep=035] loss=0.7914 acc=73.83%
[TRAIN][ep=035] mask_avg: mc_mean=0.1973 mb_mean=0.4991 norm_overlap=0.9944 corr_cb=-0.2166
[EPOCH 035/089] train: loss=0.7914 acc=73.83% | val: loss=0.7909 acc=51.81% f1=67.74% auc=59.24% val_score=40.7193 val_score_bestthr=56.7716 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.197, mb=0.499, no=0.994, corr=-0.217) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 56.7716
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2262 mb_mean=0.4963 norm_overlap=0.9970 corr_cb=-0.1313 topkJ=0.0309
[TRAIN][ep=036] loss=0.7892 acc=72.62%
[TRAIN][ep=036] mask_avg: mc_mean=0.2110 mb_mean=0.4991 norm_overlap=0.9949 corr_cb=-0.1994
[EPOCH 036/089] train: loss=0.7892 acc=72.62% | val: loss=0.7982 acc=59.04% f1=65.31% auc=59.19% val_score=39.8551 val_score_bestthr=54.6439 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.211, mb=0.499, no=0.995, corr=-0.199) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 54.6439
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1643 mb_mean=0.4991 norm_overlap=0.9984 corr_cb=-0.0527 topkJ=0.0660
[TRAIN][ep=037] loss=0.7805 acc=74.63%
[TRAIN][ep=037] mask_avg: mc_mean=0.2010 mb_mean=0.4991 norm_overlap=0.9952 corr_cb=-0.1815
[EPOCH 037/089] train: loss=0.7805 acc=74.63% | val: loss=0.8039 acc=51.81% f1=67.74% auc=58.49% val_score=47.3379 val_score_bestthr=56.7716 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.201, mb=0.499, no=0.995, corr=-0.182) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 56.7716
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.1489 mb_mean=0.4984 norm_overlap=0.9961 corr_cb=-0.1314 topkJ=0.0152
[TRAIN][ep=038] loss=0.7749 acc=72.89%
[TRAIN][ep=038] mask_avg: mc_mean=0.1911 mb_mean=0.4991 norm_overlap=0.9949 corr_cb=-0.1877
[EPOCH 038/089] train: loss=0.7749 acc=72.89% | val: loss=0.7964 acc=53.01% f1=68.29% auc=59.36% val_score=48.9724 val_score_bestthr=56.7094 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.191, mb=0.499, no=0.995, corr=-0.188) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 56.7094
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2211 mb_mean=0.4963 norm_overlap=1.0004 corr_cb=0.0203 topkJ=0.0691
[TRAIN][ep=039] loss=0.7748 acc=74.50%
[TRAIN][ep=039] mask_avg: mc_mean=0.2073 mb_mean=0.4991 norm_overlap=0.9953 corr_cb=-0.1824
[EPOCH 039/089] train: loss=0.7748 acc=74.50% | val: loss=0.8097 acc=51.81% f1=67.74% auc=58.49% val_score=42.9005 val_score_bestthr=56.7716 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.207, mb=0.499, no=0.995, corr=-0.182) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 56.7716
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.1713 mb_mean=0.4988 norm_overlap=0.9940 corr_cb=-0.2073 topkJ=0.0216
[TRAIN][ep=040] loss=0.7641 acc=74.23%
[TRAIN][ep=040] mask_avg: mc_mean=0.1974 mb_mean=0.4992 norm_overlap=0.9958 corr_cb=-0.1595
[EPOCH 040/089] train: loss=0.7641 acc=74.23% | val: loss=0.8233 acc=51.81% f1=67.74% auc=58.78% val_score=42.9005 val_score_bestthr=56.7716 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.197, mb=0.499, no=0.996, corr=-0.159) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 56.7716
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.1410 mb_mean=0.5002 norm_overlap=0.9981 corr_cb=-0.0742 topkJ=0.0435
[TRAIN][ep=041] loss=0.7612 acc=74.09%
[TRAIN][ep=041] mask_avg: mc_mean=0.2187 mb_mean=0.4991 norm_overlap=0.9961 corr_cb=-0.1546
[EPOCH 041/089] train: loss=0.7612 acc=74.09% | val: loss=0.8871 acc=60.24% f1=65.26% auc=58.14% val_score=34.9280 val_score_bestthr=51.6225 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.219, mb=0.499, no=0.996, corr=-0.155) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 51.6225
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.1347 mb_mean=0.4995 norm_overlap=0.9981 corr_cb=-0.0733 topkJ=0.0254
[TRAIN][ep=042] loss=0.7502 acc=75.84%
[TRAIN][ep=042] mask_avg: mc_mean=0.2004 mb_mean=0.4991 norm_overlap=0.9959 corr_cb=-0.1519
[EPOCH 042/089] train: loss=0.7502 acc=75.84% | val: loss=0.8345 acc=56.63% f1=64.71% auc=58.60% val_score=45.3534 val_score_bestthr=54.3558 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.200, mb=0.499, no=0.996, corr=-0.152) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 54.3558
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.1601 mb_mean=0.4981 norm_overlap=0.9976 corr_cb=-0.0800 topkJ=0.0495
[TRAIN][ep=043] loss=0.7430 acc=75.44%
[TRAIN][ep=043] mask_avg: mc_mean=0.1954 mb_mean=0.4991 norm_overlap=0.9964 corr_cb=-0.1328
[EPOCH 043/089] train: loss=0.7430 acc=75.44% | val: loss=0.8514 acc=57.83% f1=65.35% auc=58.60% val_score=45.3534 val_score_bestthr=54.5293 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.195, mb=0.499, no=0.996, corr=-0.133) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 54.5293
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.1714 mb_mean=0.4991 norm_overlap=0.9932 corr_cb=-0.2179 topkJ=0.0328
[TRAIN][ep=044] loss=0.7466 acc=74.50%
[TRAIN][ep=044] mask_avg: mc_mean=0.1977 mb_mean=0.4991 norm_overlap=0.9965 corr_cb=-0.1290
[EPOCH 044/089] train: loss=0.7466 acc=74.50% | val: loss=0.8335 acc=57.83% f1=63.92% auc=58.43% val_score=44.4179 val_score_bestthr=54.4683 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.198, mb=0.499, no=0.996, corr=-0.129) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 54.4683
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2070 mb_mean=0.4983 norm_overlap=0.9990 corr_cb=-0.0445 topkJ=0.0473
[TRAIN][ep=045] loss=0.7332 acc=76.11%
[TRAIN][ep=045] mask_avg: mc_mean=0.1979 mb_mean=0.4991 norm_overlap=0.9966 corr_cb=-0.1264
[EPOCH 045/089] train: loss=0.7332 acc=76.11% | val: loss=0.8399 acc=56.63% f1=64.71% auc=58.60% val_score=42.9572 val_score_bestthr=55.4950 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.198, mb=0.499, no=0.997, corr=-0.126) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 55.4950
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.2145 mb_mean=0.4995 norm_overlap=0.9968 corr_cb=-0.1183 topkJ=0.0361
[TRAIN][ep=046] loss=0.7315 acc=76.64%
[TRAIN][ep=046] mask_avg: mc_mean=0.1989 mb_mean=0.4991 norm_overlap=0.9966 corr_cb=-0.1273
[EPOCH 046/089] train: loss=0.7315 acc=76.64% | val: loss=0.8406 acc=57.83% f1=65.35% auc=58.49% val_score=47.9787 val_score_bestthr=57.0018 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.199, mb=0.499, no=0.997, corr=-0.127) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 57.0018
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.2722 mb_mean=0.4995 norm_overlap=0.9983 corr_cb=-0.0775 topkJ=0.0389
[TRAIN][ep=047] loss=0.7200 acc=77.99%
[TRAIN][ep=047] mask_avg: mc_mean=0.2192 mb_mean=0.4992 norm_overlap=0.9968 corr_cb=-0.1264
[EPOCH 047/089] train: loss=0.7200 acc=77.99% | val: loss=0.9186 acc=59.04% f1=64.58% auc=58.31% val_score=33.1279 val_score_bestthr=52.8431 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.219, mb=0.499, no=0.997, corr=-0.126) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 52.8431
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.1323 mb_mean=0.5025 norm_overlap=0.9945 corr_cb=-0.1815 topkJ=0.0236
[TRAIN][ep=048] loss=0.7293 acc=75.84%
[TRAIN][ep=048] mask_avg: mc_mean=0.2039 mb_mean=0.4991 norm_overlap=0.9968 corr_cb=-0.1221
[EPOCH 048/089] train: loss=0.7293 acc=75.84% | val: loss=0.8533 acc=53.01% f1=68.29% auc=58.90% val_score=45.8769 val_score_bestthr=56.7094 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.204, mb=0.499, no=0.997, corr=-0.122) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 56.7094
[EARLY STOP] no improvement for 30 epochs. best_epoch=18
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/ckpt_best_fold_4.pt
=============== FIT DONE ===============
[BEST] epoch=18 | val_acc=54.22% | val_f1=69.35% | val_auc=59.59% | val_score=43.4695 | val_score_bestthr=62.3371
[TEST@BEST] thr_used=0.575 | acc=66.67% f1=70.13% auc=67.74% | SP_sex=10.33% EO_sex=4.18% SP_age=22.99% EO_age=11.58%
[TIME] 1.16 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/summary_fold_4.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4721 mb_mean=0.5002 norm_overlap=0.9999 corr_cb=-0.1647 topkJ=0.0157
[TRAIN][ep=000] loss=0.6976 acc=49.40%
[TRAIN][ep=000] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1975
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4770 mb_mean=0.4998 norm_overlap=0.9998 corr_cb=-0.3436 topkJ=0.0036
[TRAIN][ep=001] loss=0.6952 acc=49.13%
[TRAIN][ep=001] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1999
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4738 mb_mean=0.5016 norm_overlap=0.9996 corr_cb=-0.4790 topkJ=0.0004
[TRAIN][ep=002] loss=0.6936 acc=51.28%
[TRAIN][ep=002] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2027
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4776 mb_mean=0.5006 norm_overlap=0.9998 corr_cb=-0.3552 topkJ=0.0111
[TRAIN][ep=003] loss=0.6935 acc=50.87%
[TRAIN][ep=003] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2020
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4748 mb_mean=0.5000 norm_overlap=0.9999 corr_cb=-0.1629 topkJ=0.0285
[TRAIN][ep=004] loss=0.6915 acc=52.08%
[TRAIN][ep=004] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2047
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4745 mb_mean=0.4997 norm_overlap=0.9999 corr_cb=-0.1323 topkJ=0.0316
[TRAIN][ep=005] loss=0.6905 acc=52.35%
[TRAIN][ep=005] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1977
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4771 mb_mean=0.4972 norm_overlap=0.9998 corr_cb=-0.2743 topkJ=0.0103
[TRAIN][ep=006] loss=0.6881 acc=58.12%
[TRAIN][ep=006] mask_avg: mc_mean=0.4756 mb_mean=0.4992 norm_overlap=0.9999 corr_cb=-0.1986
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4738 mb_mean=0.4973 norm_overlap=0.9999 corr_cb=-0.1266 topkJ=0.0306
[TRAIN][ep=007] loss=0.6889 acc=56.64%
[TRAIN][ep=007] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2027
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4717 mb_mean=0.5007 norm_overlap=0.9998 corr_cb=-0.2901 topkJ=0.0142
[TRAIN][ep=008] loss=0.6861 acc=58.79%
[TRAIN][ep=008] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1953
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4772 mb_mean=0.5007 norm_overlap=0.9999 corr_cb=-0.2881 topkJ=0.0134
[TRAIN][ep=009] loss=0.6834 acc=59.60%
[TRAIN][ep=009] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1962
================= FIT START (fold=4) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.45 select_by=val_score_bestthr | eval_thr_mode=fixed eval_thr_grid=coarse | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4762 mb_mean=0.4988 norm_overlap=0.9999 corr_cb=-0.2022 topkJ=0.0282
[TRAIN][ep=000] loss=0.6813 acc=56.91%
[TRAIN][ep=000] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1983
[EPOCH 000/089] train: loss=0.6813 acc=56.91% | val: loss=0.6914 acc=50.60% f1=67.20% auc=53.72% val_score=56.3748 val_score_bestthr=56.3748 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.198) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 56.3748
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/ckpt_best_fold_4.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4752 mb_mean=0.4988 norm_overlap=0.9999 corr_cb=-0.2582 topkJ=0.0120
[TRAIN][ep=001] loss=0.6782 acc=58.26%
[TRAIN][ep=001] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2040
[EPOCH 001/089] train: loss=0.6782 acc=58.26% | val: loss=0.6963 acc=53.01% f1=64.22% auc=52.56% val_score=51.3750 val_score_bestthr=51.3750 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.204) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 56.3748 -> 51.3750
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4765 mb_mean=0.4979 norm_overlap=0.9999 corr_cb=-0.1296 topkJ=0.0093
[TRAIN][ep=002] loss=0.6756 acc=60.67%
[TRAIN][ep=002] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1937
[EPOCH 002/089] train: loss=0.6756 acc=60.67% | val: loss=0.6911 acc=50.60% f1=64.35% auc=55.06% val_score=50.2104 val_score_bestthr=50.2104 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.194) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 56.3748 -> 50.2104
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4731 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2435 topkJ=0.0106
[TRAIN][ep=003] loss=0.6748 acc=59.19%
[TRAIN][ep=003] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2014
[EPOCH 003/089] train: loss=0.6748 acc=59.19% | val: loss=0.6879 acc=50.60% f1=67.20% auc=56.51% val_score=56.3748 val_score_bestthr=56.3748 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.201) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 56.3748 -> 56.3748
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4765 mb_mean=0.4969 norm_overlap=0.9999 corr_cb=-0.2336 topkJ=0.0250
[TRAIN][ep=004] loss=0.6728 acc=57.05%
[TRAIN][ep=004] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2016
[EPOCH 004/089] train: loss=0.6728 acc=57.05% | val: loss=0.6867 acc=49.40% f1=64.41% auc=57.27% val_score=49.1950 val_score_bestthr=49.1950 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.202) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 56.3748 -> 49.1950
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4758 mb_mean=0.4977 norm_overlap=0.9998 corr_cb=-0.3229 topkJ=0.0168
[TRAIN][ep=005] loss=1.4435 acc=60.00%
[TRAIN][ep=005] mask_avg: mc_mean=0.3380 mb_mean=0.4991 norm_overlap=0.9988 corr_cb=-0.2717
[EPOCH 005/089] train: loss=1.4435 acc=60.00% | val: loss=0.7086 acc=49.40% f1=44.74% auc=51.86% val_score=40.6599 val_score_bestthr=40.6599 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.338, mb=0.499, no=0.999, corr=-0.272) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 56.3748 -> 40.6599
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2251 mb_mean=0.5012 norm_overlap=0.9976 corr_cb=-0.3275 topkJ=0.0062
[TRAIN][ep=006] loss=1.2073 acc=62.82%
[TRAIN][ep=006] mask_avg: mc_mean=0.2190 mb_mean=0.4991 norm_overlap=0.9973 corr_cb=-0.2910
[EPOCH 006/089] train: loss=1.2073 acc=62.82% | val: loss=0.6897 acc=54.22% f1=65.45% auc=55.76% val_score=50.9554 val_score_bestthr=50.9554 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.219, mb=0.499, no=0.997, corr=-0.291) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 56.3748 -> 50.9554
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.1758 mb_mean=0.5002 norm_overlap=0.9951 corr_cb=-0.3949 topkJ=0.0056
[TRAIN][ep=007] loss=0.9848 acc=60.54%
[TRAIN][ep=007] mask_avg: mc_mean=0.1929 mb_mean=0.4991 norm_overlap=0.9963 corr_cb=-0.3240
[EPOCH 007/089] train: loss=0.9848 acc=60.54% | val: loss=0.6919 acc=51.81% f1=60.78% auc=55.99% val_score=47.7548 val_score_bestthr=47.7548 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.193, mb=0.499, no=0.996, corr=-0.324) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 56.3748 -> 47.7548
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2147 mb_mean=0.4990 norm_overlap=0.9958 corr_cb=-0.3846 topkJ=0.0106
[TRAIN][ep=008] loss=0.9364 acc=61.74%
[TRAIN][ep=008] mask_avg: mc_mean=0.1782 mb_mean=0.4991 norm_overlap=0.9952 corr_cb=-0.3518
[EPOCH 008/089] train: loss=0.9364 acc=61.74% | val: loss=0.6900 acc=50.60% f1=66.67% auc=57.15% val_score=54.1924 val_score_bestthr=54.1924 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.178, mb=0.499, no=0.995, corr=-0.352) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 56.3748 -> 54.1924
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1610 mb_mean=0.4992 norm_overlap=0.9940 corr_cb=-0.4131 topkJ=0.0078
[TRAIN][ep=009] loss=0.9341 acc=58.93%
[TRAIN][ep=009] mask_avg: mc_mean=0.1792 mb_mean=0.4991 norm_overlap=0.9943 corr_cb=-0.3835
[EPOCH 009/089] train: loss=0.9341 acc=58.93% | val: loss=0.6954 acc=51.81% f1=67.74% auc=57.73% val_score=57.2994 val_score_bestthr=57.2994 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.179, mb=0.499, no=0.994, corr=-0.383) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 56.3748 -> 57.2994
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/ckpt_best_fold_4.pt
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1488 mb_mean=0.5005 norm_overlap=0.9963 corr_cb=-0.2741 topkJ=0.0137
[TRAIN][ep=010] loss=1.0150 acc=62.95%
[TRAIN][ep=010] mask_avg: mc_mean=0.1730 mb_mean=0.4991 norm_overlap=0.9933 corr_cb=-0.4113
[EPOCH 010/089] train: loss=1.0150 acc=62.95% | val: loss=0.6881 acc=49.40% f1=63.79% auc=58.43% val_score=48.7165 val_score_bestthr=48.7165 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.173, mb=0.499, no=0.993, corr=-0.411) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 57.2994 -> 48.7165
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1398 mb_mean=0.5000 norm_overlap=0.9933 corr_cb=-0.4018 topkJ=0.0059
[TRAIN][ep=011] loss=1.0934 acc=63.09%
[TRAIN][ep=011] mask_avg: mc_mean=0.1590 mb_mean=0.4992 norm_overlap=0.9921 corr_cb=-0.4132
[EPOCH 011/089] train: loss=1.0934 acc=63.09% | val: loss=0.6879 acc=54.22% f1=64.15% auc=57.85% val_score=52.6477 val_score_bestthr=52.6477 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.159, mb=0.499, no=0.992, corr=-0.413) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 57.2994 -> 52.6477
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.2066 mb_mean=0.4969 norm_overlap=0.9953 corr_cb=-0.3357 topkJ=0.0118
[TRAIN][ep=012] loss=1.1751 acc=63.62%
[TRAIN][ep=012] mask_avg: mc_mean=0.1642 mb_mean=0.4991 norm_overlap=0.9917 corr_cb=-0.4109
[EPOCH 012/089] train: loss=1.1751 acc=63.62% | val: loss=0.6905 acc=53.01% f1=62.14% auc=57.03% val_score=46.0033 val_score_bestthr=46.0033 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.164, mb=0.499, no=0.992, corr=-0.411) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 57.2994 -> 46.0033
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1857 mb_mean=0.4960 norm_overlap=0.9925 corr_cb=-0.3815 topkJ=0.0032
[TRAIN][ep=013] loss=1.2505 acc=64.83%
[TRAIN][ep=013] mask_avg: mc_mean=0.1671 mb_mean=0.4991 norm_overlap=0.9913 corr_cb=-0.4072
[EPOCH 013/089] train: loss=1.2505 acc=64.83% | val: loss=0.6932 acc=50.60% f1=63.06% auc=57.79% val_score=47.9225 val_score_bestthr=47.9225 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.167, mb=0.499, no=0.991, corr=-0.407) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 57.2994 -> 47.9225
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1314 mb_mean=0.5003 norm_overlap=0.9915 corr_cb=-0.3401 topkJ=0.0066
[TRAIN][ep=014] loss=1.3340 acc=64.30%
[TRAIN][ep=014] mask_avg: mc_mean=0.1646 mb_mean=0.4991 norm_overlap=0.9907 corr_cb=-0.4080
[EPOCH 014/089] train: loss=1.3340 acc=64.30% | val: loss=0.6952 acc=50.60% f1=63.72% auc=58.31% val_score=49.9707 val_score_bestthr=49.9707 | dyn(w_pfs=0.100, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.165, mb=0.499, no=0.991, corr=-0.408) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 57.2994 -> 49.9707
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.2015 mb_mean=0.4990 norm_overlap=0.9896 corr_cb=-0.5232 topkJ=0.0044
[TRAIN][ep=015] loss=1.1203 acc=64.16%
[TRAIN][ep=015] mask_avg: mc_mean=0.1638 mb_mean=0.4991 norm_overlap=0.9904 corr_cb=-0.3989
[EPOCH 015/089] train: loss=1.1203 acc=64.16% | val: loss=0.7051 acc=56.63% f1=58.14% auc=56.80% val_score=44.5771 val_score_bestthr=44.5771 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.164, mb=0.499, no=0.990, corr=-0.399) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 57.2994 -> 44.5771
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1127 mb_mean=0.5034 norm_overlap=0.9862 corr_cb=-0.4121 topkJ=0.0043
[TRAIN][ep=016] loss=0.8952 acc=65.64%
[TRAIN][ep=016] mask_avg: mc_mean=0.1678 mb_mean=0.4991 norm_overlap=0.9905 corr_cb=-0.3836
[EPOCH 016/089] train: loss=0.8952 acc=65.64% | val: loss=0.6962 acc=55.42% f1=63.37% auc=58.26% val_score=47.8106 val_score_bestthr=47.8106 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.168, mb=0.499, no=0.991, corr=-0.384) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 57.2994 -> 47.8106
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1729 mb_mean=0.4979 norm_overlap=0.9919 corr_cb=-0.3540 topkJ=0.0149
[TRAIN][ep=017] loss=0.8865 acc=67.25%
[TRAIN][ep=017] mask_avg: mc_mean=0.1760 mb_mean=0.4991 norm_overlap=0.9905 corr_cb=-0.3877
[EPOCH 017/089] train: loss=0.8865 acc=67.25% | val: loss=0.7053 acc=53.01% f1=63.55% auc=58.66% val_score=50.1588 val_score_bestthr=50.1588 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.176, mb=0.499, no=0.991, corr=-0.388) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 57.2994 -> 50.1588
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1788 mb_mean=0.5000 norm_overlap=0.9947 corr_cb=-0.2483 topkJ=0.0216
[TRAIN][ep=018] loss=0.8863 acc=65.77%
[TRAIN][ep=018] mask_avg: mc_mean=0.1766 mb_mean=0.4992 norm_overlap=0.9904 corr_cb=-0.3748
[EPOCH 018/089] train: loss=0.8863 acc=65.77% | val: loss=0.7143 acc=51.81% f1=64.91% auc=59.59% val_score=48.4472 val_score_bestthr=48.4472 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.177, mb=0.499, no=0.990, corr=-0.375) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 57.2994 -> 48.4472
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.2470 mb_mean=0.4994 norm_overlap=0.9881 corr_cb=-0.5266 topkJ=0.0037
[TRAIN][ep=019] loss=0.8899 acc=64.70%
[TRAIN][ep=019] mask_avg: mc_mean=0.1874 mb_mean=0.4991 norm_overlap=0.9908 corr_cb=-0.3686
[EPOCH 019/089] train: loss=0.8899 acc=64.70% | val: loss=0.7070 acc=59.04% f1=63.83% auc=57.50% val_score=52.3486 val_score_bestthr=52.3486 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.187, mb=0.499, no=0.991, corr=-0.369) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 57.2994 -> 52.3486
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1611 mb_mean=0.4995 norm_overlap=0.9891 corr_cb=-0.3973 topkJ=0.0043
[TRAIN][ep=020] loss=0.8810 acc=67.11%
[TRAIN][ep=020] mask_avg: mc_mean=0.1695 mb_mean=0.4991 norm_overlap=0.9903 corr_cb=-0.3608
[EPOCH 020/089] train: loss=0.8810 acc=67.11% | val: loss=0.7163 acc=57.83% f1=58.82% auc=57.85% val_score=46.0904 val_score_bestthr=46.0904 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.170, mb=0.499, no=0.990, corr=-0.361) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 57.2994 -> 46.0904
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2098 mb_mean=0.4957 norm_overlap=0.9927 corr_cb=-0.3142 topkJ=0.0231
[TRAIN][ep=021] loss=0.8656 acc=67.52%
[TRAIN][ep=021] mask_avg: mc_mean=0.1887 mb_mean=0.4991 norm_overlap=0.9907 corr_cb=-0.3645
[EPOCH 021/089] train: loss=0.8656 acc=67.52% | val: loss=0.7232 acc=55.42% f1=66.67% auc=59.65% val_score=51.5810 val_score_bestthr=51.5810 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.189, mb=0.499, no=0.991, corr=-0.364) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 57.2994 -> 51.5810
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2347 mb_mean=0.4965 norm_overlap=0.9928 corr_cb=-0.3301 topkJ=0.0048
[TRAIN][ep=022] loss=0.8671 acc=66.31%
[TRAIN][ep=022] mask_avg: mc_mean=0.1846 mb_mean=0.4991 norm_overlap=0.9912 corr_cb=-0.3344
[EPOCH 022/089] train: loss=0.8671 acc=66.31% | val: loss=0.7247 acc=57.83% f1=59.77% auc=58.43% val_score=41.7189 val_score_bestthr=41.7189 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.185, mb=0.499, no=0.991, corr=-0.334) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 57.2994 -> 41.7189
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1870 mb_mean=0.4979 norm_overlap=0.9921 corr_cb=-0.3523 topkJ=0.0092
[TRAIN][ep=023] loss=0.8526 acc=68.86%
[TRAIN][ep=023] mask_avg: mc_mean=0.2024 mb_mean=0.4992 norm_overlap=0.9916 corr_cb=-0.3377
[EPOCH 023/089] train: loss=0.8526 acc=68.86% | val: loss=0.7556 acc=56.63% f1=53.85% auc=57.79% val_score=44.0378 val_score_bestthr=44.0378 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.202, mb=0.499, no=0.992, corr=-0.338) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 57.2994 -> 44.0378
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1548 mb_mean=0.5023 norm_overlap=0.9894 corr_cb=-0.4011 topkJ=0.0078
[TRAIN][ep=024] loss=0.8521 acc=68.32%
[TRAIN][ep=024] mask_avg: mc_mean=0.1945 mb_mean=0.4991 norm_overlap=0.9913 corr_cb=-0.3370
[EPOCH 024/089] train: loss=0.8521 acc=68.32% | val: loss=0.7319 acc=55.42% f1=61.05% auc=59.01% val_score=46.4705 val_score_bestthr=46.4705 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.195, mb=0.499, no=0.991, corr=-0.337) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 57.2994 -> 46.4705
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1629 mb_mean=0.4994 norm_overlap=0.9887 corr_cb=-0.3892 topkJ=0.0371
[TRAIN][ep=025] loss=0.8485 acc=68.86%
[TRAIN][ep=025] mask_avg: mc_mean=0.1912 mb_mean=0.4991 norm_overlap=0.9917 corr_cb=-0.3134
[EPOCH 025/089] train: loss=0.8485 acc=68.86% | val: loss=0.7325 acc=59.04% f1=63.04% auc=59.13% val_score=48.0052 val_score_bestthr=48.0052 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.191, mb=0.499, no=0.992, corr=-0.313) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 57.2994 -> 48.0052
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2930 mb_mean=0.4956 norm_overlap=0.9930 corr_cb=-0.3415 topkJ=0.0048
[TRAIN][ep=026] loss=0.8326 acc=69.53%
[TRAIN][ep=026] mask_avg: mc_mean=0.2023 mb_mean=0.4991 norm_overlap=0.9920 corr_cb=-0.3137
[EPOCH 026/089] train: loss=0.8326 acc=69.53% | val: loss=0.7452 acc=55.42% f1=58.43% auc=58.37% val_score=37.2960 val_score_bestthr=37.2960 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.202, mb=0.499, no=0.992, corr=-0.314) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 57.2994 -> 37.2960
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.0974 mb_mean=0.5030 norm_overlap=0.9935 corr_cb=-0.2120 topkJ=0.0193
[TRAIN][ep=027] loss=0.8369 acc=70.07%
[TRAIN][ep=027] mask_avg: mc_mean=0.1788 mb_mean=0.4991 norm_overlap=0.9920 corr_cb=-0.2854
[EPOCH 027/089] train: loss=0.8369 acc=70.07% | val: loss=0.7442 acc=56.63% f1=64.71% auc=59.94% val_score=42.1225 val_score_bestthr=42.1225 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.179, mb=0.499, no=0.992, corr=-0.285) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 57.2994 -> 42.1225
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1987 mb_mean=0.4994 norm_overlap=0.9914 corr_cb=-0.3029 topkJ=0.0112
[TRAIN][ep=028] loss=0.8338 acc=70.07%
[TRAIN][ep=028] mask_avg: mc_mean=0.1855 mb_mean=0.4991 norm_overlap=0.9923 corr_cb=-0.2829
[EPOCH 028/089] train: loss=0.8338 acc=70.07% | val: loss=0.7483 acc=56.63% f1=62.50% auc=59.59% val_score=48.0550 val_score_bestthr=48.0550 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.186, mb=0.499, no=0.992, corr=-0.283) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 57.2994 -> 48.0550
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2131 mb_mean=0.4979 norm_overlap=0.9919 corr_cb=-0.3442 topkJ=0.0074
[TRAIN][ep=029] loss=0.8238 acc=71.81%
[TRAIN][ep=029] mask_avg: mc_mean=0.1901 mb_mean=0.4991 norm_overlap=0.9930 corr_cb=-0.2623
[EPOCH 029/089] train: loss=0.8238 acc=71.81% | val: loss=0.7759 acc=54.22% f1=66.07% auc=59.71% val_score=48.8810 val_score_bestthr=48.8810 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.499, no=0.993, corr=-0.262) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 57.2994 -> 48.8810
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2426 mb_mean=0.4970 norm_overlap=0.9947 corr_cb=-0.2416 topkJ=0.0225
[TRAIN][ep=030] loss=0.8289 acc=71.41%
[TRAIN][ep=030] mask_avg: mc_mean=0.1879 mb_mean=0.4992 norm_overlap=0.9925 corr_cb=-0.2780
[EPOCH 030/089] train: loss=0.8289 acc=71.41% | val: loss=0.7594 acc=60.24% f1=60.24% auc=59.59% val_score=47.7911 val_score_bestthr=47.7911 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.188, mb=0.499, no=0.992, corr=-0.278) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 57.2994 -> 47.7911
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2251 mb_mean=0.4980 norm_overlap=0.9920 corr_cb=-0.3239 topkJ=0.0085
[TRAIN][ep=031] loss=0.8194 acc=69.53%
[TRAIN][ep=031] mask_avg: mc_mean=0.1951 mb_mean=0.4991 norm_overlap=0.9927 corr_cb=-0.2758
[EPOCH 031/089] train: loss=0.8194 acc=69.53% | val: loss=0.7589 acc=57.83% f1=60.67% auc=59.19% val_score=39.6743 val_score_bestthr=39.6743 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.195, mb=0.499, no=0.993, corr=-0.276) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 57.2994 -> 39.6743
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1677 mb_mean=0.4981 norm_overlap=0.9947 corr_cb=-0.2263 topkJ=0.0465
[TRAIN][ep=032] loss=0.8119 acc=72.08%
[TRAIN][ep=032] mask_avg: mc_mean=0.1875 mb_mean=0.4991 norm_overlap=0.9932 corr_cb=-0.2513
[EPOCH 032/089] train: loss=0.8119 acc=72.08% | val: loss=0.7643 acc=56.63% f1=62.50% auc=59.48% val_score=48.0550 val_score_bestthr=48.0550 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.187, mb=0.499, no=0.993, corr=-0.251) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 57.2994 -> 48.0550
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2200 mb_mean=0.4969 norm_overlap=0.9932 corr_cb=-0.2822 topkJ=0.0193
[TRAIN][ep=033] loss=0.8028 acc=70.87%
[TRAIN][ep=033] mask_avg: mc_mean=0.1817 mb_mean=0.4991 norm_overlap=0.9935 corr_cb=-0.2356
[EPOCH 033/089] train: loss=0.8028 acc=70.87% | val: loss=0.7711 acc=60.24% f1=63.74% auc=59.42% val_score=46.9144 val_score_bestthr=46.9144 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.182, mb=0.499, no=0.993, corr=-0.236) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 57.2994 -> 46.9144
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2053 mb_mean=0.4955 norm_overlap=0.9956 corr_cb=-0.1738 topkJ=0.0311
[TRAIN][ep=034] loss=0.7944 acc=72.89%
[TRAIN][ep=034] mask_avg: mc_mean=0.1740 mb_mean=0.4991 norm_overlap=0.9937 corr_cb=-0.2247
[EPOCH 034/089] train: loss=0.7944 acc=72.89% | val: loss=0.7928 acc=56.63% f1=65.38% auc=59.88% val_score=49.1254 val_score_bestthr=49.1254 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.174, mb=0.499, no=0.994, corr=-0.225) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 57.2994 -> 49.1254
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.1915 mb_mean=0.4987 norm_overlap=0.9948 corr_cb=-0.1938 topkJ=0.0269
[TRAIN][ep=035] loss=0.7919 acc=73.56%
[TRAIN][ep=035] mask_avg: mc_mean=0.1967 mb_mean=0.4991 norm_overlap=0.9941 corr_cb=-0.2282
[EPOCH 035/089] train: loss=0.7919 acc=73.56% | val: loss=0.7891 acc=57.83% f1=62.37% auc=59.36% val_score=47.2208 val_score_bestthr=47.2208 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.197, mb=0.499, no=0.994, corr=-0.228) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 57.2994 -> 47.2208
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2251 mb_mean=0.4963 norm_overlap=0.9968 corr_cb=-0.1402 topkJ=0.0296
[TRAIN][ep=036] loss=0.7893 acc=72.48%
[TRAIN][ep=036] mask_avg: mc_mean=0.2097 mb_mean=0.4991 norm_overlap=0.9946 corr_cb=-0.2102
[EPOCH 036/089] train: loss=0.7893 acc=72.48% | val: loss=0.7968 acc=59.04% f1=63.04% auc=59.42% val_score=48.0665 val_score_bestthr=48.0665 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.210, mb=0.499, no=0.995, corr=-0.210) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 57.2994 -> 48.0665
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1642 mb_mean=0.4991 norm_overlap=0.9981 corr_cb=-0.0632 topkJ=0.0651
[TRAIN][ep=037] loss=0.7812 acc=74.50%
[TRAIN][ep=037] mask_avg: mc_mean=0.2010 mb_mean=0.4991 norm_overlap=0.9949 corr_cb=-0.1929
[EPOCH 037/089] train: loss=0.7812 acc=74.50% | val: loss=0.8037 acc=57.83% f1=59.77% auc=58.60% val_score=42.7189 val_score_bestthr=42.7189 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.201, mb=0.499, no=0.995, corr=-0.193) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 57.2994 -> 42.7189
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.1496 mb_mean=0.4984 norm_overlap=0.9958 corr_cb=-0.1433 topkJ=0.0144
[TRAIN][ep=038] loss=0.7753 acc=72.75%
[TRAIN][ep=038] mask_avg: mc_mean=0.1911 mb_mean=0.4991 norm_overlap=0.9947 corr_cb=-0.1993
[EPOCH 038/089] train: loss=0.7753 acc=72.75% | val: loss=0.7955 acc=60.24% f1=65.26% auc=59.48% val_score=52.5309 val_score_bestthr=52.5309 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.191, mb=0.499, no=0.995, corr=-0.199) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 57.2994 -> 52.5309
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2211 mb_mean=0.4963 norm_overlap=1.0002 corr_cb=0.0120 topkJ=0.0686
[TRAIN][ep=039] loss=0.7758 acc=74.23%
[TRAIN][ep=039] mask_avg: mc_mean=0.2057 mb_mean=0.4991 norm_overlap=0.9950 corr_cb=-0.1948
[EPOCH 039/089] train: loss=0.7758 acc=74.23% | val: loss=0.8085 acc=59.04% f1=63.04% auc=58.55% val_score=48.0665 val_score_bestthr=48.0665 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.206, mb=0.499, no=0.995, corr=-0.195) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 57.2994 -> 48.0665
[EARLY STOP] no improvement for 30 epochs. best_epoch=9
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/ckpt_best_fold_4.pt
=============== FIT DONE ===============
[BEST] epoch=9 | val_acc=51.81% | val_f1=67.74% | val_auc=57.73% | val_score=57.2994 | val_score_bestthr=57.2994
[TEST@BEST] thr_used=0.450 | acc=53.14% f1=68.40% auc=62.39% | SP_sex=3.26% EO_sex=1.10% SP_age=1.01% EO_age=2.86%
[TIME] 0.84 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/summary_fold_4.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4721 mb_mean=0.5002 norm_overlap=0.9999 corr_cb=-0.1647 topkJ=0.0157
[TRAIN][ep=000] loss=0.6977 acc=48.59%
[TRAIN][ep=000] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1975
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4770 mb_mean=0.4998 norm_overlap=0.9998 corr_cb=-0.3436 topkJ=0.0036
[TRAIN][ep=001] loss=0.6950 acc=49.53%
[TRAIN][ep=001] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1999
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4738 mb_mean=0.5016 norm_overlap=0.9996 corr_cb=-0.4790 topkJ=0.0004
[TRAIN][ep=002] loss=0.6930 acc=51.28%
[TRAIN][ep=002] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2027
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4776 mb_mean=0.5006 norm_overlap=0.9998 corr_cb=-0.3552 topkJ=0.0111
[TRAIN][ep=003] loss=0.6925 acc=52.75%
[TRAIN][ep=003] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2020
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4748 mb_mean=0.5000 norm_overlap=0.9999 corr_cb=-0.1629 topkJ=0.0285
[TRAIN][ep=004] loss=0.6906 acc=53.02%
[TRAIN][ep=004] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2047
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4745 mb_mean=0.4997 norm_overlap=0.9999 corr_cb=-0.1323 topkJ=0.0316
[TRAIN][ep=005] loss=0.6891 acc=54.90%
[TRAIN][ep=005] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1977
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4771 mb_mean=0.4972 norm_overlap=0.9998 corr_cb=-0.2743 topkJ=0.0103
[TRAIN][ep=006] loss=0.6856 acc=58.12%
[TRAIN][ep=006] mask_avg: mc_mean=0.4756 mb_mean=0.4992 norm_overlap=0.9999 corr_cb=-0.1986
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4738 mb_mean=0.4973 norm_overlap=0.9999 corr_cb=-0.1266 topkJ=0.0306
[TRAIN][ep=007] loss=0.6873 acc=57.05%
[TRAIN][ep=007] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2027
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4717 mb_mean=0.5007 norm_overlap=0.9998 corr_cb=-0.2901 topkJ=0.0142
[TRAIN][ep=008] loss=0.6822 acc=57.99%
[TRAIN][ep=008] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1953
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4772 mb_mean=0.5007 norm_overlap=0.9999 corr_cb=-0.2881 topkJ=0.0134
[TRAIN][ep=009] loss=0.6789 acc=58.39%
[TRAIN][ep=009] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1962
================= FIT START (fold=4) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4762 mb_mean=0.4988 norm_overlap=0.9999 corr_cb=-0.2022 topkJ=0.0282
[TRAIN][ep=000] loss=0.6748 acc=58.66%
[TRAIN][ep=000] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1983
[EPOCH 000/089] train: loss=0.6748 acc=58.66% | val: loss=0.6925 acc=54.22% f1=66.07% auc=54.71% val_score=42.1744 val_score_bestthr=54.9344 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.198) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 54.9344
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/ckpt_best_fold_4.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4752 mb_mean=0.4988 norm_overlap=0.9999 corr_cb=-0.2582 topkJ=0.0120
[TRAIN][ep=001] loss=0.6685 acc=60.67%
[TRAIN][ep=001] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2040
[EPOCH 001/089] train: loss=0.6685 acc=60.67% | val: loss=0.6889 acc=60.24% f1=61.18% auc=56.63% val_score=55.5611 val_score_bestthr=55.5611 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.204) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 54.9344 -> 55.5611
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/ckpt_best_fold_4.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4765 mb_mean=0.4979 norm_overlap=0.9999 corr_cb=-0.1296 topkJ=0.0093
[TRAIN][ep=002] loss=0.6655 acc=62.42%
[TRAIN][ep=002] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1937
[EPOCH 002/089] train: loss=0.6655 acc=62.42% | val: loss=0.6905 acc=51.81% f1=68.25% auc=56.69% val_score=39.2574 val_score_bestthr=62.0453 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.194) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 55.5611 -> 62.0453
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/ckpt_best_fold_4.pt
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4731 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2435 topkJ=0.0106
[TRAIN][ep=003] loss=0.6647 acc=60.40%
[TRAIN][ep=003] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2014
[EPOCH 003/089] train: loss=0.6647 acc=60.40% | val: loss=0.6858 acc=63.86% f1=61.54% auc=58.31% val_score=50.2856 val_score_bestthr=55.7466 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.201) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 55.7466
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4765 mb_mean=0.4969 norm_overlap=0.9999 corr_cb=-0.2336 topkJ=0.0250
[TRAIN][ep=004] loss=0.6589 acc=61.07%
[TRAIN][ep=004] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2016
[EPOCH 004/089] train: loss=0.6589 acc=61.07% | val: loss=0.6870 acc=60.24% f1=62.07% auc=57.85% val_score=51.3174 val_score_bestthr=53.8915 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.202) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 53.8915
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4758 mb_mean=0.4977 norm_overlap=0.9998 corr_cb=-0.3229 topkJ=0.0168
[TRAIN][ep=005] loss=1.3618 acc=61.34%
[TRAIN][ep=005] mask_avg: mc_mean=0.3377 mb_mean=0.4991 norm_overlap=0.9987 corr_cb=-0.2822
[EPOCH 005/089] train: loss=1.3618 acc=61.34% | val: loss=0.7044 acc=56.63% f1=67.27% auc=54.77% val_score=39.6203 val_score_bestthr=58.1693 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.338, mb=0.499, no=0.999, corr=-0.282) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 58.1693
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2242 mb_mean=0.5012 norm_overlap=0.9976 corr_cb=-0.3352 topkJ=0.0058
[TRAIN][ep=006] loss=1.3497 acc=62.01%
[TRAIN][ep=006] mask_avg: mc_mean=0.2141 mb_mean=0.4991 norm_overlap=0.9972 corr_cb=-0.2953
[EPOCH 006/089] train: loss=1.3497 acc=62.01% | val: loss=0.6864 acc=54.22% f1=66.07% auc=57.09% val_score=50.2475 val_score_bestthr=54.9344 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.214, mb=0.499, no=0.997, corr=-0.295) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 54.9344
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.1692 mb_mean=0.5002 norm_overlap=0.9949 corr_cb=-0.3991 topkJ=0.0056
[TRAIN][ep=007] loss=1.3443 acc=63.89%
[TRAIN][ep=007] mask_avg: mc_mean=0.1842 mb_mean=0.4991 norm_overlap=0.9961 corr_cb=-0.3241
[EPOCH 007/089] train: loss=1.3443 acc=63.89% | val: loss=0.6865 acc=59.04% f1=62.22% auc=57.27% val_score=46.8960 val_score_bestthr=53.7020 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.184, mb=0.499, no=0.996, corr=-0.324) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 53.7020
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2040 mb_mean=0.4990 norm_overlap=0.9956 corr_cb=-0.3815 topkJ=0.0106
[TRAIN][ep=008] loss=1.1535 acc=63.62%
[TRAIN][ep=008] mask_avg: mc_mean=0.1685 mb_mean=0.4991 norm_overlap=0.9951 corr_cb=-0.3550
[EPOCH 008/089] train: loss=1.1535 acc=63.62% | val: loss=0.6980 acc=59.04% f1=55.26% auc=58.26% val_score=51.4771 val_score_bestthr=53.6410 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.168, mb=0.499, no=0.995, corr=-0.355) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 53.6410
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1499 mb_mean=0.4992 norm_overlap=0.9939 corr_cb=-0.4197 topkJ=0.0082
[TRAIN][ep=009] loss=0.9591 acc=64.30%
[TRAIN][ep=009] mask_avg: mc_mean=0.1700 mb_mean=0.4991 norm_overlap=0.9943 corr_cb=-0.3873
[EPOCH 009/089] train: loss=0.9591 acc=64.30% | val: loss=0.6872 acc=61.45% f1=63.64% auc=57.97% val_score=55.9450 val_score_bestthr=57.0512 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.170, mb=0.499, no=0.994, corr=-0.387) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 57.0512
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1392 mb_mean=0.5005 norm_overlap=0.9962 corr_cb=-0.2828 topkJ=0.0133
[TRAIN][ep=010] loss=0.9315 acc=63.36%
[TRAIN][ep=010] mask_avg: mc_mean=0.1691 mb_mean=0.4991 norm_overlap=0.9934 corr_cb=-0.4132
[EPOCH 010/089] train: loss=0.9315 acc=63.36% | val: loss=0.6865 acc=62.65% f1=65.17% auc=58.90% val_score=50.8338 val_score_bestthr=59.4856 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.169, mb=0.499, no=0.993, corr=-0.413) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 59.4856
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1384 mb_mean=0.5000 norm_overlap=0.9935 corr_cb=-0.4100 topkJ=0.0055
[TRAIN][ep=011] loss=0.9018 acc=64.97%
[TRAIN][ep=011] mask_avg: mc_mean=0.1618 mb_mean=0.4992 norm_overlap=0.9925 corr_cb=-0.4145
[EPOCH 011/089] train: loss=0.9018 acc=64.97% | val: loss=0.6929 acc=61.45% f1=64.44% auc=58.55% val_score=50.5952 val_score_bestthr=57.9526 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.162, mb=0.499, no=0.993, corr=-0.415) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 57.9526
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.2119 mb_mean=0.4969 norm_overlap=0.9958 corr_cb=-0.3151 topkJ=0.0126
[TRAIN][ep=012] loss=0.8984 acc=64.03%
[TRAIN][ep=012] mask_avg: mc_mean=0.1699 mb_mean=0.4991 norm_overlap=0.9922 corr_cb=-0.4120
[EPOCH 012/089] train: loss=0.8984 acc=64.03% | val: loss=0.6949 acc=62.65% f1=64.37% auc=58.49% val_score=55.9450 val_score_bestthr=57.6598 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.170, mb=0.499, no=0.992, corr=-0.412) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 57.6598
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1929 mb_mean=0.4960 norm_overlap=0.9927 corr_cb=-0.3984 topkJ=0.0028
[TRAIN][ep=013] loss=0.8855 acc=66.85%
[TRAIN][ep=013] mask_avg: mc_mean=0.1718 mb_mean=0.4991 norm_overlap=0.9917 corr_cb=-0.4108
[EPOCH 013/089] train: loss=0.8855 acc=66.85% | val: loss=0.7002 acc=60.24% f1=62.92% auc=58.20% val_score=55.1154 val_score_bestthr=55.9450 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.172, mb=0.499, no=0.992, corr=-0.411) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 55.9450
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1257 mb_mean=0.5003 norm_overlap=0.9915 corr_cb=-0.3483 topkJ=0.0059
[TRAIN][ep=014] loss=0.8804 acc=67.11%
[TRAIN][ep=014] mask_avg: mc_mean=0.1655 mb_mean=0.4991 norm_overlap=0.9909 corr_cb=-0.4169
[EPOCH 014/089] train: loss=0.8804 acc=67.11% | val: loss=0.7162 acc=59.04% f1=57.50% auc=59.65% val_score=49.0716 val_score_bestthr=57.5078 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.166, mb=0.499, no=0.991, corr=-0.417) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 57.5078
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.2099 mb_mean=0.4990 norm_overlap=0.9900 corr_cb=-0.5348 topkJ=0.0048
[TRAIN][ep=015] loss=0.8821 acc=65.10%
[TRAIN][ep=015] mask_avg: mc_mean=0.1742 mb_mean=0.4991 norm_overlap=0.9908 corr_cb=-0.4150
[EPOCH 015/089] train: loss=0.8821 acc=65.10% | val: loss=0.7118 acc=57.83% f1=67.29% auc=58.26% val_score=46.5120 val_score_bestthr=57.5872 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.174, mb=0.499, no=0.991, corr=-0.415) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 57.5872
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1287 mb_mean=0.5034 norm_overlap=0.9865 corr_cb=-0.4669 topkJ=0.0031
[TRAIN][ep=016] loss=0.8731 acc=65.37%
[TRAIN][ep=016] mask_avg: mc_mean=0.1787 mb_mean=0.4991 norm_overlap=0.9908 corr_cb=-0.4115
[EPOCH 016/089] train: loss=0.8731 acc=65.37% | val: loss=0.7026 acc=59.04% f1=68.52% auc=60.12% val_score=48.1555 val_score_bestthr=54.9295 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.179, mb=0.499, no=0.991, corr=-0.412) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 54.9295
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1939 mb_mean=0.4979 norm_overlap=0.9922 corr_cb=-0.3949 topkJ=0.0097
[TRAIN][ep=017] loss=0.8636 acc=69.26%
[TRAIN][ep=017] mask_avg: mc_mean=0.1802 mb_mean=0.4991 norm_overlap=0.9906 corr_cb=-0.4224
[EPOCH 017/089] train: loss=0.8636 acc=69.26% | val: loss=0.7202 acc=53.01% f1=68.80% auc=59.94% val_score=52.2410 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.180, mb=0.499, no=0.991, corr=-0.422) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 61.2320
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1890 mb_mean=0.5000 norm_overlap=0.9946 corr_cb=-0.2838 topkJ=0.0200
[TRAIN][ep=018] loss=0.8673 acc=68.19%
[TRAIN][ep=018] mask_avg: mc_mean=0.1909 mb_mean=0.4992 norm_overlap=0.9903 corr_cb=-0.4342
[EPOCH 018/089] train: loss=0.8673 acc=68.19% | val: loss=0.7268 acc=53.01% f1=68.80% auc=60.64% val_score=48.7317 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.191, mb=0.499, no=0.990, corr=-0.434) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 61.2320
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.2408 mb_mean=0.4994 norm_overlap=0.9879 corr_cb=-0.5627 topkJ=0.0020
[TRAIN][ep=019] loss=0.8670 acc=67.25%
[TRAIN][ep=019] mask_avg: mc_mean=0.1870 mb_mean=0.4991 norm_overlap=0.9904 corr_cb=-0.4259
[EPOCH 019/089] train: loss=0.8670 acc=67.25% | val: loss=0.7103 acc=57.83% f1=67.89% auc=59.42% val_score=41.0743 val_score_bestthr=54.7859 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.187, mb=0.499, no=0.990, corr=-0.426) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 54.7859
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1590 mb_mean=0.4995 norm_overlap=0.9884 corr_cb=-0.4665 topkJ=0.0028
[TRAIN][ep=020] loss=0.8544 acc=69.66%
[TRAIN][ep=020] mask_avg: mc_mean=0.1780 mb_mean=0.4991 norm_overlap=0.9900 corr_cb=-0.4259
[EPOCH 020/089] train: loss=0.8544 acc=69.66% | val: loss=0.7480 acc=53.01% f1=68.80% auc=59.88% val_score=38.6501 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.178, mb=0.499, no=0.990, corr=-0.426) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 61.2320
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2451 mb_mean=0.4957 norm_overlap=0.9920 corr_cb=-0.4266 topkJ=0.0162
[TRAIN][ep=021] loss=0.8403 acc=71.41%
[TRAIN][ep=021] mask_avg: mc_mean=0.1919 mb_mean=0.4991 norm_overlap=0.9904 corr_cb=-0.4250
[EPOCH 021/089] train: loss=0.8403 acc=71.41% | val: loss=0.7495 acc=53.01% f1=68.80% auc=61.05% val_score=43.8132 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.192, mb=0.499, no=0.990, corr=-0.425) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 61.2320
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2217 mb_mean=0.4965 norm_overlap=0.9927 corr_cb=-0.3542 topkJ=0.0028
[TRAIN][ep=022] loss=0.8443 acc=69.13%
[TRAIN][ep=022] mask_avg: mc_mean=0.1812 mb_mean=0.4991 norm_overlap=0.9908 corr_cb=-0.3920
[EPOCH 022/089] train: loss=0.8443 acc=69.13% | val: loss=0.7305 acc=59.04% f1=67.92% auc=60.29% val_score=44.1033 val_score_bestthr=56.6206 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.181, mb=0.499, no=0.991, corr=-0.392) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 56.6206
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1897 mb_mean=0.4979 norm_overlap=0.9917 corr_cb=-0.4297 topkJ=0.0068
[TRAIN][ep=023] loss=0.8204 acc=72.08%
[TRAIN][ep=023] mask_avg: mc_mean=0.1989 mb_mean=0.4992 norm_overlap=0.9911 corr_cb=-0.4009
[EPOCH 023/089] train: loss=0.8204 acc=72.08% | val: loss=0.7607 acc=59.04% f1=67.92% auc=60.06% val_score=40.0409 val_score_bestthr=56.6206 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.199, mb=0.499, no=0.991, corr=-0.401) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 56.6206
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1584 mb_mean=0.5023 norm_overlap=0.9897 corr_cb=-0.4559 topkJ=0.0047
[TRAIN][ep=024] loss=0.8205 acc=72.08%
[TRAIN][ep=024] mask_avg: mc_mean=0.1804 mb_mean=0.4991 norm_overlap=0.9907 corr_cb=-0.3938
[EPOCH 024/089] train: loss=0.8205 acc=72.08% | val: loss=0.7479 acc=53.01% f1=68.80% auc=60.29% val_score=41.0743 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.180, mb=0.499, no=0.991, corr=-0.394) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 61.2320
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1584 mb_mean=0.4994 norm_overlap=0.9878 corr_cb=-0.4631 topkJ=0.0226
[TRAIN][ep=025] loss=0.8184 acc=71.95%
[TRAIN][ep=025] mask_avg: mc_mean=0.1904 mb_mean=0.4991 norm_overlap=0.9913 corr_cb=-0.3803
[EPOCH 025/089] train: loss=0.8184 acc=71.95% | val: loss=0.7390 acc=57.83% f1=67.89% auc=60.52% val_score=45.4522 val_score_bestthr=54.7859 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.499, no=0.991, corr=-0.380) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 54.7859
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2946 mb_mean=0.4956 norm_overlap=0.9924 corr_cb=-0.4221 topkJ=0.0044
[TRAIN][ep=026] loss=0.7953 acc=71.95%
[TRAIN][ep=026] mask_avg: mc_mean=0.1874 mb_mean=0.4991 norm_overlap=0.9913 corr_cb=-0.3806
[EPOCH 026/089] train: loss=0.7953 acc=71.95% | val: loss=0.7857 acc=57.83% f1=67.29% auc=60.35% val_score=40.6085 val_score_bestthr=53.7146 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.187, mb=0.499, no=0.991, corr=-0.381) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 53.7146
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.0742 mb_mean=0.5030 norm_overlap=0.9925 corr_cb=-0.2669 topkJ=0.0213
[TRAIN][ep=027] loss=0.8036 acc=72.89%
[TRAIN][ep=027] mask_avg: mc_mean=0.1693 mb_mean=0.4991 norm_overlap=0.9915 corr_cb=-0.3497
[EPOCH 027/089] train: loss=0.8036 acc=72.89% | val: loss=0.7607 acc=51.81% f1=68.25% auc=61.34% val_score=46.5594 val_score_bestthr=62.0453 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.169, mb=0.499, no=0.991, corr=-0.350) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 62.0453
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1704 mb_mean=0.4994 norm_overlap=0.9903 corr_cb=-0.3699 topkJ=0.0063
[TRAIN][ep=028] loss=0.7938 acc=72.75%
[TRAIN][ep=028] mask_avg: mc_mean=0.1689 mb_mean=0.4991 norm_overlap=0.9919 corr_cb=-0.3401
[EPOCH 028/089] train: loss=0.7938 acc=72.75% | val: loss=0.7586 acc=51.81% f1=68.25% auc=61.16% val_score=40.5371 val_score_bestthr=62.0453 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.169, mb=0.499, no=0.992, corr=-0.340) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 62.0453
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2028 mb_mean=0.4979 norm_overlap=0.9915 corr_cb=-0.4111 topkJ=0.0057
[TRAIN][ep=029] loss=0.7781 acc=73.83%
[TRAIN][ep=029] mask_avg: mc_mean=0.1894 mb_mean=0.4991 norm_overlap=0.9926 corr_cb=-0.3329
[EPOCH 029/089] train: loss=0.7781 acc=73.83% | val: loss=0.8103 acc=53.01% f1=68.29% auc=61.45% val_score=41.6963 val_score_bestthr=56.7094 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.189, mb=0.499, no=0.993, corr=-0.333) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 56.7094
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2330 mb_mean=0.4970 norm_overlap=0.9940 corr_cb=-0.3139 topkJ=0.0162
[TRAIN][ep=030] loss=0.7877 acc=73.83%
[TRAIN][ep=030] mask_avg: mc_mean=0.1772 mb_mean=0.4992 norm_overlap=0.9920 corr_cb=-0.3486
[EPOCH 030/089] train: loss=0.7877 acc=73.83% | val: loss=0.7842 acc=59.04% f1=67.31% auc=60.58% val_score=44.4606 val_score_bestthr=54.4446 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.177, mb=0.499, no=0.992, corr=-0.349) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 54.4446
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2321 mb_mean=0.4980 norm_overlap=0.9925 corr_cb=-0.3803 topkJ=0.0068
[TRAIN][ep=031] loss=0.7727 acc=73.83%
[TRAIN][ep=031] mask_avg: mc_mean=0.1841 mb_mean=0.4991 norm_overlap=0.9922 corr_cb=-0.3502
[EPOCH 031/089] train: loss=0.7727 acc=73.83% | val: loss=0.7751 acc=51.81% f1=67.74% auc=61.05% val_score=47.0490 val_score_bestthr=56.7716 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.184, mb=0.499, no=0.992, corr=-0.350) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 56.7716
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1598 mb_mean=0.4981 norm_overlap=0.9945 corr_cb=-0.2773 topkJ=0.0268
[TRAIN][ep=032] loss=0.7684 acc=75.03%
[TRAIN][ep=032] mask_avg: mc_mean=0.1849 mb_mean=0.4991 norm_overlap=0.9927 corr_cb=-0.3330
[EPOCH 032/089] train: loss=0.7684 acc=75.03% | val: loss=0.7747 acc=59.04% f1=66.67% auc=62.38% val_score=48.0709 val_score_bestthr=54.6783 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.185, mb=0.499, no=0.993, corr=-0.333) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 54.6783
[EARLY STOP] no improvement for 30 epochs. best_epoch=2
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/ckpt_best_fold_4.pt
=============== FIT DONE ===============
[BEST] epoch=2 | val_acc=51.81% | val_f1=68.25% | val_auc=56.69% | val_score=39.2574 | val_score_bestthr=62.0453
[TEST@BEST] thr_used=0.440 | acc=60.39% f1=68.94% auc=63.59% | SP_sex=11.96% EO_sex=8.72% SP_age=17.75% EO_age=11.68%
[TIME] 0.73 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/summary_fold_4.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4721 mb_mean=0.5002 norm_overlap=0.9999 corr_cb=-0.1647 topkJ=0.0157
[TRAIN][ep=000] loss=0.6977 acc=48.59%
[TRAIN][ep=000] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1975
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4770 mb_mean=0.4998 norm_overlap=0.9998 corr_cb=-0.3436 topkJ=0.0036
[TRAIN][ep=001] loss=0.6950 acc=49.53%
[TRAIN][ep=001] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1999
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4738 mb_mean=0.5016 norm_overlap=0.9996 corr_cb=-0.4790 topkJ=0.0004
[TRAIN][ep=002] loss=0.6930 acc=51.28%
[TRAIN][ep=002] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2027
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4776 mb_mean=0.5006 norm_overlap=0.9998 corr_cb=-0.3552 topkJ=0.0111
[TRAIN][ep=003] loss=0.6925 acc=52.75%
[TRAIN][ep=003] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2020
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4748 mb_mean=0.5000 norm_overlap=0.9999 corr_cb=-0.1629 topkJ=0.0285
[TRAIN][ep=004] loss=0.6906 acc=53.02%
[TRAIN][ep=004] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2047
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4745 mb_mean=0.4997 norm_overlap=0.9999 corr_cb=-0.1323 topkJ=0.0316
[TRAIN][ep=005] loss=0.6891 acc=55.03%
[TRAIN][ep=005] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1977
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4771 mb_mean=0.4972 norm_overlap=0.9998 corr_cb=-0.2743 topkJ=0.0103
[TRAIN][ep=006] loss=0.6856 acc=58.12%
[TRAIN][ep=006] mask_avg: mc_mean=0.4756 mb_mean=0.4992 norm_overlap=0.9999 corr_cb=-0.1986
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4738 mb_mean=0.4973 norm_overlap=0.9999 corr_cb=-0.1266 topkJ=0.0306
[TRAIN][ep=007] loss=0.6873 acc=57.05%
[TRAIN][ep=007] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2027
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4717 mb_mean=0.5007 norm_overlap=0.9998 corr_cb=-0.2901 topkJ=0.0142
[TRAIN][ep=008] loss=0.6822 acc=57.99%
[TRAIN][ep=008] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1953
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4772 mb_mean=0.5007 norm_overlap=0.9999 corr_cb=-0.2881 topkJ=0.0134
[TRAIN][ep=009] loss=0.6789 acc=58.39%
[TRAIN][ep=009] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1962
================= FIT START (fold=4) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4762 mb_mean=0.4988 norm_overlap=0.9999 corr_cb=-0.2022 topkJ=0.0282
[TRAIN][ep=000] loss=0.6748 acc=58.66%
[TRAIN][ep=000] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1983
[EPOCH 000/089] train: loss=0.6748 acc=58.66% | val: loss=0.6925 acc=54.22% f1=66.07% auc=54.65% val_score=42.1744 val_score_bestthr=54.9344 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.198) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 54.9344
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/ckpt_best_fold_4.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4752 mb_mean=0.4988 norm_overlap=0.9999 corr_cb=-0.2582 topkJ=0.0120
[TRAIN][ep=001] loss=0.6685 acc=60.67%
[TRAIN][ep=001] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2040
[EPOCH 001/089] train: loss=0.6685 acc=60.67% | val: loss=0.6889 acc=60.24% f1=61.18% auc=56.57% val_score=55.5611 val_score_bestthr=55.5611 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.204) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 54.9344 -> 55.5611
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/ckpt_best_fold_4.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4765 mb_mean=0.4979 norm_overlap=0.9999 corr_cb=-0.1296 topkJ=0.0093
[TRAIN][ep=002] loss=0.6655 acc=62.42%
[TRAIN][ep=002] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1937
[EPOCH 002/089] train: loss=0.6655 acc=62.42% | val: loss=0.6905 acc=51.81% f1=68.25% auc=56.69% val_score=39.2574 val_score_bestthr=62.0453 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.194) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 55.5611 -> 62.0453
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/ckpt_best_fold_4.pt
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4731 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2435 topkJ=0.0106
[TRAIN][ep=003] loss=0.6647 acc=60.40%
[TRAIN][ep=003] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2014
[EPOCH 003/089] train: loss=0.6647 acc=60.40% | val: loss=0.6858 acc=63.86% f1=61.54% auc=58.31% val_score=44.9148 val_score_bestthr=55.7466 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.201) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 55.7466
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4765 mb_mean=0.4969 norm_overlap=0.9999 corr_cb=-0.2336 topkJ=0.0250
[TRAIN][ep=004] loss=0.6590 acc=61.07%
[TRAIN][ep=004] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2016
[EPOCH 004/089] train: loss=0.6590 acc=61.07% | val: loss=0.6870 acc=59.04% f1=60.47% auc=57.85% val_score=51.3174 val_score_bestthr=54.2051 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.202) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 54.2051
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4758 mb_mean=0.4977 norm_overlap=0.9998 corr_cb=-0.3229 topkJ=0.0168
[TRAIN][ep=005] loss=1.5390 acc=61.21%
[TRAIN][ep=005] mask_avg: mc_mean=0.3418 mb_mean=0.4991 norm_overlap=0.9988 corr_cb=-0.2834
[EPOCH 005/089] train: loss=1.5390 acc=61.21% | val: loss=0.7047 acc=55.42% f1=68.38% auc=54.94% val_score=39.5814 val_score_bestthr=58.2029 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.342, mb=0.499, no=0.999, corr=-0.283) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 58.2029
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2283 mb_mean=0.5012 norm_overlap=0.9977 corr_cb=-0.3361 topkJ=0.0058
[TRAIN][ep=006] loss=1.5248 acc=61.88%
[TRAIN][ep=006] mask_avg: mc_mean=0.2171 mb_mean=0.4991 norm_overlap=0.9973 corr_cb=-0.2955
[EPOCH 006/089] train: loss=1.5248 acc=61.88% | val: loss=0.6863 acc=55.42% f1=66.67% auc=57.03% val_score=46.8960 val_score_bestthr=55.2677 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.217, mb=0.499, no=0.997, corr=-0.295) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 55.2677
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.1708 mb_mean=0.5002 norm_overlap=0.9950 corr_cb=-0.3983 topkJ=0.0056
[TRAIN][ep=007] loss=1.5195 acc=63.76%
[TRAIN][ep=007] mask_avg: mc_mean=0.1856 mb_mean=0.4991 norm_overlap=0.9962 corr_cb=-0.3241
[EPOCH 007/089] train: loss=1.5195 acc=63.76% | val: loss=0.6862 acc=59.04% f1=62.22% auc=57.38% val_score=46.8960 val_score_bestthr=53.7020 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.186, mb=0.499, no=0.996, corr=-0.324) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 53.7020
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2049 mb_mean=0.4990 norm_overlap=0.9957 corr_cb=-0.3800 topkJ=0.0110
[TRAIN][ep=008] loss=1.2588 acc=63.62%
[TRAIN][ep=008] mask_avg: mc_mean=0.1691 mb_mean=0.4991 norm_overlap=0.9951 corr_cb=-0.3540
[EPOCH 008/089] train: loss=1.2588 acc=63.62% | val: loss=0.6977 acc=59.04% f1=56.41% auc=58.20% val_score=49.9497 val_score_bestthr=54.0879 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.169, mb=0.499, no=0.995, corr=-0.354) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 54.0879
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1499 mb_mean=0.4992 norm_overlap=0.9939 corr_cb=-0.4212 topkJ=0.0082
[TRAIN][ep=009] loss=0.9946 acc=63.62%
[TRAIN][ep=009] mask_avg: mc_mean=0.1695 mb_mean=0.4991 norm_overlap=0.9944 corr_cb=-0.3872
[EPOCH 009/089] train: loss=0.9946 acc=63.62% | val: loss=0.6866 acc=61.45% f1=64.44% auc=57.91% val_score=57.9526 val_score_bestthr=57.9526 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.170, mb=0.499, no=0.994, corr=-0.387) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 57.9526
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1393 mb_mean=0.5005 norm_overlap=0.9962 corr_cb=-0.2850 topkJ=0.0133
[TRAIN][ep=010] loss=0.9320 acc=63.62%
[TRAIN][ep=010] mask_avg: mc_mean=0.1686 mb_mean=0.4991 norm_overlap=0.9935 corr_cb=-0.4129
[EPOCH 010/089] train: loss=0.9320 acc=63.62% | val: loss=0.6859 acc=63.86% f1=65.91% auc=58.72% val_score=50.8338 val_score_bestthr=61.0074 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.169, mb=0.499, no=0.994, corr=-0.413) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 61.0074
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1378 mb_mean=0.5000 norm_overlap=0.9936 corr_cb=-0.4094 topkJ=0.0055
[TRAIN][ep=011] loss=0.9020 acc=64.83%
[TRAIN][ep=011] mask_avg: mc_mean=0.1613 mb_mean=0.4992 norm_overlap=0.9926 corr_cb=-0.4140
[EPOCH 011/089] train: loss=0.9020 acc=64.83% | val: loss=0.6923 acc=61.45% f1=64.44% auc=58.49% val_score=50.5952 val_score_bestthr=57.9526 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.161, mb=0.499, no=0.993, corr=-0.414) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 57.9526
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.2114 mb_mean=0.4969 norm_overlap=0.9958 corr_cb=-0.3167 topkJ=0.0122
[TRAIN][ep=012] loss=0.8986 acc=63.76%
[TRAIN][ep=012] mask_avg: mc_mean=0.1692 mb_mean=0.4991 norm_overlap=0.9922 corr_cb=-0.4117
[EPOCH 012/089] train: loss=0.8986 acc=63.76% | val: loss=0.6943 acc=62.65% f1=64.37% auc=58.60% val_score=55.9450 val_score_bestthr=57.6598 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.169, mb=0.499, no=0.992, corr=-0.412) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 57.6598
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1912 mb_mean=0.4960 norm_overlap=0.9928 corr_cb=-0.3949 topkJ=0.0028
[TRAIN][ep=013] loss=0.8857 acc=66.85%
[TRAIN][ep=013] mask_avg: mc_mean=0.1708 mb_mean=0.4991 norm_overlap=0.9917 corr_cb=-0.4105
[EPOCH 013/089] train: loss=0.8857 acc=66.85% | val: loss=0.6997 acc=60.24% f1=62.92% auc=58.31% val_score=55.1154 val_score_bestthr=55.9450 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.171, mb=0.499, no=0.992, corr=-0.410) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 55.9450
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1247 mb_mean=0.5003 norm_overlap=0.9916 corr_cb=-0.3477 topkJ=0.0059
[TRAIN][ep=014] loss=0.8806 acc=66.85%
[TRAIN][ep=014] mask_avg: mc_mean=0.1644 mb_mean=0.4991 norm_overlap=0.9909 corr_cb=-0.4160
[EPOCH 014/089] train: loss=0.8806 acc=66.85% | val: loss=0.7159 acc=59.04% f1=57.50% auc=59.71% val_score=49.0716 val_score_bestthr=57.5078 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.164, mb=0.499, no=0.991, corr=-0.416) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 57.5078
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.2086 mb_mean=0.4990 norm_overlap=0.9900 corr_cb=-0.5339 topkJ=0.0048
[TRAIN][ep=015] loss=0.8822 acc=65.37%
[TRAIN][ep=015] mask_avg: mc_mean=0.1725 mb_mean=0.4991 norm_overlap=0.9908 corr_cb=-0.4139
[EPOCH 015/089] train: loss=0.8822 acc=65.37% | val: loss=0.7112 acc=57.83% f1=67.29% auc=58.31% val_score=46.5120 val_score_bestthr=57.5872 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.173, mb=0.499, no=0.991, corr=-0.414) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 57.5872
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1270 mb_mean=0.5034 norm_overlap=0.9865 corr_cb=-0.4639 topkJ=0.0031
[TRAIN][ep=016] loss=0.8731 acc=65.23%
[TRAIN][ep=016] mask_avg: mc_mean=0.1779 mb_mean=0.4991 norm_overlap=0.9908 corr_cb=-0.4107
[EPOCH 016/089] train: loss=0.8731 acc=65.23% | val: loss=0.7022 acc=59.04% f1=68.52% auc=60.12% val_score=48.1555 val_score_bestthr=54.9295 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.178, mb=0.499, no=0.991, corr=-0.411) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 54.9295
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1929 mb_mean=0.4979 norm_overlap=0.9922 corr_cb=-0.3949 topkJ=0.0093
[TRAIN][ep=017] loss=0.8636 acc=69.13%
[TRAIN][ep=017] mask_avg: mc_mean=0.1798 mb_mean=0.4991 norm_overlap=0.9905 corr_cb=-0.4220
[EPOCH 017/089] train: loss=0.8636 acc=69.13% | val: loss=0.7202 acc=53.01% f1=68.80% auc=60.12% val_score=52.2410 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.180, mb=0.499, no=0.991, corr=-0.422) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 61.2320
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1891 mb_mean=0.5000 norm_overlap=0.9947 corr_cb=-0.2829 topkJ=0.0204
[TRAIN][ep=018] loss=0.8673 acc=68.05%
[TRAIN][ep=018] mask_avg: mc_mean=0.1900 mb_mean=0.4992 norm_overlap=0.9903 corr_cb=-0.4335
[EPOCH 018/089] train: loss=0.8673 acc=68.05% | val: loss=0.7269 acc=53.01% f1=68.80% auc=60.58% val_score=48.7317 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.499, no=0.990, corr=-0.433) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 61.2320
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.2405 mb_mean=0.4994 norm_overlap=0.9879 corr_cb=-0.5623 topkJ=0.0020
[TRAIN][ep=019] loss=0.8670 acc=67.11%
[TRAIN][ep=019] mask_avg: mc_mean=0.1857 mb_mean=0.4991 norm_overlap=0.9903 corr_cb=-0.4255
[EPOCH 019/089] train: loss=0.8670 acc=67.11% | val: loss=0.7100 acc=57.83% f1=67.89% auc=59.48% val_score=41.0743 val_score_bestthr=54.7859 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.186, mb=0.499, no=0.990, corr=-0.425) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 54.7859
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1585 mb_mean=0.4995 norm_overlap=0.9884 corr_cb=-0.4657 topkJ=0.0028
[TRAIN][ep=020] loss=0.8543 acc=69.66%
[TRAIN][ep=020] mask_avg: mc_mean=0.1773 mb_mean=0.4991 norm_overlap=0.9899 corr_cb=-0.4257
[EPOCH 020/089] train: loss=0.8543 acc=69.66% | val: loss=0.7489 acc=51.81% f1=68.25% auc=59.88% val_score=38.6501 val_score_bestthr=62.0453 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.177, mb=0.499, no=0.990, corr=-0.426) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 62.0453
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2418 mb_mean=0.4957 norm_overlap=0.9920 corr_cb=-0.4230 topkJ=0.0166
[TRAIN][ep=021] loss=0.8403 acc=71.14%
[TRAIN][ep=021] mask_avg: mc_mean=0.1918 mb_mean=0.4991 norm_overlap=0.9904 corr_cb=-0.4251
[EPOCH 021/089] train: loss=0.8403 acc=71.14% | val: loss=0.7497 acc=53.01% f1=68.80% auc=61.05% val_score=43.8132 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.192, mb=0.499, no=0.990, corr=-0.425) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 61.2320
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2217 mb_mean=0.4965 norm_overlap=0.9926 corr_cb=-0.3561 topkJ=0.0024
[TRAIN][ep=022] loss=0.8442 acc=69.13%
[TRAIN][ep=022] mask_avg: mc_mean=0.1810 mb_mean=0.4991 norm_overlap=0.9907 corr_cb=-0.3926
[EPOCH 022/089] train: loss=0.8442 acc=69.13% | val: loss=0.7307 acc=59.04% f1=67.92% auc=60.23% val_score=44.1033 val_score_bestthr=56.6206 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.181, mb=0.499, no=0.991, corr=-0.393) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 56.6206
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1888 mb_mean=0.4979 norm_overlap=0.9917 corr_cb=-0.4294 topkJ=0.0068
[TRAIN][ep=023] loss=0.8203 acc=72.08%
[TRAIN][ep=023] mask_avg: mc_mean=0.1983 mb_mean=0.4992 norm_overlap=0.9911 corr_cb=-0.4008
[EPOCH 023/089] train: loss=0.8203 acc=72.08% | val: loss=0.7602 acc=59.04% f1=67.92% auc=59.88% val_score=37.8171 val_score_bestthr=56.6206 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.198, mb=0.499, no=0.991, corr=-0.401) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 56.6206
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1588 mb_mean=0.5023 norm_overlap=0.9897 corr_cb=-0.4554 topkJ=0.0047
[TRAIN][ep=024] loss=0.8204 acc=72.35%
[TRAIN][ep=024] mask_avg: mc_mean=0.1802 mb_mean=0.4991 norm_overlap=0.9907 corr_cb=-0.3934
[EPOCH 024/089] train: loss=0.8204 acc=72.35% | val: loss=0.7481 acc=53.01% f1=68.80% auc=60.29% val_score=41.9371 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.180, mb=0.499, no=0.991, corr=-0.393) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 61.2320
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1584 mb_mean=0.4994 norm_overlap=0.9877 corr_cb=-0.4633 topkJ=0.0226
[TRAIN][ep=025] loss=0.8184 acc=71.81%
[TRAIN][ep=025] mask_avg: mc_mean=0.1902 mb_mean=0.4991 norm_overlap=0.9913 corr_cb=-0.3797
[EPOCH 025/089] train: loss=0.8184 acc=71.81% | val: loss=0.7392 acc=57.83% f1=67.89% auc=60.52% val_score=45.4522 val_score_bestthr=54.7859 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.499, no=0.991, corr=-0.380) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 54.7859
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2951 mb_mean=0.4956 norm_overlap=0.9924 corr_cb=-0.4220 topkJ=0.0044
[TRAIN][ep=026] loss=0.7953 acc=71.95%
[TRAIN][ep=026] mask_avg: mc_mean=0.1873 mb_mean=0.4991 norm_overlap=0.9913 corr_cb=-0.3800
[EPOCH 026/089] train: loss=0.7953 acc=71.95% | val: loss=0.7860 acc=57.83% f1=67.29% auc=60.35% val_score=39.5040 val_score_bestthr=53.7146 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.187, mb=0.499, no=0.991, corr=-0.380) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 53.7146
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.0744 mb_mean=0.5030 norm_overlap=0.9925 corr_cb=-0.2649 topkJ=0.0217
[TRAIN][ep=027] loss=0.8037 acc=72.75%
[TRAIN][ep=027] mask_avg: mc_mean=0.1689 mb_mean=0.4991 norm_overlap=0.9915 corr_cb=-0.3492
[EPOCH 027/089] train: loss=0.8037 acc=72.75% | val: loss=0.7607 acc=51.81% f1=68.25% auc=61.45% val_score=46.5594 val_score_bestthr=62.0453 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.169, mb=0.499, no=0.991, corr=-0.349) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 62.0453
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1701 mb_mean=0.4994 norm_overlap=0.9903 corr_cb=-0.3702 topkJ=0.0063
[TRAIN][ep=028] loss=0.7938 acc=72.62%
[TRAIN][ep=028] mask_avg: mc_mean=0.1681 mb_mean=0.4991 norm_overlap=0.9918 corr_cb=-0.3389
[EPOCH 028/089] train: loss=0.7938 acc=72.62% | val: loss=0.7592 acc=56.63% f1=66.67% auc=61.16% val_score=40.5371 val_score_bestthr=54.7497 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.168, mb=0.499, no=0.992, corr=-0.339) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 54.7497
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2030 mb_mean=0.4979 norm_overlap=0.9916 corr_cb=-0.4071 topkJ=0.0057
[TRAIN][ep=029] loss=0.7784 acc=73.69%
[TRAIN][ep=029] mask_avg: mc_mean=0.1889 mb_mean=0.4991 norm_overlap=0.9926 corr_cb=-0.3312
[EPOCH 029/089] train: loss=0.7784 acc=73.69% | val: loss=0.8114 acc=53.01% f1=68.29% auc=61.57% val_score=41.6963 val_score_bestthr=56.7094 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.189, mb=0.499, no=0.993, corr=-0.331) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 56.7094
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2326 mb_mean=0.4970 norm_overlap=0.9940 corr_cb=-0.3118 topkJ=0.0162
[TRAIN][ep=030] loss=0.7880 acc=73.69%
[TRAIN][ep=030] mask_avg: mc_mean=0.1767 mb_mean=0.4992 norm_overlap=0.9920 corr_cb=-0.3475
[EPOCH 030/089] train: loss=0.7880 acc=73.69% | val: loss=0.7851 acc=59.04% f1=67.31% auc=60.47% val_score=44.4606 val_score_bestthr=54.4446 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.177, mb=0.499, no=0.992, corr=-0.347) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 54.4446
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2308 mb_mean=0.4980 norm_overlap=0.9925 corr_cb=-0.3796 topkJ=0.0068
[TRAIN][ep=031] loss=0.7727 acc=73.83%
[TRAIN][ep=031] mask_avg: mc_mean=0.1830 mb_mean=0.4991 norm_overlap=0.9922 corr_cb=-0.3487
[EPOCH 031/089] train: loss=0.7727 acc=73.83% | val: loss=0.7759 acc=51.81% f1=67.74% auc=60.99% val_score=47.0490 val_score_bestthr=56.7716 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.183, mb=0.499, no=0.992, corr=-0.349) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 56.7716
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1587 mb_mean=0.4981 norm_overlap=0.9945 corr_cb=-0.2758 topkJ=0.0268
[TRAIN][ep=032] loss=0.7687 acc=74.77%
[TRAIN][ep=032] mask_avg: mc_mean=0.1842 mb_mean=0.4991 norm_overlap=0.9927 corr_cb=-0.3312
[EPOCH 032/089] train: loss=0.7687 acc=74.77% | val: loss=0.7754 acc=59.04% f1=66.00% auc=62.38% val_score=48.0709 val_score_bestthr=54.8824 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.184, mb=0.499, no=0.993, corr=-0.331) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 54.8824
[EARLY STOP] no improvement for 30 epochs. best_epoch=2
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/ckpt_best_fold_4.pt
=============== FIT DONE ===============
[BEST] epoch=2 | val_acc=51.81% | val_f1=68.25% | val_auc=56.69% | val_score=39.2574 | val_score_bestthr=62.0453
[TEST@BEST] thr_used=0.440 | acc=60.39% f1=68.94% auc=63.61% | SP_sex=11.96% EO_sex=8.72% SP_age=17.75% EO_age=11.68%
[TIME] 0.81 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/summary_fold_4.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4721 mb_mean=0.5002 norm_overlap=0.9999 corr_cb=-0.1647 topkJ=0.0157
[TRAIN][ep=000] loss=0.6977 acc=48.59%
[TRAIN][ep=000] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1975
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4770 mb_mean=0.4998 norm_overlap=0.9998 corr_cb=-0.3436 topkJ=0.0036
[TRAIN][ep=001] loss=0.6950 acc=49.53%
[TRAIN][ep=001] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1999
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4738 mb_mean=0.5016 norm_overlap=0.9996 corr_cb=-0.4790 topkJ=0.0004
[TRAIN][ep=002] loss=0.6930 acc=51.28%
[TRAIN][ep=002] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2027
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4776 mb_mean=0.5006 norm_overlap=0.9998 corr_cb=-0.3552 topkJ=0.0111
[TRAIN][ep=003] loss=0.6925 acc=52.75%
[TRAIN][ep=003] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2020
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4748 mb_mean=0.5000 norm_overlap=0.9999 corr_cb=-0.1629 topkJ=0.0285
[TRAIN][ep=004] loss=0.6906 acc=53.02%
[TRAIN][ep=004] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2047
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4745 mb_mean=0.4997 norm_overlap=0.9999 corr_cb=-0.1323 topkJ=0.0316
[TRAIN][ep=005] loss=0.6891 acc=55.03%
[TRAIN][ep=005] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1977
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4771 mb_mean=0.4972 norm_overlap=0.9998 corr_cb=-0.2743 topkJ=0.0103
[TRAIN][ep=006] loss=0.6856 acc=58.12%
[TRAIN][ep=006] mask_avg: mc_mean=0.4756 mb_mean=0.4992 norm_overlap=0.9999 corr_cb=-0.1986
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4738 mb_mean=0.4973 norm_overlap=0.9999 corr_cb=-0.1266 topkJ=0.0306
[TRAIN][ep=007] loss=0.6873 acc=57.05%
[TRAIN][ep=007] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2027
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4717 mb_mean=0.5007 norm_overlap=0.9998 corr_cb=-0.2901 topkJ=0.0142
[TRAIN][ep=008] loss=0.6822 acc=57.99%
[TRAIN][ep=008] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1953
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4772 mb_mean=0.5007 norm_overlap=0.9999 corr_cb=-0.2881 topkJ=0.0134
[TRAIN][ep=009] loss=0.6789 acc=58.39%
[TRAIN][ep=009] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1962
================= FIT START (fold=4) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4762 mb_mean=0.4988 norm_overlap=0.9999 corr_cb=-0.2022 topkJ=0.0282
[TRAIN][ep=000] loss=0.6748 acc=58.66%
[TRAIN][ep=000] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1983
[EPOCH 000/089] train: loss=0.6748 acc=58.66% | val: loss=0.6925 acc=54.22% f1=66.07% auc=54.65% val_score=42.1744 val_score_bestthr=54.9344 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.198) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 54.9344
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/ckpt_best_fold_4.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4752 mb_mean=0.4988 norm_overlap=0.9999 corr_cb=-0.2582 topkJ=0.0120
[TRAIN][ep=001] loss=0.6685 acc=60.67%
[TRAIN][ep=001] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2040
[EPOCH 001/089] train: loss=0.6685 acc=60.67% | val: loss=0.6890 acc=60.24% f1=61.18% auc=56.57% val_score=55.5611 val_score_bestthr=55.5611 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.204) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 54.9344 -> 55.5611
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/ckpt_best_fold_4.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4765 mb_mean=0.4979 norm_overlap=0.9999 corr_cb=-0.1296 topkJ=0.0093
[TRAIN][ep=002] loss=0.6655 acc=62.42%
[TRAIN][ep=002] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1937
[EPOCH 002/089] train: loss=0.6655 acc=62.42% | val: loss=0.6905 acc=51.81% f1=68.25% auc=56.69% val_score=39.2574 val_score_bestthr=62.0453 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.194) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 55.5611 -> 62.0453
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/ckpt_best_fold_4.pt
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4731 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2435 topkJ=0.0106
[TRAIN][ep=003] loss=0.6647 acc=60.40%
[TRAIN][ep=003] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2014
[EPOCH 003/089] train: loss=0.6647 acc=60.40% | val: loss=0.6858 acc=63.86% f1=61.54% auc=58.31% val_score=44.9148 val_score_bestthr=55.7466 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.201) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 55.7466
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4765 mb_mean=0.4969 norm_overlap=0.9999 corr_cb=-0.2336 topkJ=0.0250
[TRAIN][ep=004] loss=0.6589 acc=61.07%
[TRAIN][ep=004] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2016
[EPOCH 004/089] train: loss=0.6589 acc=61.07% | val: loss=0.6870 acc=59.04% f1=60.47% auc=57.85% val_score=51.3174 val_score_bestthr=54.2051 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.202) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 54.2051
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4758 mb_mean=0.4977 norm_overlap=0.9998 corr_cb=-0.3229 topkJ=0.0168
[TRAIN][ep=005] loss=1.4799 acc=61.34%
[TRAIN][ep=005] mask_avg: mc_mean=0.3404 mb_mean=0.4991 norm_overlap=0.9988 corr_cb=-0.2829
[EPOCH 005/089] train: loss=1.4799 acc=61.34% | val: loss=0.7046 acc=54.22% f1=67.24% auc=54.83% val_score=41.1187 val_score_bestthr=58.3320 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.340, mb=0.499, no=0.999, corr=-0.283) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 58.3320
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2269 mb_mean=0.5012 norm_overlap=0.9976 corr_cb=-0.3357 topkJ=0.0058
[TRAIN][ep=006] loss=1.4665 acc=61.88%
[TRAIN][ep=006] mask_avg: mc_mean=0.2159 mb_mean=0.4991 norm_overlap=0.9972 corr_cb=-0.2955
[EPOCH 006/089] train: loss=1.4665 acc=61.88% | val: loss=0.6863 acc=55.42% f1=66.67% auc=56.92% val_score=46.8960 val_score_bestthr=55.2677 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.216, mb=0.499, no=0.997, corr=-0.296) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 55.2677
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.1699 mb_mean=0.5002 norm_overlap=0.9949 corr_cb=-0.3985 topkJ=0.0056
[TRAIN][ep=007] loss=1.4611 acc=63.76%
[TRAIN][ep=007] mask_avg: mc_mean=0.1849 mb_mean=0.4991 norm_overlap=0.9962 corr_cb=-0.3243
[EPOCH 007/089] train: loss=1.4611 acc=63.76% | val: loss=0.6864 acc=59.04% f1=62.22% auc=57.21% val_score=46.8960 val_score_bestthr=53.7020 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.185, mb=0.499, no=0.996, corr=-0.324) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 53.7020
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2043 mb_mean=0.4990 norm_overlap=0.9957 corr_cb=-0.3807 topkJ=0.0110
[TRAIN][ep=008] loss=1.2237 acc=63.76%
[TRAIN][ep=008] mask_avg: mc_mean=0.1686 mb_mean=0.4991 norm_overlap=0.9951 corr_cb=-0.3543
[EPOCH 008/089] train: loss=1.2237 acc=63.76% | val: loss=0.6980 acc=59.04% f1=56.41% auc=58.26% val_score=49.9497 val_score_bestthr=54.0879 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.169, mb=0.499, no=0.995, corr=-0.354) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 54.0879
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1494 mb_mean=0.4992 norm_overlap=0.9939 corr_cb=-0.4206 topkJ=0.0082
[TRAIN][ep=009] loss=0.9828 acc=63.89%
[TRAIN][ep=009] mask_avg: mc_mean=0.1694 mb_mean=0.4991 norm_overlap=0.9943 corr_cb=-0.3872
[EPOCH 009/089] train: loss=0.9828 acc=63.89% | val: loss=0.6869 acc=61.45% f1=64.44% auc=57.91% val_score=57.9526 val_score_bestthr=57.9526 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.169, mb=0.499, no=0.994, corr=-0.387) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 57.9526
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1392 mb_mean=0.5005 norm_overlap=0.9962 corr_cb=-0.2843 topkJ=0.0133
[TRAIN][ep=010] loss=0.9319 acc=63.62%
[TRAIN][ep=010] mask_avg: mc_mean=0.1689 mb_mean=0.4991 norm_overlap=0.9935 corr_cb=-0.4131
[EPOCH 010/089] train: loss=0.9319 acc=63.62% | val: loss=0.6863 acc=62.65% f1=65.17% auc=58.90% val_score=50.8338 val_score_bestthr=59.4856 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.169, mb=0.499, no=0.993, corr=-0.413) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 59.4856
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1381 mb_mean=0.5000 norm_overlap=0.9936 corr_cb=-0.4095 topkJ=0.0055
[TRAIN][ep=011] loss=0.9020 acc=64.83%
[TRAIN][ep=011] mask_avg: mc_mean=0.1616 mb_mean=0.4992 norm_overlap=0.9926 corr_cb=-0.4141
[EPOCH 011/089] train: loss=0.9020 acc=64.83% | val: loss=0.6926 acc=61.45% f1=64.44% auc=58.49% val_score=50.5952 val_score_bestthr=57.9526 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.162, mb=0.499, no=0.993, corr=-0.414) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 57.9526
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.2116 mb_mean=0.4969 norm_overlap=0.9958 corr_cb=-0.3166 topkJ=0.0122
[TRAIN][ep=012] loss=0.8986 acc=63.89%
[TRAIN][ep=012] mask_avg: mc_mean=0.1695 mb_mean=0.4991 norm_overlap=0.9922 corr_cb=-0.4119
[EPOCH 012/089] train: loss=0.8986 acc=63.89% | val: loss=0.6946 acc=62.65% f1=64.37% auc=58.60% val_score=55.9450 val_score_bestthr=57.6598 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.170, mb=0.499, no=0.992, corr=-0.412) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 57.6598
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1914 mb_mean=0.4960 norm_overlap=0.9928 corr_cb=-0.3952 topkJ=0.0028
[TRAIN][ep=013] loss=0.8857 acc=66.85%
[TRAIN][ep=013] mask_avg: mc_mean=0.1709 mb_mean=0.4991 norm_overlap=0.9917 corr_cb=-0.4103
[EPOCH 013/089] train: loss=0.8857 acc=66.85% | val: loss=0.6999 acc=60.24% f1=62.92% auc=58.31% val_score=55.1154 val_score_bestthr=55.9450 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.171, mb=0.499, no=0.992, corr=-0.410) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 55.9450
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1250 mb_mean=0.5003 norm_overlap=0.9916 corr_cb=-0.3478 topkJ=0.0059
[TRAIN][ep=014] loss=0.8806 acc=66.98%
[TRAIN][ep=014] mask_avg: mc_mean=0.1647 mb_mean=0.4991 norm_overlap=0.9909 corr_cb=-0.4163
[EPOCH 014/089] train: loss=0.8806 acc=66.98% | val: loss=0.7161 acc=59.04% f1=57.50% auc=59.71% val_score=49.0716 val_score_bestthr=57.5078 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.165, mb=0.499, no=0.991, corr=-0.416) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 57.5078
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.2090 mb_mean=0.4990 norm_overlap=0.9900 corr_cb=-0.5342 topkJ=0.0048
[TRAIN][ep=015] loss=0.8822 acc=65.37%
[TRAIN][ep=015] mask_avg: mc_mean=0.1730 mb_mean=0.4991 norm_overlap=0.9908 corr_cb=-0.4144
[EPOCH 015/089] train: loss=0.8822 acc=65.37% | val: loss=0.7115 acc=57.83% f1=67.29% auc=58.26% val_score=46.5120 val_score_bestthr=57.5872 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.173, mb=0.499, no=0.991, corr=-0.414) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 57.5872
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1275 mb_mean=0.5034 norm_overlap=0.9865 corr_cb=-0.4650 topkJ=0.0031
[TRAIN][ep=016] loss=0.8731 acc=65.37%
[TRAIN][ep=016] mask_avg: mc_mean=0.1778 mb_mean=0.4991 norm_overlap=0.9908 corr_cb=-0.4111
[EPOCH 016/089] train: loss=0.8731 acc=65.37% | val: loss=0.7024 acc=59.04% f1=68.52% auc=60.00% val_score=48.1555 val_score_bestthr=54.9295 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.178, mb=0.499, no=0.991, corr=-0.411) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 54.9295
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1927 mb_mean=0.4979 norm_overlap=0.9922 corr_cb=-0.3949 topkJ=0.0097
[TRAIN][ep=017] loss=0.8636 acc=69.13%
[TRAIN][ep=017] mask_avg: mc_mean=0.1799 mb_mean=0.4991 norm_overlap=0.9905 corr_cb=-0.4222
[EPOCH 017/089] train: loss=0.8636 acc=69.13% | val: loss=0.7203 acc=53.01% f1=68.80% auc=60.12% val_score=52.2410 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.180, mb=0.499, no=0.991, corr=-0.422) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 61.2320
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1893 mb_mean=0.5000 norm_overlap=0.9947 corr_cb=-0.2834 topkJ=0.0204
[TRAIN][ep=018] loss=0.8673 acc=68.05%
[TRAIN][ep=018] mask_avg: mc_mean=0.1905 mb_mean=0.4992 norm_overlap=0.9903 corr_cb=-0.4341
[EPOCH 018/089] train: loss=0.8673 acc=68.05% | val: loss=0.7268 acc=53.01% f1=68.80% auc=60.70% val_score=48.7317 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.499, no=0.990, corr=-0.434) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 61.2320
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.2402 mb_mean=0.4994 norm_overlap=0.9879 corr_cb=-0.5624 topkJ=0.0020
[TRAIN][ep=019] loss=0.8670 acc=67.11%
[TRAIN][ep=019] mask_avg: mc_mean=0.1857 mb_mean=0.4991 norm_overlap=0.9903 corr_cb=-0.4255
[EPOCH 019/089] train: loss=0.8670 acc=67.11% | val: loss=0.7101 acc=57.83% f1=67.89% auc=59.48% val_score=41.0743 val_score_bestthr=54.7859 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.186, mb=0.499, no=0.990, corr=-0.426) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 54.7859
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1582 mb_mean=0.4995 norm_overlap=0.9884 corr_cb=-0.4657 topkJ=0.0028
[TRAIN][ep=020] loss=0.8544 acc=69.66%
[TRAIN][ep=020] mask_avg: mc_mean=0.1775 mb_mean=0.4991 norm_overlap=0.9899 corr_cb=-0.4257
[EPOCH 020/089] train: loss=0.8544 acc=69.66% | val: loss=0.7485 acc=51.81% f1=68.25% auc=59.88% val_score=38.6501 val_score_bestthr=62.0453 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.178, mb=0.499, no=0.990, corr=-0.426) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 62.0453
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2431 mb_mean=0.4957 norm_overlap=0.9920 corr_cb=-0.4242 topkJ=0.0166
[TRAIN][ep=021] loss=0.8402 acc=71.14%
[TRAIN][ep=021] mask_avg: mc_mean=0.1917 mb_mean=0.4991 norm_overlap=0.9904 corr_cb=-0.4250
[EPOCH 021/089] train: loss=0.8402 acc=71.14% | val: loss=0.7499 acc=53.01% f1=68.80% auc=60.99% val_score=43.8132 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.192, mb=0.499, no=0.990, corr=-0.425) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 61.2320
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2216 mb_mean=0.4965 norm_overlap=0.9926 corr_cb=-0.3553 topkJ=0.0028
[TRAIN][ep=022] loss=0.8442 acc=69.13%
[TRAIN][ep=022] mask_avg: mc_mean=0.1807 mb_mean=0.4991 norm_overlap=0.9907 corr_cb=-0.3921
[EPOCH 022/089] train: loss=0.8442 acc=69.13% | val: loss=0.7306 acc=59.04% f1=67.92% auc=60.29% val_score=44.1033 val_score_bestthr=56.6206 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.181, mb=0.499, no=0.991, corr=-0.392) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 56.6206
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1888 mb_mean=0.4979 norm_overlap=0.9917 corr_cb=-0.4297 topkJ=0.0068
[TRAIN][ep=023] loss=0.8203 acc=72.08%
[TRAIN][ep=023] mask_avg: mc_mean=0.1979 mb_mean=0.4992 norm_overlap=0.9911 corr_cb=-0.4008
[EPOCH 023/089] train: loss=0.8203 acc=72.08% | val: loss=0.7605 acc=59.04% f1=67.92% auc=60.00% val_score=37.8171 val_score_bestthr=56.6206 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.198, mb=0.499, no=0.991, corr=-0.401) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 56.6206
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1577 mb_mean=0.5023 norm_overlap=0.9896 corr_cb=-0.4556 topkJ=0.0047
[TRAIN][ep=024] loss=0.8203 acc=72.35%
[TRAIN][ep=024] mask_avg: mc_mean=0.1804 mb_mean=0.4991 norm_overlap=0.9907 corr_cb=-0.3939
[EPOCH 024/089] train: loss=0.8203 acc=72.35% | val: loss=0.7480 acc=53.01% f1=68.80% auc=60.29% val_score=41.9371 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.180, mb=0.499, no=0.991, corr=-0.394) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 61.2320
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1585 mb_mean=0.4994 norm_overlap=0.9877 corr_cb=-0.4639 topkJ=0.0222
[TRAIN][ep=025] loss=0.8183 acc=71.81%
[TRAIN][ep=025] mask_avg: mc_mean=0.1902 mb_mean=0.4991 norm_overlap=0.9913 corr_cb=-0.3801
[EPOCH 025/089] train: loss=0.8183 acc=71.81% | val: loss=0.7392 acc=57.83% f1=67.89% auc=60.47% val_score=45.4522 val_score_bestthr=54.7859 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.499, no=0.991, corr=-0.380) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 54.7859
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2951 mb_mean=0.4956 norm_overlap=0.9924 corr_cb=-0.4221 topkJ=0.0044
[TRAIN][ep=026] loss=0.7952 acc=71.95%
[TRAIN][ep=026] mask_avg: mc_mean=0.1875 mb_mean=0.4991 norm_overlap=0.9913 corr_cb=-0.3805
[EPOCH 026/089] train: loss=0.7952 acc=71.95% | val: loss=0.7857 acc=57.83% f1=67.29% auc=60.29% val_score=39.5040 val_score_bestthr=53.7146 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.188, mb=0.499, no=0.991, corr=-0.380) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 53.7146
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.0747 mb_mean=0.5030 norm_overlap=0.9925 corr_cb=-0.2659 topkJ=0.0213
[TRAIN][ep=027] loss=0.8035 acc=72.89%
[TRAIN][ep=027] mask_avg: mc_mean=0.1690 mb_mean=0.4991 norm_overlap=0.9915 corr_cb=-0.3494
[EPOCH 027/089] train: loss=0.8035 acc=72.89% | val: loss=0.7608 acc=51.81% f1=68.25% auc=61.40% val_score=46.5594 val_score_bestthr=62.0453 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.169, mb=0.499, no=0.991, corr=-0.349) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 62.0453
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1702 mb_mean=0.4994 norm_overlap=0.9903 corr_cb=-0.3700 topkJ=0.0063
[TRAIN][ep=028] loss=0.7937 acc=72.62%
[TRAIN][ep=028] mask_avg: mc_mean=0.1685 mb_mean=0.4991 norm_overlap=0.9918 corr_cb=-0.3393
[EPOCH 028/089] train: loss=0.7937 acc=72.62% | val: loss=0.7591 acc=56.63% f1=66.67% auc=61.16% val_score=40.5371 val_score_bestthr=54.7497 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.168, mb=0.499, no=0.992, corr=-0.339) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 54.7497
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2023 mb_mean=0.4979 norm_overlap=0.9916 corr_cb=-0.4082 topkJ=0.0057
[TRAIN][ep=029] loss=0.7781 acc=73.69%
[TRAIN][ep=029] mask_avg: mc_mean=0.1888 mb_mean=0.4991 norm_overlap=0.9926 corr_cb=-0.3316
[EPOCH 029/089] train: loss=0.7781 acc=73.69% | val: loss=0.8111 acc=53.01% f1=68.29% auc=61.40% val_score=43.1946 val_score_bestthr=56.7094 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.189, mb=0.499, no=0.993, corr=-0.332) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 56.7094
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2324 mb_mean=0.4970 norm_overlap=0.9940 corr_cb=-0.3121 topkJ=0.0162
[TRAIN][ep=030] loss=0.7878 acc=73.83%
[TRAIN][ep=030] mask_avg: mc_mean=0.1766 mb_mean=0.4992 norm_overlap=0.9920 corr_cb=-0.3478
[EPOCH 030/089] train: loss=0.7878 acc=73.83% | val: loss=0.7846 acc=59.04% f1=67.31% auc=60.58% val_score=44.4606 val_score_bestthr=54.4446 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.177, mb=0.499, no=0.992, corr=-0.348) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 54.4446
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2317 mb_mean=0.4980 norm_overlap=0.9925 corr_cb=-0.3799 topkJ=0.0072
[TRAIN][ep=031] loss=0.7726 acc=73.83%
[TRAIN][ep=031] mask_avg: mc_mean=0.1836 mb_mean=0.4991 norm_overlap=0.9922 corr_cb=-0.3491
[EPOCH 031/089] train: loss=0.7726 acc=73.83% | val: loss=0.7755 acc=51.81% f1=67.74% auc=60.93% val_score=47.0490 val_score_bestthr=56.7716 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.184, mb=0.499, no=0.992, corr=-0.349) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 56.7716
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1587 mb_mean=0.4981 norm_overlap=0.9945 corr_cb=-0.2767 topkJ=0.0268
[TRAIN][ep=032] loss=0.7685 acc=74.77%
[TRAIN][ep=032] mask_avg: mc_mean=0.1844 mb_mean=0.4991 norm_overlap=0.9927 corr_cb=-0.3315
[EPOCH 032/089] train: loss=0.7685 acc=74.77% | val: loss=0.7751 acc=59.04% f1=66.00% auc=62.33% val_score=48.0709 val_score_bestthr=54.8824 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.184, mb=0.499, no=0.993, corr=-0.332) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 54.8824
[EARLY STOP] no improvement for 30 epochs. best_epoch=2
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/ckpt_best_fold_4.pt
=============== FIT DONE ===============
[BEST] epoch=2 | val_acc=51.81% | val_f1=68.25% | val_auc=56.69% | val_score=39.2574 | val_score_bestthr=62.0453
[TEST@BEST] thr_used=0.440 | acc=60.39% f1=68.94% auc=63.61% | SP_sex=11.96% EO_sex=8.72% SP_age=17.75% EO_age=11.68%
[TIME] 0.78 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/summary_fold_4.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4721 mb_mean=0.5002 norm_overlap=0.9999 corr_cb=-0.1647 topkJ=0.0157
[TRAIN][ep=000] loss=0.6977 acc=48.59%
[TRAIN][ep=000] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1975
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4770 mb_mean=0.4998 norm_overlap=0.9998 corr_cb=-0.3436 topkJ=0.0036
[TRAIN][ep=001] loss=0.6950 acc=49.53%
[TRAIN][ep=001] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1999
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4738 mb_mean=0.5016 norm_overlap=0.9996 corr_cb=-0.4790 topkJ=0.0004
[TRAIN][ep=002] loss=0.6930 acc=51.28%
[TRAIN][ep=002] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2027
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4776 mb_mean=0.5006 norm_overlap=0.9998 corr_cb=-0.3552 topkJ=0.0111
[TRAIN][ep=003] loss=0.6925 acc=52.75%
[TRAIN][ep=003] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2020
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4748 mb_mean=0.5000 norm_overlap=0.9999 corr_cb=-0.1629 topkJ=0.0285
[TRAIN][ep=004] loss=0.6906 acc=53.02%
[TRAIN][ep=004] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2047
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4745 mb_mean=0.4997 norm_overlap=0.9999 corr_cb=-0.1323 topkJ=0.0316
[TRAIN][ep=005] loss=0.6891 acc=54.90%
[TRAIN][ep=005] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1977
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4771 mb_mean=0.4972 norm_overlap=0.9998 corr_cb=-0.2743 topkJ=0.0103
[TRAIN][ep=006] loss=0.6856 acc=58.12%
[TRAIN][ep=006] mask_avg: mc_mean=0.4756 mb_mean=0.4992 norm_overlap=0.9999 corr_cb=-0.1986
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4738 mb_mean=0.4973 norm_overlap=0.9999 corr_cb=-0.1266 topkJ=0.0306
[TRAIN][ep=007] loss=0.6873 acc=57.05%
[TRAIN][ep=007] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2027
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4717 mb_mean=0.5007 norm_overlap=0.9998 corr_cb=-0.2901 topkJ=0.0142
[TRAIN][ep=008] loss=0.6822 acc=57.99%
[TRAIN][ep=008] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1953
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4772 mb_mean=0.5007 norm_overlap=0.9999 corr_cb=-0.2881 topkJ=0.0134
[TRAIN][ep=009] loss=0.6789 acc=58.39%
[TRAIN][ep=009] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1962
================= FIT START (fold=4) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4762 mb_mean=0.4988 norm_overlap=0.9999 corr_cb=-0.2022 topkJ=0.0282
[TRAIN][ep=000] loss=0.6748 acc=58.66%
[TRAIN][ep=000] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1983
[EPOCH 000/089] train: loss=0.6748 acc=58.66% | val: loss=0.6925 acc=54.22% f1=66.07% auc=54.71% val_score=42.1744 val_score_bestthr=54.9344 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.198) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 54.9344
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/ckpt_best_fold_4.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4752 mb_mean=0.4988 norm_overlap=0.9999 corr_cb=-0.2582 topkJ=0.0120
[TRAIN][ep=001] loss=0.6685 acc=60.67%
[TRAIN][ep=001] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2040
[EPOCH 001/089] train: loss=0.6685 acc=60.67% | val: loss=0.6889 acc=60.24% f1=61.18% auc=56.63% val_score=55.5611 val_score_bestthr=55.5611 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.204) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 54.9344 -> 55.5611
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/ckpt_best_fold_4.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4765 mb_mean=0.4979 norm_overlap=0.9999 corr_cb=-0.1296 topkJ=0.0093
[TRAIN][ep=002] loss=0.6655 acc=62.42%
[TRAIN][ep=002] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1937
[EPOCH 002/089] train: loss=0.6655 acc=62.42% | val: loss=0.6904 acc=51.81% f1=68.25% auc=56.69% val_score=39.2574 val_score_bestthr=62.0453 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.194) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 55.5611 -> 62.0453
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/ckpt_best_fold_4.pt
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4731 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2435 topkJ=0.0106
[TRAIN][ep=003] loss=0.6647 acc=60.40%
[TRAIN][ep=003] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2014
[EPOCH 003/089] train: loss=0.6647 acc=60.40% | val: loss=0.6858 acc=63.86% f1=61.54% auc=58.31% val_score=50.2856 val_score_bestthr=55.7466 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.201) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 55.7466
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4765 mb_mean=0.4969 norm_overlap=0.9999 corr_cb=-0.2336 topkJ=0.0250
[TRAIN][ep=004] loss=0.6589 acc=61.07%
[TRAIN][ep=004] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2016
[EPOCH 004/089] train: loss=0.6589 acc=61.07% | val: loss=0.6870 acc=60.24% f1=62.07% auc=57.85% val_score=51.3174 val_score_bestthr=53.8915 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.202) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 53.8915
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4758 mb_mean=0.4977 norm_overlap=0.9998 corr_cb=-0.3229 topkJ=0.0168
[TRAIN][ep=005] loss=1.2410 acc=61.34%
[TRAIN][ep=005] mask_avg: mc_mean=0.3385 mb_mean=0.4991 norm_overlap=0.9988 corr_cb=-0.2819
[EPOCH 005/089] train: loss=1.2410 acc=61.34% | val: loss=0.7042 acc=56.63% f1=67.27% auc=55.52% val_score=39.5814 val_score_bestthr=58.1693 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.338, mb=0.499, no=0.999, corr=-0.282) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 58.1693
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2254 mb_mean=0.5012 norm_overlap=0.9976 corr_cb=-0.3350 topkJ=0.0058
[TRAIN][ep=006] loss=1.2326 acc=62.68%
[TRAIN][ep=006] mask_avg: mc_mean=0.2154 mb_mean=0.4991 norm_overlap=0.9972 corr_cb=-0.2952
[EPOCH 006/089] train: loss=1.2326 acc=62.68% | val: loss=0.6855 acc=59.04% f1=63.04% auc=57.21% val_score=47.9992 val_score_bestthr=54.6053 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.215, mb=0.499, no=0.997, corr=-0.295) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 54.6053
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.1704 mb_mean=0.5002 norm_overlap=0.9949 corr_cb=-0.3986 topkJ=0.0056
[TRAIN][ep=007] loss=1.2278 acc=63.89%
[TRAIN][ep=007] mask_avg: mc_mean=0.1851 mb_mean=0.4991 norm_overlap=0.9962 corr_cb=-0.3234
[EPOCH 007/089] train: loss=1.2278 acc=63.89% | val: loss=0.6854 acc=59.04% f1=62.22% auc=57.56% val_score=46.8960 val_score_bestthr=53.7020 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.185, mb=0.499, no=0.996, corr=-0.323) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 53.7020
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2041 mb_mean=0.4990 norm_overlap=0.9957 corr_cb=-0.3798 topkJ=0.0106
[TRAIN][ep=008] loss=1.0251 acc=64.83%
[TRAIN][ep=008] mask_avg: mc_mean=0.1688 mb_mean=0.4991 norm_overlap=0.9951 corr_cb=-0.3535
[EPOCH 008/089] train: loss=1.0251 acc=64.83% | val: loss=0.6970 acc=60.24% f1=57.14% auc=58.49% val_score=49.9497 val_score_bestthr=55.6085 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.169, mb=0.499, no=0.995, corr=-0.354) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 55.6085
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1506 mb_mean=0.4992 norm_overlap=0.9939 corr_cb=-0.4183 topkJ=0.0082
[TRAIN][ep=009] loss=0.8196 acc=63.76%
[TRAIN][ep=009] mask_avg: mc_mean=0.1702 mb_mean=0.4991 norm_overlap=0.9944 corr_cb=-0.3855
[EPOCH 009/089] train: loss=0.8196 acc=63.76% | val: loss=0.6863 acc=61.45% f1=63.64% auc=58.14% val_score=55.7082 val_score_bestthr=57.0512 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.170, mb=0.499, no=0.994, corr=-0.386) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 57.0512
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1399 mb_mean=0.5005 norm_overlap=0.9962 corr_cb=-0.2822 topkJ=0.0133
[TRAIN][ep=010] loss=0.7855 acc=63.36%
[TRAIN][ep=010] mask_avg: mc_mean=0.1693 mb_mean=0.4991 norm_overlap=0.9935 corr_cb=-0.4110
[EPOCH 010/089] train: loss=0.7855 acc=63.36% | val: loss=0.6861 acc=63.86% f1=65.91% auc=58.84% val_score=50.8338 val_score_bestthr=61.0074 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.169, mb=0.499, no=0.994, corr=-0.411) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 61.0074
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1384 mb_mean=0.5000 norm_overlap=0.9936 corr_cb=-0.4074 topkJ=0.0059
[TRAIN][ep=011] loss=0.7562 acc=64.97%
[TRAIN][ep=011] mask_avg: mc_mean=0.1617 mb_mean=0.4992 norm_overlap=0.9926 corr_cb=-0.4118
[EPOCH 011/089] train: loss=0.7562 acc=64.97% | val: loss=0.6925 acc=61.45% f1=64.44% auc=58.37% val_score=50.5952 val_score_bestthr=57.9526 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.162, mb=0.499, no=0.993, corr=-0.412) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 57.9526
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.2111 mb_mean=0.4969 norm_overlap=0.9959 corr_cb=-0.3110 topkJ=0.0126
[TRAIN][ep=012] loss=0.7529 acc=64.03%
[TRAIN][ep=012] mask_avg: mc_mean=0.1694 mb_mean=0.4991 norm_overlap=0.9922 corr_cb=-0.4077
[EPOCH 012/089] train: loss=0.7529 acc=64.03% | val: loss=0.6948 acc=62.65% f1=64.37% auc=58.43% val_score=55.9450 val_score_bestthr=57.6598 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.169, mb=0.499, no=0.992, corr=-0.408) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 57.6598
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1921 mb_mean=0.4960 norm_overlap=0.9928 corr_cb=-0.3925 topkJ=0.0028
[TRAIN][ep=013] loss=0.7403 acc=67.11%
[TRAIN][ep=013] mask_avg: mc_mean=0.1718 mb_mean=0.4991 norm_overlap=0.9918 corr_cb=-0.4064
[EPOCH 013/089] train: loss=0.7403 acc=67.11% | val: loss=0.7003 acc=61.45% f1=63.64% auc=57.91% val_score=55.1154 val_score_bestthr=57.0512 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.172, mb=0.499, no=0.992, corr=-0.406) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 57.0512
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1252 mb_mean=0.5003 norm_overlap=0.9916 corr_cb=-0.3433 topkJ=0.0059
[TRAIN][ep=014] loss=0.7354 acc=67.38%
[TRAIN][ep=014] mask_avg: mc_mean=0.1654 mb_mean=0.4991 norm_overlap=0.9910 corr_cb=-0.4122
[EPOCH 014/089] train: loss=0.7354 acc=67.38% | val: loss=0.7160 acc=59.04% f1=57.50% auc=59.53% val_score=43.3176 val_score_bestthr=57.5078 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.165, mb=0.499, no=0.991, corr=-0.412) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 57.5078
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.2103 mb_mean=0.4990 norm_overlap=0.9901 corr_cb=-0.5299 topkJ=0.0052
[TRAIN][ep=015] loss=0.7376 acc=65.10%
[TRAIN][ep=015] mask_avg: mc_mean=0.1740 mb_mean=0.4991 norm_overlap=0.9909 corr_cb=-0.4101
[EPOCH 015/089] train: loss=0.7376 acc=65.10% | val: loss=0.7123 acc=57.83% f1=67.29% auc=58.26% val_score=46.5120 val_score_bestthr=57.5872 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.174, mb=0.499, no=0.991, corr=-0.410) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 57.5872
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1287 mb_mean=0.5034 norm_overlap=0.9867 corr_cb=-0.4620 topkJ=0.0031
[TRAIN][ep=016] loss=0.7284 acc=65.37%
[TRAIN][ep=016] mask_avg: mc_mean=0.1782 mb_mean=0.4991 norm_overlap=0.9909 corr_cb=-0.4066
[EPOCH 016/089] train: loss=0.7284 acc=65.37% | val: loss=0.7028 acc=59.04% f1=68.52% auc=60.12% val_score=48.1555 val_score_bestthr=54.9295 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.178, mb=0.499, no=0.991, corr=-0.407) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 54.9295
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1939 mb_mean=0.4979 norm_overlap=0.9924 corr_cb=-0.3890 topkJ=0.0101
[TRAIN][ep=017] loss=0.7194 acc=68.99%
[TRAIN][ep=017] mask_avg: mc_mean=0.1798 mb_mean=0.4991 norm_overlap=0.9907 corr_cb=-0.4167
[EPOCH 017/089] train: loss=0.7194 acc=68.99% | val: loss=0.7208 acc=53.01% f1=68.80% auc=59.94% val_score=50.6610 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.180, mb=0.499, no=0.991, corr=-0.417) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 61.2320
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1899 mb_mean=0.5000 norm_overlap=0.9948 corr_cb=-0.2782 topkJ=0.0216
[TRAIN][ep=018] loss=0.7233 acc=68.19%
[TRAIN][ep=018] mask_avg: mc_mean=0.1907 mb_mean=0.4992 norm_overlap=0.9904 corr_cb=-0.4289
[EPOCH 018/089] train: loss=0.7233 acc=68.19% | val: loss=0.7272 acc=54.22% f1=69.35% auc=60.64% val_score=48.7317 val_score_bestthr=62.3371 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.191, mb=0.499, no=0.990, corr=-0.429) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 62.0453 -> 62.3371
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/ckpt_best_fold_4.pt
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.2407 mb_mean=0.4994 norm_overlap=0.9880 corr_cb=-0.5594 topkJ=0.0020
[TRAIN][ep=019] loss=0.8074 acc=66.98%
[TRAIN][ep=019] mask_avg: mc_mean=0.1848 mb_mean=0.4991 norm_overlap=0.9904 corr_cb=-0.4225
[EPOCH 019/089] train: loss=0.8074 acc=66.98% | val: loss=0.7071 acc=60.24% f1=69.16% auc=59.42% val_score=41.7189 val_score_bestthr=55.1029 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.185, mb=0.499, no=0.990, corr=-0.422) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 55.1029
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1548 mb_mean=0.4995 norm_overlap=0.9883 corr_cb=-0.4633 topkJ=0.0028
[TRAIN][ep=020] loss=0.8737 acc=69.93%
[TRAIN][ep=020] mask_avg: mc_mean=0.1737 mb_mean=0.4991 norm_overlap=0.9899 corr_cb=-0.4262
[EPOCH 020/089] train: loss=0.8737 acc=69.93% | val: loss=0.7410 acc=53.01% f1=68.80% auc=60.41% val_score=38.6501 val_score_bestthr=61.2320 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.174, mb=0.499, no=0.990, corr=-0.426) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 61.2320
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2378 mb_mean=0.4957 norm_overlap=0.9919 corr_cb=-0.4274 topkJ=0.0166
[TRAIN][ep=021] loss=0.9355 acc=71.01%
[TRAIN][ep=021] mask_avg: mc_mean=0.1837 mb_mean=0.4991 norm_overlap=0.9903 corr_cb=-0.4241
[EPOCH 021/089] train: loss=0.9355 acc=71.01% | val: loss=0.7403 acc=53.01% f1=68.80% auc=60.29% val_score=48.7317 val_score_bestthr=61.2320 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.184, mb=0.499, no=0.990, corr=-0.424) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 61.2320
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2158 mb_mean=0.4965 norm_overlap=0.9928 corr_cb=-0.3488 topkJ=0.0024
[TRAIN][ep=022] loss=1.0171 acc=68.46%
[TRAIN][ep=022] mask_avg: mc_mean=0.1747 mb_mean=0.4991 norm_overlap=0.9908 corr_cb=-0.3857
[EPOCH 022/089] train: loss=1.0171 acc=68.46% | val: loss=0.7248 acc=59.04% f1=67.92% auc=60.06% val_score=46.0541 val_score_bestthr=56.6206 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.175, mb=0.499, no=0.991, corr=-0.386) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 56.6206
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1818 mb_mean=0.4979 norm_overlap=0.9916 corr_cb=-0.4248 topkJ=0.0068
[TRAIN][ep=023] loss=1.0671 acc=71.95%
[TRAIN][ep=023] mask_avg: mc_mean=0.1936 mb_mean=0.4992 norm_overlap=0.9911 corr_cb=-0.4004
[EPOCH 023/089] train: loss=1.0671 acc=71.95% | val: loss=0.7427 acc=57.83% f1=67.29% auc=60.12% val_score=37.0992 val_score_bestthr=56.4480 | dyn(w_pfs=0.100, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.194, mb=0.499, no=0.991, corr=-0.400) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 56.4480
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1552 mb_mean=0.5023 norm_overlap=0.9896 corr_cb=-0.4575 topkJ=0.0043
[TRAIN][ep=024] loss=0.8759 acc=71.95%
[TRAIN][ep=024] mask_avg: mc_mean=0.1732 mb_mean=0.4991 norm_overlap=0.9908 corr_cb=-0.3835
[EPOCH 024/089] train: loss=0.8759 acc=71.95% | val: loss=0.7379 acc=53.01% f1=68.80% auc=60.70% val_score=39.0238 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.173, mb=0.499, no=0.991, corr=-0.383) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 61.2320
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1553 mb_mean=0.4994 norm_overlap=0.9878 corr_cb=-0.4581 topkJ=0.0238
[TRAIN][ep=025] loss=0.6780 acc=71.68%
[TRAIN][ep=025] mask_avg: mc_mean=0.1812 mb_mean=0.4991 norm_overlap=0.9915 corr_cb=-0.3635
[EPOCH 025/089] train: loss=0.6780 acc=71.68% | val: loss=0.7334 acc=53.01% f1=68.80% auc=61.05% val_score=43.9885 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.181, mb=0.499, no=0.992, corr=-0.363) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 61.2320
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2830 mb_mean=0.4956 norm_overlap=0.9926 corr_cb=-0.4039 topkJ=0.0044
[TRAIN][ep=026] loss=0.6555 acc=72.89%
[TRAIN][ep=026] mask_avg: mc_mean=0.1833 mb_mean=0.4991 norm_overlap=0.9917 corr_cb=-0.3601
[EPOCH 026/089] train: loss=0.6555 acc=72.89% | val: loss=0.7872 acc=53.01% f1=68.80% auc=60.17% val_score=43.7645 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.183, mb=0.499, no=0.992, corr=-0.360) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 61.2320
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.0691 mb_mean=0.5030 norm_overlap=0.9928 corr_cb=-0.2437 topkJ=0.0226
[TRAIN][ep=027] loss=0.6648 acc=72.75%
[TRAIN][ep=027] mask_avg: mc_mean=0.1624 mb_mean=0.4991 norm_overlap=0.9919 corr_cb=-0.3242
[EPOCH 027/089] train: loss=0.6648 acc=72.75% | val: loss=0.7624 acc=51.81% f1=68.25% auc=61.51% val_score=50.3966 val_score_bestthr=62.0453 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.162, mb=0.499, no=0.992, corr=-0.324) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 62.0453
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1631 mb_mean=0.4994 norm_overlap=0.9907 corr_cb=-0.3447 topkJ=0.0067
[TRAIN][ep=028] loss=0.6565 acc=72.21%
[TRAIN][ep=028] mask_avg: mc_mean=0.1649 mb_mean=0.4991 norm_overlap=0.9923 corr_cb=-0.3148
[EPOCH 028/089] train: loss=0.6565 acc=72.21% | val: loss=0.7533 acc=51.81% f1=68.25% auc=60.93% val_score=41.0743 val_score_bestthr=62.0453 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.165, mb=0.499, no=0.992, corr=-0.315) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 62.0453
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.1969 mb_mean=0.4979 norm_overlap=0.9918 corr_cb=-0.3890 topkJ=0.0066
[TRAIN][ep=029] loss=0.6412 acc=73.96%
[TRAIN][ep=029] mask_avg: mc_mean=0.1852 mb_mean=0.4991 norm_overlap=0.9930 corr_cb=-0.3084
[EPOCH 029/089] train: loss=0.6412 acc=73.96% | val: loss=0.8082 acc=53.01% f1=68.29% auc=61.34% val_score=41.6963 val_score_bestthr=56.7094 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.185, mb=0.499, no=0.993, corr=-0.308) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 56.7094
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2294 mb_mean=0.4970 norm_overlap=0.9945 corr_cb=-0.2830 topkJ=0.0200
[TRAIN][ep=030] loss=0.6524 acc=74.09%
[TRAIN][ep=030] mask_avg: mc_mean=0.1775 mb_mean=0.4992 norm_overlap=0.9926 corr_cb=-0.3217
[EPOCH 030/089] train: loss=0.6524 acc=74.09% | val: loss=0.7864 acc=56.63% f1=66.67% auc=61.05% val_score=41.7825 val_score_bestthr=54.7497 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.177, mb=0.499, no=0.993, corr=-0.322) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 54.7497
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2337 mb_mean=0.4980 norm_overlap=0.9932 corr_cb=-0.3486 topkJ=0.0093
[TRAIN][ep=031] loss=0.6387 acc=74.09%
[TRAIN][ep=031] mask_avg: mc_mean=0.1827 mb_mean=0.4991 norm_overlap=0.9927 corr_cb=-0.3225
[EPOCH 031/089] train: loss=0.6387 acc=74.09% | val: loss=0.7719 acc=59.04% f1=67.92% auc=61.16% val_score=47.0490 val_score_bestthr=56.6206 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.183, mb=0.499, no=0.993, corr=-0.323) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 56.6206
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1630 mb_mean=0.4981 norm_overlap=0.9949 corr_cb=-0.2535 topkJ=0.0297
[TRAIN][ep=032] loss=0.6349 acc=74.63%
[TRAIN][ep=032] mask_avg: mc_mean=0.1856 mb_mean=0.4991 norm_overlap=0.9932 corr_cb=-0.3074
[EPOCH 032/089] train: loss=0.6349 acc=74.63% | val: loss=0.7703 acc=59.04% f1=66.67% auc=61.92% val_score=46.5594 val_score_bestthr=54.6783 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.186, mb=0.499, no=0.993, corr=-0.307) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 54.6783
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2044 mb_mean=0.4969 norm_overlap=0.9927 corr_cb=-0.3495 topkJ=0.0126
[TRAIN][ep=033] loss=0.6163 acc=75.17%
[TRAIN][ep=033] mask_avg: mc_mean=0.1672 mb_mean=0.4991 norm_overlap=0.9935 corr_cb=-0.2745
[EPOCH 033/089] train: loss=0.6163 acc=75.17% | val: loss=0.7672 acc=57.83% f1=67.29% auc=62.33% val_score=47.3441 val_score_bestthr=55.1146 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.167, mb=0.499, no=0.994, corr=-0.274) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 55.1146
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2078 mb_mean=0.4955 norm_overlap=0.9954 corr_cb=-0.2145 topkJ=0.0269
[TRAIN][ep=034] loss=0.6116 acc=76.64%
[TRAIN][ep=034] mask_avg: mc_mean=0.1780 mb_mean=0.4991 norm_overlap=0.9936 corr_cb=-0.2806
[EPOCH 034/089] train: loss=0.6116 acc=76.64% | val: loss=0.7840 acc=53.01% f1=68.80% auc=62.62% val_score=46.5594 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.178, mb=0.499, no=0.994, corr=-0.281) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 61.2320
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.1614 mb_mean=0.4987 norm_overlap=0.9952 corr_cb=-0.2025 topkJ=0.0244
[TRAIN][ep=035] loss=0.6060 acc=75.97%
[TRAIN][ep=035] mask_avg: mc_mean=0.1893 mb_mean=0.4991 norm_overlap=0.9938 corr_cb=-0.2880
[EPOCH 035/089] train: loss=0.6060 acc=75.97% | val: loss=0.7833 acc=51.81% f1=68.25% auc=61.10% val_score=52.9260 val_score_bestthr=62.0453 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.189, mb=0.499, no=0.994, corr=-0.288) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 62.0453
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2170 mb_mean=0.4963 norm_overlap=0.9967 corr_cb=-0.1746 topkJ=0.0288
[TRAIN][ep=036] loss=0.6101 acc=76.24%
[TRAIN][ep=036] mask_avg: mc_mean=0.2010 mb_mean=0.4991 norm_overlap=0.9943 corr_cb=-0.2694
[EPOCH 036/089] train: loss=0.6101 acc=76.24% | val: loss=0.7838 acc=53.01% f1=68.80% auc=61.98% val_score=44.7395 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.201, mb=0.499, no=0.994, corr=-0.269) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 61.2320
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1469 mb_mean=0.4991 norm_overlap=0.9962 corr_cb=-0.1519 topkJ=0.0465
[TRAIN][ep=037] loss=0.5987 acc=76.91%
[TRAIN][ep=037] mask_avg: mc_mean=0.1913 mb_mean=0.4991 norm_overlap=0.9943 corr_cb=-0.2612
[EPOCH 037/089] train: loss=0.5987 acc=76.91% | val: loss=0.7824 acc=56.63% f1=67.27% auc=62.03% val_score=46.0729 val_score_bestthr=56.8023 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.191, mb=0.499, no=0.994, corr=-0.261) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 56.8023
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.1777 mb_mean=0.4984 norm_overlap=0.9946 corr_cb=-0.2516 topkJ=0.0091
[TRAIN][ep=038] loss=0.5848 acc=77.58%
[TRAIN][ep=038] mask_avg: mc_mean=0.2012 mb_mean=0.4991 norm_overlap=0.9941 corr_cb=-0.2779
[EPOCH 038/089] train: loss=0.5848 acc=77.58% | val: loss=0.7785 acc=56.63% f1=67.86% auc=61.69% val_score=54.5168 val_score_bestthr=55.8035 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.201, mb=0.499, no=0.994, corr=-0.278) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 55.8035
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2427 mb_mean=0.4963 norm_overlap=0.9980 corr_cb=-0.1261 topkJ=0.0433
[TRAIN][ep=039] loss=0.5804 acc=77.58%
[TRAIN][ep=039] mask_avg: mc_mean=0.2089 mb_mean=0.4991 norm_overlap=0.9942 corr_cb=-0.2769
[EPOCH 039/089] train: loss=0.5804 acc=77.58% | val: loss=0.7848 acc=65.06% f1=65.06% auc=62.09% val_score=46.2176 val_score_bestthr=57.3770 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.209, mb=0.499, no=0.994, corr=-0.277) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 57.3770
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.1957 mb_mean=0.4988 norm_overlap=0.9927 corr_cb=-0.3249 topkJ=0.0170
[TRAIN][ep=040] loss=0.5717 acc=80.27%
[TRAIN][ep=040] mask_avg: mc_mean=0.2111 mb_mean=0.4992 norm_overlap=0.9948 corr_cb=-0.2514
[EPOCH 040/089] train: loss=0.5717 acc=80.27% | val: loss=0.8214 acc=63.86% f1=64.29% auc=62.15% val_score=47.9401 val_score_bestthr=55.8501 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.211, mb=0.499, no=0.995, corr=-0.251) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 55.8501
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.1633 mb_mean=0.5002 norm_overlap=0.9963 corr_cb=-0.2018 topkJ=0.0293
[TRAIN][ep=041] loss=0.5628 acc=79.87%
[TRAIN][ep=041] mask_avg: mc_mean=0.2057 mb_mean=0.4991 norm_overlap=0.9948 corr_cb=-0.2382
[EPOCH 041/089] train: loss=0.5628 acc=79.87% | val: loss=0.8344 acc=61.45% f1=68.63% auc=62.73% val_score=43.6760 val_score_bestthr=56.5679 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.206, mb=0.499, no=0.995, corr=-0.238) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 56.5679
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.1287 mb_mean=0.4995 norm_overlap=0.9938 corr_cb=-0.2922 topkJ=0.0057
[TRAIN][ep=042] loss=0.5547 acc=79.06%
[TRAIN][ep=042] mask_avg: mc_mean=0.2089 mb_mean=0.4991 norm_overlap=0.9943 corr_cb=-0.2648
[EPOCH 042/089] train: loss=0.5547 acc=79.06% | val: loss=0.8517 acc=63.86% f1=64.29% auc=62.67% val_score=42.5229 val_score_bestthr=55.8501 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.209, mb=0.499, no=0.994, corr=-0.265) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 55.8501
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.1642 mb_mean=0.4981 norm_overlap=0.9960 corr_cb=-0.1643 topkJ=0.0302
[TRAIN][ep=043] loss=0.5452 acc=80.27%
[TRAIN][ep=043] mask_avg: mc_mean=0.1954 mb_mean=0.4991 norm_overlap=0.9942 corr_cb=-0.2583
[EPOCH 043/089] train: loss=0.5452 acc=80.27% | val: loss=0.8738 acc=62.65% f1=69.90% auc=62.62% val_score=45.8226 val_score_bestthr=55.7453 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.195, mb=0.499, no=0.994, corr=-0.258) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 55.7453
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2449 mb_mean=0.4991 norm_overlap=0.9946 corr_cb=-0.2660 topkJ=0.0189
[TRAIN][ep=044] loss=0.5510 acc=80.67%
[TRAIN][ep=044] mask_avg: mc_mean=0.2169 mb_mean=0.4991 norm_overlap=0.9946 corr_cb=-0.2537
[EPOCH 044/089] train: loss=0.5510 acc=80.67% | val: loss=0.8076 acc=55.42% f1=69.92% auc=62.50% val_score=54.3260 val_score_bestthr=63.8324 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.217, mb=0.499, no=0.995, corr=-0.254) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 62.3371 -> 63.8324
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/ckpt_best_fold_4.pt
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2119 mb_mean=0.4983 norm_overlap=0.9959 corr_cb=-0.2316 topkJ=0.0204
[TRAIN][ep=045] loss=0.6091 acc=80.40%
[TRAIN][ep=045] mask_avg: mc_mean=0.2128 mb_mean=0.4991 norm_overlap=0.9944 corr_cb=-0.2551
[EPOCH 045/089] train: loss=0.6091 acc=80.40% | val: loss=0.8123 acc=55.42% f1=69.92% auc=63.08% val_score=55.8501 val_score_bestthr=63.8324 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.213, mb=0.499, no=0.994, corr=-0.255) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 63.8324
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.1592 mb_mean=0.4995 norm_overlap=0.9939 corr_cb=-0.2247 topkJ=0.0184
[TRAIN][ep=046] loss=0.6793 acc=81.21%
[TRAIN][ep=046] mask_avg: mc_mean=0.2092 mb_mean=0.4991 norm_overlap=0.9944 corr_cb=-0.2540
[EPOCH 046/089] train: loss=0.6793 acc=81.21% | val: loss=0.8161 acc=55.42% f1=67.26% auc=62.73% val_score=47.9401 val_score_bestthr=55.8811 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.209, mb=0.499, no=0.994, corr=-0.254) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 55.8811
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.3095 mb_mean=0.4995 norm_overlap=0.9958 corr_cb=-0.2510 topkJ=0.0090
[TRAIN][ep=047] loss=0.7482 acc=81.61%
[TRAIN][ep=047] mask_avg: mc_mean=0.2140 mb_mean=0.4992 norm_overlap=0.9939 corr_cb=-0.2707
[EPOCH 047/089] train: loss=0.7482 acc=81.61% | val: loss=0.8431 acc=65.06% f1=66.67% auc=63.84% val_score=42.5229 val_score_bestthr=56.3303 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.214, mb=0.499, no=0.994, corr=-0.271) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.3303
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.1527 mb_mean=0.5025 norm_overlap=0.9934 corr_cb=-0.3002 topkJ=0.0083
[TRAIN][ep=048] loss=0.8175 acc=82.15%
[TRAIN][ep=048] mask_avg: mc_mean=0.2027 mb_mean=0.4991 norm_overlap=0.9940 corr_cb=-0.2615
[EPOCH 048/089] train: loss=0.8175 acc=82.15% | val: loss=0.8143 acc=61.45% f1=63.64% auc=62.91% val_score=53.8470 val_score_bestthr=56.0905 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.203, mb=0.499, no=0.994, corr=-0.261) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.0905
[DBG][ep=049] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.2472 mb_mean=0.4992 norm_overlap=0.9938 corr_cb=-0.2816 topkJ=0.0137
[TRAIN][ep=049] loss=0.8987 acc=81.88%
[TRAIN][ep=049] mask_avg: mc_mean=0.2271 mb_mean=0.4991 norm_overlap=0.9939 corr_cb=-0.2821
[EPOCH 049/089] train: loss=0.8987 acc=81.88% | val: loss=0.8196 acc=54.22% f1=67.80% auc=63.26% val_score=53.9542 val_score_bestthr=56.0066 | dyn(w_pfs=0.100, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.227, mb=0.499, no=0.994, corr=-0.282) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.0066
[DBG][ep=050] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.1815 mb_mean=0.5005 norm_overlap=0.9924 corr_cb=-0.3441 topkJ=0.0211
[TRAIN][ep=050] loss=0.5074 acc=85.23%
[TRAIN][ep=050] mask_avg: mc_mean=0.2025 mb_mean=0.4991 norm_overlap=0.9936 corr_cb=-0.2786
[EPOCH 050/089] train: loss=0.5074 acc=85.23% | val: loss=0.8285 acc=65.06% f1=65.06% auc=62.91% val_score=52.6715 val_score_bestthr=57.3770 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.202, mb=0.499, no=0.994, corr=-0.279) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 57.3770
[DBG][ep=051] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.2538 mb_mean=0.4959 norm_overlap=0.9953 corr_cb=-0.2214 topkJ=0.0203
[TRAIN][ep=051] loss=0.4858 acc=84.70%
[TRAIN][ep=051] mask_avg: mc_mean=0.2025 mb_mean=0.4991 norm_overlap=0.9937 corr_cb=-0.2761
[EPOCH 051/089] train: loss=0.4858 acc=84.70% | val: loss=0.8357 acc=65.06% f1=65.06% auc=62.85% val_score=55.8501 val_score_bestthr=57.3770 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.203, mb=0.499, no=0.994, corr=-0.276) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 57.3770
[DBG][ep=052] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.2109 mb_mean=0.4993 norm_overlap=0.9932 corr_cb=-0.3143 topkJ=0.0095
[TRAIN][ep=052] loss=0.4857 acc=83.76%
[TRAIN][ep=052] mask_avg: mc_mean=0.2025 mb_mean=0.4991 norm_overlap=0.9936 corr_cb=-0.2816
[EPOCH 052/089] train: loss=0.4857 acc=83.76% | val: loss=0.8509 acc=54.22% f1=67.80% auc=62.91% val_score=55.1804 val_score_bestthr=56.0066 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.202, mb=0.499, no=0.994, corr=-0.282) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.0066
[DBG][ep=053] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.2341 mb_mean=0.4968 norm_overlap=0.9946 corr_cb=-0.2382 topkJ=0.0176
[TRAIN][ep=053] loss=0.4820 acc=84.30%
[TRAIN][ep=053] mask_avg: mc_mean=0.2025 mb_mean=0.4991 norm_overlap=0.9937 corr_cb=-0.2770
[EPOCH 053/089] train: loss=0.4820 acc=84.30% | val: loss=0.8574 acc=54.22% f1=67.80% auc=63.26% val_score=55.1804 val_score_bestthr=56.0066 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.203, mb=0.499, no=0.994, corr=-0.277) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.0066
[DBG][ep=054] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=054] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=054] mask(step0): mc_mean=0.1585 mb_mean=0.5002 norm_overlap=0.9941 corr_cb=-0.2143 topkJ=0.0140
[TRAIN][ep=054] loss=0.4816 acc=84.70%
[TRAIN][ep=054] mask_avg: mc_mean=0.2025 mb_mean=0.4991 norm_overlap=0.9937 corr_cb=-0.2774
[EPOCH 054/089] train: loss=0.4816 acc=84.70% | val: loss=0.8602 acc=54.22% f1=67.80% auc=62.91% val_score=53.9542 val_score_bestthr=56.0066 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.202, mb=0.499, no=0.994, corr=-0.277) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.0066
[DBG][ep=055] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=055] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=055] mask(step0): mc_mean=0.1750 mb_mean=0.5003 norm_overlap=0.9965 corr_cb=-0.1753 topkJ=0.0301
[TRAIN][ep=055] loss=0.4775 acc=84.43%
[TRAIN][ep=055] mask_avg: mc_mean=0.2025 mb_mean=0.4991 norm_overlap=0.9936 corr_cb=-0.2800
[EPOCH 055/089] train: loss=0.4775 acc=84.43% | val: loss=0.8807 acc=54.22% f1=67.80% auc=63.14% val_score=52.0121 val_score_bestthr=56.0066 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.202, mb=0.499, no=0.994, corr=-0.280) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.0066
[DBG][ep=056] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=056] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=056] mask(step0): mc_mean=0.1822 mb_mean=0.5005 norm_overlap=0.9948 corr_cb=-0.2434 topkJ=0.0145
[TRAIN][ep=056] loss=0.4767 acc=84.70%
[TRAIN][ep=056] mask_avg: mc_mean=0.2025 mb_mean=0.4991 norm_overlap=0.9936 corr_cb=-0.2772
[EPOCH 056/089] train: loss=0.4767 acc=84.70% | val: loss=0.8674 acc=54.22% f1=67.80% auc=62.62% val_score=53.9542 val_score_bestthr=56.0066 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.202, mb=0.499, no=0.994, corr=-0.277) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.0066
[DBG][ep=057] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=057] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=057] mask(step0): mc_mean=0.2063 mb_mean=0.4965 norm_overlap=0.9935 corr_cb=-0.3319 topkJ=0.0060
[TRAIN][ep=057] loss=0.4780 acc=84.16%
[TRAIN][ep=057] mask_avg: mc_mean=0.2025 mb_mean=0.4992 norm_overlap=0.9936 corr_cb=-0.2771
[EPOCH 057/089] train: loss=0.4780 acc=84.16% | val: loss=0.8834 acc=54.22% f1=67.80% auc=63.26% val_score=51.9429 val_score_bestthr=56.0066 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.202, mb=0.499, no=0.994, corr=-0.277) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.0066
[DBG][ep=058] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=058] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=058] mask(step0): mc_mean=0.2012 mb_mean=0.4978 norm_overlap=0.9974 corr_cb=-0.1267 topkJ=0.0283
[TRAIN][ep=058] loss=0.4743 acc=84.83%
[TRAIN][ep=058] mask_avg: mc_mean=0.2024 mb_mean=0.4991 norm_overlap=0.9936 corr_cb=-0.2772
[EPOCH 058/089] train: loss=0.4743 acc=84.83% | val: loss=0.8892 acc=54.22% f1=67.80% auc=62.97% val_score=51.9429 val_score_bestthr=56.0066 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.202, mb=0.499, no=0.994, corr=-0.277) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.0066
[DBG][ep=059] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=059] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=059] mask(step0): mc_mean=0.2034 mb_mean=0.4995 norm_overlap=0.9947 corr_cb=-0.2946 topkJ=0.0184
[TRAIN][ep=059] loss=0.4722 acc=84.97%
[TRAIN][ep=059] mask_avg: mc_mean=0.2024 mb_mean=0.4991 norm_overlap=0.9936 corr_cb=-0.2784
[EPOCH 059/089] train: loss=0.4722 acc=84.97% | val: loss=0.8852 acc=54.22% f1=67.80% auc=62.91% val_score=55.6273 val_score_bestthr=56.0066 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.202, mb=0.499, no=0.994, corr=-0.278) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.0066
[DBG][ep=060] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=060] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=060] mask(step0): mc_mean=0.1831 mb_mean=0.4997 norm_overlap=0.9963 corr_cb=-0.2356 topkJ=0.0259
[TRAIN][ep=060] loss=0.4691 acc=86.04%
[TRAIN][ep=060] mask_avg: mc_mean=0.2025 mb_mean=0.4991 norm_overlap=0.9937 corr_cb=-0.2752
[EPOCH 060/089] train: loss=0.4691 acc=86.04% | val: loss=0.8926 acc=60.24% f1=69.16% auc=63.02% val_score=51.9429 val_score_bestthr=55.7768 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.202, mb=0.499, no=0.994, corr=-0.275) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 55.7768
[DBG][ep=061] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=061] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=061] mask(step0): mc_mean=0.2068 mb_mean=0.4977 norm_overlap=0.9930 corr_cb=-0.3228 topkJ=0.0113
[TRAIN][ep=061] loss=0.4719 acc=84.70%
[TRAIN][ep=061] mask_avg: mc_mean=0.2023 mb_mean=0.4991 norm_overlap=0.9936 corr_cb=-0.2787
[EPOCH 061/089] train: loss=0.4719 acc=84.70% | val: loss=0.8960 acc=66.27% f1=64.10% auc=63.02% val_score=56.5322 val_score_bestthr=56.5322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.202, mb=0.499, no=0.994, corr=-0.279) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.5322
[DBG][ep=062] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=062] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=062] mask(step0): mc_mean=0.2300 mb_mean=0.4994 norm_overlap=0.9936 corr_cb=-0.2752 topkJ=0.0104
[TRAIN][ep=062] loss=0.4712 acc=84.70%
[TRAIN][ep=062] mask_avg: mc_mean=0.2025 mb_mean=0.4991 norm_overlap=0.9937 corr_cb=-0.2769
[EPOCH 062/089] train: loss=0.4712 acc=84.70% | val: loss=0.8941 acc=66.27% f1=64.10% auc=62.73% val_score=55.4116 val_score_bestthr=56.5322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.202, mb=0.499, no=0.994, corr=-0.277) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.5322
[DBG][ep=063] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=063] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=063] mask(step0): mc_mean=0.2298 mb_mean=0.4970 norm_overlap=0.9968 corr_cb=-0.1852 topkJ=0.0371
[TRAIN][ep=063] loss=0.4685 acc=85.23%
[TRAIN][ep=063] mask_avg: mc_mean=0.2024 mb_mean=0.4992 norm_overlap=0.9936 corr_cb=-0.2775
[EPOCH 063/089] train: loss=0.4685 acc=85.23% | val: loss=0.9006 acc=54.22% f1=67.80% auc=63.02% val_score=55.4116 val_score_bestthr=56.0066 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.202, mb=0.499, no=0.994, corr=-0.278) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.0066
[DBG][ep=064] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=064] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=064] mask(step0): mc_mean=0.2329 mb_mean=0.4982 norm_overlap=0.9903 corr_cb=-0.4556 topkJ=0.0040
[TRAIN][ep=064] loss=0.4676 acc=85.10%
[TRAIN][ep=064] mask_avg: mc_mean=0.2025 mb_mean=0.4991 norm_overlap=0.9937 corr_cb=-0.2778
[EPOCH 064/089] train: loss=0.4676 acc=85.10% | val: loss=0.9172 acc=54.22% f1=67.80% auc=62.85% val_score=52.2254 val_score_bestthr=56.0066 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.202, mb=0.499, no=0.994, corr=-0.278) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.0066
[DBG][ep=065] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=065] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=065] mask(step0): mc_mean=0.2069 mb_mean=0.4994 norm_overlap=0.9921 corr_cb=-0.3295 topkJ=0.0160
[TRAIN][ep=065] loss=0.4655 acc=84.56%
[TRAIN][ep=065] mask_avg: mc_mean=0.2024 mb_mean=0.4991 norm_overlap=0.9936 corr_cb=-0.2779
[EPOCH 065/089] train: loss=0.4655 acc=84.56% | val: loss=0.9255 acc=60.24% f1=67.96% auc=62.73% val_score=52.0121 val_score_bestthr=55.9533 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.202, mb=0.499, no=0.994, corr=-0.278) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 55.9533
[DBG][ep=066] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=066] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=066] mask(step0): mc_mean=0.1911 mb_mean=0.5017 norm_overlap=0.9898 corr_cb=-0.4201 topkJ=0.0087
[TRAIN][ep=066] loss=0.4660 acc=84.70%
[TRAIN][ep=066] mask_avg: mc_mean=0.2024 mb_mean=0.4991 norm_overlap=0.9936 corr_cb=-0.2784
[EPOCH 066/089] train: loss=0.4660 acc=84.70% | val: loss=0.8979 acc=54.22% f1=67.80% auc=62.62% val_score=54.2415 val_score_bestthr=56.0066 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.202, mb=0.499, no=0.994, corr=-0.278) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.0066
[DBG][ep=067] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=067] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=067] mask(step0): mc_mean=0.2044 mb_mean=0.4992 norm_overlap=0.9949 corr_cb=-0.2650 topkJ=0.0119
[TRAIN][ep=067] loss=0.4642 acc=84.70%
[TRAIN][ep=067] mask_avg: mc_mean=0.2025 mb_mean=0.4991 norm_overlap=0.9936 corr_cb=-0.2799
[EPOCH 067/089] train: loss=0.4642 acc=84.70% | val: loss=0.8989 acc=54.22% f1=67.80% auc=62.38% val_score=54.5126 val_score_bestthr=56.0066 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.202, mb=0.499, no=0.994, corr=-0.280) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.0066
[DBG][ep=068] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=068] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=068] mask(step0): mc_mean=0.2470 mb_mean=0.4973 norm_overlap=0.9947 corr_cb=-0.2520 topkJ=0.0105
[TRAIN][ep=068] loss=0.4590 acc=85.64%
[TRAIN][ep=068] mask_avg: mc_mean=0.2025 mb_mean=0.4991 norm_overlap=0.9936 corr_cb=-0.2788
[EPOCH 068/089] train: loss=0.4590 acc=85.64% | val: loss=0.9018 acc=54.22% f1=67.80% auc=62.62% val_score=55.6273 val_score_bestthr=56.0066 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.202, mb=0.499, no=0.994, corr=-0.279) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.0066
[DBG][ep=069] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=069] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=069] mask(step0): mc_mean=0.2018 mb_mean=0.4983 norm_overlap=0.9926 corr_cb=-0.2784 topkJ=0.0043
[TRAIN][ep=069] loss=0.4573 acc=85.91%
[TRAIN][ep=069] mask_avg: mc_mean=0.2024 mb_mean=0.4991 norm_overlap=0.9936 corr_cb=-0.2788
[EPOCH 069/089] train: loss=0.4573 acc=85.91% | val: loss=0.9069 acc=61.45% f1=61.90% auc=62.44% val_score=55.6273 val_score_bestthr=57.1184 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.202, mb=0.499, no=0.994, corr=-0.279) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 57.1184
[DBG][ep=070] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=070] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=070] mask(step0): mc_mean=0.2003 mb_mean=0.4984 norm_overlap=0.9971 corr_cb=-0.1436 topkJ=0.0154
[TRAIN][ep=070] loss=0.4583 acc=85.50%
[TRAIN][ep=070] mask_avg: mc_mean=0.2025 mb_mean=0.4991 norm_overlap=0.9936 corr_cb=-0.2792
[EPOCH 070/089] train: loss=0.4583 acc=85.50% | val: loss=0.9108 acc=54.22% f1=67.80% auc=62.50% val_score=55.6273 val_score_bestthr=56.0066 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.203, mb=0.499, no=0.994, corr=-0.279) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.0066
[DBG][ep=071] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=071] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=071] mask(step0): mc_mean=0.2085 mb_mean=0.4984 norm_overlap=0.9951 corr_cb=-0.2229 topkJ=0.0088
[TRAIN][ep=071] loss=0.4614 acc=84.97%
[TRAIN][ep=071] mask_avg: mc_mean=0.2025 mb_mean=0.4991 norm_overlap=0.9936 corr_cb=-0.2777
[EPOCH 071/089] train: loss=0.4614 acc=84.97% | val: loss=0.9154 acc=61.45% f1=61.90% auc=62.67% val_score=55.6273 val_score_bestthr=57.1184 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.202, mb=0.499, no=0.994, corr=-0.278) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 57.1184
[DBG][ep=072] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=072] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=072] mask(step0): mc_mean=0.2308 mb_mean=0.4976 norm_overlap=0.9919 corr_cb=-0.3352 topkJ=0.0074
[TRAIN][ep=072] loss=0.4567 acc=85.37%
[TRAIN][ep=072] mask_avg: mc_mean=0.2024 mb_mean=0.4991 norm_overlap=0.9937 corr_cb=-0.2764
[EPOCH 072/089] train: loss=0.4567 acc=85.37% | val: loss=0.9107 acc=55.42% f1=68.38% auc=62.62% val_score=53.1034 val_score_bestthr=56.2140 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.202, mb=0.499, no=0.994, corr=-0.276) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.2140
[DBG][ep=073] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=073] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=073] mask(step0): mc_mean=0.1785 mb_mean=0.5004 norm_overlap=0.9938 corr_cb=-0.3102 topkJ=0.0079
[TRAIN][ep=073] loss=0.4609 acc=84.97%
[TRAIN][ep=073] mask_avg: mc_mean=0.2025 mb_mean=0.4991 norm_overlap=0.9936 corr_cb=-0.2792
[EPOCH 073/089] train: loss=0.4609 acc=84.97% | val: loss=0.9150 acc=61.45% f1=61.90% auc=62.44% val_score=55.6273 val_score_bestthr=57.1184 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.202, mb=0.499, no=0.994, corr=-0.279) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 57.1184
[DBG][ep=074] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=074] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=074] mask(step0): mc_mean=0.2289 mb_mean=0.4964 norm_overlap=0.9910 corr_cb=-0.3638 topkJ=0.0093
[TRAIN][ep=074] loss=0.4578 acc=85.23%
[TRAIN][ep=074] mask_avg: mc_mean=0.2025 mb_mean=0.4991 norm_overlap=0.9936 corr_cb=-0.2782
[EPOCH 074/089] train: loss=0.4578 acc=85.23% | val: loss=0.9178 acc=61.45% f1=61.90% auc=62.33% val_score=55.6273 val_score_bestthr=57.1184 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.203, mb=0.499, no=0.994, corr=-0.278) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 57.1184
[EARLY STOP] no improvement for 30 epochs. best_epoch=44
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/ckpt_best_fold_4.pt
=============== FIT DONE ===============
[BEST] epoch=44 | val_acc=55.42% | val_f1=69.92% | val_auc=62.50% | val_score=54.3260 | val_score_bestthr=63.8324
[TEST@BEST] thr_used=0.385 | acc=72.46% f1=77.65% auc=75.85% | SP_sex=11.96% EO_sex=7.69% SP_age=25.15% EO_age=21.05%
[TIME] 1.76 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/summary_fold_4.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4721 mb_mean=0.5002 norm_overlap=0.9999 corr_cb=-0.1647 topkJ=0.0157
[TRAIN][ep=000] loss=0.6977 acc=48.59%
[TRAIN][ep=000] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1975
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4770 mb_mean=0.4998 norm_overlap=0.9998 corr_cb=-0.3436 topkJ=0.0036
[TRAIN][ep=001] loss=0.6950 acc=49.53%
[TRAIN][ep=001] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1999
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4738 mb_mean=0.5016 norm_overlap=0.9996 corr_cb=-0.4790 topkJ=0.0004
[TRAIN][ep=002] loss=0.6930 acc=51.28%
[TRAIN][ep=002] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2027
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4776 mb_mean=0.5006 norm_overlap=0.9998 corr_cb=-0.3552 topkJ=0.0111
[TRAIN][ep=003] loss=0.6925 acc=52.75%
[TRAIN][ep=003] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2020
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4748 mb_mean=0.5000 norm_overlap=0.9999 corr_cb=-0.1629 topkJ=0.0285
[TRAIN][ep=004] loss=0.6906 acc=53.02%
[TRAIN][ep=004] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2047
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4745 mb_mean=0.4997 norm_overlap=0.9999 corr_cb=-0.1323 topkJ=0.0316
[TRAIN][ep=005] loss=0.6891 acc=54.90%
[TRAIN][ep=005] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1977
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4771 mb_mean=0.4972 norm_overlap=0.9998 corr_cb=-0.2743 topkJ=0.0103
[TRAIN][ep=006] loss=0.6856 acc=58.12%
[TRAIN][ep=006] mask_avg: mc_mean=0.4756 mb_mean=0.4992 norm_overlap=0.9999 corr_cb=-0.1986
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4738 mb_mean=0.4973 norm_overlap=0.9999 corr_cb=-0.1266 topkJ=0.0306
[TRAIN][ep=007] loss=0.6873 acc=57.05%
[TRAIN][ep=007] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2027
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4717 mb_mean=0.5007 norm_overlap=0.9998 corr_cb=-0.2901 topkJ=0.0142
[TRAIN][ep=008] loss=0.6822 acc=57.99%
[TRAIN][ep=008] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1953
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4772 mb_mean=0.5007 norm_overlap=0.9999 corr_cb=-0.2881 topkJ=0.0134
[TRAIN][ep=009] loss=0.6789 acc=58.39%
[TRAIN][ep=009] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1962
================= FIT START (fold=4) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4762 mb_mean=0.4988 norm_overlap=0.9999 corr_cb=-0.2022 topkJ=0.0282
[TRAIN][ep=000] loss=0.6748 acc=58.52%
[TRAIN][ep=000] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1983
[EPOCH 000/089] train: loss=0.6748 acc=58.52% | val: loss=0.6925 acc=54.22% f1=66.07% auc=54.71% val_score=42.1744 val_score_bestthr=54.9344 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.198) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 54.9344
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/ckpt_best_fold_4.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4752 mb_mean=0.4988 norm_overlap=0.9999 corr_cb=-0.2582 topkJ=0.0120
[TRAIN][ep=001] loss=0.6685 acc=60.67%
[TRAIN][ep=001] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2040
[EPOCH 001/089] train: loss=0.6685 acc=60.67% | val: loss=0.6889 acc=60.24% f1=61.18% auc=56.63% val_score=55.5611 val_score_bestthr=55.5611 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.204) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 54.9344 -> 55.5611
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/ckpt_best_fold_4.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4765 mb_mean=0.4979 norm_overlap=0.9999 corr_cb=-0.1296 topkJ=0.0093
[TRAIN][ep=002] loss=0.6655 acc=62.42%
[TRAIN][ep=002] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1937
[EPOCH 002/089] train: loss=0.6655 acc=62.42% | val: loss=0.6905 acc=51.81% f1=68.25% auc=56.69% val_score=39.2574 val_score_bestthr=62.0453 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.194) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 55.5611 -> 62.0453
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/ckpt_best_fold_4.pt
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4731 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2435 topkJ=0.0106
[TRAIN][ep=003] loss=0.6647 acc=60.40%
[TRAIN][ep=003] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2014
[EPOCH 003/089] train: loss=0.6647 acc=60.40% | val: loss=0.6858 acc=63.86% f1=61.54% auc=58.31% val_score=44.9148 val_score_bestthr=55.7466 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.201) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 55.7466
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4765 mb_mean=0.4969 norm_overlap=0.9999 corr_cb=-0.2336 topkJ=0.0250
[TRAIN][ep=004] loss=0.6589 acc=61.07%
[TRAIN][ep=004] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2016
[EPOCH 004/089] train: loss=0.6589 acc=61.07% | val: loss=0.6870 acc=60.24% f1=62.07% auc=57.85% val_score=51.3174 val_score_bestthr=53.8915 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.202) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 53.8915
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4758 mb_mean=0.4977 norm_overlap=0.9998 corr_cb=-0.3229 topkJ=0.0168
[TRAIN][ep=005] loss=1.2971 acc=61.34%
[TRAIN][ep=005] mask_avg: mc_mean=0.3384 mb_mean=0.4991 norm_overlap=0.9988 corr_cb=-0.2822
[EPOCH 005/089] train: loss=1.2971 acc=61.34% | val: loss=0.7041 acc=56.63% f1=67.27% auc=54.83% val_score=39.6203 val_score_bestthr=58.1693 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.338, mb=0.499, no=0.999, corr=-0.282) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 58.1693
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2252 mb_mean=0.5012 norm_overlap=0.9976 corr_cb=-0.3353 topkJ=0.0058
[TRAIN][ep=006] loss=1.2872 acc=61.88%
[TRAIN][ep=006] mask_avg: mc_mean=0.2148 mb_mean=0.4991 norm_overlap=0.9972 corr_cb=-0.2952
[EPOCH 006/089] train: loss=1.2872 acc=61.88% | val: loss=0.6860 acc=59.04% f1=63.04% auc=57.27% val_score=50.2475 val_score_bestthr=54.6053 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.215, mb=0.499, no=0.997, corr=-0.295) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 54.6053
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.1696 mb_mean=0.5002 norm_overlap=0.9949 corr_cb=-0.3986 topkJ=0.0056
[TRAIN][ep=007] loss=1.2822 acc=63.89%
[TRAIN][ep=007] mask_avg: mc_mean=0.1847 mb_mean=0.4991 norm_overlap=0.9962 corr_cb=-0.3239
[EPOCH 007/089] train: loss=1.2822 acc=63.89% | val: loss=0.6860 acc=59.04% f1=62.22% auc=57.50% val_score=50.2475 val_score_bestthr=53.7020 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.185, mb=0.499, no=0.996, corr=-0.324) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 53.7020
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2041 mb_mean=0.4990 norm_overlap=0.9956 corr_cb=-0.3806 topkJ=0.0106
[TRAIN][ep=008] loss=1.0798 acc=63.89%
[TRAIN][ep=008] mask_avg: mc_mean=0.1684 mb_mean=0.4991 norm_overlap=0.9951 corr_cb=-0.3541
[EPOCH 008/089] train: loss=1.0798 acc=63.89% | val: loss=0.6975 acc=59.04% f1=56.41% auc=58.26% val_score=49.9497 val_score_bestthr=54.0879 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.168, mb=0.499, no=0.995, corr=-0.354) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 54.0879
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1497 mb_mean=0.4992 norm_overlap=0.9939 corr_cb=-0.4196 topkJ=0.0082
[TRAIN][ep=009] loss=0.8740 acc=63.76%
[TRAIN][ep=009] mask_avg: mc_mean=0.1699 mb_mean=0.4991 norm_overlap=0.9943 corr_cb=-0.3868
[EPOCH 009/089] train: loss=0.8740 acc=63.76% | val: loss=0.6866 acc=61.45% f1=64.44% auc=58.14% val_score=57.9526 val_score_bestthr=57.9526 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.170, mb=0.499, no=0.994, corr=-0.387) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 57.9526
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1391 mb_mean=0.5005 norm_overlap=0.9962 corr_cb=-0.2830 topkJ=0.0133
[TRAIN][ep=010] loss=0.8405 acc=63.36%
[TRAIN][ep=010] mask_avg: mc_mean=0.1691 mb_mean=0.4991 norm_overlap=0.9935 corr_cb=-0.4131
[EPOCH 010/089] train: loss=0.8405 acc=63.36% | val: loss=0.6860 acc=63.86% f1=65.91% auc=58.78% val_score=50.8338 val_score_bestthr=61.0074 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.169, mb=0.499, no=0.993, corr=-0.413) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 61.0074
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1386 mb_mean=0.5000 norm_overlap=0.9935 corr_cb=-0.4100 topkJ=0.0055
[TRAIN][ep=011] loss=0.8109 acc=64.97%
[TRAIN][ep=011] mask_avg: mc_mean=0.1617 mb_mean=0.4992 norm_overlap=0.9926 corr_cb=-0.4139
[EPOCH 011/089] train: loss=0.8109 acc=64.97% | val: loss=0.6925 acc=61.45% f1=64.44% auc=58.60% val_score=50.5952 val_score_bestthr=57.9526 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.162, mb=0.499, no=0.993, corr=-0.414) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 57.9526
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.2116 mb_mean=0.4969 norm_overlap=0.9958 corr_cb=-0.3148 topkJ=0.0122
[TRAIN][ep=012] loss=0.8076 acc=64.03%
[TRAIN][ep=012] mask_avg: mc_mean=0.1698 mb_mean=0.4991 norm_overlap=0.9922 corr_cb=-0.4112
[EPOCH 012/089] train: loss=0.8076 acc=64.03% | val: loss=0.6945 acc=62.65% f1=64.37% auc=58.49% val_score=55.9450 val_score_bestthr=57.6598 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.170, mb=0.499, no=0.992, corr=-0.411) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 57.6598
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1927 mb_mean=0.4960 norm_overlap=0.9927 corr_cb=-0.3967 topkJ=0.0028
[TRAIN][ep=013] loss=0.7949 acc=66.98%
[TRAIN][ep=013] mask_avg: mc_mean=0.1716 mb_mean=0.4991 norm_overlap=0.9917 corr_cb=-0.4097
[EPOCH 013/089] train: loss=0.7949 acc=66.98% | val: loss=0.7001 acc=61.45% f1=63.64% auc=58.08% val_score=55.1154 val_score_bestthr=57.0512 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.172, mb=0.499, no=0.992, corr=-0.410) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 57.0512
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1255 mb_mean=0.5003 norm_overlap=0.9916 corr_cb=-0.3472 topkJ=0.0059
[TRAIN][ep=014] loss=0.7900 acc=67.38%
[TRAIN][ep=014] mask_avg: mc_mean=0.1655 mb_mean=0.4991 norm_overlap=0.9909 corr_cb=-0.4157
[EPOCH 014/089] train: loss=0.7900 acc=67.38% | val: loss=0.7160 acc=59.04% f1=57.50% auc=59.65% val_score=49.0716 val_score_bestthr=57.5078 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.165, mb=0.499, no=0.991, corr=-0.416) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 57.5078
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.2099 mb_mean=0.4990 norm_overlap=0.9901 corr_cb=-0.5335 topkJ=0.0048
[TRAIN][ep=015] loss=0.7920 acc=65.10%
[TRAIN][ep=015] mask_avg: mc_mean=0.1738 mb_mean=0.4991 norm_overlap=0.9908 corr_cb=-0.4136
[EPOCH 015/089] train: loss=0.7920 acc=65.10% | val: loss=0.7119 acc=56.63% f1=66.67% auc=58.26% val_score=46.5120 val_score_bestthr=57.6458 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.174, mb=0.499, no=0.991, corr=-0.414) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 57.6458
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1282 mb_mean=0.5034 norm_overlap=0.9866 corr_cb=-0.4649 topkJ=0.0031
[TRAIN][ep=016] loss=0.7830 acc=65.37%
[TRAIN][ep=016] mask_avg: mc_mean=0.1783 mb_mean=0.4991 norm_overlap=0.9908 corr_cb=-0.4102
[EPOCH 016/089] train: loss=0.7830 acc=65.37% | val: loss=0.7026 acc=59.04% f1=68.52% auc=60.23% val_score=48.1555 val_score_bestthr=54.9295 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.178, mb=0.499, no=0.991, corr=-0.410) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 54.9295
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1937 mb_mean=0.4979 norm_overlap=0.9923 corr_cb=-0.3934 topkJ=0.0097
[TRAIN][ep=017] loss=0.7739 acc=69.26%
[TRAIN][ep=017] mask_avg: mc_mean=0.1801 mb_mean=0.4991 norm_overlap=0.9906 corr_cb=-0.4207
[EPOCH 017/089] train: loss=0.7739 acc=69.26% | val: loss=0.7206 acc=53.01% f1=68.80% auc=59.94% val_score=52.2410 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.180, mb=0.499, no=0.991, corr=-0.421) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 61.2320
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1889 mb_mean=0.5000 norm_overlap=0.9947 corr_cb=-0.2818 topkJ=0.0204
[TRAIN][ep=018] loss=0.7777 acc=68.19%
[TRAIN][ep=018] mask_avg: mc_mean=0.1905 mb_mean=0.4992 norm_overlap=0.9903 corr_cb=-0.4322
[EPOCH 018/089] train: loss=0.7777 acc=68.19% | val: loss=0.7273 acc=54.22% f1=69.35% auc=60.64% val_score=48.7317 val_score_bestthr=62.3371 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.190, mb=0.499, no=0.990, corr=-0.432) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 62.0453 -> 62.3371
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/ckpt_best_fold_4.pt
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.2407 mb_mean=0.4994 norm_overlap=0.9879 corr_cb=-0.5614 topkJ=0.0020
[TRAIN][ep=019] loss=0.8618 acc=66.98%
[TRAIN][ep=019] mask_avg: mc_mean=0.1838 mb_mean=0.4991 norm_overlap=0.9903 corr_cb=-0.4253
[EPOCH 019/089] train: loss=0.8618 acc=66.98% | val: loss=0.7070 acc=60.24% f1=69.16% auc=59.48% val_score=41.7189 val_score_bestthr=55.1029 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.184, mb=0.499, no=0.990, corr=-0.425) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 55.1029
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1536 mb_mean=0.4995 norm_overlap=0.9882 corr_cb=-0.4648 topkJ=0.0028
[TRAIN][ep=020] loss=0.9279 acc=70.07%
[TRAIN][ep=020] mask_avg: mc_mean=0.1738 mb_mean=0.4991 norm_overlap=0.9898 corr_cb=-0.4294
[EPOCH 020/089] train: loss=0.9279 acc=70.07% | val: loss=0.7422 acc=53.01% f1=68.80% auc=60.35% val_score=40.2126 val_score_bestthr=61.2320 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.174, mb=0.499, no=0.990, corr=-0.429) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 61.2320
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2357 mb_mean=0.4957 norm_overlap=0.9919 corr_cb=-0.4286 topkJ=0.0166
[TRAIN][ep=021] loss=0.9899 acc=71.28%
[TRAIN][ep=021] mask_avg: mc_mean=0.1836 mb_mean=0.4991 norm_overlap=0.9902 corr_cb=-0.4276
[EPOCH 021/089] train: loss=0.9899 acc=71.28% | val: loss=0.7403 acc=53.01% f1=68.80% auc=60.41% val_score=48.7317 val_score_bestthr=61.2320 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.184, mb=0.499, no=0.990, corr=-0.428) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 61.2320
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2160 mb_mean=0.4965 norm_overlap=0.9927 corr_cb=-0.3535 topkJ=0.0024
[TRAIN][ep=022] loss=1.0713 acc=68.32%
[TRAIN][ep=022] mask_avg: mc_mean=0.1740 mb_mean=0.4991 norm_overlap=0.9907 corr_cb=-0.3894
[EPOCH 022/089] train: loss=1.0713 acc=68.32% | val: loss=0.7248 acc=59.04% f1=67.92% auc=60.06% val_score=46.0541 val_score_bestthr=56.6206 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.174, mb=0.499, no=0.991, corr=-0.389) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 56.6206
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1798 mb_mean=0.4979 norm_overlap=0.9915 corr_cb=-0.4264 topkJ=0.0068
[TRAIN][ep=023] loss=1.1211 acc=71.95%
[TRAIN][ep=023] mask_avg: mc_mean=0.1932 mb_mean=0.4992 norm_overlap=0.9910 corr_cb=-0.4034
[EPOCH 023/089] train: loss=1.1211 acc=71.95% | val: loss=0.7427 acc=57.83% f1=67.29% auc=60.06% val_score=37.0992 val_score_bestthr=56.4480 | dyn(w_pfs=0.100, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.193, mb=0.499, no=0.991, corr=-0.403) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 56.4480
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1560 mb_mean=0.5023 norm_overlap=0.9896 corr_cb=-0.4592 topkJ=0.0039
[TRAIN][ep=024] loss=0.9302 acc=71.95%
[TRAIN][ep=024] mask_avg: mc_mean=0.1732 mb_mean=0.4991 norm_overlap=0.9908 corr_cb=-0.3868
[EPOCH 024/089] train: loss=0.9302 acc=71.95% | val: loss=0.7380 acc=53.01% f1=68.80% auc=60.64% val_score=39.0238 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.173, mb=0.499, no=0.991, corr=-0.387) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 61.2320
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1557 mb_mean=0.4994 norm_overlap=0.9877 corr_cb=-0.4633 topkJ=0.0226
[TRAIN][ep=025] loss=0.7320 acc=71.54%
[TRAIN][ep=025] mask_avg: mc_mean=0.1807 mb_mean=0.4991 norm_overlap=0.9915 corr_cb=-0.3663
[EPOCH 025/089] train: loss=0.7320 acc=71.54% | val: loss=0.7335 acc=53.01% f1=68.80% auc=60.93% val_score=43.9885 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.181, mb=0.499, no=0.991, corr=-0.366) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 61.2320
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2826 mb_mean=0.4956 norm_overlap=0.9926 corr_cb=-0.4061 topkJ=0.0044
[TRAIN][ep=026] loss=0.7096 acc=73.02%
[TRAIN][ep=026] mask_avg: mc_mean=0.1832 mb_mean=0.4991 norm_overlap=0.9916 corr_cb=-0.3626
[EPOCH 026/089] train: loss=0.7096 acc=73.02% | val: loss=0.7877 acc=61.45% f1=68.63% auc=60.12% val_score=43.7645 val_score_bestthr=56.4874 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.183, mb=0.499, no=0.992, corr=-0.363) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 56.4874
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.0701 mb_mean=0.5030 norm_overlap=0.9928 corr_cb=-0.2452 topkJ=0.0226
[TRAIN][ep=027] loss=0.7188 acc=72.62%
[TRAIN][ep=027] mask_avg: mc_mean=0.1621 mb_mean=0.4991 norm_overlap=0.9918 corr_cb=-0.3268
[EPOCH 027/089] train: loss=0.7188 acc=72.62% | val: loss=0.7628 acc=51.81% f1=68.25% auc=61.57% val_score=50.3966 val_score_bestthr=62.0453 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.162, mb=0.499, no=0.992, corr=-0.327) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 62.0453
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1619 mb_mean=0.4994 norm_overlap=0.9906 corr_cb=-0.3483 topkJ=0.0067
[TRAIN][ep=028] loss=0.7104 acc=72.08%
[TRAIN][ep=028] mask_avg: mc_mean=0.1643 mb_mean=0.4991 norm_overlap=0.9923 corr_cb=-0.3169
[EPOCH 028/089] train: loss=0.7104 acc=72.08% | val: loss=0.7536 acc=51.81% f1=68.25% auc=60.99% val_score=41.0743 val_score_bestthr=62.0453 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.164, mb=0.499, no=0.992, corr=-0.317) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 62.0453
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.1961 mb_mean=0.4979 norm_overlap=0.9919 corr_cb=-0.3873 topkJ=0.0066
[TRAIN][ep=029] loss=0.6951 acc=73.69%
[TRAIN][ep=029] mask_avg: mc_mean=0.1848 mb_mean=0.4991 norm_overlap=0.9930 corr_cb=-0.3107
[EPOCH 029/089] train: loss=0.6951 acc=73.69% | val: loss=0.8090 acc=53.01% f1=68.29% auc=61.16% val_score=41.6963 val_score_bestthr=56.7094 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.185, mb=0.499, no=0.993, corr=-0.311) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 56.7094
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2277 mb_mean=0.4970 norm_overlap=0.9945 corr_cb=-0.2843 topkJ=0.0191
[TRAIN][ep=030] loss=0.7063 acc=74.23%
[TRAIN][ep=030] mask_avg: mc_mean=0.1769 mb_mean=0.4992 norm_overlap=0.9925 corr_cb=-0.3239
[EPOCH 030/089] train: loss=0.7063 acc=74.23% | val: loss=0.7873 acc=56.63% f1=66.67% auc=60.99% val_score=41.7825 val_score_bestthr=54.7497 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.177, mb=0.499, no=0.993, corr=-0.324) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 54.7497
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2316 mb_mean=0.4980 norm_overlap=0.9931 corr_cb=-0.3500 topkJ=0.0089
[TRAIN][ep=031] loss=0.6926 acc=74.36%
[TRAIN][ep=031] mask_avg: mc_mean=0.1818 mb_mean=0.4991 norm_overlap=0.9927 corr_cb=-0.3247
[EPOCH 031/089] train: loss=0.6926 acc=74.36% | val: loss=0.7719 acc=59.04% f1=67.92% auc=61.22% val_score=47.0490 val_score_bestthr=56.6206 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.182, mb=0.499, no=0.993, corr=-0.325) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 56.6206
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1613 mb_mean=0.4981 norm_overlap=0.9949 corr_cb=-0.2547 topkJ=0.0297
[TRAIN][ep=032] loss=0.6887 acc=74.63%
[TRAIN][ep=032] mask_avg: mc_mean=0.1847 mb_mean=0.4991 norm_overlap=0.9932 corr_cb=-0.3096
[EPOCH 032/089] train: loss=0.6887 acc=74.63% | val: loss=0.7707 acc=59.04% f1=66.67% auc=61.98% val_score=46.5594 val_score_bestthr=54.6783 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.185, mb=0.499, no=0.993, corr=-0.310) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 54.6783
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2027 mb_mean=0.4969 norm_overlap=0.9927 corr_cb=-0.3501 topkJ=0.0118
[TRAIN][ep=033] loss=0.6701 acc=75.17%
[TRAIN][ep=033] mask_avg: mc_mean=0.1664 mb_mean=0.4991 norm_overlap=0.9935 corr_cb=-0.2756
[EPOCH 033/089] train: loss=0.6701 acc=75.17% | val: loss=0.7671 acc=57.83% f1=67.29% auc=62.50% val_score=47.3441 val_score_bestthr=55.1146 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.166, mb=0.499, no=0.994, corr=-0.276) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 55.1146
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2079 mb_mean=0.4955 norm_overlap=0.9953 corr_cb=-0.2158 topkJ=0.0264
[TRAIN][ep=034] loss=0.6653 acc=76.64%
[TRAIN][ep=034] mask_avg: mc_mean=0.1769 mb_mean=0.4991 norm_overlap=0.9936 corr_cb=-0.2810
[EPOCH 034/089] train: loss=0.6653 acc=76.64% | val: loss=0.7836 acc=60.24% f1=67.33% auc=62.97% val_score=46.5594 val_score_bestthr=56.1880 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.177, mb=0.499, no=0.994, corr=-0.281) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 56.1880
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.1601 mb_mean=0.4987 norm_overlap=0.9952 corr_cb=-0.2036 topkJ=0.0244
[TRAIN][ep=035] loss=0.6596 acc=75.97%
[TRAIN][ep=035] mask_avg: mc_mean=0.1881 mb_mean=0.4991 norm_overlap=0.9938 corr_cb=-0.2883
[EPOCH 035/089] train: loss=0.6596 acc=75.97% | val: loss=0.7829 acc=51.81% f1=68.25% auc=61.28% val_score=52.9260 val_score_bestthr=62.0453 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.188, mb=0.499, no=0.994, corr=-0.288) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 62.0453
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2156 mb_mean=0.4963 norm_overlap=0.9967 corr_cb=-0.1773 topkJ=0.0288
[TRAIN][ep=036] loss=0.6637 acc=76.24%
[TRAIN][ep=036] mask_avg: mc_mean=0.1998 mb_mean=0.4991 norm_overlap=0.9943 corr_cb=-0.2696
[EPOCH 036/089] train: loss=0.6637 acc=76.24% | val: loss=0.7838 acc=53.01% f1=68.80% auc=62.09% val_score=44.7395 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.200, mb=0.499, no=0.994, corr=-0.270) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 61.2320
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1457 mb_mean=0.4991 norm_overlap=0.9962 corr_cb=-0.1535 topkJ=0.0473
[TRAIN][ep=037] loss=0.6524 acc=77.05%
[TRAIN][ep=037] mask_avg: mc_mean=0.1896 mb_mean=0.4991 norm_overlap=0.9943 corr_cb=-0.2616
[EPOCH 037/089] train: loss=0.6524 acc=77.05% | val: loss=0.7822 acc=56.63% f1=67.27% auc=62.21% val_score=46.0729 val_score_bestthr=56.8023 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.499, no=0.994, corr=-0.262) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 56.8023
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.1766 mb_mean=0.4984 norm_overlap=0.9946 corr_cb=-0.2519 topkJ=0.0087
[TRAIN][ep=038] loss=0.6384 acc=77.32%
[TRAIN][ep=038] mask_avg: mc_mean=0.2000 mb_mean=0.4991 norm_overlap=0.9941 corr_cb=-0.2785
[EPOCH 038/089] train: loss=0.6384 acc=77.32% | val: loss=0.7787 acc=56.63% f1=67.86% auc=61.74% val_score=54.5168 val_score_bestthr=55.8035 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.200, mb=0.499, no=0.994, corr=-0.279) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 55.8035
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2410 mb_mean=0.4963 norm_overlap=0.9980 corr_cb=-0.1276 topkJ=0.0424
[TRAIN][ep=039] loss=0.6342 acc=77.58%
[TRAIN][ep=039] mask_avg: mc_mean=0.2081 mb_mean=0.4991 norm_overlap=0.9942 corr_cb=-0.2765
[EPOCH 039/089] train: loss=0.6342 acc=77.58% | val: loss=0.7850 acc=65.06% f1=65.06% auc=62.03% val_score=46.2176 val_score_bestthr=57.3770 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.208, mb=0.499, no=0.994, corr=-0.277) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 57.3770
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.1948 mb_mean=0.4988 norm_overlap=0.9927 corr_cb=-0.3254 topkJ=0.0166
[TRAIN][ep=040] loss=0.6252 acc=80.40%
[TRAIN][ep=040] mask_avg: mc_mean=0.2093 mb_mean=0.4992 norm_overlap=0.9948 corr_cb=-0.2505
[EPOCH 040/089] train: loss=0.6252 acc=80.40% | val: loss=0.8212 acc=63.86% f1=64.29% auc=62.21% val_score=47.9401 val_score_bestthr=55.8501 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.209, mb=0.499, no=0.995, corr=-0.250) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 55.8501
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.1628 mb_mean=0.5002 norm_overlap=0.9963 corr_cb=-0.2014 topkJ=0.0293
[TRAIN][ep=041] loss=0.6165 acc=79.73%
[TRAIN][ep=041] mask_avg: mc_mean=0.2047 mb_mean=0.4991 norm_overlap=0.9948 corr_cb=-0.2381
[EPOCH 041/089] train: loss=0.6165 acc=79.73% | val: loss=0.8347 acc=61.45% f1=68.63% auc=62.91% val_score=43.6760 val_score_bestthr=56.5679 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.205, mb=0.499, no=0.995, corr=-0.238) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 56.5679
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.1290 mb_mean=0.4995 norm_overlap=0.9938 corr_cb=-0.2916 topkJ=0.0057
[TRAIN][ep=042] loss=0.6082 acc=79.19%
[TRAIN][ep=042] mask_avg: mc_mean=0.2081 mb_mean=0.4991 norm_overlap=0.9943 corr_cb=-0.2642
[EPOCH 042/089] train: loss=0.6082 acc=79.19% | val: loss=0.8529 acc=63.86% f1=64.29% auc=62.73% val_score=42.5229 val_score_bestthr=55.8501 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.208, mb=0.499, no=0.994, corr=-0.264) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 55.8501
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.1619 mb_mean=0.4981 norm_overlap=0.9960 corr_cb=-0.1640 topkJ=0.0319
[TRAIN][ep=043] loss=0.5988 acc=80.27%
[TRAIN][ep=043] mask_avg: mc_mean=0.1942 mb_mean=0.4991 norm_overlap=0.9941 corr_cb=-0.2584
[EPOCH 043/089] train: loss=0.5988 acc=80.27% | val: loss=0.8745 acc=62.65% f1=69.90% auc=62.67% val_score=45.8226 val_score_bestthr=55.7453 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.194, mb=0.499, no=0.994, corr=-0.258) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 55.7453
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2404 mb_mean=0.4991 norm_overlap=0.9945 corr_cb=-0.2665 topkJ=0.0189
[TRAIN][ep=044] loss=0.6045 acc=80.67%
[TRAIN][ep=044] mask_avg: mc_mean=0.2152 mb_mean=0.4991 norm_overlap=0.9946 corr_cb=-0.2539
[EPOCH 044/089] train: loss=0.6045 acc=80.67% | val: loss=0.8082 acc=55.42% f1=69.92% auc=62.38% val_score=54.3260 val_score_bestthr=63.8324 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.215, mb=0.499, no=0.995, corr=-0.254) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 62.3371 -> 63.8324
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/ckpt_best_fold_4.pt
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2087 mb_mean=0.4983 norm_overlap=0.9958 corr_cb=-0.2326 topkJ=0.0209
[TRAIN][ep=045] loss=0.6626 acc=80.54%
[TRAIN][ep=045] mask_avg: mc_mean=0.2117 mb_mean=0.4991 norm_overlap=0.9944 corr_cb=-0.2558
[EPOCH 045/089] train: loss=0.6626 acc=80.54% | val: loss=0.8116 acc=55.42% f1=69.92% auc=63.08% val_score=55.8501 val_score_bestthr=63.8324 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.212, mb=0.499, no=0.994, corr=-0.256) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 63.8324
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.1596 mb_mean=0.4995 norm_overlap=0.9941 corr_cb=-0.2205 topkJ=0.0196
[TRAIN][ep=046] loss=0.7326 acc=81.48%
[TRAIN][ep=046] mask_avg: mc_mean=0.2079 mb_mean=0.4991 norm_overlap=0.9944 corr_cb=-0.2543
[EPOCH 046/089] train: loss=0.7326 acc=81.48% | val: loss=0.8163 acc=55.42% f1=67.26% auc=62.73% val_score=47.9401 val_score_bestthr=55.8811 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.208, mb=0.499, no=0.994, corr=-0.254) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 55.8811
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.3058 mb_mean=0.4995 norm_overlap=0.9958 corr_cb=-0.2502 topkJ=0.0082
[TRAIN][ep=047] loss=0.8017 acc=81.61%
[TRAIN][ep=047] mask_avg: mc_mean=0.2118 mb_mean=0.4992 norm_overlap=0.9939 corr_cb=-0.2702
[EPOCH 047/089] train: loss=0.8017 acc=81.61% | val: loss=0.8424 acc=65.06% f1=66.67% auc=63.95% val_score=42.5229 val_score_bestthr=56.3303 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.212, mb=0.499, no=0.994, corr=-0.270) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.3303
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.1536 mb_mean=0.5025 norm_overlap=0.9934 corr_cb=-0.3020 topkJ=0.0079
[TRAIN][ep=048] loss=0.8711 acc=82.28%
[TRAIN][ep=048] mask_avg: mc_mean=0.1995 mb_mean=0.4991 norm_overlap=0.9939 corr_cb=-0.2607
[EPOCH 048/089] train: loss=0.8711 acc=82.28% | val: loss=0.8147 acc=62.65% f1=64.37% auc=63.08% val_score=53.8470 val_score_bestthr=57.6109 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.199, mb=0.499, no=0.994, corr=-0.261) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 57.6109
[DBG][ep=049] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.2468 mb_mean=0.4992 norm_overlap=0.9937 corr_cb=-0.2839 topkJ=0.0133
[TRAIN][ep=049] loss=0.9519 acc=82.01%
[TRAIN][ep=049] mask_avg: mc_mean=0.2256 mb_mean=0.4991 norm_overlap=0.9939 corr_cb=-0.2819
[EPOCH 049/089] train: loss=0.9519 acc=82.01% | val: loss=0.8206 acc=65.06% f1=65.06% auc=63.31% val_score=53.9542 val_score_bestthr=57.3770 | dyn(w_pfs=0.100, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.226, mb=0.499, no=0.994, corr=-0.282) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 57.3770
[DBG][ep=050] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.1803 mb_mean=0.5005 norm_overlap=0.9924 corr_cb=-0.3439 topkJ=0.0211
[TRAIN][ep=050] loss=0.5609 acc=85.23%
[TRAIN][ep=050] mask_avg: mc_mean=0.2018 mb_mean=0.4991 norm_overlap=0.9936 corr_cb=-0.2782
[EPOCH 050/089] train: loss=0.5609 acc=85.23% | val: loss=0.8293 acc=55.42% f1=67.83% auc=63.02% val_score=52.6715 val_score_bestthr=59.7749 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.202, mb=0.499, no=0.994, corr=-0.278) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 59.7749
[DBG][ep=051] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.2536 mb_mean=0.4959 norm_overlap=0.9952 corr_cb=-0.2221 topkJ=0.0203
[TRAIN][ep=051] loss=0.5392 acc=84.70%
[TRAIN][ep=051] mask_avg: mc_mean=0.2018 mb_mean=0.4991 norm_overlap=0.9937 corr_cb=-0.2758
[EPOCH 051/089] train: loss=0.5392 acc=84.70% | val: loss=0.8364 acc=65.06% f1=65.06% auc=62.79% val_score=55.8501 val_score_bestthr=57.3770 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.202, mb=0.499, no=0.994, corr=-0.276) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 57.3770
[DBG][ep=052] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.2099 mb_mean=0.4993 norm_overlap=0.9932 corr_cb=-0.3124 topkJ=0.0095
[TRAIN][ep=052] loss=0.5391 acc=83.89%
[TRAIN][ep=052] mask_avg: mc_mean=0.2018 mb_mean=0.4991 norm_overlap=0.9936 corr_cb=-0.2812
[EPOCH 052/089] train: loss=0.5391 acc=83.89% | val: loss=0.8517 acc=54.22% f1=67.80% auc=62.91% val_score=55.1804 val_score_bestthr=56.0066 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.202, mb=0.499, no=0.994, corr=-0.281) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.0066
[DBG][ep=053] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.2321 mb_mean=0.4968 norm_overlap=0.9946 corr_cb=-0.2378 topkJ=0.0181
[TRAIN][ep=053] loss=0.5354 acc=84.30%
[TRAIN][ep=053] mask_avg: mc_mean=0.2018 mb_mean=0.4991 norm_overlap=0.9937 corr_cb=-0.2766
[EPOCH 053/089] train: loss=0.5354 acc=84.30% | val: loss=0.8579 acc=61.45% f1=63.64% auc=63.43% val_score=55.1804 val_score_bestthr=57.2297 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.202, mb=0.499, no=0.994, corr=-0.277) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 57.2297
[DBG][ep=054] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=054] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=054] mask(step0): mc_mean=0.1583 mb_mean=0.5002 norm_overlap=0.9942 corr_cb=-0.2096 topkJ=0.0156
[TRAIN][ep=054] loss=0.5350 acc=84.83%
[TRAIN][ep=054] mask_avg: mc_mean=0.2018 mb_mean=0.4991 norm_overlap=0.9937 corr_cb=-0.2770
[EPOCH 054/089] train: loss=0.5350 acc=84.83% | val: loss=0.8607 acc=54.22% f1=67.80% auc=63.02% val_score=53.9542 val_score_bestthr=56.0066 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.202, mb=0.499, no=0.994, corr=-0.277) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.0066
[DBG][ep=055] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=055] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=055] mask(step0): mc_mean=0.1752 mb_mean=0.5003 norm_overlap=0.9965 corr_cb=-0.1763 topkJ=0.0305
[TRAIN][ep=055] loss=0.5310 acc=84.56%
[TRAIN][ep=055] mask_avg: mc_mean=0.2017 mb_mean=0.4991 norm_overlap=0.9936 corr_cb=-0.2797
[EPOCH 055/089] train: loss=0.5310 acc=84.56% | val: loss=0.8807 acc=60.24% f1=69.16% auc=63.26% val_score=52.0121 val_score_bestthr=55.7768 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.202, mb=0.499, no=0.994, corr=-0.280) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 55.7768
[DBG][ep=056] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=056] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=056] mask(step0): mc_mean=0.1804 mb_mean=0.5005 norm_overlap=0.9949 corr_cb=-0.2403 topkJ=0.0141
[TRAIN][ep=056] loss=0.5301 acc=84.83%
[TRAIN][ep=056] mask_avg: mc_mean=0.2017 mb_mean=0.4991 norm_overlap=0.9936 corr_cb=-0.2769
[EPOCH 056/089] train: loss=0.5301 acc=84.83% | val: loss=0.8677 acc=54.22% f1=67.80% auc=62.79% val_score=53.9542 val_score_bestthr=56.0066 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.202, mb=0.499, no=0.994, corr=-0.277) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.0066
[DBG][ep=057] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=057] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=057] mask(step0): mc_mean=0.2054 mb_mean=0.4965 norm_overlap=0.9934 corr_cb=-0.3364 topkJ=0.0064
[TRAIN][ep=057] loss=0.5315 acc=84.03%
[TRAIN][ep=057] mask_avg: mc_mean=0.2018 mb_mean=0.4992 norm_overlap=0.9936 corr_cb=-0.2767
[EPOCH 057/089] train: loss=0.5315 acc=84.03% | val: loss=0.8836 acc=54.22% f1=67.80% auc=63.43% val_score=51.9429 val_score_bestthr=56.0066 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.202, mb=0.499, no=0.994, corr=-0.277) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.0066
[DBG][ep=058] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=058] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=058] mask(step0): mc_mean=0.2009 mb_mean=0.4978 norm_overlap=0.9975 corr_cb=-0.1246 topkJ=0.0287
[TRAIN][ep=058] loss=0.5278 acc=85.10%
[TRAIN][ep=058] mask_avg: mc_mean=0.2017 mb_mean=0.4991 norm_overlap=0.9936 corr_cb=-0.2768
[EPOCH 058/089] train: loss=0.5278 acc=85.10% | val: loss=0.8893 acc=54.22% f1=67.80% auc=62.85% val_score=51.9429 val_score_bestthr=56.0066 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.202, mb=0.499, no=0.994, corr=-0.277) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.0066
[DBG][ep=059] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=059] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=059] mask(step0): mc_mean=0.2027 mb_mean=0.4995 norm_overlap=0.9948 corr_cb=-0.2927 topkJ=0.0176
[TRAIN][ep=059] loss=0.5257 acc=85.10%
[TRAIN][ep=059] mask_avg: mc_mean=0.2017 mb_mean=0.4991 norm_overlap=0.9936 corr_cb=-0.2780
[EPOCH 059/089] train: loss=0.5257 acc=85.10% | val: loss=0.8854 acc=54.22% f1=67.80% auc=62.91% val_score=55.6273 val_score_bestthr=56.0066 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.202, mb=0.499, no=0.994, corr=-0.278) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.0066
[DBG][ep=060] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=060] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=060] mask(step0): mc_mean=0.1829 mb_mean=0.4997 norm_overlap=0.9963 corr_cb=-0.2373 topkJ=0.0259
[TRAIN][ep=060] loss=0.5225 acc=85.91%
[TRAIN][ep=060] mask_avg: mc_mean=0.2018 mb_mean=0.4991 norm_overlap=0.9937 corr_cb=-0.2748
[EPOCH 060/089] train: loss=0.5225 acc=85.91% | val: loss=0.8926 acc=60.24% f1=69.16% auc=62.91% val_score=51.9429 val_score_bestthr=55.7768 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.202, mb=0.499, no=0.994, corr=-0.275) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 55.7768
[DBG][ep=061] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=061] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=061] mask(step0): mc_mean=0.2060 mb_mean=0.4977 norm_overlap=0.9931 corr_cb=-0.3179 topkJ=0.0113
[TRAIN][ep=061] loss=0.5254 acc=85.23%
[TRAIN][ep=061] mask_avg: mc_mean=0.2016 mb_mean=0.4991 norm_overlap=0.9936 corr_cb=-0.2783
[EPOCH 061/089] train: loss=0.5254 acc=85.23% | val: loss=0.8963 acc=54.22% f1=67.80% auc=62.97% val_score=55.4116 val_score_bestthr=56.0066 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.202, mb=0.499, no=0.994, corr=-0.278) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.0066
[DBG][ep=062] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=062] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=062] mask(step0): mc_mean=0.2288 mb_mean=0.4994 norm_overlap=0.9936 corr_cb=-0.2758 topkJ=0.0104
[TRAIN][ep=062] loss=0.5247 acc=84.97%
[TRAIN][ep=062] mask_avg: mc_mean=0.2017 mb_mean=0.4991 norm_overlap=0.9937 corr_cb=-0.2765
[EPOCH 062/089] train: loss=0.5247 acc=84.97% | val: loss=0.8942 acc=66.27% f1=64.10% auc=62.79% val_score=55.4116 val_score_bestthr=56.5322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.202, mb=0.499, no=0.994, corr=-0.276) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.5322
[DBG][ep=063] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=063] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=063] mask(step0): mc_mean=0.2291 mb_mean=0.4970 norm_overlap=0.9968 corr_cb=-0.1850 topkJ=0.0367
[TRAIN][ep=063] loss=0.5219 acc=85.23%
[TRAIN][ep=063] mask_avg: mc_mean=0.2017 mb_mean=0.4992 norm_overlap=0.9936 corr_cb=-0.2773
[EPOCH 063/089] train: loss=0.5219 acc=85.23% | val: loss=0.9009 acc=54.22% f1=67.80% auc=62.85% val_score=55.4116 val_score_bestthr=56.0066 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.202, mb=0.499, no=0.994, corr=-0.277) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.0066
[DBG][ep=064] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=064] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=064] mask(step0): mc_mean=0.2337 mb_mean=0.4982 norm_overlap=0.9903 corr_cb=-0.4576 topkJ=0.0040
[TRAIN][ep=064] loss=0.5211 acc=85.10%
[TRAIN][ep=064] mask_avg: mc_mean=0.2018 mb_mean=0.4991 norm_overlap=0.9937 corr_cb=-0.2774
[EPOCH 064/089] train: loss=0.5211 acc=85.10% | val: loss=0.9173 acc=54.22% f1=67.80% auc=62.97% val_score=52.2254 val_score_bestthr=56.0066 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.202, mb=0.499, no=0.994, corr=-0.277) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.0066
[DBG][ep=065] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=065] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=065] mask(step0): mc_mean=0.2069 mb_mean=0.4994 norm_overlap=0.9921 corr_cb=-0.3294 topkJ=0.0160
[TRAIN][ep=065] loss=0.5190 acc=84.56%
[TRAIN][ep=065] mask_avg: mc_mean=0.2017 mb_mean=0.4991 norm_overlap=0.9936 corr_cb=-0.2775
[EPOCH 065/089] train: loss=0.5190 acc=84.56% | val: loss=0.9259 acc=60.24% f1=67.96% auc=62.73% val_score=52.0121 val_score_bestthr=55.9533 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.202, mb=0.499, no=0.994, corr=-0.278) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 55.9533
[DBG][ep=066] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=066] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=066] mask(step0): mc_mean=0.1908 mb_mean=0.5017 norm_overlap=0.9898 corr_cb=-0.4207 topkJ=0.0087
[TRAIN][ep=066] loss=0.5196 acc=84.70%
[TRAIN][ep=066] mask_avg: mc_mean=0.2017 mb_mean=0.4991 norm_overlap=0.9936 corr_cb=-0.2781
[EPOCH 066/089] train: loss=0.5196 acc=84.70% | val: loss=0.8983 acc=55.42% f1=68.38% auc=62.44% val_score=54.9816 val_score_bestthr=56.2140 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.202, mb=0.499, no=0.994, corr=-0.278) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.2140
[DBG][ep=067] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=067] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=067] mask(step0): mc_mean=0.2046 mb_mean=0.4992 norm_overlap=0.9948 corr_cb=-0.2680 topkJ=0.0115
[TRAIN][ep=067] loss=0.5177 acc=84.70%
[TRAIN][ep=067] mask_avg: mc_mean=0.2018 mb_mean=0.4991 norm_overlap=0.9936 corr_cb=-0.2795
[EPOCH 067/089] train: loss=0.5177 acc=84.70% | val: loss=0.8992 acc=54.22% f1=67.80% auc=62.33% val_score=54.5126 val_score_bestthr=56.0066 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.202, mb=0.499, no=0.994, corr=-0.280) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.0066
[DBG][ep=068] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=068] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=068] mask(step0): mc_mean=0.2460 mb_mean=0.4973 norm_overlap=0.9946 corr_cb=-0.2531 topkJ=0.0113
[TRAIN][ep=068] loss=0.5125 acc=85.77%
[TRAIN][ep=068] mask_avg: mc_mean=0.2018 mb_mean=0.4991 norm_overlap=0.9936 corr_cb=-0.2785
[EPOCH 068/089] train: loss=0.5125 acc=85.77% | val: loss=0.9021 acc=54.22% f1=67.80% auc=62.62% val_score=55.6273 val_score_bestthr=56.0066 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.202, mb=0.499, no=0.994, corr=-0.279) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.0066
[DBG][ep=069] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=069] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=069] mask(step0): mc_mean=0.2011 mb_mean=0.4983 norm_overlap=0.9925 corr_cb=-0.2803 topkJ=0.0043
[TRAIN][ep=069] loss=0.5108 acc=85.77%
[TRAIN][ep=069] mask_avg: mc_mean=0.2017 mb_mean=0.4991 norm_overlap=0.9936 corr_cb=-0.2784
[EPOCH 069/089] train: loss=0.5108 acc=85.77% | val: loss=0.9073 acc=54.22% f1=67.80% auc=62.50% val_score=55.6273 val_score_bestthr=56.0066 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.202, mb=0.499, no=0.994, corr=-0.278) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.0066
[DBG][ep=070] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=070] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=070] mask(step0): mc_mean=0.1994 mb_mean=0.4984 norm_overlap=0.9971 corr_cb=-0.1438 topkJ=0.0158
[TRAIN][ep=070] loss=0.5118 acc=85.50%
[TRAIN][ep=070] mask_avg: mc_mean=0.2018 mb_mean=0.4991 norm_overlap=0.9936 corr_cb=-0.2788
[EPOCH 070/089] train: loss=0.5118 acc=85.50% | val: loss=0.9113 acc=54.22% f1=67.80% auc=62.56% val_score=55.6273 val_score_bestthr=56.0066 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.202, mb=0.499, no=0.994, corr=-0.279) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.0066
[DBG][ep=071] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=071] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=071] mask(step0): mc_mean=0.2076 mb_mean=0.4984 norm_overlap=0.9950 corr_cb=-0.2274 topkJ=0.0088
[TRAIN][ep=071] loss=0.5148 acc=85.10%
[TRAIN][ep=071] mask_avg: mc_mean=0.2017 mb_mean=0.4991 norm_overlap=0.9936 corr_cb=-0.2774
[EPOCH 071/089] train: loss=0.5148 acc=85.10% | val: loss=0.9156 acc=54.22% f1=67.80% auc=62.73% val_score=55.6273 val_score_bestthr=56.0066 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.202, mb=0.499, no=0.994, corr=-0.277) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.0066
[DBG][ep=072] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=072] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=072] mask(step0): mc_mean=0.2319 mb_mean=0.4976 norm_overlap=0.9919 corr_cb=-0.3353 topkJ=0.0074
[TRAIN][ep=072] loss=0.5103 acc=85.37%
[TRAIN][ep=072] mask_avg: mc_mean=0.2017 mb_mean=0.4991 norm_overlap=0.9937 corr_cb=-0.2760
[EPOCH 072/089] train: loss=0.5103 acc=85.37% | val: loss=0.9111 acc=55.42% f1=68.38% auc=62.67% val_score=54.2910 val_score_bestthr=56.2140 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.202, mb=0.499, no=0.994, corr=-0.276) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.2140
[DBG][ep=073] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=073] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=073] mask(step0): mc_mean=0.1779 mb_mean=0.5004 norm_overlap=0.9938 corr_cb=-0.3090 topkJ=0.0083
[TRAIN][ep=073] loss=0.5144 acc=85.10%
[TRAIN][ep=073] mask_avg: mc_mean=0.2018 mb_mean=0.4991 norm_overlap=0.9936 corr_cb=-0.2788
[EPOCH 073/089] train: loss=0.5144 acc=85.10% | val: loss=0.9152 acc=61.45% f1=61.90% auc=62.44% val_score=55.6273 val_score_bestthr=57.1184 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.202, mb=0.499, no=0.994, corr=-0.279) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 57.1184
[DBG][ep=074] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=074] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=074] mask(step0): mc_mean=0.2282 mb_mean=0.4964 norm_overlap=0.9909 corr_cb=-0.3640 topkJ=0.0093
[TRAIN][ep=074] loss=0.5113 acc=85.10%
[TRAIN][ep=074] mask_avg: mc_mean=0.2018 mb_mean=0.4991 norm_overlap=0.9936 corr_cb=-0.2778
[EPOCH 074/089] train: loss=0.5113 acc=85.10% | val: loss=0.9179 acc=61.45% f1=61.90% auc=62.44% val_score=55.6273 val_score_bestthr=57.1184 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.202, mb=0.499, no=0.994, corr=-0.278) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 57.1184
[EARLY STOP] no improvement for 30 epochs. best_epoch=44
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/ckpt_best_fold_4.pt
=============== FIT DONE ===============
[BEST] epoch=44 | val_acc=55.42% | val_f1=69.92% | val_auc=62.38% | val_score=54.3260 | val_score_bestthr=63.8324
[TEST@BEST] thr_used=0.385 | acc=72.46% f1=77.65% auc=75.91% | SP_sex=11.96% EO_sex=7.69% SP_age=25.15% EO_age=21.05%
[TIME] 1.89 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/summary_fold_4.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4721 mb_mean=0.5002 norm_overlap=0.9999 corr_cb=-0.1647 topkJ=0.0157
[TRAIN][ep=000] loss=0.6977 acc=48.59%
[TRAIN][ep=000] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1975
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4770 mb_mean=0.4998 norm_overlap=0.9998 corr_cb=-0.3436 topkJ=0.0036
[TRAIN][ep=001] loss=0.6950 acc=49.53%
[TRAIN][ep=001] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1999
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4738 mb_mean=0.5016 norm_overlap=0.9996 corr_cb=-0.4790 topkJ=0.0004
[TRAIN][ep=002] loss=0.6930 acc=51.28%
[TRAIN][ep=002] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2027
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4776 mb_mean=0.5006 norm_overlap=0.9998 corr_cb=-0.3552 topkJ=0.0111
[TRAIN][ep=003] loss=0.6925 acc=52.75%
[TRAIN][ep=003] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2020
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4748 mb_mean=0.5000 norm_overlap=0.9999 corr_cb=-0.1629 topkJ=0.0285
[TRAIN][ep=004] loss=0.6906 acc=53.02%
[TRAIN][ep=004] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2047
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4745 mb_mean=0.4997 norm_overlap=0.9999 corr_cb=-0.1323 topkJ=0.0316
[TRAIN][ep=005] loss=0.6891 acc=54.90%
[TRAIN][ep=005] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1977
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4771 mb_mean=0.4972 norm_overlap=0.9998 corr_cb=-0.2743 topkJ=0.0103
[TRAIN][ep=006] loss=0.6856 acc=58.12%
[TRAIN][ep=006] mask_avg: mc_mean=0.4756 mb_mean=0.4992 norm_overlap=0.9999 corr_cb=-0.1986
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4738 mb_mean=0.4973 norm_overlap=0.9999 corr_cb=-0.1266 topkJ=0.0306
[TRAIN][ep=007] loss=0.6873 acc=57.05%
[TRAIN][ep=007] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2027
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4717 mb_mean=0.5007 norm_overlap=0.9998 corr_cb=-0.2901 topkJ=0.0142
[TRAIN][ep=008] loss=0.6822 acc=57.99%
[TRAIN][ep=008] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1953
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4772 mb_mean=0.5007 norm_overlap=0.9999 corr_cb=-0.2881 topkJ=0.0134
[TRAIN][ep=009] loss=0.6789 acc=58.39%
[TRAIN][ep=009] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1962
================= FIT START (fold=4) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4762 mb_mean=0.4988 norm_overlap=0.9999 corr_cb=-0.2022 topkJ=0.0282
[TRAIN][ep=000] loss=0.6748 acc=58.66%
[TRAIN][ep=000] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1983
[EPOCH 000/089] train: loss=0.6748 acc=58.66% | val: loss=0.6925 acc=54.22% f1=66.07% auc=54.65% val_score=42.1744 val_score_bestthr=54.9344 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.198) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 54.9344
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/ckpt_best_fold_4.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4752 mb_mean=0.4988 norm_overlap=0.9999 corr_cb=-0.2582 topkJ=0.0120
[TRAIN][ep=001] loss=0.6685 acc=60.67%
[TRAIN][ep=001] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2040
[EPOCH 001/089] train: loss=0.6685 acc=60.67% | val: loss=0.6889 acc=60.24% f1=61.18% auc=56.63% val_score=55.5611 val_score_bestthr=55.5611 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.204) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 54.9344 -> 55.5611
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/ckpt_best_fold_4.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4765 mb_mean=0.4979 norm_overlap=0.9999 corr_cb=-0.1296 topkJ=0.0093
[TRAIN][ep=002] loss=0.6655 acc=62.55%
[TRAIN][ep=002] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1937
[EPOCH 002/089] train: loss=0.6655 acc=62.55% | val: loss=0.6904 acc=51.81% f1=68.25% auc=56.69% val_score=39.2574 val_score_bestthr=62.0453 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.194) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 55.5611 -> 62.0453
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/ckpt_best_fold_4.pt
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4731 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2435 topkJ=0.0106
[TRAIN][ep=003] loss=0.6647 acc=60.40%
[TRAIN][ep=003] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2014
[EPOCH 003/089] train: loss=0.6647 acc=60.40% | val: loss=0.6858 acc=63.86% f1=61.54% auc=58.31% val_score=44.9148 val_score_bestthr=55.7466 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.201) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 55.7466
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4765 mb_mean=0.4969 norm_overlap=0.9999 corr_cb=-0.2336 topkJ=0.0250
[TRAIN][ep=004] loss=0.6589 acc=61.07%
[TRAIN][ep=004] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2016
[EPOCH 004/089] train: loss=0.6589 acc=61.07% | val: loss=0.6869 acc=60.24% f1=62.07% auc=57.85% val_score=51.3174 val_score_bestthr=53.8915 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.202) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 53.8915
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4758 mb_mean=0.4977 norm_overlap=0.9998 corr_cb=-0.3229 topkJ=0.0168
[TRAIN][ep=005] loss=1.4667 acc=61.34%
[TRAIN][ep=005] mask_avg: mc_mean=0.3385 mb_mean=0.4991 norm_overlap=0.9988 corr_cb=-0.2824
[EPOCH 005/089] train: loss=1.4667 acc=61.34% | val: loss=0.7045 acc=56.63% f1=67.27% auc=54.71% val_score=39.6203 val_score_bestthr=58.1693 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.338, mb=0.499, no=0.999, corr=-0.282) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 58.1693
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2250 mb_mean=0.5012 norm_overlap=0.9976 corr_cb=-0.3355 topkJ=0.0058
[TRAIN][ep=006] loss=1.4522 acc=61.88%
[TRAIN][ep=006] mask_avg: mc_mean=0.2146 mb_mean=0.4991 norm_overlap=0.9972 corr_cb=-0.2954
[EPOCH 006/089] train: loss=1.4522 acc=61.88% | val: loss=0.6865 acc=54.22% f1=66.07% auc=56.92% val_score=46.8960 val_score_bestthr=54.9344 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.215, mb=0.499, no=0.997, corr=-0.295) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 54.9344
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.1693 mb_mean=0.5002 norm_overlap=0.9949 corr_cb=-0.3989 topkJ=0.0056
[TRAIN][ep=007] loss=1.4465 acc=63.89%
[TRAIN][ep=007] mask_avg: mc_mean=0.1843 mb_mean=0.4991 norm_overlap=0.9961 corr_cb=-0.3243
[EPOCH 007/089] train: loss=1.4465 acc=63.89% | val: loss=0.6866 acc=59.04% f1=62.22% auc=57.21% val_score=46.8960 val_score_bestthr=53.7020 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.184, mb=0.499, no=0.996, corr=-0.324) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 53.7020
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2038 mb_mean=0.4990 norm_overlap=0.9956 corr_cb=-0.3812 topkJ=0.0106
[TRAIN][ep=008] loss=1.2440 acc=63.76%
[TRAIN][ep=008] mask_avg: mc_mean=0.1683 mb_mean=0.4991 norm_overlap=0.9951 corr_cb=-0.3549
[EPOCH 008/089] train: loss=1.2440 acc=63.76% | val: loss=0.6982 acc=59.04% f1=55.26% auc=58.26% val_score=51.4771 val_score_bestthr=53.6410 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.168, mb=0.499, no=0.995, corr=-0.355) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 53.6410
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1498 mb_mean=0.4992 norm_overlap=0.9938 corr_cb=-0.4202 topkJ=0.0082
[TRAIN][ep=009] loss=1.0378 acc=64.03%
[TRAIN][ep=009] mask_avg: mc_mean=0.1698 mb_mean=0.4991 norm_overlap=0.9943 corr_cb=-0.3873
[EPOCH 009/089] train: loss=1.0378 acc=64.03% | val: loss=0.6874 acc=60.24% f1=62.92% auc=57.73% val_score=55.9450 val_score_bestthr=55.9450 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.170, mb=0.499, no=0.994, corr=-0.387) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 55.9450
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1393 mb_mean=0.5005 norm_overlap=0.9962 corr_cb=-0.2829 topkJ=0.0133
[TRAIN][ep=010] loss=1.0045 acc=63.49%
[TRAIN][ep=010] mask_avg: mc_mean=0.1693 mb_mean=0.4991 norm_overlap=0.9935 corr_cb=-0.4133
[EPOCH 010/089] train: loss=1.0045 acc=63.49% | val: loss=0.6866 acc=62.65% f1=65.17% auc=58.84% val_score=50.8338 val_score_bestthr=59.4856 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.169, mb=0.499, no=0.993, corr=-0.413) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 59.4856
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1385 mb_mean=0.5000 norm_overlap=0.9935 corr_cb=-0.4099 topkJ=0.0055
[TRAIN][ep=011] loss=0.9744 acc=64.97%
[TRAIN][ep=011] mask_avg: mc_mean=0.1617 mb_mean=0.4992 norm_overlap=0.9925 corr_cb=-0.4147
[EPOCH 011/089] train: loss=0.9744 acc=64.97% | val: loss=0.6930 acc=61.45% f1=64.44% auc=58.37% val_score=50.5952 val_score_bestthr=57.9526 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.162, mb=0.499, no=0.993, corr=-0.415) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 57.9526
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.2119 mb_mean=0.4969 norm_overlap=0.9958 corr_cb=-0.3157 topkJ=0.0122
[TRAIN][ep=012] loss=0.9710 acc=64.03%
[TRAIN][ep=012] mask_avg: mc_mean=0.1699 mb_mean=0.4991 norm_overlap=0.9922 corr_cb=-0.4125
[EPOCH 012/089] train: loss=0.9710 acc=64.03% | val: loss=0.6949 acc=62.65% f1=64.37% auc=58.60% val_score=55.9450 val_score_bestthr=57.6598 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.170, mb=0.499, no=0.992, corr=-0.413) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 57.6598
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1928 mb_mean=0.4960 norm_overlap=0.9927 corr_cb=-0.3987 topkJ=0.0028
[TRAIN][ep=013] loss=0.9577 acc=67.11%
[TRAIN][ep=013] mask_avg: mc_mean=0.1718 mb_mean=0.4991 norm_overlap=0.9917 corr_cb=-0.4115
[EPOCH 013/089] train: loss=0.9577 acc=67.11% | val: loss=0.7002 acc=60.24% f1=62.92% auc=58.20% val_score=55.1154 val_score_bestthr=55.9450 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.172, mb=0.499, no=0.992, corr=-0.412) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 55.9450
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1258 mb_mean=0.5003 norm_overlap=0.9915 corr_cb=-0.3491 topkJ=0.0059
[TRAIN][ep=014] loss=0.9524 acc=66.98%
[TRAIN][ep=014] mask_avg: mc_mean=0.1656 mb_mean=0.4991 norm_overlap=0.9909 corr_cb=-0.4176
[EPOCH 014/089] train: loss=0.9524 acc=66.98% | val: loss=0.7163 acc=59.04% f1=57.50% auc=59.59% val_score=49.0716 val_score_bestthr=57.5078 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.166, mb=0.499, no=0.991, corr=-0.418) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 57.5078
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.2099 mb_mean=0.4990 norm_overlap=0.9900 corr_cb=-0.5355 topkJ=0.0044
[TRAIN][ep=015] loss=0.9538 acc=65.50%
[TRAIN][ep=015] mask_avg: mc_mean=0.1740 mb_mean=0.4991 norm_overlap=0.9908 corr_cb=-0.4157
[EPOCH 015/089] train: loss=0.9538 acc=65.50% | val: loss=0.7118 acc=57.83% f1=67.29% auc=58.31% val_score=46.5120 val_score_bestthr=57.5872 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.174, mb=0.499, no=0.991, corr=-0.416) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 57.5872
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1285 mb_mean=0.5034 norm_overlap=0.9865 corr_cb=-0.4679 topkJ=0.0031
[TRAIN][ep=016] loss=0.9441 acc=65.37%
[TRAIN][ep=016] mask_avg: mc_mean=0.1789 mb_mean=0.4991 norm_overlap=0.9908 corr_cb=-0.4125
[EPOCH 016/089] train: loss=0.9441 acc=65.37% | val: loss=0.7026 acc=59.04% f1=68.52% auc=60.00% val_score=48.1555 val_score_bestthr=54.9295 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.179, mb=0.499, no=0.991, corr=-0.412) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 54.9295
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1938 mb_mean=0.4979 norm_overlap=0.9922 corr_cb=-0.3959 topkJ=0.0097
[TRAIN][ep=017] loss=0.9342 acc=68.99%
[TRAIN][ep=017] mask_avg: mc_mean=0.1801 mb_mean=0.4991 norm_overlap=0.9905 corr_cb=-0.4232
[EPOCH 017/089] train: loss=0.9342 acc=68.99% | val: loss=0.7201 acc=53.01% f1=68.80% auc=60.12% val_score=52.2410 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.180, mb=0.499, no=0.991, corr=-0.423) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 61.2320
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1883 mb_mean=0.5000 norm_overlap=0.9946 corr_cb=-0.2847 topkJ=0.0200
[TRAIN][ep=018] loss=0.9373 acc=68.19%
[TRAIN][ep=018] mask_avg: mc_mean=0.1900 mb_mean=0.4992 norm_overlap=0.9903 corr_cb=-0.4346
[EPOCH 018/089] train: loss=0.9373 acc=68.19% | val: loss=0.7264 acc=53.01% f1=68.80% auc=60.64% val_score=48.7317 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.499, no=0.990, corr=-0.435) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 61.2320
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.2405 mb_mean=0.4994 norm_overlap=0.9879 corr_cb=-0.5628 topkJ=0.0020
[TRAIN][ep=019] loss=0.9361 acc=67.38%
[TRAIN][ep=019] mask_avg: mc_mean=0.1868 mb_mean=0.4991 norm_overlap=0.9903 corr_cb=-0.4264
[EPOCH 019/089] train: loss=0.9361 acc=67.38% | val: loss=0.7103 acc=57.83% f1=67.89% auc=59.48% val_score=41.0743 val_score_bestthr=54.7859 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.187, mb=0.499, no=0.990, corr=-0.426) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 54.7859
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1589 mb_mean=0.4995 norm_overlap=0.9884 corr_cb=-0.4667 topkJ=0.0028
[TRAIN][ep=020] loss=0.9220 acc=69.53%
[TRAIN][ep=020] mask_avg: mc_mean=0.1777 mb_mean=0.4991 norm_overlap=0.9900 corr_cb=-0.4258
[EPOCH 020/089] train: loss=0.9220 acc=69.53% | val: loss=0.7493 acc=51.81% f1=68.25% auc=59.88% val_score=38.6501 val_score_bestthr=62.0453 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.178, mb=0.499, no=0.990, corr=-0.426) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 62.0453
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2452 mb_mean=0.4957 norm_overlap=0.9920 corr_cb=-0.4256 topkJ=0.0162
[TRAIN][ep=021] loss=0.9073 acc=71.14%
[TRAIN][ep=021] mask_avg: mc_mean=0.1923 mb_mean=0.4991 norm_overlap=0.9904 corr_cb=-0.4252
[EPOCH 021/089] train: loss=0.9073 acc=71.14% | val: loss=0.7498 acc=53.01% f1=68.80% auc=61.05% val_score=43.8132 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.192, mb=0.499, no=0.990, corr=-0.425) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 61.2320
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2217 mb_mean=0.4965 norm_overlap=0.9926 corr_cb=-0.3551 topkJ=0.0024
[TRAIN][ep=022] loss=0.9100 acc=69.13%
[TRAIN][ep=022] mask_avg: mc_mean=0.1814 mb_mean=0.4991 norm_overlap=0.9908 corr_cb=-0.3926
[EPOCH 022/089] train: loss=0.9100 acc=69.13% | val: loss=0.7300 acc=59.04% f1=67.92% auc=60.29% val_score=44.1033 val_score_bestthr=56.6206 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.181, mb=0.499, no=0.991, corr=-0.393) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 56.6206
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1898 mb_mean=0.4979 norm_overlap=0.9917 corr_cb=-0.4305 topkJ=0.0068
[TRAIN][ep=023] loss=0.8850 acc=71.54%
[TRAIN][ep=023] mask_avg: mc_mean=0.1990 mb_mean=0.4992 norm_overlap=0.9911 corr_cb=-0.4011
[EPOCH 023/089] train: loss=0.8850 acc=71.54% | val: loss=0.7600 acc=59.04% f1=67.92% auc=59.83% val_score=37.8171 val_score_bestthr=56.6206 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.199, mb=0.499, no=0.991, corr=-0.401) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 56.6206
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1590 mb_mean=0.5023 norm_overlap=0.9897 corr_cb=-0.4565 topkJ=0.0047
[TRAIN][ep=024] loss=0.8841 acc=71.95%
[TRAIN][ep=024] mask_avg: mc_mean=0.1805 mb_mean=0.4991 norm_overlap=0.9907 corr_cb=-0.3944
[EPOCH 024/089] train: loss=0.8841 acc=71.95% | val: loss=0.7486 acc=53.01% f1=68.80% auc=60.87% val_score=41.9371 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.180, mb=0.499, no=0.991, corr=-0.394) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 61.2320
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1585 mb_mean=0.4994 norm_overlap=0.9878 corr_cb=-0.4631 topkJ=0.0230
[TRAIN][ep=025] loss=0.8828 acc=71.95%
[TRAIN][ep=025] mask_avg: mc_mean=0.1908 mb_mean=0.4991 norm_overlap=0.9913 corr_cb=-0.3812
[EPOCH 025/089] train: loss=0.8828 acc=71.95% | val: loss=0.7389 acc=57.83% f1=67.89% auc=60.52% val_score=45.4522 val_score_bestthr=54.7859 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.191, mb=0.499, no=0.991, corr=-0.381) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 54.7859
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2946 mb_mean=0.4956 norm_overlap=0.9924 corr_cb=-0.4225 topkJ=0.0044
[TRAIN][ep=026] loss=0.8578 acc=72.21%
[TRAIN][ep=026] mask_avg: mc_mean=0.1872 mb_mean=0.4991 norm_overlap=0.9913 corr_cb=-0.3811
[EPOCH 026/089] train: loss=0.8578 acc=72.21% | val: loss=0.7853 acc=57.83% f1=67.29% auc=60.17% val_score=39.5040 val_score_bestthr=53.7146 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.187, mb=0.499, no=0.991, corr=-0.381) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 53.7146
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.0741 mb_mean=0.5030 norm_overlap=0.9925 corr_cb=-0.2671 topkJ=0.0213
[TRAIN][ep=027] loss=0.8666 acc=72.75%
[TRAIN][ep=027] mask_avg: mc_mean=0.1689 mb_mean=0.4991 norm_overlap=0.9914 corr_cb=-0.3501
[EPOCH 027/089] train: loss=0.8666 acc=72.75% | val: loss=0.7602 acc=51.81% f1=68.25% auc=61.45% val_score=46.5594 val_score_bestthr=62.0453 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.169, mb=0.499, no=0.991, corr=-0.350) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 62.0453
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1699 mb_mean=0.4994 norm_overlap=0.9903 corr_cb=-0.3711 topkJ=0.0063
[TRAIN][ep=028] loss=0.8561 acc=72.62%
[TRAIN][ep=028] mask_avg: mc_mean=0.1688 mb_mean=0.4991 norm_overlap=0.9918 corr_cb=-0.3407
[EPOCH 028/089] train: loss=0.8561 acc=72.62% | val: loss=0.7591 acc=56.63% f1=66.67% auc=61.16% val_score=40.5371 val_score_bestthr=53.6105 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.169, mb=0.499, no=0.992, corr=-0.341) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 53.6105
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2020 mb_mean=0.4979 norm_overlap=0.9915 corr_cb=-0.4100 topkJ=0.0057
[TRAIN][ep=029] loss=0.8402 acc=73.69%
[TRAIN][ep=029] mask_avg: mc_mean=0.1895 mb_mean=0.4991 norm_overlap=0.9925 corr_cb=-0.3342
[EPOCH 029/089] train: loss=0.8402 acc=73.69% | val: loss=0.8110 acc=53.01% f1=68.29% auc=61.40% val_score=43.1946 val_score_bestthr=56.7094 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.499, no=0.993, corr=-0.334) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 56.7094
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2328 mb_mean=0.4970 norm_overlap=0.9940 corr_cb=-0.3152 topkJ=0.0162
[TRAIN][ep=030] loss=0.8501 acc=73.83%
[TRAIN][ep=030] mask_avg: mc_mean=0.1769 mb_mean=0.4992 norm_overlap=0.9919 corr_cb=-0.3503
[EPOCH 030/089] train: loss=0.8501 acc=73.83% | val: loss=0.7854 acc=59.04% f1=67.31% auc=60.52% val_score=44.4606 val_score_bestthr=54.4446 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.177, mb=0.499, no=0.992, corr=-0.350) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 54.4446
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2329 mb_mean=0.4980 norm_overlap=0.9925 corr_cb=-0.3820 topkJ=0.0068
[TRAIN][ep=031] loss=0.8353 acc=73.83%
[TRAIN][ep=031] mask_avg: mc_mean=0.1840 mb_mean=0.4991 norm_overlap=0.9922 corr_cb=-0.3521
[EPOCH 031/089] train: loss=0.8353 acc=73.83% | val: loss=0.7757 acc=53.01% f1=68.80% auc=60.93% val_score=47.0490 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.184, mb=0.499, no=0.992, corr=-0.352) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 61.2320
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1589 mb_mean=0.4981 norm_overlap=0.9944 corr_cb=-0.2795 topkJ=0.0264
[TRAIN][ep=032] loss=0.8305 acc=75.03%
[TRAIN][ep=032] mask_avg: mc_mean=0.1844 mb_mean=0.4991 norm_overlap=0.9926 corr_cb=-0.3351
[EPOCH 032/089] train: loss=0.8305 acc=75.03% | val: loss=0.7754 acc=59.04% f1=66.00% auc=62.33% val_score=48.0709 val_score_bestthr=54.8824 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.184, mb=0.499, no=0.993, corr=-0.335) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 54.8824
[EARLY STOP] no improvement for 30 epochs. best_epoch=2
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/ckpt_best_fold_4.pt
=============== FIT DONE ===============
[BEST] epoch=2 | val_acc=51.81% | val_f1=68.25% | val_auc=56.69% | val_score=39.2574 | val_score_bestthr=62.0453
[TEST@BEST] thr_used=0.440 | acc=60.39% f1=68.94% auc=63.60% | SP_sex=11.96% EO_sex=8.72% SP_age=17.75% EO_age=11.68%
[TIME] 0.85 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/summary_fold_4.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4721 mb_mean=0.5002 norm_overlap=0.9999 corr_cb=-0.1647 topkJ=0.0157
[TRAIN][ep=000] loss=0.6977 acc=48.59%
[TRAIN][ep=000] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1975
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4770 mb_mean=0.4998 norm_overlap=0.9998 corr_cb=-0.3436 topkJ=0.0036
[TRAIN][ep=001] loss=0.6950 acc=49.53%
[TRAIN][ep=001] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1999
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4738 mb_mean=0.5016 norm_overlap=0.9996 corr_cb=-0.4790 topkJ=0.0004
[TRAIN][ep=002] loss=0.6930 acc=51.28%
[TRAIN][ep=002] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2027
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4776 mb_mean=0.5006 norm_overlap=0.9998 corr_cb=-0.3552 topkJ=0.0111
[TRAIN][ep=003] loss=0.6925 acc=52.75%
[TRAIN][ep=003] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2020
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4748 mb_mean=0.5000 norm_overlap=0.9999 corr_cb=-0.1629 topkJ=0.0285
[TRAIN][ep=004] loss=0.6906 acc=53.02%
[TRAIN][ep=004] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2047
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4745 mb_mean=0.4997 norm_overlap=0.9999 corr_cb=-0.1323 topkJ=0.0316
[TRAIN][ep=005] loss=0.6891 acc=55.03%
[TRAIN][ep=005] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1977
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4771 mb_mean=0.4972 norm_overlap=0.9998 corr_cb=-0.2743 topkJ=0.0103
[TRAIN][ep=006] loss=0.6856 acc=58.12%
[TRAIN][ep=006] mask_avg: mc_mean=0.4756 mb_mean=0.4992 norm_overlap=0.9999 corr_cb=-0.1986
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4738 mb_mean=0.4973 norm_overlap=0.9999 corr_cb=-0.1266 topkJ=0.0306
[TRAIN][ep=007] loss=0.6873 acc=57.05%
[TRAIN][ep=007] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2027
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4717 mb_mean=0.5007 norm_overlap=0.9998 corr_cb=-0.2901 topkJ=0.0142
[TRAIN][ep=008] loss=0.6822 acc=57.99%
[TRAIN][ep=008] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1953
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4772 mb_mean=0.5007 norm_overlap=0.9999 corr_cb=-0.2881 topkJ=0.0134
[TRAIN][ep=009] loss=0.6789 acc=58.39%
[TRAIN][ep=009] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1962
================= FIT START (fold=4) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4762 mb_mean=0.4988 norm_overlap=0.9999 corr_cb=-0.2022 topkJ=0.0282
[TRAIN][ep=000] loss=0.6748 acc=58.66%
[TRAIN][ep=000] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1983
[EPOCH 000/089] train: loss=0.6748 acc=58.66% | val: loss=0.6925 acc=54.22% f1=66.07% auc=54.65% val_score=42.1744 val_score_bestthr=54.9344 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.198) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 54.9344
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/ckpt_best_fold_4.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4752 mb_mean=0.4988 norm_overlap=0.9999 corr_cb=-0.2582 topkJ=0.0120
[TRAIN][ep=001] loss=0.6685 acc=60.67%
[TRAIN][ep=001] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2040
[EPOCH 001/089] train: loss=0.6685 acc=60.67% | val: loss=0.6889 acc=60.24% f1=61.18% auc=56.57% val_score=55.5611 val_score_bestthr=55.5611 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.204) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 54.9344 -> 55.5611
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/ckpt_best_fold_4.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4765 mb_mean=0.4979 norm_overlap=0.9999 corr_cb=-0.1296 topkJ=0.0093
[TRAIN][ep=002] loss=0.6655 acc=62.42%
[TRAIN][ep=002] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1937
[EPOCH 002/089] train: loss=0.6655 acc=62.42% | val: loss=0.6905 acc=51.81% f1=68.25% auc=56.69% val_score=39.2574 val_score_bestthr=62.0453 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.194) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 55.5611 -> 62.0453
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/ckpt_best_fold_4.pt
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4731 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2435 topkJ=0.0106
[TRAIN][ep=003] loss=0.6647 acc=60.40%
[TRAIN][ep=003] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2014
[EPOCH 003/089] train: loss=0.6647 acc=60.40% | val: loss=0.6858 acc=63.86% f1=61.54% auc=58.31% val_score=44.9148 val_score_bestthr=55.7466 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.201) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 55.7466
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4765 mb_mean=0.4969 norm_overlap=0.9999 corr_cb=-0.2336 topkJ=0.0250
[TRAIN][ep=004] loss=0.6589 acc=61.07%
[TRAIN][ep=004] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2016
[EPOCH 004/089] train: loss=0.6589 acc=61.07% | val: loss=0.6870 acc=59.04% f1=60.47% auc=57.85% val_score=51.3174 val_score_bestthr=54.2051 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.202) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 54.2051
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4758 mb_mean=0.4977 norm_overlap=0.9998 corr_cb=-0.3229 topkJ=0.0168
[TRAIN][ep=005] loss=1.2594 acc=61.34%
[TRAIN][ep=005] mask_avg: mc_mean=0.3384 mb_mean=0.4991 norm_overlap=0.9988 corr_cb=-0.2820
[EPOCH 005/089] train: loss=1.2594 acc=61.34% | val: loss=0.7040 acc=56.63% f1=67.27% auc=55.23% val_score=39.5814 val_score_bestthr=58.1693 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.338, mb=0.499, no=0.999, corr=-0.282) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 58.1693
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2252 mb_mean=0.5012 norm_overlap=0.9976 corr_cb=-0.3351 topkJ=0.0058
[TRAIN][ep=006] loss=1.2506 acc=62.28%
[TRAIN][ep=006] mask_avg: mc_mean=0.2151 mb_mean=0.4991 norm_overlap=0.9972 corr_cb=-0.2951
[EPOCH 006/089] train: loss=1.2506 acc=62.28% | val: loss=0.6857 acc=59.04% f1=63.04% auc=57.15% val_score=47.9992 val_score_bestthr=54.6053 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.215, mb=0.499, no=0.997, corr=-0.295) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 54.6053
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.1700 mb_mean=0.5002 norm_overlap=0.9949 corr_cb=-0.3985 topkJ=0.0056
[TRAIN][ep=007] loss=1.2457 acc=63.76%
[TRAIN][ep=007] mask_avg: mc_mean=0.1849 mb_mean=0.4991 norm_overlap=0.9962 corr_cb=-0.3235
[EPOCH 007/089] train: loss=1.2457 acc=63.76% | val: loss=0.6856 acc=59.04% f1=62.22% auc=57.62% val_score=46.8960 val_score_bestthr=53.7020 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.185, mb=0.499, no=0.996, corr=-0.324) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 53.7020
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2041 mb_mean=0.4990 norm_overlap=0.9957 corr_cb=-0.3803 topkJ=0.0106
[TRAIN][ep=008] loss=1.0433 acc=64.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.1686 mb_mean=0.4991 norm_overlap=0.9951 corr_cb=-0.3536
[EPOCH 008/089] train: loss=1.0433 acc=64.70% | val: loss=0.6971 acc=59.04% f1=56.41% auc=58.49% val_score=49.9497 val_score_bestthr=54.0879 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.169, mb=0.499, no=0.995, corr=-0.354) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 54.0879
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1502 mb_mean=0.4992 norm_overlap=0.9939 corr_cb=-0.4187 topkJ=0.0082
[TRAIN][ep=009] loss=0.8376 acc=63.89%
[TRAIN][ep=009] mask_avg: mc_mean=0.1700 mb_mean=0.4991 norm_overlap=0.9944 corr_cb=-0.3858
[EPOCH 009/089] train: loss=0.8376 acc=63.89% | val: loss=0.6863 acc=61.45% f1=64.44% auc=58.14% val_score=57.9526 val_score_bestthr=57.9526 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.170, mb=0.499, no=0.994, corr=-0.386) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 57.9526
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1393 mb_mean=0.5005 norm_overlap=0.9962 corr_cb=-0.2820 topkJ=0.0133
[TRAIN][ep=010] loss=0.8039 acc=63.22%
[TRAIN][ep=010] mask_avg: mc_mean=0.1692 mb_mean=0.4991 norm_overlap=0.9935 corr_cb=-0.4113
[EPOCH 010/089] train: loss=0.8039 acc=63.22% | val: loss=0.6859 acc=63.86% f1=65.91% auc=58.78% val_score=50.8338 val_score_bestthr=61.0074 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.169, mb=0.499, no=0.994, corr=-0.411) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 61.0074
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1386 mb_mean=0.5000 norm_overlap=0.9936 corr_cb=-0.4082 topkJ=0.0059
[TRAIN][ep=011] loss=0.7744 acc=64.83%
[TRAIN][ep=011] mask_avg: mc_mean=0.1620 mb_mean=0.4992 norm_overlap=0.9926 corr_cb=-0.4125
[EPOCH 011/089] train: loss=0.7744 acc=64.83% | val: loss=0.6924 acc=61.45% f1=64.44% auc=58.66% val_score=50.5952 val_score_bestthr=57.9526 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.162, mb=0.499, no=0.993, corr=-0.413) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 57.9526
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.2118 mb_mean=0.4969 norm_overlap=0.9959 corr_cb=-0.3125 topkJ=0.0126
[TRAIN][ep=012] loss=0.7711 acc=64.03%
[TRAIN][ep=012] mask_avg: mc_mean=0.1699 mb_mean=0.4991 norm_overlap=0.9922 corr_cb=-0.4091
[EPOCH 012/089] train: loss=0.7711 acc=64.03% | val: loss=0.6947 acc=62.65% f1=64.37% auc=58.43% val_score=55.9450 val_score_bestthr=57.6598 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.170, mb=0.499, no=0.992, corr=-0.409) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 57.6598
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1928 mb_mean=0.4960 norm_overlap=0.9928 corr_cb=-0.3944 topkJ=0.0028
[TRAIN][ep=013] loss=0.7585 acc=66.98%
[TRAIN][ep=013] mask_avg: mc_mean=0.1721 mb_mean=0.4991 norm_overlap=0.9918 corr_cb=-0.4079
[EPOCH 013/089] train: loss=0.7585 acc=66.98% | val: loss=0.7001 acc=61.45% f1=63.64% auc=57.91% val_score=55.1154 val_score_bestthr=57.0512 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.172, mb=0.499, no=0.992, corr=-0.408) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 57.0512
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1253 mb_mean=0.5003 norm_overlap=0.9916 corr_cb=-0.3451 topkJ=0.0059
[TRAIN][ep=014] loss=0.7536 acc=67.11%
[TRAIN][ep=014] mask_avg: mc_mean=0.1656 mb_mean=0.4991 norm_overlap=0.9910 corr_cb=-0.4137
[EPOCH 014/089] train: loss=0.7536 acc=67.11% | val: loss=0.7162 acc=63.86% f1=65.12% auc=59.59% val_score=49.0716 val_score_bestthr=57.8042 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.166, mb=0.499, no=0.991, corr=-0.414) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 57.8042
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.2105 mb_mean=0.4990 norm_overlap=0.9901 corr_cb=-0.5317 topkJ=0.0048
[TRAIN][ep=015] loss=0.7557 acc=65.23%
[TRAIN][ep=015] mask_avg: mc_mean=0.1742 mb_mean=0.4991 norm_overlap=0.9909 corr_cb=-0.4118
[EPOCH 015/089] train: loss=0.7557 acc=65.23% | val: loss=0.7120 acc=57.83% f1=67.29% auc=58.31% val_score=46.5120 val_score_bestthr=57.5872 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.174, mb=0.499, no=0.991, corr=-0.412) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 57.5872
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1285 mb_mean=0.5034 norm_overlap=0.9866 corr_cb=-0.4636 topkJ=0.0031
[TRAIN][ep=016] loss=0.7467 acc=65.10%
[TRAIN][ep=016] mask_avg: mc_mean=0.1786 mb_mean=0.4991 norm_overlap=0.9908 corr_cb=-0.4085
[EPOCH 016/089] train: loss=0.7467 acc=65.10% | val: loss=0.7027 acc=59.04% f1=68.52% auc=60.23% val_score=48.1555 val_score_bestthr=54.9295 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.179, mb=0.499, no=0.991, corr=-0.408) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 54.9295
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1948 mb_mean=0.4979 norm_overlap=0.9923 corr_cb=-0.3913 topkJ=0.0097
[TRAIN][ep=017] loss=0.7376 acc=68.99%
[TRAIN][ep=017] mask_avg: mc_mean=0.1802 mb_mean=0.4991 norm_overlap=0.9906 corr_cb=-0.4187
[EPOCH 017/089] train: loss=0.7376 acc=68.99% | val: loss=0.7208 acc=53.01% f1=68.80% auc=59.88% val_score=50.6610 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.180, mb=0.499, no=0.991, corr=-0.419) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 61.2320
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1896 mb_mean=0.5000 norm_overlap=0.9947 corr_cb=-0.2798 topkJ=0.0208
[TRAIN][ep=018] loss=0.7415 acc=68.19%
[TRAIN][ep=018] mask_avg: mc_mean=0.1910 mb_mean=0.4992 norm_overlap=0.9904 corr_cb=-0.4308
[EPOCH 018/089] train: loss=0.7415 acc=68.19% | val: loss=0.7272 acc=54.22% f1=69.35% auc=60.64% val_score=48.7317 val_score_bestthr=62.3371 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.191, mb=0.499, no=0.990, corr=-0.431) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 62.0453 -> 62.3371
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/ckpt_best_fold_4.pt
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.2409 mb_mean=0.4994 norm_overlap=0.9880 corr_cb=-0.5605 topkJ=0.0020
[TRAIN][ep=019] loss=0.8256 acc=66.98%
[TRAIN][ep=019] mask_avg: mc_mean=0.1844 mb_mean=0.4991 norm_overlap=0.9904 corr_cb=-0.4240
[EPOCH 019/089] train: loss=0.8256 acc=66.98% | val: loss=0.7070 acc=60.24% f1=69.16% auc=59.48% val_score=41.7189 val_score_bestthr=55.1029 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.184, mb=0.499, no=0.990, corr=-0.424) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 55.1029
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1546 mb_mean=0.4995 norm_overlap=0.9883 corr_cb=-0.4647 topkJ=0.0028
[TRAIN][ep=020] loss=0.8918 acc=69.93%
[TRAIN][ep=020] mask_avg: mc_mean=0.1743 mb_mean=0.4991 norm_overlap=0.9899 corr_cb=-0.4280
[EPOCH 020/089] train: loss=0.8918 acc=69.93% | val: loss=0.7414 acc=53.01% f1=68.80% auc=60.41% val_score=38.6501 val_score_bestthr=61.2320 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.174, mb=0.499, no=0.990, corr=-0.428) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 61.2320
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2396 mb_mean=0.4957 norm_overlap=0.9919 corr_cb=-0.4297 topkJ=0.0166
[TRAIN][ep=021] loss=0.9537 acc=71.01%
[TRAIN][ep=021] mask_avg: mc_mean=0.1836 mb_mean=0.4991 norm_overlap=0.9903 corr_cb=-0.4254
[EPOCH 021/089] train: loss=0.9537 acc=71.01% | val: loss=0.7404 acc=53.01% f1=68.80% auc=60.35% val_score=48.7317 val_score_bestthr=61.2320 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.184, mb=0.499, no=0.990, corr=-0.425) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 61.2320
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2158 mb_mean=0.4965 norm_overlap=0.9927 corr_cb=-0.3503 topkJ=0.0024
[TRAIN][ep=022] loss=1.0352 acc=68.46%
[TRAIN][ep=022] mask_avg: mc_mean=0.1745 mb_mean=0.4991 norm_overlap=0.9908 corr_cb=-0.3872
[EPOCH 022/089] train: loss=1.0352 acc=68.46% | val: loss=0.7247 acc=59.04% f1=67.92% auc=60.12% val_score=46.0541 val_score_bestthr=56.6206 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.174, mb=0.499, no=0.991, corr=-0.387) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 56.6206
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1820 mb_mean=0.4979 norm_overlap=0.9916 corr_cb=-0.4264 topkJ=0.0068
[TRAIN][ep=023] loss=1.0851 acc=71.95%
[TRAIN][ep=023] mask_avg: mc_mean=0.1936 mb_mean=0.4992 norm_overlap=0.9911 corr_cb=-0.4016
[EPOCH 023/089] train: loss=1.0851 acc=71.95% | val: loss=0.7424 acc=57.83% f1=67.29% auc=60.06% val_score=37.0992 val_score_bestthr=56.4480 | dyn(w_pfs=0.100, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.194, mb=0.499, no=0.991, corr=-0.402) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 56.4480
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1553 mb_mean=0.5023 norm_overlap=0.9896 corr_cb=-0.4581 topkJ=0.0043
[TRAIN][ep=024] loss=0.8940 acc=71.95%
[TRAIN][ep=024] mask_avg: mc_mean=0.1732 mb_mean=0.4991 norm_overlap=0.9908 corr_cb=-0.3846
[EPOCH 024/089] train: loss=0.8940 acc=71.95% | val: loss=0.7378 acc=53.01% f1=68.80% auc=60.70% val_score=39.0238 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.173, mb=0.499, no=0.991, corr=-0.385) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 61.2320
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1558 mb_mean=0.4994 norm_overlap=0.9878 corr_cb=-0.4606 topkJ=0.0234
[TRAIN][ep=025] loss=0.6961 acc=71.68%
[TRAIN][ep=025] mask_avg: mc_mean=0.1807 mb_mean=0.4991 norm_overlap=0.9915 corr_cb=-0.3646
[EPOCH 025/089] train: loss=0.6961 acc=71.68% | val: loss=0.7335 acc=53.01% f1=68.80% auc=60.93% val_score=43.9885 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.181, mb=0.499, no=0.992, corr=-0.365) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 61.2320
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2828 mb_mean=0.4956 norm_overlap=0.9926 corr_cb=-0.4047 topkJ=0.0044
[TRAIN][ep=026] loss=0.6735 acc=73.02%
[TRAIN][ep=026] mask_avg: mc_mean=0.1832 mb_mean=0.4991 norm_overlap=0.9917 corr_cb=-0.3609
[EPOCH 026/089] train: loss=0.6735 acc=73.02% | val: loss=0.7873 acc=53.01% f1=68.80% auc=60.06% val_score=43.7645 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.183, mb=0.499, no=0.992, corr=-0.361) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 61.2320
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.0695 mb_mean=0.5030 norm_overlap=0.9928 corr_cb=-0.2446 topkJ=0.0226
[TRAIN][ep=027] loss=0.6827 acc=72.62%
[TRAIN][ep=027] mask_avg: mc_mean=0.1624 mb_mean=0.4991 norm_overlap=0.9918 corr_cb=-0.3254
[EPOCH 027/089] train: loss=0.6827 acc=72.62% | val: loss=0.7632 acc=51.81% f1=68.25% auc=61.45% val_score=50.3966 val_score_bestthr=62.0453 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.162, mb=0.499, no=0.992, corr=-0.325) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 62.0453
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1624 mb_mean=0.4994 norm_overlap=0.9907 corr_cb=-0.3462 topkJ=0.0067
[TRAIN][ep=028] loss=0.6744 acc=72.08%
[TRAIN][ep=028] mask_avg: mc_mean=0.1647 mb_mean=0.4991 norm_overlap=0.9923 corr_cb=-0.3157
[EPOCH 028/089] train: loss=0.6744 acc=72.08% | val: loss=0.7536 acc=51.81% f1=68.25% auc=60.93% val_score=41.0743 val_score_bestthr=62.0453 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.165, mb=0.499, no=0.992, corr=-0.316) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 62.0453
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.1967 mb_mean=0.4979 norm_overlap=0.9918 corr_cb=-0.3890 topkJ=0.0066
[TRAIN][ep=029] loss=0.6591 acc=74.23%
[TRAIN][ep=029] mask_avg: mc_mean=0.1850 mb_mean=0.4991 norm_overlap=0.9930 corr_cb=-0.3097
[EPOCH 029/089] train: loss=0.6591 acc=74.23% | val: loss=0.8094 acc=53.01% f1=68.29% auc=61.22% val_score=41.6963 val_score_bestthr=56.7094 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.185, mb=0.499, no=0.993, corr=-0.310) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 56.7094
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2283 mb_mean=0.4970 norm_overlap=0.9945 corr_cb=-0.2836 topkJ=0.0196
[TRAIN][ep=030] loss=0.6702 acc=74.09%
[TRAIN][ep=030] mask_avg: mc_mean=0.1770 mb_mean=0.4992 norm_overlap=0.9925 corr_cb=-0.3229
[EPOCH 030/089] train: loss=0.6702 acc=74.09% | val: loss=0.7875 acc=57.83% f1=67.29% auc=60.99% val_score=42.7625 val_score_bestthr=56.2538 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.177, mb=0.499, no=0.993, corr=-0.323) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 56.2538
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2327 mb_mean=0.4980 norm_overlap=0.9932 corr_cb=-0.3485 topkJ=0.0093
[TRAIN][ep=031] loss=0.6565 acc=74.36%
[TRAIN][ep=031] mask_avg: mc_mean=0.1823 mb_mean=0.4991 norm_overlap=0.9927 corr_cb=-0.3240
[EPOCH 031/089] train: loss=0.6565 acc=74.36% | val: loss=0.7716 acc=59.04% f1=67.92% auc=61.16% val_score=47.0490 val_score_bestthr=56.6206 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.182, mb=0.499, no=0.993, corr=-0.324) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 56.6206
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1621 mb_mean=0.4981 norm_overlap=0.9949 corr_cb=-0.2550 topkJ=0.0297
[TRAIN][ep=032] loss=0.6527 acc=74.63%
[TRAIN][ep=032] mask_avg: mc_mean=0.1853 mb_mean=0.4991 norm_overlap=0.9932 corr_cb=-0.3091
[EPOCH 032/089] train: loss=0.6527 acc=74.63% | val: loss=0.7706 acc=59.04% f1=66.67% auc=62.03% val_score=46.5594 val_score_bestthr=54.6783 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.185, mb=0.499, no=0.993, corr=-0.309) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 54.6783
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2035 mb_mean=0.4969 norm_overlap=0.9927 corr_cb=-0.3497 topkJ=0.0126
[TRAIN][ep=033] loss=0.6340 acc=75.03%
[TRAIN][ep=033] mask_avg: mc_mean=0.1671 mb_mean=0.4991 norm_overlap=0.9935 corr_cb=-0.2754
[EPOCH 033/089] train: loss=0.6340 acc=75.03% | val: loss=0.7670 acc=57.83% f1=67.29% auc=62.56% val_score=47.3441 val_score_bestthr=55.1146 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.167, mb=0.499, no=0.994, corr=-0.275) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 55.1146
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2083 mb_mean=0.4955 norm_overlap=0.9953 corr_cb=-0.2158 topkJ=0.0264
[TRAIN][ep=034] loss=0.6293 acc=76.64%
[TRAIN][ep=034] mask_avg: mc_mean=0.1774 mb_mean=0.4991 norm_overlap=0.9936 corr_cb=-0.2813
[EPOCH 034/089] train: loss=0.6293 acc=76.64% | val: loss=0.7837 acc=60.24% f1=67.33% auc=62.85% val_score=46.5594 val_score_bestthr=56.1880 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.177, mb=0.499, no=0.994, corr=-0.281) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 56.1880
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.1599 mb_mean=0.4987 norm_overlap=0.9952 corr_cb=-0.2029 topkJ=0.0240
[TRAIN][ep=035] loss=0.6235 acc=76.11%
[TRAIN][ep=035] mask_avg: mc_mean=0.1884 mb_mean=0.4991 norm_overlap=0.9938 corr_cb=-0.2886
[EPOCH 035/089] train: loss=0.6235 acc=76.11% | val: loss=0.7831 acc=51.81% f1=68.25% auc=61.34% val_score=52.9260 val_score_bestthr=62.0453 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.188, mb=0.499, no=0.994, corr=-0.289) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 62.0453
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2160 mb_mean=0.4963 norm_overlap=0.9967 corr_cb=-0.1772 topkJ=0.0288
[TRAIN][ep=036] loss=0.6279 acc=76.38%
[TRAIN][ep=036] mask_avg: mc_mean=0.2005 mb_mean=0.4991 norm_overlap=0.9943 corr_cb=-0.2706
[EPOCH 036/089] train: loss=0.6279 acc=76.38% | val: loss=0.7837 acc=53.01% f1=68.80% auc=62.21% val_score=44.7395 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.201, mb=0.499, no=0.994, corr=-0.271) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 61.2320
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1460 mb_mean=0.4991 norm_overlap=0.9961 corr_cb=-0.1543 topkJ=0.0465
[TRAIN][ep=037] loss=0.6164 acc=77.18%
[TRAIN][ep=037] mask_avg: mc_mean=0.1899 mb_mean=0.4991 norm_overlap=0.9943 corr_cb=-0.2622
[EPOCH 037/089] train: loss=0.6164 acc=77.18% | val: loss=0.7820 acc=56.63% f1=67.27% auc=62.15% val_score=46.0729 val_score_bestthr=56.8023 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.499, no=0.994, corr=-0.262) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 56.8023
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.1773 mb_mean=0.4984 norm_overlap=0.9945 corr_cb=-0.2537 topkJ=0.0087
[TRAIN][ep=038] loss=0.6023 acc=77.45%
[TRAIN][ep=038] mask_avg: mc_mean=0.2007 mb_mean=0.4991 norm_overlap=0.9940 corr_cb=-0.2795
[EPOCH 038/089] train: loss=0.6023 acc=77.45% | val: loss=0.7782 acc=56.63% f1=67.86% auc=61.86% val_score=54.5168 val_score_bestthr=55.8035 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.201, mb=0.499, no=0.994, corr=-0.280) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 55.8035
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2420 mb_mean=0.4963 norm_overlap=0.9980 corr_cb=-0.1290 topkJ=0.0424
[TRAIN][ep=039] loss=0.5978 acc=77.72%
[TRAIN][ep=039] mask_avg: mc_mean=0.2085 mb_mean=0.4991 norm_overlap=0.9942 corr_cb=-0.2778
[EPOCH 039/089] train: loss=0.5978 acc=77.72% | val: loss=0.7844 acc=65.06% f1=65.06% auc=62.15% val_score=46.2176 val_score_bestthr=57.3770 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.208, mb=0.499, no=0.994, corr=-0.278) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 57.3770
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.1951 mb_mean=0.4988 norm_overlap=0.9927 corr_cb=-0.3263 topkJ=0.0166
[TRAIN][ep=040] loss=0.5891 acc=80.27%
[TRAIN][ep=040] mask_avg: mc_mean=0.2098 mb_mean=0.4992 norm_overlap=0.9948 corr_cb=-0.2517
[EPOCH 040/089] train: loss=0.5891 acc=80.27% | val: loss=0.8214 acc=55.42% f1=67.26% auc=62.33% val_score=47.9401 val_score_bestthr=55.5700 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.210, mb=0.499, no=0.995, corr=-0.252) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 55.5700
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.1634 mb_mean=0.5002 norm_overlap=0.9963 corr_cb=-0.2027 topkJ=0.0289
[TRAIN][ep=041] loss=0.5804 acc=79.73%
[TRAIN][ep=041] mask_avg: mc_mean=0.2048 mb_mean=0.4991 norm_overlap=0.9948 corr_cb=-0.2392
[EPOCH 041/089] train: loss=0.5804 acc=79.73% | val: loss=0.8341 acc=61.45% f1=68.63% auc=62.67% val_score=43.6760 val_score_bestthr=56.5679 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.205, mb=0.499, no=0.995, corr=-0.239) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 56.5679
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.1284 mb_mean=0.4995 norm_overlap=0.9937 corr_cb=-0.2928 topkJ=0.0057
[TRAIN][ep=042] loss=0.5720 acc=79.33%
[TRAIN][ep=042] mask_avg: mc_mean=0.2083 mb_mean=0.4991 norm_overlap=0.9942 corr_cb=-0.2654
[EPOCH 042/089] train: loss=0.5720 acc=79.33% | val: loss=0.8525 acc=63.86% f1=64.29% auc=62.73% val_score=42.5229 val_score_bestthr=55.8501 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.208, mb=0.499, no=0.994, corr=-0.265) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 55.8501
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.1629 mb_mean=0.4981 norm_overlap=0.9960 corr_cb=-0.1649 topkJ=0.0306
[TRAIN][ep=043] loss=0.5626 acc=80.27%
[TRAIN][ep=043] mask_avg: mc_mean=0.1950 mb_mean=0.4991 norm_overlap=0.9941 corr_cb=-0.2597
[EPOCH 043/089] train: loss=0.5626 acc=80.27% | val: loss=0.8745 acc=62.65% f1=69.90% auc=62.67% val_score=45.8226 val_score_bestthr=55.7453 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.195, mb=0.499, no=0.994, corr=-0.260) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.3371 -> 55.7453
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2417 mb_mean=0.4991 norm_overlap=0.9945 corr_cb=-0.2684 topkJ=0.0184
[TRAIN][ep=044] loss=0.5685 acc=80.81%
[TRAIN][ep=044] mask_avg: mc_mean=0.2158 mb_mean=0.4991 norm_overlap=0.9946 corr_cb=-0.2547
[EPOCH 044/089] train: loss=0.5685 acc=80.81% | val: loss=0.8077 acc=55.42% f1=69.92% auc=62.44% val_score=54.3260 val_score_bestthr=63.8324 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.216, mb=0.499, no=0.995, corr=-0.255) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 62.3371 -> 63.8324
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/ckpt_best_fold_4.pt
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2095 mb_mean=0.4983 norm_overlap=0.9958 corr_cb=-0.2326 topkJ=0.0209
[TRAIN][ep=045] loss=0.6264 acc=80.40%
[TRAIN][ep=045] mask_avg: mc_mean=0.2120 mb_mean=0.4991 norm_overlap=0.9944 corr_cb=-0.2566
[EPOCH 045/089] train: loss=0.6264 acc=80.40% | val: loss=0.8115 acc=55.42% f1=69.92% auc=63.02% val_score=55.8501 val_score_bestthr=63.8324 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.212, mb=0.499, no=0.994, corr=-0.257) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 63.8324
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.1592 mb_mean=0.4995 norm_overlap=0.9940 corr_cb=-0.2221 topkJ=0.0192
[TRAIN][ep=046] loss=0.6964 acc=81.34%
[TRAIN][ep=046] mask_avg: mc_mean=0.2079 mb_mean=0.4991 norm_overlap=0.9943 corr_cb=-0.2553
[EPOCH 046/089] train: loss=0.6964 acc=81.34% | val: loss=0.8157 acc=55.42% f1=67.26% auc=62.73% val_score=47.9401 val_score_bestthr=55.8811 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.208, mb=0.499, no=0.994, corr=-0.255) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 55.8811
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.3053 mb_mean=0.4995 norm_overlap=0.9957 corr_cb=-0.2515 topkJ=0.0086
[TRAIN][ep=047] loss=0.7656 acc=81.61%
[TRAIN][ep=047] mask_avg: mc_mean=0.2117 mb_mean=0.4992 norm_overlap=0.9939 corr_cb=-0.2712
[EPOCH 047/089] train: loss=0.7656 acc=81.61% | val: loss=0.8404 acc=65.06% f1=66.67% auc=63.90% val_score=42.5229 val_score_bestthr=56.3303 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.212, mb=0.499, no=0.994, corr=-0.271) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.3303
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.1514 mb_mean=0.5025 norm_overlap=0.9933 corr_cb=-0.3026 topkJ=0.0079
[TRAIN][ep=048] loss=0.8344 acc=82.28%
[TRAIN][ep=048] mask_avg: mc_mean=0.2006 mb_mean=0.4991 norm_overlap=0.9939 corr_cb=-0.2618
[EPOCH 048/089] train: loss=0.8344 acc=82.28% | val: loss=0.8145 acc=61.45% f1=63.64% auc=63.02% val_score=53.8470 val_score_bestthr=56.0905 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.201, mb=0.499, no=0.994, corr=-0.262) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.0905
[DBG][ep=049] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.2471 mb_mean=0.4992 norm_overlap=0.9937 corr_cb=-0.2835 topkJ=0.0142
[TRAIN][ep=049] loss=0.9152 acc=82.01%
[TRAIN][ep=049] mask_avg: mc_mean=0.2258 mb_mean=0.4991 norm_overlap=0.9939 corr_cb=-0.2827
[EPOCH 049/089] train: loss=0.9152 acc=82.01% | val: loss=0.8207 acc=54.22% f1=67.80% auc=63.31% val_score=53.9542 val_score_bestthr=56.0066 | dyn(w_pfs=0.100, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.226, mb=0.499, no=0.994, corr=-0.283) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.0066
[DBG][ep=050] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.1817 mb_mean=0.5005 norm_overlap=0.9924 corr_cb=-0.3445 topkJ=0.0211
[TRAIN][ep=050] loss=0.5244 acc=85.37%
[TRAIN][ep=050] mask_avg: mc_mean=0.2030 mb_mean=0.4991 norm_overlap=0.9936 corr_cb=-0.2793
[EPOCH 050/089] train: loss=0.5244 acc=85.37% | val: loss=0.8292 acc=55.42% f1=67.83% auc=62.91% val_score=52.6715 val_score_bestthr=59.7749 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.203, mb=0.499, no=0.994, corr=-0.279) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 59.7749
[DBG][ep=051] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.2544 mb_mean=0.4959 norm_overlap=0.9952 corr_cb=-0.2241 topkJ=0.0203
[TRAIN][ep=051] loss=0.5029 acc=84.70%
[TRAIN][ep=051] mask_avg: mc_mean=0.2030 mb_mean=0.4991 norm_overlap=0.9937 corr_cb=-0.2768
[EPOCH 051/089] train: loss=0.5029 acc=84.70% | val: loss=0.8363 acc=65.06% f1=65.06% auc=62.91% val_score=55.8501 val_score_bestthr=57.3770 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.203, mb=0.499, no=0.994, corr=-0.277) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 57.3770
[DBG][ep=052] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.2119 mb_mean=0.4993 norm_overlap=0.9932 corr_cb=-0.3155 topkJ=0.0095
[TRAIN][ep=052] loss=0.5027 acc=83.89%
[TRAIN][ep=052] mask_avg: mc_mean=0.2030 mb_mean=0.4991 norm_overlap=0.9935 corr_cb=-0.2823
[EPOCH 052/089] train: loss=0.5027 acc=83.89% | val: loss=0.8518 acc=54.22% f1=67.80% auc=63.14% val_score=55.1804 val_score_bestthr=56.0066 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.203, mb=0.499, no=0.994, corr=-0.282) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.0066
[DBG][ep=053] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.2333 mb_mean=0.4968 norm_overlap=0.9946 corr_cb=-0.2385 topkJ=0.0181
[TRAIN][ep=053] loss=0.4990 acc=84.43%
[TRAIN][ep=053] mask_avg: mc_mean=0.2030 mb_mean=0.4991 norm_overlap=0.9936 corr_cb=-0.2777
[EPOCH 053/089] train: loss=0.4990 acc=84.43% | val: loss=0.8580 acc=54.22% f1=67.80% auc=63.49% val_score=55.1804 val_score_bestthr=56.0066 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.203, mb=0.499, no=0.994, corr=-0.278) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.0066
[DBG][ep=054] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=054] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=054] mask(step0): mc_mean=0.1593 mb_mean=0.5002 norm_overlap=0.9941 corr_cb=-0.2123 topkJ=0.0148
[TRAIN][ep=054] loss=0.4986 acc=84.83%
[TRAIN][ep=054] mask_avg: mc_mean=0.2030 mb_mean=0.4991 norm_overlap=0.9937 corr_cb=-0.2781
[EPOCH 054/089] train: loss=0.4986 acc=84.83% | val: loss=0.8610 acc=54.22% f1=67.80% auc=62.91% val_score=53.9542 val_score_bestthr=56.0066 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.203, mb=0.499, no=0.994, corr=-0.278) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.0066
[DBG][ep=055] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=055] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=055] mask(step0): mc_mean=0.1763 mb_mean=0.5003 norm_overlap=0.9965 corr_cb=-0.1761 topkJ=0.0305
[TRAIN][ep=055] loss=0.4945 acc=84.56%
[TRAIN][ep=055] mask_avg: mc_mean=0.2030 mb_mean=0.4991 norm_overlap=0.9936 corr_cb=-0.2807
[EPOCH 055/089] train: loss=0.4945 acc=84.56% | val: loss=0.8810 acc=54.22% f1=67.80% auc=63.20% val_score=52.0121 val_score_bestthr=56.0066 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.203, mb=0.499, no=0.994, corr=-0.281) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.0066
[DBG][ep=056] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=056] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=056] mask(step0): mc_mean=0.1821 mb_mean=0.5005 norm_overlap=0.9948 corr_cb=-0.2433 topkJ=0.0137
[TRAIN][ep=056] loss=0.4937 acc=84.97%
[TRAIN][ep=056] mask_avg: mc_mean=0.2030 mb_mean=0.4991 norm_overlap=0.9936 corr_cb=-0.2780
[EPOCH 056/089] train: loss=0.4937 acc=84.97% | val: loss=0.8681 acc=54.22% f1=67.80% auc=62.85% val_score=53.9542 val_score_bestthr=56.0066 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.203, mb=0.499, no=0.994, corr=-0.278) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.0066
[DBG][ep=057] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=057] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=057] mask(step0): mc_mean=0.2070 mb_mean=0.4965 norm_overlap=0.9934 corr_cb=-0.3360 topkJ=0.0060
[TRAIN][ep=057] loss=0.4950 acc=84.03%
[TRAIN][ep=057] mask_avg: mc_mean=0.2030 mb_mean=0.4992 norm_overlap=0.9936 corr_cb=-0.2778
[EPOCH 057/089] train: loss=0.4950 acc=84.03% | val: loss=0.8835 acc=66.27% f1=64.10% auc=63.31% val_score=56.5322 val_score_bestthr=56.5322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.203, mb=0.499, no=0.994, corr=-0.278) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.5322
[DBG][ep=058] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=058] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=058] mask(step0): mc_mean=0.2019 mb_mean=0.4978 norm_overlap=0.9974 corr_cb=-0.1260 topkJ=0.0283
[TRAIN][ep=058] loss=0.4913 acc=85.10%
[TRAIN][ep=058] mask_avg: mc_mean=0.2029 mb_mean=0.4991 norm_overlap=0.9936 corr_cb=-0.2779
[EPOCH 058/089] train: loss=0.4913 acc=85.10% | val: loss=0.8900 acc=54.22% f1=67.80% auc=63.02% val_score=51.9429 val_score_bestthr=56.0066 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.203, mb=0.499, no=0.994, corr=-0.278) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.0066
[DBG][ep=059] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=059] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=059] mask(step0): mc_mean=0.2038 mb_mean=0.4995 norm_overlap=0.9948 corr_cb=-0.2940 topkJ=0.0180
[TRAIN][ep=059] loss=0.4892 acc=85.10%
[TRAIN][ep=059] mask_avg: mc_mean=0.2029 mb_mean=0.4991 norm_overlap=0.9936 corr_cb=-0.2791
[EPOCH 059/089] train: loss=0.4892 acc=85.10% | val: loss=0.8859 acc=54.22% f1=67.80% auc=62.79% val_score=55.6273 val_score_bestthr=56.0066 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.203, mb=0.499, no=0.994, corr=-0.279) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.0066
[DBG][ep=060] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=060] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=060] mask(step0): mc_mean=0.1845 mb_mean=0.4997 norm_overlap=0.9963 corr_cb=-0.2380 topkJ=0.0259
[TRAIN][ep=060] loss=0.4860 acc=85.77%
[TRAIN][ep=060] mask_avg: mc_mean=0.2030 mb_mean=0.4991 norm_overlap=0.9937 corr_cb=-0.2759
[EPOCH 060/089] train: loss=0.4860 acc=85.77% | val: loss=0.8933 acc=66.27% f1=64.10% auc=63.08% val_score=56.5322 val_score_bestthr=56.5322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.203, mb=0.499, no=0.994, corr=-0.276) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.5322
[DBG][ep=061] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=061] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=061] mask(step0): mc_mean=0.2074 mb_mean=0.4977 norm_overlap=0.9930 corr_cb=-0.3213 topkJ=0.0113
[TRAIN][ep=061] loss=0.4888 acc=85.10%
[TRAIN][ep=061] mask_avg: mc_mean=0.2029 mb_mean=0.4991 norm_overlap=0.9936 corr_cb=-0.2794
[EPOCH 061/089] train: loss=0.4888 acc=85.10% | val: loss=0.8966 acc=66.27% f1=64.10% auc=63.08% val_score=56.5322 val_score_bestthr=56.5322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.203, mb=0.499, no=0.994, corr=-0.279) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.5322
[DBG][ep=062] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=062] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=062] mask(step0): mc_mean=0.2305 mb_mean=0.4994 norm_overlap=0.9936 corr_cb=-0.2772 topkJ=0.0099
[TRAIN][ep=062] loss=0.4882 acc=84.97%
[TRAIN][ep=062] mask_avg: mc_mean=0.2030 mb_mean=0.4991 norm_overlap=0.9937 corr_cb=-0.2776
[EPOCH 062/089] train: loss=0.4882 acc=84.97% | val: loss=0.8951 acc=66.27% f1=64.10% auc=62.73% val_score=55.4116 val_score_bestthr=56.5322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.203, mb=0.499, no=0.994, corr=-0.278) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.5322
[DBG][ep=063] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=063] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=063] mask(step0): mc_mean=0.2306 mb_mean=0.4970 norm_overlap=0.9968 corr_cb=-0.1862 topkJ=0.0367
[TRAIN][ep=063] loss=0.4854 acc=85.23%
[TRAIN][ep=063] mask_avg: mc_mean=0.2029 mb_mean=0.4992 norm_overlap=0.9936 corr_cb=-0.2783
[EPOCH 063/089] train: loss=0.4854 acc=85.23% | val: loss=0.9012 acc=66.27% f1=64.10% auc=62.79% val_score=56.5322 val_score_bestthr=56.5322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.203, mb=0.499, no=0.994, corr=-0.278) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.5322
[DBG][ep=064] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=064] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=064] mask(step0): mc_mean=0.2343 mb_mean=0.4982 norm_overlap=0.9903 corr_cb=-0.4583 topkJ=0.0040
[TRAIN][ep=064] loss=0.4846 acc=85.10%
[TRAIN][ep=064] mask_avg: mc_mean=0.2030 mb_mean=0.4991 norm_overlap=0.9937 corr_cb=-0.2785
[EPOCH 064/089] train: loss=0.4846 acc=85.10% | val: loss=0.9181 acc=61.45% f1=61.90% auc=62.97% val_score=52.2254 val_score_bestthr=57.1184 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.203, mb=0.499, no=0.994, corr=-0.278) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 57.1184
[DBG][ep=065] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=065] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=065] mask(step0): mc_mean=0.2080 mb_mean=0.4994 norm_overlap=0.9921 corr_cb=-0.3309 topkJ=0.0160
[TRAIN][ep=065] loss=0.4824 acc=84.70%
[TRAIN][ep=065] mask_avg: mc_mean=0.2030 mb_mean=0.4991 norm_overlap=0.9936 corr_cb=-0.2786
[EPOCH 065/089] train: loss=0.4824 acc=84.70% | val: loss=0.9267 acc=66.27% f1=64.10% auc=62.73% val_score=52.0121 val_score_bestthr=56.5322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.203, mb=0.499, no=0.994, corr=-0.279) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.5322
[DBG][ep=066] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=066] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=066] mask(step0): mc_mean=0.1918 mb_mean=0.5017 norm_overlap=0.9898 corr_cb=-0.4211 topkJ=0.0087
[TRAIN][ep=066] loss=0.4830 acc=84.83%
[TRAIN][ep=066] mask_avg: mc_mean=0.2029 mb_mean=0.4991 norm_overlap=0.9936 corr_cb=-0.2791
[EPOCH 066/089] train: loss=0.4830 acc=84.83% | val: loss=0.8991 acc=55.42% f1=68.38% auc=62.50% val_score=54.2415 val_score_bestthr=56.2140 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.203, mb=0.499, no=0.994, corr=-0.279) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.2140
[DBG][ep=067] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=067] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=067] mask(step0): mc_mean=0.2052 mb_mean=0.4992 norm_overlap=0.9948 corr_cb=-0.2677 topkJ=0.0119
[TRAIN][ep=067] loss=0.4812 acc=84.83%
[TRAIN][ep=067] mask_avg: mc_mean=0.2030 mb_mean=0.4991 norm_overlap=0.9936 corr_cb=-0.2806
[EPOCH 067/089] train: loss=0.4812 acc=84.83% | val: loss=0.8998 acc=54.22% f1=67.80% auc=62.38% val_score=54.5126 val_score_bestthr=56.0066 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.203, mb=0.499, no=0.994, corr=-0.281) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.0066
[DBG][ep=068] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=068] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=068] mask(step0): mc_mean=0.2475 mb_mean=0.4973 norm_overlap=0.9946 corr_cb=-0.2538 topkJ=0.0109
[TRAIN][ep=068] loss=0.4759 acc=85.77%
[TRAIN][ep=068] mask_avg: mc_mean=0.2030 mb_mean=0.4991 norm_overlap=0.9936 corr_cb=-0.2796
[EPOCH 068/089] train: loss=0.4759 acc=85.77% | val: loss=0.9029 acc=54.22% f1=67.80% auc=62.62% val_score=55.6273 val_score_bestthr=56.0066 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.203, mb=0.499, no=0.994, corr=-0.280) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 56.0066
[DBG][ep=069] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=069] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=069] mask(step0): mc_mean=0.2022 mb_mean=0.4983 norm_overlap=0.9925 corr_cb=-0.2797 topkJ=0.0047
[TRAIN][ep=069] loss=0.4742 acc=86.04%
[TRAIN][ep=069] mask_avg: mc_mean=0.2029 mb_mean=0.4991 norm_overlap=0.9936 corr_cb=-0.2795
[EPOCH 069/089] train: loss=0.4742 acc=86.04% | val: loss=0.9079 acc=61.45% f1=61.90% auc=62.44% val_score=55.6273 val_score_bestthr=57.1184 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.203, mb=0.499, no=0.994, corr=-0.279) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 57.1184
[DBG][ep=070] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=070] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=070] mask(step0): mc_mean=0.2010 mb_mean=0.4984 norm_overlap=0.9971 corr_cb=-0.1445 topkJ=0.0158
[TRAIN][ep=070] loss=0.4752 acc=85.64%
[TRAIN][ep=070] mask_avg: mc_mean=0.2030 mb_mean=0.4991 norm_overlap=0.9936 corr_cb=-0.2799
[EPOCH 070/089] train: loss=0.4752 acc=85.64% | val: loss=0.9117 acc=61.45% f1=61.90% auc=62.50% val_score=55.6273 val_score_bestthr=57.1184 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.203, mb=0.499, no=0.994, corr=-0.280) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 57.1184
[DBG][ep=071] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=071] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=071] mask(step0): mc_mean=0.2091 mb_mean=0.4984 norm_overlap=0.9950 corr_cb=-0.2256 topkJ=0.0088
[TRAIN][ep=071] loss=0.4784 acc=84.97%
[TRAIN][ep=071] mask_avg: mc_mean=0.2030 mb_mean=0.4991 norm_overlap=0.9936 corr_cb=-0.2785
[EPOCH 071/089] train: loss=0.4784 acc=84.97% | val: loss=0.9164 acc=61.45% f1=61.90% auc=62.62% val_score=55.6273 val_score_bestthr=57.1184 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.203, mb=0.499, no=0.994, corr=-0.278) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 57.1184
[DBG][ep=072] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=072] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=072] mask(step0): mc_mean=0.2324 mb_mean=0.4976 norm_overlap=0.9919 corr_cb=-0.3357 topkJ=0.0074
[TRAIN][ep=072] loss=0.4736 acc=85.37%
[TRAIN][ep=072] mask_avg: mc_mean=0.2030 mb_mean=0.4991 norm_overlap=0.9937 corr_cb=-0.2771
[EPOCH 072/089] train: loss=0.4736 acc=85.37% | val: loss=0.9118 acc=61.45% f1=61.90% auc=62.56% val_score=53.1034 val_score_bestthr=57.1184 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.203, mb=0.499, no=0.994, corr=-0.277) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 57.1184
[DBG][ep=073] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=073] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=073] mask(step0): mc_mean=0.1791 mb_mean=0.5004 norm_overlap=0.9938 corr_cb=-0.3087 topkJ=0.0083
[TRAIN][ep=073] loss=0.4779 acc=85.23%
[TRAIN][ep=073] mask_avg: mc_mean=0.2030 mb_mean=0.4991 norm_overlap=0.9936 corr_cb=-0.2799
[EPOCH 073/089] train: loss=0.4779 acc=85.23% | val: loss=0.9162 acc=61.45% f1=61.90% auc=62.33% val_score=55.6273 val_score_bestthr=57.1184 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.203, mb=0.499, no=0.994, corr=-0.280) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 57.1184
[DBG][ep=074] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=074] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=074] mask(step0): mc_mean=0.2296 mb_mean=0.4964 norm_overlap=0.9910 corr_cb=-0.3650 topkJ=0.0093
[TRAIN][ep=074] loss=0.4746 acc=85.23%
[TRAIN][ep=074] mask_avg: mc_mean=0.2030 mb_mean=0.4991 norm_overlap=0.9936 corr_cb=-0.2789
[EPOCH 074/089] train: loss=0.4746 acc=85.23% | val: loss=0.9187 acc=61.45% f1=61.90% auc=62.33% val_score=55.6273 val_score_bestthr=57.1184 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.203, mb=0.499, no=0.994, corr=-0.279) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8324 -> 57.1184
[EARLY STOP] no improvement for 30 epochs. best_epoch=44
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/ckpt_best_fold_4.pt
=============== FIT DONE ===============
[BEST] epoch=44 | val_acc=55.42% | val_f1=69.92% | val_auc=62.44% | val_score=54.3260 | val_score_bestthr=63.8324
[TEST@BEST] thr_used=0.385 | acc=72.46% f1=77.65% auc=75.85% | SP_sex=11.96% EO_sex=7.69% SP_age=25.15% EO_age=21.05%
[TIME] 1.85 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/summary_fold_4.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4721 mb_mean=0.5002 norm_overlap=0.9999 corr_cb=-0.1647 topkJ=0.0157
[TRAIN][ep=000] loss=0.6977 acc=48.59%
[TRAIN][ep=000] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1975
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4770 mb_mean=0.4998 norm_overlap=0.9998 corr_cb=-0.3436 topkJ=0.0036
[TRAIN][ep=001] loss=0.6950 acc=49.53%
[TRAIN][ep=001] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1999
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4738 mb_mean=0.5016 norm_overlap=0.9996 corr_cb=-0.4790 topkJ=0.0004
[TRAIN][ep=002] loss=0.6930 acc=51.28%
[TRAIN][ep=002] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2027
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4776 mb_mean=0.5006 norm_overlap=0.9998 corr_cb=-0.3552 topkJ=0.0111
[TRAIN][ep=003] loss=0.6925 acc=52.75%
[TRAIN][ep=003] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2020
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4748 mb_mean=0.5000 norm_overlap=0.9999 corr_cb=-0.1629 topkJ=0.0285
[TRAIN][ep=004] loss=0.6906 acc=53.02%
[TRAIN][ep=004] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2047
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4745 mb_mean=0.4997 norm_overlap=0.9999 corr_cb=-0.1323 topkJ=0.0316
[TRAIN][ep=005] loss=0.6891 acc=55.03%
[TRAIN][ep=005] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1977
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4771 mb_mean=0.4972 norm_overlap=0.9998 corr_cb=-0.2743 topkJ=0.0103
[TRAIN][ep=006] loss=0.6856 acc=58.12%
[TRAIN][ep=006] mask_avg: mc_mean=0.4756 mb_mean=0.4992 norm_overlap=0.9999 corr_cb=-0.1986
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4738 mb_mean=0.4973 norm_overlap=0.9999 corr_cb=-0.1266 topkJ=0.0306
[TRAIN][ep=007] loss=0.6873 acc=57.05%
[TRAIN][ep=007] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2027
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4717 mb_mean=0.5007 norm_overlap=0.9998 corr_cb=-0.2901 topkJ=0.0142
[TRAIN][ep=008] loss=0.6822 acc=57.99%
[TRAIN][ep=008] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1953
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4772 mb_mean=0.5007 norm_overlap=0.9999 corr_cb=-0.2881 topkJ=0.0134
[TRAIN][ep=009] loss=0.6789 acc=58.39%
[TRAIN][ep=009] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1962
================= FIT START (fold=4) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4762 mb_mean=0.4988 norm_overlap=0.9999 corr_cb=-0.2022 topkJ=0.0282
[TRAIN][ep=000] loss=0.6748 acc=58.66%
[TRAIN][ep=000] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1983
[EPOCH 000/089] train: loss=0.6748 acc=58.66% | val: loss=0.6925 acc=54.22% f1=66.07% auc=54.71% val_score=42.1744 val_score_bestthr=54.9344 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.198) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 54.9344
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/ckpt_best_fold_4.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4752 mb_mean=0.4988 norm_overlap=0.9999 corr_cb=-0.2582 topkJ=0.0120
[TRAIN][ep=001] loss=0.6685 acc=60.67%
[TRAIN][ep=001] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2040
[EPOCH 001/089] train: loss=0.6685 acc=60.67% | val: loss=0.6890 acc=60.24% f1=61.18% auc=56.57% val_score=55.5611 val_score_bestthr=55.5611 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.204) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 54.9344 -> 55.5611
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/ckpt_best_fold_4.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4765 mb_mean=0.4979 norm_overlap=0.9999 corr_cb=-0.1296 topkJ=0.0093
[TRAIN][ep=002] loss=0.6655 acc=62.42%
[TRAIN][ep=002] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.1937
[EPOCH 002/089] train: loss=0.6655 acc=62.42% | val: loss=0.6905 acc=51.81% f1=68.25% auc=56.69% val_score=39.2574 val_score_bestthr=62.0453 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.194) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 55.5611 -> 62.0453
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/ckpt_best_fold_4.pt
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4731 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2435 topkJ=0.0106
[TRAIN][ep=003] loss=0.6647 acc=60.40%
[TRAIN][ep=003] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2014
[EPOCH 003/089] train: loss=0.6647 acc=60.40% | val: loss=0.6858 acc=63.86% f1=61.54% auc=58.31% val_score=44.9148 val_score_bestthr=55.7466 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.201) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 55.7466
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4765 mb_mean=0.4969 norm_overlap=0.9999 corr_cb=-0.2336 topkJ=0.0250
[TRAIN][ep=004] loss=0.6589 acc=61.07%
[TRAIN][ep=004] mask_avg: mc_mean=0.4756 mb_mean=0.4991 norm_overlap=0.9999 corr_cb=-0.2016
[EPOCH 004/089] train: loss=0.6589 acc=61.07% | val: loss=0.6870 acc=59.04% f1=60.47% auc=57.85% val_score=51.3174 val_score_bestthr=54.2051 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.476, mb=0.499, no=1.000, corr=-0.202) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 54.2051
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4758 mb_mean=0.4977 norm_overlap=0.9998 corr_cb=-0.3229 topkJ=0.0168
[TRAIN][ep=005] loss=1.3766 acc=61.34%
[TRAIN][ep=005] mask_avg: mc_mean=0.3380 mb_mean=0.4991 norm_overlap=0.9988 corr_cb=-0.2821
[EPOCH 005/089] train: loss=1.3766 acc=61.34% | val: loss=0.7044 acc=56.63% f1=67.27% auc=54.71% val_score=39.6203 val_score_bestthr=58.1693 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.338, mb=0.499, no=0.999, corr=-0.282) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 58.1693
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2245 mb_mean=0.5012 norm_overlap=0.9976 corr_cb=-0.3352 topkJ=0.0058
[TRAIN][ep=006] loss=1.3643 acc=62.01%
[TRAIN][ep=006] mask_avg: mc_mean=0.2142 mb_mean=0.4991 norm_overlap=0.9972 corr_cb=-0.2952
[EPOCH 006/089] train: loss=1.3643 acc=62.01% | val: loss=0.6864 acc=54.22% f1=66.07% auc=56.98% val_score=50.2475 val_score_bestthr=54.9344 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.214, mb=0.499, no=0.997, corr=-0.295) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 54.9344
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.1692 mb_mean=0.5002 norm_overlap=0.9949 corr_cb=-0.3987 topkJ=0.0056
[TRAIN][ep=007] loss=1.3589 acc=63.89%
[TRAIN][ep=007] mask_avg: mc_mean=0.1843 mb_mean=0.4991 norm_overlap=0.9961 corr_cb=-0.3238
[EPOCH 007/089] train: loss=1.3589 acc=63.89% | val: loss=0.6865 acc=59.04% f1=62.22% auc=57.33% val_score=50.2475 val_score_bestthr=53.7020 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.184, mb=0.499, no=0.996, corr=-0.324) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 53.7020
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2039 mb_mean=0.4990 norm_overlap=0.9956 corr_cb=-0.3811 topkJ=0.0106
[TRAIN][ep=008] loss=1.1622 acc=63.76%
[TRAIN][ep=008] mask_avg: mc_mean=0.1684 mb_mean=0.4991 norm_overlap=0.9951 corr_cb=-0.3547
[EPOCH 008/089] train: loss=1.1622 acc=63.76% | val: loss=0.6980 acc=59.04% f1=55.26% auc=58.43% val_score=51.4771 val_score_bestthr=53.6410 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.168, mb=0.499, no=0.995, corr=-0.355) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 53.6410
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1500 mb_mean=0.4992 norm_overlap=0.9939 corr_cb=-0.4197 topkJ=0.0082
[TRAIN][ep=009] loss=0.9620 acc=64.16%
[TRAIN][ep=009] mask_avg: mc_mean=0.1698 mb_mean=0.4991 norm_overlap=0.9943 corr_cb=-0.3870
[EPOCH 009/089] train: loss=0.9620 acc=64.16% | val: loss=0.6872 acc=61.45% f1=63.64% auc=58.02% val_score=55.9450 val_score_bestthr=57.0512 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.170, mb=0.499, no=0.994, corr=-0.387) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 57.0512
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1394 mb_mean=0.5005 norm_overlap=0.9962 corr_cb=-0.2826 topkJ=0.0133
[TRAIN][ep=010] loss=0.9316 acc=63.36%
[TRAIN][ep=010] mask_avg: mc_mean=0.1694 mb_mean=0.4991 norm_overlap=0.9935 corr_cb=-0.4128
[EPOCH 010/089] train: loss=0.9316 acc=63.36% | val: loss=0.6865 acc=62.65% f1=65.17% auc=58.95% val_score=50.8338 val_score_bestthr=59.4856 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.169, mb=0.499, no=0.993, corr=-0.413) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 59.4856
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1387 mb_mean=0.5000 norm_overlap=0.9935 corr_cb=-0.4097 topkJ=0.0059
[TRAIN][ep=011] loss=0.9018 acc=64.83%
[TRAIN][ep=011] mask_avg: mc_mean=0.1617 mb_mean=0.4992 norm_overlap=0.9925 corr_cb=-0.4141
[EPOCH 011/089] train: loss=0.9018 acc=64.83% | val: loss=0.6929 acc=61.45% f1=64.44% auc=58.49% val_score=50.5952 val_score_bestthr=57.9526 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.162, mb=0.499, no=0.993, corr=-0.414) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 57.9526
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.2117 mb_mean=0.4969 norm_overlap=0.9958 corr_cb=-0.3151 topkJ=0.0122
[TRAIN][ep=012] loss=0.8984 acc=64.03%
[TRAIN][ep=012] mask_avg: mc_mean=0.1697 mb_mean=0.4991 norm_overlap=0.9922 corr_cb=-0.4115
[EPOCH 012/089] train: loss=0.8984 acc=64.03% | val: loss=0.6948 acc=62.65% f1=64.37% auc=58.49% val_score=55.9450 val_score_bestthr=57.6598 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.170, mb=0.499, no=0.992, corr=-0.411) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 57.6598
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1926 mb_mean=0.4960 norm_overlap=0.9927 corr_cb=-0.3973 topkJ=0.0028
[TRAIN][ep=013] loss=0.8855 acc=66.98%
[TRAIN][ep=013] mask_avg: mc_mean=0.1716 mb_mean=0.4991 norm_overlap=0.9917 corr_cb=-0.4105
[EPOCH 013/089] train: loss=0.8855 acc=66.98% | val: loss=0.7001 acc=60.24% f1=62.92% auc=58.26% val_score=55.1154 val_score_bestthr=55.9450 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.172, mb=0.499, no=0.992, corr=-0.410) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 55.9450
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1255 mb_mean=0.5003 norm_overlap=0.9915 corr_cb=-0.3479 topkJ=0.0059
[TRAIN][ep=014] loss=0.8804 acc=67.11%
[TRAIN][ep=014] mask_avg: mc_mean=0.1656 mb_mean=0.4991 norm_overlap=0.9909 corr_cb=-0.4167
[EPOCH 014/089] train: loss=0.8804 acc=67.11% | val: loss=0.7161 acc=59.04% f1=57.50% auc=59.59% val_score=49.0716 val_score_bestthr=57.5078 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.166, mb=0.499, no=0.991, corr=-0.417) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 57.5078
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.2101 mb_mean=0.4990 norm_overlap=0.9900 corr_cb=-0.5346 topkJ=0.0048
[TRAIN][ep=015] loss=0.8821 acc=65.10%
[TRAIN][ep=015] mask_avg: mc_mean=0.1740 mb_mean=0.4991 norm_overlap=0.9908 corr_cb=-0.4146
[EPOCH 015/089] train: loss=0.8821 acc=65.10% | val: loss=0.7118 acc=57.83% f1=67.29% auc=58.26% val_score=46.5120 val_score_bestthr=57.5872 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.174, mb=0.499, no=0.991, corr=-0.415) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 57.5872
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1284 mb_mean=0.5034 norm_overlap=0.9865 corr_cb=-0.4661 topkJ=0.0031
[TRAIN][ep=016] loss=0.8730 acc=65.37%
[TRAIN][ep=016] mask_avg: mc_mean=0.1785 mb_mean=0.4991 norm_overlap=0.9908 corr_cb=-0.4112
[EPOCH 016/089] train: loss=0.8730 acc=65.37% | val: loss=0.7025 acc=59.04% f1=68.52% auc=60.17% val_score=48.1555 val_score_bestthr=54.9295 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.179, mb=0.499, no=0.991, corr=-0.411) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 54.9295
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1935 mb_mean=0.4979 norm_overlap=0.9922 corr_cb=-0.3946 topkJ=0.0097
[TRAIN][ep=017] loss=0.8636 acc=69.26%
[TRAIN][ep=017] mask_avg: mc_mean=0.1799 mb_mean=0.4991 norm_overlap=0.9905 corr_cb=-0.4218
[EPOCH 017/089] train: loss=0.8636 acc=69.26% | val: loss=0.7204 acc=53.01% f1=68.80% auc=60.00% val_score=52.2410 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.180, mb=0.499, no=0.991, corr=-0.422) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 61.2320
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1888 mb_mean=0.5000 norm_overlap=0.9947 corr_cb=-0.2832 topkJ=0.0204
[TRAIN][ep=018] loss=0.8673 acc=68.19%
[TRAIN][ep=018] mask_avg: mc_mean=0.1908 mb_mean=0.4992 norm_overlap=0.9903 corr_cb=-0.4339
[EPOCH 018/089] train: loss=0.8673 acc=68.19% | val: loss=0.7270 acc=53.01% f1=68.80% auc=60.64% val_score=48.7317 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.191, mb=0.499, no=0.990, corr=-0.434) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 61.2320
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.2409 mb_mean=0.4994 norm_overlap=0.9879 corr_cb=-0.5625 topkJ=0.0020
[TRAIN][ep=019] loss=0.8669 acc=67.25%
[TRAIN][ep=019] mask_avg: mc_mean=0.1865 mb_mean=0.4991 norm_overlap=0.9903 corr_cb=-0.4254
[EPOCH 019/089] train: loss=0.8669 acc=67.25% | val: loss=0.7103 acc=57.83% f1=67.89% auc=59.42% val_score=41.0743 val_score_bestthr=54.7859 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.186, mb=0.499, no=0.990, corr=-0.425) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 54.7859
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1587 mb_mean=0.4995 norm_overlap=0.9884 corr_cb=-0.4659 topkJ=0.0028
[TRAIN][ep=020] loss=0.8544 acc=69.66%
[TRAIN][ep=020] mask_avg: mc_mean=0.1779 mb_mean=0.4991 norm_overlap=0.9900 corr_cb=-0.4257
[EPOCH 020/089] train: loss=0.8544 acc=69.66% | val: loss=0.7480 acc=53.01% f1=68.80% auc=59.88% val_score=38.6501 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.178, mb=0.499, no=0.990, corr=-0.426) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 61.2320
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2454 mb_mean=0.4957 norm_overlap=0.9920 corr_cb=-0.4263 topkJ=0.0162
[TRAIN][ep=021] loss=0.8402 acc=71.28%
[TRAIN][ep=021] mask_avg: mc_mean=0.1918 mb_mean=0.4991 norm_overlap=0.9904 corr_cb=-0.4246
[EPOCH 021/089] train: loss=0.8402 acc=71.28% | val: loss=0.7495 acc=53.01% f1=68.80% auc=61.05% val_score=43.8132 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.192, mb=0.499, no=0.990, corr=-0.425) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 61.2320
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2216 mb_mean=0.4965 norm_overlap=0.9927 corr_cb=-0.3542 topkJ=0.0028
[TRAIN][ep=022] loss=0.8442 acc=69.13%
[TRAIN][ep=022] mask_avg: mc_mean=0.1812 mb_mean=0.4991 norm_overlap=0.9908 corr_cb=-0.3915
[EPOCH 022/089] train: loss=0.8442 acc=69.13% | val: loss=0.7306 acc=59.04% f1=67.92% auc=60.29% val_score=44.1033 val_score_bestthr=56.6206 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.181, mb=0.499, no=0.991, corr=-0.392) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 56.6206
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1898 mb_mean=0.4979 norm_overlap=0.9917 corr_cb=-0.4292 topkJ=0.0068
[TRAIN][ep=023] loss=0.8203 acc=72.08%
[TRAIN][ep=023] mask_avg: mc_mean=0.1987 mb_mean=0.4992 norm_overlap=0.9911 corr_cb=-0.4003
[EPOCH 023/089] train: loss=0.8203 acc=72.08% | val: loss=0.7603 acc=59.04% f1=67.92% auc=60.06% val_score=37.8171 val_score_bestthr=56.6206 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.199, mb=0.499, no=0.991, corr=-0.400) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 56.6206
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1582 mb_mean=0.5023 norm_overlap=0.9896 corr_cb=-0.4553 topkJ=0.0047
[TRAIN][ep=024] loss=0.8203 acc=72.21%
[TRAIN][ep=024] mask_avg: mc_mean=0.1803 mb_mean=0.4991 norm_overlap=0.9907 corr_cb=-0.3934
[EPOCH 024/089] train: loss=0.8203 acc=72.21% | val: loss=0.7481 acc=53.01% f1=68.80% auc=60.35% val_score=41.0743 val_score_bestthr=61.2320 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.180, mb=0.499, no=0.991, corr=-0.393) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 61.2320
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1584 mb_mean=0.4994 norm_overlap=0.9878 corr_cb=-0.4625 topkJ=0.0230
[TRAIN][ep=025] loss=0.8183 acc=71.81%
[TRAIN][ep=025] mask_avg: mc_mean=0.1905 mb_mean=0.4991 norm_overlap=0.9913 corr_cb=-0.3799
[EPOCH 025/089] train: loss=0.8183 acc=71.81% | val: loss=0.7390 acc=57.83% f1=67.89% auc=60.47% val_score=45.4522 val_score_bestthr=54.7859 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.499, no=0.991, corr=-0.380) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 54.7859
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2951 mb_mean=0.4956 norm_overlap=0.9924 corr_cb=-0.4221 topkJ=0.0044
[TRAIN][ep=026] loss=0.7952 acc=71.95%
[TRAIN][ep=026] mask_avg: mc_mean=0.1876 mb_mean=0.4991 norm_overlap=0.9913 corr_cb=-0.3801
[EPOCH 026/089] train: loss=0.7952 acc=71.95% | val: loss=0.7853 acc=57.83% f1=67.29% auc=60.41% val_score=40.6085 val_score_bestthr=53.7146 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.188, mb=0.499, no=0.991, corr=-0.380) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 53.7146
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.0744 mb_mean=0.5030 norm_overlap=0.9925 corr_cb=-0.2665 topkJ=0.0213
[TRAIN][ep=027] loss=0.8034 acc=72.89%
[TRAIN][ep=027] mask_avg: mc_mean=0.1693 mb_mean=0.4991 norm_overlap=0.9915 corr_cb=-0.3487
[EPOCH 027/089] train: loss=0.8034 acc=72.89% | val: loss=0.7609 acc=51.81% f1=68.25% auc=61.34% val_score=46.5594 val_score_bestthr=62.0453 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.169, mb=0.499, no=0.991, corr=-0.349) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 62.0453
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1705 mb_mean=0.4994 norm_overlap=0.9904 corr_cb=-0.3681 topkJ=0.0063
[TRAIN][ep=028] loss=0.7937 acc=72.75%
[TRAIN][ep=028] mask_avg: mc_mean=0.1688 mb_mean=0.4991 norm_overlap=0.9919 corr_cb=-0.3388
[EPOCH 028/089] train: loss=0.7937 acc=72.75% | val: loss=0.7587 acc=51.81% f1=68.25% auc=61.16% val_score=40.5371 val_score_bestthr=62.0453 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.169, mb=0.499, no=0.992, corr=-0.339) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 62.0453
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2026 mb_mean=0.4979 norm_overlap=0.9916 corr_cb=-0.4099 topkJ=0.0057
[TRAIN][ep=029] loss=0.7780 acc=73.69%
[TRAIN][ep=029] mask_avg: mc_mean=0.1891 mb_mean=0.4991 norm_overlap=0.9926 corr_cb=-0.3317
[EPOCH 029/089] train: loss=0.7780 acc=73.69% | val: loss=0.8108 acc=53.01% f1=68.29% auc=61.40% val_score=43.1946 val_score_bestthr=56.7094 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.189, mb=0.499, no=0.993, corr=-0.332) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 56.7094
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2330 mb_mean=0.4970 norm_overlap=0.9940 corr_cb=-0.3128 topkJ=0.0162
[TRAIN][ep=030] loss=0.7877 acc=73.83%
[TRAIN][ep=030] mask_avg: mc_mean=0.1772 mb_mean=0.4992 norm_overlap=0.9920 corr_cb=-0.3478
[EPOCH 030/089] train: loss=0.7877 acc=73.83% | val: loss=0.7845 acc=59.04% f1=67.31% auc=60.64% val_score=44.4606 val_score_bestthr=54.4446 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.177, mb=0.499, no=0.992, corr=-0.348) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 54.4446
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2328 mb_mean=0.4980 norm_overlap=0.9926 corr_cb=-0.3790 topkJ=0.0068
[TRAIN][ep=031] loss=0.7726 acc=73.83%
[TRAIN][ep=031] mask_avg: mc_mean=0.1839 mb_mean=0.4991 norm_overlap=0.9922 corr_cb=-0.3495
[EPOCH 031/089] train: loss=0.7726 acc=73.83% | val: loss=0.7751 acc=51.81% f1=67.74% auc=60.99% val_score=47.0490 val_score_bestthr=56.7716 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.184, mb=0.499, no=0.992, corr=-0.350) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 56.7716
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1598 mb_mean=0.4981 norm_overlap=0.9945 corr_cb=-0.2773 topkJ=0.0268
[TRAIN][ep=032] loss=0.7683 acc=74.90%
[TRAIN][ep=032] mask_avg: mc_mean=0.1849 mb_mean=0.4991 norm_overlap=0.9927 corr_cb=-0.3325
[EPOCH 032/089] train: loss=0.7683 acc=74.90% | val: loss=0.7747 acc=60.24% f1=67.33% auc=62.38% val_score=48.0709 val_score_bestthr=55.0488 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.185, mb=0.499, no=0.993, corr=-0.332) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 55.0488
[EARLY STOP] no improvement for 30 epochs. best_epoch=2
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/ckpt_best_fold_4.pt
=============== FIT DONE ===============
[BEST] epoch=2 | val_acc=51.81% | val_f1=68.25% | val_auc=56.69% | val_score=39.2574 | val_score_bestthr=62.0453
[TEST@BEST] thr_used=0.440 | acc=60.39% f1=68.94% auc=63.60% | SP_sex=11.96% EO_sex=8.72% SP_age=17.75% EO_age=11.68%
[TIME] 0.86 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold4_rep1_seed1004/summary_fold_4.json
