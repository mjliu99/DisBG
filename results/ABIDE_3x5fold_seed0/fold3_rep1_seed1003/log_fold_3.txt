[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5496 mb_mean=0.5403 norm_overlap=1.0001 corr_cb=0.3519 topkJ=0.1406
[TRAIN][ep=000] loss=0.6938 acc=50.07%
[TRAIN][ep=000] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1607
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5475 mb_mean=0.5372 norm_overlap=1.0001 corr_cb=0.1760 topkJ=0.2310
[TRAIN][ep=001] loss=0.6922 acc=54.23%
[TRAIN][ep=001] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1625
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5445 mb_mean=0.5368 norm_overlap=1.0000 corr_cb=-0.0182 topkJ=0.0374
[TRAIN][ep=002] loss=0.6921 acc=51.95%
[TRAIN][ep=002] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1664
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5469 mb_mean=0.5363 norm_overlap=1.0000 corr_cb=-0.0789 topkJ=0.0102
[TRAIN][ep=003] loss=0.6902 acc=53.15%
[TRAIN][ep=003] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1676
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5430 mb_mean=0.5353 norm_overlap=1.0000 corr_cb=0.0043 topkJ=0.1063
[TRAIN][ep=004] loss=0.6900 acc=54.50%
[TRAIN][ep=004] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1536
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5519 mb_mean=0.5362 norm_overlap=1.0000 corr_cb=0.1233 topkJ=0.0542
[TRAIN][ep=005] loss=0.6888 acc=54.50%
[TRAIN][ep=005] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1638
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5510 mb_mean=0.5382 norm_overlap=1.0001 corr_cb=0.2709 topkJ=0.0754
[TRAIN][ep=006] loss=0.6875 acc=58.93%
[TRAIN][ep=006] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1403
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5482 mb_mean=0.5362 norm_overlap=1.0001 corr_cb=0.1681 topkJ=0.1178
[TRAIN][ep=007] loss=0.6860 acc=56.64%
[TRAIN][ep=007] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1610
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5467 mb_mean=0.5373 norm_overlap=1.0000 corr_cb=-0.0661 topkJ=0.0328
[TRAIN][ep=008] loss=0.6848 acc=57.45%
[TRAIN][ep=008] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1699
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5503 mb_mean=0.5383 norm_overlap=1.0002 corr_cb=0.3963 topkJ=0.1772
[TRAIN][ep=009] loss=0.6834 acc=58.93%
[TRAIN][ep=009] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1600
================= FIT START (fold=3) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5516 mb_mean=0.5395 norm_overlap=1.0000 corr_cb=0.0837 topkJ=0.0302
[TRAIN][ep=000] loss=0.6814 acc=59.46%
[TRAIN][ep=000] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1701
[EPOCH 000/089] train: loss=0.6814 acc=59.46% | val: loss=0.6930 acc=56.63% f1=68.97% auc=48.78% val_score=43.0529 val_score_bestthr=57.8999 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.170) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 57.8999
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep1_seed1003/ckpt_best_fold_3.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5481 mb_mean=0.5374 norm_overlap=1.0000 corr_cb=0.1478 topkJ=0.0522
[TRAIN][ep=001] loss=0.6794 acc=57.72%
[TRAIN][ep=001] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1569
[EPOCH 001/089] train: loss=0.6794 acc=57.72% | val: loss=0.6986 acc=55.42% f1=67.83% auc=46.74% val_score=34.5304 val_score_bestthr=55.3369 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.157) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 57.8999 -> 55.3369
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5562 mb_mean=0.5396 norm_overlap=1.0002 corr_cb=0.3367 topkJ=0.1809
[TRAIN][ep=002] loss=0.6773 acc=61.07%
[TRAIN][ep=002] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1556
[EPOCH 002/089] train: loss=0.6773 acc=61.07% | val: loss=0.6929 acc=55.42% f1=69.42% auc=49.42% val_score=41.9537 val_score_bestthr=59.0157 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.156) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 57.8999 -> 59.0157
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep1_seed1003/ckpt_best_fold_3.pt
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5486 mb_mean=0.5364 norm_overlap=1.0000 corr_cb=0.1156 topkJ=0.0623
[TRAIN][ep=003] loss=0.6746 acc=61.34%
[TRAIN][ep=003] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1636
[EPOCH 003/089] train: loss=0.6746 acc=61.34% | val: loss=0.6897 acc=57.83% f1=71.07% auc=56.40% val_score=65.5155 val_score_bestthr=65.5155 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.164) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 59.0157 -> 65.5155
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep1_seed1003/ckpt_best_fold_3.pt
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5592 mb_mean=0.5394 norm_overlap=1.0001 corr_cb=0.2315 topkJ=0.1445
[TRAIN][ep=004] loss=0.6742 acc=58.93%
[TRAIN][ep=004] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1579
[EPOCH 004/089] train: loss=0.6742 acc=58.93% | val: loss=0.6909 acc=57.83% f1=70.59% auc=52.50% val_score=52.1214 val_score_bestthr=62.3259 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.158) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 65.5155 -> 62.3259
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5493 mb_mean=0.5373 norm_overlap=1.0000 corr_cb=-0.0651 topkJ=0.0040
[TRAIN][ep=005] loss=1.2704 acc=58.79%
[TRAIN][ep=005] mask_avg: mc_mean=0.4395 mb_mean=0.5376 norm_overlap=0.9994 corr_cb=-0.3762
[EPOCH 005/089] train: loss=1.2704 acc=58.79% | val: loss=0.6929 acc=57.83% f1=69.57% auc=51.28% val_score=38.9787 val_score_bestthr=59.9519 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.439, mb=0.538, no=0.999, corr=-0.376) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.5155 -> 59.9519
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.3792 mb_mean=0.5346 norm_overlap=0.9986 corr_cb=-0.4564 topkJ=0.0190
[TRAIN][ep=006] loss=1.2544 acc=60.67%
[TRAIN][ep=006] mask_avg: mc_mean=0.3051 mb_mean=0.5376 norm_overlap=0.9983 corr_cb=-0.3794
[EPOCH 006/089] train: loss=1.2544 acc=60.67% | val: loss=0.6971 acc=54.22% f1=69.35% auc=49.83% val_score=31.6208 val_score_bestthr=62.6702 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.305, mb=0.538, no=0.998, corr=-0.379) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.5155 -> 62.6702
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2421 mb_mean=0.5371 norm_overlap=0.9981 corr_cb=-0.4484 topkJ=0.0035
[TRAIN][ep=007] loss=1.2512 acc=60.54%
[TRAIN][ep=007] mask_avg: mc_mean=0.2434 mb_mean=0.5376 norm_overlap=0.9976 corr_cb=-0.3772
[EPOCH 007/089] train: loss=1.2512 acc=60.54% | val: loss=0.6917 acc=56.63% f1=69.49% auc=51.80% val_score=40.4152 val_score_bestthr=61.4905 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.243, mb=0.538, no=0.998, corr=-0.377) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.5155 -> 61.4905
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2520 mb_mean=0.5355 norm_overlap=0.9989 corr_cb=-0.1944 topkJ=0.0885
[TRAIN][ep=008] loss=1.2491 acc=59.19%
[TRAIN][ep=008] mask_avg: mc_mean=0.2129 mb_mean=0.5376 norm_overlap=0.9971 corr_cb=-0.3711
[EPOCH 008/089] train: loss=1.2491 acc=59.19% | val: loss=0.6956 acc=55.42% f1=68.91% auc=51.22% val_score=34.9310 val_score_bestthr=59.2753 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.213, mb=0.538, no=0.997, corr=-0.371) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.5155 -> 59.2753
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1859 mb_mean=0.5395 norm_overlap=0.9957 corr_cb=-0.4516 topkJ=0.0123
[TRAIN][ep=009] loss=1.0074 acc=62.68%
[TRAIN][ep=009] mask_avg: mc_mean=0.2001 mb_mean=0.5376 norm_overlap=0.9969 corr_cb=-0.3550
[EPOCH 009/089] train: loss=1.0074 acc=62.68% | val: loss=0.7066 acc=54.22% f1=69.35% auc=48.78% val_score=35.7333 val_score_bestthr=62.6702 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.200, mb=0.538, no=0.997, corr=-0.355) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.5155 -> 62.6702
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1683 mb_mean=0.5379 norm_overlap=0.9977 corr_cb=-0.3398 topkJ=0.0163
[TRAIN][ep=010] loss=0.7615 acc=61.88%
[TRAIN][ep=010] mask_avg: mc_mean=0.1945 mb_mean=0.5376 norm_overlap=0.9967 corr_cb=-0.3583
[EPOCH 010/089] train: loss=0.7615 acc=61.88% | val: loss=0.7198 acc=55.42% f1=65.42% auc=48.02% val_score=38.2471 val_score_bestthr=56.5703 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.194, mb=0.538, no=0.997, corr=-0.358) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.5155 -> 56.5703
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1658 mb_mean=0.5409 norm_overlap=0.9963 corr_cb=-0.3255 topkJ=0.0203
[TRAIN][ep=011] loss=0.7034 acc=64.70%
[TRAIN][ep=011] mask_avg: mc_mean=0.1875 mb_mean=0.5376 norm_overlap=0.9965 corr_cb=-0.3496
[EPOCH 011/089] train: loss=0.7034 acc=64.70% | val: loss=0.6970 acc=59.04% f1=70.69% auc=51.22% val_score=34.9310 val_score_bestthr=63.1567 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.188, mb=0.538, no=0.997, corr=-0.350) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.5155 -> 63.1567
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1890 mb_mean=0.5345 norm_overlap=0.9987 corr_cb=-0.1852 topkJ=0.0798
[TRAIN][ep=012] loss=0.6841 acc=64.56%
[TRAIN][ep=012] mask_avg: mc_mean=0.1861 mb_mean=0.5376 norm_overlap=0.9965 corr_cb=-0.3214
[EPOCH 012/089] train: loss=0.6841 acc=64.56% | val: loss=0.6910 acc=61.45% f1=72.41% auc=56.40% val_score=57.3773 val_score_bestthr=65.9981 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.186, mb=0.538, no=0.997, corr=-0.321) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 65.5155 -> 65.9981
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep1_seed1003/ckpt_best_fold_3.pt
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.2146 mb_mean=0.5357 norm_overlap=0.9989 corr_cb=-0.1683 topkJ=0.0438
[TRAIN][ep=013] loss=0.7816 acc=62.28%
[TRAIN][ep=013] mask_avg: mc_mean=0.1744 mb_mean=0.5376 norm_overlap=0.9963 corr_cb=-0.2892
[EPOCH 013/089] train: loss=0.7816 acc=62.28% | val: loss=0.6967 acc=61.45% f1=72.88% auc=58.60% val_score=69.5199 val_score_bestthr=69.5199 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.174, mb=0.538, no=0.996, corr=-0.289) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 65.9981 -> 69.5199
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep1_seed1003/ckpt_best_fold_3.pt
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1633 mb_mean=0.5402 norm_overlap=0.9956 corr_cb=-0.3514 topkJ=0.0024
[TRAIN][ep=014] loss=0.8761 acc=61.88%
[TRAIN][ep=014] mask_avg: mc_mean=0.1737 mb_mean=0.5376 norm_overlap=0.9962 corr_cb=-0.2884
[EPOCH 014/089] train: loss=0.8761 acc=61.88% | val: loss=0.6959 acc=60.24% f1=71.30% auc=53.08% val_score=35.6917 val_score_bestthr=65.9315 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.174, mb=0.538, no=0.996, corr=-0.288) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.5199 -> 65.9315
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1698 mb_mean=0.5349 norm_overlap=0.9964 corr_cb=-0.3232 topkJ=0.0237
[TRAIN][ep=015] loss=0.9641 acc=65.77%
[TRAIN][ep=015] mask_avg: mc_mean=0.1654 mb_mean=0.5376 norm_overlap=0.9958 corr_cb=-0.2887
[EPOCH 015/089] train: loss=0.9641 acc=65.77% | val: loss=0.6906 acc=62.65% f1=73.50% auc=56.34% val_score=46.8696 val_score_bestthr=71.3054 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.165, mb=0.538, no=0.996, corr=-0.289) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 69.5199 -> 71.3054
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep1_seed1003/ckpt_best_fold_3.pt
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1315 mb_mean=0.5397 norm_overlap=0.9943 corr_cb=-0.3164 topkJ=0.0081
[TRAIN][ep=016] loss=1.0623 acc=63.22%
[TRAIN][ep=016] mask_avg: mc_mean=0.1581 mb_mean=0.5376 norm_overlap=0.9956 corr_cb=-0.2772
[EPOCH 016/089] train: loss=1.0623 acc=63.22% | val: loss=0.7150 acc=60.24% f1=70.80% auc=52.44% val_score=39.0625 val_score_bestthr=60.1028 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.158, mb=0.538, no=0.996, corr=-0.277) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.3054 -> 60.1028
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1848 mb_mean=0.5373 norm_overlap=0.9965 corr_cb=-0.2049 topkJ=0.0474
[TRAIN][ep=017] loss=1.1447 acc=66.31%
[TRAIN][ep=017] mask_avg: mc_mean=0.1661 mb_mean=0.5376 norm_overlap=0.9958 corr_cb=-0.2603
[EPOCH 017/089] train: loss=1.1447 acc=66.31% | val: loss=0.6948 acc=60.24% f1=71.79% auc=55.06% val_score=41.4848 val_score_bestthr=67.4967 | dyn(w_pfs=0.240, w_sup=0.240, w_csuf=0.200, stage2=False) | mask(mc=0.166, mb=0.538, no=0.996, corr=-0.260) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.3054 -> 67.4967
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1825 mb_mean=0.5362 norm_overlap=0.9977 corr_cb=-0.1682 topkJ=0.0277
[TRAIN][ep=018] loss=1.1697 acc=66.17%
[TRAIN][ep=018] mask_avg: mc_mean=0.1669 mb_mean=0.5376 norm_overlap=0.9957 corr_cb=-0.2491
[EPOCH 018/089] train: loss=1.1697 acc=66.17% | val: loss=0.6916 acc=61.45% f1=72.41% auc=56.22% val_score=50.5611 val_score_bestthr=67.7571 | dyn(w_pfs=0.280, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.167, mb=0.538, no=0.996, corr=-0.249) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.3054 -> 67.7571
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1704 mb_mean=0.5388 norm_overlap=0.9939 corr_cb=-0.3427 topkJ=0.0149
[TRAIN][ep=019] loss=1.1870 acc=65.37%
[TRAIN][ep=019] mask_avg: mc_mean=0.1761 mb_mean=0.5376 norm_overlap=0.9957 corr_cb=-0.2526
[EPOCH 019/089] train: loss=1.1870 acc=65.37% | val: loss=0.6998 acc=60.24% f1=71.30% auc=54.94% val_score=42.2964 val_score_bestthr=65.9315 | dyn(w_pfs=0.320, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.176, mb=0.538, no=0.996, corr=-0.253) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.3054 -> 65.9315
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1583 mb_mean=0.5373 norm_overlap=0.9947 corr_cb=-0.3103 topkJ=0.0072
[TRAIN][ep=020] loss=1.1899 acc=66.04%
[TRAIN][ep=020] mask_avg: mc_mean=0.1755 mb_mean=0.5376 norm_overlap=0.9957 corr_cb=-0.2407
[EPOCH 020/089] train: loss=1.1899 acc=66.04% | val: loss=0.6918 acc=61.45% f1=72.41% auc=57.33% val_score=50.7001 val_score_bestthr=67.7571 | dyn(w_pfs=0.220, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.175, mb=0.538, no=0.996, corr=-0.241) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.3054 -> 67.7571
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2144 mb_mean=0.5381 norm_overlap=0.9962 corr_cb=-0.2340 topkJ=0.0407
[TRAIN][ep=021] loss=0.9514 acc=66.31%
[TRAIN][ep=021] mask_avg: mc_mean=0.1908 mb_mean=0.5376 norm_overlap=0.9958 corr_cb=-0.2426
[EPOCH 021/089] train: loss=0.9514 acc=66.31% | val: loss=0.6977 acc=61.45% f1=72.88% auc=59.01% val_score=58.3352 val_score_bestthr=69.5199 | dyn(w_pfs=0.120, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.191, mb=0.538, no=0.996, corr=-0.243) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.3054 -> 69.5199
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1520 mb_mean=0.5376 norm_overlap=0.9950 corr_cb=-0.3129 topkJ=0.0197
[TRAIN][ep=022] loss=0.7125 acc=65.91%
[TRAIN][ep=022] mask_avg: mc_mean=0.1863 mb_mean=0.5376 norm_overlap=0.9957 corr_cb=-0.2367
[EPOCH 022/089] train: loss=0.7125 acc=65.91% | val: loss=0.6986 acc=60.24% f1=71.79% auc=56.34% val_score=43.5382 val_score_bestthr=66.0967 | dyn(w_pfs=0.020, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.186, mb=0.538, no=0.996, corr=-0.237) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.3054 -> 66.0967
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2215 mb_mean=0.5360 norm_overlap=0.9962 corr_cb=-0.2416 topkJ=0.0195
[TRAIN][ep=023] loss=0.6502 acc=68.99%
[TRAIN][ep=023] mask_avg: mc_mean=0.1885 mb_mean=0.5376 norm_overlap=0.9959 corr_cb=-0.2200
[EPOCH 023/089] train: loss=0.6502 acc=68.99% | val: loss=0.6978 acc=59.04% f1=71.67% auc=56.63% val_score=48.6883 val_score_bestthr=67.9254 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.189, mb=0.538, no=0.996, corr=-0.220) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.3054 -> 67.9254
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1798 mb_mean=0.5388 norm_overlap=0.9957 corr_cb=-0.2073 topkJ=0.0347
[TRAIN][ep=024] loss=0.6443 acc=68.32%
[TRAIN][ep=024] mask_avg: mc_mean=0.1860 mb_mean=0.5376 norm_overlap=0.9959 corr_cb=-0.2117
[EPOCH 024/089] train: loss=0.6443 acc=68.32% | val: loss=0.7009 acc=59.04% f1=71.67% auc=56.22% val_score=52.5828 val_score_bestthr=67.9254 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.186, mb=0.538, no=0.996, corr=-0.212) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.3054 -> 67.9254
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1973 mb_mean=0.5377 norm_overlap=0.9937 corr_cb=-0.2942 topkJ=0.0209
[TRAIN][ep=025] loss=0.6440 acc=65.77%
[TRAIN][ep=025] mask_avg: mc_mean=0.1915 mb_mean=0.5376 norm_overlap=0.9960 corr_cb=-0.2026
[EPOCH 025/089] train: loss=0.6440 acc=65.77% | val: loss=0.7214 acc=59.04% f1=71.19% auc=54.48% val_score=36.4257 val_score_bestthr=66.0866 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.191, mb=0.538, no=0.996, corr=-0.203) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.3054 -> 66.0866
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1899 mb_mean=0.5373 norm_overlap=0.9957 corr_cb=-0.2213 topkJ=0.0224
[TRAIN][ep=026] loss=0.6400 acc=67.52%
[TRAIN][ep=026] mask_avg: mc_mean=0.1818 mb_mean=0.5376 norm_overlap=0.9959 corr_cb=-0.2011
[EPOCH 026/089] train: loss=0.6400 acc=67.52% | val: loss=0.7005 acc=59.04% f1=71.67% auc=56.69% val_score=49.7998 val_score_bestthr=67.9254 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.182, mb=0.538, no=0.996, corr=-0.201) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.3054 -> 67.9254
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2039 mb_mean=0.5358 norm_overlap=0.9996 corr_cb=-0.0250 topkJ=0.0579
[TRAIN][ep=027] loss=0.6289 acc=70.60%
[TRAIN][ep=027] mask_avg: mc_mean=0.1923 mb_mean=0.5376 norm_overlap=0.9960 corr_cb=-0.2012
[EPOCH 027/089] train: loss=0.6289 acc=70.60% | val: loss=0.7033 acc=59.04% f1=71.67% auc=57.15% val_score=51.8129 val_score_bestthr=67.9254 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.192, mb=0.538, no=0.996, corr=-0.201) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.3054 -> 67.9254
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2075 mb_mean=0.5361 norm_overlap=0.9964 corr_cb=-0.1879 topkJ=0.0236
[TRAIN][ep=028] loss=0.6312 acc=67.25%
[TRAIN][ep=028] mask_avg: mc_mean=0.2024 mb_mean=0.5376 norm_overlap=0.9961 corr_cb=-0.1957
[EPOCH 028/089] train: loss=0.6312 acc=67.25% | val: loss=0.7036 acc=59.04% f1=71.67% auc=57.67% val_score=51.8129 val_score_bestthr=67.9254 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.202, mb=0.538, no=0.996, corr=-0.196) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.3054 -> 67.9254
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.1979 mb_mean=0.5390 norm_overlap=0.9943 corr_cb=-0.2590 topkJ=0.0232
[TRAIN][ep=029] loss=0.6224 acc=68.05%
[TRAIN][ep=029] mask_avg: mc_mean=0.2029 mb_mean=0.5376 norm_overlap=0.9961 corr_cb=-0.1945
[EPOCH 029/089] train: loss=0.6224 acc=68.05% | val: loss=0.7163 acc=59.04% f1=71.19% auc=56.22% val_score=42.2964 val_score_bestthr=66.0866 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.203, mb=0.538, no=0.996, corr=-0.194) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.3054 -> 66.0866
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2274 mb_mean=0.5360 norm_overlap=0.9979 corr_cb=-0.1301 topkJ=0.0228
[TRAIN][ep=030] loss=0.6194 acc=69.93%
[TRAIN][ep=030] mask_avg: mc_mean=0.1844 mb_mean=0.5376 norm_overlap=0.9960 corr_cb=-0.1835
[EPOCH 030/089] train: loss=0.6194 acc=69.93% | val: loss=0.7751 acc=57.83% f1=70.59% auc=55.12% val_score=41.2887 val_score_bestthr=63.8693 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.184, mb=0.538, no=0.996, corr=-0.183) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.3054 -> 63.8693
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2272 mb_mean=0.5363 norm_overlap=0.9977 corr_cb=-0.1196 topkJ=0.0384
[TRAIN][ep=031] loss=0.6242 acc=67.65%
[TRAIN][ep=031] mask_avg: mc_mean=0.2017 mb_mean=0.5376 norm_overlap=0.9963 corr_cb=-0.1773
[EPOCH 031/089] train: loss=0.6242 acc=67.65% | val: loss=0.7052 acc=59.04% f1=71.67% auc=58.95% val_score=49.1540 val_score_bestthr=67.9254 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.202, mb=0.538, no=0.996, corr=-0.177) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.3054 -> 67.9254
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1806 mb_mean=0.5378 norm_overlap=0.9948 corr_cb=-0.2700 topkJ=0.0175
[TRAIN][ep=032] loss=0.6260 acc=67.11%
[TRAIN][ep=032] mask_avg: mc_mean=0.2038 mb_mean=0.5376 norm_overlap=0.9964 corr_cb=-0.1769
[EPOCH 032/089] train: loss=0.6260 acc=67.11% | val: loss=0.7049 acc=57.83% f1=71.07% auc=57.44% val_score=55.3603 val_score_bestthr=65.3145 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.204, mb=0.538, no=0.996, corr=-0.177) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.3054 -> 65.3145
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2110 mb_mean=0.5365 norm_overlap=0.9966 corr_cb=-0.1805 topkJ=0.0210
[TRAIN][ep=033] loss=0.6076 acc=70.87%
[TRAIN][ep=033] mask_avg: mc_mean=0.2061 mb_mean=0.5376 norm_overlap=0.9964 corr_cb=-0.1774
[EPOCH 033/089] train: loss=0.6076 acc=70.87% | val: loss=0.7257 acc=59.04% f1=71.19% auc=56.69% val_score=31.2821 val_score_bestthr=66.0866 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.206, mb=0.538, no=0.996, corr=-0.177) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.3054 -> 66.0866
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2126 mb_mean=0.5402 norm_overlap=0.9943 corr_cb=-0.2829 topkJ=0.0056
[TRAIN][ep=034] loss=0.6052 acc=70.74%
[TRAIN][ep=034] mask_avg: mc_mean=0.2104 mb_mean=0.5376 norm_overlap=0.9965 corr_cb=-0.1712
[EPOCH 034/089] train: loss=0.6052 acc=70.74% | val: loss=0.7043 acc=59.04% f1=71.67% auc=58.37% val_score=55.3603 val_score_bestthr=67.9254 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.210, mb=0.538, no=0.996, corr=-0.171) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.3054 -> 67.9254
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2075 mb_mean=0.5383 norm_overlap=0.9967 corr_cb=-0.1712 topkJ=0.0284
[TRAIN][ep=035] loss=0.6106 acc=71.14%
[TRAIN][ep=035] mask_avg: mc_mean=0.2139 mb_mean=0.5376 norm_overlap=0.9965 corr_cb=-0.1689
[EPOCH 035/089] train: loss=0.6106 acc=71.14% | val: loss=0.7131 acc=57.83% f1=71.07% auc=57.62% val_score=46.6939 val_score_bestthr=65.3145 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.214, mb=0.538, no=0.997, corr=-0.169) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.3054 -> 65.3145
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2551 mb_mean=0.5386 norm_overlap=0.9970 corr_cb=-0.1685 topkJ=0.0272
[TRAIN][ep=036] loss=0.5987 acc=70.47%
[TRAIN][ep=036] mask_avg: mc_mean=0.2120 mb_mean=0.5376 norm_overlap=0.9965 corr_cb=-0.1619
[EPOCH 036/089] train: loss=0.5987 acc=70.47% | val: loss=0.7059 acc=57.83% f1=71.07% auc=58.66% val_score=55.3603 val_score_bestthr=65.3145 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.212, mb=0.538, no=0.997, corr=-0.162) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.3054 -> 65.3145
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.2019 mb_mean=0.5386 norm_overlap=0.9967 corr_cb=-0.1682 topkJ=0.0240
[TRAIN][ep=037] loss=0.5966 acc=71.14%
[TRAIN][ep=037] mask_avg: mc_mean=0.2110 mb_mean=0.5376 norm_overlap=0.9966 corr_cb=-0.1625
[EPOCH 037/089] train: loss=0.5966 acc=71.14% | val: loss=0.7426 acc=61.45% f1=65.22% auc=57.50% val_score=38.9397 val_score_bestthr=59.2173 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.211, mb=0.538, no=0.997, corr=-0.162) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.3054 -> 59.2173
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2218 mb_mean=0.5338 norm_overlap=0.9991 corr_cb=-0.0583 topkJ=0.0449
[TRAIN][ep=038] loss=0.5961 acc=71.68%
[TRAIN][ep=038] mask_avg: mc_mean=0.2134 mb_mean=0.5376 norm_overlap=0.9967 corr_cb=-0.1546
[EPOCH 038/089] train: loss=0.5961 acc=71.68% | val: loss=0.7120 acc=57.83% f1=71.07% auc=58.37% val_score=54.7343 val_score_bestthr=65.3145 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.213, mb=0.538, no=0.997, corr=-0.155) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.3054 -> 65.3145
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.1895 mb_mean=0.5379 norm_overlap=0.9957 corr_cb=-0.2133 topkJ=0.0204
[TRAIN][ep=039] loss=0.5871 acc=72.48%
[TRAIN][ep=039] mask_avg: mc_mean=0.2202 mb_mean=0.5376 norm_overlap=0.9968 corr_cb=-0.1525
[EPOCH 039/089] train: loss=0.5871 acc=72.48% | val: loss=0.7284 acc=61.45% f1=65.22% auc=57.73% val_score=47.5067 val_score_bestthr=59.2173 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.220, mb=0.538, no=0.997, corr=-0.153) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.3054 -> 59.2173
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.1841 mb_mean=0.5405 norm_overlap=0.9953 corr_cb=-0.2004 topkJ=0.0114
[TRAIN][ep=040] loss=0.5893 acc=71.41%
[TRAIN][ep=040] mask_avg: mc_mean=0.2180 mb_mean=0.5376 norm_overlap=0.9968 corr_cb=-0.1494
[EPOCH 040/089] train: loss=0.5893 acc=71.41% | val: loss=0.7123 acc=57.83% f1=70.59% auc=60.47% val_score=49.5719 val_score_bestthr=64.6159 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.218, mb=0.538, no=0.997, corr=-0.149) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.3054 -> 64.6159
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.2416 mb_mean=0.5397 norm_overlap=0.9961 corr_cb=-0.1796 topkJ=0.0237
[TRAIN][ep=041] loss=0.5841 acc=72.08%
[TRAIN][ep=041] mask_avg: mc_mean=0.2311 mb_mean=0.5376 norm_overlap=0.9969 corr_cb=-0.1483
[EPOCH 041/089] train: loss=0.5841 acc=72.08% | val: loss=0.7275 acc=56.63% f1=70.49% auc=58.08% val_score=47.6315 val_score_bestthr=63.8252 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.231, mb=0.538, no=0.997, corr=-0.148) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.3054 -> 63.8252
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.2567 mb_mean=0.5372 norm_overlap=0.9985 corr_cb=-0.0870 topkJ=0.0305
[TRAIN][ep=042] loss=0.5880 acc=71.68%
[TRAIN][ep=042] mask_avg: mc_mean=0.2163 mb_mean=0.5376 norm_overlap=0.9967 corr_cb=-0.1511
[EPOCH 042/089] train: loss=0.5880 acc=71.68% | val: loss=0.8228 acc=61.45% f1=71.43% auc=63.08% val_score=64.6159 val_score_bestthr=62.6773 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.216, mb=0.538, no=0.997, corr=-0.151) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.3054 -> 62.6773
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.2332 mb_mean=0.5389 norm_overlap=0.9965 corr_cb=-0.1824 topkJ=0.0166
[TRAIN][ep=043] loss=0.5886 acc=71.54%
[TRAIN][ep=043] mask_avg: mc_mean=0.2344 mb_mean=0.5376 norm_overlap=0.9968 corr_cb=-0.1572
[EPOCH 043/089] train: loss=0.5886 acc=71.54% | val: loss=0.7207 acc=57.83% f1=70.59% auc=59.07% val_score=50.8726 val_score_bestthr=64.6159 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.234, mb=0.538, no=0.997, corr=-0.157) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.3054 -> 64.6159
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.1687 mb_mean=0.5413 norm_overlap=0.9954 corr_cb=-0.1779 topkJ=0.0315
[TRAIN][ep=044] loss=0.5704 acc=72.75%
[TRAIN][ep=044] mask_avg: mc_mean=0.2297 mb_mean=0.5376 norm_overlap=0.9970 corr_cb=-0.1438
[EPOCH 044/089] train: loss=0.5704 acc=72.75% | val: loss=0.7227 acc=59.04% f1=70.18% auc=61.57% val_score=49.0520 val_score_bestthr=61.4823 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.230, mb=0.538, no=0.997, corr=-0.144) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.3054 -> 61.4823
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2778 mb_mean=0.5348 norm_overlap=0.9984 corr_cb=-0.1015 topkJ=0.0358
[TRAIN][ep=045] loss=0.5722 acc=72.08%
[TRAIN][ep=045] mask_avg: mc_mean=0.2376 mb_mean=0.5376 norm_overlap=0.9971 corr_cb=-0.1419
[EPOCH 045/089] train: loss=0.5722 acc=72.08% | val: loss=0.7124 acc=59.04% f1=70.69% auc=61.74% val_score=52.3680 val_score_bestthr=62.9961 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.238, mb=0.538, no=0.997, corr=-0.142) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.3054 -> 62.9961
[EARLY STOP] no improvement for 30 epochs. best_epoch=15
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold3_rep1_seed1003/ckpt_best_fold_3.pt
=============== FIT DONE ===============
[BEST] epoch=15 | val_acc=62.65% | val_f1=73.50% | val_auc=56.34% | val_score=46.8696 | val_score_bestthr=71.3054
[TEST@BEST] thr_used=0.430 | acc=57.97% f1=70.10% auc=64.95% | SP_sex=6.36% EO_sex=4.94% SP_age=9.02% EO_age=12.00%
[TIME] 1.24 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold3_rep1_seed1003/summary_fold_3.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5496 mb_mean=0.5403 norm_overlap=1.0001 corr_cb=0.3519 topkJ=0.1406
[TRAIN][ep=000] loss=0.6940 acc=50.34%
[TRAIN][ep=000] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1607
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5475 mb_mean=0.5372 norm_overlap=1.0001 corr_cb=0.1760 topkJ=0.2310
[TRAIN][ep=001] loss=0.6920 acc=53.02%
[TRAIN][ep=001] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1625
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5445 mb_mean=0.5368 norm_overlap=1.0000 corr_cb=-0.0182 topkJ=0.0374
[TRAIN][ep=002] loss=0.6917 acc=52.08%
[TRAIN][ep=002] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1664
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5469 mb_mean=0.5363 norm_overlap=1.0000 corr_cb=-0.0789 topkJ=0.0102
[TRAIN][ep=003] loss=0.6890 acc=56.78%
[TRAIN][ep=003] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1676
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5430 mb_mean=0.5353 norm_overlap=1.0000 corr_cb=0.0043 topkJ=0.1063
[TRAIN][ep=004] loss=0.6884 acc=55.17%
[TRAIN][ep=004] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1536
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5519 mb_mean=0.5362 norm_overlap=1.0000 corr_cb=0.1233 topkJ=0.0542
[TRAIN][ep=005] loss=0.6865 acc=55.17%
[TRAIN][ep=005] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1638
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5510 mb_mean=0.5382 norm_overlap=1.0001 corr_cb=0.2709 topkJ=0.0754
[TRAIN][ep=006] loss=0.6844 acc=59.06%
[TRAIN][ep=006] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1403
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5482 mb_mean=0.5362 norm_overlap=1.0001 corr_cb=0.1681 topkJ=0.1178
[TRAIN][ep=007] loss=0.6812 acc=58.93%
[TRAIN][ep=007] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1610
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5467 mb_mean=0.5373 norm_overlap=1.0000 corr_cb=-0.0661 topkJ=0.0328
[TRAIN][ep=008] loss=0.6793 acc=60.40%
[TRAIN][ep=008] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1699
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5503 mb_mean=0.5383 norm_overlap=1.0002 corr_cb=0.3963 topkJ=0.1772
[TRAIN][ep=009] loss=0.6764 acc=58.52%
[TRAIN][ep=009] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1600
================= FIT START (fold=3) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5516 mb_mean=0.5395 norm_overlap=1.0000 corr_cb=0.0837 topkJ=0.0302
[TRAIN][ep=000] loss=0.6704 acc=59.33%
[TRAIN][ep=000] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1701
[EPOCH 000/089] train: loss=0.6704 acc=59.33% | val: loss=0.6894 acc=59.04% f1=71.67% auc=56.28% val_score=57.6104 val_score_bestthr=66.6119 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.170) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 66.6119
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep1_seed1003/ckpt_best_fold_3.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5481 mb_mean=0.5374 norm_overlap=1.0000 corr_cb=0.1478 topkJ=0.0522
[TRAIN][ep=001] loss=0.6680 acc=59.33%
[TRAIN][ep=001] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1569
[EPOCH 001/089] train: loss=0.6680 acc=59.33% | val: loss=0.6984 acc=60.24% f1=71.30% auc=49.59% val_score=33.0153 val_score_bestthr=65.1537 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.157) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6119 -> 65.1537
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5562 mb_mean=0.5396 norm_overlap=1.0002 corr_cb=0.3367 topkJ=0.1809
[TRAIN][ep=002] loss=0.6659 acc=60.94%
[TRAIN][ep=002] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1556
[EPOCH 002/089] train: loss=0.6659 acc=60.94% | val: loss=0.6944 acc=59.04% f1=70.69% auc=51.22% val_score=35.8445 val_score_bestthr=64.0538 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.156) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6119 -> 64.0538
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5486 mb_mean=0.5364 norm_overlap=1.0000 corr_cb=0.1156 topkJ=0.0623
[TRAIN][ep=003] loss=0.6602 acc=62.55%
[TRAIN][ep=003] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1636
[EPOCH 003/089] train: loss=0.6602 acc=62.55% | val: loss=0.6913 acc=60.24% f1=70.80% auc=58.66% val_score=62.0007 val_score_bestthr=62.6773 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.164) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6119 -> 62.6773
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5592 mb_mean=0.5394 norm_overlap=1.0001 corr_cb=0.2315 topkJ=0.1445
[TRAIN][ep=004] loss=0.6567 acc=63.89%
[TRAIN][ep=004] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1579
[EPOCH 004/089] train: loss=0.6567 acc=63.89% | val: loss=0.6897 acc=57.83% f1=71.07% auc=54.59% val_score=56.9108 val_score_bestthr=64.3955 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.158) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6119 -> 64.3955
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5493 mb_mean=0.5373 norm_overlap=1.0000 corr_cb=-0.0651 topkJ=0.0040
[TRAIN][ep=005] loss=1.4411 acc=61.07%
[TRAIN][ep=005] mask_avg: mc_mean=0.4259 mb_mean=0.5376 norm_overlap=0.9993 corr_cb=-0.3829
[EPOCH 005/089] train: loss=1.4411 acc=61.07% | val: loss=0.7093 acc=56.63% f1=67.86% auc=50.81% val_score=40.0859 val_score_bestthr=57.9211 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.426, mb=0.538, no=0.999, corr=-0.383) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6119 -> 57.9211
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.3585 mb_mean=0.5346 norm_overlap=0.9984 corr_cb=-0.4476 topkJ=0.0190
[TRAIN][ep=006] loss=1.1944 acc=63.36%
[TRAIN][ep=006] mask_avg: mc_mean=0.2800 mb_mean=0.5376 norm_overlap=0.9981 corr_cb=-0.3689
[EPOCH 006/089] train: loss=1.1944 acc=63.36% | val: loss=0.6940 acc=60.24% f1=70.80% auc=53.08% val_score=33.3255 val_score_bestthr=62.6773 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.280, mb=0.538, no=0.998, corr=-0.369) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6119 -> 62.6773
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2161 mb_mean=0.5371 norm_overlap=0.9978 corr_cb=-0.4330 topkJ=0.0039
[TRAIN][ep=007] loss=0.9720 acc=64.56%
[TRAIN][ep=007] mask_avg: mc_mean=0.2242 mb_mean=0.5376 norm_overlap=0.9974 corr_cb=-0.3630
[EPOCH 007/089] train: loss=0.9720 acc=64.56% | val: loss=0.6854 acc=60.24% f1=71.79% auc=58.20% val_score=56.4755 val_score_bestthr=63.9433 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.224, mb=0.538, no=0.997, corr=-0.363) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6119 -> 63.9433
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2361 mb_mean=0.5355 norm_overlap=0.9988 corr_cb=-0.1824 topkJ=0.0862
[TRAIN][ep=008] loss=0.9248 acc=61.61%
[TRAIN][ep=008] mask_avg: mc_mean=0.1987 mb_mean=0.5376 norm_overlap=0.9969 corr_cb=-0.3539
[EPOCH 008/089] train: loss=0.9248 acc=61.61% | val: loss=0.7005 acc=59.04% f1=70.69% auc=52.79% val_score=30.0523 val_score_bestthr=63.9605 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.199, mb=0.538, no=0.997, corr=-0.354) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6119 -> 63.9605
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1713 mb_mean=0.5395 norm_overlap=0.9955 corr_cb=-0.4281 topkJ=0.0123
[TRAIN][ep=009] loss=0.9216 acc=64.43%
[TRAIN][ep=009] mask_avg: mc_mean=0.1861 mb_mean=0.5376 norm_overlap=0.9968 corr_cb=-0.3313
[EPOCH 009/089] train: loss=0.9216 acc=64.43% | val: loss=0.7391 acc=54.22% f1=69.35% auc=50.29% val_score=38.2471 val_score_bestthr=62.6702 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.186, mb=0.538, no=0.997, corr=-0.331) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6119 -> 62.6702
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1548 mb_mean=0.5379 norm_overlap=0.9977 corr_cb=-0.3003 topkJ=0.0187
[TRAIN][ep=010] loss=0.9147 acc=65.50%
[TRAIN][ep=010] mask_avg: mc_mean=0.1868 mb_mean=0.5376 norm_overlap=0.9965 corr_cb=-0.3470
[EPOCH 010/089] train: loss=0.9147 acc=65.50% | val: loss=0.7135 acc=57.83% f1=70.09% auc=53.08% val_score=41.3199 val_score_bestthr=62.8622 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.187, mb=0.538, no=0.997, corr=-0.347) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6119 -> 62.8622
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1561 mb_mean=0.5409 norm_overlap=0.9961 corr_cb=-0.3169 topkJ=0.0191
[TRAIN][ep=011] loss=0.9104 acc=65.23%
[TRAIN][ep=011] mask_avg: mc_mean=0.1785 mb_mean=0.5376 norm_overlap=0.9963 corr_cb=-0.3451
[EPOCH 011/089] train: loss=0.9104 acc=65.23% | val: loss=0.7049 acc=59.04% f1=70.69% auc=54.13% val_score=26.7710 val_score_bestthr=62.5605 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.178, mb=0.538, no=0.996, corr=-0.345) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6119 -> 62.5605
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1765 mb_mean=0.5345 norm_overlap=0.9987 corr_cb=-0.1767 topkJ=0.0780
[TRAIN][ep=012] loss=0.8993 acc=67.11%
[TRAIN][ep=012] mask_avg: mc_mean=0.1762 mb_mean=0.5376 norm_overlap=0.9962 corr_cb=-0.3198
[EPOCH 012/089] train: loss=0.8993 acc=67.11% | val: loss=0.6959 acc=59.04% f1=71.67% auc=59.19% val_score=55.3727 val_score_bestthr=67.9254 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.176, mb=0.538, no=0.996, corr=-0.320) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 66.6119 -> 67.9254
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep1_seed1003/ckpt_best_fold_3.pt
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.2055 mb_mean=0.5357 norm_overlap=0.9987 corr_cb=-0.1825 topkJ=0.0429
[TRAIN][ep=013] loss=0.9870 acc=64.97%
[TRAIN][ep=013] mask_avg: mc_mean=0.1614 mb_mean=0.5376 norm_overlap=0.9960 corr_cb=-0.2962
[EPOCH 013/089] train: loss=0.9870 acc=64.97% | val: loss=0.7330 acc=62.65% f1=71.56% auc=61.34% val_score=63.8252 val_score_bestthr=64.4601 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.161, mb=0.538, no=0.996, corr=-0.296) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 64.4601
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1492 mb_mean=0.5402 norm_overlap=0.9953 corr_cb=-0.3541 topkJ=0.0020
[TRAIN][ep=014] loss=1.0751 acc=65.64%
[TRAIN][ep=014] mask_avg: mc_mean=0.1620 mb_mean=0.5376 norm_overlap=0.9958 corr_cb=-0.3078
[EPOCH 014/089] train: loss=1.0751 acc=65.64% | val: loss=0.6886 acc=60.24% f1=70.80% auc=57.56% val_score=49.5895 val_score_bestthr=62.6773 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.162, mb=0.538, no=0.996, corr=-0.308) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 62.6773
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1558 mb_mean=0.5349 norm_overlap=0.9961 corr_cb=-0.3479 topkJ=0.0220
[TRAIN][ep=015] loss=1.1536 acc=67.52%
[TRAIN][ep=015] mask_avg: mc_mean=0.1534 mb_mean=0.5376 norm_overlap=0.9953 corr_cb=-0.3190
[EPOCH 015/089] train: loss=1.1536 acc=67.52% | val: loss=0.6892 acc=59.04% f1=71.67% auc=58.43% val_score=54.9301 val_score_bestthr=67.9254 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.153, mb=0.538, no=0.995, corr=-0.319) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 67.9254
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1220 mb_mean=0.5397 norm_overlap=0.9938 corr_cb=-0.3562 topkJ=0.0081
[TRAIN][ep=016] loss=1.2429 acc=64.56%
[TRAIN][ep=016] mask_avg: mc_mean=0.1528 mb_mean=0.5376 norm_overlap=0.9951 corr_cb=-0.3251
[EPOCH 016/089] train: loss=1.2429 acc=64.56% | val: loss=0.7304 acc=59.04% f1=71.19% auc=55.29% val_score=35.4190 val_score_bestthr=66.0866 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.153, mb=0.538, no=0.995, corr=-0.325) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 66.0866
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1769 mb_mean=0.5373 norm_overlap=0.9960 corr_cb=-0.2393 topkJ=0.0448
[TRAIN][ep=017] loss=1.3114 acc=66.58%
[TRAIN][ep=017] mask_avg: mc_mean=0.1597 mb_mean=0.5376 norm_overlap=0.9952 corr_cb=-0.3252
[EPOCH 017/089] train: loss=1.3114 acc=66.58% | val: loss=0.6880 acc=57.83% f1=70.59% auc=58.60% val_score=47.0593 val_score_bestthr=64.6159 | dyn(w_pfs=0.100, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.160, mb=0.538, no=0.995, corr=-0.325) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 64.6159
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1783 mb_mean=0.5362 norm_overlap=0.9974 corr_cb=-0.2191 topkJ=0.0268
[TRAIN][ep=018] loss=1.0871 acc=69.53%
[TRAIN][ep=018] mask_avg: mc_mean=0.1654 mb_mean=0.5376 norm_overlap=0.9952 corr_cb=-0.3135
[EPOCH 018/089] train: loss=1.0871 acc=69.53% | val: loss=0.6886 acc=59.04% f1=71.67% auc=58.95% val_score=53.3381 val_score_bestthr=67.9254 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.165, mb=0.538, no=0.995, corr=-0.314) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 67.9254
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1659 mb_mean=0.5388 norm_overlap=0.9937 corr_cb=-0.3974 topkJ=0.0157
[TRAIN][ep=019] loss=0.8736 acc=68.46%
[TRAIN][ep=019] mask_avg: mc_mean=0.1749 mb_mean=0.5376 norm_overlap=0.9951 corr_cb=-0.3257
[EPOCH 019/089] train: loss=0.8736 acc=68.46% | val: loss=0.7053 acc=59.04% f1=71.19% auc=57.33% val_score=32.0948 val_score_bestthr=66.0866 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.175, mb=0.538, no=0.995, corr=-0.326) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 66.0866
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1585 mb_mean=0.5373 norm_overlap=0.9940 corr_cb=-0.3899 topkJ=0.0044
[TRAIN][ep=020] loss=0.8669 acc=68.32%
[TRAIN][ep=020] mask_avg: mc_mean=0.1762 mb_mean=0.5376 norm_overlap=0.9951 corr_cb=-0.3084
[EPOCH 020/089] train: loss=0.8669 acc=68.32% | val: loss=0.6931 acc=59.04% f1=71.67% auc=60.70% val_score=46.6857 val_score_bestthr=67.9254 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.176, mb=0.538, no=0.995, corr=-0.308) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 67.9254
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2086 mb_mean=0.5381 norm_overlap=0.9957 corr_cb=-0.2918 topkJ=0.0419
[TRAIN][ep=021] loss=0.8694 acc=67.38%
[TRAIN][ep=021] mask_avg: mc_mean=0.1850 mb_mean=0.5376 norm_overlap=0.9950 corr_cb=-0.3322
[EPOCH 021/089] train: loss=0.8694 acc=67.38% | val: loss=0.6998 acc=59.04% f1=71.67% auc=60.76% val_score=46.9454 val_score_bestthr=67.9254 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.185, mb=0.538, no=0.995, corr=-0.332) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 67.9254
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1533 mb_mean=0.5376 norm_overlap=0.9942 corr_cb=-0.4216 topkJ=0.0116
[TRAIN][ep=022] loss=0.8664 acc=68.59%
[TRAIN][ep=022] mask_avg: mc_mean=0.1881 mb_mean=0.5376 norm_overlap=0.9949 corr_cb=-0.3413
[EPOCH 022/089] train: loss=0.8664 acc=68.59% | val: loss=0.7119 acc=57.83% f1=70.59% auc=58.20% val_score=34.7553 val_score_bestthr=64.6159 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.188, mb=0.538, no=0.995, corr=-0.341) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 64.6159
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2102 mb_mean=0.5360 norm_overlap=0.9954 corr_cb=-0.3435 topkJ=0.0125
[TRAIN][ep=023] loss=0.8545 acc=70.74%
[TRAIN][ep=023] mask_avg: mc_mean=0.1783 mb_mean=0.5376 norm_overlap=0.9949 corr_cb=-0.3147
[EPOCH 023/089] train: loss=0.8545 acc=70.74% | val: loss=0.7065 acc=57.83% f1=70.59% auc=58.95% val_score=46.5503 val_score_bestthr=64.6159 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.178, mb=0.538, no=0.995, corr=-0.315) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 64.6159
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1686 mb_mean=0.5388 norm_overlap=0.9943 corr_cb=-0.3054 topkJ=0.0300
[TRAIN][ep=024] loss=0.8566 acc=69.40%
[TRAIN][ep=024] mask_avg: mc_mean=0.1752 mb_mean=0.5376 norm_overlap=0.9947 corr_cb=-0.3144
[EPOCH 024/089] train: loss=0.8566 acc=69.40% | val: loss=0.7020 acc=59.04% f1=71.67% auc=60.06% val_score=51.6383 val_score_bestthr=67.9254 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.175, mb=0.538, no=0.995, corr=-0.314) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 67.9254
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1773 mb_mean=0.5377 norm_overlap=0.9918 corr_cb=-0.4059 topkJ=0.0143
[TRAIN][ep=025] loss=0.8568 acc=68.99%
[TRAIN][ep=025] mask_avg: mc_mean=0.1840 mb_mean=0.5376 norm_overlap=0.9948 corr_cb=-0.3130
[EPOCH 025/089] train: loss=0.8568 acc=68.99% | val: loss=0.7645 acc=57.83% f1=70.09% auc=57.91% val_score=35.8345 val_score_bestthr=62.2879 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.184, mb=0.538, no=0.995, corr=-0.313) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 62.2879
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1727 mb_mean=0.5373 norm_overlap=0.9945 corr_cb=-0.3182 topkJ=0.0208
[TRAIN][ep=026] loss=0.8502 acc=69.26%
[TRAIN][ep=026] mask_avg: mc_mean=0.1835 mb_mean=0.5376 norm_overlap=0.9946 corr_cb=-0.3387
[EPOCH 026/089] train: loss=0.8502 acc=69.26% | val: loss=0.6984 acc=57.83% f1=71.07% auc=60.58% val_score=52.7523 val_score_bestthr=66.4345 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.183, mb=0.538, no=0.995, corr=-0.339) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 66.4345
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1961 mb_mean=0.5358 norm_overlap=0.9984 corr_cb=-0.1206 topkJ=0.0552
[TRAIN][ep=027] loss=0.8329 acc=72.48%
[TRAIN][ep=027] mask_avg: mc_mean=0.1810 mb_mean=0.5376 norm_overlap=0.9945 corr_cb=-0.3240
[EPOCH 027/089] train: loss=0.8329 acc=72.48% | val: loss=0.7093 acc=57.83% f1=71.07% auc=60.41% val_score=53.0285 val_score_bestthr=66.4345 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.181, mb=0.538, no=0.995, corr=-0.324) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 66.4345
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1987 mb_mean=0.5361 norm_overlap=0.9948 corr_cb=-0.3260 topkJ=0.0134
[TRAIN][ep=028] loss=0.8357 acc=71.28%
[TRAIN][ep=028] mask_avg: mc_mean=0.1769 mb_mean=0.5376 norm_overlap=0.9945 corr_cb=-0.3076
[EPOCH 028/089] train: loss=0.8357 acc=71.28% | val: loss=0.7053 acc=57.83% f1=70.59% auc=60.35% val_score=48.6143 val_score_bestthr=64.6159 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.177, mb=0.538, no=0.995, corr=-0.308) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 64.6159
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.1883 mb_mean=0.5390 norm_overlap=0.9925 corr_cb=-0.3803 topkJ=0.0155
[TRAIN][ep=029] loss=0.8240 acc=70.74%
[TRAIN][ep=029] mask_avg: mc_mean=0.1949 mb_mean=0.5376 norm_overlap=0.9946 corr_cb=-0.3218
[EPOCH 029/089] train: loss=0.8240 acc=70.74% | val: loss=0.7115 acc=57.83% f1=70.59% auc=60.29% val_score=51.7537 val_score_bestthr=64.6159 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.195, mb=0.538, no=0.995, corr=-0.322) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 64.6159
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2290 mb_mean=0.5360 norm_overlap=0.9966 corr_cb=-0.2497 topkJ=0.0171
[TRAIN][ep=030] loss=0.8272 acc=71.95%
[TRAIN][ep=030] mask_avg: mc_mean=0.1806 mb_mean=0.5376 norm_overlap=0.9945 corr_cb=-0.3028
[EPOCH 030/089] train: loss=0.8272 acc=71.95% | val: loss=0.8068 acc=61.45% f1=67.35% auc=58.26% val_score=37.3892 val_score_bestthr=60.1710 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.181, mb=0.538, no=0.994, corr=-0.303) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 60.1710
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2096 mb_mean=0.5363 norm_overlap=0.9969 corr_cb=-0.1818 topkJ=0.0350
[TRAIN][ep=031] loss=0.8283 acc=71.14%
[TRAIN][ep=031] mask_avg: mc_mean=0.1966 mb_mean=0.5376 norm_overlap=0.9948 corr_cb=-0.3045
[EPOCH 031/089] train: loss=0.8283 acc=71.14% | val: loss=0.7303 acc=60.24% f1=71.79% auc=63.84% val_score=56.1506 val_score_bestthr=65.1322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.197, mb=0.538, no=0.995, corr=-0.305) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1322
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1938 mb_mean=0.5378 norm_overlap=0.9932 corr_cb=-0.4851 topkJ=0.0058
[TRAIN][ep=032] loss=0.8364 acc=70.20%
[TRAIN][ep=032] mask_avg: mc_mean=0.2034 mb_mean=0.5376 norm_overlap=0.9948 corr_cb=-0.3215
[EPOCH 032/089] train: loss=0.8364 acc=70.20% | val: loss=0.7045 acc=57.83% f1=70.09% auc=60.99% val_score=52.8269 val_score_bestthr=59.9234 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.203, mb=0.538, no=0.995, corr=-0.321) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 59.9234
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2033 mb_mean=0.5365 norm_overlap=0.9945 corr_cb=-0.3566 topkJ=0.0116
[TRAIN][ep=033] loss=0.8050 acc=73.29%
[TRAIN][ep=033] mask_avg: mc_mean=0.1961 mb_mean=0.5376 norm_overlap=0.9946 corr_cb=-0.3211
[EPOCH 033/089] train: loss=0.8050 acc=73.29% | val: loss=0.7101 acc=57.83% f1=70.59% auc=61.63% val_score=41.5187 val_score_bestthr=64.6159 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.196, mb=0.538, no=0.995, corr=-0.321) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 64.6159
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1849 mb_mean=0.5402 norm_overlap=0.9921 corr_cb=-0.4209 topkJ=0.0016
[TRAIN][ep=034] loss=0.7982 acc=73.56%
[TRAIN][ep=034] mask_avg: mc_mean=0.1958 mb_mean=0.5376 norm_overlap=0.9947 corr_cb=-0.3008
[EPOCH 034/089] train: loss=0.7982 acc=73.56% | val: loss=0.7077 acc=63.86% f1=68.75% auc=62.62% val_score=51.6191 val_score_bestthr=61.2767 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.196, mb=0.538, no=0.995, corr=-0.301) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 61.2767
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.1942 mb_mean=0.5383 norm_overlap=0.9948 corr_cb=-0.3190 topkJ=0.0193
[TRAIN][ep=035] loss=0.8095 acc=72.62%
[TRAIN][ep=035] mask_avg: mc_mean=0.2107 mb_mean=0.5376 norm_overlap=0.9951 corr_cb=-0.2937
[EPOCH 035/089] train: loss=0.8095 acc=72.62% | val: loss=0.7064 acc=59.04% f1=71.19% auc=62.33% val_score=50.8305 val_score_bestthr=65.1533 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.211, mb=0.538, no=0.995, corr=-0.294) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1533
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2420 mb_mean=0.5386 norm_overlap=0.9953 corr_cb=-0.2764 topkJ=0.0184
[TRAIN][ep=036] loss=0.7921 acc=74.50%
[TRAIN][ep=036] mask_avg: mc_mean=0.1893 mb_mean=0.5376 norm_overlap=0.9947 corr_cb=-0.2865
[EPOCH 036/089] train: loss=0.7921 acc=74.50% | val: loss=0.7005 acc=60.24% f1=71.79% auc=63.37% val_score=52.2466 val_score_bestthr=65.1322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.189, mb=0.538, no=0.995, corr=-0.286) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1322
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1948 mb_mean=0.5386 norm_overlap=0.9948 corr_cb=-0.3319 topkJ=0.0132
[TRAIN][ep=037] loss=0.7888 acc=74.63%
[TRAIN][ep=037] mask_avg: mc_mean=0.2207 mb_mean=0.5376 norm_overlap=0.9952 corr_cb=-0.2860
[EPOCH 037/089] train: loss=0.7888 acc=74.63% | val: loss=0.7498 acc=59.04% f1=71.19% auc=62.15% val_score=48.5769 val_score_bestthr=65.1533 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.221, mb=0.538, no=0.995, corr=-0.286) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1533
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.1864 mb_mean=0.5338 norm_overlap=0.9980 corr_cb=-0.1584 topkJ=0.0366
[TRAIN][ep=038] loss=0.7854 acc=73.96%
[TRAIN][ep=038] mask_avg: mc_mean=0.1899 mb_mean=0.5376 norm_overlap=0.9949 corr_cb=-0.2821
[EPOCH 038/089] train: loss=0.7854 acc=73.96% | val: loss=0.7196 acc=60.24% f1=71.79% auc=62.50% val_score=50.8362 val_score_bestthr=65.1322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.538, no=0.995, corr=-0.282) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1322
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.1907 mb_mean=0.5379 norm_overlap=0.9930 corr_cb=-0.4226 topkJ=0.0091
[TRAIN][ep=039] loss=0.7778 acc=74.36%
[TRAIN][ep=039] mask_avg: mc_mean=0.2105 mb_mean=0.5376 norm_overlap=0.9951 corr_cb=-0.2825
[EPOCH 039/089] train: loss=0.7778 acc=74.36% | val: loss=0.7200 acc=60.24% f1=71.79% auc=63.26% val_score=51.4071 val_score_bestthr=65.1322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.210, mb=0.538, no=0.995, corr=-0.283) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1322
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.1475 mb_mean=0.5405 norm_overlap=0.9932 corr_cb=-0.3483 topkJ=0.0063
[TRAIN][ep=040] loss=0.7744 acc=74.77%
[TRAIN][ep=040] mask_avg: mc_mean=0.1934 mb_mean=0.5376 norm_overlap=0.9950 corr_cb=-0.2680
[EPOCH 040/089] train: loss=0.7744 acc=74.77% | val: loss=0.7447 acc=61.45% f1=72.41% auc=64.77% val_score=51.2612 val_score_bestthr=65.1127 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.193, mb=0.538, no=0.995, corr=-0.268) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1127
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.2078 mb_mean=0.5397 norm_overlap=0.9946 corr_cb=-0.2664 topkJ=0.0196
[TRAIN][ep=041] loss=0.7709 acc=74.63%
[TRAIN][ep=041] mask_avg: mc_mean=0.2083 mb_mean=0.5376 norm_overlap=0.9953 corr_cb=-0.2685
[EPOCH 041/089] train: loss=0.7709 acc=74.63% | val: loss=0.7272 acc=60.24% f1=71.79% auc=63.20% val_score=55.3469 val_score_bestthr=65.1322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.208, mb=0.538, no=0.995, corr=-0.268) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1322
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.2256 mb_mean=0.5372 norm_overlap=0.9980 corr_cb=-0.1250 topkJ=0.0259
[TRAIN][ep=042] loss=0.7733 acc=76.64%
[TRAIN][ep=042] mask_avg: mc_mean=0.1963 mb_mean=0.5376 norm_overlap=0.9952 corr_cb=-0.2656
[EPOCH 042/089] train: loss=0.7733 acc=76.64% | val: loss=0.8138 acc=61.45% f1=72.41% auc=65.12% val_score=55.9066 val_score_bestthr=66.2327 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.196, mb=0.538, no=0.995, corr=-0.266) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 66.2327
[EARLY STOP] no improvement for 30 epochs. best_epoch=12
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold3_rep1_seed1003/ckpt_best_fold_3.pt
=============== FIT DONE ===============
[BEST] epoch=12 | val_acc=59.04% | val_f1=71.67% | val_auc=59.19% | val_score=55.3727 | val_score_bestthr=67.9254
[TEST@BEST] thr_used=0.405 | acc=57.97% f1=70.51% auc=65.60% | SP_sex=4.01% EO_sex=2.47% SP_age=7.77% EO_age=8.00%
[TIME] 1.11 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold3_rep1_seed1003/summary_fold_3.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5496 mb_mean=0.5403 norm_overlap=1.0001 corr_cb=0.3519 topkJ=0.1406
[TRAIN][ep=000] loss=0.6940 acc=50.34%
[TRAIN][ep=000] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1607
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5475 mb_mean=0.5372 norm_overlap=1.0001 corr_cb=0.1760 topkJ=0.2310
[TRAIN][ep=001] loss=0.6920 acc=53.02%
[TRAIN][ep=001] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1625
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5445 mb_mean=0.5368 norm_overlap=1.0000 corr_cb=-0.0182 topkJ=0.0374
[TRAIN][ep=002] loss=0.6917 acc=52.08%
[TRAIN][ep=002] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1664
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5469 mb_mean=0.5363 norm_overlap=1.0000 corr_cb=-0.0789 topkJ=0.0102
[TRAIN][ep=003] loss=0.6890 acc=56.78%
[TRAIN][ep=003] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1676
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5430 mb_mean=0.5353 norm_overlap=1.0000 corr_cb=0.0043 topkJ=0.1063
[TRAIN][ep=004] loss=0.6884 acc=55.17%
[TRAIN][ep=004] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1536
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5519 mb_mean=0.5362 norm_overlap=1.0000 corr_cb=0.1233 topkJ=0.0542
[TRAIN][ep=005] loss=0.6865 acc=55.17%
[TRAIN][ep=005] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1638
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5510 mb_mean=0.5382 norm_overlap=1.0001 corr_cb=0.2709 topkJ=0.0754
[TRAIN][ep=006] loss=0.6844 acc=59.06%
[TRAIN][ep=006] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1403
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5482 mb_mean=0.5362 norm_overlap=1.0001 corr_cb=0.1681 topkJ=0.1178
[TRAIN][ep=007] loss=0.6812 acc=58.93%
[TRAIN][ep=007] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1610
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5467 mb_mean=0.5373 norm_overlap=1.0000 corr_cb=-0.0661 topkJ=0.0328
[TRAIN][ep=008] loss=0.6793 acc=60.40%
[TRAIN][ep=008] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1699
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5503 mb_mean=0.5383 norm_overlap=1.0002 corr_cb=0.3963 topkJ=0.1772
[TRAIN][ep=009] loss=0.6764 acc=58.52%
[TRAIN][ep=009] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1600
================= FIT START (fold=3) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.45 select_by=val_score_bestthr | eval_thr_mode=fixed eval_thr_grid=coarse | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5516 mb_mean=0.5395 norm_overlap=1.0000 corr_cb=0.0837 topkJ=0.0302
[TRAIN][ep=000] loss=0.6704 acc=59.33%
[TRAIN][ep=000] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1701
[EPOCH 000/089] train: loss=0.6704 acc=59.33% | val: loss=0.6894 acc=51.81% f1=68.25% auc=56.28% val_score=62.0453 val_score_bestthr=62.0453 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.170) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 62.0453
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep1_seed1003/ckpt_best_fold_3.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5481 mb_mean=0.5374 norm_overlap=1.0000 corr_cb=0.1478 topkJ=0.0522
[TRAIN][ep=001] loss=0.6680 acc=59.33%
[TRAIN][ep=001] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1569
[EPOCH 001/089] train: loss=0.6680 acc=59.33% | val: loss=0.6984 acc=53.01% f1=62.14% auc=49.53% val_score=51.1122 val_score_bestthr=51.1122 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.157) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 51.1122
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5562 mb_mean=0.5396 norm_overlap=1.0002 corr_cb=0.3367 topkJ=0.1809
[TRAIN][ep=002] loss=0.6659 acc=60.94%
[TRAIN][ep=002] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1556
[EPOCH 002/089] train: loss=0.6659 acc=60.94% | val: loss=0.6944 acc=56.63% f1=67.86% auc=51.22% val_score=57.0662 val_score_bestthr=57.0662 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.156) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 57.0662
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5486 mb_mean=0.5364 norm_overlap=1.0000 corr_cb=0.1156 topkJ=0.0623
[TRAIN][ep=003] loss=0.6602 acc=62.55%
[TRAIN][ep=003] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1636
[EPOCH 003/089] train: loss=0.6602 acc=62.55% | val: loss=0.6913 acc=51.81% f1=68.25% auc=58.66% val_score=62.0453 val_score_bestthr=62.0453 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.164) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 62.0453
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5592 mb_mean=0.5394 norm_overlap=1.0001 corr_cb=0.2315 topkJ=0.1445
[TRAIN][ep=004] loss=0.6567 acc=63.89%
[TRAIN][ep=004] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1579
[EPOCH 004/089] train: loss=0.6567 acc=63.89% | val: loss=0.6897 acc=56.63% f1=68.97% auc=54.59% val_score=59.1534 val_score_bestthr=59.1534 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.158) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 59.1534
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5493 mb_mean=0.5373 norm_overlap=1.0000 corr_cb=-0.0651 topkJ=0.0040
[TRAIN][ep=005] loss=1.4411 acc=61.07%
[TRAIN][ep=005] mask_avg: mc_mean=0.4259 mb_mean=0.5376 norm_overlap=0.9993 corr_cb=-0.3829
[EPOCH 005/089] train: loss=1.4411 acc=61.07% | val: loss=0.7093 acc=54.22% f1=54.76% auc=50.81% val_score=41.7026 val_score_bestthr=41.7026 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.426, mb=0.538, no=0.999, corr=-0.383) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 41.7026
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.3585 mb_mean=0.5346 norm_overlap=0.9984 corr_cb=-0.4476 topkJ=0.0190
[TRAIN][ep=006] loss=1.1944 acc=63.36%
[TRAIN][ep=006] mask_avg: mc_mean=0.2800 mb_mean=0.5376 norm_overlap=0.9981 corr_cb=-0.3690
[EPOCH 006/089] train: loss=1.1944 acc=63.36% | val: loss=0.6940 acc=53.01% f1=60.61% auc=53.20% val_score=48.9382 val_score_bestthr=48.9382 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.280, mb=0.538, no=0.998, corr=-0.369) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 48.9382
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2161 mb_mean=0.5371 norm_overlap=0.9978 corr_cb=-0.4331 topkJ=0.0039
[TRAIN][ep=007] loss=0.9720 acc=64.56%
[TRAIN][ep=007] mask_avg: mc_mean=0.2242 mb_mean=0.5376 norm_overlap=0.9974 corr_cb=-0.3630
[EPOCH 007/089] train: loss=0.9720 acc=64.56% | val: loss=0.6854 acc=59.04% f1=71.67% auc=58.20% val_score=66.5254 val_score_bestthr=66.5254 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.040, stage2=False) | mask(mc=0.224, mb=0.538, no=0.997, corr=-0.363) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 62.0453 -> 66.5254
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep1_seed1003/ckpt_best_fold_3.pt
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2361 mb_mean=0.5355 norm_overlap=0.9988 corr_cb=-0.1823 topkJ=0.0862
[TRAIN][ep=008] loss=1.0563 acc=61.88%
[TRAIN][ep=008] mask_avg: mc_mean=0.1983 mb_mean=0.5376 norm_overlap=0.9969 corr_cb=-0.3548
[EPOCH 008/089] train: loss=1.0563 acc=61.88% | val: loss=0.6997 acc=55.42% f1=60.22% auc=53.08% val_score=49.7467 val_score_bestthr=49.7467 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.080, stage2=False) | mask(mc=0.198, mb=0.538, no=0.997, corr=-0.355) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.5254 -> 49.7467
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1703 mb_mean=0.5395 norm_overlap=0.9955 corr_cb=-0.4300 topkJ=0.0127
[TRAIN][ep=009] loss=1.1406 acc=64.56%
[TRAIN][ep=009] mask_avg: mc_mean=0.1833 mb_mean=0.5376 norm_overlap=0.9967 corr_cb=-0.3345
[EPOCH 009/089] train: loss=1.1406 acc=64.56% | val: loss=0.7387 acc=44.58% f1=30.30% auc=50.35% val_score=34.1925 val_score_bestthr=34.1925 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.120, stage2=False) | mask(mc=0.183, mb=0.538, no=0.997, corr=-0.334) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.5254 -> 34.1925
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1516 mb_mean=0.5379 norm_overlap=0.9976 corr_cb=-0.3117 topkJ=0.0175
[TRAIN][ep=010] loss=1.2175 acc=65.10%
[TRAIN][ep=010] mask_avg: mc_mean=0.1832 mb_mean=0.5376 norm_overlap=0.9965 corr_cb=-0.3535
[EPOCH 010/089] train: loss=1.2175 acc=65.10% | val: loss=0.7108 acc=54.22% f1=54.76% auc=53.31% val_score=41.9826 val_score_bestthr=41.9826 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.160, stage2=False) | mask(mc=0.183, mb=0.538, no=0.996, corr=-0.354) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.5254 -> 41.9826
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1533 mb_mean=0.5409 norm_overlap=0.9960 corr_cb=-0.3247 topkJ=0.0199
[TRAIN][ep=011] loss=1.2998 acc=64.97%
[TRAIN][ep=011] mask_avg: mc_mean=0.1734 mb_mean=0.5376 norm_overlap=0.9962 corr_cb=-0.3528
[EPOCH 011/089] train: loss=1.2998 acc=64.97% | val: loss=0.7024 acc=54.22% f1=57.78% auc=54.13% val_score=48.5181 val_score_bestthr=48.5181 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.173, mb=0.538, no=0.996, corr=-0.353) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.5254 -> 48.5181
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1693 mb_mean=0.5345 norm_overlap=0.9986 corr_cb=-0.1843 topkJ=0.0802
[TRAIN][ep=012] loss=1.3745 acc=66.85%
[TRAIN][ep=012] mask_avg: mc_mean=0.1665 mb_mean=0.5376 norm_overlap=0.9961 corr_cb=-0.3311
[EPOCH 012/089] train: loss=1.3745 acc=66.85% | val: loss=0.6906 acc=57.83% f1=70.59% auc=60.41% val_score=61.6739 val_score_bestthr=61.6739 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.167, mb=0.538, no=0.996, corr=-0.331) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.5254 -> 61.6739
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1954 mb_mean=0.5357 norm_overlap=0.9986 corr_cb=-0.1952 topkJ=0.0416
[TRAIN][ep=013] loss=1.1580 acc=65.23%
[TRAIN][ep=013] mask_avg: mc_mean=0.1577 mb_mean=0.5376 norm_overlap=0.9959 corr_cb=-0.3052
[EPOCH 013/089] train: loss=1.1580 acc=65.23% | val: loss=0.7316 acc=51.81% f1=68.25% auc=61.74% val_score=62.0453 val_score_bestthr=62.0453 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.158, mb=0.538, no=0.996, corr=-0.305) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.5254 -> 62.0453
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1490 mb_mean=0.5402 norm_overlap=0.9953 corr_cb=-0.3589 topkJ=0.0020
[TRAIN][ep=014] loss=0.9451 acc=65.91%
[TRAIN][ep=014] mask_avg: mc_mean=0.1655 mb_mean=0.5376 norm_overlap=0.9959 corr_cb=-0.3107
[EPOCH 014/089] train: loss=0.9451 acc=65.91% | val: loss=0.6887 acc=55.42% f1=64.08% auc=57.79% val_score=45.0341 val_score_bestthr=45.0341 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.165, mb=0.538, no=0.996, corr=-0.311) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.5254 -> 45.0341
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1635 mb_mean=0.5349 norm_overlap=0.9962 corr_cb=-0.3455 topkJ=0.0224
[TRAIN][ep=015] loss=0.8926 acc=67.52%
[TRAIN][ep=015] mask_avg: mc_mean=0.1617 mb_mean=0.5376 norm_overlap=0.9955 corr_cb=-0.3162
[EPOCH 015/089] train: loss=0.8926 acc=67.52% | val: loss=0.6915 acc=55.42% f1=64.08% auc=58.26% val_score=45.0341 val_score_bestthr=45.0341 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.162, mb=0.538, no=0.996, corr=-0.316) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.5254 -> 45.0341
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1312 mb_mean=0.5397 norm_overlap=0.9941 corr_cb=-0.3507 topkJ=0.0085
[TRAIN][ep=016] loss=0.8978 acc=65.50%
[TRAIN][ep=016] mask_avg: mc_mean=0.1611 mb_mean=0.5376 norm_overlap=0.9953 corr_cb=-0.3196
[EPOCH 016/089] train: loss=0.8978 acc=65.50% | val: loss=0.7336 acc=51.81% f1=48.72% auc=54.88% val_score=26.2833 val_score_bestthr=26.2833 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.161, mb=0.538, no=0.995, corr=-0.320) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.5254 -> 26.2833
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1854 mb_mean=0.5373 norm_overlap=0.9961 corr_cb=-0.2353 topkJ=0.0444
[TRAIN][ep=017] loss=0.8860 acc=66.71%
[TRAIN][ep=017] mask_avg: mc_mean=0.1677 mb_mean=0.5376 norm_overlap=0.9954 corr_cb=-0.3158
[EPOCH 017/089] train: loss=0.8860 acc=66.71% | val: loss=0.6923 acc=60.24% f1=65.98% auc=58.37% val_score=53.8194 val_score_bestthr=53.8194 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.168, mb=0.538, no=0.995, corr=-0.316) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.5254 -> 53.8194
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1874 mb_mean=0.5362 norm_overlap=0.9975 corr_cb=-0.2108 topkJ=0.0268
[TRAIN][ep=018] loss=0.8742 acc=68.46%
[TRAIN][ep=018] mask_avg: mc_mean=0.1712 mb_mean=0.5376 norm_overlap=0.9954 corr_cb=-0.3054
[EPOCH 018/089] train: loss=0.8742 acc=68.46% | val: loss=0.6921 acc=60.24% f1=65.98% auc=58.55% val_score=53.8194 val_score_bestthr=53.8194 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.171, mb=0.538, no=0.995, corr=-0.305) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.5254 -> 53.8194
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1707 mb_mean=0.5388 norm_overlap=0.9939 corr_cb=-0.3880 topkJ=0.0157
[TRAIN][ep=019] loss=0.8733 acc=68.99%
[TRAIN][ep=019] mask_avg: mc_mean=0.1774 mb_mean=0.5376 norm_overlap=0.9953 corr_cb=-0.3188
[EPOCH 019/089] train: loss=0.8733 acc=68.99% | val: loss=0.7067 acc=56.63% f1=59.09% auc=57.33% val_score=51.0415 val_score_bestthr=51.0415 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.177, mb=0.538, no=0.995, corr=-0.319) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.5254 -> 51.0415
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1607 mb_mean=0.5373 norm_overlap=0.9941 corr_cb=-0.3861 topkJ=0.0044
[TRAIN][ep=020] loss=0.8670 acc=68.19%
[TRAIN][ep=020] mask_avg: mc_mean=0.1785 mb_mean=0.5376 norm_overlap=0.9952 corr_cb=-0.3047
[EPOCH 020/089] train: loss=0.8670 acc=68.19% | val: loss=0.6942 acc=60.24% f1=66.67% auc=60.52% val_score=49.1540 val_score_bestthr=49.1540 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.178, mb=0.538, no=0.995, corr=-0.305) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.5254 -> 49.1540
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2117 mb_mean=0.5381 norm_overlap=0.9958 corr_cb=-0.2895 topkJ=0.0419
[TRAIN][ep=021] loss=0.8695 acc=67.52%
[TRAIN][ep=021] mask_avg: mc_mean=0.1874 mb_mean=0.5376 norm_overlap=0.9951 corr_cb=-0.3301
[EPOCH 021/089] train: loss=0.8695 acc=67.52% | val: loss=0.7003 acc=56.63% f1=67.86% auc=60.76% val_score=56.2573 val_score_bestthr=56.2573 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.187, mb=0.538, no=0.995, corr=-0.330) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.5254 -> 56.2573
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1551 mb_mean=0.5376 norm_overlap=0.9943 corr_cb=-0.4209 topkJ=0.0112
[TRAIN][ep=022] loss=0.8664 acc=68.72%
[TRAIN][ep=022] mask_avg: mc_mean=0.1889 mb_mean=0.5376 norm_overlap=0.9950 corr_cb=-0.3391
[EPOCH 022/089] train: loss=0.8664 acc=68.72% | val: loss=0.7123 acc=56.63% f1=57.14% auc=58.08% val_score=46.5503 val_score_bestthr=46.5503 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.189, mb=0.538, no=0.995, corr=-0.339) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.5254 -> 46.5503
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2101 mb_mean=0.5360 norm_overlap=0.9954 corr_cb=-0.3407 topkJ=0.0125
[TRAIN][ep=023] loss=0.8550 acc=70.60%
[TRAIN][ep=023] mask_avg: mc_mean=0.1794 mb_mean=0.5376 norm_overlap=0.9950 corr_cb=-0.3134
[EPOCH 023/089] train: loss=0.8550 acc=70.60% | val: loss=0.7067 acc=61.45% f1=66.67% auc=58.60% val_score=54.9301 val_score_bestthr=54.9301 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.179, mb=0.538, no=0.995, corr=-0.313) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.5254 -> 54.9301
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1702 mb_mean=0.5388 norm_overlap=0.9944 corr_cb=-0.3056 topkJ=0.0296
[TRAIN][ep=024] loss=0.8568 acc=69.80%
[TRAIN][ep=024] mask_avg: mc_mean=0.1772 mb_mean=0.5376 norm_overlap=0.9948 corr_cb=-0.3142
[EPOCH 024/089] train: loss=0.8568 acc=69.80% | val: loss=0.7021 acc=59.04% f1=66.00% auc=60.06% val_score=47.6520 val_score_bestthr=47.6520 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.177, mb=0.538, no=0.995, corr=-0.314) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.5254 -> 47.6520
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1789 mb_mean=0.5377 norm_overlap=0.9919 corr_cb=-0.4068 topkJ=0.0143
[TRAIN][ep=025] loss=0.8569 acc=68.46%
[TRAIN][ep=025] mask_avg: mc_mean=0.1850 mb_mean=0.5376 norm_overlap=0.9949 corr_cb=-0.3121
[EPOCH 025/089] train: loss=0.8569 acc=68.46% | val: loss=0.7630 acc=49.40% f1=40.00% auc=57.97% val_score=37.8690 val_score_bestthr=37.8690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.185, mb=0.538, no=0.995, corr=-0.312) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.5254 -> 37.8690
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1739 mb_mean=0.5373 norm_overlap=0.9946 corr_cb=-0.3173 topkJ=0.0208
[TRAIN][ep=026] loss=0.8504 acc=68.86%
[TRAIN][ep=026] mask_avg: mc_mean=0.1847 mb_mean=0.5376 norm_overlap=0.9947 corr_cb=-0.3380
[EPOCH 026/089] train: loss=0.8504 acc=68.86% | val: loss=0.6984 acc=59.04% f1=66.00% auc=60.70% val_score=47.6520 val_score_bestthr=47.6520 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.185, mb=0.538, no=0.995, corr=-0.338) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.5254 -> 47.6520
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1965 mb_mean=0.5358 norm_overlap=0.9984 corr_cb=-0.1188 topkJ=0.0556
[TRAIN][ep=027] loss=0.8334 acc=72.35%
[TRAIN][ep=027] mask_avg: mc_mean=0.1807 mb_mean=0.5376 norm_overlap=0.9946 corr_cb=-0.3232
[EPOCH 027/089] train: loss=0.8334 acc=72.35% | val: loss=0.7092 acc=60.24% f1=66.67% auc=60.23% val_score=49.1540 val_score_bestthr=49.1540 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.181, mb=0.538, no=0.995, corr=-0.323) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.5254 -> 49.1540
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1985 mb_mean=0.5361 norm_overlap=0.9948 corr_cb=-0.3258 topkJ=0.0134
[TRAIN][ep=028] loss=0.8363 acc=71.14%
[TRAIN][ep=028] mask_avg: mc_mean=0.1771 mb_mean=0.5376 norm_overlap=0.9946 corr_cb=-0.3073
[EPOCH 028/089] train: loss=0.8363 acc=71.14% | val: loss=0.7055 acc=61.45% f1=65.96% auc=60.29% val_score=55.3783 val_score_bestthr=55.3783 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.177, mb=0.538, no=0.995, corr=-0.307) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.5254 -> 55.3783
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.1890 mb_mean=0.5390 norm_overlap=0.9926 corr_cb=-0.3800 topkJ=0.0155
[TRAIN][ep=029] loss=0.8246 acc=70.74%
[TRAIN][ep=029] mask_avg: mc_mean=0.1950 mb_mean=0.5376 norm_overlap=0.9947 corr_cb=-0.3221
[EPOCH 029/089] train: loss=0.8246 acc=70.74% | val: loss=0.7116 acc=62.65% f1=68.04% auc=60.23% val_score=51.6383 val_score_bestthr=51.6383 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.195, mb=0.538, no=0.995, corr=-0.322) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.5254 -> 51.6383
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2277 mb_mean=0.5360 norm_overlap=0.9966 corr_cb=-0.2498 topkJ=0.0171
[TRAIN][ep=030] loss=0.8276 acc=72.08%
[TRAIN][ep=030] mask_avg: mc_mean=0.1801 mb_mean=0.5376 norm_overlap=0.9945 corr_cb=-0.3032
[EPOCH 030/089] train: loss=0.8276 acc=72.08% | val: loss=0.8054 acc=53.01% f1=41.79% auc=58.37% val_score=42.2805 val_score_bestthr=42.2805 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.180, mb=0.538, no=0.995, corr=-0.303) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.5254 -> 42.2805
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2096 mb_mean=0.5363 norm_overlap=0.9969 corr_cb=-0.1813 topkJ=0.0350
[TRAIN][ep=031] loss=0.8287 acc=71.01%
[TRAIN][ep=031] mask_avg: mc_mean=0.1965 mb_mean=0.5376 norm_overlap=0.9948 corr_cb=-0.3050
[EPOCH 031/089] train: loss=0.8287 acc=71.01% | val: loss=0.7291 acc=60.24% f1=69.72% auc=63.66% val_score=57.3204 val_score_bestthr=57.3204 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.196, mb=0.538, no=0.995, corr=-0.305) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.5254 -> 57.3204
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1940 mb_mean=0.5378 norm_overlap=0.9932 corr_cb=-0.4880 topkJ=0.0058
[TRAIN][ep=032] loss=0.8368 acc=70.34%
[TRAIN][ep=032] mask_avg: mc_mean=0.2033 mb_mean=0.5376 norm_overlap=0.9948 corr_cb=-0.3224
[EPOCH 032/089] train: loss=0.8368 acc=70.34% | val: loss=0.7043 acc=62.65% f1=67.37% auc=60.81% val_score=57.4430 val_score_bestthr=57.4430 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.203, mb=0.538, no=0.995, corr=-0.322) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.5254 -> 57.4430
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2037 mb_mean=0.5365 norm_overlap=0.9945 corr_cb=-0.3577 topkJ=0.0116
[TRAIN][ep=033] loss=0.8056 acc=73.29%
[TRAIN][ep=033] mask_avg: mc_mean=0.1958 mb_mean=0.5376 norm_overlap=0.9946 corr_cb=-0.3219
[EPOCH 033/089] train: loss=0.8056 acc=73.29% | val: loss=0.7103 acc=61.45% f1=63.64% auc=61.40% val_score=52.2062 val_score_bestthr=52.2062 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.196, mb=0.538, no=0.995, corr=-0.322) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.5254 -> 52.2062
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1846 mb_mean=0.5402 norm_overlap=0.9921 corr_cb=-0.4216 topkJ=0.0016
[TRAIN][ep=034] loss=0.7989 acc=73.69%
[TRAIN][ep=034] mask_avg: mc_mean=0.1954 mb_mean=0.5376 norm_overlap=0.9948 corr_cb=-0.3019
[EPOCH 034/089] train: loss=0.7989 acc=73.69% | val: loss=0.7076 acc=61.45% f1=65.22% auc=62.50% val_score=56.1062 val_score_bestthr=56.1062 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.195, mb=0.538, no=0.995, corr=-0.302) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.5254 -> 56.1062
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.1923 mb_mean=0.5383 norm_overlap=0.9948 corr_cb=-0.3194 topkJ=0.0193
[TRAIN][ep=035] loss=0.8102 acc=72.35%
[TRAIN][ep=035] mask_avg: mc_mean=0.2099 mb_mean=0.5376 norm_overlap=0.9951 corr_cb=-0.2946
[EPOCH 035/089] train: loss=0.8102 acc=72.35% | val: loss=0.7065 acc=60.24% f1=63.74% auc=62.38% val_score=51.7168 val_score_bestthr=51.7168 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.210, mb=0.538, no=0.995, corr=-0.295) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.5254 -> 51.7168
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2413 mb_mean=0.5386 norm_overlap=0.9953 corr_cb=-0.2768 topkJ=0.0184
[TRAIN][ep=036] loss=0.7928 acc=74.63%
[TRAIN][ep=036] mask_avg: mc_mean=0.1894 mb_mean=0.5376 norm_overlap=0.9947 corr_cb=-0.2878
[EPOCH 036/089] train: loss=0.7928 acc=74.63% | val: loss=0.7000 acc=61.45% f1=64.44% auc=63.49% val_score=52.8306 val_score_bestthr=52.8306 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.189, mb=0.538, no=0.995, corr=-0.288) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.5254 -> 52.8306
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1925 mb_mean=0.5386 norm_overlap=0.9947 corr_cb=-0.3354 topkJ=0.0132
[TRAIN][ep=037] loss=0.7895 acc=74.77%
[TRAIN][ep=037] mask_avg: mc_mean=0.2200 mb_mean=0.5376 norm_overlap=0.9952 corr_cb=-0.2878
[EPOCH 037/089] train: loss=0.7895 acc=74.77% | val: loss=0.7496 acc=55.42% f1=51.95% auc=62.38% val_score=48.2712 val_score_bestthr=48.2712 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.220, mb=0.538, no=0.995, corr=-0.288) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.5254 -> 48.2712
[EARLY STOP] no improvement for 30 epochs. best_epoch=7
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold3_rep1_seed1003/ckpt_best_fold_3.pt
=============== FIT DONE ===============
[BEST] epoch=7 | val_acc=59.04% | val_f1=71.67% | val_auc=58.20% | val_score=66.5254 | val_score_bestthr=66.5254
[TEST@BEST] thr_used=0.450 | acc=57.49% f1=69.23% auc=64.41% | SP_sex=6.01% EO_sex=3.41% SP_age=8.69% EO_age=12.00%
[TIME] 0.78 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold3_rep1_seed1003/summary_fold_3.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5496 mb_mean=0.5403 norm_overlap=1.0001 corr_cb=0.3519 topkJ=0.1406
[TRAIN][ep=000] loss=0.6941 acc=50.47%
[TRAIN][ep=000] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1607
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5475 mb_mean=0.5372 norm_overlap=1.0001 corr_cb=0.1760 topkJ=0.2310
[TRAIN][ep=001] loss=0.6918 acc=53.02%
[TRAIN][ep=001] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1625
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5445 mb_mean=0.5368 norm_overlap=1.0000 corr_cb=-0.0182 topkJ=0.0374
[TRAIN][ep=002] loss=0.6911 acc=52.89%
[TRAIN][ep=002] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1664
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5469 mb_mean=0.5363 norm_overlap=1.0000 corr_cb=-0.0789 topkJ=0.0102
[TRAIN][ep=003] loss=0.6880 acc=57.45%
[TRAIN][ep=003] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1676
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5430 mb_mean=0.5353 norm_overlap=1.0000 corr_cb=0.0043 topkJ=0.1063
[TRAIN][ep=004] loss=0.6863 acc=55.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1536
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5519 mb_mean=0.5362 norm_overlap=1.0000 corr_cb=0.1233 topkJ=0.0542
[TRAIN][ep=005] loss=0.6841 acc=54.77%
[TRAIN][ep=005] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1638
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5510 mb_mean=0.5382 norm_overlap=1.0001 corr_cb=0.2709 topkJ=0.0754
[TRAIN][ep=006] loss=0.6814 acc=58.66%
[TRAIN][ep=006] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1403
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5482 mb_mean=0.5362 norm_overlap=1.0001 corr_cb=0.1681 topkJ=0.1178
[TRAIN][ep=007] loss=0.6765 acc=59.33%
[TRAIN][ep=007] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1610
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5467 mb_mean=0.5373 norm_overlap=1.0000 corr_cb=-0.0661 topkJ=0.0328
[TRAIN][ep=008] loss=0.6734 acc=59.73%
[TRAIN][ep=008] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1699
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5503 mb_mean=0.5383 norm_overlap=1.0002 corr_cb=0.3963 topkJ=0.1772
[TRAIN][ep=009] loss=0.6678 acc=57.85%
[TRAIN][ep=009] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1600
================= FIT START (fold=3) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5516 mb_mean=0.5395 norm_overlap=1.0000 corr_cb=0.0837 topkJ=0.0302
[TRAIN][ep=000] loss=0.6601 acc=61.34%
[TRAIN][ep=000] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1701
[EPOCH 000/089] train: loss=0.6601 acc=61.34% | val: loss=0.6887 acc=59.04% f1=71.67% auc=57.73% val_score=62.3022 val_score_bestthr=67.2030 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.170) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 67.2030
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep1_seed1003/ckpt_best_fold_3.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5481 mb_mean=0.5374 norm_overlap=1.0000 corr_cb=0.1478 topkJ=0.0522
[TRAIN][ep=001] loss=0.6562 acc=60.27%
[TRAIN][ep=001] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1569
[EPOCH 001/089] train: loss=0.6562 acc=60.27% | val: loss=0.6934 acc=61.45% f1=71.43% auc=52.15% val_score=38.1845 val_score_bestthr=63.8992 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.157) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.2030 -> 63.8992
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5562 mb_mean=0.5396 norm_overlap=1.0002 corr_cb=0.3367 topkJ=0.1809
[TRAIN][ep=002] loss=0.6546 acc=60.94%
[TRAIN][ep=002] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1556
[EPOCH 002/089] train: loss=0.6546 acc=60.94% | val: loss=0.6945 acc=61.45% f1=71.43% auc=52.91% val_score=38.1845 val_score_bestthr=63.8992 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.156) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.2030 -> 63.8992
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5486 mb_mean=0.5364 norm_overlap=1.0000 corr_cb=0.1156 topkJ=0.0623
[TRAIN][ep=003] loss=0.6461 acc=62.95%
[TRAIN][ep=003] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1636
[EPOCH 003/089] train: loss=0.6461 acc=62.95% | val: loss=0.6917 acc=62.65% f1=69.31% auc=59.19% val_score=58.2372 val_score_bestthr=62.3086 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.164) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.2030 -> 62.3086
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5592 mb_mean=0.5394 norm_overlap=1.0001 corr_cb=0.2315 topkJ=0.1445
[TRAIN][ep=004] loss=0.6401 acc=64.83%
[TRAIN][ep=004] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1579
[EPOCH 004/089] train: loss=0.6401 acc=64.83% | val: loss=0.6900 acc=59.04% f1=70.69% auc=55.93% val_score=50.9895 val_score_bestthr=61.5649 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.158) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.2030 -> 61.5649
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5493 mb_mean=0.5373 norm_overlap=1.0000 corr_cb=-0.0651 topkJ=0.0040
[TRAIN][ep=005] loss=1.3573 acc=63.36%
[TRAIN][ep=005] mask_avg: mc_mean=0.4187 mb_mean=0.5376 norm_overlap=0.9992 corr_cb=-0.3866
[EPOCH 005/089] train: loss=1.3573 acc=63.36% | val: loss=0.7256 acc=57.83% f1=61.54% auc=52.73% val_score=38.0736 val_score_bestthr=56.5650 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.419, mb=0.538, no=0.999, corr=-0.387) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.2030 -> 56.5650
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.3453 mb_mean=0.5346 norm_overlap=0.9983 corr_cb=-0.4449 topkJ=0.0190
[TRAIN][ep=006] loss=1.1369 acc=62.55%
[TRAIN][ep=006] mask_avg: mc_mean=0.2654 mb_mean=0.5376 norm_overlap=0.9979 corr_cb=-0.3699
[EPOCH 006/089] train: loss=1.1369 acc=62.55% | val: loss=0.6857 acc=59.04% f1=71.19% auc=57.56% val_score=48.9790 val_score_bestthr=66.0866 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.265, mb=0.538, no=0.998, corr=-0.370) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.2030 -> 66.0866
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2021 mb_mean=0.5371 norm_overlap=0.9976 corr_cb=-0.4368 topkJ=0.0039
[TRAIN][ep=007] loss=0.9411 acc=63.49%
[TRAIN][ep=007] mask_avg: mc_mean=0.2144 mb_mean=0.5376 norm_overlap=0.9972 corr_cb=-0.3665
[EPOCH 007/089] train: loss=0.9411 acc=63.49% | val: loss=0.6812 acc=59.04% f1=71.67% auc=60.93% val_score=53.6900 val_score_bestthr=67.9254 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.040, stage2=False) | mask(mc=0.214, mb=0.538, no=0.997, corr=-0.367) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 67.2030 -> 67.9254
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep1_seed1003/ckpt_best_fold_3.pt
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2302 mb_mean=0.5355 norm_overlap=0.9988 corr_cb=-0.1891 topkJ=0.0849
[TRAIN][ep=008] loss=1.0092 acc=64.03%
[TRAIN][ep=008] mask_avg: mc_mean=0.1927 mb_mean=0.5376 norm_overlap=0.9968 corr_cb=-0.3637
[EPOCH 008/089] train: loss=1.0092 acc=64.03% | val: loss=0.6880 acc=59.04% f1=71.19% auc=57.15% val_score=37.1542 val_score_bestthr=66.0866 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.080, stage2=False) | mask(mc=0.193, mb=0.538, no=0.997, corr=-0.364) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 66.0866
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1624 mb_mean=0.5395 norm_overlap=0.9952 corr_cb=-0.4376 topkJ=0.0131
[TRAIN][ep=009] loss=1.0821 acc=64.56%
[TRAIN][ep=009] mask_avg: mc_mean=0.1779 mb_mean=0.5376 norm_overlap=0.9965 corr_cb=-0.3477
[EPOCH 009/089] train: loss=1.0821 acc=64.56% | val: loss=0.7227 acc=55.42% f1=69.42% auc=55.47% val_score=40.0656 val_score_bestthr=60.9231 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.120, stage2=False) | mask(mc=0.178, mb=0.538, no=0.997, corr=-0.348) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 60.9231
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1468 mb_mean=0.5379 norm_overlap=0.9973 corr_cb=-0.3398 topkJ=0.0151
[TRAIN][ep=010] loss=1.1487 acc=65.50%
[TRAIN][ep=010] mask_avg: mc_mean=0.1792 mb_mean=0.5376 norm_overlap=0.9963 corr_cb=-0.3725
[EPOCH 010/089] train: loss=1.1487 acc=65.50% | val: loss=0.6917 acc=59.04% f1=71.19% auc=57.44% val_score=35.6917 val_score_bestthr=66.0866 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.160, stage2=False) | mask(mc=0.179, mb=0.538, no=0.996, corr=-0.372) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 66.0866
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1495 mb_mean=0.5409 norm_overlap=0.9956 corr_cb=-0.3531 topkJ=0.0187
[TRAIN][ep=011] loss=1.2183 acc=67.11%
[TRAIN][ep=011] mask_avg: mc_mean=0.1712 mb_mean=0.5376 norm_overlap=0.9959 corr_cb=-0.3778
[EPOCH 011/089] train: loss=1.2183 acc=67.11% | val: loss=0.7162 acc=57.83% f1=70.09% auc=56.57% val_score=37.7166 val_score_bestthr=62.8622 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.171, mb=0.538, no=0.996, corr=-0.378) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 62.8622
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1676 mb_mean=0.5345 norm_overlap=0.9984 corr_cb=-0.2088 topkJ=0.0789
[TRAIN][ep=012] loss=1.2805 acc=67.92%
[TRAIN][ep=012] mask_avg: mc_mean=0.1629 mb_mean=0.5376 norm_overlap=0.9958 corr_cb=-0.3611
[EPOCH 012/089] train: loss=1.2805 acc=67.92% | val: loss=0.6876 acc=59.04% f1=71.67% auc=61.92% val_score=51.2186 val_score_bestthr=67.9254 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.163, mb=0.538, no=0.996, corr=-0.361) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 67.9254
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1942 mb_mean=0.5357 norm_overlap=0.9983 corr_cb=-0.2393 topkJ=0.0381
[TRAIN][ep=013] loss=1.0945 acc=67.25%
[TRAIN][ep=013] mask_avg: mc_mean=0.1538 mb_mean=0.5376 norm_overlap=0.9955 corr_cb=-0.3422
[EPOCH 013/089] train: loss=1.0945 acc=67.25% | val: loss=0.7313 acc=61.45% f1=72.41% auc=63.26% val_score=65.3145 val_score_bestthr=64.4737 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.154, mb=0.538, no=0.996, corr=-0.342) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 64.4737
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1449 mb_mean=0.5402 norm_overlap=0.9950 corr_cb=-0.3941 topkJ=0.0020
[TRAIN][ep=014] loss=0.9088 acc=67.25%
[TRAIN][ep=014] mask_avg: mc_mean=0.1638 mb_mean=0.5376 norm_overlap=0.9955 corr_cb=-0.3584
[EPOCH 014/089] train: loss=0.9088 acc=67.25% | val: loss=0.6834 acc=59.04% f1=71.67% auc=61.28% val_score=55.1065 val_score_bestthr=67.9254 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.164, mb=0.538, no=0.995, corr=-0.358) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 67.9254
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1589 mb_mean=0.5349 norm_overlap=0.9958 corr_cb=-0.4122 topkJ=0.0203
[TRAIN][ep=015] loss=0.8762 acc=67.79%
[TRAIN][ep=015] mask_avg: mc_mean=0.1580 mb_mean=0.5376 norm_overlap=0.9950 corr_cb=-0.3749
[EPOCH 015/089] train: loss=0.8762 acc=67.79% | val: loss=0.6888 acc=57.83% f1=70.59% auc=60.29% val_score=51.8129 val_score_bestthr=64.6159 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.158, mb=0.538, no=0.995, corr=-0.375) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 64.6159
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1308 mb_mean=0.5397 norm_overlap=0.9935 corr_cb=-0.4346 topkJ=0.0077
[TRAIN][ep=016] loss=0.8794 acc=67.79%
[TRAIN][ep=016] mask_avg: mc_mean=0.1619 mb_mean=0.5376 norm_overlap=0.9947 corr_cb=-0.3957
[EPOCH 016/089] train: loss=0.8794 acc=67.79% | val: loss=0.7776 acc=59.04% f1=67.31% auc=57.09% val_score=37.0115 val_score_bestthr=59.6594 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.162, mb=0.538, no=0.995, corr=-0.396) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 59.6594
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1761 mb_mean=0.5373 norm_overlap=0.9954 corr_cb=-0.2833 topkJ=0.0448
[TRAIN][ep=017] loss=0.8678 acc=67.79%
[TRAIN][ep=017] mask_avg: mc_mean=0.1660 mb_mean=0.5376 norm_overlap=0.9946 corr_cb=-0.4070
[EPOCH 017/089] train: loss=0.8678 acc=67.79% | val: loss=0.6823 acc=61.45% f1=70.91% auc=62.09% val_score=51.0849 val_score_bestthr=60.7200 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.166, mb=0.538, no=0.995, corr=-0.407) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 60.7200
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1882 mb_mean=0.5362 norm_overlap=0.9969 corr_cb=-0.2964 topkJ=0.0281
[TRAIN][ep=018] loss=0.8505 acc=71.81%
[TRAIN][ep=018] mask_avg: mc_mean=0.1735 mb_mean=0.5376 norm_overlap=0.9948 corr_cb=-0.3920
[EPOCH 018/089] train: loss=0.8505 acc=71.81% | val: loss=0.6846 acc=57.83% f1=71.07% auc=61.98% val_score=51.7537 val_score_bestthr=66.4345 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.174, mb=0.538, no=0.995, corr=-0.392) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 66.4345
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1654 mb_mean=0.5388 norm_overlap=0.9933 corr_cb=-0.4717 topkJ=0.0149
[TRAIN][ep=019] loss=0.8505 acc=70.34%
[TRAIN][ep=019] mask_avg: mc_mean=0.1745 mb_mean=0.5376 norm_overlap=0.9945 corr_cb=-0.4111
[EPOCH 019/089] train: loss=0.8505 acc=70.34% | val: loss=0.7052 acc=57.83% f1=70.09% auc=60.64% val_score=41.9157 val_score_bestthr=59.9234 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.175, mb=0.538, no=0.994, corr=-0.411) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 59.9234
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1567 mb_mean=0.5373 norm_overlap=0.9933 corr_cb=-0.4684 topkJ=0.0012
[TRAIN][ep=020] loss=0.8440 acc=71.68%
[TRAIN][ep=020] mask_avg: mc_mean=0.1754 mb_mean=0.5376 norm_overlap=0.9945 corr_cb=-0.3897
[EPOCH 020/089] train: loss=0.8440 acc=71.68% | val: loss=0.6889 acc=57.83% f1=70.59% auc=63.37% val_score=52.7523 val_score_bestthr=64.6159 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.175, mb=0.538, no=0.995, corr=-0.390) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 64.6159
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2047 mb_mean=0.5381 norm_overlap=0.9950 corr_cb=-0.3565 topkJ=0.0390
[TRAIN][ep=021] loss=0.8429 acc=68.32%
[TRAIN][ep=021] mask_avg: mc_mean=0.1740 mb_mean=0.5376 norm_overlap=0.9941 corr_cb=-0.4201
[EPOCH 021/089] train: loss=0.8429 acc=68.32% | val: loss=0.7003 acc=61.45% f1=70.37% auc=63.60% val_score=57.8752 val_score_bestthr=60.6338 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.174, mb=0.538, no=0.994, corr=-0.420) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 60.6338
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1484 mb_mean=0.5376 norm_overlap=0.9933 corr_cb=-0.5183 topkJ=0.0083
[TRAIN][ep=022] loss=0.8400 acc=70.20%
[TRAIN][ep=022] mask_avg: mc_mean=0.1776 mb_mean=0.5376 norm_overlap=0.9940 corr_cb=-0.4310
[EPOCH 022/089] train: loss=0.8400 acc=70.20% | val: loss=0.7081 acc=63.86% f1=68.75% auc=61.22% val_score=44.3512 val_score_bestthr=61.2767 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.178, mb=0.538, no=0.994, corr=-0.431) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 61.2767
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1939 mb_mean=0.5360 norm_overlap=0.9946 corr_cb=-0.4294 topkJ=0.0084
[TRAIN][ep=023] loss=0.8247 acc=71.81%
[TRAIN][ep=023] mask_avg: mc_mean=0.1702 mb_mean=0.5376 norm_overlap=0.9940 corr_cb=-0.3955
[EPOCH 023/089] train: loss=0.8247 acc=71.81% | val: loss=0.7112 acc=63.86% f1=68.75% auc=61.16% val_score=49.1566 val_score_bestthr=61.2767 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.170, mb=0.538, no=0.994, corr=-0.395) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 61.2767
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1618 mb_mean=0.5388 norm_overlap=0.9934 corr_cb=-0.3597 topkJ=0.0296
[TRAIN][ep=024] loss=0.8280 acc=70.07%
[TRAIN][ep=024] mask_avg: mc_mean=0.1619 mb_mean=0.5376 norm_overlap=0.9937 corr_cb=-0.3906
[EPOCH 024/089] train: loss=0.8280 acc=70.07% | val: loss=0.6932 acc=60.24% f1=71.79% auc=64.19% val_score=55.2111 val_score_bestthr=65.1322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.162, mb=0.538, no=0.994, corr=-0.391) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1322
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1563 mb_mean=0.5377 norm_overlap=0.9903 corr_cb=-0.4626 topkJ=0.0130
[TRAIN][ep=025] loss=0.8274 acc=72.08%
[TRAIN][ep=025] mask_avg: mc_mean=0.1721 mb_mean=0.5376 norm_overlap=0.9939 corr_cb=-0.3811
[EPOCH 025/089] train: loss=0.8274 acc=72.08% | val: loss=0.8352 acc=61.45% f1=65.96% auc=60.47% val_score=41.6456 val_score_bestthr=61.1649 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.172, mb=0.538, no=0.994, corr=-0.381) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 61.1649
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1209 mb_mean=0.5373 norm_overlap=0.9930 corr_cb=-0.3623 topkJ=0.0111
[TRAIN][ep=026] loss=0.8215 acc=71.81%
[TRAIN][ep=026] mask_avg: mc_mean=0.1605 mb_mean=0.5376 norm_overlap=0.9933 corr_cb=-0.3997
[EPOCH 026/089] train: loss=0.8215 acc=71.81% | val: loss=0.6845 acc=60.24% f1=71.79% auc=63.95% val_score=59.9061 val_score_bestthr=65.1322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.161, mb=0.538, no=0.993, corr=-0.400) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1322
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1948 mb_mean=0.5358 norm_overlap=0.9977 corr_cb=-0.1871 topkJ=0.0477
[TRAIN][ep=027] loss=0.7979 acc=74.09%
[TRAIN][ep=027] mask_avg: mc_mean=0.1779 mb_mean=0.5376 norm_overlap=0.9937 corr_cb=-0.3897
[EPOCH 027/089] train: loss=0.7979 acc=74.09% | val: loss=0.7042 acc=59.04% f1=71.19% auc=63.02% val_score=57.6757 val_score_bestthr=65.1533 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.178, mb=0.538, no=0.994, corr=-0.390) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1533
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1780 mb_mean=0.5361 norm_overlap=0.9938 corr_cb=-0.3830 topkJ=0.0099
[TRAIN][ep=028] loss=0.8034 acc=73.15%
[TRAIN][ep=028] mask_avg: mc_mean=0.1592 mb_mean=0.5376 norm_overlap=0.9936 corr_cb=-0.3560
[EPOCH 028/089] train: loss=0.8034 acc=73.15% | val: loss=0.6949 acc=60.24% f1=71.79% auc=64.19% val_score=59.9061 val_score_bestthr=65.1322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.159, mb=0.538, no=0.994, corr=-0.356) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1322
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.1716 mb_mean=0.5390 norm_overlap=0.9915 corr_cb=-0.4277 topkJ=0.0111
[TRAIN][ep=029] loss=0.7858 acc=73.96%
[TRAIN][ep=029] mask_avg: mc_mean=0.1864 mb_mean=0.5376 norm_overlap=0.9939 corr_cb=-0.3691
[EPOCH 029/089] train: loss=0.7858 acc=73.96% | val: loss=0.7169 acc=60.24% f1=71.79% auc=64.24% val_score=57.5005 val_score_bestthr=65.1322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.186, mb=0.538, no=0.994, corr=-0.369) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1322
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2425 mb_mean=0.5360 norm_overlap=0.9965 corr_cb=-0.2712 topkJ=0.0183
[TRAIN][ep=030] loss=0.7969 acc=72.75%
[TRAIN][ep=030] mask_avg: mc_mean=0.1684 mb_mean=0.5376 norm_overlap=0.9937 corr_cb=-0.3466
[EPOCH 030/089] train: loss=0.7969 acc=72.75% | val: loss=0.7973 acc=62.65% f1=65.93% auc=62.21% val_score=44.1087 val_score_bestthr=60.6077 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.168, mb=0.538, no=0.994, corr=-0.347) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 60.6077
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.1777 mb_mean=0.5363 norm_overlap=0.9966 corr_cb=-0.1834 topkJ=0.0375
[TRAIN][ep=031] loss=0.7873 acc=75.30%
[TRAIN][ep=031] mask_avg: mc_mean=0.1603 mb_mean=0.5376 norm_overlap=0.9937 corr_cb=-0.3335
[EPOCH 031/089] train: loss=0.7873 acc=75.30% | val: loss=0.7323 acc=61.45% f1=72.41% auc=66.05% val_score=62.7963 val_score_bestthr=65.1127 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.160, mb=0.538, no=0.994, corr=-0.333) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1127
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1520 mb_mean=0.5378 norm_overlap=0.9917 corr_cb=-0.5318 topkJ=0.0012
[TRAIN][ep=032] loss=0.7969 acc=73.02%
[TRAIN][ep=032] mask_avg: mc_mean=0.1652 mb_mean=0.5376 norm_overlap=0.9936 corr_cb=-0.3482
[EPOCH 032/089] train: loss=0.7969 acc=73.02% | val: loss=0.7108 acc=59.04% f1=71.19% auc=63.31% val_score=51.2154 val_score_bestthr=63.8778 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.165, mb=0.538, no=0.994, corr=-0.348) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 63.8778
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1730 mb_mean=0.5365 norm_overlap=0.9940 corr_cb=-0.3402 topkJ=0.0080
[TRAIN][ep=033] loss=0.7647 acc=75.84%
[TRAIN][ep=033] mask_avg: mc_mean=0.1819 mb_mean=0.5376 norm_overlap=0.9941 corr_cb=-0.3375
[EPOCH 033/089] train: loss=0.7647 acc=75.84% | val: loss=0.6958 acc=61.45% f1=72.41% auc=64.83% val_score=55.3469 val_score_bestthr=65.1127 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.182, mb=0.538, no=0.994, corr=-0.337) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1127
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1760 mb_mean=0.5402 norm_overlap=0.9916 corr_cb=-0.4443 topkJ=0.0040
[TRAIN][ep=034] loss=0.7526 acc=76.64%
[TRAIN][ep=034] mask_avg: mc_mean=0.1784 mb_mean=0.5376 norm_overlap=0.9942 corr_cb=-0.3181
[EPOCH 034/089] train: loss=0.7526 acc=76.64% | val: loss=0.7072 acc=61.45% f1=72.41% auc=65.99% val_score=58.1094 val_score_bestthr=65.1127 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.178, mb=0.538, no=0.994, corr=-0.318) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1127
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.1970 mb_mean=0.5383 norm_overlap=0.9937 corr_cb=-0.3922 topkJ=0.0112
[TRAIN][ep=035] loss=0.7639 acc=75.57%
[TRAIN][ep=035] mask_avg: mc_mean=0.2015 mb_mean=0.5376 norm_overlap=0.9948 corr_cb=-0.3063
[EPOCH 035/089] train: loss=0.7639 acc=75.57% | val: loss=0.6987 acc=61.45% f1=72.41% auc=66.40% val_score=54.6632 val_score_bestthr=65.1127 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.202, mb=0.538, no=0.995, corr=-0.306) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1127
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2149 mb_mean=0.5386 norm_overlap=0.9945 corr_cb=-0.2924 topkJ=0.0114
[TRAIN][ep=036] loss=0.7507 acc=76.64%
[TRAIN][ep=036] mask_avg: mc_mean=0.1624 mb_mean=0.5376 norm_overlap=0.9941 corr_cb=-0.2905
[EPOCH 036/089] train: loss=0.7507 acc=76.64% | val: loss=0.6865 acc=60.24% f1=71.79% auc=67.09% val_score=56.7469 val_score_bestthr=63.8567 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.162, mb=0.538, no=0.994, corr=-0.291) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 63.8567
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1846 mb_mean=0.5386 norm_overlap=0.9942 corr_cb=-0.3546 topkJ=0.0097
[TRAIN][ep=037] loss=0.7420 acc=76.24%
[TRAIN][ep=037] mask_avg: mc_mean=0.2140 mb_mean=0.5376 norm_overlap=0.9949 corr_cb=-0.2949
[EPOCH 037/089] train: loss=0.7420 acc=76.24% | val: loss=0.7251 acc=61.45% f1=72.41% auc=65.64% val_score=49.6152 val_score_bestthr=65.1127 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.214, mb=0.538, no=0.995, corr=-0.295) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1127
[EARLY STOP] no improvement for 30 epochs. best_epoch=7
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold3_rep1_seed1003/ckpt_best_fold_3.pt
=============== FIT DONE ===============
[BEST] epoch=7 | val_acc=59.04% | val_f1=71.67% | val_auc=60.93% | val_score=53.6900 | val_score_bestthr=67.9254
[TEST@BEST] thr_used=0.425 | acc=57.97% f1=69.69% auc=65.60% | SP_sex=5.42% EO_sex=2.17% SP_age=8.69% EO_age=12.00%
[TIME] 0.98 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold3_rep1_seed1003/summary_fold_3.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5496 mb_mean=0.5403 norm_overlap=1.0001 corr_cb=0.3519 topkJ=0.1406
[TRAIN][ep=000] loss=0.6941 acc=50.47%
[TRAIN][ep=000] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1607
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5475 mb_mean=0.5372 norm_overlap=1.0001 corr_cb=0.1760 topkJ=0.2310
[TRAIN][ep=001] loss=0.6918 acc=53.02%
[TRAIN][ep=001] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1625
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5445 mb_mean=0.5368 norm_overlap=1.0000 corr_cb=-0.0182 topkJ=0.0374
[TRAIN][ep=002] loss=0.6911 acc=52.89%
[TRAIN][ep=002] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1664
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5469 mb_mean=0.5363 norm_overlap=1.0000 corr_cb=-0.0789 topkJ=0.0102
[TRAIN][ep=003] loss=0.6880 acc=57.45%
[TRAIN][ep=003] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1676
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5430 mb_mean=0.5353 norm_overlap=1.0000 corr_cb=0.0043 topkJ=0.1063
[TRAIN][ep=004] loss=0.6863 acc=55.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1536
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5519 mb_mean=0.5362 norm_overlap=1.0000 corr_cb=0.1233 topkJ=0.0542
[TRAIN][ep=005] loss=0.6841 acc=54.77%
[TRAIN][ep=005] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1638
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5510 mb_mean=0.5382 norm_overlap=1.0001 corr_cb=0.2709 topkJ=0.0754
[TRAIN][ep=006] loss=0.6814 acc=58.66%
[TRAIN][ep=006] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1403
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5482 mb_mean=0.5362 norm_overlap=1.0001 corr_cb=0.1681 topkJ=0.1178
[TRAIN][ep=007] loss=0.6765 acc=59.33%
[TRAIN][ep=007] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1610
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5467 mb_mean=0.5373 norm_overlap=1.0000 corr_cb=-0.0661 topkJ=0.0328
[TRAIN][ep=008] loss=0.6734 acc=59.73%
[TRAIN][ep=008] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1699
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5503 mb_mean=0.5383 norm_overlap=1.0002 corr_cb=0.3963 topkJ=0.1772
[TRAIN][ep=009] loss=0.6678 acc=57.85%
[TRAIN][ep=009] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1600
================= FIT START (fold=3) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5516 mb_mean=0.5395 norm_overlap=1.0000 corr_cb=0.0837 topkJ=0.0302
[TRAIN][ep=000] loss=0.6601 acc=61.34%
[TRAIN][ep=000] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1701
[EPOCH 000/089] train: loss=0.6601 acc=61.34% | val: loss=0.6887 acc=59.04% f1=71.67% auc=57.73% val_score=62.3022 val_score_bestthr=67.2030 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.170) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 67.2030
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep1_seed1003/ckpt_best_fold_3.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5481 mb_mean=0.5374 norm_overlap=1.0000 corr_cb=0.1478 topkJ=0.0522
[TRAIN][ep=001] loss=0.6562 acc=60.27%
[TRAIN][ep=001] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1569
[EPOCH 001/089] train: loss=0.6562 acc=60.27% | val: loss=0.6934 acc=61.45% f1=71.43% auc=52.09% val_score=38.1845 val_score_bestthr=63.8992 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.157) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.2030 -> 63.8992
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5562 mb_mean=0.5396 norm_overlap=1.0002 corr_cb=0.3367 topkJ=0.1809
[TRAIN][ep=002] loss=0.6546 acc=60.94%
[TRAIN][ep=002] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1556
[EPOCH 002/089] train: loss=0.6546 acc=60.94% | val: loss=0.6945 acc=61.45% f1=71.43% auc=52.91% val_score=38.1845 val_score_bestthr=63.8992 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.156) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.2030 -> 63.8992
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5486 mb_mean=0.5364 norm_overlap=1.0000 corr_cb=0.1156 topkJ=0.0623
[TRAIN][ep=003] loss=0.6461 acc=62.95%
[TRAIN][ep=003] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1636
[EPOCH 003/089] train: loss=0.6461 acc=62.95% | val: loss=0.6917 acc=62.65% f1=69.31% auc=59.19% val_score=58.2372 val_score_bestthr=62.3086 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.164) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.2030 -> 62.3086
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5592 mb_mean=0.5394 norm_overlap=1.0001 corr_cb=0.2315 topkJ=0.1445
[TRAIN][ep=004] loss=0.6401 acc=64.83%
[TRAIN][ep=004] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1579
[EPOCH 004/089] train: loss=0.6401 acc=64.83% | val: loss=0.6900 acc=59.04% f1=70.69% auc=55.93% val_score=50.9895 val_score_bestthr=61.5649 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.158) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.2030 -> 61.5649
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5493 mb_mean=0.5373 norm_overlap=1.0000 corr_cb=-0.0651 topkJ=0.0040
[TRAIN][ep=005] loss=1.5364 acc=63.09%
[TRAIN][ep=005] mask_avg: mc_mean=0.4224 mb_mean=0.5376 norm_overlap=0.9992 corr_cb=-0.3884
[EPOCH 005/089] train: loss=1.5364 acc=63.09% | val: loss=0.7262 acc=56.63% f1=60.87% auc=52.44% val_score=37.3493 val_score_bestthr=56.5770 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.422, mb=0.538, no=0.999, corr=-0.388) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.2030 -> 56.5770
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.3488 mb_mean=0.5346 norm_overlap=0.9983 corr_cb=-0.4462 topkJ=0.0190
[TRAIN][ep=006] loss=1.2424 acc=62.95%
[TRAIN][ep=006] mask_avg: mc_mean=0.2676 mb_mean=0.5376 norm_overlap=0.9979 corr_cb=-0.3713
[EPOCH 006/089] train: loss=1.2424 acc=62.95% | val: loss=0.6862 acc=59.04% f1=70.69% auc=57.50% val_score=48.9790 val_score_bestthr=61.5649 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.268, mb=0.538, no=0.998, corr=-0.371) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.2030 -> 61.5649
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2028 mb_mean=0.5371 norm_overlap=0.9976 corr_cb=-0.4374 topkJ=0.0039
[TRAIN][ep=007] loss=0.9768 acc=63.22%
[TRAIN][ep=007] mask_avg: mc_mean=0.2142 mb_mean=0.5376 norm_overlap=0.9972 corr_cb=-0.3674
[EPOCH 007/089] train: loss=0.9768 acc=63.22% | val: loss=0.6815 acc=59.04% f1=71.67% auc=60.99% val_score=52.3206 val_score_bestthr=67.9254 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.040, stage2=False) | mask(mc=0.214, mb=0.538, no=0.997, corr=-0.367) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 67.2030 -> 67.9254
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep1_seed1003/ckpt_best_fold_3.pt
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2298 mb_mean=0.5355 norm_overlap=0.9988 corr_cb=-0.1892 topkJ=0.0844
[TRAIN][ep=008] loss=1.0728 acc=64.30%
[TRAIN][ep=008] mask_avg: mc_mean=0.1924 mb_mean=0.5376 norm_overlap=0.9968 corr_cb=-0.3656
[EPOCH 008/089] train: loss=1.0728 acc=64.30% | val: loss=0.6882 acc=59.04% f1=71.19% auc=56.98% val_score=38.7087 val_score_bestthr=66.0866 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.080, stage2=False) | mask(mc=0.192, mb=0.538, no=0.997, corr=-0.366) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 66.0866
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1629 mb_mean=0.5395 norm_overlap=0.9952 corr_cb=-0.4408 topkJ=0.0131
[TRAIN][ep=009] loss=1.1737 acc=64.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.1766 mb_mean=0.5376 norm_overlap=0.9965 corr_cb=-0.3486
[EPOCH 009/089] train: loss=1.1737 acc=64.70% | val: loss=0.7227 acc=55.42% f1=69.42% auc=55.41% val_score=40.0656 val_score_bestthr=60.9231 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.120, stage2=False) | mask(mc=0.177, mb=0.538, no=0.997, corr=-0.349) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 60.9231
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1459 mb_mean=0.5379 norm_overlap=0.9973 corr_cb=-0.3430 topkJ=0.0143
[TRAIN][ep=010] loss=1.2678 acc=65.23%
[TRAIN][ep=010] mask_avg: mc_mean=0.1791 mb_mean=0.5376 norm_overlap=0.9962 corr_cb=-0.3735
[EPOCH 010/089] train: loss=1.2678 acc=65.23% | val: loss=0.6918 acc=59.04% f1=71.19% auc=57.38% val_score=36.7942 val_score_bestthr=66.0866 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.160, stage2=False) | mask(mc=0.179, mb=0.538, no=0.996, corr=-0.374) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 66.0866
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1490 mb_mean=0.5409 norm_overlap=0.9956 corr_cb=-0.3538 topkJ=0.0187
[TRAIN][ep=011] loss=1.3656 acc=66.98%
[TRAIN][ep=011] mask_avg: mc_mean=0.1709 mb_mean=0.5376 norm_overlap=0.9959 corr_cb=-0.3787
[EPOCH 011/089] train: loss=1.3656 acc=66.98% | val: loss=0.7158 acc=59.04% f1=70.69% auc=56.45% val_score=36.3074 val_score_bestthr=62.5605 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.171, mb=0.538, no=0.996, corr=-0.379) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 62.5605
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1680 mb_mean=0.5345 norm_overlap=0.9984 corr_cb=-0.2101 topkJ=0.0789
[TRAIN][ep=012] loss=1.4556 acc=67.92%
[TRAIN][ep=012] mask_avg: mc_mean=0.1627 mb_mean=0.5376 norm_overlap=0.9958 corr_cb=-0.3621
[EPOCH 012/089] train: loss=1.4556 acc=67.92% | val: loss=0.6874 acc=59.04% f1=71.67% auc=61.86% val_score=51.2186 val_score_bestthr=67.9254 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.163, mb=0.538, no=0.996, corr=-0.362) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 67.9254
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1932 mb_mean=0.5357 norm_overlap=0.9983 corr_cb=-0.2378 topkJ=0.0377
[TRAIN][ep=013] loss=1.1999 acc=66.98%
[TRAIN][ep=013] mask_avg: mc_mean=0.1527 mb_mean=0.5376 norm_overlap=0.9955 corr_cb=-0.3412
[EPOCH 013/089] train: loss=1.1999 acc=66.98% | val: loss=0.7313 acc=61.45% f1=72.41% auc=63.31% val_score=65.3145 val_score_bestthr=64.4737 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.153, mb=0.538, no=0.996, corr=-0.341) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 64.4737
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1443 mb_mean=0.5402 norm_overlap=0.9950 corr_cb=-0.3932 topkJ=0.0020
[TRAIN][ep=014] loss=0.9443 acc=67.11%
[TRAIN][ep=014] mask_avg: mc_mean=0.1625 mb_mean=0.5376 norm_overlap=0.9955 corr_cb=-0.3568
[EPOCH 014/089] train: loss=0.9443 acc=67.11% | val: loss=0.6832 acc=59.04% f1=71.67% auc=61.28% val_score=55.1065 val_score_bestthr=67.9254 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.162, mb=0.538, no=0.995, corr=-0.357) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 67.9254
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1574 mb_mean=0.5349 norm_overlap=0.9957 corr_cb=-0.4103 topkJ=0.0207
[TRAIN][ep=015] loss=0.8768 acc=67.65%
[TRAIN][ep=015] mask_avg: mc_mean=0.1569 mb_mean=0.5376 norm_overlap=0.9950 corr_cb=-0.3726
[EPOCH 015/089] train: loss=0.8768 acc=67.65% | val: loss=0.6885 acc=57.83% f1=70.59% auc=60.06% val_score=48.6883 val_score_bestthr=64.6159 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.157, mb=0.538, no=0.995, corr=-0.373) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 64.6159
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1302 mb_mean=0.5397 norm_overlap=0.9935 corr_cb=-0.4321 topkJ=0.0077
[TRAIN][ep=016] loss=0.8800 acc=67.92%
[TRAIN][ep=016] mask_avg: mc_mean=0.1619 mb_mean=0.5376 norm_overlap=0.9947 corr_cb=-0.3935
[EPOCH 016/089] train: loss=0.8800 acc=67.92% | val: loss=0.7777 acc=59.04% f1=67.31% auc=57.15% val_score=37.0115 val_score_bestthr=59.6594 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.162, mb=0.538, no=0.995, corr=-0.394) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 59.6594
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1769 mb_mean=0.5373 norm_overlap=0.9954 corr_cb=-0.2840 topkJ=0.0448
[TRAIN][ep=017] loss=0.8683 acc=67.65%
[TRAIN][ep=017] mask_avg: mc_mean=0.1657 mb_mean=0.5376 norm_overlap=0.9946 corr_cb=-0.4045
[EPOCH 017/089] train: loss=0.8683 acc=67.65% | val: loss=0.6822 acc=61.45% f1=70.91% auc=62.09% val_score=51.0849 val_score_bestthr=60.7200 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.166, mb=0.538, no=0.995, corr=-0.404) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 60.7200
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1879 mb_mean=0.5362 norm_overlap=0.9969 corr_cb=-0.2924 topkJ=0.0285
[TRAIN][ep=018] loss=0.8510 acc=71.68%
[TRAIN][ep=018] mask_avg: mc_mean=0.1729 mb_mean=0.5376 norm_overlap=0.9948 corr_cb=-0.3874
[EPOCH 018/089] train: loss=0.8510 acc=71.68% | val: loss=0.6844 acc=57.83% f1=71.07% auc=61.98% val_score=51.7537 val_score_bestthr=66.4345 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.173, mb=0.538, no=0.995, corr=-0.387) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 66.4345
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1647 mb_mean=0.5388 norm_overlap=0.9933 corr_cb=-0.4673 topkJ=0.0153
[TRAIN][ep=019] loss=0.8511 acc=70.20%
[TRAIN][ep=019] mask_avg: mc_mean=0.1733 mb_mean=0.5376 norm_overlap=0.9945 corr_cb=-0.4059
[EPOCH 019/089] train: loss=0.8511 acc=70.20% | val: loss=0.7052 acc=57.83% f1=70.09% auc=60.41% val_score=41.9157 val_score_bestthr=59.9234 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.173, mb=0.538, no=0.994, corr=-0.406) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 59.9234
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1554 mb_mean=0.5373 norm_overlap=0.9933 corr_cb=-0.4642 topkJ=0.0012
[TRAIN][ep=020] loss=0.8447 acc=71.68%
[TRAIN][ep=020] mask_avg: mc_mean=0.1741 mb_mean=0.5376 norm_overlap=0.9945 corr_cb=-0.3860
[EPOCH 020/089] train: loss=0.8447 acc=71.68% | val: loss=0.6889 acc=57.83% f1=70.59% auc=63.31% val_score=52.7523 val_score_bestthr=64.6159 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.174, mb=0.538, no=0.994, corr=-0.386) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 64.6159
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2033 mb_mean=0.5381 norm_overlap=0.9950 corr_cb=-0.3519 topkJ=0.0390
[TRAIN][ep=021] loss=0.8431 acc=68.19%
[TRAIN][ep=021] mask_avg: mc_mean=0.1729 mb_mean=0.5376 norm_overlap=0.9941 corr_cb=-0.4152
[EPOCH 021/089] train: loss=0.8431 acc=68.19% | val: loss=0.7012 acc=57.83% f1=71.07% auc=63.60% val_score=54.3001 val_score_bestthr=66.4345 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.173, mb=0.538, no=0.994, corr=-0.415) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 66.4345
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1479 mb_mean=0.5376 norm_overlap=0.9933 corr_cb=-0.5138 topkJ=0.0083
[TRAIN][ep=022] loss=0.8405 acc=69.93%
[TRAIN][ep=022] mask_avg: mc_mean=0.1783 mb_mean=0.5376 norm_overlap=0.9940 corr_cb=-0.4270
[EPOCH 022/089] train: loss=0.8405 acc=69.93% | val: loss=0.7078 acc=63.86% f1=68.75% auc=61.10% val_score=44.3512 val_score_bestthr=61.2767 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.178, mb=0.538, no=0.994, corr=-0.427) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 61.2767
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1944 mb_mean=0.5360 norm_overlap=0.9946 corr_cb=-0.4255 topkJ=0.0084
[TRAIN][ep=023] loss=0.8251 acc=71.95%
[TRAIN][ep=023] mask_avg: mc_mean=0.1700 mb_mean=0.5376 norm_overlap=0.9940 corr_cb=-0.3916
[EPOCH 023/089] train: loss=0.8251 acc=71.95% | val: loss=0.7112 acc=63.86% f1=68.75% auc=61.28% val_score=49.1566 val_score_bestthr=61.2767 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.170, mb=0.538, no=0.994, corr=-0.392) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 61.2767
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1618 mb_mean=0.5388 norm_overlap=0.9935 corr_cb=-0.3545 topkJ=0.0296
[TRAIN][ep=024] loss=0.8286 acc=70.07%
[TRAIN][ep=024] mask_avg: mc_mean=0.1617 mb_mean=0.5376 norm_overlap=0.9937 corr_cb=-0.3871
[EPOCH 024/089] train: loss=0.8286 acc=70.07% | val: loss=0.6930 acc=60.24% f1=71.79% auc=64.01% val_score=55.2111 val_score_bestthr=65.1322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.162, mb=0.538, no=0.994, corr=-0.387) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1322
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1556 mb_mean=0.5377 norm_overlap=0.9903 corr_cb=-0.4576 topkJ=0.0130
[TRAIN][ep=025] loss=0.8278 acc=72.08%
[TRAIN][ep=025] mask_avg: mc_mean=0.1710 mb_mean=0.5376 norm_overlap=0.9939 corr_cb=-0.3776
[EPOCH 025/089] train: loss=0.8278 acc=72.08% | val: loss=0.8361 acc=61.45% f1=65.96% auc=60.17% val_score=41.6456 val_score_bestthr=61.1649 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.171, mb=0.538, no=0.994, corr=-0.378) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 61.1649
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1212 mb_mean=0.5373 norm_overlap=0.9930 corr_cb=-0.3601 topkJ=0.0127
[TRAIN][ep=026] loss=0.8220 acc=71.81%
[TRAIN][ep=026] mask_avg: mc_mean=0.1611 mb_mean=0.5376 norm_overlap=0.9933 corr_cb=-0.3976
[EPOCH 026/089] train: loss=0.8220 acc=71.81% | val: loss=0.6841 acc=60.24% f1=71.79% auc=63.90% val_score=58.7897 val_score_bestthr=65.1322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.161, mb=0.538, no=0.993, corr=-0.398) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1322
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1950 mb_mean=0.5358 norm_overlap=0.9977 corr_cb=-0.1855 topkJ=0.0473
[TRAIN][ep=027] loss=0.7984 acc=74.09%
[TRAIN][ep=027] mask_avg: mc_mean=0.1777 mb_mean=0.5376 norm_overlap=0.9937 corr_cb=-0.3867
[EPOCH 027/089] train: loss=0.7984 acc=74.09% | val: loss=0.7037 acc=59.04% f1=71.19% auc=63.02% val_score=57.6757 val_score_bestthr=65.1533 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.178, mb=0.538, no=0.994, corr=-0.387) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1533
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1772 mb_mean=0.5361 norm_overlap=0.9938 corr_cb=-0.3787 topkJ=0.0107
[TRAIN][ep=028] loss=0.8039 acc=72.89%
[TRAIN][ep=028] mask_avg: mc_mean=0.1595 mb_mean=0.5376 norm_overlap=0.9936 corr_cb=-0.3536
[EPOCH 028/089] train: loss=0.8039 acc=72.89% | val: loss=0.6949 acc=60.24% f1=71.79% auc=64.30% val_score=59.9061 val_score_bestthr=65.1322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.160, mb=0.538, no=0.994, corr=-0.354) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1322
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.1724 mb_mean=0.5390 norm_overlap=0.9916 corr_cb=-0.4251 topkJ=0.0115
[TRAIN][ep=029] loss=0.7864 acc=74.09%
[TRAIN][ep=029] mask_avg: mc_mean=0.1866 mb_mean=0.5376 norm_overlap=0.9939 corr_cb=-0.3663
[EPOCH 029/089] train: loss=0.7864 acc=74.09% | val: loss=0.7166 acc=60.24% f1=71.79% auc=64.07% val_score=57.5005 val_score_bestthr=65.1322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.187, mb=0.538, no=0.994, corr=-0.366) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1322
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2425 mb_mean=0.5360 norm_overlap=0.9966 corr_cb=-0.2671 topkJ=0.0204
[TRAIN][ep=030] loss=0.7973 acc=72.62%
[TRAIN][ep=030] mask_avg: mc_mean=0.1683 mb_mean=0.5376 norm_overlap=0.9937 corr_cb=-0.3437
[EPOCH 030/089] train: loss=0.7973 acc=72.62% | val: loss=0.7976 acc=62.65% f1=65.93% auc=62.09% val_score=41.6405 val_score_bestthr=60.6077 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.168, mb=0.538, no=0.994, corr=-0.344) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 60.6077
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.1781 mb_mean=0.5363 norm_overlap=0.9966 corr_cb=-0.1808 topkJ=0.0379
[TRAIN][ep=031] loss=0.7880 acc=75.17%
[TRAIN][ep=031] mask_avg: mc_mean=0.1610 mb_mean=0.5376 norm_overlap=0.9937 corr_cb=-0.3311
[EPOCH 031/089] train: loss=0.7880 acc=75.17% | val: loss=0.7332 acc=61.45% f1=72.41% auc=65.81% val_score=62.7963 val_score_bestthr=65.1127 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.161, mb=0.538, no=0.994, corr=-0.331) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1127
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1521 mb_mean=0.5378 norm_overlap=0.9917 corr_cb=-0.5303 topkJ=0.0012
[TRAIN][ep=032] loss=0.7978 acc=73.15%
[TRAIN][ep=032] mask_avg: mc_mean=0.1651 mb_mean=0.5376 norm_overlap=0.9936 corr_cb=-0.3457
[EPOCH 032/089] train: loss=0.7978 acc=73.15% | val: loss=0.7104 acc=59.04% f1=71.19% auc=63.26% val_score=51.2154 val_score_bestthr=63.8778 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.165, mb=0.538, no=0.994, corr=-0.346) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 63.8778
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1710 mb_mean=0.5365 norm_overlap=0.9940 corr_cb=-0.3357 topkJ=0.0084
[TRAIN][ep=033] loss=0.7655 acc=75.84%
[TRAIN][ep=033] mask_avg: mc_mean=0.1818 mb_mean=0.5376 norm_overlap=0.9941 corr_cb=-0.3351
[EPOCH 033/089] train: loss=0.7655 acc=75.84% | val: loss=0.6954 acc=61.45% f1=72.41% auc=64.88% val_score=57.3625 val_score_bestthr=65.1127 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.182, mb=0.538, no=0.994, corr=-0.335) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1127
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1784 mb_mean=0.5402 norm_overlap=0.9917 corr_cb=-0.4421 topkJ=0.0040
[TRAIN][ep=034] loss=0.7535 acc=76.51%
[TRAIN][ep=034] mask_avg: mc_mean=0.1790 mb_mean=0.5376 norm_overlap=0.9943 corr_cb=-0.3161
[EPOCH 034/089] train: loss=0.7535 acc=76.51% | val: loss=0.7072 acc=61.45% f1=72.41% auc=65.81% val_score=58.1094 val_score_bestthr=65.1127 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.179, mb=0.538, no=0.994, corr=-0.316) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1127
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.1973 mb_mean=0.5383 norm_overlap=0.9937 corr_cb=-0.3897 topkJ=0.0112
[TRAIN][ep=035] loss=0.7648 acc=75.44%
[TRAIN][ep=035] mask_avg: mc_mean=0.2023 mb_mean=0.5376 norm_overlap=0.9948 corr_cb=-0.3043
[EPOCH 035/089] train: loss=0.7648 acc=75.44% | val: loss=0.6987 acc=61.45% f1=72.41% auc=66.40% val_score=54.6632 val_score_bestthr=65.1127 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.202, mb=0.538, no=0.995, corr=-0.304) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1127
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2165 mb_mean=0.5386 norm_overlap=0.9945 corr_cb=-0.2924 topkJ=0.0114
[TRAIN][ep=036] loss=0.7517 acc=76.64%
[TRAIN][ep=036] mask_avg: mc_mean=0.1632 mb_mean=0.5376 norm_overlap=0.9942 corr_cb=-0.2887
[EPOCH 036/089] train: loss=0.7517 acc=76.64% | val: loss=0.6863 acc=60.24% f1=71.79% auc=66.92% val_score=56.7469 val_score_bestthr=63.8567 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.163, mb=0.538, no=0.994, corr=-0.289) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 63.8567
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1852 mb_mean=0.5386 norm_overlap=0.9942 corr_cb=-0.3540 topkJ=0.0101
[TRAIN][ep=037] loss=0.7430 acc=76.24%
[TRAIN][ep=037] mask_avg: mc_mean=0.2139 mb_mean=0.5376 norm_overlap=0.9949 corr_cb=-0.2930
[EPOCH 037/089] train: loss=0.7430 acc=76.24% | val: loss=0.7255 acc=61.45% f1=72.41% auc=65.70% val_score=50.7299 val_score_bestthr=65.1127 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.214, mb=0.538, no=0.995, corr=-0.293) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1127
[EARLY STOP] no improvement for 30 epochs. best_epoch=7
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold3_rep1_seed1003/ckpt_best_fold_3.pt
=============== FIT DONE ===============
[BEST] epoch=7 | val_acc=59.04% | val_f1=71.67% | val_auc=60.99% | val_score=52.3206 | val_score_bestthr=67.9254
[TEST@BEST] thr_used=0.430 | acc=57.97% f1=69.69% auc=65.72% | SP_sex=5.42% EO_sex=2.17% SP_age=8.69% EO_age=12.00%
[TIME] 0.92 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold3_rep1_seed1003/summary_fold_3.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5496 mb_mean=0.5403 norm_overlap=1.0001 corr_cb=0.3519 topkJ=0.1406
[TRAIN][ep=000] loss=0.6941 acc=50.47%
[TRAIN][ep=000] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1607
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5475 mb_mean=0.5372 norm_overlap=1.0001 corr_cb=0.1760 topkJ=0.2310
[TRAIN][ep=001] loss=0.6918 acc=53.02%
[TRAIN][ep=001] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1625
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5445 mb_mean=0.5368 norm_overlap=1.0000 corr_cb=-0.0182 topkJ=0.0374
[TRAIN][ep=002] loss=0.6911 acc=52.89%
[TRAIN][ep=002] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1664
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5469 mb_mean=0.5363 norm_overlap=1.0000 corr_cb=-0.0789 topkJ=0.0102
[TRAIN][ep=003] loss=0.6880 acc=57.45%
[TRAIN][ep=003] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1676
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5430 mb_mean=0.5353 norm_overlap=1.0000 corr_cb=0.0043 topkJ=0.1063
[TRAIN][ep=004] loss=0.6863 acc=55.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1536
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5519 mb_mean=0.5362 norm_overlap=1.0000 corr_cb=0.1233 topkJ=0.0542
[TRAIN][ep=005] loss=0.6841 acc=54.77%
[TRAIN][ep=005] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1638
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5510 mb_mean=0.5382 norm_overlap=1.0001 corr_cb=0.2709 topkJ=0.0754
[TRAIN][ep=006] loss=0.6814 acc=58.66%
[TRAIN][ep=006] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1403
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5482 mb_mean=0.5362 norm_overlap=1.0001 corr_cb=0.1681 topkJ=0.1178
[TRAIN][ep=007] loss=0.6765 acc=59.33%
[TRAIN][ep=007] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1610
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5467 mb_mean=0.5373 norm_overlap=1.0000 corr_cb=-0.0661 topkJ=0.0328
[TRAIN][ep=008] loss=0.6734 acc=59.73%
[TRAIN][ep=008] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1699
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5503 mb_mean=0.5383 norm_overlap=1.0002 corr_cb=0.3963 topkJ=0.1772
[TRAIN][ep=009] loss=0.6678 acc=57.85%
[TRAIN][ep=009] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1600
================= FIT START (fold=3) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5516 mb_mean=0.5395 norm_overlap=1.0000 corr_cb=0.0837 topkJ=0.0302
[TRAIN][ep=000] loss=0.6601 acc=61.34%
[TRAIN][ep=000] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1701
[EPOCH 000/089] train: loss=0.6601 acc=61.34% | val: loss=0.6887 acc=59.04% f1=71.67% auc=57.79% val_score=62.3022 val_score_bestthr=67.2030 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.170) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 67.2030
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep1_seed1003/ckpt_best_fold_3.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5481 mb_mean=0.5374 norm_overlap=1.0000 corr_cb=0.1478 topkJ=0.0522
[TRAIN][ep=001] loss=0.6562 acc=60.27%
[TRAIN][ep=001] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1569
[EPOCH 001/089] train: loss=0.6562 acc=60.27% | val: loss=0.6934 acc=61.45% f1=71.43% auc=52.15% val_score=38.1845 val_score_bestthr=63.8992 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.157) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.2030 -> 63.8992
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5562 mb_mean=0.5396 norm_overlap=1.0002 corr_cb=0.3367 topkJ=0.1809
[TRAIN][ep=002] loss=0.6546 acc=60.94%
[TRAIN][ep=002] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1556
[EPOCH 002/089] train: loss=0.6546 acc=60.94% | val: loss=0.6945 acc=61.45% f1=71.43% auc=52.91% val_score=38.1845 val_score_bestthr=63.8992 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.156) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.2030 -> 63.8992
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5486 mb_mean=0.5364 norm_overlap=1.0000 corr_cb=0.1156 topkJ=0.0623
[TRAIN][ep=003] loss=0.6461 acc=62.95%
[TRAIN][ep=003] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1636
[EPOCH 003/089] train: loss=0.6461 acc=62.95% | val: loss=0.6917 acc=62.65% f1=69.31% auc=59.19% val_score=58.2372 val_score_bestthr=62.3086 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.164) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.2030 -> 62.3086
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5592 mb_mean=0.5394 norm_overlap=1.0001 corr_cb=0.2315 topkJ=0.1445
[TRAIN][ep=004] loss=0.6401 acc=64.83%
[TRAIN][ep=004] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1579
[EPOCH 004/089] train: loss=0.6401 acc=64.83% | val: loss=0.6900 acc=59.04% f1=70.69% auc=55.93% val_score=50.9895 val_score_bestthr=61.5649 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.158) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.2030 -> 61.5649
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5493 mb_mean=0.5373 norm_overlap=1.0000 corr_cb=-0.0651 topkJ=0.0040
[TRAIN][ep=005] loss=1.4766 acc=63.36%
[TRAIN][ep=005] mask_avg: mc_mean=0.4211 mb_mean=0.5376 norm_overlap=0.9992 corr_cb=-0.3878
[EPOCH 005/089] train: loss=1.4766 acc=63.36% | val: loss=0.7262 acc=56.63% f1=60.87% auc=52.50% val_score=37.3493 val_score_bestthr=56.5770 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.421, mb=0.538, no=0.999, corr=-0.388) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.2030 -> 56.5770
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.3475 mb_mean=0.5346 norm_overlap=0.9983 corr_cb=-0.4458 topkJ=0.0190
[TRAIN][ep=006] loss=1.2073 acc=62.95%
[TRAIN][ep=006] mask_avg: mc_mean=0.2669 mb_mean=0.5376 norm_overlap=0.9979 corr_cb=-0.3709
[EPOCH 006/089] train: loss=1.2073 acc=62.95% | val: loss=0.6861 acc=59.04% f1=70.69% auc=57.62% val_score=48.9790 val_score_bestthr=61.5649 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.267, mb=0.538, no=0.998, corr=-0.371) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.2030 -> 61.5649
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2025 mb_mean=0.5371 norm_overlap=0.9976 corr_cb=-0.4371 topkJ=0.0039
[TRAIN][ep=007] loss=0.9649 acc=63.36%
[TRAIN][ep=007] mask_avg: mc_mean=0.2141 mb_mean=0.5376 norm_overlap=0.9972 corr_cb=-0.3671
[EPOCH 007/089] train: loss=0.9649 acc=63.36% | val: loss=0.6814 acc=59.04% f1=71.67% auc=61.05% val_score=52.3206 val_score_bestthr=67.9254 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.040, stage2=False) | mask(mc=0.214, mb=0.538, no=0.997, corr=-0.367) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 67.2030 -> 67.9254
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep1_seed1003/ckpt_best_fold_3.pt
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2300 mb_mean=0.5355 norm_overlap=0.9988 corr_cb=-0.1891 topkJ=0.0844
[TRAIN][ep=008] loss=1.0516 acc=64.16%
[TRAIN][ep=008] mask_avg: mc_mean=0.1925 mb_mean=0.5376 norm_overlap=0.9968 corr_cb=-0.3646
[EPOCH 008/089] train: loss=1.0516 acc=64.16% | val: loss=0.6882 acc=59.04% f1=71.19% auc=56.98% val_score=37.1542 val_score_bestthr=66.0866 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.080, stage2=False) | mask(mc=0.192, mb=0.538, no=0.997, corr=-0.365) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 66.0866
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1622 mb_mean=0.5395 norm_overlap=0.9952 corr_cb=-0.4393 topkJ=0.0131
[TRAIN][ep=009] loss=1.1431 acc=64.56%
[TRAIN][ep=009] mask_avg: mc_mean=0.1769 mb_mean=0.5376 norm_overlap=0.9965 corr_cb=-0.3483
[EPOCH 009/089] train: loss=1.1431 acc=64.56% | val: loss=0.7227 acc=55.42% f1=69.42% auc=55.52% val_score=40.0656 val_score_bestthr=60.9231 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.120, stage2=False) | mask(mc=0.177, mb=0.538, no=0.997, corr=-0.348) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 60.9231
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1458 mb_mean=0.5379 norm_overlap=0.9973 corr_cb=-0.3416 topkJ=0.0147
[TRAIN][ep=010] loss=1.2281 acc=65.50%
[TRAIN][ep=010] mask_avg: mc_mean=0.1787 mb_mean=0.5376 norm_overlap=0.9962 corr_cb=-0.3727
[EPOCH 010/089] train: loss=1.2281 acc=65.50% | val: loss=0.6919 acc=59.04% f1=71.19% auc=57.44% val_score=36.7942 val_score_bestthr=66.0866 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.160, stage2=False) | mask(mc=0.179, mb=0.538, no=0.996, corr=-0.373) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 66.0866
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1491 mb_mean=0.5409 norm_overlap=0.9956 corr_cb=-0.3532 topkJ=0.0187
[TRAIN][ep=011] loss=1.3165 acc=67.11%
[TRAIN][ep=011] mask_avg: mc_mean=0.1711 mb_mean=0.5376 norm_overlap=0.9959 corr_cb=-0.3784
[EPOCH 011/089] train: loss=1.3165 acc=67.11% | val: loss=0.7161 acc=57.83% f1=70.09% auc=56.40% val_score=37.7166 val_score_bestthr=62.8622 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.171, mb=0.538, no=0.996, corr=-0.378) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 62.8622
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1673 mb_mean=0.5345 norm_overlap=0.9984 corr_cb=-0.2089 topkJ=0.0789
[TRAIN][ep=012] loss=1.3972 acc=67.92%
[TRAIN][ep=012] mask_avg: mc_mean=0.1628 mb_mean=0.5376 norm_overlap=0.9958 corr_cb=-0.3615
[EPOCH 012/089] train: loss=1.3972 acc=67.92% | val: loss=0.6875 acc=59.04% f1=71.67% auc=61.86% val_score=51.2186 val_score_bestthr=67.9254 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.163, mb=0.538, no=0.996, corr=-0.362) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 67.9254
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1939 mb_mean=0.5357 norm_overlap=0.9983 corr_cb=-0.2385 topkJ=0.0377
[TRAIN][ep=013] loss=1.1648 acc=67.25%
[TRAIN][ep=013] mask_avg: mc_mean=0.1534 mb_mean=0.5376 norm_overlap=0.9955 corr_cb=-0.3415
[EPOCH 013/089] train: loss=1.1648 acc=67.25% | val: loss=0.7311 acc=61.45% f1=72.41% auc=63.31% val_score=65.3145 val_score_bestthr=64.4737 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.153, mb=0.538, no=0.996, corr=-0.341) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 64.4737
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1450 mb_mean=0.5402 norm_overlap=0.9950 corr_cb=-0.3936 topkJ=0.0020
[TRAIN][ep=014] loss=0.9324 acc=67.11%
[TRAIN][ep=014] mask_avg: mc_mean=0.1629 mb_mean=0.5376 norm_overlap=0.9955 corr_cb=-0.3565
[EPOCH 014/089] train: loss=0.9324 acc=67.11% | val: loss=0.6834 acc=59.04% f1=71.67% auc=61.34% val_score=55.1065 val_score_bestthr=67.9254 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.163, mb=0.538, no=0.995, corr=-0.356) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 67.9254
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1572 mb_mean=0.5349 norm_overlap=0.9957 corr_cb=-0.4089 topkJ=0.0207
[TRAIN][ep=015] loss=0.8766 acc=67.65%
[TRAIN][ep=015] mask_avg: mc_mean=0.1571 mb_mean=0.5376 norm_overlap=0.9950 corr_cb=-0.3718
[EPOCH 015/089] train: loss=0.8766 acc=67.65% | val: loss=0.6887 acc=57.83% f1=70.59% auc=60.06% val_score=48.6883 val_score_bestthr=64.6159 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.157, mb=0.538, no=0.995, corr=-0.372) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 64.6159
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1303 mb_mean=0.5397 norm_overlap=0.9935 corr_cb=-0.4309 topkJ=0.0077
[TRAIN][ep=016] loss=0.8797 acc=68.05%
[TRAIN][ep=016] mask_avg: mc_mean=0.1618 mb_mean=0.5376 norm_overlap=0.9947 corr_cb=-0.3926
[EPOCH 016/089] train: loss=0.8797 acc=68.05% | val: loss=0.7783 acc=59.04% f1=67.31% auc=57.21% val_score=37.0115 val_score_bestthr=59.6594 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.162, mb=0.538, no=0.995, corr=-0.393) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 59.6594
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1775 mb_mean=0.5373 norm_overlap=0.9955 corr_cb=-0.2828 topkJ=0.0448
[TRAIN][ep=017] loss=0.8681 acc=67.65%
[TRAIN][ep=017] mask_avg: mc_mean=0.1655 mb_mean=0.5376 norm_overlap=0.9946 corr_cb=-0.4035
[EPOCH 017/089] train: loss=0.8681 acc=67.65% | val: loss=0.6823 acc=61.45% f1=70.91% auc=62.09% val_score=51.0849 val_score_bestthr=60.7200 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.166, mb=0.538, no=0.995, corr=-0.403) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 60.7200
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1870 mb_mean=0.5362 norm_overlap=0.9969 corr_cb=-0.2915 topkJ=0.0285
[TRAIN][ep=018] loss=0.8508 acc=71.68%
[TRAIN][ep=018] mask_avg: mc_mean=0.1721 mb_mean=0.5376 norm_overlap=0.9948 corr_cb=-0.3874
[EPOCH 018/089] train: loss=0.8508 acc=71.68% | val: loss=0.6845 acc=57.83% f1=71.07% auc=61.98% val_score=51.7537 val_score_bestthr=66.4345 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.172, mb=0.538, no=0.995, corr=-0.387) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 66.4345
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1635 mb_mean=0.5388 norm_overlap=0.9933 corr_cb=-0.4674 topkJ=0.0153
[TRAIN][ep=019] loss=0.8509 acc=70.20%
[TRAIN][ep=019] mask_avg: mc_mean=0.1728 mb_mean=0.5376 norm_overlap=0.9945 corr_cb=-0.4067
[EPOCH 019/089] train: loss=0.8509 acc=70.20% | val: loss=0.7055 acc=57.83% f1=70.09% auc=60.58% val_score=41.9157 val_score_bestthr=59.9234 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.173, mb=0.538, no=0.994, corr=-0.407) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 59.9234
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1559 mb_mean=0.5373 norm_overlap=0.9933 corr_cb=-0.4655 topkJ=0.0012
[TRAIN][ep=020] loss=0.8445 acc=71.68%
[TRAIN][ep=020] mask_avg: mc_mean=0.1738 mb_mean=0.5376 norm_overlap=0.9945 corr_cb=-0.3856
[EPOCH 020/089] train: loss=0.8445 acc=71.68% | val: loss=0.6890 acc=57.83% f1=70.59% auc=63.31% val_score=52.7523 val_score_bestthr=64.6159 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.174, mb=0.538, no=0.994, corr=-0.386) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 64.6159
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2031 mb_mean=0.5381 norm_overlap=0.9950 corr_cb=-0.3532 topkJ=0.0394
[TRAIN][ep=021] loss=0.8430 acc=68.32%
[TRAIN][ep=021] mask_avg: mc_mean=0.1722 mb_mean=0.5376 norm_overlap=0.9941 corr_cb=-0.4152
[EPOCH 021/089] train: loss=0.8430 acc=68.32% | val: loss=0.7012 acc=61.45% f1=70.37% auc=63.72% val_score=54.3001 val_score_bestthr=60.6338 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.172, mb=0.538, no=0.994, corr=-0.415) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 60.6338
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1471 mb_mean=0.5376 norm_overlap=0.9933 corr_cb=-0.5143 topkJ=0.0083
[TRAIN][ep=022] loss=0.8404 acc=70.20%
[TRAIN][ep=022] mask_avg: mc_mean=0.1778 mb_mean=0.5376 norm_overlap=0.9940 corr_cb=-0.4272
[EPOCH 022/089] train: loss=0.8404 acc=70.20% | val: loss=0.7082 acc=63.86% f1=68.75% auc=61.16% val_score=44.3512 val_score_bestthr=61.2767 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.178, mb=0.538, no=0.994, corr=-0.427) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 61.2767
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1949 mb_mean=0.5360 norm_overlap=0.9946 corr_cb=-0.4262 topkJ=0.0084
[TRAIN][ep=023] loss=0.8251 acc=71.95%
[TRAIN][ep=023] mask_avg: mc_mean=0.1699 mb_mean=0.5376 norm_overlap=0.9941 corr_cb=-0.3914
[EPOCH 023/089] train: loss=0.8251 acc=71.95% | val: loss=0.7116 acc=63.86% f1=68.75% auc=61.28% val_score=49.1566 val_score_bestthr=61.2767 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.170, mb=0.538, no=0.994, corr=-0.391) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 61.2767
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1615 mb_mean=0.5388 norm_overlap=0.9935 corr_cb=-0.3557 topkJ=0.0296
[TRAIN][ep=024] loss=0.8286 acc=70.20%
[TRAIN][ep=024] mask_avg: mc_mean=0.1612 mb_mean=0.5376 norm_overlap=0.9937 corr_cb=-0.3868
[EPOCH 024/089] train: loss=0.8286 acc=70.20% | val: loss=0.6933 acc=60.24% f1=71.79% auc=64.07% val_score=55.2111 val_score_bestthr=65.1322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.161, mb=0.538, no=0.994, corr=-0.387) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1322
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1554 mb_mean=0.5377 norm_overlap=0.9903 corr_cb=-0.4576 topkJ=0.0130
[TRAIN][ep=025] loss=0.8278 acc=71.95%
[TRAIN][ep=025] mask_avg: mc_mean=0.1706 mb_mean=0.5376 norm_overlap=0.9939 corr_cb=-0.3779
[EPOCH 025/089] train: loss=0.8278 acc=71.95% | val: loss=0.8365 acc=61.45% f1=65.96% auc=60.17% val_score=41.6456 val_score_bestthr=61.1649 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.171, mb=0.538, no=0.994, corr=-0.378) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 61.1649
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1214 mb_mean=0.5373 norm_overlap=0.9930 corr_cb=-0.3605 topkJ=0.0127
[TRAIN][ep=026] loss=0.8221 acc=71.81%
[TRAIN][ep=026] mask_avg: mc_mean=0.1602 mb_mean=0.5376 norm_overlap=0.9933 corr_cb=-0.3978
[EPOCH 026/089] train: loss=0.8221 acc=71.81% | val: loss=0.6845 acc=60.24% f1=71.79% auc=63.90% val_score=58.7897 val_score_bestthr=65.1322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.160, mb=0.538, no=0.993, corr=-0.398) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1322
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1947 mb_mean=0.5358 norm_overlap=0.9977 corr_cb=-0.1851 topkJ=0.0477
[TRAIN][ep=027] loss=0.7985 acc=74.09%
[TRAIN][ep=027] mask_avg: mc_mean=0.1766 mb_mean=0.5376 norm_overlap=0.9937 corr_cb=-0.3872
[EPOCH 027/089] train: loss=0.7985 acc=74.09% | val: loss=0.7039 acc=59.04% f1=71.19% auc=62.97% val_score=57.6757 val_score_bestthr=65.1533 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.177, mb=0.538, no=0.994, corr=-0.387) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1533
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1774 mb_mean=0.5361 norm_overlap=0.9938 corr_cb=-0.3811 topkJ=0.0099
[TRAIN][ep=028] loss=0.8039 acc=73.15%
[TRAIN][ep=028] mask_avg: mc_mean=0.1593 mb_mean=0.5376 norm_overlap=0.9936 corr_cb=-0.3550
[EPOCH 028/089] train: loss=0.8039 acc=73.15% | val: loss=0.6949 acc=60.24% f1=71.79% auc=64.24% val_score=59.9061 val_score_bestthr=65.1322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.159, mb=0.538, no=0.994, corr=-0.355) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1322
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.1709 mb_mean=0.5390 norm_overlap=0.9915 corr_cb=-0.4262 topkJ=0.0115
[TRAIN][ep=029] loss=0.7865 acc=73.96%
[TRAIN][ep=029] mask_avg: mc_mean=0.1852 mb_mean=0.5376 norm_overlap=0.9938 corr_cb=-0.3677
[EPOCH 029/089] train: loss=0.7865 acc=73.96% | val: loss=0.7166 acc=60.24% f1=71.79% auc=64.13% val_score=57.5005 val_score_bestthr=65.1322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.185, mb=0.538, no=0.994, corr=-0.368) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1322
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2408 mb_mean=0.5360 norm_overlap=0.9965 corr_cb=-0.2700 topkJ=0.0196
[TRAIN][ep=030] loss=0.7975 acc=72.75%
[TRAIN][ep=030] mask_avg: mc_mean=0.1677 mb_mean=0.5376 norm_overlap=0.9937 corr_cb=-0.3456
[EPOCH 030/089] train: loss=0.7975 acc=72.75% | val: loss=0.7981 acc=62.65% f1=65.93% auc=62.09% val_score=44.1087 val_score_bestthr=60.6077 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.168, mb=0.538, no=0.994, corr=-0.346) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 60.6077
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.1772 mb_mean=0.5363 norm_overlap=0.9965 corr_cb=-0.1836 topkJ=0.0375
[TRAIN][ep=031] loss=0.7881 acc=75.03%
[TRAIN][ep=031] mask_avg: mc_mean=0.1604 mb_mean=0.5376 norm_overlap=0.9937 corr_cb=-0.3330
[EPOCH 031/089] train: loss=0.7881 acc=75.03% | val: loss=0.7332 acc=61.45% f1=72.41% auc=65.93% val_score=62.7963 val_score_bestthr=65.1127 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.160, mb=0.538, no=0.994, corr=-0.333) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1127
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1510 mb_mean=0.5378 norm_overlap=0.9916 corr_cb=-0.5322 topkJ=0.0012
[TRAIN][ep=032] loss=0.7979 acc=73.02%
[TRAIN][ep=032] mask_avg: mc_mean=0.1641 mb_mean=0.5376 norm_overlap=0.9936 corr_cb=-0.3473
[EPOCH 032/089] train: loss=0.7979 acc=73.02% | val: loss=0.7109 acc=59.04% f1=71.19% auc=63.20% val_score=51.2154 val_score_bestthr=63.8778 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.164, mb=0.538, no=0.994, corr=-0.347) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 63.8778
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1708 mb_mean=0.5365 norm_overlap=0.9940 corr_cb=-0.3384 topkJ=0.0084
[TRAIN][ep=033] loss=0.7657 acc=75.70%
[TRAIN][ep=033] mask_avg: mc_mean=0.1816 mb_mean=0.5376 norm_overlap=0.9941 corr_cb=-0.3376
[EPOCH 033/089] train: loss=0.7657 acc=75.70% | val: loss=0.6957 acc=61.45% f1=72.41% auc=64.83% val_score=55.3469 val_score_bestthr=65.1127 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.182, mb=0.538, no=0.994, corr=-0.338) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1127
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1781 mb_mean=0.5402 norm_overlap=0.9917 corr_cb=-0.4444 topkJ=0.0040
[TRAIN][ep=034] loss=0.7538 acc=76.64%
[TRAIN][ep=034] mask_avg: mc_mean=0.1785 mb_mean=0.5376 norm_overlap=0.9942 corr_cb=-0.3183
[EPOCH 034/089] train: loss=0.7538 acc=76.64% | val: loss=0.7071 acc=61.45% f1=72.41% auc=65.76% val_score=58.1094 val_score_bestthr=65.1127 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.178, mb=0.538, no=0.994, corr=-0.318) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1127
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.1956 mb_mean=0.5383 norm_overlap=0.9937 corr_cb=-0.3906 topkJ=0.0116
[TRAIN][ep=035] loss=0.7652 acc=75.44%
[TRAIN][ep=035] mask_avg: mc_mean=0.2007 mb_mean=0.5376 norm_overlap=0.9947 corr_cb=-0.3066
[EPOCH 035/089] train: loss=0.7652 acc=75.44% | val: loss=0.6984 acc=61.45% f1=72.41% auc=66.34% val_score=54.6632 val_score_bestthr=65.1127 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.201, mb=0.538, no=0.995, corr=-0.307) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1127
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2152 mb_mean=0.5386 norm_overlap=0.9945 corr_cb=-0.2933 topkJ=0.0114
[TRAIN][ep=036] loss=0.7519 acc=76.91%
[TRAIN][ep=036] mask_avg: mc_mean=0.1623 mb_mean=0.5376 norm_overlap=0.9941 corr_cb=-0.2907
[EPOCH 036/089] train: loss=0.7519 acc=76.91% | val: loss=0.6862 acc=60.24% f1=71.79% auc=66.92% val_score=55.3195 val_score_bestthr=63.8567 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.162, mb=0.538, no=0.994, corr=-0.291) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 63.8567
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1839 mb_mean=0.5386 norm_overlap=0.9942 corr_cb=-0.3567 topkJ=0.0105
[TRAIN][ep=037] loss=0.7434 acc=76.24%
[TRAIN][ep=037] mask_avg: mc_mean=0.2129 mb_mean=0.5376 norm_overlap=0.9949 corr_cb=-0.2954
[EPOCH 037/089] train: loss=0.7434 acc=76.24% | val: loss=0.7255 acc=61.45% f1=72.41% auc=65.76% val_score=50.7299 val_score_bestthr=65.1127 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.213, mb=0.538, no=0.995, corr=-0.295) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1127
[EARLY STOP] no improvement for 30 epochs. best_epoch=7
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold3_rep1_seed1003/ckpt_best_fold_3.pt
=============== FIT DONE ===============
[BEST] epoch=7 | val_acc=59.04% | val_f1=71.67% | val_auc=61.05% | val_score=52.3206 | val_score_bestthr=67.9254
[TEST@BEST] thr_used=0.430 | acc=57.97% f1=69.69% auc=65.73% | SP_sex=5.42% EO_sex=2.17% SP_age=8.69% EO_age=12.00%
[TIME] 0.95 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold3_rep1_seed1003/summary_fold_3.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5496 mb_mean=0.5403 norm_overlap=1.0001 corr_cb=0.3519 topkJ=0.1406
[TRAIN][ep=000] loss=0.6941 acc=50.47%
[TRAIN][ep=000] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1607
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5475 mb_mean=0.5372 norm_overlap=1.0001 corr_cb=0.1760 topkJ=0.2310
[TRAIN][ep=001] loss=0.6918 acc=53.02%
[TRAIN][ep=001] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1625
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5445 mb_mean=0.5368 norm_overlap=1.0000 corr_cb=-0.0182 topkJ=0.0374
[TRAIN][ep=002] loss=0.6911 acc=52.89%
[TRAIN][ep=002] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1664
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5469 mb_mean=0.5363 norm_overlap=1.0000 corr_cb=-0.0789 topkJ=0.0102
[TRAIN][ep=003] loss=0.6880 acc=57.58%
[TRAIN][ep=003] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1676
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5430 mb_mean=0.5353 norm_overlap=1.0000 corr_cb=0.0043 topkJ=0.1063
[TRAIN][ep=004] loss=0.6863 acc=55.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1536
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5519 mb_mean=0.5362 norm_overlap=1.0000 corr_cb=0.1233 topkJ=0.0542
[TRAIN][ep=005] loss=0.6841 acc=54.77%
[TRAIN][ep=005] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1638
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5510 mb_mean=0.5382 norm_overlap=1.0001 corr_cb=0.2709 topkJ=0.0754
[TRAIN][ep=006] loss=0.6814 acc=58.52%
[TRAIN][ep=006] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1403
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5482 mb_mean=0.5362 norm_overlap=1.0001 corr_cb=0.1681 topkJ=0.1178
[TRAIN][ep=007] loss=0.6765 acc=59.33%
[TRAIN][ep=007] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1610
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5467 mb_mean=0.5373 norm_overlap=1.0000 corr_cb=-0.0661 topkJ=0.0328
[TRAIN][ep=008] loss=0.6734 acc=59.73%
[TRAIN][ep=008] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1699
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5503 mb_mean=0.5383 norm_overlap=1.0002 corr_cb=0.3963 topkJ=0.1772
[TRAIN][ep=009] loss=0.6678 acc=57.85%
[TRAIN][ep=009] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1600
================= FIT START (fold=3) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5516 mb_mean=0.5395 norm_overlap=1.0000 corr_cb=0.0837 topkJ=0.0302
[TRAIN][ep=000] loss=0.6601 acc=61.34%
[TRAIN][ep=000] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1701
[EPOCH 000/089] train: loss=0.6601 acc=61.34% | val: loss=0.6887 acc=59.04% f1=71.67% auc=57.79% val_score=62.3022 val_score_bestthr=67.2030 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.170) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 67.2030
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep1_seed1003/ckpt_best_fold_3.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5481 mb_mean=0.5374 norm_overlap=1.0000 corr_cb=0.1478 topkJ=0.0522
[TRAIN][ep=001] loss=0.6562 acc=60.27%
[TRAIN][ep=001] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1569
[EPOCH 001/089] train: loss=0.6562 acc=60.27% | val: loss=0.6934 acc=61.45% f1=71.43% auc=52.09% val_score=38.1845 val_score_bestthr=63.8992 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.157) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.2030 -> 63.8992
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5562 mb_mean=0.5396 norm_overlap=1.0002 corr_cb=0.3367 topkJ=0.1809
[TRAIN][ep=002] loss=0.6546 acc=60.94%
[TRAIN][ep=002] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1556
[EPOCH 002/089] train: loss=0.6546 acc=60.94% | val: loss=0.6945 acc=61.45% f1=71.43% auc=52.97% val_score=38.1845 val_score_bestthr=63.8992 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.156) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.2030 -> 63.8992
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5486 mb_mean=0.5364 norm_overlap=1.0000 corr_cb=0.1156 topkJ=0.0623
[TRAIN][ep=003] loss=0.6461 acc=62.95%
[TRAIN][ep=003] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1636
[EPOCH 003/089] train: loss=0.6461 acc=62.95% | val: loss=0.6917 acc=62.65% f1=69.31% auc=59.13% val_score=58.2372 val_score_bestthr=62.3086 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.164) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.2030 -> 62.3086
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5592 mb_mean=0.5394 norm_overlap=1.0001 corr_cb=0.2315 topkJ=0.1445
[TRAIN][ep=004] loss=0.6401 acc=64.83%
[TRAIN][ep=004] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1579
[EPOCH 004/089] train: loss=0.6401 acc=64.83% | val: loss=0.6900 acc=59.04% f1=70.69% auc=55.93% val_score=50.9895 val_score_bestthr=61.5649 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.158) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.2030 -> 61.5649
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5493 mb_mean=0.5373 norm_overlap=1.0000 corr_cb=-0.0651 topkJ=0.0040
[TRAIN][ep=005] loss=1.2357 acc=63.76%
[TRAIN][ep=005] mask_avg: mc_mean=0.4192 mb_mean=0.5376 norm_overlap=0.9992 corr_cb=-0.3874
[EPOCH 005/089] train: loss=1.2357 acc=63.76% | val: loss=0.7256 acc=57.83% f1=61.54% auc=52.56% val_score=42.2818 val_score_bestthr=56.5650 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.419, mb=0.538, no=0.999, corr=-0.387) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.2030 -> 56.5650
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.3459 mb_mean=0.5346 norm_overlap=0.9983 corr_cb=-0.4451 topkJ=0.0190
[TRAIN][ep=006] loss=1.0103 acc=62.95%
[TRAIN][ep=006] mask_avg: mc_mean=0.2655 mb_mean=0.5376 norm_overlap=0.9979 corr_cb=-0.3701
[EPOCH 006/089] train: loss=1.0103 acc=62.95% | val: loss=0.6857 acc=59.04% f1=70.69% auc=57.50% val_score=48.9790 val_score_bestthr=61.5649 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.266, mb=0.538, no=0.998, corr=-0.370) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.2030 -> 61.5649
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2015 mb_mean=0.5371 norm_overlap=0.9976 corr_cb=-0.4365 topkJ=0.0039
[TRAIN][ep=007] loss=0.8032 acc=62.95%
[TRAIN][ep=007] mask_avg: mc_mean=0.2136 mb_mean=0.5376 norm_overlap=0.9972 corr_cb=-0.3670
[EPOCH 007/089] train: loss=0.8032 acc=62.95% | val: loss=0.6808 acc=59.04% f1=71.67% auc=60.81% val_score=53.6900 val_score_bestthr=67.9254 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.040, stage2=False) | mask(mc=0.214, mb=0.538, no=0.997, corr=-0.367) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 67.2030 -> 67.9254
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep1_seed1003/ckpt_best_fold_3.pt
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2292 mb_mean=0.5355 norm_overlap=0.9988 corr_cb=-0.1888 topkJ=0.0844
[TRAIN][ep=008] loss=0.8765 acc=64.30%
[TRAIN][ep=008] mask_avg: mc_mean=0.1920 mb_mean=0.5376 norm_overlap=0.9968 corr_cb=-0.3652
[EPOCH 008/089] train: loss=0.8765 acc=64.30% | val: loss=0.6872 acc=59.04% f1=71.19% auc=57.15% val_score=38.7087 val_score_bestthr=66.0866 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.080, stage2=False) | mask(mc=0.192, mb=0.538, no=0.997, corr=-0.365) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 66.0866
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1631 mb_mean=0.5395 norm_overlap=0.9952 corr_cb=-0.4403 topkJ=0.0131
[TRAIN][ep=009] loss=0.9538 acc=64.97%
[TRAIN][ep=009] mask_avg: mc_mean=0.1775 mb_mean=0.5376 norm_overlap=0.9965 corr_cb=-0.3481
[EPOCH 009/089] train: loss=0.9538 acc=64.97% | val: loss=0.7226 acc=55.42% f1=69.42% auc=55.52% val_score=40.0656 val_score_bestthr=60.9231 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.120, stage2=False) | mask(mc=0.178, mb=0.538, no=0.997, corr=-0.348) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 60.9231
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1460 mb_mean=0.5379 norm_overlap=0.9973 corr_cb=-0.3411 topkJ=0.0147
[TRAIN][ep=010] loss=1.0252 acc=65.50%
[TRAIN][ep=010] mask_avg: mc_mean=0.1791 mb_mean=0.5376 norm_overlap=0.9962 corr_cb=-0.3733
[EPOCH 010/089] train: loss=1.0252 acc=65.50% | val: loss=0.6912 acc=59.04% f1=71.19% auc=57.62% val_score=36.7942 val_score_bestthr=66.0866 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.160, stage2=False) | mask(mc=0.179, mb=0.538, no=0.996, corr=-0.373) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 66.0866
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1493 mb_mean=0.5409 norm_overlap=0.9956 corr_cb=-0.3547 topkJ=0.0187
[TRAIN][ep=011] loss=1.0994 acc=67.11%
[TRAIN][ep=011] mask_avg: mc_mean=0.1708 mb_mean=0.5376 norm_overlap=0.9959 corr_cb=-0.3786
[EPOCH 011/089] train: loss=1.0994 acc=67.11% | val: loss=0.7141 acc=59.04% f1=70.69% auc=56.63% val_score=36.3074 val_score_bestthr=62.5605 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.171, mb=0.538, no=0.996, corr=-0.379) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 62.5605
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1670 mb_mean=0.5345 norm_overlap=0.9984 corr_cb=-0.2106 topkJ=0.0789
[TRAIN][ep=012] loss=1.1661 acc=68.19%
[TRAIN][ep=012] mask_avg: mc_mean=0.1629 mb_mean=0.5376 norm_overlap=0.9957 corr_cb=-0.3619
[EPOCH 012/089] train: loss=1.1661 acc=68.19% | val: loss=0.6868 acc=59.04% f1=71.67% auc=62.03% val_score=51.2006 val_score_bestthr=67.9254 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.163, mb=0.538, no=0.996, corr=-0.362) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 67.9254
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1944 mb_mean=0.5357 norm_overlap=0.9983 corr_cb=-0.2387 topkJ=0.0377
[TRAIN][ep=013] loss=0.9690 acc=67.38%
[TRAIN][ep=013] mask_avg: mc_mean=0.1543 mb_mean=0.5376 norm_overlap=0.9955 corr_cb=-0.3420
[EPOCH 013/089] train: loss=0.9690 acc=67.38% | val: loss=0.7310 acc=61.45% f1=72.41% auc=63.20% val_score=65.3145 val_score_bestthr=64.4737 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.154, mb=0.538, no=0.996, corr=-0.342) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 64.4737
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1450 mb_mean=0.5402 norm_overlap=0.9950 corr_cb=-0.3932 topkJ=0.0020
[TRAIN][ep=014] loss=0.7715 acc=67.52%
[TRAIN][ep=014] mask_avg: mc_mean=0.1641 mb_mean=0.5376 norm_overlap=0.9955 corr_cb=-0.3577
[EPOCH 014/089] train: loss=0.7715 acc=67.52% | val: loss=0.6828 acc=59.04% f1=71.67% auc=61.40% val_score=49.5895 val_score_bestthr=67.9254 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.164, mb=0.538, no=0.995, corr=-0.358) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 67.9254
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1584 mb_mean=0.5349 norm_overlap=0.9957 corr_cb=-0.4112 topkJ=0.0203
[TRAIN][ep=015] loss=0.7331 acc=67.79%
[TRAIN][ep=015] mask_avg: mc_mean=0.1577 mb_mean=0.5376 norm_overlap=0.9950 corr_cb=-0.3734
[EPOCH 015/089] train: loss=0.7331 acc=67.79% | val: loss=0.6881 acc=57.83% f1=70.59% auc=60.35% val_score=51.8129 val_score_bestthr=64.6159 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.158, mb=0.538, no=0.995, corr=-0.373) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 64.6159
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1311 mb_mean=0.5397 norm_overlap=0.9935 corr_cb=-0.4336 topkJ=0.0077
[TRAIN][ep=016] loss=0.7359 acc=67.79%
[TRAIN][ep=016] mask_avg: mc_mean=0.1627 mb_mean=0.5376 norm_overlap=0.9947 corr_cb=-0.3952
[EPOCH 016/089] train: loss=0.7359 acc=67.79% | val: loss=0.7767 acc=60.24% f1=67.33% auc=57.15% val_score=37.0115 val_score_bestthr=62.3142 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.163, mb=0.538, no=0.995, corr=-0.395) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 62.3142
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1777 mb_mean=0.5373 norm_overlap=0.9954 corr_cb=-0.2855 topkJ=0.0448
[TRAIN][ep=017] loss=0.7246 acc=67.92%
[TRAIN][ep=017] mask_avg: mc_mean=0.1671 mb_mean=0.5376 norm_overlap=0.9946 corr_cb=-0.4069
[EPOCH 017/089] train: loss=0.7246 acc=67.92% | val: loss=0.6819 acc=61.45% f1=70.91% auc=62.09% val_score=51.0849 val_score_bestthr=60.7200 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.167, mb=0.538, no=0.995, corr=-0.407) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 60.7200
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1889 mb_mean=0.5362 norm_overlap=0.9969 corr_cb=-0.2954 topkJ=0.0285
[TRAIN][ep=018] loss=0.7076 acc=71.81%
[TRAIN][ep=018] mask_avg: mc_mean=0.1737 mb_mean=0.5376 norm_overlap=0.9948 corr_cb=-0.3906
[EPOCH 018/089] train: loss=0.7076 acc=71.81% | val: loss=0.6842 acc=57.83% f1=71.07% auc=62.21% val_score=51.7537 val_score_bestthr=66.4345 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.174, mb=0.538, no=0.995, corr=-0.391) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 66.4345
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1655 mb_mean=0.5388 norm_overlap=0.9933 corr_cb=-0.4708 topkJ=0.0149
[TRAIN][ep=019] loss=0.7074 acc=70.47%
[TRAIN][ep=019] mask_avg: mc_mean=0.1741 mb_mean=0.5376 norm_overlap=0.9945 corr_cb=-0.4093
[EPOCH 019/089] train: loss=0.7074 acc=70.47% | val: loss=0.7049 acc=57.83% f1=70.09% auc=60.58% val_score=41.9157 val_score_bestthr=59.9234 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.174, mb=0.538, no=0.994, corr=-0.409) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 59.9234
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1557 mb_mean=0.5373 norm_overlap=0.9933 corr_cb=-0.4660 topkJ=0.0012
[TRAIN][ep=020] loss=0.7012 acc=71.95%
[TRAIN][ep=020] mask_avg: mc_mean=0.1747 mb_mean=0.5376 norm_overlap=0.9945 corr_cb=-0.3889
[EPOCH 020/089] train: loss=0.7012 acc=71.95% | val: loss=0.6885 acc=57.83% f1=70.59% auc=63.43% val_score=52.7523 val_score_bestthr=64.6159 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.175, mb=0.538, no=0.994, corr=-0.389) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 64.6159
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2036 mb_mean=0.5381 norm_overlap=0.9950 corr_cb=-0.3544 topkJ=0.0390
[TRAIN][ep=021] loss=0.7002 acc=68.32%
[TRAIN][ep=021] mask_avg: mc_mean=0.1736 mb_mean=0.5376 norm_overlap=0.9941 corr_cb=-0.4183
[EPOCH 021/089] train: loss=0.7002 acc=68.32% | val: loss=0.6998 acc=59.04% f1=71.19% auc=63.66% val_score=57.8752 val_score_bestthr=65.1533 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.174, mb=0.538, no=0.994, corr=-0.418) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1533
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1485 mb_mean=0.5376 norm_overlap=0.9933 corr_cb=-0.5168 topkJ=0.0083
[TRAIN][ep=022] loss=0.6969 acc=70.34%
[TRAIN][ep=022] mask_avg: mc_mean=0.1780 mb_mean=0.5376 norm_overlap=0.9940 corr_cb=-0.4292
[EPOCH 022/089] train: loss=0.6969 acc=70.34% | val: loss=0.7078 acc=63.86% f1=68.75% auc=61.22% val_score=44.3512 val_score_bestthr=61.2767 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.178, mb=0.538, no=0.994, corr=-0.429) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 61.2767
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1941 mb_mean=0.5360 norm_overlap=0.9946 corr_cb=-0.4275 topkJ=0.0084
[TRAIN][ep=023] loss=0.6819 acc=72.08%
[TRAIN][ep=023] mask_avg: mc_mean=0.1703 mb_mean=0.5376 norm_overlap=0.9940 corr_cb=-0.3944
[EPOCH 023/089] train: loss=0.6819 acc=72.08% | val: loss=0.7110 acc=63.86% f1=68.75% auc=61.16% val_score=49.1566 val_score_bestthr=61.2767 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.170, mb=0.538, no=0.994, corr=-0.394) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 61.2767
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1617 mb_mean=0.5388 norm_overlap=0.9934 corr_cb=-0.3566 topkJ=0.0296
[TRAIN][ep=024] loss=0.6855 acc=70.07%
[TRAIN][ep=024] mask_avg: mc_mean=0.1620 mb_mean=0.5376 norm_overlap=0.9937 corr_cb=-0.3892
[EPOCH 024/089] train: loss=0.6855 acc=70.07% | val: loss=0.6927 acc=60.24% f1=71.79% auc=64.13% val_score=55.2111 val_score_bestthr=65.1322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.162, mb=0.538, no=0.994, corr=-0.389) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1322
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1561 mb_mean=0.5377 norm_overlap=0.9903 corr_cb=-0.4598 topkJ=0.0130
[TRAIN][ep=025] loss=0.6848 acc=72.21%
[TRAIN][ep=025] mask_avg: mc_mean=0.1716 mb_mean=0.5376 norm_overlap=0.9939 corr_cb=-0.3800
[EPOCH 025/089] train: loss=0.6848 acc=72.21% | val: loss=0.8336 acc=61.45% f1=65.96% auc=60.35% val_score=41.6456 val_score_bestthr=61.1649 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.172, mb=0.538, no=0.994, corr=-0.380) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 61.1649
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1202 mb_mean=0.5373 norm_overlap=0.9929 corr_cb=-0.3618 topkJ=0.0111
[TRAIN][ep=026] loss=0.6791 acc=71.81%
[TRAIN][ep=026] mask_avg: mc_mean=0.1611 mb_mean=0.5376 norm_overlap=0.9933 corr_cb=-0.3987
[EPOCH 026/089] train: loss=0.6791 acc=71.81% | val: loss=0.6840 acc=60.24% f1=71.79% auc=63.90% val_score=59.9061 val_score_bestthr=65.1322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.161, mb=0.538, no=0.993, corr=-0.399) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1322
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1950 mb_mean=0.5358 norm_overlap=0.9977 corr_cb=-0.1868 topkJ=0.0468
[TRAIN][ep=027] loss=0.6557 acc=74.09%
[TRAIN][ep=027] mask_avg: mc_mean=0.1780 mb_mean=0.5376 norm_overlap=0.9937 corr_cb=-0.3883
[EPOCH 027/089] train: loss=0.6557 acc=74.09% | val: loss=0.7038 acc=59.04% f1=71.19% auc=63.20% val_score=57.6757 val_score_bestthr=65.1533 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.178, mb=0.538, no=0.994, corr=-0.388) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1533
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1766 mb_mean=0.5361 norm_overlap=0.9938 corr_cb=-0.3798 topkJ=0.0107
[TRAIN][ep=028] loss=0.6610 acc=73.15%
[TRAIN][ep=028] mask_avg: mc_mean=0.1586 mb_mean=0.5376 norm_overlap=0.9936 corr_cb=-0.3545
[EPOCH 028/089] train: loss=0.6610 acc=73.15% | val: loss=0.6948 acc=60.24% f1=71.79% auc=64.19% val_score=59.9061 val_score_bestthr=65.1322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.159, mb=0.538, no=0.994, corr=-0.354) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1322
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.1711 mb_mean=0.5390 norm_overlap=0.9915 corr_cb=-0.4252 topkJ=0.0111
[TRAIN][ep=029] loss=0.6436 acc=74.23%
[TRAIN][ep=029] mask_avg: mc_mean=0.1864 mb_mean=0.5376 norm_overlap=0.9939 corr_cb=-0.3668
[EPOCH 029/089] train: loss=0.6436 acc=74.23% | val: loss=0.7169 acc=60.24% f1=71.79% auc=64.24% val_score=57.5005 val_score_bestthr=65.1322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.186, mb=0.538, no=0.994, corr=-0.367) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1322
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2434 mb_mean=0.5360 norm_overlap=0.9966 corr_cb=-0.2671 topkJ=0.0196
[TRAIN][ep=030] loss=0.6553 acc=72.89%
[TRAIN][ep=030] mask_avg: mc_mean=0.1673 mb_mean=0.5376 norm_overlap=0.9937 corr_cb=-0.3442
[EPOCH 030/089] train: loss=0.6553 acc=72.89% | val: loss=0.7966 acc=62.65% f1=65.93% auc=62.15% val_score=44.1087 val_score_bestthr=60.6077 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.167, mb=0.538, no=0.994, corr=-0.344) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 60.6077
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.1783 mb_mean=0.5363 norm_overlap=0.9966 corr_cb=-0.1815 topkJ=0.0375
[TRAIN][ep=031] loss=0.6452 acc=75.30%
[TRAIN][ep=031] mask_avg: mc_mean=0.1599 mb_mean=0.5376 norm_overlap=0.9936 corr_cb=-0.3314
[EPOCH 031/089] train: loss=0.6452 acc=75.30% | val: loss=0.7321 acc=61.45% f1=72.41% auc=65.81% val_score=62.7963 val_score_bestthr=65.1127 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.160, mb=0.538, no=0.994, corr=-0.331) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1127
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1510 mb_mean=0.5378 norm_overlap=0.9916 corr_cb=-0.5296 topkJ=0.0015
[TRAIN][ep=032] loss=0.6551 acc=73.29%
[TRAIN][ep=032] mask_avg: mc_mean=0.1651 mb_mean=0.5376 norm_overlap=0.9936 corr_cb=-0.3461
[EPOCH 032/089] train: loss=0.6551 acc=73.29% | val: loss=0.7106 acc=59.04% f1=71.19% auc=63.31% val_score=51.2154 val_score_bestthr=63.8778 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.165, mb=0.538, no=0.994, corr=-0.346) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 63.8778
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1714 mb_mean=0.5365 norm_overlap=0.9940 corr_cb=-0.3356 topkJ=0.0080
[TRAIN][ep=033] loss=0.6231 acc=75.84%
[TRAIN][ep=033] mask_avg: mc_mean=0.1818 mb_mean=0.5376 norm_overlap=0.9941 corr_cb=-0.3347
[EPOCH 033/089] train: loss=0.6231 acc=75.84% | val: loss=0.6959 acc=61.45% f1=72.41% auc=64.94% val_score=55.3469 val_score_bestthr=65.1127 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.182, mb=0.538, no=0.994, corr=-0.335) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1127
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1763 mb_mean=0.5402 norm_overlap=0.9917 corr_cb=-0.4417 topkJ=0.0040
[TRAIN][ep=034] loss=0.6117 acc=76.51%
[TRAIN][ep=034] mask_avg: mc_mean=0.1785 mb_mean=0.5376 norm_overlap=0.9943 corr_cb=-0.3157
[EPOCH 034/089] train: loss=0.6117 acc=76.51% | val: loss=0.7075 acc=61.45% f1=72.41% auc=66.05% val_score=58.1094 val_score_bestthr=65.1127 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.178, mb=0.538, no=0.994, corr=-0.316) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1127
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.1992 mb_mean=0.5383 norm_overlap=0.9937 corr_cb=-0.3914 topkJ=0.0104
[TRAIN][ep=035] loss=0.6235 acc=75.70%
[TRAIN][ep=035] mask_avg: mc_mean=0.2022 mb_mean=0.5376 norm_overlap=0.9948 corr_cb=-0.3039
[EPOCH 035/089] train: loss=0.6235 acc=75.70% | val: loss=0.6985 acc=61.45% f1=72.41% auc=66.51% val_score=54.6632 val_score_bestthr=65.1127 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.202, mb=0.538, no=0.995, corr=-0.304) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1127
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2148 mb_mean=0.5386 norm_overlap=0.9945 corr_cb=-0.2918 topkJ=0.0110
[TRAIN][ep=036] loss=0.6102 acc=76.64%
[TRAIN][ep=036] mask_avg: mc_mean=0.1621 mb_mean=0.5376 norm_overlap=0.9942 corr_cb=-0.2882
[EPOCH 036/089] train: loss=0.6102 acc=76.64% | val: loss=0.6870 acc=60.24% f1=71.79% auc=67.15% val_score=56.7469 val_score_bestthr=63.8567 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.162, mb=0.538, no=0.994, corr=-0.288) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 63.8567
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1853 mb_mean=0.5386 norm_overlap=0.9942 corr_cb=-0.3527 topkJ=0.0101
[TRAIN][ep=037] loss=0.6021 acc=76.11%
[TRAIN][ep=037] mask_avg: mc_mean=0.2136 mb_mean=0.5376 norm_overlap=0.9949 corr_cb=-0.2927
[EPOCH 037/089] train: loss=0.6021 acc=76.11% | val: loss=0.7254 acc=61.45% f1=72.41% auc=65.70% val_score=48.2823 val_score_bestthr=65.1127 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.214, mb=0.538, no=0.995, corr=-0.293) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1127
[EARLY STOP] no improvement for 30 epochs. best_epoch=7
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold3_rep1_seed1003/ckpt_best_fold_3.pt
=============== FIT DONE ===============
[BEST] epoch=7 | val_acc=59.04% | val_f1=71.67% | val_auc=60.81% | val_score=53.6900 | val_score_bestthr=67.9254
[TEST@BEST] thr_used=0.425 | acc=57.97% f1=69.69% auc=65.54% | SP_sex=5.42% EO_sex=2.17% SP_age=8.69% EO_age=12.00%
[TIME] 1.02 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold3_rep1_seed1003/summary_fold_3.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5496 mb_mean=0.5403 norm_overlap=1.0001 corr_cb=0.3519 topkJ=0.1406
[TRAIN][ep=000] loss=0.6941 acc=50.47%
[TRAIN][ep=000] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1607
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5475 mb_mean=0.5372 norm_overlap=1.0001 corr_cb=0.1760 topkJ=0.2310
[TRAIN][ep=001] loss=0.6918 acc=53.02%
[TRAIN][ep=001] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1625
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5445 mb_mean=0.5368 norm_overlap=1.0000 corr_cb=-0.0182 topkJ=0.0374
[TRAIN][ep=002] loss=0.6911 acc=52.89%
[TRAIN][ep=002] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1664
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5469 mb_mean=0.5363 norm_overlap=1.0000 corr_cb=-0.0789 topkJ=0.0102
[TRAIN][ep=003] loss=0.6880 acc=57.58%
[TRAIN][ep=003] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1676
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5430 mb_mean=0.5353 norm_overlap=1.0000 corr_cb=0.0043 topkJ=0.1063
[TRAIN][ep=004] loss=0.6863 acc=55.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1536
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5519 mb_mean=0.5362 norm_overlap=1.0000 corr_cb=0.1233 topkJ=0.0542
[TRAIN][ep=005] loss=0.6841 acc=54.77%
[TRAIN][ep=005] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1638
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5510 mb_mean=0.5382 norm_overlap=1.0001 corr_cb=0.2709 topkJ=0.0754
[TRAIN][ep=006] loss=0.6814 acc=58.52%
[TRAIN][ep=006] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1403
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5482 mb_mean=0.5362 norm_overlap=1.0001 corr_cb=0.1681 topkJ=0.1178
[TRAIN][ep=007] loss=0.6765 acc=59.33%
[TRAIN][ep=007] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1610
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5467 mb_mean=0.5373 norm_overlap=1.0000 corr_cb=-0.0661 topkJ=0.0328
[TRAIN][ep=008] loss=0.6734 acc=59.73%
[TRAIN][ep=008] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1699
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5503 mb_mean=0.5383 norm_overlap=1.0002 corr_cb=0.3963 topkJ=0.1772
[TRAIN][ep=009] loss=0.6678 acc=57.85%
[TRAIN][ep=009] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1600
================= FIT START (fold=3) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5516 mb_mean=0.5395 norm_overlap=1.0000 corr_cb=0.0837 topkJ=0.0302
[TRAIN][ep=000] loss=0.6601 acc=61.34%
[TRAIN][ep=000] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1701
[EPOCH 000/089] train: loss=0.6601 acc=61.34% | val: loss=0.6887 acc=59.04% f1=71.67% auc=57.79% val_score=62.3022 val_score_bestthr=67.2030 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.170) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 67.2030
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep1_seed1003/ckpt_best_fold_3.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5481 mb_mean=0.5374 norm_overlap=1.0000 corr_cb=0.1478 topkJ=0.0522
[TRAIN][ep=001] loss=0.6562 acc=60.27%
[TRAIN][ep=001] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1569
[EPOCH 001/089] train: loss=0.6562 acc=60.27% | val: loss=0.6935 acc=61.45% f1=71.43% auc=52.15% val_score=38.1845 val_score_bestthr=63.8992 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.157) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.2030 -> 63.8992
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5562 mb_mean=0.5396 norm_overlap=1.0002 corr_cb=0.3367 topkJ=0.1809
[TRAIN][ep=002] loss=0.6546 acc=60.94%
[TRAIN][ep=002] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1556
[EPOCH 002/089] train: loss=0.6546 acc=60.94% | val: loss=0.6945 acc=61.45% f1=71.43% auc=52.91% val_score=38.1845 val_score_bestthr=63.8992 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.156) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.2030 -> 63.8992
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5486 mb_mean=0.5364 norm_overlap=1.0000 corr_cb=0.1156 topkJ=0.0623
[TRAIN][ep=003] loss=0.6461 acc=62.95%
[TRAIN][ep=003] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1636
[EPOCH 003/089] train: loss=0.6461 acc=62.95% | val: loss=0.6917 acc=62.65% f1=69.31% auc=59.13% val_score=58.2372 val_score_bestthr=62.3086 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.164) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.2030 -> 62.3086
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5592 mb_mean=0.5394 norm_overlap=1.0001 corr_cb=0.2315 topkJ=0.1445
[TRAIN][ep=004] loss=0.6401 acc=64.83%
[TRAIN][ep=004] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1579
[EPOCH 004/089] train: loss=0.6401 acc=64.83% | val: loss=0.6900 acc=59.04% f1=70.69% auc=55.99% val_score=50.9895 val_score_bestthr=61.5649 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.158) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.2030 -> 61.5649
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5493 mb_mean=0.5373 norm_overlap=1.0000 corr_cb=-0.0651 topkJ=0.0040
[TRAIN][ep=005] loss=1.2921 acc=63.49%
[TRAIN][ep=005] mask_avg: mc_mean=0.4193 mb_mean=0.5376 norm_overlap=0.9992 corr_cb=-0.3870
[EPOCH 005/089] train: loss=1.2921 acc=63.49% | val: loss=0.7262 acc=56.63% f1=60.87% auc=52.38% val_score=37.3493 val_score_bestthr=56.5770 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.419, mb=0.538, no=0.999, corr=-0.387) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.2030 -> 56.5770
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.3458 mb_mean=0.5346 norm_overlap=0.9983 corr_cb=-0.4452 topkJ=0.0190
[TRAIN][ep=006] loss=1.0643 acc=63.22%
[TRAIN][ep=006] mask_avg: mc_mean=0.2657 mb_mean=0.5376 norm_overlap=0.9979 corr_cb=-0.3702
[EPOCH 006/089] train: loss=1.0643 acc=63.22% | val: loss=0.6860 acc=59.04% f1=71.19% auc=57.50% val_score=48.9790 val_score_bestthr=66.0866 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.266, mb=0.538, no=0.998, corr=-0.370) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.2030 -> 66.0866
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2020 mb_mean=0.5371 norm_overlap=0.9976 corr_cb=-0.4369 topkJ=0.0039
[TRAIN][ep=007] loss=0.8571 acc=63.22%
[TRAIN][ep=007] mask_avg: mc_mean=0.2139 mb_mean=0.5376 norm_overlap=0.9972 corr_cb=-0.3667
[EPOCH 007/089] train: loss=0.8571 acc=63.22% | val: loss=0.6811 acc=59.04% f1=71.67% auc=60.99% val_score=53.6900 val_score_bestthr=67.9254 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.040, stage2=False) | mask(mc=0.214, mb=0.538, no=0.997, corr=-0.367) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 67.2030 -> 67.9254
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep1_seed1003/ckpt_best_fold_3.pt
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2300 mb_mean=0.5355 norm_overlap=0.9988 corr_cb=-0.1891 topkJ=0.0840
[TRAIN][ep=008] loss=0.9303 acc=64.16%
[TRAIN][ep=008] mask_avg: mc_mean=0.1927 mb_mean=0.5376 norm_overlap=0.9968 corr_cb=-0.3644
[EPOCH 008/089] train: loss=0.9303 acc=64.16% | val: loss=0.6878 acc=59.04% f1=71.19% auc=56.98% val_score=37.1542 val_score_bestthr=66.0866 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.080, stage2=False) | mask(mc=0.193, mb=0.538, no=0.997, corr=-0.364) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 66.0866
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1625 mb_mean=0.5395 norm_overlap=0.9952 corr_cb=-0.4388 topkJ=0.0131
[TRAIN][ep=009] loss=1.0078 acc=64.43%
[TRAIN][ep=009] mask_avg: mc_mean=0.1774 mb_mean=0.5376 norm_overlap=0.9965 corr_cb=-0.3480
[EPOCH 009/089] train: loss=1.0078 acc=64.43% | val: loss=0.7224 acc=55.42% f1=69.42% auc=55.52% val_score=40.0656 val_score_bestthr=60.9231 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.120, stage2=False) | mask(mc=0.177, mb=0.538, no=0.997, corr=-0.348) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 60.9231
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1462 mb_mean=0.5379 norm_overlap=0.9973 corr_cb=-0.3406 topkJ=0.0147
[TRAIN][ep=010] loss=1.0791 acc=65.50%
[TRAIN][ep=010] mask_avg: mc_mean=0.1790 mb_mean=0.5376 norm_overlap=0.9963 corr_cb=-0.3728
[EPOCH 010/089] train: loss=1.0791 acc=65.50% | val: loss=0.6915 acc=59.04% f1=71.19% auc=57.56% val_score=36.7942 val_score_bestthr=66.0866 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.160, stage2=False) | mask(mc=0.179, mb=0.538, no=0.996, corr=-0.373) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 66.0866
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1495 mb_mean=0.5409 norm_overlap=0.9956 corr_cb=-0.3537 topkJ=0.0187
[TRAIN][ep=011] loss=1.1533 acc=66.98%
[TRAIN][ep=011] mask_avg: mc_mean=0.1710 mb_mean=0.5376 norm_overlap=0.9959 corr_cb=-0.3782
[EPOCH 011/089] train: loss=1.1533 acc=66.98% | val: loss=0.7154 acc=59.04% f1=70.69% auc=56.57% val_score=37.7166 val_score_bestthr=62.5605 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.171, mb=0.538, no=0.996, corr=-0.378) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 62.5605
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1674 mb_mean=0.5345 norm_overlap=0.9984 corr_cb=-0.2088 topkJ=0.0789
[TRAIN][ep=012] loss=1.2201 acc=68.05%
[TRAIN][ep=012] mask_avg: mc_mean=0.1629 mb_mean=0.5376 norm_overlap=0.9958 corr_cb=-0.3615
[EPOCH 012/089] train: loss=1.2201 acc=68.05% | val: loss=0.6871 acc=59.04% f1=71.67% auc=61.98% val_score=51.2186 val_score_bestthr=67.9254 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.163, mb=0.538, no=0.996, corr=-0.361) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 67.9254
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1935 mb_mean=0.5357 norm_overlap=0.9983 corr_cb=-0.2386 topkJ=0.0377
[TRAIN][ep=013] loss=1.0229 acc=67.38%
[TRAIN][ep=013] mask_avg: mc_mean=0.1532 mb_mean=0.5376 norm_overlap=0.9955 corr_cb=-0.3411
[EPOCH 013/089] train: loss=1.0229 acc=67.38% | val: loss=0.7311 acc=61.45% f1=72.41% auc=63.31% val_score=65.3145 val_score_bestthr=64.4737 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.153, mb=0.538, no=0.996, corr=-0.341) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 64.4737
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1451 mb_mean=0.5402 norm_overlap=0.9950 corr_cb=-0.3935 topkJ=0.0020
[TRAIN][ep=014] loss=0.8255 acc=67.25%
[TRAIN][ep=014] mask_avg: mc_mean=0.1639 mb_mean=0.5376 norm_overlap=0.9955 corr_cb=-0.3579
[EPOCH 014/089] train: loss=0.8255 acc=67.25% | val: loss=0.6830 acc=59.04% f1=71.67% auc=61.40% val_score=55.1065 val_score_bestthr=67.9254 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.164, mb=0.538, no=0.995, corr=-0.358) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 67.9254
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1582 mb_mean=0.5349 norm_overlap=0.9957 corr_cb=-0.4112 topkJ=0.0207
[TRAIN][ep=015] loss=0.7871 acc=67.79%
[TRAIN][ep=015] mask_avg: mc_mean=0.1573 mb_mean=0.5376 norm_overlap=0.9950 corr_cb=-0.3737
[EPOCH 015/089] train: loss=0.7871 acc=67.79% | val: loss=0.6882 acc=57.83% f1=70.59% auc=60.41% val_score=51.8129 val_score_bestthr=64.6159 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.157, mb=0.538, no=0.995, corr=-0.374) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 64.6159
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1309 mb_mean=0.5397 norm_overlap=0.9935 corr_cb=-0.4341 topkJ=0.0077
[TRAIN][ep=016] loss=0.7902 acc=67.65%
[TRAIN][ep=016] mask_avg: mc_mean=0.1617 mb_mean=0.5376 norm_overlap=0.9947 corr_cb=-0.3952
[EPOCH 016/089] train: loss=0.7902 acc=67.65% | val: loss=0.7770 acc=60.24% f1=67.33% auc=57.09% val_score=37.0115 val_score_bestthr=62.3142 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.162, mb=0.538, no=0.995, corr=-0.395) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 62.3142
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1762 mb_mean=0.5373 norm_overlap=0.9954 corr_cb=-0.2838 topkJ=0.0448
[TRAIN][ep=017] loss=0.7787 acc=67.79%
[TRAIN][ep=017] mask_avg: mc_mean=0.1659 mb_mean=0.5376 norm_overlap=0.9946 corr_cb=-0.4066
[EPOCH 017/089] train: loss=0.7787 acc=67.79% | val: loss=0.6820 acc=61.45% f1=70.91% auc=62.09% val_score=51.0849 val_score_bestthr=60.7200 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.166, mb=0.538, no=0.995, corr=-0.407) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 60.7200
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1883 mb_mean=0.5362 norm_overlap=0.9969 corr_cb=-0.2957 topkJ=0.0281
[TRAIN][ep=018] loss=0.7616 acc=71.81%
[TRAIN][ep=018] mask_avg: mc_mean=0.1730 mb_mean=0.5376 norm_overlap=0.9947 corr_cb=-0.3908
[EPOCH 018/089] train: loss=0.7616 acc=71.81% | val: loss=0.6840 acc=57.83% f1=71.07% auc=62.21% val_score=51.7537 val_score_bestthr=66.4345 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.173, mb=0.538, no=0.995, corr=-0.391) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 66.4345
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1647 mb_mean=0.5388 norm_overlap=0.9933 corr_cb=-0.4706 topkJ=0.0149
[TRAIN][ep=019] loss=0.7615 acc=70.34%
[TRAIN][ep=019] mask_avg: mc_mean=0.1737 mb_mean=0.5376 norm_overlap=0.9944 corr_cb=-0.4102
[EPOCH 019/089] train: loss=0.7615 acc=70.34% | val: loss=0.7049 acc=57.83% f1=70.09% auc=60.64% val_score=41.9157 val_score_bestthr=59.9234 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.174, mb=0.538, no=0.994, corr=-0.410) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 59.9234
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1561 mb_mean=0.5373 norm_overlap=0.9933 corr_cb=-0.4679 topkJ=0.0012
[TRAIN][ep=020] loss=0.7553 acc=71.81%
[TRAIN][ep=020] mask_avg: mc_mean=0.1751 mb_mean=0.5376 norm_overlap=0.9945 corr_cb=-0.3891
[EPOCH 020/089] train: loss=0.7553 acc=71.81% | val: loss=0.6885 acc=57.83% f1=70.59% auc=63.43% val_score=52.7523 val_score_bestthr=64.6159 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.175, mb=0.538, no=0.994, corr=-0.389) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 64.6159
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2044 mb_mean=0.5381 norm_overlap=0.9950 corr_cb=-0.3558 topkJ=0.0390
[TRAIN][ep=021] loss=0.7541 acc=68.19%
[TRAIN][ep=021] mask_avg: mc_mean=0.1737 mb_mean=0.5376 norm_overlap=0.9941 corr_cb=-0.4197
[EPOCH 021/089] train: loss=0.7541 acc=68.19% | val: loss=0.6999 acc=61.45% f1=70.37% auc=63.66% val_score=57.8752 val_score_bestthr=60.6338 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.174, mb=0.538, no=0.994, corr=-0.420) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 60.6338
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1484 mb_mean=0.5376 norm_overlap=0.9933 corr_cb=-0.5177 topkJ=0.0083
[TRAIN][ep=022] loss=0.7510 acc=70.34%
[TRAIN][ep=022] mask_avg: mc_mean=0.1780 mb_mean=0.5376 norm_overlap=0.9940 corr_cb=-0.4305
[EPOCH 022/089] train: loss=0.7510 acc=70.34% | val: loss=0.7077 acc=63.86% f1=68.75% auc=61.28% val_score=44.3512 val_score_bestthr=61.2767 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.178, mb=0.538, no=0.994, corr=-0.430) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 61.2767
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1947 mb_mean=0.5360 norm_overlap=0.9946 corr_cb=-0.4289 topkJ=0.0084
[TRAIN][ep=023] loss=0.7360 acc=72.08%
[TRAIN][ep=023] mask_avg: mc_mean=0.1706 mb_mean=0.5376 norm_overlap=0.9940 corr_cb=-0.3947
[EPOCH 023/089] train: loss=0.7360 acc=72.08% | val: loss=0.7112 acc=63.86% f1=68.75% auc=61.22% val_score=49.1566 val_score_bestthr=61.2767 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.171, mb=0.538, no=0.994, corr=-0.395) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 61.2767
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1625 mb_mean=0.5388 norm_overlap=0.9934 corr_cb=-0.3589 topkJ=0.0292
[TRAIN][ep=024] loss=0.7395 acc=70.07%
[TRAIN][ep=024] mask_avg: mc_mean=0.1622 mb_mean=0.5376 norm_overlap=0.9937 corr_cb=-0.3893
[EPOCH 024/089] train: loss=0.7395 acc=70.07% | val: loss=0.6927 acc=60.24% f1=71.79% auc=64.24% val_score=55.2111 val_score_bestthr=65.1322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.162, mb=0.538, no=0.994, corr=-0.389) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1322
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1563 mb_mean=0.5377 norm_overlap=0.9903 corr_cb=-0.4606 topkJ=0.0130
[TRAIN][ep=025] loss=0.7388 acc=72.21%
[TRAIN][ep=025] mask_avg: mc_mean=0.1716 mb_mean=0.5376 norm_overlap=0.9939 corr_cb=-0.3800
[EPOCH 025/089] train: loss=0.7388 acc=72.21% | val: loss=0.8354 acc=61.45% f1=65.96% auc=60.29% val_score=41.6456 val_score_bestthr=61.1649 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.172, mb=0.538, no=0.994, corr=-0.380) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 61.1649
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1208 mb_mean=0.5373 norm_overlap=0.9930 corr_cb=-0.3620 topkJ=0.0119
[TRAIN][ep=026] loss=0.7331 acc=71.81%
[TRAIN][ep=026] mask_avg: mc_mean=0.1614 mb_mean=0.5376 norm_overlap=0.9933 corr_cb=-0.3993
[EPOCH 026/089] train: loss=0.7331 acc=71.81% | val: loss=0.6842 acc=60.24% f1=71.79% auc=64.07% val_score=59.9061 val_score_bestthr=65.1322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.161, mb=0.538, no=0.993, corr=-0.399) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1322
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1953 mb_mean=0.5358 norm_overlap=0.9977 corr_cb=-0.1868 topkJ=0.0468
[TRAIN][ep=027] loss=0.7097 acc=74.09%
[TRAIN][ep=027] mask_avg: mc_mean=0.1779 mb_mean=0.5376 norm_overlap=0.9937 corr_cb=-0.3883
[EPOCH 027/089] train: loss=0.7097 acc=74.09% | val: loss=0.7038 acc=59.04% f1=71.19% auc=63.20% val_score=57.6757 val_score_bestthr=65.1533 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.178, mb=0.538, no=0.994, corr=-0.388) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1533
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1774 mb_mean=0.5361 norm_overlap=0.9938 corr_cb=-0.3807 topkJ=0.0107
[TRAIN][ep=028] loss=0.7150 acc=73.15%
[TRAIN][ep=028] mask_avg: mc_mean=0.1587 mb_mean=0.5376 norm_overlap=0.9936 corr_cb=-0.3546
[EPOCH 028/089] train: loss=0.7150 acc=73.15% | val: loss=0.6949 acc=60.24% f1=71.79% auc=64.24% val_score=59.9061 val_score_bestthr=65.1322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.159, mb=0.538, no=0.994, corr=-0.355) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1322
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.1724 mb_mean=0.5390 norm_overlap=0.9916 corr_cb=-0.4269 topkJ=0.0115
[TRAIN][ep=029] loss=0.6976 acc=74.09%
[TRAIN][ep=029] mask_avg: mc_mean=0.1868 mb_mean=0.5376 norm_overlap=0.9939 corr_cb=-0.3678
[EPOCH 029/089] train: loss=0.6976 acc=74.09% | val: loss=0.7168 acc=60.24% f1=71.79% auc=64.19% val_score=57.5005 val_score_bestthr=65.1322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.187, mb=0.538, no=0.994, corr=-0.368) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1322
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2418 mb_mean=0.5360 norm_overlap=0.9966 corr_cb=-0.2688 topkJ=0.0192
[TRAIN][ep=030] loss=0.7090 acc=72.75%
[TRAIN][ep=030] mask_avg: mc_mean=0.1676 mb_mean=0.5376 norm_overlap=0.9937 corr_cb=-0.3448
[EPOCH 030/089] train: loss=0.7090 acc=72.75% | val: loss=0.7966 acc=62.65% f1=65.93% auc=62.21% val_score=44.1087 val_score_bestthr=60.6077 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.168, mb=0.538, no=0.994, corr=-0.345) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 60.6077
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.1780 mb_mean=0.5363 norm_overlap=0.9966 corr_cb=-0.1816 topkJ=0.0384
[TRAIN][ep=031] loss=0.6993 acc=75.30%
[TRAIN][ep=031] mask_avg: mc_mean=0.1604 mb_mean=0.5376 norm_overlap=0.9937 corr_cb=-0.3320
[EPOCH 031/089] train: loss=0.6993 acc=75.30% | val: loss=0.7324 acc=61.45% f1=72.41% auc=65.87% val_score=62.7963 val_score_bestthr=65.1127 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.160, mb=0.538, no=0.994, corr=-0.332) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1127
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1512 mb_mean=0.5378 norm_overlap=0.9916 corr_cb=-0.5310 topkJ=0.0008
[TRAIN][ep=032] loss=0.7092 acc=73.29%
[TRAIN][ep=032] mask_avg: mc_mean=0.1651 mb_mean=0.5376 norm_overlap=0.9936 corr_cb=-0.3466
[EPOCH 032/089] train: loss=0.7092 acc=73.29% | val: loss=0.7106 acc=59.04% f1=71.19% auc=63.20% val_score=51.2154 val_score_bestthr=63.8778 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.165, mb=0.538, no=0.994, corr=-0.347) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 63.8778
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1721 mb_mean=0.5365 norm_overlap=0.9940 corr_cb=-0.3366 topkJ=0.0080
[TRAIN][ep=033] loss=0.6770 acc=75.84%
[TRAIN][ep=033] mask_avg: mc_mean=0.1817 mb_mean=0.5376 norm_overlap=0.9941 corr_cb=-0.3354
[EPOCH 033/089] train: loss=0.6770 acc=75.84% | val: loss=0.6956 acc=61.45% f1=72.41% auc=64.77% val_score=57.3625 val_score_bestthr=65.1127 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.182, mb=0.538, no=0.994, corr=-0.335) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1127
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1763 mb_mean=0.5402 norm_overlap=0.9917 corr_cb=-0.4418 topkJ=0.0040
[TRAIN][ep=034] loss=0.6656 acc=76.51%
[TRAIN][ep=034] mask_avg: mc_mean=0.1786 mb_mean=0.5376 norm_overlap=0.9943 corr_cb=-0.3161
[EPOCH 034/089] train: loss=0.6656 acc=76.51% | val: loss=0.7074 acc=61.45% f1=72.41% auc=65.93% val_score=58.1094 val_score_bestthr=65.1127 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.179, mb=0.538, no=0.994, corr=-0.316) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1127
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.1967 mb_mean=0.5383 norm_overlap=0.9937 corr_cb=-0.3908 topkJ=0.0112
[TRAIN][ep=035] loss=0.6774 acc=75.70%
[TRAIN][ep=035] mask_avg: mc_mean=0.2013 mb_mean=0.5376 norm_overlap=0.9948 corr_cb=-0.3042
[EPOCH 035/089] train: loss=0.6774 acc=75.70% | val: loss=0.6983 acc=61.45% f1=72.41% auc=66.57% val_score=54.6632 val_score_bestthr=65.1127 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.201, mb=0.538, no=0.995, corr=-0.304) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1127
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2160 mb_mean=0.5386 norm_overlap=0.9945 corr_cb=-0.2918 topkJ=0.0114
[TRAIN][ep=036] loss=0.6641 acc=76.64%
[TRAIN][ep=036] mask_avg: mc_mean=0.1627 mb_mean=0.5376 norm_overlap=0.9942 corr_cb=-0.2887
[EPOCH 036/089] train: loss=0.6641 acc=76.64% | val: loss=0.6868 acc=60.24% f1=71.79% auc=67.09% val_score=56.7469 val_score_bestthr=63.8567 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.163, mb=0.538, no=0.994, corr=-0.289) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 63.8567
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1845 mb_mean=0.5386 norm_overlap=0.9942 corr_cb=-0.3542 topkJ=0.0101
[TRAIN][ep=037] loss=0.6560 acc=75.97%
[TRAIN][ep=037] mask_avg: mc_mean=0.2139 mb_mean=0.5376 norm_overlap=0.9949 corr_cb=-0.2932
[EPOCH 037/089] train: loss=0.6560 acc=75.97% | val: loss=0.7255 acc=61.45% f1=72.41% auc=65.70% val_score=47.1655 val_score_bestthr=65.1127 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.214, mb=0.538, no=0.995, corr=-0.293) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1127
[EARLY STOP] no improvement for 30 epochs. best_epoch=7
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold3_rep1_seed1003/ckpt_best_fold_3.pt
=============== FIT DONE ===============
[BEST] epoch=7 | val_acc=59.04% | val_f1=71.67% | val_auc=60.99% | val_score=53.6900 | val_score_bestthr=67.9254
[TEST@BEST] thr_used=0.430 | acc=57.97% f1=69.69% auc=65.55% | SP_sex=5.42% EO_sex=2.17% SP_age=8.69% EO_age=12.00%
[TIME] 1.08 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold3_rep1_seed1003/summary_fold_3.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5496 mb_mean=0.5403 norm_overlap=1.0001 corr_cb=0.3519 topkJ=0.1406
[TRAIN][ep=000] loss=0.6941 acc=50.47%
[TRAIN][ep=000] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1607
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5475 mb_mean=0.5372 norm_overlap=1.0001 corr_cb=0.1760 topkJ=0.2310
[TRAIN][ep=001] loss=0.6918 acc=53.02%
[TRAIN][ep=001] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1625
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5445 mb_mean=0.5368 norm_overlap=1.0000 corr_cb=-0.0182 topkJ=0.0374
[TRAIN][ep=002] loss=0.6911 acc=52.89%
[TRAIN][ep=002] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1664
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5469 mb_mean=0.5363 norm_overlap=1.0000 corr_cb=-0.0789 topkJ=0.0102
[TRAIN][ep=003] loss=0.6880 acc=57.45%
[TRAIN][ep=003] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1676
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5430 mb_mean=0.5353 norm_overlap=1.0000 corr_cb=0.0043 topkJ=0.1063
[TRAIN][ep=004] loss=0.6863 acc=55.57%
[TRAIN][ep=004] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1536
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5519 mb_mean=0.5362 norm_overlap=1.0000 corr_cb=0.1233 topkJ=0.0542
[TRAIN][ep=005] loss=0.6841 acc=54.77%
[TRAIN][ep=005] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1638
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5510 mb_mean=0.5382 norm_overlap=1.0001 corr_cb=0.2709 topkJ=0.0754
[TRAIN][ep=006] loss=0.6814 acc=58.52%
[TRAIN][ep=006] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1403
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5482 mb_mean=0.5362 norm_overlap=1.0001 corr_cb=0.1681 topkJ=0.1178
[TRAIN][ep=007] loss=0.6765 acc=59.33%
[TRAIN][ep=007] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1610
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5467 mb_mean=0.5373 norm_overlap=1.0000 corr_cb=-0.0661 topkJ=0.0328
[TRAIN][ep=008] loss=0.6734 acc=59.73%
[TRAIN][ep=008] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1699
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5503 mb_mean=0.5383 norm_overlap=1.0002 corr_cb=0.3963 topkJ=0.1772
[TRAIN][ep=009] loss=0.6678 acc=57.85%
[TRAIN][ep=009] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1600
================= FIT START (fold=3) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5516 mb_mean=0.5395 norm_overlap=1.0000 corr_cb=0.0837 topkJ=0.0302
[TRAIN][ep=000] loss=0.6601 acc=61.34%
[TRAIN][ep=000] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1701
[EPOCH 000/089] train: loss=0.6601 acc=61.34% | val: loss=0.6887 acc=62.65% f1=68.69% auc=57.85% val_score=62.3022 val_score_bestthr=60.1879 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.170) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 60.1879
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep1_seed1003/ckpt_best_fold_3.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5481 mb_mean=0.5374 norm_overlap=1.0000 corr_cb=0.1478 topkJ=0.0522
[TRAIN][ep=001] loss=0.6562 acc=60.27%
[TRAIN][ep=001] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1569
[EPOCH 001/089] train: loss=0.6562 acc=60.27% | val: loss=0.6934 acc=61.45% f1=71.43% auc=52.15% val_score=38.9876 val_score_bestthr=63.8992 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.157) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 60.1879 -> 63.8992
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep1_seed1003/ckpt_best_fold_3.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5562 mb_mean=0.5396 norm_overlap=1.0002 corr_cb=0.3367 topkJ=0.1809
[TRAIN][ep=002] loss=0.6547 acc=60.94%
[TRAIN][ep=002] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1556
[EPOCH 002/089] train: loss=0.6547 acc=60.94% | val: loss=0.6945 acc=61.45% f1=71.43% auc=52.97% val_score=38.1845 val_score_bestthr=63.8992 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.156) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8992 -> 63.8992
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5486 mb_mean=0.5364 norm_overlap=1.0000 corr_cb=0.1156 topkJ=0.0623
[TRAIN][ep=003] loss=0.6462 acc=62.95%
[TRAIN][ep=003] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1636
[EPOCH 003/089] train: loss=0.6462 acc=62.95% | val: loss=0.6917 acc=62.65% f1=69.31% auc=59.19% val_score=58.2372 val_score_bestthr=62.3086 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.164) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8992 -> 62.3086
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5592 mb_mean=0.5394 norm_overlap=1.0001 corr_cb=0.2315 topkJ=0.1445
[TRAIN][ep=004] loss=0.6402 acc=64.83%
[TRAIN][ep=004] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1579
[EPOCH 004/089] train: loss=0.6402 acc=64.83% | val: loss=0.6900 acc=59.04% f1=70.69% auc=55.93% val_score=50.9895 val_score_bestthr=61.5649 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.158) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8992 -> 61.5649
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5493 mb_mean=0.5373 norm_overlap=1.0000 corr_cb=-0.0651 topkJ=0.0040
[TRAIN][ep=005] loss=1.4630 acc=63.49%
[TRAIN][ep=005] mask_avg: mc_mean=0.4193 mb_mean=0.5376 norm_overlap=0.9992 corr_cb=-0.3869
[EPOCH 005/089] train: loss=1.4630 acc=63.49% | val: loss=0.7257 acc=56.63% f1=67.86% auc=52.56% val_score=38.7965 val_score_bestthr=57.9211 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.419, mb=0.538, no=0.999, corr=-0.387) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8992 -> 57.9211
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.3458 mb_mean=0.5346 norm_overlap=0.9983 corr_cb=-0.4451 topkJ=0.0190
[TRAIN][ep=006] loss=1.4373 acc=62.15%
[TRAIN][ep=006] mask_avg: mc_mean=0.2658 mb_mean=0.5376 norm_overlap=0.9979 corr_cb=-0.3720
[EPOCH 006/089] train: loss=1.4373 acc=62.15% | val: loss=0.6851 acc=59.04% f1=71.19% auc=57.73% val_score=48.9790 val_score_bestthr=66.0866 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.266, mb=0.538, no=0.998, corr=-0.372) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 63.8992 -> 66.0866
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep1_seed1003/ckpt_best_fold_3.pt
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2023 mb_mean=0.5371 norm_overlap=0.9976 corr_cb=-0.4408 topkJ=0.0039
[TRAIN][ep=007] loss=1.4294 acc=63.62%
[TRAIN][ep=007] mask_avg: mc_mean=0.2134 mb_mean=0.5376 norm_overlap=0.9972 corr_cb=-0.3704
[EPOCH 007/089] train: loss=1.4294 acc=63.62% | val: loss=0.6804 acc=59.04% f1=71.67% auc=60.87% val_score=53.4244 val_score_bestthr=67.9254 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.213, mb=0.538, no=0.997, corr=-0.370) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 66.0866 -> 67.9254
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep1_seed1003/ckpt_best_fold_3.pt
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2291 mb_mean=0.5355 norm_overlap=0.9987 corr_cb=-0.1935 topkJ=0.0849
[TRAIN][ep=008] loss=1.4214 acc=64.16%
[TRAIN][ep=008] mask_avg: mc_mean=0.1928 mb_mean=0.5376 norm_overlap=0.9968 corr_cb=-0.3718
[EPOCH 008/089] train: loss=1.4214 acc=64.16% | val: loss=0.6872 acc=59.04% f1=71.19% auc=57.27% val_score=37.1542 val_score_bestthr=66.0866 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.193, mb=0.538, no=0.997, corr=-0.372) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 66.0866
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1633 mb_mean=0.5395 norm_overlap=0.9952 corr_cb=-0.4438 topkJ=0.0131
[TRAIN][ep=009] loss=1.4195 acc=64.97%
[TRAIN][ep=009] mask_avg: mc_mean=0.1781 mb_mean=0.5376 norm_overlap=0.9965 corr_cb=-0.3513
[EPOCH 009/089] train: loss=1.4195 acc=64.97% | val: loss=0.7200 acc=57.83% f1=69.57% auc=55.35% val_score=40.7066 val_score_bestthr=56.8676 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.178, mb=0.538, no=0.997, corr=-0.351) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 56.8676
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1476 mb_mean=0.5379 norm_overlap=0.9973 corr_cb=-0.3477 topkJ=0.0143
[TRAIN][ep=010] loss=1.4103 acc=65.91%
[TRAIN][ep=010] mask_avg: mc_mean=0.1800 mb_mean=0.5376 norm_overlap=0.9963 corr_cb=-0.3739
[EPOCH 010/089] train: loss=1.4103 acc=65.91% | val: loss=0.6906 acc=59.04% f1=71.19% auc=57.62% val_score=35.6917 val_score_bestthr=66.0866 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.180, mb=0.538, no=0.996, corr=-0.374) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 66.0866
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1503 mb_mean=0.5409 norm_overlap=0.9956 corr_cb=-0.3546 topkJ=0.0187
[TRAIN][ep=011] loss=1.4055 acc=67.25%
[TRAIN][ep=011] mask_avg: mc_mean=0.1726 mb_mean=0.5376 norm_overlap=0.9960 corr_cb=-0.3769
[EPOCH 011/089] train: loss=1.4055 acc=67.25% | val: loss=0.7170 acc=59.04% f1=67.31% auc=56.57% val_score=37.6974 val_score_bestthr=59.6594 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.173, mb=0.538, no=0.996, corr=-0.377) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 59.6594
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1702 mb_mean=0.5345 norm_overlap=0.9985 corr_cb=-0.2085 topkJ=0.0789
[TRAIN][ep=012] loss=1.3938 acc=68.05%
[TRAIN][ep=012] mask_avg: mc_mean=0.1645 mb_mean=0.5376 norm_overlap=0.9958 corr_cb=-0.3574
[EPOCH 012/089] train: loss=1.3938 acc=68.05% | val: loss=0.6876 acc=59.04% f1=71.67% auc=61.86% val_score=52.3206 val_score_bestthr=67.9254 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.165, mb=0.538, no=0.996, corr=-0.357) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 67.9254
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1953 mb_mean=0.5357 norm_overlap=0.9984 corr_cb=-0.2318 topkJ=0.0385
[TRAIN][ep=013] loss=1.1964 acc=67.38%
[TRAIN][ep=013] mask_avg: mc_mean=0.1534 mb_mean=0.5376 norm_overlap=0.9956 corr_cb=-0.3346
[EPOCH 013/089] train: loss=1.1964 acc=67.38% | val: loss=0.7316 acc=61.45% f1=72.41% auc=63.43% val_score=65.3145 val_score_bestthr=64.4737 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.153, mb=0.538, no=0.996, corr=-0.335) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 64.4737
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1437 mb_mean=0.5402 norm_overlap=0.9951 corr_cb=-0.3854 topkJ=0.0020
[TRAIN][ep=014] loss=0.9994 acc=67.38%
[TRAIN][ep=014] mask_avg: mc_mean=0.1620 mb_mean=0.5376 norm_overlap=0.9955 corr_cb=-0.3490
[EPOCH 014/089] train: loss=0.9994 acc=67.38% | val: loss=0.6835 acc=59.04% f1=71.67% auc=61.34% val_score=55.1065 val_score_bestthr=67.9254 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.162, mb=0.538, no=0.996, corr=-0.349) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 67.9254
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1563 mb_mean=0.5349 norm_overlap=0.9958 corr_cb=-0.3988 topkJ=0.0220
[TRAIN][ep=015] loss=0.9608 acc=67.79%
[TRAIN][ep=015] mask_avg: mc_mean=0.1559 mb_mean=0.5376 norm_overlap=0.9951 corr_cb=-0.3641
[EPOCH 015/089] train: loss=0.9608 acc=67.79% | val: loss=0.6890 acc=57.83% f1=70.59% auc=60.17% val_score=49.2398 val_score_bestthr=64.6159 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.156, mb=0.538, no=0.995, corr=-0.364) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 64.6159
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1296 mb_mean=0.5397 norm_overlap=0.9936 corr_cb=-0.4239 topkJ=0.0077
[TRAIN][ep=016] loss=0.9499 acc=68.05%
[TRAIN][ep=016] mask_avg: mc_mean=0.1612 mb_mean=0.5376 norm_overlap=0.9948 corr_cb=-0.3854
[EPOCH 016/089] train: loss=0.9499 acc=68.05% | val: loss=0.7757 acc=60.24% f1=67.33% auc=57.27% val_score=39.0663 val_score_bestthr=62.3142 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.161, mb=0.538, no=0.995, corr=-0.385) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 62.3142
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1757 mb_mean=0.5373 norm_overlap=0.9955 corr_cb=-0.2755 topkJ=0.0448
[TRAIN][ep=017] loss=0.9378 acc=67.92%
[TRAIN][ep=017] mask_avg: mc_mean=0.1648 mb_mean=0.5376 norm_overlap=0.9947 corr_cb=-0.3958
[EPOCH 017/089] train: loss=0.9378 acc=67.92% | val: loss=0.6823 acc=61.45% f1=70.91% auc=62.09% val_score=53.5990 val_score_bestthr=60.7200 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.165, mb=0.538, no=0.995, corr=-0.396) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 60.7200
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1875 mb_mean=0.5362 norm_overlap=0.9970 corr_cb=-0.2832 topkJ=0.0281
[TRAIN][ep=018] loss=0.9206 acc=71.81%
[TRAIN][ep=018] mask_avg: mc_mean=0.1729 mb_mean=0.5376 norm_overlap=0.9949 corr_cb=-0.3800
[EPOCH 018/089] train: loss=0.9206 acc=71.81% | val: loss=0.6845 acc=57.83% f1=71.07% auc=61.98% val_score=51.7537 val_score_bestthr=66.4345 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.173, mb=0.538, no=0.995, corr=-0.380) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 66.4345
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1649 mb_mean=0.5388 norm_overlap=0.9934 corr_cb=-0.4598 topkJ=0.0153
[TRAIN][ep=019] loss=0.9205 acc=70.47%
[TRAIN][ep=019] mask_avg: mc_mean=0.1746 mb_mean=0.5376 norm_overlap=0.9946 corr_cb=-0.3999
[EPOCH 019/089] train: loss=0.9205 acc=70.47% | val: loss=0.7051 acc=57.83% f1=70.09% auc=60.47% val_score=41.9157 val_score_bestthr=59.9234 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.175, mb=0.538, no=0.995, corr=-0.400) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 59.9234
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1558 mb_mean=0.5373 norm_overlap=0.9934 corr_cb=-0.4560 topkJ=0.0012
[TRAIN][ep=020] loss=0.9140 acc=71.68%
[TRAIN][ep=020] mask_avg: mc_mean=0.1745 mb_mean=0.5376 norm_overlap=0.9946 corr_cb=-0.3784
[EPOCH 020/089] train: loss=0.9140 acc=71.68% | val: loss=0.6894 acc=57.83% f1=70.59% auc=63.31% val_score=52.7523 val_score_bestthr=64.6159 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.174, mb=0.538, no=0.995, corr=-0.378) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 64.6159
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2039 mb_mean=0.5381 norm_overlap=0.9951 corr_cb=-0.3463 topkJ=0.0398
[TRAIN][ep=021] loss=0.9124 acc=68.46%
[TRAIN][ep=021] mask_avg: mc_mean=0.1741 mb_mean=0.5376 norm_overlap=0.9942 corr_cb=-0.4094
[EPOCH 021/089] train: loss=0.9124 acc=68.46% | val: loss=0.7020 acc=60.24% f1=71.79% auc=63.84% val_score=54.3001 val_score_bestthr=65.1322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.174, mb=0.538, no=0.994, corr=-0.409) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1322
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1488 mb_mean=0.5376 norm_overlap=0.9934 corr_cb=-0.5105 topkJ=0.0092
[TRAIN][ep=022] loss=0.9099 acc=70.20%
[TRAIN][ep=022] mask_avg: mc_mean=0.1786 mb_mean=0.5376 norm_overlap=0.9941 corr_cb=-0.4212
[EPOCH 022/089] train: loss=0.9099 acc=70.20% | val: loss=0.7080 acc=63.86% f1=68.75% auc=61.10% val_score=44.3512 val_score_bestthr=61.2767 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.179, mb=0.538, no=0.994, corr=-0.421) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 61.2767
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1956 mb_mean=0.5360 norm_overlap=0.9947 corr_cb=-0.4206 topkJ=0.0084
[TRAIN][ep=023] loss=0.8943 acc=72.08%
[TRAIN][ep=023] mask_avg: mc_mean=0.1707 mb_mean=0.5376 norm_overlap=0.9942 corr_cb=-0.3851
[EPOCH 023/089] train: loss=0.8943 acc=72.08% | val: loss=0.7116 acc=63.86% f1=68.75% auc=61.22% val_score=49.1566 val_score_bestthr=61.2767 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.171, mb=0.538, no=0.994, corr=-0.385) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 61.2767
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1625 mb_mean=0.5388 norm_overlap=0.9936 corr_cb=-0.3478 topkJ=0.0296
[TRAIN][ep=024] loss=0.8972 acc=70.07%
[TRAIN][ep=024] mask_avg: mc_mean=0.1618 mb_mean=0.5376 norm_overlap=0.9938 corr_cb=-0.3814
[EPOCH 024/089] train: loss=0.8972 acc=70.07% | val: loss=0.6937 acc=60.24% f1=71.79% auc=64.07% val_score=55.2111 val_score_bestthr=65.1322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.162, mb=0.538, no=0.994, corr=-0.381) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1322
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1572 mb_mean=0.5377 norm_overlap=0.9905 corr_cb=-0.4565 topkJ=0.0130
[TRAIN][ep=025] loss=0.8961 acc=72.08%
[TRAIN][ep=025] mask_avg: mc_mean=0.1714 mb_mean=0.5376 norm_overlap=0.9940 corr_cb=-0.3719
[EPOCH 025/089] train: loss=0.8961 acc=72.08% | val: loss=0.8375 acc=61.45% f1=65.96% auc=60.17% val_score=41.6456 val_score_bestthr=61.1649 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.171, mb=0.538, no=0.994, corr=-0.372) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 61.1649
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1214 mb_mean=0.5373 norm_overlap=0.9931 corr_cb=-0.3537 topkJ=0.0135
[TRAIN][ep=026] loss=0.8898 acc=71.68%
[TRAIN][ep=026] mask_avg: mc_mean=0.1612 mb_mean=0.5376 norm_overlap=0.9934 corr_cb=-0.3937
[EPOCH 026/089] train: loss=0.8898 acc=71.68% | val: loss=0.6850 acc=60.24% f1=71.79% auc=63.95% val_score=58.7897 val_score_bestthr=65.1322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.161, mb=0.538, no=0.993, corr=-0.394) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1322
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1945 mb_mean=0.5358 norm_overlap=0.9978 corr_cb=-0.1773 topkJ=0.0477
[TRAIN][ep=027] loss=0.8651 acc=74.09%
[TRAIN][ep=027] mask_avg: mc_mean=0.1776 mb_mean=0.5376 norm_overlap=0.9938 corr_cb=-0.3824
[EPOCH 027/089] train: loss=0.8651 acc=74.09% | val: loss=0.7035 acc=59.04% f1=71.19% auc=63.31% val_score=57.6757 val_score_bestthr=65.1533 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.178, mb=0.538, no=0.994, corr=-0.382) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1533
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1787 mb_mean=0.5361 norm_overlap=0.9939 corr_cb=-0.3763 topkJ=0.0107
[TRAIN][ep=028] loss=0.8708 acc=73.02%
[TRAIN][ep=028] mask_avg: mc_mean=0.1609 mb_mean=0.5376 norm_overlap=0.9937 corr_cb=-0.3507
[EPOCH 028/089] train: loss=0.8708 acc=73.02% | val: loss=0.6953 acc=60.24% f1=71.79% auc=63.84% val_score=59.9061 val_score_bestthr=65.1322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.161, mb=0.538, no=0.994, corr=-0.351) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1322
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.1726 mb_mean=0.5390 norm_overlap=0.9917 corr_cb=-0.4198 topkJ=0.0115
[TRAIN][ep=029] loss=0.8530 acc=73.69%
[TRAIN][ep=029] mask_avg: mc_mean=0.1861 mb_mean=0.5376 norm_overlap=0.9939 corr_cb=-0.3628
[EPOCH 029/089] train: loss=0.8530 acc=73.69% | val: loss=0.7175 acc=60.24% f1=71.79% auc=64.01% val_score=54.2097 val_score_bestthr=65.1322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.186, mb=0.538, no=0.994, corr=-0.363) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1322
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2412 mb_mean=0.5360 norm_overlap=0.9966 corr_cb=-0.2657 topkJ=0.0200
[TRAIN][ep=030] loss=0.8613 acc=72.89%
[TRAIN][ep=030] mask_avg: mc_mean=0.1687 mb_mean=0.5376 norm_overlap=0.9938 corr_cb=-0.3411
[EPOCH 030/089] train: loss=0.8613 acc=72.89% | val: loss=0.7975 acc=62.65% f1=67.37% auc=62.38% val_score=41.6405 val_score_bestthr=61.4564 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.169, mb=0.538, no=0.994, corr=-0.341) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 61.4564
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.1798 mb_mean=0.5363 norm_overlap=0.9967 corr_cb=-0.1784 topkJ=0.0379
[TRAIN][ep=031] loss=0.8514 acc=74.77%
[TRAIN][ep=031] mask_avg: mc_mean=0.1615 mb_mean=0.5376 norm_overlap=0.9938 corr_cb=-0.3283
[EPOCH 031/089] train: loss=0.8514 acc=74.77% | val: loss=0.7363 acc=61.45% f1=72.41% auc=66.05% val_score=62.7963 val_score_bestthr=65.1127 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.162, mb=0.538, no=0.994, corr=-0.328) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1127
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1529 mb_mean=0.5378 norm_overlap=0.9918 corr_cb=-0.5256 topkJ=0.0012
[TRAIN][ep=032] loss=0.8597 acc=73.02%
[TRAIN][ep=032] mask_avg: mc_mean=0.1663 mb_mean=0.5376 norm_overlap=0.9937 corr_cb=-0.3441
[EPOCH 032/089] train: loss=0.8597 acc=73.02% | val: loss=0.7095 acc=59.04% f1=71.19% auc=63.31% val_score=51.2154 val_score_bestthr=63.8778 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.166, mb=0.538, no=0.994, corr=-0.344) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 63.8778
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1723 mb_mean=0.5365 norm_overlap=0.9940 corr_cb=-0.3373 topkJ=0.0084
[TRAIN][ep=033] loss=0.8257 acc=75.84%
[TRAIN][ep=033] mask_avg: mc_mean=0.1819 mb_mean=0.5376 norm_overlap=0.9942 corr_cb=-0.3338
[EPOCH 033/089] train: loss=0.8257 acc=75.84% | val: loss=0.6957 acc=61.45% f1=72.41% auc=64.88% val_score=57.3625 val_score_bestthr=65.1127 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.182, mb=0.538, no=0.994, corr=-0.334) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1127
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1796 mb_mean=0.5402 norm_overlap=0.9918 corr_cb=-0.4420 topkJ=0.0036
[TRAIN][ep=034] loss=0.8122 acc=76.64%
[TRAIN][ep=034] mask_avg: mc_mean=0.1803 mb_mean=0.5376 norm_overlap=0.9943 corr_cb=-0.3153
[EPOCH 034/089] train: loss=0.8122 acc=76.64% | val: loss=0.7066 acc=61.45% f1=72.41% auc=65.87% val_score=58.1094 val_score_bestthr=65.1127 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.180, mb=0.538, no=0.994, corr=-0.315) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1127
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.1963 mb_mean=0.5383 norm_overlap=0.9937 corr_cb=-0.3870 topkJ=0.0116
[TRAIN][ep=035] loss=0.8230 acc=75.17%
[TRAIN][ep=035] mask_avg: mc_mean=0.2027 mb_mean=0.5376 norm_overlap=0.9948 corr_cb=-0.3034
[EPOCH 035/089] train: loss=0.8230 acc=75.17% | val: loss=0.6971 acc=61.45% f1=72.41% auc=66.22% val_score=54.6632 val_score_bestthr=65.1127 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.203, mb=0.538, no=0.995, corr=-0.303) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1127
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2150 mb_mean=0.5386 norm_overlap=0.9945 corr_cb=-0.2909 topkJ=0.0114
[TRAIN][ep=036] loss=0.8093 acc=76.64%
[TRAIN][ep=036] mask_avg: mc_mean=0.1638 mb_mean=0.5376 norm_overlap=0.9942 corr_cb=-0.2886
[EPOCH 036/089] train: loss=0.8093 acc=76.64% | val: loss=0.6865 acc=60.24% f1=71.79% auc=66.80% val_score=56.7469 val_score_bestthr=63.8567 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.164, mb=0.538, no=0.994, corr=-0.289) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 63.8567
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1855 mb_mean=0.5386 norm_overlap=0.9943 corr_cb=-0.3503 topkJ=0.0101
[TRAIN][ep=037] loss=0.7988 acc=75.97%
[TRAIN][ep=037] mask_avg: mc_mean=0.2135 mb_mean=0.5376 norm_overlap=0.9950 corr_cb=-0.2921
[EPOCH 037/089] train: loss=0.7988 acc=75.97% | val: loss=0.7257 acc=61.45% f1=72.41% auc=65.70% val_score=50.7299 val_score_bestthr=65.1127 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.213, mb=0.538, no=0.995, corr=-0.292) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1127
[EARLY STOP] no improvement for 30 epochs. best_epoch=7
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold3_rep1_seed1003/ckpt_best_fold_3.pt
=============== FIT DONE ===============
[BEST] epoch=7 | val_acc=59.04% | val_f1=71.67% | val_auc=60.87% | val_score=53.4244 | val_score_bestthr=67.9254
[TEST@BEST] thr_used=0.455 | acc=60.39% f1=70.07% auc=65.86% | SP_sex=6.49% EO_sex=3.36% SP_age=10.49% EO_age=20.00%
[TIME] 1.04 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold3_rep1_seed1003/summary_fold_3.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5496 mb_mean=0.5403 norm_overlap=1.0001 corr_cb=0.3519 topkJ=0.1406
[TRAIN][ep=000] loss=0.6941 acc=50.47%
[TRAIN][ep=000] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1607
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5475 mb_mean=0.5372 norm_overlap=1.0001 corr_cb=0.1760 topkJ=0.2310
[TRAIN][ep=001] loss=0.6918 acc=53.02%
[TRAIN][ep=001] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1625
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5445 mb_mean=0.5368 norm_overlap=1.0000 corr_cb=-0.0182 topkJ=0.0374
[TRAIN][ep=002] loss=0.6911 acc=52.89%
[TRAIN][ep=002] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1664
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5469 mb_mean=0.5363 norm_overlap=1.0000 corr_cb=-0.0789 topkJ=0.0102
[TRAIN][ep=003] loss=0.6880 acc=57.45%
[TRAIN][ep=003] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1676
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5430 mb_mean=0.5353 norm_overlap=1.0000 corr_cb=0.0043 topkJ=0.1063
[TRAIN][ep=004] loss=0.6863 acc=55.57%
[TRAIN][ep=004] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1536
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5519 mb_mean=0.5362 norm_overlap=1.0000 corr_cb=0.1233 topkJ=0.0542
[TRAIN][ep=005] loss=0.6841 acc=54.77%
[TRAIN][ep=005] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1638
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5510 mb_mean=0.5382 norm_overlap=1.0001 corr_cb=0.2709 topkJ=0.0754
[TRAIN][ep=006] loss=0.6814 acc=58.52%
[TRAIN][ep=006] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1403
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5482 mb_mean=0.5362 norm_overlap=1.0001 corr_cb=0.1681 topkJ=0.1178
[TRAIN][ep=007] loss=0.6765 acc=59.33%
[TRAIN][ep=007] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1610
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5467 mb_mean=0.5373 norm_overlap=1.0000 corr_cb=-0.0661 topkJ=0.0328
[TRAIN][ep=008] loss=0.6734 acc=59.73%
[TRAIN][ep=008] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1699
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5503 mb_mean=0.5383 norm_overlap=1.0002 corr_cb=0.3963 topkJ=0.1772
[TRAIN][ep=009] loss=0.6678 acc=57.85%
[TRAIN][ep=009] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1600
================= FIT START (fold=3) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5516 mb_mean=0.5395 norm_overlap=1.0000 corr_cb=0.0837 topkJ=0.0302
[TRAIN][ep=000] loss=0.6601 acc=61.34%
[TRAIN][ep=000] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1701
[EPOCH 000/089] train: loss=0.6601 acc=61.34% | val: loss=0.6887 acc=62.65% f1=68.69% auc=57.85% val_score=62.3022 val_score_bestthr=60.1879 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.170) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 60.1879
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep1_seed1003/ckpt_best_fold_3.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5481 mb_mean=0.5374 norm_overlap=1.0000 corr_cb=0.1478 topkJ=0.0522
[TRAIN][ep=001] loss=0.6562 acc=60.27%
[TRAIN][ep=001] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1569
[EPOCH 001/089] train: loss=0.6562 acc=60.27% | val: loss=0.6934 acc=61.45% f1=71.43% auc=52.09% val_score=38.9876 val_score_bestthr=63.8992 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.157) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 60.1879 -> 63.8992
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep1_seed1003/ckpt_best_fold_3.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5562 mb_mean=0.5396 norm_overlap=1.0002 corr_cb=0.3367 topkJ=0.1809
[TRAIN][ep=002] loss=0.6547 acc=60.81%
[TRAIN][ep=002] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1556
[EPOCH 002/089] train: loss=0.6547 acc=60.81% | val: loss=0.6945 acc=61.45% f1=71.43% auc=52.97% val_score=38.1845 val_score_bestthr=63.8992 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.156) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8992 -> 63.8992
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5486 mb_mean=0.5364 norm_overlap=1.0000 corr_cb=0.1156 topkJ=0.0623
[TRAIN][ep=003] loss=0.6462 acc=62.95%
[TRAIN][ep=003] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1636
[EPOCH 003/089] train: loss=0.6462 acc=62.95% | val: loss=0.6917 acc=62.65% f1=69.31% auc=59.19% val_score=58.2372 val_score_bestthr=62.3086 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.164) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8992 -> 62.3086
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5592 mb_mean=0.5394 norm_overlap=1.0001 corr_cb=0.2315 topkJ=0.1445
[TRAIN][ep=004] loss=0.6401 acc=64.83%
[TRAIN][ep=004] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1579
[EPOCH 004/089] train: loss=0.6401 acc=64.83% | val: loss=0.6900 acc=59.04% f1=70.69% auc=55.93% val_score=50.9895 val_score_bestthr=61.5649 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.158) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8992 -> 61.5649
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5493 mb_mean=0.5373 norm_overlap=1.0000 corr_cb=-0.0651 topkJ=0.0040
[TRAIN][ep=005] loss=1.2543 acc=63.49%
[TRAIN][ep=005] mask_avg: mc_mean=0.4192 mb_mean=0.5376 norm_overlap=0.9992 corr_cb=-0.3873
[EPOCH 005/089] train: loss=1.2543 acc=63.49% | val: loss=0.7262 acc=57.83% f1=61.54% auc=52.56% val_score=37.8515 val_score_bestthr=56.5650 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.419, mb=0.538, no=0.999, corr=-0.387) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8992 -> 56.5650
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.3459 mb_mean=0.5346 norm_overlap=0.9983 corr_cb=-0.4452 topkJ=0.0190
[TRAIN][ep=006] loss=1.2387 acc=62.82%
[TRAIN][ep=006] mask_avg: mc_mean=0.2655 mb_mean=0.5376 norm_overlap=0.9979 corr_cb=-0.3720
[EPOCH 006/089] train: loss=1.2387 acc=62.82% | val: loss=0.6853 acc=59.04% f1=70.69% auc=57.56% val_score=49.5895 val_score_bestthr=61.5649 | dyn(w_pfs=0.240, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.265, mb=0.538, no=0.998, corr=-0.372) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8992 -> 61.5649
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2012 mb_mean=0.5371 norm_overlap=0.9976 corr_cb=-0.4407 topkJ=0.0039
[TRAIN][ep=007] loss=1.0312 acc=63.22%
[TRAIN][ep=007] mask_avg: mc_mean=0.2131 mb_mean=0.5376 norm_overlap=0.9971 corr_cb=-0.3704
[EPOCH 007/089] train: loss=1.0312 acc=63.22% | val: loss=0.6805 acc=59.04% f1=71.67% auc=60.99% val_score=53.4244 val_score_bestthr=67.9254 | dyn(w_pfs=0.280, w_sup=0.190, w_csuf=0.140, stage2=False) | mask(mc=0.213, mb=0.538, no=0.997, corr=-0.370) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 63.8992 -> 67.9254
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep1_seed1003/ckpt_best_fold_3.pt
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2290 mb_mean=0.5355 norm_overlap=0.9987 corr_cb=-0.1925 topkJ=0.0844
[TRAIN][ep=008] loss=1.1032 acc=64.16%
[TRAIN][ep=008] mask_avg: mc_mean=0.1927 mb_mean=0.5376 norm_overlap=0.9967 corr_cb=-0.3715
[EPOCH 008/089] train: loss=1.1032 acc=64.16% | val: loss=0.6870 acc=59.04% f1=71.19% auc=57.33% val_score=36.5182 val_score_bestthr=66.0866 | dyn(w_pfs=0.320, w_sup=0.230, w_csuf=0.180, stage2=False) | mask(mc=0.193, mb=0.538, no=0.997, corr=-0.371) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 66.0866
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1634 mb_mean=0.5395 norm_overlap=0.9952 corr_cb=-0.4447 topkJ=0.0131
[TRAIN][ep=009] loss=1.1802 acc=64.97%
[TRAIN][ep=009] mask_avg: mc_mean=0.1786 mb_mean=0.5376 norm_overlap=0.9965 corr_cb=-0.3532
[EPOCH 009/089] train: loss=1.1802 acc=64.97% | val: loss=0.7200 acc=55.42% f1=69.42% auc=55.70% val_score=41.6399 val_score_bestthr=60.9231 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.179, mb=0.538, no=0.997, corr=-0.353) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 60.9231
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1472 mb_mean=0.5379 norm_overlap=0.9973 corr_cb=-0.3493 topkJ=0.0143
[TRAIN][ep=010] loss=1.2135 acc=65.77%
[TRAIN][ep=010] mask_avg: mc_mean=0.1797 mb_mean=0.5376 norm_overlap=0.9963 corr_cb=-0.3757
[EPOCH 010/089] train: loss=1.2135 acc=65.77% | val: loss=0.6903 acc=59.04% f1=71.19% auc=57.97% val_score=35.6917 val_score_bestthr=66.0866 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.180, mb=0.538, no=0.996, corr=-0.376) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 66.0866
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1495 mb_mean=0.5409 norm_overlap=0.9956 corr_cb=-0.3560 topkJ=0.0187
[TRAIN][ep=011] loss=1.2087 acc=67.38%
[TRAIN][ep=011] mask_avg: mc_mean=0.1725 mb_mean=0.5376 norm_overlap=0.9959 corr_cb=-0.3791
[EPOCH 011/089] train: loss=1.2087 acc=67.38% | val: loss=0.7155 acc=57.83% f1=70.09% auc=56.57% val_score=37.7166 val_score_bestthr=62.8622 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.172, mb=0.538, no=0.996, corr=-0.379) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 62.8622
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1700 mb_mean=0.5345 norm_overlap=0.9984 corr_cb=-0.2120 topkJ=0.0789
[TRAIN][ep=012] loss=1.1968 acc=68.05%
[TRAIN][ep=012] mask_avg: mc_mean=0.1651 mb_mean=0.5376 norm_overlap=0.9958 corr_cb=-0.3611
[EPOCH 012/089] train: loss=1.1968 acc=68.05% | val: loss=0.6870 acc=59.04% f1=71.67% auc=62.09% val_score=53.4100 val_score_bestthr=67.9254 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.165, mb=0.538, no=0.996, corr=-0.361) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 67.9254
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1957 mb_mean=0.5357 norm_overlap=0.9983 corr_cb=-0.2367 topkJ=0.0381
[TRAIN][ep=013] loss=1.0002 acc=67.11%
[TRAIN][ep=013] mask_avg: mc_mean=0.1547 mb_mean=0.5376 norm_overlap=0.9956 corr_cb=-0.3383
[EPOCH 013/089] train: loss=1.0002 acc=67.11% | val: loss=0.7313 acc=61.45% f1=72.41% auc=63.43% val_score=65.3145 val_score_bestthr=64.4737 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.155, mb=0.538, no=0.996, corr=-0.338) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 64.4737
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1458 mb_mean=0.5402 norm_overlap=0.9950 corr_cb=-0.3893 topkJ=0.0020
[TRAIN][ep=014] loss=0.8030 acc=67.38%
[TRAIN][ep=014] mask_avg: mc_mean=0.1635 mb_mean=0.5376 norm_overlap=0.9955 corr_cb=-0.3523
[EPOCH 014/089] train: loss=0.8030 acc=67.38% | val: loss=0.6829 acc=59.04% f1=71.67% auc=61.22% val_score=49.5895 val_score_bestthr=67.9254 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.164, mb=0.538, no=0.996, corr=-0.352) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 67.9254
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1570 mb_mean=0.5349 norm_overlap=0.9958 corr_cb=-0.4008 topkJ=0.0216
[TRAIN][ep=015] loss=0.7647 acc=67.92%
[TRAIN][ep=015] mask_avg: mc_mean=0.1572 mb_mean=0.5376 norm_overlap=0.9951 corr_cb=-0.3669
[EPOCH 015/089] train: loss=0.7647 acc=67.92% | val: loss=0.6882 acc=57.83% f1=70.59% auc=60.58% val_score=51.8129 val_score_bestthr=64.6159 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.157, mb=0.538, no=0.995, corr=-0.367) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 64.6159
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1307 mb_mean=0.5397 norm_overlap=0.9936 corr_cb=-0.4259 topkJ=0.0077
[TRAIN][ep=016] loss=0.7532 acc=68.19%
[TRAIN][ep=016] mask_avg: mc_mean=0.1618 mb_mean=0.5376 norm_overlap=0.9948 corr_cb=-0.3881
[EPOCH 016/089] train: loss=0.7532 acc=68.19% | val: loss=0.7749 acc=60.24% f1=67.33% auc=57.38% val_score=39.0663 val_score_bestthr=62.3142 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.162, mb=0.538, no=0.995, corr=-0.388) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 62.3142
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1768 mb_mean=0.5373 norm_overlap=0.9955 corr_cb=-0.2791 topkJ=0.0448
[TRAIN][ep=017] loss=0.7415 acc=68.05%
[TRAIN][ep=017] mask_avg: mc_mean=0.1663 mb_mean=0.5376 norm_overlap=0.9947 corr_cb=-0.3994
[EPOCH 017/089] train: loss=0.7415 acc=68.05% | val: loss=0.6820 acc=61.45% f1=70.91% auc=62.09% val_score=53.5990 val_score_bestthr=60.7200 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.166, mb=0.538, no=0.995, corr=-0.399) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 60.7200
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1889 mb_mean=0.5362 norm_overlap=0.9970 corr_cb=-0.2861 topkJ=0.0289
[TRAIN][ep=018] loss=0.7247 acc=71.81%
[TRAIN][ep=018] mask_avg: mc_mean=0.1736 mb_mean=0.5376 norm_overlap=0.9948 corr_cb=-0.3828
[EPOCH 018/089] train: loss=0.7247 acc=71.81% | val: loss=0.6841 acc=57.83% f1=71.07% auc=62.03% val_score=51.7537 val_score_bestthr=66.4345 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.174, mb=0.538, no=0.995, corr=-0.383) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 66.4345
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1653 mb_mean=0.5388 norm_overlap=0.9934 corr_cb=-0.4624 topkJ=0.0153
[TRAIN][ep=019] loss=0.7246 acc=70.47%
[TRAIN][ep=019] mask_avg: mc_mean=0.1745 mb_mean=0.5376 norm_overlap=0.9945 corr_cb=-0.4025
[EPOCH 019/089] train: loss=0.7246 acc=70.47% | val: loss=0.7049 acc=57.83% f1=70.09% auc=60.52% val_score=41.9157 val_score_bestthr=59.9234 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.174, mb=0.538, no=0.995, corr=-0.403) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 59.9234
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1565 mb_mean=0.5373 norm_overlap=0.9934 corr_cb=-0.4583 topkJ=0.0012
[TRAIN][ep=020] loss=0.7183 acc=71.81%
[TRAIN][ep=020] mask_avg: mc_mean=0.1754 mb_mean=0.5376 norm_overlap=0.9946 corr_cb=-0.3812
[EPOCH 020/089] train: loss=0.7183 acc=71.81% | val: loss=0.6889 acc=57.83% f1=70.59% auc=63.37% val_score=52.7523 val_score_bestthr=64.6159 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.175, mb=0.538, no=0.995, corr=-0.381) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 64.6159
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2047 mb_mean=0.5381 norm_overlap=0.9951 corr_cb=-0.3469 topkJ=0.0394
[TRAIN][ep=021] loss=0.7174 acc=68.32%
[TRAIN][ep=021] mask_avg: mc_mean=0.1742 mb_mean=0.5376 norm_overlap=0.9942 corr_cb=-0.4114
[EPOCH 021/089] train: loss=0.7174 acc=68.32% | val: loss=0.7004 acc=60.24% f1=71.79% auc=63.78% val_score=54.3001 val_score_bestthr=65.1322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.174, mb=0.538, no=0.994, corr=-0.411) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1322
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1489 mb_mean=0.5376 norm_overlap=0.9934 corr_cb=-0.5120 topkJ=0.0083
[TRAIN][ep=022] loss=0.7142 acc=70.34%
[TRAIN][ep=022] mask_avg: mc_mean=0.1788 mb_mean=0.5376 norm_overlap=0.9941 corr_cb=-0.4225
[EPOCH 022/089] train: loss=0.7142 acc=70.34% | val: loss=0.7080 acc=63.86% f1=68.75% auc=61.22% val_score=44.3512 val_score_bestthr=61.2767 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.179, mb=0.538, no=0.994, corr=-0.422) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 61.2767
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1958 mb_mean=0.5360 norm_overlap=0.9946 corr_cb=-0.4219 topkJ=0.0084
[TRAIN][ep=023] loss=0.6992 acc=72.08%
[TRAIN][ep=023] mask_avg: mc_mean=0.1720 mb_mean=0.5376 norm_overlap=0.9941 corr_cb=-0.3875
[EPOCH 023/089] train: loss=0.6992 acc=72.08% | val: loss=0.7115 acc=63.86% f1=68.75% auc=61.28% val_score=49.1566 val_score_bestthr=61.2767 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.172, mb=0.538, no=0.994, corr=-0.388) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 61.2767
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1628 mb_mean=0.5388 norm_overlap=0.9936 corr_cb=-0.3501 topkJ=0.0296
[TRAIN][ep=024] loss=0.7029 acc=70.20%
[TRAIN][ep=024] mask_avg: mc_mean=0.1628 mb_mean=0.5376 norm_overlap=0.9938 corr_cb=-0.3825
[EPOCH 024/089] train: loss=0.7029 acc=70.20% | val: loss=0.6931 acc=60.24% f1=71.79% auc=64.19% val_score=55.2111 val_score_bestthr=65.1322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.163, mb=0.538, no=0.994, corr=-0.383) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1322
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1567 mb_mean=0.5377 norm_overlap=0.9904 corr_cb=-0.4552 topkJ=0.0130
[TRAIN][ep=025] loss=0.7023 acc=72.35%
[TRAIN][ep=025] mask_avg: mc_mean=0.1724 mb_mean=0.5376 norm_overlap=0.9940 corr_cb=-0.3732
[EPOCH 025/089] train: loss=0.7023 acc=72.35% | val: loss=0.8351 acc=61.45% f1=65.96% auc=60.35% val_score=41.6456 val_score_bestthr=61.1649 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.172, mb=0.538, no=0.994, corr=-0.373) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 61.1649
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1204 mb_mean=0.5373 norm_overlap=0.9930 corr_cb=-0.3545 topkJ=0.0115
[TRAIN][ep=026] loss=0.6967 acc=71.81%
[TRAIN][ep=026] mask_avg: mc_mean=0.1621 mb_mean=0.5376 norm_overlap=0.9934 corr_cb=-0.3934
[EPOCH 026/089] train: loss=0.6967 acc=71.81% | val: loss=0.6841 acc=60.24% f1=71.79% auc=63.95% val_score=58.7897 val_score_bestthr=65.1322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.162, mb=0.538, no=0.993, corr=-0.393) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1322
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1959 mb_mean=0.5358 norm_overlap=0.9977 corr_cb=-0.1802 topkJ=0.0473
[TRAIN][ep=027] loss=0.6731 acc=74.09%
[TRAIN][ep=027] mask_avg: mc_mean=0.1795 mb_mean=0.5376 norm_overlap=0.9938 corr_cb=-0.3830
[EPOCH 027/089] train: loss=0.6731 acc=74.09% | val: loss=0.7038 acc=59.04% f1=71.19% auc=63.08% val_score=57.6757 val_score_bestthr=65.1533 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.180, mb=0.538, no=0.994, corr=-0.383) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1533
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1786 mb_mean=0.5361 norm_overlap=0.9939 corr_cb=-0.3746 topkJ=0.0114
[TRAIN][ep=028] loss=0.6785 acc=73.02%
[TRAIN][ep=028] mask_avg: mc_mean=0.1604 mb_mean=0.5376 norm_overlap=0.9937 corr_cb=-0.3499
[EPOCH 028/089] train: loss=0.6785 acc=73.02% | val: loss=0.6953 acc=61.45% f1=72.41% auc=64.30% val_score=58.7897 val_score_bestthr=65.1127 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.160, mb=0.538, no=0.994, corr=-0.350) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1127
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.1737 mb_mean=0.5390 norm_overlap=0.9917 corr_cb=-0.4193 topkJ=0.0115
[TRAIN][ep=029] loss=0.6612 acc=74.23%
[TRAIN][ep=029] mask_avg: mc_mean=0.1879 mb_mean=0.5376 norm_overlap=0.9940 corr_cb=-0.3619
[EPOCH 029/089] train: loss=0.6612 acc=74.23% | val: loss=0.7168 acc=60.24% f1=71.79% auc=64.24% val_score=57.5005 val_score_bestthr=65.1322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.188, mb=0.538, no=0.994, corr=-0.362) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1322
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2439 mb_mean=0.5360 norm_overlap=0.9966 corr_cb=-0.2632 topkJ=0.0204
[TRAIN][ep=030] loss=0.6728 acc=72.62%
[TRAIN][ep=030] mask_avg: mc_mean=0.1691 mb_mean=0.5376 norm_overlap=0.9938 corr_cb=-0.3394
[EPOCH 030/089] train: loss=0.6728 acc=72.62% | val: loss=0.7970 acc=62.65% f1=65.93% auc=62.15% val_score=44.1087 val_score_bestthr=60.6077 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.169, mb=0.538, no=0.994, corr=-0.339) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 60.6077
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.1789 mb_mean=0.5363 norm_overlap=0.9967 corr_cb=-0.1769 topkJ=0.0384
[TRAIN][ep=031] loss=0.6627 acc=75.17%
[TRAIN][ep=031] mask_avg: mc_mean=0.1615 mb_mean=0.5376 norm_overlap=0.9938 corr_cb=-0.3275
[EPOCH 031/089] train: loss=0.6627 acc=75.17% | val: loss=0.7328 acc=61.45% f1=72.41% auc=66.16% val_score=62.7963 val_score_bestthr=65.1127 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.162, mb=0.538, no=0.994, corr=-0.327) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1127
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1538 mb_mean=0.5378 norm_overlap=0.9918 corr_cb=-0.5253 topkJ=0.0012
[TRAIN][ep=032] loss=0.6727 acc=73.02%
[TRAIN][ep=032] mask_avg: mc_mean=0.1670 mb_mean=0.5376 norm_overlap=0.9937 corr_cb=-0.3424
[EPOCH 032/089] train: loss=0.6727 acc=73.02% | val: loss=0.7106 acc=59.04% f1=71.19% auc=63.31% val_score=51.2154 val_score_bestthr=63.8778 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.167, mb=0.538, no=0.994, corr=-0.342) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 63.8778
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1732 mb_mean=0.5365 norm_overlap=0.9941 corr_cb=-0.3333 topkJ=0.0080
[TRAIN][ep=033] loss=0.6409 acc=76.11%
[TRAIN][ep=033] mask_avg: mc_mean=0.1829 mb_mean=0.5376 norm_overlap=0.9942 corr_cb=-0.3307
[EPOCH 033/089] train: loss=0.6409 acc=76.11% | val: loss=0.6957 acc=61.45% f1=72.41% auc=64.94% val_score=57.3625 val_score_bestthr=65.1127 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.183, mb=0.538, no=0.994, corr=-0.331) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1127
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1776 mb_mean=0.5402 norm_overlap=0.9918 corr_cb=-0.4380 topkJ=0.0040
[TRAIN][ep=034] loss=0.6294 acc=76.38%
[TRAIN][ep=034] mask_avg: mc_mean=0.1797 mb_mean=0.5376 norm_overlap=0.9943 corr_cb=-0.3119
[EPOCH 034/089] train: loss=0.6294 acc=76.38% | val: loss=0.7073 acc=61.45% f1=72.41% auc=66.10% val_score=58.1094 val_score_bestthr=65.1127 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.180, mb=0.538, no=0.994, corr=-0.312) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1127
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.1988 mb_mean=0.5383 norm_overlap=0.9938 corr_cb=-0.3868 topkJ=0.0112
[TRAIN][ep=035] loss=0.6410 acc=75.57%
[TRAIN][ep=035] mask_avg: mc_mean=0.2034 mb_mean=0.5376 norm_overlap=0.9949 corr_cb=-0.2997
[EPOCH 035/089] train: loss=0.6410 acc=75.57% | val: loss=0.6995 acc=61.45% f1=72.41% auc=66.22% val_score=54.6632 val_score_bestthr=65.1127 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.203, mb=0.538, no=0.995, corr=-0.300) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1127
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2164 mb_mean=0.5386 norm_overlap=0.9946 corr_cb=-0.2886 topkJ=0.0114
[TRAIN][ep=036] loss=0.6280 acc=76.78%
[TRAIN][ep=036] mask_avg: mc_mean=0.1639 mb_mean=0.5376 norm_overlap=0.9943 corr_cb=-0.2851
[EPOCH 036/089] train: loss=0.6280 acc=76.78% | val: loss=0.6877 acc=60.24% f1=71.79% auc=67.03% val_score=56.7469 val_score_bestthr=63.8567 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.164, mb=0.538, no=0.994, corr=-0.285) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 63.8567
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1862 mb_mean=0.5386 norm_overlap=0.9943 corr_cb=-0.3490 topkJ=0.0109
[TRAIN][ep=037] loss=0.6200 acc=76.11%
[TRAIN][ep=037] mask_avg: mc_mean=0.2140 mb_mean=0.5376 norm_overlap=0.9950 corr_cb=-0.2891
[EPOCH 037/089] train: loss=0.6200 acc=76.11% | val: loss=0.7249 acc=61.45% f1=72.41% auc=65.64% val_score=47.1655 val_score_bestthr=65.1127 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.214, mb=0.538, no=0.995, corr=-0.289) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1127
[EARLY STOP] no improvement for 30 epochs. best_epoch=7
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold3_rep1_seed1003/ckpt_best_fold_3.pt
=============== FIT DONE ===============
[BEST] epoch=7 | val_acc=59.04% | val_f1=71.67% | val_auc=60.99% | val_score=53.4244 | val_score_bestthr=67.9254
[TEST@BEST] thr_used=0.475 | acc=61.35% f1=69.23% auc=65.65% | SP_sex=14.72% EO_sex=4.05% SP_age=16.96% EO_age=18.00%
[TIME] 1.03 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold3_rep1_seed1003/summary_fold_3.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5496 mb_mean=0.5403 norm_overlap=1.0001 corr_cb=0.3519 topkJ=0.1406
[TRAIN][ep=000] loss=0.6941 acc=50.47%
[TRAIN][ep=000] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1607
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5475 mb_mean=0.5372 norm_overlap=1.0001 corr_cb=0.1760 topkJ=0.2310
[TRAIN][ep=001] loss=0.6918 acc=53.02%
[TRAIN][ep=001] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1625
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5445 mb_mean=0.5368 norm_overlap=1.0000 corr_cb=-0.0182 topkJ=0.0374
[TRAIN][ep=002] loss=0.6911 acc=52.89%
[TRAIN][ep=002] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1664
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5469 mb_mean=0.5363 norm_overlap=1.0000 corr_cb=-0.0789 topkJ=0.0102
[TRAIN][ep=003] loss=0.6880 acc=57.45%
[TRAIN][ep=003] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1676
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5430 mb_mean=0.5353 norm_overlap=1.0000 corr_cb=0.0043 topkJ=0.1063
[TRAIN][ep=004] loss=0.6863 acc=55.57%
[TRAIN][ep=004] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1536
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5519 mb_mean=0.5362 norm_overlap=1.0000 corr_cb=0.1233 topkJ=0.0542
[TRAIN][ep=005] loss=0.6841 acc=54.77%
[TRAIN][ep=005] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1638
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5510 mb_mean=0.5382 norm_overlap=1.0001 corr_cb=0.2709 topkJ=0.0754
[TRAIN][ep=006] loss=0.6814 acc=58.52%
[TRAIN][ep=006] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1403
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5482 mb_mean=0.5362 norm_overlap=1.0001 corr_cb=0.1681 topkJ=0.1178
[TRAIN][ep=007] loss=0.6765 acc=59.33%
[TRAIN][ep=007] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1610
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5467 mb_mean=0.5373 norm_overlap=1.0000 corr_cb=-0.0661 topkJ=0.0328
[TRAIN][ep=008] loss=0.6734 acc=59.73%
[TRAIN][ep=008] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1699
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5503 mb_mean=0.5383 norm_overlap=1.0002 corr_cb=0.3963 topkJ=0.1772
[TRAIN][ep=009] loss=0.6678 acc=57.85%
[TRAIN][ep=009] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1600
================= FIT START (fold=3) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5516 mb_mean=0.5395 norm_overlap=1.0000 corr_cb=0.0837 topkJ=0.0302
[TRAIN][ep=000] loss=0.6601 acc=61.34%
[TRAIN][ep=000] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1701
[EPOCH 000/089] train: loss=0.6601 acc=61.34% | val: loss=0.6887 acc=62.65% f1=68.69% auc=57.85% val_score=62.3022 val_score_bestthr=60.1879 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.170) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 60.1879
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep1_seed1003/ckpt_best_fold_3.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5481 mb_mean=0.5374 norm_overlap=1.0000 corr_cb=0.1478 topkJ=0.0522
[TRAIN][ep=001] loss=0.6562 acc=60.27%
[TRAIN][ep=001] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1569
[EPOCH 001/089] train: loss=0.6562 acc=60.27% | val: loss=0.6934 acc=61.45% f1=71.43% auc=52.15% val_score=38.1845 val_score_bestthr=63.8992 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.157) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 60.1879 -> 63.8992
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep1_seed1003/ckpt_best_fold_3.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5562 mb_mean=0.5396 norm_overlap=1.0002 corr_cb=0.3367 topkJ=0.1809
[TRAIN][ep=002] loss=0.6547 acc=60.94%
[TRAIN][ep=002] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1556
[EPOCH 002/089] train: loss=0.6547 acc=60.94% | val: loss=0.6945 acc=61.45% f1=71.43% auc=52.97% val_score=38.1845 val_score_bestthr=63.8992 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.156) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8992 -> 63.8992
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5486 mb_mean=0.5364 norm_overlap=1.0000 corr_cb=0.1156 topkJ=0.0623
[TRAIN][ep=003] loss=0.6462 acc=62.95%
[TRAIN][ep=003] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1636
[EPOCH 003/089] train: loss=0.6462 acc=62.95% | val: loss=0.6917 acc=62.65% f1=69.31% auc=59.24% val_score=58.2372 val_score_bestthr=62.3086 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.164) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8992 -> 62.3086
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5592 mb_mean=0.5394 norm_overlap=1.0001 corr_cb=0.2315 topkJ=0.1445
[TRAIN][ep=004] loss=0.6402 acc=64.83%
[TRAIN][ep=004] mask_avg: mc_mean=0.5482 mb_mean=0.5376 norm_overlap=1.0001 corr_cb=0.1579
[EPOCH 004/089] train: loss=0.6402 acc=64.83% | val: loss=0.6900 acc=59.04% f1=70.69% auc=55.93% val_score=50.9895 val_score_bestthr=61.5649 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.548, mb=0.538, no=1.000, corr=0.158) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8992 -> 61.5649
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5493 mb_mean=0.5373 norm_overlap=1.0000 corr_cb=-0.0651 topkJ=0.0040
[TRAIN][ep=005] loss=1.3721 acc=63.49%
[TRAIN][ep=005] mask_avg: mc_mean=0.4190 mb_mean=0.5376 norm_overlap=0.9992 corr_cb=-0.3867
[EPOCH 005/089] train: loss=1.3721 acc=63.49% | val: loss=0.7256 acc=57.83% f1=61.54% auc=52.44% val_score=38.7965 val_score_bestthr=56.5650 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.419, mb=0.538, no=0.999, corr=-0.387) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.8992 -> 56.5650
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.3455 mb_mean=0.5346 norm_overlap=0.9983 corr_cb=-0.4450 topkJ=0.0190
[TRAIN][ep=006] loss=1.3505 acc=62.15%
[TRAIN][ep=006] mask_avg: mc_mean=0.2657 mb_mean=0.5376 norm_overlap=0.9979 corr_cb=-0.3718
[EPOCH 006/089] train: loss=1.3505 acc=62.15% | val: loss=0.6850 acc=59.04% f1=71.19% auc=57.79% val_score=48.9790 val_score_bestthr=66.0866 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.266, mb=0.538, no=0.998, corr=-0.372) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 63.8992 -> 66.0866
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep1_seed1003/ckpt_best_fold_3.pt
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2021 mb_mean=0.5371 norm_overlap=0.9976 corr_cb=-0.4407 topkJ=0.0039
[TRAIN][ep=007] loss=1.3428 acc=63.49%
[TRAIN][ep=007] mask_avg: mc_mean=0.2133 mb_mean=0.5376 norm_overlap=0.9972 corr_cb=-0.3701
[EPOCH 007/089] train: loss=1.3428 acc=63.49% | val: loss=0.6803 acc=59.04% f1=71.67% auc=60.93% val_score=53.4244 val_score_bestthr=67.9254 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.213, mb=0.538, no=0.997, corr=-0.370) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 66.0866 -> 67.9254
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold3_rep1_seed1003/ckpt_best_fold_3.pt
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2289 mb_mean=0.5355 norm_overlap=0.9987 corr_cb=-0.1931 topkJ=0.0849
[TRAIN][ep=008] loss=1.3349 acc=64.30%
[TRAIN][ep=008] mask_avg: mc_mean=0.1925 mb_mean=0.5376 norm_overlap=0.9968 corr_cb=-0.3711
[EPOCH 008/089] train: loss=1.3349 acc=64.30% | val: loss=0.6871 acc=59.04% f1=71.19% auc=57.38% val_score=36.5182 val_score_bestthr=66.0866 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.192, mb=0.538, no=0.997, corr=-0.371) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 66.0866
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1628 mb_mean=0.5395 norm_overlap=0.9952 corr_cb=-0.4434 topkJ=0.0131
[TRAIN][ep=009] loss=1.3331 acc=64.97%
[TRAIN][ep=009] mask_avg: mc_mean=0.1780 mb_mean=0.5376 norm_overlap=0.9965 corr_cb=-0.3518
[EPOCH 009/089] train: loss=1.3331 acc=64.97% | val: loss=0.7201 acc=57.83% f1=69.57% auc=55.35% val_score=40.7066 val_score_bestthr=56.8676 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.178, mb=0.538, no=0.997, corr=-0.352) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 56.8676
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1476 mb_mean=0.5379 norm_overlap=0.9973 corr_cb=-0.3483 topkJ=0.0143
[TRAIN][ep=010] loss=1.3241 acc=65.91%
[TRAIN][ep=010] mask_avg: mc_mean=0.1799 mb_mean=0.5376 norm_overlap=0.9963 corr_cb=-0.3742
[EPOCH 010/089] train: loss=1.3241 acc=65.91% | val: loss=0.6906 acc=59.04% f1=71.19% auc=57.62% val_score=35.6917 val_score_bestthr=66.0866 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.180, mb=0.538, no=0.996, corr=-0.374) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 66.0866
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1498 mb_mean=0.5409 norm_overlap=0.9956 corr_cb=-0.3535 topkJ=0.0187
[TRAIN][ep=011] loss=1.3193 acc=67.52%
[TRAIN][ep=011] mask_avg: mc_mean=0.1722 mb_mean=0.5376 norm_overlap=0.9960 corr_cb=-0.3763
[EPOCH 011/089] train: loss=1.3193 acc=67.52% | val: loss=0.7170 acc=59.04% f1=67.31% auc=56.51% val_score=37.6974 val_score_bestthr=59.6594 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.172, mb=0.538, no=0.996, corr=-0.376) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 59.6594
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1696 mb_mean=0.5345 norm_overlap=0.9985 corr_cb=-0.2088 topkJ=0.0789
[TRAIN][ep=012] loss=1.3075 acc=68.19%
[TRAIN][ep=012] mask_avg: mc_mean=0.1643 mb_mean=0.5376 norm_overlap=0.9958 corr_cb=-0.3577
[EPOCH 012/089] train: loss=1.3075 acc=68.19% | val: loss=0.6875 acc=59.04% f1=71.67% auc=61.92% val_score=52.5844 val_score_bestthr=67.9254 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.164, mb=0.538, no=0.996, corr=-0.358) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 67.9254
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1945 mb_mean=0.5357 norm_overlap=0.9984 corr_cb=-0.2315 topkJ=0.0381
[TRAIN][ep=013] loss=1.1163 acc=67.38%
[TRAIN][ep=013] mask_avg: mc_mean=0.1532 mb_mean=0.5376 norm_overlap=0.9956 corr_cb=-0.3349
[EPOCH 013/089] train: loss=1.1163 acc=67.38% | val: loss=0.7316 acc=61.45% f1=72.41% auc=63.37% val_score=65.3145 val_score_bestthr=64.4737 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.153, mb=0.538, no=0.996, corr=-0.335) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 64.4737
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1439 mb_mean=0.5402 norm_overlap=0.9951 corr_cb=-0.3860 topkJ=0.0020
[TRAIN][ep=014] loss=0.9251 acc=67.38%
[TRAIN][ep=014] mask_avg: mc_mean=0.1624 mb_mean=0.5376 norm_overlap=0.9955 corr_cb=-0.3495
[EPOCH 014/089] train: loss=0.9251 acc=67.38% | val: loss=0.6835 acc=59.04% f1=71.67% auc=61.22% val_score=55.1065 val_score_bestthr=67.9254 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.162, mb=0.538, no=0.996, corr=-0.349) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 67.9254
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1570 mb_mean=0.5349 norm_overlap=0.9958 corr_cb=-0.3984 topkJ=0.0220
[TRAIN][ep=015] loss=0.8897 acc=67.79%
[TRAIN][ep=015] mask_avg: mc_mean=0.1564 mb_mean=0.5376 norm_overlap=0.9951 corr_cb=-0.3646
[EPOCH 015/089] train: loss=0.8897 acc=67.79% | val: loss=0.6889 acc=57.83% f1=70.59% auc=60.23% val_score=49.2398 val_score_bestthr=64.6159 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.156, mb=0.538, no=0.995, corr=-0.365) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 64.6159
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1302 mb_mean=0.5397 norm_overlap=0.9936 corr_cb=-0.4249 topkJ=0.0077
[TRAIN][ep=016] loss=0.8785 acc=68.32%
[TRAIN][ep=016] mask_avg: mc_mean=0.1614 mb_mean=0.5376 norm_overlap=0.9948 corr_cb=-0.3860
[EPOCH 016/089] train: loss=0.8785 acc=68.32% | val: loss=0.7761 acc=60.24% f1=67.33% auc=57.27% val_score=39.0663 val_score_bestthr=62.3142 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.161, mb=0.538, no=0.995, corr=-0.386) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 62.3142
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1760 mb_mean=0.5373 norm_overlap=0.9955 corr_cb=-0.2764 topkJ=0.0448
[TRAIN][ep=017] loss=0.8667 acc=68.05%
[TRAIN][ep=017] mask_avg: mc_mean=0.1651 mb_mean=0.5376 norm_overlap=0.9947 corr_cb=-0.3967
[EPOCH 017/089] train: loss=0.8667 acc=68.05% | val: loss=0.6823 acc=61.45% f1=70.91% auc=62.03% val_score=53.5990 val_score_bestthr=60.7200 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.165, mb=0.538, no=0.995, corr=-0.397) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 60.7200
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1870 mb_mean=0.5362 norm_overlap=0.9970 corr_cb=-0.2846 topkJ=0.0285
[TRAIN][ep=018] loss=0.8496 acc=71.68%
[TRAIN][ep=018] mask_avg: mc_mean=0.1728 mb_mean=0.5376 norm_overlap=0.9948 corr_cb=-0.3815
[EPOCH 018/089] train: loss=0.8496 acc=71.68% | val: loss=0.6845 acc=57.83% f1=71.07% auc=61.98% val_score=51.7537 val_score_bestthr=66.4345 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.173, mb=0.538, no=0.995, corr=-0.382) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 66.4345
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1652 mb_mean=0.5388 norm_overlap=0.9934 corr_cb=-0.4617 topkJ=0.0153
[TRAIN][ep=019] loss=0.8496 acc=70.47%
[TRAIN][ep=019] mask_avg: mc_mean=0.1744 mb_mean=0.5376 norm_overlap=0.9946 corr_cb=-0.4010
[EPOCH 019/089] train: loss=0.8496 acc=70.47% | val: loss=0.7052 acc=57.83% f1=70.09% auc=60.64% val_score=41.9157 val_score_bestthr=59.9234 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.174, mb=0.538, no=0.995, corr=-0.401) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 59.9234
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1556 mb_mean=0.5373 norm_overlap=0.9934 corr_cb=-0.4561 topkJ=0.0012
[TRAIN][ep=020] loss=0.8432 acc=71.68%
[TRAIN][ep=020] mask_avg: mc_mean=0.1750 mb_mean=0.5376 norm_overlap=0.9946 corr_cb=-0.3799
[EPOCH 020/089] train: loss=0.8432 acc=71.68% | val: loss=0.6891 acc=57.83% f1=70.59% auc=63.37% val_score=52.7523 val_score_bestthr=64.6159 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.175, mb=0.538, no=0.995, corr=-0.380) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 64.6159
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2043 mb_mean=0.5381 norm_overlap=0.9951 corr_cb=-0.3467 topkJ=0.0394
[TRAIN][ep=021] loss=0.8421 acc=68.32%
[TRAIN][ep=021] mask_avg: mc_mean=0.1744 mb_mean=0.5376 norm_overlap=0.9942 corr_cb=-0.4106
[EPOCH 021/089] train: loss=0.8421 acc=68.32% | val: loss=0.7012 acc=59.04% f1=71.19% auc=63.78% val_score=54.2848 val_score_bestthr=65.1533 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.174, mb=0.538, no=0.994, corr=-0.411) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1533
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.1489 mb_mean=0.5376 norm_overlap=0.9934 corr_cb=-0.5112 topkJ=0.0083
[TRAIN][ep=022] loss=0.8392 acc=70.74%
[TRAIN][ep=022] mask_avg: mc_mean=0.1782 mb_mean=0.5376 norm_overlap=0.9941 corr_cb=-0.4214
[EPOCH 022/089] train: loss=0.8392 acc=70.74% | val: loss=0.7083 acc=63.86% f1=68.75% auc=61.16% val_score=44.3512 val_score_bestthr=61.2767 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.178, mb=0.538, no=0.994, corr=-0.421) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 61.2767
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1948 mb_mean=0.5360 norm_overlap=0.9947 corr_cb=-0.4206 topkJ=0.0084
[TRAIN][ep=023] loss=0.8240 acc=72.08%
[TRAIN][ep=023] mask_avg: mc_mean=0.1705 mb_mean=0.5376 norm_overlap=0.9942 corr_cb=-0.3852
[EPOCH 023/089] train: loss=0.8240 acc=72.08% | val: loss=0.7119 acc=63.86% f1=68.75% auc=61.28% val_score=49.1566 val_score_bestthr=61.2767 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.170, mb=0.538, no=0.994, corr=-0.385) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 61.2767
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1623 mb_mean=0.5388 norm_overlap=0.9936 corr_cb=-0.3483 topkJ=0.0296
[TRAIN][ep=024] loss=0.8275 acc=70.20%
[TRAIN][ep=024] mask_avg: mc_mean=0.1619 mb_mean=0.5376 norm_overlap=0.9938 corr_cb=-0.3820
[EPOCH 024/089] train: loss=0.8275 acc=70.20% | val: loss=0.6938 acc=60.24% f1=71.79% auc=64.13% val_score=55.2111 val_score_bestthr=65.1322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.162, mb=0.538, no=0.994, corr=-0.382) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1322
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1569 mb_mean=0.5377 norm_overlap=0.9904 corr_cb=-0.4564 topkJ=0.0130
[TRAIN][ep=025] loss=0.8269 acc=72.35%
[TRAIN][ep=025] mask_avg: mc_mean=0.1717 mb_mean=0.5376 norm_overlap=0.9940 corr_cb=-0.3726
[EPOCH 025/089] train: loss=0.8269 acc=72.35% | val: loss=0.8377 acc=61.45% f1=65.96% auc=60.29% val_score=41.6456 val_score_bestthr=61.1649 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.172, mb=0.538, no=0.994, corr=-0.373) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 61.1649
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1211 mb_mean=0.5373 norm_overlap=0.9931 corr_cb=-0.3546 topkJ=0.0131
[TRAIN][ep=026] loss=0.8212 acc=71.81%
[TRAIN][ep=026] mask_avg: mc_mean=0.1619 mb_mean=0.5376 norm_overlap=0.9934 corr_cb=-0.3942
[EPOCH 026/089] train: loss=0.8212 acc=71.81% | val: loss=0.6847 acc=60.24% f1=71.79% auc=63.95% val_score=58.7897 val_score_bestthr=65.1322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.162, mb=0.538, no=0.993, corr=-0.394) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1322
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1946 mb_mean=0.5358 norm_overlap=0.9978 corr_cb=-0.1787 topkJ=0.0477
[TRAIN][ep=027] loss=0.7974 acc=74.23%
[TRAIN][ep=027] mask_avg: mc_mean=0.1780 mb_mean=0.5376 norm_overlap=0.9938 corr_cb=-0.3828
[EPOCH 027/089] train: loss=0.7974 acc=74.23% | val: loss=0.7044 acc=59.04% f1=71.19% auc=63.02% val_score=61.4564 val_score_bestthr=65.1533 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.178, mb=0.538, no=0.994, corr=-0.383) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1533
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1789 mb_mean=0.5361 norm_overlap=0.9939 corr_cb=-0.3762 topkJ=0.0107
[TRAIN][ep=028] loss=0.8030 acc=72.75%
[TRAIN][ep=028] mask_avg: mc_mean=0.1605 mb_mean=0.5376 norm_overlap=0.9937 corr_cb=-0.3506
[EPOCH 028/089] train: loss=0.8030 acc=72.75% | val: loss=0.6957 acc=61.45% f1=72.41% auc=64.01% val_score=59.9061 val_score_bestthr=65.1127 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.160, mb=0.538, no=0.994, corr=-0.351) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1127
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.1728 mb_mean=0.5390 norm_overlap=0.9917 corr_cb=-0.4195 topkJ=0.0115
[TRAIN][ep=029] loss=0.7854 acc=73.83%
[TRAIN][ep=029] mask_avg: mc_mean=0.1871 mb_mean=0.5376 norm_overlap=0.9940 corr_cb=-0.3627
[EPOCH 029/089] train: loss=0.7854 acc=73.83% | val: loss=0.7167 acc=60.24% f1=71.79% auc=64.19% val_score=57.5005 val_score_bestthr=65.1322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.187, mb=0.538, no=0.994, corr=-0.363) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1322
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2422 mb_mean=0.5360 norm_overlap=0.9966 corr_cb=-0.2656 topkJ=0.0204
[TRAIN][ep=030] loss=0.7966 acc=72.62%
[TRAIN][ep=030] mask_avg: mc_mean=0.1686 mb_mean=0.5376 norm_overlap=0.9938 corr_cb=-0.3404
[EPOCH 030/089] train: loss=0.7966 acc=72.62% | val: loss=0.7983 acc=62.65% f1=65.93% auc=62.21% val_score=44.1087 val_score_bestthr=60.6077 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.169, mb=0.538, no=0.994, corr=-0.340) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 60.6077
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.1803 mb_mean=0.5363 norm_overlap=0.9967 corr_cb=-0.1785 topkJ=0.0379
[TRAIN][ep=031] loss=0.7869 acc=75.17%
[TRAIN][ep=031] mask_avg: mc_mean=0.1615 mb_mean=0.5376 norm_overlap=0.9938 corr_cb=-0.3285
[EPOCH 031/089] train: loss=0.7869 acc=75.17% | val: loss=0.7336 acc=61.45% f1=72.41% auc=66.16% val_score=62.7963 val_score_bestthr=65.1127 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.161, mb=0.538, no=0.994, corr=-0.329) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1127
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1525 mb_mean=0.5378 norm_overlap=0.9918 corr_cb=-0.5251 topkJ=0.0012
[TRAIN][ep=032] loss=0.7968 acc=73.15%
[TRAIN][ep=032] mask_avg: mc_mean=0.1667 mb_mean=0.5376 norm_overlap=0.9937 corr_cb=-0.3439
[EPOCH 032/089] train: loss=0.7968 acc=73.15% | val: loss=0.7106 acc=59.04% f1=71.19% auc=63.37% val_score=51.2154 val_score_bestthr=63.8778 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.167, mb=0.538, no=0.994, corr=-0.344) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 63.8778
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1725 mb_mean=0.5365 norm_overlap=0.9941 corr_cb=-0.3357 topkJ=0.0084
[TRAIN][ep=033] loss=0.7646 acc=75.97%
[TRAIN][ep=033] mask_avg: mc_mean=0.1826 mb_mean=0.5376 norm_overlap=0.9942 corr_cb=-0.3326
[EPOCH 033/089] train: loss=0.7646 acc=75.97% | val: loss=0.6958 acc=61.45% f1=72.41% auc=64.88% val_score=57.3625 val_score_bestthr=65.1127 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.183, mb=0.538, no=0.994, corr=-0.333) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1127
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.1790 mb_mean=0.5402 norm_overlap=0.9918 corr_cb=-0.4408 topkJ=0.0040
[TRAIN][ep=034] loss=0.7527 acc=76.64%
[TRAIN][ep=034] mask_avg: mc_mean=0.1803 mb_mean=0.5376 norm_overlap=0.9943 corr_cb=-0.3135
[EPOCH 034/089] train: loss=0.7527 acc=76.64% | val: loss=0.7069 acc=61.45% f1=72.41% auc=66.05% val_score=58.1094 val_score_bestthr=65.1127 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.180, mb=0.538, no=0.994, corr=-0.314) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1127
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.1975 mb_mean=0.5383 norm_overlap=0.9938 corr_cb=-0.3866 topkJ=0.0116
[TRAIN][ep=035] loss=0.7639 acc=75.57%
[TRAIN][ep=035] mask_avg: mc_mean=0.2031 mb_mean=0.5376 norm_overlap=0.9949 corr_cb=-0.3010
[EPOCH 035/089] train: loss=0.7639 acc=75.57% | val: loss=0.6992 acc=61.45% f1=72.41% auc=66.28% val_score=54.6632 val_score_bestthr=65.1127 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.203, mb=0.538, no=0.995, corr=-0.301) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1127
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2160 mb_mean=0.5386 norm_overlap=0.9946 corr_cb=-0.2896 topkJ=0.0114
[TRAIN][ep=036] loss=0.7508 acc=76.64%
[TRAIN][ep=036] mask_avg: mc_mean=0.1637 mb_mean=0.5376 norm_overlap=0.9942 corr_cb=-0.2865
[EPOCH 036/089] train: loss=0.7508 acc=76.64% | val: loss=0.6873 acc=60.24% f1=71.79% auc=66.98% val_score=56.7469 val_score_bestthr=63.8567 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.164, mb=0.538, no=0.994, corr=-0.286) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 63.8567
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1856 mb_mean=0.5386 norm_overlap=0.9943 corr_cb=-0.3486 topkJ=0.0113
[TRAIN][ep=037] loss=0.7424 acc=76.11%
[TRAIN][ep=037] mask_avg: mc_mean=0.2139 mb_mean=0.5376 norm_overlap=0.9950 corr_cb=-0.2903
[EPOCH 037/089] train: loss=0.7424 acc=76.11% | val: loss=0.7250 acc=61.45% f1=72.41% auc=65.76% val_score=49.6152 val_score_bestthr=65.1127 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.214, mb=0.538, no=0.995, corr=-0.290) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.9254 -> 65.1127
[EARLY STOP] no improvement for 30 epochs. best_epoch=7
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold3_rep1_seed1003/ckpt_best_fold_3.pt
=============== FIT DONE ===============
[BEST] epoch=7 | val_acc=59.04% | val_f1=71.67% | val_auc=60.93% | val_score=53.4244 | val_score_bestthr=67.9254
[TEST@BEST] thr_used=0.485 | acc=61.84% f1=69.02% auc=65.84% | SP_sex=17.66% EO_sex=6.52% SP_age=15.59% EO_age=18.00%
[TIME] 1.03 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold3_rep1_seed1003/summary_fold_3.json
