[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5259 mb_mean=0.5010 norm_overlap=0.9999 corr_cb=-0.0912 topkJ=0.0676
[TRAIN][ep=000] loss=0.6930 acc=52.21%
[TRAIN][ep=000] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0996
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5274 mb_mean=0.4997 norm_overlap=0.9999 corr_cb=-0.2567 topkJ=0.0254
[TRAIN][ep=001] loss=0.6919 acc=51.68%
[TRAIN][ep=001] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0926
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5297 mb_mean=0.5053 norm_overlap=1.0000 corr_cb=0.0154 topkJ=0.0969
[TRAIN][ep=002] loss=0.6908 acc=52.08%
[TRAIN][ep=002] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0983
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5296 mb_mean=0.5000 norm_overlap=0.9999 corr_cb=-0.1407 topkJ=0.0490
[TRAIN][ep=003] loss=0.6901 acc=54.77%
[TRAIN][ep=003] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0952
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5295 mb_mean=0.4987 norm_overlap=0.9999 corr_cb=-0.1840 topkJ=0.0339
[TRAIN][ep=004] loss=0.6899 acc=52.48%
[TRAIN][ep=004] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.1002
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5288 mb_mean=0.5009 norm_overlap=0.9999 corr_cb=-0.1690 topkJ=0.0368
[TRAIN][ep=005] loss=0.6888 acc=56.11%
[TRAIN][ep=005] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0988
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5323 mb_mean=0.5018 norm_overlap=0.9999 corr_cb=-0.2431 topkJ=0.0234
[TRAIN][ep=006] loss=0.6890 acc=53.83%
[TRAIN][ep=006] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0978
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5339 mb_mean=0.5021 norm_overlap=1.0000 corr_cb=-0.0185 topkJ=0.0321
[TRAIN][ep=007] loss=0.6873 acc=58.79%
[TRAIN][ep=007] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0955
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5308 mb_mean=0.5020 norm_overlap=1.0000 corr_cb=-0.0361 topkJ=0.0444
[TRAIN][ep=008] loss=0.6857 acc=52.75%
[TRAIN][ep=008] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0938
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5248 mb_mean=0.5048 norm_overlap=0.9999 corr_cb=-0.0945 topkJ=0.0690
[TRAIN][ep=009] loss=0.6848 acc=58.26%
[TRAIN][ep=009] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0965
================= FIT START (fold=0) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5327 mb_mean=0.5004 norm_overlap=1.0000 corr_cb=-0.0395 topkJ=0.0304
[TRAIN][ep=000] loss=0.6835 acc=58.93%
[TRAIN][ep=000] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0992
[EPOCH 000/089] train: loss=0.6835 acc=58.93% | val: loss=0.6834 acc=60.24% f1=69.16% auc=63.55% val_score=55.1499 val_score_bestthr=62.6844 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.099) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 62.6844
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5321 mb_mean=0.5010 norm_overlap=0.9998 corr_cb=-0.3401 topkJ=0.0082
[TRAIN][ep=001] loss=0.6819 acc=58.12%
[TRAIN][ep=001] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0976
[EPOCH 001/089] train: loss=0.6819 acc=58.12% | val: loss=0.6837 acc=59.04% f1=66.67% auc=61.57% val_score=55.9345 val_score_bestthr=59.4899 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.098) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6844 -> 59.4899
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5308 mb_mean=0.5031 norm_overlap=1.0000 corr_cb=-0.0851 topkJ=0.0316
[TRAIN][ep=002] loss=0.6800 acc=58.52%
[TRAIN][ep=002] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0965
[EPOCH 002/089] train: loss=0.6800 acc=58.52% | val: loss=0.6839 acc=57.83% f1=66.02% auc=61.51% val_score=45.8371 val_score_bestthr=58.3909 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.097) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6844 -> 58.3909
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5303 mb_mean=0.5028 norm_overlap=1.0000 corr_cb=0.0572 topkJ=0.0336
[TRAIN][ep=003] loss=0.6781 acc=60.27%
[TRAIN][ep=003] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0987
[EPOCH 003/089] train: loss=0.6781 acc=60.27% | val: loss=0.6799 acc=62.65% f1=70.48% auc=62.97% val_score=56.7108 val_score_bestthr=65.3967 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.099) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 62.6844 -> 65.3967
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5315 mb_mean=0.5048 norm_overlap=1.0000 corr_cb=-0.0454 topkJ=0.0668
[TRAIN][ep=004] loss=0.6769 acc=58.93%
[TRAIN][ep=004] mask_avg: mc_mean=0.5292 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0985
[EPOCH 004/089] train: loss=0.6769 acc=58.93% | val: loss=0.6802 acc=60.24% f1=67.96% auc=62.44% val_score=48.8967 val_score_bestthr=62.1171 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.099) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 65.3967 -> 62.1171
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5300 mb_mean=0.5015 norm_overlap=0.9999 corr_cb=-0.2288 topkJ=0.0177
[TRAIN][ep=005] loss=1.2765 acc=62.68%
[TRAIN][ep=005] mask_avg: mc_mean=0.4029 mb_mean=0.5023 norm_overlap=1.0005 corr_cb=0.1804
[EPOCH 005/089] train: loss=1.2765 acc=62.68% | val: loss=0.6785 acc=61.45% f1=69.23% auc=64.94% val_score=41.7760 val_score_bestthr=63.5244 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.403, mb=0.502, no=1.001, corr=0.180) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.3967 -> 63.5244
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.3108 mb_mean=0.5013 norm_overlap=1.0017 corr_cb=0.3748 topkJ=0.1226
[TRAIN][ep=006] loss=1.2574 acc=64.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.2762 mb_mean=0.5023 norm_overlap=1.0012 corr_cb=0.1948
[EPOCH 006/089] train: loss=1.2574 acc=64.70% | val: loss=0.6739 acc=62.65% f1=69.31% auc=66.22% val_score=62.4236 val_score_bestthr=64.9727 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.276, mb=0.502, no=1.001, corr=0.195) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.3967 -> 64.9727
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2509 mb_mean=0.5027 norm_overlap=1.0018 corr_cb=0.2386 topkJ=0.0780
[TRAIN][ep=007] loss=1.2538 acc=59.73%
[TRAIN][ep=007] mask_avg: mc_mean=0.2437 mb_mean=0.5023 norm_overlap=1.0013 corr_cb=0.1699
[EPOCH 007/089] train: loss=1.2538 acc=59.73% | val: loss=0.6730 acc=62.65% f1=69.31% auc=66.28% val_score=56.9790 val_score_bestthr=64.9727 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.244, mb=0.502, no=1.001, corr=0.170) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.3967 -> 64.9727
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2388 mb_mean=0.5013 norm_overlap=1.0007 corr_cb=0.0941 topkJ=0.0742
[TRAIN][ep=008] loss=1.2495 acc=63.22%
[TRAIN][ep=008] mask_avg: mc_mean=0.2354 mb_mean=0.5023 norm_overlap=1.0011 corr_cb=0.1438
[EPOCH 008/089] train: loss=1.2495 acc=63.22% | val: loss=0.6726 acc=62.65% f1=69.31% auc=65.70% val_score=41.8560 val_score_bestthr=64.9727 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.235, mb=0.502, no=1.001, corr=0.144) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.3967 -> 64.9727
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2392 mb_mean=0.5024 norm_overlap=1.0007 corr_cb=0.0822 topkJ=0.0837
[TRAIN][ep=009] loss=1.0088 acc=61.61%
[TRAIN][ep=009] mask_avg: mc_mean=0.2245 mb_mean=0.5023 norm_overlap=1.0010 corr_cb=0.1222
[EPOCH 009/089] train: loss=1.0088 acc=61.61% | val: loss=0.6682 acc=61.45% f1=67.35% auc=65.99% val_score=61.2844 val_score_bestthr=61.2844 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.225, mb=0.502, no=1.001, corr=0.122) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.3967 -> 61.2844
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.2247 mb_mean=0.5010 norm_overlap=1.0014 corr_cb=0.1780 topkJ=0.0781
[TRAIN][ep=010] loss=0.7657 acc=62.28%
[TRAIN][ep=010] mask_avg: mc_mean=0.2248 mb_mean=0.5023 norm_overlap=1.0008 corr_cb=0.0903
[EPOCH 010/089] train: loss=0.7657 acc=62.28% | val: loss=0.6717 acc=61.45% f1=68.63% auc=65.06% val_score=52.4026 val_score_bestthr=63.8688 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.225, mb=0.502, no=1.001, corr=0.090) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.3967 -> 63.8688
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.2165 mb_mean=0.5027 norm_overlap=0.9986 corr_cb=-0.1661 topkJ=0.0700
[TRAIN][ep=011] loss=0.7070 acc=60.81%
[TRAIN][ep=011] mask_avg: mc_mean=0.2206 mb_mean=0.5023 norm_overlap=1.0006 corr_cb=0.0606
[EPOCH 011/089] train: loss=0.7070 acc=60.81% | val: loss=0.6719 acc=61.45% f1=69.81% auc=64.77% val_score=40.8093 val_score_bestthr=64.2951 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.221, mb=0.502, no=1.001, corr=0.061) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.3967 -> 64.2951
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.2196 mb_mean=0.5005 norm_overlap=1.0001 corr_cb=0.0064 topkJ=0.1250
[TRAIN][ep=012] loss=0.6858 acc=64.30%
[TRAIN][ep=012] mask_avg: mc_mean=0.2147 mb_mean=0.5023 norm_overlap=1.0004 corr_cb=0.0363
[EPOCH 012/089] train: loss=0.6858 acc=64.30% | val: loss=0.7139 acc=60.24% f1=67.33% auc=60.41% val_score=44.4627 val_score_bestthr=60.2727 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.215, mb=0.502, no=1.000, corr=0.036) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.3967 -> 60.2727
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.2273 mb_mean=0.5050 norm_overlap=0.9997 corr_cb=-0.0323 topkJ=0.0786
[TRAIN][ep=013] loss=0.6965 acc=61.07%
[TRAIN][ep=013] mask_avg: mc_mean=0.2095 mb_mean=0.5023 norm_overlap=1.0001 corr_cb=0.0106
[EPOCH 013/089] train: loss=0.6965 acc=61.07% | val: loss=0.6603 acc=61.45% f1=68.63% auc=65.87% val_score=45.0796 val_score_bestthr=62.6515 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.210, mb=0.502, no=1.000, corr=0.011) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.3967 -> 62.6515
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1819 mb_mean=0.4973 norm_overlap=1.0007 corr_cb=0.0671 topkJ=0.0735
[TRAIN][ep=014] loss=0.6831 acc=65.23%
[TRAIN][ep=014] mask_avg: mc_mean=0.2030 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0089
[EPOCH 014/089] train: loss=0.6831 acc=65.23% | val: loss=0.6563 acc=65.06% f1=70.71% auc=65.76% val_score=50.9225 val_score_bestthr=62.4692 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.203, mb=0.502, no=1.000, corr=-0.009) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.3967 -> 62.4692
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1930 mb_mean=0.5022 norm_overlap=1.0001 corr_cb=0.0091 topkJ=0.0668
[TRAIN][ep=015] loss=0.6837 acc=65.10%
[TRAIN][ep=015] mask_avg: mc_mean=0.2015 mb_mean=0.5023 norm_overlap=0.9997 corr_cb=-0.0281
[EPOCH 015/089] train: loss=0.6837 acc=65.10% | val: loss=0.6612 acc=62.65% f1=69.31% auc=65.64% val_score=40.3513 val_score_bestthr=60.2553 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.201, mb=0.502, no=1.000, corr=-0.028) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.3967 -> 60.2553
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1872 mb_mean=0.5002 norm_overlap=1.0014 corr_cb=0.1118 topkJ=0.0834
[TRAIN][ep=016] loss=0.6737 acc=66.04%
[TRAIN][ep=016] mask_avg: mc_mean=0.1996 mb_mean=0.5023 norm_overlap=0.9995 corr_cb=-0.0373
[EPOCH 016/089] train: loss=0.6737 acc=66.04% | val: loss=0.6529 acc=57.83% f1=71.07% auc=66.51% val_score=41.1682 val_score_bestthr=65.0432 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.200, mb=0.502, no=0.999, corr=-0.037) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.3967 -> 65.0432
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.2082 mb_mean=0.5033 norm_overlap=0.9986 corr_cb=-0.0903 topkJ=0.0370
[TRAIN][ep=017] loss=0.6706 acc=66.85%
[TRAIN][ep=017] mask_avg: mc_mean=0.1923 mb_mean=0.5023 norm_overlap=0.9993 corr_cb=-0.0425
[EPOCH 017/089] train: loss=0.6706 acc=66.85% | val: loss=0.6485 acc=62.65% f1=72.57% auc=68.72% val_score=60.4497 val_score_bestthr=66.6326 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.192, mb=0.502, no=0.999, corr=-0.043) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 65.3967 -> 66.6326
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.2129 mb_mean=0.5025 norm_overlap=0.9997 corr_cb=-0.0211 topkJ=0.0744
[TRAIN][ep=018] loss=0.7627 acc=68.05%
[TRAIN][ep=018] mask_avg: mc_mean=0.1915 mb_mean=0.5023 norm_overlap=0.9992 corr_cb=-0.0524
[EPOCH 018/089] train: loss=0.7627 acc=68.05% | val: loss=0.6450 acc=61.45% f1=71.93% auc=68.55% val_score=61.3612 val_score_bestthr=64.5497 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.192, mb=0.502, no=0.999, corr=-0.052) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6326 -> 64.5497
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1547 mb_mean=0.5022 norm_overlap=0.9987 corr_cb=-0.0820 topkJ=0.0880
[TRAIN][ep=019] loss=0.8576 acc=66.85%
[TRAIN][ep=019] mask_avg: mc_mean=0.1886 mb_mean=0.5023 norm_overlap=0.9989 corr_cb=-0.0653
[EPOCH 019/089] train: loss=0.8576 acc=66.85% | val: loss=0.6447 acc=61.45% f1=70.91% auc=68.14% val_score=39.7620 val_score_bestthr=60.2805 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.189, mb=0.502, no=0.999, corr=-0.065) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6326 -> 60.2805
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1864 mb_mean=0.5020 norm_overlap=1.0006 corr_cb=0.0283 topkJ=0.1063
[TRAIN][ep=020] loss=0.9508 acc=66.17%
[TRAIN][ep=020] mask_avg: mc_mean=0.1808 mb_mean=0.5023 norm_overlap=0.9988 corr_cb=-0.0645
[EPOCH 020/089] train: loss=0.9508 acc=66.17% | val: loss=0.6386 acc=61.45% f1=71.43% auc=68.84% val_score=34.8957 val_score_bestthr=62.9031 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.181, mb=0.502, no=0.999, corr=-0.065) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6326 -> 62.9031
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2214 mb_mean=0.5058 norm_overlap=0.9964 corr_cb=-0.2156 topkJ=0.0382
[TRAIN][ep=021] loss=1.0388 acc=67.52%
[TRAIN][ep=021] mask_avg: mc_mean=0.1845 mb_mean=0.5023 norm_overlap=0.9986 corr_cb=-0.0766
[EPOCH 021/089] train: loss=1.0388 acc=67.52% | val: loss=0.6401 acc=59.04% f1=70.18% auc=69.36% val_score=42.4982 val_score_bestthr=61.4867 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.184, mb=0.502, no=0.999, corr=-0.077) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6326 -> 61.4867
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2192 mb_mean=0.4996 norm_overlap=0.9998 corr_cb=-0.0086 topkJ=0.0434
[TRAIN][ep=022] loss=1.1229 acc=69.66%
[TRAIN][ep=022] mask_avg: mc_mean=0.1898 mb_mean=0.5023 norm_overlap=0.9984 corr_cb=-0.0827
[EPOCH 022/089] train: loss=1.1229 acc=69.66% | val: loss=0.6716 acc=61.45% f1=67.35% auc=67.33% val_score=47.7340 val_score_bestthr=56.7336 | dyn(w_pfs=0.100, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.190, mb=0.502, no=0.998, corr=-0.083) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6326 -> 56.7336
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1565 mb_mean=0.5023 norm_overlap=0.9996 corr_cb=-0.0177 topkJ=0.0481
[TRAIN][ep=023] loss=0.8798 acc=69.53%
[TRAIN][ep=023] mask_avg: mc_mean=0.1939 mb_mean=0.5023 norm_overlap=0.9983 corr_cb=-0.0903
[EPOCH 023/089] train: loss=0.8798 acc=69.53% | val: loss=0.6429 acc=61.45% f1=70.37% auc=69.36% val_score=51.8387 val_score_bestthr=60.2149 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.194, mb=0.502, no=0.998, corr=-0.090) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6326 -> 60.2149
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1691 mb_mean=0.5016 norm_overlap=0.9985 corr_cb=-0.0695 topkJ=0.0610
[TRAIN][ep=024] loss=0.6425 acc=70.87%
[TRAIN][ep=024] mask_avg: mc_mean=0.1952 mb_mean=0.5023 norm_overlap=0.9983 corr_cb=-0.0849
[EPOCH 024/089] train: loss=0.6425 acc=70.87% | val: loss=0.6273 acc=61.45% f1=71.43% auc=70.70% val_score=42.0383 val_score_bestthr=61.7002 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.195, mb=0.502, no=0.998, corr=-0.085) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6326 -> 61.7002
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1733 mb_mean=0.4998 norm_overlap=0.9983 corr_cb=-0.0674 topkJ=0.0252
[TRAIN][ep=025] loss=0.6318 acc=69.13%
[TRAIN][ep=025] mask_avg: mc_mean=0.2021 mb_mean=0.5023 norm_overlap=0.9982 corr_cb=-0.0924
[EPOCH 025/089] train: loss=0.6318 acc=69.13% | val: loss=0.6277 acc=61.45% f1=71.43% auc=70.52% val_score=42.0383 val_score_bestthr=61.7002 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.202, mb=0.502, no=0.998, corr=-0.092) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6326 -> 61.7002
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1929 mb_mean=0.5001 norm_overlap=0.9967 corr_cb=-0.1517 topkJ=0.0341
[TRAIN][ep=026] loss=0.6283 acc=71.14%
[TRAIN][ep=026] mask_avg: mc_mean=0.1984 mb_mean=0.5023 norm_overlap=0.9981 corr_cb=-0.0907
[EPOCH 026/089] train: loss=0.6283 acc=71.14% | val: loss=0.6472 acc=62.65% f1=69.31% auc=69.48% val_score=40.5156 val_score_bestthr=60.2553 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.198, mb=0.502, no=0.998, corr=-0.091) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6326 -> 60.2553
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1947 mb_mean=0.5032 norm_overlap=0.9979 corr_cb=-0.1131 topkJ=0.0581
[TRAIN][ep=027] loss=0.6331 acc=69.40%
[TRAIN][ep=027] mask_avg: mc_mean=0.2105 mb_mean=0.5023 norm_overlap=0.9979 corr_cb=-0.1056
[EPOCH 027/089] train: loss=0.6331 acc=69.40% | val: loss=0.6139 acc=63.86% f1=73.21% auc=72.85% val_score=50.4711 val_score_bestthr=66.5288 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.210, mb=0.502, no=0.998, corr=-0.106) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6326 -> 66.5288
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2045 mb_mean=0.5016 norm_overlap=1.0000 corr_cb=-0.0007 topkJ=0.0446
[TRAIN][ep=028] loss=0.6207 acc=69.80%
[TRAIN][ep=028] mask_avg: mc_mean=0.2085 mb_mean=0.5023 norm_overlap=0.9979 corr_cb=-0.1049
[EPOCH 028/089] train: loss=0.6207 acc=69.80% | val: loss=0.6145 acc=62.65% f1=72.57% auc=72.56% val_score=53.4481 val_score_bestthr=65.4297 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.209, mb=0.502, no=0.998, corr=-0.105) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6326 -> 65.4297
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.1919 mb_mean=0.5039 norm_overlap=0.9972 corr_cb=-0.1436 topkJ=0.0587
[TRAIN][ep=029] loss=0.6179 acc=71.54%
[TRAIN][ep=029] mask_avg: mc_mean=0.2178 mb_mean=0.5023 norm_overlap=0.9978 corr_cb=-0.1097
[EPOCH 029/089] train: loss=0.6179 acc=71.54% | val: loss=0.6090 acc=63.86% f1=73.21% auc=73.43% val_score=55.5541 val_score_bestthr=66.5288 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.218, mb=0.502, no=0.998, corr=-0.110) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6326 -> 66.5288
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2010 mb_mean=0.5015 norm_overlap=0.9978 corr_cb=-0.1228 topkJ=0.0367
[TRAIN][ep=030] loss=0.6126 acc=71.14%
[TRAIN][ep=030] mask_avg: mc_mean=0.2026 mb_mean=0.5023 norm_overlap=0.9978 corr_cb=-0.1041
[EPOCH 030/089] train: loss=0.6126 acc=71.14% | val: loss=0.6566 acc=60.24% f1=71.79% auc=70.81% val_score=45.1243 val_score_bestthr=65.0291 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.203, mb=0.502, no=0.998, corr=-0.104) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6326 -> 65.0291
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2093 mb_mean=0.5032 norm_overlap=0.9982 corr_cb=-0.0988 topkJ=0.0613
[TRAIN][ep=031] loss=0.6077 acc=71.81%
[TRAIN][ep=031] mask_avg: mc_mean=0.2208 mb_mean=0.5023 norm_overlap=0.9975 corr_cb=-0.1243
[EPOCH 031/089] train: loss=0.6077 acc=71.81% | val: loss=0.6065 acc=62.65% f1=72.57% auc=74.01% val_score=49.0359 val_score_bestthr=67.0964 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.221, mb=0.502, no=0.998, corr=-0.124) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 66.6326 -> 67.0964
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2226 mb_mean=0.5001 norm_overlap=0.9950 corr_cb=-0.2159 topkJ=0.0454
[TRAIN][ep=032] loss=0.7041 acc=71.41%
[TRAIN][ep=032] mask_avg: mc_mean=0.2046 mb_mean=0.5023 norm_overlap=0.9975 corr_cb=-0.1199
[EPOCH 032/089] train: loss=0.7041 acc=71.41% | val: loss=0.6033 acc=61.45% f1=71.43% auc=74.19% val_score=53.4481 val_score_bestthr=62.5079 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.205, mb=0.502, no=0.998, corr=-0.120) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.0964 -> 62.5079
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1955 mb_mean=0.5007 norm_overlap=0.9989 corr_cb=-0.0615 topkJ=0.0550
[TRAIN][ep=033] loss=0.7865 acc=72.48%
[TRAIN][ep=033] mask_avg: mc_mean=0.2044 mb_mean=0.5023 norm_overlap=0.9975 corr_cb=-0.1164
[EPOCH 033/089] train: loss=0.7865 acc=72.48% | val: loss=0.6382 acc=60.24% f1=71.79% auc=72.91% val_score=43.2724 val_score_bestthr=65.0291 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.204, mb=0.502, no=0.997, corr=-0.116) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.0964 -> 65.0291
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2266 mb_mean=0.5049 norm_overlap=0.9954 corr_cb=-0.2290 topkJ=0.0252
[TRAIN][ep=034] loss=0.8787 acc=74.50%
[TRAIN][ep=034] mask_avg: mc_mean=0.2130 mb_mean=0.5023 norm_overlap=0.9975 corr_cb=-0.1205
[EPOCH 034/089] train: loss=0.8787 acc=74.50% | val: loss=0.5952 acc=63.86% f1=73.21% auc=75.70% val_score=58.3941 val_score_bestthr=66.8622 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.213, mb=0.502, no=0.997, corr=-0.121) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.0964 -> 66.8622
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2500 mb_mean=0.5025 norm_overlap=0.9962 corr_cb=-0.1782 topkJ=0.0334
[TRAIN][ep=035] loss=0.9699 acc=72.35%
[TRAIN][ep=035] mask_avg: mc_mean=0.2319 mb_mean=0.5023 norm_overlap=0.9973 corr_cb=-0.1381
[EPOCH 035/089] train: loss=0.9699 acc=72.35% | val: loss=0.5924 acc=62.65% f1=72.07% auc=75.29% val_score=59.3667 val_score_bestthr=63.6063 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.232, mb=0.502, no=0.997, corr=-0.138) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.0964 -> 63.6063
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2014 mb_mean=0.5025 norm_overlap=0.9961 corr_cb=-0.1600 topkJ=0.0617
[TRAIN][ep=036] loss=1.0556 acc=73.42%
[TRAIN][ep=036] mask_avg: mc_mean=0.2157 mb_mean=0.5023 norm_overlap=0.9975 corr_cb=-0.1205
[EPOCH 036/089] train: loss=1.0556 acc=73.42% | val: loss=0.6026 acc=62.65% f1=71.56% auc=74.59% val_score=54.1241 val_score_bestthr=63.1386 | dyn(w_pfs=0.100, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.216, mb=0.502, no=0.997, corr=-0.120) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.0964 -> 63.1386
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1928 mb_mean=0.5040 norm_overlap=0.9959 corr_cb=-0.1953 topkJ=0.0584
[TRAIN][ep=037] loss=0.8171 acc=72.21%
[TRAIN][ep=037] mask_avg: mc_mean=0.2092 mb_mean=0.5023 norm_overlap=0.9976 corr_cb=-0.1104
[EPOCH 037/089] train: loss=0.8171 acc=72.21% | val: loss=0.6132 acc=62.65% f1=72.57% auc=76.51% val_score=59.0461 val_score_bestthr=64.4080 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.209, mb=0.502, no=0.998, corr=-0.110) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.0964 -> 64.4080
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2207 mb_mean=0.5023 norm_overlap=0.9941 corr_cb=-0.2550 topkJ=0.0373
[TRAIN][ep=038] loss=0.5819 acc=72.75%
[TRAIN][ep=038] mask_avg: mc_mean=0.2396 mb_mean=0.5023 norm_overlap=0.9973 corr_cb=-0.1341
[EPOCH 038/089] train: loss=0.5819 acc=72.75% | val: loss=0.5861 acc=63.86% f1=73.21% auc=76.74% val_score=57.1912 val_score_bestthr=66.8622 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.240, mb=0.502, no=0.997, corr=-0.134) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.0964 -> 66.8622
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2750 mb_mean=0.5023 norm_overlap=0.9949 corr_cb=-0.2771 topkJ=0.0261
[TRAIN][ep=039] loss=0.5796 acc=73.29%
[TRAIN][ep=039] mask_avg: mc_mean=0.2363 mb_mean=0.5023 norm_overlap=0.9974 corr_cb=-0.1289
[EPOCH 039/089] train: loss=0.5796 acc=73.29% | val: loss=0.5854 acc=62.65% f1=72.07% auc=75.76% val_score=61.8155 val_score_bestthr=63.6063 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.236, mb=0.502, no=0.997, corr=-0.129) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.0964 -> 63.6063
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.2091 mb_mean=0.5019 norm_overlap=0.9967 corr_cb=-0.1479 topkJ=0.0139
[TRAIN][ep=040] loss=0.5706 acc=75.30%
[TRAIN][ep=040] mask_avg: mc_mean=0.2209 mb_mean=0.5023 norm_overlap=0.9974 corr_cb=-0.1239
[EPOCH 040/089] train: loss=0.5706 acc=75.30% | val: loss=0.5828 acc=69.88% f1=72.53% auc=76.69% val_score=64.1745 val_score_bestthr=65.2947 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.221, mb=0.502, no=0.997, corr=-0.124) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.0964 -> 65.2947
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.2464 mb_mean=0.5002 norm_overlap=0.9972 corr_cb=-0.1578 topkJ=0.0515
[TRAIN][ep=041] loss=0.5734 acc=73.83%
[TRAIN][ep=041] mask_avg: mc_mean=0.2401 mb_mean=0.5023 norm_overlap=0.9974 corr_cb=-0.1271
[EPOCH 041/089] train: loss=0.5734 acc=73.83% | val: loss=0.5773 acc=69.88% f1=72.53% auc=76.80% val_score=60.1559 val_score_bestthr=65.2947 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.240, mb=0.502, no=0.997, corr=-0.127) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.0964 -> 65.2947
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.1982 mb_mean=0.5021 norm_overlap=0.9976 corr_cb=-0.1164 topkJ=0.0200
[TRAIN][ep=042] loss=0.5668 acc=75.03%
[TRAIN][ep=042] mask_avg: mc_mean=0.2112 mb_mean=0.5023 norm_overlap=0.9976 corr_cb=-0.1078
[EPOCH 042/089] train: loss=0.5668 acc=75.03% | val: loss=0.5979 acc=73.49% f1=71.79% auc=75.81% val_score=50.3997 val_score_bestthr=67.5100 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.211, mb=0.502, no=0.998, corr=-0.108) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 67.0964 -> 67.5100
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.3061 mb_mean=0.5025 norm_overlap=0.9956 corr_cb=-0.2394 topkJ=0.0155
[TRAIN][ep=043] loss=0.6614 acc=73.69%
[TRAIN][ep=043] mask_avg: mc_mean=0.2549 mb_mean=0.5023 norm_overlap=0.9972 corr_cb=-0.1461
[EPOCH 043/089] train: loss=0.6614 acc=73.69% | val: loss=0.5789 acc=74.70% f1=72.00% auc=76.34% val_score=63.0184 val_score_bestthr=66.1108 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.255, mb=0.502, no=0.997, corr=-0.146) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.5100 -> 66.1108
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2650 mb_mean=0.5062 norm_overlap=1.0004 corr_cb=0.0184 topkJ=0.0701
[TRAIN][ep=044] loss=0.7388 acc=75.03%
[TRAIN][ep=044] mask_avg: mc_mean=0.2357 mb_mean=0.5023 norm_overlap=0.9973 corr_cb=-0.1321
[EPOCH 044/089] train: loss=0.7388 acc=75.03% | val: loss=0.5756 acc=75.90% f1=72.97% auc=76.57% val_score=60.1559 val_score_bestthr=68.8818 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.236, mb=0.502, no=0.997, corr=-0.132) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 67.5100 -> 68.8818
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2783 mb_mean=0.5009 norm_overlap=0.9966 corr_cb=-0.1404 topkJ=0.0646
[TRAIN][ep=045] loss=0.8407 acc=74.23%
[TRAIN][ep=045] mask_avg: mc_mean=0.2309 mb_mean=0.5023 norm_overlap=0.9973 corr_cb=-0.1273
[EPOCH 045/089] train: loss=0.8407 acc=74.23% | val: loss=0.5757 acc=72.29% f1=70.89% auc=76.57% val_score=63.0184 val_score_bestthr=67.3645 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.231, mb=0.502, no=0.997, corr=-0.127) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8818 -> 67.3645
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.2270 mb_mean=0.5026 norm_overlap=0.9985 corr_cb=-0.0609 topkJ=0.0739
[TRAIN][ep=046] loss=0.9182 acc=75.30%
[TRAIN][ep=046] mask_avg: mc_mean=0.2328 mb_mean=0.5023 norm_overlap=0.9973 corr_cb=-0.1281
[EPOCH 046/089] train: loss=0.9182 acc=75.30% | val: loss=0.5780 acc=75.90% f1=72.97% auc=77.44% val_score=61.7180 val_score_bestthr=68.8818 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.233, mb=0.502, no=0.997, corr=-0.128) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8818 -> 68.8818
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.2330 mb_mean=0.5033 norm_overlap=0.9972 corr_cb=-0.1494 topkJ=0.0337
[TRAIN][ep=047] loss=1.0208 acc=74.90%
[TRAIN][ep=047] mask_avg: mc_mean=0.2170 mb_mean=0.5023 norm_overlap=0.9973 corr_cb=-0.1234
[EPOCH 047/089] train: loss=1.0208 acc=74.90% | val: loss=0.5739 acc=74.70% f1=72.73% auc=77.03% val_score=67.3645 val_score_bestthr=69.7097 | dyn(w_pfs=0.240, w_sup=0.240, w_csuf=0.200, stage2=False) | mask(mc=0.217, mb=0.502, no=0.997, corr=-0.123) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 68.8818 -> 69.7097
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.2922 mb_mean=0.5001 norm_overlap=0.9965 corr_cb=-0.1966 topkJ=0.0267
[TRAIN][ep=048] loss=1.0389 acc=75.70%
[TRAIN][ep=048] mask_avg: mc_mean=0.2602 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1515
[EPOCH 048/089] train: loss=1.0389 acc=75.70% | val: loss=0.5731 acc=74.70% f1=71.23% auc=78.55% val_score=52.9595 val_score_bestthr=69.7469 | dyn(w_pfs=0.280, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.260, mb=0.502, no=0.997, corr=-0.151) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 69.7097 -> 69.7469
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=049] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.2098 mb_mean=0.4996 norm_overlap=0.9959 corr_cb=-0.1804 topkJ=0.0485
[TRAIN][ep=049] loss=1.0637 acc=73.02%
[TRAIN][ep=049] mask_avg: mc_mean=0.2435 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1491
[EPOCH 049/089] train: loss=1.0637 acc=73.02% | val: loss=0.5720 acc=75.90% f1=73.68% auc=77.85% val_score=66.1108 val_score_bestthr=70.8552 | dyn(w_pfs=0.320, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.243, mb=0.502, no=0.997, corr=-0.149) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 69.7469 -> 70.8552
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=050] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.2431 mb_mean=0.5034 norm_overlap=0.9948 corr_cb=-0.2444 topkJ=0.0176
[TRAIN][ep=050] loss=0.5953 acc=76.64%
[TRAIN][ep=050] mask_avg: mc_mean=0.2421 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1436
[EPOCH 050/089] train: loss=0.5953 acc=76.64% | val: loss=0.5632 acc=74.70% f1=72.73% auc=77.97% val_score=67.3645 val_score_bestthr=69.7097 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.242, mb=0.502, no=0.997, corr=-0.144) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.8552 -> 69.7097
[DBG][ep=051] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.2104 mb_mean=0.5047 norm_overlap=1.0010 corr_cb=0.0494 topkJ=0.0994
[TRAIN][ep=051] loss=0.5299 acc=76.38%
[TRAIN][ep=051] mask_avg: mc_mean=0.2420 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1450
[EPOCH 051/089] train: loss=0.5299 acc=76.38% | val: loss=0.5600 acc=72.29% f1=70.89% auc=78.66% val_score=61.0694 val_score_bestthr=67.3645 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.242, mb=0.502, no=0.997, corr=-0.145) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.8552 -> 67.3645
[DBG][ep=052] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.2384 mb_mean=0.5020 norm_overlap=0.9941 corr_cb=-0.2726 topkJ=0.0365
[TRAIN][ep=052] loss=0.5288 acc=77.32%
[TRAIN][ep=052] mask_avg: mc_mean=0.2420 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1429
[EPOCH 052/089] train: loss=0.5288 acc=77.32% | val: loss=0.5624 acc=74.70% f1=72.73% auc=78.02% val_score=67.3645 val_score_bestthr=69.7097 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.242, mb=0.502, no=0.997, corr=-0.143) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.8552 -> 69.7097
[DBG][ep=053] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.2637 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1758 topkJ=0.0548
[TRAIN][ep=053] loss=0.5294 acc=77.45%
[TRAIN][ep=053] mask_avg: mc_mean=0.2420 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1461
[EPOCH 053/089] train: loss=0.5294 acc=77.45% | val: loss=0.5627 acc=74.70% f1=72.73% auc=78.02% val_score=67.3645 val_score_bestthr=69.7097 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.242, mb=0.502, no=0.997, corr=-0.146) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.8552 -> 69.7097
[DBG][ep=054] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=054] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=054] mask(step0): mc_mean=0.2562 mb_mean=0.5013 norm_overlap=0.9977 corr_cb=-0.1118 topkJ=0.0453
[TRAIN][ep=054] loss=0.5295 acc=76.38%
[TRAIN][ep=054] mask_avg: mc_mean=0.2420 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1467
[EPOCH 054/089] train: loss=0.5295 acc=76.38% | val: loss=0.5646 acc=74.70% f1=72.73% auc=78.08% val_score=69.7097 val_score_bestthr=69.7097 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.242, mb=0.502, no=0.997, corr=-0.147) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.8552 -> 69.7097
[DBG][ep=055] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=055] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=055] mask(step0): mc_mean=0.2394 mb_mean=0.5029 norm_overlap=0.9957 corr_cb=-0.2102 topkJ=0.0249
[TRAIN][ep=055] loss=0.5257 acc=77.45%
[TRAIN][ep=055] mask_avg: mc_mean=0.2421 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1429
[EPOCH 055/089] train: loss=0.5257 acc=77.45% | val: loss=0.5609 acc=74.70% f1=72.73% auc=78.84% val_score=63.4003 val_score_bestthr=69.7097 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.242, mb=0.502, no=0.997, corr=-0.143) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.8552 -> 69.7097
[DBG][ep=056] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=056] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=056] mask(step0): mc_mean=0.2126 mb_mean=0.5009 norm_overlap=0.9990 corr_cb=-0.0548 topkJ=0.0646
[TRAIN][ep=056] loss=0.5288 acc=76.51%
[TRAIN][ep=056] mask_avg: mc_mean=0.2421 mb_mean=0.5023 norm_overlap=0.9971 corr_cb=-0.1424
[EPOCH 056/089] train: loss=0.5288 acc=76.51% | val: loss=0.5641 acc=74.70% f1=72.73% auc=78.20% val_score=67.3645 val_score_bestthr=69.7097 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.242, mb=0.502, no=0.997, corr=-0.142) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.8552 -> 69.7097
[DBG][ep=057] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=057] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=057] mask(step0): mc_mean=0.2422 mb_mean=0.5026 norm_overlap=0.9985 corr_cb=-0.0760 topkJ=0.0562
[TRAIN][ep=057] loss=0.5258 acc=76.51%
[TRAIN][ep=057] mask_avg: mc_mean=0.2421 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1468
[EPOCH 057/089] train: loss=0.5258 acc=76.51% | val: loss=0.5629 acc=74.70% f1=72.73% auc=78.37% val_score=67.3645 val_score_bestthr=69.7097 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.242, mb=0.502, no=0.997, corr=-0.147) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.8552 -> 69.7097
[DBG][ep=058] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=058] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=058] mask(step0): mc_mean=0.1949 mb_mean=0.5051 norm_overlap=0.9954 corr_cb=-0.2459 topkJ=0.0382
[TRAIN][ep=058] loss=0.5257 acc=76.78%
[TRAIN][ep=058] mask_avg: mc_mean=0.2420 mb_mean=0.5023 norm_overlap=0.9971 corr_cb=-0.1404
[EPOCH 058/089] train: loss=0.5257 acc=76.78% | val: loss=0.5641 acc=74.70% f1=72.73% auc=78.31% val_score=67.3645 val_score_bestthr=69.7097 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.242, mb=0.502, no=0.997, corr=-0.140) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.8552 -> 69.7097
[DBG][ep=059] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=059] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=059] mask(step0): mc_mean=0.2701 mb_mean=0.4997 norm_overlap=0.9949 corr_cb=-0.2575 topkJ=0.0364
[TRAIN][ep=059] loss=0.5225 acc=76.91%
[TRAIN][ep=059] mask_avg: mc_mean=0.2420 mb_mean=0.5023 norm_overlap=0.9971 corr_cb=-0.1421
[EPOCH 059/089] train: loss=0.5225 acc=76.91% | val: loss=0.5625 acc=74.70% f1=72.73% auc=78.26% val_score=67.3645 val_score_bestthr=69.7097 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.242, mb=0.502, no=0.997, corr=-0.142) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.8552 -> 69.7097
[DBG][ep=060] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=060] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=060] mask(step0): mc_mean=0.2923 mb_mean=0.4999 norm_overlap=0.9960 corr_cb=-0.2348 topkJ=0.0245
[TRAIN][ep=060] loss=0.5230 acc=77.72%
[TRAIN][ep=060] mask_avg: mc_mean=0.2420 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1453
[EPOCH 060/089] train: loss=0.5230 acc=77.72% | val: loss=0.5635 acc=74.70% f1=72.73% auc=78.08% val_score=69.7097 val_score_bestthr=69.7097 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.242, mb=0.502, no=0.997, corr=-0.145) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.8552 -> 69.7097
[DBG][ep=061] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=061] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=061] mask(step0): mc_mean=0.2672 mb_mean=0.5016 norm_overlap=0.9925 corr_cb=-0.3088 topkJ=0.0290
[TRAIN][ep=061] loss=0.5224 acc=77.32%
[TRAIN][ep=061] mask_avg: mc_mean=0.2420 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1447
[EPOCH 061/089] train: loss=0.5224 acc=77.32% | val: loss=0.5632 acc=74.70% f1=72.73% auc=78.31% val_score=67.3645 val_score_bestthr=69.7097 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.242, mb=0.502, no=0.997, corr=-0.145) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.8552 -> 69.7097
[DBG][ep=062] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=062] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=062] mask(step0): mc_mean=0.2395 mb_mean=0.5002 norm_overlap=0.9964 corr_cb=-0.1954 topkJ=0.0467
[TRAIN][ep=062] loss=0.5244 acc=77.32%
[TRAIN][ep=062] mask_avg: mc_mean=0.2420 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1425
[EPOCH 062/089] train: loss=0.5244 acc=77.32% | val: loss=0.5624 acc=74.70% f1=72.73% auc=78.37% val_score=67.3645 val_score_bestthr=69.7097 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.242, mb=0.502, no=0.997, corr=-0.143) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.8552 -> 69.7097
[DBG][ep=063] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=063] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=063] mask(step0): mc_mean=0.2334 mb_mean=0.5036 norm_overlap=0.9958 corr_cb=-0.1789 topkJ=0.0248
[TRAIN][ep=063] loss=0.5235 acc=77.32%
[TRAIN][ep=063] mask_avg: mc_mean=0.2420 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1461
[EPOCH 063/089] train: loss=0.5235 acc=77.32% | val: loss=0.5627 acc=74.70% f1=72.73% auc=78.20% val_score=67.3645 val_score_bestthr=69.7097 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.242, mb=0.502, no=0.997, corr=-0.146) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.8552 -> 69.7097
[DBG][ep=064] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=064] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=064] mask(step0): mc_mean=0.2432 mb_mean=0.5016 norm_overlap=0.9961 corr_cb=-0.1733 topkJ=0.0512
[TRAIN][ep=064] loss=0.5208 acc=76.51%
[TRAIN][ep=064] mask_avg: mc_mean=0.2420 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1473
[EPOCH 064/089] train: loss=0.5208 acc=76.51% | val: loss=0.5645 acc=74.70% f1=72.73% auc=78.08% val_score=67.3645 val_score_bestthr=69.7097 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.242, mb=0.502, no=0.997, corr=-0.147) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.8552 -> 69.7097
[DBG][ep=065] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=065] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=065] mask(step0): mc_mean=0.2263 mb_mean=0.5027 norm_overlap=0.9953 corr_cb=-0.2393 topkJ=0.0453
[TRAIN][ep=065] loss=0.5220 acc=77.18%
[TRAIN][ep=065] mask_avg: mc_mean=0.2420 mb_mean=0.5023 norm_overlap=0.9971 corr_cb=-0.1419
[EPOCH 065/089] train: loss=0.5220 acc=77.18% | val: loss=0.5633 acc=74.70% f1=72.73% auc=78.31% val_score=69.7097 val_score_bestthr=69.7097 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.242, mb=0.502, no=0.997, corr=-0.142) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.8552 -> 69.7097
[DBG][ep=066] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=066] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=066] mask(step0): mc_mean=0.2066 mb_mean=0.5044 norm_overlap=0.9974 corr_cb=-0.1443 topkJ=0.0291
[TRAIN][ep=066] loss=0.5208 acc=77.45%
[TRAIN][ep=066] mask_avg: mc_mean=0.2421 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1420
[EPOCH 066/089] train: loss=0.5208 acc=77.45% | val: loss=0.5612 acc=74.70% f1=72.73% auc=78.31% val_score=65.8239 val_score_bestthr=69.7097 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.242, mb=0.502, no=0.997, corr=-0.142) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.8552 -> 69.7097
[DBG][ep=067] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=067] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=067] mask(step0): mc_mean=0.2549 mb_mean=0.4998 norm_overlap=0.9988 corr_cb=-0.0518 topkJ=0.0759
[TRAIN][ep=067] loss=0.5191 acc=78.12%
[TRAIN][ep=067] mask_avg: mc_mean=0.2420 mb_mean=0.5023 norm_overlap=0.9971 corr_cb=-0.1427
[EPOCH 067/089] train: loss=0.5191 acc=78.12% | val: loss=0.5636 acc=74.70% f1=72.73% auc=78.31% val_score=69.7097 val_score_bestthr=69.7097 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.242, mb=0.502, no=0.997, corr=-0.143) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.8552 -> 69.7097
[DBG][ep=068] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=068] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=068] mask(step0): mc_mean=0.2211 mb_mean=0.5046 norm_overlap=0.9969 corr_cb=-0.1445 topkJ=0.0453
[TRAIN][ep=068] loss=0.5176 acc=77.05%
[TRAIN][ep=068] mask_avg: mc_mean=0.2420 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1434
[EPOCH 068/089] train: loss=0.5176 acc=77.05% | val: loss=0.5599 acc=74.70% f1=72.73% auc=78.55% val_score=61.0694 val_score_bestthr=69.7097 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.242, mb=0.502, no=0.997, corr=-0.143) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.8552 -> 69.7097
[DBG][ep=069] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=069] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=069] mask(step0): mc_mean=0.2498 mb_mean=0.5008 norm_overlap=0.9958 corr_cb=-0.1993 topkJ=0.0299
[TRAIN][ep=069] loss=0.5173 acc=77.85%
[TRAIN][ep=069] mask_avg: mc_mean=0.2420 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1447
[EPOCH 069/089] train: loss=0.5173 acc=77.85% | val: loss=0.5744 acc=74.70% f1=72.73% auc=77.67% val_score=66.1108 val_score_bestthr=69.7097 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.242, mb=0.502, no=0.997, corr=-0.145) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.8552 -> 69.7097
[DBG][ep=070] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=070] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=070] mask(step0): mc_mean=0.2386 mb_mean=0.5018 norm_overlap=0.9979 corr_cb=-0.0931 topkJ=0.0659
[TRAIN][ep=070] loss=0.5182 acc=76.78%
[TRAIN][ep=070] mask_avg: mc_mean=0.2420 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1448
[EPOCH 070/089] train: loss=0.5182 acc=76.78% | val: loss=0.5600 acc=74.70% f1=72.73% auc=78.43% val_score=61.2777 val_score_bestthr=69.7097 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.242, mb=0.502, no=0.997, corr=-0.145) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.8552 -> 69.7097
[DBG][ep=071] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=071] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=071] mask(step0): mc_mean=0.2257 mb_mean=0.5030 norm_overlap=0.9959 corr_cb=-0.2141 topkJ=0.0350
[TRAIN][ep=071] loss=0.5212 acc=77.99%
[TRAIN][ep=071] mask_avg: mc_mean=0.2420 mb_mean=0.5023 norm_overlap=0.9971 corr_cb=-0.1405
[EPOCH 071/089] train: loss=0.5212 acc=77.99% | val: loss=0.5599 acc=74.70% f1=72.73% auc=78.31% val_score=65.8239 val_score_bestthr=69.7097 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.242, mb=0.502, no=0.997, corr=-0.141) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.8552 -> 69.7097
[DBG][ep=072] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=072] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=072] mask(step0): mc_mean=0.2553 mb_mean=0.5026 norm_overlap=0.9958 corr_cb=-0.2396 topkJ=0.0252
[TRAIN][ep=072] loss=0.5177 acc=77.32%
[TRAIN][ep=072] mask_avg: mc_mean=0.2420 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1424
[EPOCH 072/089] train: loss=0.5177 acc=77.32% | val: loss=0.5598 acc=74.70% f1=72.73% auc=78.31% val_score=67.0745 val_score_bestthr=69.7097 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.242, mb=0.502, no=0.997, corr=-0.142) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.8552 -> 69.7097
[DBG][ep=073] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=073] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=073] mask(step0): mc_mean=0.2039 mb_mean=0.5011 norm_overlap=0.9989 corr_cb=-0.0583 topkJ=0.0718
[TRAIN][ep=073] loss=0.5172 acc=76.51%
[TRAIN][ep=073] mask_avg: mc_mean=0.2421 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1465
[EPOCH 073/089] train: loss=0.5172 acc=76.51% | val: loss=0.5606 acc=74.70% f1=72.73% auc=78.20% val_score=68.5819 val_score_bestthr=69.7097 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.242, mb=0.502, no=0.997, corr=-0.146) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.8552 -> 69.7097
[DBG][ep=074] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=074] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=074] mask(step0): mc_mean=0.2412 mb_mean=0.5028 norm_overlap=0.9963 corr_cb=-0.1990 topkJ=0.0292
[TRAIN][ep=074] loss=0.5165 acc=77.85%
[TRAIN][ep=074] mask_avg: mc_mean=0.2421 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1441
[EPOCH 074/089] train: loss=0.5165 acc=77.85% | val: loss=0.5587 acc=74.70% f1=72.73% auc=78.60% val_score=65.7487 val_score_bestthr=69.7097 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.242, mb=0.502, no=0.997, corr=-0.144) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.8552 -> 69.7097
[DBG][ep=075] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=075] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=075] mask(step0): mc_mean=0.2519 mb_mean=0.5013 norm_overlap=0.9947 corr_cb=-0.2362 topkJ=0.0323
[TRAIN][ep=075] loss=0.5179 acc=77.18%
[TRAIN][ep=075] mask_avg: mc_mean=0.2420 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1436
[EPOCH 075/089] train: loss=0.5179 acc=77.18% | val: loss=0.5606 acc=74.70% f1=72.73% auc=78.20% val_score=68.5819 val_score_bestthr=69.7097 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.242, mb=0.502, no=0.997, corr=-0.144) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.8552 -> 69.7097
[DBG][ep=076] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=076] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=076] mask(step0): mc_mean=0.2081 mb_mean=0.5030 norm_overlap=0.9992 corr_cb=-0.0372 topkJ=0.0552
[TRAIN][ep=076] loss=0.5152 acc=77.58%
[TRAIN][ep=076] mask_avg: mc_mean=0.2421 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1425
[EPOCH 076/089] train: loss=0.5152 acc=77.58% | val: loss=0.5587 acc=74.70% f1=72.73% auc=78.49% val_score=69.1072 val_score_bestthr=69.7097 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.242, mb=0.502, no=0.997, corr=-0.142) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.8552 -> 69.7097
[DBG][ep=077] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=077] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=077] mask(step0): mc_mean=0.2315 mb_mean=0.5034 norm_overlap=0.9948 corr_cb=-0.2506 topkJ=0.0291
[TRAIN][ep=077] loss=0.5159 acc=78.39%
[TRAIN][ep=077] mask_avg: mc_mean=0.2420 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1434
[EPOCH 077/089] train: loss=0.5159 acc=78.39% | val: loss=0.5598 acc=74.70% f1=72.73% auc=78.26% val_score=68.5819 val_score_bestthr=69.7097 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.242, mb=0.502, no=0.997, corr=-0.143) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.8552 -> 69.7097
[DBG][ep=078] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=078] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=078] mask(step0): mc_mean=0.2444 mb_mean=0.5031 norm_overlap=0.9969 corr_cb=-0.1263 topkJ=0.0399
[TRAIN][ep=078] loss=0.5151 acc=76.64%
[TRAIN][ep=078] mask_avg: mc_mean=0.2421 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1463
[EPOCH 078/089] train: loss=0.5151 acc=76.64% | val: loss=0.5589 acc=74.70% f1=72.73% auc=78.37% val_score=67.0745 val_score_bestthr=69.7097 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.242, mb=0.502, no=0.997, corr=-0.146) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.8552 -> 69.7097
[DBG][ep=079] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=079] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=079] mask(step0): mc_mean=0.2867 mb_mean=0.4999 norm_overlap=0.9961 corr_cb=-0.2223 topkJ=0.0360
[TRAIN][ep=079] loss=0.5115 acc=77.18%
[TRAIN][ep=079] mask_avg: mc_mean=0.2421 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1440
[EPOCH 079/089] train: loss=0.5115 acc=77.18% | val: loss=0.5573 acc=74.70% f1=72.73% auc=78.66% val_score=65.7487 val_score_bestthr=69.7097 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.242, mb=0.502, no=0.997, corr=-0.144) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 70.8552 -> 69.7097
[EARLY STOP] no improvement for 30 epochs. best_epoch=49
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
=============== FIT DONE ===============
[BEST] epoch=49 | val_acc=75.90% | val_f1=73.68% | val_auc=77.85% | val_score=66.1108 | val_score_bestthr=70.8552
[TEST@BEST] thr_used=0.415 | acc=63.29% f1=66.96% auc=65.47% | SP_sex=6.99% EO_sex=7.68% SP_age=6.79% EO_age=15.25%
[TIME] 1.84 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/summary_fold_0.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5259 mb_mean=0.5010 norm_overlap=0.9999 corr_cb=-0.0912 topkJ=0.0676
[TRAIN][ep=000] loss=0.6935 acc=51.81%
[TRAIN][ep=000] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0996
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5274 mb_mean=0.4997 norm_overlap=0.9999 corr_cb=-0.2567 topkJ=0.0254
[TRAIN][ep=001] loss=0.6919 acc=49.93%
[TRAIN][ep=001] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0926
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5297 mb_mean=0.5053 norm_overlap=1.0000 corr_cb=0.0154 topkJ=0.0969
[TRAIN][ep=002] loss=0.6903 acc=52.48%
[TRAIN][ep=002] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0983
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5296 mb_mean=0.5000 norm_overlap=0.9999 corr_cb=-0.1407 topkJ=0.0490
[TRAIN][ep=003] loss=0.6890 acc=55.57%
[TRAIN][ep=003] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0952
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5295 mb_mean=0.4987 norm_overlap=0.9999 corr_cb=-0.1840 topkJ=0.0339
[TRAIN][ep=004] loss=0.6892 acc=53.56%
[TRAIN][ep=004] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.1002
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5288 mb_mean=0.5009 norm_overlap=0.9999 corr_cb=-0.1690 topkJ=0.0368
[TRAIN][ep=005] loss=0.6862 acc=56.38%
[TRAIN][ep=005] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0988
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5323 mb_mean=0.5018 norm_overlap=0.9999 corr_cb=-0.2431 topkJ=0.0234
[TRAIN][ep=006] loss=0.6870 acc=51.68%
[TRAIN][ep=006] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0978
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5339 mb_mean=0.5021 norm_overlap=1.0000 corr_cb=-0.0185 topkJ=0.0321
[TRAIN][ep=007] loss=0.6847 acc=57.45%
[TRAIN][ep=007] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0955
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5308 mb_mean=0.5020 norm_overlap=1.0000 corr_cb=-0.0361 topkJ=0.0444
[TRAIN][ep=008] loss=0.6816 acc=57.05%
[TRAIN][ep=008] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0938
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5248 mb_mean=0.5048 norm_overlap=0.9999 corr_cb=-0.0945 topkJ=0.0690
[TRAIN][ep=009] loss=0.6806 acc=59.06%
[TRAIN][ep=009] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0965
================= FIT START (fold=0) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5327 mb_mean=0.5004 norm_overlap=1.0000 corr_cb=-0.0395 topkJ=0.0304
[TRAIN][ep=000] loss=0.6775 acc=59.06%
[TRAIN][ep=000] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0992
[EPOCH 000/089] train: loss=0.6775 acc=59.06% | val: loss=0.6765 acc=62.65% f1=69.31% auc=64.71% val_score=62.4236 val_score_bestthr=64.9727 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.099) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 64.9727
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5321 mb_mean=0.5010 norm_overlap=0.9998 corr_cb=-0.3401 topkJ=0.0082
[TRAIN][ep=001] loss=0.6748 acc=60.27%
[TRAIN][ep=001] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0976
[EPOCH 001/089] train: loss=0.6748 acc=60.27% | val: loss=0.6767 acc=60.24% f1=67.96% auc=63.60% val_score=41.2022 val_score_bestthr=62.1171 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.098) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9727 -> 62.1171
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5308 mb_mean=0.5031 norm_overlap=1.0000 corr_cb=-0.0851 topkJ=0.0316
[TRAIN][ep=002] loss=0.6705 acc=60.81%
[TRAIN][ep=002] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0965
[EPOCH 002/089] train: loss=0.6705 acc=60.81% | val: loss=0.6834 acc=62.65% f1=65.17% auc=62.15% val_score=37.3504 val_score_bestthr=57.3510 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.097) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9727 -> 57.3510
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5303 mb_mean=0.5028 norm_overlap=1.0000 corr_cb=0.0572 topkJ=0.0336
[TRAIN][ep=003] loss=0.6674 acc=62.28%
[TRAIN][ep=003] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0987
[EPOCH 003/089] train: loss=0.6674 acc=62.28% | val: loss=0.6696 acc=61.45% f1=68.63% auc=65.12% val_score=56.8142 val_score_bestthr=63.8688 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.099) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9727 -> 63.8688
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5315 mb_mean=0.5048 norm_overlap=1.0000 corr_cb=-0.0454 topkJ=0.0668
[TRAIN][ep=004] loss=0.6629 acc=62.82%
[TRAIN][ep=004] mask_avg: mc_mean=0.5292 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0985
[EPOCH 004/089] train: loss=0.6629 acc=62.82% | val: loss=0.6651 acc=62.65% f1=69.31% auc=65.87% val_score=56.4328 val_score_bestthr=64.9727 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.099) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9727 -> 64.9727
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5300 mb_mean=0.5015 norm_overlap=0.9999 corr_cb=-0.2288 topkJ=0.0177
[TRAIN][ep=005] loss=1.4455 acc=64.16%
[TRAIN][ep=005] mask_avg: mc_mean=0.3859 mb_mean=0.5023 norm_overlap=1.0006 corr_cb=0.1873
[EPOCH 005/089] train: loss=1.4455 acc=64.16% | val: loss=0.6669 acc=63.86% f1=71.15% auc=67.91% val_score=51.0965 val_score_bestthr=63.0003 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.386, mb=0.502, no=1.001, corr=0.187) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9727 -> 63.0003
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2901 mb_mean=0.5013 norm_overlap=1.0019 corr_cb=0.3804 topkJ=0.1285
[TRAIN][ep=006] loss=1.1977 acc=63.62%
[TRAIN][ep=006] mask_avg: mc_mean=0.2619 mb_mean=0.5023 norm_overlap=1.0012 corr_cb=0.1889
[EPOCH 006/089] train: loss=1.1977 acc=63.62% | val: loss=0.6579 acc=61.45% f1=71.93% auc=68.49% val_score=60.4497 val_score_bestthr=66.3106 | dyn(w_pfs=0.240, w_sup=0.190, w_csuf=0.140, stage2=False) | mask(mc=0.262, mb=0.502, no=1.001, corr=0.189) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 64.9727 -> 66.3106
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2399 mb_mean=0.5027 norm_overlap=1.0018 corr_cb=0.2207 topkJ=0.0752
[TRAIN][ep=007] loss=1.2780 acc=63.36%
[TRAIN][ep=007] mask_avg: mc_mean=0.2335 mb_mean=0.5023 norm_overlap=1.0012 corr_cb=0.1551
[EPOCH 007/089] train: loss=1.2780 acc=63.36% | val: loss=0.6532 acc=62.65% f1=72.57% auc=69.36% val_score=61.5496 val_score_bestthr=66.9442 | dyn(w_pfs=0.280, w_sup=0.230, w_csuf=0.180, stage2=False) | mask(mc=0.233, mb=0.502, no=1.001, corr=0.155) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 66.3106 -> 66.9442
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2300 mb_mean=0.5013 norm_overlap=1.0006 corr_cb=0.0744 topkJ=0.0742
[TRAIN][ep=008] loss=1.3574 acc=66.98%
[TRAIN][ep=008] mask_avg: mc_mean=0.2219 mb_mean=0.5023 norm_overlap=1.0010 corr_cb=0.1212
[EPOCH 008/089] train: loss=1.3574 acc=66.98% | val: loss=0.6546 acc=63.86% f1=70.00% auc=68.37% val_score=47.3525 val_score_bestthr=61.3612 | dyn(w_pfs=0.320, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.222, mb=0.502, no=1.001, corr=0.121) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.9442 -> 61.3612
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2197 mb_mean=0.5024 norm_overlap=1.0006 corr_cb=0.0542 topkJ=0.0719
[TRAIN][ep=009] loss=1.4043 acc=64.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.2006 mb_mean=0.5023 norm_overlap=1.0010 corr_cb=0.1031
[EPOCH 009/089] train: loss=1.4043 acc=64.70% | val: loss=0.6484 acc=65.06% f1=73.39% auc=70.23% val_score=69.1834 val_score_bestthr=69.1834 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.201, mb=0.502, no=1.001, corr=0.103) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 66.9442 -> 69.1834
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.2033 mb_mean=0.5010 norm_overlap=1.0015 corr_cb=0.1648 topkJ=0.0785
[TRAIN][ep=010] loss=1.4101 acc=63.22%
[TRAIN][ep=010] mask_avg: mc_mean=0.2025 mb_mean=0.5023 norm_overlap=1.0008 corr_cb=0.0674
[EPOCH 010/089] train: loss=1.4101 acc=63.22% | val: loss=0.6541 acc=62.65% f1=68.69% auc=68.84% val_score=52.0419 val_score_bestthr=58.7312 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.203, mb=0.502, no=1.001, corr=0.067) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.1834 -> 58.7312
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1949 mb_mean=0.5027 norm_overlap=0.9982 corr_cb=-0.1781 topkJ=0.0641
[TRAIN][ep=011] loss=1.3917 acc=67.25%
[TRAIN][ep=011] mask_avg: mc_mean=0.1944 mb_mean=0.5023 norm_overlap=1.0005 corr_cb=0.0407
[EPOCH 011/089] train: loss=1.3917 acc=67.25% | val: loss=0.6344 acc=62.65% f1=72.57% auc=71.69% val_score=58.1479 val_score_bestthr=67.1797 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.194, mb=0.502, no=1.000, corr=0.041) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.1834 -> 67.1797
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1890 mb_mean=0.5005 norm_overlap=1.0002 corr_cb=0.0143 topkJ=0.1186
[TRAIN][ep=012] loss=1.3883 acc=68.05%
[TRAIN][ep=012] mask_avg: mc_mean=0.1867 mb_mean=0.5023 norm_overlap=1.0002 corr_cb=0.0146
[EPOCH 012/089] train: loss=1.3883 acc=68.05% | val: loss=0.6985 acc=61.45% f1=68.63% auc=66.28% val_score=42.0268 val_score_bestthr=59.1515 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.187, mb=0.502, no=1.000, corr=0.015) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.1834 -> 59.1515
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.2007 mb_mean=0.5050 norm_overlap=0.9994 corr_cb=-0.0497 topkJ=0.0790
[TRAIN][ep=013] loss=1.3840 acc=67.25%
[TRAIN][ep=013] mask_avg: mc_mean=0.1742 mb_mean=0.5023 norm_overlap=1.0000 corr_cb=-0.0038
[EPOCH 013/089] train: loss=1.3840 acc=67.25% | val: loss=0.6542 acc=62.65% f1=68.69% auc=69.83% val_score=49.0762 val_score_bestthr=58.7312 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.174, mb=0.502, no=1.000, corr=-0.004) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.1834 -> 58.7312
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1541 mb_mean=0.4973 norm_overlap=1.0007 corr_cb=0.0513 topkJ=0.0672
[TRAIN][ep=014] loss=1.3722 acc=67.92%
[TRAIN][ep=014] mask_avg: mc_mean=0.1844 mb_mean=0.5023 norm_overlap=0.9995 corr_cb=-0.0361
[EPOCH 014/089] train: loss=1.3722 acc=67.92% | val: loss=0.6227 acc=63.86% f1=72.73% auc=73.78% val_score=61.5037 val_score_bestthr=66.8785 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.184, mb=0.502, no=1.000, corr=-0.036) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.1834 -> 66.8785
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1702 mb_mean=0.5022 norm_overlap=1.0002 corr_cb=0.0120 topkJ=0.0685
[TRAIN][ep=015] loss=1.1658 acc=68.46%
[TRAIN][ep=015] mask_avg: mc_mean=0.1899 mb_mean=0.5023 norm_overlap=0.9992 corr_cb=-0.0598
[EPOCH 015/089] train: loss=1.1658 acc=68.46% | val: loss=0.6244 acc=63.86% f1=73.68% auc=73.37% val_score=48.8180 val_score_bestthr=66.8001 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.190, mb=0.502, no=0.999, corr=-0.060) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.1834 -> 66.8001
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1877 mb_mean=0.5002 norm_overlap=1.0003 corr_cb=0.0215 topkJ=0.0636
[TRAIN][ep=016] loss=0.9350 acc=70.07%
[TRAIN][ep=016] mask_avg: mc_mean=0.1936 mb_mean=0.5023 norm_overlap=0.9989 corr_cb=-0.0780
[EPOCH 016/089] train: loss=0.9350 acc=70.07% | val: loss=0.6179 acc=62.65% f1=73.04% auc=73.31% val_score=46.6018 val_score_bestthr=65.4702 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.194, mb=0.502, no=0.999, corr=-0.078) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.1834 -> 65.4702
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.2053 mb_mean=0.5033 norm_overlap=0.9977 corr_cb=-0.1401 topkJ=0.0277
[TRAIN][ep=017] loss=0.8892 acc=70.74%
[TRAIN][ep=017] mask_avg: mc_mean=0.1919 mb_mean=0.5023 norm_overlap=0.9987 corr_cb=-0.0798
[EPOCH 017/089] train: loss=0.8892 acc=70.74% | val: loss=0.6080 acc=61.45% f1=71.93% auc=75.06% val_score=52.6398 val_score_bestthr=66.0823 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.192, mb=0.502, no=0.999, corr=-0.080) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.1834 -> 66.0823
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1961 mb_mean=0.5025 norm_overlap=0.9990 corr_cb=-0.0674 topkJ=0.0599
[TRAIN][ep=018] loss=0.8632 acc=70.60%
[TRAIN][ep=018] mask_avg: mc_mean=0.1875 mb_mean=0.5023 norm_overlap=0.9986 corr_cb=-0.0836
[EPOCH 018/089] train: loss=0.8632 acc=70.60% | val: loss=0.6136 acc=62.65% f1=72.07% auc=75.17% val_score=59.0823 val_score_bestthr=63.6063 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.188, mb=0.502, no=0.999, corr=-0.084) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.1834 -> 63.6063
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1527 mb_mean=0.5022 norm_overlap=0.9975 corr_cb=-0.1625 topkJ=0.0779
[TRAIN][ep=019] loss=0.8590 acc=71.01%
[TRAIN][ep=019] mask_avg: mc_mean=0.1908 mb_mean=0.5023 norm_overlap=0.9983 corr_cb=-0.0987
[EPOCH 019/089] train: loss=0.8590 acc=71.01% | val: loss=0.5961 acc=61.45% f1=72.88% auc=75.06% val_score=59.3806 val_score_bestthr=68.3200 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.191, mb=0.502, no=0.998, corr=-0.099) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.1834 -> 68.3200
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1943 mb_mean=0.5020 norm_overlap=1.0000 corr_cb=-0.0012 topkJ=0.1078
[TRAIN][ep=020] loss=0.8543 acc=70.20%
[TRAIN][ep=020] mask_avg: mc_mean=0.1832 mb_mean=0.5023 norm_overlap=0.9983 corr_cb=-0.0927
[EPOCH 020/089] train: loss=0.8543 acc=70.20% | val: loss=0.6166 acc=60.24% f1=71.79% auc=73.95% val_score=51.2276 val_score_bestthr=65.0291 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.183, mb=0.502, no=0.998, corr=-0.093) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.1834 -> 65.0291
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2212 mb_mean=0.5058 norm_overlap=0.9969 corr_cb=-0.1827 topkJ=0.0413
[TRAIN][ep=021] loss=0.8582 acc=69.80%
[TRAIN][ep=021] mask_avg: mc_mean=0.2027 mb_mean=0.5023 norm_overlap=0.9980 corr_cb=-0.1177
[EPOCH 021/089] train: loss=0.8582 acc=69.80% | val: loss=0.6010 acc=73.49% f1=71.79% auc=74.65% val_score=51.3639 val_score_bestthr=65.3216 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.203, mb=0.502, no=0.998, corr=-0.118) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.1834 -> 65.3216
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2433 mb_mean=0.4996 norm_overlap=0.9988 corr_cb=-0.0702 topkJ=0.0360
[TRAIN][ep=022] loss=0.8379 acc=73.02%
[TRAIN][ep=022] mask_avg: mc_mean=0.2054 mb_mean=0.5023 norm_overlap=0.9979 corr_cb=-0.1235
[EPOCH 022/089] train: loss=0.8379 acc=73.02% | val: loss=0.6100 acc=72.29% f1=70.89% auc=74.19% val_score=42.8542 val_score_bestthr=64.9804 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.205, mb=0.502, no=0.998, corr=-0.124) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.1834 -> 64.9804
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1566 mb_mean=0.5023 norm_overlap=0.9983 corr_cb=-0.0921 topkJ=0.0317
[TRAIN][ep=023] loss=0.8299 acc=72.89%
[TRAIN][ep=023] mask_avg: mc_mean=0.2067 mb_mean=0.5023 norm_overlap=0.9978 corr_cb=-0.1228
[EPOCH 023/089] train: loss=0.8299 acc=72.89% | val: loss=0.6067 acc=74.70% f1=72.73% auc=75.35% val_score=42.8542 val_score_bestthr=68.0866 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.207, mb=0.502, no=0.998, corr=-0.123) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.1834 -> 68.0866
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1898 mb_mean=0.5016 norm_overlap=0.9972 corr_cb=-0.1574 topkJ=0.0508
[TRAIN][ep=024] loss=0.8371 acc=72.21%
[TRAIN][ep=024] mask_avg: mc_mean=0.1981 mb_mean=0.5023 norm_overlap=0.9979 corr_cb=-0.1106
[EPOCH 024/089] train: loss=0.8371 acc=72.21% | val: loss=0.5719 acc=63.86% f1=74.14% auc=76.86% val_score=64.1100 val_score_bestthr=70.1174 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.198, mb=0.502, no=0.998, corr=-0.111) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 69.1834 -> 70.1174
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1737 mb_mean=0.4998 norm_overlap=0.9998 corr_cb=-0.0083 topkJ=0.0470
[TRAIN][ep=025] loss=0.9065 acc=72.35%
[TRAIN][ep=025] mask_avg: mc_mean=0.2040 mb_mean=0.5023 norm_overlap=0.9978 corr_cb=-0.1191
[EPOCH 025/089] train: loss=0.9065 acc=72.35% | val: loss=0.5795 acc=74.70% f1=72.73% auc=75.76% val_score=68.0866 val_score_bestthr=68.0866 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.204, mb=0.502, no=0.998, corr=-0.119) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.1174 -> 68.0866
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2240 mb_mean=0.5001 norm_overlap=0.9965 corr_cb=-0.2167 topkJ=0.0252
[TRAIN][ep=026] loss=0.9883 acc=72.62%
[TRAIN][ep=026] mask_avg: mc_mean=0.2101 mb_mean=0.5023 norm_overlap=0.9978 corr_cb=-0.1192
[EPOCH 026/089] train: loss=0.9883 acc=72.62% | val: loss=0.5795 acc=74.70% f1=72.73% auc=76.45% val_score=62.4726 val_score_bestthr=68.0866 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.210, mb=0.502, no=0.998, corr=-0.119) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.1174 -> 68.0866
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1755 mb_mean=0.5032 norm_overlap=0.9972 corr_cb=-0.1571 topkJ=0.0401
[TRAIN][ep=027] loss=1.0679 acc=72.48%
[TRAIN][ep=027] mask_avg: mc_mean=0.2164 mb_mean=0.5023 norm_overlap=0.9976 corr_cb=-0.1339
[EPOCH 027/089] train: loss=1.0679 acc=72.48% | val: loss=0.5704 acc=74.70% f1=72.73% auc=77.03% val_score=66.6390 val_score_bestthr=68.0866 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.216, mb=0.502, no=0.998, corr=-0.134) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.1174 -> 68.0866
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2018 mb_mean=0.5016 norm_overlap=0.9997 corr_cb=-0.0141 topkJ=0.0450
[TRAIN][ep=028] loss=1.1366 acc=74.36%
[TRAIN][ep=028] mask_avg: mc_mean=0.2123 mb_mean=0.5023 norm_overlap=0.9977 corr_cb=-0.1195
[EPOCH 028/089] train: loss=1.1366 acc=74.36% | val: loss=0.5607 acc=65.06% f1=72.38% auc=78.02% val_score=62.2723 val_score_bestthr=66.8004 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.212, mb=0.502, no=0.998, corr=-0.119) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.1174 -> 66.8004
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.1952 mb_mean=0.5039 norm_overlap=0.9978 corr_cb=-0.1198 topkJ=0.0639
[TRAIN][ep=029] loss=1.2233 acc=74.90%
[TRAIN][ep=029] mask_avg: mc_mean=0.2292 mb_mean=0.5023 norm_overlap=0.9976 corr_cb=-0.1330
[EPOCH 029/089] train: loss=1.2233 acc=74.90% | val: loss=0.5643 acc=74.70% f1=72.73% auc=78.31% val_score=62.4726 val_score_bestthr=68.0866 | dyn(w_pfs=0.100, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.229, mb=0.502, no=0.998, corr=-0.133) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.1174 -> 68.0866
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.1740 mb_mean=0.5015 norm_overlap=0.9977 corr_cb=-0.1254 topkJ=0.0321
[TRAIN][ep=030] loss=1.0071 acc=73.69%
[TRAIN][ep=030] mask_avg: mc_mean=0.2066 mb_mean=0.5023 norm_overlap=0.9977 corr_cb=-0.1171
[EPOCH 030/089] train: loss=1.0071 acc=73.69% | val: loss=0.6474 acc=71.08% f1=70.73% auc=77.33% val_score=48.9800 val_score_bestthr=66.8273 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.207, mb=0.502, no=0.998, corr=-0.117) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.1174 -> 66.8273
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2589 mb_mean=0.5032 norm_overlap=0.9984 corr_cb=-0.1074 topkJ=0.0427
[TRAIN][ep=031] loss=0.7980 acc=75.03%
[TRAIN][ep=031] mask_avg: mc_mean=0.2346 mb_mean=0.5023 norm_overlap=0.9973 corr_cb=-0.1461
[EPOCH 031/089] train: loss=0.7980 acc=75.03% | val: loss=0.5590 acc=74.70% f1=73.42% auc=77.85% val_score=64.1100 val_score_bestthr=68.5621 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.235, mb=0.502, no=0.997, corr=-0.146) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.1174 -> 68.5621
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2380 mb_mean=0.5001 norm_overlap=0.9942 corr_cb=-0.2886 topkJ=0.0398
[TRAIN][ep=032] loss=0.7933 acc=76.51%
[TRAIN][ep=032] mask_avg: mc_mean=0.2246 mb_mean=0.5023 norm_overlap=0.9972 corr_cb=-0.1462
[EPOCH 032/089] train: loss=0.7933 acc=76.51% | val: loss=0.5571 acc=74.70% f1=73.42% auc=78.14% val_score=51.1950 val_score_bestthr=68.5621 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.225, mb=0.502, no=0.997, corr=-0.146) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.1174 -> 68.5621
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2088 mb_mean=0.5007 norm_overlap=0.9988 corr_cb=-0.0723 topkJ=0.0602
[TRAIN][ep=033] loss=0.7766 acc=76.11%
[TRAIN][ep=033] mask_avg: mc_mean=0.2158 mb_mean=0.5023 norm_overlap=0.9973 corr_cb=-0.1323
[EPOCH 033/089] train: loss=0.7766 acc=76.11% | val: loss=0.5608 acc=75.90% f1=73.68% auc=77.91% val_score=70.8552 val_score_bestthr=70.8552 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.216, mb=0.502, no=0.997, corr=-0.132) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 70.1174 -> 70.8552
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2529 mb_mean=0.5049 norm_overlap=0.9950 corr_cb=-0.2727 topkJ=0.0157
[TRAIN][ep=034] loss=0.8605 acc=75.17%
[TRAIN][ep=034] mask_avg: mc_mean=0.2334 mb_mean=0.5023 norm_overlap=0.9973 corr_cb=-0.1400
[EPOCH 034/089] train: loss=0.8605 acc=75.17% | val: loss=0.5666 acc=67.47% f1=74.29% auc=78.90% val_score=54.4993 val_score_bestthr=68.7726 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.233, mb=0.502, no=0.997, corr=-0.140) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.8552 -> 68.7726
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2929 mb_mean=0.5025 norm_overlap=0.9960 corr_cb=-0.1874 topkJ=0.0278
[TRAIN][ep=035] loss=0.9356 acc=75.70%
[TRAIN][ep=035] mask_avg: mc_mean=0.2583 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1669
[EPOCH 035/089] train: loss=0.9356 acc=75.70% | val: loss=0.5512 acc=75.90% f1=74.36% auc=78.31% val_score=59.3880 val_score_bestthr=71.3284 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.258, mb=0.502, no=0.997, corr=-0.167) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 70.8552 -> 71.3284
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2147 mb_mean=0.5025 norm_overlap=0.9971 corr_cb=-0.1292 topkJ=0.0617
[TRAIN][ep=036] loss=1.0129 acc=75.57%
[TRAIN][ep=036] mask_avg: mc_mean=0.2386 mb_mean=0.5023 norm_overlap=0.9973 corr_cb=-0.1409
[EPOCH 036/089] train: loss=1.0129 acc=75.57% | val: loss=0.5523 acc=74.70% f1=72.00% auc=78.31% val_score=69.7097 val_score_bestthr=70.6236 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.239, mb=0.502, no=0.997, corr=-0.141) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.3284 -> 70.6236
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1771 mb_mean=0.5040 norm_overlap=0.9958 corr_cb=-0.1984 topkJ=0.0400
[TRAIN][ep=037] loss=1.0924 acc=75.97%
[TRAIN][ep=037] mask_avg: mc_mean=0.2202 mb_mean=0.5023 norm_overlap=0.9975 corr_cb=-0.1244
[EPOCH 037/089] train: loss=1.0924 acc=75.97% | val: loss=0.5667 acc=77.11% f1=76.54% auc=79.53% val_score=62.2409 val_score_bestthr=71.0539 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.220, mb=0.502, no=0.997, corr=-0.124) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.3284 -> 71.0539
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2606 mb_mean=0.5023 norm_overlap=0.9931 corr_cb=-0.3382 topkJ=0.0167
[TRAIN][ep=038] loss=1.1538 acc=77.05%
[TRAIN][ep=038] mask_avg: mc_mean=0.2577 mb_mean=0.5023 norm_overlap=0.9971 corr_cb=-0.1587
[EPOCH 038/089] train: loss=1.1538 acc=77.05% | val: loss=0.5517 acc=75.90% f1=72.22% auc=78.02% val_score=69.7097 val_score_bestthr=73.5876 | dyn(w_pfs=0.240, w_sup=0.240, w_csuf=0.200, stage2=False) | mask(mc=0.258, mb=0.502, no=0.997, corr=-0.159) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 71.3284 -> 73.5876
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2832 mb_mean=0.5023 norm_overlap=0.9953 corr_cb=-0.2673 topkJ=0.0253
[TRAIN][ep=039] loss=1.1800 acc=76.78%
[TRAIN][ep=039] mask_avg: mc_mean=0.2450 mb_mean=0.5023 norm_overlap=0.9973 corr_cb=-0.1419
[EPOCH 039/089] train: loss=1.1800 acc=76.78% | val: loss=0.5743 acc=75.90% f1=72.22% auc=77.67% val_score=69.7511 val_score_bestthr=73.5876 | dyn(w_pfs=0.280, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.245, mb=0.502, no=0.997, corr=-0.142) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.5876 -> 73.5876
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.1956 mb_mean=0.5019 norm_overlap=0.9968 corr_cb=-0.1432 topkJ=0.0251
[TRAIN][ep=040] loss=1.1835 acc=78.93%
[TRAIN][ep=040] mask_avg: mc_mean=0.2278 mb_mean=0.5023 norm_overlap=0.9973 corr_cb=-0.1343
[EPOCH 040/089] train: loss=1.1835 acc=78.93% | val: loss=0.5474 acc=75.90% f1=73.68% auc=79.53% val_score=61.0747 val_score_bestthr=72.4784 | dyn(w_pfs=0.320, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.228, mb=0.502, no=0.997, corr=-0.134) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.5876 -> 72.4784
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.2619 mb_mean=0.5002 norm_overlap=0.9977 corr_cb=-0.1344 topkJ=0.0280
[TRAIN][ep=041] loss=1.1925 acc=77.32%
[TRAIN][ep=041] mask_avg: mc_mean=0.2530 mb_mean=0.5023 norm_overlap=0.9974 corr_cb=-0.1372
[EPOCH 041/089] train: loss=1.1925 acc=77.32% | val: loss=0.5487 acc=75.90% f1=73.68% auc=79.24% val_score=63.4616 val_score_bestthr=72.4784 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.253, mb=0.502, no=0.997, corr=-0.137) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.5876 -> 72.4784
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.1971 mb_mean=0.5021 norm_overlap=0.9980 corr_cb=-0.0994 topkJ=0.0233
[TRAIN][ep=042] loss=1.1891 acc=77.18%
[TRAIN][ep=042] mask_avg: mc_mean=0.2282 mb_mean=0.5023 norm_overlap=0.9975 corr_cb=-0.1212
[EPOCH 042/089] train: loss=1.1891 acc=77.18% | val: loss=0.5524 acc=75.90% f1=72.97% auc=79.07% val_score=71.6880 val_score_bestthr=73.3947 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.228, mb=0.502, no=0.998, corr=-0.121) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.5876 -> 73.3947
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.3436 mb_mean=0.5025 norm_overlap=0.9956 corr_cb=-0.2556 topkJ=0.0199
[TRAIN][ep=043] loss=1.1952 acc=79.33%
[TRAIN][ep=043] mask_avg: mc_mean=0.2487 mb_mean=0.5023 norm_overlap=0.9972 corr_cb=-0.1434
[EPOCH 043/089] train: loss=1.1952 acc=79.33% | val: loss=0.5641 acc=74.70% f1=72.73% auc=78.49% val_score=51.6476 val_score_bestthr=71.6880 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.249, mb=0.502, no=0.997, corr=-0.143) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.5876 -> 71.6880
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2556 mb_mean=0.5062 norm_overlap=1.0008 corr_cb=0.0383 topkJ=0.0664
[TRAIN][ep=044] loss=0.9612 acc=80.40%
[TRAIN][ep=044] mask_avg: mc_mean=0.2447 mb_mean=0.5023 norm_overlap=0.9973 corr_cb=-0.1378
[EPOCH 044/089] train: loss=0.9612 acc=80.40% | val: loss=0.5509 acc=77.11% f1=76.54% auc=79.30% val_score=61.7433 val_score_bestthr=72.2713 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.245, mb=0.502, no=0.997, corr=-0.138) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.5876 -> 72.2713
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2865 mb_mean=0.5009 norm_overlap=0.9980 corr_cb=-0.0868 topkJ=0.0660
[TRAIN][ep=045] loss=0.7707 acc=79.06%
[TRAIN][ep=045] mask_avg: mc_mean=0.2520 mb_mean=0.5023 norm_overlap=0.9973 corr_cb=-0.1369
[EPOCH 045/089] train: loss=0.7707 acc=79.06% | val: loss=0.5552 acc=73.49% f1=71.05% auc=78.84% val_score=61.7433 val_score_bestthr=70.0629 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.252, mb=0.502, no=0.997, corr=-0.137) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.5876 -> 70.0629
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.1956 mb_mean=0.5026 norm_overlap=0.9991 corr_cb=-0.0331 topkJ=0.0762
[TRAIN][ep=046] loss=0.7154 acc=79.60%
[TRAIN][ep=046] mask_avg: mc_mean=0.2214 mb_mean=0.5023 norm_overlap=0.9975 corr_cb=-0.1203
[EPOCH 046/089] train: loss=0.7154 acc=79.60% | val: loss=0.5565 acc=73.49% f1=70.27% auc=78.84% val_score=61.7433 val_score_bestthr=70.9685 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.221, mb=0.502, no=0.997, corr=-0.120) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.5876 -> 70.9685
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.2608 mb_mean=0.5033 norm_overlap=0.9971 corr_cb=-0.1674 topkJ=0.0261
[TRAIN][ep=047] loss=0.7076 acc=80.00%
[TRAIN][ep=047] mask_avg: mc_mean=0.2418 mb_mean=0.5023 norm_overlap=0.9972 corr_cb=-0.1355
[EPOCH 047/089] train: loss=0.7076 acc=80.00% | val: loss=0.5743 acc=74.70% f1=72.73% auc=78.55% val_score=69.0738 val_score_bestthr=71.6880 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.242, mb=0.502, no=0.997, corr=-0.135) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.5876 -> 71.6880
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.2852 mb_mean=0.5001 norm_overlap=0.9962 corr_cb=-0.2062 topkJ=0.0267
[TRAIN][ep=048] loss=0.6838 acc=81.07%
[TRAIN][ep=048] mask_avg: mc_mean=0.2497 mb_mean=0.5023 norm_overlap=0.9972 corr_cb=-0.1400
[EPOCH 048/089] train: loss=0.6838 acc=81.07% | val: loss=0.5992 acc=67.47% f1=75.68% auc=79.01% val_score=64.6205 val_score_bestthr=70.6985 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.250, mb=0.502, no=0.997, corr=-0.140) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.5876 -> 70.6985
[DBG][ep=049] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.2259 mb_mean=0.4996 norm_overlap=0.9946 corr_cb=-0.2522 topkJ=0.0346
[TRAIN][ep=049] loss=0.7226 acc=77.72%
[TRAIN][ep=049] mask_avg: mc_mean=0.2490 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1491
[EPOCH 049/089] train: loss=0.7226 acc=77.72% | val: loss=0.5658 acc=68.67% f1=76.36% auc=79.77% val_score=60.9588 val_score_bestthr=71.8036 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.249, mb=0.502, no=0.997, corr=-0.149) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.5876 -> 71.8036
[DBG][ep=050] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.2367 mb_mean=0.5034 norm_overlap=0.9949 corr_cb=-0.2324 topkJ=0.0163
[TRAIN][ep=050] loss=0.6731 acc=82.68%
[TRAIN][ep=050] mask_avg: mc_mean=0.2378 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1436
[EPOCH 050/089] train: loss=0.6731 acc=82.68% | val: loss=0.5574 acc=67.47% f1=75.68% auc=79.65% val_score=58.1996 val_score_bestthr=70.6985 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.238, mb=0.502, no=0.997, corr=-0.144) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.5876 -> 70.6985
[DBG][ep=051] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.1970 mb_mean=0.5047 norm_overlap=1.0008 corr_cb=0.0382 topkJ=0.0834
[TRAIN][ep=051] loss=0.6743 acc=82.68%
[TRAIN][ep=051] mask_avg: mc_mean=0.2377 mb_mean=0.5023 norm_overlap=0.9971 corr_cb=-0.1413
[EPOCH 051/089] train: loss=0.6743 acc=82.68% | val: loss=0.5568 acc=67.47% f1=75.68% auc=79.59% val_score=57.0790 val_score_bestthr=70.6985 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.238, mb=0.502, no=0.997, corr=-0.141) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.5876 -> 70.6985
[DBG][ep=052] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.2344 mb_mean=0.5020 norm_overlap=0.9949 corr_cb=-0.2436 topkJ=0.0361
[TRAIN][ep=052] loss=0.6689 acc=83.62%
[TRAIN][ep=052] mask_avg: mc_mean=0.2377 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1427
[EPOCH 052/089] train: loss=0.6689 acc=83.62% | val: loss=0.5557 acc=67.47% f1=75.68% auc=80.00% val_score=60.6199 val_score_bestthr=70.6985 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.238, mb=0.502, no=0.997, corr=-0.143) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.5876 -> 70.6985
[DBG][ep=053] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.2594 mb_mean=0.5023 norm_overlap=0.9971 corr_cb=-0.1551 topkJ=0.0420
[TRAIN][ep=053] loss=0.6714 acc=83.62%
[TRAIN][ep=053] mask_avg: mc_mean=0.2377 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1440
[EPOCH 053/089] train: loss=0.6714 acc=83.62% | val: loss=0.5552 acc=67.47% f1=75.68% auc=79.65% val_score=61.7433 val_score_bestthr=70.6985 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.238, mb=0.502, no=0.997, corr=-0.144) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.5876 -> 70.6985
[DBG][ep=054] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=054] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=054] mask(step0): mc_mean=0.2464 mb_mean=0.5013 norm_overlap=0.9975 corr_cb=-0.1140 topkJ=0.0422
[TRAIN][ep=054] loss=0.6674 acc=82.01%
[TRAIN][ep=054] mask_avg: mc_mean=0.2377 mb_mean=0.5023 norm_overlap=0.9969 corr_cb=-0.1478
[EPOCH 054/089] train: loss=0.6674 acc=82.01% | val: loss=0.5559 acc=73.49% f1=71.05% auc=79.59% val_score=61.7433 val_score_bestthr=69.7223 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.238, mb=0.502, no=0.997, corr=-0.148) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.5876 -> 69.7223
[DBG][ep=055] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=055] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=055] mask(step0): mc_mean=0.2411 mb_mean=0.5029 norm_overlap=0.9948 corr_cb=-0.2533 topkJ=0.0150
[TRAIN][ep=055] loss=0.6649 acc=83.36%
[TRAIN][ep=055] mask_avg: mc_mean=0.2378 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1426
[EPOCH 055/089] train: loss=0.6649 acc=83.36% | val: loss=0.5564 acc=71.08% f1=76.00% auc=79.59% val_score=61.7433 val_score_bestthr=70.1680 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.238, mb=0.502, no=0.997, corr=-0.143) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.5876 -> 70.1680
[DBG][ep=056] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=056] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=056] mask(step0): mc_mean=0.2152 mb_mean=0.5009 norm_overlap=0.9975 corr_cb=-0.1405 topkJ=0.0517
[TRAIN][ep=056] loss=0.6666 acc=83.49%
[TRAIN][ep=056] mask_avg: mc_mean=0.2378 mb_mean=0.5023 norm_overlap=0.9971 corr_cb=-0.1429
[EPOCH 056/089] train: loss=0.6666 acc=83.49% | val: loss=0.5593 acc=77.11% f1=76.54% auc=79.59% val_score=62.7391 val_score_bestthr=72.2713 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.238, mb=0.502, no=0.997, corr=-0.143) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.5876 -> 72.2713
[DBG][ep=057] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=057] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=057] mask(step0): mc_mean=0.2452 mb_mean=0.5026 norm_overlap=0.9980 corr_cb=-0.1090 topkJ=0.0483
[TRAIN][ep=057] loss=0.6633 acc=83.62%
[TRAIN][ep=057] mask_avg: mc_mean=0.2377 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1429
[EPOCH 057/089] train: loss=0.6633 acc=83.62% | val: loss=0.5596 acc=77.11% f1=76.54% auc=79.77% val_score=65.0856 val_score_bestthr=72.2713 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.238, mb=0.502, no=0.997, corr=-0.143) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.5876 -> 72.2713
[DBG][ep=058] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=058] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=058] mask(step0): mc_mean=0.1901 mb_mean=0.5051 norm_overlap=0.9964 corr_cb=-0.1956 topkJ=0.0357
[TRAIN][ep=058] loss=0.6633 acc=82.95%
[TRAIN][ep=058] mask_avg: mc_mean=0.2377 mb_mean=0.5023 norm_overlap=0.9971 corr_cb=-0.1395
[EPOCH 058/089] train: loss=0.6633 acc=82.95% | val: loss=0.5588 acc=73.49% f1=70.27% auc=79.71% val_score=61.7433 val_score_bestthr=70.9685 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.238, mb=0.502, no=0.997, corr=-0.139) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.5876 -> 70.9685
[DBG][ep=059] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=059] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=059] mask(step0): mc_mean=0.2528 mb_mean=0.4997 norm_overlap=0.9959 corr_cb=-0.2066 topkJ=0.0490
[TRAIN][ep=059] loss=0.6602 acc=83.49%
[TRAIN][ep=059] mask_avg: mc_mean=0.2377 mb_mean=0.5023 norm_overlap=0.9971 corr_cb=-0.1416
[EPOCH 059/089] train: loss=0.6602 acc=83.49% | val: loss=0.5583 acc=73.49% f1=70.27% auc=79.83% val_score=60.6199 val_score_bestthr=70.9685 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.238, mb=0.502, no=0.997, corr=-0.142) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.5876 -> 70.9685
[DBG][ep=060] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=060] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=060] mask(step0): mc_mean=0.2729 mb_mean=0.4999 norm_overlap=0.9962 corr_cb=-0.2115 topkJ=0.0170
[TRAIN][ep=060] loss=0.6602 acc=83.76%
[TRAIN][ep=060] mask_avg: mc_mean=0.2377 mb_mean=0.5023 norm_overlap=0.9971 corr_cb=-0.1433
[EPOCH 060/089] train: loss=0.6602 acc=83.76% | val: loss=0.5605 acc=77.11% f1=76.54% auc=79.65% val_score=62.7391 val_score_bestthr=72.2713 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.238, mb=0.502, no=0.997, corr=-0.143) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.5876 -> 72.2713
[DBG][ep=061] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=061] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=061] mask(step0): mc_mean=0.2693 mb_mean=0.5016 norm_overlap=0.9917 corr_cb=-0.3441 topkJ=0.0192
[TRAIN][ep=061] loss=0.6594 acc=83.09%
[TRAIN][ep=061] mask_avg: mc_mean=0.2377 mb_mean=0.5023 norm_overlap=0.9971 corr_cb=-0.1421
[EPOCH 061/089] train: loss=0.6594 acc=83.09% | val: loss=0.5620 acc=73.49% f1=70.27% auc=79.53% val_score=61.7433 val_score_bestthr=70.9685 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.238, mb=0.502, no=0.997, corr=-0.142) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.5876 -> 70.9685
[DBG][ep=062] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=062] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=062] mask(step0): mc_mean=0.2469 mb_mean=0.5002 norm_overlap=0.9966 corr_cb=-0.1893 topkJ=0.0342
[TRAIN][ep=062] loss=0.6615 acc=82.95%
[TRAIN][ep=062] mask_avg: mc_mean=0.2377 mb_mean=0.5023 norm_overlap=0.9971 corr_cb=-0.1415
[EPOCH 062/089] train: loss=0.6615 acc=82.95% | val: loss=0.5623 acc=77.11% f1=76.54% auc=79.42% val_score=62.7391 val_score_bestthr=72.2713 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.238, mb=0.502, no=0.997, corr=-0.142) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.5876 -> 72.2713
[DBG][ep=063] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=063] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=063] mask(step0): mc_mean=0.2306 mb_mean=0.5036 norm_overlap=0.9967 corr_cb=-0.1446 topkJ=0.0211
[TRAIN][ep=063] loss=0.6624 acc=83.22%
[TRAIN][ep=063] mask_avg: mc_mean=0.2377 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1476
[EPOCH 063/089] train: loss=0.6624 acc=83.22% | val: loss=0.5655 acc=71.08% f1=74.47% auc=79.01% val_score=62.7391 val_score_bestthr=70.6549 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.238, mb=0.502, no=0.997, corr=-0.148) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.5876 -> 70.6549
[DBG][ep=064] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=064] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=064] mask(step0): mc_mean=0.2308 mb_mean=0.5016 norm_overlap=0.9955 corr_cb=-0.1895 topkJ=0.0456
[TRAIN][ep=064] loss=0.6559 acc=83.49%
[TRAIN][ep=064] mask_avg: mc_mean=0.2377 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1460
[EPOCH 064/089] train: loss=0.6559 acc=83.49% | val: loss=0.5663 acc=71.08% f1=74.47% auc=79.01% val_score=62.7391 val_score_bestthr=70.6549 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.238, mb=0.502, no=0.997, corr=-0.146) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.5876 -> 70.6549
[DBG][ep=065] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=065] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=065] mask(step0): mc_mean=0.2066 mb_mean=0.5027 norm_overlap=0.9958 corr_cb=-0.2091 topkJ=0.0271
[TRAIN][ep=065] loss=0.6574 acc=83.36%
[TRAIN][ep=065] mask_avg: mc_mean=0.2377 mb_mean=0.5023 norm_overlap=0.9971 corr_cb=-0.1417
[EPOCH 065/089] train: loss=0.6574 acc=83.36% | val: loss=0.5652 acc=72.29% f1=75.79% auc=79.36% val_score=63.8682 val_score_bestthr=71.4323 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.238, mb=0.502, no=0.997, corr=-0.142) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.5876 -> 71.4323
[DBG][ep=066] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=066] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=066] mask(step0): mc_mean=0.2046 mb_mean=0.5044 norm_overlap=0.9969 corr_cb=-0.1690 topkJ=0.0299
[TRAIN][ep=066] loss=0.6551 acc=84.03%
[TRAIN][ep=066] mask_avg: mc_mean=0.2378 mb_mean=0.5023 norm_overlap=0.9971 corr_cb=-0.1407
[EPOCH 066/089] train: loss=0.6551 acc=84.03% | val: loss=0.5653 acc=72.29% f1=76.29% auc=79.53% val_score=61.0747 val_score_bestthr=70.9734 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.238, mb=0.502, no=0.997, corr=-0.141) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.5876 -> 70.9734
[DBG][ep=067] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=067] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=067] mask(step0): mc_mean=0.2360 mb_mean=0.4998 norm_overlap=0.9992 corr_cb=-0.0324 topkJ=0.0595
[TRAIN][ep=067] loss=0.6542 acc=84.56%
[TRAIN][ep=067] mask_avg: mc_mean=0.2377 mb_mean=0.5023 norm_overlap=0.9971 corr_cb=-0.1397
[EPOCH 067/089] train: loss=0.6542 acc=84.56% | val: loss=0.5693 acc=77.11% f1=76.54% auc=79.36% val_score=68.0180 val_score_bestthr=72.2713 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.238, mb=0.502, no=0.997, corr=-0.140) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.5876 -> 72.2713
[DBG][ep=068] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=068] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=068] mask(step0): mc_mean=0.2230 mb_mean=0.5046 norm_overlap=0.9950 corr_cb=-0.2320 topkJ=0.0334
[TRAIN][ep=068] loss=0.6522 acc=82.95%
[TRAIN][ep=068] mask_avg: mc_mean=0.2377 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1433
[EPOCH 068/089] train: loss=0.6522 acc=82.95% | val: loss=0.5654 acc=71.08% f1=75.00% auc=79.30% val_score=60.6199 val_score_bestthr=70.3120 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.238, mb=0.502, no=0.997, corr=-0.143) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.5876 -> 70.3120
[EARLY STOP] no improvement for 30 epochs. best_epoch=38
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
=============== FIT DONE ===============
[BEST] epoch=38 | val_acc=75.90% | val_f1=72.22% | val_auc=78.02% | val_score=69.7097 | val_score_bestthr=73.5876
[TEST@BEST] thr_used=0.405 | acc=64.25% f1=67.54% auc=64.39% | SP_sex=4.72% EO_sex=7.68% SP_age=10.43% EO_age=15.25%
[TIME] 1.65 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/summary_fold_0.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5259 mb_mean=0.5010 norm_overlap=0.9999 corr_cb=-0.0912 topkJ=0.0676
[TRAIN][ep=000] loss=0.6935 acc=51.81%
[TRAIN][ep=000] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0996
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5274 mb_mean=0.4997 norm_overlap=0.9999 corr_cb=-0.2567 topkJ=0.0254
[TRAIN][ep=001] loss=0.6919 acc=49.93%
[TRAIN][ep=001] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0926
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5297 mb_mean=0.5053 norm_overlap=1.0000 corr_cb=0.0154 topkJ=0.0969
[TRAIN][ep=002] loss=0.6903 acc=52.48%
[TRAIN][ep=002] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0983
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5296 mb_mean=0.5000 norm_overlap=0.9999 corr_cb=-0.1407 topkJ=0.0490
[TRAIN][ep=003] loss=0.6890 acc=55.57%
[TRAIN][ep=003] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0952
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5295 mb_mean=0.4987 norm_overlap=0.9999 corr_cb=-0.1840 topkJ=0.0339
[TRAIN][ep=004] loss=0.6892 acc=53.56%
[TRAIN][ep=004] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.1002
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5288 mb_mean=0.5009 norm_overlap=0.9999 corr_cb=-0.1690 topkJ=0.0368
[TRAIN][ep=005] loss=0.6862 acc=56.38%
[TRAIN][ep=005] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0988
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5323 mb_mean=0.5018 norm_overlap=0.9999 corr_cb=-0.2431 topkJ=0.0234
[TRAIN][ep=006] loss=0.6870 acc=51.68%
[TRAIN][ep=006] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0978
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5339 mb_mean=0.5021 norm_overlap=1.0000 corr_cb=-0.0185 topkJ=0.0321
[TRAIN][ep=007] loss=0.6847 acc=57.45%
[TRAIN][ep=007] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0955
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5308 mb_mean=0.5020 norm_overlap=1.0000 corr_cb=-0.0361 topkJ=0.0444
[TRAIN][ep=008] loss=0.6816 acc=57.05%
[TRAIN][ep=008] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0938
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5248 mb_mean=0.5048 norm_overlap=0.9999 corr_cb=-0.0945 topkJ=0.0690
[TRAIN][ep=009] loss=0.6806 acc=59.06%
[TRAIN][ep=009] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0965
================= FIT START (fold=0) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.45 select_by=val_score_bestthr | eval_thr_mode=fixed eval_thr_grid=coarse | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5327 mb_mean=0.5004 norm_overlap=1.0000 corr_cb=-0.0395 topkJ=0.0304
[TRAIN][ep=000] loss=0.6775 acc=59.06%
[TRAIN][ep=000] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0992
[EPOCH 000/089] train: loss=0.6775 acc=59.06% | val: loss=0.6765 acc=51.81% f1=68.25% auc=64.71% val_score=62.0453 val_score_bestthr=62.0453 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.099) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 62.0453
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5321 mb_mean=0.5010 norm_overlap=0.9998 corr_cb=-0.3401 topkJ=0.0082
[TRAIN][ep=001] loss=0.6748 acc=60.27%
[TRAIN][ep=001] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0976
[EPOCH 001/089] train: loss=0.6748 acc=60.27% | val: loss=0.6767 acc=56.63% f1=68.97% auc=63.60% val_score=52.7056 val_score_bestthr=52.7056 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.098) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 52.7056
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5308 mb_mean=0.5031 norm_overlap=1.0000 corr_cb=-0.0851 topkJ=0.0316
[TRAIN][ep=002] loss=0.6705 acc=60.81%
[TRAIN][ep=002] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0965
[EPOCH 002/089] train: loss=0.6705 acc=60.81% | val: loss=0.6834 acc=56.63% f1=61.70% auc=62.21% val_score=48.1982 val_score_bestthr=48.1982 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.097) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 48.1982
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5303 mb_mean=0.5028 norm_overlap=1.0000 corr_cb=0.0572 topkJ=0.0336
[TRAIN][ep=003] loss=0.6674 acc=62.28%
[TRAIN][ep=003] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0987
[EPOCH 003/089] train: loss=0.6674 acc=62.28% | val: loss=0.6696 acc=57.83% f1=70.09% auc=65.12% val_score=53.4867 val_score_bestthr=53.4867 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.099) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 53.4867
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5315 mb_mean=0.5048 norm_overlap=1.0000 corr_cb=-0.0454 topkJ=0.0668
[TRAIN][ep=004] loss=0.6629 acc=62.82%
[TRAIN][ep=004] mask_avg: mc_mean=0.5292 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0985
[EPOCH 004/089] train: loss=0.6629 acc=62.82% | val: loss=0.6651 acc=59.04% f1=71.19% auc=65.87% val_score=61.4883 val_score_bestthr=61.4883 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.099) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 61.4883
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5300 mb_mean=0.5015 norm_overlap=0.9999 corr_cb=-0.2288 topkJ=0.0177
[TRAIN][ep=005] loss=1.4455 acc=64.16%
[TRAIN][ep=005] mask_avg: mc_mean=0.3859 mb_mean=0.5023 norm_overlap=1.0006 corr_cb=0.1872
[EPOCH 005/089] train: loss=1.4455 acc=64.16% | val: loss=0.6669 acc=63.86% f1=71.15% auc=67.97% val_score=63.0003 val_score_bestthr=63.0003 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.386, mb=0.502, no=1.001, corr=0.187) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 62.0453 -> 63.0003
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2901 mb_mean=0.5013 norm_overlap=1.0019 corr_cb=0.3803 topkJ=0.1285
[TRAIN][ep=006] loss=1.4252 acc=63.36%
[TRAIN][ep=006] mask_avg: mc_mean=0.2615 mb_mean=0.5023 norm_overlap=1.0012 corr_cb=0.1892
[EPOCH 006/089] train: loss=1.4252 acc=63.36% | val: loss=0.6579 acc=56.63% f1=70.49% auc=68.78% val_score=63.9539 val_score_bestthr=63.9539 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.262, mb=0.502, no=1.001, corr=0.189) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 63.0003 -> 63.9539
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2397 mb_mean=0.5027 norm_overlap=1.0018 corr_cb=0.2219 topkJ=0.0752
[TRAIN][ep=007] loss=1.4223 acc=63.62%
[TRAIN][ep=007] mask_avg: mc_mean=0.2332 mb_mean=0.5023 norm_overlap=1.0013 corr_cb=0.1565
[EPOCH 007/089] train: loss=1.4223 acc=63.62% | val: loss=0.6530 acc=59.04% f1=71.19% auc=69.19% val_score=62.0120 val_score_bestthr=62.0120 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.233, mb=0.502, no=1.001, corr=0.157) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.9539 -> 62.0120
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2300 mb_mean=0.5013 norm_overlap=1.0006 corr_cb=0.0765 topkJ=0.0733
[TRAIN][ep=008] loss=1.4151 acc=66.98%
[TRAIN][ep=008] mask_avg: mc_mean=0.2223 mb_mean=0.5023 norm_overlap=1.0011 corr_cb=0.1236
[EPOCH 008/089] train: loss=1.4151 acc=66.98% | val: loss=0.6545 acc=63.86% f1=70.00% auc=68.43% val_score=61.3612 val_score_bestthr=61.3612 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.222, mb=0.502, no=1.001, corr=0.124) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.9539 -> 61.3612
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2206 mb_mean=0.5024 norm_overlap=1.0006 corr_cb=0.0576 topkJ=0.0741
[TRAIN][ep=009] loss=1.4129 acc=65.10%
[TRAIN][ep=009] mask_avg: mc_mean=0.2015 mb_mean=0.5023 norm_overlap=1.0010 corr_cb=0.1053
[EPOCH 009/089] train: loss=1.4129 acc=65.10% | val: loss=0.6482 acc=56.63% f1=70.49% auc=70.17% val_score=63.9539 val_score_bestthr=63.9539 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.202, mb=0.502, no=1.001, corr=0.105) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.9539 -> 63.9539
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.2043 mb_mean=0.5010 norm_overlap=1.0015 corr_cb=0.1652 topkJ=0.0785
[TRAIN][ep=010] loss=1.4097 acc=63.09%
[TRAIN][ep=010] mask_avg: mc_mean=0.2031 mb_mean=0.5023 norm_overlap=1.0008 corr_cb=0.0698
[EPOCH 010/089] train: loss=1.4097 acc=63.09% | val: loss=0.6541 acc=59.04% f1=62.22% auc=68.66% val_score=42.3542 val_score_bestthr=42.3542 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.203, mb=0.502, no=1.001, corr=0.070) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.9539 -> 42.3542
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1949 mb_mean=0.5027 norm_overlap=0.9983 corr_cb=-0.1738 topkJ=0.0645
[TRAIN][ep=011] loss=1.3914 acc=67.38%
[TRAIN][ep=011] mask_avg: mc_mean=0.1946 mb_mean=0.5023 norm_overlap=1.0005 corr_cb=0.0438
[EPOCH 011/089] train: loss=1.3914 acc=67.38% | val: loss=0.6343 acc=60.24% f1=69.16% auc=71.63% val_score=60.4063 val_score_bestthr=60.4063 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.195, mb=0.502, no=1.001, corr=0.044) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.9539 -> 60.4063
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1896 mb_mean=0.5005 norm_overlap=1.0002 corr_cb=0.0162 topkJ=0.1186
[TRAIN][ep=012] loss=1.1732 acc=68.05%
[TRAIN][ep=012] mask_avg: mc_mean=0.1879 mb_mean=0.5023 norm_overlap=1.0003 corr_cb=0.0186
[EPOCH 012/089] train: loss=1.1732 acc=68.05% | val: loss=0.6999 acc=61.45% f1=46.67% auc=66.16% val_score=46.7646 val_score_bestthr=46.7646 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.188, mb=0.502, no=1.000, corr=0.019) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.9539 -> 46.7646
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.2032 mb_mean=0.5050 norm_overlap=0.9994 corr_cb=-0.0470 topkJ=0.0790
[TRAIN][ep=013] loss=0.9575 acc=66.58%
[TRAIN][ep=013] mask_avg: mc_mean=0.1799 mb_mean=0.5023 norm_overlap=1.0000 corr_cb=-0.0035
[EPOCH 013/089] train: loss=0.9575 acc=66.58% | val: loss=0.6552 acc=65.06% f1=62.34% auc=69.30% val_score=53.0032 val_score_bestthr=53.0032 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.180, mb=0.502, no=1.000, corr=-0.004) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.9539 -> 53.0032
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1592 mb_mean=0.4973 norm_overlap=1.0007 corr_cb=0.0540 topkJ=0.0704
[TRAIN][ep=014] loss=0.9052 acc=68.46%
[TRAIN][ep=014] mask_avg: mc_mean=0.1856 mb_mean=0.5023 norm_overlap=0.9996 corr_cb=-0.0313
[EPOCH 014/089] train: loss=0.9052 acc=68.46% | val: loss=0.6235 acc=61.45% f1=71.43% auc=72.91% val_score=65.1291 val_score_bestthr=65.1291 | dyn(w_pfs=0.090, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.186, mb=0.502, no=1.000, corr=-0.031) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 63.9539 -> 65.1291
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1746 mb_mean=0.5022 norm_overlap=1.0001 corr_cb=0.0115 topkJ=0.0712
[TRAIN][ep=015] loss=0.9943 acc=67.79%
[TRAIN][ep=015] mask_avg: mc_mean=0.1912 mb_mean=0.5023 norm_overlap=0.9992 corr_cb=-0.0558
[EPOCH 015/089] train: loss=0.9943 acc=67.79% | val: loss=0.6265 acc=62.65% f1=64.37% auc=72.56% val_score=45.7542 val_score_bestthr=45.7542 | dyn(w_pfs=0.130, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.191, mb=0.502, no=0.999, corr=-0.056) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1291 -> 45.7542
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1889 mb_mean=0.5002 norm_overlap=1.0004 corr_cb=0.0285 topkJ=0.0623
[TRAIN][ep=016] loss=1.0639 acc=70.47%
[TRAIN][ep=016] mask_avg: mc_mean=0.1925 mb_mean=0.5023 norm_overlap=0.9989 corr_cb=-0.0752
[EPOCH 016/089] train: loss=1.0639 acc=70.47% | val: loss=0.6183 acc=61.45% f1=62.79% auc=73.31% val_score=47.0585 val_score_bestthr=47.0585 | dyn(w_pfs=0.170, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.192, mb=0.502, no=0.999, corr=-0.075) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1291 -> 47.0585
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.2033 mb_mean=0.5033 norm_overlap=0.9977 corr_cb=-0.1387 topkJ=0.0265
[TRAIN][ep=017] loss=1.1481 acc=70.74%
[TRAIN][ep=017] mask_avg: mc_mean=0.1878 mb_mean=0.5023 norm_overlap=0.9988 corr_cb=-0.0785
[EPOCH 017/089] train: loss=1.1481 acc=70.74% | val: loss=0.6078 acc=61.45% f1=70.37% auc=75.06% val_score=59.5727 val_score_bestthr=59.5727 | dyn(w_pfs=0.210, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.188, mb=0.502, no=0.999, corr=-0.079) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.1291 -> 59.5727
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1888 mb_mean=0.5025 norm_overlap=0.9990 corr_cb=-0.0639 topkJ=0.0608
[TRAIN][ep=018] loss=1.2192 acc=70.07%
[TRAIN][ep=018] mask_avg: mc_mean=0.1847 mb_mean=0.5023 norm_overlap=0.9986 corr_cb=-0.0844
[EPOCH 018/089] train: loss=1.2192 acc=70.07% | val: loss=0.6154 acc=62.65% f1=73.04% auc=75.64% val_score=65.5423 val_score_bestthr=65.5423 | dyn(w_pfs=0.250, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.185, mb=0.502, no=0.999, corr=-0.084) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 65.1291 -> 65.5423
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1468 mb_mean=0.5022 norm_overlap=0.9975 corr_cb=-0.1611 topkJ=0.0788
[TRAIN][ep=019] loss=1.3011 acc=71.41%
[TRAIN][ep=019] mask_avg: mc_mean=0.1868 mb_mean=0.5023 norm_overlap=0.9983 corr_cb=-0.0981
[EPOCH 019/089] train: loss=1.3011 acc=71.41% | val: loss=0.5961 acc=62.65% f1=67.37% auc=75.41% val_score=52.0742 val_score_bestthr=52.0742 | dyn(w_pfs=0.290, w_sup=0.240, w_csuf=0.200, stage2=False) | mask(mc=0.187, mb=0.502, no=0.998, corr=-0.098) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.5423 -> 52.0742
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.1932 mb_mean=0.5020 norm_overlap=1.0000 corr_cb=-0.0016 topkJ=0.1088
[TRAIN][ep=020] loss=1.3157 acc=69.80%
[TRAIN][ep=020] mask_avg: mc_mean=0.1798 mb_mean=0.5023 norm_overlap=0.9984 corr_cb=-0.0892
[EPOCH 020/089] train: loss=1.3157 acc=69.80% | val: loss=0.6177 acc=71.08% f1=70.00% auc=74.01% val_score=62.8166 val_score_bestthr=62.8166 | dyn(w_pfs=0.330, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.180, mb=0.502, no=0.998, corr=-0.089) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.5423 -> 62.8166
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2189 mb_mean=0.5058 norm_overlap=0.9970 corr_cb=-0.1761 topkJ=0.0417
[TRAIN][ep=021] loss=1.3363 acc=68.72%
[TRAIN][ep=021] mask_avg: mc_mean=0.1956 mb_mean=0.5023 norm_overlap=0.9981 corr_cb=-0.1101
[EPOCH 021/089] train: loss=1.3363 acc=68.72% | val: loss=0.6003 acc=67.47% f1=67.47% auc=74.94% val_score=59.5618 val_score_bestthr=59.5618 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.196, mb=0.502, no=0.998, corr=-0.110) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.5423 -> 59.5618
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2384 mb_mean=0.4996 norm_overlap=0.9989 corr_cb=-0.0615 topkJ=0.0360
[TRAIN][ep=022] loss=1.3159 acc=73.02%
[TRAIN][ep=022] mask_avg: mc_mean=0.2057 mb_mean=0.5023 norm_overlap=0.9979 corr_cb=-0.1209
[EPOCH 022/089] train: loss=1.3159 acc=73.02% | val: loss=0.6047 acc=72.29% f1=70.89% auc=74.83% val_score=64.9804 val_score_bestthr=64.9804 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.206, mb=0.502, no=0.998, corr=-0.121) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.5423 -> 64.9804
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1524 mb_mean=0.5023 norm_overlap=0.9984 corr_cb=-0.0882 topkJ=0.0317
[TRAIN][ep=023] loss=1.3049 acc=72.35%
[TRAIN][ep=023] mask_avg: mc_mean=0.2058 mb_mean=0.5023 norm_overlap=0.9980 corr_cb=-0.1150
[EPOCH 023/089] train: loss=1.3049 acc=72.35% | val: loss=0.6045 acc=73.49% f1=71.05% auc=75.41% val_score=66.6390 val_score_bestthr=66.6390 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.206, mb=0.502, no=0.998, corr=-0.115) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 65.5423 -> 66.6390
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1884 mb_mean=0.5016 norm_overlap=0.9973 corr_cb=-0.1505 topkJ=0.0495
[TRAIN][ep=024] loss=1.3157 acc=72.48%
[TRAIN][ep=024] mask_avg: mc_mean=0.2005 mb_mean=0.5023 norm_overlap=0.9981 corr_cb=-0.1032
[EPOCH 024/089] train: loss=1.3157 acc=72.48% | val: loss=0.5689 acc=63.86% f1=68.75% auc=77.73% val_score=57.8307 val_score_bestthr=57.8307 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.201, mb=0.502, no=0.998, corr=-0.103) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6390 -> 57.8307
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1775 mb_mean=0.4998 norm_overlap=1.0002 corr_cb=0.0100 topkJ=0.0483
[TRAIN][ep=025] loss=1.2927 acc=72.48%
[TRAIN][ep=025] mask_avg: mc_mean=0.2060 mb_mean=0.5023 norm_overlap=0.9981 corr_cb=-0.1069
[EPOCH 025/089] train: loss=1.2927 acc=72.48% | val: loss=0.5776 acc=68.67% f1=69.05% auc=76.22% val_score=62.1506 val_score_bestthr=62.1506 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.206, mb=0.502, no=0.998, corr=-0.107) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6390 -> 62.1506
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2253 mb_mean=0.5001 norm_overlap=0.9968 corr_cb=-0.2032 topkJ=0.0248
[TRAIN][ep=026] loss=1.2892 acc=72.89%
[TRAIN][ep=026] mask_avg: mc_mean=0.2136 mb_mean=0.5023 norm_overlap=0.9981 corr_cb=-0.1054
[EPOCH 026/089] train: loss=1.2892 acc=72.89% | val: loss=0.5732 acc=72.29% f1=70.89% auc=76.98% val_score=66.3355 val_score_bestthr=66.3355 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.214, mb=0.502, no=0.998, corr=-0.105) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6390 -> 66.3355
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1775 mb_mean=0.5032 norm_overlap=0.9975 corr_cb=-0.1417 topkJ=0.0423
[TRAIN][ep=027] loss=1.2817 acc=73.15%
[TRAIN][ep=027] mask_avg: mc_mean=0.2197 mb_mean=0.5023 norm_overlap=0.9978 corr_cb=-0.1180
[EPOCH 027/089] train: loss=1.2817 acc=73.15% | val: loss=0.5715 acc=74.70% f1=73.42% auc=76.98% val_score=69.7650 val_score_bestthr=69.7650 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.220, mb=0.502, no=0.998, corr=-0.118) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 66.6390 -> 69.7650
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2028 mb_mean=0.5016 norm_overlap=1.0000 corr_cb=-0.0018 topkJ=0.0455
[TRAIN][ep=028] loss=1.2672 acc=74.77%
[TRAIN][ep=028] mask_avg: mc_mean=0.2147 mb_mean=0.5023 norm_overlap=0.9980 corr_cb=-0.1021
[EPOCH 028/089] train: loss=1.2672 acc=74.77% | val: loss=0.5590 acc=66.27% f1=70.83% auc=78.20% val_score=56.5171 val_score_bestthr=56.5171 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.215, mb=0.502, no=0.998, corr=-0.102) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.7650 -> 56.5171
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.1986 mb_mean=0.5039 norm_overlap=0.9981 corr_cb=-0.1006 topkJ=0.0661
[TRAIN][ep=029] loss=1.2715 acc=75.30%
[TRAIN][ep=029] mask_avg: mc_mean=0.2324 mb_mean=0.5023 norm_overlap=0.9978 corr_cb=-0.1177
[EPOCH 029/089] train: loss=1.2715 acc=75.30% | val: loss=0.5638 acc=73.49% f1=72.50% auc=78.26% val_score=68.2196 val_score_bestthr=68.2196 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.232, mb=0.502, no=0.998, corr=-0.118) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.7650 -> 68.2196
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.1787 mb_mean=0.5015 norm_overlap=0.9979 corr_cb=-0.1145 topkJ=0.0338
[TRAIN][ep=030] loss=1.2647 acc=73.83%
[TRAIN][ep=030] mask_avg: mc_mean=0.2107 mb_mean=0.5023 norm_overlap=0.9980 corr_cb=-0.1043
[EPOCH 030/089] train: loss=1.2647 acc=73.83% | val: loss=0.6452 acc=69.88% f1=62.69% auc=77.27% val_score=47.4658 val_score_bestthr=47.4658 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.211, mb=0.502, no=0.998, corr=-0.104) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.7650 -> 47.4658
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2636 mb_mean=0.5032 norm_overlap=0.9985 corr_cb=-0.0963 topkJ=0.0457
[TRAIN][ep=031] loss=1.2660 acc=74.77%
[TRAIN][ep=031] mask_avg: mc_mean=0.2354 mb_mean=0.5023 norm_overlap=0.9976 corr_cb=-0.1322
[EPOCH 031/089] train: loss=1.2660 acc=74.77% | val: loss=0.5590 acc=66.27% f1=68.18% auc=77.85% val_score=56.4998 val_score_bestthr=56.4998 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.235, mb=0.502, no=0.998, corr=-0.132) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.7650 -> 56.4998
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2346 mb_mean=0.5001 norm_overlap=0.9944 corr_cb=-0.2760 topkJ=0.0394
[TRAIN][ep=032] loss=1.2609 acc=76.78%
[TRAIN][ep=032] mask_avg: mc_mean=0.2237 mb_mean=0.5023 norm_overlap=0.9974 corr_cb=-0.1328
[EPOCH 032/089] train: loss=1.2609 acc=76.78% | val: loss=0.5556 acc=63.86% f1=69.39% auc=78.26% val_score=53.0935 val_score_bestthr=53.0935 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.224, mb=0.502, no=0.997, corr=-0.133) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.7650 -> 53.0935
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2080 mb_mean=0.5007 norm_overlap=0.9991 corr_cb=-0.0558 topkJ=0.0672
[TRAIN][ep=033] loss=1.0318 acc=76.51%
[TRAIN][ep=033] mask_avg: mc_mean=0.2186 mb_mean=0.5023 norm_overlap=0.9975 corr_cb=-0.1220
[EPOCH 033/089] train: loss=1.0318 acc=76.51% | val: loss=0.5581 acc=73.49% f1=72.50% auc=77.97% val_score=68.2196 val_score_bestthr=68.2196 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.219, mb=0.502, no=0.998, corr=-0.122) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.7650 -> 68.2196
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2561 mb_mean=0.5049 norm_overlap=0.9952 corr_cb=-0.2604 topkJ=0.0173
[TRAIN][ep=034] loss=0.8250 acc=75.70%
[TRAIN][ep=034] mask_avg: mc_mean=0.2357 mb_mean=0.5023 norm_overlap=0.9976 corr_cb=-0.1268
[EPOCH 034/089] train: loss=0.8250 acc=75.70% | val: loss=0.5652 acc=66.27% f1=73.08% auc=79.13% val_score=64.6205 val_score_bestthr=64.6205 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.236, mb=0.502, no=0.998, corr=-0.127) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.7650 -> 64.6205
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2932 mb_mean=0.5025 norm_overlap=0.9964 corr_cb=-0.1700 topkJ=0.0295
[TRAIN][ep=035] loss=0.7763 acc=75.84%
[TRAIN][ep=035] mask_avg: mc_mean=0.2584 mb_mean=0.5023 norm_overlap=0.9973 corr_cb=-0.1502
[EPOCH 035/089] train: loss=0.7763 acc=75.84% | val: loss=0.5512 acc=63.86% f1=68.75% auc=78.31% val_score=52.9810 val_score_bestthr=52.9810 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.258, mb=0.502, no=0.997, corr=-0.150) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.7650 -> 52.9810
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2146 mb_mean=0.5025 norm_overlap=0.9976 corr_cb=-0.1070 topkJ=0.0635
[TRAIN][ep=036] loss=0.7587 acc=75.97%
[TRAIN][ep=036] mask_avg: mc_mean=0.2382 mb_mean=0.5023 norm_overlap=0.9976 corr_cb=-0.1246
[EPOCH 036/089] train: loss=0.7587 acc=75.97% | val: loss=0.5541 acc=69.88% f1=70.59% auc=78.26% val_score=61.2467 val_score_bestthr=61.2467 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.238, mb=0.502, no=0.998, corr=-0.125) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.7650 -> 61.2467
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1830 mb_mean=0.5040 norm_overlap=0.9961 corr_cb=-0.1839 topkJ=0.0413
[TRAIN][ep=037] loss=0.7541 acc=75.97%
[TRAIN][ep=037] mask_avg: mc_mean=0.2224 mb_mean=0.5023 norm_overlap=0.9978 corr_cb=-0.1109
[EPOCH 037/089] train: loss=0.7541 acc=75.97% | val: loss=0.5709 acc=65.06% f1=72.38% auc=79.48% val_score=64.0975 val_score_bestthr=64.0975 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.222, mb=0.502, no=0.998, corr=-0.111) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.7650 -> 64.0975
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2643 mb_mean=0.5023 norm_overlap=0.9934 corr_cb=-0.3255 topkJ=0.0167
[TRAIN][ep=038] loss=0.7411 acc=77.05%
[TRAIN][ep=038] mask_avg: mc_mean=0.2583 mb_mean=0.5023 norm_overlap=0.9973 corr_cb=-0.1439
[EPOCH 038/089] train: loss=0.7411 acc=77.05% | val: loss=0.5502 acc=69.88% f1=70.59% auc=78.37% val_score=61.2467 val_score_bestthr=61.2467 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.258, mb=0.502, no=0.997, corr=-0.144) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.7650 -> 61.2467
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2833 mb_mean=0.5023 norm_overlap=0.9956 corr_cb=-0.2472 topkJ=0.0274
[TRAIN][ep=039] loss=0.7435 acc=76.91%
[TRAIN][ep=039] mask_avg: mc_mean=0.2449 mb_mean=0.5023 norm_overlap=0.9975 corr_cb=-0.1306
[EPOCH 039/089] train: loss=0.7435 acc=76.91% | val: loss=0.5752 acc=72.29% f1=70.13% auc=77.50% val_score=66.3103 val_score_bestthr=66.3103 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.245, mb=0.502, no=0.997, corr=-0.131) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.7650 -> 66.3103
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.2001 mb_mean=0.5019 norm_overlap=0.9969 corr_cb=-0.1388 topkJ=0.0260
[TRAIN][ep=040] loss=0.7344 acc=79.73%
[TRAIN][ep=040] mask_avg: mc_mean=0.2291 mb_mean=0.5023 norm_overlap=0.9974 corr_cb=-0.1261
[EPOCH 040/089] train: loss=0.7344 acc=79.73% | val: loss=0.5515 acc=62.65% f1=68.69% auc=79.59% val_score=50.7691 val_score_bestthr=50.7691 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.229, mb=0.502, no=0.997, corr=-0.126) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.7650 -> 50.7691
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.2659 mb_mean=0.5002 norm_overlap=0.9978 corr_cb=-0.1319 topkJ=0.0293
[TRAIN][ep=041] loss=0.7381 acc=77.45%
[TRAIN][ep=041] mask_avg: mc_mean=0.2523 mb_mean=0.5023 norm_overlap=0.9975 corr_cb=-0.1297
[EPOCH 041/089] train: loss=0.7381 acc=77.45% | val: loss=0.5510 acc=68.67% f1=70.45% auc=78.84% val_score=60.6199 val_score_bestthr=60.6199 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.252, mb=0.502, no=0.998, corr=-0.130) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.7650 -> 60.6199
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.1980 mb_mean=0.5021 norm_overlap=0.9980 corr_cb=-0.0954 topkJ=0.0233
[TRAIN][ep=042] loss=0.7280 acc=78.26%
[TRAIN][ep=042] mask_avg: mc_mean=0.2235 mb_mean=0.5023 norm_overlap=0.9976 corr_cb=-0.1129
[EPOCH 042/089] train: loss=0.7280 acc=78.26% | val: loss=0.5589 acc=74.70% f1=73.42% auc=78.84% val_score=66.4083 val_score_bestthr=66.4083 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.224, mb=0.502, no=0.998, corr=-0.113) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.7650 -> 66.4083
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.3340 mb_mean=0.5025 norm_overlap=0.9957 corr_cb=-0.2436 topkJ=0.0212
[TRAIN][ep=043] loss=0.7328 acc=79.19%
[TRAIN][ep=043] mask_avg: mc_mean=0.2467 mb_mean=0.5023 norm_overlap=0.9973 corr_cb=-0.1367
[EPOCH 043/089] train: loss=0.7328 acc=79.19% | val: loss=0.5642 acc=65.06% f1=71.29% auc=78.49% val_score=58.0486 val_score_bestthr=58.0486 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.247, mb=0.502, no=0.997, corr=-0.137) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.7650 -> 58.0486
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2539 mb_mean=0.5062 norm_overlap=1.0009 corr_cb=0.0417 topkJ=0.0673
[TRAIN][ep=044] loss=0.7094 acc=80.00%
[TRAIN][ep=044] mask_avg: mc_mean=0.2421 mb_mean=0.5023 norm_overlap=0.9973 corr_cb=-0.1332
[EPOCH 044/089] train: loss=0.7094 acc=80.00% | val: loss=0.5525 acc=67.47% f1=70.97% auc=79.01% val_score=59.2904 val_score_bestthr=59.2904 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.242, mb=0.502, no=0.997, corr=-0.133) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.7650 -> 59.2904
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2853 mb_mean=0.5009 norm_overlap=0.9980 corr_cb=-0.0871 topkJ=0.0669
[TRAIN][ep=045] loss=0.7212 acc=78.79%
[TRAIN][ep=045] mask_avg: mc_mean=0.2524 mb_mean=0.5023 norm_overlap=0.9973 corr_cb=-0.1360
[EPOCH 045/089] train: loss=0.7212 acc=78.79% | val: loss=0.5557 acc=66.27% f1=68.89% auc=78.72% val_score=55.9609 val_score_bestthr=55.9609 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.252, mb=0.502, no=0.997, corr=-0.136) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.7650 -> 55.9609
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.1979 mb_mean=0.5026 norm_overlap=0.9991 corr_cb=-0.0348 topkJ=0.0757
[TRAIN][ep=046] loss=0.7044 acc=79.19%
[TRAIN][ep=046] mask_avg: mc_mean=0.2228 mb_mean=0.5023 norm_overlap=0.9974 corr_cb=-0.1223
[EPOCH 046/089] train: loss=0.7044 acc=79.19% | val: loss=0.5560 acc=66.27% f1=69.57% auc=79.01% val_score=59.9581 val_score_bestthr=59.9581 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.223, mb=0.502, no=0.997, corr=-0.122) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.7650 -> 59.9581
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.2612 mb_mean=0.5033 norm_overlap=0.9971 corr_cb=-0.1686 topkJ=0.0266
[TRAIN][ep=047] loss=0.7091 acc=80.27%
[TRAIN][ep=047] mask_avg: mc_mean=0.2410 mb_mean=0.5023 norm_overlap=0.9972 corr_cb=-0.1363
[EPOCH 047/089] train: loss=0.7091 acc=80.27% | val: loss=0.5749 acc=73.49% f1=73.17% auc=78.31% val_score=66.9442 val_score_bestthr=66.9442 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.241, mb=0.502, no=0.997, corr=-0.136) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.7650 -> 66.9442
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.2817 mb_mean=0.5001 norm_overlap=0.9962 corr_cb=-0.2040 topkJ=0.0267
[TRAIN][ep=048] loss=0.6844 acc=80.67%
[TRAIN][ep=048] mask_avg: mc_mean=0.2493 mb_mean=0.5023 norm_overlap=0.9972 corr_cb=-0.1409
[EPOCH 048/089] train: loss=0.6844 acc=80.67% | val: loss=0.5974 acc=66.27% f1=73.08% auc=79.24% val_score=64.6205 val_score_bestthr=64.6205 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.249, mb=0.502, no=0.997, corr=-0.141) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.7650 -> 64.6205
[DBG][ep=049] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.2212 mb_mean=0.4996 norm_overlap=0.9947 corr_cb=-0.2439 topkJ=0.0354
[TRAIN][ep=049] loss=0.7240 acc=77.99%
[TRAIN][ep=049] mask_avg: mc_mean=0.2490 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1508
[EPOCH 049/089] train: loss=0.7240 acc=77.99% | val: loss=0.5647 acc=68.67% f1=74.00% auc=79.65% val_score=65.8521 val_score_bestthr=65.8521 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.249, mb=0.502, no=0.997, corr=-0.151) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.7650 -> 65.8521
[DBG][ep=050] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.2355 mb_mean=0.5034 norm_overlap=0.9950 corr_cb=-0.2303 topkJ=0.0163
[TRAIN][ep=050] loss=0.6740 acc=82.28%
[TRAIN][ep=050] mask_avg: mc_mean=0.2355 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1432
[EPOCH 050/089] train: loss=0.6740 acc=82.28% | val: loss=0.5567 acc=68.67% f1=71.74% auc=79.65% val_score=60.9588 val_score_bestthr=60.9588 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.235, mb=0.502, no=0.997, corr=-0.143) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 69.7650 -> 60.9588
[DBG][ep=051] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.1948 mb_mean=0.5047 norm_overlap=1.0008 corr_cb=0.0372 topkJ=0.0839
[TRAIN][ep=051] loss=0.6753 acc=82.68%
[TRAIN][ep=051] mask_avg: mc_mean=0.2354 mb_mean=0.5023 norm_overlap=0.9971 corr_cb=-0.1413
[EPOCH 051/089] train: loss=0.6753 acc=82.68% | val: loss=0.5561 acc=68.67% f1=71.74% auc=79.65% val_score=60.9588 val_score_bestthr=60.9588 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.235, mb=0.502, no=0.997, corr=-0.141) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 69.7650 -> 60.9588
[DBG][ep=052] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.2320 mb_mean=0.5020 norm_overlap=0.9949 corr_cb=-0.2412 topkJ=0.0361
[TRAIN][ep=052] loss=0.6698 acc=83.09%
[TRAIN][ep=052] mask_avg: mc_mean=0.2354 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1425
[EPOCH 052/089] train: loss=0.6698 acc=83.09% | val: loss=0.5551 acc=68.67% f1=71.11% auc=80.12% val_score=62.1938 val_score_bestthr=62.1938 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.235, mb=0.502, no=0.997, corr=-0.142) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 69.7650 -> 62.1938
[DBG][ep=053] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.2567 mb_mean=0.5023 norm_overlap=0.9971 corr_cb=-0.1566 topkJ=0.0407
[TRAIN][ep=053] loss=0.6723 acc=83.36%
[TRAIN][ep=053] mask_avg: mc_mean=0.2353 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1439
[EPOCH 053/089] train: loss=0.6723 acc=83.36% | val: loss=0.5546 acc=68.67% f1=71.11% auc=79.88% val_score=62.1938 val_score_bestthr=62.1938 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.235, mb=0.502, no=0.997, corr=-0.144) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 69.7650 -> 62.1938
[DBG][ep=054] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=054] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=054] mask(step0): mc_mean=0.2441 mb_mean=0.5013 norm_overlap=0.9975 corr_cb=-0.1149 topkJ=0.0409
[TRAIN][ep=054] loss=0.6682 acc=81.88%
[TRAIN][ep=054] mask_avg: mc_mean=0.2354 mb_mean=0.5023 norm_overlap=0.9969 corr_cb=-0.1475
[EPOCH 054/089] train: loss=0.6682 acc=81.88% | val: loss=0.5555 acc=68.67% f1=71.11% auc=79.77% val_score=62.1938 val_score_bestthr=62.1938 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.235, mb=0.502, no=0.997, corr=-0.147) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 69.7650 -> 62.1938
[DBG][ep=055] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=055] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=055] mask(step0): mc_mean=0.2384 mb_mean=0.5029 norm_overlap=0.9947 corr_cb=-0.2528 topkJ=0.0146
[TRAIN][ep=055] loss=0.6660 acc=83.36%
[TRAIN][ep=055] mask_avg: mc_mean=0.2355 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1423
[EPOCH 055/089] train: loss=0.6660 acc=83.36% | val: loss=0.5557 acc=68.67% f1=71.74% auc=79.77% val_score=60.9588 val_score_bestthr=60.9588 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.235, mb=0.502, no=0.997, corr=-0.142) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 69.7650 -> 60.9588
[DBG][ep=056] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=056] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=056] mask(step0): mc_mean=0.2126 mb_mean=0.5009 norm_overlap=0.9976 corr_cb=-0.1362 topkJ=0.0517
[TRAIN][ep=056] loss=0.6675 acc=83.22%
[TRAIN][ep=056] mask_avg: mc_mean=0.2355 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1426
[EPOCH 056/089] train: loss=0.6675 acc=83.22% | val: loss=0.5587 acc=67.47% f1=69.66% auc=79.94% val_score=57.0790 val_score_bestthr=57.0790 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.236, mb=0.502, no=0.997, corr=-0.143) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 69.7650 -> 57.0790
[DBG][ep=057] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=057] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=057] mask(step0): mc_mean=0.2424 mb_mean=0.5026 norm_overlap=0.9980 corr_cb=-0.1055 topkJ=0.0488
[TRAIN][ep=057] loss=0.6641 acc=83.49%
[TRAIN][ep=057] mask_avg: mc_mean=0.2354 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1428
[EPOCH 057/089] train: loss=0.6641 acc=83.49% | val: loss=0.5591 acc=67.47% f1=69.66% auc=79.77% val_score=57.0790 val_score_bestthr=57.0790 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.235, mb=0.502, no=0.997, corr=-0.143) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 69.7650 -> 57.0790
[EARLY STOP] no improvement for 30 epochs. best_epoch=27
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
=============== FIT DONE ===============
[BEST] epoch=27 | val_acc=74.70% | val_f1=73.42% | val_auc=76.98% | val_score=69.7650 | val_score_bestthr=69.7650
[TEST@BEST] thr_used=0.450 | acc=59.42% f1=60.75% auc=65.99% | SP_sex=2.54% EO_sex=8.65% SP_age=17.83% EO_age=24.80%
[TIME] 1.31 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/summary_fold_0.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5259 mb_mean=0.5010 norm_overlap=0.9999 corr_cb=-0.0912 topkJ=0.0676
[TRAIN][ep=000] loss=0.6939 acc=50.47%
[TRAIN][ep=000] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0996
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5274 mb_mean=0.4997 norm_overlap=0.9999 corr_cb=-0.2567 topkJ=0.0254
[TRAIN][ep=001] loss=0.6920 acc=50.47%
[TRAIN][ep=001] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0926
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5297 mb_mean=0.5053 norm_overlap=1.0000 corr_cb=0.0154 topkJ=0.0969
[TRAIN][ep=002] loss=0.6899 acc=52.89%
[TRAIN][ep=002] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0983
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5296 mb_mean=0.5000 norm_overlap=0.9999 corr_cb=-0.1407 topkJ=0.0490
[TRAIN][ep=003] loss=0.6882 acc=54.23%
[TRAIN][ep=003] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0952
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5295 mb_mean=0.4987 norm_overlap=0.9999 corr_cb=-0.1840 topkJ=0.0339
[TRAIN][ep=004] loss=0.6887 acc=53.42%
[TRAIN][ep=004] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.1002
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5288 mb_mean=0.5009 norm_overlap=0.9999 corr_cb=-0.1690 topkJ=0.0368
[TRAIN][ep=005] loss=0.6834 acc=56.91%
[TRAIN][ep=005] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0988
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5323 mb_mean=0.5018 norm_overlap=0.9999 corr_cb=-0.2431 topkJ=0.0234
[TRAIN][ep=006] loss=0.6844 acc=54.63%
[TRAIN][ep=006] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0978
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5339 mb_mean=0.5021 norm_overlap=1.0000 corr_cb=-0.0185 topkJ=0.0321
[TRAIN][ep=007] loss=0.6826 acc=57.72%
[TRAIN][ep=007] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0955
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5308 mb_mean=0.5020 norm_overlap=1.0000 corr_cb=-0.0361 topkJ=0.0444
[TRAIN][ep=008] loss=0.6776 acc=58.12%
[TRAIN][ep=008] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0938
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5248 mb_mean=0.5048 norm_overlap=0.9999 corr_cb=-0.0945 topkJ=0.0690
[TRAIN][ep=009] loss=0.6759 acc=58.93%
[TRAIN][ep=009] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0965
================= FIT START (fold=0) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5327 mb_mean=0.5004 norm_overlap=1.0000 corr_cb=-0.0395 topkJ=0.0304
[TRAIN][ep=000] loss=0.6709 acc=61.48%
[TRAIN][ep=000] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0992
[EPOCH 000/089] train: loss=0.6709 acc=61.48% | val: loss=0.6685 acc=62.65% f1=69.31% auc=66.05% val_score=63.8688 val_score_bestthr=64.9727 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.099) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 64.9727
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5321 mb_mean=0.5010 norm_overlap=0.9998 corr_cb=-0.3401 topkJ=0.0082
[TRAIN][ep=001] loss=0.6667 acc=61.34%
[TRAIN][ep=001] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0976
[EPOCH 001/089] train: loss=0.6667 acc=61.34% | val: loss=0.6664 acc=61.45% f1=68.63% auc=65.58% val_score=50.8549 val_score_bestthr=63.8688 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.098) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9727 -> 63.8688
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5308 mb_mean=0.5031 norm_overlap=1.0000 corr_cb=-0.0851 topkJ=0.0316
[TRAIN][ep=002] loss=0.6609 acc=60.94%
[TRAIN][ep=002] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0965
[EPOCH 002/089] train: loss=0.6609 acc=60.94% | val: loss=0.6767 acc=56.63% f1=64.71% auc=64.13% val_score=48.1618 val_score_bestthr=58.9427 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.097) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9727 -> 58.9427
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5303 mb_mean=0.5028 norm_overlap=1.0000 corr_cb=0.0572 topkJ=0.0336
[TRAIN][ep=003] loss=0.6553 acc=64.30%
[TRAIN][ep=003] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0987
[EPOCH 003/089] train: loss=0.6553 acc=64.30% | val: loss=0.6566 acc=62.65% f1=69.31% auc=66.69% val_score=50.8414 val_score_bestthr=64.9727 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.099) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9727 -> 64.9727
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5315 mb_mean=0.5048 norm_overlap=1.0000 corr_cb=-0.0454 topkJ=0.0668
[TRAIN][ep=004] loss=0.6486 acc=65.10%
[TRAIN][ep=004] mask_avg: mc_mean=0.5292 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0985
[EPOCH 004/089] train: loss=0.6486 acc=65.10% | val: loss=0.6512 acc=62.65% f1=69.31% auc=67.73% val_score=56.4760 val_score_bestthr=64.9727 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.099) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9727 -> 64.9727
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5300 mb_mean=0.5015 norm_overlap=0.9999 corr_cb=-0.2288 topkJ=0.0177
[TRAIN][ep=005] loss=1.3567 acc=64.83%
[TRAIN][ep=005] mask_avg: mc_mean=0.3779 mb_mean=0.5023 norm_overlap=1.0007 corr_cb=0.1900
[EPOCH 005/089] train: loss=1.3567 acc=64.83% | val: loss=0.6488 acc=61.45% f1=71.93% auc=71.22% val_score=51.2740 val_score_bestthr=62.4976 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.378, mb=0.502, no=1.001, corr=0.190) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9727 -> 62.4976
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2784 mb_mean=0.5013 norm_overlap=1.0021 corr_cb=0.3830 topkJ=0.1300
[TRAIN][ep=006] loss=1.1366 acc=65.50%
[TRAIN][ep=006] mask_avg: mc_mean=0.2532 mb_mean=0.5023 norm_overlap=1.0013 corr_cb=0.1862
[EPOCH 006/089] train: loss=1.1366 acc=65.50% | val: loss=0.6390 acc=62.65% f1=71.03% auc=71.51% val_score=61.3612 val_score_bestthr=64.7322 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.253, mb=0.502, no=1.001, corr=0.186) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9727 -> 64.7322
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2303 mb_mean=0.5027 norm_overlap=1.0018 corr_cb=0.2121 topkJ=0.0725
[TRAIN][ep=007] loss=0.9444 acc=65.50%
[TRAIN][ep=007] mask_avg: mc_mean=0.2249 mb_mean=0.5023 norm_overlap=1.0012 corr_cb=0.1470
[EPOCH 007/089] train: loss=0.9444 acc=65.50% | val: loss=0.6321 acc=62.65% f1=72.57% auc=72.50% val_score=61.1758 val_score_bestthr=67.1797 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.040, stage2=False) | mask(mc=0.225, mb=0.502, no=1.001, corr=0.147) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 64.9727 -> 67.1797
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2207 mb_mean=0.5013 norm_overlap=1.0005 corr_cb=0.0619 topkJ=0.0706
[TRAIN][ep=008] loss=1.0068 acc=68.46%
[TRAIN][ep=008] mask_avg: mc_mean=0.2100 mb_mean=0.5023 norm_overlap=1.0010 corr_cb=0.1092
[EPOCH 008/089] train: loss=1.0068 acc=68.46% | val: loss=0.6493 acc=63.86% f1=69.39% auc=69.65% val_score=51.3291 val_score_bestthr=61.0557 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.080, stage2=False) | mask(mc=0.210, mb=0.502, no=1.001, corr=0.109) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.1797 -> 61.0557
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2078 mb_mean=0.5024 norm_overlap=1.0004 corr_cb=0.0336 topkJ=0.0719
[TRAIN][ep=009] loss=1.0854 acc=65.91%
[TRAIN][ep=009] mask_avg: mc_mean=0.1897 mb_mean=0.5023 norm_overlap=1.0009 corr_cb=0.0858
[EPOCH 009/089] train: loss=1.0854 acc=65.91% | val: loss=0.6431 acc=65.06% f1=73.39% auc=73.43% val_score=65.7793 val_score_bestthr=68.3138 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.120, stage2=False) | mask(mc=0.190, mb=0.502, no=1.001, corr=0.086) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 67.1797 -> 68.3138
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1951 mb_mean=0.5010 norm_overlap=1.0013 corr_cb=0.1431 topkJ=0.0745
[TRAIN][ep=010] loss=1.1520 acc=65.77%
[TRAIN][ep=010] mask_avg: mc_mean=0.1924 mb_mean=0.5023 norm_overlap=1.0005 corr_cb=0.0444
[EPOCH 010/089] train: loss=1.1520 acc=65.77% | val: loss=0.6227 acc=65.06% f1=68.13% auc=73.43% val_score=58.4938 val_score_bestthr=64.8834 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.160, stage2=False) | mask(mc=0.192, mb=0.502, no=1.001, corr=0.044) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.3138 -> 64.8834
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1885 mb_mean=0.5027 norm_overlap=0.9979 corr_cb=-0.2012 topkJ=0.0551
[TRAIN][ep=011] loss=1.2021 acc=70.34%
[TRAIN][ep=011] mask_avg: mc_mean=0.1856 mb_mean=0.5023 norm_overlap=1.0002 corr_cb=0.0140
[EPOCH 011/089] train: loss=1.2021 acc=70.34% | val: loss=0.6125 acc=63.86% f1=72.73% auc=75.99% val_score=61.5955 val_score_bestthr=67.2118 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.186, mb=0.502, no=1.000, corr=0.014) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.3138 -> 67.2118
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1778 mb_mean=0.5005 norm_overlap=1.0001 corr_cb=0.0049 topkJ=0.1132
[TRAIN][ep=012] loss=1.2783 acc=68.99%
[TRAIN][ep=012] mask_avg: mc_mean=0.1806 mb_mean=0.5023 norm_overlap=0.9998 corr_cb=-0.0160
[EPOCH 012/089] train: loss=1.2783 acc=68.99% | val: loss=0.6697 acc=65.06% f1=70.10% auc=71.63% val_score=50.4880 val_score_bestthr=60.4149 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.181, mb=0.502, no=1.000, corr=-0.016) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.3138 -> 60.4149
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1931 mb_mean=0.5050 norm_overlap=0.9989 corr_cb=-0.0910 topkJ=0.0731
[TRAIN][ep=013] loss=1.2726 acc=69.40%
[TRAIN][ep=013] mask_avg: mc_mean=0.1703 mb_mean=0.5023 norm_overlap=0.9995 corr_cb=-0.0344
[EPOCH 013/089] train: loss=1.2726 acc=69.40% | val: loss=0.6203 acc=71.08% f1=70.00% auc=75.17% val_score=43.2724 val_score_bestthr=64.6065 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.170, mb=0.502, no=1.000, corr=-0.034) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.3138 -> 64.6065
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1602 mb_mean=0.4973 norm_overlap=1.0000 corr_cb=0.0009 topkJ=0.0575
[TRAIN][ep=014] loss=1.2584 acc=71.01%
[TRAIN][ep=014] mask_avg: mc_mean=0.1874 mb_mean=0.5023 norm_overlap=0.9991 corr_cb=-0.0680
[EPOCH 014/089] train: loss=1.2584 acc=71.01% | val: loss=0.5877 acc=62.65% f1=73.50% auc=76.16% val_score=58.7799 val_score_bestthr=69.0204 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.187, mb=0.502, no=0.999, corr=-0.068) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 68.3138 -> 69.0204
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1605 mb_mean=0.5022 norm_overlap=1.0002 corr_cb=0.0137 topkJ=0.0633
[TRAIN][ep=015] loss=1.2771 acc=69.93%
[TRAIN][ep=015] mask_avg: mc_mean=0.1926 mb_mean=0.5023 norm_overlap=0.9987 corr_cb=-0.0892
[EPOCH 015/089] train: loss=1.2771 acc=69.93% | val: loss=0.5844 acc=65.06% f1=72.38% auc=78.55% val_score=61.2400 val_score_bestthr=66.8004 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.193, mb=0.502, no=0.999, corr=-0.089) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.0204 -> 66.8004
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1785 mb_mean=0.5002 norm_overlap=0.9991 corr_cb=-0.0737 topkJ=0.0425
[TRAIN][ep=016] loss=1.2643 acc=70.60%
[TRAIN][ep=016] mask_avg: mc_mean=0.1924 mb_mean=0.5023 norm_overlap=0.9983 corr_cb=-0.1125
[EPOCH 016/089] train: loss=1.2643 acc=70.60% | val: loss=0.5754 acc=74.70% f1=72.73% auc=78.31% val_score=68.0866 val_score_bestthr=68.0866 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.192, mb=0.502, no=0.998, corr=-0.113) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.0204 -> 68.0866
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.2259 mb_mean=0.5033 norm_overlap=0.9967 corr_cb=-0.2110 topkJ=0.0211
[TRAIN][ep=017] loss=1.2542 acc=71.28%
[TRAIN][ep=017] mask_avg: mc_mean=0.2059 mb_mean=0.5023 norm_overlap=0.9982 corr_cb=-0.1200
[EPOCH 017/089] train: loss=1.2542 acc=71.28% | val: loss=0.5829 acc=67.47% f1=73.27% auc=78.26% val_score=60.0846 val_score_bestthr=67.0451 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.206, mb=0.502, no=0.998, corr=-0.120) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.0204 -> 67.0451
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1875 mb_mean=0.5025 norm_overlap=0.9987 corr_cb=-0.0822 topkJ=0.0479
[TRAIN][ep=018] loss=1.2364 acc=71.95%
[TRAIN][ep=018] mask_avg: mc_mean=0.1976 mb_mean=0.5023 norm_overlap=0.9983 corr_cb=-0.1075
[EPOCH 018/089] train: loss=1.2364 acc=71.95% | val: loss=0.6038 acc=63.86% f1=74.14% auc=79.19% val_score=63.5930 val_score_bestthr=68.8312 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.198, mb=0.502, no=0.998, corr=-0.107) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.0204 -> 68.8312
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1545 mb_mean=0.5022 norm_overlap=0.9966 corr_cb=-0.2155 topkJ=0.0513
[TRAIN][ep=019] loss=1.2263 acc=72.62%
[TRAIN][ep=019] mask_avg: mc_mean=0.1948 mb_mean=0.5023 norm_overlap=0.9981 corr_cb=-0.1122
[EPOCH 019/089] train: loss=1.2263 acc=72.62% | val: loss=0.5609 acc=74.70% f1=72.73% auc=78.31% val_score=65.3216 val_score_bestthr=68.0866 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.195, mb=0.502, no=0.998, corr=-0.112) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.0204 -> 68.0866
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.2270 mb_mean=0.5020 norm_overlap=0.9986 corr_cb=-0.0707 topkJ=0.0857
[TRAIN][ep=020] loss=1.0387 acc=73.29%
[TRAIN][ep=020] mask_avg: mc_mean=0.1986 mb_mean=0.5023 norm_overlap=0.9981 corr_cb=-0.1117
[EPOCH 020/089] train: loss=1.0387 acc=73.29% | val: loss=0.5780 acc=74.70% f1=72.00% auc=76.51% val_score=66.6390 val_score_bestthr=69.4062 | dyn(w_pfs=0.290, w_sup=0.190, w_csuf=0.140, stage2=False) | mask(mc=0.199, mb=0.502, no=0.998, corr=-0.112) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 69.0204 -> 69.4062
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2243 mb_mean=0.5058 norm_overlap=0.9977 corr_cb=-0.1377 topkJ=0.0343
[TRAIN][ep=021] loss=1.1214 acc=71.54%
[TRAIN][ep=021] mask_avg: mc_mean=0.2011 mb_mean=0.5023 norm_overlap=0.9980 corr_cb=-0.1148
[EPOCH 021/089] train: loss=1.1214 acc=71.54% | val: loss=0.5622 acc=74.70% f1=72.00% auc=78.14% val_score=68.0866 val_score_bestthr=69.4062 | dyn(w_pfs=0.330, w_sup=0.230, w_csuf=0.180, stage2=False) | mask(mc=0.201, mb=0.502, no=0.998, corr=-0.115) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.4062 -> 69.4062
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2500 mb_mean=0.4996 norm_overlap=0.9989 corr_cb=-0.0640 topkJ=0.0364
[TRAIN][ep=022] loss=1.1623 acc=73.69%
[TRAIN][ep=022] mask_avg: mc_mean=0.2244 mb_mean=0.5023 norm_overlap=0.9977 corr_cb=-0.1420
[EPOCH 022/089] train: loss=1.1623 acc=73.69% | val: loss=0.5588 acc=75.90% f1=74.36% auc=78.02% val_score=69.4062 val_score_bestthr=68.9443 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.224, mb=0.502, no=0.998, corr=-0.142) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.4062 -> 68.9443
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1362 mb_mean=0.5023 norm_overlap=0.9979 corr_cb=-0.1105 topkJ=0.0267
[TRAIN][ep=023] loss=1.1802 acc=74.77%
[TRAIN][ep=023] mask_avg: mc_mean=0.2112 mb_mean=0.5023 norm_overlap=0.9979 corr_cb=-0.1188
[EPOCH 023/089] train: loss=1.1802 acc=74.77% | val: loss=0.5729 acc=75.90% f1=73.68% auc=77.62% val_score=64.4160 val_score_bestthr=70.8552 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.211, mb=0.502, no=0.998, corr=-0.119) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 69.4062 -> 70.8552
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2144 mb_mean=0.5016 norm_overlap=0.9970 corr_cb=-0.1831 topkJ=0.0473
[TRAIN][ep=024] loss=1.2065 acc=72.75%
[TRAIN][ep=024] mask_avg: mc_mean=0.2126 mb_mean=0.5023 norm_overlap=0.9979 corr_cb=-0.1193
[EPOCH 024/089] train: loss=1.2065 acc=72.75% | val: loss=0.5437 acc=75.90% f1=74.36% auc=79.30% val_score=64.9842 val_score_bestthr=71.3284 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.213, mb=0.502, no=0.998, corr=-0.119) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 70.8552 -> 71.3284
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1782 mb_mean=0.4998 norm_overlap=1.0003 corr_cb=0.0111 topkJ=0.0518
[TRAIN][ep=025] loss=1.1722 acc=75.44%
[TRAIN][ep=025] mask_avg: mc_mean=0.1950 mb_mean=0.5023 norm_overlap=0.9980 corr_cb=-0.1079
[EPOCH 025/089] train: loss=1.1722 acc=75.44% | val: loss=0.5527 acc=77.11% f1=74.67% auc=78.14% val_score=68.2341 val_score_bestthr=73.6277 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.195, mb=0.502, no=0.998, corr=-0.108) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 71.3284 -> 73.6277
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2305 mb_mean=0.5001 norm_overlap=0.9971 corr_cb=-0.1896 topkJ=0.0174
[TRAIN][ep=026] loss=1.1639 acc=75.97%
[TRAIN][ep=026] mask_avg: mc_mean=0.2183 mb_mean=0.5023 norm_overlap=0.9979 corr_cb=-0.1168
[EPOCH 026/089] train: loss=1.1639 acc=75.97% | val: loss=0.5415 acc=78.31% f1=77.50% auc=79.48% val_score=52.5159 val_score_bestthr=72.6051 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.218, mb=0.502, no=0.998, corr=-0.117) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 72.6051
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1657 mb_mean=0.5032 norm_overlap=0.9973 corr_cb=-0.1493 topkJ=0.0363
[TRAIN][ep=027] loss=1.1449 acc=76.11%
[TRAIN][ep=027] mask_avg: mc_mean=0.2174 mb_mean=0.5023 norm_overlap=0.9978 corr_cb=-0.1194
[EPOCH 027/089] train: loss=1.1449 acc=76.11% | val: loss=0.5834 acc=73.49% f1=72.50% auc=77.56% val_score=64.4158 val_score_bestthr=68.2341 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.217, mb=0.502, no=0.998, corr=-0.119) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 68.2341
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2034 mb_mean=0.5016 norm_overlap=1.0000 corr_cb=-0.0018 topkJ=0.0506
[TRAIN][ep=028] loss=1.1329 acc=78.12%
[TRAIN][ep=028] mask_avg: mc_mean=0.2194 mb_mean=0.5023 norm_overlap=0.9980 corr_cb=-0.1083
[EPOCH 028/089] train: loss=1.1329 acc=78.12% | val: loss=0.5479 acc=77.11% f1=75.95% auc=78.43% val_score=64.0724 val_score_bestthr=72.4213 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.219, mb=0.502, no=0.998, corr=-0.108) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 72.4213
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2141 mb_mean=0.5039 norm_overlap=0.9984 corr_cb=-0.0921 topkJ=0.0718
[TRAIN][ep=029] loss=1.1443 acc=77.99%
[TRAIN][ep=029] mask_avg: mc_mean=0.2250 mb_mean=0.5023 norm_overlap=0.9978 corr_cb=-0.1182
[EPOCH 029/089] train: loss=1.1443 acc=77.99% | val: loss=0.5475 acc=74.70% f1=72.73% auc=80.23% val_score=67.8564 val_score_bestthr=70.5527 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.225, mb=0.502, no=0.998, corr=-0.118) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 70.5527
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.1430 mb_mean=0.5015 norm_overlap=0.9979 corr_cb=-0.1055 topkJ=0.0329
[TRAIN][ep=030] loss=1.1377 acc=76.64%
[TRAIN][ep=030] mask_avg: mc_mean=0.2208 mb_mean=0.5023 norm_overlap=0.9978 corr_cb=-0.1219
[EPOCH 030/089] train: loss=1.1377 acc=76.64% | val: loss=0.5857 acc=73.49% f1=72.50% auc=79.59% val_score=64.4158 val_score_bestthr=69.8694 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.221, mb=0.502, no=0.998, corr=-0.122) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 69.8694
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2905 mb_mean=0.5032 norm_overlap=0.9983 corr_cb=-0.1186 topkJ=0.0401
[TRAIN][ep=031] loss=0.9599 acc=77.45%
[TRAIN][ep=031] mask_avg: mc_mean=0.2244 mb_mean=0.5023 norm_overlap=0.9974 corr_cb=-0.1410
[EPOCH 031/089] train: loss=0.9599 acc=77.45% | val: loss=0.5669 acc=73.49% f1=72.50% auc=78.31% val_score=62.8147 val_score_bestthr=68.2341 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.224, mb=0.502, no=0.997, corr=-0.141) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 68.2341
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2151 mb_mean=0.5001 norm_overlap=0.9950 corr_cb=-0.2474 topkJ=0.0356
[TRAIN][ep=032] loss=0.7794 acc=78.12%
[TRAIN][ep=032] mask_avg: mc_mean=0.2157 mb_mean=0.5023 norm_overlap=0.9972 corr_cb=-0.1427
[EPOCH 032/089] train: loss=0.7794 acc=78.12% | val: loss=0.5587 acc=68.67% f1=75.93% auc=78.66% val_score=51.1842 val_score_bestthr=68.2387 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.216, mb=0.502, no=0.997, corr=-0.143) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 68.2387
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1940 mb_mean=0.5007 norm_overlap=0.9988 corr_cb=-0.0712 topkJ=0.0686
[TRAIN][ep=033] loss=0.7285 acc=79.06%
[TRAIN][ep=033] mask_avg: mc_mean=0.2134 mb_mean=0.5023 norm_overlap=0.9973 corr_cb=-0.1355
[EPOCH 033/089] train: loss=0.7285 acc=79.06% | val: loss=0.5540 acc=68.67% f1=75.93% auc=79.01% val_score=55.9609 val_score_bestthr=68.2387 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.213, mb=0.502, no=0.997, corr=-0.136) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 68.2387
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2685 mb_mean=0.5049 norm_overlap=0.9960 corr_cb=-0.2268 topkJ=0.0248
[TRAIN][ep=034] loss=0.7158 acc=78.93%
[TRAIN][ep=034] mask_avg: mc_mean=0.2345 mb_mean=0.5023 norm_overlap=0.9973 corr_cb=-0.1447
[EPOCH 034/089] train: loss=0.7158 acc=78.93% | val: loss=0.6042 acc=69.88% f1=75.25% auc=79.42% val_score=65.7650 val_score_bestthr=69.0388 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.235, mb=0.502, no=0.997, corr=-0.145) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 69.0388
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2928 mb_mean=0.5025 norm_overlap=0.9951 corr_cb=-0.2222 topkJ=0.0240
[TRAIN][ep=035] loss=0.7007 acc=80.54%
[TRAIN][ep=035] mask_avg: mc_mean=0.2588 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1682
[EPOCH 035/089] train: loss=0.7007 acc=80.54% | val: loss=0.5717 acc=68.67% f1=74.00% auc=78.37% val_score=64.7677 val_score_bestthr=67.0695 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.259, mb=0.502, no=0.997, corr=-0.168) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 67.0695
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2048 mb_mean=0.5025 norm_overlap=0.9974 corr_cb=-0.1155 topkJ=0.0594
[TRAIN][ep=036] loss=0.7039 acc=80.67%
[TRAIN][ep=036] mask_avg: mc_mean=0.2293 mb_mean=0.5023 norm_overlap=0.9973 corr_cb=-0.1372
[EPOCH 036/089] train: loss=0.7039 acc=80.67% | val: loss=0.5708 acc=69.88% f1=74.75% auc=78.08% val_score=64.5926 val_score_bestthr=68.1836 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.229, mb=0.502, no=0.997, corr=-0.137) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 68.1836
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1647 mb_mean=0.5040 norm_overlap=0.9961 corr_cb=-0.1798 topkJ=0.0304
[TRAIN][ep=037] loss=0.6897 acc=80.40%
[TRAIN][ep=037] mask_avg: mc_mean=0.2282 mb_mean=0.5023 norm_overlap=0.9973 corr_cb=-0.1377
[EPOCH 037/089] train: loss=0.6897 acc=80.40% | val: loss=0.5653 acc=71.08% f1=76.00% auc=79.19% val_score=54.8619 val_score_bestthr=71.3709 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.228, mb=0.502, no=0.997, corr=-0.138) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 71.3709
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2629 mb_mean=0.5023 norm_overlap=0.9932 corr_cb=-0.3364 topkJ=0.0111
[TRAIN][ep=038] loss=0.6712 acc=80.94%
[TRAIN][ep=038] mask_avg: mc_mean=0.2485 mb_mean=0.5023 norm_overlap=0.9969 corr_cb=-0.1620
[EPOCH 038/089] train: loss=0.6712 acc=80.94% | val: loss=0.5787 acc=67.47% f1=75.68% auc=77.85% val_score=61.8819 val_score_bestthr=69.4811 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.248, mb=0.502, no=0.997, corr=-0.162) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 69.4811
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2684 mb_mean=0.5023 norm_overlap=0.9951 corr_cb=-0.2689 topkJ=0.0270
[TRAIN][ep=039] loss=0.6711 acc=82.01%
[TRAIN][ep=039] mask_avg: mc_mean=0.2444 mb_mean=0.5023 norm_overlap=0.9972 corr_cb=-0.1477
[EPOCH 039/089] train: loss=0.6711 acc=82.01% | val: loss=0.5984 acc=68.67% f1=75.93% auc=76.69% val_score=58.4968 val_score_bestthr=68.2387 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.244, mb=0.502, no=0.997, corr=-0.148) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 68.2387
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.1791 mb_mean=0.5019 norm_overlap=0.9967 corr_cb=-0.1379 topkJ=0.0411
[TRAIN][ep=040] loss=0.6684 acc=81.34%
[TRAIN][ep=040] mask_avg: mc_mean=0.2257 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1460
[EPOCH 040/089] train: loss=0.6684 acc=81.34% | val: loss=0.5921 acc=72.29% f1=76.77% auc=78.60% val_score=62.6910 val_score_bestthr=70.9047 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.226, mb=0.502, no=0.997, corr=-0.146) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 70.9047
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.2535 mb_mean=0.5002 norm_overlap=0.9979 corr_cb=-0.1250 topkJ=0.0251
[TRAIN][ep=041] loss=0.6547 acc=81.88%
[TRAIN][ep=041] mask_avg: mc_mean=0.2480 mb_mean=0.5023 norm_overlap=0.9972 corr_cb=-0.1452
[EPOCH 041/089] train: loss=0.6547 acc=81.88% | val: loss=0.5979 acc=68.67% f1=76.36% auc=77.33% val_score=54.9733 val_score_bestthr=71.8036 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.248, mb=0.502, no=0.997, corr=-0.145) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 71.8036
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.1810 mb_mean=0.5021 norm_overlap=0.9979 corr_cb=-0.0974 topkJ=0.0241
[TRAIN][ep=042] loss=0.6534 acc=82.01%
[TRAIN][ep=042] mask_avg: mc_mean=0.2283 mb_mean=0.5023 norm_overlap=0.9972 corr_cb=-0.1369
[EPOCH 042/089] train: loss=0.6534 acc=82.01% | val: loss=0.5918 acc=68.67% f1=76.36% auc=77.79% val_score=56.0901 val_score_bestthr=71.8036 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.228, mb=0.502, no=0.997, corr=-0.137) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 71.8036
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.3243 mb_mean=0.5025 norm_overlap=0.9954 corr_cb=-0.2487 topkJ=0.0220
[TRAIN][ep=043] loss=0.6556 acc=83.22%
[TRAIN][ep=043] mask_avg: mc_mean=0.2475 mb_mean=0.5023 norm_overlap=0.9969 corr_cb=-0.1583
[EPOCH 043/089] train: loss=0.6556 acc=83.22% | val: loss=0.6268 acc=68.67% f1=76.36% auc=75.87% val_score=56.0901 val_score_bestthr=71.8036 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.248, mb=0.502, no=0.997, corr=-0.158) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 71.8036
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2532 mb_mean=0.5062 norm_overlap=1.0007 corr_cb=0.0343 topkJ=0.0628
[TRAIN][ep=044] loss=0.6312 acc=82.95%
[TRAIN][ep=044] mask_avg: mc_mean=0.2475 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1528
[EPOCH 044/089] train: loss=0.6312 acc=82.95% | val: loss=0.6320 acc=67.47% f1=75.68% auc=77.56% val_score=61.7270 val_score_bestthr=71.0318 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.248, mb=0.502, no=0.997, corr=-0.153) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 71.0318
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2976 mb_mean=0.5009 norm_overlap=0.9983 corr_cb=-0.0781 topkJ=0.0716
[TRAIN][ep=045] loss=0.6383 acc=84.03%
[TRAIN][ep=045] mask_avg: mc_mean=0.2585 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1558
[EPOCH 045/089] train: loss=0.6383 acc=84.03% | val: loss=0.6925 acc=71.08% f1=76.47% auc=75.76% val_score=60.3728 val_score_bestthr=71.5735 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.258, mb=0.502, no=0.997, corr=-0.156) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 71.5735
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.2003 mb_mean=0.5026 norm_overlap=0.9988 corr_cb=-0.0444 topkJ=0.0722
[TRAIN][ep=046] loss=0.6333 acc=83.62%
[TRAIN][ep=046] mask_avg: mc_mean=0.2174 mb_mean=0.5023 norm_overlap=0.9971 corr_cb=-0.1338
[EPOCH 046/089] train: loss=0.6333 acc=83.62% | val: loss=0.6460 acc=72.29% f1=76.77% auc=76.28% val_score=59.6185 val_score_bestthr=69.6873 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.217, mb=0.502, no=0.997, corr=-0.134) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 69.6873
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.2738 mb_mean=0.5033 norm_overlap=0.9965 corr_cb=-0.2068 topkJ=0.0154
[TRAIN][ep=047] loss=0.6301 acc=84.30%
[TRAIN][ep=047] mask_avg: mc_mean=0.2586 mb_mean=0.5023 norm_overlap=0.9969 corr_cb=-0.1611
[EPOCH 047/089] train: loss=0.6301 acc=84.30% | val: loss=0.6668 acc=69.88% f1=75.25% auc=75.47% val_score=56.0501 val_score_bestthr=69.2199 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.259, mb=0.502, no=0.997, corr=-0.161) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 69.2199
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.2734 mb_mean=0.5001 norm_overlap=0.9959 corr_cb=-0.2161 topkJ=0.0234
[TRAIN][ep=048] loss=0.5972 acc=85.50%
[TRAIN][ep=048] mask_avg: mc_mean=0.2438 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1490
[EPOCH 048/089] train: loss=0.5972 acc=85.50% | val: loss=0.7598 acc=68.67% f1=75.93% auc=75.93% val_score=65.7650 val_score_bestthr=71.1606 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.244, mb=0.502, no=0.997, corr=-0.149) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 71.1606
[DBG][ep=049] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.2375 mb_mean=0.4996 norm_overlap=0.9936 corr_cb=-0.3078 topkJ=0.0202
[TRAIN][ep=049] loss=0.6735 acc=80.00%
[TRAIN][ep=049] mask_avg: mc_mean=0.2251 mb_mean=0.5023 norm_overlap=0.9967 corr_cb=-0.1540
[EPOCH 049/089] train: loss=0.6735 acc=80.00% | val: loss=0.7053 acc=69.88% f1=77.06% auc=75.41% val_score=69.0388 val_score_bestthr=74.1280 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.225, mb=0.502, no=0.997, corr=-0.154) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 73.6277 -> 74.1280
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=050] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.2439 mb_mean=0.5034 norm_overlap=0.9942 corr_cb=-0.2717 topkJ=0.0097
[TRAIN][ep=050] loss=0.5932 acc=86.85%
[TRAIN][ep=050] mask_avg: mc_mean=0.2552 mb_mean=0.5023 norm_overlap=0.9964 corr_cb=-0.1806
[EPOCH 050/089] train: loss=0.5932 acc=86.85% | val: loss=0.6487 acc=71.08% f1=76.47% auc=75.00% val_score=62.5027 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.996, corr=-0.181) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=051] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.2077 mb_mean=0.5047 norm_overlap=1.0003 corr_cb=0.0136 topkJ=0.0683
[TRAIN][ep=051] loss=0.5816 acc=87.79%
[TRAIN][ep=051] mask_avg: mc_mean=0.2552 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1762
[EPOCH 051/089] train: loss=0.5816 acc=87.79% | val: loss=0.6508 acc=71.08% f1=76.47% auc=75.64% val_score=62.5027 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.997, corr=-0.176) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=052] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.2553 mb_mean=0.5020 norm_overlap=0.9954 corr_cb=-0.2366 topkJ=0.0357
[TRAIN][ep=052] loss=0.5736 acc=88.19%
[TRAIN][ep=052] mask_avg: mc_mean=0.2552 mb_mean=0.5023 norm_overlap=0.9964 corr_cb=-0.1789
[EPOCH 052/089] train: loss=0.5736 acc=88.19% | val: loss=0.6540 acc=71.08% f1=76.47% auc=75.81% val_score=61.7074 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.996, corr=-0.179) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=053] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.2714 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1874 topkJ=0.0260
[TRAIN][ep=053] loss=0.5757 acc=88.72%
[TRAIN][ep=053] mask_avg: mc_mean=0.2551 mb_mean=0.5023 norm_overlap=0.9964 corr_cb=-0.1796
[EPOCH 053/089] train: loss=0.5757 acc=88.72% | val: loss=0.6564 acc=71.08% f1=76.47% auc=75.52% val_score=61.7074 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.996, corr=-0.180) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=054] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=054] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=054] mask(step0): mc_mean=0.2630 mb_mean=0.5013 norm_overlap=0.9962 corr_cb=-0.1768 topkJ=0.0280
[TRAIN][ep=054] loss=0.5683 acc=87.92%
[TRAIN][ep=054] mask_avg: mc_mean=0.2552 mb_mean=0.5023 norm_overlap=0.9963 corr_cb=-0.1844
[EPOCH 054/089] train: loss=0.5683 acc=87.92% | val: loss=0.6627 acc=69.88% f1=75.73% auc=75.52% val_score=56.5112 val_score_bestthr=71.6269 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.996, corr=-0.184) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 71.6269
[DBG][ep=055] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=055] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=055] mask(step0): mc_mean=0.2602 mb_mean=0.5029 norm_overlap=0.9936 corr_cb=-0.3190 topkJ=0.0109
[TRAIN][ep=055] loss=0.5681 acc=88.19%
[TRAIN][ep=055] mask_avg: mc_mean=0.2552 mb_mean=0.5023 norm_overlap=0.9964 corr_cb=-0.1799
[EPOCH 055/089] train: loss=0.5681 acc=88.19% | val: loss=0.6659 acc=71.08% f1=76.47% auc=75.58% val_score=61.7074 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.996, corr=-0.180) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=056] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=056] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=056] mask(step0): mc_mean=0.2255 mb_mean=0.5009 norm_overlap=0.9960 corr_cb=-0.2305 topkJ=0.0297
[TRAIN][ep=056] loss=0.5658 acc=87.92%
[TRAIN][ep=056] mask_avg: mc_mean=0.2553 mb_mean=0.5023 norm_overlap=0.9964 corr_cb=-0.1810
[EPOCH 056/089] train: loss=0.5658 acc=87.92% | val: loss=0.6717 acc=69.88% f1=75.73% auc=75.70% val_score=56.5112 val_score_bestthr=71.6269 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.996, corr=-0.181) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 71.6269
[DBG][ep=057] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=057] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=057] mask(step0): mc_mean=0.2724 mb_mean=0.5026 norm_overlap=0.9966 corr_cb=-0.1947 topkJ=0.0300
[TRAIN][ep=057] loss=0.5625 acc=88.32%
[TRAIN][ep=057] mask_avg: mc_mean=0.2552 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1775
[EPOCH 057/089] train: loss=0.5625 acc=88.32% | val: loss=0.6763 acc=69.88% f1=75.73% auc=75.52% val_score=53.8555 val_score_bestthr=71.6269 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.996, corr=-0.177) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 71.6269
[DBG][ep=058] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=058] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=058] mask(step0): mc_mean=0.2144 mb_mean=0.5051 norm_overlap=0.9967 corr_cb=-0.1970 topkJ=0.0337
[TRAIN][ep=058] loss=0.5621 acc=87.79%
[TRAIN][ep=058] mask_avg: mc_mean=0.2552 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1761
[EPOCH 058/089] train: loss=0.5621 acc=87.79% | val: loss=0.6749 acc=71.08% f1=76.47% auc=75.70% val_score=61.0754 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.997, corr=-0.176) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=059] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=059] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=059] mask(step0): mc_mean=0.2821 mb_mean=0.4997 norm_overlap=0.9957 corr_cb=-0.2311 topkJ=0.0429
[TRAIN][ep=059] loss=0.5586 acc=88.86%
[TRAIN][ep=059] mask_avg: mc_mean=0.2552 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1783
[EPOCH 059/089] train: loss=0.5586 acc=88.86% | val: loss=0.6827 acc=71.08% f1=76.47% auc=75.76% val_score=60.3488 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.996, corr=-0.178) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=060] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=060] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=060] mask(step0): mc_mean=0.2776 mb_mean=0.4999 norm_overlap=0.9955 corr_cb=-0.2541 topkJ=0.0162
[TRAIN][ep=060] loss=0.5598 acc=89.40%
[TRAIN][ep=060] mask_avg: mc_mean=0.2552 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1783
[EPOCH 060/089] train: loss=0.5598 acc=89.40% | val: loss=0.6814 acc=71.08% f1=76.47% auc=75.81% val_score=61.0754 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.996, corr=-0.178) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=061] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=061] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=061] mask(step0): mc_mean=0.2814 mb_mean=0.5016 norm_overlap=0.9893 corr_cb=-0.4351 topkJ=0.0071
[TRAIN][ep=061] loss=0.5567 acc=88.99%
[TRAIN][ep=061] mask_avg: mc_mean=0.2552 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1777
[EPOCH 061/089] train: loss=0.5567 acc=88.99% | val: loss=0.6870 acc=71.08% f1=76.47% auc=75.58% val_score=61.0754 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.996, corr=-0.178) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=062] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=062] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=062] mask(step0): mc_mean=0.2784 mb_mean=0.5002 norm_overlap=0.9963 corr_cb=-0.2188 topkJ=0.0266
[TRAIN][ep=062] loss=0.5575 acc=87.92%
[TRAIN][ep=062] mask_avg: mc_mean=0.2552 mb_mean=0.5023 norm_overlap=0.9964 corr_cb=-0.1781
[EPOCH 062/089] train: loss=0.5575 acc=87.92% | val: loss=0.6872 acc=71.08% f1=76.47% auc=75.70% val_score=61.7074 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.996, corr=-0.178) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=063] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=063] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=063] mask(step0): mc_mean=0.2471 mb_mean=0.5036 norm_overlap=0.9963 corr_cb=-0.1731 topkJ=0.0219
[TRAIN][ep=063] loss=0.5659 acc=86.98%
[TRAIN][ep=063] mask_avg: mc_mean=0.2552 mb_mean=0.5023 norm_overlap=0.9964 corr_cb=-0.1841
[EPOCH 063/089] train: loss=0.5659 acc=86.98% | val: loss=0.6900 acc=69.88% f1=75.73% auc=75.23% val_score=61.7074 val_score_bestthr=71.6631 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.996, corr=-0.184) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 71.6631
[DBG][ep=064] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=064] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=064] mask(step0): mc_mean=0.2551 mb_mean=0.5016 norm_overlap=0.9953 corr_cb=-0.2102 topkJ=0.0374
[TRAIN][ep=064] loss=0.5508 acc=88.99%
[TRAIN][ep=064] mask_avg: mc_mean=0.2552 mb_mean=0.5023 norm_overlap=0.9964 corr_cb=-0.1812
[EPOCH 064/089] train: loss=0.5508 acc=88.99% | val: loss=0.6952 acc=69.88% f1=75.73% auc=75.23% val_score=61.7074 val_score_bestthr=71.6631 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.996, corr=-0.181) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 71.6631
[DBG][ep=065] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=065] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=065] mask(step0): mc_mean=0.2081 mb_mean=0.5027 norm_overlap=0.9955 corr_cb=-0.2260 topkJ=0.0263
[TRAIN][ep=065] loss=0.5534 acc=88.86%
[TRAIN][ep=065] mask_avg: mc_mean=0.2552 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1777
[EPOCH 065/089] train: loss=0.5534 acc=88.86% | val: loss=0.6949 acc=69.88% f1=75.73% auc=75.35% val_score=61.0754 val_score_bestthr=71.6631 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.996, corr=-0.178) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 71.6631
[DBG][ep=066] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=066] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=066] mask(step0): mc_mean=0.2260 mb_mean=0.5044 norm_overlap=0.9961 corr_cb=-0.2192 topkJ=0.0304
[TRAIN][ep=066] loss=0.5497 acc=88.99%
[TRAIN][ep=066] mask_avg: mc_mean=0.2552 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1766
[EPOCH 066/089] train: loss=0.5497 acc=88.99% | val: loss=0.7125 acc=71.08% f1=76.47% auc=75.87% val_score=58.9067 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.996, corr=-0.177) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=067] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=067] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=067] mask(step0): mc_mean=0.2551 mb_mean=0.4998 norm_overlap=0.9982 corr_cb=-0.0805 topkJ=0.0463
[TRAIN][ep=067] loss=0.5493 acc=89.40%
[TRAIN][ep=067] mask_avg: mc_mean=0.2552 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1762
[EPOCH 067/089] train: loss=0.5493 acc=89.40% | val: loss=0.7061 acc=68.67% f1=75.93% auc=75.41% val_score=56.1793 val_score_bestthr=71.1606 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.996, corr=-0.176) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 71.1606
[DBG][ep=068] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=068] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=068] mask(step0): mc_mean=0.2441 mb_mean=0.5046 norm_overlap=0.9933 corr_cb=-0.3246 topkJ=0.0275
[TRAIN][ep=068] loss=0.5452 acc=87.79%
[TRAIN][ep=068] mask_avg: mc_mean=0.2552 mb_mean=0.5023 norm_overlap=0.9964 corr_cb=-0.1800
[EPOCH 068/089] train: loss=0.5452 acc=87.79% | val: loss=0.7096 acc=71.08% f1=76.47% auc=75.41% val_score=61.7074 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.996, corr=-0.180) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=069] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=069] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=069] mask(step0): mc_mean=0.2827 mb_mean=0.5008 norm_overlap=0.9983 corr_cb=-0.0891 topkJ=0.0398
[TRAIN][ep=069] loss=0.5438 acc=88.72%
[TRAIN][ep=069] mask_avg: mc_mean=0.2551 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1765
[EPOCH 069/089] train: loss=0.5438 acc=88.72% | val: loss=0.7150 acc=68.67% f1=75.00% auc=75.12% val_score=54.1474 val_score_bestthr=71.0991 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.996, corr=-0.177) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 71.0991
[DBG][ep=070] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=070] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=070] mask(step0): mc_mean=0.2471 mb_mean=0.5018 norm_overlap=0.9975 corr_cb=-0.1170 topkJ=0.0620
[TRAIN][ep=070] loss=0.5430 acc=88.99%
[TRAIN][ep=070] mask_avg: mc_mean=0.2552 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1772
[EPOCH 070/089] train: loss=0.5430 acc=88.99% | val: loss=0.7276 acc=71.08% f1=76.47% auc=75.70% val_score=63.4537 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.996, corr=-0.177) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=071] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=071] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=071] mask(step0): mc_mean=0.2489 mb_mean=0.5030 norm_overlap=0.9942 corr_cb=-0.3041 topkJ=0.0132
[TRAIN][ep=071] loss=0.5441 acc=89.13%
[TRAIN][ep=071] mask_avg: mc_mean=0.2552 mb_mean=0.5023 norm_overlap=0.9964 corr_cb=-0.1777
[EPOCH 071/089] train: loss=0.5441 acc=89.13% | val: loss=0.7132 acc=69.88% f1=76.64% auc=75.29% val_score=59.3108 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.996, corr=-0.178) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.2690
[DBG][ep=072] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=072] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=072] mask(step0): mc_mean=0.2671 mb_mean=0.5026 norm_overlap=0.9965 corr_cb=-0.1973 topkJ=0.0194
[TRAIN][ep=072] loss=0.5440 acc=88.32%
[TRAIN][ep=072] mask_avg: mc_mean=0.2551 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1776
[EPOCH 072/089] train: loss=0.5440 acc=88.32% | val: loss=0.7136 acc=69.88% f1=76.64% auc=75.23% val_score=61.0754 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.996, corr=-0.178) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.2690
[DBG][ep=073] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=073] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=073] mask(step0): mc_mean=0.2346 mb_mean=0.5011 norm_overlap=0.9989 corr_cb=-0.0688 topkJ=0.0688
[TRAIN][ep=073] loss=0.5415 acc=89.26%
[TRAIN][ep=073] mask_avg: mc_mean=0.2552 mb_mean=0.5023 norm_overlap=0.9964 corr_cb=-0.1794
[EPOCH 073/089] train: loss=0.5415 acc=89.26% | val: loss=0.7258 acc=68.67% f1=75.93% auc=75.17% val_score=54.1474 val_score_bestthr=71.1606 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.996, corr=-0.179) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 71.1606
[DBG][ep=074] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=074] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=074] mask(step0): mc_mean=0.2276 mb_mean=0.5028 norm_overlap=0.9960 corr_cb=-0.2040 topkJ=0.0218
[TRAIN][ep=074] loss=0.5429 acc=87.92%
[TRAIN][ep=074] mask_avg: mc_mean=0.2553 mb_mean=0.5023 norm_overlap=0.9964 corr_cb=-0.1806
[EPOCH 074/089] train: loss=0.5429 acc=87.92% | val: loss=0.7194 acc=69.88% f1=76.64% auc=75.17% val_score=61.0754 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.996, corr=-0.181) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.2690
[DBG][ep=075] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=075] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=075] mask(step0): mc_mean=0.3160 mb_mean=0.5013 norm_overlap=0.9930 corr_cb=-0.3634 topkJ=0.0064
[TRAIN][ep=075] loss=0.5440 acc=88.72%
[TRAIN][ep=075] mask_avg: mc_mean=0.2552 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1767
[EPOCH 075/089] train: loss=0.5440 acc=88.72% | val: loss=0.7202 acc=69.88% f1=76.64% auc=75.23% val_score=61.0754 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.996, corr=-0.177) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.2690
[DBG][ep=076] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=076] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=076] mask(step0): mc_mean=0.2107 mb_mean=0.5030 norm_overlap=0.9991 corr_cb=-0.0461 topkJ=0.0575
[TRAIN][ep=076] loss=0.5432 acc=88.32%
[TRAIN][ep=076] mask_avg: mc_mean=0.2552 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1778
[EPOCH 076/089] train: loss=0.5432 acc=88.32% | val: loss=0.7212 acc=69.88% f1=76.64% auc=75.41% val_score=61.0754 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.996, corr=-0.178) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.2690
[DBG][ep=077] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=077] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=077] mask(step0): mc_mean=0.2316 mb_mean=0.5034 norm_overlap=0.9945 corr_cb=-0.2908 topkJ=0.0165
[TRAIN][ep=077] loss=0.5384 acc=88.86%
[TRAIN][ep=077] mask_avg: mc_mean=0.2551 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1784
[EPOCH 077/089] train: loss=0.5384 acc=88.86% | val: loss=0.7306 acc=68.67% f1=75.93% auc=75.29% val_score=60.4330 val_score_bestthr=71.1606 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.996, corr=-0.178) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 71.1606
[DBG][ep=078] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=078] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=078] mask(step0): mc_mean=0.2472 mb_mean=0.5031 norm_overlap=0.9973 corr_cb=-0.1098 topkJ=0.0377
[TRAIN][ep=078] loss=0.5357 acc=88.59%
[TRAIN][ep=078] mask_avg: mc_mean=0.2552 mb_mean=0.5023 norm_overlap=0.9964 corr_cb=-0.1807
[EPOCH 078/089] train: loss=0.5357 acc=88.59% | val: loss=0.7311 acc=68.67% f1=75.93% auc=74.94% val_score=61.0754 val_score_bestthr=71.1606 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.996, corr=-0.181) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 71.1606
[DBG][ep=079] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=079] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=079] mask(step0): mc_mean=0.2706 mb_mean=0.4999 norm_overlap=0.9963 corr_cb=-0.1991 topkJ=0.0442
[TRAIN][ep=079] loss=0.5321 acc=89.66%
[TRAIN][ep=079] mask_avg: mc_mean=0.2553 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1778
[EPOCH 079/089] train: loss=0.5321 acc=89.66% | val: loss=0.7505 acc=69.88% f1=76.64% auc=75.23% val_score=63.4537 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.996, corr=-0.178) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.2690
[EARLY STOP] no improvement for 30 epochs. best_epoch=49
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
=============== FIT DONE ===============
[BEST] epoch=49 | val_acc=69.88% | val_f1=77.06% | val_auc=75.41% | val_score=69.0388 | val_score_bestthr=74.1280
[TEST@BEST] thr_used=0.475 | acc=63.29% f1=69.35% auc=62.97% | SP_sex=0.03% EO_sex=3.75% SP_age=12.41% EO_age=6.49%
[TIME] 1.63 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/summary_fold_0.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5259 mb_mean=0.5010 norm_overlap=0.9999 corr_cb=-0.0912 topkJ=0.0676
[TRAIN][ep=000] loss=0.6939 acc=50.47%
[TRAIN][ep=000] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0996
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5274 mb_mean=0.4997 norm_overlap=0.9999 corr_cb=-0.2567 topkJ=0.0254
[TRAIN][ep=001] loss=0.6920 acc=50.47%
[TRAIN][ep=001] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0926
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5297 mb_mean=0.5053 norm_overlap=1.0000 corr_cb=0.0154 topkJ=0.0969
[TRAIN][ep=002] loss=0.6899 acc=52.89%
[TRAIN][ep=002] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0983
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5296 mb_mean=0.5000 norm_overlap=0.9999 corr_cb=-0.1407 topkJ=0.0490
[TRAIN][ep=003] loss=0.6882 acc=54.23%
[TRAIN][ep=003] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0952
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5295 mb_mean=0.4987 norm_overlap=0.9999 corr_cb=-0.1840 topkJ=0.0339
[TRAIN][ep=004] loss=0.6887 acc=53.42%
[TRAIN][ep=004] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.1002
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5288 mb_mean=0.5009 norm_overlap=0.9999 corr_cb=-0.1690 topkJ=0.0368
[TRAIN][ep=005] loss=0.6834 acc=56.91%
[TRAIN][ep=005] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0988
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5323 mb_mean=0.5018 norm_overlap=0.9999 corr_cb=-0.2431 topkJ=0.0234
[TRAIN][ep=006] loss=0.6844 acc=54.63%
[TRAIN][ep=006] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0978
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5339 mb_mean=0.5021 norm_overlap=1.0000 corr_cb=-0.0185 topkJ=0.0321
[TRAIN][ep=007] loss=0.6826 acc=57.72%
[TRAIN][ep=007] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0955
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5308 mb_mean=0.5020 norm_overlap=1.0000 corr_cb=-0.0361 topkJ=0.0444
[TRAIN][ep=008] loss=0.6776 acc=58.12%
[TRAIN][ep=008] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0938
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5248 mb_mean=0.5048 norm_overlap=0.9999 corr_cb=-0.0945 topkJ=0.0690
[TRAIN][ep=009] loss=0.6759 acc=58.93%
[TRAIN][ep=009] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0965
================= FIT START (fold=0) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5327 mb_mean=0.5004 norm_overlap=1.0000 corr_cb=-0.0395 topkJ=0.0304
[TRAIN][ep=000] loss=0.6709 acc=61.48%
[TRAIN][ep=000] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0992
[EPOCH 000/089] train: loss=0.6709 acc=61.48% | val: loss=0.6686 acc=62.65% f1=69.31% auc=65.87% val_score=63.8688 val_score_bestthr=64.9727 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.099) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 64.9727
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5321 mb_mean=0.5010 norm_overlap=0.9998 corr_cb=-0.3401 topkJ=0.0082
[TRAIN][ep=001] loss=0.6667 acc=61.34%
[TRAIN][ep=001] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0976
[EPOCH 001/089] train: loss=0.6667 acc=61.34% | val: loss=0.6664 acc=61.45% f1=68.63% auc=65.58% val_score=50.8549 val_score_bestthr=63.8688 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.098) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9727 -> 63.8688
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5308 mb_mean=0.5031 norm_overlap=1.0000 corr_cb=-0.0851 topkJ=0.0316
[TRAIN][ep=002] loss=0.6610 acc=60.94%
[TRAIN][ep=002] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0965
[EPOCH 002/089] train: loss=0.6610 acc=60.94% | val: loss=0.6768 acc=56.63% f1=64.71% auc=64.19% val_score=48.1618 val_score_bestthr=58.9427 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.097) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9727 -> 58.9427
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5303 mb_mean=0.5028 norm_overlap=1.0000 corr_cb=0.0572 topkJ=0.0336
[TRAIN][ep=003] loss=0.6553 acc=64.43%
[TRAIN][ep=003] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0987
[EPOCH 003/089] train: loss=0.6553 acc=64.43% | val: loss=0.6567 acc=62.65% f1=69.31% auc=66.74% val_score=50.8414 val_score_bestthr=64.9727 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.099) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9727 -> 64.9727
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5315 mb_mean=0.5048 norm_overlap=1.0000 corr_cb=-0.0454 topkJ=0.0668
[TRAIN][ep=004] loss=0.6487 acc=65.10%
[TRAIN][ep=004] mask_avg: mc_mean=0.5292 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0985
[EPOCH 004/089] train: loss=0.6487 acc=65.10% | val: loss=0.6513 acc=62.65% f1=69.31% auc=67.73% val_score=56.4760 val_score_bestthr=64.9727 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.099) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9727 -> 64.9727
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5300 mb_mean=0.5015 norm_overlap=0.9999 corr_cb=-0.2288 topkJ=0.0177
[TRAIN][ep=005] loss=1.5342 acc=64.83%
[TRAIN][ep=005] mask_avg: mc_mean=0.3812 mb_mean=0.5023 norm_overlap=1.0007 corr_cb=0.1903
[EPOCH 005/089] train: loss=1.5342 acc=64.83% | val: loss=0.6496 acc=62.65% f1=72.07% auc=71.22% val_score=56.2554 val_score_bestthr=61.8131 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.381, mb=0.502, no=1.001, corr=0.190) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9727 -> 61.8131
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2811 mb_mean=0.5013 norm_overlap=1.0021 corr_cb=0.3844 topkJ=0.1305
[TRAIN][ep=006] loss=1.2419 acc=65.91%
[TRAIN][ep=006] mask_avg: mc_mean=0.2542 mb_mean=0.5023 norm_overlap=1.0013 corr_cb=0.1880
[EPOCH 006/089] train: loss=1.2419 acc=65.91% | val: loss=0.6397 acc=62.65% f1=71.03% auc=71.92% val_score=61.3612 val_score_bestthr=64.7322 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.254, mb=0.502, no=1.001, corr=0.188) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9727 -> 64.7322
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2305 mb_mean=0.5027 norm_overlap=1.0018 corr_cb=0.2149 topkJ=0.0734
[TRAIN][ep=007] loss=0.9798 acc=65.37%
[TRAIN][ep=007] mask_avg: mc_mean=0.2250 mb_mean=0.5023 norm_overlap=1.0013 corr_cb=0.1486
[EPOCH 007/089] train: loss=0.9798 acc=65.37% | val: loss=0.6327 acc=62.65% f1=72.57% auc=72.44% val_score=59.6608 val_score_bestthr=67.1797 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.040, stage2=False) | mask(mc=0.225, mb=0.502, no=1.001, corr=0.149) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 64.9727 -> 67.1797
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2211 mb_mean=0.5013 norm_overlap=1.0006 corr_cb=0.0633 topkJ=0.0724
[TRAIN][ep=008] loss=1.0702 acc=68.05%
[TRAIN][ep=008] mask_avg: mc_mean=0.2104 mb_mean=0.5023 norm_overlap=1.0010 corr_cb=0.1104
[EPOCH 008/089] train: loss=1.0702 acc=68.05% | val: loss=0.6497 acc=65.06% f1=70.10% auc=69.71% val_score=50.8167 val_score_bestthr=62.1649 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.080, stage2=False) | mask(mc=0.210, mb=0.502, no=1.001, corr=0.110) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.1797 -> 62.1649
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2070 mb_mean=0.5024 norm_overlap=1.0004 corr_cb=0.0365 topkJ=0.0732
[TRAIN][ep=009] loss=1.1766 acc=66.17%
[TRAIN][ep=009] mask_avg: mc_mean=0.1889 mb_mean=0.5023 norm_overlap=1.0009 corr_cb=0.0874
[EPOCH 009/089] train: loss=1.1766 acc=66.17% | val: loss=0.6433 acc=66.27% f1=73.58% auc=73.37% val_score=65.7793 val_score_bestthr=66.3266 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.120, stage2=False) | mask(mc=0.189, mb=0.502, no=1.001, corr=0.087) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.1797 -> 66.3266
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1949 mb_mean=0.5010 norm_overlap=1.0013 corr_cb=0.1438 topkJ=0.0745
[TRAIN][ep=010] loss=1.2714 acc=65.77%
[TRAIN][ep=010] mask_avg: mc_mean=0.1920 mb_mean=0.5023 norm_overlap=1.0006 corr_cb=0.0456
[EPOCH 010/089] train: loss=1.2714 acc=65.77% | val: loss=0.6232 acc=63.86% f1=73.68% auc=73.43% val_score=58.4938 val_score_bestthr=66.8001 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.160, stage2=False) | mask(mc=0.192, mb=0.502, no=1.001, corr=0.046) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.1797 -> 66.8001
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1882 mb_mean=0.5027 norm_overlap=0.9979 corr_cb=-0.1985 topkJ=0.0551
[TRAIN][ep=011] loss=1.3491 acc=70.87%
[TRAIN][ep=011] mask_avg: mc_mean=0.1850 mb_mean=0.5023 norm_overlap=1.0002 corr_cb=0.0152
[EPOCH 011/089] train: loss=1.3491 acc=70.87% | val: loss=0.6131 acc=63.86% f1=72.73% auc=75.93% val_score=61.5955 val_score_bestthr=67.2118 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.185, mb=0.502, no=1.000, corr=0.015) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 67.1797 -> 67.2118
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1772 mb_mean=0.5005 norm_overlap=1.0001 corr_cb=0.0055 topkJ=0.1122
[TRAIN][ep=012] loss=1.4534 acc=69.13%
[TRAIN][ep=012] mask_avg: mc_mean=0.1802 mb_mean=0.5023 norm_overlap=0.9998 corr_cb=-0.0146
[EPOCH 012/089] train: loss=1.4534 acc=69.13% | val: loss=0.6714 acc=59.04% f1=70.18% auc=71.34% val_score=50.4880 val_score_bestthr=60.2729 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.180, mb=0.502, no=1.000, corr=-0.015) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.2118 -> 60.2729
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1921 mb_mean=0.5050 norm_overlap=0.9989 corr_cb=-0.0893 topkJ=0.0735
[TRAIN][ep=013] loss=1.4469 acc=69.26%
[TRAIN][ep=013] mask_avg: mc_mean=0.1691 mb_mean=0.5023 norm_overlap=0.9996 corr_cb=-0.0316
[EPOCH 013/089] train: loss=1.4469 acc=69.26% | val: loss=0.6206 acc=71.08% f1=70.00% auc=75.23% val_score=51.6655 val_score_bestthr=64.6065 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.169, mb=0.502, no=1.000, corr=-0.032) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.2118 -> 64.6065
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1601 mb_mean=0.4973 norm_overlap=1.0001 corr_cb=0.0054 topkJ=0.0579
[TRAIN][ep=014] loss=1.4324 acc=71.14%
[TRAIN][ep=014] mask_avg: mc_mean=0.1878 mb_mean=0.5023 norm_overlap=0.9991 corr_cb=-0.0658
[EPOCH 014/089] train: loss=1.4324 acc=71.14% | val: loss=0.5883 acc=62.65% f1=73.50% auc=76.10% val_score=58.7799 val_score_bestthr=69.0204 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.188, mb=0.502, no=0.999, corr=-0.066) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 67.2118 -> 69.0204
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1608 mb_mean=0.5022 norm_overlap=1.0002 corr_cb=0.0157 topkJ=0.0646
[TRAIN][ep=015] loss=1.4513 acc=69.93%
[TRAIN][ep=015] mask_avg: mc_mean=0.1921 mb_mean=0.5023 norm_overlap=0.9988 corr_cb=-0.0862
[EPOCH 015/089] train: loss=1.4513 acc=69.93% | val: loss=0.5849 acc=65.06% f1=72.38% auc=78.72% val_score=61.2400 val_score_bestthr=66.8004 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.192, mb=0.502, no=0.999, corr=-0.086) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.0204 -> 66.8004
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1789 mb_mean=0.5002 norm_overlap=0.9991 corr_cb=-0.0719 topkJ=0.0446
[TRAIN][ep=016] loss=1.4385 acc=70.47%
[TRAIN][ep=016] mask_avg: mc_mean=0.1937 mb_mean=0.5023 norm_overlap=0.9984 corr_cb=-0.1104
[EPOCH 016/089] train: loss=1.4385 acc=70.47% | val: loss=0.5754 acc=74.70% f1=72.73% auc=78.37% val_score=68.0866 val_score_bestthr=68.0866 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.194, mb=0.502, no=0.998, corr=-0.110) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.0204 -> 68.0866
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.2258 mb_mean=0.5033 norm_overlap=0.9968 corr_cb=-0.2047 topkJ=0.0219
[TRAIN][ep=017] loss=1.4284 acc=71.14%
[TRAIN][ep=017] mask_avg: mc_mean=0.2065 mb_mean=0.5023 norm_overlap=0.9983 corr_cb=-0.1165
[EPOCH 017/089] train: loss=1.4284 acc=71.14% | val: loss=0.5832 acc=67.47% f1=73.27% auc=78.14% val_score=63.8330 val_score_bestthr=67.0451 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.206, mb=0.502, no=0.998, corr=-0.116) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.0204 -> 67.0451
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1891 mb_mean=0.5025 norm_overlap=0.9988 corr_cb=-0.0762 topkJ=0.0475
[TRAIN][ep=018] loss=1.4099 acc=71.68%
[TRAIN][ep=018] mask_avg: mc_mean=0.1997 mb_mean=0.5023 norm_overlap=0.9983 corr_cb=-0.1046
[EPOCH 018/089] train: loss=1.4099 acc=71.68% | val: loss=0.6044 acc=63.86% f1=74.14% auc=79.01% val_score=63.5930 val_score_bestthr=68.8312 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.200, mb=0.502, no=0.998, corr=-0.105) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.0204 -> 68.8312
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1552 mb_mean=0.5022 norm_overlap=0.9967 corr_cb=-0.2114 topkJ=0.0522
[TRAIN][ep=019] loss=1.4000 acc=72.62%
[TRAIN][ep=019] mask_avg: mc_mean=0.1952 mb_mean=0.5023 norm_overlap=0.9982 corr_cb=-0.1080
[EPOCH 019/089] train: loss=1.4000 acc=72.62% | val: loss=0.5609 acc=74.70% f1=72.73% auc=78.60% val_score=65.3216 val_score_bestthr=68.0866 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.195, mb=0.502, no=0.998, corr=-0.108) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.0204 -> 68.0866
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.2285 mb_mean=0.5020 norm_overlap=0.9987 corr_cb=-0.0666 topkJ=0.0857
[TRAIN][ep=020] loss=1.1422 acc=73.02%
[TRAIN][ep=020] mask_avg: mc_mean=0.1999 mb_mean=0.5023 norm_overlap=0.9982 corr_cb=-0.1076
[EPOCH 020/089] train: loss=1.1422 acc=73.02% | val: loss=0.5780 acc=74.70% f1=72.00% auc=76.51% val_score=66.6390 val_score_bestthr=69.4062 | dyn(w_pfs=0.290, w_sup=0.190, w_csuf=0.140, stage2=False) | mask(mc=0.200, mb=0.502, no=0.998, corr=-0.108) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 69.0204 -> 69.4062
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2266 mb_mean=0.5058 norm_overlap=0.9978 corr_cb=-0.1308 topkJ=0.0352
[TRAIN][ep=021] loss=1.2530 acc=71.95%
[TRAIN][ep=021] mask_avg: mc_mean=0.2028 mb_mean=0.5023 norm_overlap=0.9981 corr_cb=-0.1111
[EPOCH 021/089] train: loss=1.2530 acc=71.95% | val: loss=0.5618 acc=74.70% f1=72.00% auc=78.02% val_score=68.0866 val_score_bestthr=69.4062 | dyn(w_pfs=0.330, w_sup=0.230, w_csuf=0.180, stage2=False) | mask(mc=0.203, mb=0.502, no=0.998, corr=-0.111) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.4062 -> 69.4062
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2526 mb_mean=0.4996 norm_overlap=0.9989 corr_cb=-0.0636 topkJ=0.0364
[TRAIN][ep=022] loss=1.3211 acc=73.83%
[TRAIN][ep=022] mask_avg: mc_mean=0.2259 mb_mean=0.5023 norm_overlap=0.9978 corr_cb=-0.1380
[EPOCH 022/089] train: loss=1.3211 acc=73.83% | val: loss=0.5584 acc=75.90% f1=74.36% auc=77.97% val_score=69.4062 val_score_bestthr=68.9443 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.226, mb=0.502, no=0.998, corr=-0.138) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.4062 -> 68.9443
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1362 mb_mean=0.5023 norm_overlap=0.9979 corr_cb=-0.1071 topkJ=0.0271
[TRAIN][ep=023] loss=1.3525 acc=74.77%
[TRAIN][ep=023] mask_avg: mc_mean=0.2128 mb_mean=0.5023 norm_overlap=0.9980 corr_cb=-0.1148
[EPOCH 023/089] train: loss=1.3525 acc=74.77% | val: loss=0.5722 acc=75.90% f1=72.97% auc=77.79% val_score=64.4160 val_score_bestthr=72.1773 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.213, mb=0.502, no=0.998, corr=-0.115) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 69.4062 -> 72.1773
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2167 mb_mean=0.5016 norm_overlap=0.9970 corr_cb=-0.1816 topkJ=0.0469
[TRAIN][ep=024] loss=1.3790 acc=72.48%
[TRAIN][ep=024] mask_avg: mc_mean=0.2152 mb_mean=0.5023 norm_overlap=0.9980 corr_cb=-0.1157
[EPOCH 024/089] train: loss=1.3790 acc=72.48% | val: loss=0.5432 acc=75.90% f1=74.36% auc=79.42% val_score=62.8550 val_score_bestthr=71.3284 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.215, mb=0.502, no=0.998, corr=-0.116) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1773 -> 71.3284
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1793 mb_mean=0.4998 norm_overlap=1.0004 corr_cb=0.0179 topkJ=0.0535
[TRAIN][ep=025] loss=1.3444 acc=75.70%
[TRAIN][ep=025] mask_avg: mc_mean=0.1965 mb_mean=0.5023 norm_overlap=0.9981 corr_cb=-0.1039
[EPOCH 025/089] train: loss=1.3444 acc=75.70% | val: loss=0.5518 acc=77.11% f1=74.67% auc=78.31% val_score=68.2341 val_score_bestthr=73.6277 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.197, mb=0.502, no=0.998, corr=-0.104) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 72.1773 -> 73.6277
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2288 mb_mean=0.5001 norm_overlap=0.9972 corr_cb=-0.1814 topkJ=0.0178
[TRAIN][ep=026] loss=1.3355 acc=75.70%
[TRAIN][ep=026] mask_avg: mc_mean=0.2196 mb_mean=0.5023 norm_overlap=0.9980 corr_cb=-0.1122
[EPOCH 026/089] train: loss=1.3355 acc=75.70% | val: loss=0.5401 acc=78.31% f1=77.50% auc=79.77% val_score=54.8474 val_score_bestthr=72.6051 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.220, mb=0.502, no=0.998, corr=-0.112) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 72.6051
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1665 mb_mean=0.5032 norm_overlap=0.9974 corr_cb=-0.1453 topkJ=0.0376
[TRAIN][ep=027] loss=1.3166 acc=75.97%
[TRAIN][ep=027] mask_avg: mc_mean=0.2187 mb_mean=0.5023 norm_overlap=0.9979 corr_cb=-0.1147
[EPOCH 027/089] train: loss=1.3166 acc=75.97% | val: loss=0.5823 acc=73.49% f1=72.50% auc=77.73% val_score=64.4158 val_score_bestthr=68.2341 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.219, mb=0.502, no=0.998, corr=-0.115) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 68.2341
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2055 mb_mean=0.5016 norm_overlap=1.0000 corr_cb=0.0028 topkJ=0.0506
[TRAIN][ep=028] loss=1.3047 acc=78.12%
[TRAIN][ep=028] mask_avg: mc_mean=0.2209 mb_mean=0.5023 norm_overlap=0.9981 corr_cb=-0.1032
[EPOCH 028/089] train: loss=1.3047 acc=78.12% | val: loss=0.5459 acc=77.11% f1=75.95% auc=78.72% val_score=64.0724 val_score_bestthr=72.4213 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.221, mb=0.502, no=0.998, corr=-0.103) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 72.4213
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2171 mb_mean=0.5039 norm_overlap=0.9985 corr_cb=-0.0869 topkJ=0.0718
[TRAIN][ep=029] loss=1.3160 acc=77.99%
[TRAIN][ep=029] mask_avg: mc_mean=0.2274 mb_mean=0.5023 norm_overlap=0.9979 corr_cb=-0.1139
[EPOCH 029/089] train: loss=1.3160 acc=77.99% | val: loss=0.5468 acc=74.70% f1=72.00% auc=80.70% val_score=68.0011 val_score_bestthr=70.6236 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.227, mb=0.502, no=0.998, corr=-0.114) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 70.6236
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.1429 mb_mean=0.5015 norm_overlap=0.9979 corr_cb=-0.1022 topkJ=0.0325
[TRAIN][ep=030] loss=1.3093 acc=77.32%
[TRAIN][ep=030] mask_avg: mc_mean=0.2237 mb_mean=0.5023 norm_overlap=0.9978 corr_cb=-0.1185
[EPOCH 030/089] train: loss=1.3093 acc=77.32% | val: loss=0.5820 acc=71.08% f1=75.00% auc=79.71% val_score=64.4158 val_score_bestthr=73.4125 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.224, mb=0.502, no=0.998, corr=-0.119) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 73.4125
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2931 mb_mean=0.5032 norm_overlap=0.9984 corr_cb=-0.1142 topkJ=0.0401
[TRAIN][ep=031] loss=1.0623 acc=77.85%
[TRAIN][ep=031] mask_avg: mc_mean=0.2254 mb_mean=0.5023 norm_overlap=0.9975 corr_cb=-0.1359
[EPOCH 031/089] train: loss=1.0623 acc=77.85% | val: loss=0.5664 acc=73.49% f1=72.50% auc=78.55% val_score=62.8147 val_score_bestthr=68.2341 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.225, mb=0.502, no=0.997, corr=-0.136) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 68.2341
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2185 mb_mean=0.5001 norm_overlap=0.9951 corr_cb=-0.2447 topkJ=0.0352
[TRAIN][ep=032] loss=0.8140 acc=78.52%
[TRAIN][ep=032] mask_avg: mc_mean=0.2164 mb_mean=0.5023 norm_overlap=0.9973 corr_cb=-0.1373
[EPOCH 032/089] train: loss=0.8140 acc=78.52% | val: loss=0.5570 acc=68.67% f1=75.93% auc=79.07% val_score=51.1842 val_score_bestthr=68.2387 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.216, mb=0.502, no=0.997, corr=-0.137) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 68.2387
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1925 mb_mean=0.5007 norm_overlap=0.9989 corr_cb=-0.0655 topkJ=0.0681
[TRAIN][ep=033] loss=0.7273 acc=78.79%
[TRAIN][ep=033] mask_avg: mc_mean=0.2142 mb_mean=0.5023 norm_overlap=0.9974 corr_cb=-0.1298
[EPOCH 033/089] train: loss=0.7273 acc=78.79% | val: loss=0.5516 acc=68.67% f1=75.93% auc=79.19% val_score=62.9462 val_score_bestthr=68.2387 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.214, mb=0.502, no=0.997, corr=-0.130) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 68.2387
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2686 mb_mean=0.5049 norm_overlap=0.9961 corr_cb=-0.2195 topkJ=0.0252
[TRAIN][ep=034] loss=0.7146 acc=78.79%
[TRAIN][ep=034] mask_avg: mc_mean=0.2356 mb_mean=0.5023 norm_overlap=0.9974 corr_cb=-0.1382
[EPOCH 034/089] train: loss=0.7146 acc=78.79% | val: loss=0.6028 acc=69.88% f1=75.25% auc=79.59% val_score=65.7650 val_score_bestthr=69.0388 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.236, mb=0.502, no=0.997, corr=-0.138) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 69.0388
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2943 mb_mean=0.5025 norm_overlap=0.9953 corr_cb=-0.2150 topkJ=0.0252
[TRAIN][ep=035] loss=0.6989 acc=80.54%
[TRAIN][ep=035] mask_avg: mc_mean=0.2603 mb_mean=0.5023 norm_overlap=0.9971 corr_cb=-0.1621
[EPOCH 035/089] train: loss=0.6989 acc=80.54% | val: loss=0.5692 acc=68.67% f1=75.93% auc=78.66% val_score=62.1499 val_score_bestthr=68.2387 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.260, mb=0.502, no=0.997, corr=-0.162) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 68.2387
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2042 mb_mean=0.5025 norm_overlap=0.9976 corr_cb=-0.1071 topkJ=0.0603
[TRAIN][ep=036] loss=0.7018 acc=80.67%
[TRAIN][ep=036] mask_avg: mc_mean=0.2293 mb_mean=0.5023 norm_overlap=0.9975 corr_cb=-0.1298
[EPOCH 036/089] train: loss=0.7018 acc=80.67% | val: loss=0.5684 acc=71.08% f1=75.51% auc=78.20% val_score=64.5926 val_score_bestthr=68.9195 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.229, mb=0.502, no=0.997, corr=-0.130) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 68.9195
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1684 mb_mean=0.5040 norm_overlap=0.9962 corr_cb=-0.1737 topkJ=0.0304
[TRAIN][ep=037] loss=0.6873 acc=80.40%
[TRAIN][ep=037] mask_avg: mc_mean=0.2307 mb_mean=0.5023 norm_overlap=0.9974 corr_cb=-0.1323
[EPOCH 037/089] train: loss=0.6873 acc=80.40% | val: loss=0.5616 acc=71.08% f1=76.00% auc=79.42% val_score=54.8619 val_score_bestthr=71.3709 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.231, mb=0.502, no=0.997, corr=-0.132) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 71.3709
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2680 mb_mean=0.5023 norm_overlap=0.9933 corr_cb=-0.3324 topkJ=0.0111
[TRAIN][ep=038] loss=0.6687 acc=81.07%
[TRAIN][ep=038] mask_avg: mc_mean=0.2502 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1559
[EPOCH 038/089] train: loss=0.6687 acc=81.07% | val: loss=0.5745 acc=69.88% f1=74.75% auc=78.20% val_score=64.4477 val_score_bestthr=68.1836 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.250, mb=0.502, no=0.997, corr=-0.156) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 68.1836
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2690 mb_mean=0.5023 norm_overlap=0.9952 corr_cb=-0.2625 topkJ=0.0283
[TRAIN][ep=039] loss=0.6684 acc=82.01%
[TRAIN][ep=039] mask_avg: mc_mean=0.2457 mb_mean=0.5023 norm_overlap=0.9973 corr_cb=-0.1409
[EPOCH 039/089] train: loss=0.6684 acc=82.01% | val: loss=0.5958 acc=68.67% f1=75.93% auc=76.74% val_score=59.9133 val_score_bestthr=68.2387 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.246, mb=0.502, no=0.997, corr=-0.141) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 68.2387
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.1773 mb_mean=0.5019 norm_overlap=0.9969 corr_cb=-0.1296 topkJ=0.0411
[TRAIN][ep=040] loss=0.6660 acc=81.61%
[TRAIN][ep=040] mask_avg: mc_mean=0.2272 mb_mean=0.5023 norm_overlap=0.9972 corr_cb=-0.1391
[EPOCH 040/089] train: loss=0.6660 acc=81.61% | val: loss=0.5876 acc=72.29% f1=76.77% auc=78.72% val_score=61.0747 val_score_bestthr=70.9047 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.227, mb=0.502, no=0.997, corr=-0.139) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 70.9047
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.2538 mb_mean=0.5002 norm_overlap=0.9979 corr_cb=-0.1200 topkJ=0.0255
[TRAIN][ep=041] loss=0.6515 acc=81.88%
[TRAIN][ep=041] mask_avg: mc_mean=0.2491 mb_mean=0.5023 norm_overlap=0.9973 corr_cb=-0.1388
[EPOCH 041/089] train: loss=0.6515 acc=81.88% | val: loss=0.5931 acc=72.29% f1=76.77% auc=77.67% val_score=54.9733 val_score_bestthr=70.9047 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.249, mb=0.502, no=0.997, corr=-0.139) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 70.9047
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.1808 mb_mean=0.5021 norm_overlap=0.9980 corr_cb=-0.0900 topkJ=0.0241
[TRAIN][ep=042] loss=0.6508 acc=82.28%
[TRAIN][ep=042] mask_avg: mc_mean=0.2305 mb_mean=0.5023 norm_overlap=0.9973 corr_cb=-0.1313
[EPOCH 042/089] train: loss=0.6508 acc=82.28% | val: loss=0.5875 acc=68.67% f1=76.36% auc=78.08% val_score=56.0901 val_score_bestthr=71.8036 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.230, mb=0.502, no=0.997, corr=-0.131) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 71.8036
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.3236 mb_mean=0.5025 norm_overlap=0.9955 corr_cb=-0.2409 topkJ=0.0232
[TRAIN][ep=043] loss=0.6519 acc=82.95%
[TRAIN][ep=043] mask_avg: mc_mean=0.2488 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1519
[EPOCH 043/089] train: loss=0.6519 acc=82.95% | val: loss=0.6215 acc=68.67% f1=76.36% auc=76.34% val_score=56.0901 val_score_bestthr=71.8036 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.249, mb=0.502, no=0.997, corr=-0.152) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 71.8036
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2528 mb_mean=0.5062 norm_overlap=1.0009 corr_cb=0.0415 topkJ=0.0615
[TRAIN][ep=044] loss=0.6290 acc=83.22%
[TRAIN][ep=044] mask_avg: mc_mean=0.2475 mb_mean=0.5023 norm_overlap=0.9971 corr_cb=-0.1453
[EPOCH 044/089] train: loss=0.6290 acc=83.22% | val: loss=0.6265 acc=73.49% f1=77.08% auc=77.79% val_score=61.7270 val_score_bestthr=70.6267 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.248, mb=0.502, no=0.997, corr=-0.145) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 70.6267
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.3002 mb_mean=0.5009 norm_overlap=0.9984 corr_cb=-0.0723 topkJ=0.0716
[TRAIN][ep=045] loss=0.6345 acc=84.43%
[TRAIN][ep=045] mask_avg: mc_mean=0.2580 mb_mean=0.5023 norm_overlap=0.9971 corr_cb=-0.1484
[EPOCH 045/089] train: loss=0.6345 acc=84.43% | val: loss=0.6899 acc=71.08% f1=76.00% auc=75.76% val_score=64.2011 val_score_bestthr=70.3347 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.258, mb=0.502, no=0.997, corr=-0.148) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 70.3347
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.1981 mb_mean=0.5026 norm_overlap=0.9990 corr_cb=-0.0376 topkJ=0.0739
[TRAIN][ep=046] loss=0.6303 acc=83.76%
[TRAIN][ep=046] mask_avg: mc_mean=0.2177 mb_mean=0.5023 norm_overlap=0.9973 corr_cb=-0.1263
[EPOCH 046/089] train: loss=0.6303 acc=83.76% | val: loss=0.6421 acc=72.29% f1=76.77% auc=76.69% val_score=61.7776 val_score_bestthr=69.6873 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.218, mb=0.502, no=0.997, corr=-0.126) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 69.6873
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.2772 mb_mean=0.5033 norm_overlap=0.9966 corr_cb=-0.2005 topkJ=0.0162
[TRAIN][ep=047] loss=0.6271 acc=84.03%
[TRAIN][ep=047] mask_avg: mc_mean=0.2594 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1540
[EPOCH 047/089] train: loss=0.6271 acc=84.03% | val: loss=0.6611 acc=67.47% f1=75.68% auc=75.76% val_score=56.0501 val_score_bestthr=71.0318 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.259, mb=0.502, no=0.997, corr=-0.154) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 71.0318
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.2725 mb_mean=0.5001 norm_overlap=0.9960 corr_cb=-0.2096 topkJ=0.0242
[TRAIN][ep=048] loss=0.5941 acc=86.31%
[TRAIN][ep=048] mask_avg: mc_mean=0.2436 mb_mean=0.5023 norm_overlap=0.9971 corr_cb=-0.1399
[EPOCH 048/089] train: loss=0.5941 acc=86.31% | val: loss=0.7447 acc=69.88% f1=77.06% auc=76.34% val_score=69.0388 val_score_bestthr=74.1280 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.244, mb=0.502, no=0.997, corr=-0.140) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 73.6277 -> 74.1280
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=049] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.2415 mb_mean=0.4996 norm_overlap=0.9938 corr_cb=-0.2993 topkJ=0.0202
[TRAIN][ep=049] loss=0.7701 acc=79.60%
[TRAIN][ep=049] mask_avg: mc_mean=0.2239 mb_mean=0.5023 norm_overlap=0.9969 corr_cb=-0.1453
[EPOCH 049/089] train: loss=0.7701 acc=79.60% | val: loss=0.7006 acc=69.88% f1=77.06% auc=75.70% val_score=69.0388 val_score_bestthr=74.1280 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.224, mb=0.502, no=0.997, corr=-0.145) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 74.1280
[DBG][ep=050] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.2391 mb_mean=0.5034 norm_overlap=0.9943 corr_cb=-0.2640 topkJ=0.0102
[TRAIN][ep=050] loss=0.5995 acc=87.52%
[TRAIN][ep=050] mask_avg: mc_mean=0.2502 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1702
[EPOCH 050/089] train: loss=0.5995 acc=87.52% | val: loss=0.6412 acc=71.08% f1=76.47% auc=75.52% val_score=62.5027 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.502, no=0.997, corr=-0.170) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=051] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.2039 mb_mean=0.5047 norm_overlap=1.0003 corr_cb=0.0174 topkJ=0.0678
[TRAIN][ep=051] loss=0.5798 acc=87.65%
[TRAIN][ep=051] mask_avg: mc_mean=0.2501 mb_mean=0.5023 norm_overlap=0.9967 corr_cb=-0.1658
[EPOCH 051/089] train: loss=0.5798 acc=87.65% | val: loss=0.6422 acc=71.08% f1=76.47% auc=75.76% val_score=62.5027 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.502, no=0.997, corr=-0.166) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=052] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.2474 mb_mean=0.5020 norm_overlap=0.9957 corr_cb=-0.2192 topkJ=0.0365
[TRAIN][ep=052] loss=0.5717 acc=88.05%
[TRAIN][ep=052] mask_avg: mc_mean=0.2501 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1684
[EPOCH 052/089] train: loss=0.5717 acc=88.05% | val: loss=0.6446 acc=71.08% f1=76.47% auc=75.81% val_score=62.5027 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.502, no=0.997, corr=-0.168) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=053] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.2653 mb_mean=0.5023 norm_overlap=0.9967 corr_cb=-0.1804 topkJ=0.0286
[TRAIN][ep=053] loss=0.5738 acc=88.72%
[TRAIN][ep=053] mask_avg: mc_mean=0.2500 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1691
[EPOCH 053/089] train: loss=0.5738 acc=88.72% | val: loss=0.6469 acc=71.08% f1=76.47% auc=75.70% val_score=61.0754 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.502, no=0.997, corr=-0.169) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=054] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=054] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=054] mask(step0): mc_mean=0.2586 mb_mean=0.5013 norm_overlap=0.9963 corr_cb=-0.1705 topkJ=0.0289
[TRAIN][ep=054] loss=0.5663 acc=87.92%
[TRAIN][ep=054] mask_avg: mc_mean=0.2501 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1740
[EPOCH 054/089] train: loss=0.5663 acc=87.92% | val: loss=0.6529 acc=71.08% f1=76.47% auc=75.81% val_score=56.5112 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.502, no=0.996, corr=-0.174) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=055] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=055] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=055] mask(step0): mc_mean=0.2574 mb_mean=0.5029 norm_overlap=0.9937 corr_cb=-0.3096 topkJ=0.0113
[TRAIN][ep=055] loss=0.5664 acc=88.59%
[TRAIN][ep=055] mask_avg: mc_mean=0.2501 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1694
[EPOCH 055/089] train: loss=0.5664 acc=88.59% | val: loss=0.6562 acc=71.08% f1=76.47% auc=75.76% val_score=61.0754 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.502, no=0.997, corr=-0.169) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=056] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=056] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=056] mask(step0): mc_mean=0.2195 mb_mean=0.5009 norm_overlap=0.9962 corr_cb=-0.2143 topkJ=0.0329
[TRAIN][ep=056] loss=0.5638 acc=88.32%
[TRAIN][ep=056] mask_avg: mc_mean=0.2502 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1704
[EPOCH 056/089] train: loss=0.5638 acc=88.32% | val: loss=0.6620 acc=71.08% f1=76.47% auc=75.64% val_score=56.5112 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.502, no=0.997, corr=-0.170) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=057] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=057] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=057] mask(step0): mc_mean=0.2668 mb_mean=0.5026 norm_overlap=0.9967 corr_cb=-0.1852 topkJ=0.0305
[TRAIN][ep=057] loss=0.5605 acc=88.72%
[TRAIN][ep=057] mask_avg: mc_mean=0.2501 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1672
[EPOCH 057/089] train: loss=0.5605 acc=88.72% | val: loss=0.6667 acc=71.08% f1=76.47% auc=75.76% val_score=54.4873 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.502, no=0.997, corr=-0.167) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=058] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=058] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=058] mask(step0): mc_mean=0.2065 mb_mean=0.5051 norm_overlap=0.9968 corr_cb=-0.1836 topkJ=0.0353
[TRAIN][ep=058] loss=0.5600 acc=88.19%
[TRAIN][ep=058] mask_avg: mc_mean=0.2501 mb_mean=0.5023 norm_overlap=0.9967 corr_cb=-0.1656
[EPOCH 058/089] train: loss=0.5600 acc=88.19% | val: loss=0.6651 acc=71.08% f1=76.47% auc=76.05% val_score=61.0754 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.502, no=0.997, corr=-0.166) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=059] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=059] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=059] mask(step0): mc_mean=0.2755 mb_mean=0.4997 norm_overlap=0.9959 corr_cb=-0.2140 topkJ=0.0446
[TRAIN][ep=059] loss=0.5568 acc=88.72%
[TRAIN][ep=059] mask_avg: mc_mean=0.2501 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1677
[EPOCH 059/089] train: loss=0.5568 acc=88.72% | val: loss=0.6733 acc=71.08% f1=76.47% auc=75.76% val_score=62.3569 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.502, no=0.997, corr=-0.168) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=060] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=060] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=060] mask(step0): mc_mean=0.2730 mb_mean=0.4999 norm_overlap=0.9957 corr_cb=-0.2370 topkJ=0.0174
[TRAIN][ep=060] loss=0.5579 acc=89.13%
[TRAIN][ep=060] mask_avg: mc_mean=0.2501 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1679
[EPOCH 060/089] train: loss=0.5579 acc=89.13% | val: loss=0.6719 acc=71.08% f1=76.47% auc=75.76% val_score=61.0754 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.502, no=0.997, corr=-0.168) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=061] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=061] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=061] mask(step0): mc_mean=0.2771 mb_mean=0.5016 norm_overlap=0.9893 corr_cb=-0.4287 topkJ=0.0075
[TRAIN][ep=061] loss=0.5547 acc=89.26%
[TRAIN][ep=061] mask_avg: mc_mean=0.2501 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1673
[EPOCH 061/089] train: loss=0.5547 acc=89.26% | val: loss=0.6778 acc=71.08% f1=76.47% auc=75.64% val_score=61.0754 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.502, no=0.997, corr=-0.167) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=062] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=062] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=062] mask(step0): mc_mean=0.2713 mb_mean=0.5002 norm_overlap=0.9964 corr_cb=-0.2087 topkJ=0.0270
[TRAIN][ep=062] loss=0.5555 acc=87.92%
[TRAIN][ep=062] mask_avg: mc_mean=0.2501 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1677
[EPOCH 062/089] train: loss=0.5555 acc=87.92% | val: loss=0.6780 acc=71.08% f1=76.47% auc=76.10% val_score=61.7074 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.502, no=0.997, corr=-0.168) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=063] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=063] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=063] mask(step0): mc_mean=0.2430 mb_mean=0.5036 norm_overlap=0.9964 corr_cb=-0.1676 topkJ=0.0219
[TRAIN][ep=063] loss=0.5638 acc=87.65%
[TRAIN][ep=063] mask_avg: mc_mean=0.2501 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1736
[EPOCH 063/089] train: loss=0.5638 acc=87.65% | val: loss=0.6809 acc=71.08% f1=76.47% auc=75.76% val_score=61.0754 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.502, no=0.997, corr=-0.174) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=064] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=064] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=064] mask(step0): mc_mean=0.2484 mb_mean=0.5016 norm_overlap=0.9956 corr_cb=-0.1922 topkJ=0.0395
[TRAIN][ep=064] loss=0.5489 acc=89.13%
[TRAIN][ep=064] mask_avg: mc_mean=0.2501 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1708
[EPOCH 064/089] train: loss=0.5489 acc=89.13% | val: loss=0.6857 acc=71.08% f1=76.47% auc=75.64% val_score=61.7074 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.502, no=0.997, corr=-0.171) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=065] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=065] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=065] mask(step0): mc_mean=0.2045 mb_mean=0.5027 norm_overlap=0.9956 corr_cb=-0.2171 topkJ=0.0280
[TRAIN][ep=065] loss=0.5512 acc=88.86%
[TRAIN][ep=065] mask_avg: mc_mean=0.2501 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1672
[EPOCH 065/089] train: loss=0.5512 acc=88.86% | val: loss=0.6862 acc=71.08% f1=76.47% auc=75.70% val_score=61.0754 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.502, no=0.997, corr=-0.167) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=066] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=066] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=066] mask(step0): mc_mean=0.2200 mb_mean=0.5044 norm_overlap=0.9962 corr_cb=-0.2090 topkJ=0.0316
[TRAIN][ep=066] loss=0.5480 acc=88.86%
[TRAIN][ep=066] mask_avg: mc_mean=0.2502 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1661
[EPOCH 066/089] train: loss=0.5480 acc=88.86% | val: loss=0.7024 acc=71.08% f1=76.47% auc=75.76% val_score=66.9058 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.502, no=0.997, corr=-0.166) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=067] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=067] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=067] mask(step0): mc_mean=0.2504 mb_mean=0.4998 norm_overlap=0.9984 corr_cb=-0.0688 topkJ=0.0467
[TRAIN][ep=067] loss=0.5477 acc=88.99%
[TRAIN][ep=067] mask_avg: mc_mean=0.2501 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1658
[EPOCH 067/089] train: loss=0.5477 acc=88.99% | val: loss=0.6968 acc=71.08% f1=76.47% auc=75.70% val_score=56.5584 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.502, no=0.997, corr=-0.166) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=068] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=068] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=068] mask(step0): mc_mean=0.2394 mb_mean=0.5046 norm_overlap=0.9934 corr_cb=-0.3129 topkJ=0.0283
[TRAIN][ep=068] loss=0.5431 acc=87.79%
[TRAIN][ep=068] mask_avg: mc_mean=0.2501 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1696
[EPOCH 068/089] train: loss=0.5431 acc=87.79% | val: loss=0.7004 acc=71.08% f1=76.47% auc=75.64% val_score=62.5027 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.502, no=0.997, corr=-0.170) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=069] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=069] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=069] mask(step0): mc_mean=0.2779 mb_mean=0.5008 norm_overlap=0.9983 corr_cb=-0.0837 topkJ=0.0403
[TRAIN][ep=069] loss=0.5421 acc=88.72%
[TRAIN][ep=069] mask_avg: mc_mean=0.2500 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1661
[EPOCH 069/089] train: loss=0.5421 acc=88.72% | val: loss=0.7061 acc=68.67% f1=75.93% auc=75.47% val_score=54.1474 val_score_bestthr=71.1606 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.502, no=0.997, corr=-0.166) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 71.1606
[DBG][ep=070] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=070] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=070] mask(step0): mc_mean=0.2423 mb_mean=0.5018 norm_overlap=0.9977 corr_cb=-0.1050 topkJ=0.0650
[TRAIN][ep=070] loss=0.5413 acc=89.26%
[TRAIN][ep=070] mask_avg: mc_mean=0.2501 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1668
[EPOCH 070/089] train: loss=0.5413 acc=89.26% | val: loss=0.7180 acc=71.08% f1=76.47% auc=75.76% val_score=63.4537 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.502, no=0.997, corr=-0.167) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=071] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=071] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=071] mask(step0): mc_mean=0.2429 mb_mean=0.5030 norm_overlap=0.9944 corr_cb=-0.2882 topkJ=0.0136
[TRAIN][ep=071] loss=0.5421 acc=88.59%
[TRAIN][ep=071] mask_avg: mc_mean=0.2501 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1672
[EPOCH 071/089] train: loss=0.5421 acc=88.59% | val: loss=0.7045 acc=71.08% f1=76.47% auc=75.64% val_score=63.3989 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.502, no=0.997, corr=-0.167) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=072] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=072] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=072] mask(step0): mc_mean=0.2610 mb_mean=0.5026 norm_overlap=0.9965 corr_cb=-0.1880 topkJ=0.0190
[TRAIN][ep=072] loss=0.5424 acc=88.46%
[TRAIN][ep=072] mask_avg: mc_mean=0.2501 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1671
[EPOCH 072/089] train: loss=0.5424 acc=88.46% | val: loss=0.7043 acc=69.88% f1=76.64% auc=75.93% val_score=61.0754 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.502, no=0.997, corr=-0.167) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.2690
[DBG][ep=073] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=073] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=073] mask(step0): mc_mean=0.2279 mb_mean=0.5011 norm_overlap=0.9989 corr_cb=-0.0636 topkJ=0.0710
[TRAIN][ep=073] loss=0.5397 acc=89.53%
[TRAIN][ep=073] mask_avg: mc_mean=0.2502 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1689
[EPOCH 073/089] train: loss=0.5397 acc=89.53% | val: loss=0.7167 acc=69.88% f1=76.64% auc=75.64% val_score=54.1474 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.502, no=0.997, corr=-0.169) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.2690
[DBG][ep=074] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=074] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=074] mask(step0): mc_mean=0.2232 mb_mean=0.5028 norm_overlap=0.9961 corr_cb=-0.1939 topkJ=0.0222
[TRAIN][ep=074] loss=0.5409 acc=88.05%
[TRAIN][ep=074] mask_avg: mc_mean=0.2502 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1701
[EPOCH 074/089] train: loss=0.5409 acc=88.05% | val: loss=0.7106 acc=69.88% f1=76.64% auc=75.93% val_score=61.0754 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.502, no=0.997, corr=-0.170) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.2690
[DBG][ep=075] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=075] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=075] mask(step0): mc_mean=0.3060 mb_mean=0.5013 norm_overlap=0.9931 corr_cb=-0.3470 topkJ=0.0064
[TRAIN][ep=075] loss=0.5420 acc=88.86%
[TRAIN][ep=075] mask_avg: mc_mean=0.2501 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1663
[EPOCH 075/089] train: loss=0.5420 acc=88.86% | val: loss=0.7102 acc=71.08% f1=76.47% auc=75.76% val_score=61.0754 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.502, no=0.997, corr=-0.166) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=076] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=076] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=076] mask(step0): mc_mean=0.2056 mb_mean=0.5030 norm_overlap=0.9993 corr_cb=-0.0321 topkJ=0.0598
[TRAIN][ep=076] loss=0.5416 acc=88.46%
[TRAIN][ep=076] mask_avg: mc_mean=0.2501 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1673
[EPOCH 076/089] train: loss=0.5416 acc=88.46% | val: loss=0.7116 acc=71.08% f1=76.47% auc=75.87% val_score=61.0754 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.502, no=0.997, corr=-0.167) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=077] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=077] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=077] mask(step0): mc_mean=0.2264 mb_mean=0.5034 norm_overlap=0.9945 corr_cb=-0.2837 topkJ=0.0169
[TRAIN][ep=077] loss=0.5370 acc=88.46%
[TRAIN][ep=077] mask_avg: mc_mean=0.2500 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1679
[EPOCH 077/089] train: loss=0.5370 acc=88.46% | val: loss=0.7220 acc=69.88% f1=76.64% auc=75.64% val_score=55.0584 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.502, no=0.997, corr=-0.168) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.2690
[DBG][ep=078] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=078] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=078] mask(step0): mc_mean=0.2429 mb_mean=0.5031 norm_overlap=0.9975 corr_cb=-0.0973 topkJ=0.0390
[TRAIN][ep=078] loss=0.5342 acc=88.99%
[TRAIN][ep=078] mask_avg: mc_mean=0.2501 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1704
[EPOCH 078/089] train: loss=0.5342 acc=88.99% | val: loss=0.7213 acc=69.88% f1=76.64% auc=75.58% val_score=61.0754 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.502, no=0.997, corr=-0.170) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.2690
[EARLY STOP] no improvement for 30 epochs. best_epoch=48
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
=============== FIT DONE ===============
[BEST] epoch=48 | val_acc=69.88% | val_f1=77.06% | val_auc=76.34% | val_score=69.0388 | val_score_bestthr=74.1280
[TEST@BEST] thr_used=0.485 | acc=63.29% f1=69.35% auc=63.55% | SP_sex=3.41% EO_sex=10.16% SP_age=13.20% EO_age=8.08%
[TIME] 1.98 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/summary_fold_0.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5259 mb_mean=0.5010 norm_overlap=0.9999 corr_cb=-0.0912 topkJ=0.0676
[TRAIN][ep=000] loss=0.6939 acc=50.47%
[TRAIN][ep=000] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0996
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5274 mb_mean=0.4997 norm_overlap=0.9999 corr_cb=-0.2567 topkJ=0.0254
[TRAIN][ep=001] loss=0.6920 acc=50.47%
[TRAIN][ep=001] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0926
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5297 mb_mean=0.5053 norm_overlap=1.0000 corr_cb=0.0154 topkJ=0.0969
[TRAIN][ep=002] loss=0.6899 acc=52.89%
[TRAIN][ep=002] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0983
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5296 mb_mean=0.5000 norm_overlap=0.9999 corr_cb=-0.1407 topkJ=0.0490
[TRAIN][ep=003] loss=0.6882 acc=54.23%
[TRAIN][ep=003] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0952
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5295 mb_mean=0.4987 norm_overlap=0.9999 corr_cb=-0.1840 topkJ=0.0339
[TRAIN][ep=004] loss=0.6887 acc=53.42%
[TRAIN][ep=004] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.1002
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5288 mb_mean=0.5009 norm_overlap=0.9999 corr_cb=-0.1690 topkJ=0.0368
[TRAIN][ep=005] loss=0.6834 acc=56.91%
[TRAIN][ep=005] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0988
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5323 mb_mean=0.5018 norm_overlap=0.9999 corr_cb=-0.2431 topkJ=0.0234
[TRAIN][ep=006] loss=0.6844 acc=54.63%
[TRAIN][ep=006] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0978
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5339 mb_mean=0.5021 norm_overlap=1.0000 corr_cb=-0.0185 topkJ=0.0321
[TRAIN][ep=007] loss=0.6826 acc=57.72%
[TRAIN][ep=007] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0955
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5308 mb_mean=0.5020 norm_overlap=1.0000 corr_cb=-0.0361 topkJ=0.0444
[TRAIN][ep=008] loss=0.6776 acc=58.12%
[TRAIN][ep=008] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0938
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5248 mb_mean=0.5048 norm_overlap=0.9999 corr_cb=-0.0945 topkJ=0.0690
[TRAIN][ep=009] loss=0.6759 acc=58.93%
[TRAIN][ep=009] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0965
================= FIT START (fold=0) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5327 mb_mean=0.5004 norm_overlap=1.0000 corr_cb=-0.0395 topkJ=0.0304
[TRAIN][ep=000] loss=0.6709 acc=61.48%
[TRAIN][ep=000] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0992
[EPOCH 000/089] train: loss=0.6709 acc=61.48% | val: loss=0.6686 acc=62.65% f1=69.31% auc=65.87% val_score=63.8688 val_score_bestthr=64.9727 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.099) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 64.9727
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5321 mb_mean=0.5010 norm_overlap=0.9998 corr_cb=-0.3401 topkJ=0.0082
[TRAIN][ep=001] loss=0.6667 acc=61.34%
[TRAIN][ep=001] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0976
[EPOCH 001/089] train: loss=0.6667 acc=61.34% | val: loss=0.6664 acc=61.45% f1=68.63% auc=65.58% val_score=50.8549 val_score_bestthr=63.8688 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.098) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9727 -> 63.8688
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5308 mb_mean=0.5031 norm_overlap=1.0000 corr_cb=-0.0851 topkJ=0.0316
[TRAIN][ep=002] loss=0.6610 acc=60.94%
[TRAIN][ep=002] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0965
[EPOCH 002/089] train: loss=0.6610 acc=60.94% | val: loss=0.6768 acc=56.63% f1=64.71% auc=64.07% val_score=48.1618 val_score_bestthr=58.9427 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.097) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9727 -> 58.9427
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5303 mb_mean=0.5028 norm_overlap=1.0000 corr_cb=0.0572 topkJ=0.0336
[TRAIN][ep=003] loss=0.6553 acc=64.43%
[TRAIN][ep=003] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0987
[EPOCH 003/089] train: loss=0.6553 acc=64.43% | val: loss=0.6566 acc=62.65% f1=69.31% auc=66.69% val_score=50.8414 val_score_bestthr=64.9727 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.099) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9727 -> 64.9727
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5315 mb_mean=0.5048 norm_overlap=1.0000 corr_cb=-0.0454 topkJ=0.0668
[TRAIN][ep=004] loss=0.6487 acc=65.10%
[TRAIN][ep=004] mask_avg: mc_mean=0.5292 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0985
[EPOCH 004/089] train: loss=0.6487 acc=65.10% | val: loss=0.6513 acc=62.65% f1=69.31% auc=67.73% val_score=56.4760 val_score_bestthr=64.9727 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.099) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9727 -> 64.9727
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5300 mb_mean=0.5015 norm_overlap=0.9999 corr_cb=-0.2288 topkJ=0.0177
[TRAIN][ep=005] loss=1.4750 acc=65.10%
[TRAIN][ep=005] mask_avg: mc_mean=0.3801 mb_mean=0.5023 norm_overlap=1.0007 corr_cb=0.1904
[EPOCH 005/089] train: loss=1.4750 acc=65.10% | val: loss=0.6494 acc=62.65% f1=72.07% auc=71.22% val_score=56.2554 val_score_bestthr=61.8131 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.380, mb=0.502, no=1.001, corr=0.190) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9727 -> 61.8131
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2802 mb_mean=0.5013 norm_overlap=1.0021 corr_cb=0.3841 topkJ=0.1305
[TRAIN][ep=006] loss=1.2068 acc=65.64%
[TRAIN][ep=006] mask_avg: mc_mean=0.2539 mb_mean=0.5023 norm_overlap=1.0013 corr_cb=0.1876
[EPOCH 006/089] train: loss=1.2068 acc=65.64% | val: loss=0.6395 acc=62.65% f1=71.56% auc=71.86% val_score=61.3612 val_score_bestthr=64.3474 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.254, mb=0.502, no=1.001, corr=0.188) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9727 -> 64.3474
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2305 mb_mean=0.5027 norm_overlap=1.0018 corr_cb=0.2145 topkJ=0.0734
[TRAIN][ep=007] loss=0.9681 acc=65.37%
[TRAIN][ep=007] mask_avg: mc_mean=0.2252 mb_mean=0.5023 norm_overlap=1.0012 corr_cb=0.1481
[EPOCH 007/089] train: loss=0.9681 acc=65.37% | val: loss=0.6325 acc=62.65% f1=72.57% auc=72.50% val_score=59.6608 val_score_bestthr=67.1797 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.040, stage2=False) | mask(mc=0.225, mb=0.502, no=1.001, corr=0.148) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 64.9727 -> 67.1797
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2210 mb_mean=0.5013 norm_overlap=1.0006 corr_cb=0.0627 topkJ=0.0715
[TRAIN][ep=008] loss=1.0491 acc=68.19%
[TRAIN][ep=008] mask_avg: mc_mean=0.2102 mb_mean=0.5023 norm_overlap=1.0010 corr_cb=0.1098
[EPOCH 008/089] train: loss=1.0491 acc=68.19% | val: loss=0.6496 acc=65.06% f1=70.10% auc=69.71% val_score=51.3291 val_score_bestthr=62.1649 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.080, stage2=False) | mask(mc=0.210, mb=0.502, no=1.001, corr=0.110) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.1797 -> 62.1649
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2074 mb_mean=0.5024 norm_overlap=1.0004 corr_cb=0.0351 topkJ=0.0723
[TRAIN][ep=009] loss=1.1462 acc=65.91%
[TRAIN][ep=009] mask_avg: mc_mean=0.1892 mb_mean=0.5023 norm_overlap=1.0009 corr_cb=0.0866
[EPOCH 009/089] train: loss=1.1462 acc=65.91% | val: loss=0.6432 acc=65.06% f1=73.39% auc=73.31% val_score=65.7793 val_score_bestthr=68.3138 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.120, stage2=False) | mask(mc=0.189, mb=0.502, no=1.001, corr=0.087) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 67.1797 -> 68.3138
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1950 mb_mean=0.5010 norm_overlap=1.0013 corr_cb=0.1436 topkJ=0.0745
[TRAIN][ep=010] loss=1.2316 acc=66.04%
[TRAIN][ep=010] mask_avg: mc_mean=0.1922 mb_mean=0.5023 norm_overlap=1.0006 corr_cb=0.0451
[EPOCH 010/089] train: loss=1.2316 acc=66.04% | val: loss=0.6231 acc=63.86% f1=73.68% auc=73.37% val_score=58.4938 val_score_bestthr=66.8001 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.160, stage2=False) | mask(mc=0.192, mb=0.502, no=1.001, corr=0.045) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.3138 -> 66.8001
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1883 mb_mean=0.5027 norm_overlap=0.9979 corr_cb=-0.1993 topkJ=0.0556
[TRAIN][ep=011] loss=1.3001 acc=70.60%
[TRAIN][ep=011] mask_avg: mc_mean=0.1852 mb_mean=0.5023 norm_overlap=1.0002 corr_cb=0.0148
[EPOCH 011/089] train: loss=1.3001 acc=70.60% | val: loss=0.6130 acc=63.86% f1=72.73% auc=75.93% val_score=61.5955 val_score_bestthr=67.2118 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.185, mb=0.502, no=1.000, corr=0.015) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.3138 -> 67.2118
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1772 mb_mean=0.5005 norm_overlap=1.0001 corr_cb=0.0058 topkJ=0.1127
[TRAIN][ep=012] loss=1.3951 acc=69.13%
[TRAIN][ep=012] mask_avg: mc_mean=0.1804 mb_mean=0.5023 norm_overlap=0.9998 corr_cb=-0.0157
[EPOCH 012/089] train: loss=1.3951 acc=69.13% | val: loss=0.6708 acc=59.04% f1=71.19% auc=71.34% val_score=50.4880 val_score_bestthr=62.7185 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.180, mb=0.502, no=1.000, corr=-0.016) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.3138 -> 62.7185
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1925 mb_mean=0.5050 norm_overlap=0.9989 corr_cb=-0.0898 topkJ=0.0740
[TRAIN][ep=013] loss=1.3889 acc=69.40%
[TRAIN][ep=013] mask_avg: mc_mean=0.1695 mb_mean=0.5023 norm_overlap=0.9996 corr_cb=-0.0324
[EPOCH 013/089] train: loss=1.3889 acc=69.40% | val: loss=0.6205 acc=71.08% f1=70.00% auc=75.17% val_score=51.6655 val_score_bestthr=64.6065 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.170, mb=0.502, no=1.000, corr=-0.032) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.3138 -> 64.6065
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1604 mb_mean=0.4973 norm_overlap=1.0000 corr_cb=0.0037 topkJ=0.0575
[TRAIN][ep=014] loss=1.3744 acc=71.01%
[TRAIN][ep=014] mask_avg: mc_mean=0.1872 mb_mean=0.5023 norm_overlap=0.9991 corr_cb=-0.0660
[EPOCH 014/089] train: loss=1.3744 acc=71.01% | val: loss=0.5881 acc=62.65% f1=73.50% auc=76.05% val_score=58.7799 val_score_bestthr=69.0204 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.187, mb=0.502, no=0.999, corr=-0.066) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 68.3138 -> 69.0204
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1611 mb_mean=0.5022 norm_overlap=1.0002 corr_cb=0.0152 topkJ=0.0646
[TRAIN][ep=015] loss=1.3934 acc=69.93%
[TRAIN][ep=015] mask_avg: mc_mean=0.1925 mb_mean=0.5023 norm_overlap=0.9988 corr_cb=-0.0871
[EPOCH 015/089] train: loss=1.3934 acc=69.93% | val: loss=0.5847 acc=65.06% f1=72.38% auc=78.78% val_score=61.2400 val_score_bestthr=66.8004 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.192, mb=0.502, no=0.999, corr=-0.087) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.0204 -> 66.8004
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1791 mb_mean=0.5002 norm_overlap=0.9991 corr_cb=-0.0718 topkJ=0.0438
[TRAIN][ep=016] loss=1.3805 acc=70.47%
[TRAIN][ep=016] mask_avg: mc_mean=0.1927 mb_mean=0.5023 norm_overlap=0.9983 corr_cb=-0.1113
[EPOCH 016/089] train: loss=1.3805 acc=70.47% | val: loss=0.5755 acc=74.70% f1=72.73% auc=78.31% val_score=68.0866 val_score_bestthr=68.0866 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.193, mb=0.502, no=0.998, corr=-0.111) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.0204 -> 68.0866
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.2246 mb_mean=0.5033 norm_overlap=0.9968 corr_cb=-0.2058 topkJ=0.0223
[TRAIN][ep=017] loss=1.3705 acc=71.14%
[TRAIN][ep=017] mask_avg: mc_mean=0.2060 mb_mean=0.5023 norm_overlap=0.9983 corr_cb=-0.1170
[EPOCH 017/089] train: loss=1.3705 acc=71.14% | val: loss=0.5831 acc=67.47% f1=73.27% auc=78.31% val_score=63.8330 val_score_bestthr=67.0451 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.206, mb=0.502, no=0.998, corr=-0.117) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.0204 -> 67.0451
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1882 mb_mean=0.5025 norm_overlap=0.9988 corr_cb=-0.0780 topkJ=0.0479
[TRAIN][ep=018] loss=1.3522 acc=71.68%
[TRAIN][ep=018] mask_avg: mc_mean=0.1988 mb_mean=0.5023 norm_overlap=0.9983 corr_cb=-0.1048
[EPOCH 018/089] train: loss=1.3522 acc=71.68% | val: loss=0.6043 acc=63.86% f1=74.14% auc=79.01% val_score=63.5930 val_score_bestthr=68.8312 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.199, mb=0.502, no=0.998, corr=-0.105) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.0204 -> 68.8312
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1548 mb_mean=0.5022 norm_overlap=0.9967 corr_cb=-0.2118 topkJ=0.0531
[TRAIN][ep=019] loss=1.3423 acc=72.62%
[TRAIN][ep=019] mask_avg: mc_mean=0.1952 mb_mean=0.5023 norm_overlap=0.9982 corr_cb=-0.1096
[EPOCH 019/089] train: loss=1.3423 acc=72.62% | val: loss=0.5609 acc=74.70% f1=72.73% auc=78.49% val_score=65.3216 val_score_bestthr=68.0866 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.195, mb=0.502, no=0.998, corr=-0.110) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.0204 -> 68.0866
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.2268 mb_mean=0.5020 norm_overlap=0.9987 corr_cb=-0.0663 topkJ=0.0862
[TRAIN][ep=020] loss=1.1078 acc=73.02%
[TRAIN][ep=020] mask_avg: mc_mean=0.1990 mb_mean=0.5023 norm_overlap=0.9982 corr_cb=-0.1081
[EPOCH 020/089] train: loss=1.1078 acc=73.02% | val: loss=0.5781 acc=74.70% f1=72.00% auc=76.45% val_score=66.6390 val_score_bestthr=69.4062 | dyn(w_pfs=0.290, w_sup=0.190, w_csuf=0.140, stage2=False) | mask(mc=0.199, mb=0.502, no=0.998, corr=-0.108) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 69.0204 -> 69.4062
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2262 mb_mean=0.5058 norm_overlap=0.9978 corr_cb=-0.1333 topkJ=0.0347
[TRAIN][ep=021] loss=1.2094 acc=71.54%
[TRAIN][ep=021] mask_avg: mc_mean=0.2018 mb_mean=0.5023 norm_overlap=0.9981 corr_cb=-0.1116
[EPOCH 021/089] train: loss=1.2094 acc=71.54% | val: loss=0.5620 acc=74.70% f1=72.00% auc=78.02% val_score=68.0866 val_score_bestthr=69.4062 | dyn(w_pfs=0.330, w_sup=0.230, w_csuf=0.180, stage2=False) | mask(mc=0.202, mb=0.502, no=0.998, corr=-0.112) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.4062 -> 69.4062
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2517 mb_mean=0.4996 norm_overlap=0.9989 corr_cb=-0.0626 topkJ=0.0364
[TRAIN][ep=022] loss=1.2684 acc=73.83%
[TRAIN][ep=022] mask_avg: mc_mean=0.2253 mb_mean=0.5023 norm_overlap=0.9978 corr_cb=-0.1384
[EPOCH 022/089] train: loss=1.2684 acc=73.83% | val: loss=0.5585 acc=75.90% f1=74.36% auc=78.08% val_score=69.4062 val_score_bestthr=68.9443 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.225, mb=0.502, no=0.998, corr=-0.138) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.4062 -> 68.9443
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1358 mb_mean=0.5023 norm_overlap=0.9979 corr_cb=-0.1068 topkJ=0.0271
[TRAIN][ep=023] loss=1.2954 acc=74.63%
[TRAIN][ep=023] mask_avg: mc_mean=0.2119 mb_mean=0.5023 norm_overlap=0.9980 corr_cb=-0.1157
[EPOCH 023/089] train: loss=1.2954 acc=74.63% | val: loss=0.5726 acc=75.90% f1=74.36% auc=77.67% val_score=64.4160 val_score_bestthr=70.1617 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.212, mb=0.502, no=0.998, corr=-0.116) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 69.4062 -> 70.1617
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2147 mb_mean=0.5016 norm_overlap=0.9970 corr_cb=-0.1811 topkJ=0.0469
[TRAIN][ep=024] loss=1.3219 acc=72.75%
[TRAIN][ep=024] mask_avg: mc_mean=0.2142 mb_mean=0.5023 norm_overlap=0.9980 corr_cb=-0.1165
[EPOCH 024/089] train: loss=1.3219 acc=72.75% | val: loss=0.5435 acc=75.90% f1=74.36% auc=79.42% val_score=62.8550 val_score_bestthr=71.3284 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.214, mb=0.502, no=0.998, corr=-0.117) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 70.1617 -> 71.3284
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1797 mb_mean=0.4998 norm_overlap=1.0003 corr_cb=0.0146 topkJ=0.0526
[TRAIN][ep=025] loss=1.2874 acc=75.44%
[TRAIN][ep=025] mask_avg: mc_mean=0.1959 mb_mean=0.5023 norm_overlap=0.9981 corr_cb=-0.1049
[EPOCH 025/089] train: loss=1.2874 acc=75.44% | val: loss=0.5521 acc=77.11% f1=74.67% auc=78.31% val_score=68.2341 val_score_bestthr=73.6277 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.196, mb=0.502, no=0.998, corr=-0.105) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 71.3284 -> 73.6277
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2300 mb_mean=0.5001 norm_overlap=0.9971 corr_cb=-0.1853 topkJ=0.0174
[TRAIN][ep=026] loss=1.2786 acc=75.70%
[TRAIN][ep=026] mask_avg: mc_mean=0.2192 mb_mean=0.5023 norm_overlap=0.9980 corr_cb=-0.1136
[EPOCH 026/089] train: loss=1.2786 acc=75.70% | val: loss=0.5403 acc=78.31% f1=77.50% auc=79.65% val_score=54.8474 val_score_bestthr=72.6051 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.219, mb=0.502, no=0.998, corr=-0.114) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 72.6051
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1656 mb_mean=0.5032 norm_overlap=0.9974 corr_cb=-0.1450 topkJ=0.0376
[TRAIN][ep=027] loss=1.2597 acc=75.70%
[TRAIN][ep=027] mask_avg: mc_mean=0.2182 mb_mean=0.5023 norm_overlap=0.9979 corr_cb=-0.1160
[EPOCH 027/089] train: loss=1.2597 acc=75.70% | val: loss=0.5824 acc=73.49% f1=72.50% auc=77.67% val_score=64.4158 val_score_bestthr=68.2341 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.218, mb=0.502, no=0.998, corr=-0.116) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 68.2341
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2044 mb_mean=0.5016 norm_overlap=1.0000 corr_cb=0.0017 topkJ=0.0506
[TRAIN][ep=028] loss=1.2479 acc=78.26%
[TRAIN][ep=028] mask_avg: mc_mean=0.2203 mb_mean=0.5023 norm_overlap=0.9981 corr_cb=-0.1044
[EPOCH 028/089] train: loss=1.2479 acc=78.26% | val: loss=0.5466 acc=77.11% f1=75.95% auc=78.60% val_score=64.0724 val_score_bestthr=72.4213 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.220, mb=0.502, no=0.998, corr=-0.104) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 72.4213
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2168 mb_mean=0.5039 norm_overlap=0.9985 corr_cb=-0.0877 topkJ=0.0723
[TRAIN][ep=029] loss=1.2594 acc=77.99%
[TRAIN][ep=029] mask_avg: mc_mean=0.2271 mb_mean=0.5023 norm_overlap=0.9979 corr_cb=-0.1157
[EPOCH 029/089] train: loss=1.2594 acc=77.99% | val: loss=0.5469 acc=74.70% f1=72.73% auc=80.47% val_score=68.0011 val_score_bestthr=70.5527 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.227, mb=0.502, no=0.998, corr=-0.116) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 70.5527
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.1436 mb_mean=0.5015 norm_overlap=0.9979 corr_cb=-0.1035 topkJ=0.0329
[TRAIN][ep=030] loss=1.2528 acc=76.91%
[TRAIN][ep=030] mask_avg: mc_mean=0.2224 mb_mean=0.5023 norm_overlap=0.9978 corr_cb=-0.1199
[EPOCH 030/089] train: loss=1.2528 acc=76.91% | val: loss=0.5843 acc=71.08% f1=75.00% auc=79.65% val_score=64.4158 val_score_bestthr=73.4125 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.222, mb=0.502, no=0.998, corr=-0.120) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 73.4125
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2913 mb_mean=0.5032 norm_overlap=0.9984 corr_cb=-0.1158 topkJ=0.0401
[TRAIN][ep=031] loss=1.0291 acc=77.72%
[TRAIN][ep=031] mask_avg: mc_mean=0.2247 mb_mean=0.5023 norm_overlap=0.9974 corr_cb=-0.1377
[EPOCH 031/089] train: loss=1.0291 acc=77.72% | val: loss=0.5659 acc=73.49% f1=72.50% auc=78.49% val_score=62.8147 val_score_bestthr=68.2341 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.225, mb=0.502, no=0.997, corr=-0.138) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 68.2341
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2182 mb_mean=0.5001 norm_overlap=0.9950 corr_cb=-0.2478 topkJ=0.0352
[TRAIN][ep=032] loss=0.8030 acc=78.26%
[TRAIN][ep=032] mask_avg: mc_mean=0.2160 mb_mean=0.5023 norm_overlap=0.9973 corr_cb=-0.1393
[EPOCH 032/089] train: loss=0.8030 acc=78.26% | val: loss=0.5569 acc=68.67% f1=75.93% auc=78.84% val_score=51.1842 val_score_bestthr=68.2387 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.216, mb=0.502, no=0.997, corr=-0.139) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 68.2387
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1923 mb_mean=0.5007 norm_overlap=0.9989 corr_cb=-0.0677 topkJ=0.0677
[TRAIN][ep=033] loss=0.7281 acc=79.19%
[TRAIN][ep=033] mask_avg: mc_mean=0.2132 mb_mean=0.5023 norm_overlap=0.9974 corr_cb=-0.1310
[EPOCH 033/089] train: loss=0.7281 acc=79.19% | val: loss=0.5521 acc=68.67% f1=75.93% auc=79.07% val_score=59.4025 val_score_bestthr=68.2387 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.213, mb=0.502, no=0.997, corr=-0.131) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 68.2387
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2682 mb_mean=0.5049 norm_overlap=0.9961 corr_cb=-0.2225 topkJ=0.0252
[TRAIN][ep=034] loss=0.7154 acc=78.93%
[TRAIN][ep=034] mask_avg: mc_mean=0.2347 mb_mean=0.5023 norm_overlap=0.9973 corr_cb=-0.1399
[EPOCH 034/089] train: loss=0.7154 acc=78.93% | val: loss=0.6030 acc=69.88% f1=75.25% auc=79.48% val_score=65.7650 val_score_bestthr=69.0388 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.235, mb=0.502, no=0.997, corr=-0.140) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 69.0388
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2927 mb_mean=0.5025 norm_overlap=0.9953 corr_cb=-0.2161 topkJ=0.0248
[TRAIN][ep=035] loss=0.6998 acc=80.40%
[TRAIN][ep=035] mask_avg: mc_mean=0.2588 mb_mean=0.5023 norm_overlap=0.9971 corr_cb=-0.1630
[EPOCH 035/089] train: loss=0.6998 acc=80.40% | val: loss=0.5700 acc=68.67% f1=74.00% auc=78.49% val_score=64.7677 val_score_bestthr=67.0695 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.259, mb=0.502, no=0.997, corr=-0.163) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 67.0695
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2042 mb_mean=0.5025 norm_overlap=0.9976 corr_cb=-0.1086 topkJ=0.0603
[TRAIN][ep=036] loss=0.7027 acc=80.67%
[TRAIN][ep=036] mask_avg: mc_mean=0.2291 mb_mean=0.5023 norm_overlap=0.9974 corr_cb=-0.1318
[EPOCH 036/089] train: loss=0.7027 acc=80.67% | val: loss=0.5689 acc=71.08% f1=75.51% auc=78.20% val_score=64.5926 val_score_bestthr=68.9195 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.229, mb=0.502, no=0.997, corr=-0.132) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 68.9195
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1670 mb_mean=0.5040 norm_overlap=0.9962 corr_cb=-0.1743 topkJ=0.0304
[TRAIN][ep=037] loss=0.6882 acc=80.40%
[TRAIN][ep=037] mask_avg: mc_mean=0.2291 mb_mean=0.5023 norm_overlap=0.9974 corr_cb=-0.1337
[EPOCH 037/089] train: loss=0.6882 acc=80.40% | val: loss=0.5631 acc=71.08% f1=76.00% auc=79.24% val_score=54.8619 val_score_bestthr=71.3709 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.229, mb=0.502, no=0.997, corr=-0.134) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 71.3709
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2641 mb_mean=0.5023 norm_overlap=0.9933 corr_cb=-0.3320 topkJ=0.0111
[TRAIN][ep=038] loss=0.6698 acc=81.07%
[TRAIN][ep=038] mask_avg: mc_mean=0.2490 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1576
[EPOCH 038/089] train: loss=0.6698 acc=81.07% | val: loss=0.5758 acc=69.88% f1=74.75% auc=78.02% val_score=63.9109 val_score_bestthr=68.1836 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.249, mb=0.502, no=0.997, corr=-0.158) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 68.1836
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2688 mb_mean=0.5023 norm_overlap=0.9952 corr_cb=-0.2640 topkJ=0.0274
[TRAIN][ep=039] loss=0.6696 acc=81.88%
[TRAIN][ep=039] mask_avg: mc_mean=0.2447 mb_mean=0.5023 norm_overlap=0.9972 corr_cb=-0.1434
[EPOCH 039/089] train: loss=0.6696 acc=81.88% | val: loss=0.5960 acc=68.67% f1=75.93% auc=76.80% val_score=58.4968 val_score_bestthr=68.2387 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.245, mb=0.502, no=0.997, corr=-0.143) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 68.2387
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.1786 mb_mean=0.5019 norm_overlap=0.9968 corr_cb=-0.1343 topkJ=0.0411
[TRAIN][ep=040] loss=0.6670 acc=81.61%
[TRAIN][ep=040] mask_avg: mc_mean=0.2260 mb_mean=0.5023 norm_overlap=0.9971 corr_cb=-0.1415
[EPOCH 040/089] train: loss=0.6670 acc=81.61% | val: loss=0.5895 acc=72.29% f1=76.77% auc=78.72% val_score=65.0270 val_score_bestthr=70.9047 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.226, mb=0.502, no=0.997, corr=-0.141) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 70.9047
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.2534 mb_mean=0.5002 norm_overlap=0.9979 corr_cb=-0.1214 topkJ=0.0251
[TRAIN][ep=041] loss=0.6530 acc=81.74%
[TRAIN][ep=041] mask_avg: mc_mean=0.2479 mb_mean=0.5023 norm_overlap=0.9973 corr_cb=-0.1406
[EPOCH 041/089] train: loss=0.6530 acc=81.74% | val: loss=0.5947 acc=68.67% f1=76.36% auc=77.50% val_score=54.9733 val_score_bestthr=71.8036 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.248, mb=0.502, no=0.997, corr=-0.141) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 71.8036
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.1832 mb_mean=0.5021 norm_overlap=0.9979 corr_cb=-0.0956 topkJ=0.0241
[TRAIN][ep=042] loss=0.6521 acc=82.01%
[TRAIN][ep=042] mask_avg: mc_mean=0.2291 mb_mean=0.5023 norm_overlap=0.9973 corr_cb=-0.1331
[EPOCH 042/089] train: loss=0.6521 acc=82.01% | val: loss=0.5894 acc=68.67% f1=76.36% auc=77.91% val_score=56.0901 val_score_bestthr=71.8036 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.229, mb=0.502, no=0.997, corr=-0.133) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 71.8036
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.3244 mb_mean=0.5025 norm_overlap=0.9955 corr_cb=-0.2444 topkJ=0.0220
[TRAIN][ep=043] loss=0.6537 acc=82.82%
[TRAIN][ep=043] mask_avg: mc_mean=0.2478 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1545
[EPOCH 043/089] train: loss=0.6537 acc=82.82% | val: loss=0.6233 acc=68.67% f1=76.36% auc=76.05% val_score=56.0901 val_score_bestthr=71.8036 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.248, mb=0.502, no=0.997, corr=-0.154) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 71.8036
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2523 mb_mean=0.5062 norm_overlap=1.0008 corr_cb=0.0382 topkJ=0.0610
[TRAIN][ep=044] loss=0.6301 acc=83.22%
[TRAIN][ep=044] mask_avg: mc_mean=0.2474 mb_mean=0.5023 norm_overlap=0.9971 corr_cb=-0.1485
[EPOCH 044/089] train: loss=0.6301 acc=83.22% | val: loss=0.6295 acc=68.67% f1=76.36% auc=77.79% val_score=61.7270 val_score_bestthr=71.8036 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.247, mb=0.502, no=0.997, corr=-0.149) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 71.8036
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2976 mb_mean=0.5009 norm_overlap=0.9983 corr_cb=-0.0755 topkJ=0.0706
[TRAIN][ep=045] loss=0.6365 acc=84.16%
[TRAIN][ep=045] mask_avg: mc_mean=0.2579 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1516
[EPOCH 045/089] train: loss=0.6365 acc=84.16% | val: loss=0.6891 acc=71.08% f1=76.47% auc=75.64% val_score=64.2011 val_score_bestthr=71.5735 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.258, mb=0.502, no=0.997, corr=-0.152) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 71.5735
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.1984 mb_mean=0.5026 norm_overlap=0.9989 corr_cb=-0.0414 topkJ=0.0726
[TRAIN][ep=046] loss=0.6318 acc=83.62%
[TRAIN][ep=046] mask_avg: mc_mean=0.2165 mb_mean=0.5023 norm_overlap=0.9972 corr_cb=-0.1293
[EPOCH 046/089] train: loss=0.6318 acc=83.62% | val: loss=0.6434 acc=72.29% f1=76.77% auc=76.34% val_score=61.7776 val_score_bestthr=69.6873 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.216, mb=0.502, no=0.997, corr=-0.129) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 69.6873
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.2747 mb_mean=0.5033 norm_overlap=0.9965 corr_cb=-0.2031 topkJ=0.0149
[TRAIN][ep=047] loss=0.6286 acc=84.03%
[TRAIN][ep=047] mask_avg: mc_mean=0.2584 mb_mean=0.5023 norm_overlap=0.9969 corr_cb=-0.1568
[EPOCH 047/089] train: loss=0.6286 acc=84.03% | val: loss=0.6621 acc=67.47% f1=75.68% auc=75.64% val_score=56.0501 val_score_bestthr=71.0318 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.258, mb=0.502, no=0.997, corr=-0.157) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 71.0318
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.2730 mb_mean=0.5001 norm_overlap=0.9959 corr_cb=-0.2138 topkJ=0.0238
[TRAIN][ep=048] loss=0.5958 acc=85.64%
[TRAIN][ep=048] mask_avg: mc_mean=0.2438 mb_mean=0.5023 norm_overlap=0.9971 corr_cb=-0.1443
[EPOCH 048/089] train: loss=0.5958 acc=85.64% | val: loss=0.7528 acc=68.67% f1=75.93% auc=76.34% val_score=65.7650 val_score_bestthr=71.1606 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.244, mb=0.502, no=0.997, corr=-0.144) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 71.1606
[DBG][ep=049] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.2386 mb_mean=0.4996 norm_overlap=0.9937 corr_cb=-0.3019 topkJ=0.0202
[TRAIN][ep=049] loss=0.6727 acc=80.00%
[TRAIN][ep=049] mask_avg: mc_mean=0.2245 mb_mean=0.5023 norm_overlap=0.9968 corr_cb=-0.1498
[EPOCH 049/089] train: loss=0.6727 acc=80.00% | val: loss=0.7020 acc=69.88% f1=77.06% auc=75.41% val_score=69.0388 val_score_bestthr=74.1280 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.224, mb=0.502, no=0.997, corr=-0.150) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 73.6277 -> 74.1280
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=050] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.2441 mb_mean=0.5034 norm_overlap=0.9943 corr_cb=-0.2688 topkJ=0.0097
[TRAIN][ep=050] loss=0.5922 acc=86.85%
[TRAIN][ep=050] mask_avg: mc_mean=0.2553 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1768
[EPOCH 050/089] train: loss=0.5922 acc=86.85% | val: loss=0.6446 acc=71.08% f1=76.47% auc=75.23% val_score=62.5027 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.996, corr=-0.177) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=051] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.2079 mb_mean=0.5047 norm_overlap=1.0003 corr_cb=0.0158 topkJ=0.0678
[TRAIN][ep=051] loss=0.5807 acc=87.79%
[TRAIN][ep=051] mask_avg: mc_mean=0.2552 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1723
[EPOCH 051/089] train: loss=0.5807 acc=87.79% | val: loss=0.6461 acc=71.08% f1=76.47% auc=75.64% val_score=62.5027 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.997, corr=-0.172) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=052] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.2552 mb_mean=0.5020 norm_overlap=0.9955 corr_cb=-0.2312 topkJ=0.0365
[TRAIN][ep=052] loss=0.5726 acc=88.19%
[TRAIN][ep=052] mask_avg: mc_mean=0.2552 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1750
[EPOCH 052/089] train: loss=0.5726 acc=88.19% | val: loss=0.6489 acc=71.08% f1=76.47% auc=75.70% val_score=62.5027 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.996, corr=-0.175) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=053] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.2711 mb_mean=0.5023 norm_overlap=0.9967 corr_cb=-0.1828 topkJ=0.0273
[TRAIN][ep=053] loss=0.5748 acc=88.72%
[TRAIN][ep=053] mask_avg: mc_mean=0.2551 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1756
[EPOCH 053/089] train: loss=0.5748 acc=88.72% | val: loss=0.6511 acc=71.08% f1=76.47% auc=75.76% val_score=61.0754 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.997, corr=-0.176) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=054] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=054] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=054] mask(step0): mc_mean=0.2628 mb_mean=0.5013 norm_overlap=0.9963 corr_cb=-0.1746 topkJ=0.0289
[TRAIN][ep=054] loss=0.5673 acc=87.92%
[TRAIN][ep=054] mask_avg: mc_mean=0.2552 mb_mean=0.5023 norm_overlap=0.9964 corr_cb=-0.1805
[EPOCH 054/089] train: loss=0.5673 acc=87.92% | val: loss=0.6572 acc=71.08% f1=76.47% auc=75.76% val_score=56.5112 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.996, corr=-0.181) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=055] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=055] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=055] mask(step0): mc_mean=0.2611 mb_mean=0.5029 norm_overlap=0.9937 corr_cb=-0.3145 topkJ=0.0113
[TRAIN][ep=055] loss=0.5673 acc=88.46%
[TRAIN][ep=055] mask_avg: mc_mean=0.2553 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1760
[EPOCH 055/089] train: loss=0.5673 acc=88.46% | val: loss=0.6603 acc=71.08% f1=76.47% auc=75.76% val_score=61.0754 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.997, corr=-0.176) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=056] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=056] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=056] mask(step0): mc_mean=0.2261 mb_mean=0.5009 norm_overlap=0.9961 corr_cb=-0.2264 topkJ=0.0301
[TRAIN][ep=056] loss=0.5649 acc=87.92%
[TRAIN][ep=056] mask_avg: mc_mean=0.2553 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1770
[EPOCH 056/089] train: loss=0.5649 acc=87.92% | val: loss=0.6661 acc=71.08% f1=76.47% auc=75.70% val_score=56.5112 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.997, corr=-0.177) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=057] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=057] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=057] mask(step0): mc_mean=0.2726 mb_mean=0.5026 norm_overlap=0.9966 corr_cb=-0.1918 topkJ=0.0305
[TRAIN][ep=057] loss=0.5616 acc=88.32%
[TRAIN][ep=057] mask_avg: mc_mean=0.2552 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1736
[EPOCH 057/089] train: loss=0.5616 acc=88.32% | val: loss=0.6704 acc=71.08% f1=76.47% auc=75.99% val_score=56.5584 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.997, corr=-0.174) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=058] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=058] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=058] mask(step0): mc_mean=0.2138 mb_mean=0.5051 norm_overlap=0.9967 corr_cb=-0.1927 topkJ=0.0349
[TRAIN][ep=058] loss=0.5612 acc=88.05%
[TRAIN][ep=058] mask_avg: mc_mean=0.2552 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1722
[EPOCH 058/089] train: loss=0.5612 acc=88.05% | val: loss=0.6691 acc=71.08% f1=76.47% auc=76.05% val_score=61.0754 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.997, corr=-0.172) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=059] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=059] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=059] mask(step0): mc_mean=0.2820 mb_mean=0.4997 norm_overlap=0.9958 corr_cb=-0.2256 topkJ=0.0433
[TRAIN][ep=059] loss=0.5578 acc=88.72%
[TRAIN][ep=059] mask_avg: mc_mean=0.2553 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1743
[EPOCH 059/089] train: loss=0.5578 acc=88.72% | val: loss=0.6772 acc=71.08% f1=76.47% auc=75.93% val_score=62.3569 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.997, corr=-0.174) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=060] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=060] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=060] mask(step0): mc_mean=0.2781 mb_mean=0.4999 norm_overlap=0.9956 corr_cb=-0.2471 topkJ=0.0166
[TRAIN][ep=060] loss=0.5590 acc=89.26%
[TRAIN][ep=060] mask_avg: mc_mean=0.2552 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1744
[EPOCH 060/089] train: loss=0.5590 acc=89.26% | val: loss=0.6755 acc=71.08% f1=76.47% auc=75.81% val_score=61.0754 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.997, corr=-0.174) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=061] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=061] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=061] mask(step0): mc_mean=0.2819 mb_mean=0.5016 norm_overlap=0.9893 corr_cb=-0.4322 topkJ=0.0075
[TRAIN][ep=061] loss=0.5558 acc=89.40%
[TRAIN][ep=061] mask_avg: mc_mean=0.2552 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1738
[EPOCH 061/089] train: loss=0.5558 acc=89.40% | val: loss=0.6812 acc=71.08% f1=76.47% auc=75.81% val_score=61.0754 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.997, corr=-0.174) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=062] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=062] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=062] mask(step0): mc_mean=0.2782 mb_mean=0.5002 norm_overlap=0.9964 corr_cb=-0.2148 topkJ=0.0266
[TRAIN][ep=062] loss=0.5566 acc=87.92%
[TRAIN][ep=062] mask_avg: mc_mean=0.2552 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1742
[EPOCH 062/089] train: loss=0.5566 acc=87.92% | val: loss=0.6816 acc=71.08% f1=76.47% auc=75.93% val_score=61.7074 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.997, corr=-0.174) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=063] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=063] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=063] mask(step0): mc_mean=0.2469 mb_mean=0.5036 norm_overlap=0.9964 corr_cb=-0.1694 topkJ=0.0223
[TRAIN][ep=063] loss=0.5650 acc=86.98%
[TRAIN][ep=063] mask_avg: mc_mean=0.2552 mb_mean=0.5023 norm_overlap=0.9964 corr_cb=-0.1802
[EPOCH 063/089] train: loss=0.5650 acc=86.98% | val: loss=0.6840 acc=69.88% f1=75.73% auc=75.29% val_score=61.7074 val_score_bestthr=71.6631 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.996, corr=-0.180) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 71.6631
[DBG][ep=064] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=064] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=064] mask(step0): mc_mean=0.2545 mb_mean=0.5016 norm_overlap=0.9955 corr_cb=-0.2024 topkJ=0.0387
[TRAIN][ep=064] loss=0.5499 acc=89.13%
[TRAIN][ep=064] mask_avg: mc_mean=0.2552 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1773
[EPOCH 064/089] train: loss=0.5499 acc=89.13% | val: loss=0.6891 acc=69.88% f1=75.73% auc=75.52% val_score=61.7074 val_score_bestthr=71.6631 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.996, corr=-0.177) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 71.6631
[DBG][ep=065] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=065] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=065] mask(step0): mc_mean=0.2086 mb_mean=0.5027 norm_overlap=0.9956 corr_cb=-0.2211 topkJ=0.0271
[TRAIN][ep=065] loss=0.5526 acc=88.59%
[TRAIN][ep=065] mask_avg: mc_mean=0.2552 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1738
[EPOCH 065/089] train: loss=0.5526 acc=88.59% | val: loss=0.6887 acc=71.08% f1=76.47% auc=75.47% val_score=61.0754 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.997, corr=-0.174) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=066] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=066] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=066] mask(step0): mc_mean=0.2265 mb_mean=0.5044 norm_overlap=0.9961 corr_cb=-0.2181 topkJ=0.0304
[TRAIN][ep=066] loss=0.5489 acc=88.86%
[TRAIN][ep=066] mask_avg: mc_mean=0.2553 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1727
[EPOCH 066/089] train: loss=0.5489 acc=88.86% | val: loss=0.7059 acc=71.08% f1=76.47% auc=75.99% val_score=64.5698 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.997, corr=-0.173) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=067] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=067] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=067] mask(step0): mc_mean=0.2554 mb_mean=0.4998 norm_overlap=0.9983 corr_cb=-0.0773 topkJ=0.0463
[TRAIN][ep=067] loss=0.5486 acc=89.26%
[TRAIN][ep=067] mask_avg: mc_mean=0.2552 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1723
[EPOCH 067/089] train: loss=0.5486 acc=89.26% | val: loss=0.6995 acc=68.67% f1=75.93% auc=75.58% val_score=59.7057 val_score_bestthr=71.1606 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.997, corr=-0.172) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 71.1606
[DBG][ep=068] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=068] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=068] mask(step0): mc_mean=0.2444 mb_mean=0.5046 norm_overlap=0.9933 corr_cb=-0.3219 topkJ=0.0283
[TRAIN][ep=068] loss=0.5444 acc=87.65%
[TRAIN][ep=068] mask_avg: mc_mean=0.2552 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1762
[EPOCH 068/089] train: loss=0.5444 acc=87.65% | val: loss=0.7033 acc=71.08% f1=76.47% auc=75.93% val_score=60.3488 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.996, corr=-0.176) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=069] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=069] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=069] mask(step0): mc_mean=0.2823 mb_mean=0.5008 norm_overlap=0.9983 corr_cb=-0.0869 topkJ=0.0403
[TRAIN][ep=069] loss=0.5432 acc=88.72%
[TRAIN][ep=069] mask_avg: mc_mean=0.2551 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1726
[EPOCH 069/089] train: loss=0.5432 acc=88.72% | val: loss=0.7084 acc=68.67% f1=75.93% auc=75.47% val_score=54.1474 val_score_bestthr=71.1606 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.997, corr=-0.173) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 71.1606
[DBG][ep=070] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=070] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=070] mask(step0): mc_mean=0.2474 mb_mean=0.5018 norm_overlap=0.9976 corr_cb=-0.1131 topkJ=0.0628
[TRAIN][ep=070] loss=0.5422 acc=89.26%
[TRAIN][ep=070] mask_avg: mc_mean=0.2552 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1733
[EPOCH 070/089] train: loss=0.5422 acc=89.26% | val: loss=0.7211 acc=71.08% f1=76.47% auc=75.76% val_score=63.4537 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.997, corr=-0.173) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=071] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=071] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=071] mask(step0): mc_mean=0.2492 mb_mean=0.5030 norm_overlap=0.9943 corr_cb=-0.2987 topkJ=0.0132
[TRAIN][ep=071] loss=0.5432 acc=88.99%
[TRAIN][ep=071] mask_avg: mc_mean=0.2552 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1738
[EPOCH 071/089] train: loss=0.5432 acc=88.99% | val: loss=0.7070 acc=69.88% f1=76.64% auc=75.47% val_score=63.3989 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.997, corr=-0.174) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.2690
[DBG][ep=072] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=072] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=072] mask(step0): mc_mean=0.2667 mb_mean=0.5026 norm_overlap=0.9965 corr_cb=-0.1933 topkJ=0.0190
[TRAIN][ep=072] loss=0.5432 acc=88.32%
[TRAIN][ep=072] mask_avg: mc_mean=0.2552 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1737
[EPOCH 072/089] train: loss=0.5432 acc=88.32% | val: loss=0.7071 acc=69.88% f1=76.64% auc=75.41% val_score=61.0754 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.997, corr=-0.174) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.2690
[DBG][ep=073] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=073] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=073] mask(step0): mc_mean=0.2342 mb_mean=0.5011 norm_overlap=0.9989 corr_cb=-0.0666 topkJ=0.0692
[TRAIN][ep=073] loss=0.5408 acc=88.99%
[TRAIN][ep=073] mask_avg: mc_mean=0.2553 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1755
[EPOCH 073/089] train: loss=0.5408 acc=88.99% | val: loss=0.7194 acc=69.88% f1=76.64% auc=75.29% val_score=54.1474 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.997, corr=-0.175) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.2690
[DBG][ep=074] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=074] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=074] mask(step0): mc_mean=0.2273 mb_mean=0.5028 norm_overlap=0.9961 corr_cb=-0.1989 topkJ=0.0218
[TRAIN][ep=074] loss=0.5421 acc=87.92%
[TRAIN][ep=074] mask_avg: mc_mean=0.2553 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1767
[EPOCH 074/089] train: loss=0.5421 acc=87.92% | val: loss=0.7129 acc=69.88% f1=76.64% auc=75.47% val_score=61.0754 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.996, corr=-0.177) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.2690
[DBG][ep=075] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=075] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=075] mask(step0): mc_mean=0.3154 mb_mean=0.5013 norm_overlap=0.9930 corr_cb=-0.3598 topkJ=0.0064
[TRAIN][ep=075] loss=0.5433 acc=88.46%
[TRAIN][ep=075] mask_avg: mc_mean=0.2552 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1729
[EPOCH 075/089] train: loss=0.5433 acc=88.46% | val: loss=0.7130 acc=71.08% f1=76.47% auc=75.52% val_score=61.0754 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.997, corr=-0.173) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=076] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=076] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=076] mask(step0): mc_mean=0.2102 mb_mean=0.5030 norm_overlap=0.9992 corr_cb=-0.0403 topkJ=0.0593
[TRAIN][ep=076] loss=0.5426 acc=88.32%
[TRAIN][ep=076] mask_avg: mc_mean=0.2552 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1739
[EPOCH 076/089] train: loss=0.5426 acc=88.32% | val: loss=0.7142 acc=69.88% f1=76.64% auc=75.81% val_score=61.0754 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.997, corr=-0.174) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.2690
[DBG][ep=077] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=077] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=077] mask(step0): mc_mean=0.2311 mb_mean=0.5034 norm_overlap=0.9945 corr_cb=-0.2885 topkJ=0.0165
[TRAIN][ep=077] loss=0.5378 acc=88.86%
[TRAIN][ep=077] mask_avg: mc_mean=0.2552 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1745
[EPOCH 077/089] train: loss=0.5378 acc=88.86% | val: loss=0.7240 acc=69.88% f1=76.64% auc=75.47% val_score=60.4330 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.997, corr=-0.174) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.2690
[DBG][ep=078] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=078] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=078] mask(step0): mc_mean=0.2476 mb_mean=0.5031 norm_overlap=0.9973 corr_cb=-0.1086 topkJ=0.0382
[TRAIN][ep=078] loss=0.5352 acc=88.86%
[TRAIN][ep=078] mask_avg: mc_mean=0.2552 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1768
[EPOCH 078/089] train: loss=0.5352 acc=88.86% | val: loss=0.7240 acc=69.88% f1=76.64% auc=75.17% val_score=61.0754 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.996, corr=-0.177) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.2690
[DBG][ep=079] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=079] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=079] mask(step0): mc_mean=0.2706 mb_mean=0.4999 norm_overlap=0.9963 corr_cb=-0.1974 topkJ=0.0442
[TRAIN][ep=079] loss=0.5315 acc=89.53%
[TRAIN][ep=079] mask_avg: mc_mean=0.2553 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1738
[EPOCH 079/089] train: loss=0.5315 acc=89.53% | val: loss=0.7433 acc=69.88% f1=76.64% auc=75.47% val_score=64.5698 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.502, no=0.997, corr=-0.174) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.2690
[EARLY STOP] no improvement for 30 epochs. best_epoch=49
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
=============== FIT DONE ===============
[BEST] epoch=49 | val_acc=69.88% | val_f1=77.06% | val_auc=75.41% | val_score=69.0388 | val_score_bestthr=74.1280
[TEST@BEST] thr_used=0.470 | acc=62.80% f1=69.08% auc=63.01% | SP_sex=2.82% EO_sex=3.75% SP_age=12.41% EO_age=6.49%
[TIME] 1.94 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/summary_fold_0.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5259 mb_mean=0.5010 norm_overlap=0.9999 corr_cb=-0.0912 topkJ=0.0676
[TRAIN][ep=000] loss=0.6939 acc=50.47%
[TRAIN][ep=000] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0996
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5274 mb_mean=0.4997 norm_overlap=0.9999 corr_cb=-0.2567 topkJ=0.0254
[TRAIN][ep=001] loss=0.6920 acc=50.47%
[TRAIN][ep=001] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0926
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5297 mb_mean=0.5053 norm_overlap=1.0000 corr_cb=0.0154 topkJ=0.0969
[TRAIN][ep=002] loss=0.6899 acc=52.89%
[TRAIN][ep=002] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0983
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5296 mb_mean=0.5000 norm_overlap=0.9999 corr_cb=-0.1407 topkJ=0.0490
[TRAIN][ep=003] loss=0.6882 acc=54.23%
[TRAIN][ep=003] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0952
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5295 mb_mean=0.4987 norm_overlap=0.9999 corr_cb=-0.1840 topkJ=0.0339
[TRAIN][ep=004] loss=0.6887 acc=53.42%
[TRAIN][ep=004] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.1002
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5288 mb_mean=0.5009 norm_overlap=0.9999 corr_cb=-0.1690 topkJ=0.0368
[TRAIN][ep=005] loss=0.6834 acc=56.91%
[TRAIN][ep=005] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0988
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5323 mb_mean=0.5018 norm_overlap=0.9999 corr_cb=-0.2431 topkJ=0.0234
[TRAIN][ep=006] loss=0.6844 acc=54.63%
[TRAIN][ep=006] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0978
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5339 mb_mean=0.5021 norm_overlap=1.0000 corr_cb=-0.0185 topkJ=0.0321
[TRAIN][ep=007] loss=0.6826 acc=57.72%
[TRAIN][ep=007] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0955
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5308 mb_mean=0.5020 norm_overlap=1.0000 corr_cb=-0.0361 topkJ=0.0444
[TRAIN][ep=008] loss=0.6776 acc=58.12%
[TRAIN][ep=008] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0938
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5248 mb_mean=0.5048 norm_overlap=0.9999 corr_cb=-0.0945 topkJ=0.0690
[TRAIN][ep=009] loss=0.6759 acc=58.93%
[TRAIN][ep=009] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0965
================= FIT START (fold=0) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5327 mb_mean=0.5004 norm_overlap=1.0000 corr_cb=-0.0395 topkJ=0.0304
[TRAIN][ep=000] loss=0.6709 acc=61.48%
[TRAIN][ep=000] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0992
[EPOCH 000/089] train: loss=0.6709 acc=61.48% | val: loss=0.6686 acc=62.65% f1=69.31% auc=65.99% val_score=63.8688 val_score_bestthr=64.9727 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.099) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 64.9727
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5321 mb_mean=0.5010 norm_overlap=0.9998 corr_cb=-0.3401 topkJ=0.0082
[TRAIN][ep=001] loss=0.6667 acc=61.34%
[TRAIN][ep=001] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0976
[EPOCH 001/089] train: loss=0.6667 acc=61.34% | val: loss=0.6664 acc=61.45% f1=68.63% auc=65.58% val_score=50.8549 val_score_bestthr=63.8688 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.098) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9727 -> 63.8688
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5308 mb_mean=0.5031 norm_overlap=1.0000 corr_cb=-0.0851 topkJ=0.0316
[TRAIN][ep=002] loss=0.6610 acc=60.94%
[TRAIN][ep=002] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0965
[EPOCH 002/089] train: loss=0.6610 acc=60.94% | val: loss=0.6768 acc=56.63% f1=64.71% auc=64.19% val_score=48.1618 val_score_bestthr=58.9427 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.097) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9727 -> 58.9427
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5303 mb_mean=0.5028 norm_overlap=1.0000 corr_cb=0.0572 topkJ=0.0336
[TRAIN][ep=003] loss=0.6553 acc=64.30%
[TRAIN][ep=003] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0987
[EPOCH 003/089] train: loss=0.6553 acc=64.30% | val: loss=0.6566 acc=62.65% f1=69.31% auc=66.69% val_score=50.8414 val_score_bestthr=64.9727 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.099) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9727 -> 64.9727
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5315 mb_mean=0.5048 norm_overlap=1.0000 corr_cb=-0.0454 topkJ=0.0668
[TRAIN][ep=004] loss=0.6487 acc=65.10%
[TRAIN][ep=004] mask_avg: mc_mean=0.5292 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0985
[EPOCH 004/089] train: loss=0.6487 acc=65.10% | val: loss=0.6512 acc=62.65% f1=69.31% auc=67.79% val_score=56.4760 val_score_bestthr=64.9727 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.099) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9727 -> 64.9727
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5300 mb_mean=0.5015 norm_overlap=0.9999 corr_cb=-0.2288 topkJ=0.0177
[TRAIN][ep=005] loss=1.2314 acc=64.97%
[TRAIN][ep=005] mask_avg: mc_mean=0.3784 mb_mean=0.5023 norm_overlap=1.0007 corr_cb=0.1906
[EPOCH 005/089] train: loss=1.2314 acc=64.97% | val: loss=0.6509 acc=63.86% f1=72.73% auc=70.58% val_score=53.6112 val_score_bestthr=61.1633 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.378, mb=0.502, no=1.001, corr=0.191) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9727 -> 61.1633
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2790 mb_mean=0.5013 norm_overlap=1.0021 corr_cb=0.3853 topkJ=0.1325
[TRAIN][ep=006] loss=1.0103 acc=65.77%
[TRAIN][ep=006] mask_avg: mc_mean=0.2531 mb_mean=0.5023 norm_overlap=1.0013 corr_cb=0.1865
[EPOCH 006/089] train: loss=1.0103 acc=65.77% | val: loss=0.6404 acc=62.65% f1=72.07% auc=71.45% val_score=60.2553 val_score_bestthr=66.1116 | dyn(w_pfs=0.240, w_sup=0.190, w_csuf=0.140, stage2=False) | mask(mc=0.253, mb=0.502, no=1.001, corr=0.186) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 64.9727 -> 66.1116
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2305 mb_mean=0.5027 norm_overlap=1.0018 corr_cb=0.2136 topkJ=0.0739
[TRAIN][ep=007] loss=1.0838 acc=65.37%
[TRAIN][ep=007] mask_avg: mc_mean=0.2233 mb_mean=0.5023 norm_overlap=1.0013 corr_cb=0.1487
[EPOCH 007/089] train: loss=1.0838 acc=65.37% | val: loss=0.6335 acc=65.06% f1=72.90% auc=72.79% val_score=59.6463 val_score_bestthr=65.2656 | dyn(w_pfs=0.280, w_sup=0.230, w_csuf=0.180, stage2=False) | mask(mc=0.223, mb=0.502, no=1.001, corr=0.149) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.1116 -> 65.2656
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2192 mb_mean=0.5013 norm_overlap=1.0006 corr_cb=0.0627 topkJ=0.0697
[TRAIN][ep=008] loss=1.1482 acc=68.46%
[TRAIN][ep=008] mask_avg: mc_mean=0.2085 mb_mean=0.5023 norm_overlap=1.0010 corr_cb=0.1125
[EPOCH 008/089] train: loss=1.1482 acc=68.46% | val: loss=0.6520 acc=63.86% f1=69.39% auc=70.06% val_score=50.8167 val_score_bestthr=61.0557 | dyn(w_pfs=0.320, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.208, mb=0.502, no=1.001, corr=0.112) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.1116 -> 61.0557
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2057 mb_mean=0.5024 norm_overlap=1.0005 corr_cb=0.0423 topkJ=0.0782
[TRAIN][ep=009] loss=1.1980 acc=66.17%
[TRAIN][ep=009] mask_avg: mc_mean=0.1864 mb_mean=0.5023 norm_overlap=1.0010 corr_cb=0.0910
[EPOCH 009/089] train: loss=1.1980 acc=66.17% | val: loss=0.6438 acc=65.06% f1=73.39% auc=73.72% val_score=64.6845 val_score_bestthr=68.3138 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.186, mb=0.502, no=1.001, corr=0.091) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 66.1116 -> 68.3138
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1913 mb_mean=0.5010 norm_overlap=1.0014 corr_cb=0.1444 topkJ=0.0727
[TRAIN][ep=010] loss=1.1987 acc=66.17%
[TRAIN][ep=010] mask_avg: mc_mean=0.1912 mb_mean=0.5023 norm_overlap=1.0006 corr_cb=0.0478
[EPOCH 010/089] train: loss=1.1987 acc=66.17% | val: loss=0.6228 acc=63.86% f1=73.68% auc=73.26% val_score=55.7437 val_score_bestthr=66.8001 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.191, mb=0.502, no=1.001, corr=0.048) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.3138 -> 66.8001
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1882 mb_mean=0.5027 norm_overlap=0.9981 corr_cb=-0.1882 topkJ=0.0582
[TRAIN][ep=011] loss=1.1731 acc=70.47%
[TRAIN][ep=011] mask_avg: mc_mean=0.1835 mb_mean=0.5023 norm_overlap=1.0002 corr_cb=0.0174
[EPOCH 011/089] train: loss=1.1731 acc=70.47% | val: loss=0.6130 acc=66.27% f1=73.58% auc=75.87% val_score=61.5955 val_score_bestthr=65.1237 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.183, mb=0.502, no=1.000, corr=0.017) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.3138 -> 65.1237
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1785 mb_mean=0.5005 norm_overlap=1.0001 corr_cb=0.0062 topkJ=0.1107
[TRAIN][ep=012] loss=1.1759 acc=68.59%
[TRAIN][ep=012] mask_avg: mc_mean=0.1842 mb_mean=0.5023 norm_overlap=0.9998 corr_cb=-0.0158
[EPOCH 012/089] train: loss=1.1759 acc=68.59% | val: loss=0.6702 acc=65.06% f1=70.10% auc=71.45% val_score=50.4880 val_score_bestthr=60.4149 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.184, mb=0.502, no=1.000, corr=-0.016) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.3138 -> 60.4149
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1942 mb_mean=0.5050 norm_overlap=0.9989 corr_cb=-0.0867 topkJ=0.0745
[TRAIN][ep=013] loss=1.1585 acc=69.53%
[TRAIN][ep=013] mask_avg: mc_mean=0.1727 mb_mean=0.5023 norm_overlap=0.9996 corr_cb=-0.0290
[EPOCH 013/089] train: loss=1.1585 acc=69.53% | val: loss=0.6210 acc=71.08% f1=70.00% auc=75.35% val_score=43.2724 val_score_bestthr=64.6065 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.173, mb=0.502, no=1.000, corr=-0.029) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.3138 -> 64.6065
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1650 mb_mean=0.4973 norm_overlap=1.0002 corr_cb=0.0164 topkJ=0.0575
[TRAIN][ep=014] loss=1.1420 acc=70.60%
[TRAIN][ep=014] mask_avg: mc_mean=0.1898 mb_mean=0.5023 norm_overlap=0.9992 corr_cb=-0.0613
[EPOCH 014/089] train: loss=1.1420 acc=70.60% | val: loss=0.5858 acc=72.29% f1=70.89% auc=76.69% val_score=57.2167 val_score_bestthr=64.9804 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.190, mb=0.502, no=0.999, corr=-0.061) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.3138 -> 64.9804
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1664 mb_mean=0.5022 norm_overlap=1.0003 corr_cb=0.0201 topkJ=0.0641
[TRAIN][ep=015] loss=0.9647 acc=69.93%
[TRAIN][ep=015] mask_avg: mc_mean=0.1940 mb_mean=0.5023 norm_overlap=0.9989 corr_cb=-0.0798
[EPOCH 015/089] train: loss=0.9647 acc=69.93% | val: loss=0.5816 acc=65.06% f1=73.87% auc=78.60% val_score=61.2871 val_score_bestthr=65.4577 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.194, mb=0.502, no=0.999, corr=-0.080) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.3138 -> 65.4577
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1795 mb_mean=0.5002 norm_overlap=0.9990 corr_cb=-0.0785 topkJ=0.0421
[TRAIN][ep=016] loss=0.7589 acc=71.01%
[TRAIN][ep=016] mask_avg: mc_mean=0.1975 mb_mean=0.5023 norm_overlap=0.9984 corr_cb=-0.1055
[EPOCH 016/089] train: loss=0.7589 acc=71.01% | val: loss=0.5753 acc=74.70% f1=72.73% auc=77.62% val_score=68.0866 val_score_bestthr=68.0866 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.197, mb=0.502, no=0.998, corr=-0.105) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.3138 -> 68.0866
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.2292 mb_mean=0.5033 norm_overlap=0.9970 corr_cb=-0.1897 topkJ=0.0256
[TRAIN][ep=017] loss=0.7156 acc=71.14%
[TRAIN][ep=017] mask_avg: mc_mean=0.2096 mb_mean=0.5023 norm_overlap=0.9983 corr_cb=-0.1094
[EPOCH 017/089] train: loss=0.7156 acc=71.14% | val: loss=0.5778 acc=67.47% f1=73.27% auc=78.08% val_score=65.1695 val_score_bestthr=67.0451 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.210, mb=0.502, no=0.998, corr=-0.109) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.3138 -> 67.0451
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1916 mb_mean=0.5025 norm_overlap=0.9990 corr_cb=-0.0612 topkJ=0.0466
[TRAIN][ep=018] loss=0.6872 acc=72.75%
[TRAIN][ep=018] mask_avg: mc_mean=0.1972 mb_mean=0.5023 norm_overlap=0.9984 corr_cb=-0.0969
[EPOCH 018/089] train: loss=0.6872 acc=72.75% | val: loss=0.5966 acc=67.47% f1=73.27% auc=78.95% val_score=65.9149 val_score_bestthr=67.0451 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.197, mb=0.502, no=0.998, corr=-0.097) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.3138 -> 67.0451
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1595 mb_mean=0.5022 norm_overlap=0.9969 corr_cb=-0.1935 topkJ=0.0565
[TRAIN][ep=019] loss=0.6800 acc=73.29%
[TRAIN][ep=019] mask_avg: mc_mean=0.1983 mb_mean=0.5023 norm_overlap=0.9982 corr_cb=-0.1077
[EPOCH 019/089] train: loss=0.6800 acc=73.29% | val: loss=0.5568 acc=73.49% f1=71.79% auc=78.26% val_score=60.5060 val_score_bestthr=65.3216 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.198, mb=0.502, no=0.998, corr=-0.108) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.3138 -> 65.3216
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.2304 mb_mean=0.5020 norm_overlap=0.9988 corr_cb=-0.0589 topkJ=0.0843
[TRAIN][ep=020] loss=0.6741 acc=72.89%
[TRAIN][ep=020] mask_avg: mc_mean=0.2029 mb_mean=0.5023 norm_overlap=0.9981 corr_cb=-0.1108
[EPOCH 020/089] train: loss=0.6741 acc=72.89% | val: loss=0.5808 acc=73.49% f1=71.05% auc=76.40% val_score=66.6390 val_score_bestthr=66.6390 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.203, mb=0.502, no=0.998, corr=-0.111) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.3138 -> 66.6390
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2362 mb_mean=0.5058 norm_overlap=0.9976 corr_cb=-0.1449 topkJ=0.0339
[TRAIN][ep=021] loss=0.6856 acc=71.68%
[TRAIN][ep=021] mask_avg: mc_mean=0.2109 mb_mean=0.5023 norm_overlap=0.9979 corr_cb=-0.1234
[EPOCH 021/089] train: loss=0.6856 acc=71.68% | val: loss=0.5649 acc=74.70% f1=72.00% auc=78.20% val_score=66.6390 val_score_bestthr=69.4062 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.211, mb=0.502, no=0.998, corr=-0.123) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 68.3138 -> 69.4062
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2552 mb_mean=0.4996 norm_overlap=0.9986 corr_cb=-0.0783 topkJ=0.0360
[TRAIN][ep=022] loss=0.7372 acc=74.63%
[TRAIN][ep=022] mask_avg: mc_mean=0.2243 mb_mean=0.5023 norm_overlap=0.9976 corr_cb=-0.1451
[EPOCH 022/089] train: loss=0.7372 acc=74.63% | val: loss=0.5591 acc=75.90% f1=74.36% auc=78.08% val_score=69.4062 val_score_bestthr=68.9443 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.224, mb=0.502, no=0.998, corr=-0.145) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.4062 -> 68.9443
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1390 mb_mean=0.5023 norm_overlap=0.9976 corr_cb=-0.1238 topkJ=0.0262
[TRAIN][ep=023] loss=0.7997 acc=75.03%
[TRAIN][ep=023] mask_avg: mc_mean=0.2161 mb_mean=0.5023 norm_overlap=0.9978 corr_cb=-0.1282
[EPOCH 023/089] train: loss=0.7997 acc=75.03% | val: loss=0.5726 acc=75.90% f1=73.68% auc=77.67% val_score=61.6465 val_score_bestthr=70.8552 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.216, mb=0.502, no=0.998, corr=-0.128) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 69.4062 -> 70.8552
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2183 mb_mean=0.5016 norm_overlap=0.9966 corr_cb=-0.2062 topkJ=0.0452
[TRAIN][ep=024] loss=0.8987 acc=72.89%
[TRAIN][ep=024] mask_avg: mc_mean=0.2162 mb_mean=0.5023 norm_overlap=0.9978 corr_cb=-0.1268
[EPOCH 024/089] train: loss=0.8987 acc=72.89% | val: loss=0.5429 acc=75.90% f1=74.36% auc=79.48% val_score=62.8550 val_score_bestthr=71.3284 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.216, mb=0.502, no=0.998, corr=-0.127) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 70.8552 -> 71.3284
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1733 mb_mean=0.4998 norm_overlap=1.0004 corr_cb=0.0155 topkJ=0.0522
[TRAIN][ep=025] loss=0.9457 acc=75.17%
[TRAIN][ep=025] mask_avg: mc_mean=0.1966 mb_mean=0.5023 norm_overlap=0.9979 corr_cb=-0.1146
[EPOCH 025/089] train: loss=0.9457 acc=75.17% | val: loss=0.5514 acc=75.90% f1=73.68% auc=78.20% val_score=69.7097 val_score_bestthr=70.8552 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.197, mb=0.502, no=0.998, corr=-0.115) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.3284 -> 70.8552
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2298 mb_mean=0.5001 norm_overlap=0.9970 corr_cb=-0.1880 topkJ=0.0182
[TRAIN][ep=026] loss=1.0141 acc=75.84%
[TRAIN][ep=026] mask_avg: mc_mean=0.2214 mb_mean=0.5023 norm_overlap=0.9978 corr_cb=-0.1251
[EPOCH 026/089] train: loss=1.0141 acc=75.84% | val: loss=0.5392 acc=75.90% f1=74.36% auc=79.36% val_score=55.9464 val_score_bestthr=71.3284 | dyn(w_pfs=0.240, w_sup=0.240, w_csuf=0.200, stage2=False) | mask(mc=0.221, mb=0.502, no=0.998, corr=-0.125) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.3284 -> 71.3284
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1647 mb_mean=0.5032 norm_overlap=0.9971 corr_cb=-0.1608 topkJ=0.0354
[TRAIN][ep=027] loss=1.0098 acc=75.70%
[TRAIN][ep=027] mask_avg: mc_mean=0.2194 mb_mean=0.5023 norm_overlap=0.9977 corr_cb=-0.1254
[EPOCH 027/089] train: loss=1.0098 acc=75.70% | val: loss=0.5801 acc=73.49% f1=72.50% auc=77.56% val_score=64.4158 val_score_bestthr=68.2341 | dyn(w_pfs=0.280, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.219, mb=0.502, no=0.998, corr=-0.125) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 71.3284 -> 68.2341
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2051 mb_mean=0.5016 norm_overlap=1.0000 corr_cb=-0.0021 topkJ=0.0487
[TRAIN][ep=028] loss=1.0100 acc=77.58%
[TRAIN][ep=028] mask_avg: mc_mean=0.2220 mb_mean=0.5023 norm_overlap=0.9979 corr_cb=-0.1123
[EPOCH 028/089] train: loss=1.0100 acc=77.58% | val: loss=0.5460 acc=78.31% f1=77.50% auc=78.72% val_score=64.0724 val_score_bestthr=72.6051 | dyn(w_pfs=0.320, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.222, mb=0.502, no=0.998, corr=-0.112) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 71.3284 -> 72.6051
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2230 mb_mean=0.5039 norm_overlap=0.9984 corr_cb=-0.0914 topkJ=0.0736
[TRAIN][ep=029] loss=1.0325 acc=77.85%
[TRAIN][ep=029] mask_avg: mc_mean=0.2285 mb_mean=0.5023 norm_overlap=0.9978 corr_cb=-0.1221
[EPOCH 029/089] train: loss=1.0325 acc=77.85% | val: loss=0.5457 acc=75.90% f1=75.00% auc=80.06% val_score=65.2355 val_score_bestthr=70.8712 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.229, mb=0.502, no=0.998, corr=-0.122) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.6051 -> 70.8712
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.1411 mb_mean=0.5015 norm_overlap=0.9978 corr_cb=-0.1076 topkJ=0.0325
[TRAIN][ep=030] loss=1.0337 acc=76.11%
[TRAIN][ep=030] mask_avg: mc_mean=0.2267 mb_mean=0.5023 norm_overlap=0.9977 corr_cb=-0.1280
[EPOCH 030/089] train: loss=1.0337 acc=76.11% | val: loss=0.5801 acc=74.70% f1=73.42% auc=79.71% val_score=64.4158 val_score_bestthr=72.0379 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.227, mb=0.502, no=0.998, corr=-0.128) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.6051 -> 72.0379
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2915 mb_mean=0.5032 norm_overlap=0.9982 corr_cb=-0.1262 topkJ=0.0383
[TRAIN][ep=031] loss=1.0318 acc=77.05%
[TRAIN][ep=031] mask_avg: mc_mean=0.2279 mb_mean=0.5023 norm_overlap=0.9973 corr_cb=-0.1464
[EPOCH 031/089] train: loss=1.0318 acc=77.05% | val: loss=0.5731 acc=73.49% f1=72.50% auc=78.66% val_score=64.3576 val_score_bestthr=68.2341 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.228, mb=0.502, no=0.997, corr=-0.146) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.6051 -> 68.2341
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2137 mb_mean=0.5001 norm_overlap=0.9950 corr_cb=-0.2461 topkJ=0.0335
[TRAIN][ep=032] loss=1.0289 acc=78.12%
[TRAIN][ep=032] mask_avg: mc_mean=0.2218 mb_mean=0.5023 norm_overlap=0.9971 corr_cb=-0.1515
[EPOCH 032/089] train: loss=1.0289 acc=78.12% | val: loss=0.5572 acc=67.47% f1=76.11% auc=78.95% val_score=52.5151 val_score_bestthr=72.8858 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.222, mb=0.502, no=0.997, corr=-0.151) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 72.6051 -> 72.8858
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1841 mb_mean=0.5007 norm_overlap=0.9988 corr_cb=-0.0674 topkJ=0.0672
[TRAIN][ep=033] loss=0.9977 acc=79.06%
[TRAIN][ep=033] mask_avg: mc_mean=0.2162 mb_mean=0.5023 norm_overlap=0.9971 corr_cb=-0.1425
[EPOCH 033/089] train: loss=0.9977 acc=79.06% | val: loss=0.5565 acc=68.67% f1=75.93% auc=79.36% val_score=54.8455 val_score_bestthr=68.2387 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.216, mb=0.502, no=0.997, corr=-0.143) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.8858 -> 68.2387
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2822 mb_mean=0.5049 norm_overlap=0.9958 corr_cb=-0.2428 topkJ=0.0231
[TRAIN][ep=034] loss=0.9966 acc=78.79%
[TRAIN][ep=034] mask_avg: mc_mean=0.2352 mb_mean=0.5023 norm_overlap=0.9971 corr_cb=-0.1496
[EPOCH 034/089] train: loss=0.9966 acc=78.79% | val: loss=0.5939 acc=67.47% f1=75.68% auc=79.07% val_score=68.0929 val_score_bestthr=70.6985 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.235, mb=0.502, no=0.997, corr=-0.150) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.8858 -> 70.6985
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.3202 mb_mean=0.5025 norm_overlap=0.9950 corr_cb=-0.2428 topkJ=0.0214
[TRAIN][ep=035] loss=0.9764 acc=80.40%
[TRAIN][ep=035] mask_avg: mc_mean=0.2665 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1737
[EPOCH 035/089] train: loss=0.9764 acc=80.40% | val: loss=0.5757 acc=68.67% f1=74.00% auc=77.73% val_score=64.9083 val_score_bestthr=67.0695 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.266, mb=0.502, no=0.997, corr=-0.174) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.8858 -> 67.0695
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2168 mb_mean=0.5025 norm_overlap=0.9973 corr_cb=-0.1275 topkJ=0.0576
[TRAIN][ep=036] loss=0.9790 acc=80.00%
[TRAIN][ep=036] mask_avg: mc_mean=0.2342 mb_mean=0.5023 norm_overlap=0.9973 corr_cb=-0.1394
[EPOCH 036/089] train: loss=0.9790 acc=80.00% | val: loss=0.5675 acc=69.88% f1=76.19% auc=78.14% val_score=59.8282 val_score_bestthr=70.9204 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.234, mb=0.502, no=0.997, corr=-0.139) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.8858 -> 70.9204
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1561 mb_mean=0.5040 norm_overlap=0.9957 corr_cb=-0.1897 topkJ=0.0308
[TRAIN][ep=037] loss=0.9652 acc=80.40%
[TRAIN][ep=037] mask_avg: mc_mean=0.2330 mb_mean=0.5023 norm_overlap=0.9973 corr_cb=-0.1406
[EPOCH 037/089] train: loss=0.9652 acc=80.40% | val: loss=0.5618 acc=71.08% f1=76.00% auc=79.01% val_score=55.9785 val_score_bestthr=71.3709 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.233, mb=0.502, no=0.997, corr=-0.141) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.8858 -> 71.3709
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2745 mb_mean=0.5023 norm_overlap=0.9930 corr_cb=-0.3464 topkJ=0.0103
[TRAIN][ep=038] loss=0.7564 acc=81.88%
[TRAIN][ep=038] mask_avg: mc_mean=0.2515 mb_mean=0.5023 norm_overlap=0.9969 corr_cb=-0.1605
[EPOCH 038/089] train: loss=0.7564 acc=81.88% | val: loss=0.5796 acc=68.67% f1=76.36% auc=77.56% val_score=53.6829 val_score_bestthr=71.8036 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.252, mb=0.502, no=0.997, corr=-0.160) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.8858 -> 71.8036
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2754 mb_mean=0.5023 norm_overlap=0.9951 corr_cb=-0.2688 topkJ=0.0266
[TRAIN][ep=039] loss=0.5745 acc=82.15%
[TRAIN][ep=039] mask_avg: mc_mean=0.2494 mb_mean=0.5023 norm_overlap=0.9972 corr_cb=-0.1442
[EPOCH 039/089] train: loss=0.5745 acc=82.15% | val: loss=0.6014 acc=67.47% f1=75.68% auc=76.45% val_score=57.3730 val_score_bestthr=69.4811 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.249, mb=0.502, no=0.997, corr=-0.144) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.8858 -> 69.4811
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.1833 mb_mean=0.5019 norm_overlap=0.9970 corr_cb=-0.1236 topkJ=0.0425
[TRAIN][ep=040] loss=0.5417 acc=82.01%
[TRAIN][ep=040] mask_avg: mc_mean=0.2307 mb_mean=0.5023 norm_overlap=0.9972 corr_cb=-0.1393
[EPOCH 040/089] train: loss=0.5417 acc=82.01% | val: loss=0.5954 acc=67.47% f1=75.68% auc=78.08% val_score=64.3697 val_score_bestthr=70.6985 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.231, mb=0.502, no=0.997, corr=-0.139) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.8858 -> 70.6985
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.2606 mb_mean=0.5002 norm_overlap=0.9980 corr_cb=-0.1202 topkJ=0.0251
[TRAIN][ep=041] loss=0.5181 acc=82.28%
[TRAIN][ep=041] mask_avg: mc_mean=0.2542 mb_mean=0.5023 norm_overlap=0.9973 corr_cb=-0.1399
[EPOCH 041/089] train: loss=0.5181 acc=82.28% | val: loss=0.6012 acc=69.88% f1=76.19% auc=76.80% val_score=54.9733 val_score_bestthr=70.9204 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.254, mb=0.502, no=0.997, corr=-0.140) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.8858 -> 70.9204
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.1859 mb_mean=0.5021 norm_overlap=0.9979 corr_cb=-0.0989 topkJ=0.0229
[TRAIN][ep=042] loss=0.5167 acc=82.82%
[TRAIN][ep=042] mask_avg: mc_mean=0.2317 mb_mean=0.5023 norm_overlap=0.9973 corr_cb=-0.1307
[EPOCH 042/089] train: loss=0.5167 acc=82.82% | val: loss=0.6001 acc=69.88% f1=73.12% auc=77.33% val_score=56.0901 val_score_bestthr=70.0020 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.232, mb=0.502, no=0.997, corr=-0.131) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.8858 -> 70.0020
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.3329 mb_mean=0.5025 norm_overlap=0.9954 corr_cb=-0.2500 topkJ=0.0195
[TRAIN][ep=043] loss=0.5184 acc=83.22%
[TRAIN][ep=043] mask_avg: mc_mean=0.2501 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1506
[EPOCH 043/089] train: loss=0.5184 acc=83.22% | val: loss=0.6349 acc=67.47% f1=75.68% auc=75.47% val_score=56.0901 val_score_bestthr=71.0318 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.250, mb=0.502, no=0.997, corr=-0.151) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.8858 -> 71.0318
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2516 mb_mean=0.5062 norm_overlap=1.0011 corr_cb=0.0516 topkJ=0.0633
[TRAIN][ep=044] loss=0.4954 acc=83.49%
[TRAIN][ep=044] mask_avg: mc_mean=0.2499 mb_mean=0.5023 norm_overlap=0.9972 corr_cb=-0.1438
[EPOCH 044/089] train: loss=0.4954 acc=83.49% | val: loss=0.6368 acc=68.67% f1=75.93% auc=76.40% val_score=61.8718 val_score_bestthr=71.1606 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.250, mb=0.502, no=0.997, corr=-0.144) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.8858 -> 71.1606
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.3029 mb_mean=0.5009 norm_overlap=0.9985 corr_cb=-0.0680 topkJ=0.0716
[TRAIN][ep=045] loss=0.5026 acc=84.03%
[TRAIN][ep=045] mask_avg: mc_mean=0.2587 mb_mean=0.5023 norm_overlap=0.9971 corr_cb=-0.1474
[EPOCH 045/089] train: loss=0.5026 acc=84.03% | val: loss=0.6942 acc=69.88% f1=76.64% auc=75.00% val_score=60.3728 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.259, mb=0.502, no=0.997, corr=-0.147) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.8858 -> 72.2690
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.1879 mb_mean=0.5026 norm_overlap=0.9993 corr_cb=-0.0254 topkJ=0.0762
[TRAIN][ep=046] loss=0.4979 acc=84.30%
[TRAIN][ep=046] mask_avg: mc_mean=0.2171 mb_mean=0.5023 norm_overlap=0.9974 corr_cb=-0.1229
[EPOCH 046/089] train: loss=0.4979 acc=84.30% | val: loss=0.6567 acc=69.88% f1=76.64% auc=75.52% val_score=53.4776 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.217, mb=0.502, no=0.997, corr=-0.123) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.8858 -> 72.2690
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.2817 mb_mean=0.5033 norm_overlap=0.9966 corr_cb=-0.2000 topkJ=0.0158
[TRAIN][ep=047] loss=0.4980 acc=83.62%
[TRAIN][ep=047] mask_avg: mc_mean=0.2639 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1554
[EPOCH 047/089] train: loss=0.4980 acc=83.62% | val: loss=0.6718 acc=67.47% f1=75.68% auc=74.88% val_score=58.5835 val_score_bestthr=71.0318 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.264, mb=0.502, no=0.997, corr=-0.155) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.8858 -> 71.0318
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.2765 mb_mean=0.5001 norm_overlap=0.9960 corr_cb=-0.2079 topkJ=0.0246
[TRAIN][ep=048] loss=0.4671 acc=85.77%
[TRAIN][ep=048] mask_avg: mc_mean=0.2466 mb_mean=0.5023 norm_overlap=0.9971 corr_cb=-0.1404
[EPOCH 048/089] train: loss=0.4671 acc=85.77% | val: loss=0.7730 acc=68.67% f1=75.93% auc=75.00% val_score=69.0388 val_score_bestthr=71.1606 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.247, mb=0.502, no=0.997, corr=-0.140) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.8858 -> 71.1606
[DBG][ep=049] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.2468 mb_mean=0.4996 norm_overlap=0.9935 corr_cb=-0.3139 topkJ=0.0194
[TRAIN][ep=049] loss=0.5451 acc=79.60%
[TRAIN][ep=049] mask_avg: mc_mean=0.2320 mb_mean=0.5023 norm_overlap=0.9968 corr_cb=-0.1495
[EPOCH 049/089] train: loss=0.5451 acc=79.60% | val: loss=0.7196 acc=71.08% f1=76.47% auc=74.77% val_score=68.2724 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.232, mb=0.502, no=0.997, corr=-0.149) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.8858 -> 72.7764
[DBG][ep=050] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.2460 mb_mean=0.5034 norm_overlap=0.9944 corr_cb=-0.2646 topkJ=0.0093
[TRAIN][ep=050] loss=0.4559 acc=87.38%
[TRAIN][ep=050] mask_avg: mc_mean=0.2568 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1720
[EPOCH 050/089] train: loss=0.4559 acc=87.38% | val: loss=0.6602 acc=71.08% f1=76.47% auc=74.59% val_score=60.1687 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.257, mb=0.502, no=0.997, corr=-0.172) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.8858 -> 72.7764
[DBG][ep=051] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.2041 mb_mean=0.5047 norm_overlap=1.0003 corr_cb=0.0139 topkJ=0.0687
[TRAIN][ep=051] loss=0.4520 acc=87.65%
[TRAIN][ep=051] mask_avg: mc_mean=0.2567 mb_mean=0.5023 norm_overlap=0.9967 corr_cb=-0.1674
[EPOCH 051/089] train: loss=0.4520 acc=87.65% | val: loss=0.6592 acc=71.08% f1=76.47% auc=74.83% val_score=62.5027 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.257, mb=0.502, no=0.997, corr=-0.167) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.8858 -> 72.7764
[DBG][ep=052] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.2553 mb_mean=0.5020 norm_overlap=0.9958 corr_cb=-0.2164 topkJ=0.0361
[TRAIN][ep=052] loss=0.4441 acc=88.72%
[TRAIN][ep=052] mask_avg: mc_mean=0.2567 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1703
[EPOCH 052/089] train: loss=0.4441 acc=88.72% | val: loss=0.6616 acc=71.08% f1=76.47% auc=75.17% val_score=62.5027 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.257, mb=0.502, no=0.997, corr=-0.170) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.8858 -> 72.7764
[DBG][ep=053] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.2721 mb_mean=0.5023 norm_overlap=0.9967 corr_cb=-0.1842 topkJ=0.0282
[TRAIN][ep=053] loss=0.4462 acc=88.32%
[TRAIN][ep=053] mask_avg: mc_mean=0.2567 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1711
[EPOCH 053/089] train: loss=0.4462 acc=88.32% | val: loss=0.6632 acc=71.08% f1=76.47% auc=74.77% val_score=56.4777 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.257, mb=0.502, no=0.997, corr=-0.171) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.8858 -> 72.7764
[DBG][ep=054] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=054] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=054] mask(step0): mc_mean=0.2639 mb_mean=0.5013 norm_overlap=0.9965 corr_cb=-0.1641 topkJ=0.0306
[TRAIN][ep=054] loss=0.4394 acc=88.05%
[TRAIN][ep=054] mask_avg: mc_mean=0.2567 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1757
[EPOCH 054/089] train: loss=0.4394 acc=88.05% | val: loss=0.6686 acc=71.08% f1=76.47% auc=74.65% val_score=56.4777 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.257, mb=0.502, no=0.996, corr=-0.176) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.8858 -> 72.7764
[DBG][ep=055] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=055] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=055] mask(step0): mc_mean=0.2635 mb_mean=0.5029 norm_overlap=0.9937 corr_cb=-0.3141 topkJ=0.0109
[TRAIN][ep=055] loss=0.4382 acc=88.59%
[TRAIN][ep=055] mask_avg: mc_mean=0.2568 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1714
[EPOCH 055/089] train: loss=0.4382 acc=88.59% | val: loss=0.6726 acc=71.08% f1=76.47% auc=74.71% val_score=56.4777 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.257, mb=0.502, no=0.997, corr=-0.171) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.8858 -> 72.7764
[DBG][ep=056] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=056] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=056] mask(step0): mc_mean=0.2262 mb_mean=0.5009 norm_overlap=0.9963 corr_cb=-0.2129 topkJ=0.0362
[TRAIN][ep=056] loss=0.4363 acc=88.05%
[TRAIN][ep=056] mask_avg: mc_mean=0.2569 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1721
[EPOCH 056/089] train: loss=0.4363 acc=88.05% | val: loss=0.6788 acc=71.08% f1=76.47% auc=74.71% val_score=56.5584 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.257, mb=0.502, no=0.997, corr=-0.172) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.8858 -> 72.7764
[DBG][ep=057] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=057] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=057] mask(step0): mc_mean=0.2731 mb_mean=0.5026 norm_overlap=0.9968 corr_cb=-0.1812 topkJ=0.0309
[TRAIN][ep=057] loss=0.4338 acc=88.05%
[TRAIN][ep=057] mask_avg: mc_mean=0.2567 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1691
[EPOCH 057/089] train: loss=0.4338 acc=88.05% | val: loss=0.6842 acc=71.08% f1=76.47% auc=74.59% val_score=52.0381 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.257, mb=0.502, no=0.997, corr=-0.169) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.8858 -> 72.7764
[DBG][ep=058] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=058] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=058] mask(step0): mc_mean=0.2113 mb_mean=0.5051 norm_overlap=0.9969 corr_cb=-0.1805 topkJ=0.0353
[TRAIN][ep=058] loss=0.4334 acc=88.46%
[TRAIN][ep=058] mask_avg: mc_mean=0.2567 mb_mean=0.5023 norm_overlap=0.9967 corr_cb=-0.1676
[EPOCH 058/089] train: loss=0.4334 acc=88.46% | val: loss=0.6825 acc=71.08% f1=76.47% auc=74.94% val_score=56.4777 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.257, mb=0.502, no=0.997, corr=-0.168) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.8858 -> 72.7764
[DBG][ep=059] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=059] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=059] mask(step0): mc_mean=0.2834 mb_mean=0.4997 norm_overlap=0.9958 corr_cb=-0.2206 topkJ=0.0420
[TRAIN][ep=059] loss=0.4294 acc=88.86%
[TRAIN][ep=059] mask_avg: mc_mean=0.2568 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1699
[EPOCH 059/089] train: loss=0.4294 acc=88.86% | val: loss=0.6903 acc=71.08% f1=76.47% auc=75.00% val_score=61.7074 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.257, mb=0.502, no=0.997, corr=-0.170) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.8858 -> 72.7764
[DBG][ep=060] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=060] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=060] mask(step0): mc_mean=0.2785 mb_mean=0.4999 norm_overlap=0.9958 corr_cb=-0.2373 topkJ=0.0183
[TRAIN][ep=060] loss=0.4314 acc=89.40%
[TRAIN][ep=060] mask_avg: mc_mean=0.2567 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1698
[EPOCH 060/089] train: loss=0.4314 acc=89.40% | val: loss=0.6896 acc=71.08% f1=76.47% auc=74.88% val_score=56.4777 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.257, mb=0.502, no=0.997, corr=-0.170) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.8858 -> 72.7764
[DBG][ep=061] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=061] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=061] mask(step0): mc_mean=0.2877 mb_mean=0.5016 norm_overlap=0.9893 corr_cb=-0.4351 topkJ=0.0075
[TRAIN][ep=061] loss=0.4280 acc=88.72%
[TRAIN][ep=061] mask_avg: mc_mean=0.2568 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1692
[EPOCH 061/089] train: loss=0.4280 acc=88.72% | val: loss=0.6957 acc=71.08% f1=76.47% auc=74.65% val_score=56.4777 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.257, mb=0.502, no=0.997, corr=-0.169) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.8858 -> 72.7764
[DBG][ep=062] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=062] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=062] mask(step0): mc_mean=0.2790 mb_mean=0.5002 norm_overlap=0.9964 corr_cb=-0.2091 topkJ=0.0274
[TRAIN][ep=062] loss=0.4285 acc=88.46%
[TRAIN][ep=062] mask_avg: mc_mean=0.2568 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1697
[EPOCH 062/089] train: loss=0.4285 acc=88.46% | val: loss=0.6961 acc=71.08% f1=76.47% auc=74.83% val_score=61.7074 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.257, mb=0.502, no=0.997, corr=-0.170) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.8858 -> 72.7764
[EARLY STOP] no improvement for 30 epochs. best_epoch=32
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
=============== FIT DONE ===============
[BEST] epoch=32 | val_acc=67.47% | val_f1=76.11% | val_auc=78.95% | val_score=52.5151 | val_score_bestthr=72.8858
[TEST@BEST] thr_used=0.385 | acc=64.25% f1=69.92% auc=65.27% | SP_sex=4.57% EO_sex=3.75% SP_age=10.03% EO_age=6.49%
[TIME] 1.67 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/summary_fold_0.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5259 mb_mean=0.5010 norm_overlap=0.9999 corr_cb=-0.0912 topkJ=0.0676
[TRAIN][ep=000] loss=0.6939 acc=50.47%
[TRAIN][ep=000] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0996
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5274 mb_mean=0.4997 norm_overlap=0.9999 corr_cb=-0.2567 topkJ=0.0254
[TRAIN][ep=001] loss=0.6920 acc=50.47%
[TRAIN][ep=001] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0926
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5297 mb_mean=0.5053 norm_overlap=1.0000 corr_cb=0.0154 topkJ=0.0969
[TRAIN][ep=002] loss=0.6899 acc=52.89%
[TRAIN][ep=002] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0983
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5296 mb_mean=0.5000 norm_overlap=0.9999 corr_cb=-0.1407 topkJ=0.0490
[TRAIN][ep=003] loss=0.6882 acc=54.23%
[TRAIN][ep=003] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0952
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5295 mb_mean=0.4987 norm_overlap=0.9999 corr_cb=-0.1840 topkJ=0.0339
[TRAIN][ep=004] loss=0.6887 acc=53.42%
[TRAIN][ep=004] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.1002
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5288 mb_mean=0.5009 norm_overlap=0.9999 corr_cb=-0.1690 topkJ=0.0368
[TRAIN][ep=005] loss=0.6834 acc=56.91%
[TRAIN][ep=005] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0988
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5323 mb_mean=0.5018 norm_overlap=0.9999 corr_cb=-0.2431 topkJ=0.0234
[TRAIN][ep=006] loss=0.6844 acc=54.63%
[TRAIN][ep=006] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0978
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5339 mb_mean=0.5021 norm_overlap=1.0000 corr_cb=-0.0185 topkJ=0.0321
[TRAIN][ep=007] loss=0.6826 acc=57.72%
[TRAIN][ep=007] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0955
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5308 mb_mean=0.5020 norm_overlap=1.0000 corr_cb=-0.0361 topkJ=0.0444
[TRAIN][ep=008] loss=0.6776 acc=57.99%
[TRAIN][ep=008] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0938
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5248 mb_mean=0.5048 norm_overlap=0.9999 corr_cb=-0.0945 topkJ=0.0690
[TRAIN][ep=009] loss=0.6759 acc=58.93%
[TRAIN][ep=009] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0965
================= FIT START (fold=0) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5327 mb_mean=0.5004 norm_overlap=1.0000 corr_cb=-0.0395 topkJ=0.0304
[TRAIN][ep=000] loss=0.6709 acc=61.48%
[TRAIN][ep=000] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0992
[EPOCH 000/089] train: loss=0.6709 acc=61.48% | val: loss=0.6686 acc=62.65% f1=69.31% auc=65.87% val_score=63.8688 val_score_bestthr=64.9727 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.099) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 64.9727
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5321 mb_mean=0.5010 norm_overlap=0.9998 corr_cb=-0.3401 topkJ=0.0082
[TRAIN][ep=001] loss=0.6667 acc=61.48%
[TRAIN][ep=001] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0976
[EPOCH 001/089] train: loss=0.6667 acc=61.48% | val: loss=0.6664 acc=61.45% f1=68.63% auc=65.58% val_score=50.8549 val_score_bestthr=63.8688 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.098) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9727 -> 63.8688
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5308 mb_mean=0.5031 norm_overlap=1.0000 corr_cb=-0.0851 topkJ=0.0316
[TRAIN][ep=002] loss=0.6610 acc=60.94%
[TRAIN][ep=002] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0965
[EPOCH 002/089] train: loss=0.6610 acc=60.94% | val: loss=0.6767 acc=57.83% f1=66.67% auc=64.13% val_score=48.1618 val_score_bestthr=58.1219 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.097) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9727 -> 58.1219
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5303 mb_mean=0.5028 norm_overlap=1.0000 corr_cb=0.0572 topkJ=0.0336
[TRAIN][ep=003] loss=0.6553 acc=64.43%
[TRAIN][ep=003] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0987
[EPOCH 003/089] train: loss=0.6553 acc=64.43% | val: loss=0.6566 acc=62.65% f1=69.31% auc=66.69% val_score=50.8414 val_score_bestthr=64.9727 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.099) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9727 -> 64.9727
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5315 mb_mean=0.5048 norm_overlap=1.0000 corr_cb=-0.0454 topkJ=0.0668
[TRAIN][ep=004] loss=0.6487 acc=65.10%
[TRAIN][ep=004] mask_avg: mc_mean=0.5292 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0985
[EPOCH 004/089] train: loss=0.6487 acc=65.10% | val: loss=0.6513 acc=62.65% f1=69.31% auc=67.73% val_score=56.4760 val_score_bestthr=64.9727 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.099) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9727 -> 64.9727
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5300 mb_mean=0.5015 norm_overlap=0.9999 corr_cb=-0.2288 topkJ=0.0177
[TRAIN][ep=005] loss=1.2886 acc=64.83%
[TRAIN][ep=005] mask_avg: mc_mean=0.3784 mb_mean=0.5023 norm_overlap=1.0007 corr_cb=0.1901
[EPOCH 005/089] train: loss=1.2886 acc=64.83% | val: loss=0.6493 acc=62.65% f1=71.56% auc=71.22% val_score=51.2740 val_score_bestthr=61.7278 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.378, mb=0.502, no=1.001, corr=0.190) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9727 -> 61.7278
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2787 mb_mean=0.5013 norm_overlap=1.0021 corr_cb=0.3834 topkJ=0.1305
[TRAIN][ep=006] loss=1.0638 acc=65.37%
[TRAIN][ep=006] mask_avg: mc_mean=0.2531 mb_mean=0.5023 norm_overlap=1.0013 corr_cb=0.1865
[EPOCH 006/089] train: loss=1.0638 acc=65.37% | val: loss=0.6395 acc=62.65% f1=71.56% auc=71.51% val_score=61.3612 val_score_bestthr=64.3474 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.253, mb=0.502, no=1.001, corr=0.187) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9727 -> 64.3474
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2301 mb_mean=0.5027 norm_overlap=1.0018 corr_cb=0.2132 topkJ=0.0729
[TRAIN][ep=007] loss=0.8601 acc=65.50%
[TRAIN][ep=007] mask_avg: mc_mean=0.2249 mb_mean=0.5023 norm_overlap=1.0012 corr_cb=0.1467
[EPOCH 007/089] train: loss=0.8601 acc=65.50% | val: loss=0.6325 acc=62.65% f1=72.57% auc=72.50% val_score=61.1758 val_score_bestthr=67.1797 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.040, stage2=False) | mask(mc=0.225, mb=0.502, no=1.001, corr=0.147) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 64.9727 -> 67.1797
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2204 mb_mean=0.5013 norm_overlap=1.0005 corr_cb=0.0615 topkJ=0.0710
[TRAIN][ep=008] loss=0.9272 acc=68.05%
[TRAIN][ep=008] mask_avg: mc_mean=0.2096 mb_mean=0.5023 norm_overlap=1.0010 corr_cb=0.1087
[EPOCH 008/089] train: loss=0.9272 acc=68.05% | val: loss=0.6500 acc=63.86% f1=69.39% auc=69.42% val_score=50.8167 val_score_bestthr=61.0557 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.080, stage2=False) | mask(mc=0.210, mb=0.502, no=1.001, corr=0.109) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.1797 -> 61.0557
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2071 mb_mean=0.5024 norm_overlap=1.0004 corr_cb=0.0337 topkJ=0.0719
[TRAIN][ep=009] loss=1.0108 acc=65.91%
[TRAIN][ep=009] mask_avg: mc_mean=0.1891 mb_mean=0.5023 norm_overlap=1.0009 corr_cb=0.0854
[EPOCH 009/089] train: loss=1.0108 acc=65.91% | val: loss=0.6433 acc=65.06% f1=73.39% auc=73.55% val_score=65.7793 val_score_bestthr=68.3138 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.120, stage2=False) | mask(mc=0.189, mb=0.502, no=1.001, corr=0.085) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 67.1797 -> 68.3138
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1944 mb_mean=0.5010 norm_overlap=1.0013 corr_cb=0.1421 topkJ=0.0745
[TRAIN][ep=010] loss=1.0821 acc=65.77%
[TRAIN][ep=010] mask_avg: mc_mean=0.1922 mb_mean=0.5023 norm_overlap=1.0005 corr_cb=0.0434
[EPOCH 010/089] train: loss=1.0821 acc=65.77% | val: loss=0.6227 acc=63.86% f1=73.68% auc=73.43% val_score=58.4938 val_score_bestthr=66.8001 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.160, stage2=False) | mask(mc=0.192, mb=0.502, no=1.001, corr=0.043) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.3138 -> 66.8001
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1885 mb_mean=0.5027 norm_overlap=0.9979 corr_cb=-0.2003 topkJ=0.0551
[TRAIN][ep=011] loss=1.1368 acc=70.34%
[TRAIN][ep=011] mask_avg: mc_mean=0.1852 mb_mean=0.5023 norm_overlap=1.0002 corr_cb=0.0129
[EPOCH 011/089] train: loss=1.1368 acc=70.34% | val: loss=0.6127 acc=63.86% f1=72.73% auc=75.87% val_score=61.5955 val_score_bestthr=67.2118 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.185, mb=0.502, no=1.000, corr=0.013) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.3138 -> 67.2118
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1779 mb_mean=0.5005 norm_overlap=1.0000 corr_cb=0.0036 topkJ=0.1127
[TRAIN][ep=012] loss=1.2179 acc=68.99%
[TRAIN][ep=012] mask_avg: mc_mean=0.1814 mb_mean=0.5023 norm_overlap=0.9998 corr_cb=-0.0181
[EPOCH 012/089] train: loss=1.2179 acc=68.99% | val: loss=0.6700 acc=63.86% f1=70.00% auc=71.45% val_score=50.4880 val_score_bestthr=61.9409 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.181, mb=0.502, no=1.000, corr=-0.018) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.3138 -> 61.9409
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1924 mb_mean=0.5050 norm_overlap=0.9989 corr_cb=-0.0902 topkJ=0.0740
[TRAIN][ep=013] loss=1.2121 acc=69.26%
[TRAIN][ep=013] mask_avg: mc_mean=0.1709 mb_mean=0.5023 norm_overlap=0.9995 corr_cb=-0.0353
[EPOCH 013/089] train: loss=1.2121 acc=69.26% | val: loss=0.6207 acc=71.08% f1=70.00% auc=75.17% val_score=43.2724 val_score_bestthr=64.6065 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.171, mb=0.502, no=1.000, corr=-0.035) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.3138 -> 64.6065
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1630 mb_mean=0.4973 norm_overlap=1.0000 corr_cb=0.0002 topkJ=0.0579
[TRAIN][ep=014] loss=1.1981 acc=70.87%
[TRAIN][ep=014] mask_avg: mc_mean=0.1878 mb_mean=0.5023 norm_overlap=0.9991 corr_cb=-0.0690
[EPOCH 014/089] train: loss=1.1981 acc=70.87% | val: loss=0.5875 acc=67.47% f1=72.16% auc=76.34% val_score=59.8927 val_score_bestthr=64.4505 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.188, mb=0.502, no=0.999, corr=-0.069) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.3138 -> 64.4505
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1620 mb_mean=0.5022 norm_overlap=1.0002 corr_cb=0.0138 topkJ=0.0637
[TRAIN][ep=015] loss=1.0214 acc=69.66%
[TRAIN][ep=015] mask_avg: mc_mean=0.1935 mb_mean=0.5023 norm_overlap=0.9987 corr_cb=-0.0893
[EPOCH 015/089] train: loss=1.0214 acc=69.66% | val: loss=0.5836 acc=66.27% f1=73.08% auc=78.43% val_score=61.2871 val_score_bestthr=66.1567 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.194, mb=0.502, no=0.999, corr=-0.089) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.3138 -> 66.1567
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1797 mb_mean=0.5002 norm_overlap=0.9990 corr_cb=-0.0765 topkJ=0.0438
[TRAIN][ep=016] loss=0.8148 acc=70.87%
[TRAIN][ep=016] mask_avg: mc_mean=0.1943 mb_mean=0.5023 norm_overlap=0.9983 corr_cb=-0.1130
[EPOCH 016/089] train: loss=0.8148 acc=70.87% | val: loss=0.5772 acc=74.70% f1=72.73% auc=77.38% val_score=68.0866 val_score_bestthr=68.0866 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.194, mb=0.502, no=0.998, corr=-0.113) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.3138 -> 68.0866
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.2272 mb_mean=0.5033 norm_overlap=0.9968 corr_cb=-0.2050 topkJ=0.0219
[TRAIN][ep=017] loss=0.7709 acc=71.01%
[TRAIN][ep=017] mask_avg: mc_mean=0.2068 mb_mean=0.5023 norm_overlap=0.9982 corr_cb=-0.1172
[EPOCH 017/089] train: loss=0.7709 acc=71.01% | val: loss=0.5797 acc=63.86% f1=74.14% auc=77.67% val_score=62.8433 val_score_bestthr=70.1174 | dyn(w_pfs=0.090, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.207, mb=0.502, no=0.998, corr=-0.117) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 68.3138 -> 70.1174
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1865 mb_mean=0.5025 norm_overlap=0.9988 corr_cb=-0.0748 topkJ=0.0466
[TRAIN][ep=018] loss=0.8346 acc=72.62%
[TRAIN][ep=018] mask_avg: mc_mean=0.1939 mb_mean=0.5023 norm_overlap=0.9983 corr_cb=-0.1046
[EPOCH 018/089] train: loss=0.8346 acc=72.62% | val: loss=0.5993 acc=67.47% f1=73.27% auc=79.01% val_score=63.5930 val_score_bestthr=67.0451 | dyn(w_pfs=0.130, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.194, mb=0.502, no=0.998, corr=-0.105) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.1174 -> 67.0451
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1545 mb_mean=0.5022 norm_overlap=0.9968 corr_cb=-0.2052 topkJ=0.0544
[TRAIN][ep=019] loss=0.9049 acc=72.89%
[TRAIN][ep=019] mask_avg: mc_mean=0.1949 mb_mean=0.5023 norm_overlap=0.9981 corr_cb=-0.1150
[EPOCH 019/089] train: loss=0.9049 acc=72.89% | val: loss=0.5595 acc=73.49% f1=71.79% auc=78.43% val_score=64.6065 val_score_bestthr=65.3216 | dyn(w_pfs=0.170, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.195, mb=0.502, no=0.998, corr=-0.115) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.1174 -> 65.3216
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.2236 mb_mean=0.5020 norm_overlap=0.9987 corr_cb=-0.0671 topkJ=0.0871
[TRAIN][ep=020] loss=0.9759 acc=72.75%
[TRAIN][ep=020] mask_avg: mc_mean=0.1963 mb_mean=0.5023 norm_overlap=0.9980 corr_cb=-0.1146
[EPOCH 020/089] train: loss=0.9759 acc=72.75% | val: loss=0.5794 acc=74.70% f1=72.73% auc=76.34% val_score=66.6390 val_score_bestthr=68.0866 | dyn(w_pfs=0.210, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.196, mb=0.502, no=0.998, corr=-0.115) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.1174 -> 68.0866
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2283 mb_mean=0.5058 norm_overlap=0.9975 corr_cb=-0.1475 topkJ=0.0339
[TRAIN][ep=021] loss=1.0645 acc=71.41%
[TRAIN][ep=021] mask_avg: mc_mean=0.2014 mb_mean=0.5023 norm_overlap=0.9979 corr_cb=-0.1222
[EPOCH 021/089] train: loss=1.0645 acc=71.41% | val: loss=0.5629 acc=74.70% f1=72.00% auc=78.20% val_score=68.0866 val_score_bestthr=69.4062 | dyn(w_pfs=0.250, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.201, mb=0.502, no=0.998, corr=-0.122) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.1174 -> 69.4062
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2514 mb_mean=0.4996 norm_overlap=0.9987 corr_cb=-0.0714 topkJ=0.0347
[TRAIN][ep=022] loss=1.1103 acc=73.42%
[TRAIN][ep=022] mask_avg: mc_mean=0.2258 mb_mean=0.5023 norm_overlap=0.9976 corr_cb=-0.1515
[EPOCH 022/089] train: loss=1.1103 acc=73.42% | val: loss=0.5591 acc=75.90% f1=74.36% auc=78.14% val_score=69.4062 val_score_bestthr=68.9443 | dyn(w_pfs=0.150, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.226, mb=0.502, no=0.998, corr=-0.151) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.1174 -> 68.9443
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1365 mb_mean=0.5023 norm_overlap=0.9977 corr_cb=-0.1200 topkJ=0.0267
[TRAIN][ep=023] loss=0.9020 acc=75.17%
[TRAIN][ep=023] mask_avg: mc_mean=0.2131 mb_mean=0.5023 norm_overlap=0.9978 corr_cb=-0.1264
[EPOCH 023/089] train: loss=0.9020 acc=75.17% | val: loss=0.5722 acc=75.90% f1=73.68% auc=77.67% val_score=64.4160 val_score_bestthr=70.8552 | dyn(w_pfs=0.190, w_sup=0.140, w_csuf=0.140, stage2=False) | mask(mc=0.213, mb=0.502, no=0.998, corr=-0.126) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 70.1174 -> 70.8552
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2193 mb_mean=0.5016 norm_overlap=0.9967 corr_cb=-0.1984 topkJ=0.0465
[TRAIN][ep=024] loss=1.0033 acc=73.15%
[TRAIN][ep=024] mask_avg: mc_mean=0.2144 mb_mean=0.5023 norm_overlap=0.9978 corr_cb=-0.1260
[EPOCH 024/089] train: loss=1.0033 acc=73.15% | val: loss=0.5443 acc=75.90% f1=74.36% auc=79.19% val_score=62.8550 val_score_bestthr=71.3284 | dyn(w_pfs=0.230, w_sup=0.180, w_csuf=0.180, stage2=False) | mask(mc=0.214, mb=0.502, no=0.998, corr=-0.126) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 70.8552 -> 71.3284
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1764 mb_mean=0.4998 norm_overlap=1.0002 corr_cb=0.0091 topkJ=0.0509
[TRAIN][ep=025] loss=1.0483 acc=75.44%
[TRAIN][ep=025] mask_avg: mc_mean=0.1960 mb_mean=0.5023 norm_overlap=0.9979 corr_cb=-0.1139
[EPOCH 025/089] train: loss=1.0483 acc=75.44% | val: loss=0.5520 acc=77.11% f1=74.67% auc=78.26% val_score=68.9230 val_score_bestthr=73.6277 | dyn(w_pfs=0.270, w_sup=0.220, w_csuf=0.200, stage2=False) | mask(mc=0.196, mb=0.502, no=0.998, corr=-0.114) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 71.3284 -> 73.6277
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2314 mb_mean=0.5001 norm_overlap=0.9969 corr_cb=-0.1962 topkJ=0.0169
[TRAIN][ep=026] loss=1.0862 acc=75.97%
[TRAIN][ep=026] mask_avg: mc_mean=0.2194 mb_mean=0.5023 norm_overlap=0.9978 corr_cb=-0.1240
[EPOCH 026/089] train: loss=1.0862 acc=75.97% | val: loss=0.5400 acc=78.31% f1=77.50% auc=79.53% val_score=54.8474 val_score_bestthr=72.6051 | dyn(w_pfs=0.310, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.219, mb=0.502, no=0.998, corr=-0.124) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 72.6051
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1656 mb_mean=0.5032 norm_overlap=0.9972 corr_cb=-0.1557 topkJ=0.0358
[TRAIN][ep=027] loss=1.0813 acc=75.70%
[TRAIN][ep=027] mask_avg: mc_mean=0.2188 mb_mean=0.5023 norm_overlap=0.9977 corr_cb=-0.1262
[EPOCH 027/089] train: loss=1.0813 acc=75.70% | val: loss=0.5811 acc=73.49% f1=72.50% auc=77.67% val_score=64.4158 val_score_bestthr=68.2341 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.219, mb=0.502, no=0.998, corr=-0.126) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 68.2341
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2040 mb_mean=0.5016 norm_overlap=0.9999 corr_cb=-0.0052 topkJ=0.0506
[TRAIN][ep=028] loss=1.0802 acc=77.58%
[TRAIN][ep=028] mask_avg: mc_mean=0.2206 mb_mean=0.5023 norm_overlap=0.9979 corr_cb=-0.1143
[EPOCH 028/089] train: loss=1.0802 acc=77.58% | val: loss=0.5463 acc=77.11% f1=75.95% auc=78.78% val_score=64.0724 val_score_bestthr=72.4213 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.221, mb=0.502, no=0.998, corr=-0.114) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 72.4213
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2185 mb_mean=0.5039 norm_overlap=0.9983 corr_cb=-0.0987 topkJ=0.0705
[TRAIN][ep=029] loss=1.0929 acc=77.72%
[TRAIN][ep=029] mask_avg: mc_mean=0.2265 mb_mean=0.5023 norm_overlap=0.9977 corr_cb=-0.1249
[EPOCH 029/089] train: loss=1.0929 acc=77.72% | val: loss=0.5470 acc=73.49% f1=71.79% auc=80.23% val_score=67.8564 val_score_bestthr=70.1718 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.227, mb=0.502, no=0.998, corr=-0.125) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 70.1718
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.1408 mb_mean=0.5015 norm_overlap=0.9978 corr_cb=-0.1095 topkJ=0.0321
[TRAIN][ep=030] loss=1.0863 acc=76.78%
[TRAIN][ep=030] mask_avg: mc_mean=0.2217 mb_mean=0.5023 norm_overlap=0.9976 corr_cb=-0.1285
[EPOCH 030/089] train: loss=1.0863 acc=76.78% | val: loss=0.5829 acc=71.08% f1=75.00% auc=79.59% val_score=64.4158 val_score_bestthr=73.4125 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.222, mb=0.502, no=0.998, corr=-0.128) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 73.4125
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2929 mb_mean=0.5032 norm_overlap=0.9982 corr_cb=-0.1266 topkJ=0.0388
[TRAIN][ep=031] loss=0.8971 acc=77.45%
[TRAIN][ep=031] mask_avg: mc_mean=0.2273 mb_mean=0.5023 norm_overlap=0.9972 corr_cb=-0.1491
[EPOCH 031/089] train: loss=0.8971 acc=77.45% | val: loss=0.5663 acc=73.49% f1=72.50% auc=78.43% val_score=62.8147 val_score_bestthr=68.2341 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.227, mb=0.502, no=0.997, corr=-0.149) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 68.2341
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2171 mb_mean=0.5001 norm_overlap=0.9949 corr_cb=-0.2537 topkJ=0.0340
[TRAIN][ep=032] loss=0.7046 acc=78.12%
[TRAIN][ep=032] mask_avg: mc_mean=0.2160 mb_mean=0.5023 norm_overlap=0.9971 corr_cb=-0.1488
[EPOCH 032/089] train: loss=0.7046 acc=78.12% | val: loss=0.5571 acc=68.67% f1=75.93% auc=78.84% val_score=51.1842 val_score_bestthr=68.2387 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.216, mb=0.502, no=0.997, corr=-0.149) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 68.2387
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1940 mb_mean=0.5007 norm_overlap=0.9987 corr_cb=-0.0751 topkJ=0.0681
[TRAIN][ep=033] loss=0.6486 acc=79.06%
[TRAIN][ep=033] mask_avg: mc_mean=0.2146 mb_mean=0.5023 norm_overlap=0.9972 corr_cb=-0.1412
[EPOCH 033/089] train: loss=0.6486 acc=79.06% | val: loss=0.5522 acc=68.67% f1=75.93% auc=79.19% val_score=61.8228 val_score_bestthr=68.2387 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.215, mb=0.502, no=0.997, corr=-0.141) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 68.2387
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2679 mb_mean=0.5049 norm_overlap=0.9959 corr_cb=-0.2331 topkJ=0.0244
[TRAIN][ep=034] loss=0.6362 acc=78.52%
[TRAIN][ep=034] mask_avg: mc_mean=0.2345 mb_mean=0.5023 norm_overlap=0.9972 corr_cb=-0.1491
[EPOCH 034/089] train: loss=0.6362 acc=78.52% | val: loss=0.6038 acc=69.88% f1=75.25% auc=79.36% val_score=65.7650 val_score_bestthr=69.0388 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.234, mb=0.502, no=0.997, corr=-0.149) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 69.0388
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2967 mb_mean=0.5025 norm_overlap=0.9950 corr_cb=-0.2284 topkJ=0.0240
[TRAIN][ep=035] loss=0.6218 acc=80.13%
[TRAIN][ep=035] mask_avg: mc_mean=0.2600 mb_mean=0.5023 norm_overlap=0.9969 corr_cb=-0.1734
[EPOCH 035/089] train: loss=0.6218 acc=80.13% | val: loss=0.5704 acc=68.67% f1=74.00% auc=78.37% val_score=64.7677 val_score_bestthr=67.0695 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.260, mb=0.502, no=0.997, corr=-0.173) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 67.0695
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2049 mb_mean=0.5025 norm_overlap=0.9973 corr_cb=-0.1228 topkJ=0.0594
[TRAIN][ep=036] loss=0.6255 acc=80.13%
[TRAIN][ep=036] mask_avg: mc_mean=0.2295 mb_mean=0.5023 norm_overlap=0.9973 corr_cb=-0.1405
[EPOCH 036/089] train: loss=0.6255 acc=80.13% | val: loss=0.5695 acc=71.08% f1=75.51% auc=78.37% val_score=63.3402 val_score_bestthr=68.9195 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.229, mb=0.502, no=0.997, corr=-0.141) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 68.9195
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1639 mb_mean=0.5040 norm_overlap=0.9959 corr_cb=-0.1855 topkJ=0.0304
[TRAIN][ep=037] loss=0.6123 acc=80.27%
[TRAIN][ep=037] mask_avg: mc_mean=0.2281 mb_mean=0.5023 norm_overlap=0.9972 corr_cb=-0.1419
[EPOCH 037/089] train: loss=0.6123 acc=80.27% | val: loss=0.5649 acc=71.08% f1=76.00% auc=79.30% val_score=54.8619 val_score_bestthr=71.3709 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.228, mb=0.502, no=0.997, corr=-0.142) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 71.3709
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2667 mb_mean=0.5023 norm_overlap=0.9930 corr_cb=-0.3476 topkJ=0.0103
[TRAIN][ep=038] loss=0.5944 acc=80.81%
[TRAIN][ep=038] mask_avg: mc_mean=0.2487 mb_mean=0.5023 norm_overlap=0.9968 corr_cb=-0.1660
[EPOCH 038/089] train: loss=0.5944 acc=80.81% | val: loss=0.5779 acc=67.47% f1=75.68% auc=77.85% val_score=64.4477 val_score_bestthr=69.4811 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.249, mb=0.502, no=0.997, corr=-0.166) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 69.4811
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2693 mb_mean=0.5023 norm_overlap=0.9949 corr_cb=-0.2769 topkJ=0.0266
[TRAIN][ep=039] loss=0.5949 acc=81.88%
[TRAIN][ep=039] mask_avg: mc_mean=0.2444 mb_mean=0.5023 norm_overlap=0.9971 corr_cb=-0.1510
[EPOCH 039/089] train: loss=0.5949 acc=81.88% | val: loss=0.5991 acc=68.67% f1=75.93% auc=76.86% val_score=62.2587 val_score_bestthr=68.2387 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.244, mb=0.502, no=0.997, corr=-0.151) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 68.2387
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.1793 mb_mean=0.5019 norm_overlap=0.9967 corr_cb=-0.1360 topkJ=0.0406
[TRAIN][ep=040] loss=0.5919 acc=81.61%
[TRAIN][ep=040] mask_avg: mc_mean=0.2263 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1493
[EPOCH 040/089] train: loss=0.5919 acc=81.61% | val: loss=0.5923 acc=72.29% f1=76.77% auc=78.43% val_score=55.9609 val_score_bestthr=70.9047 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.226, mb=0.502, no=0.997, corr=-0.149) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 70.9047
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.2564 mb_mean=0.5002 norm_overlap=0.9978 corr_cb=-0.1298 topkJ=0.0255
[TRAIN][ep=041] loss=0.5798 acc=81.61%
[TRAIN][ep=041] mask_avg: mc_mean=0.2488 mb_mean=0.5023 norm_overlap=0.9971 corr_cb=-0.1488
[EPOCH 041/089] train: loss=0.5798 acc=81.61% | val: loss=0.5987 acc=68.67% f1=76.36% auc=77.03% val_score=55.9609 val_score_bestthr=71.8036 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.249, mb=0.502, no=0.997, corr=-0.149) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 71.8036
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.1785 mb_mean=0.5021 norm_overlap=0.9978 corr_cb=-0.1003 topkJ=0.0229
[TRAIN][ep=042] loss=0.5798 acc=82.01%
[TRAIN][ep=042] mask_avg: mc_mean=0.2288 mb_mean=0.5023 norm_overlap=0.9971 corr_cb=-0.1404
[EPOCH 042/089] train: loss=0.5798 acc=82.01% | val: loss=0.5933 acc=68.67% f1=76.36% auc=77.79% val_score=56.0901 val_score_bestthr=71.8036 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.229, mb=0.502, no=0.997, corr=-0.140) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 71.8036
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.3361 mb_mean=0.5025 norm_overlap=0.9952 corr_cb=-0.2657 topkJ=0.0195
[TRAIN][ep=043] loss=0.5811 acc=82.55%
[TRAIN][ep=043] mask_avg: mc_mean=0.2470 mb_mean=0.5023 norm_overlap=0.9968 corr_cb=-0.1617
[EPOCH 043/089] train: loss=0.5811 acc=82.55% | val: loss=0.6291 acc=68.67% f1=76.36% auc=75.70% val_score=56.0901 val_score_bestthr=71.8036 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.247, mb=0.502, no=0.997, corr=-0.162) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 71.8036
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2494 mb_mean=0.5062 norm_overlap=1.0007 corr_cb=0.0344 topkJ=0.0624
[TRAIN][ep=044] loss=0.5568 acc=83.36%
[TRAIN][ep=044] mask_avg: mc_mean=0.2462 mb_mean=0.5023 norm_overlap=0.9969 corr_cb=-0.1558
[EPOCH 044/089] train: loss=0.5568 acc=83.36% | val: loss=0.6303 acc=68.67% f1=76.36% auc=76.74% val_score=61.8718 val_score_bestthr=71.8036 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.246, mb=0.502, no=0.997, corr=-0.156) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 71.8036
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2964 mb_mean=0.5009 norm_overlap=0.9982 corr_cb=-0.0817 topkJ=0.0720
[TRAIN][ep=045] loss=0.5641 acc=84.03%
[TRAIN][ep=045] mask_avg: mc_mean=0.2579 mb_mean=0.5023 norm_overlap=0.9969 corr_cb=-0.1592
[EPOCH 045/089] train: loss=0.5641 acc=84.03% | val: loss=0.7004 acc=71.08% f1=76.47% auc=75.00% val_score=60.3728 val_score_bestthr=71.5735 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.258, mb=0.502, no=0.997, corr=-0.159) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 71.5735
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.1973 mb_mean=0.5026 norm_overlap=0.9988 corr_cb=-0.0442 topkJ=0.0700
[TRAIN][ep=046] loss=0.5599 acc=83.76%
[TRAIN][ep=046] mask_avg: mc_mean=0.2171 mb_mean=0.5023 norm_overlap=0.9971 corr_cb=-0.1368
[EPOCH 046/089] train: loss=0.5599 acc=83.76% | val: loss=0.6474 acc=72.29% f1=76.77% auc=75.70% val_score=57.2742 val_score_bestthr=69.6873 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.217, mb=0.502, no=0.997, corr=-0.137) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 69.6873
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.2736 mb_mean=0.5033 norm_overlap=0.9964 corr_cb=-0.2098 topkJ=0.0145
[TRAIN][ep=047] loss=0.5577 acc=83.22%
[TRAIN][ep=047] mask_avg: mc_mean=0.2589 mb_mean=0.5023 norm_overlap=0.9968 corr_cb=-0.1645
[EPOCH 047/089] train: loss=0.5577 acc=83.22% | val: loss=0.6681 acc=71.08% f1=76.47% auc=75.17% val_score=56.5112 val_score_bestthr=71.5735 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.259, mb=0.502, no=0.997, corr=-0.165) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 71.5735
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.2756 mb_mean=0.5001 norm_overlap=0.9958 corr_cb=-0.2212 topkJ=0.0230
[TRAIN][ep=048] loss=0.5272 acc=85.37%
[TRAIN][ep=048] mask_avg: mc_mean=0.2435 mb_mean=0.5023 norm_overlap=0.9969 corr_cb=-0.1506
[EPOCH 048/089] train: loss=0.5272 acc=85.37% | val: loss=0.7616 acc=68.67% f1=75.93% auc=75.29% val_score=69.0388 val_score_bestthr=71.1606 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.243, mb=0.502, no=0.997, corr=-0.151) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 71.1606
[DBG][ep=049] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.2407 mb_mean=0.4996 norm_overlap=0.9934 corr_cb=-0.3163 topkJ=0.0198
[TRAIN][ep=049] loss=0.6030 acc=79.46%
[TRAIN][ep=049] mask_avg: mc_mean=0.2291 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1598
[EPOCH 049/089] train: loss=0.6030 acc=79.46% | val: loss=0.7137 acc=71.08% f1=76.47% auc=75.12% val_score=69.0388 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.229, mb=0.502, no=0.997, corr=-0.160) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 72.7764
[DBG][ep=050] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.2407 mb_mean=0.5034 norm_overlap=0.9941 corr_cb=-0.2746 topkJ=0.0097
[TRAIN][ep=050] loss=0.5160 acc=87.11%
[TRAIN][ep=050] mask_avg: mc_mean=0.2506 mb_mean=0.5023 norm_overlap=0.9964 corr_cb=-0.1812
[EPOCH 050/089] train: loss=0.5160 acc=87.11% | val: loss=0.6547 acc=71.08% f1=76.47% auc=74.42% val_score=62.5027 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.251, mb=0.502, no=0.996, corr=-0.181) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 72.7764
[DBG][ep=051] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.2019 mb_mean=0.5047 norm_overlap=1.0002 corr_cb=0.0107 topkJ=0.0669
[TRAIN][ep=051] loss=0.5119 acc=87.65%
[TRAIN][ep=051] mask_avg: mc_mean=0.2505 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1768
[EPOCH 051/089] train: loss=0.5119 acc=87.65% | val: loss=0.6556 acc=71.08% f1=76.47% auc=74.83% val_score=62.5027 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.251, mb=0.502, no=0.996, corr=-0.177) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 72.7764
[DBG][ep=052] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.2493 mb_mean=0.5020 norm_overlap=0.9954 corr_cb=-0.2350 topkJ=0.0365
[TRAIN][ep=052] loss=0.5041 acc=88.32%
[TRAIN][ep=052] mask_avg: mc_mean=0.2505 mb_mean=0.5023 norm_overlap=0.9964 corr_cb=-0.1795
[EPOCH 052/089] train: loss=0.5041 acc=88.32% | val: loss=0.6581 acc=71.08% f1=76.47% auc=75.17% val_score=62.5027 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.502, no=0.996, corr=-0.179) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 72.7764
[DBG][ep=053] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.2678 mb_mean=0.5023 norm_overlap=0.9964 corr_cb=-0.1956 topkJ=0.0256
[TRAIN][ep=053] loss=0.5061 acc=87.79%
[TRAIN][ep=053] mask_avg: mc_mean=0.2504 mb_mean=0.5023 norm_overlap=0.9964 corr_cb=-0.1803
[EPOCH 053/089] train: loss=0.5061 acc=87.79% | val: loss=0.6605 acc=71.08% f1=76.47% auc=74.94% val_score=56.4777 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.502, no=0.996, corr=-0.180) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 72.7764
[DBG][ep=054] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=054] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=054] mask(step0): mc_mean=0.2591 mb_mean=0.5013 norm_overlap=0.9961 corr_cb=-0.1785 topkJ=0.0285
[TRAIN][ep=054] loss=0.4993 acc=87.52%
[TRAIN][ep=054] mask_avg: mc_mean=0.2505 mb_mean=0.5023 norm_overlap=0.9963 corr_cb=-0.1850
[EPOCH 054/089] train: loss=0.4993 acc=87.52% | val: loss=0.6661 acc=71.08% f1=76.47% auc=74.77% val_score=56.4777 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.250, mb=0.502, no=0.996, corr=-0.185) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 72.7764
[DBG][ep=055] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=055] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=055] mask(step0): mc_mean=0.2562 mb_mean=0.5029 norm_overlap=0.9935 corr_cb=-0.3212 topkJ=0.0113
[TRAIN][ep=055] loss=0.4977 acc=88.32%
[TRAIN][ep=055] mask_avg: mc_mean=0.2505 mb_mean=0.5023 norm_overlap=0.9964 corr_cb=-0.1805
[EPOCH 055/089] train: loss=0.4977 acc=88.32% | val: loss=0.6698 acc=71.08% f1=76.47% auc=74.77% val_score=56.4777 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.251, mb=0.502, no=0.996, corr=-0.181) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 72.7764
[EARLY STOP] no improvement for 30 epochs. best_epoch=25
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
=============== FIT DONE ===============
[BEST] epoch=25 | val_acc=77.11% | val_f1=74.67% | val_auc=78.26% | val_score=68.9230 | val_score_bestthr=73.6277
[TEST@BEST] thr_used=0.315 | acc=62.32% f1=70.23% auc=65.20% | SP_sex=2.14% EO_sex=3.15% SP_age=9.79% EO_age=5.44%
[TIME] 1.61 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/summary_fold_0.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5259 mb_mean=0.5010 norm_overlap=0.9999 corr_cb=-0.0912 topkJ=0.0676
[TRAIN][ep=000] loss=0.6939 acc=50.47%
[TRAIN][ep=000] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0996
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5274 mb_mean=0.4997 norm_overlap=0.9999 corr_cb=-0.2567 topkJ=0.0254
[TRAIN][ep=001] loss=0.6920 acc=50.47%
[TRAIN][ep=001] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0926
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5297 mb_mean=0.5053 norm_overlap=1.0000 corr_cb=0.0154 topkJ=0.0969
[TRAIN][ep=002] loss=0.6899 acc=52.89%
[TRAIN][ep=002] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0983
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5296 mb_mean=0.5000 norm_overlap=0.9999 corr_cb=-0.1407 topkJ=0.0490
[TRAIN][ep=003] loss=0.6882 acc=54.23%
[TRAIN][ep=003] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0952
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5295 mb_mean=0.4987 norm_overlap=0.9999 corr_cb=-0.1840 topkJ=0.0339
[TRAIN][ep=004] loss=0.6887 acc=53.42%
[TRAIN][ep=004] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.1002
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5288 mb_mean=0.5009 norm_overlap=0.9999 corr_cb=-0.1690 topkJ=0.0368
[TRAIN][ep=005] loss=0.6834 acc=56.91%
[TRAIN][ep=005] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0988
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5323 mb_mean=0.5018 norm_overlap=0.9999 corr_cb=-0.2431 topkJ=0.0234
[TRAIN][ep=006] loss=0.6844 acc=54.63%
[TRAIN][ep=006] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0978
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5339 mb_mean=0.5021 norm_overlap=1.0000 corr_cb=-0.0185 topkJ=0.0321
[TRAIN][ep=007] loss=0.6826 acc=57.72%
[TRAIN][ep=007] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0955
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5308 mb_mean=0.5020 norm_overlap=1.0000 corr_cb=-0.0361 topkJ=0.0444
[TRAIN][ep=008] loss=0.6776 acc=57.99%
[TRAIN][ep=008] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0938
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5248 mb_mean=0.5048 norm_overlap=0.9999 corr_cb=-0.0945 topkJ=0.0690
[TRAIN][ep=009] loss=0.6759 acc=58.93%
[TRAIN][ep=009] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0965
================= FIT START (fold=0) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5327 mb_mean=0.5004 norm_overlap=1.0000 corr_cb=-0.0395 topkJ=0.0304
[TRAIN][ep=000] loss=0.6709 acc=61.48%
[TRAIN][ep=000] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0992
[EPOCH 000/089] train: loss=0.6709 acc=61.48% | val: loss=0.6686 acc=62.65% f1=69.31% auc=65.99% val_score=63.8688 val_score_bestthr=64.9727 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.099) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 64.9727
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5321 mb_mean=0.5010 norm_overlap=0.9998 corr_cb=-0.3401 topkJ=0.0082
[TRAIN][ep=001] loss=0.6668 acc=61.34%
[TRAIN][ep=001] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0976
[EPOCH 001/089] train: loss=0.6668 acc=61.34% | val: loss=0.6664 acc=61.45% f1=68.63% auc=65.58% val_score=50.8549 val_score_bestthr=63.8688 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.098) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9727 -> 63.8688
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5308 mb_mean=0.5031 norm_overlap=1.0000 corr_cb=-0.0851 topkJ=0.0316
[TRAIN][ep=002] loss=0.6610 acc=60.94%
[TRAIN][ep=002] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0965
[EPOCH 002/089] train: loss=0.6610 acc=60.94% | val: loss=0.6768 acc=56.63% f1=64.71% auc=64.19% val_score=48.1618 val_score_bestthr=58.9427 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.097) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9727 -> 58.9427
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5303 mb_mean=0.5028 norm_overlap=1.0000 corr_cb=0.0572 topkJ=0.0336
[TRAIN][ep=003] loss=0.6554 acc=64.43%
[TRAIN][ep=003] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0987
[EPOCH 003/089] train: loss=0.6554 acc=64.43% | val: loss=0.6567 acc=62.65% f1=69.31% auc=66.74% val_score=50.8414 val_score_bestthr=64.9727 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.099) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9727 -> 64.9727
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5315 mb_mean=0.5048 norm_overlap=1.0000 corr_cb=-0.0454 topkJ=0.0668
[TRAIN][ep=004] loss=0.6487 acc=65.10%
[TRAIN][ep=004] mask_avg: mc_mean=0.5292 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0985
[EPOCH 004/089] train: loss=0.6487 acc=65.10% | val: loss=0.6513 acc=62.65% f1=69.31% auc=67.79% val_score=56.4760 val_score_bestthr=64.9727 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.099) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9727 -> 64.9727
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5300 mb_mean=0.5015 norm_overlap=0.9999 corr_cb=-0.2288 topkJ=0.0177
[TRAIN][ep=005] loss=1.4646 acc=64.83%
[TRAIN][ep=005] mask_avg: mc_mean=0.3785 mb_mean=0.5023 norm_overlap=1.0007 corr_cb=0.1902
[EPOCH 005/089] train: loss=1.4646 acc=64.83% | val: loss=0.6490 acc=62.65% f1=72.07% auc=71.16% val_score=56.2554 val_score_bestthr=61.8131 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.379, mb=0.502, no=1.001, corr=0.190) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9727 -> 61.8131
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2789 mb_mean=0.5013 norm_overlap=1.0021 corr_cb=0.3833 topkJ=0.1300
[TRAIN][ep=006] loss=1.2267 acc=65.64%
[TRAIN][ep=006] mask_avg: mc_mean=0.2533 mb_mean=0.5023 norm_overlap=1.0013 corr_cb=0.1867
[EPOCH 006/089] train: loss=1.2267 acc=65.64% | val: loss=0.6393 acc=62.65% f1=71.56% auc=71.51% val_score=61.3612 val_score_bestthr=64.3474 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.253, mb=0.502, no=1.001, corr=0.187) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9727 -> 64.3474
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2299 mb_mean=0.5027 norm_overlap=1.0018 corr_cb=0.2132 topkJ=0.0729
[TRAIN][ep=007] loss=1.0226 acc=65.37%
[TRAIN][ep=007] mask_avg: mc_mean=0.2248 mb_mean=0.5023 norm_overlap=1.0012 corr_cb=0.1475
[EPOCH 007/089] train: loss=1.0226 acc=65.37% | val: loss=0.6323 acc=62.65% f1=72.57% auc=72.62% val_score=59.6608 val_score_bestthr=67.1797 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.040, stage2=False) | mask(mc=0.225, mb=0.502, no=1.001, corr=0.148) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 64.9727 -> 67.1797
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2211 mb_mean=0.5013 norm_overlap=1.0005 corr_cb=0.0618 topkJ=0.0706
[TRAIN][ep=008] loss=1.0897 acc=68.05%
[TRAIN][ep=008] mask_avg: mc_mean=0.2104 mb_mean=0.5023 norm_overlap=1.0010 corr_cb=0.1095
[EPOCH 008/089] train: loss=1.0897 acc=68.05% | val: loss=0.6491 acc=65.06% f1=70.10% auc=69.65% val_score=51.3291 val_score_bestthr=62.1649 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.080, stage2=False) | mask(mc=0.210, mb=0.502, no=1.001, corr=0.109) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.1797 -> 62.1649
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2075 mb_mean=0.5024 norm_overlap=1.0004 corr_cb=0.0346 topkJ=0.0723
[TRAIN][ep=009] loss=1.1725 acc=65.91%
[TRAIN][ep=009] mask_avg: mc_mean=0.1895 mb_mean=0.5023 norm_overlap=1.0009 corr_cb=0.0865
[EPOCH 009/089] train: loss=1.1725 acc=65.91% | val: loss=0.6431 acc=65.06% f1=73.39% auc=73.43% val_score=65.7793 val_score_bestthr=68.3138 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.120, stage2=False) | mask(mc=0.189, mb=0.502, no=1.001, corr=0.087) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 67.1797 -> 68.3138
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1951 mb_mean=0.5010 norm_overlap=1.0013 corr_cb=0.1438 topkJ=0.0749
[TRAIN][ep=010] loss=1.2438 acc=65.64%
[TRAIN][ep=010] mask_avg: mc_mean=0.1921 mb_mean=0.5023 norm_overlap=1.0006 corr_cb=0.0452
[EPOCH 010/089] train: loss=1.2438 acc=65.64% | val: loss=0.6228 acc=66.27% f1=68.89% auc=73.43% val_score=55.7437 val_score_bestthr=65.4518 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.160, stage2=False) | mask(mc=0.192, mb=0.502, no=1.001, corr=0.045) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.3138 -> 65.4518
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1883 mb_mean=0.5027 norm_overlap=0.9979 corr_cb=-0.2009 topkJ=0.0551
[TRAIN][ep=011] loss=1.2984 acc=70.34%
[TRAIN][ep=011] mask_avg: mc_mean=0.1858 mb_mean=0.5023 norm_overlap=1.0002 corr_cb=0.0143
[EPOCH 011/089] train: loss=1.2984 acc=70.34% | val: loss=0.6124 acc=63.86% f1=72.73% auc=76.05% val_score=61.5955 val_score_bestthr=67.2118 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.186, mb=0.502, no=1.000, corr=0.014) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.3138 -> 67.2118
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1775 mb_mean=0.5005 norm_overlap=1.0001 corr_cb=0.0055 topkJ=0.1132
[TRAIN][ep=012] loss=1.3791 acc=69.26%
[TRAIN][ep=012] mask_avg: mc_mean=0.1802 mb_mean=0.5023 norm_overlap=0.9998 corr_cb=-0.0152
[EPOCH 012/089] train: loss=1.3791 acc=69.26% | val: loss=0.6700 acc=65.06% f1=70.10% auc=71.51% val_score=50.4880 val_score_bestthr=60.4149 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.180, mb=0.502, no=1.000, corr=-0.015) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.3138 -> 60.4149
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1929 mb_mean=0.5050 norm_overlap=0.9989 corr_cb=-0.0908 topkJ=0.0731
[TRAIN][ep=013] loss=1.3729 acc=69.40%
[TRAIN][ep=013] mask_avg: mc_mean=0.1698 mb_mean=0.5023 norm_overlap=0.9996 corr_cb=-0.0335
[EPOCH 013/089] train: loss=1.3729 acc=69.40% | val: loss=0.6201 acc=62.65% f1=73.04% auc=75.17% val_score=51.6655 val_score_bestthr=65.4702 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.170, mb=0.502, no=1.000, corr=-0.033) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.3138 -> 65.4702
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1593 mb_mean=0.4973 norm_overlap=1.0000 corr_cb=0.0021 topkJ=0.0575
[TRAIN][ep=014] loss=1.3586 acc=71.01%
[TRAIN][ep=014] mask_avg: mc_mean=0.1872 mb_mean=0.5023 norm_overlap=0.9991 corr_cb=-0.0672
[EPOCH 014/089] train: loss=1.3586 acc=71.01% | val: loss=0.5880 acc=62.65% f1=73.50% auc=76.16% val_score=58.7799 val_score_bestthr=69.0204 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.187, mb=0.502, no=0.999, corr=-0.067) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 68.3138 -> 69.0204
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1598 mb_mean=0.5022 norm_overlap=1.0002 corr_cb=0.0142 topkJ=0.0641
[TRAIN][ep=015] loss=1.3770 acc=69.80%
[TRAIN][ep=015] mask_avg: mc_mean=0.1925 mb_mean=0.5023 norm_overlap=0.9988 corr_cb=-0.0879
[EPOCH 015/089] train: loss=1.3770 acc=69.80% | val: loss=0.5847 acc=65.06% f1=72.38% auc=78.84% val_score=61.2400 val_score_bestthr=66.8004 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.192, mb=0.502, no=0.999, corr=-0.088) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.0204 -> 66.8004
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1804 mb_mean=0.5002 norm_overlap=0.9991 corr_cb=-0.0731 topkJ=0.0429
[TRAIN][ep=016] loss=1.3639 acc=70.47%
[TRAIN][ep=016] mask_avg: mc_mean=0.1928 mb_mean=0.5023 norm_overlap=0.9983 corr_cb=-0.1113
[EPOCH 016/089] train: loss=1.3639 acc=70.47% | val: loss=0.5752 acc=74.70% f1=72.73% auc=78.31% val_score=68.0866 val_score_bestthr=68.0866 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.193, mb=0.502, no=0.998, corr=-0.111) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.0204 -> 68.0866
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.2247 mb_mean=0.5033 norm_overlap=0.9968 corr_cb=-0.2087 topkJ=0.0215
[TRAIN][ep=017] loss=1.3537 acc=71.14%
[TRAIN][ep=017] mask_avg: mc_mean=0.2056 mb_mean=0.5023 norm_overlap=0.9982 corr_cb=-0.1185
[EPOCH 017/089] train: loss=1.3537 acc=71.14% | val: loss=0.5832 acc=67.47% f1=73.27% auc=78.20% val_score=60.0846 val_score_bestthr=67.0451 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.206, mb=0.502, no=0.998, corr=-0.118) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.0204 -> 67.0451
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1881 mb_mean=0.5025 norm_overlap=0.9987 corr_cb=-0.0806 topkJ=0.0484
[TRAIN][ep=018] loss=1.3361 acc=71.95%
[TRAIN][ep=018] mask_avg: mc_mean=0.1982 mb_mean=0.5023 norm_overlap=0.9983 corr_cb=-0.1068
[EPOCH 018/089] train: loss=1.3361 acc=71.95% | val: loss=0.6032 acc=63.86% f1=74.14% auc=78.90% val_score=61.6238 val_score_bestthr=68.8312 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.198, mb=0.502, no=0.998, corr=-0.107) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.0204 -> 68.8312
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1543 mb_mean=0.5022 norm_overlap=0.9966 corr_cb=-0.2151 topkJ=0.0513
[TRAIN][ep=019] loss=1.3249 acc=72.48%
[TRAIN][ep=019] mask_avg: mc_mean=0.1949 mb_mean=0.5023 norm_overlap=0.9982 corr_cb=-0.1115
[EPOCH 019/089] train: loss=1.3249 acc=72.48% | val: loss=0.5608 acc=74.70% f1=72.73% auc=78.20% val_score=65.3216 val_score_bestthr=68.0866 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.195, mb=0.502, no=0.998, corr=-0.111) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.0204 -> 68.0866
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.2255 mb_mean=0.5020 norm_overlap=0.9986 corr_cb=-0.0692 topkJ=0.0852
[TRAIN][ep=020] loss=1.1253 acc=73.02%
[TRAIN][ep=020] mask_avg: mc_mean=0.1977 mb_mean=0.5023 norm_overlap=0.9981 corr_cb=-0.1103
[EPOCH 020/089] train: loss=1.1253 acc=73.02% | val: loss=0.5777 acc=74.70% f1=72.00% auc=76.57% val_score=66.6390 val_score_bestthr=69.4062 | dyn(w_pfs=0.290, w_sup=0.190, w_csuf=0.140, stage2=False) | mask(mc=0.198, mb=0.502, no=0.998, corr=-0.110) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 69.0204 -> 69.4062
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2234 mb_mean=0.5058 norm_overlap=0.9977 corr_cb=-0.1364 topkJ=0.0347
[TRAIN][ep=021] loss=1.2122 acc=71.28%
[TRAIN][ep=021] mask_avg: mc_mean=0.2006 mb_mean=0.5023 norm_overlap=0.9981 corr_cb=-0.1136
[EPOCH 021/089] train: loss=1.2122 acc=71.28% | val: loss=0.5622 acc=74.70% f1=72.00% auc=78.08% val_score=68.0866 val_score_bestthr=69.4062 | dyn(w_pfs=0.330, w_sup=0.230, w_csuf=0.180, stage2=False) | mask(mc=0.201, mb=0.502, no=0.998, corr=-0.114) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.4062 -> 69.4062
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2501 mb_mean=0.4996 norm_overlap=0.9989 corr_cb=-0.0640 topkJ=0.0360
[TRAIN][ep=022] loss=1.2573 acc=73.83%
[TRAIN][ep=022] mask_avg: mc_mean=0.2242 mb_mean=0.5023 norm_overlap=0.9977 corr_cb=-0.1409
[EPOCH 022/089] train: loss=1.2573 acc=73.83% | val: loss=0.5588 acc=75.90% f1=74.36% auc=77.97% val_score=69.4062 val_score_bestthr=68.9443 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.224, mb=0.502, no=0.998, corr=-0.141) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.4062 -> 68.9443
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1362 mb_mean=0.5023 norm_overlap=0.9979 corr_cb=-0.1087 topkJ=0.0271
[TRAIN][ep=023] loss=1.2770 acc=74.63%
[TRAIN][ep=023] mask_avg: mc_mean=0.2106 mb_mean=0.5023 norm_overlap=0.9980 corr_cb=-0.1172
[EPOCH 023/089] train: loss=1.2770 acc=74.63% | val: loss=0.5728 acc=75.90% f1=74.36% auc=77.73% val_score=63.5347 val_score_bestthr=70.1617 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.211, mb=0.502, no=0.998, corr=-0.117) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 69.4062 -> 70.1617
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2129 mb_mean=0.5016 norm_overlap=0.9970 corr_cb=-0.1798 topkJ=0.0478
[TRAIN][ep=024] loss=1.3024 acc=73.02%
[TRAIN][ep=024] mask_avg: mc_mean=0.2121 mb_mean=0.5023 norm_overlap=0.9979 corr_cb=-0.1174
[EPOCH 024/089] train: loss=1.3024 acc=73.02% | val: loss=0.5439 acc=75.90% f1=74.36% auc=79.36% val_score=64.9842 val_score_bestthr=71.3284 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.212, mb=0.502, no=0.998, corr=-0.117) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 70.1617 -> 71.3284
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1797 mb_mean=0.4998 norm_overlap=1.0003 corr_cb=0.0117 topkJ=0.0513
[TRAIN][ep=025] loss=1.2683 acc=75.57%
[TRAIN][ep=025] mask_avg: mc_mean=0.1952 mb_mean=0.5023 norm_overlap=0.9981 corr_cb=-0.1061
[EPOCH 025/089] train: loss=1.2683 acc=75.57% | val: loss=0.5521 acc=77.11% f1=74.67% auc=78.26% val_score=68.2341 val_score_bestthr=73.6277 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.195, mb=0.502, no=0.998, corr=-0.106) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 71.3284 -> 73.6277
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2298 mb_mean=0.5001 norm_overlap=0.9971 corr_cb=-0.1879 topkJ=0.0174
[TRAIN][ep=026] loss=1.2592 acc=75.70%
[TRAIN][ep=026] mask_avg: mc_mean=0.2181 mb_mean=0.5023 norm_overlap=0.9980 corr_cb=-0.1147
[EPOCH 026/089] train: loss=1.2592 acc=75.70% | val: loss=0.5408 acc=78.31% f1=77.50% auc=79.59% val_score=54.8474 val_score_bestthr=72.6051 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.218, mb=0.502, no=0.998, corr=-0.115) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 72.6051
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1649 mb_mean=0.5032 norm_overlap=0.9974 corr_cb=-0.1465 topkJ=0.0367
[TRAIN][ep=027] loss=1.2389 acc=75.70%
[TRAIN][ep=027] mask_avg: mc_mean=0.2167 mb_mean=0.5023 norm_overlap=0.9979 corr_cb=-0.1165
[EPOCH 027/089] train: loss=1.2389 acc=75.70% | val: loss=0.5828 acc=73.49% f1=72.50% auc=77.62% val_score=64.4158 val_score_bestthr=68.2341 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.217, mb=0.502, no=0.998, corr=-0.117) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 68.2341
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2046 mb_mean=0.5016 norm_overlap=1.0000 corr_cb=-0.0022 topkJ=0.0506
[TRAIN][ep=028] loss=1.2272 acc=77.99%
[TRAIN][ep=028] mask_avg: mc_mean=0.2195 mb_mean=0.5023 norm_overlap=0.9980 corr_cb=-0.1056
[EPOCH 028/089] train: loss=1.2272 acc=77.99% | val: loss=0.5471 acc=77.11% f1=75.95% auc=78.55% val_score=64.0724 val_score_bestthr=72.4213 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.219, mb=0.502, no=0.998, corr=-0.106) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 72.4213
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2136 mb_mean=0.5039 norm_overlap=0.9985 corr_cb=-0.0889 topkJ=0.0723
[TRAIN][ep=029] loss=1.2374 acc=77.85%
[TRAIN][ep=029] mask_avg: mc_mean=0.2249 mb_mean=0.5023 norm_overlap=0.9979 corr_cb=-0.1157
[EPOCH 029/089] train: loss=1.2374 acc=77.85% | val: loss=0.5472 acc=74.70% f1=72.73% auc=80.35% val_score=68.0011 val_score_bestthr=70.5527 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.225, mb=0.502, no=0.998, corr=-0.116) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 70.5527
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.1424 mb_mean=0.5015 norm_overlap=0.9979 corr_cb=-0.1030 topkJ=0.0329
[TRAIN][ep=030] loss=1.2307 acc=77.05%
[TRAIN][ep=030] mask_avg: mc_mean=0.2210 mb_mean=0.5023 norm_overlap=0.9978 corr_cb=-0.1200
[EPOCH 030/089] train: loss=1.2307 acc=77.05% | val: loss=0.5830 acc=71.08% f1=75.00% auc=79.53% val_score=64.4158 val_score_bestthr=73.4125 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.221, mb=0.502, no=0.998, corr=-0.120) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 73.4125
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2886 mb_mean=0.5032 norm_overlap=0.9984 corr_cb=-0.1154 topkJ=0.0401
[TRAIN][ep=031] loss=1.0401 acc=77.58%
[TRAIN][ep=031] mask_avg: mc_mean=0.2233 mb_mean=0.5023 norm_overlap=0.9974 corr_cb=-0.1376
[EPOCH 031/089] train: loss=1.0401 acc=77.58% | val: loss=0.5661 acc=73.49% f1=72.50% auc=78.43% val_score=62.8147 val_score_bestthr=68.2341 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.223, mb=0.502, no=0.997, corr=-0.138) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 68.2341
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2169 mb_mean=0.5001 norm_overlap=0.9950 corr_cb=-0.2477 topkJ=0.0344
[TRAIN][ep=032] loss=0.8495 acc=78.39%
[TRAIN][ep=032] mask_avg: mc_mean=0.2150 mb_mean=0.5023 norm_overlap=0.9973 corr_cb=-0.1392
[EPOCH 032/089] train: loss=0.8495 acc=78.39% | val: loss=0.5572 acc=68.67% f1=75.93% auc=78.95% val_score=51.1842 val_score_bestthr=68.2387 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.215, mb=0.502, no=0.997, corr=-0.139) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 68.2387
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1914 mb_mean=0.5007 norm_overlap=0.9989 corr_cb=-0.0688 topkJ=0.0677
[TRAIN][ep=033] loss=0.7913 acc=78.79%
[TRAIN][ep=033] mask_avg: mc_mean=0.2120 mb_mean=0.5023 norm_overlap=0.9973 corr_cb=-0.1314
[EPOCH 033/089] train: loss=0.7913 acc=78.79% | val: loss=0.5519 acc=68.67% f1=75.93% auc=78.95% val_score=59.4025 val_score_bestthr=68.2387 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.212, mb=0.502, no=0.997, corr=-0.131) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 68.2387
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2666 mb_mean=0.5049 norm_overlap=0.9961 corr_cb=-0.2209 topkJ=0.0252
[TRAIN][ep=034] loss=0.7782 acc=79.06%
[TRAIN][ep=034] mask_avg: mc_mean=0.2341 mb_mean=0.5023 norm_overlap=0.9973 corr_cb=-0.1407
[EPOCH 034/089] train: loss=0.7782 acc=79.06% | val: loss=0.6057 acc=69.88% f1=75.25% auc=79.42% val_score=65.7650 val_score_bestthr=69.0388 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.234, mb=0.502, no=0.997, corr=-0.141) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 69.0388
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2893 mb_mean=0.5025 norm_overlap=0.9953 corr_cb=-0.2151 topkJ=0.0252
[TRAIN][ep=035] loss=0.7623 acc=80.13%
[TRAIN][ep=035] mask_avg: mc_mean=0.2587 mb_mean=0.5023 norm_overlap=0.9971 corr_cb=-0.1646
[EPOCH 035/089] train: loss=0.7623 acc=80.13% | val: loss=0.5687 acc=68.67% f1=74.00% auc=78.66% val_score=62.1499 val_score_bestthr=67.0695 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.259, mb=0.502, no=0.997, corr=-0.165) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 67.0695
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2042 mb_mean=0.5025 norm_overlap=0.9976 corr_cb=-0.1101 topkJ=0.0599
[TRAIN][ep=036] loss=0.7647 acc=80.81%
[TRAIN][ep=036] mask_avg: mc_mean=0.2287 mb_mean=0.5023 norm_overlap=0.9974 corr_cb=-0.1334
[EPOCH 036/089] train: loss=0.7647 acc=80.81% | val: loss=0.5685 acc=71.08% f1=75.51% auc=78.08% val_score=64.5926 val_score_bestthr=68.9195 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.229, mb=0.502, no=0.997, corr=-0.133) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 68.9195
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1651 mb_mean=0.5040 norm_overlap=0.9962 corr_cb=-0.1747 topkJ=0.0312
[TRAIN][ep=037] loss=0.7498 acc=80.40%
[TRAIN][ep=037] mask_avg: mc_mean=0.2276 mb_mean=0.5023 norm_overlap=0.9974 corr_cb=-0.1347
[EPOCH 037/089] train: loss=0.7498 acc=80.40% | val: loss=0.5627 acc=72.29% f1=76.77% auc=79.24% val_score=54.8619 val_score_bestthr=70.9047 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.228, mb=0.502, no=0.997, corr=-0.135) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 70.9047
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2608 mb_mean=0.5023 norm_overlap=0.9933 corr_cb=-0.3295 topkJ=0.0107
[TRAIN][ep=038] loss=0.7311 acc=80.81%
[TRAIN][ep=038] mask_avg: mc_mean=0.2482 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1588
[EPOCH 038/089] train: loss=0.7311 acc=80.81% | val: loss=0.5750 acc=68.67% f1=76.36% auc=78.14% val_score=61.8819 val_score_bestthr=71.8036 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.248, mb=0.502, no=0.997, corr=-0.159) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 71.8036
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2669 mb_mean=0.5023 norm_overlap=0.9952 corr_cb=-0.2644 topkJ=0.0278
[TRAIN][ep=039] loss=0.7307 acc=81.88%
[TRAIN][ep=039] mask_avg: mc_mean=0.2441 mb_mean=0.5023 norm_overlap=0.9972 corr_cb=-0.1443
[EPOCH 039/089] train: loss=0.7307 acc=81.88% | val: loss=0.5964 acc=68.67% f1=75.93% auc=76.69% val_score=58.4968 val_score_bestthr=68.2387 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.244, mb=0.502, no=0.997, corr=-0.144) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 68.2387
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.1780 mb_mean=0.5019 norm_overlap=0.9967 corr_cb=-0.1382 topkJ=0.0411
[TRAIN][ep=040] loss=0.7284 acc=81.48%
[TRAIN][ep=040] mask_avg: mc_mean=0.2251 mb_mean=0.5023 norm_overlap=0.9971 corr_cb=-0.1422
[EPOCH 040/089] train: loss=0.7284 acc=81.48% | val: loss=0.5893 acc=72.29% f1=76.77% auc=78.66% val_score=64.3697 val_score_bestthr=70.9047 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.225, mb=0.502, no=0.997, corr=-0.142) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 70.9047
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.2532 mb_mean=0.5002 norm_overlap=0.9979 corr_cb=-0.1217 topkJ=0.0251
[TRAIN][ep=041] loss=0.7128 acc=81.88%
[TRAIN][ep=041] mask_avg: mc_mean=0.2478 mb_mean=0.5023 norm_overlap=0.9972 corr_cb=-0.1422
[EPOCH 041/089] train: loss=0.7128 acc=81.88% | val: loss=0.5947 acc=72.29% f1=76.77% auc=77.56% val_score=54.9733 val_score_bestthr=70.9047 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.248, mb=0.502, no=0.997, corr=-0.142) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 70.9047
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.1827 mb_mean=0.5021 norm_overlap=0.9979 corr_cb=-0.0969 topkJ=0.0237
[TRAIN][ep=042] loss=0.7120 acc=82.28%
[TRAIN][ep=042] mask_avg: mc_mean=0.2291 mb_mean=0.5023 norm_overlap=0.9973 corr_cb=-0.1347
[EPOCH 042/089] train: loss=0.7120 acc=82.28% | val: loss=0.5893 acc=68.67% f1=76.36% auc=77.73% val_score=56.9125 val_score_bestthr=71.8036 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.229, mb=0.502, no=0.997, corr=-0.135) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 71.8036
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.3196 mb_mean=0.5025 norm_overlap=0.9955 corr_cb=-0.2401 topkJ=0.0228
[TRAIN][ep=043] loss=0.7134 acc=82.95%
[TRAIN][ep=043] mask_avg: mc_mean=0.2474 mb_mean=0.5023 norm_overlap=0.9969 corr_cb=-0.1550
[EPOCH 043/089] train: loss=0.7134 acc=82.95% | val: loss=0.6238 acc=67.47% f1=75.68% auc=76.10% val_score=57.3125 val_score_bestthr=71.0318 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.247, mb=0.502, no=0.997, corr=-0.155) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 71.0318
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2516 mb_mean=0.5062 norm_overlap=1.0008 corr_cb=0.0378 topkJ=0.0615
[TRAIN][ep=044] loss=0.6906 acc=83.22%
[TRAIN][ep=044] mask_avg: mc_mean=0.2476 mb_mean=0.5023 norm_overlap=0.9971 corr_cb=-0.1488
[EPOCH 044/089] train: loss=0.6906 acc=83.22% | val: loss=0.6323 acc=67.47% f1=75.68% auc=77.67% val_score=61.7270 val_score_bestthr=71.0318 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.248, mb=0.502, no=0.997, corr=-0.149) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 71.0318
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2983 mb_mean=0.5009 norm_overlap=0.9983 corr_cb=-0.0777 topkJ=0.0706
[TRAIN][ep=045] loss=0.6963 acc=84.03%
[TRAIN][ep=045] mask_avg: mc_mean=0.2588 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1527
[EPOCH 045/089] train: loss=0.6963 acc=84.03% | val: loss=0.6878 acc=71.08% f1=76.47% auc=75.81% val_score=64.2011 val_score_bestthr=71.5735 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.259, mb=0.502, no=0.997, corr=-0.153) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 71.5735
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.2014 mb_mean=0.5026 norm_overlap=0.9988 corr_cb=-0.0457 topkJ=0.0713
[TRAIN][ep=046] loss=0.6902 acc=83.36%
[TRAIN][ep=046] mask_avg: mc_mean=0.2179 mb_mean=0.5023 norm_overlap=0.9972 corr_cb=-0.1309
[EPOCH 046/089] train: loss=0.6902 acc=83.36% | val: loss=0.6446 acc=72.29% f1=76.77% auc=76.45% val_score=61.7776 val_score_bestthr=69.6873 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.218, mb=0.502, no=0.997, corr=-0.131) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 69.6873
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.2746 mb_mean=0.5033 norm_overlap=0.9965 corr_cb=-0.2041 topkJ=0.0158
[TRAIN][ep=047] loss=0.6868 acc=84.03%
[TRAIN][ep=047] mask_avg: mc_mean=0.2584 mb_mean=0.5023 norm_overlap=0.9969 corr_cb=-0.1575
[EPOCH 047/089] train: loss=0.6868 acc=84.03% | val: loss=0.6633 acc=67.47% f1=75.68% auc=75.64% val_score=56.0501 val_score_bestthr=71.0318 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.258, mb=0.502, no=0.997, corr=-0.158) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 71.0318
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.2727 mb_mean=0.5001 norm_overlap=0.9959 corr_cb=-0.2134 topkJ=0.0230
[TRAIN][ep=048] loss=0.6535 acc=85.77%
[TRAIN][ep=048] mask_avg: mc_mean=0.2439 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1453
[EPOCH 048/089] train: loss=0.6535 acc=85.77% | val: loss=0.7509 acc=68.67% f1=75.93% auc=76.10% val_score=68.0929 val_score_bestthr=71.1606 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.244, mb=0.502, no=0.997, corr=-0.145) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 71.1606
[DBG][ep=049] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.2391 mb_mean=0.4996 norm_overlap=0.9937 corr_cb=-0.3039 topkJ=0.0202
[TRAIN][ep=049] loss=0.7296 acc=80.13%
[TRAIN][ep=049] mask_avg: mc_mean=0.2238 mb_mean=0.5023 norm_overlap=0.9968 corr_cb=-0.1488
[EPOCH 049/089] train: loss=0.7296 acc=80.13% | val: loss=0.7047 acc=69.88% f1=77.06% auc=75.47% val_score=69.0388 val_score_bestthr=74.1280 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.224, mb=0.502, no=0.997, corr=-0.149) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 73.6277 -> 74.1280
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=050] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.2450 mb_mean=0.5034 norm_overlap=0.9943 corr_cb=-0.2677 topkJ=0.0097
[TRAIN][ep=050] loss=0.6490 acc=86.71%
[TRAIN][ep=050] mask_avg: mc_mean=0.2569 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1770
[EPOCH 050/089] train: loss=0.6490 acc=86.71% | val: loss=0.6469 acc=72.29% f1=77.23% auc=75.17% val_score=62.5027 val_score_bestthr=72.1419 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.257, mb=0.502, no=0.997, corr=-0.177) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.1419
[DBG][ep=051] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.2090 mb_mean=0.5047 norm_overlap=1.0003 corr_cb=0.0175 topkJ=0.0683
[TRAIN][ep=051] loss=0.6370 acc=87.65%
[TRAIN][ep=051] mask_avg: mc_mean=0.2569 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1723
[EPOCH 051/089] train: loss=0.6370 acc=87.65% | val: loss=0.6484 acc=72.29% f1=77.23% auc=75.58% val_score=62.5027 val_score_bestthr=72.1419 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.257, mb=0.502, no=0.997, corr=-0.172) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.1419
[DBG][ep=052] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.2574 mb_mean=0.5020 norm_overlap=0.9955 corr_cb=-0.2360 topkJ=0.0357
[TRAIN][ep=052] loss=0.6291 acc=88.19%
[TRAIN][ep=052] mask_avg: mc_mean=0.2569 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1751
[EPOCH 052/089] train: loss=0.6291 acc=88.19% | val: loss=0.6508 acc=72.29% f1=77.23% auc=75.81% val_score=61.7074 val_score_bestthr=72.1419 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.257, mb=0.502, no=0.996, corr=-0.175) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.1419
[DBG][ep=053] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.2726 mb_mean=0.5023 norm_overlap=0.9967 corr_cb=-0.1803 topkJ=0.0286
[TRAIN][ep=053] loss=0.6310 acc=88.59%
[TRAIN][ep=053] mask_avg: mc_mean=0.2568 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1757
[EPOCH 053/089] train: loss=0.6310 acc=88.59% | val: loss=0.6529 acc=71.08% f1=76.47% auc=75.93% val_score=61.0754 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.257, mb=0.502, no=0.997, corr=-0.176) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=054] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=054] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=054] mask(step0): mc_mean=0.2639 mb_mean=0.5013 norm_overlap=0.9963 corr_cb=-0.1722 topkJ=0.0293
[TRAIN][ep=054] loss=0.6234 acc=87.65%
[TRAIN][ep=054] mask_avg: mc_mean=0.2568 mb_mean=0.5023 norm_overlap=0.9964 corr_cb=-0.1806
[EPOCH 054/089] train: loss=0.6234 acc=87.65% | val: loss=0.6593 acc=71.08% f1=76.47% auc=75.87% val_score=56.5112 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.257, mb=0.502, no=0.996, corr=-0.181) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=055] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=055] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=055] mask(step0): mc_mean=0.2618 mb_mean=0.5029 norm_overlap=0.9938 corr_cb=-0.3138 topkJ=0.0113
[TRAIN][ep=055] loss=0.6241 acc=88.59%
[TRAIN][ep=055] mask_avg: mc_mean=0.2569 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1761
[EPOCH 055/089] train: loss=0.6241 acc=88.59% | val: loss=0.6623 acc=71.08% f1=76.47% auc=75.99% val_score=61.0754 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.257, mb=0.502, no=0.997, corr=-0.176) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=056] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=056] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=056] mask(step0): mc_mean=0.2286 mb_mean=0.5009 norm_overlap=0.9961 corr_cb=-0.2295 topkJ=0.0293
[TRAIN][ep=056] loss=0.6213 acc=88.19%
[TRAIN][ep=056] mask_avg: mc_mean=0.2570 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1771
[EPOCH 056/089] train: loss=0.6213 acc=88.19% | val: loss=0.6679 acc=71.08% f1=76.47% auc=75.87% val_score=56.5112 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.257, mb=0.502, no=0.997, corr=-0.177) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=057] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=057] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=057] mask(step0): mc_mean=0.2749 mb_mean=0.5026 norm_overlap=0.9966 corr_cb=-0.1938 topkJ=0.0305
[TRAIN][ep=057] loss=0.6176 acc=88.59%
[TRAIN][ep=057] mask_avg: mc_mean=0.2568 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1736
[EPOCH 057/089] train: loss=0.6176 acc=88.59% | val: loss=0.6723 acc=68.67% f1=75.93% auc=75.76% val_score=56.1793 val_score_bestthr=71.1606 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.257, mb=0.502, no=0.997, corr=-0.174) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 71.1606
[DBG][ep=058] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=058] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=058] mask(step0): mc_mean=0.2168 mb_mean=0.5051 norm_overlap=0.9967 corr_cb=-0.1940 topkJ=0.0349
[TRAIN][ep=058] loss=0.6172 acc=88.19%
[TRAIN][ep=058] mask_avg: mc_mean=0.2568 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1723
[EPOCH 058/089] train: loss=0.6172 acc=88.19% | val: loss=0.6713 acc=71.08% f1=76.47% auc=75.99% val_score=61.0754 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.257, mb=0.502, no=0.997, corr=-0.172) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=059] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=059] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=059] mask(step0): mc_mean=0.2843 mb_mean=0.4997 norm_overlap=0.9958 corr_cb=-0.2257 topkJ=0.0437
[TRAIN][ep=059] loss=0.6138 acc=88.72%
[TRAIN][ep=059] mask_avg: mc_mean=0.2569 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1743
[EPOCH 059/089] train: loss=0.6138 acc=88.72% | val: loss=0.6803 acc=71.08% f1=76.47% auc=75.99% val_score=60.3488 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.257, mb=0.502, no=0.997, corr=-0.174) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=060] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=060] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=060] mask(step0): mc_mean=0.2797 mb_mean=0.4999 norm_overlap=0.9956 corr_cb=-0.2487 topkJ=0.0162
[TRAIN][ep=060] loss=0.6150 acc=89.40%
[TRAIN][ep=060] mask_avg: mc_mean=0.2568 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1745
[EPOCH 060/089] train: loss=0.6150 acc=89.40% | val: loss=0.6778 acc=69.88% f1=75.73% auc=75.87% val_score=61.0754 val_score_bestthr=71.6631 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.257, mb=0.502, no=0.997, corr=-0.174) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 71.6631
[DBG][ep=061] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=061] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=061] mask(step0): mc_mean=0.2829 mb_mean=0.5016 norm_overlap=0.9894 corr_cb=-0.4328 topkJ=0.0079
[TRAIN][ep=061] loss=0.6115 acc=89.53%
[TRAIN][ep=061] mask_avg: mc_mean=0.2569 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1739
[EPOCH 061/089] train: loss=0.6115 acc=89.53% | val: loss=0.6834 acc=71.08% f1=76.47% auc=75.81% val_score=61.0754 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.257, mb=0.502, no=0.997, corr=-0.174) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=062] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=062] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=062] mask(step0): mc_mean=0.2809 mb_mean=0.5002 norm_overlap=0.9964 corr_cb=-0.2153 topkJ=0.0266
[TRAIN][ep=062] loss=0.6124 acc=88.05%
[TRAIN][ep=062] mask_avg: mc_mean=0.2569 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1742
[EPOCH 062/089] train: loss=0.6124 acc=88.05% | val: loss=0.6840 acc=71.08% f1=76.47% auc=75.76% val_score=61.7074 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.257, mb=0.502, no=0.997, corr=-0.174) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=063] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=063] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=063] mask(step0): mc_mean=0.2490 mb_mean=0.5036 norm_overlap=0.9964 corr_cb=-0.1674 topkJ=0.0228
[TRAIN][ep=063] loss=0.6205 acc=87.25%
[TRAIN][ep=063] mask_avg: mc_mean=0.2569 mb_mean=0.5023 norm_overlap=0.9964 corr_cb=-0.1802
[EPOCH 063/089] train: loss=0.6205 acc=87.25% | val: loss=0.6864 acc=69.88% f1=75.73% auc=75.58% val_score=61.0754 val_score_bestthr=71.6631 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.257, mb=0.502, no=0.996, corr=-0.180) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 71.6631
[DBG][ep=064] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=064] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=064] mask(step0): mc_mean=0.2564 mb_mean=0.5016 norm_overlap=0.9955 corr_cb=-0.2021 topkJ=0.0400
[TRAIN][ep=064] loss=0.6053 acc=89.40%
[TRAIN][ep=064] mask_avg: mc_mean=0.2569 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1773
[EPOCH 064/089] train: loss=0.6053 acc=89.40% | val: loss=0.6917 acc=69.88% f1=75.73% auc=75.52% val_score=61.7074 val_score_bestthr=71.6631 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.257, mb=0.502, no=0.996, corr=-0.177) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 71.6631
[DBG][ep=065] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=065] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=065] mask(step0): mc_mean=0.2093 mb_mean=0.5027 norm_overlap=0.9956 corr_cb=-0.2215 topkJ=0.0276
[TRAIN][ep=065] loss=0.6080 acc=88.99%
[TRAIN][ep=065] mask_avg: mc_mean=0.2569 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1738
[EPOCH 065/089] train: loss=0.6080 acc=88.99% | val: loss=0.6913 acc=69.88% f1=76.64% auc=75.70% val_score=61.0754 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.257, mb=0.502, no=0.997, corr=-0.174) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.2690
[DBG][ep=066] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=066] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=066] mask(step0): mc_mean=0.2286 mb_mean=0.5044 norm_overlap=0.9961 corr_cb=-0.2210 topkJ=0.0304
[TRAIN][ep=066] loss=0.6044 acc=88.99%
[TRAIN][ep=066] mask_avg: mc_mean=0.2569 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1728
[EPOCH 066/089] train: loss=0.6044 acc=88.99% | val: loss=0.7089 acc=71.08% f1=76.47% auc=75.93% val_score=62.3569 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.257, mb=0.502, no=0.997, corr=-0.173) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.7764
[DBG][ep=067] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=067] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=067] mask(step0): mc_mean=0.2569 mb_mean=0.4998 norm_overlap=0.9983 corr_cb=-0.0785 topkJ=0.0458
[TRAIN][ep=067] loss=0.6042 acc=89.40%
[TRAIN][ep=067] mask_avg: mc_mean=0.2569 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1723
[EPOCH 067/089] train: loss=0.6042 acc=89.40% | val: loss=0.7021 acc=69.88% f1=76.64% auc=75.70% val_score=57.6793 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.257, mb=0.502, no=0.997, corr=-0.172) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.2690
[DBG][ep=068] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=068] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=068] mask(step0): mc_mean=0.2453 mb_mean=0.5046 norm_overlap=0.9933 corr_cb=-0.3248 topkJ=0.0275
[TRAIN][ep=068] loss=0.5995 acc=87.79%
[TRAIN][ep=068] mask_avg: mc_mean=0.2569 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1762
[EPOCH 068/089] train: loss=0.5995 acc=87.79% | val: loss=0.7066 acc=69.88% f1=76.64% auc=75.93% val_score=61.7074 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.257, mb=0.502, no=0.996, corr=-0.176) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.2690
[DBG][ep=069] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=069] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=069] mask(step0): mc_mean=0.2833 mb_mean=0.5008 norm_overlap=0.9983 corr_cb=-0.0865 topkJ=0.0403
[TRAIN][ep=069] loss=0.5984 acc=88.72%
[TRAIN][ep=069] mask_avg: mc_mean=0.2568 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1726
[EPOCH 069/089] train: loss=0.5984 acc=88.72% | val: loss=0.7110 acc=68.67% f1=75.00% auc=75.52% val_score=54.1474 val_score_bestthr=71.0991 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.257, mb=0.502, no=0.997, corr=-0.173) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 71.0991
[DBG][ep=070] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=070] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=070] mask(step0): mc_mean=0.2491 mb_mean=0.5018 norm_overlap=0.9976 corr_cb=-0.1136 topkJ=0.0628
[TRAIN][ep=070] loss=0.5976 acc=89.13%
[TRAIN][ep=070] mask_avg: mc_mean=0.2569 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1733
[EPOCH 070/089] train: loss=0.5976 acc=89.13% | val: loss=0.7246 acc=69.88% f1=76.64% auc=75.93% val_score=64.5698 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.257, mb=0.502, no=0.997, corr=-0.173) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.2690
[DBG][ep=071] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=071] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=071] mask(step0): mc_mean=0.2516 mb_mean=0.5030 norm_overlap=0.9943 corr_cb=-0.3007 topkJ=0.0132
[TRAIN][ep=071] loss=0.5983 acc=89.13%
[TRAIN][ep=071] mask_avg: mc_mean=0.2568 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1739
[EPOCH 071/089] train: loss=0.5983 acc=89.13% | val: loss=0.7098 acc=69.88% f1=76.64% auc=75.52% val_score=63.3989 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.257, mb=0.502, no=0.997, corr=-0.174) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.2690
[DBG][ep=072] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=072] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=072] mask(step0): mc_mean=0.2687 mb_mean=0.5026 norm_overlap=0.9965 corr_cb=-0.1922 topkJ=0.0194
[TRAIN][ep=072] loss=0.5984 acc=88.46%
[TRAIN][ep=072] mask_avg: mc_mean=0.2568 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1738
[EPOCH 072/089] train: loss=0.5984 acc=88.46% | val: loss=0.7103 acc=69.88% f1=76.64% auc=75.70% val_score=61.0754 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.257, mb=0.502, no=0.997, corr=-0.174) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.2690
[DBG][ep=073] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=073] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=073] mask(step0): mc_mean=0.2366 mb_mean=0.5011 norm_overlap=0.9989 corr_cb=-0.0639 topkJ=0.0701
[TRAIN][ep=073] loss=0.5959 acc=89.26%
[TRAIN][ep=073] mask_avg: mc_mean=0.2569 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1756
[EPOCH 073/089] train: loss=0.5959 acc=89.26% | val: loss=0.7229 acc=69.88% f1=76.64% auc=75.52% val_score=54.1474 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.257, mb=0.502, no=0.997, corr=-0.176) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.2690
[DBG][ep=074] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=074] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=074] mask(step0): mc_mean=0.2277 mb_mean=0.5028 norm_overlap=0.9961 corr_cb=-0.1985 topkJ=0.0222
[TRAIN][ep=074] loss=0.5969 acc=88.05%
[TRAIN][ep=074] mask_avg: mc_mean=0.2570 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1768
[EPOCH 074/089] train: loss=0.5969 acc=88.05% | val: loss=0.7162 acc=69.88% f1=76.64% auc=75.70% val_score=61.0754 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.257, mb=0.502, no=0.996, corr=-0.177) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.2690
[DBG][ep=075] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=075] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=075] mask(step0): mc_mean=0.3193 mb_mean=0.5013 norm_overlap=0.9930 corr_cb=-0.3633 topkJ=0.0060
[TRAIN][ep=075] loss=0.5981 acc=88.72%
[TRAIN][ep=075] mask_avg: mc_mean=0.2569 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1729
[EPOCH 075/089] train: loss=0.5981 acc=88.72% | val: loss=0.7167 acc=69.88% f1=76.64% auc=75.64% val_score=61.0754 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.257, mb=0.502, no=0.997, corr=-0.173) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.2690
[DBG][ep=076] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=076] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=076] mask(step0): mc_mean=0.2112 mb_mean=0.5030 norm_overlap=0.9992 corr_cb=-0.0407 topkJ=0.0571
[TRAIN][ep=076] loss=0.5979 acc=88.32%
[TRAIN][ep=076] mask_avg: mc_mean=0.2569 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1740
[EPOCH 076/089] train: loss=0.5979 acc=88.32% | val: loss=0.7182 acc=69.88% f1=76.64% auc=75.93% val_score=61.0754 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.257, mb=0.502, no=0.997, corr=-0.174) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.2690
[DBG][ep=077] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=077] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=077] mask(step0): mc_mean=0.2335 mb_mean=0.5034 norm_overlap=0.9945 corr_cb=-0.2886 topkJ=0.0165
[TRAIN][ep=077] loss=0.5927 acc=88.59%
[TRAIN][ep=077] mask_avg: mc_mean=0.2568 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1745
[EPOCH 077/089] train: loss=0.5927 acc=88.59% | val: loss=0.7274 acc=69.88% f1=76.64% auc=75.64% val_score=59.3108 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.257, mb=0.502, no=0.997, corr=-0.175) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.2690
[DBG][ep=078] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=078] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=078] mask(step0): mc_mean=0.2491 mb_mean=0.5031 norm_overlap=0.9973 corr_cb=-0.1077 topkJ=0.0373
[TRAIN][ep=078] loss=0.5901 acc=88.72%
[TRAIN][ep=078] mask_avg: mc_mean=0.2568 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1768
[EPOCH 078/089] train: loss=0.5901 acc=88.72% | val: loss=0.7280 acc=69.88% f1=76.64% auc=75.47% val_score=61.0754 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.257, mb=0.502, no=0.996, corr=-0.177) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.2690
[DBG][ep=079] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=079] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=079] mask(step0): mc_mean=0.2722 mb_mean=0.4999 norm_overlap=0.9963 corr_cb=-0.1982 topkJ=0.0446
[TRAIN][ep=079] loss=0.5860 acc=89.40%
[TRAIN][ep=079] mask_avg: mc_mean=0.2569 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1740
[EPOCH 079/089] train: loss=0.5860 acc=89.40% | val: loss=0.7478 acc=69.88% f1=76.64% auc=75.58% val_score=64.5698 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.257, mb=0.502, no=0.997, corr=-0.174) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.1280 -> 72.2690
[EARLY STOP] no improvement for 30 epochs. best_epoch=49
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
=============== FIT DONE ===============
[BEST] epoch=49 | val_acc=69.88% | val_f1=77.06% | val_auc=75.47% | val_score=69.0388 | val_score_bestthr=74.1280
[TEST@BEST] thr_used=0.545 | acc=62.80% f1=66.95% auc=62.96% | SP_sex=1.63% EO_sex=6.53% SP_age=11.90% EO_age=11.80%
[TIME] 1.99 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/summary_fold_0.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5259 mb_mean=0.5010 norm_overlap=0.9999 corr_cb=-0.0912 topkJ=0.0676
[TRAIN][ep=000] loss=0.6939 acc=50.47%
[TRAIN][ep=000] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0996
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5274 mb_mean=0.4997 norm_overlap=0.9999 corr_cb=-0.2567 topkJ=0.0254
[TRAIN][ep=001] loss=0.6920 acc=50.47%
[TRAIN][ep=001] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0926
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5297 mb_mean=0.5053 norm_overlap=1.0000 corr_cb=0.0154 topkJ=0.0969
[TRAIN][ep=002] loss=0.6899 acc=52.89%
[TRAIN][ep=002] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0983
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5296 mb_mean=0.5000 norm_overlap=0.9999 corr_cb=-0.1407 topkJ=0.0490
[TRAIN][ep=003] loss=0.6882 acc=54.23%
[TRAIN][ep=003] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0952
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5295 mb_mean=0.4987 norm_overlap=0.9999 corr_cb=-0.1840 topkJ=0.0339
[TRAIN][ep=004] loss=0.6887 acc=53.42%
[TRAIN][ep=004] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.1002
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5288 mb_mean=0.5009 norm_overlap=0.9999 corr_cb=-0.1690 topkJ=0.0368
[TRAIN][ep=005] loss=0.6834 acc=56.91%
[TRAIN][ep=005] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0988
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5323 mb_mean=0.5018 norm_overlap=0.9999 corr_cb=-0.2431 topkJ=0.0234
[TRAIN][ep=006] loss=0.6844 acc=54.63%
[TRAIN][ep=006] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0978
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5339 mb_mean=0.5021 norm_overlap=1.0000 corr_cb=-0.0185 topkJ=0.0321
[TRAIN][ep=007] loss=0.6826 acc=57.72%
[TRAIN][ep=007] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0955
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5308 mb_mean=0.5020 norm_overlap=1.0000 corr_cb=-0.0361 topkJ=0.0444
[TRAIN][ep=008] loss=0.6776 acc=57.99%
[TRAIN][ep=008] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0938
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5248 mb_mean=0.5048 norm_overlap=0.9999 corr_cb=-0.0945 topkJ=0.0690
[TRAIN][ep=009] loss=0.6759 acc=58.93%
[TRAIN][ep=009] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0965
================= FIT START (fold=0) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5327 mb_mean=0.5004 norm_overlap=1.0000 corr_cb=-0.0395 topkJ=0.0304
[TRAIN][ep=000] loss=0.6709 acc=61.48%
[TRAIN][ep=000] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0992
[EPOCH 000/089] train: loss=0.6709 acc=61.48% | val: loss=0.6686 acc=62.65% f1=69.31% auc=65.87% val_score=63.8688 val_score_bestthr=64.9727 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.099) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 64.9727
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5321 mb_mean=0.5010 norm_overlap=0.9998 corr_cb=-0.3401 topkJ=0.0082
[TRAIN][ep=001] loss=0.6667 acc=61.34%
[TRAIN][ep=001] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0976
[EPOCH 001/089] train: loss=0.6667 acc=61.34% | val: loss=0.6665 acc=61.45% f1=68.63% auc=65.58% val_score=50.8549 val_score_bestthr=63.8688 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.098) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9727 -> 63.8688
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5308 mb_mean=0.5031 norm_overlap=1.0000 corr_cb=-0.0851 topkJ=0.0316
[TRAIN][ep=002] loss=0.6610 acc=60.94%
[TRAIN][ep=002] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0965
[EPOCH 002/089] train: loss=0.6610 acc=60.94% | val: loss=0.6768 acc=56.63% f1=64.71% auc=64.07% val_score=48.1618 val_score_bestthr=58.9427 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.097) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9727 -> 58.9427
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5303 mb_mean=0.5028 norm_overlap=1.0000 corr_cb=0.0572 topkJ=0.0336
[TRAIN][ep=003] loss=0.6553 acc=64.43%
[TRAIN][ep=003] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0987
[EPOCH 003/089] train: loss=0.6553 acc=64.43% | val: loss=0.6567 acc=62.65% f1=69.31% auc=66.69% val_score=50.8414 val_score_bestthr=64.9727 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.099) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9727 -> 64.9727
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5315 mb_mean=0.5048 norm_overlap=1.0000 corr_cb=-0.0454 topkJ=0.0668
[TRAIN][ep=004] loss=0.6487 acc=65.10%
[TRAIN][ep=004] mask_avg: mc_mean=0.5292 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0985
[EPOCH 004/089] train: loss=0.6487 acc=65.10% | val: loss=0.6513 acc=62.65% f1=69.31% auc=67.73% val_score=56.4760 val_score_bestthr=64.9727 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.099) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9727 -> 64.9727
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5300 mb_mean=0.5015 norm_overlap=0.9999 corr_cb=-0.2288 topkJ=0.0177
[TRAIN][ep=005] loss=1.2500 acc=64.97%
[TRAIN][ep=005] mask_avg: mc_mean=0.3785 mb_mean=0.5023 norm_overlap=1.0007 corr_cb=0.1905
[EPOCH 005/089] train: loss=1.2500 acc=64.97% | val: loss=0.6499 acc=60.24% f1=70.80% auc=70.81% val_score=51.2740 val_score_bestthr=60.5310 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.378, mb=0.502, no=1.001, corr=0.190) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9727 -> 60.5310
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2790 mb_mean=0.5013 norm_overlap=1.0021 corr_cb=0.3845 topkJ=0.1320
[TRAIN][ep=006] loss=1.0278 acc=65.50%
[TRAIN][ep=006] mask_avg: mc_mean=0.2532 mb_mean=0.5023 norm_overlap=1.0013 corr_cb=0.1868
[EPOCH 006/089] train: loss=1.0278 acc=65.50% | val: loss=0.6399 acc=62.65% f1=71.56% auc=71.40% val_score=61.3612 val_score_bestthr=64.3474 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.253, mb=0.502, no=1.001, corr=0.187) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9727 -> 64.3474
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2304 mb_mean=0.5027 norm_overlap=1.0018 corr_cb=0.2134 topkJ=0.0734
[TRAIN][ep=007] loss=0.8239 acc=65.50%
[TRAIN][ep=007] mask_avg: mc_mean=0.2248 mb_mean=0.5023 norm_overlap=1.0012 corr_cb=0.1466
[EPOCH 007/089] train: loss=0.8239 acc=65.50% | val: loss=0.6328 acc=62.65% f1=72.07% auc=72.27% val_score=57.6694 val_score_bestthr=66.1116 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.040, stage2=False) | mask(mc=0.225, mb=0.502, no=1.001, corr=0.147) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 64.9727 -> 66.1116
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2203 mb_mean=0.5013 norm_overlap=1.0005 corr_cb=0.0611 topkJ=0.0710
[TRAIN][ep=008] loss=0.8910 acc=68.05%
[TRAIN][ep=008] mask_avg: mc_mean=0.2099 mb_mean=0.5023 norm_overlap=1.0010 corr_cb=0.1086
[EPOCH 008/089] train: loss=0.8910 acc=68.05% | val: loss=0.6510 acc=65.06% f1=70.10% auc=69.13% val_score=50.8167 val_score_bestthr=62.1649 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.080, stage2=False) | mask(mc=0.210, mb=0.502, no=1.001, corr=0.109) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.1116 -> 62.1649
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2077 mb_mean=0.5024 norm_overlap=1.0004 corr_cb=0.0325 topkJ=0.0710
[TRAIN][ep=009] loss=0.9748 acc=65.91%
[TRAIN][ep=009] mask_avg: mc_mean=0.1888 mb_mean=0.5023 norm_overlap=1.0009 corr_cb=0.0854
[EPOCH 009/089] train: loss=0.9748 acc=65.91% | val: loss=0.6431 acc=63.86% f1=72.73% auc=73.55% val_score=65.7793 val_score_bestthr=64.6393 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.120, stage2=False) | mask(mc=0.189, mb=0.502, no=1.001, corr=0.085) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.1116 -> 64.6393
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1934 mb_mean=0.5010 norm_overlap=1.0013 corr_cb=0.1412 topkJ=0.0740
[TRAIN][ep=010] loss=1.0460 acc=65.91%
[TRAIN][ep=010] mask_avg: mc_mean=0.1917 mb_mean=0.5023 norm_overlap=1.0005 corr_cb=0.0431
[EPOCH 010/089] train: loss=1.0460 acc=65.91% | val: loss=0.6229 acc=63.86% f1=73.68% auc=73.31% val_score=55.7437 val_score_bestthr=66.8001 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.160, stage2=False) | mask(mc=0.192, mb=0.502, no=1.001, corr=0.043) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 66.1116 -> 66.8001
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1881 mb_mean=0.5027 norm_overlap=0.9979 corr_cb=-0.1979 topkJ=0.0560
[TRAIN][ep=011] loss=1.1004 acc=70.47%
[TRAIN][ep=011] mask_avg: mc_mean=0.1851 mb_mean=0.5023 norm_overlap=1.0002 corr_cb=0.0111
[EPOCH 011/089] train: loss=1.1004 acc=70.47% | val: loss=0.6129 acc=63.86% f1=72.73% auc=75.87% val_score=61.5955 val_score_bestthr=67.2118 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.185, mb=0.502, no=1.000, corr=0.011) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 66.8001 -> 67.2118
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1789 mb_mean=0.5005 norm_overlap=1.0000 corr_cb=-0.0000 topkJ=0.1102
[TRAIN][ep=012] loss=1.1816 acc=68.99%
[TRAIN][ep=012] mask_avg: mc_mean=0.1834 mb_mean=0.5023 norm_overlap=0.9997 corr_cb=-0.0229
[EPOCH 012/089] train: loss=1.1816 acc=68.99% | val: loss=0.6702 acc=63.86% f1=70.00% auc=71.57% val_score=46.3517 val_score_bestthr=61.9409 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.183, mb=0.502, no=1.000, corr=-0.023) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.2118 -> 61.9409
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1926 mb_mean=0.5050 norm_overlap=0.9988 corr_cb=-0.0922 topkJ=0.0731
[TRAIN][ep=013] loss=1.1755 acc=69.40%
[TRAIN][ep=013] mask_avg: mc_mean=0.1720 mb_mean=0.5023 norm_overlap=0.9995 corr_cb=-0.0384
[EPOCH 013/089] train: loss=1.1755 acc=69.40% | val: loss=0.6211 acc=62.65% f1=73.04% auc=75.35% val_score=43.2724 val_score_bestthr=65.4702 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.172, mb=0.502, no=0.999, corr=-0.038) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.2118 -> 65.4702
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1649 mb_mean=0.4973 norm_overlap=1.0000 corr_cb=-0.0007 topkJ=0.0562
[TRAIN][ep=014] loss=1.1618 acc=70.60%
[TRAIN][ep=014] mask_avg: mc_mean=0.1890 mb_mean=0.5023 norm_overlap=0.9990 corr_cb=-0.0712
[EPOCH 014/089] train: loss=1.1618 acc=70.60% | val: loss=0.5871 acc=72.29% f1=70.89% auc=76.57% val_score=60.9960 val_score_bestthr=64.9804 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.189, mb=0.502, no=0.999, corr=-0.071) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.2118 -> 64.9804
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1666 mb_mean=0.5022 norm_overlap=1.0002 corr_cb=0.0128 topkJ=0.0615
[TRAIN][ep=015] loss=1.1800 acc=69.40%
[TRAIN][ep=015] mask_avg: mc_mean=0.1933 mb_mean=0.5023 norm_overlap=0.9987 corr_cb=-0.0895
[EPOCH 015/089] train: loss=1.1800 acc=69.40% | val: loss=0.5837 acc=65.06% f1=74.34% auc=78.78% val_score=58.9596 val_score_bestthr=66.4068 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.193, mb=0.502, no=0.999, corr=-0.089) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.2118 -> 66.4068
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1758 mb_mean=0.5002 norm_overlap=0.9989 corr_cb=-0.0799 topkJ=0.0429
[TRAIN][ep=016] loss=1.1680 acc=70.60%
[TRAIN][ep=016] mask_avg: mc_mean=0.1961 mb_mean=0.5023 norm_overlap=0.9983 corr_cb=-0.1154
[EPOCH 016/089] train: loss=1.1680 acc=70.60% | val: loss=0.5748 acc=74.70% f1=72.73% auc=78.26% val_score=68.0866 val_score_bestthr=68.0866 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.196, mb=0.502, no=0.998, corr=-0.115) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 67.2118 -> 68.0866
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.2289 mb_mean=0.5033 norm_overlap=0.9967 corr_cb=-0.2088 topkJ=0.0227
[TRAIN][ep=017] loss=1.1580 acc=71.41%
[TRAIN][ep=017] mask_avg: mc_mean=0.2091 mb_mean=0.5023 norm_overlap=0.9982 corr_cb=-0.1193
[EPOCH 017/089] train: loss=1.1580 acc=71.41% | val: loss=0.5823 acc=67.47% f1=73.27% auc=78.31% val_score=62.4076 val_score_bestthr=67.0451 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.209, mb=0.502, no=0.998, corr=-0.119) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.0866 -> 67.0451
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1917 mb_mean=0.5025 norm_overlap=0.9988 corr_cb=-0.0734 topkJ=0.0466
[TRAIN][ep=018] loss=1.1398 acc=72.08%
[TRAIN][ep=018] mask_avg: mc_mean=0.2016 mb_mean=0.5023 norm_overlap=0.9983 corr_cb=-0.1064
[EPOCH 018/089] train: loss=1.1398 acc=72.08% | val: loss=0.6049 acc=63.86% f1=74.14% auc=79.13% val_score=63.5930 val_score_bestthr=68.8312 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.202, mb=0.502, no=0.998, corr=-0.106) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 68.0866 -> 68.8312
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1570 mb_mean=0.5022 norm_overlap=0.9967 corr_cb=-0.2042 topkJ=0.0535
[TRAIN][ep=019] loss=1.1315 acc=72.75%
[TRAIN][ep=019] mask_avg: mc_mean=0.1973 mb_mean=0.5023 norm_overlap=0.9981 corr_cb=-0.1107
[EPOCH 019/089] train: loss=1.1315 acc=72.75% | val: loss=0.5593 acc=74.70% f1=72.73% auc=78.60% val_score=64.9804 val_score_bestthr=68.0866 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.197, mb=0.502, no=0.998, corr=-0.111) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.8312 -> 68.0866
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.2350 mb_mean=0.5020 norm_overlap=0.9986 corr_cb=-0.0716 topkJ=0.0815
[TRAIN][ep=020] loss=1.1239 acc=72.89%
[TRAIN][ep=020] mask_avg: mc_mean=0.2041 mb_mean=0.5023 norm_overlap=0.9981 corr_cb=-0.1117
[EPOCH 020/089] train: loss=1.1239 acc=72.89% | val: loss=0.5770 acc=74.70% f1=72.00% auc=76.80% val_score=66.6390 val_score_bestthr=69.4062 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.204, mb=0.502, no=0.998, corr=-0.112) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 68.8312 -> 69.4062
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2327 mb_mean=0.5058 norm_overlap=0.9978 corr_cb=-0.1336 topkJ=0.0339
[TRAIN][ep=021] loss=1.1351 acc=71.81%
[TRAIN][ep=021] mask_avg: mc_mean=0.2064 mb_mean=0.5023 norm_overlap=0.9980 corr_cb=-0.1157
[EPOCH 021/089] train: loss=1.1351 acc=71.81% | val: loss=0.5613 acc=74.70% f1=72.00% auc=78.31% val_score=68.0866 val_score_bestthr=69.4062 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.206, mb=0.502, no=0.998, corr=-0.116) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.4062 -> 69.4062
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2584 mb_mean=0.4996 norm_overlap=0.9987 corr_cb=-0.0718 topkJ=0.0364
[TRAIN][ep=022] loss=1.1032 acc=74.09%
[TRAIN][ep=022] mask_avg: mc_mean=0.2293 mb_mean=0.5023 norm_overlap=0.9977 corr_cb=-0.1417
[EPOCH 022/089] train: loss=1.1032 acc=74.09% | val: loss=0.5575 acc=75.90% f1=73.68% auc=77.97% val_score=70.8552 val_score_bestthr=70.8552 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.229, mb=0.502, no=0.998, corr=-0.142) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 69.4062 -> 70.8552
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1374 mb_mean=0.5023 norm_overlap=0.9978 corr_cb=-0.1142 topkJ=0.0262
[TRAIN][ep=023] loss=1.0854 acc=74.90%
[TRAIN][ep=023] mask_avg: mc_mean=0.2153 mb_mean=0.5023 norm_overlap=0.9979 corr_cb=-0.1181
[EPOCH 023/089] train: loss=1.0854 acc=74.90% | val: loss=0.5710 acc=75.90% f1=73.68% auc=77.67% val_score=61.6465 val_score_bestthr=70.8552 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.215, mb=0.502, no=0.998, corr=-0.118) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.8552 -> 70.8552
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2217 mb_mean=0.5016 norm_overlap=0.9968 corr_cb=-0.1950 topkJ=0.0452
[TRAIN][ep=024] loss=1.1121 acc=72.62%
[TRAIN][ep=024] mask_avg: mc_mean=0.2186 mb_mean=0.5023 norm_overlap=0.9979 corr_cb=-0.1190
[EPOCH 024/089] train: loss=1.1121 acc=72.62% | val: loss=0.5433 acc=75.90% f1=74.36% auc=79.24% val_score=62.8550 val_score_bestthr=71.3284 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.219, mb=0.502, no=0.998, corr=-0.119) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 70.8552 -> 71.3284
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1791 mb_mean=0.4998 norm_overlap=1.0004 corr_cb=0.0180 topkJ=0.0526
[TRAIN][ep=025] loss=1.0785 acc=75.70%
[TRAIN][ep=025] mask_avg: mc_mean=0.1983 mb_mean=0.5023 norm_overlap=0.9980 corr_cb=-0.1066
[EPOCH 025/089] train: loss=1.0785 acc=75.70% | val: loss=0.5516 acc=75.90% f1=72.97% auc=78.37% val_score=68.2341 val_score_bestthr=72.1773 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.198, mb=0.502, no=0.998, corr=-0.107) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 71.3284 -> 72.1773
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2336 mb_mean=0.5001 norm_overlap=0.9972 corr_cb=-0.1814 topkJ=0.0178
[TRAIN][ep=026] loss=1.0703 acc=76.11%
[TRAIN][ep=026] mask_avg: mc_mean=0.2221 mb_mean=0.5023 norm_overlap=0.9979 corr_cb=-0.1163
[EPOCH 026/089] train: loss=1.0703 acc=76.11% | val: loss=0.5396 acc=78.31% f1=77.50% auc=79.42% val_score=55.9319 val_score_bestthr=72.6051 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.222, mb=0.502, no=0.998, corr=-0.116) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 72.1773 -> 72.6051
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1681 mb_mean=0.5032 norm_overlap=0.9973 corr_cb=-0.1515 topkJ=0.0354
[TRAIN][ep=027] loss=1.0522 acc=75.70%
[TRAIN][ep=027] mask_avg: mc_mean=0.2204 mb_mean=0.5023 norm_overlap=0.9978 corr_cb=-0.1179
[EPOCH 027/089] train: loss=1.0522 acc=75.70% | val: loss=0.5815 acc=73.49% f1=72.50% auc=77.97% val_score=64.4158 val_score_bestthr=68.2341 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.220, mb=0.502, no=0.998, corr=-0.118) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.6051 -> 68.2341
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2063 mb_mean=0.5016 norm_overlap=1.0000 corr_cb=0.0032 topkJ=0.0501
[TRAIN][ep=028] loss=1.0409 acc=78.12%
[TRAIN][ep=028] mask_avg: mc_mean=0.2219 mb_mean=0.5023 norm_overlap=0.9980 corr_cb=-0.1063
[EPOCH 028/089] train: loss=1.0409 acc=78.12% | val: loss=0.5466 acc=77.11% f1=75.95% auc=79.01% val_score=64.0724 val_score_bestthr=72.4213 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.222, mb=0.502, no=0.998, corr=-0.106) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.6051 -> 72.4213
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2221 mb_mean=0.5039 norm_overlap=0.9985 corr_cb=-0.0891 topkJ=0.0736
[TRAIN][ep=029] loss=1.0539 acc=77.85%
[TRAIN][ep=029] mask_avg: mc_mean=0.2290 mb_mean=0.5023 norm_overlap=0.9979 corr_cb=-0.1166
[EPOCH 029/089] train: loss=1.0539 acc=77.85% | val: loss=0.5491 acc=74.70% f1=72.73% auc=80.35% val_score=67.1215 val_score_bestthr=70.5527 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.229, mb=0.502, no=0.998, corr=-0.117) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.6051 -> 70.5527
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.1453 mb_mean=0.5015 norm_overlap=0.9978 corr_cb=-0.1065 topkJ=0.0325
[TRAIN][ep=030] loss=1.0471 acc=76.64%
[TRAIN][ep=030] mask_avg: mc_mean=0.2252 mb_mean=0.5023 norm_overlap=0.9978 corr_cb=-0.1213
[EPOCH 030/089] train: loss=1.0471 acc=76.64% | val: loss=0.5874 acc=74.70% f1=73.42% auc=79.48% val_score=60.6383 val_score_bestthr=72.0379 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.225, mb=0.502, no=0.998, corr=-0.121) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.6051 -> 72.0379
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2937 mb_mean=0.5032 norm_overlap=0.9983 corr_cb=-0.1203 topkJ=0.0396
[TRAIN][ep=031] loss=1.0468 acc=77.72%
[TRAIN][ep=031] mask_avg: mc_mean=0.2273 mb_mean=0.5023 norm_overlap=0.9974 corr_cb=-0.1397
[EPOCH 031/089] train: loss=1.0468 acc=77.72% | val: loss=0.5693 acc=73.49% f1=72.50% auc=78.31% val_score=62.8147 val_score_bestthr=68.2341 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.227, mb=0.502, no=0.997, corr=-0.140) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.6051 -> 68.2341
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2123 mb_mean=0.5001 norm_overlap=0.9951 corr_cb=-0.2388 topkJ=0.0360
[TRAIN][ep=032] loss=0.8551 acc=78.39%
[TRAIN][ep=032] mask_avg: mc_mean=0.2195 mb_mean=0.5023 norm_overlap=0.9972 corr_cb=-0.1429
[EPOCH 032/089] train: loss=0.8551 acc=78.39% | val: loss=0.5588 acc=68.67% f1=75.93% auc=79.01% val_score=52.5151 val_score_bestthr=68.2387 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.219, mb=0.502, no=0.997, corr=-0.143) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.6051 -> 68.2387
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1944 mb_mean=0.5007 norm_overlap=0.9989 corr_cb=-0.0673 topkJ=0.0686
[TRAIN][ep=033] loss=0.6411 acc=78.93%
[TRAIN][ep=033] mask_avg: mc_mean=0.2154 mb_mean=0.5023 norm_overlap=0.9973 corr_cb=-0.1331
[EPOCH 033/089] train: loss=0.6411 acc=78.93% | val: loss=0.5540 acc=68.67% f1=75.93% auc=79.19% val_score=58.2819 val_score_bestthr=68.2387 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.215, mb=0.502, no=0.997, corr=-0.133) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.6051 -> 68.2387
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2728 mb_mean=0.5049 norm_overlap=0.9960 corr_cb=-0.2260 topkJ=0.0244
[TRAIN][ep=034] loss=0.6104 acc=78.79%
[TRAIN][ep=034] mask_avg: mc_mean=0.2370 mb_mean=0.5023 norm_overlap=0.9973 corr_cb=-0.1409
[EPOCH 034/089] train: loss=0.6104 acc=78.79% | val: loss=0.6043 acc=69.88% f1=75.25% auc=79.30% val_score=68.0929 val_score_bestthr=69.0388 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.237, mb=0.502, no=0.997, corr=-0.141) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.6051 -> 69.0388
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.3024 mb_mean=0.5025 norm_overlap=0.9952 corr_cb=-0.2205 topkJ=0.0244
[TRAIN][ep=035] loss=0.5843 acc=80.40%
[TRAIN][ep=035] mask_avg: mc_mean=0.2639 mb_mean=0.5023 norm_overlap=0.9971 corr_cb=-0.1647
[EPOCH 035/089] train: loss=0.5843 acc=80.40% | val: loss=0.5712 acc=68.67% f1=74.00% auc=78.20% val_score=64.7677 val_score_bestthr=67.0695 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.264, mb=0.502, no=0.997, corr=-0.165) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.6051 -> 67.0695
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2082 mb_mean=0.5025 norm_overlap=0.9974 corr_cb=-0.1163 topkJ=0.0590
[TRAIN][ep=036] loss=0.5875 acc=80.40%
[TRAIN][ep=036] mask_avg: mc_mean=0.2307 mb_mean=0.5023 norm_overlap=0.9974 corr_cb=-0.1314
[EPOCH 036/089] train: loss=0.5875 acc=80.40% | val: loss=0.5711 acc=68.67% f1=75.93% auc=78.20% val_score=64.5926 val_score_bestthr=68.2387 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.231, mb=0.502, no=0.997, corr=-0.131) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.6051 -> 68.2387
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1694 mb_mean=0.5040 norm_overlap=0.9960 corr_cb=-0.1822 topkJ=0.0304
[TRAIN][ep=037] loss=0.5746 acc=80.27%
[TRAIN][ep=037] mask_avg: mc_mean=0.2313 mb_mean=0.5023 norm_overlap=0.9974 corr_cb=-0.1328
[EPOCH 037/089] train: loss=0.5746 acc=80.27% | val: loss=0.5659 acc=71.08% f1=76.00% auc=79.30% val_score=54.8619 val_score_bestthr=71.3709 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.231, mb=0.502, no=0.997, corr=-0.133) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.6051 -> 71.3709
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2684 mb_mean=0.5023 norm_overlap=0.9932 corr_cb=-0.3385 topkJ=0.0107
[TRAIN][ep=038] loss=0.5576 acc=80.81%
[TRAIN][ep=038] mask_avg: mc_mean=0.2508 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1558
[EPOCH 038/089] train: loss=0.5576 acc=80.81% | val: loss=0.5791 acc=68.67% f1=75.00% auc=78.02% val_score=61.0733 val_score_bestthr=69.3491 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.251, mb=0.502, no=0.997, corr=-0.156) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.6051 -> 69.3491
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2708 mb_mean=0.5023 norm_overlap=0.9951 corr_cb=-0.2661 topkJ=0.0278
[TRAIN][ep=039] loss=0.5583 acc=82.15%
[TRAIN][ep=039] mask_avg: mc_mean=0.2484 mb_mean=0.5023 norm_overlap=0.9973 corr_cb=-0.1433
[EPOCH 039/089] train: loss=0.5583 acc=82.15% | val: loss=0.6005 acc=68.67% f1=75.93% auc=76.51% val_score=60.8409 val_score_bestthr=68.2387 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.248, mb=0.502, no=0.997, corr=-0.143) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.6051 -> 68.2387
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.1820 mb_mean=0.5019 norm_overlap=0.9970 corr_cb=-0.1257 topkJ=0.0415
[TRAIN][ep=040] loss=0.5554 acc=81.48%
[TRAIN][ep=040] mask_avg: mc_mean=0.2292 mb_mean=0.5023 norm_overlap=0.9971 corr_cb=-0.1413
[EPOCH 040/089] train: loss=0.5554 acc=81.48% | val: loss=0.5923 acc=69.88% f1=75.25% auc=78.37% val_score=55.9609 val_score_bestthr=69.0388 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.229, mb=0.502, no=0.997, corr=-0.141) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.6051 -> 69.0388
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.2564 mb_mean=0.5002 norm_overlap=0.9979 corr_cb=-0.1231 topkJ=0.0260
[TRAIN][ep=041] loss=0.5435 acc=81.74%
[TRAIN][ep=041] mask_avg: mc_mean=0.2514 mb_mean=0.5023 norm_overlap=0.9973 corr_cb=-0.1406
[EPOCH 041/089] train: loss=0.5435 acc=81.74% | val: loss=0.5977 acc=68.67% f1=76.36% auc=77.33% val_score=54.9733 val_score_bestthr=71.8036 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.251, mb=0.502, no=0.997, corr=-0.141) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.6051 -> 71.8036
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.1798 mb_mean=0.5021 norm_overlap=0.9980 corr_cb=-0.0912 topkJ=0.0241
[TRAIN][ep=042] loss=0.5432 acc=82.15%
[TRAIN][ep=042] mask_avg: mc_mean=0.2308 mb_mean=0.5023 norm_overlap=0.9973 corr_cb=-0.1324
[EPOCH 042/089] train: loss=0.5432 acc=82.15% | val: loss=0.5935 acc=67.47% f1=75.68% auc=77.67% val_score=56.9125 val_score_bestthr=70.6985 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.231, mb=0.502, no=0.997, corr=-0.132) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.6051 -> 70.6985
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.3290 mb_mean=0.5025 norm_overlap=0.9954 corr_cb=-0.2490 topkJ=0.0212
[TRAIN][ep=043] loss=0.5451 acc=82.82%
[TRAIN][ep=043] mask_avg: mc_mean=0.2501 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1537
[EPOCH 043/089] train: loss=0.5451 acc=82.82% | val: loss=0.6284 acc=67.47% f1=75.68% auc=75.87% val_score=56.0901 val_score_bestthr=71.0318 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.250, mb=0.502, no=0.997, corr=-0.154) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.6051 -> 71.0318
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2583 mb_mean=0.5062 norm_overlap=1.0008 corr_cb=0.0402 topkJ=0.0628
[TRAIN][ep=044] loss=0.5212 acc=83.36%
[TRAIN][ep=044] mask_avg: mc_mean=0.2511 mb_mean=0.5023 norm_overlap=0.9971 corr_cb=-0.1493
[EPOCH 044/089] train: loss=0.5212 acc=83.36% | val: loss=0.6299 acc=68.67% f1=75.93% auc=77.09% val_score=61.7270 val_score_bestthr=71.1606 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.251, mb=0.502, no=0.997, corr=-0.149) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.6051 -> 71.1606
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2999 mb_mean=0.5009 norm_overlap=0.9984 corr_cb=-0.0700 topkJ=0.0730
[TRAIN][ep=045] loss=0.5283 acc=84.16%
[TRAIN][ep=045] mask_avg: mc_mean=0.2581 mb_mean=0.5023 norm_overlap=0.9971 corr_cb=-0.1500
[EPOCH 045/089] train: loss=0.5283 acc=84.16% | val: loss=0.6895 acc=72.29% f1=77.23% auc=75.41% val_score=64.2011 val_score_bestthr=72.1419 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.258, mb=0.502, no=0.997, corr=-0.150) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.6051 -> 72.1419
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.1916 mb_mean=0.5026 norm_overlap=0.9992 corr_cb=-0.0285 topkJ=0.0771
[TRAIN][ep=046] loss=0.5238 acc=83.49%
[TRAIN][ep=046] mask_avg: mc_mean=0.2164 mb_mean=0.5023 norm_overlap=0.9973 corr_cb=-0.1258
[EPOCH 046/089] train: loss=0.5238 acc=83.49% | val: loss=0.6462 acc=69.88% f1=76.64% auc=76.10% val_score=57.2742 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.216, mb=0.502, no=0.997, corr=-0.126) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.6051 -> 72.2690
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.2779 mb_mean=0.5033 norm_overlap=0.9966 corr_cb=-0.2025 topkJ=0.0154
[TRAIN][ep=047] loss=0.5226 acc=83.62%
[TRAIN][ep=047] mask_avg: mc_mean=0.2618 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1565
[EPOCH 047/089] train: loss=0.5226 acc=83.62% | val: loss=0.6643 acc=69.88% f1=75.25% auc=75.17% val_score=56.5112 val_score_bestthr=69.2199 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.262, mb=0.502, no=0.997, corr=-0.156) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.6051 -> 69.2199
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.2758 mb_mean=0.5001 norm_overlap=0.9960 corr_cb=-0.2120 topkJ=0.0238
[TRAIN][ep=048] loss=0.4924 acc=85.23%
[TRAIN][ep=048] mask_avg: mc_mean=0.2455 mb_mean=0.5023 norm_overlap=0.9971 corr_cb=-0.1431
[EPOCH 048/089] train: loss=0.4924 acc=85.23% | val: loss=0.7597 acc=68.67% f1=75.93% auc=75.52% val_score=69.0388 val_score_bestthr=71.1606 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.245, mb=0.502, no=0.997, corr=-0.143) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.6051 -> 71.1606
[DBG][ep=049] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.2452 mb_mean=0.4996 norm_overlap=0.9936 corr_cb=-0.3119 topkJ=0.0210
[TRAIN][ep=049] loss=0.5693 acc=80.00%
[TRAIN][ep=049] mask_avg: mc_mean=0.2298 mb_mean=0.5023 norm_overlap=0.9968 corr_cb=-0.1513
[EPOCH 049/089] train: loss=0.5693 acc=80.00% | val: loss=0.7090 acc=71.08% f1=76.47% auc=75.12% val_score=68.2724 val_score_bestthr=72.7764 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.230, mb=0.502, no=0.997, corr=-0.151) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 72.6051 -> 72.7764
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=050] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.2425 mb_mean=0.5034 norm_overlap=0.9943 corr_cb=-0.2676 topkJ=0.0102
[TRAIN][ep=050] loss=0.4901 acc=86.71%
[TRAIN][ep=050] mask_avg: mc_mean=0.2531 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1728
[EPOCH 050/089] train: loss=0.4901 acc=86.71% | val: loss=0.6513 acc=71.08% f1=76.47% auc=74.71% val_score=57.2778 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.253, mb=0.502, no=0.997, corr=-0.173) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7764 -> 72.7764
[DBG][ep=051] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.2048 mb_mean=0.5047 norm_overlap=1.0003 corr_cb=0.0155 topkJ=0.0687
[TRAIN][ep=051] loss=0.4781 acc=87.25%
[TRAIN][ep=051] mask_avg: mc_mean=0.2530 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1683
[EPOCH 051/089] train: loss=0.4781 acc=87.25% | val: loss=0.6511 acc=71.08% f1=76.47% auc=75.41% val_score=57.2778 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.253, mb=0.502, no=0.997, corr=-0.168) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7764 -> 72.7764
[DBG][ep=052] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.2508 mb_mean=0.5020 norm_overlap=0.9957 corr_cb=-0.2195 topkJ=0.0374
[TRAIN][ep=052] loss=0.4701 acc=88.46%
[TRAIN][ep=052] mask_avg: mc_mean=0.2530 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1710
[EPOCH 052/089] train: loss=0.4701 acc=88.46% | val: loss=0.6535 acc=71.08% f1=76.47% auc=75.47% val_score=57.2778 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.253, mb=0.502, no=0.997, corr=-0.171) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7764 -> 72.7764
[DBG][ep=053] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.2692 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1864 topkJ=0.0277
[TRAIN][ep=053] loss=0.4724 acc=88.19%
[TRAIN][ep=053] mask_avg: mc_mean=0.2530 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1718
[EPOCH 053/089] train: loss=0.4724 acc=88.19% | val: loss=0.6553 acc=71.08% f1=76.47% auc=75.47% val_score=56.4777 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.253, mb=0.502, no=0.997, corr=-0.172) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7764 -> 72.7764
[DBG][ep=054] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=054] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=054] mask(step0): mc_mean=0.2619 mb_mean=0.5013 norm_overlap=0.9964 corr_cb=-0.1684 topkJ=0.0289
[TRAIN][ep=054] loss=0.4655 acc=87.25%
[TRAIN][ep=054] mask_avg: mc_mean=0.2530 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1765
[EPOCH 054/089] train: loss=0.4655 acc=87.25% | val: loss=0.6606 acc=71.08% f1=76.47% auc=75.17% val_score=56.4777 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.253, mb=0.502, no=0.996, corr=-0.177) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7764 -> 72.7764
[DBG][ep=055] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=055] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=055] mask(step0): mc_mean=0.2596 mb_mean=0.5029 norm_overlap=0.9937 corr_cb=-0.3138 topkJ=0.0109
[TRAIN][ep=055] loss=0.4637 acc=88.59%
[TRAIN][ep=055] mask_avg: mc_mean=0.2531 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1722
[EPOCH 055/089] train: loss=0.4637 acc=88.59% | val: loss=0.6644 acc=71.08% f1=76.47% auc=75.29% val_score=56.4777 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.253, mb=0.502, no=0.997, corr=-0.172) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7764 -> 72.7764
[DBG][ep=056] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=056] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=056] mask(step0): mc_mean=0.2209 mb_mean=0.5009 norm_overlap=0.9963 corr_cb=-0.2127 topkJ=0.0350
[TRAIN][ep=056] loss=0.4625 acc=87.79%
[TRAIN][ep=056] mask_avg: mc_mean=0.2532 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1730
[EPOCH 056/089] train: loss=0.4625 acc=87.79% | val: loss=0.6707 acc=71.08% f1=76.47% auc=75.23% val_score=56.5112 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.253, mb=0.502, no=0.997, corr=-0.173) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7764 -> 72.7764
[DBG][ep=057] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=057] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=057] mask(step0): mc_mean=0.2695 mb_mean=0.5026 norm_overlap=0.9967 corr_cb=-0.1843 topkJ=0.0305
[TRAIN][ep=057] loss=0.4601 acc=87.92%
[TRAIN][ep=057] mask_avg: mc_mean=0.2530 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1700
[EPOCH 057/089] train: loss=0.4601 acc=87.92% | val: loss=0.6755 acc=71.08% f1=76.47% auc=75.29% val_score=50.8352 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.253, mb=0.502, no=0.997, corr=-0.170) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7764 -> 72.7764
[DBG][ep=058] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=058] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=058] mask(step0): mc_mean=0.2089 mb_mean=0.5051 norm_overlap=0.9969 corr_cb=-0.1833 topkJ=0.0341
[TRAIN][ep=058] loss=0.4593 acc=87.92%
[TRAIN][ep=058] mask_avg: mc_mean=0.2530 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1683
[EPOCH 058/089] train: loss=0.4593 acc=87.92% | val: loss=0.6732 acc=71.08% f1=76.47% auc=75.29% val_score=56.4777 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.253, mb=0.502, no=0.997, corr=-0.168) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7764 -> 72.7764
[DBG][ep=059] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=059] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=059] mask(step0): mc_mean=0.2803 mb_mean=0.4997 norm_overlap=0.9958 corr_cb=-0.2221 topkJ=0.0433
[TRAIN][ep=059] loss=0.4556 acc=88.32%
[TRAIN][ep=059] mask_avg: mc_mean=0.2531 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1705
[EPOCH 059/089] train: loss=0.4556 acc=88.32% | val: loss=0.6802 acc=71.08% f1=76.47% auc=75.23% val_score=60.3488 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.253, mb=0.502, no=0.997, corr=-0.171) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7764 -> 72.7764
[DBG][ep=060] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=060] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=060] mask(step0): mc_mean=0.2770 mb_mean=0.4999 norm_overlap=0.9957 corr_cb=-0.2434 topkJ=0.0183
[TRAIN][ep=060] loss=0.4575 acc=88.86%
[TRAIN][ep=060] mask_avg: mc_mean=0.2530 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1705
[EPOCH 060/089] train: loss=0.4575 acc=88.86% | val: loss=0.6798 acc=71.08% f1=76.47% auc=75.23% val_score=56.5112 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.253, mb=0.502, no=0.997, corr=-0.171) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7764 -> 72.7764
[DBG][ep=061] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=061] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=061] mask(step0): mc_mean=0.2823 mb_mean=0.5016 norm_overlap=0.9893 corr_cb=-0.4338 topkJ=0.0071
[TRAIN][ep=061] loss=0.4544 acc=88.32%
[TRAIN][ep=061] mask_avg: mc_mean=0.2530 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1701
[EPOCH 061/089] train: loss=0.4544 acc=88.32% | val: loss=0.6858 acc=71.08% f1=76.47% auc=75.12% val_score=56.4777 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.253, mb=0.502, no=0.997, corr=-0.170) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7764 -> 72.7764
[DBG][ep=062] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=062] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=062] mask(step0): mc_mean=0.2726 mb_mean=0.5002 norm_overlap=0.9964 corr_cb=-0.2082 topkJ=0.0266
[TRAIN][ep=062] loss=0.4550 acc=87.92%
[TRAIN][ep=062] mask_avg: mc_mean=0.2530 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1704
[EPOCH 062/089] train: loss=0.4550 acc=87.92% | val: loss=0.6860 acc=71.08% f1=76.47% auc=75.35% val_score=61.7074 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.253, mb=0.502, no=0.997, corr=-0.170) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7764 -> 72.7764
[DBG][ep=063] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=063] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=063] mask(step0): mc_mean=0.2432 mb_mean=0.5036 norm_overlap=0.9963 corr_cb=-0.1724 topkJ=0.0203
[TRAIN][ep=063] loss=0.4635 acc=87.38%
[TRAIN][ep=063] mask_avg: mc_mean=0.2530 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1765
[EPOCH 063/089] train: loss=0.4635 acc=87.38% | val: loss=0.6902 acc=69.88% f1=76.64% auc=74.59% val_score=56.4777 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.253, mb=0.502, no=0.996, corr=-0.176) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7764 -> 72.2690
[DBG][ep=064] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=064] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=064] mask(step0): mc_mean=0.2540 mb_mean=0.5016 norm_overlap=0.9954 corr_cb=-0.2049 topkJ=0.0353
[TRAIN][ep=064] loss=0.4491 acc=88.46%
[TRAIN][ep=064] mask_avg: mc_mean=0.2530 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1736
[EPOCH 064/089] train: loss=0.4491 acc=88.46% | val: loss=0.6940 acc=69.88% f1=76.64% auc=74.88% val_score=56.4777 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.253, mb=0.502, no=0.997, corr=-0.174) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7764 -> 72.2690
[DBG][ep=065] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=065] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=065] mask(step0): mc_mean=0.2057 mb_mean=0.5027 norm_overlap=0.9956 corr_cb=-0.2217 topkJ=0.0267
[TRAIN][ep=065] loss=0.4514 acc=88.46%
[TRAIN][ep=065] mask_avg: mc_mean=0.2530 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1700
[EPOCH 065/089] train: loss=0.4514 acc=88.46% | val: loss=0.6936 acc=69.88% f1=76.64% auc=74.94% val_score=56.4777 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.253, mb=0.502, no=0.997, corr=-0.170) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7764 -> 72.2690
[DBG][ep=066] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=066] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=066] mask(step0): mc_mean=0.2231 mb_mean=0.5044 norm_overlap=0.9963 corr_cb=-0.2083 topkJ=0.0308
[TRAIN][ep=066] loss=0.4483 acc=88.32%
[TRAIN][ep=066] mask_avg: mc_mean=0.2531 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1688
[EPOCH 066/089] train: loss=0.4483 acc=88.32% | val: loss=0.7098 acc=71.08% f1=77.36% auc=75.35% val_score=60.0219 val_score_bestthr=73.8323 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.253, mb=0.502, no=0.997, corr=-0.169) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 72.7764 -> 73.8323
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=067] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=067] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=067] mask(step0): mc_mean=0.2532 mb_mean=0.4998 norm_overlap=0.9983 corr_cb=-0.0755 topkJ=0.0458
[TRAIN][ep=067] loss=0.4476 acc=88.72%
[TRAIN][ep=067] mask_avg: mc_mean=0.2530 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1684
[EPOCH 067/089] train: loss=0.4476 acc=88.72% | val: loss=0.7049 acc=69.88% f1=76.64% auc=75.06% val_score=54.1474 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.253, mb=0.502, no=0.997, corr=-0.168) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.8323 -> 72.2690
[DBG][ep=068] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=068] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=068] mask(step0): mc_mean=0.2429 mb_mean=0.5046 norm_overlap=0.9936 corr_cb=-0.3124 topkJ=0.0292
[TRAIN][ep=068] loss=0.4442 acc=87.92%
[TRAIN][ep=068] mask_avg: mc_mean=0.2531 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1721
[EPOCH 068/089] train: loss=0.4442 acc=87.92% | val: loss=0.7074 acc=71.08% f1=76.47% auc=75.00% val_score=61.7074 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.253, mb=0.502, no=0.997, corr=-0.172) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.8323 -> 72.7764
[DBG][ep=069] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=069] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=069] mask(step0): mc_mean=0.2825 mb_mean=0.5008 norm_overlap=0.9984 corr_cb=-0.0834 topkJ=0.0416
[TRAIN][ep=069] loss=0.4426 acc=87.92%
[TRAIN][ep=069] mask_avg: mc_mean=0.2530 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1688
[EPOCH 069/089] train: loss=0.4426 acc=87.92% | val: loss=0.7157 acc=69.88% f1=75.73% auc=75.00% val_score=54.1474 val_score_bestthr=71.6631 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.253, mb=0.502, no=0.997, corr=-0.169) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.8323 -> 71.6631
[DBG][ep=070] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=070] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=070] mask(step0): mc_mean=0.2434 mb_mean=0.5018 norm_overlap=0.9977 corr_cb=-0.1062 topkJ=0.0633
[TRAIN][ep=070] loss=0.4418 acc=88.72%
[TRAIN][ep=070] mask_avg: mc_mean=0.2530 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1696
[EPOCH 070/089] train: loss=0.4418 acc=88.72% | val: loss=0.7242 acc=71.08% f1=77.36% auc=75.12% val_score=64.5698 val_score_bestthr=73.8323 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.253, mb=0.502, no=0.997, corr=-0.170) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.8323 -> 73.8323
[DBG][ep=071] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=071] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=071] mask(step0): mc_mean=0.2469 mb_mean=0.5030 norm_overlap=0.9943 corr_cb=-0.2969 topkJ=0.0136
[TRAIN][ep=071] loss=0.4430 acc=88.99%
[TRAIN][ep=071] mask_avg: mc_mean=0.2530 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1699
[EPOCH 071/089] train: loss=0.4430 acc=88.99% | val: loss=0.7122 acc=69.88% f1=76.64% auc=75.17% val_score=55.0584 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.253, mb=0.502, no=0.997, corr=-0.170) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.8323 -> 72.2690
[DBG][ep=072] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=072] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=072] mask(step0): mc_mean=0.2644 mb_mean=0.5026 norm_overlap=0.9966 corr_cb=-0.1848 topkJ=0.0203
[TRAIN][ep=072] loss=0.4438 acc=87.92%
[TRAIN][ep=072] mask_avg: mc_mean=0.2530 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1697
[EPOCH 072/089] train: loss=0.4438 acc=87.92% | val: loss=0.7116 acc=69.88% f1=76.64% auc=74.83% val_score=56.4777 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.253, mb=0.502, no=0.997, corr=-0.170) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.8323 -> 72.2690
[DBG][ep=073] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=073] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=073] mask(step0): mc_mean=0.2301 mb_mean=0.5011 norm_overlap=0.9989 corr_cb=-0.0668 topkJ=0.0710
[TRAIN][ep=073] loss=0.4412 acc=88.19%
[TRAIN][ep=073] mask_avg: mc_mean=0.2531 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1716
[EPOCH 073/089] train: loss=0.4412 acc=88.19% | val: loss=0.7237 acc=69.88% f1=76.64% auc=74.88% val_score=54.1474 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.253, mb=0.502, no=0.997, corr=-0.172) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.8323 -> 72.2690
[DBG][ep=074] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=074] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=074] mask(step0): mc_mean=0.2283 mb_mean=0.5028 norm_overlap=0.9961 corr_cb=-0.1998 topkJ=0.0218
[TRAIN][ep=074] loss=0.4420 acc=88.05%
[TRAIN][ep=074] mask_avg: mc_mean=0.2532 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1729
[EPOCH 074/089] train: loss=0.4420 acc=88.05% | val: loss=0.7178 acc=69.88% f1=76.64% auc=75.12% val_score=56.5112 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.253, mb=0.502, no=0.997, corr=-0.173) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.8323 -> 72.2690
[DBG][ep=075] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=075] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=075] mask(step0): mc_mean=0.3081 mb_mean=0.5013 norm_overlap=0.9931 corr_cb=-0.3493 topkJ=0.0064
[TRAIN][ep=075] loss=0.4435 acc=88.32%
[TRAIN][ep=075] mask_avg: mc_mean=0.2530 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1690
[EPOCH 075/089] train: loss=0.4435 acc=88.32% | val: loss=0.7186 acc=69.88% f1=76.64% auc=74.94% val_score=61.7074 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.253, mb=0.502, no=0.997, corr=-0.169) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.8323 -> 72.2690
[DBG][ep=076] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=076] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=076] mask(step0): mc_mean=0.2084 mb_mean=0.5030 norm_overlap=0.9994 corr_cb=-0.0274 topkJ=0.0616
[TRAIN][ep=076] loss=0.4417 acc=88.19%
[TRAIN][ep=076] mask_avg: mc_mean=0.2530 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1701
[EPOCH 076/089] train: loss=0.4417 acc=88.19% | val: loss=0.7198 acc=71.08% f1=77.36% auc=75.06% val_score=61.7074 val_score_bestthr=73.8323 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.253, mb=0.502, no=0.997, corr=-0.170) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.8323 -> 73.8323
[DBG][ep=077] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=077] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=077] mask(step0): mc_mean=0.2271 mb_mean=0.5034 norm_overlap=0.9945 corr_cb=-0.2859 topkJ=0.0169
[TRAIN][ep=077] loss=0.4389 acc=88.32%
[TRAIN][ep=077] mask_avg: mc_mean=0.2530 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1706
[EPOCH 077/089] train: loss=0.4389 acc=88.32% | val: loss=0.7296 acc=69.88% f1=76.64% auc=75.00% val_score=53.0278 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.253, mb=0.502, no=0.997, corr=-0.171) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.8323 -> 72.2690
[DBG][ep=078] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=078] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=078] mask(step0): mc_mean=0.2454 mb_mean=0.5031 norm_overlap=0.9976 corr_cb=-0.0951 topkJ=0.0399
[TRAIN][ep=078] loss=0.4352 acc=88.32%
[TRAIN][ep=078] mask_avg: mc_mean=0.2530 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1732
[EPOCH 078/089] train: loss=0.4352 acc=88.32% | val: loss=0.7297 acc=69.88% f1=76.64% auc=74.88% val_score=61.0754 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.253, mb=0.502, no=0.997, corr=-0.173) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.8323 -> 72.2690
[DBG][ep=079] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=079] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=079] mask(step0): mc_mean=0.2684 mb_mean=0.4999 norm_overlap=0.9965 corr_cb=-0.1886 topkJ=0.0459
[TRAIN][ep=079] loss=0.4321 acc=88.72%
[TRAIN][ep=079] mask_avg: mc_mean=0.2531 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1699
[EPOCH 079/089] train: loss=0.4321 acc=88.72% | val: loss=0.7468 acc=71.08% f1=77.36% auc=74.77% val_score=64.5698 val_score_bestthr=73.8323 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.253, mb=0.502, no=0.997, corr=-0.170) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.8323 -> 73.8323
[DBG][ep=080] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=080] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=080] mask(step0): mc_mean=0.2137 mb_mean=0.5059 norm_overlap=0.9986 corr_cb=-0.0753 topkJ=0.0506
[TRAIN][ep=080] loss=0.4300 acc=88.99%
[TRAIN][ep=080] mask_avg: mc_mean=0.2531 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1680
[EPOCH 080/089] train: loss=0.4300 acc=88.99% | val: loss=0.7389 acc=69.88% f1=75.73% auc=74.88% val_score=61.0754 val_score_bestthr=71.6631 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.253, mb=0.502, no=0.997, corr=-0.168) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.8323 -> 71.6631
[DBG][ep=081] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=081] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=081] mask(step0): mc_mean=0.2979 mb_mean=0.5021 norm_overlap=0.9952 corr_cb=-0.2635 topkJ=0.0123
[TRAIN][ep=081] loss=0.4275 acc=88.72%
[TRAIN][ep=081] mask_avg: mc_mean=0.2531 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1721
[EPOCH 081/089] train: loss=0.4275 acc=88.72% | val: loss=0.7454 acc=69.88% f1=76.64% auc=74.83% val_score=59.3745 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.253, mb=0.502, no=0.997, corr=-0.172) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.8323 -> 72.2690
[DBG][ep=082] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=082] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=082] mask(step0): mc_mean=0.2530 mb_mean=0.5024 norm_overlap=0.9967 corr_cb=-0.1573 topkJ=0.0466
[TRAIN][ep=082] loss=0.4279 acc=88.59%
[TRAIN][ep=082] mask_avg: mc_mean=0.2530 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1707
[EPOCH 082/089] train: loss=0.4279 acc=88.59% | val: loss=0.7492 acc=69.88% f1=75.73% auc=75.06% val_score=54.1474 val_score_bestthr=71.6631 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.253, mb=0.502, no=0.997, corr=-0.171) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.8323 -> 71.6631
[DBG][ep=083] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=083] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=083] mask(step0): mc_mean=0.2345 mb_mean=0.5025 norm_overlap=0.9977 corr_cb=-0.1260 topkJ=0.0468
[TRAIN][ep=083] loss=0.4345 acc=88.46%
[TRAIN][ep=083] mask_avg: mc_mean=0.2531 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1709
[EPOCH 083/089] train: loss=0.4345 acc=88.46% | val: loss=0.7424 acc=69.88% f1=76.64% auc=75.00% val_score=61.7074 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.253, mb=0.502, no=0.997, corr=-0.171) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.8323 -> 72.2690
[DBG][ep=084] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=084] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=084] mask(step0): mc_mean=0.2450 mb_mean=0.5033 norm_overlap=0.9957 corr_cb=-0.1785 topkJ=0.0272
[TRAIN][ep=084] loss=0.4245 acc=88.86%
[TRAIN][ep=084] mask_avg: mc_mean=0.2530 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1702
[EPOCH 084/089] train: loss=0.4245 acc=88.86% | val: loss=0.7633 acc=71.08% f1=77.36% auc=74.77% val_score=64.5698 val_score_bestthr=73.8323 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.253, mb=0.502, no=0.997, corr=-0.170) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.8323 -> 73.8323
[DBG][ep=085] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=085] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=085] mask(step0): mc_mean=0.2243 mb_mean=0.5032 norm_overlap=0.9974 corr_cb=-0.1351 topkJ=0.0380
[TRAIN][ep=085] loss=0.4266 acc=89.13%
[TRAIN][ep=085] mask_avg: mc_mean=0.2530 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1721
[EPOCH 085/089] train: loss=0.4266 acc=89.13% | val: loss=0.7489 acc=69.88% f1=76.64% auc=74.83% val_score=61.7074 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.253, mb=0.502, no=0.997, corr=-0.172) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.8323 -> 72.2690
[DBG][ep=086] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=086] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=086] mask(step0): mc_mean=0.2731 mb_mean=0.5017 norm_overlap=0.9988 corr_cb=-0.0641 topkJ=0.0595
[TRAIN][ep=086] loss=0.4216 acc=89.13%
[TRAIN][ep=086] mask_avg: mc_mean=0.2531 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1705
[EPOCH 086/089] train: loss=0.4216 acc=89.13% | val: loss=0.7502 acc=69.88% f1=76.64% auc=74.94% val_score=61.7074 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.253, mb=0.502, no=0.997, corr=-0.171) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.8323 -> 72.2690
[DBG][ep=087] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=087] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=087] mask(step0): mc_mean=0.2399 mb_mean=0.5030 norm_overlap=0.9962 corr_cb=-0.1864 topkJ=0.0333
[TRAIN][ep=087] loss=0.4208 acc=89.53%
[TRAIN][ep=087] mask_avg: mc_mean=0.2530 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1718
[EPOCH 087/089] train: loss=0.4208 acc=89.53% | val: loss=0.7580 acc=69.88% f1=76.64% auc=74.83% val_score=61.7074 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.253, mb=0.502, no=0.997, corr=-0.172) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.8323 -> 72.2690
[DBG][ep=088] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=088] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=088] mask(step0): mc_mean=0.2458 mb_mean=0.5009 norm_overlap=0.9985 corr_cb=-0.0796 topkJ=0.0559
[TRAIN][ep=088] loss=0.4168 acc=89.80%
[TRAIN][ep=088] mask_avg: mc_mean=0.2530 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1725
[EPOCH 088/089] train: loss=0.4168 acc=89.80% | val: loss=0.7649 acc=69.88% f1=76.64% auc=74.77% val_score=59.3745 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.253, mb=0.502, no=0.997, corr=-0.172) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.8323 -> 72.2690
[DBG][ep=089] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=089] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=089] mask(step0): mc_mean=0.2249 mb_mean=0.5016 norm_overlap=0.9983 corr_cb=-0.0939 topkJ=0.0585
[TRAIN][ep=089] loss=0.4213 acc=88.59%
[TRAIN][ep=089] mask_avg: mc_mean=0.2530 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1723
[EPOCH 089/089] train: loss=0.4213 acc=88.59% | val: loss=0.7702 acc=69.88% f1=76.64% auc=74.30% val_score=59.3745 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.253, mb=0.502, no=0.997, corr=-0.172) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.8323 -> 72.2690
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
=============== FIT DONE ===============
[BEST] epoch=66 | val_acc=71.08% | val_f1=77.36% | val_auc=75.35% | val_score=60.0219 | val_score_bestthr=73.8323
[TEST@BEST] thr_used=0.300 | acc=63.77% f1=69.64% auc=63.15% | SP_sex=0.55% EO_sex=3.75% SP_age=14.16% EO_age=3.81%
[TIME] 2.10 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/summary_fold_0.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5259 mb_mean=0.5010 norm_overlap=0.9999 corr_cb=-0.0912 topkJ=0.0676
[TRAIN][ep=000] loss=0.6939 acc=50.47%
[TRAIN][ep=000] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0996
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5274 mb_mean=0.4997 norm_overlap=0.9999 corr_cb=-0.2567 topkJ=0.0254
[TRAIN][ep=001] loss=0.6920 acc=50.47%
[TRAIN][ep=001] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0926
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5297 mb_mean=0.5053 norm_overlap=1.0000 corr_cb=0.0154 topkJ=0.0969
[TRAIN][ep=002] loss=0.6899 acc=52.89%
[TRAIN][ep=002] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0983
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5296 mb_mean=0.5000 norm_overlap=0.9999 corr_cb=-0.1407 topkJ=0.0490
[TRAIN][ep=003] loss=0.6882 acc=54.23%
[TRAIN][ep=003] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0952
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5295 mb_mean=0.4987 norm_overlap=0.9999 corr_cb=-0.1840 topkJ=0.0339
[TRAIN][ep=004] loss=0.6887 acc=53.42%
[TRAIN][ep=004] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.1002
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5288 mb_mean=0.5009 norm_overlap=0.9999 corr_cb=-0.1690 topkJ=0.0368
[TRAIN][ep=005] loss=0.6834 acc=56.91%
[TRAIN][ep=005] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0988
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5323 mb_mean=0.5018 norm_overlap=0.9999 corr_cb=-0.2431 topkJ=0.0234
[TRAIN][ep=006] loss=0.6844 acc=54.63%
[TRAIN][ep=006] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0978
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5339 mb_mean=0.5021 norm_overlap=1.0000 corr_cb=-0.0185 topkJ=0.0321
[TRAIN][ep=007] loss=0.6826 acc=57.72%
[TRAIN][ep=007] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0955
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5308 mb_mean=0.5020 norm_overlap=1.0000 corr_cb=-0.0361 topkJ=0.0444
[TRAIN][ep=008] loss=0.6776 acc=58.12%
[TRAIN][ep=008] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0938
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5248 mb_mean=0.5048 norm_overlap=0.9999 corr_cb=-0.0945 topkJ=0.0690
[TRAIN][ep=009] loss=0.6759 acc=58.93%
[TRAIN][ep=009] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0965
================= FIT START (fold=0) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5327 mb_mean=0.5004 norm_overlap=1.0000 corr_cb=-0.0395 topkJ=0.0304
[TRAIN][ep=000] loss=0.6709 acc=61.48%
[TRAIN][ep=000] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0992
[EPOCH 000/089] train: loss=0.6709 acc=61.48% | val: loss=0.6685 acc=62.65% f1=69.31% auc=65.99% val_score=63.8688 val_score_bestthr=64.9727 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.099) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 64.9727
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5321 mb_mean=0.5010 norm_overlap=0.9998 corr_cb=-0.3401 topkJ=0.0082
[TRAIN][ep=001] loss=0.6667 acc=61.21%
[TRAIN][ep=001] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0976
[EPOCH 001/089] train: loss=0.6667 acc=61.21% | val: loss=0.6664 acc=61.45% f1=68.63% auc=65.58% val_score=50.8549 val_score_bestthr=63.8688 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.098) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9727 -> 63.8688
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5308 mb_mean=0.5031 norm_overlap=1.0000 corr_cb=-0.0851 topkJ=0.0316
[TRAIN][ep=002] loss=0.6609 acc=60.94%
[TRAIN][ep=002] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0965
[EPOCH 002/089] train: loss=0.6609 acc=60.94% | val: loss=0.6768 acc=56.63% f1=64.71% auc=64.07% val_score=48.1618 val_score_bestthr=58.9427 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.097) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9727 -> 58.9427
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5303 mb_mean=0.5028 norm_overlap=1.0000 corr_cb=0.0572 topkJ=0.0336
[TRAIN][ep=003] loss=0.6553 acc=64.43%
[TRAIN][ep=003] mask_avg: mc_mean=0.5293 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0987
[EPOCH 003/089] train: loss=0.6553 acc=64.43% | val: loss=0.6566 acc=62.65% f1=69.31% auc=66.69% val_score=50.8414 val_score_bestthr=64.9727 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.099) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9727 -> 64.9727
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5315 mb_mean=0.5048 norm_overlap=1.0000 corr_cb=-0.0454 topkJ=0.0668
[TRAIN][ep=004] loss=0.6486 acc=65.10%
[TRAIN][ep=004] mask_avg: mc_mean=0.5292 mb_mean=0.5023 norm_overlap=0.9999 corr_cb=-0.0985
[EPOCH 004/089] train: loss=0.6486 acc=65.10% | val: loss=0.6512 acc=62.65% f1=69.31% auc=67.73% val_score=56.4760 val_score_bestthr=64.9727 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.529, mb=0.502, no=1.000, corr=-0.099) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9727 -> 64.9727
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5300 mb_mean=0.5015 norm_overlap=0.9999 corr_cb=-0.2288 topkJ=0.0177
[TRAIN][ep=005] loss=1.3714 acc=64.83%
[TRAIN][ep=005] mask_avg: mc_mean=0.3782 mb_mean=0.5023 norm_overlap=1.0007 corr_cb=0.1900
[EPOCH 005/089] train: loss=1.3714 acc=64.83% | val: loss=0.6489 acc=61.45% f1=71.93% auc=71.16% val_score=51.2740 val_score_bestthr=62.4976 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.378, mb=0.502, no=1.001, corr=0.190) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9727 -> 62.4976
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2785 mb_mean=0.5013 norm_overlap=1.0021 corr_cb=0.3830 topkJ=0.1300
[TRAIN][ep=006] loss=1.1454 acc=65.50%
[TRAIN][ep=006] mask_avg: mc_mean=0.2531 mb_mean=0.5023 norm_overlap=1.0013 corr_cb=0.1865
[EPOCH 006/089] train: loss=1.1454 acc=65.50% | val: loss=0.6391 acc=62.65% f1=71.56% auc=71.51% val_score=61.3612 val_score_bestthr=64.3474 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.253, mb=0.502, no=1.001, corr=0.186) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.9727 -> 64.3474
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2300 mb_mean=0.5027 norm_overlap=1.0018 corr_cb=0.2130 topkJ=0.0725
[TRAIN][ep=007] loss=0.9474 acc=65.23%
[TRAIN][ep=007] mask_avg: mc_mean=0.2249 mb_mean=0.5023 norm_overlap=1.0012 corr_cb=0.1474
[EPOCH 007/089] train: loss=0.9474 acc=65.23% | val: loss=0.6322 acc=62.65% f1=72.57% auc=72.56% val_score=59.6608 val_score_bestthr=67.1797 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.040, stage2=False) | mask(mc=0.225, mb=0.502, no=1.001, corr=0.147) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 64.9727 -> 67.1797
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2211 mb_mean=0.5013 norm_overlap=1.0005 corr_cb=0.0619 topkJ=0.0706
[TRAIN][ep=008] loss=1.0123 acc=68.32%
[TRAIN][ep=008] mask_avg: mc_mean=0.2108 mb_mean=0.5023 norm_overlap=1.0010 corr_cb=0.1092
[EPOCH 008/089] train: loss=1.0123 acc=68.32% | val: loss=0.6493 acc=65.06% f1=70.10% auc=69.71% val_score=51.3291 val_score_bestthr=62.1649 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.080, stage2=False) | mask(mc=0.211, mb=0.502, no=1.001, corr=0.109) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.1797 -> 62.1649
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2079 mb_mean=0.5024 norm_overlap=1.0004 corr_cb=0.0342 topkJ=0.0723
[TRAIN][ep=009] loss=1.0930 acc=65.91%
[TRAIN][ep=009] mask_avg: mc_mean=0.1897 mb_mean=0.5023 norm_overlap=1.0009 corr_cb=0.0864
[EPOCH 009/089] train: loss=1.0930 acc=65.91% | val: loss=0.6428 acc=65.06% f1=73.39% auc=73.43% val_score=65.7793 val_score_bestthr=68.3138 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.120, stage2=False) | mask(mc=0.190, mb=0.502, no=1.001, corr=0.086) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 67.1797 -> 68.3138
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1950 mb_mean=0.5010 norm_overlap=1.0013 corr_cb=0.1437 topkJ=0.0749
[TRAIN][ep=010] loss=1.1621 acc=65.64%
[TRAIN][ep=010] mask_avg: mc_mean=0.1921 mb_mean=0.5023 norm_overlap=1.0006 corr_cb=0.0451
[EPOCH 010/089] train: loss=1.1621 acc=65.64% | val: loss=0.6228 acc=63.86% f1=73.68% auc=73.43% val_score=58.4938 val_score_bestthr=66.8001 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.160, stage2=False) | mask(mc=0.192, mb=0.502, no=1.001, corr=0.045) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.3138 -> 66.8001
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1881 mb_mean=0.5027 norm_overlap=0.9979 corr_cb=-0.2005 topkJ=0.0556
[TRAIN][ep=011] loss=1.2144 acc=70.34%
[TRAIN][ep=011] mask_avg: mc_mean=0.1856 mb_mean=0.5023 norm_overlap=1.0002 corr_cb=0.0144
[EPOCH 011/089] train: loss=1.2144 acc=70.34% | val: loss=0.6126 acc=63.86% f1=72.73% auc=75.93% val_score=61.5955 val_score_bestthr=67.2118 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.186, mb=0.502, no=1.000, corr=0.014) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.3138 -> 67.2118
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1777 mb_mean=0.5005 norm_overlap=1.0001 corr_cb=0.0053 topkJ=0.1136
[TRAIN][ep=012] loss=1.2928 acc=69.13%
[TRAIN][ep=012] mask_avg: mc_mean=0.1807 mb_mean=0.5023 norm_overlap=0.9998 corr_cb=-0.0156
[EPOCH 012/089] train: loss=1.2928 acc=69.13% | val: loss=0.6701 acc=65.06% f1=70.10% auc=71.51% val_score=50.4880 val_score_bestthr=60.4149 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.181, mb=0.502, no=1.000, corr=-0.016) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.3138 -> 60.4149
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1929 mb_mean=0.5050 norm_overlap=0.9989 corr_cb=-0.0906 topkJ=0.0731
[TRAIN][ep=013] loss=1.2873 acc=69.40%
[TRAIN][ep=013] mask_avg: mc_mean=0.1700 mb_mean=0.5023 norm_overlap=0.9996 corr_cb=-0.0335
[EPOCH 013/089] train: loss=1.2873 acc=69.40% | val: loss=0.6204 acc=71.08% f1=70.00% auc=75.12% val_score=51.6655 val_score_bestthr=64.6065 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.170, mb=0.502, no=1.000, corr=-0.033) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 68.3138 -> 64.6065
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1598 mb_mean=0.4973 norm_overlap=1.0000 corr_cb=0.0018 topkJ=0.0575
[TRAIN][ep=014] loss=1.2732 acc=71.01%
[TRAIN][ep=014] mask_avg: mc_mean=0.1869 mb_mean=0.5023 norm_overlap=0.9991 corr_cb=-0.0668
[EPOCH 014/089] train: loss=1.2732 acc=71.01% | val: loss=0.5881 acc=62.65% f1=73.50% auc=76.16% val_score=58.7799 val_score_bestthr=69.0204 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.187, mb=0.502, no=0.999, corr=-0.067) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 68.3138 -> 69.0204
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1595 mb_mean=0.5022 norm_overlap=1.0002 corr_cb=0.0151 topkJ=0.0641
[TRAIN][ep=015] loss=1.2920 acc=69.80%
[TRAIN][ep=015] mask_avg: mc_mean=0.1918 mb_mean=0.5023 norm_overlap=0.9988 corr_cb=-0.0872
[EPOCH 015/089] train: loss=1.2920 acc=69.80% | val: loss=0.5843 acc=65.06% f1=72.38% auc=78.55% val_score=61.2400 val_score_bestthr=66.8004 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.192, mb=0.502, no=0.999, corr=-0.087) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.0204 -> 66.8004
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1785 mb_mean=0.5002 norm_overlap=0.9991 corr_cb=-0.0710 topkJ=0.0429
[TRAIN][ep=016] loss=1.2790 acc=70.47%
[TRAIN][ep=016] mask_avg: mc_mean=0.1925 mb_mean=0.5023 norm_overlap=0.9984 corr_cb=-0.1108
[EPOCH 016/089] train: loss=1.2790 acc=70.47% | val: loss=0.5757 acc=74.70% f1=72.73% auc=78.37% val_score=68.0866 val_score_bestthr=68.0866 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.193, mb=0.502, no=0.998, corr=-0.111) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.0204 -> 68.0866
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.2251 mb_mean=0.5033 norm_overlap=0.9968 corr_cb=-0.2086 topkJ=0.0215
[TRAIN][ep=017] loss=1.2691 acc=71.28%
[TRAIN][ep=017] mask_avg: mc_mean=0.2056 mb_mean=0.5023 norm_overlap=0.9982 corr_cb=-0.1183
[EPOCH 017/089] train: loss=1.2691 acc=71.28% | val: loss=0.5833 acc=67.47% f1=73.27% auc=78.14% val_score=60.0846 val_score_bestthr=67.0451 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.206, mb=0.502, no=0.998, corr=-0.118) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.0204 -> 67.0451
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1881 mb_mean=0.5025 norm_overlap=0.9987 corr_cb=-0.0790 topkJ=0.0488
[TRAIN][ep=018] loss=1.2511 acc=71.81%
[TRAIN][ep=018] mask_avg: mc_mean=0.1975 mb_mean=0.5023 norm_overlap=0.9983 corr_cb=-0.1057
[EPOCH 018/089] train: loss=1.2511 acc=71.81% | val: loss=0.6038 acc=63.86% f1=74.14% auc=79.01% val_score=61.6238 val_score_bestthr=68.8312 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.197, mb=0.502, no=0.998, corr=-0.106) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.0204 -> 68.8312
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.1539 mb_mean=0.5022 norm_overlap=0.9967 corr_cb=-0.2133 topkJ=0.0522
[TRAIN][ep=019] loss=1.2413 acc=72.75%
[TRAIN][ep=019] mask_avg: mc_mean=0.1945 mb_mean=0.5023 norm_overlap=0.9982 corr_cb=-0.1108
[EPOCH 019/089] train: loss=1.2413 acc=72.75% | val: loss=0.5609 acc=74.70% f1=72.73% auc=78.43% val_score=65.3216 val_score_bestthr=68.0866 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.195, mb=0.502, no=0.998, corr=-0.111) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.0204 -> 68.0866
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.2251 mb_mean=0.5020 norm_overlap=0.9986 corr_cb=-0.0687 topkJ=0.0857
[TRAIN][ep=020] loss=1.0477 acc=73.02%
[TRAIN][ep=020] mask_avg: mc_mean=0.1979 mb_mean=0.5023 norm_overlap=0.9981 corr_cb=-0.1106
[EPOCH 020/089] train: loss=1.0477 acc=73.02% | val: loss=0.5785 acc=74.70% f1=72.00% auc=76.51% val_score=66.6390 val_score_bestthr=69.4062 | dyn(w_pfs=0.290, w_sup=0.190, w_csuf=0.140, stage2=False) | mask(mc=0.198, mb=0.502, no=0.998, corr=-0.111) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 69.0204 -> 69.4062
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2243 mb_mean=0.5058 norm_overlap=0.9977 corr_cb=-0.1375 topkJ=0.0343
[TRAIN][ep=021] loss=1.1330 acc=71.68%
[TRAIN][ep=021] mask_avg: mc_mean=0.2007 mb_mean=0.5023 norm_overlap=0.9980 corr_cb=-0.1144
[EPOCH 021/089] train: loss=1.1330 acc=71.68% | val: loss=0.5626 acc=74.70% f1=72.00% auc=78.14% val_score=66.6390 val_score_bestthr=69.4062 | dyn(w_pfs=0.330, w_sup=0.230, w_csuf=0.180, stage2=False) | mask(mc=0.201, mb=0.502, no=0.998, corr=-0.114) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.4062 -> 69.4062
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2493 mb_mean=0.4996 norm_overlap=0.9989 corr_cb=-0.0631 topkJ=0.0364
[TRAIN][ep=022] loss=1.1761 acc=73.69%
[TRAIN][ep=022] mask_avg: mc_mean=0.2242 mb_mean=0.5023 norm_overlap=0.9977 corr_cb=-0.1414
[EPOCH 022/089] train: loss=1.1761 acc=73.69% | val: loss=0.5595 acc=75.90% f1=74.36% auc=77.85% val_score=69.4062 val_score_bestthr=68.9443 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.224, mb=0.502, no=0.998, corr=-0.141) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 69.4062 -> 68.9443
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1366 mb_mean=0.5023 norm_overlap=0.9979 corr_cb=-0.1103 topkJ=0.0267
[TRAIN][ep=023] loss=1.1953 acc=74.77%
[TRAIN][ep=023] mask_avg: mc_mean=0.2113 mb_mean=0.5023 norm_overlap=0.9979 corr_cb=-0.1188
[EPOCH 023/089] train: loss=1.1953 acc=74.77% | val: loss=0.5728 acc=75.90% f1=73.68% auc=77.73% val_score=64.4160 val_score_bestthr=70.8552 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.211, mb=0.502, no=0.998, corr=-0.119) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 69.4062 -> 70.8552
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2148 mb_mean=0.5016 norm_overlap=0.9970 corr_cb=-0.1842 topkJ=0.0469
[TRAIN][ep=024] loss=1.2207 acc=72.75%
[TRAIN][ep=024] mask_avg: mc_mean=0.2127 mb_mean=0.5023 norm_overlap=0.9979 corr_cb=-0.1190
[EPOCH 024/089] train: loss=1.2207 acc=72.75% | val: loss=0.5439 acc=75.90% f1=74.36% auc=79.30% val_score=62.8550 val_score_bestthr=71.3284 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.213, mb=0.502, no=0.998, corr=-0.119) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 70.8552 -> 71.3284
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.1793 mb_mean=0.4998 norm_overlap=1.0002 corr_cb=0.0109 topkJ=0.0509
[TRAIN][ep=025] loss=1.1875 acc=75.44%
[TRAIN][ep=025] mask_avg: mc_mean=0.1950 mb_mean=0.5023 norm_overlap=0.9980 corr_cb=-0.1074
[EPOCH 025/089] train: loss=1.1875 acc=75.44% | val: loss=0.5527 acc=77.11% f1=74.67% auc=78.14% val_score=68.2341 val_score_bestthr=73.6277 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.195, mb=0.502, no=0.998, corr=-0.107) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 71.3284 -> 73.6277
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2313 mb_mean=0.5001 norm_overlap=0.9971 corr_cb=-0.1893 topkJ=0.0174
[TRAIN][ep=026] loss=1.1794 acc=75.70%
[TRAIN][ep=026] mask_avg: mc_mean=0.2186 mb_mean=0.5023 norm_overlap=0.9979 corr_cb=-0.1171
[EPOCH 026/089] train: loss=1.1794 acc=75.70% | val: loss=0.5411 acc=78.31% f1=77.50% auc=79.48% val_score=54.8474 val_score_bestthr=72.6051 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.219, mb=0.502, no=0.998, corr=-0.117) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 72.6051
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.1664 mb_mean=0.5032 norm_overlap=0.9974 corr_cb=-0.1497 topkJ=0.0363
[TRAIN][ep=027] loss=1.1612 acc=75.84%
[TRAIN][ep=027] mask_avg: mc_mean=0.2176 mb_mean=0.5023 norm_overlap=0.9978 corr_cb=-0.1200
[EPOCH 027/089] train: loss=1.1612 acc=75.84% | val: loss=0.5833 acc=73.49% f1=72.50% auc=77.44% val_score=64.4158 val_score_bestthr=68.2341 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.218, mb=0.502, no=0.998, corr=-0.120) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 68.2341
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2040 mb_mean=0.5016 norm_overlap=1.0000 corr_cb=-0.0010 topkJ=0.0510
[TRAIN][ep=028] loss=1.1491 acc=77.85%
[TRAIN][ep=028] mask_avg: mc_mean=0.2194 mb_mean=0.5023 norm_overlap=0.9980 corr_cb=-0.1090
[EPOCH 028/089] train: loss=1.1491 acc=77.85% | val: loss=0.5475 acc=77.11% f1=75.95% auc=78.55% val_score=64.0724 val_score_bestthr=72.4213 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.219, mb=0.502, no=0.998, corr=-0.109) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 72.4213
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2136 mb_mean=0.5039 norm_overlap=0.9984 corr_cb=-0.0932 topkJ=0.0718
[TRAIN][ep=029] loss=1.1606 acc=77.72%
[TRAIN][ep=029] mask_avg: mc_mean=0.2253 mb_mean=0.5023 norm_overlap=0.9978 corr_cb=-0.1195
[EPOCH 029/089] train: loss=1.1606 acc=77.72% | val: loss=0.5480 acc=73.49% f1=71.79% auc=80.23% val_score=67.8564 val_score_bestthr=70.1718 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.225, mb=0.502, no=0.998, corr=-0.120) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 70.1718
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.1434 mb_mean=0.5015 norm_overlap=0.9978 corr_cb=-0.1066 topkJ=0.0325
[TRAIN][ep=030] loss=1.1544 acc=76.78%
[TRAIN][ep=030] mask_avg: mc_mean=0.2211 mb_mean=0.5023 norm_overlap=0.9977 corr_cb=-0.1229
[EPOCH 030/089] train: loss=1.1544 acc=76.78% | val: loss=0.5861 acc=73.49% f1=72.50% auc=79.59% val_score=64.4158 val_score_bestthr=69.8694 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.221, mb=0.502, no=0.998, corr=-0.123) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 69.8694
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2910 mb_mean=0.5032 norm_overlap=0.9983 corr_cb=-0.1187 topkJ=0.0396
[TRAIN][ep=031] loss=0.9714 acc=77.18%
[TRAIN][ep=031] mask_avg: mc_mean=0.2240 mb_mean=0.5023 norm_overlap=0.9974 corr_cb=-0.1412
[EPOCH 031/089] train: loss=0.9714 acc=77.18% | val: loss=0.5643 acc=73.49% f1=72.50% auc=78.43% val_score=62.8147 val_score_bestthr=68.2341 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.224, mb=0.502, no=0.997, corr=-0.141) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 68.2341
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2151 mb_mean=0.5001 norm_overlap=0.9950 corr_cb=-0.2483 topkJ=0.0360
[TRAIN][ep=032] loss=0.7843 acc=78.52%
[TRAIN][ep=032] mask_avg: mc_mean=0.2161 mb_mean=0.5023 norm_overlap=0.9972 corr_cb=-0.1432
[EPOCH 032/089] train: loss=0.7843 acc=78.52% | val: loss=0.5570 acc=68.67% f1=75.93% auc=78.90% val_score=51.1842 val_score_bestthr=68.2387 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.216, mb=0.502, no=0.997, corr=-0.143) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 68.2387
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.1934 mb_mean=0.5007 norm_overlap=0.9988 corr_cb=-0.0704 topkJ=0.0677
[TRAIN][ep=033] loss=0.7305 acc=78.79%
[TRAIN][ep=033] mask_avg: mc_mean=0.2125 mb_mean=0.5023 norm_overlap=0.9973 corr_cb=-0.1350
[EPOCH 033/089] train: loss=0.7305 acc=78.79% | val: loss=0.5525 acc=68.67% f1=75.93% auc=79.19% val_score=58.2819 val_score_bestthr=68.2387 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.213, mb=0.502, no=0.997, corr=-0.135) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 68.2387
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2680 mb_mean=0.5049 norm_overlap=0.9960 corr_cb=-0.2274 topkJ=0.0248
[TRAIN][ep=034] loss=0.7178 acc=78.66%
[TRAIN][ep=034] mask_avg: mc_mean=0.2343 mb_mean=0.5023 norm_overlap=0.9973 corr_cb=-0.1446
[EPOCH 034/089] train: loss=0.7178 acc=78.66% | val: loss=0.6032 acc=69.88% f1=75.25% auc=79.59% val_score=65.7650 val_score_bestthr=69.0388 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.234, mb=0.502, no=0.997, corr=-0.145) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 69.0388
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2919 mb_mean=0.5025 norm_overlap=0.9952 corr_cb=-0.2206 topkJ=0.0244
[TRAIN][ep=035] loss=0.7027 acc=80.13%
[TRAIN][ep=035] mask_avg: mc_mean=0.2583 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1682
[EPOCH 035/089] train: loss=0.7027 acc=80.13% | val: loss=0.5682 acc=73.49% f1=69.44% auc=78.31% val_score=65.6290 val_score_bestthr=69.6284 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.258, mb=0.502, no=0.997, corr=-0.168) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 69.6284
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2048 mb_mean=0.5025 norm_overlap=0.9974 corr_cb=-0.1169 topkJ=0.0590
[TRAIN][ep=036] loss=0.7058 acc=80.27%
[TRAIN][ep=036] mask_avg: mc_mean=0.2288 mb_mean=0.5023 norm_overlap=0.9973 corr_cb=-0.1371
[EPOCH 036/089] train: loss=0.7058 acc=80.27% | val: loss=0.5680 acc=68.67% f1=75.93% auc=78.14% val_score=64.5926 val_score_bestthr=68.2387 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.229, mb=0.502, no=0.997, corr=-0.137) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 68.2387
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.1641 mb_mean=0.5040 norm_overlap=0.9961 corr_cb=-0.1808 topkJ=0.0304
[TRAIN][ep=037] loss=0.6916 acc=80.40%
[TRAIN][ep=037] mask_avg: mc_mean=0.2269 mb_mean=0.5023 norm_overlap=0.9973 corr_cb=-0.1373
[EPOCH 037/089] train: loss=0.6916 acc=80.40% | val: loss=0.5642 acc=72.29% f1=76.77% auc=79.42% val_score=54.8619 val_score_bestthr=70.9047 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.227, mb=0.502, no=0.997, corr=-0.137) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 70.9047
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2565 mb_mean=0.5023 norm_overlap=0.9931 corr_cb=-0.3347 topkJ=0.0111
[TRAIN][ep=038] loss=0.6739 acc=80.81%
[TRAIN][ep=038] mask_avg: mc_mean=0.2479 mb_mean=0.5023 norm_overlap=0.9969 corr_cb=-0.1623
[EPOCH 038/089] train: loss=0.6739 acc=80.81% | val: loss=0.5750 acc=67.47% f1=75.68% auc=78.20% val_score=63.9109 val_score_bestthr=69.4811 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.248, mb=0.502, no=0.997, corr=-0.162) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 69.4811
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2706 mb_mean=0.5023 norm_overlap=0.9951 corr_cb=-0.2702 topkJ=0.0270
[TRAIN][ep=039] loss=0.6736 acc=81.88%
[TRAIN][ep=039] mask_avg: mc_mean=0.2454 mb_mean=0.5023 norm_overlap=0.9972 corr_cb=-0.1493
[EPOCH 039/089] train: loss=0.6736 acc=81.88% | val: loss=0.5965 acc=68.67% f1=75.93% auc=76.98% val_score=58.4968 val_score_bestthr=68.2387 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.245, mb=0.502, no=0.997, corr=-0.149) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 68.2387
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.1785 mb_mean=0.5019 norm_overlap=0.9967 corr_cb=-0.1377 topkJ=0.0411
[TRAIN][ep=040] loss=0.6709 acc=81.34%
[TRAIN][ep=040] mask_avg: mc_mean=0.2250 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1469
[EPOCH 040/089] train: loss=0.6709 acc=81.34% | val: loss=0.5881 acc=75.90% f1=74.36% auc=78.60% val_score=65.0270 val_score_bestthr=71.2011 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.225, mb=0.502, no=0.997, corr=-0.147) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 71.2011
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.2536 mb_mean=0.5002 norm_overlap=0.9978 corr_cb=-0.1268 topkJ=0.0251
[TRAIN][ep=041] loss=0.6573 acc=81.61%
[TRAIN][ep=041] mask_avg: mc_mean=0.2484 mb_mean=0.5023 norm_overlap=0.9971 corr_cb=-0.1474
[EPOCH 041/089] train: loss=0.6573 acc=81.61% | val: loss=0.5937 acc=68.67% f1=76.36% auc=77.56% val_score=57.0790 val_score_bestthr=71.8036 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.248, mb=0.502, no=0.997, corr=-0.147) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 71.8036
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.1798 mb_mean=0.5021 norm_overlap=0.9979 corr_cb=-0.0988 topkJ=0.0241
[TRAIN][ep=042] loss=0.6562 acc=82.15%
[TRAIN][ep=042] mask_avg: mc_mean=0.2277 mb_mean=0.5023 norm_overlap=0.9972 corr_cb=-0.1389
[EPOCH 042/089] train: loss=0.6562 acc=82.15% | val: loss=0.5893 acc=68.67% f1=76.36% auc=77.97% val_score=56.0901 val_score_bestthr=71.8036 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.228, mb=0.502, no=0.997, corr=-0.139) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 71.8036
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.3225 mb_mean=0.5025 norm_overlap=0.9954 corr_cb=-0.2502 topkJ=0.0220
[TRAIN][ep=043] loss=0.6586 acc=82.68%
[TRAIN][ep=043] mask_avg: mc_mean=0.2469 mb_mean=0.5023 norm_overlap=0.9969 corr_cb=-0.1600
[EPOCH 043/089] train: loss=0.6586 acc=82.68% | val: loss=0.6218 acc=67.47% f1=75.68% auc=76.22% val_score=57.3125 val_score_bestthr=71.0318 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.247, mb=0.502, no=0.997, corr=-0.160) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 71.0318
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2502 mb_mean=0.5062 norm_overlap=1.0007 corr_cb=0.0335 topkJ=0.0610
[TRAIN][ep=044] loss=0.6340 acc=83.09%
[TRAIN][ep=044] mask_avg: mc_mean=0.2473 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1550
[EPOCH 044/089] train: loss=0.6340 acc=83.09% | val: loss=0.6246 acc=67.47% f1=75.68% auc=77.44% val_score=61.7270 val_score_bestthr=71.0318 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.247, mb=0.502, no=0.997, corr=-0.155) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 71.0318
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2945 mb_mean=0.5009 norm_overlap=0.9982 corr_cb=-0.0819 topkJ=0.0711
[TRAIN][ep=045] loss=0.6409 acc=83.89%
[TRAIN][ep=045] mask_avg: mc_mean=0.2576 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1573
[EPOCH 045/089] train: loss=0.6409 acc=83.89% | val: loss=0.6829 acc=69.88% f1=76.64% auc=75.52% val_score=64.2011 val_score_bestthr=72.2690 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.258, mb=0.502, no=0.997, corr=-0.157) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 72.2690
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.1986 mb_mean=0.5026 norm_overlap=0.9988 corr_cb=-0.0455 topkJ=0.0713
[TRAIN][ep=046] loss=0.6360 acc=83.49%
[TRAIN][ep=046] mask_avg: mc_mean=0.2164 mb_mean=0.5023 norm_overlap=0.9971 corr_cb=-0.1338
[EPOCH 046/089] train: loss=0.6360 acc=83.49% | val: loss=0.6416 acc=72.29% f1=76.77% auc=76.22% val_score=59.6185 val_score_bestthr=69.6873 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.216, mb=0.502, no=0.997, corr=-0.134) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 69.6873
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.2753 mb_mean=0.5033 norm_overlap=0.9965 corr_cb=-0.2087 topkJ=0.0145
[TRAIN][ep=047] loss=0.6337 acc=83.89%
[TRAIN][ep=047] mask_avg: mc_mean=0.2571 mb_mean=0.5023 norm_overlap=0.9968 corr_cb=-0.1619
[EPOCH 047/089] train: loss=0.6337 acc=83.89% | val: loss=0.6584 acc=69.88% f1=75.25% auc=75.47% val_score=56.1793 val_score_bestthr=69.2199 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.257, mb=0.502, no=0.997, corr=-0.162) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 69.2199
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.2732 mb_mean=0.5001 norm_overlap=0.9959 corr_cb=-0.2182 topkJ=0.0234
[TRAIN][ep=048] loss=0.6010 acc=85.10%
[TRAIN][ep=048] mask_avg: mc_mean=0.2437 mb_mean=0.5023 norm_overlap=0.9970 corr_cb=-0.1498
[EPOCH 048/089] train: loss=0.6010 acc=85.10% | val: loss=0.7456 acc=68.67% f1=75.93% auc=75.87% val_score=68.0929 val_score_bestthr=71.1606 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.244, mb=0.502, no=0.997, corr=-0.150) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 71.1606
[DBG][ep=049] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.2353 mb_mean=0.4996 norm_overlap=0.9936 corr_cb=-0.3088 topkJ=0.0206
[TRAIN][ep=049] loss=0.6755 acc=79.73%
[TRAIN][ep=049] mask_avg: mc_mean=0.2248 mb_mean=0.5023 norm_overlap=0.9967 corr_cb=-0.1547
[EPOCH 049/089] train: loss=0.6755 acc=79.73% | val: loss=0.7026 acc=68.67% f1=76.36% auc=75.47% val_score=68.2724 val_score_bestthr=73.3543 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.225, mb=0.502, no=0.997, corr=-0.155) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 73.3543
[DBG][ep=050] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.2425 mb_mean=0.5034 norm_overlap=0.9942 corr_cb=-0.2714 topkJ=0.0097
[TRAIN][ep=050] loss=0.5891 acc=86.71%
[TRAIN][ep=050] mask_avg: mc_mean=0.2538 mb_mean=0.5023 norm_overlap=0.9964 corr_cb=-0.1805
[EPOCH 050/089] train: loss=0.5891 acc=86.71% | val: loss=0.6445 acc=71.08% f1=76.47% auc=75.29% val_score=62.5027 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.254, mb=0.502, no=0.996, corr=-0.180) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 72.7764
[DBG][ep=051] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.2052 mb_mean=0.5047 norm_overlap=1.0003 corr_cb=0.0140 topkJ=0.0669
[TRAIN][ep=051] loss=0.5853 acc=87.25%
[TRAIN][ep=051] mask_avg: mc_mean=0.2538 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1759
[EPOCH 051/089] train: loss=0.5853 acc=87.25% | val: loss=0.6455 acc=69.88% f1=75.73% auc=75.47% val_score=62.5027 val_score_bestthr=71.6631 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.254, mb=0.502, no=0.997, corr=-0.176) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 71.6631
[DBG][ep=052] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.2542 mb_mean=0.5020 norm_overlap=0.9953 corr_cb=-0.2451 topkJ=0.0344
[TRAIN][ep=052] loss=0.5776 acc=88.19%
[TRAIN][ep=052] mask_avg: mc_mean=0.2538 mb_mean=0.5023 norm_overlap=0.9964 corr_cb=-0.1786
[EPOCH 052/089] train: loss=0.5776 acc=88.19% | val: loss=0.6476 acc=69.88% f1=76.19% auc=75.76% val_score=61.7074 val_score_bestthr=72.6250 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.254, mb=0.502, no=0.996, corr=-0.179) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 72.6250
[DBG][ep=053] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.2704 mb_mean=0.5023 norm_overlap=0.9966 corr_cb=-0.1878 topkJ=0.0252
[TRAIN][ep=053] loss=0.5795 acc=87.92%
[TRAIN][ep=053] mask_avg: mc_mean=0.2537 mb_mean=0.5023 norm_overlap=0.9965 corr_cb=-0.1794
[EPOCH 053/089] train: loss=0.5795 acc=87.92% | val: loss=0.6500 acc=71.08% f1=76.47% auc=75.47% val_score=56.4777 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.254, mb=0.502, no=0.996, corr=-0.179) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 72.7764
[DBG][ep=054] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=054] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=054] mask(step0): mc_mean=0.2616 mb_mean=0.5013 norm_overlap=0.9963 corr_cb=-0.1740 topkJ=0.0285
[TRAIN][ep=054] loss=0.5720 acc=87.25%
[TRAIN][ep=054] mask_avg: mc_mean=0.2538 mb_mean=0.5023 norm_overlap=0.9963 corr_cb=-0.1842
[EPOCH 054/089] train: loss=0.5720 acc=87.25% | val: loss=0.6557 acc=69.88% f1=75.73% auc=75.35% val_score=56.5112 val_score_bestthr=71.6631 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.254, mb=0.502, no=0.996, corr=-0.184) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 71.6631
[DBG][ep=055] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=055] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=055] mask(step0): mc_mean=0.2576 mb_mean=0.5029 norm_overlap=0.9937 corr_cb=-0.3176 topkJ=0.0117
[TRAIN][ep=055] loss=0.5718 acc=88.46%
[TRAIN][ep=055] mask_avg: mc_mean=0.2538 mb_mean=0.5023 norm_overlap=0.9964 corr_cb=-0.1797
[EPOCH 055/089] train: loss=0.5718 acc=88.46% | val: loss=0.6595 acc=71.08% f1=76.47% auc=75.47% val_score=56.4777 val_score_bestthr=72.7764 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.254, mb=0.502, no=0.996, corr=-0.180) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.6277 -> 72.7764
[EARLY STOP] no improvement for 30 epochs. best_epoch=25
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
=============== FIT DONE ===============
[BEST] epoch=25 | val_acc=77.11% | val_f1=74.67% | val_auc=78.14% | val_score=68.2341 | val_score_bestthr=73.6277
[TEST@BEST] thr_used=0.315 | acc=63.29% f1=70.99% auc=65.32% | SP_sex=2.14% EO_sex=4.30% SP_age=11.65% EO_age=8.89%
[TIME] 1.65 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold0_rep2_seed2000/summary_fold_0.json
