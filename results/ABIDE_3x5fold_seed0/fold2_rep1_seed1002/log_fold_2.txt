[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4409 mb_mean=0.4998 norm_overlap=0.9999 corr_cb=-0.1537 topkJ=0.0142
[TRAIN][ep=000] loss=0.6966 acc=49.13%
[TRAIN][ep=000] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2179
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4456 mb_mean=0.4977 norm_overlap=0.9998 corr_cb=-0.3429 topkJ=0.0084
[TRAIN][ep=001] loss=0.6933 acc=50.60%
[TRAIN][ep=001] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2197
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4416 mb_mean=0.4967 norm_overlap=1.0000 corr_cb=-0.0925 topkJ=0.0328
[TRAIN][ep=002] loss=0.6926 acc=51.54%
[TRAIN][ep=002] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2149
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4401 mb_mean=0.4989 norm_overlap=0.9997 corr_cb=-0.3682 topkJ=0.0059
[TRAIN][ep=003] loss=0.6918 acc=53.83%
[TRAIN][ep=003] mask_avg: mc_mean=0.4421 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2220
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4399 mb_mean=0.4974 norm_overlap=0.9999 corr_cb=-0.1290 topkJ=0.0272
[TRAIN][ep=004] loss=0.6910 acc=53.96%
[TRAIN][ep=004] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2177
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4388 mb_mean=0.4999 norm_overlap=0.9998 corr_cb=-0.3849 topkJ=0.0055
[TRAIN][ep=005] loss=0.6906 acc=51.95%
[TRAIN][ep=005] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2149
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4421 mb_mean=0.4993 norm_overlap=0.9998 corr_cb=-0.2996 topkJ=0.0246
[TRAIN][ep=006] loss=0.6893 acc=55.97%
[TRAIN][ep=006] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2113
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4448 mb_mean=0.4952 norm_overlap=1.0000 corr_cb=0.0093 topkJ=0.0332
[TRAIN][ep=007] loss=0.6878 acc=59.46%
[TRAIN][ep=007] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2179
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4400 mb_mean=0.4972 norm_overlap=1.0000 corr_cb=-0.0037 topkJ=0.0472
[TRAIN][ep=008] loss=0.6870 acc=57.99%
[TRAIN][ep=008] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2155
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4446 mb_mean=0.4966 norm_overlap=0.9999 corr_cb=-0.2381 topkJ=0.0197
[TRAIN][ep=009] loss=0.6843 acc=59.60%
[TRAIN][ep=009] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2154
================= FIT START (fold=2) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4430 mb_mean=0.4980 norm_overlap=1.0000 corr_cb=-0.1091 topkJ=0.0223
[TRAIN][ep=000] loss=0.6845 acc=56.64%
[TRAIN][ep=000] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2180
[EPOCH 000/089] train: loss=0.6845 acc=56.64% | val: loss=0.6799 acc=65.06% f1=71.84% auc=68.37% val_score=61.8498 val_score_bestthr=70.3800 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.218) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 70.3800
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4450 mb_mean=0.4972 norm_overlap=0.9999 corr_cb=-0.1381 topkJ=0.0336
[TRAIN][ep=001] loss=0.6828 acc=60.00%
[TRAIN][ep=001] mask_avg: mc_mean=0.4421 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2187
[EPOCH 001/089] train: loss=0.6828 acc=60.00% | val: loss=0.6797 acc=66.27% f1=74.55% auc=69.48% val_score=62.4161 val_score_bestthr=70.6111 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.219) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 70.3800 -> 70.6111
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4416 mb_mean=0.4970 norm_overlap=0.9999 corr_cb=-0.1910 topkJ=0.0291
[TRAIN][ep=002] loss=0.6803 acc=60.94%
[TRAIN][ep=002] mask_avg: mc_mean=0.4421 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2200
[EPOCH 002/089] train: loss=0.6803 acc=60.94% | val: loss=0.6776 acc=66.27% f1=75.00% auc=69.83% val_score=66.6521 val_score_bestthr=72.4003 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.220) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 70.6111 -> 72.4003
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4419 mb_mean=0.4995 norm_overlap=0.9998 corr_cb=-0.3017 topkJ=0.0204
[TRAIN][ep=003] loss=0.6797 acc=59.87%
[TRAIN][ep=003] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2169
[EPOCH 003/089] train: loss=0.6797 acc=59.87% | val: loss=0.6760 acc=66.27% f1=72.55% auc=69.01% val_score=65.3720 val_score_bestthr=73.0194 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.217) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 72.4003 -> 73.0194
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4404 mb_mean=0.4979 norm_overlap=0.9999 corr_cb=-0.1561 topkJ=0.0339
[TRAIN][ep=004] loss=0.6784 acc=58.26%
[TRAIN][ep=004] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2191
[EPOCH 004/089] train: loss=0.6784 acc=58.26% | val: loss=0.6748 acc=67.47% f1=75.68% auc=69.83% val_score=60.1820 val_score_bestthr=72.1654 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.219) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 73.0194 -> 72.1654
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4474 mb_mean=0.4984 norm_overlap=1.0000 corr_cb=-0.0752 topkJ=0.0199
[TRAIN][ep=005] loss=1.2697 acc=57.72%
[TRAIN][ep=005] mask_avg: mc_mean=0.3276 mb_mean=0.4982 norm_overlap=0.9992 corr_cb=-0.2569
[EPOCH 005/089] train: loss=1.2697 acc=57.72% | val: loss=0.6752 acc=67.47% f1=73.27% auc=70.29% val_score=63.6187 val_score_bestthr=73.2470 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.328, mb=0.498, no=0.999, corr=-0.257) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 73.0194 -> 73.2470
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2601 mb_mean=0.4984 norm_overlap=0.9986 corr_cb=-0.2169 topkJ=0.0233
[TRAIN][ep=006] loss=1.2550 acc=62.01%
[TRAIN][ep=006] mask_avg: mc_mean=0.2287 mb_mean=0.4982 norm_overlap=0.9984 corr_cb=-0.2526
[EPOCH 006/089] train: loss=1.2550 acc=62.01% | val: loss=0.6765 acc=67.47% f1=71.58% auc=69.77% val_score=51.5543 val_score_bestthr=67.2194 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.229, mb=0.498, no=0.998, corr=-0.253) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.2470 -> 67.2194
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2524 mb_mean=0.5001 norm_overlap=0.9982 corr_cb=-0.2756 topkJ=0.0495
[TRAIN][ep=007] loss=1.2541 acc=60.54%
[TRAIN][ep=007] mask_avg: mc_mean=0.1981 mb_mean=0.4982 norm_overlap=0.9979 corr_cb=-0.2715
[EPOCH 007/089] train: loss=1.2541 acc=60.54% | val: loss=0.6721 acc=66.27% f1=75.00% auc=71.28% val_score=61.4276 val_score_bestthr=69.5303 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.198, mb=0.498, no=0.998, corr=-0.271) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 73.2470 -> 69.5303
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1987 mb_mean=0.4984 norm_overlap=0.9983 corr_cb=-0.2567 topkJ=0.0439
[TRAIN][ep=008] loss=1.2466 acc=62.82%
[TRAIN][ep=008] mask_avg: mc_mean=0.1831 mb_mean=0.4982 norm_overlap=0.9975 corr_cb=-0.2888
[EPOCH 008/089] train: loss=1.2466 acc=62.82% | val: loss=0.6757 acc=69.88% f1=74.75% auc=69.42% val_score=61.3370 val_score_bestthr=75.5719 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.183, mb=0.498, no=0.997, corr=-0.289) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 73.2470 -> 75.5719
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1760 mb_mean=0.4974 norm_overlap=0.9973 corr_cb=-0.3277 topkJ=0.0169
[TRAIN][ep=009] loss=1.2523 acc=56.11%
[TRAIN][ep=009] mask_avg: mc_mean=0.1760 mb_mean=0.4982 norm_overlap=0.9970 corr_cb=-0.3061
[EPOCH 009/089] train: loss=1.2523 acc=56.11% | val: loss=0.6763 acc=65.06% f1=68.13% auc=67.33% val_score=53.6598 val_score_bestthr=65.5565 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.176, mb=0.498, no=0.997, corr=-0.306) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.5719 -> 65.5565
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1832 mb_mean=0.4962 norm_overlap=0.9962 corr_cb=-0.3986 topkJ=0.0164
[TRAIN][ep=010] loss=1.2454 acc=62.15%
[TRAIN][ep=010] mask_avg: mc_mean=0.1679 mb_mean=0.4982 norm_overlap=0.9966 corr_cb=-0.3268
[EPOCH 010/089] train: loss=1.2454 acc=62.15% | val: loss=0.6680 acc=71.08% f1=75.51% auc=70.93% val_score=63.6135 val_score_bestthr=72.7360 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.168, mb=0.498, no=0.997, corr=-0.327) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.5719 -> 72.7360
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1885 mb_mean=0.4990 norm_overlap=0.9964 corr_cb=-0.3848 topkJ=0.0174
[TRAIN][ep=011] loss=1.2401 acc=64.56%
[TRAIN][ep=011] mask_avg: mc_mean=0.1618 mb_mean=0.4982 norm_overlap=0.9962 corr_cb=-0.3227
[EPOCH 011/089] train: loss=1.2401 acc=64.56% | val: loss=0.6667 acc=66.27% f1=67.44% auc=69.94% val_score=52.9669 val_score_bestthr=69.1888 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.162, mb=0.498, no=0.996, corr=-0.323) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.5719 -> 69.1888
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1787 mb_mean=0.4965 norm_overlap=0.9979 corr_cb=-0.2079 topkJ=0.0616
[TRAIN][ep=012] loss=1.2351 acc=62.95%
[TRAIN][ep=012] mask_avg: mc_mean=0.1575 mb_mean=0.4982 norm_overlap=0.9960 corr_cb=-0.2974
[EPOCH 012/089] train: loss=1.2351 acc=62.95% | val: loss=0.6615 acc=69.88% f1=73.68% auc=71.10% val_score=63.6135 val_score_bestthr=73.4314 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.157, mb=0.498, no=0.996, corr=-0.297) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.5719 -> 73.4314
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.0994 mb_mean=0.5001 norm_overlap=0.9937 corr_cb=-0.3298 topkJ=0.0309
[TRAIN][ep=013] loss=1.2278 acc=63.89%
[TRAIN][ep=013] mask_avg: mc_mean=0.1566 mb_mean=0.4982 norm_overlap=0.9957 corr_cb=-0.2906
[EPOCH 013/089] train: loss=1.2278 acc=63.89% | val: loss=0.6566 acc=72.29% f1=76.77% auc=71.34% val_score=63.4960 val_score_bestthr=70.3321 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.157, mb=0.498, no=0.996, corr=-0.291) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.5719 -> 70.3321
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1988 mb_mean=0.4970 norm_overlap=0.9955 corr_cb=-0.3323 topkJ=0.0173
[TRAIN][ep=014] loss=0.9837 acc=62.15%
[TRAIN][ep=014] mask_avg: mc_mean=0.1653 mb_mean=0.4982 norm_overlap=0.9959 corr_cb=-0.2542
[EPOCH 014/089] train: loss=0.9837 acc=62.15% | val: loss=0.6693 acc=66.27% f1=65.00% auc=67.97% val_score=42.4417 val_score_bestthr=63.9798 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.165, mb=0.498, no=0.996, corr=-0.254) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.5719 -> 63.9798
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1437 mb_mean=0.4996 norm_overlap=0.9932 corr_cb=-0.3662 topkJ=0.0258
[TRAIN][ep=015] loss=0.7396 acc=64.83%
[TRAIN][ep=015] mask_avg: mc_mean=0.1591 mb_mean=0.4982 norm_overlap=0.9955 corr_cb=-0.2438
[EPOCH 015/089] train: loss=0.7396 acc=64.83% | val: loss=0.6583 acc=66.27% f1=70.83% auc=69.24% val_score=54.5354 val_score_bestthr=63.9438 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.159, mb=0.498, no=0.996, corr=-0.244) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.5719 -> 63.9438
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1576 mb_mean=0.4984 norm_overlap=0.9981 corr_cb=-0.1064 topkJ=0.0335
[TRAIN][ep=016] loss=0.6791 acc=65.23%
[TRAIN][ep=016] mask_avg: mc_mean=0.1823 mb_mean=0.4982 norm_overlap=0.9957 corr_cb=-0.2301
[EPOCH 016/089] train: loss=0.6791 acc=65.23% | val: loss=0.6459 acc=68.67% f1=73.47% auc=70.47% val_score=57.9848 val_score_bestthr=70.3258 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.182, mb=0.498, no=0.996, corr=-0.230) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.5719 -> 70.3258
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1709 mb_mean=0.4984 norm_overlap=0.9948 corr_cb=-0.2419 topkJ=0.0349
[TRAIN][ep=017] loss=0.6661 acc=62.68%
[TRAIN][ep=017] mask_avg: mc_mean=0.1738 mb_mean=0.4982 norm_overlap=0.9957 corr_cb=-0.2104
[EPOCH 017/089] train: loss=0.6661 acc=62.68% | val: loss=0.6398 acc=71.08% f1=76.47% auc=71.92% val_score=68.8484 val_score_bestthr=69.4341 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.174, mb=0.498, no=0.996, corr=-0.210) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.5719 -> 69.4341
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1674 mb_mean=0.4979 norm_overlap=0.9965 corr_cb=-0.1618 topkJ=0.0305
[TRAIN][ep=018] loss=0.6546 acc=66.04%
[TRAIN][ep=018] mask_avg: mc_mean=0.1828 mb_mean=0.4982 norm_overlap=0.9960 corr_cb=-0.1910
[EPOCH 018/089] train: loss=0.6546 acc=66.04% | val: loss=0.6338 acc=68.67% f1=73.47% auc=71.51% val_score=64.3014 val_score_bestthr=72.0758 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.183, mb=0.498, no=0.996, corr=-0.191) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.5719 -> 72.0758
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.2147 mb_mean=0.5006 norm_overlap=0.9954 corr_cb=-0.2552 topkJ=0.0231
[TRAIN][ep=019] loss=0.6555 acc=65.10%
[TRAIN][ep=019] mask_avg: mc_mean=0.2046 mb_mean=0.4982 norm_overlap=0.9962 corr_cb=-0.1854
[EPOCH 019/089] train: loss=0.6555 acc=65.10% | val: loss=0.6424 acc=66.27% f1=72.00% auc=70.29% val_score=57.3642 val_score_bestthr=65.5278 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.205, mb=0.498, no=0.996, corr=-0.185) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.5719 -> 65.5278
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.2360 mb_mean=0.4972 norm_overlap=0.9940 corr_cb=-0.2814 topkJ=0.0061
[TRAIN][ep=020] loss=0.6489 acc=64.97%
[TRAIN][ep=020] mask_avg: mc_mean=0.2061 mb_mean=0.4982 norm_overlap=0.9960 corr_cb=-0.1874
[EPOCH 020/089] train: loss=0.6489 acc=64.97% | val: loss=0.6329 acc=71.08% f1=76.47% auc=72.21% val_score=68.0260 val_score_bestthr=69.4341 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.206, mb=0.498, no=0.996, corr=-0.187) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.5719 -> 69.4341
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2227 mb_mean=0.4957 norm_overlap=0.9971 corr_cb=-0.1590 topkJ=0.0360
[TRAIN][ep=021] loss=0.6387 acc=66.04%
[TRAIN][ep=021] mask_avg: mc_mean=0.2007 mb_mean=0.4982 norm_overlap=0.9961 corr_cb=-0.1779
[EPOCH 021/089] train: loss=0.6387 acc=66.04% | val: loss=0.6281 acc=69.88% f1=75.25% auc=71.51% val_score=62.3711 val_score_bestthr=69.7636 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.201, mb=0.498, no=0.996, corr=-0.178) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.5719 -> 69.7636
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2122 mb_mean=0.4977 norm_overlap=0.9992 corr_cb=-0.0462 topkJ=0.0525
[TRAIN][ep=022] loss=0.6308 acc=69.13%
[TRAIN][ep=022] mask_avg: mc_mean=0.2099 mb_mean=0.4982 norm_overlap=0.9964 corr_cb=-0.1644
[EPOCH 022/089] train: loss=0.6308 acc=69.13% | val: loss=0.6513 acc=67.47% f1=72.16% auc=70.12% val_score=53.1108 val_score_bestthr=62.7269 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.210, mb=0.498, no=0.996, corr=-0.164) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.5719 -> 62.7269
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1990 mb_mean=0.4976 norm_overlap=0.9972 corr_cb=-0.1240 topkJ=0.0305
[TRAIN][ep=023] loss=0.6365 acc=66.44%
[TRAIN][ep=023] mask_avg: mc_mean=0.2168 mb_mean=0.4982 norm_overlap=0.9965 corr_cb=-0.1594
[EPOCH 023/089] train: loss=0.6365 acc=66.44% | val: loss=0.6789 acc=63.86% f1=64.29% auc=68.60% val_score=47.2802 val_score_bestthr=60.9175 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.217, mb=0.498, no=0.997, corr=-0.159) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.5719 -> 60.9175
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1947 mb_mean=0.4983 norm_overlap=0.9963 corr_cb=-0.1537 topkJ=0.0361
[TRAIN][ep=024] loss=0.6343 acc=65.77%
[TRAIN][ep=024] mask_avg: mc_mean=0.1939 mb_mean=0.4982 norm_overlap=0.9964 corr_cb=-0.1521
[EPOCH 024/089] train: loss=0.6343 acc=65.77% | val: loss=0.6209 acc=69.88% f1=75.25% auc=72.33% val_score=57.7931 val_score_bestthr=68.0260 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.194, mb=0.498, no=0.996, corr=-0.152) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.5719 -> 68.0260
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2501 mb_mean=0.4978 norm_overlap=0.9933 corr_cb=-0.3010 topkJ=0.0170
[TRAIN][ep=025] loss=0.6274 acc=66.98%
[TRAIN][ep=025] mask_avg: mc_mean=0.2159 mb_mean=0.4982 norm_overlap=0.9967 corr_cb=-0.1479
[EPOCH 025/089] train: loss=0.6274 acc=66.98% | val: loss=0.6212 acc=68.67% f1=72.92% auc=71.92% val_score=58.6246 val_score_bestthr=67.7535 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.216, mb=0.498, no=0.997, corr=-0.148) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.5719 -> 67.7535
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2596 mb_mean=0.4982 norm_overlap=0.9969 corr_cb=-0.1737 topkJ=0.0264
[TRAIN][ep=026] loss=0.6171 acc=69.26%
[TRAIN][ep=026] mask_avg: mc_mean=0.2318 mb_mean=0.4982 norm_overlap=0.9966 corr_cb=-0.1576
[EPOCH 026/089] train: loss=0.6171 acc=69.26% | val: loss=0.6228 acc=68.67% f1=72.92% auc=71.74% val_score=55.6866 val_score_bestthr=66.0035 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.232, mb=0.498, no=0.997, corr=-0.158) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.5719 -> 66.0035
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2345 mb_mean=0.4957 norm_overlap=0.9948 corr_cb=-0.2094 topkJ=0.0290
[TRAIN][ep=027] loss=0.6218 acc=68.32%
[TRAIN][ep=027] mask_avg: mc_mean=0.2214 mb_mean=0.4982 norm_overlap=0.9966 corr_cb=-0.1476
[EPOCH 027/089] train: loss=0.6218 acc=68.32% | val: loss=0.6210 acc=68.67% f1=72.92% auc=72.09% val_score=61.0877 val_score_bestthr=67.7535 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.221, mb=0.498, no=0.997, corr=-0.148) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.5719 -> 67.7535
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1766 mb_mean=0.5019 norm_overlap=0.9871 corr_cb=-0.3786 topkJ=0.0067
[TRAIN][ep=028] loss=0.6030 acc=69.66%
[TRAIN][ep=028] mask_avg: mc_mean=0.2178 mb_mean=0.4982 norm_overlap=0.9966 corr_cb=-0.1466
[EPOCH 028/089] train: loss=0.6030 acc=69.66% | val: loss=0.6692 acc=69.88% f1=72.53% auc=72.38% val_score=71.4743 val_score_bestthr=67.3031 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.218, mb=0.498, no=0.997, corr=-0.147) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.5719 -> 67.3031
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2384 mb_mean=0.4959 norm_overlap=0.9975 corr_cb=-0.1224 topkJ=0.0293
[TRAIN][ep=029] loss=0.6075 acc=70.20%
[TRAIN][ep=029] mask_avg: mc_mean=0.2240 mb_mean=0.4982 norm_overlap=0.9965 corr_cb=-0.1540
[EPOCH 029/089] train: loss=0.6075 acc=70.20% | val: loss=0.6128 acc=71.08% f1=76.47% auc=72.15% val_score=58.4937 val_score_bestthr=69.7141 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.224, mb=0.498, no=0.997, corr=-0.154) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.5719 -> 69.7141
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2112 mb_mean=0.4994 norm_overlap=0.9969 corr_cb=-0.1447 topkJ=0.0428
[TRAIN][ep=030] loss=0.6049 acc=69.26%
[TRAIN][ep=030] mask_avg: mc_mean=0.2300 mb_mean=0.4982 norm_overlap=0.9967 corr_cb=-0.1454
[EPOCH 030/089] train: loss=0.6049 acc=69.26% | val: loss=0.6337 acc=68.67% f1=72.92% auc=71.10% val_score=53.6357 val_score_bestthr=66.0035 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.230, mb=0.498, no=0.997, corr=-0.145) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.5719 -> 66.0035
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2148 mb_mean=0.4974 norm_overlap=0.9995 corr_cb=-0.0222 topkJ=0.0577
[TRAIN][ep=031] loss=0.5971 acc=69.66%
[TRAIN][ep=031] mask_avg: mc_mean=0.2351 mb_mean=0.4982 norm_overlap=0.9966 corr_cb=-0.1509
[EPOCH 031/089] train: loss=0.5971 acc=69.66% | val: loss=0.6286 acc=69.88% f1=73.68% auc=71.69% val_score=55.7174 val_score_bestthr=67.5324 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.235, mb=0.498, no=0.997, corr=-0.151) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.5719 -> 67.5324
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1897 mb_mean=0.4974 norm_overlap=0.9991 corr_cb=-0.0430 topkJ=0.0410
[TRAIN][ep=032] loss=0.6022 acc=70.34%
[TRAIN][ep=032] mask_avg: mc_mean=0.2034 mb_mean=0.4982 norm_overlap=0.9963 corr_cb=-0.1515
[EPOCH 032/089] train: loss=0.6022 acc=70.34% | val: loss=0.6191 acc=68.67% f1=72.34% auc=71.28% val_score=56.9658 val_score_bestthr=68.6838 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.203, mb=0.498, no=0.996, corr=-0.151) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.5719 -> 68.6838
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2754 mb_mean=0.4964 norm_overlap=0.9975 corr_cb=-0.1519 topkJ=0.0443
[TRAIN][ep=033] loss=0.5993 acc=69.40%
[TRAIN][ep=033] mask_avg: mc_mean=0.2330 mb_mean=0.4982 norm_overlap=0.9964 corr_cb=-0.1568
[EPOCH 033/089] train: loss=0.5993 acc=69.40% | val: loss=0.6094 acc=69.88% f1=76.19% auc=72.27% val_score=57.5787 val_score_bestthr=68.4325 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.233, mb=0.498, no=0.996, corr=-0.157) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.5719 -> 68.4325
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2424 mb_mean=0.4971 norm_overlap=0.9973 corr_cb=-0.1189 topkJ=0.0433
[TRAIN][ep=034] loss=0.5975 acc=70.60%
[TRAIN][ep=034] mask_avg: mc_mean=0.2274 mb_mean=0.4982 norm_overlap=0.9964 corr_cb=-0.1588
[EPOCH 034/089] train: loss=0.5975 acc=70.60% | val: loss=0.6092 acc=69.88% f1=75.73% auc=72.03% val_score=59.7540 val_score_bestthr=69.8360 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.227, mb=0.498, no=0.996, corr=-0.159) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.5719 -> 69.8360
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2017 mb_mean=0.5006 norm_overlap=0.9962 corr_cb=-0.1589 topkJ=0.0195
[TRAIN][ep=035] loss=0.5914 acc=70.07%
[TRAIN][ep=035] mask_avg: mc_mean=0.2403 mb_mean=0.4982 norm_overlap=0.9964 corr_cb=-0.1614
[EPOCH 035/089] train: loss=0.5914 acc=70.07% | val: loss=0.6086 acc=69.88% f1=75.73% auc=72.15% val_score=56.2919 val_score_bestthr=69.8360 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.240, mb=0.498, no=0.996, corr=-0.161) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.5719 -> 69.8360
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2583 mb_mean=0.4984 norm_overlap=0.9950 corr_cb=-0.2311 topkJ=0.0291
[TRAIN][ep=036] loss=0.5916 acc=69.93%
[TRAIN][ep=036] mask_avg: mc_mean=0.2302 mb_mean=0.4982 norm_overlap=0.9963 corr_cb=-0.1620
[EPOCH 036/089] train: loss=0.5916 acc=69.93% | val: loss=0.6244 acc=67.47% f1=71.58% auc=71.40% val_score=53.6357 val_score_bestthr=66.9458 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.230, mb=0.498, no=0.996, corr=-0.162) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.5719 -> 66.9458
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.2493 mb_mean=0.4972 norm_overlap=0.9964 corr_cb=-0.1693 topkJ=0.0278
[TRAIN][ep=037] loss=0.5797 acc=71.54%
[TRAIN][ep=037] mask_avg: mc_mean=0.2388 mb_mean=0.4982 norm_overlap=0.9964 corr_cb=-0.1594
[EPOCH 037/089] train: loss=0.5797 acc=71.54% | val: loss=0.6078 acc=66.27% f1=75.00% auc=72.44% val_score=61.1842 val_score_bestthr=69.3203 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.239, mb=0.498, no=0.996, corr=-0.159) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.5719 -> 69.3203
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2364 mb_mean=0.4981 norm_overlap=0.9948 corr_cb=-0.2354 topkJ=0.0250
[TRAIN][ep=038] loss=0.5747 acc=72.21%
[TRAIN][ep=038] mask_avg: mc_mean=0.2220 mb_mean=0.4982 norm_overlap=0.9962 corr_cb=-0.1615
[EPOCH 038/089] train: loss=0.5747 acc=72.21% | val: loss=0.6065 acc=66.27% f1=75.00% auc=72.50% val_score=62.7126 val_score_bestthr=69.3203 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.222, mb=0.498, no=0.996, corr=-0.162) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 75.5719 -> 69.3203
[EARLY STOP] no improvement for 30 epochs. best_epoch=8
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
=============== FIT DONE ===============
[BEST] epoch=8 | val_acc=69.88% | val_f1=74.75% | val_auc=69.42% | val_score=61.3370 | val_score_bestthr=75.5719
[TEST@BEST] thr_used=0.545 | acc=62.32% f1=70.90% auc=66.11% | SP_sex=8.97% EO_sex=1.06% SP_age=4.47% EO_age=12.60%
[TIME] 1.03 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/summary_fold_2.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4409 mb_mean=0.4998 norm_overlap=0.9999 corr_cb=-0.1537 topkJ=0.0142
[TRAIN][ep=000] loss=0.6955 acc=48.46%
[TRAIN][ep=000] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2179
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4456 mb_mean=0.4977 norm_overlap=0.9998 corr_cb=-0.3429 topkJ=0.0084
[TRAIN][ep=001] loss=0.6931 acc=50.87%
[TRAIN][ep=001] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2197
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4416 mb_mean=0.4967 norm_overlap=1.0000 corr_cb=-0.0925 topkJ=0.0328
[TRAIN][ep=002] loss=0.6924 acc=51.01%
[TRAIN][ep=002] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2149
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4401 mb_mean=0.4989 norm_overlap=0.9997 corr_cb=-0.3682 topkJ=0.0059
[TRAIN][ep=003] loss=0.6912 acc=53.42%
[TRAIN][ep=003] mask_avg: mc_mean=0.4421 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2220
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4399 mb_mean=0.4974 norm_overlap=0.9999 corr_cb=-0.1290 topkJ=0.0272
[TRAIN][ep=004] loss=0.6899 acc=55.84%
[TRAIN][ep=004] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2177
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4388 mb_mean=0.4999 norm_overlap=0.9998 corr_cb=-0.3849 topkJ=0.0055
[TRAIN][ep=005] loss=0.6890 acc=51.95%
[TRAIN][ep=005] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2149
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4421 mb_mean=0.4993 norm_overlap=0.9998 corr_cb=-0.2996 topkJ=0.0246
[TRAIN][ep=006] loss=0.6863 acc=53.83%
[TRAIN][ep=006] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2113
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4448 mb_mean=0.4952 norm_overlap=1.0000 corr_cb=0.0093 topkJ=0.0332
[TRAIN][ep=007] loss=0.6844 acc=59.73%
[TRAIN][ep=007] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2179
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4400 mb_mean=0.4972 norm_overlap=1.0000 corr_cb=-0.0037 topkJ=0.0472
[TRAIN][ep=008] loss=0.6827 acc=59.87%
[TRAIN][ep=008] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2155
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4446 mb_mean=0.4966 norm_overlap=0.9999 corr_cb=-0.2381 topkJ=0.0197
[TRAIN][ep=009] loss=0.6776 acc=58.39%
[TRAIN][ep=009] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2154
================= FIT START (fold=2) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4430 mb_mean=0.4980 norm_overlap=1.0000 corr_cb=-0.1091 topkJ=0.0223
[TRAIN][ep=000] loss=0.6773 acc=57.72%
[TRAIN][ep=000] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2180
[EPOCH 000/089] train: loss=0.6773 acc=57.72% | val: loss=0.6728 acc=68.67% f1=75.47% auc=69.94% val_score=62.4000 val_score_bestthr=69.2917 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.218) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 69.2917
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4450 mb_mean=0.4972 norm_overlap=0.9999 corr_cb=-0.1381 topkJ=0.0336
[TRAIN][ep=001] loss=0.6748 acc=61.07%
[TRAIN][ep=001] mask_avg: mc_mean=0.4421 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2187
[EPOCH 001/089] train: loss=0.6748 acc=61.07% | val: loss=0.6700 acc=68.67% f1=71.74% auc=70.23% val_score=65.4056 val_score_bestthr=69.7543 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.219) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 69.2917 -> 69.7543
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4416 mb_mean=0.4970 norm_overlap=0.9999 corr_cb=-0.1910 topkJ=0.0291
[TRAIN][ep=002] loss=0.6693 acc=63.09%
[TRAIN][ep=002] mask_avg: mc_mean=0.4421 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2200
[EPOCH 002/089] train: loss=0.6693 acc=63.09% | val: loss=0.6673 acc=68.67% f1=71.74% auc=70.17% val_score=69.9572 val_score_bestthr=69.7543 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.220) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 69.7543 -> 69.7543
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4419 mb_mean=0.4995 norm_overlap=0.9998 corr_cb=-0.3017 topkJ=0.0204
[TRAIN][ep=003] loss=0.6659 acc=60.94%
[TRAIN][ep=003] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2169
[EPOCH 003/089] train: loss=0.6659 acc=60.94% | val: loss=0.6766 acc=68.67% f1=74.00% auc=69.42% val_score=61.3370 val_score_bestthr=74.7085 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.217) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 69.7543 -> 74.7085
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4404 mb_mean=0.4979 norm_overlap=0.9999 corr_cb=-0.1561 topkJ=0.0339
[TRAIN][ep=004] loss=0.6651 acc=61.48%
[TRAIN][ep=004] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2191
[EPOCH 004/089] train: loss=0.6651 acc=61.48% | val: loss=0.6612 acc=69.88% f1=76.64% auc=71.57% val_score=70.5879 val_score_bestthr=70.5879 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.219) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 74.7085 -> 70.5879
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4474 mb_mean=0.4984 norm_overlap=1.0000 corr_cb=-0.0752 topkJ=0.0199
[TRAIN][ep=005] loss=1.4388 acc=59.87%
[TRAIN][ep=005] mask_avg: mc_mean=0.3204 mb_mean=0.4982 norm_overlap=0.9991 corr_cb=-0.2573
[EPOCH 005/089] train: loss=1.4388 acc=59.87% | val: loss=0.6705 acc=66.27% f1=67.44% auc=69.07% val_score=55.4552 val_score_bestthr=66.6433 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.320, mb=0.498, no=0.999, corr=-0.257) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.7085 -> 66.6433
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2547 mb_mean=0.4984 norm_overlap=0.9986 corr_cb=-0.2138 topkJ=0.0237
[TRAIN][ep=006] loss=1.4272 acc=61.88%
[TRAIN][ep=006] mask_avg: mc_mean=0.2227 mb_mean=0.4982 norm_overlap=0.9984 corr_cb=-0.2389
[EPOCH 006/089] train: loss=1.4272 acc=61.88% | val: loss=0.6604 acc=72.29% f1=76.77% auc=71.34% val_score=62.0296 val_score_bestthr=71.7816 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.223, mb=0.498, no=0.998, corr=-0.239) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.7085 -> 71.7816
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2433 mb_mean=0.5001 norm_overlap=0.9982 corr_cb=-0.2524 topkJ=0.0491
[TRAIN][ep=007] loss=1.4214 acc=62.68%
[TRAIN][ep=007] mask_avg: mc_mean=0.1874 mb_mean=0.4982 norm_overlap=0.9980 corr_cb=-0.2327
[EPOCH 007/089] train: loss=1.4214 acc=62.68% | val: loss=0.6550 acc=71.08% f1=77.36% auc=72.38% val_score=62.0314 val_score_bestthr=74.3337 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.187, mb=0.498, no=0.998, corr=-0.233) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.7085 -> 74.3337
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1833 mb_mean=0.4984 norm_overlap=0.9984 corr_cb=-0.2112 topkJ=0.0456
[TRAIN][ep=008] loss=1.4089 acc=63.89%
[TRAIN][ep=008] mask_avg: mc_mean=0.1610 mb_mean=0.4982 norm_overlap=0.9977 corr_cb=-0.2136
[EPOCH 008/089] train: loss=1.4089 acc=63.89% | val: loss=0.6779 acc=69.88% f1=73.68% auc=70.06% val_score=61.3370 val_score_bestthr=70.4847 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.161, mb=0.498, no=0.998, corr=-0.214) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.7085 -> 70.4847
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1504 mb_mean=0.4974 norm_overlap=0.9975 corr_cb=-0.2392 topkJ=0.0251
[TRAIN][ep=009] loss=1.1996 acc=61.88%
[TRAIN][ep=009] mask_avg: mc_mean=0.1539 mb_mean=0.4982 norm_overlap=0.9973 corr_cb=-0.2247
[EPOCH 009/089] train: loss=1.1996 acc=61.88% | val: loss=0.6540 acc=68.67% f1=75.47% auc=71.57% val_score=70.4350 val_score_bestthr=69.8064 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.154, mb=0.498, no=0.997, corr=-0.225) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.7085 -> 69.8064
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1580 mb_mean=0.4962 norm_overlap=0.9961 corr_cb=-0.3219 topkJ=0.0223
[TRAIN][ep=010] loss=0.9738 acc=62.68%
[TRAIN][ep=010] mask_avg: mc_mean=0.1509 mb_mean=0.4982 norm_overlap=0.9969 corr_cb=-0.2433
[EPOCH 010/089] train: loss=0.9738 acc=62.68% | val: loss=0.6438 acc=71.08% f1=75.00% auc=71.57% val_score=66.1348 val_score_bestthr=71.5602 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.151, mb=0.498, no=0.997, corr=-0.243) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.7085 -> 71.5602
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1736 mb_mean=0.4990 norm_overlap=0.9969 corr_cb=-0.2754 topkJ=0.0245
[TRAIN][ep=011] loss=0.9212 acc=65.50%
[TRAIN][ep=011] mask_avg: mc_mean=0.1509 mb_mean=0.4982 norm_overlap=0.9968 corr_cb=-0.2221
[EPOCH 011/089] train: loss=0.9212 acc=65.50% | val: loss=0.6496 acc=68.67% f1=73.47% auc=70.12% val_score=56.6582 val_score_bestthr=70.3258 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.151, mb=0.498, no=0.997, corr=-0.222) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.7085 -> 70.3258
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1712 mb_mean=0.4965 norm_overlap=0.9987 corr_cb=-0.1018 topkJ=0.0675
[TRAIN][ep=012] loss=0.9001 acc=65.23%
[TRAIN][ep=012] mask_avg: mc_mean=0.1512 mb_mean=0.4982 norm_overlap=0.9967 corr_cb=-0.1970
[EPOCH 012/089] train: loss=0.9001 acc=65.23% | val: loss=0.6399 acc=69.88% f1=74.23% auc=71.51% val_score=59.7245 val_score_bestthr=70.7331 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.151, mb=0.498, no=0.997, corr=-0.197) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.7085 -> 70.7331
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.1022 mb_mean=0.5001 norm_overlap=0.9949 corr_cb=-0.2326 topkJ=0.0474
[TRAIN][ep=013] loss=0.8917 acc=66.98%
[TRAIN][ep=013] mask_avg: mc_mean=0.1581 mb_mean=0.4982 norm_overlap=0.9964 corr_cb=-0.2066
[EPOCH 013/089] train: loss=0.8917 acc=66.98% | val: loss=0.6299 acc=71.08% f1=74.47% auc=71.74% val_score=64.4413 val_score_bestthr=70.3531 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.158, mb=0.498, no=0.996, corr=-0.207) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.7085 -> 70.3531
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1957 mb_mean=0.4970 norm_overlap=0.9959 corr_cb=-0.2542 topkJ=0.0218
[TRAIN][ep=014] loss=0.8859 acc=67.11%
[TRAIN][ep=014] mask_avg: mc_mean=0.1780 mb_mean=0.4982 norm_overlap=0.9965 corr_cb=-0.1922
[EPOCH 014/089] train: loss=0.8859 acc=67.11% | val: loss=0.6352 acc=69.88% f1=74.23% auc=71.69% val_score=61.8453 val_score_bestthr=70.7331 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.178, mb=0.498, no=0.997, corr=-0.192) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.7085 -> 70.7331
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1551 mb_mean=0.4996 norm_overlap=0.9936 corr_cb=-0.3180 topkJ=0.0287
[TRAIN][ep=015] loss=0.8796 acc=67.52%
[TRAIN][ep=015] mask_avg: mc_mean=0.1608 mb_mean=0.4982 norm_overlap=0.9957 corr_cb=-0.2117
[EPOCH 015/089] train: loss=0.8796 acc=67.52% | val: loss=0.6318 acc=71.08% f1=74.47% auc=71.69% val_score=62.4943 val_score_bestthr=70.8137 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.161, mb=0.498, no=0.996, corr=-0.212) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.7085 -> 70.8137
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1760 mb_mean=0.4984 norm_overlap=0.9982 corr_cb=-0.0989 topkJ=0.0347
[TRAIN][ep=016] loss=0.8754 acc=68.19%
[TRAIN][ep=016] mask_avg: mc_mean=0.2002 mb_mean=0.4982 norm_overlap=0.9957 corr_cb=-0.2328
[EPOCH 016/089] train: loss=0.8754 acc=68.19% | val: loss=0.6288 acc=71.08% f1=74.47% auc=71.92% val_score=61.0877 val_score_bestthr=70.8137 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.200, mb=0.498, no=0.996, corr=-0.233) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.7085 -> 70.8137
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1712 mb_mean=0.4984 norm_overlap=0.9948 corr_cb=-0.2289 topkJ=0.0307
[TRAIN][ep=017] loss=0.8726 acc=66.17%
[TRAIN][ep=017] mask_avg: mc_mean=0.1694 mb_mean=0.4982 norm_overlap=0.9952 corr_cb=-0.2269
[EPOCH 017/089] train: loss=0.8726 acc=66.17% | val: loss=0.6189 acc=69.88% f1=75.73% auc=72.85% val_score=59.7227 val_score_bestthr=69.0413 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.169, mb=0.498, no=0.995, corr=-0.227) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.7085 -> 69.0413
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1591 mb_mean=0.4979 norm_overlap=0.9957 corr_cb=-0.1908 topkJ=0.0246
[TRAIN][ep=018] loss=0.8564 acc=69.13%
[TRAIN][ep=018] mask_avg: mc_mean=0.1831 mb_mean=0.4982 norm_overlap=0.9952 corr_cb=-0.2288
[EPOCH 018/089] train: loss=0.8564 acc=69.13% | val: loss=0.6218 acc=69.88% f1=73.68% auc=71.98% val_score=62.4943 val_score_bestthr=69.2824 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.183, mb=0.498, no=0.995, corr=-0.229) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.7085 -> 69.2824
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.2230 mb_mean=0.5006 norm_overlap=0.9947 corr_cb=-0.3068 topkJ=0.0207
[TRAIN][ep=019] loss=0.8672 acc=67.65%
[TRAIN][ep=019] mask_avg: mc_mean=0.2121 mb_mean=0.4982 norm_overlap=0.9950 corr_cb=-0.2532
[EPOCH 019/089] train: loss=0.8672 acc=67.65% | val: loss=0.6213 acc=69.88% f1=73.68% auc=72.44% val_score=62.4943 val_score_bestthr=69.2824 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.212, mb=0.498, no=0.995, corr=-0.253) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.7085 -> 69.2824
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.2343 mb_mean=0.4972 norm_overlap=0.9926 corr_cb=-0.3526 topkJ=0.0040
[TRAIN][ep=020] loss=0.8576 acc=67.79%
[TRAIN][ep=020] mask_avg: mc_mean=0.2035 mb_mean=0.4982 norm_overlap=0.9945 corr_cb=-0.2760
[EPOCH 020/089] train: loss=0.8576 acc=67.79% | val: loss=0.6129 acc=69.88% f1=75.25% auc=72.73% val_score=59.0472 val_score_bestthr=69.1460 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.204, mb=0.498, no=0.994, corr=-0.276) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.7085 -> 69.1460
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2322 mb_mean=0.4957 norm_overlap=0.9955 corr_cb=-0.2631 topkJ=0.0224
[TRAIN][ep=021] loss=0.8444 acc=69.80%
[TRAIN][ep=021] mask_avg: mc_mean=0.2029 mb_mean=0.4982 norm_overlap=0.9945 corr_cb=-0.2673
[EPOCH 021/089] train: loss=0.8444 acc=69.80% | val: loss=0.6111 acc=71.08% f1=76.00% auc=72.91% val_score=60.5782 val_score_bestthr=70.6726 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.203, mb=0.498, no=0.995, corr=-0.267) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.7085 -> 70.6726
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2182 mb_mean=0.4977 norm_overlap=0.9972 corr_cb=-0.1674 topkJ=0.0376
[TRAIN][ep=022] loss=0.8327 acc=71.28%
[TRAIN][ep=022] mask_avg: mc_mean=0.2089 mb_mean=0.4982 norm_overlap=0.9948 corr_cb=-0.2501
[EPOCH 022/089] train: loss=0.8327 acc=71.28% | val: loss=0.6249 acc=69.88% f1=73.68% auc=72.38% val_score=55.7174 val_score_bestthr=69.2824 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.209, mb=0.498, no=0.995, corr=-0.250) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.7085 -> 69.2824
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1802 mb_mean=0.4976 norm_overlap=0.9956 corr_cb=-0.1953 topkJ=0.0234
[TRAIN][ep=023] loss=0.8477 acc=69.13%
[TRAIN][ep=023] mask_avg: mc_mean=0.2158 mb_mean=0.4982 norm_overlap=0.9947 corr_cb=-0.2568
[EPOCH 023/089] train: loss=0.8477 acc=69.13% | val: loss=0.7023 acc=68.67% f1=75.00% auc=70.17% val_score=35.3364 val_score_bestthr=64.2499 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.216, mb=0.498, no=0.995, corr=-0.257) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.7085 -> 64.2499
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1922 mb_mean=0.4983 norm_overlap=0.9940 corr_cb=-0.2647 topkJ=0.0303
[TRAIN][ep=024] loss=0.8397 acc=70.87%
[TRAIN][ep=024] mask_avg: mc_mean=0.1916 mb_mean=0.4982 norm_overlap=0.9943 corr_cb=-0.2555
[EPOCH 024/089] train: loss=0.8397 acc=70.87% | val: loss=0.6175 acc=66.27% f1=75.00% auc=72.56% val_score=65.7267 val_score_bestthr=69.3203 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.192, mb=0.498, no=0.994, corr=-0.255) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.7085 -> 69.3203
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2384 mb_mean=0.4978 norm_overlap=0.9920 corr_cb=-0.3514 topkJ=0.0142
[TRAIN][ep=025] loss=0.8355 acc=70.60%
[TRAIN][ep=025] mask_avg: mc_mean=0.2059 mb_mean=0.4982 norm_overlap=0.9946 corr_cb=-0.2450
[EPOCH 025/089] train: loss=0.8355 acc=70.60% | val: loss=0.6066 acc=66.27% f1=75.44% auc=72.67% val_score=65.7483 val_score_bestthr=72.9864 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.206, mb=0.498, no=0.995, corr=-0.245) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.7085 -> 72.9864
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2314 mb_mean=0.4982 norm_overlap=0.9947 corr_cb=-0.2940 topkJ=0.0130
[TRAIN][ep=026] loss=0.8189 acc=72.08%
[TRAIN][ep=026] mask_avg: mc_mean=0.2316 mb_mean=0.4982 norm_overlap=0.9945 corr_cb=-0.2691
[EPOCH 026/089] train: loss=0.8189 acc=72.08% | val: loss=0.6028 acc=66.27% f1=75.00% auc=72.44% val_score=66.8973 val_score_bestthr=69.3203 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.232, mb=0.498, no=0.995, corr=-0.269) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.7085 -> 69.3203
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2412 mb_mean=0.4957 norm_overlap=0.9913 corr_cb=-0.3646 topkJ=0.0080
[TRAIN][ep=027] loss=0.8184 acc=72.48%
[TRAIN][ep=027] mask_avg: mc_mean=0.2133 mb_mean=0.4982 norm_overlap=0.9944 corr_cb=-0.2549
[EPOCH 027/089] train: loss=0.8184 acc=72.48% | val: loss=0.6159 acc=68.67% f1=72.34% auc=72.21% val_score=65.0443 val_score_bestthr=69.2785 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.213, mb=0.498, no=0.994, corr=-0.255) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.7085 -> 69.2785
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1782 mb_mean=0.5019 norm_overlap=0.9846 corr_cb=-0.4804 topkJ=0.0035
[TRAIN][ep=028] loss=0.8041 acc=73.29%
[TRAIN][ep=028] mask_avg: mc_mean=0.2221 mb_mean=0.4982 norm_overlap=0.9946 corr_cb=-0.2555
[EPOCH 028/089] train: loss=0.8041 acc=73.29% | val: loss=0.6990 acc=69.88% f1=73.12% auc=71.98% val_score=68.3578 val_score_bestthr=70.0527 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.222, mb=0.498, no=0.995, corr=-0.255) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.7085 -> 70.0527
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2352 mb_mean=0.4959 norm_overlap=0.9960 corr_cb=-0.2043 topkJ=0.0230
[TRAIN][ep=029] loss=0.8074 acc=74.09%
[TRAIN][ep=029] mask_avg: mc_mean=0.2128 mb_mean=0.4982 norm_overlap=0.9943 corr_cb=-0.2561
[EPOCH 029/089] train: loss=0.8074 acc=74.09% | val: loss=0.6102 acc=68.67% f1=71.11% auc=72.15% val_score=65.3440 val_score_bestthr=69.9370 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.213, mb=0.498, no=0.994, corr=-0.256) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.7085 -> 69.9370
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2196 mb_mean=0.4994 norm_overlap=0.9953 corr_cb=-0.2427 topkJ=0.0293
[TRAIN][ep=030] loss=0.8050 acc=72.35%
[TRAIN][ep=030] mask_avg: mc_mean=0.2259 mb_mean=0.4982 norm_overlap=0.9947 corr_cb=-0.2480
[EPOCH 030/089] train: loss=0.8050 acc=72.35% | val: loss=0.6331 acc=69.88% f1=73.68% auc=72.62% val_score=47.1518 val_score_bestthr=68.1984 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.226, mb=0.498, no=0.995, corr=-0.248) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.7085 -> 68.1984
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2116 mb_mean=0.4974 norm_overlap=0.9966 corr_cb=-0.1752 topkJ=0.0443
[TRAIN][ep=031] loss=0.7958 acc=73.02%
[TRAIN][ep=031] mask_avg: mc_mean=0.2256 mb_mean=0.4982 norm_overlap=0.9944 corr_cb=-0.2544
[EPOCH 031/089] train: loss=0.7958 acc=73.02% | val: loss=0.6059 acc=68.67% f1=70.45% auc=73.14% val_score=56.9658 val_score_bestthr=68.8253 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.226, mb=0.498, no=0.994, corr=-0.254) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.7085 -> 68.8253
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1204 mb_mean=0.4974 norm_overlap=0.9954 corr_cb=-0.1757 topkJ=0.0253
[TRAIN][ep=032] loss=0.8051 acc=73.56%
[TRAIN][ep=032] mask_avg: mc_mean=0.1629 mb_mean=0.4982 norm_overlap=0.9934 corr_cb=-0.2417
[EPOCH 032/089] train: loss=0.8051 acc=73.56% | val: loss=0.6114 acc=65.06% f1=74.34% auc=72.33% val_score=53.1848 val_score_bestthr=68.8909 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.163, mb=0.498, no=0.993, corr=-0.242) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.7085 -> 68.8909
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2737 mb_mean=0.4964 norm_overlap=0.9958 corr_cb=-0.2559 topkJ=0.0302
[TRAIN][ep=033] loss=0.7956 acc=73.83%
[TRAIN][ep=033] mask_avg: mc_mean=0.2264 mb_mean=0.4982 norm_overlap=0.9942 corr_cb=-0.2606
[EPOCH 033/089] train: loss=0.7956 acc=73.83% | val: loss=0.6213 acc=68.67% f1=75.93% auc=72.15% val_score=57.6819 val_score_bestthr=69.2803 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.226, mb=0.498, no=0.994, corr=-0.261) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.7085 -> 69.2803
[EARLY STOP] no improvement for 30 epochs. best_epoch=3
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
=============== FIT DONE ===============
[BEST] epoch=3 | val_acc=68.67% | val_f1=74.00% | val_auc=69.42% | val_score=61.3370 | val_score_bestthr=74.7085
[TEST@BEST] thr_used=0.560 | acc=60.87% f1=69.43% auc=65.18% | SP_sex=14.15% EO_sex=4.59% SP_age=0.58% EO_age=12.85%
[TIME] 0.79 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/summary_fold_2.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4409 mb_mean=0.4998 norm_overlap=0.9999 corr_cb=-0.1537 topkJ=0.0142
[TRAIN][ep=000] loss=0.6955 acc=48.46%
[TRAIN][ep=000] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2179
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4456 mb_mean=0.4977 norm_overlap=0.9998 corr_cb=-0.3429 topkJ=0.0084
[TRAIN][ep=001] loss=0.6931 acc=50.87%
[TRAIN][ep=001] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2197
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4416 mb_mean=0.4967 norm_overlap=1.0000 corr_cb=-0.0925 topkJ=0.0328
[TRAIN][ep=002] loss=0.6924 acc=51.14%
[TRAIN][ep=002] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2149
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4401 mb_mean=0.4989 norm_overlap=0.9997 corr_cb=-0.3682 topkJ=0.0059
[TRAIN][ep=003] loss=0.6912 acc=53.56%
[TRAIN][ep=003] mask_avg: mc_mean=0.4421 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2220
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4399 mb_mean=0.4974 norm_overlap=0.9999 corr_cb=-0.1290 topkJ=0.0272
[TRAIN][ep=004] loss=0.6899 acc=55.97%
[TRAIN][ep=004] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2177
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4388 mb_mean=0.4999 norm_overlap=0.9998 corr_cb=-0.3849 topkJ=0.0055
[TRAIN][ep=005] loss=0.6890 acc=51.95%
[TRAIN][ep=005] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2149
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4421 mb_mean=0.4993 norm_overlap=0.9998 corr_cb=-0.2996 topkJ=0.0246
[TRAIN][ep=006] loss=0.6863 acc=53.83%
[TRAIN][ep=006] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2113
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4448 mb_mean=0.4952 norm_overlap=1.0000 corr_cb=0.0093 topkJ=0.0332
[TRAIN][ep=007] loss=0.6844 acc=59.73%
[TRAIN][ep=007] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2179
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4400 mb_mean=0.4972 norm_overlap=1.0000 corr_cb=-0.0037 topkJ=0.0472
[TRAIN][ep=008] loss=0.6827 acc=59.87%
[TRAIN][ep=008] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2155
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4446 mb_mean=0.4966 norm_overlap=0.9999 corr_cb=-0.2381 topkJ=0.0197
[TRAIN][ep=009] loss=0.6776 acc=58.26%
[TRAIN][ep=009] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2154
================= FIT START (fold=2) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.45 select_by=val_score_bestthr | eval_thr_mode=fixed eval_thr_grid=coarse | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4430 mb_mean=0.4980 norm_overlap=1.0000 corr_cb=-0.1091 topkJ=0.0223
[TRAIN][ep=000] loss=0.6773 acc=57.58%
[TRAIN][ep=000] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2180
[EPOCH 000/089] train: loss=0.6773 acc=57.58% | val: loss=0.6727 acc=51.81% f1=68.25% auc=69.94% val_score=62.0453 val_score_bestthr=62.0453 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.218) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 62.0453
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4450 mb_mean=0.4972 norm_overlap=0.9999 corr_cb=-0.1381 topkJ=0.0336
[TRAIN][ep=001] loss=0.6749 acc=61.07%
[TRAIN][ep=001] mask_avg: mc_mean=0.4421 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2187
[EPOCH 001/089] train: loss=0.6749 acc=61.07% | val: loss=0.6700 acc=50.60% f1=67.20% auc=70.23% val_score=55.8921 val_score_bestthr=55.8921 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.219) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 55.8921
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4416 mb_mean=0.4970 norm_overlap=0.9999 corr_cb=-0.1910 topkJ=0.0291
[TRAIN][ep=002] loss=0.6693 acc=63.09%
[TRAIN][ep=002] mask_avg: mc_mean=0.4421 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2200
[EPOCH 002/089] train: loss=0.6693 acc=63.09% | val: loss=0.6673 acc=50.60% f1=67.20% auc=70.17% val_score=55.8921 val_score_bestthr=55.8921 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.220) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 55.8921
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4419 mb_mean=0.4995 norm_overlap=0.9998 corr_cb=-0.3017 topkJ=0.0204
[TRAIN][ep=003] loss=0.6659 acc=60.94%
[TRAIN][ep=003] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2169
[EPOCH 003/089] train: loss=0.6659 acc=60.94% | val: loss=0.6766 acc=51.81% f1=68.25% auc=69.42% val_score=62.0453 val_score_bestthr=62.0453 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.217) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 62.0453
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4404 mb_mean=0.4979 norm_overlap=0.9999 corr_cb=-0.1561 topkJ=0.0339
[TRAIN][ep=004] loss=0.6651 acc=61.48%
[TRAIN][ep=004] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2191
[EPOCH 004/089] train: loss=0.6651 acc=61.48% | val: loss=0.6612 acc=50.60% f1=67.20% auc=71.57% val_score=55.8921 val_score_bestthr=55.8921 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.219) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 55.8921
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4474 mb_mean=0.4984 norm_overlap=1.0000 corr_cb=-0.0752 topkJ=0.0199
[TRAIN][ep=005] loss=1.4388 acc=59.87%
[TRAIN][ep=005] mask_avg: mc_mean=0.3204 mb_mean=0.4982 norm_overlap=0.9991 corr_cb=-0.2572
[EPOCH 005/089] train: loss=1.4388 acc=59.87% | val: loss=0.6704 acc=68.67% f1=72.92% auc=69.13% val_score=60.5466 val_score_bestthr=60.5466 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.320, mb=0.498, no=0.999, corr=-0.257) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 60.5466
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2548 mb_mean=0.4984 norm_overlap=0.9986 corr_cb=-0.2138 topkJ=0.0237
[TRAIN][ep=006] loss=1.1987 acc=61.88%
[TRAIN][ep=006] mask_avg: mc_mean=0.2234 mb_mean=0.4982 norm_overlap=0.9984 corr_cb=-0.2364
[EPOCH 006/089] train: loss=1.1987 acc=61.88% | val: loss=0.6602 acc=65.06% f1=73.39% auc=71.16% val_score=61.5880 val_score_bestthr=61.5880 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.223, mb=0.498, no=0.998, corr=-0.236) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.0453 -> 61.5880
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2448 mb_mean=0.5001 norm_overlap=0.9983 corr_cb=-0.2508 topkJ=0.0482
[TRAIN][ep=007] loss=0.9740 acc=63.36%
[TRAIN][ep=007] mask_avg: mc_mean=0.1900 mb_mean=0.4982 norm_overlap=0.9981 corr_cb=-0.2219
[EPOCH 007/089] train: loss=0.9740 acc=63.36% | val: loss=0.6537 acc=59.04% f1=71.19% auc=72.21% val_score=63.4866 val_score_bestthr=63.4866 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.040, stage2=False) | mask(mc=0.190, mb=0.498, no=0.998, corr=-0.222) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 62.0453 -> 63.4866
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1864 mb_mean=0.4984 norm_overlap=0.9986 corr_cb=-0.1940 topkJ=0.0469
[TRAIN][ep=008] loss=1.0498 acc=64.56%
[TRAIN][ep=008] mask_avg: mc_mean=0.1634 mb_mean=0.4982 norm_overlap=0.9979 corr_cb=-0.1939
[EPOCH 008/089] train: loss=1.0498 acc=64.56% | val: loss=0.6753 acc=51.81% f1=68.25% auc=70.23% val_score=62.0453 val_score_bestthr=62.0453 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.080, stage2=False) | mask(mc=0.163, mb=0.498, no=0.998, corr=-0.194) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.4866 -> 62.0453
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1536 mb_mean=0.4974 norm_overlap=0.9976 corr_cb=-0.2204 topkJ=0.0247
[TRAIN][ep=009] loss=1.1416 acc=61.34%
[TRAIN][ep=009] mask_avg: mc_mean=0.1544 mb_mean=0.4982 norm_overlap=0.9974 corr_cb=-0.2088
[EPOCH 009/089] train: loss=1.1416 acc=61.34% | val: loss=0.6534 acc=53.01% f1=68.29% auc=71.40% val_score=56.5406 val_score_bestthr=56.5406 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.120, stage2=False) | mask(mc=0.154, mb=0.498, no=0.997, corr=-0.209) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.4866 -> 56.5406
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1563 mb_mean=0.4962 norm_overlap=0.9962 corr_cb=-0.3075 topkJ=0.0235
[TRAIN][ep=010] loss=1.2180 acc=62.01%
[TRAIN][ep=010] mask_avg: mc_mean=0.1437 mb_mean=0.4982 norm_overlap=0.9968 corr_cb=-0.2362
[EPOCH 010/089] train: loss=1.2180 acc=62.01% | val: loss=0.6438 acc=65.06% f1=74.34% auc=72.09% val_score=70.4350 val_score_bestthr=70.4350 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.160, stage2=False) | mask(mc=0.144, mb=0.498, no=0.997, corr=-0.236) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 63.4866 -> 70.4350
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1646 mb_mean=0.4990 norm_overlap=0.9966 corr_cb=-0.2814 topkJ=0.0237
[TRAIN][ep=011] loss=1.2980 acc=65.64%
[TRAIN][ep=011] mask_avg: mc_mean=0.1428 mb_mean=0.4982 norm_overlap=0.9965 corr_cb=-0.2324
[EPOCH 011/089] train: loss=1.2980 acc=65.64% | val: loss=0.6502 acc=63.86% f1=65.12% auc=70.35% val_score=63.4960 val_score_bestthr=63.4960 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.143, mb=0.498, no=0.996, corr=-0.232) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.4350 -> 63.4960
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1608 mb_mean=0.4965 norm_overlap=0.9985 corr_cb=-0.1165 topkJ=0.0684
[TRAIN][ep=012] loss=1.3738 acc=63.89%
[TRAIN][ep=012] mask_avg: mc_mean=0.1412 mb_mean=0.4982 norm_overlap=0.9962 corr_cb=-0.2152
[EPOCH 012/089] train: loss=1.3738 acc=63.89% | val: loss=0.6397 acc=69.88% f1=72.53% auc=72.15% val_score=68.3870 val_score_bestthr=68.3870 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.141, mb=0.498, no=0.996, corr=-0.215) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.4350 -> 68.3870
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.0933 mb_mean=0.5001 norm_overlap=0.9941 corr_cb=-0.2582 topkJ=0.0407
[TRAIN][ep=013] loss=1.3765 acc=67.38%
[TRAIN][ep=013] mask_avg: mc_mean=0.1501 mb_mean=0.4982 norm_overlap=0.9959 corr_cb=-0.2280
[EPOCH 013/089] train: loss=1.3765 acc=67.38% | val: loss=0.6308 acc=71.08% f1=76.47% auc=71.98% val_score=69.4341 val_score_bestthr=69.4341 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.150, mb=0.498, no=0.996, corr=-0.228) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.4350 -> 69.4341
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1896 mb_mean=0.4970 norm_overlap=0.9956 corr_cb=-0.2702 topkJ=0.0206
[TRAIN][ep=014] loss=1.3713 acc=65.91%
[TRAIN][ep=014] mask_avg: mc_mean=0.1718 mb_mean=0.4982 norm_overlap=0.9961 corr_cb=-0.2139
[EPOCH 014/089] train: loss=1.3713 acc=65.91% | val: loss=0.6346 acc=63.86% f1=65.12% auc=72.03% val_score=52.4668 val_score_bestthr=52.4668 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.172, mb=0.498, no=0.996, corr=-0.214) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.4350 -> 52.4668
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1472 mb_mean=0.4996 norm_overlap=0.9930 corr_cb=-0.3418 topkJ=0.0279
[TRAIN][ep=015] loss=1.3650 acc=67.38%
[TRAIN][ep=015] mask_avg: mc_mean=0.1563 mb_mean=0.4982 norm_overlap=0.9953 corr_cb=-0.2321
[EPOCH 015/089] train: loss=1.3650 acc=67.38% | val: loss=0.6352 acc=62.65% f1=62.65% auc=71.80% val_score=56.3942 val_score_bestthr=56.3942 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.156, mb=0.498, no=0.995, corr=-0.232) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.4350 -> 56.3942
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1718 mb_mean=0.4984 norm_overlap=0.9979 corr_cb=-0.1175 topkJ=0.0326
[TRAIN][ep=016] loss=1.1479 acc=69.26%
[TRAIN][ep=016] mask_avg: mc_mean=0.1981 mb_mean=0.4982 norm_overlap=0.9954 corr_cb=-0.2504
[EPOCH 016/089] train: loss=1.1479 acc=69.26% | val: loss=0.6290 acc=65.06% f1=65.88% auc=71.92% val_score=53.5776 val_score_bestthr=53.5776 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.198, mb=0.498, no=0.995, corr=-0.250) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.4350 -> 53.5776
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1729 mb_mean=0.4984 norm_overlap=0.9946 corr_cb=-0.2352 topkJ=0.0290
[TRAIN][ep=017] loss=0.9297 acc=65.64%
[TRAIN][ep=017] mask_avg: mc_mean=0.1715 mb_mean=0.4982 norm_overlap=0.9950 corr_cb=-0.2367
[EPOCH 017/089] train: loss=0.9297 acc=65.64% | val: loss=0.6183 acc=68.67% f1=75.00% auc=72.79% val_score=68.0330 val_score_bestthr=68.0330 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.172, mb=0.498, no=0.995, corr=-0.237) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.4350 -> 68.0330
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1591 mb_mean=0.4979 norm_overlap=0.9955 corr_cb=-0.1993 topkJ=0.0242
[TRAIN][ep=018] loss=0.8693 acc=69.13%
[TRAIN][ep=018] mask_avg: mc_mean=0.1842 mb_mean=0.4982 norm_overlap=0.9951 corr_cb=-0.2324
[EPOCH 018/089] train: loss=0.8693 acc=69.13% | val: loss=0.6217 acc=65.06% f1=66.67% auc=72.09% val_score=57.0475 val_score_bestthr=57.0475 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.184, mb=0.498, no=0.995, corr=-0.232) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.4350 -> 57.0475
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.2236 mb_mean=0.5006 norm_overlap=0.9946 corr_cb=-0.3084 topkJ=0.0207
[TRAIN][ep=019] loss=0.8665 acc=67.92%
[TRAIN][ep=019] mask_avg: mc_mean=0.2120 mb_mean=0.4982 norm_overlap=0.9950 corr_cb=-0.2509
[EPOCH 019/089] train: loss=0.8665 acc=67.92% | val: loss=0.6200 acc=66.27% f1=68.18% auc=72.38% val_score=59.0774 val_score_bestthr=59.0774 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.212, mb=0.498, no=0.995, corr=-0.251) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.4350 -> 59.0774
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.2335 mb_mean=0.4972 norm_overlap=0.9926 corr_cb=-0.3508 topkJ=0.0040
[TRAIN][ep=020] loss=0.8570 acc=67.65%
[TRAIN][ep=020] mask_avg: mc_mean=0.2028 mb_mean=0.4982 norm_overlap=0.9945 corr_cb=-0.2716
[EPOCH 020/089] train: loss=0.8570 acc=67.65% | val: loss=0.6129 acc=67.47% f1=73.79% auc=72.79% val_score=66.7293 val_score_bestthr=66.7293 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.203, mb=0.498, no=0.994, corr=-0.272) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.4350 -> 66.7293
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2340 mb_mean=0.4957 norm_overlap=0.9956 corr_cb=-0.2523 topkJ=0.0241
[TRAIN][ep=021] loss=0.8435 acc=69.93%
[TRAIN][ep=021] mask_avg: mc_mean=0.2037 mb_mean=0.4982 norm_overlap=0.9945 corr_cb=-0.2630
[EPOCH 021/089] train: loss=0.8435 acc=69.93% | val: loss=0.6112 acc=69.88% f1=75.25% auc=72.85% val_score=69.1460 val_score_bestthr=69.1460 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.204, mb=0.498, no=0.995, corr=-0.263) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.4350 -> 69.1460
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2205 mb_mean=0.4977 norm_overlap=0.9972 corr_cb=-0.1652 topkJ=0.0376
[TRAIN][ep=022] loss=0.8317 acc=71.41%
[TRAIN][ep=022] mask_avg: mc_mean=0.2110 mb_mean=0.4982 norm_overlap=0.9948 corr_cb=-0.2453
[EPOCH 022/089] train: loss=0.8317 acc=71.41% | val: loss=0.6242 acc=68.67% f1=67.50% auc=72.27% val_score=60.8079 val_score_bestthr=60.8079 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.211, mb=0.498, no=0.995, corr=-0.245) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.4350 -> 60.8079
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1817 mb_mean=0.4976 norm_overlap=0.9957 corr_cb=-0.1888 topkJ=0.0234
[TRAIN][ep=023] loss=0.8467 acc=69.40%
[TRAIN][ep=023] mask_avg: mc_mean=0.2156 mb_mean=0.4982 norm_overlap=0.9948 corr_cb=-0.2495
[EPOCH 023/089] train: loss=0.8467 acc=69.40% | val: loss=0.7019 acc=59.04% f1=51.43% auc=70.52% val_score=44.3863 val_score_bestthr=44.3863 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.216, mb=0.498, no=0.995, corr=-0.249) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.4350 -> 44.3863
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1960 mb_mean=0.4983 norm_overlap=0.9941 corr_cb=-0.2561 topkJ=0.0298
[TRAIN][ep=024] loss=0.8384 acc=70.74%
[TRAIN][ep=024] mask_avg: mc_mean=0.1938 mb_mean=0.4982 norm_overlap=0.9944 corr_cb=-0.2484
[EPOCH 024/089] train: loss=0.8384 acc=70.74% | val: loss=0.6171 acc=63.86% f1=72.73% auc=72.67% val_score=63.2867 val_score_bestthr=63.2867 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.194, mb=0.498, no=0.994, corr=-0.248) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.4350 -> 63.2867
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2385 mb_mean=0.4978 norm_overlap=0.9920 corr_cb=-0.3465 topkJ=0.0137
[TRAIN][ep=025] loss=0.8352 acc=70.74%
[TRAIN][ep=025] mask_avg: mc_mean=0.2078 mb_mean=0.4982 norm_overlap=0.9947 corr_cb=-0.2375
[EPOCH 025/089] train: loss=0.8352 acc=70.74% | val: loss=0.6072 acc=65.06% f1=71.84% auc=72.33% val_score=64.2073 val_score_bestthr=64.2073 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.208, mb=0.498, no=0.995, corr=-0.238) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.4350 -> 64.2073
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2345 mb_mean=0.4982 norm_overlap=0.9947 corr_cb=-0.2894 topkJ=0.0126
[TRAIN][ep=026] loss=0.8180 acc=72.21%
[TRAIN][ep=026] mask_avg: mc_mean=0.2324 mb_mean=0.4982 norm_overlap=0.9946 corr_cb=-0.2609
[EPOCH 026/089] train: loss=0.8180 acc=72.21% | val: loss=0.6030 acc=65.06% f1=70.10% auc=72.38% val_score=61.3875 val_score_bestthr=61.3875 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.232, mb=0.498, no=0.995, corr=-0.261) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.4350 -> 61.3875
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2449 mb_mean=0.4957 norm_overlap=0.9914 corr_cb=-0.3593 topkJ=0.0076
[TRAIN][ep=027] loss=0.8174 acc=72.89%
[TRAIN][ep=027] mask_avg: mc_mean=0.2156 mb_mean=0.4982 norm_overlap=0.9946 corr_cb=-0.2463
[EPOCH 027/089] train: loss=0.8174 acc=72.89% | val: loss=0.6163 acc=62.65% f1=71.03% auc=72.09% val_score=62.5985 val_score_bestthr=62.5985 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.216, mb=0.498, no=0.995, corr=-0.246) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 70.4350 -> 62.5985
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1798 mb_mean=0.5019 norm_overlap=0.9848 corr_cb=-0.4709 topkJ=0.0039
[TRAIN][ep=028] loss=0.8030 acc=73.29%
[TRAIN][ep=028] mask_avg: mc_mean=0.2228 mb_mean=0.4982 norm_overlap=0.9947 corr_cb=-0.2457
[EPOCH 028/089] train: loss=0.8030 acc=73.29% | val: loss=0.6996 acc=63.86% f1=74.14% auc=71.69% val_score=72.1678 val_score_bestthr=72.1678 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.223, mb=0.498, no=0.995, corr=-0.246) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 70.4350 -> 72.1678
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2347 mb_mean=0.4959 norm_overlap=0.9961 corr_cb=-0.1933 topkJ=0.0246
[TRAIN][ep=029] loss=0.8935 acc=74.09%
[TRAIN][ep=029] mask_avg: mc_mean=0.2110 mb_mean=0.4982 norm_overlap=0.9945 corr_cb=-0.2458
[EPOCH 029/089] train: loss=0.8935 acc=74.09% | val: loss=0.6101 acc=67.47% f1=73.27% auc=71.98% val_score=65.0443 val_score_bestthr=65.0443 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.211, mb=0.498, no=0.994, corr=-0.246) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1678 -> 65.0443
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2191 mb_mean=0.4994 norm_overlap=0.9954 corr_cb=-0.2336 topkJ=0.0309
[TRAIN][ep=030] loss=0.9762 acc=71.81%
[TRAIN][ep=030] mask_avg: mc_mean=0.2242 mb_mean=0.4982 norm_overlap=0.9948 corr_cb=-0.2377
[EPOCH 030/089] train: loss=0.9762 acc=71.81% | val: loss=0.6329 acc=65.06% f1=62.34% auc=72.44% val_score=57.7917 val_score_bestthr=57.7917 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.224, mb=0.498, no=0.995, corr=-0.238) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1678 -> 57.7917
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2143 mb_mean=0.4974 norm_overlap=0.9967 corr_cb=-0.1682 topkJ=0.0452
[TRAIN][ep=031] loss=1.0510 acc=72.75%
[TRAIN][ep=031] mask_avg: mc_mean=0.2261 mb_mean=0.4982 norm_overlap=0.9945 corr_cb=-0.2450
[EPOCH 031/089] train: loss=1.0510 acc=72.75% | val: loss=0.6063 acc=69.88% f1=70.59% auc=73.20% val_score=68.5949 val_score_bestthr=68.5949 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.226, mb=0.498, no=0.994, corr=-0.245) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1678 -> 68.5949
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.1141 mb_mean=0.4974 norm_overlap=0.9954 corr_cb=-0.1660 topkJ=0.0265
[TRAIN][ep=032] loss=1.1442 acc=73.56%
[TRAIN][ep=032] mask_avg: mc_mean=0.1572 mb_mean=0.4982 norm_overlap=0.9935 corr_cb=-0.2294
[EPOCH 032/089] train: loss=1.1442 acc=73.56% | val: loss=0.6144 acc=67.47% f1=68.97% auc=71.98% val_score=65.3304 val_score_bestthr=65.3304 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.157, mb=0.498, no=0.993, corr=-0.229) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1678 -> 65.3304
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2778 mb_mean=0.4964 norm_overlap=0.9959 corr_cb=-0.2482 topkJ=0.0294
[TRAIN][ep=033] loss=1.2135 acc=73.15%
[TRAIN][ep=033] mask_avg: mc_mean=0.2265 mb_mean=0.4982 norm_overlap=0.9943 corr_cb=-0.2510
[EPOCH 033/089] train: loss=1.2135 acc=73.15% | val: loss=0.6228 acc=63.86% f1=62.50% auc=72.27% val_score=51.6819 val_score_bestthr=51.6819 | dyn(w_pfs=0.100, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.227, mb=0.498, no=0.994, corr=-0.251) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1678 -> 51.6819
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2279 mb_mean=0.4971 norm_overlap=0.9947 corr_cb=-0.2236 topkJ=0.0251
[TRAIN][ep=034] loss=1.0023 acc=73.56%
[TRAIN][ep=034] mask_avg: mc_mean=0.2261 mb_mean=0.4982 norm_overlap=0.9944 corr_cb=-0.2506
[EPOCH 034/089] train: loss=1.0023 acc=73.56% | val: loss=0.6053 acc=65.06% f1=68.82% auc=72.27% val_score=64.0339 val_score_bestthr=64.0339 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.226, mb=0.498, no=0.994, corr=-0.251) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1678 -> 64.0339
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2065 mb_mean=0.5006 norm_overlap=0.9945 corr_cb=-0.2495 topkJ=0.0117
[TRAIN][ep=035] loss=0.7817 acc=74.09%
[TRAIN][ep=035] mask_avg: mc_mean=0.2399 mb_mean=0.4982 norm_overlap=0.9945 corr_cb=-0.2541
[EPOCH 035/089] train: loss=0.7817 acc=74.09% | val: loss=0.6030 acc=65.06% f1=68.82% auc=72.27% val_score=64.0339 val_score_bestthr=64.0339 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.240, mb=0.498, no=0.994, corr=-0.254) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1678 -> 64.0339
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2314 mb_mean=0.4984 norm_overlap=0.9922 corr_cb=-0.3324 topkJ=0.0160
[TRAIN][ep=036] loss=0.7823 acc=72.48%
[TRAIN][ep=036] mask_avg: mc_mean=0.2258 mb_mean=0.4982 norm_overlap=0.9944 corr_cb=-0.2463
[EPOCH 036/089] train: loss=0.7823 acc=72.48% | val: loss=0.6374 acc=62.65% f1=59.74% auc=72.27% val_score=55.5902 val_score_bestthr=55.5902 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.226, mb=0.498, no=0.994, corr=-0.246) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1678 -> 55.5902
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.2416 mb_mean=0.4972 norm_overlap=0.9956 corr_cb=-0.2065 topkJ=0.0200
[TRAIN][ep=037] loss=0.7644 acc=75.70%
[TRAIN][ep=037] mask_avg: mc_mean=0.2398 mb_mean=0.4982 norm_overlap=0.9948 corr_cb=-0.2338
[EPOCH 037/089] train: loss=0.7644 acc=75.70% | val: loss=0.6214 acc=65.06% f1=71.29% auc=72.15% val_score=63.4598 val_score_bestthr=63.4598 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.240, mb=0.498, no=0.995, corr=-0.234) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1678 -> 63.4598
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2290 mb_mean=0.4981 norm_overlap=0.9936 corr_cb=-0.2863 topkJ=0.0191
[TRAIN][ep=038] loss=0.7617 acc=75.70%
[TRAIN][ep=038] mask_avg: mc_mean=0.2212 mb_mean=0.4982 norm_overlap=0.9946 corr_cb=-0.2314
[EPOCH 038/089] train: loss=0.7617 acc=75.70% | val: loss=0.6168 acc=62.65% f1=68.69% auc=71.74% val_score=61.4763 val_score_bestthr=61.4763 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.221, mb=0.498, no=0.995, corr=-0.231) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1678 -> 61.4763
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2750 mb_mean=0.4977 norm_overlap=0.9965 corr_cb=-0.2112 topkJ=0.0198
[TRAIN][ep=039] loss=0.7574 acc=76.38%
[TRAIN][ep=039] mask_avg: mc_mean=0.2479 mb_mean=0.4982 norm_overlap=0.9950 corr_cb=-0.2280
[EPOCH 039/089] train: loss=0.7574 acc=76.38% | val: loss=0.6177 acc=61.45% f1=67.35% auc=71.86% val_score=58.1229 val_score_bestthr=58.1229 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.248, mb=0.498, no=0.995, corr=-0.228) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1678 -> 58.1229
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.2783 mb_mean=0.4960 norm_overlap=0.9959 corr_cb=-0.2132 topkJ=0.0205
[TRAIN][ep=040] loss=0.7650 acc=77.05%
[TRAIN][ep=040] mask_avg: mc_mean=0.2483 mb_mean=0.4982 norm_overlap=0.9950 corr_cb=-0.2248
[EPOCH 040/089] train: loss=0.7650 acc=77.05% | val: loss=0.6188 acc=61.45% f1=66.67% auc=71.92% val_score=59.4576 val_score_bestthr=59.4576 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.248, mb=0.498, no=0.995, corr=-0.225) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1678 -> 59.4576
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.2346 mb_mean=0.4988 norm_overlap=0.9940 corr_cb=-0.2848 topkJ=0.0191
[TRAIN][ep=041] loss=0.7519 acc=75.03%
[TRAIN][ep=041] mask_avg: mc_mean=0.2340 mb_mean=0.4982 norm_overlap=0.9949 corr_cb=-0.2231
[EPOCH 041/089] train: loss=0.7519 acc=75.03% | val: loss=0.6456 acc=62.65% f1=61.73% auc=72.15% val_score=50.5703 val_score_bestthr=50.5703 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.234, mb=0.498, no=0.995, corr=-0.223) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1678 -> 50.5703
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.3041 mb_mean=0.4974 norm_overlap=0.9948 corr_cb=-0.2771 topkJ=0.0144
[TRAIN][ep=042] loss=0.7517 acc=76.78%
[TRAIN][ep=042] mask_avg: mc_mean=0.2306 mb_mean=0.4982 norm_overlap=0.9950 corr_cb=-0.2149
[EPOCH 042/089] train: loss=0.7517 acc=76.78% | val: loss=0.6171 acc=63.86% f1=67.39% auc=71.57% val_score=63.2130 val_score_bestthr=63.2130 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.231, mb=0.498, no=0.995, corr=-0.215) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1678 -> 63.2130
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.2633 mb_mean=0.4988 norm_overlap=0.9930 corr_cb=-0.2987 topkJ=0.0130
[TRAIN][ep=043] loss=0.7401 acc=75.97%
[TRAIN][ep=043] mask_avg: mc_mean=0.2440 mb_mean=0.4982 norm_overlap=0.9952 corr_cb=-0.2121
[EPOCH 043/089] train: loss=0.7401 acc=75.97% | val: loss=0.6201 acc=63.86% f1=68.75% auc=72.15% val_score=63.5937 val_score_bestthr=63.5937 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.244, mb=0.498, no=0.995, corr=-0.212) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1678 -> 63.5937
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2261 mb_mean=0.4974 norm_overlap=0.9957 corr_cb=-0.1771 topkJ=0.0447
[TRAIN][ep=044] loss=0.7396 acc=77.05%
[TRAIN][ep=044] mask_avg: mc_mean=0.2486 mb_mean=0.4982 norm_overlap=0.9951 corr_cb=-0.2180
[EPOCH 044/089] train: loss=0.7396 acc=77.05% | val: loss=0.6736 acc=65.06% f1=72.90% auc=71.57% val_score=66.7879 val_score_bestthr=66.7879 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.249, mb=0.498, no=0.995, corr=-0.218) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1678 -> 66.7879
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2127 mb_mean=0.4977 norm_overlap=0.9944 corr_cb=-0.2480 topkJ=0.0324
[TRAIN][ep=045] loss=0.7342 acc=76.64%
[TRAIN][ep=045] mask_avg: mc_mean=0.2508 mb_mean=0.4982 norm_overlap=0.9952 corr_cb=-0.2165
[EPOCH 045/089] train: loss=0.7342 acc=76.64% | val: loss=0.6318 acc=63.86% f1=63.41% auc=72.50% val_score=56.2914 val_score_bestthr=56.2914 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.251, mb=0.498, no=0.995, corr=-0.216) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1678 -> 56.2914
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.2274 mb_mean=0.4994 norm_overlap=0.9926 corr_cb=-0.3088 topkJ=0.0128
[TRAIN][ep=046] loss=0.7275 acc=76.91%
[TRAIN][ep=046] mask_avg: mc_mean=0.2367 mb_mean=0.4982 norm_overlap=0.9950 corr_cb=-0.2143
[EPOCH 046/089] train: loss=0.7275 acc=76.91% | val: loss=0.6245 acc=63.86% f1=66.67% auc=72.27% val_score=63.7911 val_score_bestthr=63.7911 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.237, mb=0.498, no=0.995, corr=-0.214) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1678 -> 63.7911
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.2150 mb_mean=0.5000 norm_overlap=0.9917 corr_cb=-0.3250 topkJ=0.0132
[TRAIN][ep=047] loss=0.7219 acc=79.19%
[TRAIN][ep=047] mask_avg: mc_mean=0.2695 mb_mean=0.4982 norm_overlap=0.9956 corr_cb=-0.2031
[EPOCH 047/089] train: loss=0.7219 acc=79.19% | val: loss=0.6395 acc=63.86% f1=69.39% auc=71.34% val_score=65.4811 val_score_bestthr=65.4811 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.269, mb=0.498, no=0.996, corr=-0.203) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1678 -> 65.4811
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.2164 mb_mean=0.4968 norm_overlap=0.9933 corr_cb=-0.2376 topkJ=0.0110
[TRAIN][ep=048] loss=0.7353 acc=77.45%
[TRAIN][ep=048] mask_avg: mc_mean=0.2536 mb_mean=0.4982 norm_overlap=0.9954 corr_cb=-0.2089
[EPOCH 048/089] train: loss=0.7353 acc=77.45% | val: loss=0.6251 acc=63.86% f1=66.67% auc=72.50% val_score=63.7911 val_score_bestthr=63.7911 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.254, mb=0.498, no=0.995, corr=-0.209) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1678 -> 63.7911
[DBG][ep=049] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.1798 mb_mean=0.4976 norm_overlap=0.9949 corr_cb=-0.1821 topkJ=0.0197
[TRAIN][ep=049] loss=0.7101 acc=78.93%
[TRAIN][ep=049] mask_avg: mc_mean=0.2569 mb_mean=0.4982 norm_overlap=0.9954 corr_cb=-0.2096
[EPOCH 049/089] train: loss=0.7101 acc=78.93% | val: loss=0.6336 acc=63.86% f1=68.09% auc=71.51% val_score=62.4980 val_score_bestthr=62.4980 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.257, mb=0.498, no=0.995, corr=-0.210) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1678 -> 62.4980
[DBG][ep=050] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.2481 mb_mean=0.4977 norm_overlap=0.9982 corr_cb=-0.0853 topkJ=0.0283
[TRAIN][ep=050] loss=0.6941 acc=79.87%
[TRAIN][ep=050] mask_avg: mc_mean=0.2198 mb_mean=0.4982 norm_overlap=0.9951 corr_cb=-0.2009
[EPOCH 050/089] train: loss=0.6941 acc=79.87% | val: loss=0.6426 acc=65.06% f1=70.10% auc=70.93% val_score=67.0022 val_score_bestthr=67.0022 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.220, mb=0.498, no=0.995, corr=-0.201) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1678 -> 67.0022
[DBG][ep=051] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.1925 mb_mean=0.4997 norm_overlap=0.9938 corr_cb=-0.2393 topkJ=0.0279
[TRAIN][ep=051] loss=0.6953 acc=79.60%
[TRAIN][ep=051] mask_avg: mc_mean=0.2197 mb_mean=0.4982 norm_overlap=0.9950 corr_cb=-0.2025
[EPOCH 051/089] train: loss=0.6953 acc=79.60% | val: loss=0.6379 acc=63.86% f1=68.09% auc=71.22% val_score=62.4980 val_score_bestthr=62.4980 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.220, mb=0.498, no=0.995, corr=-0.202) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1678 -> 62.4980
[DBG][ep=052] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.2290 mb_mean=0.4957 norm_overlap=0.9951 corr_cb=-0.2141 topkJ=0.0287
[TRAIN][ep=052] loss=0.6960 acc=79.06%
[TRAIN][ep=052] mask_avg: mc_mean=0.2198 mb_mean=0.4982 norm_overlap=0.9951 corr_cb=-0.2006
[EPOCH 052/089] train: loss=0.6960 acc=79.06% | val: loss=0.6380 acc=63.86% f1=68.09% auc=71.22% val_score=62.4980 val_score_bestthr=62.4980 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.220, mb=0.498, no=0.995, corr=-0.201) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1678 -> 62.4980
[DBG][ep=053] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.2103 mb_mean=0.4980 norm_overlap=0.9967 corr_cb=-0.1179 topkJ=0.0354
[TRAIN][ep=053] loss=0.6897 acc=80.40%
[TRAIN][ep=053] mask_avg: mc_mean=0.2197 mb_mean=0.4982 norm_overlap=0.9951 corr_cb=-0.2013
[EPOCH 053/089] train: loss=0.6897 acc=80.40% | val: loss=0.6477 acc=65.06% f1=70.10% auc=71.10% val_score=67.0022 val_score_bestthr=67.0022 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.220, mb=0.498, no=0.995, corr=-0.201) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1678 -> 67.0022
[DBG][ep=054] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=054] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=054] mask(step0): mc_mean=0.2221 mb_mean=0.4970 norm_overlap=0.9939 corr_cb=-0.2644 topkJ=0.0183
[TRAIN][ep=054] loss=0.6992 acc=78.79%
[TRAIN][ep=054] mask_avg: mc_mean=0.2197 mb_mean=0.4982 norm_overlap=0.9950 corr_cb=-0.2016
[EPOCH 054/089] train: loss=0.6992 acc=78.79% | val: loss=0.6370 acc=63.86% f1=66.67% auc=71.40% val_score=63.7911 val_score_bestthr=63.7911 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.220, mb=0.498, no=0.995, corr=-0.202) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1678 -> 63.7911
[DBG][ep=055] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=055] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=055] mask(step0): mc_mean=0.2256 mb_mean=0.4989 norm_overlap=0.9890 corr_cb=-0.3629 topkJ=0.0103
[TRAIN][ep=055] loss=0.6898 acc=79.73%
[TRAIN][ep=055] mask_avg: mc_mean=0.2197 mb_mean=0.4982 norm_overlap=0.9950 corr_cb=-0.2042
[EPOCH 055/089] train: loss=0.6898 acc=79.73% | val: loss=0.6371 acc=63.86% f1=66.67% auc=71.40% val_score=63.7911 val_score_bestthr=63.7911 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.220, mb=0.498, no=0.995, corr=-0.204) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1678 -> 63.7911
[DBG][ep=056] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=056] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=056] mask(step0): mc_mean=0.1990 mb_mean=0.4973 norm_overlap=0.9922 corr_cb=-0.3069 topkJ=0.0233
[TRAIN][ep=056] loss=0.6858 acc=80.54%
[TRAIN][ep=056] mask_avg: mc_mean=0.2197 mb_mean=0.4982 norm_overlap=0.9951 corr_cb=-0.2009
[EPOCH 056/089] train: loss=0.6858 acc=80.54% | val: loss=0.6394 acc=63.86% f1=66.67% auc=71.98% val_score=63.7911 val_score_bestthr=63.7911 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.220, mb=0.498, no=0.995, corr=-0.201) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1678 -> 63.7911
[DBG][ep=057] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=057] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=057] mask(step0): mc_mean=0.1953 mb_mean=0.4987 norm_overlap=0.9973 corr_cb=-0.1109 topkJ=0.0480
[TRAIN][ep=057] loss=0.6903 acc=80.81%
[TRAIN][ep=057] mask_avg: mc_mean=0.2197 mb_mean=0.4982 norm_overlap=0.9951 corr_cb=-0.2001
[EPOCH 057/089] train: loss=0.6903 acc=80.81% | val: loss=0.6410 acc=63.86% f1=66.67% auc=71.69% val_score=63.7911 val_score_bestthr=63.7911 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.220, mb=0.498, no=0.995, corr=-0.200) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1678 -> 63.7911
[DBG][ep=058] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=058] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=058] mask(step0): mc_mean=0.2714 mb_mean=0.4971 norm_overlap=0.9949 corr_cb=-0.2368 topkJ=0.0193
[TRAIN][ep=058] loss=0.6848 acc=80.13%
[TRAIN][ep=058] mask_avg: mc_mean=0.2198 mb_mean=0.4982 norm_overlap=0.9951 corr_cb=-0.2009
[EPOCH 058/089] train: loss=0.6848 acc=80.13% | val: loss=0.6434 acc=62.65% f1=65.93% auc=71.10% val_score=63.3875 val_score_bestthr=63.3875 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.220, mb=0.498, no=0.995, corr=-0.201) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.1678 -> 63.3875
[EARLY STOP] no improvement for 30 epochs. best_epoch=28
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
=============== FIT DONE ===============
[BEST] epoch=28 | val_acc=63.86% | val_f1=74.14% | val_auc=71.69% | val_score=72.1678 | val_score_bestthr=72.1678
[TEST@BEST] thr_used=0.450 | acc=57.49% f1=69.44% auc=67.14% | SP_sex=7.66% EO_sex=1.12% SP_age=12.47% EO_age=11.43%
[TIME] 1.26 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/summary_fold_2.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4409 mb_mean=0.4998 norm_overlap=0.9999 corr_cb=-0.1537 topkJ=0.0142
[TRAIN][ep=000] loss=0.6950 acc=50.07%
[TRAIN][ep=000] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2179
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4456 mb_mean=0.4977 norm_overlap=0.9998 corr_cb=-0.3429 topkJ=0.0084
[TRAIN][ep=001] loss=0.6929 acc=50.87%
[TRAIN][ep=001] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2197
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4416 mb_mean=0.4967 norm_overlap=1.0000 corr_cb=-0.0925 topkJ=0.0328
[TRAIN][ep=002] loss=0.6924 acc=50.87%
[TRAIN][ep=002] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2149
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4401 mb_mean=0.4989 norm_overlap=0.9997 corr_cb=-0.3682 topkJ=0.0059
[TRAIN][ep=003] loss=0.6906 acc=54.23%
[TRAIN][ep=003] mask_avg: mc_mean=0.4421 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2220
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4399 mb_mean=0.4974 norm_overlap=0.9999 corr_cb=-0.1290 topkJ=0.0272
[TRAIN][ep=004] loss=0.6889 acc=56.78%
[TRAIN][ep=004] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2177
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4388 mb_mean=0.4999 norm_overlap=0.9998 corr_cb=-0.3849 topkJ=0.0055
[TRAIN][ep=005] loss=0.6873 acc=53.69%
[TRAIN][ep=005] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2149
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4421 mb_mean=0.4993 norm_overlap=0.9998 corr_cb=-0.2996 topkJ=0.0246
[TRAIN][ep=006] loss=0.6838 acc=55.30%
[TRAIN][ep=006] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2113
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4448 mb_mean=0.4952 norm_overlap=1.0000 corr_cb=0.0093 topkJ=0.0332
[TRAIN][ep=007] loss=0.6811 acc=60.00%
[TRAIN][ep=007] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2179
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4400 mb_mean=0.4972 norm_overlap=1.0000 corr_cb=-0.0037 topkJ=0.0472
[TRAIN][ep=008] loss=0.6783 acc=61.21%
[TRAIN][ep=008] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2155
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4446 mb_mean=0.4966 norm_overlap=0.9999 corr_cb=-0.2381 topkJ=0.0197
[TRAIN][ep=009] loss=0.6708 acc=59.33%
[TRAIN][ep=009] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2154
================= FIT START (fold=2) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4430 mb_mean=0.4980 norm_overlap=1.0000 corr_cb=-0.1091 topkJ=0.0223
[TRAIN][ep=000] loss=0.6696 acc=60.40%
[TRAIN][ep=000] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2180
[EPOCH 000/089] train: loss=0.6696 acc=60.40% | val: loss=0.6634 acc=71.08% f1=76.92% auc=71.63% val_score=69.3393 val_score_bestthr=68.6591 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.218) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 68.6591
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4450 mb_mean=0.4972 norm_overlap=0.9999 corr_cb=-0.1381 topkJ=0.0336
[TRAIN][ep=001] loss=0.6650 acc=60.81%
[TRAIN][ep=001] mask_avg: mc_mean=0.4421 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2187
[EPOCH 001/089] train: loss=0.6650 acc=60.81% | val: loss=0.6592 acc=68.67% f1=72.34% auc=71.34% val_score=67.1354 val_score_bestthr=72.7288 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.219) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 68.6591 -> 72.7288
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4416 mb_mean=0.4970 norm_overlap=0.9999 corr_cb=-0.1910 topkJ=0.0291
[TRAIN][ep=002] loss=0.6560 acc=62.55%
[TRAIN][ep=002] mask_avg: mc_mean=0.4421 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2200
[EPOCH 002/089] train: loss=0.6560 acc=62.55% | val: loss=0.6559 acc=68.67% f1=73.47% auc=69.59% val_score=65.8565 val_score_bestthr=69.0984 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.220) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7288 -> 69.0984
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4419 mb_mean=0.4995 norm_overlap=0.9998 corr_cb=-0.3017 topkJ=0.0204
[TRAIN][ep=003] loss=0.6534 acc=60.54%
[TRAIN][ep=003] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2169
[EPOCH 003/089] train: loss=0.6534 acc=60.54% | val: loss=0.6816 acc=69.88% f1=73.68% auc=70.64% val_score=61.3370 val_score_bestthr=71.4030 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.217) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7288 -> 71.4030
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4404 mb_mean=0.4979 norm_overlap=0.9999 corr_cb=-0.1561 topkJ=0.0339
[TRAIN][ep=004] loss=0.6513 acc=62.15%
[TRAIN][ep=004] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2191
[EPOCH 004/089] train: loss=0.6513 acc=62.15% | val: loss=0.6489 acc=71.08% f1=77.36% auc=72.21% val_score=74.3337 val_score_bestthr=74.3337 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.219) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 72.7288 -> 74.3337
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4474 mb_mean=0.4984 norm_overlap=1.0000 corr_cb=-0.0752 topkJ=0.0199
[TRAIN][ep=005] loss=1.3529 acc=61.74%
[TRAIN][ep=005] mask_avg: mc_mean=0.3162 mb_mean=0.4982 norm_overlap=0.9991 corr_cb=-0.2685
[EPOCH 005/089] train: loss=1.3529 acc=61.74% | val: loss=0.6670 acc=66.27% f1=68.18% auc=69.59% val_score=48.0730 val_score_bestthr=68.0173 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.316, mb=0.498, no=0.999, corr=-0.269) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.0173
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2506 mb_mean=0.4984 norm_overlap=0.9986 corr_cb=-0.2145 topkJ=0.0245
[TRAIN][ep=006] loss=1.3409 acc=62.82%
[TRAIN][ep=006] mask_avg: mc_mean=0.2165 mb_mean=0.4982 norm_overlap=0.9984 corr_cb=-0.2360
[EPOCH 006/089] train: loss=1.3409 acc=62.82% | val: loss=0.6459 acc=72.29% f1=77.23% auc=73.14% val_score=64.7852 val_score_bestthr=70.9614 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.216, mb=0.498, no=0.998, corr=-0.236) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 70.9614
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2364 mb_mean=0.5001 norm_overlap=0.9982 corr_cb=-0.2409 topkJ=0.0478
[TRAIN][ep=007] loss=1.3286 acc=63.62%
[TRAIN][ep=007] mask_avg: mc_mean=0.1762 mb_mean=0.4982 norm_overlap=0.9980 corr_cb=-0.2172
[EPOCH 007/089] train: loss=1.3286 acc=63.62% | val: loss=0.6423 acc=71.08% f1=76.92% auc=72.91% val_score=61.4276 val_score_bestthr=72.2412 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.176, mb=0.498, no=0.998, corr=-0.217) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 72.2412
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1669 mb_mean=0.4984 norm_overlap=0.9984 corr_cb=-0.1992 topkJ=0.0447
[TRAIN][ep=008] loss=1.3128 acc=66.17%
[TRAIN][ep=008] mask_avg: mc_mean=0.1416 mb_mean=0.4982 norm_overlap=0.9976 corr_cb=-0.1894
[EPOCH 008/089] train: loss=1.3128 acc=66.17% | val: loss=0.6688 acc=71.08% f1=75.00% auc=71.80% val_score=64.4280 val_score_bestthr=68.0334 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.142, mb=0.498, no=0.998, corr=-0.189) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.0334
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1299 mb_mean=0.4974 norm_overlap=0.9973 corr_cb=-0.2203 topkJ=0.0255
[TRAIN][ep=009] loss=1.3103 acc=65.10%
[TRAIN][ep=009] mask_avg: mc_mean=0.1312 mb_mean=0.4982 norm_overlap=0.9971 corr_cb=-0.2020
[EPOCH 009/089] train: loss=1.3103 acc=65.10% | val: loss=0.6470 acc=66.27% f1=75.00% auc=72.44% val_score=71.9483 val_score_bestthr=71.9483 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.131, mb=0.498, no=0.997, corr=-0.202) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 71.9483
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1349 mb_mean=0.4962 norm_overlap=0.9957 corr_cb=-0.2933 topkJ=0.0244
[TRAIN][ep=010] loss=1.1113 acc=66.04%
[TRAIN][ep=010] mask_avg: mc_mean=0.1303 mb_mean=0.4982 norm_overlap=0.9967 corr_cb=-0.2172
[EPOCH 010/089] train: loss=1.1113 acc=66.04% | val: loss=0.6364 acc=67.47% f1=75.68% auc=72.85% val_score=67.7793 val_score_bestthr=72.3795 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.130, mb=0.498, no=0.997, corr=-0.217) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 72.3795
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1554 mb_mean=0.4990 norm_overlap=0.9968 corr_cb=-0.2412 topkJ=0.0258
[TRAIN][ep=011] loss=0.9271 acc=67.38%
[TRAIN][ep=011] mask_avg: mc_mean=0.1386 mb_mean=0.4982 norm_overlap=0.9965 corr_cb=-0.2097
[EPOCH 011/089] train: loss=0.9271 acc=67.38% | val: loss=0.6487 acc=71.08% f1=75.51% auc=71.10% val_score=52.6552 val_score_bestthr=69.8660 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.139, mb=0.498, no=0.997, corr=-0.210) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.8660
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1613 mb_mean=0.4965 norm_overlap=0.9984 corr_cb=-0.1150 topkJ=0.0666
[TRAIN][ep=012] loss=0.8865 acc=68.59%
[TRAIN][ep=012] mask_avg: mc_mean=0.1409 mb_mean=0.4982 norm_overlap=0.9960 corr_cb=-0.2213
[EPOCH 012/089] train: loss=0.8865 acc=68.59% | val: loss=0.6215 acc=71.08% f1=76.47% auc=72.85% val_score=58.3227 val_score_bestthr=71.6864 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.141, mb=0.498, no=0.996, corr=-0.221) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 71.6864
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.0983 mb_mean=0.5001 norm_overlap=0.9935 corr_cb=-0.2881 topkJ=0.0358
[TRAIN][ep=013] loss=0.8643 acc=67.92%
[TRAIN][ep=013] mask_avg: mc_mean=0.1553 mb_mean=0.4982 norm_overlap=0.9954 corr_cb=-0.2580
[EPOCH 013/089] train: loss=0.8643 acc=67.92% | val: loss=0.6227 acc=72.29% f1=76.29% auc=72.03% val_score=62.4943 val_score_bestthr=73.1465 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.155, mb=0.498, no=0.995, corr=-0.258) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 73.1465
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1835 mb_mean=0.4970 norm_overlap=0.9947 corr_cb=-0.3075 topkJ=0.0165
[TRAIN][ep=014] loss=0.8654 acc=68.86%
[TRAIN][ep=014] mask_avg: mc_mean=0.1800 mb_mean=0.4982 norm_overlap=0.9951 corr_cb=-0.2754
[EPOCH 014/089] train: loss=0.8654 acc=68.86% | val: loss=0.6160 acc=71.08% f1=76.00% auc=72.97% val_score=59.2691 val_score_bestthr=70.6726 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.180, mb=0.498, no=0.995, corr=-0.275) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 70.6726
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1668 mb_mean=0.4996 norm_overlap=0.9920 corr_cb=-0.4320 topkJ=0.0250
[TRAIN][ep=015] loss=0.8548 acc=69.13%
[TRAIN][ep=015] mask_avg: mc_mean=0.1637 mb_mean=0.4982 norm_overlap=0.9940 corr_cb=-0.3191
[EPOCH 015/089] train: loss=0.8548 acc=69.13% | val: loss=0.6271 acc=69.88% f1=73.12% auc=72.91% val_score=56.0182 val_score_bestthr=71.3343 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.164, mb=0.498, no=0.994, corr=-0.319) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 71.3343
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1786 mb_mean=0.4984 norm_overlap=0.9965 corr_cb=-0.2083 topkJ=0.0260
[TRAIN][ep=016] loss=0.8560 acc=71.01%
[TRAIN][ep=016] mask_avg: mc_mean=0.2006 mb_mean=0.4982 norm_overlap=0.9939 corr_cb=-0.3484
[EPOCH 016/089] train: loss=0.8560 acc=71.01% | val: loss=0.6161 acc=69.88% f1=74.75% auc=72.85% val_score=60.8079 val_score_bestthr=70.2978 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.201, mb=0.498, no=0.994, corr=-0.348) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 70.2978
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1646 mb_mean=0.4984 norm_overlap=0.9933 corr_cb=-0.2920 topkJ=0.0265
[TRAIN][ep=017] loss=0.8442 acc=69.13%
[TRAIN][ep=017] mask_avg: mc_mean=0.1704 mb_mean=0.4982 norm_overlap=0.9932 corr_cb=-0.3319
[EPOCH 017/089] train: loss=0.8442 acc=69.13% | val: loss=0.6102 acc=68.67% f1=75.00% auc=72.79% val_score=61.7641 val_score_bestthr=68.0330 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.170, mb=0.498, no=0.993, corr=-0.332) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.0330
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1488 mb_mean=0.4979 norm_overlap=0.9936 corr_cb=-0.2916 topkJ=0.0181
[TRAIN][ep=018] loss=0.8285 acc=71.54%
[TRAIN][ep=018] mask_avg: mc_mean=0.1747 mb_mean=0.4982 norm_overlap=0.9931 corr_cb=-0.3278
[EPOCH 018/089] train: loss=0.8285 acc=71.54% | val: loss=0.6130 acc=69.88% f1=74.23% auc=72.79% val_score=62.4943 val_score_bestthr=69.3476 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.175, mb=0.498, no=0.993, corr=-0.328) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.3476
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.2059 mb_mean=0.5006 norm_overlap=0.9927 corr_cb=-0.4083 topkJ=0.0154
[TRAIN][ep=019] loss=0.8435 acc=70.74%
[TRAIN][ep=019] mask_avg: mc_mean=0.1942 mb_mean=0.4982 norm_overlap=0.9928 corr_cb=-0.3563
[EPOCH 019/089] train: loss=0.8435 acc=70.74% | val: loss=0.6093 acc=67.47% f1=72.73% auc=72.62% val_score=54.6218 val_score_bestthr=67.4367 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.194, mb=0.498, no=0.993, corr=-0.356) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 67.4367
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.2250 mb_mean=0.4972 norm_overlap=0.9909 corr_cb=-0.4230 topkJ=0.0012
[TRAIN][ep=020] loss=0.8362 acc=69.66%
[TRAIN][ep=020] mask_avg: mc_mean=0.1778 mb_mean=0.4982 norm_overlap=0.9923 corr_cb=-0.3598
[EPOCH 020/089] train: loss=0.8362 acc=69.66% | val: loss=0.6088 acc=67.47% f1=75.68% auc=73.31% val_score=64.4585 val_score_bestthr=69.7154 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.178, mb=0.498, no=0.992, corr=-0.360) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.7154
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2328 mb_mean=0.4957 norm_overlap=0.9941 corr_cb=-0.3402 topkJ=0.0170
[TRAIN][ep=021] loss=0.8171 acc=73.02%
[TRAIN][ep=021] mask_avg: mc_mean=0.1969 mb_mean=0.4982 norm_overlap=0.9929 corr_cb=-0.3445
[EPOCH 021/089] train: loss=0.8171 acc=73.02% | val: loss=0.6049 acc=69.88% f1=71.26% auc=73.02% val_score=65.5137 val_score_bestthr=70.7970 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.197, mb=0.498, no=0.993, corr=-0.344) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 70.7970
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2077 mb_mean=0.4977 norm_overlap=0.9955 corr_cb=-0.2711 topkJ=0.0284
[TRAIN][ep=022] loss=0.8019 acc=73.83%
[TRAIN][ep=022] mask_avg: mc_mean=0.2041 mb_mean=0.4982 norm_overlap=0.9934 corr_cb=-0.3159
[EPOCH 022/089] train: loss=0.8019 acc=73.83% | val: loss=0.6194 acc=69.88% f1=73.68% auc=73.14% val_score=57.7917 val_score_bestthr=68.1984 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.204, mb=0.498, no=0.993, corr=-0.316) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.1984
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1569 mb_mean=0.4976 norm_overlap=0.9942 corr_cb=-0.2429 topkJ=0.0218
[TRAIN][ep=023] loss=0.8241 acc=71.28%
[TRAIN][ep=023] mask_avg: mc_mean=0.1971 mb_mean=0.4982 norm_overlap=0.9931 corr_cb=-0.3203
[EPOCH 023/089] train: loss=0.8241 acc=71.28% | val: loss=0.7033 acc=69.88% f1=76.64% auc=72.67% val_score=45.7063 val_score_bestthr=69.6805 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.197, mb=0.498, no=0.993, corr=-0.320) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.6805
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1942 mb_mean=0.4983 norm_overlap=0.9922 corr_cb=-0.3505 topkJ=0.0278
[TRAIN][ep=024] loss=0.8050 acc=74.36%
[TRAIN][ep=024] mask_avg: mc_mean=0.1876 mb_mean=0.4982 norm_overlap=0.9929 corr_cb=-0.3141
[EPOCH 024/089] train: loss=0.8050 acc=74.36% | val: loss=0.6082 acc=69.88% f1=71.26% auc=72.91% val_score=62.3068 val_score_bestthr=70.7970 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.188, mb=0.498, no=0.993, corr=-0.314) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 70.7970
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2296 mb_mean=0.4978 norm_overlap=0.9915 corr_cb=-0.3658 topkJ=0.0125
[TRAIN][ep=025] loss=0.8122 acc=73.96%
[TRAIN][ep=025] mask_avg: mc_mean=0.1943 mb_mean=0.4982 norm_overlap=0.9934 corr_cb=-0.2913
[EPOCH 025/089] train: loss=0.8122 acc=73.96% | val: loss=0.6111 acc=66.27% f1=74.55% auc=72.27% val_score=63.8288 val_score_bestthr=69.3455 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.194, mb=0.498, no=0.993, corr=-0.291) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.3455
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1661 mb_mean=0.4982 norm_overlap=0.9931 corr_cb=-0.3147 topkJ=0.0150
[TRAIN][ep=026] loss=0.7852 acc=74.50%
[TRAIN][ep=026] mask_avg: mc_mean=0.2186 mb_mean=0.4982 norm_overlap=0.9933 corr_cb=-0.3222
[EPOCH 026/089] train: loss=0.7852 acc=74.50% | val: loss=0.6083 acc=67.47% f1=75.23% auc=72.62% val_score=63.1208 val_score_bestthr=69.7779 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.219, mb=0.498, no=0.993, corr=-0.322) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.7779
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2421 mb_mean=0.4957 norm_overlap=0.9898 corr_cb=-0.4216 topkJ=0.0048
[TRAIN][ep=027] loss=0.7792 acc=75.84%
[TRAIN][ep=027] mask_avg: mc_mean=0.2015 mb_mean=0.4982 norm_overlap=0.9933 corr_cb=-0.2976
[EPOCH 027/089] train: loss=0.7792 acc=75.84% | val: loss=0.6581 acc=65.06% f1=73.87% auc=71.40% val_score=63.5534 val_score_bestthr=68.9509 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.201, mb=0.498, no=0.993, corr=-0.298) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.9509
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1982 mb_mean=0.5019 norm_overlap=0.9845 corr_cb=-0.5155 topkJ=0.0023
[TRAIN][ep=028] loss=0.7645 acc=75.70%
[TRAIN][ep=028] mask_avg: mc_mean=0.2237 mb_mean=0.4982 norm_overlap=0.9939 corr_cb=-0.2886
[EPOCH 028/089] train: loss=0.7645 acc=75.70% | val: loss=0.7382 acc=66.27% f1=72.00% auc=70.93% val_score=68.3578 val_score_bestthr=67.1962 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.224, mb=0.498, no=0.994, corr=-0.289) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 67.1962
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2207 mb_mean=0.4959 norm_overlap=0.9959 corr_cb=-0.2062 topkJ=0.0221
[TRAIN][ep=029] loss=0.7679 acc=75.57%
[TRAIN][ep=029] mask_avg: mc_mean=0.2040 mb_mean=0.4982 norm_overlap=0.9936 corr_cb=-0.2802
[EPOCH 029/089] train: loss=0.7679 acc=75.57% | val: loss=0.6281 acc=66.27% f1=75.00% auc=71.51% val_score=65.7516 val_score_bestthr=69.3203 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.204, mb=0.498, no=0.994, corr=-0.280) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.3203
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2305 mb_mean=0.4994 norm_overlap=0.9948 corr_cb=-0.2771 topkJ=0.0234
[TRAIN][ep=030] loss=0.7688 acc=73.96%
[TRAIN][ep=030] mask_avg: mc_mean=0.2159 mb_mean=0.4982 norm_overlap=0.9940 corr_cb=-0.2723
[EPOCH 030/089] train: loss=0.7688 acc=73.96% | val: loss=0.6252 acc=67.47% f1=74.77% auc=72.44% val_score=52.9436 val_score_bestthr=68.6174 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.216, mb=0.498, no=0.994, corr=-0.272) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.6174
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2320 mb_mean=0.4974 norm_overlap=0.9959 corr_cb=-0.2196 topkJ=0.0417
[TRAIN][ep=031] loss=0.7569 acc=76.24%
[TRAIN][ep=031] mask_avg: mc_mean=0.2185 mb_mean=0.4982 norm_overlap=0.9937 corr_cb=-0.2797
[EPOCH 031/089] train: loss=0.7569 acc=76.24% | val: loss=0.5986 acc=69.88% f1=73.68% auc=74.01% val_score=65.1700 val_score_bestthr=71.5589 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.218, mb=0.498, no=0.994, corr=-0.280) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 71.5589
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.0818 mb_mean=0.4974 norm_overlap=0.9943 corr_cb=-0.1765 topkJ=0.0241
[TRAIN][ep=032] loss=0.7723 acc=74.36%
[TRAIN][ep=032] mask_avg: mc_mean=0.1539 mb_mean=0.4982 norm_overlap=0.9925 corr_cb=-0.2592
[EPOCH 032/089] train: loss=0.7723 acc=74.36% | val: loss=0.6343 acc=67.47% f1=75.68% auc=71.51% val_score=50.5703 val_score_bestthr=72.5854 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.154, mb=0.498, no=0.992, corr=-0.259) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 72.5854
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2544 mb_mean=0.4964 norm_overlap=0.9951 corr_cb=-0.2808 topkJ=0.0302
[TRAIN][ep=033] loss=0.7521 acc=76.11%
[TRAIN][ep=033] mask_avg: mc_mean=0.2121 mb_mean=0.4982 norm_overlap=0.9934 corr_cb=-0.2862
[EPOCH 033/089] train: loss=0.7521 acc=76.11% | val: loss=0.6378 acc=68.67% f1=75.93% auc=72.50% val_score=54.5348 val_score_bestthr=70.7418 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.212, mb=0.498, no=0.993, corr=-0.286) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 70.7418
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2109 mb_mean=0.4971 norm_overlap=0.9933 corr_cb=-0.2689 topkJ=0.0210
[TRAIN][ep=034] loss=0.7496 acc=75.17%
[TRAIN][ep=034] mask_avg: mc_mean=0.2037 mb_mean=0.4982 norm_overlap=0.9933 corr_cb=-0.2827
[EPOCH 034/089] train: loss=0.7496 acc=75.17% | val: loss=0.6189 acc=68.67% f1=75.00% auc=71.69% val_score=60.0411 val_score_bestthr=66.2214 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.204, mb=0.498, no=0.993, corr=-0.283) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 66.2214
[EARLY STOP] no improvement for 30 epochs. best_epoch=4
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
=============== FIT DONE ===============
[BEST] epoch=4 | val_acc=71.08% | val_f1=77.36% | val_auc=72.21% | val_score=74.3337 | val_score_bestthr=74.3337
[TEST@BEST] thr_used=0.580 | acc=63.77% f1=61.54% auc=65.38% | SP_sex=10.15% EO_sex=6.61% SP_age=10.52% EO_age=6.58%
[TIME] 0.84 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/summary_fold_2.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4409 mb_mean=0.4998 norm_overlap=0.9999 corr_cb=-0.1537 topkJ=0.0142
[TRAIN][ep=000] loss=0.6950 acc=50.07%
[TRAIN][ep=000] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2179
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4456 mb_mean=0.4977 norm_overlap=0.9998 corr_cb=-0.3429 topkJ=0.0084
[TRAIN][ep=001] loss=0.6929 acc=50.87%
[TRAIN][ep=001] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2197
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4416 mb_mean=0.4967 norm_overlap=1.0000 corr_cb=-0.0925 topkJ=0.0328
[TRAIN][ep=002] loss=0.6924 acc=50.87%
[TRAIN][ep=002] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2149
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4401 mb_mean=0.4989 norm_overlap=0.9997 corr_cb=-0.3682 topkJ=0.0059
[TRAIN][ep=003] loss=0.6906 acc=54.23%
[TRAIN][ep=003] mask_avg: mc_mean=0.4421 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2220
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4399 mb_mean=0.4974 norm_overlap=0.9999 corr_cb=-0.1290 topkJ=0.0272
[TRAIN][ep=004] loss=0.6889 acc=56.78%
[TRAIN][ep=004] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2177
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4388 mb_mean=0.4999 norm_overlap=0.9998 corr_cb=-0.3849 topkJ=0.0055
[TRAIN][ep=005] loss=0.6873 acc=53.69%
[TRAIN][ep=005] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2149
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4421 mb_mean=0.4993 norm_overlap=0.9998 corr_cb=-0.2996 topkJ=0.0246
[TRAIN][ep=006] loss=0.6838 acc=55.30%
[TRAIN][ep=006] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2113
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4448 mb_mean=0.4952 norm_overlap=1.0000 corr_cb=0.0093 topkJ=0.0332
[TRAIN][ep=007] loss=0.6811 acc=59.87%
[TRAIN][ep=007] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2179
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4400 mb_mean=0.4972 norm_overlap=1.0000 corr_cb=-0.0037 topkJ=0.0472
[TRAIN][ep=008] loss=0.6783 acc=61.21%
[TRAIN][ep=008] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2155
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4446 mb_mean=0.4966 norm_overlap=0.9999 corr_cb=-0.2381 topkJ=0.0197
[TRAIN][ep=009] loss=0.6708 acc=59.46%
[TRAIN][ep=009] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2154
================= FIT START (fold=2) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4430 mb_mean=0.4980 norm_overlap=1.0000 corr_cb=-0.1091 topkJ=0.0223
[TRAIN][ep=000] loss=0.6696 acc=60.40%
[TRAIN][ep=000] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2180
[EPOCH 000/089] train: loss=0.6696 acc=60.40% | val: loss=0.6634 acc=71.08% f1=76.92% auc=71.63% val_score=69.3393 val_score_bestthr=68.6591 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.218) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 68.6591
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4450 mb_mean=0.4972 norm_overlap=0.9999 corr_cb=-0.1381 topkJ=0.0336
[TRAIN][ep=001] loss=0.6650 acc=60.81%
[TRAIN][ep=001] mask_avg: mc_mean=0.4421 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2187
[EPOCH 001/089] train: loss=0.6650 acc=60.81% | val: loss=0.6591 acc=68.67% f1=72.34% auc=71.34% val_score=67.1354 val_score_bestthr=72.7288 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.219) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 68.6591 -> 72.7288
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4416 mb_mean=0.4970 norm_overlap=0.9999 corr_cb=-0.1910 topkJ=0.0291
[TRAIN][ep=002] loss=0.6560 acc=62.55%
[TRAIN][ep=002] mask_avg: mc_mean=0.4421 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2200
[EPOCH 002/089] train: loss=0.6560 acc=62.55% | val: loss=0.6559 acc=68.67% f1=73.47% auc=69.65% val_score=65.8565 val_score_bestthr=69.0984 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.220) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7288 -> 69.0984
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4419 mb_mean=0.4995 norm_overlap=0.9998 corr_cb=-0.3017 topkJ=0.0204
[TRAIN][ep=003] loss=0.6534 acc=60.67%
[TRAIN][ep=003] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2169
[EPOCH 003/089] train: loss=0.6534 acc=60.67% | val: loss=0.6816 acc=69.88% f1=73.68% auc=70.64% val_score=61.3370 val_score_bestthr=71.4030 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.217) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7288 -> 71.4030
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4404 mb_mean=0.4979 norm_overlap=0.9999 corr_cb=-0.1561 topkJ=0.0339
[TRAIN][ep=004] loss=0.6513 acc=62.28%
[TRAIN][ep=004] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2191
[EPOCH 004/089] train: loss=0.6513 acc=62.28% | val: loss=0.6489 acc=71.08% f1=77.36% auc=72.21% val_score=74.3337 val_score_bestthr=74.3337 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.219) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 72.7288 -> 74.3337
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4474 mb_mean=0.4984 norm_overlap=1.0000 corr_cb=-0.0752 topkJ=0.0199
[TRAIN][ep=005] loss=1.5314 acc=62.28%
[TRAIN][ep=005] mask_avg: mc_mean=0.3196 mb_mean=0.4982 norm_overlap=0.9991 corr_cb=-0.2726
[EPOCH 005/089] train: loss=1.5314 acc=62.28% | val: loss=0.6674 acc=66.27% f1=68.18% auc=69.83% val_score=47.1055 val_score_bestthr=68.0173 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.320, mb=0.498, no=0.999, corr=-0.273) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.0173
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2533 mb_mean=0.4984 norm_overlap=0.9986 corr_cb=-0.2172 topkJ=0.0245
[TRAIN][ep=006] loss=1.5161 acc=63.09%
[TRAIN][ep=006] mask_avg: mc_mean=0.2188 mb_mean=0.4982 norm_overlap=0.9984 corr_cb=-0.2384
[EPOCH 006/089] train: loss=1.5161 acc=63.09% | val: loss=0.6464 acc=69.88% f1=76.64% auc=73.20% val_score=64.1822 val_score_bestthr=70.0804 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.219, mb=0.498, no=0.998, corr=-0.238) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 70.0804
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2383 mb_mean=0.5001 norm_overlap=0.9983 corr_cb=-0.2423 topkJ=0.0478
[TRAIN][ep=007] loss=1.5040 acc=64.16%
[TRAIN][ep=007] mask_avg: mc_mean=0.1786 mb_mean=0.4982 norm_overlap=0.9980 corr_cb=-0.2202
[EPOCH 007/089] train: loss=1.5040 acc=64.16% | val: loss=0.6427 acc=69.88% f1=76.19% auc=73.14% val_score=61.4276 val_score_bestthr=70.7175 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.179, mb=0.498, no=0.998, corr=-0.220) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 70.7175
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1694 mb_mean=0.4984 norm_overlap=0.9984 corr_cb=-0.2018 topkJ=0.0447
[TRAIN][ep=008] loss=1.4882 acc=66.44%
[TRAIN][ep=008] mask_avg: mc_mean=0.1438 mb_mean=0.4982 norm_overlap=0.9976 corr_cb=-0.1934
[EPOCH 008/089] train: loss=1.4882 acc=66.44% | val: loss=0.6695 acc=71.08% f1=75.00% auc=71.74% val_score=64.4280 val_score_bestthr=68.0334 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.144, mb=0.498, no=0.998, corr=-0.193) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.0334
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1324 mb_mean=0.4974 norm_overlap=0.9973 corr_cb=-0.2238 topkJ=0.0255
[TRAIN][ep=009] loss=1.4857 acc=65.10%
[TRAIN][ep=009] mask_avg: mc_mean=0.1333 mb_mean=0.4982 norm_overlap=0.9971 corr_cb=-0.2063
[EPOCH 009/089] train: loss=1.4857 acc=65.10% | val: loss=0.6478 acc=66.27% f1=75.00% auc=72.38% val_score=71.9483 val_score_bestthr=71.9483 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.133, mb=0.498, no=0.997, corr=-0.206) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 71.9483
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1359 mb_mean=0.4962 norm_overlap=0.9957 corr_cb=-0.2980 topkJ=0.0240
[TRAIN][ep=010] loss=1.2169 acc=65.91%
[TRAIN][ep=010] mask_avg: mc_mean=0.1308 mb_mean=0.4982 norm_overlap=0.9966 corr_cb=-0.2212
[EPOCH 010/089] train: loss=1.2169 acc=65.91% | val: loss=0.6368 acc=67.47% f1=75.68% auc=72.62% val_score=67.7793 val_score_bestthr=72.3795 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.131, mb=0.498, no=0.997, corr=-0.221) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 72.3795
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1550 mb_mean=0.4990 norm_overlap=0.9967 corr_cb=-0.2453 topkJ=0.0249
[TRAIN][ep=011] loss=0.9627 acc=67.11%
[TRAIN][ep=011] mask_avg: mc_mean=0.1387 mb_mean=0.4982 norm_overlap=0.9965 corr_cb=-0.2121
[EPOCH 011/089] train: loss=0.9627 acc=67.11% | val: loss=0.6496 acc=71.08% f1=75.51% auc=71.05% val_score=52.6552 val_score_bestthr=69.8660 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.139, mb=0.498, no=0.997, corr=-0.212) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.8660
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1631 mb_mean=0.4965 norm_overlap=0.9984 corr_cb=-0.1180 topkJ=0.0670
[TRAIN][ep=012] loss=0.8872 acc=68.46%
[TRAIN][ep=012] mask_avg: mc_mean=0.1416 mb_mean=0.4982 norm_overlap=0.9960 corr_cb=-0.2222
[EPOCH 012/089] train: loss=0.8872 acc=68.46% | val: loss=0.6222 acc=71.08% f1=76.47% auc=72.67% val_score=58.3227 val_score_bestthr=71.6864 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.142, mb=0.498, no=0.996, corr=-0.222) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 71.6864
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.0987 mb_mean=0.5001 norm_overlap=0.9936 corr_cb=-0.2883 topkJ=0.0358
[TRAIN][ep=013] loss=0.8648 acc=67.92%
[TRAIN][ep=013] mask_avg: mc_mean=0.1551 mb_mean=0.4982 norm_overlap=0.9954 corr_cb=-0.2572
[EPOCH 013/089] train: loss=0.8648 acc=67.92% | val: loss=0.6234 acc=72.29% f1=76.29% auc=71.98% val_score=62.4943 val_score_bestthr=73.1465 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.155, mb=0.498, no=0.995, corr=-0.257) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 73.1465
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1828 mb_mean=0.4970 norm_overlap=0.9947 corr_cb=-0.3064 topkJ=0.0169
[TRAIN][ep=014] loss=0.8659 acc=68.99%
[TRAIN][ep=014] mask_avg: mc_mean=0.1797 mb_mean=0.4982 norm_overlap=0.9952 corr_cb=-0.2746
[EPOCH 014/089] train: loss=0.8659 acc=68.99% | val: loss=0.6164 acc=71.08% f1=76.00% auc=72.85% val_score=59.2691 val_score_bestthr=70.6726 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.180, mb=0.498, no=0.995, corr=-0.275) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 70.6726
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1655 mb_mean=0.4996 norm_overlap=0.9920 corr_cb=-0.4323 topkJ=0.0254
[TRAIN][ep=015] loss=0.8553 acc=68.99%
[TRAIN][ep=015] mask_avg: mc_mean=0.1626 mb_mean=0.4982 norm_overlap=0.9940 corr_cb=-0.3181
[EPOCH 015/089] train: loss=0.8553 acc=68.99% | val: loss=0.6278 acc=68.67% f1=72.34% auc=72.67% val_score=56.0182 val_score_bestthr=68.6838 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.163, mb=0.498, no=0.994, corr=-0.318) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.6838
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1781 mb_mean=0.4984 norm_overlap=0.9965 corr_cb=-0.2076 topkJ=0.0264
[TRAIN][ep=016] loss=0.8562 acc=71.01%
[TRAIN][ep=016] mask_avg: mc_mean=0.2002 mb_mean=0.4982 norm_overlap=0.9939 corr_cb=-0.3480
[EPOCH 016/089] train: loss=0.8562 acc=71.01% | val: loss=0.6164 acc=69.88% f1=75.25% auc=72.91% val_score=62.4943 val_score_bestthr=68.6436 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.200, mb=0.498, no=0.994, corr=-0.348) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.6436
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1654 mb_mean=0.4984 norm_overlap=0.9933 corr_cb=-0.2915 topkJ=0.0265
[TRAIN][ep=017] loss=0.8445 acc=69.40%
[TRAIN][ep=017] mask_avg: mc_mean=0.1707 mb_mean=0.4982 norm_overlap=0.9932 corr_cb=-0.3319
[EPOCH 017/089] train: loss=0.8445 acc=69.40% | val: loss=0.6103 acc=68.67% f1=75.00% auc=72.97% val_score=61.7641 val_score_bestthr=68.0330 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.171, mb=0.498, no=0.993, corr=-0.332) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.0330
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1495 mb_mean=0.4979 norm_overlap=0.9936 corr_cb=-0.2919 topkJ=0.0185
[TRAIN][ep=018] loss=0.8287 acc=71.41%
[TRAIN][ep=018] mask_avg: mc_mean=0.1750 mb_mean=0.4982 norm_overlap=0.9931 corr_cb=-0.3279
[EPOCH 018/089] train: loss=0.8287 acc=71.41% | val: loss=0.6131 acc=69.88% f1=74.23% auc=72.79% val_score=62.4943 val_score_bestthr=69.3476 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.175, mb=0.498, no=0.993, corr=-0.328) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.3476
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.2063 mb_mean=0.5006 norm_overlap=0.9927 corr_cb=-0.4084 topkJ=0.0154
[TRAIN][ep=019] loss=0.8437 acc=70.60%
[TRAIN][ep=019] mask_avg: mc_mean=0.1943 mb_mean=0.4982 norm_overlap=0.9928 corr_cb=-0.3567
[EPOCH 019/089] train: loss=0.8437 acc=70.60% | val: loss=0.6095 acc=67.47% f1=72.73% auc=72.56% val_score=54.6218 val_score_bestthr=67.4367 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.194, mb=0.498, no=0.993, corr=-0.357) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 67.4367
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.2259 mb_mean=0.4972 norm_overlap=0.9909 corr_cb=-0.4242 topkJ=0.0012
[TRAIN][ep=020] loss=0.8362 acc=69.66%
[TRAIN][ep=020] mask_avg: mc_mean=0.1796 mb_mean=0.4982 norm_overlap=0.9924 corr_cb=-0.3610
[EPOCH 020/089] train: loss=0.8362 acc=69.66% | val: loss=0.6089 acc=67.47% f1=75.68% auc=73.37% val_score=64.4585 val_score_bestthr=69.7154 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.180, mb=0.498, no=0.992, corr=-0.361) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.7154
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2325 mb_mean=0.4957 norm_overlap=0.9941 corr_cb=-0.3410 topkJ=0.0175
[TRAIN][ep=021] loss=0.8175 acc=73.02%
[TRAIN][ep=021] mask_avg: mc_mean=0.1966 mb_mean=0.4982 norm_overlap=0.9929 corr_cb=-0.3450
[EPOCH 021/089] train: loss=0.8175 acc=73.02% | val: loss=0.6047 acc=69.88% f1=71.26% auc=73.14% val_score=65.5137 val_score_bestthr=70.7970 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.197, mb=0.498, no=0.993, corr=-0.345) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 70.7970
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2071 mb_mean=0.4977 norm_overlap=0.9955 corr_cb=-0.2711 topkJ=0.0284
[TRAIN][ep=022] loss=0.8019 acc=73.96%
[TRAIN][ep=022] mask_avg: mc_mean=0.2040 mb_mean=0.4982 norm_overlap=0.9934 corr_cb=-0.3166
[EPOCH 022/089] train: loss=0.8019 acc=73.96% | val: loss=0.6191 acc=69.88% f1=73.68% auc=73.31% val_score=57.7917 val_score_bestthr=68.1984 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.204, mb=0.498, no=0.993, corr=-0.317) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.1984
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1574 mb_mean=0.4976 norm_overlap=0.9942 corr_cb=-0.2437 topkJ=0.0218
[TRAIN][ep=023] loss=0.8236 acc=71.28%
[TRAIN][ep=023] mask_avg: mc_mean=0.1974 mb_mean=0.4982 norm_overlap=0.9931 corr_cb=-0.3207
[EPOCH 023/089] train: loss=0.8236 acc=71.28% | val: loss=0.7037 acc=69.88% f1=76.64% auc=72.62% val_score=45.7063 val_score_bestthr=69.6805 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.197, mb=0.498, no=0.993, corr=-0.321) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.6805
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1940 mb_mean=0.4983 norm_overlap=0.9922 corr_cb=-0.3511 topkJ=0.0278
[TRAIN][ep=024] loss=0.8049 acc=74.36%
[TRAIN][ep=024] mask_avg: mc_mean=0.1876 mb_mean=0.4982 norm_overlap=0.9929 corr_cb=-0.3143
[EPOCH 024/089] train: loss=0.8049 acc=74.36% | val: loss=0.6077 acc=69.88% f1=71.26% auc=72.79% val_score=62.3068 val_score_bestthr=70.7970 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.188, mb=0.498, no=0.993, corr=-0.314) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 70.7970
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2301 mb_mean=0.4978 norm_overlap=0.9915 corr_cb=-0.3654 topkJ=0.0121
[TRAIN][ep=025] loss=0.8123 acc=73.56%
[TRAIN][ep=025] mask_avg: mc_mean=0.1950 mb_mean=0.4982 norm_overlap=0.9934 corr_cb=-0.2922
[EPOCH 025/089] train: loss=0.8123 acc=73.56% | val: loss=0.6106 acc=66.27% f1=74.55% auc=72.44% val_score=68.1367 val_score_bestthr=69.3455 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.195, mb=0.498, no=0.993, corr=-0.292) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.3455
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1664 mb_mean=0.4982 norm_overlap=0.9931 corr_cb=-0.3155 topkJ=0.0150
[TRAIN][ep=026] loss=0.7853 acc=74.23%
[TRAIN][ep=026] mask_avg: mc_mean=0.2191 mb_mean=0.4982 norm_overlap=0.9933 corr_cb=-0.3232
[EPOCH 026/089] train: loss=0.7853 acc=74.23% | val: loss=0.6076 acc=67.47% f1=75.23% auc=72.73% val_score=63.1208 val_score_bestthr=69.7779 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.219, mb=0.498, no=0.993, corr=-0.323) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.7779
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2419 mb_mean=0.4957 norm_overlap=0.9898 corr_cb=-0.4225 topkJ=0.0048
[TRAIN][ep=027] loss=0.7790 acc=75.97%
[TRAIN][ep=027] mask_avg: mc_mean=0.2019 mb_mean=0.4982 norm_overlap=0.9933 corr_cb=-0.2983
[EPOCH 027/089] train: loss=0.7790 acc=75.97% | val: loss=0.6574 acc=65.06% f1=74.34% auc=71.51% val_score=63.5534 val_score_bestthr=69.8694 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.202, mb=0.498, no=0.993, corr=-0.298) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.8694
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1987 mb_mean=0.5019 norm_overlap=0.9845 corr_cb=-0.5162 topkJ=0.0023
[TRAIN][ep=028] loss=0.7646 acc=75.70%
[TRAIN][ep=028] mask_avg: mc_mean=0.2243 mb_mean=0.4982 norm_overlap=0.9939 corr_cb=-0.2894
[EPOCH 028/089] train: loss=0.7646 acc=75.70% | val: loss=0.7377 acc=67.47% f1=73.27% auc=71.16% val_score=68.3578 val_score_bestthr=65.8191 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.224, mb=0.498, no=0.994, corr=-0.289) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 65.8191
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2223 mb_mean=0.4959 norm_overlap=0.9959 corr_cb=-0.2066 topkJ=0.0221
[TRAIN][ep=029] loss=0.7680 acc=75.70%
[TRAIN][ep=029] mask_avg: mc_mean=0.2044 mb_mean=0.4982 norm_overlap=0.9936 corr_cb=-0.2806
[EPOCH 029/089] train: loss=0.7680 acc=75.70% | val: loss=0.6274 acc=66.27% f1=75.00% auc=71.57% val_score=65.7516 val_score_bestthr=69.3203 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.204, mb=0.498, no=0.994, corr=-0.281) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.3203
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2322 mb_mean=0.4994 norm_overlap=0.9948 corr_cb=-0.2764 topkJ=0.0239
[TRAIN][ep=030] loss=0.7686 acc=74.36%
[TRAIN][ep=030] mask_avg: mc_mean=0.2168 mb_mean=0.4982 norm_overlap=0.9940 corr_cb=-0.2730
[EPOCH 030/089] train: loss=0.7686 acc=74.36% | val: loss=0.6243 acc=67.47% f1=74.77% auc=72.56% val_score=52.9436 val_score_bestthr=68.6174 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.217, mb=0.498, no=0.994, corr=-0.273) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.6174
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2312 mb_mean=0.4974 norm_overlap=0.9959 corr_cb=-0.2205 topkJ=0.0413
[TRAIN][ep=031] loss=0.7569 acc=76.11%
[TRAIN][ep=031] mask_avg: mc_mean=0.2183 mb_mean=0.4982 norm_overlap=0.9937 corr_cb=-0.2800
[EPOCH 031/089] train: loss=0.7569 acc=76.11% | val: loss=0.5981 acc=69.88% f1=72.53% auc=74.07% val_score=65.1700 val_score_bestthr=70.7928 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.218, mb=0.498, no=0.994, corr=-0.280) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 70.7928
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.0820 mb_mean=0.4974 norm_overlap=0.9943 corr_cb=-0.1760 topkJ=0.0249
[TRAIN][ep=032] loss=0.7723 acc=74.23%
[TRAIN][ep=032] mask_avg: mc_mean=0.1538 mb_mean=0.4982 norm_overlap=0.9925 corr_cb=-0.2595
[EPOCH 032/089] train: loss=0.7723 acc=74.23% | val: loss=0.6334 acc=67.47% f1=75.68% auc=71.92% val_score=50.5703 val_score_bestthr=72.5854 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.154, mb=0.498, no=0.992, corr=-0.260) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 72.5854
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2542 mb_mean=0.4964 norm_overlap=0.9951 corr_cb=-0.2799 topkJ=0.0311
[TRAIN][ep=033] loss=0.7520 acc=76.24%
[TRAIN][ep=033] mask_avg: mc_mean=0.2122 mb_mean=0.4982 norm_overlap=0.9934 corr_cb=-0.2864
[EPOCH 033/089] train: loss=0.7520 acc=76.24% | val: loss=0.6358 acc=68.67% f1=75.93% auc=72.67% val_score=54.5348 val_score_bestthr=70.7418 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.212, mb=0.498, no=0.993, corr=-0.286) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 70.7418
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2101 mb_mean=0.4971 norm_overlap=0.9933 corr_cb=-0.2691 topkJ=0.0214
[TRAIN][ep=034] loss=0.7494 acc=75.44%
[TRAIN][ep=034] mask_avg: mc_mean=0.2041 mb_mean=0.4982 norm_overlap=0.9934 corr_cb=-0.2826
[EPOCH 034/089] train: loss=0.7494 acc=75.44% | val: loss=0.6181 acc=66.27% f1=68.89% auc=71.80% val_score=60.0411 val_score_bestthr=67.8208 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.204, mb=0.498, no=0.993, corr=-0.283) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 67.8208
[EARLY STOP] no improvement for 30 epochs. best_epoch=4
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
=============== FIT DONE ===============
[BEST] epoch=4 | val_acc=71.08% | val_f1=77.36% | val_auc=72.21% | val_score=74.3337 | val_score_bestthr=74.3337
[TEST@BEST] thr_used=0.580 | acc=63.77% f1=61.54% auc=65.41% | SP_sex=10.15% EO_sex=6.61% SP_age=10.52% EO_age=6.58%
[TIME] 0.89 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/summary_fold_2.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4409 mb_mean=0.4998 norm_overlap=0.9999 corr_cb=-0.1537 topkJ=0.0142
[TRAIN][ep=000] loss=0.6950 acc=50.07%
[TRAIN][ep=000] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2179
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4456 mb_mean=0.4977 norm_overlap=0.9998 corr_cb=-0.3429 topkJ=0.0084
[TRAIN][ep=001] loss=0.6929 acc=50.87%
[TRAIN][ep=001] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2197
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4416 mb_mean=0.4967 norm_overlap=1.0000 corr_cb=-0.0925 topkJ=0.0328
[TRAIN][ep=002] loss=0.6924 acc=50.87%
[TRAIN][ep=002] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2149
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4401 mb_mean=0.4989 norm_overlap=0.9997 corr_cb=-0.3682 topkJ=0.0059
[TRAIN][ep=003] loss=0.6906 acc=54.23%
[TRAIN][ep=003] mask_avg: mc_mean=0.4421 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2220
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4399 mb_mean=0.4974 norm_overlap=0.9999 corr_cb=-0.1290 topkJ=0.0272
[TRAIN][ep=004] loss=0.6889 acc=56.78%
[TRAIN][ep=004] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2177
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4388 mb_mean=0.4999 norm_overlap=0.9998 corr_cb=-0.3849 topkJ=0.0055
[TRAIN][ep=005] loss=0.6873 acc=53.83%
[TRAIN][ep=005] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2149
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4421 mb_mean=0.4993 norm_overlap=0.9998 corr_cb=-0.2996 topkJ=0.0246
[TRAIN][ep=006] loss=0.6838 acc=55.44%
[TRAIN][ep=006] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2113
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4448 mb_mean=0.4952 norm_overlap=1.0000 corr_cb=0.0093 topkJ=0.0332
[TRAIN][ep=007] loss=0.6811 acc=59.87%
[TRAIN][ep=007] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2179
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4400 mb_mean=0.4972 norm_overlap=1.0000 corr_cb=-0.0037 topkJ=0.0472
[TRAIN][ep=008] loss=0.6783 acc=61.21%
[TRAIN][ep=008] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2155
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4446 mb_mean=0.4966 norm_overlap=0.9999 corr_cb=-0.2381 topkJ=0.0197
[TRAIN][ep=009] loss=0.6708 acc=59.46%
[TRAIN][ep=009] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2154
================= FIT START (fold=2) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4430 mb_mean=0.4980 norm_overlap=1.0000 corr_cb=-0.1091 topkJ=0.0223
[TRAIN][ep=000] loss=0.6696 acc=60.40%
[TRAIN][ep=000] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2180
[EPOCH 000/089] train: loss=0.6696 acc=60.40% | val: loss=0.6634 acc=71.08% f1=76.92% auc=71.57% val_score=69.3393 val_score_bestthr=68.6591 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.218) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 68.6591
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4450 mb_mean=0.4972 norm_overlap=0.9999 corr_cb=-0.1381 topkJ=0.0336
[TRAIN][ep=001] loss=0.6650 acc=60.67%
[TRAIN][ep=001] mask_avg: mc_mean=0.4421 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2187
[EPOCH 001/089] train: loss=0.6650 acc=60.67% | val: loss=0.6591 acc=68.67% f1=72.34% auc=71.34% val_score=67.1354 val_score_bestthr=72.7288 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.219) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 68.6591 -> 72.7288
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4416 mb_mean=0.4970 norm_overlap=0.9999 corr_cb=-0.1910 topkJ=0.0291
[TRAIN][ep=002] loss=0.6560 acc=62.55%
[TRAIN][ep=002] mask_avg: mc_mean=0.4421 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2200
[EPOCH 002/089] train: loss=0.6560 acc=62.55% | val: loss=0.6559 acc=68.67% f1=73.47% auc=69.71% val_score=65.8565 val_score_bestthr=69.0984 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.220) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7288 -> 69.0984
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4419 mb_mean=0.4995 norm_overlap=0.9998 corr_cb=-0.3017 topkJ=0.0204
[TRAIN][ep=003] loss=0.6534 acc=60.81%
[TRAIN][ep=003] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2169
[EPOCH 003/089] train: loss=0.6534 acc=60.81% | val: loss=0.6815 acc=69.88% f1=73.68% auc=70.64% val_score=61.3370 val_score_bestthr=71.4030 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.217) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7288 -> 71.4030
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4404 mb_mean=0.4979 norm_overlap=0.9999 corr_cb=-0.1561 topkJ=0.0339
[TRAIN][ep=004] loss=0.6513 acc=62.15%
[TRAIN][ep=004] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2191
[EPOCH 004/089] train: loss=0.6513 acc=62.15% | val: loss=0.6489 acc=71.08% f1=77.36% auc=72.15% val_score=74.3337 val_score_bestthr=74.3337 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.219) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 72.7288 -> 74.3337
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4474 mb_mean=0.4984 norm_overlap=1.0000 corr_cb=-0.0752 topkJ=0.0199
[TRAIN][ep=005] loss=1.4717 acc=62.28%
[TRAIN][ep=005] mask_avg: mc_mean=0.3185 mb_mean=0.4982 norm_overlap=0.9991 corr_cb=-0.2713
[EPOCH 005/089] train: loss=1.4717 acc=62.28% | val: loss=0.6673 acc=66.27% f1=68.18% auc=69.88% val_score=47.1055 val_score_bestthr=68.0173 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.318, mb=0.498, no=0.999, corr=-0.271) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.0173
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2524 mb_mean=0.4984 norm_overlap=0.9986 corr_cb=-0.2162 topkJ=0.0245
[TRAIN][ep=006] loss=1.4577 acc=62.95%
[TRAIN][ep=006] mask_avg: mc_mean=0.2179 mb_mean=0.4982 norm_overlap=0.9984 corr_cb=-0.2374
[EPOCH 006/089] train: loss=1.4577 acc=62.95% | val: loss=0.6462 acc=69.88% f1=76.64% auc=73.02% val_score=64.1822 val_score_bestthr=70.0804 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.218, mb=0.498, no=0.998, corr=-0.237) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 70.0804
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2374 mb_mean=0.5001 norm_overlap=0.9983 corr_cb=-0.2419 topkJ=0.0478
[TRAIN][ep=007] loss=1.4455 acc=63.76%
[TRAIN][ep=007] mask_avg: mc_mean=0.1776 mb_mean=0.4982 norm_overlap=0.9980 corr_cb=-0.2194
[EPOCH 007/089] train: loss=1.4455 acc=63.76% | val: loss=0.6425 acc=69.88% f1=76.19% auc=73.20% val_score=61.4276 val_score_bestthr=70.7175 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.178, mb=0.498, no=0.998, corr=-0.219) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 70.7175
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1684 mb_mean=0.4984 norm_overlap=0.9984 corr_cb=-0.2012 topkJ=0.0447
[TRAIN][ep=008] loss=1.4298 acc=66.44%
[TRAIN][ep=008] mask_avg: mc_mean=0.1430 mb_mean=0.4982 norm_overlap=0.9976 corr_cb=-0.1926
[EPOCH 008/089] train: loss=1.4298 acc=66.44% | val: loss=0.6693 acc=71.08% f1=75.00% auc=71.69% val_score=64.4280 val_score_bestthr=68.0334 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.143, mb=0.498, no=0.998, corr=-0.193) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.0334
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1318 mb_mean=0.4974 norm_overlap=0.9973 corr_cb=-0.2234 topkJ=0.0255
[TRAIN][ep=009] loss=1.4273 acc=65.23%
[TRAIN][ep=009] mask_avg: mc_mean=0.1328 mb_mean=0.4982 norm_overlap=0.9971 corr_cb=-0.2056
[EPOCH 009/089] train: loss=1.4273 acc=65.23% | val: loss=0.6475 acc=66.27% f1=75.00% auc=72.38% val_score=71.9483 val_score_bestthr=71.9483 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.133, mb=0.498, no=0.997, corr=-0.206) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 71.9483
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1358 mb_mean=0.4962 norm_overlap=0.9957 corr_cb=-0.2970 topkJ=0.0240
[TRAIN][ep=010] loss=1.1817 acc=65.91%
[TRAIN][ep=010] mask_avg: mc_mean=0.1306 mb_mean=0.4982 norm_overlap=0.9966 corr_cb=-0.2200
[EPOCH 010/089] train: loss=1.1817 acc=65.91% | val: loss=0.6367 acc=67.47% f1=75.68% auc=72.85% val_score=67.7793 val_score_bestthr=72.3795 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.131, mb=0.498, no=0.997, corr=-0.220) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 72.3795
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1550 mb_mean=0.4990 norm_overlap=0.9967 corr_cb=-0.2445 topkJ=0.0253
[TRAIN][ep=011] loss=0.9508 acc=67.11%
[TRAIN][ep=011] mask_avg: mc_mean=0.1386 mb_mean=0.4982 norm_overlap=0.9965 corr_cb=-0.2119
[EPOCH 011/089] train: loss=0.9508 acc=67.11% | val: loss=0.6494 acc=71.08% f1=75.51% auc=71.05% val_score=52.6552 val_score_bestthr=69.8660 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.139, mb=0.498, no=0.996, corr=-0.212) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.8660
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1630 mb_mean=0.4965 norm_overlap=0.9984 corr_cb=-0.1179 topkJ=0.0670
[TRAIN][ep=012] loss=0.8870 acc=68.59%
[TRAIN][ep=012] mask_avg: mc_mean=0.1414 mb_mean=0.4982 norm_overlap=0.9960 corr_cb=-0.2225
[EPOCH 012/089] train: loss=0.8870 acc=68.59% | val: loss=0.6220 acc=71.08% f1=76.47% auc=72.73% val_score=58.3227 val_score_bestthr=71.6864 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.141, mb=0.498, no=0.996, corr=-0.222) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 71.6864
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.0979 mb_mean=0.5001 norm_overlap=0.9935 corr_cb=-0.2881 topkJ=0.0358
[TRAIN][ep=013] loss=0.8648 acc=67.79%
[TRAIN][ep=013] mask_avg: mc_mean=0.1547 mb_mean=0.4982 norm_overlap=0.9954 corr_cb=-0.2575
[EPOCH 013/089] train: loss=0.8648 acc=67.79% | val: loss=0.6232 acc=72.29% f1=76.29% auc=71.98% val_score=62.4943 val_score_bestthr=73.1465 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.155, mb=0.498, no=0.995, corr=-0.257) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 73.1465
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1828 mb_mean=0.4970 norm_overlap=0.9947 corr_cb=-0.3068 topkJ=0.0169
[TRAIN][ep=014] loss=0.8658 acc=68.99%
[TRAIN][ep=014] mask_avg: mc_mean=0.1788 mb_mean=0.4982 norm_overlap=0.9952 corr_cb=-0.2743
[EPOCH 014/089] train: loss=0.8658 acc=68.99% | val: loss=0.6163 acc=71.08% f1=76.00% auc=72.91% val_score=59.2691 val_score_bestthr=70.6726 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.179, mb=0.498, no=0.995, corr=-0.274) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 70.6726
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1647 mb_mean=0.4996 norm_overlap=0.9920 corr_cb=-0.4314 topkJ=0.0254
[TRAIN][ep=015] loss=0.8553 acc=68.99%
[TRAIN][ep=015] mask_avg: mc_mean=0.1620 mb_mean=0.4982 norm_overlap=0.9940 corr_cb=-0.3175
[EPOCH 015/089] train: loss=0.8553 acc=68.99% | val: loss=0.6276 acc=68.67% f1=72.34% auc=72.73% val_score=56.0182 val_score_bestthr=68.6838 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.162, mb=0.498, no=0.994, corr=-0.318) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.6838
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1771 mb_mean=0.4984 norm_overlap=0.9965 corr_cb=-0.2069 topkJ=0.0264
[TRAIN][ep=016] loss=0.8563 acc=71.28%
[TRAIN][ep=016] mask_avg: mc_mean=0.1994 mb_mean=0.4982 norm_overlap=0.9939 corr_cb=-0.3478
[EPOCH 016/089] train: loss=0.8563 acc=71.28% | val: loss=0.6165 acc=69.88% f1=75.25% auc=72.85% val_score=62.4943 val_score_bestthr=68.6436 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.199, mb=0.498, no=0.994, corr=-0.348) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.6436
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1650 mb_mean=0.4984 norm_overlap=0.9933 corr_cb=-0.2920 topkJ=0.0265
[TRAIN][ep=017] loss=0.8446 acc=68.99%
[TRAIN][ep=017] mask_avg: mc_mean=0.1697 mb_mean=0.4982 norm_overlap=0.9932 corr_cb=-0.3317
[EPOCH 017/089] train: loss=0.8446 acc=68.99% | val: loss=0.6104 acc=67.47% f1=72.73% auc=72.85% val_score=61.7641 val_score_bestthr=70.0360 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.170, mb=0.498, no=0.993, corr=-0.332) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 70.0360
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1488 mb_mean=0.4979 norm_overlap=0.9936 corr_cb=-0.2913 topkJ=0.0193
[TRAIN][ep=018] loss=0.8288 acc=71.41%
[TRAIN][ep=018] mask_avg: mc_mean=0.1745 mb_mean=0.4982 norm_overlap=0.9931 corr_cb=-0.3277
[EPOCH 018/089] train: loss=0.8288 acc=71.41% | val: loss=0.6131 acc=69.88% f1=74.23% auc=72.67% val_score=62.4943 val_score_bestthr=69.3476 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.174, mb=0.498, no=0.993, corr=-0.328) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.3476
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.2046 mb_mean=0.5006 norm_overlap=0.9927 corr_cb=-0.4077 topkJ=0.0154
[TRAIN][ep=019] loss=0.8439 acc=70.60%
[TRAIN][ep=019] mask_avg: mc_mean=0.1937 mb_mean=0.4982 norm_overlap=0.9928 corr_cb=-0.3568
[EPOCH 019/089] train: loss=0.8439 acc=70.60% | val: loss=0.6096 acc=67.47% f1=72.73% auc=72.56% val_score=54.6218 val_score_bestthr=67.4367 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.194, mb=0.498, no=0.993, corr=-0.357) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 67.4367
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.2254 mb_mean=0.4972 norm_overlap=0.9909 corr_cb=-0.4242 topkJ=0.0012
[TRAIN][ep=020] loss=0.8362 acc=69.53%
[TRAIN][ep=020] mask_avg: mc_mean=0.1786 mb_mean=0.4982 norm_overlap=0.9924 corr_cb=-0.3608
[EPOCH 020/089] train: loss=0.8362 acc=69.53% | val: loss=0.6089 acc=67.47% f1=75.68% auc=73.37% val_score=64.4585 val_score_bestthr=69.7154 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.179, mb=0.498, no=0.992, corr=-0.361) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.7154
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2326 mb_mean=0.4957 norm_overlap=0.9941 corr_cb=-0.3414 topkJ=0.0179
[TRAIN][ep=021] loss=0.8176 acc=72.75%
[TRAIN][ep=021] mask_avg: mc_mean=0.1963 mb_mean=0.4982 norm_overlap=0.9929 corr_cb=-0.3453
[EPOCH 021/089] train: loss=0.8176 acc=72.75% | val: loss=0.6049 acc=69.88% f1=71.26% auc=73.08% val_score=65.5137 val_score_bestthr=70.7970 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.196, mb=0.498, no=0.993, corr=-0.345) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 70.7970
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2071 mb_mean=0.4977 norm_overlap=0.9955 corr_cb=-0.2715 topkJ=0.0280
[TRAIN][ep=022] loss=0.8022 acc=73.96%
[TRAIN][ep=022] mask_avg: mc_mean=0.2037 mb_mean=0.4982 norm_overlap=0.9934 corr_cb=-0.3168
[EPOCH 022/089] train: loss=0.8022 acc=73.96% | val: loss=0.6193 acc=69.88% f1=73.68% auc=73.37% val_score=57.7917 val_score_bestthr=68.1984 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.204, mb=0.498, no=0.993, corr=-0.317) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.1984
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1566 mb_mean=0.4976 norm_overlap=0.9942 corr_cb=-0.2436 topkJ=0.0218
[TRAIN][ep=023] loss=0.8240 acc=71.41%
[TRAIN][ep=023] mask_avg: mc_mean=0.1965 mb_mean=0.4982 norm_overlap=0.9931 corr_cb=-0.3211
[EPOCH 023/089] train: loss=0.8240 acc=71.41% | val: loss=0.7035 acc=69.88% f1=76.64% auc=72.67% val_score=45.7063 val_score_bestthr=69.6805 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.197, mb=0.498, no=0.993, corr=-0.321) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.6805
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1936 mb_mean=0.4983 norm_overlap=0.9921 corr_cb=-0.3517 topkJ=0.0274
[TRAIN][ep=024] loss=0.8052 acc=74.36%
[TRAIN][ep=024] mask_avg: mc_mean=0.1871 mb_mean=0.4982 norm_overlap=0.9929 corr_cb=-0.3150
[EPOCH 024/089] train: loss=0.8052 acc=74.36% | val: loss=0.6081 acc=69.88% f1=71.26% auc=72.79% val_score=62.3068 val_score_bestthr=70.7970 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.187, mb=0.498, no=0.993, corr=-0.315) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 70.7970
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2299 mb_mean=0.4978 norm_overlap=0.9915 corr_cb=-0.3664 topkJ=0.0121
[TRAIN][ep=025] loss=0.8123 acc=73.69%
[TRAIN][ep=025] mask_avg: mc_mean=0.1948 mb_mean=0.4982 norm_overlap=0.9934 corr_cb=-0.2926
[EPOCH 025/089] train: loss=0.8123 acc=73.69% | val: loss=0.6111 acc=66.27% f1=74.55% auc=72.27% val_score=68.1367 val_score_bestthr=69.3455 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.195, mb=0.498, no=0.993, corr=-0.293) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.3455
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1655 mb_mean=0.4982 norm_overlap=0.9931 corr_cb=-0.3150 topkJ=0.0150
[TRAIN][ep=026] loss=0.7855 acc=74.23%
[TRAIN][ep=026] mask_avg: mc_mean=0.2185 mb_mean=0.4982 norm_overlap=0.9933 corr_cb=-0.3238
[EPOCH 026/089] train: loss=0.7855 acc=74.23% | val: loss=0.6079 acc=67.47% f1=75.23% auc=72.62% val_score=63.1208 val_score_bestthr=69.7779 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.219, mb=0.498, no=0.993, corr=-0.324) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.7779
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2418 mb_mean=0.4957 norm_overlap=0.9898 corr_cb=-0.4235 topkJ=0.0048
[TRAIN][ep=027] loss=0.7793 acc=75.84%
[TRAIN][ep=027] mask_avg: mc_mean=0.2017 mb_mean=0.4982 norm_overlap=0.9933 corr_cb=-0.2989
[EPOCH 027/089] train: loss=0.7793 acc=75.84% | val: loss=0.6577 acc=65.06% f1=73.87% auc=71.51% val_score=63.5534 val_score_bestthr=68.9509 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.202, mb=0.498, no=0.993, corr=-0.299) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.9509
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1983 mb_mean=0.5019 norm_overlap=0.9845 corr_cb=-0.5165 topkJ=0.0023
[TRAIN][ep=028] loss=0.7649 acc=75.70%
[TRAIN][ep=028] mask_avg: mc_mean=0.2237 mb_mean=0.4982 norm_overlap=0.9938 corr_cb=-0.2899
[EPOCH 028/089] train: loss=0.7649 acc=75.70% | val: loss=0.7379 acc=66.27% f1=72.00% auc=70.99% val_score=68.3578 val_score_bestthr=67.1962 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.224, mb=0.498, no=0.994, corr=-0.290) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 67.1962
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2214 mb_mean=0.4959 norm_overlap=0.9959 corr_cb=-0.2067 topkJ=0.0225
[TRAIN][ep=029] loss=0.7682 acc=75.70%
[TRAIN][ep=029] mask_avg: mc_mean=0.2040 mb_mean=0.4982 norm_overlap=0.9936 corr_cb=-0.2813
[EPOCH 029/089] train: loss=0.7682 acc=75.70% | val: loss=0.6278 acc=66.27% f1=75.00% auc=71.74% val_score=65.7516 val_score_bestthr=69.3203 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.204, mb=0.498, no=0.994, corr=-0.281) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.3203
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2309 mb_mean=0.4994 norm_overlap=0.9948 corr_cb=-0.2774 topkJ=0.0234
[TRAIN][ep=030] loss=0.7689 acc=74.36%
[TRAIN][ep=030] mask_avg: mc_mean=0.2159 mb_mean=0.4982 norm_overlap=0.9939 corr_cb=-0.2734
[EPOCH 030/089] train: loss=0.7689 acc=74.36% | val: loss=0.6249 acc=67.47% f1=74.77% auc=72.50% val_score=52.9436 val_score_bestthr=68.6174 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.216, mb=0.498, no=0.994, corr=-0.273) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.6174
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2315 mb_mean=0.4974 norm_overlap=0.9959 corr_cb=-0.2214 topkJ=0.0413
[TRAIN][ep=031] loss=0.7571 acc=76.11%
[TRAIN][ep=031] mask_avg: mc_mean=0.2183 mb_mean=0.4982 norm_overlap=0.9936 corr_cb=-0.2810
[EPOCH 031/089] train: loss=0.7571 acc=76.11% | val: loss=0.5984 acc=69.88% f1=72.53% auc=74.01% val_score=65.1700 val_score_bestthr=70.7928 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.218, mb=0.498, no=0.994, corr=-0.281) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 70.7928
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.0818 mb_mean=0.4974 norm_overlap=0.9943 corr_cb=-0.1769 topkJ=0.0245
[TRAIN][ep=032] loss=0.7725 acc=74.23%
[TRAIN][ep=032] mask_avg: mc_mean=0.1532 mb_mean=0.4982 norm_overlap=0.9924 corr_cb=-0.2601
[EPOCH 032/089] train: loss=0.7725 acc=74.23% | val: loss=0.6337 acc=67.47% f1=75.68% auc=71.86% val_score=50.5703 val_score_bestthr=72.5854 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.153, mb=0.498, no=0.992, corr=-0.260) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 72.5854
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2547 mb_mean=0.4964 norm_overlap=0.9951 corr_cb=-0.2814 topkJ=0.0311
[TRAIN][ep=033] loss=0.7522 acc=76.24%
[TRAIN][ep=033] mask_avg: mc_mean=0.2121 mb_mean=0.4982 norm_overlap=0.9934 corr_cb=-0.2873
[EPOCH 033/089] train: loss=0.7522 acc=76.24% | val: loss=0.6360 acc=68.67% f1=75.93% auc=72.67% val_score=54.5348 val_score_bestthr=70.7418 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.212, mb=0.498, no=0.993, corr=-0.287) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 70.7418
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2100 mb_mean=0.4971 norm_overlap=0.9933 corr_cb=-0.2703 topkJ=0.0210
[TRAIN][ep=034] loss=0.7496 acc=75.44%
[TRAIN][ep=034] mask_avg: mc_mean=0.2037 mb_mean=0.4982 norm_overlap=0.9933 corr_cb=-0.2835
[EPOCH 034/089] train: loss=0.7496 acc=75.44% | val: loss=0.6184 acc=66.27% f1=68.89% auc=71.63% val_score=60.0411 val_score_bestthr=67.8208 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.204, mb=0.498, no=0.993, corr=-0.284) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 67.8208
[EARLY STOP] no improvement for 30 epochs. best_epoch=4
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
=============== FIT DONE ===============
[BEST] epoch=4 | val_acc=71.08% | val_f1=77.36% | val_auc=72.15% | val_score=74.3337 | val_score_bestthr=74.3337
[TEST@BEST] thr_used=0.580 | acc=63.77% f1=61.54% auc=65.34% | SP_sex=10.15% EO_sex=6.61% SP_age=10.52% EO_age=6.58%
[TIME] 0.97 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/summary_fold_2.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4409 mb_mean=0.4998 norm_overlap=0.9999 corr_cb=-0.1537 topkJ=0.0142
[TRAIN][ep=000] loss=0.6950 acc=50.07%
[TRAIN][ep=000] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2179
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4456 mb_mean=0.4977 norm_overlap=0.9998 corr_cb=-0.3429 topkJ=0.0084
[TRAIN][ep=001] loss=0.6929 acc=50.87%
[TRAIN][ep=001] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2197
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4416 mb_mean=0.4967 norm_overlap=1.0000 corr_cb=-0.0925 topkJ=0.0328
[TRAIN][ep=002] loss=0.6924 acc=50.87%
[TRAIN][ep=002] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2149
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4401 mb_mean=0.4989 norm_overlap=0.9997 corr_cb=-0.3682 topkJ=0.0059
[TRAIN][ep=003] loss=0.6906 acc=54.23%
[TRAIN][ep=003] mask_avg: mc_mean=0.4421 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2220
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4399 mb_mean=0.4974 norm_overlap=0.9999 corr_cb=-0.1290 topkJ=0.0272
[TRAIN][ep=004] loss=0.6889 acc=56.78%
[TRAIN][ep=004] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2177
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4388 mb_mean=0.4999 norm_overlap=0.9998 corr_cb=-0.3849 topkJ=0.0055
[TRAIN][ep=005] loss=0.6873 acc=53.83%
[TRAIN][ep=005] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2149
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4421 mb_mean=0.4993 norm_overlap=0.9998 corr_cb=-0.2996 topkJ=0.0246
[TRAIN][ep=006] loss=0.6838 acc=55.44%
[TRAIN][ep=006] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2113
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4448 mb_mean=0.4952 norm_overlap=1.0000 corr_cb=0.0093 topkJ=0.0332
[TRAIN][ep=007] loss=0.6811 acc=59.87%
[TRAIN][ep=007] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2179
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4400 mb_mean=0.4972 norm_overlap=1.0000 corr_cb=-0.0037 topkJ=0.0472
[TRAIN][ep=008] loss=0.6783 acc=61.21%
[TRAIN][ep=008] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2155
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4446 mb_mean=0.4966 norm_overlap=0.9999 corr_cb=-0.2381 topkJ=0.0197
[TRAIN][ep=009] loss=0.6708 acc=59.46%
[TRAIN][ep=009] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2154
================= FIT START (fold=2) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4430 mb_mean=0.4980 norm_overlap=1.0000 corr_cb=-0.1091 topkJ=0.0223
[TRAIN][ep=000] loss=0.6696 acc=60.40%
[TRAIN][ep=000] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2180
[EPOCH 000/089] train: loss=0.6696 acc=60.40% | val: loss=0.6634 acc=71.08% f1=76.92% auc=71.57% val_score=69.3393 val_score_bestthr=68.6591 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.218) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 68.6591
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4450 mb_mean=0.4972 norm_overlap=0.9999 corr_cb=-0.1381 topkJ=0.0336
[TRAIN][ep=001] loss=0.6650 acc=60.67%
[TRAIN][ep=001] mask_avg: mc_mean=0.4421 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2187
[EPOCH 001/089] train: loss=0.6650 acc=60.67% | val: loss=0.6591 acc=68.67% f1=72.34% auc=71.34% val_score=67.1354 val_score_bestthr=72.7288 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.219) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 68.6591 -> 72.7288
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4416 mb_mean=0.4970 norm_overlap=0.9999 corr_cb=-0.1910 topkJ=0.0291
[TRAIN][ep=002] loss=0.6560 acc=62.55%
[TRAIN][ep=002] mask_avg: mc_mean=0.4421 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2200
[EPOCH 002/089] train: loss=0.6560 acc=62.55% | val: loss=0.6559 acc=68.67% f1=73.47% auc=69.71% val_score=65.8565 val_score_bestthr=69.0984 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.220) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7288 -> 69.0984
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4419 mb_mean=0.4995 norm_overlap=0.9998 corr_cb=-0.3017 topkJ=0.0204
[TRAIN][ep=003] loss=0.6534 acc=60.81%
[TRAIN][ep=003] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2169
[EPOCH 003/089] train: loss=0.6534 acc=60.81% | val: loss=0.6815 acc=69.88% f1=73.68% auc=70.64% val_score=61.3370 val_score_bestthr=71.4030 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.217) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7288 -> 71.4030
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4404 mb_mean=0.4979 norm_overlap=0.9999 corr_cb=-0.1561 topkJ=0.0339
[TRAIN][ep=004] loss=0.6513 acc=62.15%
[TRAIN][ep=004] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2191
[EPOCH 004/089] train: loss=0.6513 acc=62.15% | val: loss=0.6489 acc=71.08% f1=77.36% auc=72.15% val_score=74.3337 val_score_bestthr=74.3337 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.219) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 72.7288 -> 74.3337
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4474 mb_mean=0.4984 norm_overlap=1.0000 corr_cb=-0.0752 topkJ=0.0199
[TRAIN][ep=005] loss=1.2337 acc=62.28%
[TRAIN][ep=005] mask_avg: mc_mean=0.3167 mb_mean=0.4982 norm_overlap=0.9991 corr_cb=-0.2691
[EPOCH 005/089] train: loss=1.2337 acc=62.28% | val: loss=0.6664 acc=66.27% f1=68.18% auc=69.94% val_score=44.1685 val_score_bestthr=68.0173 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.317, mb=0.498, no=0.999, corr=-0.269) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.0173
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2513 mb_mean=0.4984 norm_overlap=0.9986 corr_cb=-0.2155 topkJ=0.0241
[TRAIN][ep=006] loss=1.2269 acc=62.68%
[TRAIN][ep=006] mask_avg: mc_mean=0.2171 mb_mean=0.4982 norm_overlap=0.9984 corr_cb=-0.2364
[EPOCH 006/089] train: loss=1.2269 acc=62.68% | val: loss=0.6463 acc=69.88% f1=76.64% auc=72.67% val_score=64.7852 val_score_bestthr=70.0804 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.217, mb=0.498, no=0.998, corr=-0.236) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 70.0804
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2379 mb_mean=0.5001 norm_overlap=0.9983 corr_cb=-0.2413 topkJ=0.0473
[TRAIN][ep=007] loss=1.2148 acc=63.76%
[TRAIN][ep=007] mask_avg: mc_mean=0.1782 mb_mean=0.4982 norm_overlap=0.9980 corr_cb=-0.2188
[EPOCH 007/089] train: loss=1.2148 acc=63.76% | val: loss=0.6428 acc=71.08% f1=76.92% auc=72.79% val_score=61.4276 val_score_bestthr=72.2412 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.178, mb=0.498, no=0.998, corr=-0.219) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 72.2412
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1681 mb_mean=0.4984 norm_overlap=0.9984 corr_cb=-0.2000 topkJ=0.0447
[TRAIN][ep=008] loss=1.1994 acc=66.31%
[TRAIN][ep=008] mask_avg: mc_mean=0.1427 mb_mean=0.4982 norm_overlap=0.9977 corr_cb=-0.1909
[EPOCH 008/089] train: loss=1.1994 acc=66.31% | val: loss=0.6707 acc=71.08% f1=75.00% auc=71.63% val_score=64.4280 val_score_bestthr=68.0334 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.143, mb=0.498, no=0.998, corr=-0.191) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.0334
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1317 mb_mean=0.4974 norm_overlap=0.9973 corr_cb=-0.2211 topkJ=0.0255
[TRAIN][ep=009] loss=1.1978 acc=65.37%
[TRAIN][ep=009] mask_avg: mc_mean=0.1328 mb_mean=0.4982 norm_overlap=0.9971 corr_cb=-0.2043
[EPOCH 009/089] train: loss=1.1978 acc=65.37% | val: loss=0.6477 acc=66.27% f1=75.00% auc=72.15% val_score=71.9483 val_score_bestthr=71.9483 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.133, mb=0.498, no=0.997, corr=-0.204) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 71.9483
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1351 mb_mean=0.4962 norm_overlap=0.9957 corr_cb=-0.2966 topkJ=0.0240
[TRAIN][ep=010] loss=0.9872 acc=66.04%
[TRAIN][ep=010] mask_avg: mc_mean=0.1303 mb_mean=0.4982 norm_overlap=0.9966 corr_cb=-0.2190
[EPOCH 010/089] train: loss=0.9872 acc=66.04% | val: loss=0.6370 acc=67.47% f1=75.68% auc=72.67% val_score=67.7793 val_score_bestthr=72.3795 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.130, mb=0.498, no=0.997, corr=-0.219) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 72.3795
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1546 mb_mean=0.4990 norm_overlap=0.9967 corr_cb=-0.2433 topkJ=0.0258
[TRAIN][ep=011] loss=0.7916 acc=66.98%
[TRAIN][ep=011] mask_avg: mc_mean=0.1379 mb_mean=0.4982 norm_overlap=0.9965 corr_cb=-0.2106
[EPOCH 011/089] train: loss=0.7916 acc=66.98% | val: loss=0.6496 acc=69.88% f1=74.23% auc=71.05% val_score=52.6552 val_score_bestthr=67.2798 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.138, mb=0.498, no=0.997, corr=-0.211) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 67.2798
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1603 mb_mean=0.4965 norm_overlap=0.9984 corr_cb=-0.1154 topkJ=0.0675
[TRAIN][ep=012] loss=0.7455 acc=68.32%
[TRAIN][ep=012] mask_avg: mc_mean=0.1402 mb_mean=0.4982 norm_overlap=0.9960 corr_cb=-0.2211
[EPOCH 012/089] train: loss=0.7455 acc=68.32% | val: loss=0.6222 acc=69.88% f1=74.75% auc=72.79% val_score=58.3227 val_score_bestthr=69.8778 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.140, mb=0.498, no=0.996, corr=-0.221) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.8778
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.0972 mb_mean=0.5001 norm_overlap=0.9935 corr_cb=-0.2870 topkJ=0.0358
[TRAIN][ep=013] loss=0.7237 acc=67.65%
[TRAIN][ep=013] mask_avg: mc_mean=0.1545 mb_mean=0.4982 norm_overlap=0.9954 corr_cb=-0.2570
[EPOCH 013/089] train: loss=0.7237 acc=67.65% | val: loss=0.6229 acc=72.29% f1=76.29% auc=72.03% val_score=62.4943 val_score_bestthr=73.1465 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.154, mb=0.498, no=0.995, corr=-0.257) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 73.1465
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1822 mb_mean=0.4970 norm_overlap=0.9947 corr_cb=-0.3067 topkJ=0.0169
[TRAIN][ep=014] loss=0.7251 acc=68.46%
[TRAIN][ep=014] mask_avg: mc_mean=0.1791 mb_mean=0.4982 norm_overlap=0.9952 corr_cb=-0.2748
[EPOCH 014/089] train: loss=0.7251 acc=68.46% | val: loss=0.6166 acc=69.88% f1=75.25% auc=72.91% val_score=59.2691 val_score_bestthr=69.1460 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.179, mb=0.498, no=0.995, corr=-0.275) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.1460
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1652 mb_mean=0.4996 norm_overlap=0.9920 corr_cb=-0.4321 topkJ=0.0254
[TRAIN][ep=015] loss=0.7151 acc=69.26%
[TRAIN][ep=015] mask_avg: mc_mean=0.1621 mb_mean=0.4982 norm_overlap=0.9940 corr_cb=-0.3182
[EPOCH 015/089] train: loss=0.7151 acc=69.26% | val: loss=0.6274 acc=68.67% f1=72.34% auc=72.91% val_score=56.0182 val_score_bestthr=68.6838 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.162, mb=0.498, no=0.994, corr=-0.318) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.6838
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1768 mb_mean=0.4984 norm_overlap=0.9965 corr_cb=-0.2064 topkJ=0.0264
[TRAIN][ep=016] loss=0.7161 acc=71.28%
[TRAIN][ep=016] mask_avg: mc_mean=0.1996 mb_mean=0.4982 norm_overlap=0.9939 corr_cb=-0.3482
[EPOCH 016/089] train: loss=0.7161 acc=71.28% | val: loss=0.6165 acc=69.88% f1=74.75% auc=72.97% val_score=60.8079 val_score_bestthr=70.2978 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.200, mb=0.498, no=0.994, corr=-0.348) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 70.2978
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1647 mb_mean=0.4984 norm_overlap=0.9933 corr_cb=-0.2931 topkJ=0.0265
[TRAIN][ep=017] loss=0.7052 acc=69.13%
[TRAIN][ep=017] mask_avg: mc_mean=0.1690 mb_mean=0.4982 norm_overlap=0.9932 corr_cb=-0.3318
[EPOCH 017/089] train: loss=0.7052 acc=69.13% | val: loss=0.6101 acc=68.67% f1=75.00% auc=72.67% val_score=61.7641 val_score_bestthr=68.0330 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.169, mb=0.498, no=0.993, corr=-0.332) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.0330
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1474 mb_mean=0.4979 norm_overlap=0.9936 corr_cb=-0.2905 topkJ=0.0193
[TRAIN][ep=018] loss=0.6898 acc=71.54%
[TRAIN][ep=018] mask_avg: mc_mean=0.1738 mb_mean=0.4982 norm_overlap=0.9931 corr_cb=-0.3285
[EPOCH 018/089] train: loss=0.6898 acc=71.54% | val: loss=0.6130 acc=68.67% f1=72.92% auc=72.91% val_score=62.4943 val_score_bestthr=68.5441 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.174, mb=0.498, no=0.993, corr=-0.329) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.5441
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.2040 mb_mean=0.5006 norm_overlap=0.9927 corr_cb=-0.4086 topkJ=0.0154
[TRAIN][ep=019] loss=0.7051 acc=70.60%
[TRAIN][ep=019] mask_avg: mc_mean=0.1929 mb_mean=0.4982 norm_overlap=0.9928 corr_cb=-0.3576
[EPOCH 019/089] train: loss=0.7051 acc=70.60% | val: loss=0.6093 acc=67.47% f1=72.73% auc=72.62% val_score=54.6218 val_score_bestthr=67.4367 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.193, mb=0.498, no=0.993, corr=-0.358) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 67.4367
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.2236 mb_mean=0.4972 norm_overlap=0.9909 corr_cb=-0.4230 topkJ=0.0012
[TRAIN][ep=020] loss=0.6979 acc=69.66%
[TRAIN][ep=020] mask_avg: mc_mean=0.1769 mb_mean=0.4982 norm_overlap=0.9923 corr_cb=-0.3615
[EPOCH 020/089] train: loss=0.6979 acc=69.66% | val: loss=0.6085 acc=67.47% f1=75.68% auc=73.43% val_score=65.9859 val_score_bestthr=69.7154 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.177, mb=0.498, no=0.992, corr=-0.362) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.7154
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2318 mb_mean=0.4957 norm_overlap=0.9941 corr_cb=-0.3422 topkJ=0.0179
[TRAIN][ep=021] loss=0.6794 acc=73.02%
[TRAIN][ep=021] mask_avg: mc_mean=0.1958 mb_mean=0.4982 norm_overlap=0.9929 corr_cb=-0.3467
[EPOCH 021/089] train: loss=0.6794 acc=73.02% | val: loss=0.6046 acc=69.88% f1=71.26% auc=73.31% val_score=62.8808 val_score_bestthr=70.7970 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.196, mb=0.498, no=0.993, corr=-0.347) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 70.7970
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2078 mb_mean=0.4977 norm_overlap=0.9955 corr_cb=-0.2732 topkJ=0.0276
[TRAIN][ep=022] loss=0.6656 acc=73.96%
[TRAIN][ep=022] mask_avg: mc_mean=0.2039 mb_mean=0.4982 norm_overlap=0.9934 corr_cb=-0.3181
[EPOCH 022/089] train: loss=0.6656 acc=73.96% | val: loss=0.6194 acc=69.88% f1=73.68% auc=73.49% val_score=57.7917 val_score_bestthr=68.1984 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.204, mb=0.498, no=0.993, corr=-0.318) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.1984
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1579 mb_mean=0.4976 norm_overlap=0.9942 corr_cb=-0.2453 topkJ=0.0218
[TRAIN][ep=023] loss=0.6877 acc=71.54%
[TRAIN][ep=023] mask_avg: mc_mean=0.1952 mb_mean=0.4982 norm_overlap=0.9931 corr_cb=-0.3217
[EPOCH 023/089] train: loss=0.6877 acc=71.54% | val: loss=0.7036 acc=69.88% f1=76.64% auc=72.62% val_score=45.7063 val_score_bestthr=69.6805 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.195, mb=0.498, no=0.993, corr=-0.322) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.6805
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1942 mb_mean=0.4983 norm_overlap=0.9921 corr_cb=-0.3531 topkJ=0.0278
[TRAIN][ep=024] loss=0.6692 acc=74.09%
[TRAIN][ep=024] mask_avg: mc_mean=0.1868 mb_mean=0.4982 norm_overlap=0.9929 corr_cb=-0.3159
[EPOCH 024/089] train: loss=0.6692 acc=74.09% | val: loss=0.6077 acc=69.88% f1=71.26% auc=73.08% val_score=62.3068 val_score_bestthr=70.7970 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.187, mb=0.498, no=0.993, corr=-0.316) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 70.7970
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2285 mb_mean=0.4978 norm_overlap=0.9914 corr_cb=-0.3681 topkJ=0.0113
[TRAIN][ep=025] loss=0.6765 acc=73.69%
[TRAIN][ep=025] mask_avg: mc_mean=0.1931 mb_mean=0.4982 norm_overlap=0.9934 corr_cb=-0.2935
[EPOCH 025/089] train: loss=0.6765 acc=73.69% | val: loss=0.6099 acc=66.27% f1=74.55% auc=72.38% val_score=63.8288 val_score_bestthr=69.3455 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.193, mb=0.498, no=0.993, corr=-0.294) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.3455
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1665 mb_mean=0.4982 norm_overlap=0.9931 corr_cb=-0.3159 topkJ=0.0150
[TRAIN][ep=026] loss=0.6507 acc=74.36%
[TRAIN][ep=026] mask_avg: mc_mean=0.2180 mb_mean=0.4982 norm_overlap=0.9933 corr_cb=-0.3248
[EPOCH 026/089] train: loss=0.6507 acc=74.36% | val: loss=0.6071 acc=67.47% f1=75.23% auc=72.85% val_score=63.1208 val_score_bestthr=69.7779 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.218, mb=0.498, no=0.993, corr=-0.325) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.7779
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2412 mb_mean=0.4957 norm_overlap=0.9897 corr_cb=-0.4248 topkJ=0.0048
[TRAIN][ep=027] loss=0.6452 acc=76.11%
[TRAIN][ep=027] mask_avg: mc_mean=0.2004 mb_mean=0.4982 norm_overlap=0.9932 corr_cb=-0.3002
[EPOCH 027/089] train: loss=0.6452 acc=76.11% | val: loss=0.6564 acc=65.06% f1=73.87% auc=71.57% val_score=63.5534 val_score_bestthr=68.9509 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.200, mb=0.498, no=0.993, corr=-0.300) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.9509
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1976 mb_mean=0.5019 norm_overlap=0.9845 corr_cb=-0.5179 topkJ=0.0023
[TRAIN][ep=028] loss=0.6315 acc=75.97%
[TRAIN][ep=028] mask_avg: mc_mean=0.2236 mb_mean=0.4982 norm_overlap=0.9938 corr_cb=-0.2914
[EPOCH 028/089] train: loss=0.6315 acc=75.97% | val: loss=0.7365 acc=66.27% f1=72.00% auc=70.93% val_score=68.3578 val_score_bestthr=67.1962 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.224, mb=0.498, no=0.994, corr=-0.291) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 67.1962
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2193 mb_mean=0.4959 norm_overlap=0.9958 corr_cb=-0.2086 topkJ=0.0217
[TRAIN][ep=029] loss=0.6361 acc=75.97%
[TRAIN][ep=029] mask_avg: mc_mean=0.2032 mb_mean=0.4982 norm_overlap=0.9935 corr_cb=-0.2833
[EPOCH 029/089] train: loss=0.6361 acc=75.97% | val: loss=0.6284 acc=65.06% f1=73.87% auc=71.45% val_score=63.8288 val_score_bestthr=68.9509 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.203, mb=0.498, no=0.994, corr=-0.283) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.9509
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2291 mb_mean=0.4994 norm_overlap=0.9947 corr_cb=-0.2802 topkJ=0.0234
[TRAIN][ep=030] loss=0.6384 acc=74.23%
[TRAIN][ep=030] mask_avg: mc_mean=0.2141 mb_mean=0.4982 norm_overlap=0.9939 corr_cb=-0.2752
[EPOCH 030/089] train: loss=0.6384 acc=74.23% | val: loss=0.6262 acc=67.47% f1=74.77% auc=72.38% val_score=52.9436 val_score_bestthr=68.6174 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.214, mb=0.498, no=0.994, corr=-0.275) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.6174
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2288 mb_mean=0.4974 norm_overlap=0.9959 corr_cb=-0.2227 topkJ=0.0413
[TRAIN][ep=031] loss=0.6260 acc=75.97%
[TRAIN][ep=031] mask_avg: mc_mean=0.2185 mb_mean=0.4982 norm_overlap=0.9936 corr_cb=-0.2833
[EPOCH 031/089] train: loss=0.6260 acc=75.97% | val: loss=0.5991 acc=69.88% f1=73.68% auc=73.72% val_score=65.4434 val_score_bestthr=71.5589 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.218, mb=0.498, no=0.994, corr=-0.283) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 71.5589
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.0835 mb_mean=0.4974 norm_overlap=0.9942 corr_cb=-0.1806 topkJ=0.0237
[TRAIN][ep=032] loss=0.6417 acc=74.36%
[TRAIN][ep=032] mask_avg: mc_mean=0.1541 mb_mean=0.4982 norm_overlap=0.9924 corr_cb=-0.2624
[EPOCH 032/089] train: loss=0.6417 acc=74.36% | val: loss=0.6331 acc=66.27% f1=74.55% auc=71.86% val_score=50.5703 val_score_bestthr=69.9111 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.154, mb=0.498, no=0.992, corr=-0.262) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.9111
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2551 mb_mean=0.4964 norm_overlap=0.9951 corr_cb=-0.2838 topkJ=0.0289
[TRAIN][ep=033] loss=0.6234 acc=76.38%
[TRAIN][ep=033] mask_avg: mc_mean=0.2119 mb_mean=0.4982 norm_overlap=0.9933 corr_cb=-0.2883
[EPOCH 033/089] train: loss=0.6234 acc=76.38% | val: loss=0.6412 acc=68.67% f1=75.47% auc=72.79% val_score=54.5348 val_score_bestthr=68.1572 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.212, mb=0.498, no=0.993, corr=-0.288) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.1572
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2092 mb_mean=0.4971 norm_overlap=0.9933 corr_cb=-0.2704 topkJ=0.0210
[TRAIN][ep=034] loss=0.6182 acc=75.70%
[TRAIN][ep=034] mask_avg: mc_mean=0.2012 mb_mean=0.4982 norm_overlap=0.9933 corr_cb=-0.2844
[EPOCH 034/089] train: loss=0.6182 acc=75.70% | val: loss=0.6188 acc=66.27% f1=68.89% auc=71.98% val_score=63.2155 val_score_bestthr=67.8208 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.201, mb=0.498, no=0.993, corr=-0.284) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 67.8208
[EARLY STOP] no improvement for 30 epochs. best_epoch=4
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
=============== FIT DONE ===============
[BEST] epoch=4 | val_acc=71.08% | val_f1=77.36% | val_auc=72.15% | val_score=74.3337 | val_score_bestthr=74.3337
[TEST@BEST] thr_used=0.580 | acc=63.77% f1=61.54% auc=65.34% | SP_sex=10.15% EO_sex=6.61% SP_age=10.52% EO_age=6.58%
[TIME] 0.99 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/summary_fold_2.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4409 mb_mean=0.4998 norm_overlap=0.9999 corr_cb=-0.1537 topkJ=0.0142
[TRAIN][ep=000] loss=0.6950 acc=50.07%
[TRAIN][ep=000] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2179
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4456 mb_mean=0.4977 norm_overlap=0.9998 corr_cb=-0.3429 topkJ=0.0084
[TRAIN][ep=001] loss=0.6929 acc=50.87%
[TRAIN][ep=001] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2197
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4416 mb_mean=0.4967 norm_overlap=1.0000 corr_cb=-0.0925 topkJ=0.0328
[TRAIN][ep=002] loss=0.6924 acc=50.87%
[TRAIN][ep=002] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2149
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4401 mb_mean=0.4989 norm_overlap=0.9997 corr_cb=-0.3682 topkJ=0.0059
[TRAIN][ep=003] loss=0.6906 acc=54.23%
[TRAIN][ep=003] mask_avg: mc_mean=0.4421 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2220
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4399 mb_mean=0.4974 norm_overlap=0.9999 corr_cb=-0.1290 topkJ=0.0272
[TRAIN][ep=004] loss=0.6889 acc=56.78%
[TRAIN][ep=004] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2177
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4388 mb_mean=0.4999 norm_overlap=0.9998 corr_cb=-0.3849 topkJ=0.0055
[TRAIN][ep=005] loss=0.6873 acc=53.83%
[TRAIN][ep=005] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2149
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4421 mb_mean=0.4993 norm_overlap=0.9998 corr_cb=-0.2996 topkJ=0.0246
[TRAIN][ep=006] loss=0.6838 acc=55.44%
[TRAIN][ep=006] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2113
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4448 mb_mean=0.4952 norm_overlap=1.0000 corr_cb=0.0093 topkJ=0.0332
[TRAIN][ep=007] loss=0.6811 acc=59.87%
[TRAIN][ep=007] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2179
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4400 mb_mean=0.4972 norm_overlap=1.0000 corr_cb=-0.0037 topkJ=0.0472
[TRAIN][ep=008] loss=0.6783 acc=61.21%
[TRAIN][ep=008] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2155
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4446 mb_mean=0.4966 norm_overlap=0.9999 corr_cb=-0.2381 topkJ=0.0197
[TRAIN][ep=009] loss=0.6708 acc=59.46%
[TRAIN][ep=009] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2154
================= FIT START (fold=2) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4430 mb_mean=0.4980 norm_overlap=1.0000 corr_cb=-0.1091 topkJ=0.0223
[TRAIN][ep=000] loss=0.6696 acc=60.40%
[TRAIN][ep=000] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2180
[EPOCH 000/089] train: loss=0.6696 acc=60.40% | val: loss=0.6634 acc=71.08% f1=76.92% auc=71.57% val_score=69.3393 val_score_bestthr=68.6591 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.218) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 68.6591
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4450 mb_mean=0.4972 norm_overlap=0.9999 corr_cb=-0.1381 topkJ=0.0336
[TRAIN][ep=001] loss=0.6650 acc=60.67%
[TRAIN][ep=001] mask_avg: mc_mean=0.4421 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2187
[EPOCH 001/089] train: loss=0.6650 acc=60.67% | val: loss=0.6591 acc=68.67% f1=72.34% auc=71.34% val_score=67.1354 val_score_bestthr=72.7288 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.219) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 68.6591 -> 72.7288
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4416 mb_mean=0.4970 norm_overlap=0.9999 corr_cb=-0.1910 topkJ=0.0291
[TRAIN][ep=002] loss=0.6560 acc=62.55%
[TRAIN][ep=002] mask_avg: mc_mean=0.4421 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2200
[EPOCH 002/089] train: loss=0.6560 acc=62.55% | val: loss=0.6559 acc=68.67% f1=73.47% auc=69.71% val_score=65.8565 val_score_bestthr=69.0984 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.220) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7288 -> 69.0984
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4419 mb_mean=0.4995 norm_overlap=0.9998 corr_cb=-0.3017 topkJ=0.0204
[TRAIN][ep=003] loss=0.6534 acc=60.54%
[TRAIN][ep=003] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2169
[EPOCH 003/089] train: loss=0.6534 acc=60.54% | val: loss=0.6815 acc=69.88% f1=73.68% auc=70.64% val_score=61.3370 val_score_bestthr=71.4030 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.217) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7288 -> 71.4030
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4404 mb_mean=0.4979 norm_overlap=0.9999 corr_cb=-0.1561 topkJ=0.0339
[TRAIN][ep=004] loss=0.6513 acc=62.15%
[TRAIN][ep=004] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2191
[EPOCH 004/089] train: loss=0.6513 acc=62.15% | val: loss=0.6489 acc=71.08% f1=77.36% auc=72.15% val_score=74.3337 val_score_bestthr=74.3337 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.219) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 72.7288 -> 74.3337
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4474 mb_mean=0.4984 norm_overlap=1.0000 corr_cb=-0.0752 topkJ=0.0199
[TRAIN][ep=005] loss=1.2894 acc=61.88%
[TRAIN][ep=005] mask_avg: mc_mean=0.3168 mb_mean=0.4982 norm_overlap=0.9991 corr_cb=-0.2693
[EPOCH 005/089] train: loss=1.2894 acc=61.88% | val: loss=0.6671 acc=66.27% f1=68.18% auc=69.65% val_score=48.0730 val_score_bestthr=68.0173 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.317, mb=0.498, no=0.999, corr=-0.269) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.0173
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2512 mb_mean=0.4984 norm_overlap=0.9986 corr_cb=-0.2151 topkJ=0.0245
[TRAIN][ep=006] loss=1.2804 acc=62.68%
[TRAIN][ep=006] mask_avg: mc_mean=0.2168 mb_mean=0.4982 norm_overlap=0.9984 corr_cb=-0.2360
[EPOCH 006/089] train: loss=1.2804 acc=62.68% | val: loss=0.6462 acc=72.29% f1=77.23% auc=73.08% val_score=64.1822 val_score_bestthr=70.9614 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.217, mb=0.498, no=0.998, corr=-0.236) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 70.9614
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2367 mb_mean=0.5001 norm_overlap=0.9982 corr_cb=-0.2411 topkJ=0.0478
[TRAIN][ep=007] loss=1.2684 acc=63.62%
[TRAIN][ep=007] mask_avg: mc_mean=0.1768 mb_mean=0.4982 norm_overlap=0.9980 corr_cb=-0.2177
[EPOCH 007/089] train: loss=1.2684 acc=63.62% | val: loss=0.6426 acc=71.08% f1=76.92% auc=72.91% val_score=61.4276 val_score_bestthr=72.2412 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.177, mb=0.498, no=0.998, corr=-0.218) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 72.2412
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1675 mb_mean=0.4984 norm_overlap=0.9984 corr_cb=-0.1993 topkJ=0.0447
[TRAIN][ep=008] loss=1.2528 acc=66.17%
[TRAIN][ep=008] mask_avg: mc_mean=0.1423 mb_mean=0.4982 norm_overlap=0.9977 corr_cb=-0.1903
[EPOCH 008/089] train: loss=1.2528 acc=66.17% | val: loss=0.6695 acc=71.08% f1=75.00% auc=71.80% val_score=64.4280 val_score_bestthr=68.0334 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.142, mb=0.498, no=0.998, corr=-0.190) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.0334
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1309 mb_mean=0.4974 norm_overlap=0.9973 corr_cb=-0.2207 topkJ=0.0255
[TRAIN][ep=009] loss=1.2508 acc=65.37%
[TRAIN][ep=009] mask_avg: mc_mean=0.1318 mb_mean=0.4982 norm_overlap=0.9971 corr_cb=-0.2028
[EPOCH 009/089] train: loss=1.2508 acc=65.37% | val: loss=0.6475 acc=66.27% f1=75.00% auc=72.33% val_score=71.9483 val_score_bestthr=71.9483 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.132, mb=0.498, no=0.997, corr=-0.203) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 71.9483
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1350 mb_mean=0.4962 norm_overlap=0.9957 corr_cb=-0.2944 topkJ=0.0240
[TRAIN][ep=010] loss=1.0403 acc=66.04%
[TRAIN][ep=010] mask_avg: mc_mean=0.1302 mb_mean=0.4982 norm_overlap=0.9966 corr_cb=-0.2178
[EPOCH 010/089] train: loss=1.0403 acc=66.04% | val: loss=0.6368 acc=67.47% f1=75.68% auc=72.73% val_score=67.7793 val_score_bestthr=72.3795 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.130, mb=0.498, no=0.997, corr=-0.218) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 72.3795
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1553 mb_mean=0.4990 norm_overlap=0.9968 corr_cb=-0.2423 topkJ=0.0258
[TRAIN][ep=011] loss=0.8447 acc=67.25%
[TRAIN][ep=011] mask_avg: mc_mean=0.1387 mb_mean=0.4982 norm_overlap=0.9965 corr_cb=-0.2101
[EPOCH 011/089] train: loss=0.8447 acc=67.25% | val: loss=0.6494 acc=69.88% f1=74.23% auc=71.10% val_score=52.6552 val_score_bestthr=67.2798 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.139, mb=0.498, no=0.997, corr=-0.210) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 67.2798
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1625 mb_mean=0.4965 norm_overlap=0.9984 corr_cb=-0.1158 topkJ=0.0670
[TRAIN][ep=012] loss=0.7986 acc=68.59%
[TRAIN][ep=012] mask_avg: mc_mean=0.1416 mb_mean=0.4982 norm_overlap=0.9960 corr_cb=-0.2214
[EPOCH 012/089] train: loss=0.7986 acc=68.59% | val: loss=0.6219 acc=71.08% f1=76.47% auc=72.85% val_score=58.3227 val_score_bestthr=71.6864 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.142, mb=0.498, no=0.996, corr=-0.221) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 71.6864
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.0987 mb_mean=0.5001 norm_overlap=0.9936 corr_cb=-0.2876 topkJ=0.0358
[TRAIN][ep=013] loss=0.7767 acc=67.92%
[TRAIN][ep=013] mask_avg: mc_mean=0.1554 mb_mean=0.4982 norm_overlap=0.9954 corr_cb=-0.2575
[EPOCH 013/089] train: loss=0.7767 acc=67.92% | val: loss=0.6228 acc=71.08% f1=76.00% auc=72.09% val_score=62.4943 val_score_bestthr=71.2903 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.155, mb=0.498, no=0.995, corr=-0.258) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 71.2903
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1838 mb_mean=0.4970 norm_overlap=0.9947 corr_cb=-0.3072 topkJ=0.0165
[TRAIN][ep=014] loss=0.7782 acc=68.72%
[TRAIN][ep=014] mask_avg: mc_mean=0.1806 mb_mean=0.4982 norm_overlap=0.9952 corr_cb=-0.2752
[EPOCH 014/089] train: loss=0.7782 acc=68.72% | val: loss=0.6162 acc=69.88% f1=75.25% auc=73.02% val_score=59.2691 val_score_bestthr=69.1460 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.181, mb=0.498, no=0.995, corr=-0.275) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.1460
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1666 mb_mean=0.4996 norm_overlap=0.9920 corr_cb=-0.4320 topkJ=0.0254
[TRAIN][ep=015] loss=0.7680 acc=69.13%
[TRAIN][ep=015] mask_avg: mc_mean=0.1632 mb_mean=0.4982 norm_overlap=0.9940 corr_cb=-0.3187
[EPOCH 015/089] train: loss=0.7680 acc=69.13% | val: loss=0.6273 acc=68.67% f1=72.34% auc=72.85% val_score=56.0182 val_score_bestthr=68.6838 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.163, mb=0.498, no=0.994, corr=-0.319) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.6838
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1778 mb_mean=0.4984 norm_overlap=0.9965 corr_cb=-0.2074 topkJ=0.0264
[TRAIN][ep=016] loss=0.7690 acc=71.14%
[TRAIN][ep=016] mask_avg: mc_mean=0.2005 mb_mean=0.4982 norm_overlap=0.9939 corr_cb=-0.3484
[EPOCH 016/089] train: loss=0.7690 acc=71.14% | val: loss=0.6163 acc=69.88% f1=74.75% auc=72.85% val_score=60.8079 val_score_bestthr=70.2978 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.201, mb=0.498, no=0.994, corr=-0.348) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 70.2978
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1651 mb_mean=0.4984 norm_overlap=0.9933 corr_cb=-0.2921 topkJ=0.0265
[TRAIN][ep=017] loss=0.7579 acc=69.13%
[TRAIN][ep=017] mask_avg: mc_mean=0.1704 mb_mean=0.4982 norm_overlap=0.9932 corr_cb=-0.3322
[EPOCH 017/089] train: loss=0.7579 acc=69.13% | val: loss=0.6102 acc=68.67% f1=75.00% auc=72.67% val_score=61.7641 val_score_bestthr=68.0330 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.170, mb=0.498, no=0.993, corr=-0.332) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.0330
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1489 mb_mean=0.4979 norm_overlap=0.9936 corr_cb=-0.2920 topkJ=0.0185
[TRAIN][ep=018] loss=0.7425 acc=71.54%
[TRAIN][ep=018] mask_avg: mc_mean=0.1745 mb_mean=0.4982 norm_overlap=0.9931 corr_cb=-0.3281
[EPOCH 018/089] train: loss=0.7425 acc=71.54% | val: loss=0.6130 acc=68.67% f1=72.92% auc=72.85% val_score=62.4943 val_score_bestthr=68.5441 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.175, mb=0.498, no=0.993, corr=-0.328) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.5441
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.2052 mb_mean=0.5006 norm_overlap=0.9927 corr_cb=-0.4086 topkJ=0.0154
[TRAIN][ep=019] loss=0.7578 acc=70.60%
[TRAIN][ep=019] mask_avg: mc_mean=0.1938 mb_mean=0.4982 norm_overlap=0.9928 corr_cb=-0.3570
[EPOCH 019/089] train: loss=0.7578 acc=70.60% | val: loss=0.6094 acc=67.47% f1=72.73% auc=72.62% val_score=54.6218 val_score_bestthr=67.4367 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.194, mb=0.498, no=0.993, corr=-0.357) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 67.4367
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.2250 mb_mean=0.4972 norm_overlap=0.9909 corr_cb=-0.4237 topkJ=0.0012
[TRAIN][ep=020] loss=0.7507 acc=69.66%
[TRAIN][ep=020] mask_avg: mc_mean=0.1783 mb_mean=0.4982 norm_overlap=0.9923 corr_cb=-0.3610
[EPOCH 020/089] train: loss=0.7507 acc=69.66% | val: loss=0.6087 acc=67.47% f1=75.68% auc=73.37% val_score=64.4585 val_score_bestthr=69.7154 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.178, mb=0.498, no=0.992, corr=-0.361) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.7154
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2327 mb_mean=0.4957 norm_overlap=0.9941 corr_cb=-0.3414 topkJ=0.0175
[TRAIN][ep=021] loss=0.7320 acc=73.15%
[TRAIN][ep=021] mask_avg: mc_mean=0.1968 mb_mean=0.4982 norm_overlap=0.9929 corr_cb=-0.3454
[EPOCH 021/089] train: loss=0.7320 acc=73.15% | val: loss=0.6049 acc=69.88% f1=71.26% auc=73.02% val_score=62.8808 val_score_bestthr=70.7970 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.197, mb=0.498, no=0.993, corr=-0.345) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 70.7970
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2082 mb_mean=0.4977 norm_overlap=0.9955 corr_cb=-0.2720 topkJ=0.0280
[TRAIN][ep=022] loss=0.7181 acc=73.83%
[TRAIN][ep=022] mask_avg: mc_mean=0.2041 mb_mean=0.4982 norm_overlap=0.9934 corr_cb=-0.3167
[EPOCH 022/089] train: loss=0.7181 acc=73.83% | val: loss=0.6195 acc=69.88% f1=73.68% auc=73.37% val_score=57.7917 val_score_bestthr=68.1984 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.204, mb=0.498, no=0.993, corr=-0.317) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.1984
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1575 mb_mean=0.4976 norm_overlap=0.9942 corr_cb=-0.2437 topkJ=0.0218
[TRAIN][ep=023] loss=0.7402 acc=71.54%
[TRAIN][ep=023] mask_avg: mc_mean=0.1971 mb_mean=0.4982 norm_overlap=0.9931 corr_cb=-0.3213
[EPOCH 023/089] train: loss=0.7402 acc=71.54% | val: loss=0.7035 acc=69.88% f1=76.64% auc=72.62% val_score=45.7063 val_score_bestthr=69.6805 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.197, mb=0.498, no=0.993, corr=-0.321) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.6805
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1934 mb_mean=0.4983 norm_overlap=0.9922 corr_cb=-0.3510 topkJ=0.0274
[TRAIN][ep=024] loss=0.7217 acc=74.23%
[TRAIN][ep=024] mask_avg: mc_mean=0.1873 mb_mean=0.4982 norm_overlap=0.9929 corr_cb=-0.3151
[EPOCH 024/089] train: loss=0.7217 acc=74.23% | val: loss=0.6077 acc=69.88% f1=71.26% auc=72.97% val_score=62.3068 val_score_bestthr=70.7970 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.187, mb=0.498, no=0.993, corr=-0.315) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 70.7970
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2286 mb_mean=0.4978 norm_overlap=0.9914 corr_cb=-0.3665 topkJ=0.0117
[TRAIN][ep=025] loss=0.7291 acc=73.69%
[TRAIN][ep=025] mask_avg: mc_mean=0.1937 mb_mean=0.4982 norm_overlap=0.9934 corr_cb=-0.2925
[EPOCH 025/089] train: loss=0.7291 acc=73.69% | val: loss=0.6101 acc=66.27% f1=74.55% auc=72.38% val_score=63.8288 val_score_bestthr=69.3455 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.194, mb=0.498, no=0.993, corr=-0.293) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.3455
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1671 mb_mean=0.4982 norm_overlap=0.9931 corr_cb=-0.3167 topkJ=0.0150
[TRAIN][ep=026] loss=0.7032 acc=74.36%
[TRAIN][ep=026] mask_avg: mc_mean=0.2188 mb_mean=0.4982 norm_overlap=0.9933 corr_cb=-0.3239
[EPOCH 026/089] train: loss=0.7032 acc=74.36% | val: loss=0.6073 acc=67.47% f1=75.23% auc=72.79% val_score=63.1208 val_score_bestthr=69.7779 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.219, mb=0.498, no=0.993, corr=-0.324) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.7779
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2411 mb_mean=0.4957 norm_overlap=0.9898 corr_cb=-0.4230 topkJ=0.0048
[TRAIN][ep=027] loss=0.6978 acc=76.11%
[TRAIN][ep=027] mask_avg: mc_mean=0.2014 mb_mean=0.4982 norm_overlap=0.9933 corr_cb=-0.2993
[EPOCH 027/089] train: loss=0.6978 acc=76.11% | val: loss=0.6565 acc=65.06% f1=73.87% auc=71.51% val_score=63.5534 val_score_bestthr=68.9509 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.201, mb=0.498, no=0.993, corr=-0.299) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.9509
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1987 mb_mean=0.5019 norm_overlap=0.9845 corr_cb=-0.5168 topkJ=0.0023
[TRAIN][ep=028] loss=0.6838 acc=75.97%
[TRAIN][ep=028] mask_avg: mc_mean=0.2244 mb_mean=0.4982 norm_overlap=0.9938 corr_cb=-0.2902
[EPOCH 028/089] train: loss=0.6838 acc=75.97% | val: loss=0.7366 acc=66.27% f1=72.00% auc=70.99% val_score=68.3578 val_score_bestthr=67.1962 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.224, mb=0.498, no=0.994, corr=-0.290) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 67.1962
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2206 mb_mean=0.4959 norm_overlap=0.9958 corr_cb=-0.2079 topkJ=0.0221
[TRAIN][ep=029] loss=0.6884 acc=75.97%
[TRAIN][ep=029] mask_avg: mc_mean=0.2040 mb_mean=0.4982 norm_overlap=0.9936 corr_cb=-0.2819
[EPOCH 029/089] train: loss=0.6884 acc=75.97% | val: loss=0.6284 acc=65.06% f1=73.87% auc=71.51% val_score=63.8288 val_score_bestthr=68.9509 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.204, mb=0.498, no=0.994, corr=-0.282) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.9509
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2297 mb_mean=0.4994 norm_overlap=0.9948 corr_cb=-0.2783 topkJ=0.0234
[TRAIN][ep=030] loss=0.6908 acc=74.23%
[TRAIN][ep=030] mask_avg: mc_mean=0.2150 mb_mean=0.4982 norm_overlap=0.9939 corr_cb=-0.2736
[EPOCH 030/089] train: loss=0.6908 acc=74.23% | val: loss=0.6263 acc=67.47% f1=74.77% auc=72.44% val_score=52.9436 val_score_bestthr=68.6174 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.215, mb=0.498, no=0.994, corr=-0.274) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.6174
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2300 mb_mean=0.4974 norm_overlap=0.9959 corr_cb=-0.2213 topkJ=0.0413
[TRAIN][ep=031] loss=0.6785 acc=75.84%
[TRAIN][ep=031] mask_avg: mc_mean=0.2193 mb_mean=0.4982 norm_overlap=0.9937 corr_cb=-0.2816
[EPOCH 031/089] train: loss=0.6785 acc=75.84% | val: loss=0.5990 acc=69.88% f1=72.53% auc=73.72% val_score=65.4434 val_score_bestthr=70.7928 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.219, mb=0.498, no=0.994, corr=-0.282) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 70.7928
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.0830 mb_mean=0.4974 norm_overlap=0.9943 corr_cb=-0.1786 topkJ=0.0237
[TRAIN][ep=032] loss=0.6943 acc=74.36%
[TRAIN][ep=032] mask_avg: mc_mean=0.1547 mb_mean=0.4982 norm_overlap=0.9925 corr_cb=-0.2610
[EPOCH 032/089] train: loss=0.6943 acc=74.36% | val: loss=0.6330 acc=67.47% f1=75.68% auc=71.86% val_score=50.5703 val_score_bestthr=72.5854 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.155, mb=0.498, no=0.992, corr=-0.261) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 72.5854
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2548 mb_mean=0.4964 norm_overlap=0.9951 corr_cb=-0.2820 topkJ=0.0302
[TRAIN][ep=033] loss=0.6759 acc=76.38%
[TRAIN][ep=033] mask_avg: mc_mean=0.2122 mb_mean=0.4982 norm_overlap=0.9934 corr_cb=-0.2870
[EPOCH 033/089] train: loss=0.6759 acc=76.38% | val: loss=0.6410 acc=68.67% f1=75.47% auc=72.73% val_score=54.5348 val_score_bestthr=68.1572 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.212, mb=0.498, no=0.993, corr=-0.287) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.1572
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2087 mb_mean=0.4971 norm_overlap=0.9933 corr_cb=-0.2682 topkJ=0.0210
[TRAIN][ep=034] loss=0.6710 acc=75.70%
[TRAIN][ep=034] mask_avg: mc_mean=0.2018 mb_mean=0.4982 norm_overlap=0.9933 corr_cb=-0.2831
[EPOCH 034/089] train: loss=0.6710 acc=75.70% | val: loss=0.6187 acc=68.67% f1=75.00% auc=71.86% val_score=63.2155 val_score_bestthr=66.2214 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.202, mb=0.498, no=0.993, corr=-0.283) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 66.2214
[EARLY STOP] no improvement for 30 epochs. best_epoch=4
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
=============== FIT DONE ===============
[BEST] epoch=4 | val_acc=71.08% | val_f1=77.36% | val_auc=72.15% | val_score=74.3337 | val_score_bestthr=74.3337
[TEST@BEST] thr_used=0.580 | acc=63.77% f1=61.54% auc=65.37% | SP_sex=10.15% EO_sex=6.61% SP_age=10.52% EO_age=6.58%
[TIME] 0.94 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/summary_fold_2.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4409 mb_mean=0.4998 norm_overlap=0.9999 corr_cb=-0.1537 topkJ=0.0142
[TRAIN][ep=000] loss=0.6950 acc=50.07%
[TRAIN][ep=000] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2179
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4456 mb_mean=0.4977 norm_overlap=0.9998 corr_cb=-0.3429 topkJ=0.0084
[TRAIN][ep=001] loss=0.6929 acc=50.87%
[TRAIN][ep=001] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2197
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4416 mb_mean=0.4967 norm_overlap=1.0000 corr_cb=-0.0925 topkJ=0.0328
[TRAIN][ep=002] loss=0.6924 acc=50.87%
[TRAIN][ep=002] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2149
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4401 mb_mean=0.4989 norm_overlap=0.9997 corr_cb=-0.3682 topkJ=0.0059
[TRAIN][ep=003] loss=0.6906 acc=54.23%
[TRAIN][ep=003] mask_avg: mc_mean=0.4421 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2220
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4399 mb_mean=0.4974 norm_overlap=0.9999 corr_cb=-0.1290 topkJ=0.0272
[TRAIN][ep=004] loss=0.6889 acc=56.78%
[TRAIN][ep=004] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2177
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4388 mb_mean=0.4999 norm_overlap=0.9998 corr_cb=-0.3849 topkJ=0.0055
[TRAIN][ep=005] loss=0.6873 acc=53.69%
[TRAIN][ep=005] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2149
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4421 mb_mean=0.4993 norm_overlap=0.9998 corr_cb=-0.2996 topkJ=0.0246
[TRAIN][ep=006] loss=0.6838 acc=55.30%
[TRAIN][ep=006] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2113
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4448 mb_mean=0.4952 norm_overlap=1.0000 corr_cb=0.0093 topkJ=0.0332
[TRAIN][ep=007] loss=0.6811 acc=60.00%
[TRAIN][ep=007] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2179
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4400 mb_mean=0.4972 norm_overlap=1.0000 corr_cb=-0.0037 topkJ=0.0472
[TRAIN][ep=008] loss=0.6783 acc=61.21%
[TRAIN][ep=008] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2155
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4446 mb_mean=0.4966 norm_overlap=0.9999 corr_cb=-0.2381 topkJ=0.0197
[TRAIN][ep=009] loss=0.6708 acc=59.46%
[TRAIN][ep=009] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2154
================= FIT START (fold=2) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4430 mb_mean=0.4980 norm_overlap=1.0000 corr_cb=-0.1091 topkJ=0.0223
[TRAIN][ep=000] loss=0.6696 acc=60.40%
[TRAIN][ep=000] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2180
[EPOCH 000/089] train: loss=0.6696 acc=60.40% | val: loss=0.6634 acc=71.08% f1=76.92% auc=71.63% val_score=69.3393 val_score_bestthr=68.6591 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.218) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 68.6591
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4450 mb_mean=0.4972 norm_overlap=0.9999 corr_cb=-0.1381 topkJ=0.0336
[TRAIN][ep=001] loss=0.6650 acc=60.67%
[TRAIN][ep=001] mask_avg: mc_mean=0.4421 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2187
[EPOCH 001/089] train: loss=0.6650 acc=60.67% | val: loss=0.6591 acc=68.67% f1=72.34% auc=71.34% val_score=67.1354 val_score_bestthr=72.7288 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.219) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 68.6591 -> 72.7288
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4416 mb_mean=0.4970 norm_overlap=0.9999 corr_cb=-0.1910 topkJ=0.0291
[TRAIN][ep=002] loss=0.6560 acc=62.55%
[TRAIN][ep=002] mask_avg: mc_mean=0.4421 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2200
[EPOCH 002/089] train: loss=0.6560 acc=62.55% | val: loss=0.6559 acc=68.67% f1=73.47% auc=69.65% val_score=65.8565 val_score_bestthr=69.0984 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.220) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7288 -> 69.0984
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4419 mb_mean=0.4995 norm_overlap=0.9998 corr_cb=-0.3017 topkJ=0.0204
[TRAIN][ep=003] loss=0.6535 acc=60.67%
[TRAIN][ep=003] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2169
[EPOCH 003/089] train: loss=0.6535 acc=60.67% | val: loss=0.6815 acc=69.88% f1=73.68% auc=70.64% val_score=61.3370 val_score_bestthr=71.4030 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.217) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7288 -> 71.4030
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4404 mb_mean=0.4979 norm_overlap=0.9999 corr_cb=-0.1561 topkJ=0.0339
[TRAIN][ep=004] loss=0.6513 acc=62.42%
[TRAIN][ep=004] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2191
[EPOCH 004/089] train: loss=0.6513 acc=62.42% | val: loss=0.6489 acc=71.08% f1=77.36% auc=72.15% val_score=74.3337 val_score_bestthr=74.3337 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.219) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 72.7288 -> 74.3337
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4474 mb_mean=0.4984 norm_overlap=1.0000 corr_cb=-0.0752 topkJ=0.0199
[TRAIN][ep=005] loss=1.4570 acc=61.88%
[TRAIN][ep=005] mask_avg: mc_mean=0.3168 mb_mean=0.4982 norm_overlap=0.9991 corr_cb=-0.2693
[EPOCH 005/089] train: loss=1.4570 acc=61.88% | val: loss=0.6671 acc=66.27% f1=68.18% auc=69.77% val_score=47.1055 val_score_bestthr=68.0173 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.317, mb=0.498, no=0.999, corr=-0.269) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.0173
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2511 mb_mean=0.4984 norm_overlap=0.9986 corr_cb=-0.2150 topkJ=0.0245
[TRAIN][ep=006] loss=1.4419 acc=62.95%
[TRAIN][ep=006] mask_avg: mc_mean=0.2167 mb_mean=0.4982 norm_overlap=0.9984 corr_cb=-0.2362
[EPOCH 006/089] train: loss=1.4419 acc=62.95% | val: loss=0.6459 acc=72.29% f1=77.23% auc=73.14% val_score=64.7852 val_score_bestthr=70.9614 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.217, mb=0.498, no=0.998, corr=-0.236) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 70.9614
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2365 mb_mean=0.5001 norm_overlap=0.9982 corr_cb=-0.2409 topkJ=0.0478
[TRAIN][ep=007] loss=1.4294 acc=63.49%
[TRAIN][ep=007] mask_avg: mc_mean=0.1764 mb_mean=0.4982 norm_overlap=0.9980 corr_cb=-0.2175
[EPOCH 007/089] train: loss=1.4294 acc=63.49% | val: loss=0.6422 acc=69.88% f1=76.19% auc=72.91% val_score=61.4276 val_score_bestthr=70.7175 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.176, mb=0.498, no=0.998, corr=-0.217) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 70.7175
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1675 mb_mean=0.4984 norm_overlap=0.9984 corr_cb=-0.1994 topkJ=0.0447
[TRAIN][ep=008] loss=1.4135 acc=66.31%
[TRAIN][ep=008] mask_avg: mc_mean=0.1421 mb_mean=0.4982 norm_overlap=0.9976 corr_cb=-0.1899
[EPOCH 008/089] train: loss=1.4135 acc=66.31% | val: loss=0.6688 acc=71.08% f1=75.00% auc=71.74% val_score=64.4280 val_score_bestthr=68.0334 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.142, mb=0.498, no=0.998, corr=-0.190) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.0334
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1306 mb_mean=0.4974 norm_overlap=0.9973 corr_cb=-0.2208 topkJ=0.0255
[TRAIN][ep=009] loss=1.4107 acc=65.10%
[TRAIN][ep=009] mask_avg: mc_mean=0.1319 mb_mean=0.4982 norm_overlap=0.9971 corr_cb=-0.2027
[EPOCH 009/089] train: loss=1.4107 acc=65.10% | val: loss=0.6470 acc=66.27% f1=75.00% auc=72.33% val_score=68.4290 val_score_bestthr=71.9483 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.132, mb=0.498, no=0.997, corr=-0.203) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 71.9483
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1356 mb_mean=0.4962 norm_overlap=0.9957 corr_cb=-0.2940 topkJ=0.0244
[TRAIN][ep=010] loss=1.1998 acc=65.77%
[TRAIN][ep=010] mask_avg: mc_mean=0.1305 mb_mean=0.4982 norm_overlap=0.9967 corr_cb=-0.2175
[EPOCH 010/089] train: loss=1.1998 acc=65.77% | val: loss=0.6363 acc=67.47% f1=75.68% auc=72.85% val_score=67.7793 val_score_bestthr=72.3795 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.131, mb=0.498, no=0.997, corr=-0.218) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 72.3795
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1546 mb_mean=0.4990 norm_overlap=0.9967 corr_cb=-0.2418 topkJ=0.0258
[TRAIN][ep=011] loss=1.0036 acc=67.38%
[TRAIN][ep=011] mask_avg: mc_mean=0.1382 mb_mean=0.4982 norm_overlap=0.9965 corr_cb=-0.2101
[EPOCH 011/089] train: loss=1.0036 acc=67.38% | val: loss=0.6489 acc=71.08% f1=75.51% auc=71.05% val_score=52.6552 val_score_bestthr=69.8660 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.138, mb=0.498, no=0.997, corr=-0.210) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.8660
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1617 mb_mean=0.4965 norm_overlap=0.9984 corr_cb=-0.1155 topkJ=0.0666
[TRAIN][ep=012] loss=0.9571 acc=68.46%
[TRAIN][ep=012] mask_avg: mc_mean=0.1407 mb_mean=0.4982 norm_overlap=0.9960 corr_cb=-0.2212
[EPOCH 012/089] train: loss=0.9571 acc=68.46% | val: loss=0.6215 acc=71.08% f1=76.47% auc=72.73% val_score=58.3227 val_score_bestthr=71.6864 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.141, mb=0.498, no=0.996, corr=-0.221) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 71.6864
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.0975 mb_mean=0.5001 norm_overlap=0.9935 corr_cb=-0.2870 topkJ=0.0358
[TRAIN][ep=013] loss=0.9345 acc=68.05%
[TRAIN][ep=013] mask_avg: mc_mean=0.1546 mb_mean=0.4982 norm_overlap=0.9954 corr_cb=-0.2570
[EPOCH 013/089] train: loss=0.9345 acc=68.05% | val: loss=0.6227 acc=72.29% f1=76.29% auc=71.98% val_score=62.4943 val_score_bestthr=73.1465 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.155, mb=0.498, no=0.995, corr=-0.257) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 73.1465
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1827 mb_mean=0.4970 norm_overlap=0.9947 corr_cb=-0.3066 topkJ=0.0165
[TRAIN][ep=014] loss=0.9351 acc=68.99%
[TRAIN][ep=014] mask_avg: mc_mean=0.1786 mb_mean=0.4982 norm_overlap=0.9952 corr_cb=-0.2741
[EPOCH 014/089] train: loss=0.9351 acc=68.99% | val: loss=0.6161 acc=71.08% f1=76.00% auc=72.79% val_score=59.2691 val_score_bestthr=70.6726 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.179, mb=0.498, no=0.995, corr=-0.274) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 70.6726
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1657 mb_mean=0.4996 norm_overlap=0.9920 corr_cb=-0.4311 topkJ=0.0254
[TRAIN][ep=015] loss=0.9242 acc=68.99%
[TRAIN][ep=015] mask_avg: mc_mean=0.1626 mb_mean=0.4982 norm_overlap=0.9940 corr_cb=-0.3179
[EPOCH 015/089] train: loss=0.9242 acc=68.99% | val: loss=0.6271 acc=69.88% f1=73.12% auc=72.62% val_score=56.0182 val_score_bestthr=71.3343 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.163, mb=0.498, no=0.994, corr=-0.318) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 71.3343
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1775 mb_mean=0.4984 norm_overlap=0.9965 corr_cb=-0.2071 topkJ=0.0264
[TRAIN][ep=016] loss=0.9249 acc=71.01%
[TRAIN][ep=016] mask_avg: mc_mean=0.1996 mb_mean=0.4982 norm_overlap=0.9939 corr_cb=-0.3480
[EPOCH 016/089] train: loss=0.9249 acc=71.01% | val: loss=0.6161 acc=69.88% f1=74.75% auc=72.97% val_score=62.4943 val_score_bestthr=70.2978 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.200, mb=0.498, no=0.994, corr=-0.348) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 70.2978
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1645 mb_mean=0.4984 norm_overlap=0.9933 corr_cb=-0.2922 topkJ=0.0265
[TRAIN][ep=017] loss=0.9126 acc=68.86%
[TRAIN][ep=017] mask_avg: mc_mean=0.1692 mb_mean=0.4982 norm_overlap=0.9932 corr_cb=-0.3315
[EPOCH 017/089] train: loss=0.9126 acc=68.86% | val: loss=0.6101 acc=68.67% f1=75.00% auc=72.97% val_score=61.7641 val_score_bestthr=68.0330 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.169, mb=0.498, no=0.993, corr=-0.331) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.0330
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1484 mb_mean=0.4979 norm_overlap=0.9936 corr_cb=-0.2913 topkJ=0.0185
[TRAIN][ep=018] loss=0.8961 acc=71.54%
[TRAIN][ep=018] mask_avg: mc_mean=0.1741 mb_mean=0.4982 norm_overlap=0.9931 corr_cb=-0.3280
[EPOCH 018/089] train: loss=0.8961 acc=71.54% | val: loss=0.6129 acc=69.88% f1=74.23% auc=72.85% val_score=62.4943 val_score_bestthr=69.3476 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.174, mb=0.498, no=0.993, corr=-0.328) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.3476
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.2048 mb_mean=0.5006 norm_overlap=0.9927 corr_cb=-0.4080 topkJ=0.0154
[TRAIN][ep=019] loss=0.9108 acc=70.60%
[TRAIN][ep=019] mask_avg: mc_mean=0.1935 mb_mean=0.4982 norm_overlap=0.9928 corr_cb=-0.3567
[EPOCH 019/089] train: loss=0.9108 acc=70.60% | val: loss=0.6093 acc=67.47% f1=72.73% auc=72.50% val_score=54.6218 val_score_bestthr=67.4367 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.194, mb=0.498, no=0.993, corr=-0.357) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 67.4367
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.2248 mb_mean=0.4972 norm_overlap=0.9909 corr_cb=-0.4233 topkJ=0.0012
[TRAIN][ep=020] loss=0.9024 acc=69.66%
[TRAIN][ep=020] mask_avg: mc_mean=0.1780 mb_mean=0.4982 norm_overlap=0.9923 corr_cb=-0.3608
[EPOCH 020/089] train: loss=0.9024 acc=69.66% | val: loss=0.6085 acc=67.47% f1=75.68% auc=73.37% val_score=64.4585 val_score_bestthr=69.7154 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.178, mb=0.498, no=0.992, corr=-0.361) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.7154
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2321 mb_mean=0.4957 norm_overlap=0.9941 corr_cb=-0.3406 topkJ=0.0179
[TRAIN][ep=021] loss=0.8837 acc=72.62%
[TRAIN][ep=021] mask_avg: mc_mean=0.1959 mb_mean=0.4982 norm_overlap=0.9929 corr_cb=-0.3452
[EPOCH 021/089] train: loss=0.8837 acc=72.62% | val: loss=0.6045 acc=69.88% f1=71.26% auc=73.20% val_score=65.5137 val_score_bestthr=70.7970 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.196, mb=0.498, no=0.993, corr=-0.345) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 70.7970
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2074 mb_mean=0.4977 norm_overlap=0.9955 corr_cb=-0.2716 topkJ=0.0280
[TRAIN][ep=022] loss=0.8667 acc=74.09%
[TRAIN][ep=022] mask_avg: mc_mean=0.2037 mb_mean=0.4982 norm_overlap=0.9934 corr_cb=-0.3168
[EPOCH 022/089] train: loss=0.8667 acc=74.09% | val: loss=0.6189 acc=69.88% f1=73.68% auc=73.31% val_score=57.7917 val_score_bestthr=68.1984 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.204, mb=0.498, no=0.993, corr=-0.317) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.1984
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1566 mb_mean=0.4976 norm_overlap=0.9942 corr_cb=-0.2437 topkJ=0.0218
[TRAIN][ep=023] loss=0.8881 acc=71.41%
[TRAIN][ep=023] mask_avg: mc_mean=0.1960 mb_mean=0.4982 norm_overlap=0.9931 corr_cb=-0.3208
[EPOCH 023/089] train: loss=0.8881 acc=71.41% | val: loss=0.7041 acc=69.88% f1=76.64% auc=72.67% val_score=45.7063 val_score_bestthr=69.6805 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.196, mb=0.498, no=0.993, corr=-0.321) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.6805
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1937 mb_mean=0.4983 norm_overlap=0.9922 corr_cb=-0.3520 topkJ=0.0274
[TRAIN][ep=024] loss=0.8689 acc=74.23%
[TRAIN][ep=024] mask_avg: mc_mean=0.1865 mb_mean=0.4982 norm_overlap=0.9929 corr_cb=-0.3150
[EPOCH 024/089] train: loss=0.8689 acc=74.23% | val: loss=0.6080 acc=69.88% f1=71.26% auc=72.91% val_score=62.3068 val_score_bestthr=70.7970 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.186, mb=0.498, no=0.993, corr=-0.315) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 70.7970
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2287 mb_mean=0.4978 norm_overlap=0.9915 corr_cb=-0.3664 topkJ=0.0113
[TRAIN][ep=025] loss=0.8755 acc=73.69%
[TRAIN][ep=025] mask_avg: mc_mean=0.1938 mb_mean=0.4982 norm_overlap=0.9934 corr_cb=-0.2923
[EPOCH 025/089] train: loss=0.8755 acc=73.69% | val: loss=0.6107 acc=66.27% f1=74.55% auc=72.38% val_score=63.8288 val_score_bestthr=69.3455 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.194, mb=0.498, no=0.993, corr=-0.292) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.3455
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1652 mb_mean=0.4982 norm_overlap=0.9931 corr_cb=-0.3143 topkJ=0.0150
[TRAIN][ep=026] loss=0.8491 acc=74.09%
[TRAIN][ep=026] mask_avg: mc_mean=0.2178 mb_mean=0.4982 norm_overlap=0.9933 corr_cb=-0.3234
[EPOCH 026/089] train: loss=0.8491 acc=74.09% | val: loss=0.6078 acc=66.27% f1=74.55% auc=72.67% val_score=63.1208 val_score_bestthr=69.3455 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.218, mb=0.498, no=0.993, corr=-0.323) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.3455
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2416 mb_mean=0.4957 norm_overlap=0.9898 corr_cb=-0.4231 topkJ=0.0048
[TRAIN][ep=027] loss=0.8417 acc=75.84%
[TRAIN][ep=027] mask_avg: mc_mean=0.2010 mb_mean=0.4982 norm_overlap=0.9933 corr_cb=-0.2988
[EPOCH 027/089] train: loss=0.8417 acc=75.84% | val: loss=0.6578 acc=65.06% f1=74.34% auc=71.57% val_score=63.5534 val_score_bestthr=69.8694 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.201, mb=0.498, no=0.993, corr=-0.299) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.8694
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1973 mb_mean=0.5019 norm_overlap=0.9845 corr_cb=-0.5170 topkJ=0.0023
[TRAIN][ep=028] loss=0.8276 acc=75.70%
[TRAIN][ep=028] mask_avg: mc_mean=0.2228 mb_mean=0.4982 norm_overlap=0.9938 corr_cb=-0.2902
[EPOCH 028/089] train: loss=0.8276 acc=75.70% | val: loss=0.7375 acc=66.27% f1=72.00% auc=71.10% val_score=68.3578 val_score_bestthr=67.1962 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.223, mb=0.498, no=0.994, corr=-0.290) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 67.1962
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2208 mb_mean=0.4959 norm_overlap=0.9959 corr_cb=-0.2072 topkJ=0.0225
[TRAIN][ep=029] loss=0.8300 acc=75.70%
[TRAIN][ep=029] mask_avg: mc_mean=0.2037 mb_mean=0.4982 norm_overlap=0.9936 corr_cb=-0.2818
[EPOCH 029/089] train: loss=0.8300 acc=75.70% | val: loss=0.6268 acc=66.27% f1=75.00% auc=71.80% val_score=65.7516 val_score_bestthr=69.3203 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.204, mb=0.498, no=0.994, corr=-0.282) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.3203
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2301 mb_mean=0.4994 norm_overlap=0.9948 corr_cb=-0.2782 topkJ=0.0239
[TRAIN][ep=030] loss=0.8304 acc=74.36%
[TRAIN][ep=030] mask_avg: mc_mean=0.2155 mb_mean=0.4982 norm_overlap=0.9939 corr_cb=-0.2738
[EPOCH 030/089] train: loss=0.8304 acc=74.36% | val: loss=0.6242 acc=67.47% f1=74.77% auc=72.67% val_score=52.9436 val_score_bestthr=68.6174 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.216, mb=0.498, no=0.994, corr=-0.274) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.6174
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2302 mb_mean=0.4974 norm_overlap=0.9959 corr_cb=-0.2215 topkJ=0.0413
[TRAIN][ep=031] loss=0.8188 acc=76.11%
[TRAIN][ep=031] mask_avg: mc_mean=0.2175 mb_mean=0.4982 norm_overlap=0.9936 corr_cb=-0.2812
[EPOCH 031/089] train: loss=0.8188 acc=76.11% | val: loss=0.5979 acc=69.88% f1=73.68% auc=74.01% val_score=65.1700 val_score_bestthr=71.5589 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.218, mb=0.498, no=0.994, corr=-0.281) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 71.5589
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.0824 mb_mean=0.4974 norm_overlap=0.9943 corr_cb=-0.1780 topkJ=0.0237
[TRAIN][ep=032] loss=0.8344 acc=74.09%
[TRAIN][ep=032] mask_avg: mc_mean=0.1526 mb_mean=0.4982 norm_overlap=0.9924 corr_cb=-0.2604
[EPOCH 032/089] train: loss=0.8344 acc=74.09% | val: loss=0.6333 acc=67.47% f1=75.68% auc=71.98% val_score=50.5703 val_score_bestthr=72.5854 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.153, mb=0.498, no=0.992, corr=-0.260) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 72.5854
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2544 mb_mean=0.4964 norm_overlap=0.9951 corr_cb=-0.2817 topkJ=0.0307
[TRAIN][ep=033] loss=0.8134 acc=76.11%
[TRAIN][ep=033] mask_avg: mc_mean=0.2115 mb_mean=0.4982 norm_overlap=0.9934 corr_cb=-0.2875
[EPOCH 033/089] train: loss=0.8134 acc=76.11% | val: loss=0.6358 acc=68.67% f1=75.93% auc=72.85% val_score=54.5348 val_score_bestthr=70.7418 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.212, mb=0.498, no=0.993, corr=-0.287) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 70.7418
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2111 mb_mean=0.4971 norm_overlap=0.9933 corr_cb=-0.2708 topkJ=0.0210
[TRAIN][ep=034] loss=0.8117 acc=75.57%
[TRAIN][ep=034] mask_avg: mc_mean=0.2036 mb_mean=0.4982 norm_overlap=0.9933 corr_cb=-0.2838
[EPOCH 034/089] train: loss=0.8117 acc=75.57% | val: loss=0.6180 acc=66.27% f1=68.89% auc=71.63% val_score=60.0411 val_score_bestthr=67.8208 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.204, mb=0.498, no=0.993, corr=-0.284) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 67.8208
[EARLY STOP] no improvement for 30 epochs. best_epoch=4
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
=============== FIT DONE ===============
[BEST] epoch=4 | val_acc=71.08% | val_f1=77.36% | val_auc=72.15% | val_score=74.3337 | val_score_bestthr=74.3337
[TEST@BEST] thr_used=0.580 | acc=63.77% f1=61.54% auc=65.38% | SP_sex=10.15% EO_sex=6.61% SP_age=10.52% EO_age=6.58%
[TIME] 0.94 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/summary_fold_2.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4409 mb_mean=0.4998 norm_overlap=0.9999 corr_cb=-0.1537 topkJ=0.0142
[TRAIN][ep=000] loss=0.6950 acc=50.07%
[TRAIN][ep=000] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2179
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4456 mb_mean=0.4977 norm_overlap=0.9998 corr_cb=-0.3429 topkJ=0.0084
[TRAIN][ep=001] loss=0.6929 acc=50.87%
[TRAIN][ep=001] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2197
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4416 mb_mean=0.4967 norm_overlap=1.0000 corr_cb=-0.0925 topkJ=0.0328
[TRAIN][ep=002] loss=0.6924 acc=50.87%
[TRAIN][ep=002] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2149
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4401 mb_mean=0.4989 norm_overlap=0.9997 corr_cb=-0.3682 topkJ=0.0059
[TRAIN][ep=003] loss=0.6906 acc=54.23%
[TRAIN][ep=003] mask_avg: mc_mean=0.4421 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2220
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4399 mb_mean=0.4974 norm_overlap=0.9999 corr_cb=-0.1290 topkJ=0.0272
[TRAIN][ep=004] loss=0.6889 acc=56.78%
[TRAIN][ep=004] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2177
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4388 mb_mean=0.4999 norm_overlap=0.9998 corr_cb=-0.3849 topkJ=0.0055
[TRAIN][ep=005] loss=0.6873 acc=53.69%
[TRAIN][ep=005] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2149
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4421 mb_mean=0.4993 norm_overlap=0.9998 corr_cb=-0.2996 topkJ=0.0246
[TRAIN][ep=006] loss=0.6838 acc=55.30%
[TRAIN][ep=006] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2113
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4448 mb_mean=0.4952 norm_overlap=1.0000 corr_cb=0.0093 topkJ=0.0332
[TRAIN][ep=007] loss=0.6811 acc=60.00%
[TRAIN][ep=007] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2179
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4400 mb_mean=0.4972 norm_overlap=1.0000 corr_cb=-0.0037 topkJ=0.0472
[TRAIN][ep=008] loss=0.6783 acc=61.21%
[TRAIN][ep=008] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2155
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4446 mb_mean=0.4966 norm_overlap=0.9999 corr_cb=-0.2381 topkJ=0.0197
[TRAIN][ep=009] loss=0.6708 acc=59.46%
[TRAIN][ep=009] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2154
================= FIT START (fold=2) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4430 mb_mean=0.4980 norm_overlap=1.0000 corr_cb=-0.1091 topkJ=0.0223
[TRAIN][ep=000] loss=0.6696 acc=60.40%
[TRAIN][ep=000] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2180
[EPOCH 000/089] train: loss=0.6696 acc=60.40% | val: loss=0.6634 acc=71.08% f1=76.92% auc=71.57% val_score=69.3393 val_score_bestthr=68.6591 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.218) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 68.6591
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4450 mb_mean=0.4972 norm_overlap=0.9999 corr_cb=-0.1381 topkJ=0.0336
[TRAIN][ep=001] loss=0.6650 acc=60.81%
[TRAIN][ep=001] mask_avg: mc_mean=0.4421 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2187
[EPOCH 001/089] train: loss=0.6650 acc=60.81% | val: loss=0.6592 acc=68.67% f1=72.34% auc=71.34% val_score=67.1354 val_score_bestthr=72.7288 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.219) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 68.6591 -> 72.7288
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4416 mb_mean=0.4970 norm_overlap=0.9999 corr_cb=-0.1910 topkJ=0.0291
[TRAIN][ep=002] loss=0.6560 acc=62.55%
[TRAIN][ep=002] mask_avg: mc_mean=0.4421 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2200
[EPOCH 002/089] train: loss=0.6560 acc=62.55% | val: loss=0.6560 acc=68.67% f1=72.92% auc=69.71% val_score=65.8565 val_score_bestthr=65.7661 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.220) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7288 -> 65.7661
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4419 mb_mean=0.4995 norm_overlap=0.9998 corr_cb=-0.3017 topkJ=0.0204
[TRAIN][ep=003] loss=0.6535 acc=60.67%
[TRAIN][ep=003] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2169
[EPOCH 003/089] train: loss=0.6535 acc=60.67% | val: loss=0.6815 acc=69.88% f1=73.68% auc=70.64% val_score=61.3370 val_score_bestthr=71.4030 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.217) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7288 -> 71.4030
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4404 mb_mean=0.4979 norm_overlap=0.9999 corr_cb=-0.1561 topkJ=0.0339
[TRAIN][ep=004] loss=0.6513 acc=62.28%
[TRAIN][ep=004] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2191
[EPOCH 004/089] train: loss=0.6513 acc=62.28% | val: loss=0.6489 acc=71.08% f1=77.36% auc=72.21% val_score=74.3337 val_score_bestthr=74.3337 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.219) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 72.7288 -> 74.3337
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4474 mb_mean=0.4984 norm_overlap=1.0000 corr_cb=-0.0752 topkJ=0.0199
[TRAIN][ep=005] loss=1.2519 acc=62.28%
[TRAIN][ep=005] mask_avg: mc_mean=0.3167 mb_mean=0.4982 norm_overlap=0.9991 corr_cb=-0.2692
[EPOCH 005/089] train: loss=1.2519 acc=62.28% | val: loss=0.6669 acc=66.27% f1=68.18% auc=69.83% val_score=48.0730 val_score_bestthr=68.0173 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.317, mb=0.498, no=0.999, corr=-0.269) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.0173
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2511 mb_mean=0.4984 norm_overlap=0.9986 corr_cb=-0.2152 topkJ=0.0245
[TRAIN][ep=006] loss=1.2445 acc=62.82%
[TRAIN][ep=006] mask_avg: mc_mean=0.2170 mb_mean=0.4982 norm_overlap=0.9984 corr_cb=-0.2362
[EPOCH 006/089] train: loss=1.2445 acc=62.82% | val: loss=0.6463 acc=72.29% f1=77.23% auc=73.02% val_score=64.7852 val_score_bestthr=70.9614 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.217, mb=0.498, no=0.998, corr=-0.236) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 70.9614
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2379 mb_mean=0.5001 norm_overlap=0.9983 corr_cb=-0.2411 topkJ=0.0473
[TRAIN][ep=007] loss=1.2326 acc=63.76%
[TRAIN][ep=007] mask_avg: mc_mean=0.1779 mb_mean=0.4982 norm_overlap=0.9980 corr_cb=-0.2181
[EPOCH 007/089] train: loss=1.2326 acc=63.76% | val: loss=0.6428 acc=71.08% f1=76.92% auc=72.91% val_score=61.4276 val_score_bestthr=72.2412 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.178, mb=0.498, no=0.998, corr=-0.218) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 72.2412
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1674 mb_mean=0.4984 norm_overlap=0.9984 corr_cb=-0.1994 topkJ=0.0447
[TRAIN][ep=008] loss=1.2172 acc=66.17%
[TRAIN][ep=008] mask_avg: mc_mean=0.1421 mb_mean=0.4982 norm_overlap=0.9977 corr_cb=-0.1901
[EPOCH 008/089] train: loss=1.2172 acc=66.17% | val: loss=0.6701 acc=71.08% f1=75.00% auc=71.74% val_score=64.4280 val_score_bestthr=68.0334 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.142, mb=0.498, no=0.998, corr=-0.190) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.0334
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1307 mb_mean=0.4974 norm_overlap=0.9973 corr_cb=-0.2203 topkJ=0.0255
[TRAIN][ep=009] loss=1.2154 acc=65.37%
[TRAIN][ep=009] mask_avg: mc_mean=0.1318 mb_mean=0.4982 norm_overlap=0.9971 corr_cb=-0.2029
[EPOCH 009/089] train: loss=1.2154 acc=65.37% | val: loss=0.6477 acc=66.27% f1=75.00% auc=72.21% val_score=71.9483 val_score_bestthr=71.9483 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.132, mb=0.498, no=0.997, corr=-0.203) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 71.9483
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1345 mb_mean=0.4962 norm_overlap=0.9957 corr_cb=-0.2948 topkJ=0.0244
[TRAIN][ep=010] loss=1.0049 acc=65.91%
[TRAIN][ep=010] mask_avg: mc_mean=0.1298 mb_mean=0.4982 norm_overlap=0.9966 corr_cb=-0.2179
[EPOCH 010/089] train: loss=1.0049 acc=65.91% | val: loss=0.6370 acc=67.47% f1=75.68% auc=72.67% val_score=67.7793 val_score_bestthr=72.3795 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.130, mb=0.498, no=0.997, corr=-0.218) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 72.3795
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1542 mb_mean=0.4990 norm_overlap=0.9967 corr_cb=-0.2427 topkJ=0.0258
[TRAIN][ep=011] loss=0.8094 acc=66.98%
[TRAIN][ep=011] mask_avg: mc_mean=0.1378 mb_mean=0.4982 norm_overlap=0.9965 corr_cb=-0.2105
[EPOCH 011/089] train: loss=0.8094 acc=66.98% | val: loss=0.6495 acc=69.88% f1=74.23% auc=71.10% val_score=52.6552 val_score_bestthr=67.2798 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.138, mb=0.498, no=0.996, corr=-0.211) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 67.2798
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1605 mb_mean=0.4965 norm_overlap=0.9984 corr_cb=-0.1157 topkJ=0.0666
[TRAIN][ep=012] loss=0.7633 acc=68.46%
[TRAIN][ep=012] mask_avg: mc_mean=0.1405 mb_mean=0.4982 norm_overlap=0.9960 corr_cb=-0.2216
[EPOCH 012/089] train: loss=0.7633 acc=68.46% | val: loss=0.6221 acc=69.88% f1=74.75% auc=72.79% val_score=58.3227 val_score_bestthr=69.8778 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.140, mb=0.498, no=0.996, corr=-0.222) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.8778
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.0972 mb_mean=0.5001 norm_overlap=0.9935 corr_cb=-0.2875 topkJ=0.0358
[TRAIN][ep=013] loss=0.7415 acc=67.65%
[TRAIN][ep=013] mask_avg: mc_mean=0.1545 mb_mean=0.4982 norm_overlap=0.9954 corr_cb=-0.2576
[EPOCH 013/089] train: loss=0.7415 acc=67.65% | val: loss=0.6228 acc=71.08% f1=76.00% auc=72.09% val_score=62.4943 val_score_bestthr=71.2903 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.155, mb=0.498, no=0.995, corr=-0.258) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 71.2903
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1824 mb_mean=0.4970 norm_overlap=0.9947 corr_cb=-0.3071 topkJ=0.0165
[TRAIN][ep=014] loss=0.7429 acc=68.46%
[TRAIN][ep=014] mask_avg: mc_mean=0.1791 mb_mean=0.4982 norm_overlap=0.9952 corr_cb=-0.2752
[EPOCH 014/089] train: loss=0.7429 acc=68.46% | val: loss=0.6164 acc=69.88% f1=75.25% auc=72.91% val_score=59.2691 val_score_bestthr=69.1460 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.179, mb=0.498, no=0.995, corr=-0.275) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.1460
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1654 mb_mean=0.4996 norm_overlap=0.9920 corr_cb=-0.4323 topkJ=0.0254
[TRAIN][ep=015] loss=0.7330 acc=69.26%
[TRAIN][ep=015] mask_avg: mc_mean=0.1622 mb_mean=0.4982 norm_overlap=0.9940 corr_cb=-0.3183
[EPOCH 015/089] train: loss=0.7330 acc=69.26% | val: loss=0.6273 acc=69.88% f1=73.12% auc=72.85% val_score=56.0182 val_score_bestthr=71.3343 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.162, mb=0.498, no=0.994, corr=-0.318) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 71.3343
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1774 mb_mean=0.4984 norm_overlap=0.9965 corr_cb=-0.2071 topkJ=0.0264
[TRAIN][ep=016] loss=0.7338 acc=71.28%
[TRAIN][ep=016] mask_avg: mc_mean=0.1997 mb_mean=0.4982 norm_overlap=0.9939 corr_cb=-0.3483
[EPOCH 016/089] train: loss=0.7338 acc=71.28% | val: loss=0.6165 acc=69.88% f1=74.75% auc=72.85% val_score=60.8079 val_score_bestthr=70.2978 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.200, mb=0.498, no=0.994, corr=-0.348) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 70.2978
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1652 mb_mean=0.4984 norm_overlap=0.9933 corr_cb=-0.2928 topkJ=0.0265
[TRAIN][ep=017] loss=0.7230 acc=69.26%
[TRAIN][ep=017] mask_avg: mc_mean=0.1694 mb_mean=0.4982 norm_overlap=0.9932 corr_cb=-0.3320
[EPOCH 017/089] train: loss=0.7230 acc=69.26% | val: loss=0.6101 acc=67.47% f1=72.73% auc=72.79% val_score=61.7641 val_score_bestthr=70.0360 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.169, mb=0.498, no=0.993, corr=-0.332) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 70.0360
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1474 mb_mean=0.4979 norm_overlap=0.9936 corr_cb=-0.2907 topkJ=0.0189
[TRAIN][ep=018] loss=0.7076 acc=71.54%
[TRAIN][ep=018] mask_avg: mc_mean=0.1737 mb_mean=0.4982 norm_overlap=0.9931 corr_cb=-0.3281
[EPOCH 018/089] train: loss=0.7076 acc=71.54% | val: loss=0.6130 acc=68.67% f1=72.92% auc=72.73% val_score=62.4943 val_score_bestthr=68.5441 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.174, mb=0.498, no=0.993, corr=-0.328) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.5441
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.2041 mb_mean=0.5006 norm_overlap=0.9927 corr_cb=-0.4081 topkJ=0.0154
[TRAIN][ep=019] loss=0.7228 acc=70.60%
[TRAIN][ep=019] mask_avg: mc_mean=0.1925 mb_mean=0.4982 norm_overlap=0.9928 corr_cb=-0.3568
[EPOCH 019/089] train: loss=0.7228 acc=70.60% | val: loss=0.6094 acc=67.47% f1=72.73% auc=72.62% val_score=54.6218 val_score_bestthr=67.4367 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.193, mb=0.498, no=0.993, corr=-0.357) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 67.4367
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.2234 mb_mean=0.4972 norm_overlap=0.9909 corr_cb=-0.4227 topkJ=0.0012
[TRAIN][ep=020] loss=0.7157 acc=69.80%
[TRAIN][ep=020] mask_avg: mc_mean=0.1765 mb_mean=0.4982 norm_overlap=0.9923 corr_cb=-0.3607
[EPOCH 020/089] train: loss=0.7157 acc=69.80% | val: loss=0.6085 acc=67.47% f1=75.68% auc=73.37% val_score=64.4585 val_score_bestthr=69.7154 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.176, mb=0.498, no=0.992, corr=-0.361) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.7154
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2319 mb_mean=0.4957 norm_overlap=0.9941 corr_cb=-0.3420 topkJ=0.0175
[TRAIN][ep=021] loss=0.6971 acc=72.89%
[TRAIN][ep=021] mask_avg: mc_mean=0.1956 mb_mean=0.4982 norm_overlap=0.9929 corr_cb=-0.3459
[EPOCH 021/089] train: loss=0.6971 acc=72.89% | val: loss=0.6046 acc=69.88% f1=71.26% auc=73.14% val_score=62.8808 val_score_bestthr=70.7970 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.196, mb=0.498, no=0.993, corr=-0.346) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 70.7970
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2075 mb_mean=0.4977 norm_overlap=0.9955 corr_cb=-0.2724 topkJ=0.0280
[TRAIN][ep=022] loss=0.6833 acc=73.96%
[TRAIN][ep=022] mask_avg: mc_mean=0.2036 mb_mean=0.4982 norm_overlap=0.9934 corr_cb=-0.3175
[EPOCH 022/089] train: loss=0.6833 acc=73.96% | val: loss=0.6195 acc=69.88% f1=73.68% auc=73.43% val_score=56.9658 val_score_bestthr=68.1984 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.204, mb=0.498, no=0.993, corr=-0.317) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.1984
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1573 mb_mean=0.4976 norm_overlap=0.9942 corr_cb=-0.2442 topkJ=0.0218
[TRAIN][ep=023] loss=0.7055 acc=71.54%
[TRAIN][ep=023] mask_avg: mc_mean=0.1954 mb_mean=0.4982 norm_overlap=0.9931 corr_cb=-0.3214
[EPOCH 023/089] train: loss=0.7055 acc=71.54% | val: loss=0.7032 acc=69.88% f1=76.64% auc=72.67% val_score=45.7063 val_score_bestthr=69.6805 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.195, mb=0.498, no=0.993, corr=-0.321) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.6805
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1935 mb_mean=0.4983 norm_overlap=0.9922 corr_cb=-0.3517 topkJ=0.0274
[TRAIN][ep=024] loss=0.6869 acc=74.09%
[TRAIN][ep=024] mask_avg: mc_mean=0.1867 mb_mean=0.4982 norm_overlap=0.9929 corr_cb=-0.3157
[EPOCH 024/089] train: loss=0.6869 acc=74.09% | val: loss=0.6077 acc=69.88% f1=71.26% auc=72.97% val_score=62.3068 val_score_bestthr=70.7970 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.187, mb=0.498, no=0.993, corr=-0.316) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 70.7970
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2282 mb_mean=0.4978 norm_overlap=0.9914 corr_cb=-0.3676 topkJ=0.0113
[TRAIN][ep=025] loss=0.6942 acc=73.56%
[TRAIN][ep=025] mask_avg: mc_mean=0.1930 mb_mean=0.4982 norm_overlap=0.9934 corr_cb=-0.2931
[EPOCH 025/089] train: loss=0.6942 acc=73.56% | val: loss=0.6100 acc=66.27% f1=74.55% auc=72.38% val_score=63.8288 val_score_bestthr=69.3455 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.193, mb=0.498, no=0.993, corr=-0.293) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.3455
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1669 mb_mean=0.4982 norm_overlap=0.9931 corr_cb=-0.3163 topkJ=0.0150
[TRAIN][ep=026] loss=0.6685 acc=74.36%
[TRAIN][ep=026] mask_avg: mc_mean=0.2178 mb_mean=0.4982 norm_overlap=0.9933 corr_cb=-0.3244
[EPOCH 026/089] train: loss=0.6685 acc=74.36% | val: loss=0.6070 acc=67.47% f1=75.23% auc=72.85% val_score=63.1208 val_score_bestthr=69.7779 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.218, mb=0.498, no=0.993, corr=-0.324) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.7779
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2411 mb_mean=0.4957 norm_overlap=0.9898 corr_cb=-0.4241 topkJ=0.0048
[TRAIN][ep=027] loss=0.6630 acc=75.97%
[TRAIN][ep=027] mask_avg: mc_mean=0.2007 mb_mean=0.4982 norm_overlap=0.9933 corr_cb=-0.2998
[EPOCH 027/089] train: loss=0.6630 acc=75.97% | val: loss=0.6560 acc=65.06% f1=74.34% auc=71.51% val_score=63.5534 val_score_bestthr=69.8694 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.201, mb=0.498, no=0.993, corr=-0.300) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.8694
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1975 mb_mean=0.5019 norm_overlap=0.9845 corr_cb=-0.5176 topkJ=0.0023
[TRAIN][ep=028] loss=0.6493 acc=75.97%
[TRAIN][ep=028] mask_avg: mc_mean=0.2235 mb_mean=0.4982 norm_overlap=0.9938 corr_cb=-0.2911
[EPOCH 028/089] train: loss=0.6493 acc=75.97% | val: loss=0.7361 acc=66.27% f1=72.00% auc=71.16% val_score=68.3578 val_score_bestthr=67.1962 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.224, mb=0.498, no=0.994, corr=-0.291) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 67.1962
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2192 mb_mean=0.4959 norm_overlap=0.9958 corr_cb=-0.2082 topkJ=0.0221
[TRAIN][ep=029] loss=0.6539 acc=75.97%
[TRAIN][ep=029] mask_avg: mc_mean=0.2035 mb_mean=0.4982 norm_overlap=0.9935 corr_cb=-0.2829
[EPOCH 029/089] train: loss=0.6539 acc=75.97% | val: loss=0.6281 acc=65.06% f1=73.87% auc=71.45% val_score=63.8288 val_score_bestthr=68.9509 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.203, mb=0.498, no=0.994, corr=-0.283) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.9509
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2290 mb_mean=0.4994 norm_overlap=0.9948 corr_cb=-0.2796 topkJ=0.0234
[TRAIN][ep=030] loss=0.6560 acc=74.23%
[TRAIN][ep=030] mask_avg: mc_mean=0.2146 mb_mean=0.4982 norm_overlap=0.9939 corr_cb=-0.2746
[EPOCH 030/089] train: loss=0.6560 acc=74.23% | val: loss=0.6261 acc=67.47% f1=75.68% auc=72.38% val_score=52.9436 val_score_bestthr=69.7154 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.215, mb=0.498, no=0.994, corr=-0.275) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.7154
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2294 mb_mean=0.4974 norm_overlap=0.9959 corr_cb=-0.2221 topkJ=0.0413
[TRAIN][ep=031] loss=0.6438 acc=75.97%
[TRAIN][ep=031] mask_avg: mc_mean=0.2187 mb_mean=0.4982 norm_overlap=0.9936 corr_cb=-0.2824
[EPOCH 031/089] train: loss=0.6438 acc=75.97% | val: loss=0.5989 acc=69.88% f1=73.68% auc=73.78% val_score=65.4434 val_score_bestthr=71.5589 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.219, mb=0.498, no=0.994, corr=-0.282) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 71.5589
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.0837 mb_mean=0.4974 norm_overlap=0.9943 corr_cb=-0.1800 topkJ=0.0237
[TRAIN][ep=032] loss=0.6595 acc=74.23%
[TRAIN][ep=032] mask_avg: mc_mean=0.1544 mb_mean=0.4982 norm_overlap=0.9924 corr_cb=-0.2618
[EPOCH 032/089] train: loss=0.6595 acc=74.23% | val: loss=0.6329 acc=67.47% f1=75.68% auc=71.80% val_score=50.5703 val_score_bestthr=72.5854 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.154, mb=0.498, no=0.992, corr=-0.262) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 72.5854
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2544 mb_mean=0.4964 norm_overlap=0.9951 corr_cb=-0.2828 topkJ=0.0302
[TRAIN][ep=033] loss=0.6412 acc=76.24%
[TRAIN][ep=033] mask_avg: mc_mean=0.2118 mb_mean=0.4982 norm_overlap=0.9934 corr_cb=-0.2876
[EPOCH 033/089] train: loss=0.6412 acc=76.24% | val: loss=0.6407 acc=68.67% f1=75.47% auc=72.67% val_score=54.5348 val_score_bestthr=68.1572 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.212, mb=0.498, no=0.993, corr=-0.288) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.1572
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2087 mb_mean=0.4971 norm_overlap=0.9933 corr_cb=-0.2690 topkJ=0.0210
[TRAIN][ep=034] loss=0.6361 acc=75.84%
[TRAIN][ep=034] mask_avg: mc_mean=0.2013 mb_mean=0.4982 norm_overlap=0.9933 corr_cb=-0.2838
[EPOCH 034/089] train: loss=0.6361 acc=75.84% | val: loss=0.6185 acc=68.67% f1=75.00% auc=71.92% val_score=63.2155 val_score_bestthr=66.2214 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.201, mb=0.498, no=0.993, corr=-0.284) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 66.2214
[EARLY STOP] no improvement for 30 epochs. best_epoch=4
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
=============== FIT DONE ===============
[BEST] epoch=4 | val_acc=71.08% | val_f1=77.36% | val_auc=72.21% | val_score=74.3337 | val_score_bestthr=74.3337
[TEST@BEST] thr_used=0.580 | acc=63.77% f1=61.54% auc=65.38% | SP_sex=10.15% EO_sex=6.61% SP_age=10.52% EO_age=6.58%
[TIME] 0.90 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/summary_fold_2.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4409 mb_mean=0.4998 norm_overlap=0.9999 corr_cb=-0.1537 topkJ=0.0142
[TRAIN][ep=000] loss=0.6950 acc=50.07%
[TRAIN][ep=000] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2179
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4456 mb_mean=0.4977 norm_overlap=0.9998 corr_cb=-0.3429 topkJ=0.0084
[TRAIN][ep=001] loss=0.6929 acc=50.87%
[TRAIN][ep=001] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2197
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4416 mb_mean=0.4967 norm_overlap=1.0000 corr_cb=-0.0925 topkJ=0.0328
[TRAIN][ep=002] loss=0.6924 acc=50.87%
[TRAIN][ep=002] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2149
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4401 mb_mean=0.4989 norm_overlap=0.9997 corr_cb=-0.3682 topkJ=0.0059
[TRAIN][ep=003] loss=0.6906 acc=54.23%
[TRAIN][ep=003] mask_avg: mc_mean=0.4421 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2220
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4399 mb_mean=0.4974 norm_overlap=0.9999 corr_cb=-0.1290 topkJ=0.0272
[TRAIN][ep=004] loss=0.6889 acc=56.78%
[TRAIN][ep=004] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2177
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4388 mb_mean=0.4999 norm_overlap=0.9998 corr_cb=-0.3849 topkJ=0.0055
[TRAIN][ep=005] loss=0.6873 acc=53.83%
[TRAIN][ep=005] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2149
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4421 mb_mean=0.4993 norm_overlap=0.9998 corr_cb=-0.2996 topkJ=0.0246
[TRAIN][ep=006] loss=0.6838 acc=55.44%
[TRAIN][ep=006] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2113
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4448 mb_mean=0.4952 norm_overlap=1.0000 corr_cb=0.0093 topkJ=0.0332
[TRAIN][ep=007] loss=0.6811 acc=59.87%
[TRAIN][ep=007] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2179
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4400 mb_mean=0.4972 norm_overlap=1.0000 corr_cb=-0.0037 topkJ=0.0472
[TRAIN][ep=008] loss=0.6783 acc=61.21%
[TRAIN][ep=008] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2155
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4446 mb_mean=0.4966 norm_overlap=0.9999 corr_cb=-0.2381 topkJ=0.0197
[TRAIN][ep=009] loss=0.6708 acc=59.46%
[TRAIN][ep=009] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2154
================= FIT START (fold=2) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4430 mb_mean=0.4980 norm_overlap=1.0000 corr_cb=-0.1091 topkJ=0.0223
[TRAIN][ep=000] loss=0.6696 acc=60.40%
[TRAIN][ep=000] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2180
[EPOCH 000/089] train: loss=0.6696 acc=60.40% | val: loss=0.6634 acc=71.08% f1=76.92% auc=71.57% val_score=69.3393 val_score_bestthr=68.6591 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.218) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 68.6591
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4450 mb_mean=0.4972 norm_overlap=0.9999 corr_cb=-0.1381 topkJ=0.0336
[TRAIN][ep=001] loss=0.6650 acc=60.67%
[TRAIN][ep=001] mask_avg: mc_mean=0.4421 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2187
[EPOCH 001/089] train: loss=0.6650 acc=60.67% | val: loss=0.6591 acc=68.67% f1=72.34% auc=71.34% val_score=67.1354 val_score_bestthr=72.7288 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.219) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 68.6591 -> 72.7288
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4416 mb_mean=0.4970 norm_overlap=0.9999 corr_cb=-0.1910 topkJ=0.0291
[TRAIN][ep=002] loss=0.6560 acc=62.55%
[TRAIN][ep=002] mask_avg: mc_mean=0.4421 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2200
[EPOCH 002/089] train: loss=0.6560 acc=62.55% | val: loss=0.6559 acc=68.67% f1=73.47% auc=69.65% val_score=65.8565 val_score_bestthr=69.0984 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.220) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7288 -> 69.0984
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4419 mb_mean=0.4995 norm_overlap=0.9998 corr_cb=-0.3017 topkJ=0.0204
[TRAIN][ep=003] loss=0.6534 acc=60.67%
[TRAIN][ep=003] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2169
[EPOCH 003/089] train: loss=0.6534 acc=60.67% | val: loss=0.6815 acc=69.88% f1=73.68% auc=70.64% val_score=61.3370 val_score_bestthr=71.4030 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.217) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 72.7288 -> 71.4030
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4404 mb_mean=0.4979 norm_overlap=0.9999 corr_cb=-0.1561 topkJ=0.0339
[TRAIN][ep=004] loss=0.6513 acc=62.15%
[TRAIN][ep=004] mask_avg: mc_mean=0.4422 mb_mean=0.4982 norm_overlap=0.9999 corr_cb=-0.2191
[EPOCH 004/089] train: loss=0.6513 acc=62.15% | val: loss=0.6489 acc=71.08% f1=77.36% auc=72.21% val_score=74.3337 val_score_bestthr=74.3337 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.442, mb=0.498, no=1.000, corr=-0.219) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 72.7288 -> 74.3337
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4474 mb_mean=0.4984 norm_overlap=1.0000 corr_cb=-0.0752 topkJ=0.0199
[TRAIN][ep=005] loss=1.3678 acc=61.74%
[TRAIN][ep=005] mask_avg: mc_mean=0.3165 mb_mean=0.4982 norm_overlap=0.9991 corr_cb=-0.2688
[EPOCH 005/089] train: loss=1.3678 acc=61.74% | val: loss=0.6671 acc=66.27% f1=68.18% auc=69.77% val_score=47.1055 val_score_bestthr=68.0173 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.317, mb=0.498, no=0.999, corr=-0.269) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.0173
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2510 mb_mean=0.4984 norm_overlap=0.9986 corr_cb=-0.2147 topkJ=0.0245
[TRAIN][ep=006] loss=1.3556 acc=62.82%
[TRAIN][ep=006] mask_avg: mc_mean=0.2167 mb_mean=0.4982 norm_overlap=0.9984 corr_cb=-0.2360
[EPOCH 006/089] train: loss=1.3556 acc=62.82% | val: loss=0.6459 acc=72.29% f1=77.23% auc=73.08% val_score=64.7852 val_score_bestthr=70.9614 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.217, mb=0.498, no=0.998, corr=-0.236) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 70.9614
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2365 mb_mean=0.5001 norm_overlap=0.9982 corr_cb=-0.2408 topkJ=0.0478
[TRAIN][ep=007] loss=1.3432 acc=63.49%
[TRAIN][ep=007] mask_avg: mc_mean=0.1763 mb_mean=0.4982 norm_overlap=0.9980 corr_cb=-0.2173
[EPOCH 007/089] train: loss=1.3432 acc=63.49% | val: loss=0.6423 acc=71.08% f1=76.92% auc=72.97% val_score=61.4276 val_score_bestthr=72.2412 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.176, mb=0.498, no=0.998, corr=-0.217) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 72.2412
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.1671 mb_mean=0.4984 norm_overlap=0.9984 corr_cb=-0.1994 topkJ=0.0447
[TRAIN][ep=008] loss=1.3274 acc=66.17%
[TRAIN][ep=008] mask_avg: mc_mean=0.1418 mb_mean=0.4982 norm_overlap=0.9976 corr_cb=-0.1897
[EPOCH 008/089] train: loss=1.3274 acc=66.17% | val: loss=0.6689 acc=71.08% f1=75.00% auc=71.80% val_score=64.4280 val_score_bestthr=68.0334 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.142, mb=0.498, no=0.998, corr=-0.190) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.0334
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.1304 mb_mean=0.4974 norm_overlap=0.9973 corr_cb=-0.2208 topkJ=0.0255
[TRAIN][ep=009] loss=1.3250 acc=65.10%
[TRAIN][ep=009] mask_avg: mc_mean=0.1316 mb_mean=0.4982 norm_overlap=0.9971 corr_cb=-0.2024
[EPOCH 009/089] train: loss=1.3250 acc=65.10% | val: loss=0.6471 acc=66.27% f1=75.00% auc=72.44% val_score=71.9483 val_score_bestthr=71.9483 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.132, mb=0.498, no=0.997, corr=-0.202) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 71.9483
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.1351 mb_mean=0.4962 norm_overlap=0.9957 corr_cb=-0.2936 topkJ=0.0244
[TRAIN][ep=010] loss=1.1201 acc=66.17%
[TRAIN][ep=010] mask_avg: mc_mean=0.1304 mb_mean=0.4982 norm_overlap=0.9967 corr_cb=-0.2172
[EPOCH 010/089] train: loss=1.1201 acc=66.17% | val: loss=0.6364 acc=67.47% f1=75.68% auc=72.79% val_score=67.7793 val_score_bestthr=72.3795 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.130, mb=0.498, no=0.997, corr=-0.217) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 72.3795
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.1550 mb_mean=0.4990 norm_overlap=0.9968 corr_cb=-0.2415 topkJ=0.0258
[TRAIN][ep=011] loss=0.9301 acc=67.38%
[TRAIN][ep=011] mask_avg: mc_mean=0.1383 mb_mean=0.4982 norm_overlap=0.9965 corr_cb=-0.2098
[EPOCH 011/089] train: loss=0.9301 acc=67.38% | val: loss=0.6489 acc=71.08% f1=75.51% auc=71.10% val_score=52.6552 val_score_bestthr=69.8660 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.138, mb=0.498, no=0.997, corr=-0.210) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.8660
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.1616 mb_mean=0.4965 norm_overlap=0.9984 corr_cb=-0.1153 topkJ=0.0666
[TRAIN][ep=012] loss=0.8867 acc=68.59%
[TRAIN][ep=012] mask_avg: mc_mean=0.1406 mb_mean=0.4982 norm_overlap=0.9960 corr_cb=-0.2210
[EPOCH 012/089] train: loss=0.8867 acc=68.59% | val: loss=0.6216 acc=71.08% f1=76.47% auc=72.73% val_score=58.3227 val_score_bestthr=71.6864 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.141, mb=0.498, no=0.996, corr=-0.221) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 71.6864
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.0972 mb_mean=0.5001 norm_overlap=0.9935 corr_cb=-0.2868 topkJ=0.0358
[TRAIN][ep=013] loss=0.8645 acc=67.92%
[TRAIN][ep=013] mask_avg: mc_mean=0.1544 mb_mean=0.4982 norm_overlap=0.9954 corr_cb=-0.2570
[EPOCH 013/089] train: loss=0.8645 acc=67.92% | val: loss=0.6227 acc=72.29% f1=76.29% auc=71.98% val_score=62.4943 val_score_bestthr=73.1465 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.154, mb=0.498, no=0.995, corr=-0.257) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 73.1465
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.1827 mb_mean=0.4970 norm_overlap=0.9947 corr_cb=-0.3068 topkJ=0.0165
[TRAIN][ep=014] loss=0.8656 acc=68.86%
[TRAIN][ep=014] mask_avg: mc_mean=0.1788 mb_mean=0.4982 norm_overlap=0.9952 corr_cb=-0.2743
[EPOCH 014/089] train: loss=0.8656 acc=68.86% | val: loss=0.6161 acc=71.08% f1=76.00% auc=72.91% val_score=59.2691 val_score_bestthr=70.6726 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.179, mb=0.498, no=0.995, corr=-0.274) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 70.6726
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.1658 mb_mean=0.4996 norm_overlap=0.9920 corr_cb=-0.4309 topkJ=0.0254
[TRAIN][ep=015] loss=0.8551 acc=68.99%
[TRAIN][ep=015] mask_avg: mc_mean=0.1629 mb_mean=0.4982 norm_overlap=0.9940 corr_cb=-0.3179
[EPOCH 015/089] train: loss=0.8551 acc=68.99% | val: loss=0.6272 acc=69.88% f1=73.12% auc=72.73% val_score=56.0182 val_score_bestthr=71.3343 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.163, mb=0.498, no=0.994, corr=-0.318) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 71.3343
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1774 mb_mean=0.4984 norm_overlap=0.9965 corr_cb=-0.2066 topkJ=0.0264
[TRAIN][ep=016] loss=0.8561 acc=71.14%
[TRAIN][ep=016] mask_avg: mc_mean=0.1996 mb_mean=0.4982 norm_overlap=0.9939 corr_cb=-0.3475
[EPOCH 016/089] train: loss=0.8561 acc=71.14% | val: loss=0.6163 acc=69.88% f1=74.75% auc=72.97% val_score=62.4943 val_score_bestthr=70.2978 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.200, mb=0.498, no=0.994, corr=-0.348) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 70.2978
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.1647 mb_mean=0.4984 norm_overlap=0.9933 corr_cb=-0.2922 topkJ=0.0265
[TRAIN][ep=017] loss=0.8445 acc=69.13%
[TRAIN][ep=017] mask_avg: mc_mean=0.1696 mb_mean=0.4982 norm_overlap=0.9932 corr_cb=-0.3316
[EPOCH 017/089] train: loss=0.8445 acc=69.13% | val: loss=0.6102 acc=68.67% f1=75.00% auc=72.97% val_score=61.7641 val_score_bestthr=68.0330 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.170, mb=0.498, no=0.993, corr=-0.332) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.0330
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.1483 mb_mean=0.4979 norm_overlap=0.9936 corr_cb=-0.2912 topkJ=0.0185
[TRAIN][ep=018] loss=0.8287 acc=71.41%
[TRAIN][ep=018] mask_avg: mc_mean=0.1741 mb_mean=0.4982 norm_overlap=0.9931 corr_cb=-0.3280
[EPOCH 018/089] train: loss=0.8287 acc=71.41% | val: loss=0.6130 acc=69.88% f1=74.23% auc=72.79% val_score=62.4943 val_score_bestthr=69.3476 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.174, mb=0.498, no=0.993, corr=-0.328) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.3476
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.2050 mb_mean=0.5006 norm_overlap=0.9927 corr_cb=-0.4083 topkJ=0.0154
[TRAIN][ep=019] loss=0.8438 acc=70.60%
[TRAIN][ep=019] mask_avg: mc_mean=0.1935 mb_mean=0.4982 norm_overlap=0.9928 corr_cb=-0.3570
[EPOCH 019/089] train: loss=0.8438 acc=70.60% | val: loss=0.6093 acc=67.47% f1=72.73% auc=72.50% val_score=54.6218 val_score_bestthr=67.4367 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.194, mb=0.498, no=0.993, corr=-0.357) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 67.4367
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.2248 mb_mean=0.4972 norm_overlap=0.9909 corr_cb=-0.4234 topkJ=0.0012
[TRAIN][ep=020] loss=0.8364 acc=69.53%
[TRAIN][ep=020] mask_avg: mc_mean=0.1778 mb_mean=0.4982 norm_overlap=0.9923 corr_cb=-0.3610
[EPOCH 020/089] train: loss=0.8364 acc=69.53% | val: loss=0.6087 acc=67.47% f1=75.68% auc=73.31% val_score=64.4585 val_score_bestthr=69.7154 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.178, mb=0.498, no=0.992, corr=-0.361) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.7154
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2322 mb_mean=0.4957 norm_overlap=0.9941 corr_cb=-0.3410 topkJ=0.0175
[TRAIN][ep=021] loss=0.8175 acc=72.75%
[TRAIN][ep=021] mask_avg: mc_mean=0.1965 mb_mean=0.4982 norm_overlap=0.9929 corr_cb=-0.3455
[EPOCH 021/089] train: loss=0.8175 acc=72.75% | val: loss=0.6048 acc=69.88% f1=71.26% auc=73.08% val_score=65.5137 val_score_bestthr=70.7970 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.196, mb=0.498, no=0.993, corr=-0.346) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 70.7970
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2079 mb_mean=0.4977 norm_overlap=0.9955 corr_cb=-0.2722 topkJ=0.0284
[TRAIN][ep=022] loss=0.8023 acc=73.96%
[TRAIN][ep=022] mask_avg: mc_mean=0.2039 mb_mean=0.4982 norm_overlap=0.9934 corr_cb=-0.3168
[EPOCH 022/089] train: loss=0.8023 acc=73.96% | val: loss=0.6193 acc=69.88% f1=73.68% auc=73.26% val_score=57.7917 val_score_bestthr=68.1984 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.204, mb=0.498, no=0.993, corr=-0.317) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.1984
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.1572 mb_mean=0.4976 norm_overlap=0.9942 corr_cb=-0.2440 topkJ=0.0218
[TRAIN][ep=023] loss=0.8242 acc=71.54%
[TRAIN][ep=023] mask_avg: mc_mean=0.1966 mb_mean=0.4982 norm_overlap=0.9931 corr_cb=-0.3210
[EPOCH 023/089] train: loss=0.8242 acc=71.54% | val: loss=0.7035 acc=69.88% f1=76.64% auc=72.67% val_score=45.7063 val_score_bestthr=69.6805 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.197, mb=0.498, no=0.993, corr=-0.321) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.6805
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.1941 mb_mean=0.4983 norm_overlap=0.9922 corr_cb=-0.3518 topkJ=0.0278
[TRAIN][ep=024] loss=0.8053 acc=74.36%
[TRAIN][ep=024] mask_avg: mc_mean=0.1871 mb_mean=0.4982 norm_overlap=0.9929 corr_cb=-0.3149
[EPOCH 024/089] train: loss=0.8053 acc=74.36% | val: loss=0.6080 acc=69.88% f1=71.26% auc=72.91% val_score=62.3068 val_score_bestthr=70.7970 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.187, mb=0.498, no=0.993, corr=-0.315) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 70.7970
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2291 mb_mean=0.4978 norm_overlap=0.9915 corr_cb=-0.3667 topkJ=0.0117
[TRAIN][ep=025] loss=0.8125 acc=73.83%
[TRAIN][ep=025] mask_avg: mc_mean=0.1938 mb_mean=0.4982 norm_overlap=0.9934 corr_cb=-0.2923
[EPOCH 025/089] train: loss=0.8125 acc=73.83% | val: loss=0.6107 acc=66.27% f1=74.55% auc=72.38% val_score=63.8288 val_score_bestthr=69.3455 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.194, mb=0.498, no=0.993, corr=-0.292) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.3455
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.1657 mb_mean=0.4982 norm_overlap=0.9931 corr_cb=-0.3152 topkJ=0.0150
[TRAIN][ep=026] loss=0.7856 acc=74.23%
[TRAIN][ep=026] mask_avg: mc_mean=0.2181 mb_mean=0.4982 norm_overlap=0.9933 corr_cb=-0.3236
[EPOCH 026/089] train: loss=0.7856 acc=74.23% | val: loss=0.6078 acc=67.47% f1=75.23% auc=72.56% val_score=63.1208 val_score_bestthr=69.7779 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.218, mb=0.498, no=0.993, corr=-0.324) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.7779
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2415 mb_mean=0.4957 norm_overlap=0.9898 corr_cb=-0.4232 topkJ=0.0048
[TRAIN][ep=027] loss=0.7795 acc=75.84%
[TRAIN][ep=027] mask_avg: mc_mean=0.2011 mb_mean=0.4982 norm_overlap=0.9933 corr_cb=-0.2989
[EPOCH 027/089] train: loss=0.7795 acc=75.84% | val: loss=0.6571 acc=65.06% f1=73.87% auc=71.40% val_score=63.5534 val_score_bestthr=68.9509 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.201, mb=0.498, no=0.993, corr=-0.299) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.9509
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.1976 mb_mean=0.5019 norm_overlap=0.9845 corr_cb=-0.5167 topkJ=0.0023
[TRAIN][ep=028] loss=0.7649 acc=75.70%
[TRAIN][ep=028] mask_avg: mc_mean=0.2231 mb_mean=0.4982 norm_overlap=0.9938 corr_cb=-0.2900
[EPOCH 028/089] train: loss=0.7649 acc=75.70% | val: loss=0.7374 acc=66.27% f1=72.00% auc=70.93% val_score=68.3578 val_score_bestthr=67.1962 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.223, mb=0.498, no=0.994, corr=-0.290) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 67.1962
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2202 mb_mean=0.4959 norm_overlap=0.9958 corr_cb=-0.2073 topkJ=0.0221
[TRAIN][ep=029] loss=0.7683 acc=75.70%
[TRAIN][ep=029] mask_avg: mc_mean=0.2037 mb_mean=0.4982 norm_overlap=0.9936 corr_cb=-0.2817
[EPOCH 029/089] train: loss=0.7683 acc=75.70% | val: loss=0.6278 acc=66.27% f1=75.00% auc=71.80% val_score=65.7516 val_score_bestthr=69.3203 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.204, mb=0.498, no=0.994, corr=-0.282) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 69.3203
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2302 mb_mean=0.4994 norm_overlap=0.9948 corr_cb=-0.2784 topkJ=0.0234
[TRAIN][ep=030] loss=0.7691 acc=74.23%
[TRAIN][ep=030] mask_avg: mc_mean=0.2156 mb_mean=0.4982 norm_overlap=0.9939 corr_cb=-0.2736
[EPOCH 030/089] train: loss=0.7691 acc=74.23% | val: loss=0.6249 acc=67.47% f1=74.77% auc=72.44% val_score=52.9436 val_score_bestthr=68.6174 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.216, mb=0.498, no=0.994, corr=-0.274) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 68.6174
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2314 mb_mean=0.4974 norm_overlap=0.9959 corr_cb=-0.2213 topkJ=0.0413
[TRAIN][ep=031] loss=0.7574 acc=76.11%
[TRAIN][ep=031] mask_avg: mc_mean=0.2183 mb_mean=0.4982 norm_overlap=0.9936 corr_cb=-0.2811
[EPOCH 031/089] train: loss=0.7574 acc=76.11% | val: loss=0.5984 acc=69.88% f1=73.68% auc=74.01% val_score=65.1700 val_score_bestthr=71.5589 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.218, mb=0.498, no=0.994, corr=-0.281) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 71.5589
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.0818 mb_mean=0.4974 norm_overlap=0.9942 corr_cb=-0.1778 topkJ=0.0237
[TRAIN][ep=032] loss=0.7726 acc=74.09%
[TRAIN][ep=032] mask_avg: mc_mean=0.1533 mb_mean=0.4982 norm_overlap=0.9924 corr_cb=-0.2603
[EPOCH 032/089] train: loss=0.7726 acc=74.09% | val: loss=0.6337 acc=67.47% f1=75.68% auc=71.74% val_score=50.5703 val_score_bestthr=72.5854 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.153, mb=0.498, no=0.992, corr=-0.260) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 72.5854
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2545 mb_mean=0.4964 norm_overlap=0.9951 corr_cb=-0.2819 topkJ=0.0302
[TRAIN][ep=033] loss=0.7525 acc=76.11%
[TRAIN][ep=033] mask_avg: mc_mean=0.2118 mb_mean=0.4982 norm_overlap=0.9933 corr_cb=-0.2874
[EPOCH 033/089] train: loss=0.7525 acc=76.11% | val: loss=0.6368 acc=68.67% f1=75.93% auc=72.62% val_score=54.5348 val_score_bestthr=70.7418 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.212, mb=0.498, no=0.993, corr=-0.287) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 70.7418
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2106 mb_mean=0.4971 norm_overlap=0.9933 corr_cb=-0.2701 topkJ=0.0210
[TRAIN][ep=034] loss=0.7500 acc=75.30%
[TRAIN][ep=034] mask_avg: mc_mean=0.2034 mb_mean=0.4982 norm_overlap=0.9933 corr_cb=-0.2837
[EPOCH 034/089] train: loss=0.7500 acc=75.30% | val: loss=0.6185 acc=66.27% f1=68.89% auc=71.80% val_score=60.0411 val_score_bestthr=67.8208 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.203, mb=0.498, no=0.993, corr=-0.284) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 74.3337 -> 67.8208
[EARLY STOP] no improvement for 30 epochs. best_epoch=4
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
=============== FIT DONE ===============
[BEST] epoch=4 | val_acc=71.08% | val_f1=77.36% | val_auc=72.21% | val_score=74.3337 | val_score_bestthr=74.3337
[TEST@BEST] thr_used=0.580 | acc=63.77% f1=61.54% auc=65.35% | SP_sex=10.15% EO_sex=6.61% SP_age=10.52% EO_age=6.58%
[TIME] 0.91 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold2_rep1_seed1002/summary_fold_2.json
