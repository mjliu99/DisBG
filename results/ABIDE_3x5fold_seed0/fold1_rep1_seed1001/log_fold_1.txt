[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5240 mb_mean=0.4945 norm_overlap=1.0001 corr_cb=0.1063 topkJ=0.0892
[TRAIN][ep=000] loss=0.6989 acc=51.14%
[TRAIN][ep=000] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0637
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5198 mb_mean=0.4964 norm_overlap=1.0000 corr_cb=0.0020 topkJ=0.1618
[TRAIN][ep=001] loss=0.6933 acc=51.28%
[TRAIN][ep=001] mask_avg: mc_mean=0.5235 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0636
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5264 mb_mean=0.4883 norm_overlap=1.0000 corr_cb=0.0372 topkJ=0.1146
[TRAIN][ep=002] loss=0.6930 acc=48.19%
[TRAIN][ep=002] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0591
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5240 mb_mean=0.4973 norm_overlap=0.9999 corr_cb=-0.1065 topkJ=0.0757
[TRAIN][ep=003] loss=0.6921 acc=51.28%
[TRAIN][ep=003] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0640
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5252 mb_mean=0.4946 norm_overlap=1.0001 corr_cb=0.0693 topkJ=0.1075
[TRAIN][ep=004] loss=0.6914 acc=54.36%
[TRAIN][ep=004] mask_avg: mc_mean=0.5235 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0728
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5254 mb_mean=0.4873 norm_overlap=0.9996 corr_cb=-0.3571 topkJ=0.0700
[TRAIN][ep=005] loss=0.6910 acc=53.42%
[TRAIN][ep=005] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0579
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5240 mb_mean=0.4920 norm_overlap=0.9998 corr_cb=-0.2417 topkJ=0.0358
[TRAIN][ep=006] loss=0.6897 acc=53.29%
[TRAIN][ep=006] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0643
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5236 mb_mean=0.4973 norm_overlap=1.0000 corr_cb=0.0089 topkJ=0.0999
[TRAIN][ep=007] loss=0.6881 acc=58.79%
[TRAIN][ep=007] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0694
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5205 mb_mean=0.4927 norm_overlap=0.9997 corr_cb=-0.2425 topkJ=0.0796
[TRAIN][ep=008] loss=0.6884 acc=54.77%
[TRAIN][ep=008] mask_avg: mc_mean=0.5235 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0663
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5252 mb_mean=0.4985 norm_overlap=1.0001 corr_cb=0.1253 topkJ=0.1968
[TRAIN][ep=009] loss=0.6867 acc=57.99%
[TRAIN][ep=009] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0649
================= FIT START (fold=1) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5254 mb_mean=0.4911 norm_overlap=0.9999 corr_cb=-0.1383 topkJ=0.0522
[TRAIN][ep=000] loss=0.6858 acc=56.91%
[TRAIN][ep=000] mask_avg: mc_mean=0.5235 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0647
[EPOCH 000/089] train: loss=0.6858 acc=56.91% | val: loss=0.6911 acc=59.04% f1=65.31% auc=51.74% val_score=56.6016 val_score_bestthr=58.1923 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.065) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 58.1923
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5232 mb_mean=0.4969 norm_overlap=0.9998 corr_cb=-0.2445 topkJ=0.0792
[TRAIN][ep=001] loss=0.6856 acc=55.30%
[TRAIN][ep=001] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0653
[EPOCH 001/089] train: loss=0.6856 acc=55.30% | val: loss=0.6927 acc=59.04% f1=67.31% auc=52.09% val_score=16.0374 val_score_bestthr=61.8166 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.065) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 58.1923 -> 61.8166
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5251 mb_mean=0.4886 norm_overlap=1.0000 corr_cb=-0.0238 topkJ=0.0802
[TRAIN][ep=002] loss=0.6833 acc=60.67%
[TRAIN][ep=002] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0672
[EPOCH 002/089] train: loss=0.6833 acc=60.67% | val: loss=0.6908 acc=61.45% f1=68.00% auc=52.91% val_score=52.9303 val_score_bestthr=57.4605 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.067) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.8166 -> 57.4605
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5203 mb_mean=0.4927 norm_overlap=1.0000 corr_cb=-0.0206 topkJ=0.0508
[TRAIN][ep=003] loss=0.6823 acc=56.64%
[TRAIN][ep=003] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0645
[EPOCH 003/089] train: loss=0.6823 acc=56.64% | val: loss=0.6901 acc=60.24% f1=69.16% auc=52.73% val_score=53.5155 val_score_bestthr=58.1025 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.064) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.8166 -> 58.1025
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5239 mb_mean=0.4918 norm_overlap=0.9998 corr_cb=-0.2595 topkJ=0.0761
[TRAIN][ep=004] loss=0.6805 acc=59.33%
[TRAIN][ep=004] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0632
[EPOCH 004/089] train: loss=0.6805 acc=59.33% | val: loss=0.6896 acc=61.45% f1=69.81% auc=53.08% val_score=53.5155 val_score_bestthr=59.6051 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.063) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.8166 -> 59.6051
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5228 mb_mean=0.4934 norm_overlap=0.9999 corr_cb=-0.0737 topkJ=0.0499
[TRAIN][ep=005] loss=1.2648 acc=60.13%
[TRAIN][ep=005] mask_avg: mc_mean=0.3867 mb_mean=0.4939 norm_overlap=1.0027 corr_cb=0.5954
[EPOCH 005/089] train: loss=1.2648 acc=60.13% | val: loss=0.6896 acc=59.04% f1=64.58% auc=53.84% val_score=49.9994 val_score_bestthr=61.0227 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.387, mb=0.494, no=1.003, corr=0.595) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.8166 -> 61.0227
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.3045 mb_mean=0.4966 norm_overlap=1.0047 corr_cb=0.6731 topkJ=0.2117
[TRAIN][ep=006] loss=1.2578 acc=57.85%
[TRAIN][ep=006] mask_avg: mc_mean=0.2965 mb_mean=0.4939 norm_overlap=1.0045 corr_cb=0.6183
[EPOCH 006/089] train: loss=1.2578 acc=57.85% | val: loss=0.6966 acc=60.24% f1=66.67% auc=53.31% val_score=29.6678 val_score_bestthr=62.2222 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.296, mb=0.494, no=1.005, corr=0.618) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 61.8166 -> 62.2222
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2950 mb_mean=0.4963 norm_overlap=1.0041 corr_cb=0.5913 topkJ=0.2021
[TRAIN][ep=007] loss=1.2586 acc=59.60%
[TRAIN][ep=007] mask_avg: mc_mean=0.2857 mb_mean=0.4939 norm_overlap=1.0045 corr_cb=0.5802
[EPOCH 007/089] train: loss=1.2586 acc=59.60% | val: loss=0.6880 acc=59.04% f1=64.58% auc=54.48% val_score=61.0227 val_score_bestthr=61.0227 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.286, mb=0.494, no=1.005, corr=0.580) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.2222 -> 61.0227
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2934 mb_mean=0.4944 norm_overlap=1.0034 corr_cb=0.4702 topkJ=0.1681
[TRAIN][ep=008] loss=1.2544 acc=59.06%
[TRAIN][ep=008] mask_avg: mc_mean=0.2810 mb_mean=0.4939 norm_overlap=1.0043 corr_cb=0.5454
[EPOCH 008/089] train: loss=1.2544 acc=59.06% | val: loss=0.6906 acc=63.86% f1=70.59% auc=53.78% val_score=31.9323 val_score_bestthr=65.5158 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.281, mb=0.494, no=1.004, corr=0.545) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 62.2222 -> 65.5158
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2815 mb_mean=0.4943 norm_overlap=1.0033 corr_cb=0.4473 topkJ=0.1422
[TRAIN][ep=009] loss=1.2497 acc=60.40%
[TRAIN][ep=009] mask_avg: mc_mean=0.2766 mb_mean=0.4939 norm_overlap=1.0042 corr_cb=0.4987
[EPOCH 009/089] train: loss=1.2497 acc=60.40% | val: loss=0.6896 acc=61.45% f1=69.23% auc=53.95% val_score=33.1431 val_score_bestthr=63.1530 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.277, mb=0.494, no=1.004, corr=0.499) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.5158 -> 63.1530
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.2541 mb_mean=0.4924 norm_overlap=1.0058 corr_cb=0.5201 topkJ=0.0924
[TRAIN][ep=010] loss=1.2489 acc=61.74%
[TRAIN][ep=010] mask_avg: mc_mean=0.2695 mb_mean=0.4939 norm_overlap=1.0041 corr_cb=0.4417
[EPOCH 010/089] train: loss=1.2489 acc=61.74% | val: loss=0.6868 acc=60.24% f1=69.72% auc=54.71% val_score=55.5094 val_score_bestthr=60.4530 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.269, mb=0.494, no=1.004, corr=0.442) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.5158 -> 60.4530
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.2495 mb_mean=0.4897 norm_overlap=1.0090 corr_cb=0.5812 topkJ=0.1097
[TRAIN][ep=011] loss=1.2419 acc=63.36%
[TRAIN][ep=011] mask_avg: mc_mean=0.2595 mb_mean=0.4939 norm_overlap=1.0039 corr_cb=0.3711
[EPOCH 011/089] train: loss=1.2419 acc=63.36% | val: loss=0.6871 acc=59.04% f1=70.69% auc=55.29% val_score=55.5954 val_score_bestthr=59.6775 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.260, mb=0.494, no=1.004, corr=0.371) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.5158 -> 59.6775
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.2429 mb_mean=0.4961 norm_overlap=1.0027 corr_cb=0.2987 topkJ=0.1400
[TRAIN][ep=012] loss=1.2393 acc=61.88%
[TRAIN][ep=012] mask_avg: mc_mean=0.2457 mb_mean=0.4939 norm_overlap=1.0040 corr_cb=0.3286
[EPOCH 012/089] train: loss=1.2393 acc=61.88% | val: loss=0.6857 acc=61.45% f1=67.35% auc=54.07% val_score=53.0521 val_score_bestthr=63.3333 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.246, mb=0.494, no=1.004, corr=0.329) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.5158 -> 63.3333
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.2267 mb_mean=0.4893 norm_overlap=1.0045 corr_cb=0.3724 topkJ=0.1047
[TRAIN][ep=013] loss=1.2390 acc=60.67%
[TRAIN][ep=013] mask_avg: mc_mean=0.2508 mb_mean=0.4939 norm_overlap=1.0034 corr_cb=0.2558
[EPOCH 013/089] train: loss=1.2390 acc=60.67% | val: loss=0.6855 acc=62.65% f1=69.31% auc=54.36% val_score=51.0305 val_score_bestthr=64.0147 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.251, mb=0.494, no=1.003, corr=0.256) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.5158 -> 64.0147
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.2397 mb_mean=0.4938 norm_overlap=1.0029 corr_cb=0.2613 topkJ=0.2086
[TRAIN][ep=014] loss=0.9910 acc=65.23%
[TRAIN][ep=014] mask_avg: mc_mean=0.2378 mb_mean=0.4939 norm_overlap=1.0033 corr_cb=0.2340
[EPOCH 014/089] train: loss=0.9910 acc=65.23% | val: loss=0.7185 acc=57.83% f1=67.29% auc=54.42% val_score=31.4526 val_score_bestthr=62.4698 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.238, mb=0.494, no=1.003, corr=0.234) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.5158 -> 62.4698
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.2468 mb_mean=0.4908 norm_overlap=1.0054 corr_cb=0.3568 topkJ=0.1211
[TRAIN][ep=015] loss=0.7481 acc=64.03%
[TRAIN][ep=015] mask_avg: mc_mean=0.2445 mb_mean=0.4939 norm_overlap=1.0027 corr_cb=0.1818
[EPOCH 015/089] train: loss=0.7481 acc=64.03% | val: loss=0.6862 acc=61.45% f1=68.00% auc=54.94% val_score=60.5616 val_score_bestthr=61.3919 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.244, mb=0.494, no=1.003, corr=0.182) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.5158 -> 61.3919
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1955 mb_mean=0.4876 norm_overlap=1.0035 corr_cb=0.1985 topkJ=0.1002
[TRAIN][ep=016] loss=0.6877 acc=63.09%
[TRAIN][ep=016] mask_avg: mc_mean=0.2282 mb_mean=0.4939 norm_overlap=1.0030 corr_cb=0.1655
[EPOCH 016/089] train: loss=0.6877 acc=63.09% | val: loss=0.6862 acc=62.65% f1=69.31% auc=54.83% val_score=57.9556 val_score_bestthr=64.0147 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.228, mb=0.494, no=1.003, corr=0.165) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.5158 -> 64.0147
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.2181 mb_mean=0.4928 norm_overlap=1.0045 corr_cb=0.2659 topkJ=0.1342
[TRAIN][ep=017] loss=0.6675 acc=65.23%
[TRAIN][ep=017] mask_avg: mc_mean=0.2170 mb_mean=0.4939 norm_overlap=1.0031 corr_cb=0.1470
[EPOCH 017/089] train: loss=0.6675 acc=65.23% | val: loss=0.6963 acc=63.86% f1=70.59% auc=54.48% val_score=38.8717 val_score_bestthr=65.6006 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.217, mb=0.494, no=1.003, corr=0.147) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 65.5158 -> 65.6006
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.2286 mb_mean=0.4962 norm_overlap=1.0007 corr_cb=0.0383 topkJ=0.0568
[TRAIN][ep=018] loss=0.7577 acc=66.58%
[TRAIN][ep=018] mask_avg: mc_mean=0.2146 mb_mean=0.4939 norm_overlap=1.0027 corr_cb=0.1196
[EPOCH 018/089] train: loss=0.7577 acc=66.58% | val: loss=0.6975 acc=62.65% f1=69.90% auc=54.59% val_score=39.1753 val_score_bestthr=64.0930 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.215, mb=0.494, no=1.003, corr=0.120) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6006 -> 64.0930
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.2270 mb_mean=0.4994 norm_overlap=0.9991 corr_cb=-0.0473 topkJ=0.0513
[TRAIN][ep=019] loss=0.8480 acc=67.79%
[TRAIN][ep=019] mask_avg: mc_mean=0.2119 mb_mean=0.4939 norm_overlap=1.0026 corr_cb=0.1049
[EPOCH 019/089] train: loss=0.8480 acc=67.79% | val: loss=0.6907 acc=60.24% f1=69.16% auc=54.83% val_score=53.6454 val_score_bestthr=63.4083 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.212, mb=0.494, no=1.003, corr=0.105) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6006 -> 63.4083
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.2458 mb_mean=0.4996 norm_overlap=1.0010 corr_cb=0.0531 topkJ=0.0839
[TRAIN][ep=020] loss=0.9425 acc=65.10%
[TRAIN][ep=020] mask_avg: mc_mean=0.2167 mb_mean=0.4939 norm_overlap=1.0020 corr_cb=0.0802
[EPOCH 020/089] train: loss=0.9425 acc=65.10% | val: loss=0.7137 acc=61.45% f1=68.63% auc=54.48% val_score=35.9699 val_score_bestthr=62.5080 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.217, mb=0.494, no=1.002, corr=0.080) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6006 -> 62.5080
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2155 mb_mean=0.4905 norm_overlap=1.0031 corr_cb=0.1250 topkJ=0.1147
[TRAIN][ep=021] loss=1.0333 acc=66.98%
[TRAIN][ep=021] mask_avg: mc_mean=0.2133 mb_mean=0.4939 norm_overlap=1.0017 corr_cb=0.0632
[EPOCH 021/089] train: loss=1.0333 acc=66.98% | val: loss=0.6906 acc=61.45% f1=69.23% auc=55.58% val_score=59.4602 val_score_bestthr=64.0807 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.213, mb=0.494, no=1.002, corr=0.063) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6006 -> 64.0807
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2254 mb_mean=0.4935 norm_overlap=1.0019 corr_cb=0.0889 topkJ=0.0843
[TRAIN][ep=022] loss=1.1211 acc=65.91%
[TRAIN][ep=022] mask_avg: mc_mean=0.2140 mb_mean=0.4939 norm_overlap=1.0012 corr_cb=0.0443
[EPOCH 022/089] train: loss=1.1211 acc=65.91% | val: loss=0.7005 acc=57.83% f1=65.35% auc=56.34% val_score=58.5041 val_score_bestthr=61.2588 | dyn(w_pfs=0.100, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.214, mb=0.494, no=1.001, corr=0.044) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6006 -> 61.2588
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2397 mb_mean=0.4972 norm_overlap=0.9967 corr_cb=-0.1829 topkJ=0.0492
[TRAIN][ep=023] loss=0.8743 acc=68.05%
[TRAIN][ep=023] mask_avg: mc_mean=0.2165 mb_mean=0.4939 norm_overlap=1.0008 corr_cb=0.0265
[EPOCH 023/089] train: loss=0.8743 acc=68.05% | val: loss=0.7186 acc=59.04% f1=71.19% auc=57.38% val_score=52.2323 val_score_bestthr=62.2793 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.216, mb=0.494, no=1.001, corr=0.026) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6006 -> 62.2793
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2414 mb_mean=0.4985 norm_overlap=1.0013 corr_cb=0.0573 topkJ=0.0493
[TRAIN][ep=024] loss=0.6511 acc=65.50%
[TRAIN][ep=024] mask_avg: mc_mean=0.2184 mb_mean=0.4939 norm_overlap=1.0004 corr_cb=0.0111
[EPOCH 024/089] train: loss=0.6511 acc=65.50% | val: loss=0.6967 acc=59.04% f1=66.00% auc=56.34% val_score=62.7616 val_score_bestthr=62.7616 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.218, mb=0.494, no=1.000, corr=0.011) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6006 -> 62.7616
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2183 mb_mean=0.4905 norm_overlap=1.0033 corr_cb=0.1308 topkJ=0.0915
[TRAIN][ep=025] loss=0.6393 acc=68.59%
[TRAIN][ep=025] mask_avg: mc_mean=0.2290 mb_mean=0.4939 norm_overlap=0.9996 corr_cb=-0.0238
[EPOCH 025/089] train: loss=0.6393 acc=68.59% | val: loss=0.6937 acc=60.24% f1=67.33% auc=56.40% val_score=58.0749 val_score_bestthr=62.5878 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.229, mb=0.494, no=1.000, corr=-0.024) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6006 -> 62.5878
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2030 mb_mean=0.4946 norm_overlap=1.0011 corr_cb=0.0447 topkJ=0.0539
[TRAIN][ep=026] loss=0.6459 acc=66.31%
[TRAIN][ep=026] mask_avg: mc_mean=0.2285 mb_mean=0.4939 norm_overlap=0.9993 corr_cb=-0.0327
[EPOCH 026/089] train: loss=0.6459 acc=66.31% | val: loss=0.6957 acc=61.45% f1=70.37% auc=56.05% val_score=46.7545 val_score_bestthr=62.2714 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.229, mb=0.494, no=0.999, corr=-0.033) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6006 -> 62.2714
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2370 mb_mean=0.4930 norm_overlap=1.0025 corr_cb=0.0774 topkJ=0.0544
[TRAIN][ep=027] loss=0.6324 acc=67.52%
[TRAIN][ep=027] mask_avg: mc_mean=0.2255 mb_mean=0.4939 norm_overlap=0.9991 corr_cb=-0.0417
[EPOCH 027/089] train: loss=0.6324 acc=67.52% | val: loss=0.7107 acc=61.45% f1=69.81% auc=55.93% val_score=34.7454 val_score_bestthr=66.0310 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.226, mb=0.494, no=0.999, corr=-0.042) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 65.6006 -> 66.0310
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2005 mb_mean=0.4937 norm_overlap=0.9996 corr_cb=-0.0161 topkJ=0.0645
[TRAIN][ep=028] loss=0.7197 acc=68.32%
[TRAIN][ep=028] mask_avg: mc_mean=0.2166 mb_mean=0.4939 norm_overlap=0.9991 corr_cb=-0.0396
[EPOCH 028/089] train: loss=0.7197 acc=68.32% | val: loss=0.6962 acc=60.24% f1=67.33% auc=56.45% val_score=52.9938 val_score_bestthr=62.5878 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.217, mb=0.494, no=0.999, corr=-0.040) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 62.5878
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2208 mb_mean=0.4901 norm_overlap=0.9965 corr_cb=-0.1448 topkJ=0.0508
[TRAIN][ep=029] loss=0.8062 acc=69.26%
[TRAIN][ep=029] mask_avg: mc_mean=0.2173 mb_mean=0.4939 norm_overlap=0.9988 corr_cb=-0.0524
[EPOCH 029/089] train: loss=0.8062 acc=69.26% | val: loss=0.6991 acc=60.24% f1=68.57% auc=56.98% val_score=46.7545 val_score_bestthr=62.6392 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.217, mb=0.494, no=0.999, corr=-0.052) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 62.6392
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2259 mb_mean=0.4930 norm_overlap=0.9956 corr_cb=-0.1536 topkJ=0.0352
[TRAIN][ep=030] loss=0.9096 acc=68.86%
[TRAIN][ep=030] mask_avg: mc_mean=0.2270 mb_mean=0.4939 norm_overlap=0.9980 corr_cb=-0.0833
[EPOCH 030/089] train: loss=0.9096 acc=68.86% | val: loss=0.6945 acc=60.24% f1=67.33% auc=57.56% val_score=52.3161 val_score_bestthr=62.7293 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.227, mb=0.494, no=0.998, corr=-0.083) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 62.7293
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2315 mb_mean=0.4940 norm_overlap=1.0012 corr_cb=0.0449 topkJ=0.0518
[TRAIN][ep=031] loss=0.9997 acc=67.38%
[TRAIN][ep=031] mask_avg: mc_mean=0.2293 mb_mean=0.4939 norm_overlap=0.9976 corr_cb=-0.1013
[EPOCH 031/089] train: loss=0.9997 acc=67.38% | val: loss=0.6990 acc=60.24% f1=68.57% auc=57.44% val_score=42.6004 val_score_bestthr=62.6392 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.229, mb=0.494, no=0.998, corr=-0.101) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 62.6392
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2270 mb_mean=0.4935 norm_overlap=0.9977 corr_cb=-0.0888 topkJ=0.0724
[TRAIN][ep=032] loss=1.0816 acc=69.53%
[TRAIN][ep=032] mask_avg: mc_mean=0.2172 mb_mean=0.4939 norm_overlap=0.9977 corr_cb=-0.0945
[EPOCH 032/089] train: loss=1.0816 acc=69.53% | val: loss=0.7135 acc=57.83% f1=67.29% auc=56.80% val_score=35.8425 val_score_bestthr=59.7829 | dyn(w_pfs=0.100, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.217, mb=0.494, no=0.998, corr=-0.094) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 59.7829
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2191 mb_mean=0.4981 norm_overlap=0.9965 corr_cb=-0.1565 topkJ=0.0439
[TRAIN][ep=033] loss=0.8427 acc=71.95%
[TRAIN][ep=033] mask_avg: mc_mean=0.2131 mb_mean=0.4939 norm_overlap=0.9975 corr_cb=-0.0973
[EPOCH 033/089] train: loss=0.8427 acc=71.95% | val: loss=0.6969 acc=59.04% f1=66.67% auc=57.50% val_score=54.3786 val_score_bestthr=61.0840 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.213, mb=0.494, no=0.998, corr=-0.097) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 61.0840
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2239 mb_mean=0.4891 norm_overlap=0.9950 corr_cb=-0.1946 topkJ=0.0486
[TRAIN][ep=034] loss=0.5971 acc=71.68%
[TRAIN][ep=034] mask_avg: mc_mean=0.2242 mb_mean=0.4939 norm_overlap=0.9970 corr_cb=-0.1216
[EPOCH 034/089] train: loss=0.5971 acc=71.68% | val: loss=0.7134 acc=55.42% f1=69.42% auc=57.33% val_score=35.8425 val_score_bestthr=59.9095 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.224, mb=0.494, no=0.997, corr=-0.122) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 59.9095
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2169 mb_mean=0.4998 norm_overlap=0.9965 corr_cb=-0.1343 topkJ=0.0460
[TRAIN][ep=035] loss=0.5945 acc=71.68%
[TRAIN][ep=035] mask_avg: mc_mean=0.2283 mb_mean=0.4939 norm_overlap=0.9966 corr_cb=-0.1356
[EPOCH 035/089] train: loss=0.5945 acc=71.68% | val: loss=0.7014 acc=60.24% f1=69.16% auc=58.02% val_score=51.5092 val_score_bestthr=60.2052 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.228, mb=0.494, no=0.997, corr=-0.136) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 60.2052
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2112 mb_mean=0.4939 norm_overlap=0.9992 corr_cb=-0.0300 topkJ=0.0557
[TRAIN][ep=036] loss=0.5928 acc=72.08%
[TRAIN][ep=036] mask_avg: mc_mean=0.2223 mb_mean=0.4939 norm_overlap=0.9966 corr_cb=-0.1297
[EPOCH 036/089] train: loss=0.5928 acc=72.08% | val: loss=0.7065 acc=60.24% f1=68.57% auc=58.02% val_score=48.9194 val_score_bestthr=59.4387 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.222, mb=0.494, no=0.997, corr=-0.130) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 59.4387
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.2643 mb_mean=0.4988 norm_overlap=0.9937 corr_cb=-0.2747 topkJ=0.0308
[TRAIN][ep=037] loss=0.5905 acc=70.34%
[TRAIN][ep=037] mask_avg: mc_mean=0.2353 mb_mean=0.4939 norm_overlap=0.9959 corr_cb=-0.1621
[EPOCH 037/089] train: loss=0.5905 acc=70.34% | val: loss=0.7017 acc=60.24% f1=65.98% auc=58.26% val_score=51.5092 val_score_bestthr=58.7890 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.235, mb=0.494, no=0.996, corr=-0.162) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 58.7890
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.3051 mb_mean=0.4887 norm_overlap=0.9924 corr_cb=-0.3182 topkJ=0.0178
[TRAIN][ep=038] loss=0.5868 acc=71.14%
[TRAIN][ep=038] mask_avg: mc_mean=0.2551 mb_mean=0.4939 norm_overlap=0.9952 corr_cb=-0.2075
[EPOCH 038/089] train: loss=0.5868 acc=71.14% | val: loss=0.7079 acc=57.83% f1=69.57% auc=58.60% val_score=49.8225 val_score_bestthr=57.4087 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.255, mb=0.494, no=0.995, corr=-0.207) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 57.4087
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2254 mb_mean=0.4974 norm_overlap=0.9925 corr_cb=-0.2938 topkJ=0.0197
[TRAIN][ep=039] loss=0.5810 acc=71.81%
[TRAIN][ep=039] mask_avg: mc_mean=0.2224 mb_mean=0.4939 norm_overlap=0.9958 corr_cb=-0.1632
[EPOCH 039/089] train: loss=0.5810 acc=71.81% | val: loss=0.7108 acc=55.42% f1=69.42% auc=59.13% val_score=53.5213 val_score_bestthr=59.9095 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.222, mb=0.494, no=0.996, corr=-0.163) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 59.9095
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.2278 mb_mean=0.4958 norm_overlap=0.9960 corr_cb=-0.1915 topkJ=0.0262
[TRAIN][ep=040] loss=0.5757 acc=71.41%
[TRAIN][ep=040] mask_avg: mc_mean=0.2226 mb_mean=0.4939 norm_overlap=0.9956 corr_cb=-0.1648
[EPOCH 040/089] train: loss=0.5757 acc=71.41% | val: loss=0.7155 acc=55.42% f1=69.42% auc=58.78% val_score=53.5213 val_score_bestthr=59.9095 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.223, mb=0.494, no=0.996, corr=-0.165) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 59.9095
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.2486 mb_mean=0.5013 norm_overlap=0.9947 corr_cb=-0.2169 topkJ=0.0373
[TRAIN][ep=041] loss=0.5748 acc=72.89%
[TRAIN][ep=041] mask_avg: mc_mean=0.2332 mb_mean=0.4939 norm_overlap=0.9951 corr_cb=-0.1892
[EPOCH 041/089] train: loss=0.5748 acc=72.89% | val: loss=0.7060 acc=56.63% f1=69.49% auc=58.72% val_score=51.1204 val_score_bestthr=60.2928 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.233, mb=0.494, no=0.995, corr=-0.189) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 60.2928
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.2494 mb_mean=0.4932 norm_overlap=0.9951 corr_cb=-0.1819 topkJ=0.0360
[TRAIN][ep=042] loss=0.5756 acc=71.41%
[TRAIN][ep=042] mask_avg: mc_mean=0.2244 mb_mean=0.4939 norm_overlap=0.9952 corr_cb=-0.1792
[EPOCH 042/089] train: loss=0.5756 acc=71.41% | val: loss=0.7100 acc=55.42% f1=69.42% auc=59.48% val_score=48.2910 val_score_bestthr=59.9095 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.224, mb=0.494, no=0.995, corr=-0.179) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 59.9095
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.2442 mb_mean=0.4933 norm_overlap=1.0007 corr_cb=0.0259 topkJ=0.0621
[TRAIN][ep=043] loss=0.5655 acc=72.08%
[TRAIN][ep=043] mask_avg: mc_mean=0.2299 mb_mean=0.4939 norm_overlap=0.9949 corr_cb=-0.1934
[EPOCH 043/089] train: loss=0.5655 acc=72.08% | val: loss=0.7089 acc=56.63% f1=69.49% auc=59.65% val_score=49.3844 val_score_bestthr=62.5328 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.230, mb=0.494, no=0.995, corr=-0.193) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 62.5328
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2547 mb_mean=0.4929 norm_overlap=0.9917 corr_cb=-0.3040 topkJ=0.0173
[TRAIN][ep=044] loss=0.5663 acc=71.81%
[TRAIN][ep=044] mask_avg: mc_mean=0.2434 mb_mean=0.4939 norm_overlap=0.9943 corr_cb=-0.2210
[EPOCH 044/089] train: loss=0.5663 acc=71.81% | val: loss=0.7297 acc=55.42% f1=69.42% auc=59.53% val_score=43.0411 val_score_bestthr=59.9095 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.243, mb=0.494, no=0.994, corr=-0.221) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 59.9095
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2316 mb_mean=0.4904 norm_overlap=0.9976 corr_cb=-0.0972 topkJ=0.0426
[TRAIN][ep=045] loss=0.5474 acc=74.77%
[TRAIN][ep=045] mask_avg: mc_mean=0.2302 mb_mean=0.4939 norm_overlap=0.9946 corr_cb=-0.2032
[EPOCH 045/089] train: loss=0.5474 acc=74.77% | val: loss=0.7170 acc=61.45% f1=69.23% auc=59.59% val_score=47.0332 val_score_bestthr=59.4224 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.230, mb=0.494, no=0.995, corr=-0.203) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 59.4224
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.2143 mb_mean=0.4850 norm_overlap=0.9989 corr_cb=-0.0434 topkJ=0.0565
[TRAIN][ep=046] loss=0.5406 acc=74.63%
[TRAIN][ep=046] mask_avg: mc_mean=0.2437 mb_mean=0.4939 norm_overlap=0.9940 corr_cb=-0.2321
[EPOCH 046/089] train: loss=0.5406 acc=74.63% | val: loss=0.7250 acc=55.42% f1=69.42% auc=59.83% val_score=47.0332 val_score_bestthr=59.9095 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.244, mb=0.494, no=0.994, corr=-0.232) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 59.9095
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.2098 mb_mean=0.4971 norm_overlap=0.9953 corr_cb=-0.1935 topkJ=0.0333
[TRAIN][ep=047] loss=0.5356 acc=73.42%
[TRAIN][ep=047] mask_avg: mc_mean=0.2194 mb_mean=0.4939 norm_overlap=0.9946 corr_cb=-0.1947
[EPOCH 047/089] train: loss=0.5356 acc=73.42% | val: loss=0.7275 acc=61.45% f1=69.23% auc=59.24% val_score=47.8000 val_score_bestthr=59.4224 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.219, mb=0.494, no=0.995, corr=-0.195) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 59.4224
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.2318 mb_mean=0.4989 norm_overlap=0.9938 corr_cb=-0.3211 topkJ=0.0229
[TRAIN][ep=048] loss=0.5389 acc=73.69%
[TRAIN][ep=048] mask_avg: mc_mean=0.2380 mb_mean=0.4939 norm_overlap=0.9940 corr_cb=-0.2232
[EPOCH 048/089] train: loss=0.5389 acc=73.69% | val: loss=0.7282 acc=56.63% f1=69.49% auc=59.36% val_score=48.9056 val_score_bestthr=60.2928 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.238, mb=0.494, no=0.994, corr=-0.223) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 60.2928
[DBG][ep=049] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.2074 mb_mean=0.4919 norm_overlap=0.9955 corr_cb=-0.1596 topkJ=0.0244
[TRAIN][ep=049] loss=0.5322 acc=73.15%
[TRAIN][ep=049] mask_avg: mc_mean=0.2328 mb_mean=0.4939 norm_overlap=0.9941 corr_cb=-0.2173
[EPOCH 049/089] train: loss=0.5322 acc=73.15% | val: loss=0.7232 acc=57.83% f1=69.57% auc=60.47% val_score=51.3980 val_score_bestthr=58.9642 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.233, mb=0.494, no=0.994, corr=-0.217) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 58.9642
[DBG][ep=050] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.2532 mb_mean=0.4914 norm_overlap=0.9919 corr_cb=-0.2573 topkJ=0.0485
[TRAIN][ep=050] loss=0.5235 acc=74.77%
[TRAIN][ep=050] mask_avg: mc_mean=0.2548 mb_mean=0.4939 norm_overlap=0.9935 corr_cb=-0.2491
[EPOCH 050/089] train: loss=0.5235 acc=74.77% | val: loss=0.7239 acc=57.83% f1=69.57% auc=60.41% val_score=49.1831 val_score_bestthr=58.9642 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.494, no=0.993, corr=-0.249) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 58.9642
[DBG][ep=051] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.2336 mb_mean=0.4940 norm_overlap=0.9978 corr_cb=-0.0919 topkJ=0.0516
[TRAIN][ep=051] loss=0.5197 acc=75.30%
[TRAIN][ep=051] mask_avg: mc_mean=0.2548 mb_mean=0.4939 norm_overlap=0.9934 corr_cb=-0.2486
[EPOCH 051/089] train: loss=0.5197 acc=75.30% | val: loss=0.7247 acc=57.83% f1=70.09% auc=60.58% val_score=51.3980 val_score_bestthr=63.6833 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.494, no=0.993, corr=-0.249) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 63.6833
[DBG][ep=052] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.2542 mb_mean=0.4996 norm_overlap=0.9899 corr_cb=-0.2808 topkJ=0.0209
[TRAIN][ep=052] loss=0.5200 acc=75.57%
[TRAIN][ep=052] mask_avg: mc_mean=0.2548 mb_mean=0.4939 norm_overlap=0.9935 corr_cb=-0.2479
[EPOCH 052/089] train: loss=0.5200 acc=75.57% | val: loss=0.7250 acc=57.83% f1=70.09% auc=60.64% val_score=51.3980 val_score_bestthr=63.6833 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.494, no=0.993, corr=-0.248) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 63.6833
[DBG][ep=053] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.2696 mb_mean=0.4984 norm_overlap=0.9914 corr_cb=-0.2563 topkJ=0.0181
[TRAIN][ep=053] loss=0.5209 acc=74.50%
[TRAIN][ep=053] mask_avg: mc_mean=0.2548 mb_mean=0.4939 norm_overlap=0.9934 corr_cb=-0.2509
[EPOCH 053/089] train: loss=0.5209 acc=74.50% | val: loss=0.7255 acc=57.83% f1=70.09% auc=60.64% val_score=51.3980 val_score_bestthr=63.6833 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.494, no=0.993, corr=-0.251) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 63.6833
[DBG][ep=054] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=054] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=054] mask(step0): mc_mean=0.2565 mb_mean=0.4927 norm_overlap=0.9949 corr_cb=-0.2134 topkJ=0.0380
[TRAIN][ep=054] loss=0.5187 acc=75.57%
[TRAIN][ep=054] mask_avg: mc_mean=0.2548 mb_mean=0.4939 norm_overlap=0.9934 corr_cb=-0.2496
[EPOCH 054/089] train: loss=0.5187 acc=75.57% | val: loss=0.7264 acc=57.83% f1=69.57% auc=60.35% val_score=49.1831 val_score_bestthr=58.9642 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.494, no=0.993, corr=-0.250) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 58.9642
[DBG][ep=055] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=055] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=055] mask(step0): mc_mean=0.2787 mb_mean=0.4935 norm_overlap=0.9911 corr_cb=-0.3034 topkJ=0.0364
[TRAIN][ep=055] loss=0.5248 acc=73.83%
[TRAIN][ep=055] mask_avg: mc_mean=0.2548 mb_mean=0.4939 norm_overlap=0.9934 corr_cb=-0.2495
[EPOCH 055/089] train: loss=0.5248 acc=73.83% | val: loss=0.7267 acc=57.83% f1=70.09% auc=60.35% val_score=49.7707 val_score_bestthr=63.6833 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.494, no=0.993, corr=-0.249) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 63.6833
[DBG][ep=056] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=056] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=056] mask(step0): mc_mean=0.2763 mb_mean=0.4914 norm_overlap=0.9922 corr_cb=-0.3190 topkJ=0.0147
[TRAIN][ep=056] loss=0.5155 acc=75.44%
[TRAIN][ep=056] mask_avg: mc_mean=0.2548 mb_mean=0.4939 norm_overlap=0.9934 corr_cb=-0.2495
[EPOCH 056/089] train: loss=0.5155 acc=75.44% | val: loss=0.7271 acc=57.83% f1=70.09% auc=60.70% val_score=49.7707 val_score_bestthr=63.6833 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.494, no=0.993, corr=-0.250) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 63.6833
[DBG][ep=057] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=057] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=057] mask(step0): mc_mean=0.2577 mb_mean=0.4881 norm_overlap=0.9920 corr_cb=-0.2907 topkJ=0.0280
[TRAIN][ep=057] loss=0.5146 acc=76.11%
[TRAIN][ep=057] mask_avg: mc_mean=0.2548 mb_mean=0.4939 norm_overlap=0.9934 corr_cb=-0.2506
[EPOCH 057/089] train: loss=0.5146 acc=76.11% | val: loss=0.7378 acc=55.42% f1=69.42% auc=60.35% val_score=41.1399 val_score_bestthr=59.9095 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.255, mb=0.494, no=0.993, corr=-0.251) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.0310 -> 59.9095
[EARLY STOP] no improvement for 30 epochs. best_epoch=27
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
=============== FIT DONE ===============
[BEST] epoch=27 | val_acc=61.45% | val_f1=69.81% | val_auc=55.93% | val_score=34.7454 | val_score_bestthr=66.0310
[TEST@BEST] thr_used=0.280 | acc=56.52% f1=68.09% auc=63.97% | SP_sex=4.07% EO_sex=12.31% SP_age=12.64% EO_age=13.91%
[TIME] 1.40 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold1_rep1_seed1001/summary_fold_1.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5240 mb_mean=0.4945 norm_overlap=1.0001 corr_cb=0.1063 topkJ=0.0892
[TRAIN][ep=000] loss=0.6970 acc=50.20%
[TRAIN][ep=000] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0637
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5198 mb_mean=0.4964 norm_overlap=1.0000 corr_cb=0.0020 topkJ=0.1618
[TRAIN][ep=001] loss=0.6933 acc=49.53%
[TRAIN][ep=001] mask_avg: mc_mean=0.5235 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0636
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5264 mb_mean=0.4883 norm_overlap=1.0000 corr_cb=0.0372 topkJ=0.1146
[TRAIN][ep=002] loss=0.6925 acc=52.89%
[TRAIN][ep=002] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0591
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5240 mb_mean=0.4973 norm_overlap=0.9999 corr_cb=-0.1065 topkJ=0.0757
[TRAIN][ep=003] loss=0.6913 acc=51.81%
[TRAIN][ep=003] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0640
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5252 mb_mean=0.4946 norm_overlap=1.0001 corr_cb=0.0693 topkJ=0.1075
[TRAIN][ep=004] loss=0.6901 acc=54.23%
[TRAIN][ep=004] mask_avg: mc_mean=0.5235 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0728
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5254 mb_mean=0.4873 norm_overlap=0.9996 corr_cb=-0.3571 topkJ=0.0700
[TRAIN][ep=005] loss=0.6897 acc=54.09%
[TRAIN][ep=005] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0579
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5240 mb_mean=0.4920 norm_overlap=0.9998 corr_cb=-0.2417 topkJ=0.0358
[TRAIN][ep=006] loss=0.6871 acc=55.57%
[TRAIN][ep=006] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0643
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5236 mb_mean=0.4973 norm_overlap=1.0000 corr_cb=0.0089 topkJ=0.0999
[TRAIN][ep=007] loss=0.6848 acc=59.06%
[TRAIN][ep=007] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0694
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5205 mb_mean=0.4927 norm_overlap=0.9997 corr_cb=-0.2425 topkJ=0.0796
[TRAIN][ep=008] loss=0.6852 acc=54.09%
[TRAIN][ep=008] mask_avg: mc_mean=0.5235 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0663
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5252 mb_mean=0.4985 norm_overlap=1.0001 corr_cb=0.1253 topkJ=0.1968
[TRAIN][ep=009] loss=0.6821 acc=57.32%
[TRAIN][ep=009] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0649
================= FIT START (fold=1) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5254 mb_mean=0.4911 norm_overlap=0.9999 corr_cb=-0.1383 topkJ=0.0522
[TRAIN][ep=000] loss=0.6792 acc=57.99%
[TRAIN][ep=000] mask_avg: mc_mean=0.5235 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0647
[EPOCH 000/089] train: loss=0.6792 acc=57.99% | val: loss=0.6891 acc=62.65% f1=70.48% auc=54.24% val_score=53.9825 val_score_bestthr=62.2297 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.065) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 62.2297
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5232 mb_mean=0.4969 norm_overlap=0.9998 corr_cb=-0.2445 topkJ=0.0792
[TRAIN][ep=001] loss=0.6789 acc=57.18%
[TRAIN][ep=001] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0653
[EPOCH 001/089] train: loss=0.6789 acc=57.18% | val: loss=0.6935 acc=61.45% f1=68.00% auc=53.02% val_score=31.9563 val_score_bestthr=64.2201 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.065) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 62.2297 -> 64.2201
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5251 mb_mean=0.4886 norm_overlap=1.0000 corr_cb=-0.0238 topkJ=0.0802
[TRAIN][ep=002] loss=0.6754 acc=60.94%
[TRAIN][ep=002] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0672
[EPOCH 002/089] train: loss=0.6754 acc=60.94% | val: loss=0.6883 acc=62.65% f1=69.90% auc=53.78% val_score=61.0227 val_score_bestthr=63.3859 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.067) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2201 -> 63.3859
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5203 mb_mean=0.4927 norm_overlap=1.0000 corr_cb=-0.0206 topkJ=0.0508
[TRAIN][ep=003] loss=0.6721 acc=59.73%
[TRAIN][ep=003] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0645
[EPOCH 003/089] train: loss=0.6721 acc=59.73% | val: loss=0.6886 acc=62.65% f1=71.03% auc=54.88% val_score=55.4242 val_score_bestthr=60.4036 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.064) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2201 -> 60.4036
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5239 mb_mean=0.4918 norm_overlap=0.9998 corr_cb=-0.2595 topkJ=0.0761
[TRAIN][ep=004] loss=0.6697 acc=61.21%
[TRAIN][ep=004] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0632
[EPOCH 004/089] train: loss=0.6697 acc=61.21% | val: loss=0.6874 acc=61.45% f1=68.00% auc=54.94% val_score=57.2424 val_score_bestthr=60.1191 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.063) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2201 -> 60.1191
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5228 mb_mean=0.4934 norm_overlap=0.9999 corr_cb=-0.0737 topkJ=0.0499
[TRAIN][ep=005] loss=1.4376 acc=61.61%
[TRAIN][ep=005] mask_avg: mc_mean=0.3788 mb_mean=0.4939 norm_overlap=1.0029 corr_cb=0.5995
[EPOCH 005/089] train: loss=1.4376 acc=61.61% | val: loss=0.6875 acc=61.45% f1=70.37% auc=54.01% val_score=51.4549 val_score_bestthr=61.9547 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.379, mb=0.494, no=1.003, corr=0.599) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2201 -> 61.9547
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2991 mb_mean=0.4966 norm_overlap=1.0048 corr_cb=0.6764 topkJ=0.2088
[TRAIN][ep=006] loss=1.4260 acc=61.48%
[TRAIN][ep=006] mask_avg: mc_mean=0.2922 mb_mean=0.4939 norm_overlap=1.0046 corr_cb=0.6167
[EPOCH 006/089] train: loss=1.4260 acc=61.48% | val: loss=0.6895 acc=60.24% f1=69.16% auc=54.13% val_score=33.0030 val_score_bestthr=62.2770 | dyn(w_pfs=0.240, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.292, mb=0.494, no=1.005, corr=0.617) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2201 -> 62.2770
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2882 mb_mean=0.4963 norm_overlap=1.0042 corr_cb=0.5848 topkJ=0.1998
[TRAIN][ep=007] loss=1.2097 acc=63.22%
[TRAIN][ep=007] mask_avg: mc_mean=0.2797 mb_mean=0.4939 norm_overlap=1.0046 corr_cb=0.5720
[EPOCH 007/089] train: loss=1.2097 acc=63.22% | val: loss=0.6857 acc=60.24% f1=65.98% auc=55.41% val_score=56.0079 val_score_bestthr=60.7947 | dyn(w_pfs=0.140, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.280, mb=0.494, no=1.005, corr=0.572) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2201 -> 60.7947
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2831 mb_mean=0.4944 norm_overlap=1.0035 corr_cb=0.4594 topkJ=0.1589
[TRAIN][ep=008] loss=0.9897 acc=62.68%
[TRAIN][ep=008] mask_avg: mc_mean=0.2707 mb_mean=0.4939 norm_overlap=1.0046 corr_cb=0.5313
[EPOCH 008/089] train: loss=0.9897 acc=62.68% | val: loss=0.6886 acc=62.65% f1=69.31% auc=54.24% val_score=37.0893 val_score_bestthr=64.0147 | dyn(w_pfs=0.040, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.271, mb=0.494, no=1.005, corr=0.531) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.2201 -> 64.0147
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2718 mb_mean=0.4943 norm_overlap=1.0035 corr_cb=0.4286 topkJ=0.1387
[TRAIN][ep=009] loss=0.9373 acc=63.36%
[TRAIN][ep=009] mask_avg: mc_mean=0.2651 mb_mean=0.4939 norm_overlap=1.0044 corr_cb=0.4541
[EPOCH 009/089] train: loss=0.9373 acc=63.36% | val: loss=0.6899 acc=63.86% f1=70.00% auc=54.59% val_score=42.2176 val_score_bestthr=64.4904 | dyn(w_pfs=0.080, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.265, mb=0.494, no=1.004, corr=0.454) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 64.2201 -> 64.4904
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.2378 mb_mean=0.4924 norm_overlap=1.0062 corr_cb=0.4734 topkJ=0.0877
[TRAIN][ep=010] loss=1.0237 acc=63.62%
[TRAIN][ep=010] mask_avg: mc_mean=0.2566 mb_mean=0.4939 norm_overlap=1.0042 corr_cb=0.3866
[EPOCH 010/089] train: loss=1.0237 acc=63.62% | val: loss=0.6894 acc=59.04% f1=71.19% auc=55.12% val_score=60.0707 val_score_bestthr=60.5781 | dyn(w_pfs=0.120, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.257, mb=0.494, no=1.004, corr=0.387) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.4904 -> 60.5781
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.2403 mb_mean=0.4897 norm_overlap=1.0090 corr_cb=0.5321 topkJ=0.0959
[TRAIN][ep=011] loss=1.0990 acc=64.83%
[TRAIN][ep=011] mask_avg: mc_mean=0.2441 mb_mean=0.4939 norm_overlap=1.0040 corr_cb=0.3222
[EPOCH 011/089] train: loss=1.0990 acc=64.83% | val: loss=0.6875 acc=61.45% f1=68.63% auc=55.41% val_score=58.1875 val_score_bestthr=62.5080 | dyn(w_pfs=0.160, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.244, mb=0.494, no=1.004, corr=0.322) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.4904 -> 62.5080
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.2254 mb_mean=0.4961 norm_overlap=1.0028 corr_cb=0.2681 topkJ=0.1359
[TRAIN][ep=012] loss=1.1836 acc=64.16%
[TRAIN][ep=012] mask_avg: mc_mean=0.2292 mb_mean=0.4939 norm_overlap=1.0041 corr_cb=0.2901
[EPOCH 012/089] train: loss=1.1836 acc=64.16% | val: loss=0.6882 acc=60.24% f1=68.57% auc=55.76% val_score=57.9556 val_score_bestthr=62.6392 | dyn(w_pfs=0.200, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.229, mb=0.494, no=1.004, corr=0.290) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.4904 -> 62.6392
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.2150 mb_mean=0.4893 norm_overlap=1.0044 corr_cb=0.3388 topkJ=0.0976
[TRAIN][ep=013] loss=1.2678 acc=65.91%
[TRAIN][ep=013] mask_avg: mc_mean=0.2414 mb_mean=0.4939 norm_overlap=1.0031 corr_cb=0.2109
[EPOCH 013/089] train: loss=1.2678 acc=65.91% | val: loss=0.6872 acc=62.65% f1=69.90% auc=55.76% val_score=57.9556 val_score_bestthr=64.5172 | dyn(w_pfs=0.240, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.241, mb=0.494, no=1.003, corr=0.211) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 64.4904 -> 64.5172
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.2414 mb_mean=0.4938 norm_overlap=1.0021 corr_cb=0.1958 topkJ=0.1826
[TRAIN][ep=014] loss=1.3367 acc=68.05%
[TRAIN][ep=014] mask_avg: mc_mean=0.2305 mb_mean=0.4939 norm_overlap=1.0028 corr_cb=0.1923
[EPOCH 014/089] train: loss=1.3367 acc=68.05% | val: loss=0.7370 acc=59.04% f1=67.31% auc=55.06% val_score=30.8843 val_score_bestthr=59.0166 | dyn(w_pfs=0.280, w_sup=0.240, w_csuf=0.200, stage2=False) | mask(mc=0.231, mb=0.494, no=1.003, corr=0.192) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.5172 -> 59.0166
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.2360 mb_mean=0.4908 norm_overlap=1.0049 corr_cb=0.3284 topkJ=0.1108
[TRAIN][ep=015] loss=1.3615 acc=65.77%
[TRAIN][ep=015] mask_avg: mc_mean=0.2306 mb_mean=0.4939 norm_overlap=1.0021 corr_cb=0.1448
[EPOCH 015/089] train: loss=1.3615 acc=65.77% | val: loss=0.6954 acc=60.24% f1=68.57% auc=56.63% val_score=59.5818 val_score_bestthr=62.6392 | dyn(w_pfs=0.320, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.231, mb=0.494, no=1.002, corr=0.145) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.5172 -> 62.6392
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1865 mb_mean=0.4876 norm_overlap=1.0027 corr_cb=0.1686 topkJ=0.0912
[TRAIN][ep=016] loss=1.3648 acc=66.44%
[TRAIN][ep=016] mask_avg: mc_mean=0.2167 mb_mean=0.4939 norm_overlap=1.0020 corr_cb=0.1152
[EPOCH 016/089] train: loss=1.3648 acc=66.44% | val: loss=0.6891 acc=59.04% f1=66.00% auc=56.40% val_score=59.4602 val_score_bestthr=61.9131 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.217, mb=0.494, no=1.002, corr=0.115) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.5172 -> 61.9131
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.2141 mb_mean=0.4928 norm_overlap=1.0031 corr_cb=0.2067 topkJ=0.1153
[TRAIN][ep=017] loss=1.3574 acc=68.46%
[TRAIN][ep=017] mask_avg: mc_mean=0.2132 mb_mean=0.4939 norm_overlap=1.0015 corr_cb=0.0741
[EPOCH 017/089] train: loss=1.3574 acc=68.46% | val: loss=0.6928 acc=60.24% f1=68.57% auc=56.34% val_score=51.7833 val_score_bestthr=62.6392 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.213, mb=0.494, no=1.001, corr=0.074) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.5172 -> 62.6392
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.2169 mb_mean=0.4962 norm_overlap=1.0000 corr_cb=0.0021 topkJ=0.0577
[TRAIN][ep=018] loss=1.3487 acc=70.07%
[TRAIN][ep=018] mask_avg: mc_mean=0.2132 mb_mean=0.4939 norm_overlap=1.0007 corr_cb=0.0291
[EPOCH 018/089] train: loss=1.3487 acc=70.07% | val: loss=0.7085 acc=60.24% f1=69.16% auc=56.16% val_score=38.7183 val_score_bestthr=65.8052 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.213, mb=0.494, no=1.001, corr=0.029) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 64.5172 -> 65.8052
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.2164 mb_mean=0.4994 norm_overlap=0.9974 corr_cb=-0.1490 topkJ=0.0427
[TRAIN][ep=019] loss=1.3406 acc=70.47%
[TRAIN][ep=019] mask_avg: mc_mean=0.2118 mb_mean=0.4939 norm_overlap=1.0001 corr_cb=-0.0004
[EPOCH 019/089] train: loss=1.3406 acc=70.47% | val: loss=0.6933 acc=62.65% f1=67.37% auc=57.15% val_score=50.6467 val_score_bestthr=60.1415 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.212, mb=0.494, no=1.000, corr=-0.000) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.8052 -> 60.1415
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.2459 mb_mean=0.4996 norm_overlap=0.9986 corr_cb=-0.0856 topkJ=0.0501
[TRAIN][ep=020] loss=1.3351 acc=70.20%
[TRAIN][ep=020] mask_avg: mc_mean=0.2239 mb_mean=0.4939 norm_overlap=0.9990 corr_cb=-0.0555
[EPOCH 020/089] train: loss=1.3351 acc=70.20% | val: loss=0.7291 acc=59.04% f1=67.92% auc=56.80% val_score=37.6409 val_score_bestthr=62.0758 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.224, mb=0.494, no=0.999, corr=-0.055) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.8052 -> 62.0758
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2210 mb_mean=0.4905 norm_overlap=0.9995 corr_cb=-0.0230 topkJ=0.0523
[TRAIN][ep=021] loss=1.3238 acc=70.74%
[TRAIN][ep=021] mask_avg: mc_mean=0.2166 mb_mean=0.4939 norm_overlap=0.9985 corr_cb=-0.0764
[EPOCH 021/089] train: loss=1.3238 acc=70.74% | val: loss=0.6934 acc=59.04% f1=67.92% auc=58.08% val_score=48.2644 val_score_bestthr=62.0758 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.217, mb=0.494, no=0.998, corr=-0.076) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.8052 -> 62.0758
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2368 mb_mean=0.4935 norm_overlap=0.9980 corr_cb=-0.0973 topkJ=0.0500
[TRAIN][ep=022] loss=1.3145 acc=71.28%
[TRAIN][ep=022] mask_avg: mc_mean=0.2132 mb_mean=0.4939 norm_overlap=0.9981 corr_cb=-0.0912
[EPOCH 022/089] train: loss=1.3145 acc=71.28% | val: loss=0.6985 acc=61.45% f1=68.00% auc=58.08% val_score=57.3468 val_score_bestthr=62.7735 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.213, mb=0.494, no=0.998, corr=-0.091) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.8052 -> 62.7735
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2625 mb_mean=0.4972 norm_overlap=0.9954 corr_cb=-0.2804 topkJ=0.0236
[TRAIN][ep=023] loss=1.2976 acc=73.15%
[TRAIN][ep=023] mask_avg: mc_mean=0.2300 mb_mean=0.4939 norm_overlap=0.9971 corr_cb=-0.1389
[EPOCH 023/089] train: loss=1.2976 acc=73.15% | val: loss=0.7361 acc=55.42% f1=69.42% auc=57.50% val_score=57.5214 val_score_bestthr=59.9095 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.230, mb=0.494, no=0.997, corr=-0.139) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.8052 -> 59.9095
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2731 mb_mean=0.4985 norm_overlap=0.9967 corr_cb=-0.1700 topkJ=0.0179
[TRAIN][ep=024] loss=1.1037 acc=71.54%
[TRAIN][ep=024] mask_avg: mc_mean=0.2290 mb_mean=0.4939 norm_overlap=0.9968 corr_cb=-0.1468
[EPOCH 024/089] train: loss=1.1037 acc=71.54% | val: loss=0.6967 acc=61.45% f1=70.37% auc=58.26% val_score=48.1032 val_score_bestthr=60.5787 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.229, mb=0.494, no=0.997, corr=-0.147) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.8052 -> 60.5787
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2420 mb_mean=0.4905 norm_overlap=0.9981 corr_cb=-0.0913 topkJ=0.0453
[TRAIN][ep=025] loss=0.8855 acc=71.41%
[TRAIN][ep=025] mask_avg: mc_mean=0.2540 mb_mean=0.4939 norm_overlap=0.9957 corr_cb=-0.2068
[EPOCH 025/089] train: loss=0.8855 acc=71.41% | val: loss=0.6995 acc=62.65% f1=71.03% auc=58.84% val_score=47.2565 val_score_bestthr=62.0199 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.254, mb=0.494, no=0.996, corr=-0.207) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.8052 -> 62.0199
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2214 mb_mean=0.4946 norm_overlap=0.9982 corr_cb=-0.0849 topkJ=0.0269
[TRAIN][ep=026] loss=0.8310 acc=72.89%
[TRAIN][ep=026] mask_avg: mc_mean=0.2394 mb_mean=0.4939 norm_overlap=0.9959 corr_cb=-0.1863
[EPOCH 026/089] train: loss=0.8310 acc=72.89% | val: loss=0.7260 acc=59.04% f1=65.31% auc=59.59% val_score=32.8661 val_score_bestthr=57.6790 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.239, mb=0.494, no=0.996, corr=-0.186) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.8052 -> 57.6790
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2234 mb_mean=0.4930 norm_overlap=0.9969 corr_cb=-0.0991 topkJ=0.0325
[TRAIN][ep=027] loss=0.8058 acc=73.69%
[TRAIN][ep=027] mask_avg: mc_mean=0.2482 mb_mean=0.4939 norm_overlap=0.9955 corr_cb=-0.2092
[EPOCH 027/089] train: loss=0.8058 acc=73.69% | val: loss=0.7548 acc=59.04% f1=69.64% auc=59.53% val_score=37.8736 val_score_bestthr=58.0799 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.248, mb=0.494, no=0.995, corr=-0.209) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.8052 -> 58.0799
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2240 mb_mean=0.4937 norm_overlap=0.9960 corr_cb=-0.2085 topkJ=0.0292
[TRAIN][ep=028] loss=0.8077 acc=73.29%
[TRAIN][ep=028] mask_avg: mc_mean=0.2554 mb_mean=0.4939 norm_overlap=0.9950 corr_cb=-0.2333
[EPOCH 028/089] train: loss=0.8077 acc=73.29% | val: loss=0.7094 acc=65.06% f1=72.38% auc=59.30% val_score=48.9871 val_score_bestthr=64.2940 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.255, mb=0.494, no=0.995, corr=-0.233) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.8052 -> 64.2940
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2720 mb_mean=0.4901 norm_overlap=0.9930 corr_cb=-0.3400 topkJ=0.0126
[TRAIN][ep=029] loss=0.7897 acc=73.56%
[TRAIN][ep=029] mask_avg: mc_mean=0.2577 mb_mean=0.4939 norm_overlap=0.9947 corr_cb=-0.2422
[EPOCH 029/089] train: loss=0.7897 acc=73.56% | val: loss=0.7113 acc=62.65% f1=69.90% auc=59.53% val_score=47.8165 val_score_bestthr=61.2860 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.258, mb=0.494, no=0.995, corr=-0.242) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.8052 -> 61.2860
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2344 mb_mean=0.4930 norm_overlap=0.9928 corr_cb=-0.2940 topkJ=0.0112
[TRAIN][ep=030] loss=0.7990 acc=73.42%
[TRAIN][ep=030] mask_avg: mc_mean=0.2450 mb_mean=0.4939 norm_overlap=0.9948 corr_cb=-0.2291
[EPOCH 030/089] train: loss=0.7990 acc=73.42% | val: loss=0.7130 acc=62.65% f1=71.03% auc=59.19% val_score=51.0656 val_score_bestthr=60.4643 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.245, mb=0.494, no=0.995, corr=-0.229) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.8052 -> 60.4643
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2398 mb_mean=0.4940 norm_overlap=0.9979 corr_cb=-0.0771 topkJ=0.0396
[TRAIN][ep=031] loss=0.7957 acc=72.89%
[TRAIN][ep=031] mask_avg: mc_mean=0.2514 mb_mean=0.4939 norm_overlap=0.9946 corr_cb=-0.2434
[EPOCH 031/089] train: loss=0.7957 acc=72.89% | val: loss=0.7232 acc=57.83% f1=70.09% auc=60.35% val_score=54.5969 val_score_bestthr=63.6833 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.251, mb=0.494, no=0.995, corr=-0.243) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.8052 -> 63.6833
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2770 mb_mean=0.4935 norm_overlap=0.9935 corr_cb=-0.2947 topkJ=0.0268
[TRAIN][ep=032] loss=0.7917 acc=73.56%
[TRAIN][ep=032] mask_avg: mc_mean=0.2466 mb_mean=0.4939 norm_overlap=0.9946 corr_cb=-0.2396
[EPOCH 032/089] train: loss=0.7917 acc=73.56% | val: loss=0.7296 acc=62.65% f1=71.03% auc=60.00% val_score=54.5969 val_score_bestthr=60.4643 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.247, mb=0.494, no=0.995, corr=-0.240) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.8052 -> 60.4643
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2560 mb_mean=0.4981 norm_overlap=0.9941 corr_cb=-0.2897 topkJ=0.0384
[TRAIN][ep=033] loss=0.7756 acc=74.09%
[TRAIN][ep=033] mask_avg: mc_mean=0.2436 mb_mean=0.4939 norm_overlap=0.9947 corr_cb=-0.2348
[EPOCH 033/089] train: loss=0.7756 acc=74.09% | val: loss=0.7228 acc=57.83% f1=70.09% auc=60.17% val_score=58.2588 val_score_bestthr=63.6833 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.244, mb=0.494, no=0.995, corr=-0.235) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.8052 -> 63.6833
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2297 mb_mean=0.4891 norm_overlap=0.9945 corr_cb=-0.2282 topkJ=0.0334
[TRAIN][ep=034] loss=0.7646 acc=75.70%
[TRAIN][ep=034] mask_avg: mc_mean=0.2568 mb_mean=0.4939 norm_overlap=0.9944 corr_cb=-0.2499
[EPOCH 034/089] train: loss=0.7646 acc=75.70% | val: loss=0.7293 acc=63.86% f1=71.70% auc=60.64% val_score=54.6603 val_score_bestthr=61.6312 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.257, mb=0.494, no=0.994, corr=-0.250) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.8052 -> 61.6312
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2280 mb_mean=0.4998 norm_overlap=0.9939 corr_cb=-0.2712 topkJ=0.0194
[TRAIN][ep=035] loss=0.7546 acc=76.11%
[TRAIN][ep=035] mask_avg: mc_mean=0.2586 mb_mean=0.4939 norm_overlap=0.9941 corr_cb=-0.2615
[EPOCH 035/089] train: loss=0.7546 acc=76.11% | val: loss=0.7300 acc=63.86% f1=71.70% auc=60.87% val_score=51.2329 val_score_bestthr=61.6312 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.259, mb=0.494, no=0.994, corr=-0.262) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.8052 -> 61.6312
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2783 mb_mean=0.4939 norm_overlap=0.9954 corr_cb=-0.2294 topkJ=0.0353
[TRAIN][ep=036] loss=0.7562 acc=74.50%
[TRAIN][ep=036] mask_avg: mc_mean=0.2716 mb_mean=0.4939 norm_overlap=0.9938 corr_cb=-0.2820
[EPOCH 036/089] train: loss=0.7562 acc=74.50% | val: loss=0.7384 acc=62.65% f1=70.48% auc=60.23% val_score=54.6603 val_score_bestthr=61.9875 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.272, mb=0.494, no=0.994, corr=-0.282) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.8052 -> 61.9875
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.2508 mb_mean=0.4988 norm_overlap=0.9928 corr_cb=-0.3220 topkJ=0.0172
[TRAIN][ep=037] loss=0.7394 acc=76.91%
[TRAIN][ep=037] mask_avg: mc_mean=0.2709 mb_mean=0.4939 norm_overlap=0.9936 corr_cb=-0.2841
[EPOCH 037/089] train: loss=0.7394 acc=76.91% | val: loss=0.7857 acc=56.63% f1=69.49% auc=60.29% val_score=49.1181 val_score_bestthr=62.5328 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.271, mb=0.494, no=0.994, corr=-0.284) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.8052 -> 62.5328
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.3384 mb_mean=0.4887 norm_overlap=0.9923 corr_cb=-0.3370 topkJ=0.0186
[TRAIN][ep=038] loss=0.7560 acc=75.03%
[TRAIN][ep=038] mask_avg: mc_mean=0.2647 mb_mean=0.4939 norm_overlap=0.9940 corr_cb=-0.2638
[EPOCH 038/089] train: loss=0.7560 acc=75.03% | val: loss=0.7403 acc=62.65% f1=70.48% auc=60.64% val_score=55.6195 val_score_bestthr=61.9875 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.265, mb=0.494, no=0.994, corr=-0.264) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.8052 -> 61.9875
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2677 mb_mean=0.4974 norm_overlap=0.9918 corr_cb=-0.3692 topkJ=0.0104
[TRAIN][ep=039] loss=0.7324 acc=78.26%
[TRAIN][ep=039] mask_avg: mc_mean=0.2647 mb_mean=0.4939 norm_overlap=0.9936 corr_cb=-0.2808
[EPOCH 039/089] train: loss=0.7324 acc=78.26% | val: loss=0.7429 acc=61.45% f1=69.81% auc=60.58% val_score=50.8742 val_score_bestthr=60.8830 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.265, mb=0.494, no=0.994, corr=-0.281) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.8052 -> 60.8830
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.2426 mb_mean=0.4958 norm_overlap=0.9953 corr_cb=-0.2252 topkJ=0.0296
[TRAIN][ep=040] loss=0.7319 acc=77.45%
[TRAIN][ep=040] mask_avg: mc_mean=0.2628 mb_mean=0.4939 norm_overlap=0.9937 corr_cb=-0.2749
[EPOCH 040/089] train: loss=0.7319 acc=77.45% | val: loss=0.7555 acc=57.83% f1=70.09% auc=61.40% val_score=54.6603 val_score_bestthr=63.6833 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.263, mb=0.494, no=0.994, corr=-0.275) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.8052 -> 63.6833
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.2448 mb_mean=0.5013 norm_overlap=0.9949 corr_cb=-0.2241 topkJ=0.0292
[TRAIN][ep=041] loss=0.7363 acc=76.64%
[TRAIN][ep=041] mask_avg: mc_mean=0.2855 mb_mean=0.4939 norm_overlap=0.9933 corr_cb=-0.3037
[EPOCH 041/089] train: loss=0.7363 acc=76.64% | val: loss=0.7568 acc=60.24% f1=68.57% auc=59.77% val_score=51.6210 val_score_bestthr=60.6322 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.286, mb=0.494, no=0.993, corr=-0.304) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.8052 -> 60.6322
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.3029 mb_mean=0.4932 norm_overlap=0.9918 corr_cb=-0.3692 topkJ=0.0171
[TRAIN][ep=042] loss=0.7411 acc=75.44%
[TRAIN][ep=042] mask_avg: mc_mean=0.2426 mb_mean=0.4939 norm_overlap=0.9942 corr_cb=-0.2368
[EPOCH 042/089] train: loss=0.7411 acc=75.44% | val: loss=0.7591 acc=57.83% f1=70.09% auc=61.74% val_score=49.1570 val_score_bestthr=63.6833 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.243, mb=0.494, no=0.994, corr=-0.237) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.8052 -> 63.6833
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.2895 mb_mean=0.4933 norm_overlap=0.9964 corr_cb=-0.1430 topkJ=0.0643
[TRAIN][ep=043] loss=0.7213 acc=76.64%
[TRAIN][ep=043] mask_avg: mc_mean=0.2727 mb_mean=0.4939 norm_overlap=0.9935 corr_cb=-0.2845
[EPOCH 043/089] train: loss=0.7213 acc=76.64% | val: loss=0.7680 acc=56.63% f1=69.49% auc=61.80% val_score=49.1570 val_score_bestthr=61.5995 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.273, mb=0.494, no=0.993, corr=-0.285) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.8052 -> 61.5995
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2629 mb_mean=0.4929 norm_overlap=0.9911 corr_cb=-0.3328 topkJ=0.0124
[TRAIN][ep=044] loss=0.7130 acc=78.93%
[TRAIN][ep=044] mask_avg: mc_mean=0.2742 mb_mean=0.4939 norm_overlap=0.9938 corr_cb=-0.2693
[EPOCH 044/089] train: loss=0.7130 acc=78.93% | val: loss=0.9332 acc=56.63% f1=68.97% auc=61.74% val_score=42.6666 val_score_bestthr=57.9831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.274, mb=0.494, no=0.994, corr=-0.269) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.8052 -> 57.9831
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2229 mb_mean=0.4904 norm_overlap=0.9974 corr_cb=-0.0990 topkJ=0.0355
[TRAIN][ep=045] loss=0.7102 acc=79.33%
[TRAIN][ep=045] mask_avg: mc_mean=0.2674 mb_mean=0.4939 norm_overlap=0.9937 corr_cb=-0.2717
[EPOCH 045/089] train: loss=0.7102 acc=79.33% | val: loss=0.7679 acc=56.63% f1=69.49% auc=61.69% val_score=52.5819 val_score_bestthr=61.5995 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.267, mb=0.494, no=0.994, corr=-0.272) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.8052 -> 61.5995
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.3044 mb_mean=0.4850 norm_overlap=0.9963 corr_cb=-0.2242 topkJ=0.0514
[TRAIN][ep=046] loss=0.6892 acc=80.67%
[TRAIN][ep=046] mask_avg: mc_mean=0.2849 mb_mean=0.4939 norm_overlap=0.9934 corr_cb=-0.2934
[EPOCH 046/089] train: loss=0.6892 acc=80.67% | val: loss=0.8027 acc=57.83% f1=70.09% auc=61.92% val_score=49.1570 val_score_bestthr=63.6833 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.285, mb=0.494, no=0.993, corr=-0.293) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.8052 -> 63.6833
[DBG][ep=047] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.2480 mb_mean=0.4971 norm_overlap=0.9957 corr_cb=-0.2102 topkJ=0.0268
[TRAIN][ep=047] loss=0.6860 acc=79.06%
[TRAIN][ep=047] mask_avg: mc_mean=0.2626 mb_mean=0.4939 norm_overlap=0.9937 corr_cb=-0.2676
[EPOCH 047/089] train: loss=0.6860 acc=79.06% | val: loss=0.7947 acc=59.04% f1=57.50% auc=60.58% val_score=50.0028 val_score_bestthr=58.7958 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.263, mb=0.494, no=0.994, corr=-0.268) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.8052 -> 58.7958
[DBG][ep=048] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.3095 mb_mean=0.4989 norm_overlap=0.9957 corr_cb=-0.2805 topkJ=0.0302
[TRAIN][ep=048] loss=0.6865 acc=79.46%
[TRAIN][ep=048] mask_avg: mc_mean=0.2908 mb_mean=0.4939 norm_overlap=0.9935 corr_cb=-0.2908
[EPOCH 048/089] train: loss=0.6865 acc=79.46% | val: loss=0.8094 acc=59.04% f1=69.64% auc=60.93% val_score=46.5410 val_score_bestthr=60.0387 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.291, mb=0.494, no=0.993, corr=-0.291) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.8052 -> 60.0387
[EARLY STOP] no improvement for 30 epochs. best_epoch=18
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
=============== FIT DONE ===============
[BEST] epoch=18 | val_acc=60.24% | val_f1=69.16% | val_auc=56.16% | val_score=38.7183 | val_score_bestthr=65.8052
[TEST@BEST] thr_used=0.365 | acc=57.97% f1=63.60% auc=64.44% | SP_sex=10.00% EO_sex=13.63% SP_age=13.35% EO_age=14.48%
[TIME] 1.34 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold1_rep1_seed1001/summary_fold_1.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5240 mb_mean=0.4945 norm_overlap=1.0001 corr_cb=0.1063 topkJ=0.0892
[TRAIN][ep=000] loss=0.6970 acc=50.20%
[TRAIN][ep=000] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0637
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5198 mb_mean=0.4964 norm_overlap=1.0000 corr_cb=0.0020 topkJ=0.1618
[TRAIN][ep=001] loss=0.6933 acc=49.53%
[TRAIN][ep=001] mask_avg: mc_mean=0.5235 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0636
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5264 mb_mean=0.4883 norm_overlap=1.0000 corr_cb=0.0372 topkJ=0.1146
[TRAIN][ep=002] loss=0.6925 acc=52.89%
[TRAIN][ep=002] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0591
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5240 mb_mean=0.4973 norm_overlap=0.9999 corr_cb=-0.1065 topkJ=0.0757
[TRAIN][ep=003] loss=0.6913 acc=51.81%
[TRAIN][ep=003] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0640
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5252 mb_mean=0.4946 norm_overlap=1.0001 corr_cb=0.0693 topkJ=0.1075
[TRAIN][ep=004] loss=0.6901 acc=54.23%
[TRAIN][ep=004] mask_avg: mc_mean=0.5235 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0728
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5254 mb_mean=0.4873 norm_overlap=0.9996 corr_cb=-0.3571 topkJ=0.0700
[TRAIN][ep=005] loss=0.6897 acc=54.09%
[TRAIN][ep=005] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0579
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5240 mb_mean=0.4920 norm_overlap=0.9998 corr_cb=-0.2417 topkJ=0.0358
[TRAIN][ep=006] loss=0.6871 acc=55.57%
[TRAIN][ep=006] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0643
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5236 mb_mean=0.4973 norm_overlap=1.0000 corr_cb=0.0089 topkJ=0.0999
[TRAIN][ep=007] loss=0.6848 acc=59.06%
[TRAIN][ep=007] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0694
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5205 mb_mean=0.4927 norm_overlap=0.9997 corr_cb=-0.2425 topkJ=0.0796
[TRAIN][ep=008] loss=0.6852 acc=54.09%
[TRAIN][ep=008] mask_avg: mc_mean=0.5235 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0663
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5252 mb_mean=0.4985 norm_overlap=1.0001 corr_cb=0.1253 topkJ=0.1968
[TRAIN][ep=009] loss=0.6821 acc=57.32%
[TRAIN][ep=009] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0649
================= FIT START (fold=1) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.45 select_by=val_score_bestthr | eval_thr_mode=fixed eval_thr_grid=coarse | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5254 mb_mean=0.4911 norm_overlap=0.9999 corr_cb=-0.1383 topkJ=0.0522
[TRAIN][ep=000] loss=0.6792 acc=57.99%
[TRAIN][ep=000] mask_avg: mc_mean=0.5235 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0647
[EPOCH 000/089] train: loss=0.6792 acc=57.99% | val: loss=0.6891 acc=53.01% f1=68.80% auc=54.24% val_score=61.8593 val_score_bestthr=61.8593 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.065) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 61.8593
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5232 mb_mean=0.4969 norm_overlap=0.9998 corr_cb=-0.2445 topkJ=0.0792
[TRAIN][ep=001] loss=0.6789 acc=57.18%
[TRAIN][ep=001] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0653
[EPOCH 001/089] train: loss=0.6789 acc=57.18% | val: loss=0.6935 acc=57.83% f1=66.02% auc=53.02% val_score=59.3488 val_score_bestthr=59.3488 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.065) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.8593 -> 59.3488
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5251 mb_mean=0.4886 norm_overlap=1.0000 corr_cb=-0.0238 topkJ=0.0802
[TRAIN][ep=002] loss=0.6754 acc=60.94%
[TRAIN][ep=002] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0672
[EPOCH 002/089] train: loss=0.6754 acc=60.94% | val: loss=0.6883 acc=54.22% f1=68.33% auc=53.78% val_score=54.4443 val_score_bestthr=54.4443 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.067) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.8593 -> 54.4443
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5203 mb_mean=0.4927 norm_overlap=1.0000 corr_cb=-0.0206 topkJ=0.0508
[TRAIN][ep=003] loss=0.6721 acc=59.73%
[TRAIN][ep=003] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0645
[EPOCH 003/089] train: loss=0.6721 acc=59.73% | val: loss=0.6886 acc=53.01% f1=68.80% auc=54.94% val_score=61.8593 val_score_bestthr=61.8593 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.064) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.8593 -> 61.8593
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5239 mb_mean=0.4918 norm_overlap=0.9998 corr_cb=-0.2595 topkJ=0.0761
[TRAIN][ep=004] loss=0.6697 acc=61.21%
[TRAIN][ep=004] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0632
[EPOCH 004/089] train: loss=0.6697 acc=61.21% | val: loss=0.6874 acc=56.63% f1=70.00% auc=54.94% val_score=60.1401 val_score_bestthr=60.1401 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.063) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 61.8593 -> 60.1401
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5228 mb_mean=0.4934 norm_overlap=0.9999 corr_cb=-0.0737 topkJ=0.0499
[TRAIN][ep=005] loss=1.4376 acc=61.61%
[TRAIN][ep=005] mask_avg: mc_mean=0.3788 mb_mean=0.4939 norm_overlap=1.0029 corr_cb=0.5995
[EPOCH 005/089] train: loss=1.4376 acc=61.61% | val: loss=0.6875 acc=61.45% f1=70.37% auc=53.95% val_score=61.9547 val_score_bestthr=61.9547 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.379, mb=0.494, no=1.003, corr=0.599) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 61.8593 -> 61.9547
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2990 mb_mean=0.4966 norm_overlap=1.0048 corr_cb=0.6764 topkJ=0.2088
[TRAIN][ep=006] loss=1.4260 acc=61.48%
[TRAIN][ep=006] mask_avg: mc_mean=0.2922 mb_mean=0.4939 norm_overlap=1.0046 corr_cb=0.6166
[EPOCH 006/089] train: loss=1.4260 acc=61.48% | val: loss=0.6895 acc=61.45% f1=67.35% auc=54.19% val_score=57.1959 val_score_bestthr=57.1959 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.292, mb=0.494, no=1.005, corr=0.617) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.9547 -> 57.1959
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2881 mb_mean=0.4963 norm_overlap=1.0042 corr_cb=0.5847 topkJ=0.1998
[TRAIN][ep=007] loss=1.4285 acc=63.09%
[TRAIN][ep=007] mask_avg: mc_mean=0.2787 mb_mean=0.4939 norm_overlap=1.0046 corr_cb=0.5736
[EPOCH 007/089] train: loss=1.4285 acc=63.09% | val: loss=0.6856 acc=57.83% f1=70.09% auc=55.17% val_score=59.0192 val_score_bestthr=59.0192 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.279, mb=0.494, no=1.005, corr=0.574) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.9547 -> 59.0192
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2820 mb_mean=0.4944 norm_overlap=1.0036 corr_cb=0.4629 topkJ=0.1583
[TRAIN][ep=008] loss=1.4246 acc=62.95%
[TRAIN][ep=008] mask_avg: mc_mean=0.2683 mb_mean=0.4939 norm_overlap=1.0047 corr_cb=0.5402
[EPOCH 008/089] train: loss=1.4246 acc=62.95% | val: loss=0.6879 acc=61.45% f1=67.35% auc=54.42% val_score=57.1959 val_score_bestthr=57.1959 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.268, mb=0.494, no=1.005, corr=0.540) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.9547 -> 57.1959
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2691 mb_mean=0.4943 norm_overlap=1.0036 corr_cb=0.4460 topkJ=0.1417
[TRAIN][ep=009] loss=1.4155 acc=63.36%
[TRAIN][ep=009] mask_avg: mc_mean=0.2635 mb_mean=0.4939 norm_overlap=1.0045 corr_cb=0.4812
[EPOCH 009/089] train: loss=1.4155 acc=63.36% | val: loss=0.6880 acc=61.45% f1=67.35% auc=55.00% val_score=57.1959 val_score_bestthr=57.1959 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.263, mb=0.494, no=1.005, corr=0.481) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.9547 -> 57.1959
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.2364 mb_mean=0.4924 norm_overlap=1.0063 corr_cb=0.4985 topkJ=0.0929
[TRAIN][ep=010] loss=1.4158 acc=62.68%
[TRAIN][ep=010] mask_avg: mc_mean=0.2553 mb_mean=0.4939 norm_overlap=1.0043 corr_cb=0.4187
[EPOCH 010/089] train: loss=1.4158 acc=62.68% | val: loss=0.6885 acc=57.83% f1=69.03% auc=55.81% val_score=55.6297 val_score_bestthr=55.6297 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.255, mb=0.494, no=1.004, corr=0.419) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.9547 -> 55.6297
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.2394 mb_mean=0.4897 norm_overlap=1.0092 corr_cb=0.5564 topkJ=0.1021
[TRAIN][ep=011] loss=1.1885 acc=65.23%
[TRAIN][ep=011] mask_avg: mc_mean=0.2452 mb_mean=0.4939 norm_overlap=1.0041 corr_cb=0.3472
[EPOCH 011/089] train: loss=1.1885 acc=65.23% | val: loss=0.6865 acc=59.04% f1=67.92% auc=55.17% val_score=60.5151 val_score_bestthr=60.5151 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.245, mb=0.494, no=1.004, corr=0.347) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.9547 -> 60.5151
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.2263 mb_mean=0.4961 norm_overlap=1.0029 corr_cb=0.2882 topkJ=0.1390
[TRAIN][ep=012] loss=0.9716 acc=64.97%
[TRAIN][ep=012] mask_avg: mc_mean=0.2335 mb_mean=0.4939 norm_overlap=1.0040 corr_cb=0.2989
[EPOCH 012/089] train: loss=0.9716 acc=64.97% | val: loss=0.6884 acc=59.04% f1=67.92% auc=55.41% val_score=60.5151 val_score_bestthr=60.5151 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.233, mb=0.494, no=1.004, corr=0.299) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.9547 -> 60.5151
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.2211 mb_mean=0.4893 norm_overlap=1.0043 corr_cb=0.3400 topkJ=0.0976
[TRAIN][ep=013] loss=0.9265 acc=65.77%
[TRAIN][ep=013] mask_avg: mc_mean=0.2470 mb_mean=0.4939 norm_overlap=1.0030 corr_cb=0.2084
[EPOCH 013/089] train: loss=0.9265 acc=65.77% | val: loss=0.6877 acc=59.04% f1=67.92% auc=55.17% val_score=60.5151 val_score_bestthr=60.5151 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.247, mb=0.494, no=1.003, corr=0.208) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.9547 -> 60.5151
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.2461 mb_mean=0.4938 norm_overlap=1.0020 corr_cb=0.1906 topkJ=0.1832
[TRAIN][ep=014] loss=0.8952 acc=67.92%
[TRAIN][ep=014] mask_avg: mc_mean=0.2348 mb_mean=0.4939 norm_overlap=1.0027 corr_cb=0.1877
[EPOCH 014/089] train: loss=0.8952 acc=67.92% | val: loss=0.7443 acc=48.19% f1=39.44% auc=54.77% val_score=33.6072 val_score_bestthr=33.6072 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.235, mb=0.494, no=1.003, corr=0.188) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.9547 -> 33.6072
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.2429 mb_mean=0.4908 norm_overlap=1.0047 corr_cb=0.3122 topkJ=0.1113
[TRAIN][ep=015] loss=0.8952 acc=65.91%
[TRAIN][ep=015] mask_avg: mc_mean=0.2375 mb_mean=0.4939 norm_overlap=1.0020 corr_cb=0.1359
[EPOCH 015/089] train: loss=0.8952 acc=65.91% | val: loss=0.6981 acc=56.63% f1=67.27% auc=56.28% val_score=52.4511 val_score_bestthr=52.4511 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.237, mb=0.494, no=1.002, corr=0.136) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.9547 -> 52.4511
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1913 mb_mean=0.4876 norm_overlap=1.0027 corr_cb=0.1619 topkJ=0.0880
[TRAIN][ep=016] loss=0.8870 acc=66.17%
[TRAIN][ep=016] mask_avg: mc_mean=0.2241 mb_mean=0.4939 norm_overlap=1.0019 corr_cb=0.1075
[EPOCH 016/089] train: loss=0.8870 acc=66.17% | val: loss=0.6934 acc=60.24% f1=68.57% auc=56.05% val_score=62.6392 val_score_bestthr=62.6392 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.224, mb=0.494, no=1.002, corr=0.107) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 61.9547 -> 62.6392
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.2185 mb_mean=0.4928 norm_overlap=1.0031 corr_cb=0.2015 topkJ=0.1133
[TRAIN][ep=017] loss=0.9614 acc=68.46%
[TRAIN][ep=017] mask_avg: mc_mean=0.2161 mb_mean=0.4939 norm_overlap=1.0016 corr_cb=0.0780
[EPOCH 017/089] train: loss=0.9614 acc=68.46% | val: loss=0.6967 acc=57.83% f1=61.54% auc=56.28% val_score=51.5326 val_score_bestthr=51.5326 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.216, mb=0.494, no=1.002, corr=0.078) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6392 -> 51.5326
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.2214 mb_mean=0.4962 norm_overlap=0.9999 corr_cb=-0.0035 topkJ=0.0563
[TRAIN][ep=018] loss=1.0400 acc=70.20%
[TRAIN][ep=018] mask_avg: mc_mean=0.2162 mb_mean=0.4939 norm_overlap=1.0008 corr_cb=0.0333
[EPOCH 018/089] train: loss=1.0400 acc=70.20% | val: loss=0.7109 acc=55.42% f1=56.47% auc=56.10% val_score=50.8607 val_score_bestthr=50.8607 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.216, mb=0.494, no=1.001, corr=0.033) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6392 -> 50.8607
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.2164 mb_mean=0.4994 norm_overlap=0.9976 corr_cb=-0.1378 topkJ=0.0439
[TRAIN][ep=019] loss=1.1186 acc=70.20%
[TRAIN][ep=019] mask_avg: mc_mean=0.2103 mb_mean=0.4939 norm_overlap=1.0004 corr_cb=0.0111
[EPOCH 019/089] train: loss=1.1186 acc=70.20% | val: loss=0.6945 acc=60.24% f1=64.52% auc=57.03% val_score=52.4608 val_score_bestthr=52.4608 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.210, mb=0.494, no=1.000, corr=0.011) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6392 -> 52.4608
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.2450 mb_mean=0.4996 norm_overlap=0.9988 corr_cb=-0.0740 topkJ=0.0555
[TRAIN][ep=020] loss=1.1987 acc=68.99%
[TRAIN][ep=020] mask_avg: mc_mean=0.2217 mb_mean=0.4939 norm_overlap=0.9992 corr_cb=-0.0449
[EPOCH 020/089] train: loss=1.1987 acc=68.99% | val: loss=0.7293 acc=54.22% f1=51.28% auc=57.27% val_score=38.8969 val_score_bestthr=38.8969 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.222, mb=0.494, no=0.999, corr=-0.045) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6392 -> 38.8969
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2189 mb_mean=0.4905 norm_overlap=0.9997 corr_cb=-0.0135 topkJ=0.0558
[TRAIN][ep=021] loss=1.2732 acc=70.60%
[TRAIN][ep=021] mask_avg: mc_mean=0.2138 mb_mean=0.4939 norm_overlap=0.9987 corr_cb=-0.0682
[EPOCH 021/089] train: loss=1.2732 acc=70.60% | val: loss=0.6923 acc=60.24% f1=65.26% auc=57.62% val_score=56.2549 val_score_bestthr=56.2549 | dyn(w_pfs=0.100, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.214, mb=0.494, no=0.999, corr=-0.068) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6392 -> 56.2549
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2347 mb_mean=0.4935 norm_overlap=0.9981 corr_cb=-0.0942 topkJ=0.0513
[TRAIN][ep=022] loss=1.0533 acc=71.54%
[TRAIN][ep=022] mask_avg: mc_mean=0.2142 mb_mean=0.4939 norm_overlap=0.9981 corr_cb=-0.0942
[EPOCH 022/089] train: loss=1.0533 acc=71.54% | val: loss=0.6987 acc=59.04% f1=68.52% auc=58.08% val_score=58.2801 val_score_bestthr=58.2801 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.214, mb=0.494, no=0.998, corr=-0.094) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6392 -> 58.2801
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2563 mb_mean=0.4972 norm_overlap=0.9953 corr_cb=-0.2894 topkJ=0.0244
[TRAIN][ep=023] loss=0.8291 acc=72.48%
[TRAIN][ep=023] mask_avg: mc_mean=0.2286 mb_mean=0.4939 norm_overlap=0.9972 corr_cb=-0.1401
[EPOCH 023/089] train: loss=0.8291 acc=72.48% | val: loss=0.7325 acc=57.83% f1=68.47% auc=58.02% val_score=52.9678 val_score_bestthr=52.9678 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.229, mb=0.494, no=0.997, corr=-0.140) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6392 -> 52.9678
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2686 mb_mean=0.4985 norm_overlap=0.9968 corr_cb=-0.1651 topkJ=0.0167
[TRAIN][ep=024] loss=0.8411 acc=71.01%
[TRAIN][ep=024] mask_avg: mc_mean=0.2297 mb_mean=0.4939 norm_overlap=0.9967 corr_cb=-0.1546
[EPOCH 024/089] train: loss=0.8411 acc=71.01% | val: loss=0.6973 acc=57.83% f1=63.16% auc=58.55% val_score=51.2430 val_score_bestthr=51.2430 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.230, mb=0.494, no=0.997, corr=-0.155) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6392 -> 51.2430
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2364 mb_mean=0.4905 norm_overlap=0.9984 corr_cb=-0.0784 topkJ=0.0470
[TRAIN][ep=025] loss=0.8343 acc=70.60%
[TRAIN][ep=025] mask_avg: mc_mean=0.2497 mb_mean=0.4939 norm_overlap=0.9958 corr_cb=-0.2089
[EPOCH 025/089] train: loss=0.8343 acc=70.60% | val: loss=0.6994 acc=57.83% f1=63.16% auc=58.84% val_score=51.2430 val_score_bestthr=51.2430 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.250, mb=0.494, no=0.996, corr=-0.209) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6392 -> 51.2430
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2189 mb_mean=0.4946 norm_overlap=0.9981 corr_cb=-0.0934 topkJ=0.0265
[TRAIN][ep=026] loss=0.8225 acc=72.62%
[TRAIN][ep=026] mask_avg: mc_mean=0.2357 mb_mean=0.4939 norm_overlap=0.9959 corr_cb=-0.1897
[EPOCH 026/089] train: loss=0.8225 acc=72.62% | val: loss=0.7249 acc=57.83% f1=56.79% auc=59.30% val_score=49.4542 val_score_bestthr=49.4542 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.236, mb=0.494, no=0.996, corr=-0.190) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6392 -> 49.4542
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2236 mb_mean=0.4930 norm_overlap=0.9970 corr_cb=-0.0986 topkJ=0.0325
[TRAIN][ep=027] loss=0.8107 acc=73.42%
[TRAIN][ep=027] mask_avg: mc_mean=0.2460 mb_mean=0.4939 norm_overlap=0.9954 corr_cb=-0.2167
[EPOCH 027/089] train: loss=0.8107 acc=73.42% | val: loss=0.7506 acc=51.81% f1=44.44% auc=59.59% val_score=36.0477 val_score_bestthr=36.0477 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.246, mb=0.494, no=0.995, corr=-0.217) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6392 -> 36.0477
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2235 mb_mean=0.4937 norm_overlap=0.9959 corr_cb=-0.2158 topkJ=0.0296
[TRAIN][ep=028] loss=0.8128 acc=72.89%
[TRAIN][ep=028] mask_avg: mc_mean=0.2521 mb_mean=0.4939 norm_overlap=0.9949 corr_cb=-0.2409
[EPOCH 028/089] train: loss=0.8128 acc=72.89% | val: loss=0.7076 acc=56.63% f1=61.70% auc=59.13% val_score=50.3513 val_score_bestthr=50.3513 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.252, mb=0.494, no=0.995, corr=-0.241) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6392 -> 50.3513
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2658 mb_mean=0.4901 norm_overlap=0.9929 corr_cb=-0.3445 topkJ=0.0122
[TRAIN][ep=029] loss=0.7945 acc=73.15%
[TRAIN][ep=029] mask_avg: mc_mean=0.2554 mb_mean=0.4939 norm_overlap=0.9946 corr_cb=-0.2513
[EPOCH 029/089] train: loss=0.7945 acc=73.15% | val: loss=0.7093 acc=56.63% f1=61.70% auc=59.53% val_score=50.3513 val_score_bestthr=50.3513 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.255, mb=0.494, no=0.995, corr=-0.251) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6392 -> 50.3513
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2347 mb_mean=0.4930 norm_overlap=0.9925 corr_cb=-0.3093 topkJ=0.0104
[TRAIN][ep=030] loss=0.8034 acc=72.48%
[TRAIN][ep=030] mask_avg: mc_mean=0.2428 mb_mean=0.4939 norm_overlap=0.9947 corr_cb=-0.2381
[EPOCH 030/089] train: loss=0.8034 acc=72.48% | val: loss=0.7107 acc=56.63% f1=61.70% auc=59.24% val_score=50.3513 val_score_bestthr=50.3513 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.243, mb=0.494, no=0.995, corr=-0.238) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6392 -> 50.3513
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2340 mb_mean=0.4940 norm_overlap=0.9979 corr_cb=-0.0776 topkJ=0.0383
[TRAIN][ep=031] loss=0.7987 acc=72.62%
[TRAIN][ep=031] mask_avg: mc_mean=0.2490 mb_mean=0.4939 norm_overlap=0.9945 corr_cb=-0.2523
[EPOCH 031/089] train: loss=0.7987 acc=72.62% | val: loss=0.7187 acc=59.04% f1=61.36% auc=60.00% val_score=47.4968 val_score_bestthr=47.4968 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.249, mb=0.494, no=0.994, corr=-0.252) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6392 -> 47.4968
[DBG][ep=032] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2753 mb_mean=0.4935 norm_overlap=0.9933 corr_cb=-0.3047 topkJ=0.0255
[TRAIN][ep=032] loss=0.7971 acc=73.42%
[TRAIN][ep=032] mask_avg: mc_mean=0.2436 mb_mean=0.4939 norm_overlap=0.9945 corr_cb=-0.2467
[EPOCH 032/089] train: loss=0.7971 acc=73.42% | val: loss=0.7271 acc=55.42% f1=56.47% auc=59.77% val_score=42.6548 val_score_bestthr=42.6548 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.244, mb=0.494, no=0.994, corr=-0.247) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6392 -> 42.6548
[DBG][ep=033] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2529 mb_mean=0.4981 norm_overlap=0.9940 corr_cb=-0.2974 topkJ=0.0371
[TRAIN][ep=033] loss=0.7806 acc=73.96%
[TRAIN][ep=033] mask_avg: mc_mean=0.2423 mb_mean=0.4939 norm_overlap=0.9945 corr_cb=-0.2458
[EPOCH 033/089] train: loss=0.7806 acc=73.96% | val: loss=0.7195 acc=59.04% f1=61.36% auc=60.41% val_score=47.4968 val_score_bestthr=47.4968 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.242, mb=0.494, no=0.994, corr=-0.246) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6392 -> 47.4968
[DBG][ep=034] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2261 mb_mean=0.4891 norm_overlap=0.9943 corr_cb=-0.2375 topkJ=0.0318
[TRAIN][ep=034] loss=0.7695 acc=75.84%
[TRAIN][ep=034] mask_avg: mc_mean=0.2557 mb_mean=0.4939 norm_overlap=0.9942 corr_cb=-0.2604
[EPOCH 034/089] train: loss=0.7695 acc=75.84% | val: loss=0.7265 acc=59.04% f1=60.47% auc=60.87% val_score=49.5542 val_score_bestthr=49.5542 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.256, mb=0.494, no=0.994, corr=-0.260) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6392 -> 49.5542
[DBG][ep=035] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2276 mb_mean=0.4998 norm_overlap=0.9937 corr_cb=-0.2821 topkJ=0.0178
[TRAIN][ep=035] loss=0.7591 acc=75.70%
[TRAIN][ep=035] mask_avg: mc_mean=0.2578 mb_mean=0.4939 norm_overlap=0.9939 corr_cb=-0.2730
[EPOCH 035/089] train: loss=0.7591 acc=75.70% | val: loss=0.7262 acc=55.42% f1=58.43% auc=60.29% val_score=49.0340 val_score_bestthr=49.0340 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.258, mb=0.494, no=0.994, corr=-0.273) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6392 -> 49.0340
[DBG][ep=036] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2802 mb_mean=0.4939 norm_overlap=0.9950 corr_cb=-0.2487 topkJ=0.0328
[TRAIN][ep=036] loss=0.7613 acc=74.36%
[TRAIN][ep=036] mask_avg: mc_mean=0.2683 mb_mean=0.4939 norm_overlap=0.9936 corr_cb=-0.2911
[EPOCH 036/089] train: loss=0.7613 acc=74.36% | val: loss=0.7347 acc=55.42% f1=57.47% auc=59.77% val_score=50.8742 val_score_bestthr=50.8742 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.268, mb=0.494, no=0.994, corr=-0.291) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6392 -> 50.8742
[DBG][ep=037] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.2455 mb_mean=0.4988 norm_overlap=0.9927 corr_cb=-0.3273 topkJ=0.0176
[TRAIN][ep=037] loss=0.7446 acc=76.64%
[TRAIN][ep=037] mask_avg: mc_mean=0.2692 mb_mean=0.4939 norm_overlap=0.9934 corr_cb=-0.2952
[EPOCH 037/089] train: loss=0.7446 acc=76.64% | val: loss=0.7806 acc=54.22% f1=48.65% auc=60.35% val_score=49.6854 val_score_bestthr=49.6854 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.269, mb=0.494, no=0.993, corr=-0.295) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6392 -> 49.6854
[DBG][ep=038] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.3437 mb_mean=0.4887 norm_overlap=0.9920 corr_cb=-0.3559 topkJ=0.0174
[TRAIN][ep=038] loss=0.7612 acc=74.77%
[TRAIN][ep=038] mask_avg: mc_mean=0.2636 mb_mean=0.4939 norm_overlap=0.9938 corr_cb=-0.2752
[EPOCH 038/089] train: loss=0.7612 acc=74.77% | val: loss=0.7359 acc=54.22% f1=57.78% auc=60.00% val_score=47.9318 val_score_bestthr=47.9318 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.264, mb=0.494, no=0.994, corr=-0.275) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6392 -> 47.9318
[DBG][ep=039] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2724 mb_mean=0.4974 norm_overlap=0.9916 corr_cb=-0.3809 topkJ=0.0100
[TRAIN][ep=039] loss=0.7377 acc=78.12%
[TRAIN][ep=039] mask_avg: mc_mean=0.2609 mb_mean=0.4939 norm_overlap=0.9934 corr_cb=-0.2880
[EPOCH 039/089] train: loss=0.7377 acc=78.12% | val: loss=0.7380 acc=53.01% f1=58.06% auc=60.47% val_score=46.0011 val_score_bestthr=46.0011 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.261, mb=0.494, no=0.993, corr=-0.288) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6392 -> 46.0011
[DBG][ep=040] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.2397 mb_mean=0.4958 norm_overlap=0.9952 corr_cb=-0.2343 topkJ=0.0287
[TRAIN][ep=040] loss=0.7374 acc=77.18%
[TRAIN][ep=040] mask_avg: mc_mean=0.2589 mb_mean=0.4939 norm_overlap=0.9936 corr_cb=-0.2825
[EPOCH 040/089] train: loss=0.7374 acc=77.18% | val: loss=0.7494 acc=57.83% f1=57.83% auc=60.93% val_score=53.5179 val_score_bestthr=53.5179 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.259, mb=0.494, no=0.994, corr=-0.283) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6392 -> 53.5179
[DBG][ep=041] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.2422 mb_mean=0.5013 norm_overlap=0.9947 corr_cb=-0.2319 topkJ=0.0267
[TRAIN][ep=041] loss=0.7420 acc=76.11%
[TRAIN][ep=041] mask_avg: mc_mean=0.2827 mb_mean=0.4939 norm_overlap=0.9931 corr_cb=-0.3131
[EPOCH 041/089] train: loss=0.7420 acc=76.11% | val: loss=0.7495 acc=56.63% f1=63.27% auc=60.12% val_score=52.6442 val_score_bestthr=52.6442 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.283, mb=0.494, no=0.993, corr=-0.313) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6392 -> 52.6442
[DBG][ep=042] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.2938 mb_mean=0.4932 norm_overlap=0.9916 corr_cb=-0.3704 topkJ=0.0171
[TRAIN][ep=042] loss=0.7469 acc=75.30%
[TRAIN][ep=042] mask_avg: mc_mean=0.2383 mb_mean=0.4939 norm_overlap=0.9941 corr_cb=-0.2414
[EPOCH 042/089] train: loss=0.7469 acc=75.30% | val: loss=0.7510 acc=57.83% f1=56.79% auc=61.05% val_score=50.6024 val_score_bestthr=50.6024 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.238, mb=0.494, no=0.994, corr=-0.241) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6392 -> 50.6024
[DBG][ep=043] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.2876 mb_mean=0.4933 norm_overlap=0.9961 corr_cb=-0.1561 topkJ=0.0634
[TRAIN][ep=043] loss=0.7269 acc=77.05%
[TRAIN][ep=043] mask_avg: mc_mean=0.2707 mb_mean=0.4939 norm_overlap=0.9933 corr_cb=-0.2933
[EPOCH 043/089] train: loss=0.7269 acc=77.05% | val: loss=0.7601 acc=57.83% f1=55.70% auc=61.57% val_score=52.6305 val_score_bestthr=52.6305 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.271, mb=0.494, no=0.993, corr=-0.293) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6392 -> 52.6305
[DBG][ep=044] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2582 mb_mean=0.4929 norm_overlap=0.9912 corr_cb=-0.3306 topkJ=0.0124
[TRAIN][ep=044] loss=0.7199 acc=78.93%
[TRAIN][ep=044] mask_avg: mc_mean=0.2716 mb_mean=0.4939 norm_overlap=0.9936 corr_cb=-0.2767
[EPOCH 044/089] train: loss=0.7199 acc=78.93% | val: loss=0.9201 acc=56.63% f1=40.00% auc=61.40% val_score=45.5260 val_score_bestthr=45.5260 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.272, mb=0.494, no=0.994, corr=-0.277) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6392 -> 45.5260
[DBG][ep=045] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2163 mb_mean=0.4904 norm_overlap=0.9975 corr_cb=-0.0948 topkJ=0.0367
[TRAIN][ep=045] loss=0.7153 acc=79.06%
[TRAIN][ep=045] mask_avg: mc_mean=0.2617 mb_mean=0.4939 norm_overlap=0.9936 corr_cb=-0.2750
[EPOCH 045/089] train: loss=0.7153 acc=79.06% | val: loss=0.7591 acc=57.83% f1=57.83% auc=61.22% val_score=50.8423 val_score_bestthr=50.8423 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.262, mb=0.494, no=0.994, corr=-0.275) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6392 -> 50.8423
[DBG][ep=046] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.3070 mb_mean=0.4850 norm_overlap=0.9960 corr_cb=-0.2464 topkJ=0.0488
[TRAIN][ep=046] loss=0.6952 acc=78.93%
[TRAIN][ep=046] mask_avg: mc_mean=0.2797 mb_mean=0.4939 norm_overlap=0.9932 corr_cb=-0.2977
[EPOCH 046/089] train: loss=0.6952 acc=78.93% | val: loss=0.7917 acc=55.42% f1=51.95% auc=62.03% val_score=49.7819 val_score_bestthr=49.7819 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.280, mb=0.494, no=0.993, corr=-0.298) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.6392 -> 49.7819
[EARLY STOP] no improvement for 30 epochs. best_epoch=16
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
=============== FIT DONE ===============
[BEST] epoch=16 | val_acc=60.24% | val_f1=68.57% | val_auc=56.05% | val_score=62.6392 | val_score_bestthr=62.6392
[TEST@BEST] thr_used=0.450 | acc=58.45% f1=65.87% auc=63.93% | SP_sex=12.96% EO_sex=13.55% SP_age=16.50% EO_age=21.03%
[TIME] 1.10 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold1_rep1_seed1001/summary_fold_1.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5240 mb_mean=0.4945 norm_overlap=1.0001 corr_cb=0.1063 topkJ=0.0892
[TRAIN][ep=000] loss=0.6959 acc=50.74%
[TRAIN][ep=000] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0637
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5198 mb_mean=0.4964 norm_overlap=1.0000 corr_cb=0.0020 topkJ=0.1618
[TRAIN][ep=001] loss=0.6934 acc=50.07%
[TRAIN][ep=001] mask_avg: mc_mean=0.5235 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0636
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5264 mb_mean=0.4883 norm_overlap=1.0000 corr_cb=0.0372 topkJ=0.1146
[TRAIN][ep=002] loss=0.6920 acc=52.75%
[TRAIN][ep=002] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0591
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5240 mb_mean=0.4973 norm_overlap=0.9999 corr_cb=-0.1065 topkJ=0.0757
[TRAIN][ep=003] loss=0.6908 acc=52.21%
[TRAIN][ep=003] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0640
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5252 mb_mean=0.4946 norm_overlap=1.0001 corr_cb=0.0693 topkJ=0.1075
[TRAIN][ep=004] loss=0.6888 acc=55.84%
[TRAIN][ep=004] mask_avg: mc_mean=0.5235 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0728
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5254 mb_mean=0.4873 norm_overlap=0.9996 corr_cb=-0.3571 topkJ=0.0700
[TRAIN][ep=005] loss=0.6885 acc=57.05%
[TRAIN][ep=005] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0579
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5240 mb_mean=0.4920 norm_overlap=0.9998 corr_cb=-0.2417 topkJ=0.0358
[TRAIN][ep=006] loss=0.6843 acc=57.05%
[TRAIN][ep=006] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0643
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5236 mb_mean=0.4973 norm_overlap=1.0000 corr_cb=0.0089 topkJ=0.0999
[TRAIN][ep=007] loss=0.6810 acc=59.87%
[TRAIN][ep=007] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0694
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5205 mb_mean=0.4927 norm_overlap=0.9997 corr_cb=-0.2425 topkJ=0.0796
[TRAIN][ep=008] loss=0.6817 acc=56.24%
[TRAIN][ep=008] mask_avg: mc_mean=0.5235 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0663
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5252 mb_mean=0.4985 norm_overlap=1.0001 corr_cb=0.1253 topkJ=0.1968
[TRAIN][ep=009] loss=0.6774 acc=58.12%
[TRAIN][ep=009] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0649
================= FIT START (fold=1) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5254 mb_mean=0.4911 norm_overlap=0.9999 corr_cb=-0.1383 topkJ=0.0522
[TRAIN][ep=000] loss=0.6719 acc=60.81%
[TRAIN][ep=000] mask_avg: mc_mean=0.5235 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0647
[EPOCH 000/089] train: loss=0.6719 acc=60.81% | val: loss=0.6893 acc=57.83% f1=71.07% auc=54.94% val_score=57.9692 val_score_bestthr=63.1205 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.065) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 63.1205
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5232 mb_mean=0.4969 norm_overlap=0.9998 corr_cb=-0.2445 topkJ=0.0792
[TRAIN][ep=001] loss=0.6712 acc=59.19%
[TRAIN][ep=001] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0653
[EPOCH 001/089] train: loss=0.6712 acc=59.19% | val: loss=0.6878 acc=63.86% f1=71.15% auc=53.78% val_score=50.1238 val_score_bestthr=66.6380 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.065) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 63.1205 -> 66.6380
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5251 mb_mean=0.4886 norm_overlap=1.0000 corr_cb=-0.0238 topkJ=0.0802
[TRAIN][ep=002] loss=0.6667 acc=61.61%
[TRAIN][ep=002] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0672
[EPOCH 002/089] train: loss=0.6667 acc=61.61% | val: loss=0.6871 acc=62.65% f1=68.69% auc=54.13% val_score=60.1191 val_score_bestthr=61.2270 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.067) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.2270
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5203 mb_mean=0.4927 norm_overlap=1.0000 corr_cb=-0.0206 topkJ=0.0508
[TRAIN][ep=003] loss=0.6613 acc=61.34%
[TRAIN][ep=003] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0645
[EPOCH 003/089] train: loss=0.6613 acc=61.34% | val: loss=0.6909 acc=60.24% f1=71.30% auc=55.00% val_score=54.6289 val_score_bestthr=59.4663 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.064) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 59.4663
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5239 mb_mean=0.4918 norm_overlap=0.9998 corr_cb=-0.2595 topkJ=0.0761
[TRAIN][ep=004] loss=0.6592 acc=63.49%
[TRAIN][ep=004] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0632
[EPOCH 004/089] train: loss=0.6592 acc=63.49% | val: loss=0.6871 acc=61.45% f1=70.91% auc=55.12% val_score=60.1191 val_score_bestthr=63.5375 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.063) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 63.5375
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5228 mb_mean=0.4934 norm_overlap=0.9999 corr_cb=-0.0737 topkJ=0.0499
[TRAIN][ep=005] loss=1.3557 acc=61.21%
[TRAIN][ep=005] mask_avg: mc_mean=0.3735 mb_mean=0.4939 norm_overlap=1.0030 corr_cb=0.5953
[EPOCH 005/089] train: loss=1.3557 acc=61.21% | val: loss=0.6879 acc=61.45% f1=68.63% auc=55.06% val_score=41.1688 val_score_bestthr=62.5080 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.373, mb=0.494, no=1.003, corr=0.595) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 62.5080
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2943 mb_mean=0.4966 norm_overlap=1.0049 corr_cb=0.6713 topkJ=0.2060
[TRAIN][ep=006] loss=1.3376 acc=64.43%
[TRAIN][ep=006] mask_avg: mc_mean=0.2876 mb_mean=0.4939 norm_overlap=1.0047 corr_cb=0.6126
[EPOCH 006/089] train: loss=1.3376 acc=64.43% | val: loss=0.6853 acc=62.65% f1=68.69% auc=55.41% val_score=46.4584 val_score_bestthr=61.2270 | dyn(w_pfs=0.240, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.288, mb=0.494, no=1.005, corr=0.613) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.2270
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2809 mb_mean=0.4963 norm_overlap=1.0043 corr_cb=0.5789 topkJ=0.1958
[TRAIN][ep=007] loss=1.1494 acc=64.56%
[TRAIN][ep=007] mask_avg: mc_mean=0.2713 mb_mean=0.4939 norm_overlap=1.0048 corr_cb=0.5701
[EPOCH 007/089] train: loss=1.1494 acc=64.56% | val: loss=0.6885 acc=59.04% f1=71.19% auc=56.22% val_score=52.0294 val_score_bestthr=61.8550 | dyn(w_pfs=0.140, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.271, mb=0.494, no=1.005, corr=0.570) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.8550
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2740 mb_mean=0.4944 norm_overlap=1.0037 corr_cb=0.4563 topkJ=0.1583
[TRAIN][ep=008] loss=0.9620 acc=61.74%
[TRAIN][ep=008] mask_avg: mc_mean=0.2639 mb_mean=0.4939 norm_overlap=1.0047 corr_cb=0.5298
[EPOCH 008/089] train: loss=0.9620 acc=61.74% | val: loss=0.6918 acc=63.86% f1=70.00% auc=55.70% val_score=41.3202 val_score_bestthr=64.4904 | dyn(w_pfs=0.040, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.264, mb=0.494, no=1.005, corr=0.530) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 64.4904
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2678 mb_mean=0.4943 norm_overlap=1.0035 corr_cb=0.4367 topkJ=0.1362
[TRAIN][ep=009] loss=0.9205 acc=64.03%
[TRAIN][ep=009] mask_avg: mc_mean=0.2616 mb_mean=0.4939 norm_overlap=1.0043 corr_cb=0.4574
[EPOCH 009/089] train: loss=0.9205 acc=64.03% | val: loss=0.6900 acc=62.65% f1=69.31% auc=55.58% val_score=53.4797 val_score_bestthr=64.0147 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.262, mb=0.494, no=1.004, corr=0.457) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 64.0147
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.2323 mb_mean=0.4924 norm_overlap=1.0060 corr_cb=0.4723 topkJ=0.0886
[TRAIN][ep=010] loss=0.9073 acc=65.10%
[TRAIN][ep=010] mask_avg: mc_mean=0.2510 mb_mean=0.4939 norm_overlap=1.0041 corr_cb=0.3909
[EPOCH 010/089] train: loss=0.9073 acc=65.10% | val: loss=0.6917 acc=61.45% f1=69.23% auc=55.93% val_score=58.1393 val_score_bestthr=63.0116 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.251, mb=0.494, no=1.004, corr=0.391) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 63.0116
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.2400 mb_mean=0.4897 norm_overlap=1.0083 corr_cb=0.5216 topkJ=0.0927
[TRAIN][ep=011] loss=0.8935 acc=65.23%
[TRAIN][ep=011] mask_avg: mc_mean=0.2474 mb_mean=0.4939 norm_overlap=1.0034 corr_cb=0.3050
[EPOCH 011/089] train: loss=0.8935 acc=65.23% | val: loss=0.6904 acc=62.65% f1=69.90% auc=56.28% val_score=58.1875 val_score_bestthr=64.5172 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.247, mb=0.494, no=1.003, corr=0.305) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 64.5172
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.2226 mb_mean=0.4961 norm_overlap=1.0025 corr_cb=0.2712 topkJ=0.1202
[TRAIN][ep=012] loss=0.8958 acc=66.31%
[TRAIN][ep=012] mask_avg: mc_mean=0.2363 mb_mean=0.4939 norm_overlap=1.0032 corr_cb=0.2568
[EPOCH 012/089] train: loss=0.8958 acc=66.31% | val: loss=0.6887 acc=60.24% f1=68.57% auc=57.33% val_score=59.6943 val_score_bestthr=62.6392 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.236, mb=0.494, no=1.003, corr=0.257) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 62.6392
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.2281 mb_mean=0.4893 norm_overlap=1.0033 corr_cb=0.3156 topkJ=0.0882
[TRAIN][ep=013] loss=0.8895 acc=67.92%
[TRAIN][ep=013] mask_avg: mc_mean=0.2410 mb_mean=0.4939 norm_overlap=1.0021 corr_cb=0.1645
[EPOCH 013/089] train: loss=0.8895 acc=67.92% | val: loss=0.6885 acc=62.65% f1=69.90% auc=57.03% val_score=63.1662 val_score_bestthr=64.5172 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.241, mb=0.494, no=1.002, corr=0.164) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 64.5172
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.2231 mb_mean=0.4938 norm_overlap=1.0014 corr_cb=0.1409 topkJ=0.1470
[TRAIN][ep=014] loss=0.8675 acc=70.87%
[TRAIN][ep=014] mask_avg: mc_mean=0.2342 mb_mean=0.4939 norm_overlap=1.0014 corr_cb=0.1049
[EPOCH 014/089] train: loss=0.8675 acc=70.87% | val: loss=0.7135 acc=59.04% f1=68.52% auc=56.45% val_score=36.4447 val_score_bestthr=63.1844 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.234, mb=0.494, no=1.001, corr=0.105) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 63.1844
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.2198 mb_mean=0.4908 norm_overlap=1.0039 corr_cb=0.2508 topkJ=0.0755
[TRAIN][ep=015] loss=0.8648 acc=68.86%
[TRAIN][ep=015] mask_avg: mc_mean=0.2337 mb_mean=0.4939 norm_overlap=1.0005 corr_cb=0.0331
[EPOCH 015/089] train: loss=0.8648 acc=68.86% | val: loss=0.6947 acc=65.06% f1=70.10% auc=58.84% val_score=65.4198 val_score_bestthr=65.9325 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.234, mb=0.494, no=1.001, corr=0.033) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 65.9325
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1970 mb_mean=0.4876 norm_overlap=1.0008 corr_cb=0.0534 topkJ=0.0630
[TRAIN][ep=016] loss=0.8596 acc=69.80%
[TRAIN][ep=016] mask_avg: mc_mean=0.2232 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0153
[EPOCH 016/089] train: loss=0.8596 acc=69.80% | val: loss=0.6900 acc=63.86% f1=69.39% auc=58.72% val_score=47.8737 val_score_bestthr=65.4198 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.223, mb=0.494, no=1.000, corr=-0.015) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 65.4198
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.2223 mb_mean=0.4928 norm_overlap=1.0006 corr_cb=0.0418 topkJ=0.0604
[TRAIN][ep=017] loss=0.8413 acc=71.54%
[TRAIN][ep=017] mask_avg: mc_mean=0.2309 mb_mean=0.4939 norm_overlap=0.9987 corr_cb=-0.0790
[EPOCH 017/089] train: loss=0.8413 acc=71.54% | val: loss=0.6908 acc=61.45% f1=69.23% auc=58.78% val_score=48.6574 val_score_bestthr=63.0991 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.231, mb=0.494, no=0.999, corr=-0.079) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 63.0991
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.2345 mb_mean=0.4962 norm_overlap=0.9981 corr_cb=-0.1302 topkJ=0.0329
[TRAIN][ep=018] loss=0.8320 acc=71.14%
[TRAIN][ep=018] mask_avg: mc_mean=0.2419 mb_mean=0.4939 norm_overlap=0.9977 corr_cb=-0.1366
[EPOCH 018/089] train: loss=0.8320 acc=71.14% | val: loss=0.7167 acc=59.04% f1=67.92% auc=58.95% val_score=34.9133 val_score_bestthr=62.0758 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.242, mb=0.494, no=0.998, corr=-0.137) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 62.0758
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.2344 mb_mean=0.4994 norm_overlap=0.9954 corr_cb=-0.2839 topkJ=0.0205
[TRAIN][ep=019] loss=0.8233 acc=71.41%
[TRAIN][ep=019] mask_avg: mc_mean=0.2274 mb_mean=0.4939 norm_overlap=0.9975 corr_cb=-0.1324
[EPOCH 019/089] train: loss=0.8233 acc=71.41% | val: loss=0.6941 acc=61.45% f1=68.00% auc=59.65% val_score=48.4271 val_score_bestthr=62.7735 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.227, mb=0.494, no=0.998, corr=-0.132) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 62.7735
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.2920 mb_mean=0.4996 norm_overlap=0.9957 corr_cb=-0.2603 topkJ=0.0225
[TRAIN][ep=020] loss=0.8230 acc=72.62%
[TRAIN][ep=020] mask_avg: mc_mean=0.2672 mb_mean=0.4939 norm_overlap=0.9962 corr_cb=-0.2087
[EPOCH 020/089] train: loss=0.8230 acc=72.62% | val: loss=0.7605 acc=60.24% f1=69.72% auc=60.93% val_score=40.9847 val_score_bestthr=61.6224 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.267, mb=0.494, no=0.996, corr=-0.209) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.6224
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2179 mb_mean=0.4905 norm_overlap=0.9982 corr_cb=-0.0790 topkJ=0.0344
[TRAIN][ep=021] loss=0.8048 acc=72.48%
[TRAIN][ep=021] mask_avg: mc_mean=0.2380 mb_mean=0.4939 norm_overlap=0.9965 corr_cb=-0.1740
[EPOCH 021/089] train: loss=0.8048 acc=72.48% | val: loss=0.6999 acc=62.65% f1=71.03% auc=59.59% val_score=47.8820 val_score_bestthr=60.4643 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.238, mb=0.494, no=0.996, corr=-0.174) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 60.4643
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2540 mb_mean=0.4935 norm_overlap=0.9962 corr_cb=-0.1842 topkJ=0.0364
[TRAIN][ep=022] loss=0.7966 acc=72.89%
[TRAIN][ep=022] mask_avg: mc_mean=0.2356 mb_mean=0.4939 norm_overlap=0.9962 corr_cb=-0.1782
[EPOCH 022/089] train: loss=0.7966 acc=72.89% | val: loss=0.7121 acc=57.83% f1=70.59% auc=60.12% val_score=53.1065 val_score_bestthr=61.6332 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.236, mb=0.494, no=0.996, corr=-0.178) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.6332
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2751 mb_mean=0.4972 norm_overlap=0.9956 corr_cb=-0.2566 topkJ=0.0300
[TRAIN][ep=023] loss=0.7777 acc=76.64%
[TRAIN][ep=023] mask_avg: mc_mean=0.2615 mb_mean=0.4939 norm_overlap=0.9953 corr_cb=-0.2312
[EPOCH 023/089] train: loss=0.7777 acc=76.64% | val: loss=0.7689 acc=61.45% f1=70.91% auc=59.59% val_score=55.2954 val_score_bestthr=58.6352 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.261, mb=0.494, no=0.995, corr=-0.231) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 58.6352
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2710 mb_mean=0.4985 norm_overlap=0.9950 corr_cb=-0.2560 topkJ=0.0183
[TRAIN][ep=024] loss=0.7934 acc=73.96%
[TRAIN][ep=024] mask_avg: mc_mean=0.2218 mb_mean=0.4939 norm_overlap=0.9963 corr_cb=-0.1615
[EPOCH 024/089] train: loss=0.7934 acc=73.96% | val: loss=0.7092 acc=63.86% f1=71.70% auc=60.17% val_score=44.1225 val_score_bestthr=61.6312 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.222, mb=0.494, no=0.996, corr=-0.162) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.6312
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2623 mb_mean=0.4905 norm_overlap=0.9967 corr_cb=-0.1605 topkJ=0.0325
[TRAIN][ep=025] loss=0.7927 acc=73.15%
[TRAIN][ep=025] mask_avg: mc_mean=0.2574 mb_mean=0.4939 norm_overlap=0.9953 corr_cb=-0.2205
[EPOCH 025/089] train: loss=0.7927 acc=73.15% | val: loss=0.7129 acc=62.65% f1=71.03% auc=60.12% val_score=49.1094 val_score_bestthr=60.4643 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.257, mb=0.494, no=0.995, corr=-0.220) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 60.4643
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2380 mb_mean=0.4946 norm_overlap=0.9972 corr_cb=-0.1450 topkJ=0.0366
[TRAIN][ep=026] loss=0.7626 acc=75.84%
[TRAIN][ep=026] mask_avg: mc_mean=0.2527 mb_mean=0.4939 norm_overlap=0.9951 corr_cb=-0.2209
[EPOCH 026/089] train: loss=0.7626 acc=75.84% | val: loss=0.7201 acc=62.65% f1=71.03% auc=60.35% val_score=54.1786 val_score_bestthr=60.4643 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.253, mb=0.494, no=0.995, corr=-0.221) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 60.4643
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2496 mb_mean=0.4930 norm_overlap=0.9925 corr_cb=-0.2627 topkJ=0.0115
[TRAIN][ep=027] loss=0.7551 acc=75.03%
[TRAIN][ep=027] mask_avg: mc_mean=0.2658 mb_mean=0.4939 norm_overlap=0.9949 corr_cb=-0.2386
[EPOCH 027/089] train: loss=0.7551 acc=75.03% | val: loss=0.7343 acc=63.86% f1=71.70% auc=61.22% val_score=54.5969 val_score_bestthr=61.6312 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.266, mb=0.494, no=0.995, corr=-0.239) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.6312
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2844 mb_mean=0.4937 norm_overlap=0.9951 corr_cb=-0.2896 topkJ=0.0231
[TRAIN][ep=028] loss=0.7575 acc=76.38%
[TRAIN][ep=028] mask_avg: mc_mean=0.2744 mb_mean=0.4939 norm_overlap=0.9947 corr_cb=-0.2536
[EPOCH 028/089] train: loss=0.7575 acc=76.38% | val: loss=0.7422 acc=59.04% f1=70.69% auc=61.63% val_score=49.9659 val_score_bestthr=65.0554 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.274, mb=0.494, no=0.995, corr=-0.254) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 65.0554
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2265 mb_mean=0.4901 norm_overlap=0.9944 corr_cb=-0.2385 topkJ=0.0264
[TRAIN][ep=029] loss=0.7463 acc=77.05%
[TRAIN][ep=029] mask_avg: mc_mean=0.2761 mb_mean=0.4939 norm_overlap=0.9948 corr_cb=-0.2457
[EPOCH 029/089] train: loss=0.7463 acc=77.05% | val: loss=0.7283 acc=60.24% f1=67.96% auc=60.93% val_score=53.5121 val_score_bestthr=61.4205 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.276, mb=0.494, no=0.995, corr=-0.246) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.4205
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2817 mb_mean=0.4930 norm_overlap=0.9939 corr_cb=-0.2681 topkJ=0.0197
[TRAIN][ep=030] loss=0.7387 acc=77.72%
[TRAIN][ep=030] mask_avg: mc_mean=0.2555 mb_mean=0.4939 norm_overlap=0.9950 corr_cb=-0.2245
[EPOCH 030/089] train: loss=0.7387 acc=77.72% | val: loss=0.7533 acc=61.45% f1=69.23% auc=60.41% val_score=48.5423 val_score_bestthr=61.6737 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.255, mb=0.494, no=0.995, corr=-0.224) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.6737
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2673 mb_mean=0.4940 norm_overlap=0.9961 corr_cb=-0.1513 topkJ=0.0422
[TRAIN][ep=031] loss=0.7211 acc=78.12%
[TRAIN][ep=031] mask_avg: mc_mean=0.2606 mb_mean=0.4939 norm_overlap=0.9949 corr_cb=-0.2299
[EPOCH 031/089] train: loss=0.7211 acc=78.12% | val: loss=0.7442 acc=60.24% f1=70.80% auc=61.22% val_score=45.9740 val_score_bestthr=62.0678 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.261, mb=0.494, no=0.995, corr=-0.230) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 62.0678
[EARLY STOP] no improvement for 30 epochs. best_epoch=1
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
=============== FIT DONE ===============
[BEST] epoch=1 | val_acc=63.86% | val_f1=71.15% | val_auc=53.78% | val_score=50.1238 | val_score_bestthr=66.6380
[TEST@BEST] thr_used=0.470 | acc=55.56% f1=63.78% auc=60.63% | SP_sex=5.56% EO_sex=19.12% SP_age=2.71% EO_age=14.10%
[TIME] 0.80 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold1_rep1_seed1001/summary_fold_1.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5240 mb_mean=0.4945 norm_overlap=1.0001 corr_cb=0.1063 topkJ=0.0892
[TRAIN][ep=000] loss=0.6959 acc=50.74%
[TRAIN][ep=000] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0637
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5198 mb_mean=0.4964 norm_overlap=1.0000 corr_cb=0.0020 topkJ=0.1618
[TRAIN][ep=001] loss=0.6934 acc=50.07%
[TRAIN][ep=001] mask_avg: mc_mean=0.5235 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0636
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5264 mb_mean=0.4883 norm_overlap=1.0000 corr_cb=0.0372 topkJ=0.1146
[TRAIN][ep=002] loss=0.6920 acc=52.75%
[TRAIN][ep=002] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0591
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5240 mb_mean=0.4973 norm_overlap=0.9999 corr_cb=-0.1065 topkJ=0.0757
[TRAIN][ep=003] loss=0.6908 acc=52.21%
[TRAIN][ep=003] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0640
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5252 mb_mean=0.4946 norm_overlap=1.0001 corr_cb=0.0693 topkJ=0.1075
[TRAIN][ep=004] loss=0.6888 acc=55.84%
[TRAIN][ep=004] mask_avg: mc_mean=0.5235 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0728
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5254 mb_mean=0.4873 norm_overlap=0.9996 corr_cb=-0.3571 topkJ=0.0700
[TRAIN][ep=005] loss=0.6885 acc=57.05%
[TRAIN][ep=005] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0579
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5240 mb_mean=0.4920 norm_overlap=0.9998 corr_cb=-0.2417 topkJ=0.0358
[TRAIN][ep=006] loss=0.6843 acc=57.05%
[TRAIN][ep=006] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0643
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5236 mb_mean=0.4973 norm_overlap=1.0000 corr_cb=0.0089 topkJ=0.0999
[TRAIN][ep=007] loss=0.6810 acc=59.87%
[TRAIN][ep=007] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0694
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5205 mb_mean=0.4927 norm_overlap=0.9997 corr_cb=-0.2425 topkJ=0.0796
[TRAIN][ep=008] loss=0.6817 acc=56.24%
[TRAIN][ep=008] mask_avg: mc_mean=0.5235 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0663
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5252 mb_mean=0.4985 norm_overlap=1.0001 corr_cb=0.1253 topkJ=0.1968
[TRAIN][ep=009] loss=0.6774 acc=58.12%
[TRAIN][ep=009] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0649
================= FIT START (fold=1) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5254 mb_mean=0.4911 norm_overlap=0.9999 corr_cb=-0.1383 topkJ=0.0522
[TRAIN][ep=000] loss=0.6719 acc=60.81%
[TRAIN][ep=000] mask_avg: mc_mean=0.5235 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0647
[EPOCH 000/089] train: loss=0.6719 acc=60.81% | val: loss=0.6893 acc=57.83% f1=71.07% auc=55.00% val_score=57.9692 val_score_bestthr=63.1205 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.065) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 63.1205
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5232 mb_mean=0.4969 norm_overlap=0.9998 corr_cb=-0.2445 topkJ=0.0792
[TRAIN][ep=001] loss=0.6712 acc=59.19%
[TRAIN][ep=001] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0653
[EPOCH 001/089] train: loss=0.6712 acc=59.19% | val: loss=0.6878 acc=63.86% f1=71.15% auc=53.78% val_score=50.1238 val_score_bestthr=66.6380 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.065) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 63.1205 -> 66.6380
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5251 mb_mean=0.4886 norm_overlap=1.0000 corr_cb=-0.0238 topkJ=0.0802
[TRAIN][ep=002] loss=0.6667 acc=61.61%
[TRAIN][ep=002] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0672
[EPOCH 002/089] train: loss=0.6667 acc=61.61% | val: loss=0.6871 acc=62.65% f1=68.69% auc=54.13% val_score=60.1191 val_score_bestthr=61.2270 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.067) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.2270
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5203 mb_mean=0.4927 norm_overlap=1.0000 corr_cb=-0.0206 topkJ=0.0508
[TRAIN][ep=003] loss=0.6612 acc=61.48%
[TRAIN][ep=003] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0645
[EPOCH 003/089] train: loss=0.6612 acc=61.48% | val: loss=0.6909 acc=61.45% f1=71.93% auc=55.00% val_score=54.6289 val_score_bestthr=62.0849 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.064) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 62.0849
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5239 mb_mean=0.4918 norm_overlap=0.9998 corr_cb=-0.2595 topkJ=0.0761
[TRAIN][ep=004] loss=0.6592 acc=63.36%
[TRAIN][ep=004] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0632
[EPOCH 004/089] train: loss=0.6592 acc=63.36% | val: loss=0.6871 acc=61.45% f1=70.91% auc=55.17% val_score=60.1191 val_score_bestthr=63.5375 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.063) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 63.5375
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5228 mb_mean=0.4934 norm_overlap=0.9999 corr_cb=-0.0737 topkJ=0.0499
[TRAIN][ep=005] loss=1.5330 acc=61.21%
[TRAIN][ep=005] mask_avg: mc_mean=0.3771 mb_mean=0.4939 norm_overlap=1.0029 corr_cb=0.5916
[EPOCH 005/089] train: loss=1.5330 acc=61.21% | val: loss=0.6879 acc=61.45% f1=68.63% auc=54.83% val_score=41.1688 val_score_bestthr=62.5080 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.377, mb=0.494, no=1.003, corr=0.592) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 62.5080
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2963 mb_mean=0.4966 norm_overlap=1.0049 corr_cb=0.6710 topkJ=0.2071
[TRAIN][ep=006] loss=1.5122 acc=64.30%
[TRAIN][ep=006] mask_avg: mc_mean=0.2886 mb_mean=0.4939 norm_overlap=1.0047 corr_cb=0.6123
[EPOCH 006/089] train: loss=1.5122 acc=64.30% | val: loss=0.6851 acc=61.45% f1=68.00% auc=55.35% val_score=46.4584 val_score_bestthr=61.3919 | dyn(w_pfs=0.240, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.289, mb=0.494, no=1.005, corr=0.612) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.3919
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2814 mb_mean=0.4963 norm_overlap=1.0043 corr_cb=0.5781 topkJ=0.1947
[TRAIN][ep=007] loss=1.2545 acc=64.43%
[TRAIN][ep=007] mask_avg: mc_mean=0.2716 mb_mean=0.4939 norm_overlap=1.0048 corr_cb=0.5696
[EPOCH 007/089] train: loss=1.2545 acc=64.43% | val: loss=0.6886 acc=59.04% f1=71.19% auc=56.10% val_score=52.0294 val_score_bestthr=61.8550 | dyn(w_pfs=0.140, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.272, mb=0.494, no=1.005, corr=0.570) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.8550
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2746 mb_mean=0.4944 norm_overlap=1.0037 corr_cb=0.4572 topkJ=0.1594
[TRAIN][ep=008] loss=0.9971 acc=62.01%
[TRAIN][ep=008] mask_avg: mc_mean=0.2642 mb_mean=0.4939 norm_overlap=1.0047 corr_cb=0.5308
[EPOCH 008/089] train: loss=0.9971 acc=62.01% | val: loss=0.6917 acc=63.86% f1=70.00% auc=55.52% val_score=38.3641 val_score_bestthr=64.4904 | dyn(w_pfs=0.040, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.264, mb=0.494, no=1.005, corr=0.531) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 64.4904
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2685 mb_mean=0.4943 norm_overlap=1.0035 corr_cb=0.4395 topkJ=0.1372
[TRAIN][ep=009] loss=0.9206 acc=63.89%
[TRAIN][ep=009] mask_avg: mc_mean=0.2624 mb_mean=0.4939 norm_overlap=1.0043 corr_cb=0.4573
[EPOCH 009/089] train: loss=0.9206 acc=63.89% | val: loss=0.6896 acc=62.65% f1=69.31% auc=55.70% val_score=53.4797 val_score_bestthr=64.0147 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.262, mb=0.494, no=1.004, corr=0.457) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 64.0147
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.2328 mb_mean=0.4924 norm_overlap=1.0060 corr_cb=0.4753 topkJ=0.0900
[TRAIN][ep=010] loss=0.9074 acc=65.10%
[TRAIN][ep=010] mask_avg: mc_mean=0.2509 mb_mean=0.4939 norm_overlap=1.0041 corr_cb=0.3926
[EPOCH 010/089] train: loss=0.9074 acc=65.10% | val: loss=0.6914 acc=62.65% f1=69.90% auc=55.76% val_score=62.5080 val_score_bestthr=64.5172 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.251, mb=0.494, no=1.004, corr=0.393) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 64.5172
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.2397 mb_mean=0.4897 norm_overlap=1.0084 corr_cb=0.5239 topkJ=0.0936
[TRAIN][ep=011] loss=0.8936 acc=65.37%
[TRAIN][ep=011] mask_avg: mc_mean=0.2470 mb_mean=0.4939 norm_overlap=1.0035 corr_cb=0.3094
[EPOCH 011/089] train: loss=0.8936 acc=65.37% | val: loss=0.6900 acc=62.65% f1=69.90% auc=56.22% val_score=58.1875 val_score_bestthr=64.5172 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.247, mb=0.494, no=1.003, corr=0.309) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 64.5172
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.2228 mb_mean=0.4961 norm_overlap=1.0026 corr_cb=0.2739 topkJ=0.1207
[TRAIN][ep=012] loss=0.8961 acc=66.44%
[TRAIN][ep=012] mask_avg: mc_mean=0.2366 mb_mean=0.4939 norm_overlap=1.0032 corr_cb=0.2613
[EPOCH 012/089] train: loss=0.8961 acc=66.44% | val: loss=0.6882 acc=61.45% f1=68.63% auc=57.15% val_score=59.6943 val_score_bestthr=62.5080 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.237, mb=0.494, no=1.003, corr=0.261) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 62.5080
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.2284 mb_mean=0.4893 norm_overlap=1.0033 corr_cb=0.3218 topkJ=0.0891
[TRAIN][ep=013] loss=0.8898 acc=67.79%
[TRAIN][ep=013] mask_avg: mc_mean=0.2417 mb_mean=0.4939 norm_overlap=1.0022 corr_cb=0.1698
[EPOCH 013/089] train: loss=0.8898 acc=67.79% | val: loss=0.6885 acc=62.65% f1=69.90% auc=57.03% val_score=63.1662 val_score_bestthr=64.5172 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.242, mb=0.494, no=1.002, corr=0.170) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 64.5172
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.2237 mb_mean=0.4938 norm_overlap=1.0015 corr_cb=0.1456 topkJ=0.1486
[TRAIN][ep=014] loss=0.8677 acc=70.34%
[TRAIN][ep=014] mask_avg: mc_mean=0.2340 mb_mean=0.4939 norm_overlap=1.0015 corr_cb=0.1110
[EPOCH 014/089] train: loss=0.8677 acc=70.34% | val: loss=0.7128 acc=59.04% f1=68.52% auc=56.51% val_score=36.4447 val_score_bestthr=63.1844 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.234, mb=0.494, no=1.001, corr=0.111) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 63.1844
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.2200 mb_mean=0.4908 norm_overlap=1.0040 corr_cb=0.2553 topkJ=0.0764
[TRAIN][ep=015] loss=0.8649 acc=69.13%
[TRAIN][ep=015] mask_avg: mc_mean=0.2325 mb_mean=0.4939 norm_overlap=1.0007 corr_cb=0.0427
[EPOCH 015/089] train: loss=0.8649 acc=69.13% | val: loss=0.6946 acc=65.06% f1=70.10% auc=58.66% val_score=65.4198 val_score_bestthr=65.9325 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.232, mb=0.494, no=1.001, corr=0.043) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 65.9325
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1962 mb_mean=0.4876 norm_overlap=1.0009 corr_cb=0.0628 topkJ=0.0661
[TRAIN][ep=016] loss=0.8597 acc=69.53%
[TRAIN][ep=016] mask_avg: mc_mean=0.2234 mb_mean=0.4939 norm_overlap=1.0000 corr_cb=-0.0080
[EPOCH 016/089] train: loss=0.8597 acc=69.53% | val: loss=0.6900 acc=65.06% f1=70.10% auc=58.66% val_score=47.8737 val_score_bestthr=65.9325 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.223, mb=0.494, no=1.000, corr=-0.008) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 65.9325
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.2222 mb_mean=0.4928 norm_overlap=1.0008 corr_cb=0.0518 topkJ=0.0613
[TRAIN][ep=017] loss=0.8414 acc=71.81%
[TRAIN][ep=017] mask_avg: mc_mean=0.2315 mb_mean=0.4939 norm_overlap=0.9988 corr_cb=-0.0726
[EPOCH 017/089] train: loss=0.8414 acc=71.81% | val: loss=0.6902 acc=61.45% f1=69.23% auc=58.84% val_score=48.6574 val_score_bestthr=63.0991 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.231, mb=0.494, no=0.999, corr=-0.073) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 63.0991
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.2351 mb_mean=0.4962 norm_overlap=0.9981 corr_cb=-0.1269 topkJ=0.0346
[TRAIN][ep=018] loss=0.8322 acc=71.14%
[TRAIN][ep=018] mask_avg: mc_mean=0.2421 mb_mean=0.4939 norm_overlap=0.9978 corr_cb=-0.1308
[EPOCH 018/089] train: loss=0.8322 acc=71.14% | val: loss=0.7158 acc=59.04% f1=67.92% auc=58.78% val_score=39.2780 val_score_bestthr=62.0758 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.242, mb=0.494, no=0.998, corr=-0.131) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 62.0758
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.2334 mb_mean=0.4994 norm_overlap=0.9955 corr_cb=-0.2769 topkJ=0.0201
[TRAIN][ep=019] loss=0.8236 acc=71.41%
[TRAIN][ep=019] mask_avg: mc_mean=0.2286 mb_mean=0.4939 norm_overlap=0.9976 corr_cb=-0.1288
[EPOCH 019/089] train: loss=0.8236 acc=71.41% | val: loss=0.6935 acc=61.45% f1=68.00% auc=59.65% val_score=48.4271 val_score_bestthr=62.7735 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.229, mb=0.494, no=0.998, corr=-0.129) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 62.7735
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.2939 mb_mean=0.4996 norm_overlap=0.9957 corr_cb=-0.2588 topkJ=0.0221
[TRAIN][ep=020] loss=0.8234 acc=72.89%
[TRAIN][ep=020] mask_avg: mc_mean=0.2675 mb_mean=0.4939 norm_overlap=0.9962 corr_cb=-0.2044
[EPOCH 020/089] train: loss=0.8234 acc=72.89% | val: loss=0.7615 acc=60.24% f1=70.27% auc=61.16% val_score=41.5677 val_score_bestthr=59.1788 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.267, mb=0.494, no=0.996, corr=-0.204) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 59.1788
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2186 mb_mean=0.4905 norm_overlap=0.9982 corr_cb=-0.0768 topkJ=0.0344
[TRAIN][ep=021] loss=0.8054 acc=72.62%
[TRAIN][ep=021] mask_avg: mc_mean=0.2379 mb_mean=0.4939 norm_overlap=0.9965 corr_cb=-0.1696
[EPOCH 021/089] train: loss=0.8054 acc=72.62% | val: loss=0.6996 acc=62.65% f1=71.03% auc=60.12% val_score=47.8820 val_score_bestthr=60.4643 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.238, mb=0.494, no=0.997, corr=-0.170) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 60.4643
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2529 mb_mean=0.4935 norm_overlap=0.9963 corr_cb=-0.1778 topkJ=0.0381
[TRAIN][ep=022] loss=0.7972 acc=73.02%
[TRAIN][ep=022] mask_avg: mc_mean=0.2352 mb_mean=0.4939 norm_overlap=0.9963 corr_cb=-0.1732
[EPOCH 022/089] train: loss=0.7972 acc=73.02% | val: loss=0.7104 acc=57.83% f1=70.59% auc=60.23% val_score=53.1065 val_score_bestthr=61.6332 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.235, mb=0.494, no=0.996, corr=-0.173) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.6332
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2783 mb_mean=0.4972 norm_overlap=0.9956 corr_cb=-0.2565 topkJ=0.0291
[TRAIN][ep=023] loss=0.7784 acc=76.38%
[TRAIN][ep=023] mask_avg: mc_mean=0.2617 mb_mean=0.4939 norm_overlap=0.9953 corr_cb=-0.2273
[EPOCH 023/089] train: loss=0.7784 acc=76.38% | val: loss=0.7681 acc=62.65% f1=71.56% auc=59.88% val_score=56.7989 val_score_bestthr=58.6176 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.262, mb=0.494, no=0.995, corr=-0.227) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 58.6176
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2704 mb_mean=0.4985 norm_overlap=0.9951 corr_cb=-0.2502 topkJ=0.0187
[TRAIN][ep=024] loss=0.7944 acc=74.09%
[TRAIN][ep=024] mask_avg: mc_mean=0.2232 mb_mean=0.4939 norm_overlap=0.9963 corr_cb=-0.1601
[EPOCH 024/089] train: loss=0.7944 acc=74.09% | val: loss=0.7081 acc=63.86% f1=71.70% auc=60.17% val_score=44.1225 val_score_bestthr=61.6312 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.223, mb=0.494, no=0.996, corr=-0.160) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.6312
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2623 mb_mean=0.4905 norm_overlap=0.9968 corr_cb=-0.1544 topkJ=0.0325
[TRAIN][ep=025] loss=0.7937 acc=73.56%
[TRAIN][ep=025] mask_avg: mc_mean=0.2569 mb_mean=0.4939 norm_overlap=0.9954 corr_cb=-0.2155
[EPOCH 025/089] train: loss=0.7937 acc=73.56% | val: loss=0.7120 acc=62.65% f1=71.03% auc=60.23% val_score=53.8036 val_score_bestthr=60.4643 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.257, mb=0.494, no=0.995, corr=-0.216) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 60.4643
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2376 mb_mean=0.4946 norm_overlap=0.9973 corr_cb=-0.1391 topkJ=0.0370
[TRAIN][ep=026] loss=0.7636 acc=75.97%
[TRAIN][ep=026] mask_avg: mc_mean=0.2527 mb_mean=0.4939 norm_overlap=0.9952 corr_cb=-0.2162
[EPOCH 026/089] train: loss=0.7636 acc=75.97% | val: loss=0.7188 acc=62.65% f1=71.03% auc=60.47% val_score=56.2220 val_score_bestthr=60.4643 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.253, mb=0.494, no=0.995, corr=-0.216) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 60.4643
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2531 mb_mean=0.4930 norm_overlap=0.9925 corr_cb=-0.2637 topkJ=0.0115
[TRAIN][ep=027] loss=0.7562 acc=74.77%
[TRAIN][ep=027] mask_avg: mc_mean=0.2667 mb_mean=0.4939 norm_overlap=0.9950 corr_cb=-0.2343
[EPOCH 027/089] train: loss=0.7562 acc=74.77% | val: loss=0.7319 acc=63.86% f1=71.70% auc=61.28% val_score=54.5969 val_score_bestthr=61.6312 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.267, mb=0.494, no=0.995, corr=-0.234) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.6312
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2821 mb_mean=0.4937 norm_overlap=0.9952 corr_cb=-0.2823 topkJ=0.0231
[TRAIN][ep=028] loss=0.7577 acc=76.51%
[TRAIN][ep=028] mask_avg: mc_mean=0.2727 mb_mean=0.4939 norm_overlap=0.9948 corr_cb=-0.2456
[EPOCH 028/089] train: loss=0.7577 acc=76.51% | val: loss=0.7404 acc=57.83% f1=70.09% auc=61.69% val_score=49.9659 val_score_bestthr=63.6833 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.273, mb=0.494, no=0.995, corr=-0.246) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 63.6833
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2239 mb_mean=0.4901 norm_overlap=0.9946 corr_cb=-0.2289 topkJ=0.0268
[TRAIN][ep=029] loss=0.7467 acc=76.91%
[TRAIN][ep=029] mask_avg: mc_mean=0.2759 mb_mean=0.4939 norm_overlap=0.9949 corr_cb=-0.2398
[EPOCH 029/089] train: loss=0.7467 acc=76.91% | val: loss=0.7268 acc=62.65% f1=70.48% auc=61.22% val_score=53.5121 val_score_bestthr=61.9875 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.276, mb=0.494, no=0.995, corr=-0.240) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.9875
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2820 mb_mean=0.4930 norm_overlap=0.9941 corr_cb=-0.2596 topkJ=0.0201
[TRAIN][ep=030] loss=0.7389 acc=77.58%
[TRAIN][ep=030] mask_avg: mc_mean=0.2543 mb_mean=0.4939 norm_overlap=0.9952 corr_cb=-0.2169
[EPOCH 030/089] train: loss=0.7389 acc=77.58% | val: loss=0.7521 acc=61.45% f1=69.81% auc=60.64% val_score=48.5423 val_score_bestthr=60.8830 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.254, mb=0.494, no=0.995, corr=-0.217) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 60.8830
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2652 mb_mean=0.4940 norm_overlap=0.9964 corr_cb=-0.1407 topkJ=0.0430
[TRAIN][ep=031] loss=0.7212 acc=78.26%
[TRAIN][ep=031] mask_avg: mc_mean=0.2601 mb_mean=0.4939 norm_overlap=0.9951 corr_cb=-0.2235
[EPOCH 031/089] train: loss=0.7212 acc=78.26% | val: loss=0.7426 acc=60.24% f1=70.80% auc=61.22% val_score=45.9940 val_score_bestthr=62.0678 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.260, mb=0.494, no=0.995, corr=-0.223) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 62.0678
[EARLY STOP] no improvement for 30 epochs. best_epoch=1
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
=============== FIT DONE ===============
[BEST] epoch=1 | val_acc=63.86% | val_f1=71.15% | val_auc=53.78% | val_score=50.1238 | val_score_bestthr=66.6380
[TEST@BEST] thr_used=0.470 | acc=55.56% f1=63.78% auc=60.63% | SP_sex=5.56% EO_sex=19.12% SP_age=2.71% EO_age=14.10%
[TIME] 0.73 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold1_rep1_seed1001/summary_fold_1.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5240 mb_mean=0.4945 norm_overlap=1.0001 corr_cb=0.1063 topkJ=0.0892
[TRAIN][ep=000] loss=0.6959 acc=50.74%
[TRAIN][ep=000] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0637
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5198 mb_mean=0.4964 norm_overlap=1.0000 corr_cb=0.0020 topkJ=0.1618
[TRAIN][ep=001] loss=0.6934 acc=50.07%
[TRAIN][ep=001] mask_avg: mc_mean=0.5235 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0636
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5264 mb_mean=0.4883 norm_overlap=1.0000 corr_cb=0.0372 topkJ=0.1146
[TRAIN][ep=002] loss=0.6920 acc=52.75%
[TRAIN][ep=002] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0591
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5240 mb_mean=0.4973 norm_overlap=0.9999 corr_cb=-0.1065 topkJ=0.0757
[TRAIN][ep=003] loss=0.6908 acc=52.21%
[TRAIN][ep=003] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0640
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5252 mb_mean=0.4946 norm_overlap=1.0001 corr_cb=0.0693 topkJ=0.1075
[TRAIN][ep=004] loss=0.6888 acc=55.84%
[TRAIN][ep=004] mask_avg: mc_mean=0.5235 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0728
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5254 mb_mean=0.4873 norm_overlap=0.9996 corr_cb=-0.3571 topkJ=0.0700
[TRAIN][ep=005] loss=0.6885 acc=56.91%
[TRAIN][ep=005] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0579
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5240 mb_mean=0.4920 norm_overlap=0.9998 corr_cb=-0.2417 topkJ=0.0358
[TRAIN][ep=006] loss=0.6843 acc=57.05%
[TRAIN][ep=006] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0643
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5236 mb_mean=0.4973 norm_overlap=1.0000 corr_cb=0.0089 topkJ=0.0999
[TRAIN][ep=007] loss=0.6810 acc=59.73%
[TRAIN][ep=007] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0694
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5205 mb_mean=0.4927 norm_overlap=0.9997 corr_cb=-0.2425 topkJ=0.0796
[TRAIN][ep=008] loss=0.6817 acc=56.24%
[TRAIN][ep=008] mask_avg: mc_mean=0.5235 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0663
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5252 mb_mean=0.4985 norm_overlap=1.0001 corr_cb=0.1253 topkJ=0.1968
[TRAIN][ep=009] loss=0.6774 acc=58.12%
[TRAIN][ep=009] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0649
================= FIT START (fold=1) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5254 mb_mean=0.4911 norm_overlap=0.9999 corr_cb=-0.1383 topkJ=0.0522
[TRAIN][ep=000] loss=0.6719 acc=60.81%
[TRAIN][ep=000] mask_avg: mc_mean=0.5235 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0647
[EPOCH 000/089] train: loss=0.6719 acc=60.81% | val: loss=0.6893 acc=57.83% f1=71.07% auc=54.88% val_score=57.9692 val_score_bestthr=63.1205 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.065) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 63.1205
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5232 mb_mean=0.4969 norm_overlap=0.9998 corr_cb=-0.2445 topkJ=0.0792
[TRAIN][ep=001] loss=0.6712 acc=59.19%
[TRAIN][ep=001] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0653
[EPOCH 001/089] train: loss=0.6712 acc=59.19% | val: loss=0.6878 acc=63.86% f1=71.15% auc=53.78% val_score=50.1238 val_score_bestthr=66.6380 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.065) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 63.1205 -> 66.6380
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5251 mb_mean=0.4886 norm_overlap=1.0000 corr_cb=-0.0238 topkJ=0.0802
[TRAIN][ep=002] loss=0.6667 acc=61.61%
[TRAIN][ep=002] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0672
[EPOCH 002/089] train: loss=0.6667 acc=61.61% | val: loss=0.6871 acc=62.65% f1=68.69% auc=54.13% val_score=60.1191 val_score_bestthr=61.2270 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.067) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.2270
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5203 mb_mean=0.4927 norm_overlap=1.0000 corr_cb=-0.0206 topkJ=0.0508
[TRAIN][ep=003] loss=0.6612 acc=61.61%
[TRAIN][ep=003] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0645
[EPOCH 003/089] train: loss=0.6612 acc=61.61% | val: loss=0.6909 acc=61.45% f1=71.93% auc=55.00% val_score=54.6289 val_score_bestthr=62.0849 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.064) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 62.0849
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5239 mb_mean=0.4918 norm_overlap=0.9998 corr_cb=-0.2595 topkJ=0.0761
[TRAIN][ep=004] loss=0.6591 acc=63.49%
[TRAIN][ep=004] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0632
[EPOCH 004/089] train: loss=0.6591 acc=63.49% | val: loss=0.6871 acc=61.45% f1=70.91% auc=55.17% val_score=60.1191 val_score_bestthr=63.5375 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.063) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 63.5375
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5228 mb_mean=0.4934 norm_overlap=0.9999 corr_cb=-0.0737 topkJ=0.0499
[TRAIN][ep=005] loss=1.4739 acc=61.34%
[TRAIN][ep=005] mask_avg: mc_mean=0.3759 mb_mean=0.4939 norm_overlap=1.0030 corr_cb=0.5927
[EPOCH 005/089] train: loss=1.4739 acc=61.34% | val: loss=0.6879 acc=61.45% f1=68.63% auc=54.94% val_score=41.1688 val_score_bestthr=62.5080 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.376, mb=0.494, no=1.003, corr=0.593) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 62.5080
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2955 mb_mean=0.4966 norm_overlap=1.0049 corr_cb=0.6710 topkJ=0.2066
[TRAIN][ep=006] loss=1.4540 acc=64.30%
[TRAIN][ep=006] mask_avg: mc_mean=0.2883 mb_mean=0.4939 norm_overlap=1.0047 corr_cb=0.6122
[EPOCH 006/089] train: loss=1.4540 acc=64.30% | val: loss=0.6853 acc=61.45% f1=68.00% auc=55.41% val_score=46.4584 val_score_bestthr=61.3919 | dyn(w_pfs=0.240, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.288, mb=0.494, no=1.005, corr=0.612) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.3919
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2812 mb_mean=0.4963 norm_overlap=1.0043 corr_cb=0.5783 topkJ=0.1947
[TRAIN][ep=007] loss=1.2194 acc=64.43%
[TRAIN][ep=007] mask_avg: mc_mean=0.2713 mb_mean=0.4939 norm_overlap=1.0048 corr_cb=0.5700
[EPOCH 007/089] train: loss=1.2194 acc=64.43% | val: loss=0.6887 acc=59.04% f1=71.19% auc=55.99% val_score=52.0294 val_score_bestthr=61.8550 | dyn(w_pfs=0.140, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.271, mb=0.494, no=1.005, corr=0.570) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.8550
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2743 mb_mean=0.4944 norm_overlap=1.0037 corr_cb=0.4571 topkJ=0.1594
[TRAIN][ep=008] loss=0.9854 acc=61.88%
[TRAIN][ep=008] mask_avg: mc_mean=0.2641 mb_mean=0.4939 norm_overlap=1.0047 corr_cb=0.5305
[EPOCH 008/089] train: loss=0.9854 acc=61.88% | val: loss=0.6919 acc=63.86% f1=70.00% auc=55.58% val_score=38.3641 val_score_bestthr=64.4904 | dyn(w_pfs=0.040, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.264, mb=0.494, no=1.005, corr=0.531) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 64.4904
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2682 mb_mean=0.4943 norm_overlap=1.0035 corr_cb=0.4385 topkJ=0.1367
[TRAIN][ep=009] loss=0.9205 acc=63.89%
[TRAIN][ep=009] mask_avg: mc_mean=0.2626 mb_mean=0.4939 norm_overlap=1.0043 corr_cb=0.4553
[EPOCH 009/089] train: loss=0.9205 acc=63.89% | val: loss=0.6898 acc=62.65% f1=69.31% auc=55.52% val_score=53.4797 val_score_bestthr=64.0147 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.263, mb=0.494, no=1.004, corr=0.455) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 64.0147
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.2330 mb_mean=0.4924 norm_overlap=1.0060 corr_cb=0.4716 topkJ=0.0886
[TRAIN][ep=010] loss=0.9073 acc=64.83%
[TRAIN][ep=010] mask_avg: mc_mean=0.2511 mb_mean=0.4939 norm_overlap=1.0041 corr_cb=0.3896
[EPOCH 010/089] train: loss=0.9073 acc=64.83% | val: loss=0.6916 acc=62.65% f1=69.90% auc=55.87% val_score=63.1662 val_score_bestthr=64.5172 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.251, mb=0.494, no=1.004, corr=0.390) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 64.5172
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.2396 mb_mean=0.4897 norm_overlap=1.0084 corr_cb=0.5213 topkJ=0.0932
[TRAIN][ep=011] loss=0.8935 acc=65.50%
[TRAIN][ep=011] mask_avg: mc_mean=0.2473 mb_mean=0.4939 norm_overlap=1.0034 corr_cb=0.3051
[EPOCH 011/089] train: loss=0.8935 acc=65.50% | val: loss=0.6902 acc=62.65% f1=69.90% auc=56.16% val_score=58.1875 val_score_bestthr=64.5172 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.247, mb=0.494, no=1.003, corr=0.305) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 64.5172
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.2224 mb_mean=0.4961 norm_overlap=1.0026 corr_cb=0.2713 topkJ=0.1202
[TRAIN][ep=012] loss=0.8957 acc=66.44%
[TRAIN][ep=012] mask_avg: mc_mean=0.2359 mb_mean=0.4939 norm_overlap=1.0032 corr_cb=0.2579
[EPOCH 012/089] train: loss=0.8957 acc=66.44% | val: loss=0.6883 acc=61.45% f1=68.63% auc=57.15% val_score=59.6943 val_score_bestthr=62.5080 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.236, mb=0.494, no=1.003, corr=0.258) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 62.5080
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.2278 mb_mean=0.4893 norm_overlap=1.0033 corr_cb=0.3174 topkJ=0.0887
[TRAIN][ep=013] loss=0.8896 acc=67.79%
[TRAIN][ep=013] mask_avg: mc_mean=0.2417 mb_mean=0.4939 norm_overlap=1.0021 corr_cb=0.1641
[EPOCH 013/089] train: loss=0.8896 acc=67.79% | val: loss=0.6886 acc=62.65% f1=69.90% auc=57.03% val_score=63.1662 val_score_bestthr=64.5172 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.242, mb=0.494, no=1.002, corr=0.164) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 64.5172
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.2239 mb_mean=0.4938 norm_overlap=1.0014 corr_cb=0.1398 topkJ=0.1470
[TRAIN][ep=014] loss=0.8674 acc=70.47%
[TRAIN][ep=014] mask_avg: mc_mean=0.2342 mb_mean=0.4939 norm_overlap=1.0014 corr_cb=0.1047
[EPOCH 014/089] train: loss=0.8674 acc=70.47% | val: loss=0.7130 acc=59.04% f1=68.52% auc=56.40% val_score=36.4447 val_score_bestthr=63.1844 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.234, mb=0.494, no=1.001, corr=0.105) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 63.1844
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.2202 mb_mean=0.4908 norm_overlap=1.0039 corr_cb=0.2482 topkJ=0.0755
[TRAIN][ep=015] loss=0.8646 acc=68.86%
[TRAIN][ep=015] mask_avg: mc_mean=0.2327 mb_mean=0.4939 norm_overlap=1.0006 corr_cb=0.0362
[EPOCH 015/089] train: loss=0.8646 acc=68.86% | val: loss=0.6946 acc=65.06% f1=70.10% auc=58.84% val_score=65.4198 val_score_bestthr=65.9325 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.233, mb=0.494, no=1.001, corr=0.036) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 65.9325
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1964 mb_mean=0.4876 norm_overlap=1.0008 corr_cb=0.0564 topkJ=0.0630
[TRAIN][ep=016] loss=0.8593 acc=69.53%
[TRAIN][ep=016] mask_avg: mc_mean=0.2238 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0144
[EPOCH 016/089] train: loss=0.8593 acc=69.53% | val: loss=0.6901 acc=65.06% f1=70.10% auc=58.72% val_score=47.8737 val_score_bestthr=65.9325 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.224, mb=0.494, no=1.000, corr=-0.014) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 65.9325
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.2226 mb_mean=0.4928 norm_overlap=1.0007 corr_cb=0.0440 topkJ=0.0613
[TRAIN][ep=017] loss=0.8410 acc=71.68%
[TRAIN][ep=017] mask_avg: mc_mean=0.2314 mb_mean=0.4939 norm_overlap=0.9987 corr_cb=-0.0777
[EPOCH 017/089] train: loss=0.8410 acc=71.68% | val: loss=0.6902 acc=61.45% f1=69.23% auc=58.78% val_score=48.6574 val_score_bestthr=63.0991 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.231, mb=0.494, no=0.999, corr=-0.078) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 63.0991
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.2352 mb_mean=0.4962 norm_overlap=0.9980 corr_cb=-0.1317 topkJ=0.0329
[TRAIN][ep=018] loss=0.8317 acc=71.14%
[TRAIN][ep=018] mask_avg: mc_mean=0.2422 mb_mean=0.4939 norm_overlap=0.9977 corr_cb=-0.1348
[EPOCH 018/089] train: loss=0.8317 acc=71.14% | val: loss=0.7162 acc=59.04% f1=67.92% auc=58.78% val_score=34.9133 val_score_bestthr=62.0758 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.242, mb=0.494, no=0.998, corr=-0.135) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 62.0758
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.2335 mb_mean=0.4994 norm_overlap=0.9954 corr_cb=-0.2807 topkJ=0.0197
[TRAIN][ep=019] loss=0.8231 acc=71.28%
[TRAIN][ep=019] mask_avg: mc_mean=0.2288 mb_mean=0.4939 norm_overlap=0.9975 corr_cb=-0.1328
[EPOCH 019/089] train: loss=0.8231 acc=71.28% | val: loss=0.6940 acc=61.45% f1=68.00% auc=59.71% val_score=48.4271 val_score_bestthr=62.7735 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.229, mb=0.494, no=0.998, corr=-0.133) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 62.7735
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.2935 mb_mean=0.4996 norm_overlap=0.9956 corr_cb=-0.2609 topkJ=0.0216
[TRAIN][ep=020] loss=0.8229 acc=72.75%
[TRAIN][ep=020] mask_avg: mc_mean=0.2675 mb_mean=0.4939 norm_overlap=0.9961 corr_cb=-0.2072
[EPOCH 020/089] train: loss=0.8229 acc=72.75% | val: loss=0.7618 acc=60.24% f1=70.27% auc=60.99% val_score=41.5677 val_score_bestthr=59.1788 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.267, mb=0.494, no=0.996, corr=-0.207) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 59.1788
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2185 mb_mean=0.4905 norm_overlap=0.9981 corr_cb=-0.0797 topkJ=0.0340
[TRAIN][ep=021] loss=0.8048 acc=72.62%
[TRAIN][ep=021] mask_avg: mc_mean=0.2382 mb_mean=0.4939 norm_overlap=0.9965 corr_cb=-0.1731
[EPOCH 021/089] train: loss=0.8048 acc=72.62% | val: loss=0.6991 acc=60.24% f1=67.96% auc=60.00% val_score=48.4271 val_score_bestthr=60.7417 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.238, mb=0.494, no=0.996, corr=-0.173) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 60.7417
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2525 mb_mean=0.4935 norm_overlap=0.9963 corr_cb=-0.1784 topkJ=0.0377
[TRAIN][ep=022] loss=0.7966 acc=73.02%
[TRAIN][ep=022] mask_avg: mc_mean=0.2356 mb_mean=0.4939 norm_overlap=0.9962 corr_cb=-0.1768
[EPOCH 022/089] train: loss=0.7966 acc=73.02% | val: loss=0.7112 acc=57.83% f1=70.59% auc=60.12% val_score=53.1065 val_score_bestthr=61.6332 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.236, mb=0.494, no=0.996, corr=-0.177) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.6332
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2777 mb_mean=0.4972 norm_overlap=0.9956 corr_cb=-0.2567 topkJ=0.0295
[TRAIN][ep=023] loss=0.7776 acc=76.11%
[TRAIN][ep=023] mask_avg: mc_mean=0.2617 mb_mean=0.4939 norm_overlap=0.9953 corr_cb=-0.2298
[EPOCH 023/089] train: loss=0.7776 acc=76.11% | val: loss=0.7689 acc=62.65% f1=71.56% auc=59.59% val_score=55.2954 val_score_bestthr=58.6176 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.262, mb=0.494, no=0.995, corr=-0.230) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 58.6176
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2699 mb_mean=0.4985 norm_overlap=0.9951 corr_cb=-0.2519 topkJ=0.0187
[TRAIN][ep=024] loss=0.7935 acc=73.96%
[TRAIN][ep=024] mask_avg: mc_mean=0.2229 mb_mean=0.4939 norm_overlap=0.9963 corr_cb=-0.1619
[EPOCH 024/089] train: loss=0.7935 acc=73.96% | val: loss=0.7089 acc=63.86% f1=71.70% auc=60.17% val_score=44.1225 val_score_bestthr=61.6312 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.223, mb=0.494, no=0.996, corr=-0.162) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.6312
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2627 mb_mean=0.4905 norm_overlap=0.9967 corr_cb=-0.1596 topkJ=0.0325
[TRAIN][ep=025] loss=0.7928 acc=73.56%
[TRAIN][ep=025] mask_avg: mc_mean=0.2571 mb_mean=0.4939 norm_overlap=0.9953 corr_cb=-0.2181
[EPOCH 025/089] train: loss=0.7928 acc=73.56% | val: loss=0.7127 acc=62.65% f1=71.03% auc=60.29% val_score=49.1094 val_score_bestthr=60.4643 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.257, mb=0.494, no=0.995, corr=-0.218) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 60.4643
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2377 mb_mean=0.4946 norm_overlap=0.9972 corr_cb=-0.1415 topkJ=0.0370
[TRAIN][ep=026] loss=0.7627 acc=75.84%
[TRAIN][ep=026] mask_avg: mc_mean=0.2530 mb_mean=0.4939 norm_overlap=0.9951 corr_cb=-0.2189
[EPOCH 026/089] train: loss=0.7627 acc=75.84% | val: loss=0.7203 acc=62.65% f1=71.03% auc=60.47% val_score=56.2220 val_score_bestthr=60.4643 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.253, mb=0.494, no=0.995, corr=-0.219) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 60.4643
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2526 mb_mean=0.4930 norm_overlap=0.9923 corr_cb=-0.2682 topkJ=0.0115
[TRAIN][ep=027] loss=0.7551 acc=74.90%
[TRAIN][ep=027] mask_avg: mc_mean=0.2665 mb_mean=0.4939 norm_overlap=0.9949 corr_cb=-0.2365
[EPOCH 027/089] train: loss=0.7551 acc=74.90% | val: loss=0.7333 acc=63.86% f1=71.70% auc=61.40% val_score=52.4750 val_score_bestthr=61.6312 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.267, mb=0.494, no=0.995, corr=-0.236) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.6312
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2841 mb_mean=0.4937 norm_overlap=0.9951 corr_cb=-0.2868 topkJ=0.0231
[TRAIN][ep=028] loss=0.7568 acc=76.78%
[TRAIN][ep=028] mask_avg: mc_mean=0.2744 mb_mean=0.4939 norm_overlap=0.9947 corr_cb=-0.2502
[EPOCH 028/089] train: loss=0.7568 acc=76.78% | val: loss=0.7420 acc=57.83% f1=70.09% auc=61.63% val_score=49.9659 val_score_bestthr=63.6833 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.274, mb=0.494, no=0.995, corr=-0.250) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 63.6833
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2262 mb_mean=0.4901 norm_overlap=0.9945 corr_cb=-0.2339 topkJ=0.0264
[TRAIN][ep=029] loss=0.7460 acc=76.91%
[TRAIN][ep=029] mask_avg: mc_mean=0.2766 mb_mean=0.4939 norm_overlap=0.9948 corr_cb=-0.2430
[EPOCH 029/089] train: loss=0.7460 acc=76.91% | val: loss=0.7281 acc=62.65% f1=70.48% auc=60.93% val_score=53.5121 val_score_bestthr=61.9875 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.277, mb=0.494, no=0.995, corr=-0.243) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.9875
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2817 mb_mean=0.4930 norm_overlap=0.9940 corr_cb=-0.2624 topkJ=0.0201
[TRAIN][ep=030] loss=0.7382 acc=77.72%
[TRAIN][ep=030] mask_avg: mc_mean=0.2548 mb_mean=0.4939 norm_overlap=0.9951 corr_cb=-0.2199
[EPOCH 030/089] train: loss=0.7382 acc=77.72% | val: loss=0.7531 acc=60.24% f1=56.00% auc=60.52% val_score=48.5423 val_score_bestthr=60.0684 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.255, mb=0.494, no=0.995, corr=-0.220) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 60.0684
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2662 mb_mean=0.4940 norm_overlap=0.9963 corr_cb=-0.1457 topkJ=0.0426
[TRAIN][ep=031] loss=0.7203 acc=78.12%
[TRAIN][ep=031] mask_avg: mc_mean=0.2605 mb_mean=0.4939 norm_overlap=0.9950 corr_cb=-0.2262
[EPOCH 031/089] train: loss=0.7203 acc=78.12% | val: loss=0.7437 acc=60.24% f1=70.80% auc=61.28% val_score=45.9740 val_score_bestthr=62.0678 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.261, mb=0.494, no=0.995, corr=-0.226) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 62.0678
[EARLY STOP] no improvement for 30 epochs. best_epoch=1
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
=============== FIT DONE ===============
[BEST] epoch=1 | val_acc=63.86% | val_f1=71.15% | val_auc=53.78% | val_score=50.1238 | val_score_bestthr=66.6380
[TEST@BEST] thr_used=0.470 | acc=55.56% f1=63.78% auc=60.62% | SP_sex=5.56% EO_sex=19.12% SP_age=2.71% EO_age=14.10%
[TIME] 0.79 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold1_rep1_seed1001/summary_fold_1.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5240 mb_mean=0.4945 norm_overlap=1.0001 corr_cb=0.1063 topkJ=0.0892
[TRAIN][ep=000] loss=0.6959 acc=50.74%
[TRAIN][ep=000] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0637
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5198 mb_mean=0.4964 norm_overlap=1.0000 corr_cb=0.0020 topkJ=0.1618
[TRAIN][ep=001] loss=0.6934 acc=50.07%
[TRAIN][ep=001] mask_avg: mc_mean=0.5235 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0636
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5264 mb_mean=0.4883 norm_overlap=1.0000 corr_cb=0.0372 topkJ=0.1146
[TRAIN][ep=002] loss=0.6920 acc=52.75%
[TRAIN][ep=002] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0591
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5240 mb_mean=0.4973 norm_overlap=0.9999 corr_cb=-0.1065 topkJ=0.0757
[TRAIN][ep=003] loss=0.6908 acc=52.21%
[TRAIN][ep=003] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0640
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5252 mb_mean=0.4946 norm_overlap=1.0001 corr_cb=0.0693 topkJ=0.1075
[TRAIN][ep=004] loss=0.6888 acc=55.84%
[TRAIN][ep=004] mask_avg: mc_mean=0.5235 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0728
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5254 mb_mean=0.4873 norm_overlap=0.9996 corr_cb=-0.3571 topkJ=0.0700
[TRAIN][ep=005] loss=0.6885 acc=57.05%
[TRAIN][ep=005] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0579
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5240 mb_mean=0.4920 norm_overlap=0.9998 corr_cb=-0.2417 topkJ=0.0358
[TRAIN][ep=006] loss=0.6843 acc=57.05%
[TRAIN][ep=006] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0643
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5236 mb_mean=0.4973 norm_overlap=1.0000 corr_cb=0.0089 topkJ=0.0999
[TRAIN][ep=007] loss=0.6810 acc=59.73%
[TRAIN][ep=007] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0694
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5205 mb_mean=0.4927 norm_overlap=0.9997 corr_cb=-0.2425 topkJ=0.0796
[TRAIN][ep=008] loss=0.6817 acc=56.24%
[TRAIN][ep=008] mask_avg: mc_mean=0.5235 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0663
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5252 mb_mean=0.4985 norm_overlap=1.0001 corr_cb=0.1253 topkJ=0.1968
[TRAIN][ep=009] loss=0.6774 acc=58.12%
[TRAIN][ep=009] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0649
================= FIT START (fold=1) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5254 mb_mean=0.4911 norm_overlap=0.9999 corr_cb=-0.1383 topkJ=0.0522
[TRAIN][ep=000] loss=0.6719 acc=60.81%
[TRAIN][ep=000] mask_avg: mc_mean=0.5235 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0647
[EPOCH 000/089] train: loss=0.6719 acc=60.81% | val: loss=0.6893 acc=57.83% f1=71.07% auc=54.88% val_score=57.9692 val_score_bestthr=63.1205 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.065) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 63.1205
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5232 mb_mean=0.4969 norm_overlap=0.9998 corr_cb=-0.2445 topkJ=0.0792
[TRAIN][ep=001] loss=0.6712 acc=59.19%
[TRAIN][ep=001] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0653
[EPOCH 001/089] train: loss=0.6712 acc=59.19% | val: loss=0.6878 acc=63.86% f1=71.15% auc=53.78% val_score=50.1238 val_score_bestthr=66.6380 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.065) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 63.1205 -> 66.6380
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5251 mb_mean=0.4886 norm_overlap=1.0000 corr_cb=-0.0238 topkJ=0.0802
[TRAIN][ep=002] loss=0.6667 acc=61.61%
[TRAIN][ep=002] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0672
[EPOCH 002/089] train: loss=0.6667 acc=61.61% | val: loss=0.6871 acc=62.65% f1=68.69% auc=54.13% val_score=60.1191 val_score_bestthr=61.2270 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.067) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.2270
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5203 mb_mean=0.4927 norm_overlap=1.0000 corr_cb=-0.0206 topkJ=0.0508
[TRAIN][ep=003] loss=0.6613 acc=61.61%
[TRAIN][ep=003] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0645
[EPOCH 003/089] train: loss=0.6613 acc=61.61% | val: loss=0.6909 acc=61.45% f1=71.93% auc=55.00% val_score=54.6289 val_score_bestthr=62.0849 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.064) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 62.0849
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5239 mb_mean=0.4918 norm_overlap=0.9998 corr_cb=-0.2595 topkJ=0.0761
[TRAIN][ep=004] loss=0.6591 acc=63.49%
[TRAIN][ep=004] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0632
[EPOCH 004/089] train: loss=0.6591 acc=63.49% | val: loss=0.6871 acc=61.45% f1=70.91% auc=55.17% val_score=60.1191 val_score_bestthr=63.5375 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.063) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 63.5375
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5228 mb_mean=0.4934 norm_overlap=0.9999 corr_cb=-0.0737 topkJ=0.0499
[TRAIN][ep=005] loss=1.2368 acc=61.21%
[TRAIN][ep=005] mask_avg: mc_mean=0.3741 mb_mean=0.4939 norm_overlap=1.0030 corr_cb=0.5945
[EPOCH 005/089] train: loss=1.2368 acc=61.21% | val: loss=0.6879 acc=62.65% f1=69.31% auc=54.83% val_score=42.8623 val_score_bestthr=64.0147 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.374, mb=0.494, no=1.003, corr=0.594) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 64.0147
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2946 mb_mean=0.4966 norm_overlap=1.0049 corr_cb=0.6709 topkJ=0.2060
[TRAIN][ep=006] loss=1.2218 acc=64.97%
[TRAIN][ep=006] mask_avg: mc_mean=0.2878 mb_mean=0.4939 norm_overlap=1.0047 corr_cb=0.6123
[EPOCH 006/089] train: loss=1.2218 acc=64.97% | val: loss=0.6853 acc=62.65% f1=68.69% auc=54.94% val_score=46.4584 val_score_bestthr=61.2270 | dyn(w_pfs=0.240, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.288, mb=0.494, no=1.005, corr=0.612) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.2270
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2810 mb_mean=0.4963 norm_overlap=1.0043 corr_cb=0.5784 topkJ=0.1947
[TRAIN][ep=007] loss=1.0222 acc=64.16%
[TRAIN][ep=007] mask_avg: mc_mean=0.2712 mb_mean=0.4939 norm_overlap=1.0048 corr_cb=0.5700
[EPOCH 007/089] train: loss=1.0222 acc=64.16% | val: loss=0.6887 acc=59.04% f1=71.19% auc=56.16% val_score=57.0963 val_score_bestthr=61.8550 | dyn(w_pfs=0.140, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.271, mb=0.494, no=1.005, corr=0.570) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.8550
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2742 mb_mean=0.4944 norm_overlap=1.0037 corr_cb=0.4566 topkJ=0.1594
[TRAIN][ep=008] loss=0.8234 acc=62.01%
[TRAIN][ep=008] mask_avg: mc_mean=0.2641 mb_mean=0.4939 norm_overlap=1.0047 corr_cb=0.5293
[EPOCH 008/089] train: loss=0.8234 acc=62.01% | val: loss=0.6918 acc=63.86% f1=70.00% auc=55.47% val_score=38.3641 val_score_bestthr=64.4904 | dyn(w_pfs=0.040, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.264, mb=0.494, no=1.005, corr=0.529) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 64.4904
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2679 mb_mean=0.4943 norm_overlap=1.0035 corr_cb=0.4360 topkJ=0.1357
[TRAIN][ep=009] loss=0.7761 acc=64.30%
[TRAIN][ep=009] mask_avg: mc_mean=0.2626 mb_mean=0.4939 norm_overlap=1.0043 corr_cb=0.4524
[EPOCH 009/089] train: loss=0.7761 acc=64.30% | val: loss=0.6899 acc=62.65% f1=69.31% auc=55.35% val_score=53.4797 val_score_bestthr=64.0147 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.263, mb=0.494, no=1.004, corr=0.452) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 64.0147
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.2324 mb_mean=0.4924 norm_overlap=1.0060 corr_cb=0.4694 topkJ=0.0886
[TRAIN][ep=010] loss=0.7630 acc=65.23%
[TRAIN][ep=010] mask_avg: mc_mean=0.2507 mb_mean=0.4939 norm_overlap=1.0040 corr_cb=0.3874
[EPOCH 010/089] train: loss=0.7630 acc=65.23% | val: loss=0.6915 acc=62.65% f1=69.31% auc=55.81% val_score=58.1393 val_score_bestthr=63.1662 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.251, mb=0.494, no=1.004, corr=0.387) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 63.1662
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.2398 mb_mean=0.4897 norm_overlap=1.0083 corr_cb=0.5190 topkJ=0.0922
[TRAIN][ep=011] loss=0.7497 acc=65.37%
[TRAIN][ep=011] mask_avg: mc_mean=0.2468 mb_mean=0.4939 norm_overlap=1.0034 corr_cb=0.3034
[EPOCH 011/089] train: loss=0.7497 acc=65.37% | val: loss=0.6905 acc=62.65% f1=69.90% auc=56.16% val_score=58.1875 val_score_bestthr=64.5172 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.247, mb=0.494, no=1.003, corr=0.303) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 64.5172
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.2217 mb_mean=0.4961 norm_overlap=1.0026 corr_cb=0.2699 topkJ=0.1197
[TRAIN][ep=012] loss=0.7523 acc=66.31%
[TRAIN][ep=012] mask_avg: mc_mean=0.2359 mb_mean=0.4939 norm_overlap=1.0032 corr_cb=0.2549
[EPOCH 012/089] train: loss=0.7523 acc=66.31% | val: loss=0.6886 acc=61.45% f1=68.63% auc=57.27% val_score=59.6943 val_score_bestthr=62.5080 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.236, mb=0.494, no=1.003, corr=0.255) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 62.5080
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.2281 mb_mean=0.4893 norm_overlap=1.0033 corr_cb=0.3131 topkJ=0.0877
[TRAIN][ep=013] loss=0.7468 acc=68.05%
[TRAIN][ep=013] mask_avg: mc_mean=0.2412 mb_mean=0.4939 norm_overlap=1.0021 corr_cb=0.1619
[EPOCH 013/089] train: loss=0.7468 acc=68.05% | val: loss=0.6890 acc=62.65% f1=69.90% auc=57.09% val_score=63.1662 val_score_bestthr=64.5172 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.241, mb=0.494, no=1.002, corr=0.162) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 64.5172
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.2242 mb_mean=0.4938 norm_overlap=1.0014 corr_cb=0.1370 topkJ=0.1460
[TRAIN][ep=014] loss=0.7243 acc=70.74%
[TRAIN][ep=014] mask_avg: mc_mean=0.2338 mb_mean=0.4939 norm_overlap=1.0014 corr_cb=0.1031
[EPOCH 014/089] train: loss=0.7243 acc=70.74% | val: loss=0.7164 acc=60.24% f1=69.16% auc=56.40% val_score=37.8773 val_score_bestthr=63.4083 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.234, mb=0.494, no=1.001, corr=0.103) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 63.4083
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.2195 mb_mean=0.4908 norm_overlap=1.0039 corr_cb=0.2470 topkJ=0.0759
[TRAIN][ep=015] loss=0.7225 acc=68.59%
[TRAIN][ep=015] mask_avg: mc_mean=0.2323 mb_mean=0.4939 norm_overlap=1.0006 corr_cb=0.0349
[EPOCH 015/089] train: loss=0.7225 acc=68.59% | val: loss=0.6954 acc=65.06% f1=70.10% auc=58.66% val_score=65.4198 val_score_bestthr=65.9325 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.232, mb=0.494, no=1.001, corr=0.035) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 65.9325
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1968 mb_mean=0.4876 norm_overlap=1.0008 corr_cb=0.0538 topkJ=0.0634
[TRAIN][ep=016] loss=0.7172 acc=69.93%
[TRAIN][ep=016] mask_avg: mc_mean=0.2222 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0125
[EPOCH 016/089] train: loss=0.7172 acc=69.93% | val: loss=0.6908 acc=65.06% f1=70.10% auc=58.60% val_score=47.8737 val_score_bestthr=65.9325 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.222, mb=0.494, no=1.000, corr=-0.013) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 65.9325
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.2219 mb_mean=0.4928 norm_overlap=1.0007 corr_cb=0.0432 topkJ=0.0609
[TRAIN][ep=017] loss=0.6995 acc=72.08%
[TRAIN][ep=017] mask_avg: mc_mean=0.2303 mb_mean=0.4939 norm_overlap=0.9987 corr_cb=-0.0765
[EPOCH 017/089] train: loss=0.6995 acc=72.08% | val: loss=0.6912 acc=61.45% f1=69.23% auc=58.66% val_score=48.6574 val_score_bestthr=63.0991 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.230, mb=0.494, no=0.999, corr=-0.076) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 63.0991
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.2336 mb_mean=0.4962 norm_overlap=0.9981 corr_cb=-0.1291 topkJ=0.0337
[TRAIN][ep=018] loss=0.6910 acc=71.14%
[TRAIN][ep=018] mask_avg: mc_mean=0.2410 mb_mean=0.4939 norm_overlap=0.9977 corr_cb=-0.1337
[EPOCH 018/089] train: loss=0.6910 acc=71.14% | val: loss=0.7180 acc=61.45% f1=69.23% auc=58.72% val_score=34.9133 val_score_bestthr=64.2191 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.241, mb=0.494, no=0.998, corr=-0.134) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 64.2191
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.2336 mb_mean=0.4994 norm_overlap=0.9954 corr_cb=-0.2810 topkJ=0.0205
[TRAIN][ep=019] loss=0.6827 acc=71.01%
[TRAIN][ep=019] mask_avg: mc_mean=0.2275 mb_mean=0.4939 norm_overlap=0.9975 corr_cb=-0.1317
[EPOCH 019/089] train: loss=0.6827 acc=71.01% | val: loss=0.6950 acc=61.45% f1=68.00% auc=59.30% val_score=48.4271 val_score_bestthr=62.7735 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.227, mb=0.494, no=0.998, corr=-0.132) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 62.7735
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.2900 mb_mean=0.4996 norm_overlap=0.9957 corr_cb=-0.2551 topkJ=0.0238
[TRAIN][ep=020] loss=0.6835 acc=72.75%
[TRAIN][ep=020] mask_avg: mc_mean=0.2654 mb_mean=0.4939 norm_overlap=0.9962 corr_cb=-0.2052
[EPOCH 020/089] train: loss=0.6835 acc=72.75% | val: loss=0.7651 acc=60.24% f1=70.27% auc=60.87% val_score=44.4893 val_score_bestthr=59.1788 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.265, mb=0.494, no=0.996, corr=-0.205) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 59.1788
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2178 mb_mean=0.4905 norm_overlap=0.9981 corr_cb=-0.0807 topkJ=0.0344
[TRAIN][ep=021] loss=0.6662 acc=72.08%
[TRAIN][ep=021] mask_avg: mc_mean=0.2365 mb_mean=0.4939 norm_overlap=0.9965 corr_cb=-0.1714
[EPOCH 021/089] train: loss=0.6662 acc=72.08% | val: loss=0.7000 acc=60.24% f1=67.33% auc=59.77% val_score=48.4271 val_score_bestthr=61.6677 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.237, mb=0.494, no=0.996, corr=-0.171) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.6677
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2512 mb_mean=0.4935 norm_overlap=0.9963 corr_cb=-0.1779 topkJ=0.0377
[TRAIN][ep=022] loss=0.6591 acc=73.02%
[TRAIN][ep=022] mask_avg: mc_mean=0.2334 mb_mean=0.4939 norm_overlap=0.9962 corr_cb=-0.1739
[EPOCH 022/089] train: loss=0.6591 acc=73.02% | val: loss=0.7119 acc=57.83% f1=70.59% auc=60.12% val_score=53.1065 val_score_bestthr=61.6332 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.233, mb=0.494, no=0.996, corr=-0.174) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.6332
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2758 mb_mean=0.4972 norm_overlap=0.9956 corr_cb=-0.2574 topkJ=0.0295
[TRAIN][ep=023] loss=0.6411 acc=76.24%
[TRAIN][ep=023] mask_avg: mc_mean=0.2606 mb_mean=0.4939 norm_overlap=0.9953 corr_cb=-0.2298
[EPOCH 023/089] train: loss=0.6411 acc=76.24% | val: loss=0.7706 acc=62.65% f1=71.56% auc=59.48% val_score=58.6176 val_score_bestthr=58.6176 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.261, mb=0.494, no=0.995, corr=-0.230) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 58.6176
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2692 mb_mean=0.4985 norm_overlap=0.9951 corr_cb=-0.2514 topkJ=0.0183
[TRAIN][ep=024] loss=0.6582 acc=74.23%
[TRAIN][ep=024] mask_avg: mc_mean=0.2209 mb_mean=0.4939 norm_overlap=0.9963 corr_cb=-0.1594
[EPOCH 024/089] train: loss=0.6582 acc=74.23% | val: loss=0.7094 acc=62.65% f1=71.03% auc=60.00% val_score=46.7790 val_score_bestthr=60.4643 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.221, mb=0.494, no=0.996, corr=-0.159) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 60.4643
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2639 mb_mean=0.4905 norm_overlap=0.9966 corr_cb=-0.1666 topkJ=0.0325
[TRAIN][ep=025] loss=0.6592 acc=73.02%
[TRAIN][ep=025] mask_avg: mc_mean=0.2571 mb_mean=0.4939 norm_overlap=0.9953 corr_cb=-0.2196
[EPOCH 025/089] train: loss=0.6592 acc=73.02% | val: loss=0.7134 acc=62.65% f1=71.03% auc=60.35% val_score=51.1435 val_score_bestthr=60.4643 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.257, mb=0.494, no=0.995, corr=-0.220) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 60.4643
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2384 mb_mean=0.4946 norm_overlap=0.9971 corr_cb=-0.1456 topkJ=0.0366
[TRAIN][ep=026] loss=0.6288 acc=75.57%
[TRAIN][ep=026] mask_avg: mc_mean=0.2522 mb_mean=0.4939 norm_overlap=0.9951 corr_cb=-0.2193
[EPOCH 026/089] train: loss=0.6288 acc=75.57% | val: loss=0.7215 acc=62.65% f1=71.03% auc=60.29% val_score=56.7315 val_score_bestthr=60.4643 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.252, mb=0.494, no=0.995, corr=-0.219) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 60.4643
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2533 mb_mean=0.4930 norm_overlap=0.9921 corr_cb=-0.2752 topkJ=0.0103
[TRAIN][ep=027] loss=0.6224 acc=75.57%
[TRAIN][ep=027] mask_avg: mc_mean=0.2659 mb_mean=0.4939 norm_overlap=0.9949 corr_cb=-0.2380
[EPOCH 027/089] train: loss=0.6224 acc=75.57% | val: loss=0.7375 acc=63.86% f1=71.70% auc=61.16% val_score=54.5969 val_score_bestthr=61.6312 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.266, mb=0.494, no=0.995, corr=-0.238) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.6312
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2852 mb_mean=0.4937 norm_overlap=0.9951 corr_cb=-0.2908 topkJ=0.0231
[TRAIN][ep=028] loss=0.6251 acc=76.11%
[TRAIN][ep=028] mask_avg: mc_mean=0.2743 mb_mean=0.4939 norm_overlap=0.9946 corr_cb=-0.2533
[EPOCH 028/089] train: loss=0.6251 acc=76.11% | val: loss=0.7394 acc=57.83% f1=70.09% auc=61.40% val_score=49.1570 val_score_bestthr=63.6833 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.274, mb=0.494, no=0.995, corr=-0.253) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 63.6833
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2302 mb_mean=0.4901 norm_overlap=0.9944 corr_cb=-0.2417 topkJ=0.0252
[TRAIN][ep=029] loss=0.6144 acc=77.32%
[TRAIN][ep=029] mask_avg: mc_mean=0.2777 mb_mean=0.4939 norm_overlap=0.9947 corr_cb=-0.2472
[EPOCH 029/089] train: loss=0.6144 acc=77.32% | val: loss=0.7300 acc=61.45% f1=69.81% auc=60.52% val_score=53.5121 val_score_bestthr=60.8830 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.278, mb=0.494, no=0.995, corr=-0.247) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 60.8830
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2826 mb_mean=0.4930 norm_overlap=0.9939 corr_cb=-0.2704 topkJ=0.0189
[TRAIN][ep=030] loss=0.6084 acc=77.85%
[TRAIN][ep=030] mask_avg: mc_mean=0.2547 mb_mean=0.4939 norm_overlap=0.9950 corr_cb=-0.2226
[EPOCH 030/089] train: loss=0.6084 acc=77.85% | val: loss=0.7547 acc=61.45% f1=69.23% auc=60.41% val_score=48.5423 val_score_bestthr=61.6737 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.255, mb=0.494, no=0.995, corr=-0.223) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.6737
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2674 mb_mean=0.4940 norm_overlap=0.9962 corr_cb=-0.1487 topkJ=0.0426
[TRAIN][ep=031] loss=0.5924 acc=77.99%
[TRAIN][ep=031] mask_avg: mc_mean=0.2617 mb_mean=0.4939 norm_overlap=0.9949 corr_cb=-0.2314
[EPOCH 031/089] train: loss=0.5924 acc=77.99% | val: loss=0.7446 acc=60.24% f1=70.80% auc=60.87% val_score=45.9562 val_score_bestthr=62.0678 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.262, mb=0.494, no=0.995, corr=-0.231) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 62.0678
[EARLY STOP] no improvement for 30 epochs. best_epoch=1
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
=============== FIT DONE ===============
[BEST] epoch=1 | val_acc=63.86% | val_f1=71.15% | val_auc=53.78% | val_score=50.1238 | val_score_bestthr=66.6380
[TEST@BEST] thr_used=0.470 | acc=55.56% f1=63.78% auc=60.62% | SP_sex=5.56% EO_sex=19.12% SP_age=2.71% EO_age=14.10%
[TIME] 0.82 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold1_rep1_seed1001/summary_fold_1.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5240 mb_mean=0.4945 norm_overlap=1.0001 corr_cb=0.1063 topkJ=0.0892
[TRAIN][ep=000] loss=0.6959 acc=50.74%
[TRAIN][ep=000] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0637
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5198 mb_mean=0.4964 norm_overlap=1.0000 corr_cb=0.0020 topkJ=0.1618
[TRAIN][ep=001] loss=0.6934 acc=50.07%
[TRAIN][ep=001] mask_avg: mc_mean=0.5235 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0636
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5264 mb_mean=0.4883 norm_overlap=1.0000 corr_cb=0.0372 topkJ=0.1146
[TRAIN][ep=002] loss=0.6920 acc=52.75%
[TRAIN][ep=002] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0591
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5240 mb_mean=0.4973 norm_overlap=0.9999 corr_cb=-0.1065 topkJ=0.0757
[TRAIN][ep=003] loss=0.6908 acc=52.08%
[TRAIN][ep=003] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0640
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5252 mb_mean=0.4946 norm_overlap=1.0001 corr_cb=0.0693 topkJ=0.1075
[TRAIN][ep=004] loss=0.6888 acc=55.84%
[TRAIN][ep=004] mask_avg: mc_mean=0.5235 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0728
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5254 mb_mean=0.4873 norm_overlap=0.9996 corr_cb=-0.3571 topkJ=0.0700
[TRAIN][ep=005] loss=0.6885 acc=57.05%
[TRAIN][ep=005] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0579
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5240 mb_mean=0.4920 norm_overlap=0.9998 corr_cb=-0.2417 topkJ=0.0358
[TRAIN][ep=006] loss=0.6843 acc=57.05%
[TRAIN][ep=006] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0643
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5236 mb_mean=0.4973 norm_overlap=1.0000 corr_cb=0.0089 topkJ=0.0999
[TRAIN][ep=007] loss=0.6810 acc=59.73%
[TRAIN][ep=007] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0694
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5205 mb_mean=0.4927 norm_overlap=0.9997 corr_cb=-0.2425 topkJ=0.0796
[TRAIN][ep=008] loss=0.6817 acc=56.24%
[TRAIN][ep=008] mask_avg: mc_mean=0.5235 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0663
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5252 mb_mean=0.4985 norm_overlap=1.0001 corr_cb=0.1253 topkJ=0.1968
[TRAIN][ep=009] loss=0.6774 acc=58.12%
[TRAIN][ep=009] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0649
================= FIT START (fold=1) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5254 mb_mean=0.4911 norm_overlap=0.9999 corr_cb=-0.1383 topkJ=0.0522
[TRAIN][ep=000] loss=0.6719 acc=60.81%
[TRAIN][ep=000] mask_avg: mc_mean=0.5235 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0647
[EPOCH 000/089] train: loss=0.6719 acc=60.81% | val: loss=0.6893 acc=57.83% f1=71.07% auc=54.94% val_score=57.9692 val_score_bestthr=63.1205 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.065) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 63.1205
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5232 mb_mean=0.4969 norm_overlap=0.9998 corr_cb=-0.2445 topkJ=0.0792
[TRAIN][ep=001] loss=0.6712 acc=59.19%
[TRAIN][ep=001] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0653
[EPOCH 001/089] train: loss=0.6712 acc=59.19% | val: loss=0.6878 acc=63.86% f1=71.15% auc=53.78% val_score=50.1238 val_score_bestthr=66.6380 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.065) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 63.1205 -> 66.6380
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5251 mb_mean=0.4886 norm_overlap=1.0000 corr_cb=-0.0238 topkJ=0.0802
[TRAIN][ep=002] loss=0.6667 acc=61.61%
[TRAIN][ep=002] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0672
[EPOCH 002/089] train: loss=0.6667 acc=61.61% | val: loss=0.6871 acc=62.65% f1=68.69% auc=54.13% val_score=60.1191 val_score_bestthr=61.2270 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.067) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.2270
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5203 mb_mean=0.4927 norm_overlap=1.0000 corr_cb=-0.0206 topkJ=0.0508
[TRAIN][ep=003] loss=0.6612 acc=61.48%
[TRAIN][ep=003] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0645
[EPOCH 003/089] train: loss=0.6612 acc=61.48% | val: loss=0.6909 acc=61.45% f1=71.93% auc=55.00% val_score=54.6289 val_score_bestthr=62.0849 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.064) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 62.0849
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5239 mb_mean=0.4918 norm_overlap=0.9998 corr_cb=-0.2595 topkJ=0.0761
[TRAIN][ep=004] loss=0.6591 acc=63.36%
[TRAIN][ep=004] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0632
[EPOCH 004/089] train: loss=0.6591 acc=63.36% | val: loss=0.6870 acc=61.45% f1=70.91% auc=55.17% val_score=60.1191 val_score_bestthr=63.5375 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.063) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 63.5375
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5228 mb_mean=0.4934 norm_overlap=0.9999 corr_cb=-0.0737 topkJ=0.0499
[TRAIN][ep=005] loss=1.2923 acc=61.21%
[TRAIN][ep=005] mask_avg: mc_mean=0.3741 mb_mean=0.4939 norm_overlap=1.0030 corr_cb=0.5944
[EPOCH 005/089] train: loss=1.2923 acc=61.21% | val: loss=0.6879 acc=61.45% f1=68.63% auc=54.88% val_score=41.1688 val_score_bestthr=62.5080 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.374, mb=0.494, no=1.003, corr=0.594) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 62.5080
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2947 mb_mean=0.4966 norm_overlap=1.0049 corr_cb=0.6711 topkJ=0.2060
[TRAIN][ep=006] loss=1.2760 acc=64.83%
[TRAIN][ep=006] mask_avg: mc_mean=0.2878 mb_mean=0.4939 norm_overlap=1.0047 corr_cb=0.6124
[EPOCH 006/089] train: loss=1.2760 acc=64.83% | val: loss=0.6852 acc=62.65% f1=68.69% auc=55.23% val_score=46.4584 val_score_bestthr=61.2270 | dyn(w_pfs=0.240, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.288, mb=0.494, no=1.005, corr=0.612) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.2270
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2809 mb_mean=0.4963 norm_overlap=1.0043 corr_cb=0.5786 topkJ=0.1953
[TRAIN][ep=007] loss=1.0764 acc=64.43%
[TRAIN][ep=007] mask_avg: mc_mean=0.2711 mb_mean=0.4939 norm_overlap=1.0048 corr_cb=0.5703
[EPOCH 007/089] train: loss=1.0764 acc=64.43% | val: loss=0.6890 acc=59.04% f1=71.19% auc=55.99% val_score=52.0294 val_score_bestthr=61.8550 | dyn(w_pfs=0.140, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.271, mb=0.494, no=1.005, corr=0.570) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.8550
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2738 mb_mean=0.4944 norm_overlap=1.0037 corr_cb=0.4567 topkJ=0.1594
[TRAIN][ep=008] loss=0.8776 acc=61.88%
[TRAIN][ep=008] mask_avg: mc_mean=0.2638 mb_mean=0.4939 norm_overlap=1.0047 corr_cb=0.5296
[EPOCH 008/089] train: loss=0.8776 acc=61.88% | val: loss=0.6921 acc=63.86% f1=70.00% auc=55.58% val_score=38.3641 val_score_bestthr=64.4904 | dyn(w_pfs=0.040, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.264, mb=0.494, no=1.005, corr=0.530) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 64.4904
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2680 mb_mean=0.4943 norm_overlap=1.0035 corr_cb=0.4364 topkJ=0.1357
[TRAIN][ep=009] loss=0.8304 acc=64.03%
[TRAIN][ep=009] mask_avg: mc_mean=0.2627 mb_mean=0.4939 norm_overlap=1.0043 corr_cb=0.4522
[EPOCH 009/089] train: loss=0.8304 acc=64.03% | val: loss=0.6900 acc=62.65% f1=69.31% auc=55.47% val_score=53.4797 val_score_bestthr=64.0147 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.263, mb=0.494, no=1.004, corr=0.452) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 64.0147
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.2324 mb_mean=0.4924 norm_overlap=1.0060 corr_cb=0.4689 topkJ=0.0886
[TRAIN][ep=010] loss=0.8173 acc=65.23%
[TRAIN][ep=010] mask_avg: mc_mean=0.2506 mb_mean=0.4939 norm_overlap=1.0040 corr_cb=0.3876
[EPOCH 010/089] train: loss=0.8173 acc=65.23% | val: loss=0.6916 acc=62.65% f1=69.90% auc=55.70% val_score=63.1662 val_score_bestthr=64.5172 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.251, mb=0.494, no=1.004, corr=0.388) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 64.5172
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.2396 mb_mean=0.4897 norm_overlap=1.0083 corr_cb=0.5195 topkJ=0.0922
[TRAIN][ep=011] loss=0.8039 acc=65.50%
[TRAIN][ep=011] mask_avg: mc_mean=0.2469 mb_mean=0.4939 norm_overlap=1.0034 corr_cb=0.3033
[EPOCH 011/089] train: loss=0.8039 acc=65.50% | val: loss=0.6903 acc=62.65% f1=69.90% auc=56.22% val_score=58.1875 val_score_bestthr=64.5172 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.247, mb=0.494, no=1.003, corr=0.303) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 64.5172
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.2220 mb_mean=0.4961 norm_overlap=1.0026 corr_cb=0.2702 topkJ=0.1197
[TRAIN][ep=012] loss=0.8064 acc=66.31%
[TRAIN][ep=012] mask_avg: mc_mean=0.2363 mb_mean=0.4939 norm_overlap=1.0032 corr_cb=0.2542
[EPOCH 012/089] train: loss=0.8064 acc=66.31% | val: loss=0.6885 acc=61.45% f1=68.63% auc=57.27% val_score=59.6943 val_score_bestthr=62.5080 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.236, mb=0.494, no=1.003, corr=0.254) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 62.5080
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.2282 mb_mean=0.4893 norm_overlap=1.0032 corr_cb=0.3125 topkJ=0.0882
[TRAIN][ep=013] loss=0.8007 acc=67.65%
[TRAIN][ep=013] mask_avg: mc_mean=0.2412 mb_mean=0.4939 norm_overlap=1.0021 corr_cb=0.1613
[EPOCH 013/089] train: loss=0.8007 acc=67.65% | val: loss=0.6888 acc=62.65% f1=69.90% auc=57.03% val_score=63.1662 val_score_bestthr=64.5172 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.241, mb=0.494, no=1.002, corr=0.161) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 64.5172
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.2240 mb_mean=0.4938 norm_overlap=1.0014 corr_cb=0.1361 topkJ=0.1455
[TRAIN][ep=014] loss=0.7785 acc=70.60%
[TRAIN][ep=014] mask_avg: mc_mean=0.2340 mb_mean=0.4939 norm_overlap=1.0014 corr_cb=0.1015
[EPOCH 014/089] train: loss=0.7785 acc=70.60% | val: loss=0.7146 acc=59.04% f1=68.52% auc=56.57% val_score=36.4447 val_score_bestthr=63.1844 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.234, mb=0.494, no=1.001, corr=0.102) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 63.1844
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.2194 mb_mean=0.4908 norm_overlap=1.0039 corr_cb=0.2458 topkJ=0.0755
[TRAIN][ep=015] loss=0.7763 acc=68.86%
[TRAIN][ep=015] mask_avg: mc_mean=0.2325 mb_mean=0.4939 norm_overlap=1.0005 corr_cb=0.0331
[EPOCH 015/089] train: loss=0.7763 acc=68.86% | val: loss=0.6951 acc=65.06% f1=70.10% auc=58.60% val_score=65.4198 val_score_bestthr=65.9325 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.233, mb=0.494, no=1.001, corr=0.033) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 65.9325
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1963 mb_mean=0.4876 norm_overlap=1.0008 corr_cb=0.0540 topkJ=0.0630
[TRAIN][ep=016] loss=0.7712 acc=69.80%
[TRAIN][ep=016] mask_avg: mc_mean=0.2225 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0148
[EPOCH 016/089] train: loss=0.7712 acc=69.80% | val: loss=0.6904 acc=65.06% f1=70.10% auc=58.60% val_score=52.3888 val_score_bestthr=65.9325 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.223, mb=0.494, no=1.000, corr=-0.015) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 65.9325
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.2222 mb_mean=0.4928 norm_overlap=1.0006 corr_cb=0.0408 topkJ=0.0600
[TRAIN][ep=017] loss=0.7533 acc=72.21%
[TRAIN][ep=017] mask_avg: mc_mean=0.2308 mb_mean=0.4939 norm_overlap=0.9987 corr_cb=-0.0794
[EPOCH 017/089] train: loss=0.7533 acc=72.21% | val: loss=0.6905 acc=61.45% f1=69.23% auc=58.72% val_score=48.6574 val_score_bestthr=63.0991 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.231, mb=0.494, no=0.999, corr=-0.079) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 63.0991
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.2346 mb_mean=0.4962 norm_overlap=0.9980 corr_cb=-0.1334 topkJ=0.0329
[TRAIN][ep=018] loss=0.7447 acc=70.87%
[TRAIN][ep=018] mask_avg: mc_mean=0.2415 mb_mean=0.4939 norm_overlap=0.9977 corr_cb=-0.1362
[EPOCH 018/089] train: loss=0.7447 acc=70.87% | val: loss=0.7171 acc=59.04% f1=67.92% auc=58.78% val_score=34.9133 val_score_bestthr=62.0758 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.241, mb=0.494, no=0.998, corr=-0.136) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 62.0758
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.2335 mb_mean=0.4994 norm_overlap=0.9954 corr_cb=-0.2827 topkJ=0.0197
[TRAIN][ep=019] loss=0.7366 acc=71.14%
[TRAIN][ep=019] mask_avg: mc_mean=0.2281 mb_mean=0.4939 norm_overlap=0.9975 corr_cb=-0.1341
[EPOCH 019/089] train: loss=0.7366 acc=71.14% | val: loss=0.6940 acc=61.45% f1=68.00% auc=59.53% val_score=48.4271 val_score_bestthr=62.7735 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.228, mb=0.494, no=0.997, corr=-0.134) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 62.7735
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.2907 mb_mean=0.4996 norm_overlap=0.9957 corr_cb=-0.2578 topkJ=0.0225
[TRAIN][ep=020] loss=0.7372 acc=72.75%
[TRAIN][ep=020] mask_avg: mc_mean=0.2657 mb_mean=0.4939 norm_overlap=0.9962 corr_cb=-0.2064
[EPOCH 020/089] train: loss=0.7372 acc=72.75% | val: loss=0.7627 acc=60.24% f1=70.27% auc=61.10% val_score=43.4652 val_score_bestthr=59.1788 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.266, mb=0.494, no=0.996, corr=-0.206) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 59.1788
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2176 mb_mean=0.4905 norm_overlap=0.9981 corr_cb=-0.0804 topkJ=0.0340
[TRAIN][ep=021] loss=0.7199 acc=72.48%
[TRAIN][ep=021] mask_avg: mc_mean=0.2373 mb_mean=0.4939 norm_overlap=0.9965 corr_cb=-0.1731
[EPOCH 021/089] train: loss=0.7199 acc=72.48% | val: loss=0.6991 acc=61.45% f1=68.63% auc=59.83% val_score=47.8820 val_score_bestthr=61.8464 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.237, mb=0.494, no=0.996, corr=-0.173) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.8464
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2536 mb_mean=0.4935 norm_overlap=0.9962 corr_cb=-0.1817 topkJ=0.0377
[TRAIN][ep=022] loss=0.7128 acc=73.15%
[TRAIN][ep=022] mask_avg: mc_mean=0.2358 mb_mean=0.4939 norm_overlap=0.9962 corr_cb=-0.1785
[EPOCH 022/089] train: loss=0.7128 acc=73.15% | val: loss=0.7107 acc=57.83% f1=70.59% auc=60.29% val_score=53.1065 val_score_bestthr=61.6332 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.236, mb=0.494, no=0.996, corr=-0.178) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.6332
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2786 mb_mean=0.4972 norm_overlap=0.9956 corr_cb=-0.2587 topkJ=0.0291
[TRAIN][ep=023] loss=0.6947 acc=76.24%
[TRAIN][ep=023] mask_avg: mc_mean=0.2618 mb_mean=0.4939 norm_overlap=0.9952 corr_cb=-0.2319
[EPOCH 023/089] train: loss=0.6947 acc=76.24% | val: loss=0.7699 acc=63.86% f1=72.22% auc=59.77% val_score=59.7218 val_score_bestthr=59.7218 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.262, mb=0.494, no=0.995, corr=-0.232) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 59.7218
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2701 mb_mean=0.4985 norm_overlap=0.9950 corr_cb=-0.2548 topkJ=0.0183
[TRAIN][ep=024] loss=0.7120 acc=74.23%
[TRAIN][ep=024] mask_avg: mc_mean=0.2206 mb_mean=0.4939 norm_overlap=0.9963 corr_cb=-0.1588
[EPOCH 024/089] train: loss=0.7120 acc=74.23% | val: loss=0.7083 acc=63.86% f1=71.70% auc=60.06% val_score=44.1225 val_score_bestthr=61.6312 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.221, mb=0.494, no=0.996, corr=-0.159) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.6312
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2647 mb_mean=0.4905 norm_overlap=0.9966 corr_cb=-0.1660 topkJ=0.0325
[TRAIN][ep=025] loss=0.7128 acc=73.15%
[TRAIN][ep=025] mask_avg: mc_mean=0.2580 mb_mean=0.4939 norm_overlap=0.9953 corr_cb=-0.2203
[EPOCH 025/089] train: loss=0.7128 acc=73.15% | val: loss=0.7117 acc=62.65% f1=71.03% auc=60.29% val_score=51.1435 val_score_bestthr=60.4643 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.258, mb=0.494, no=0.995, corr=-0.220) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 60.4643
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2389 mb_mean=0.4946 norm_overlap=0.9971 corr_cb=-0.1453 topkJ=0.0370
[TRAIN][ep=026] loss=0.6826 acc=75.70%
[TRAIN][ep=026] mask_avg: mc_mean=0.2530 mb_mean=0.4939 norm_overlap=0.9951 corr_cb=-0.2195
[EPOCH 026/089] train: loss=0.6826 acc=75.70% | val: loss=0.7193 acc=62.65% f1=71.03% auc=60.23% val_score=56.7315 val_score_bestthr=60.4643 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.253, mb=0.494, no=0.995, corr=-0.219) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 60.4643
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2553 mb_mean=0.4930 norm_overlap=0.9921 corr_cb=-0.2764 topkJ=0.0103
[TRAIN][ep=027] loss=0.6763 acc=75.30%
[TRAIN][ep=027] mask_avg: mc_mean=0.2665 mb_mean=0.4939 norm_overlap=0.9949 corr_cb=-0.2374
[EPOCH 027/089] train: loss=0.6763 acc=75.30% | val: loss=0.7339 acc=63.86% f1=71.70% auc=61.28% val_score=52.4750 val_score_bestthr=61.6312 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.266, mb=0.494, no=0.995, corr=-0.237) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.6312
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2831 mb_mean=0.4937 norm_overlap=0.9951 corr_cb=-0.2869 topkJ=0.0226
[TRAIN][ep=028] loss=0.6791 acc=76.51%
[TRAIN][ep=028] mask_avg: mc_mean=0.2737 mb_mean=0.4939 norm_overlap=0.9947 corr_cb=-0.2502
[EPOCH 028/089] train: loss=0.6791 acc=76.51% | val: loss=0.7368 acc=56.63% f1=69.49% auc=61.80% val_score=49.1570 val_score_bestthr=62.5328 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.274, mb=0.494, no=0.995, corr=-0.250) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 62.5328
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2278 mb_mean=0.4901 norm_overlap=0.9944 corr_cb=-0.2364 topkJ=0.0264
[TRAIN][ep=029] loss=0.6682 acc=77.18%
[TRAIN][ep=029] mask_avg: mc_mean=0.2775 mb_mean=0.4939 norm_overlap=0.9948 corr_cb=-0.2448
[EPOCH 029/089] train: loss=0.6682 acc=77.18% | val: loss=0.7278 acc=62.65% f1=70.48% auc=60.87% val_score=53.5121 val_score_bestthr=61.9875 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.277, mb=0.494, no=0.995, corr=-0.245) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.9875
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2833 mb_mean=0.4930 norm_overlap=0.9940 corr_cb=-0.2666 topkJ=0.0193
[TRAIN][ep=030] loss=0.6624 acc=77.85%
[TRAIN][ep=030] mask_avg: mc_mean=0.2553 mb_mean=0.4939 norm_overlap=0.9951 corr_cb=-0.2214
[EPOCH 030/089] train: loss=0.6624 acc=77.85% | val: loss=0.7529 acc=61.45% f1=69.81% auc=60.47% val_score=48.5423 val_score_bestthr=60.8830 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.255, mb=0.494, no=0.995, corr=-0.221) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 60.8830
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2678 mb_mean=0.4940 norm_overlap=0.9962 corr_cb=-0.1478 topkJ=0.0426
[TRAIN][ep=031] loss=0.6462 acc=77.99%
[TRAIN][ep=031] mask_avg: mc_mean=0.2609 mb_mean=0.4939 norm_overlap=0.9950 corr_cb=-0.2280
[EPOCH 031/089] train: loss=0.6462 acc=77.99% | val: loss=0.7423 acc=60.24% f1=70.80% auc=61.10% val_score=45.9562 val_score_bestthr=62.0678 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.261, mb=0.494, no=0.995, corr=-0.228) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 62.0678
[EARLY STOP] no improvement for 30 epochs. best_epoch=1
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
=============== FIT DONE ===============
[BEST] epoch=1 | val_acc=63.86% | val_f1=71.15% | val_auc=53.78% | val_score=50.1238 | val_score_bestthr=66.6380
[TEST@BEST] thr_used=0.470 | acc=55.56% f1=63.78% auc=60.63% | SP_sex=5.56% EO_sex=19.12% SP_age=2.71% EO_age=14.10%
[TIME] 0.79 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold1_rep1_seed1001/summary_fold_1.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5240 mb_mean=0.4945 norm_overlap=1.0001 corr_cb=0.1063 topkJ=0.0892
[TRAIN][ep=000] loss=0.6959 acc=50.74%
[TRAIN][ep=000] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0637
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5198 mb_mean=0.4964 norm_overlap=1.0000 corr_cb=0.0020 topkJ=0.1618
[TRAIN][ep=001] loss=0.6934 acc=50.07%
[TRAIN][ep=001] mask_avg: mc_mean=0.5235 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0636
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5264 mb_mean=0.4883 norm_overlap=1.0000 corr_cb=0.0372 topkJ=0.1146
[TRAIN][ep=002] loss=0.6920 acc=52.75%
[TRAIN][ep=002] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0591
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5240 mb_mean=0.4973 norm_overlap=0.9999 corr_cb=-0.1065 topkJ=0.0757
[TRAIN][ep=003] loss=0.6908 acc=52.21%
[TRAIN][ep=003] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0640
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5252 mb_mean=0.4946 norm_overlap=1.0001 corr_cb=0.0693 topkJ=0.1075
[TRAIN][ep=004] loss=0.6888 acc=55.84%
[TRAIN][ep=004] mask_avg: mc_mean=0.5235 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0728
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5254 mb_mean=0.4873 norm_overlap=0.9996 corr_cb=-0.3571 topkJ=0.0700
[TRAIN][ep=005] loss=0.6885 acc=57.05%
[TRAIN][ep=005] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0579
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5240 mb_mean=0.4920 norm_overlap=0.9998 corr_cb=-0.2417 topkJ=0.0358
[TRAIN][ep=006] loss=0.6843 acc=57.05%
[TRAIN][ep=006] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0643
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5236 mb_mean=0.4973 norm_overlap=1.0000 corr_cb=0.0089 topkJ=0.0999
[TRAIN][ep=007] loss=0.6810 acc=59.87%
[TRAIN][ep=007] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0694
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5205 mb_mean=0.4927 norm_overlap=0.9997 corr_cb=-0.2425 topkJ=0.0796
[TRAIN][ep=008] loss=0.6817 acc=56.24%
[TRAIN][ep=008] mask_avg: mc_mean=0.5235 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0663
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5252 mb_mean=0.4985 norm_overlap=1.0001 corr_cb=0.1253 topkJ=0.1968
[TRAIN][ep=009] loss=0.6774 acc=58.12%
[TRAIN][ep=009] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0649
================= FIT START (fold=1) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5254 mb_mean=0.4911 norm_overlap=0.9999 corr_cb=-0.1383 topkJ=0.0522
[TRAIN][ep=000] loss=0.6719 acc=60.81%
[TRAIN][ep=000] mask_avg: mc_mean=0.5235 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0647
[EPOCH 000/089] train: loss=0.6719 acc=60.81% | val: loss=0.6894 acc=57.83% f1=71.07% auc=54.94% val_score=57.9692 val_score_bestthr=63.1205 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.065) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 63.1205
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5232 mb_mean=0.4969 norm_overlap=0.9998 corr_cb=-0.2445 topkJ=0.0792
[TRAIN][ep=001] loss=0.6712 acc=59.19%
[TRAIN][ep=001] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0653
[EPOCH 001/089] train: loss=0.6712 acc=59.19% | val: loss=0.6878 acc=63.86% f1=71.15% auc=53.78% val_score=50.1238 val_score_bestthr=66.6380 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.065) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 63.1205 -> 66.6380
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5251 mb_mean=0.4886 norm_overlap=1.0000 corr_cb=-0.0238 topkJ=0.0802
[TRAIN][ep=002] loss=0.6667 acc=61.61%
[TRAIN][ep=002] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0672
[EPOCH 002/089] train: loss=0.6667 acc=61.61% | val: loss=0.6871 acc=62.65% f1=68.69% auc=54.13% val_score=60.1191 val_score_bestthr=61.2270 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.067) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.2270
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5203 mb_mean=0.4927 norm_overlap=1.0000 corr_cb=-0.0206 topkJ=0.0508
[TRAIN][ep=003] loss=0.6613 acc=61.48%
[TRAIN][ep=003] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0645
[EPOCH 003/089] train: loss=0.6613 acc=61.48% | val: loss=0.6909 acc=61.45% f1=71.93% auc=55.00% val_score=54.6289 val_score_bestthr=62.0849 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.064) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 62.0849
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5239 mb_mean=0.4918 norm_overlap=0.9998 corr_cb=-0.2595 topkJ=0.0761
[TRAIN][ep=004] loss=0.6592 acc=63.49%
[TRAIN][ep=004] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0632
[EPOCH 004/089] train: loss=0.6592 acc=63.49% | val: loss=0.6870 acc=61.45% f1=70.91% auc=55.12% val_score=60.1191 val_score_bestthr=63.5375 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.063) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 63.5375
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5228 mb_mean=0.4934 norm_overlap=0.9999 corr_cb=-0.0737 topkJ=0.0499
[TRAIN][ep=005] loss=1.4597 acc=61.34%
[TRAIN][ep=005] mask_avg: mc_mean=0.3741 mb_mean=0.4939 norm_overlap=1.0030 corr_cb=0.5945
[EPOCH 005/089] train: loss=1.4597 acc=61.34% | val: loss=0.6880 acc=61.45% f1=68.63% auc=54.94% val_score=41.1688 val_score_bestthr=62.5080 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.374, mb=0.494, no=1.003, corr=0.595) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 62.5080
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2947 mb_mean=0.4966 norm_overlap=1.0049 corr_cb=0.6713 topkJ=0.2060
[TRAIN][ep=006] loss=1.4392 acc=64.43%
[TRAIN][ep=006] mask_avg: mc_mean=0.2879 mb_mean=0.4939 norm_overlap=1.0047 corr_cb=0.6126
[EPOCH 006/089] train: loss=1.4392 acc=64.43% | val: loss=0.6854 acc=61.45% f1=68.00% auc=55.64% val_score=46.4584 val_score_bestthr=61.3919 | dyn(w_pfs=0.240, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.288, mb=0.494, no=1.005, corr=0.613) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.3919
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2811 mb_mean=0.4963 norm_overlap=1.0043 corr_cb=0.5790 topkJ=0.1953
[TRAIN][ep=007] loss=1.2392 acc=64.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.2713 mb_mean=0.4939 norm_overlap=1.0048 corr_cb=0.5705
[EPOCH 007/089] train: loss=1.2392 acc=64.70% | val: loss=0.6888 acc=59.04% f1=71.19% auc=56.05% val_score=52.0294 val_score_bestthr=61.8550 | dyn(w_pfs=0.140, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.271, mb=0.494, no=1.005, corr=0.571) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.8550
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2740 mb_mean=0.4944 norm_overlap=1.0037 corr_cb=0.4571 topkJ=0.1594
[TRAIN][ep=008] loss=1.0399 acc=62.01%
[TRAIN][ep=008] mask_avg: mc_mean=0.2641 mb_mean=0.4939 norm_overlap=1.0047 corr_cb=0.5301
[EPOCH 008/089] train: loss=1.0399 acc=62.01% | val: loss=0.6921 acc=63.86% f1=70.00% auc=55.41% val_score=38.3641 val_score_bestthr=64.4904 | dyn(w_pfs=0.040, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.264, mb=0.494, no=1.005, corr=0.530) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 64.4904
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2682 mb_mean=0.4943 norm_overlap=1.0035 corr_cb=0.4372 topkJ=0.1362
[TRAIN][ep=009] loss=0.9924 acc=64.03%
[TRAIN][ep=009] mask_avg: mc_mean=0.2628 mb_mean=0.4939 norm_overlap=1.0043 corr_cb=0.4536
[EPOCH 009/089] train: loss=0.9924 acc=64.03% | val: loss=0.6903 acc=62.65% f1=69.31% auc=55.52% val_score=57.9387 val_score_bestthr=64.0147 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.263, mb=0.494, no=1.004, corr=0.454) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 64.0147
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.2330 mb_mean=0.4924 norm_overlap=1.0060 corr_cb=0.4697 topkJ=0.0886
[TRAIN][ep=010] loss=0.9790 acc=64.97%
[TRAIN][ep=010] mask_avg: mc_mean=0.2510 mb_mean=0.4939 norm_overlap=1.0040 corr_cb=0.3886
[EPOCH 010/089] train: loss=0.9790 acc=64.97% | val: loss=0.6918 acc=61.45% f1=69.23% auc=55.87% val_score=58.1393 val_score_bestthr=63.0116 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.251, mb=0.494, no=1.004, corr=0.389) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 63.0116
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.2399 mb_mean=0.4897 norm_overlap=1.0083 corr_cb=0.5204 topkJ=0.0922
[TRAIN][ep=011] loss=0.9648 acc=65.50%
[TRAIN][ep=011] mask_avg: mc_mean=0.2475 mb_mean=0.4939 norm_overlap=1.0034 corr_cb=0.3038
[EPOCH 011/089] train: loss=0.9648 acc=65.50% | val: loss=0.6906 acc=62.65% f1=69.90% auc=56.22% val_score=58.1875 val_score_bestthr=64.5172 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.248, mb=0.494, no=1.003, corr=0.304) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 64.5172
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.2226 mb_mean=0.4961 norm_overlap=1.0025 corr_cb=0.2708 topkJ=0.1202
[TRAIN][ep=012] loss=0.9667 acc=66.44%
[TRAIN][ep=012] mask_avg: mc_mean=0.2366 mb_mean=0.4939 norm_overlap=1.0032 corr_cb=0.2557
[EPOCH 012/089] train: loss=0.9667 acc=66.44% | val: loss=0.6889 acc=60.24% f1=68.57% auc=57.15% val_score=59.6943 val_score_bestthr=62.6392 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.237, mb=0.494, no=1.003, corr=0.256) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 62.6392
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.2287 mb_mean=0.4893 norm_overlap=1.0032 corr_cb=0.3141 topkJ=0.0882
[TRAIN][ep=013] loss=0.9598 acc=68.19%
[TRAIN][ep=013] mask_avg: mc_mean=0.2414 mb_mean=0.4939 norm_overlap=1.0021 corr_cb=0.1628
[EPOCH 013/089] train: loss=0.9598 acc=68.19% | val: loss=0.6885 acc=62.65% f1=69.90% auc=57.15% val_score=58.1393 val_score_bestthr=64.5172 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.241, mb=0.494, no=1.002, corr=0.163) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 64.5172
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.2238 mb_mean=0.4938 norm_overlap=1.0014 corr_cb=0.1380 topkJ=0.1455
[TRAIN][ep=014] loss=0.9376 acc=70.87%
[TRAIN][ep=014] mask_avg: mc_mean=0.2343 mb_mean=0.4939 norm_overlap=1.0014 corr_cb=0.1021
[EPOCH 014/089] train: loss=0.9376 acc=70.87% | val: loss=0.7137 acc=59.04% f1=68.52% auc=56.05% val_score=36.4447 val_score_bestthr=63.1844 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.234, mb=0.494, no=1.001, corr=0.102) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 63.1844
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.2204 mb_mean=0.4908 norm_overlap=1.0038 corr_cb=0.2447 topkJ=0.0755
[TRAIN][ep=015] loss=0.9342 acc=69.26%
[TRAIN][ep=015] mask_avg: mc_mean=0.2334 mb_mean=0.4939 norm_overlap=1.0005 corr_cb=0.0323
[EPOCH 015/089] train: loss=0.9342 acc=69.26% | val: loss=0.6951 acc=65.06% f1=70.10% auc=58.60% val_score=65.4198 val_score_bestthr=65.9325 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.233, mb=0.494, no=1.001, corr=0.032) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 65.9325
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1972 mb_mean=0.4876 norm_overlap=1.0008 corr_cb=0.0531 topkJ=0.0621
[TRAIN][ep=016] loss=0.9285 acc=69.93%
[TRAIN][ep=016] mask_avg: mc_mean=0.2238 mb_mean=0.4939 norm_overlap=0.9998 corr_cb=-0.0168
[EPOCH 016/089] train: loss=0.9285 acc=69.93% | val: loss=0.6908 acc=65.06% f1=70.10% auc=58.66% val_score=52.3888 val_score_bestthr=65.9325 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.224, mb=0.494, no=1.000, corr=-0.017) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 65.9325
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.2224 mb_mean=0.4928 norm_overlap=1.0006 corr_cb=0.0417 topkJ=0.0609
[TRAIN][ep=017] loss=0.9091 acc=71.81%
[TRAIN][ep=017] mask_avg: mc_mean=0.2312 mb_mean=0.4939 norm_overlap=0.9987 corr_cb=-0.0794
[EPOCH 017/089] train: loss=0.9091 acc=71.81% | val: loss=0.6914 acc=61.45% f1=69.23% auc=58.60% val_score=48.6574 val_score_bestthr=63.0991 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.231, mb=0.494, no=0.999, corr=-0.079) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 63.0991
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.2354 mb_mean=0.4962 norm_overlap=0.9980 corr_cb=-0.1325 topkJ=0.0329
[TRAIN][ep=018] loss=0.8984 acc=71.01%
[TRAIN][ep=018] mask_avg: mc_mean=0.2425 mb_mean=0.4939 norm_overlap=0.9977 corr_cb=-0.1373
[EPOCH 018/089] train: loss=0.8984 acc=71.01% | val: loss=0.7160 acc=60.24% f1=68.57% auc=58.72% val_score=34.9133 val_score_bestthr=63.1154 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.243, mb=0.494, no=0.998, corr=-0.137) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 63.1154
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.2336 mb_mean=0.4994 norm_overlap=0.9954 corr_cb=-0.2831 topkJ=0.0201
[TRAIN][ep=019] loss=0.8887 acc=70.87%
[TRAIN][ep=019] mask_avg: mc_mean=0.2278 mb_mean=0.4939 norm_overlap=0.9975 corr_cb=-0.1324
[EPOCH 019/089] train: loss=0.8887 acc=70.87% | val: loss=0.6949 acc=60.24% f1=67.33% auc=59.42% val_score=48.4271 val_score_bestthr=61.5263 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.228, mb=0.494, no=0.998, corr=-0.132) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.5263
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.2909 mb_mean=0.4996 norm_overlap=0.9957 corr_cb=-0.2580 topkJ=0.0229
[TRAIN][ep=020] loss=0.8869 acc=72.89%
[TRAIN][ep=020] mask_avg: mc_mean=0.2674 mb_mean=0.4939 norm_overlap=0.9962 corr_cb=-0.2080
[EPOCH 020/089] train: loss=0.8869 acc=72.89% | val: loss=0.7611 acc=60.24% f1=69.72% auc=60.58% val_score=40.9847 val_score_bestthr=61.6224 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.267, mb=0.494, no=0.996, corr=-0.208) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.6224
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2185 mb_mean=0.4905 norm_overlap=0.9982 corr_cb=-0.0789 topkJ=0.0340
[TRAIN][ep=021] loss=0.8671 acc=72.21%
[TRAIN][ep=021] mask_avg: mc_mean=0.2385 mb_mean=0.4939 norm_overlap=0.9965 corr_cb=-0.1742
[EPOCH 021/089] train: loss=0.8671 acc=72.21% | val: loss=0.7004 acc=60.24% f1=67.96% auc=59.59% val_score=48.4271 val_score_bestthr=60.7417 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.239, mb=0.494, no=0.996, corr=-0.174) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 60.7417
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2539 mb_mean=0.4935 norm_overlap=0.9962 corr_cb=-0.1830 topkJ=0.0364
[TRAIN][ep=022] loss=0.8577 acc=72.89%
[TRAIN][ep=022] mask_avg: mc_mean=0.2364 mb_mean=0.4939 norm_overlap=0.9962 corr_cb=-0.1785
[EPOCH 022/089] train: loss=0.8577 acc=72.89% | val: loss=0.7132 acc=57.83% f1=70.59% auc=60.12% val_score=53.1065 val_score_bestthr=61.6332 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.236, mb=0.494, no=0.996, corr=-0.179) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.6332
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2752 mb_mean=0.4972 norm_overlap=0.9956 corr_cb=-0.2540 topkJ=0.0295
[TRAIN][ep=023] loss=0.8381 acc=76.38%
[TRAIN][ep=023] mask_avg: mc_mean=0.2619 mb_mean=0.4939 norm_overlap=0.9953 corr_cb=-0.2300
[EPOCH 023/089] train: loss=0.8381 acc=76.38% | val: loss=0.7709 acc=61.45% f1=70.91% auc=59.48% val_score=55.2954 val_score_bestthr=58.6352 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.262, mb=0.494, no=0.995, corr=-0.230) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 58.6352
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2698 mb_mean=0.4985 norm_overlap=0.9950 corr_cb=-0.2531 topkJ=0.0187
[TRAIN][ep=024] loss=0.8541 acc=73.69%
[TRAIN][ep=024] mask_avg: mc_mean=0.2232 mb_mean=0.4939 norm_overlap=0.9963 corr_cb=-0.1625
[EPOCH 024/089] train: loss=0.8541 acc=73.69% | val: loss=0.7091 acc=63.86% f1=71.70% auc=59.94% val_score=44.1225 val_score_bestthr=61.6312 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.223, mb=0.494, no=0.996, corr=-0.162) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.6312
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2627 mb_mean=0.4905 norm_overlap=0.9967 corr_cb=-0.1593 topkJ=0.0325
[TRAIN][ep=025] loss=0.8524 acc=73.02%
[TRAIN][ep=025] mask_avg: mc_mean=0.2576 mb_mean=0.4939 norm_overlap=0.9953 corr_cb=-0.2191
[EPOCH 025/089] train: loss=0.8524 acc=73.02% | val: loss=0.7132 acc=62.65% f1=71.03% auc=60.00% val_score=51.1435 val_score_bestthr=60.4643 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.258, mb=0.494, no=0.995, corr=-0.219) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 60.4643
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2380 mb_mean=0.4946 norm_overlap=0.9972 corr_cb=-0.1447 topkJ=0.0370
[TRAIN][ep=026] loss=0.8225 acc=75.70%
[TRAIN][ep=026] mask_avg: mc_mean=0.2523 mb_mean=0.4939 norm_overlap=0.9952 corr_cb=-0.2179
[EPOCH 026/089] train: loss=0.8225 acc=75.70% | val: loss=0.7201 acc=62.65% f1=70.48% auc=60.29% val_score=56.7315 val_score_bestthr=61.9875 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.252, mb=0.494, no=0.995, corr=-0.218) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.9875
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2562 mb_mean=0.4930 norm_overlap=0.9921 corr_cb=-0.2770 topkJ=0.0107
[TRAIN][ep=027] loss=0.8147 acc=75.03%
[TRAIN][ep=027] mask_avg: mc_mean=0.2667 mb_mean=0.4939 norm_overlap=0.9949 corr_cb=-0.2367
[EPOCH 027/089] train: loss=0.8147 acc=75.03% | val: loss=0.7341 acc=63.86% f1=71.70% auc=61.10% val_score=54.5969 val_score_bestthr=61.6312 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.267, mb=0.494, no=0.995, corr=-0.237) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.6312
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2828 mb_mean=0.4937 norm_overlap=0.9951 corr_cb=-0.2856 topkJ=0.0231
[TRAIN][ep=028] loss=0.8185 acc=76.11%
[TRAIN][ep=028] mask_avg: mc_mean=0.2736 mb_mean=0.4939 norm_overlap=0.9947 corr_cb=-0.2493
[EPOCH 028/089] train: loss=0.8185 acc=76.11% | val: loss=0.7394 acc=59.04% f1=70.69% auc=61.74% val_score=49.1570 val_score_bestthr=65.0554 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.274, mb=0.494, no=0.995, corr=-0.249) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 65.0554
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2270 mb_mean=0.4901 norm_overlap=0.9945 corr_cb=-0.2338 topkJ=0.0264
[TRAIN][ep=029] loss=0.8059 acc=76.78%
[TRAIN][ep=029] mask_avg: mc_mean=0.2766 mb_mean=0.4939 norm_overlap=0.9948 corr_cb=-0.2434
[EPOCH 029/089] train: loss=0.8059 acc=76.78% | val: loss=0.7287 acc=60.24% f1=67.96% auc=61.05% val_score=52.1089 val_score_bestthr=61.4205 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.277, mb=0.494, no=0.995, corr=-0.243) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.4205
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2823 mb_mean=0.4930 norm_overlap=0.9941 corr_cb=-0.2632 topkJ=0.0201
[TRAIN][ep=030] loss=0.7985 acc=77.58%
[TRAIN][ep=030] mask_avg: mc_mean=0.2549 mb_mean=0.4939 norm_overlap=0.9951 corr_cb=-0.2201
[EPOCH 030/089] train: loss=0.7985 acc=77.58% | val: loss=0.7536 acc=61.45% f1=69.23% auc=60.41% val_score=48.5423 val_score_bestthr=61.6737 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.255, mb=0.494, no=0.995, corr=-0.220) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.6737
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2673 mb_mean=0.4940 norm_overlap=0.9962 corr_cb=-0.1482 topkJ=0.0426
[TRAIN][ep=031] loss=0.7805 acc=78.12%
[TRAIN][ep=031] mask_avg: mc_mean=0.2599 mb_mean=0.4939 norm_overlap=0.9950 corr_cb=-0.2254
[EPOCH 031/089] train: loss=0.7805 acc=78.12% | val: loss=0.7440 acc=60.24% f1=70.80% auc=61.57% val_score=45.9740 val_score_bestthr=62.0678 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.260, mb=0.494, no=0.995, corr=-0.225) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 62.0678
[EARLY STOP] no improvement for 30 epochs. best_epoch=1
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
=============== FIT DONE ===============
[BEST] epoch=1 | val_acc=63.86% | val_f1=71.15% | val_auc=53.78% | val_score=50.1238 | val_score_bestthr=66.6380
[TEST@BEST] thr_used=0.470 | acc=55.56% f1=63.78% auc=60.63% | SP_sex=5.56% EO_sex=19.12% SP_age=2.71% EO_age=14.10%
[TIME] 0.80 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold1_rep1_seed1001/summary_fold_1.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5240 mb_mean=0.4945 norm_overlap=1.0001 corr_cb=0.1063 topkJ=0.0892
[TRAIN][ep=000] loss=0.6959 acc=50.74%
[TRAIN][ep=000] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0637
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5198 mb_mean=0.4964 norm_overlap=1.0000 corr_cb=0.0020 topkJ=0.1618
[TRAIN][ep=001] loss=0.6934 acc=50.07%
[TRAIN][ep=001] mask_avg: mc_mean=0.5235 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0636
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5264 mb_mean=0.4883 norm_overlap=1.0000 corr_cb=0.0372 topkJ=0.1146
[TRAIN][ep=002] loss=0.6920 acc=52.75%
[TRAIN][ep=002] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0591
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5240 mb_mean=0.4973 norm_overlap=0.9999 corr_cb=-0.1065 topkJ=0.0757
[TRAIN][ep=003] loss=0.6908 acc=52.21%
[TRAIN][ep=003] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0640
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5252 mb_mean=0.4946 norm_overlap=1.0001 corr_cb=0.0693 topkJ=0.1075
[TRAIN][ep=004] loss=0.6888 acc=55.84%
[TRAIN][ep=004] mask_avg: mc_mean=0.5235 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0728
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5254 mb_mean=0.4873 norm_overlap=0.9996 corr_cb=-0.3571 topkJ=0.0700
[TRAIN][ep=005] loss=0.6885 acc=57.05%
[TRAIN][ep=005] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0579
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5240 mb_mean=0.4920 norm_overlap=0.9998 corr_cb=-0.2417 topkJ=0.0358
[TRAIN][ep=006] loss=0.6843 acc=57.05%
[TRAIN][ep=006] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0643
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5236 mb_mean=0.4973 norm_overlap=1.0000 corr_cb=0.0089 topkJ=0.0999
[TRAIN][ep=007] loss=0.6810 acc=59.73%
[TRAIN][ep=007] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0694
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5205 mb_mean=0.4927 norm_overlap=0.9997 corr_cb=-0.2425 topkJ=0.0796
[TRAIN][ep=008] loss=0.6817 acc=56.24%
[TRAIN][ep=008] mask_avg: mc_mean=0.5235 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0663
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5252 mb_mean=0.4985 norm_overlap=1.0001 corr_cb=0.1253 topkJ=0.1968
[TRAIN][ep=009] loss=0.6774 acc=58.12%
[TRAIN][ep=009] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0649
================= FIT START (fold=1) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5254 mb_mean=0.4911 norm_overlap=0.9999 corr_cb=-0.1383 topkJ=0.0522
[TRAIN][ep=000] loss=0.6719 acc=60.81%
[TRAIN][ep=000] mask_avg: mc_mean=0.5235 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0647
[EPOCH 000/089] train: loss=0.6719 acc=60.81% | val: loss=0.6893 acc=57.83% f1=71.07% auc=54.94% val_score=57.9692 val_score_bestthr=63.1205 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.065) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 63.1205
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5232 mb_mean=0.4969 norm_overlap=0.9998 corr_cb=-0.2445 topkJ=0.0792
[TRAIN][ep=001] loss=0.6712 acc=59.19%
[TRAIN][ep=001] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0653
[EPOCH 001/089] train: loss=0.6712 acc=59.19% | val: loss=0.6878 acc=63.86% f1=71.15% auc=53.78% val_score=50.1238 val_score_bestthr=66.6380 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.065) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 63.1205 -> 66.6380
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5251 mb_mean=0.4886 norm_overlap=1.0000 corr_cb=-0.0238 topkJ=0.0802
[TRAIN][ep=002] loss=0.6667 acc=61.61%
[TRAIN][ep=002] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0672
[EPOCH 002/089] train: loss=0.6667 acc=61.61% | val: loss=0.6871 acc=62.65% f1=68.69% auc=54.13% val_score=60.1191 val_score_bestthr=61.2270 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.067) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.2270
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5203 mb_mean=0.4927 norm_overlap=1.0000 corr_cb=-0.0206 topkJ=0.0508
[TRAIN][ep=003] loss=0.6613 acc=61.48%
[TRAIN][ep=003] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0645
[EPOCH 003/089] train: loss=0.6613 acc=61.48% | val: loss=0.6909 acc=60.24% f1=71.30% auc=55.00% val_score=54.6289 val_score_bestthr=59.4663 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.064) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 59.4663
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5239 mb_mean=0.4918 norm_overlap=0.9998 corr_cb=-0.2595 topkJ=0.0761
[TRAIN][ep=004] loss=0.6592 acc=63.36%
[TRAIN][ep=004] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0632
[EPOCH 004/089] train: loss=0.6592 acc=63.36% | val: loss=0.6871 acc=61.45% f1=70.91% auc=55.12% val_score=60.1191 val_score_bestthr=63.5375 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.063) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 63.5375
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5228 mb_mean=0.4934 norm_overlap=0.9999 corr_cb=-0.0737 topkJ=0.0499
[TRAIN][ep=005] loss=1.2552 acc=61.34%
[TRAIN][ep=005] mask_avg: mc_mean=0.3742 mb_mean=0.4939 norm_overlap=1.0030 corr_cb=0.5944
[EPOCH 005/089] train: loss=1.2552 acc=61.34% | val: loss=0.6878 acc=61.45% f1=68.63% auc=54.83% val_score=42.8623 val_score_bestthr=62.5080 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.374, mb=0.494, no=1.003, corr=0.594) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 62.5080
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2947 mb_mean=0.4966 norm_overlap=1.0049 corr_cb=0.6709 topkJ=0.2060
[TRAIN][ep=006] loss=1.2398 acc=65.10%
[TRAIN][ep=006] mask_avg: mc_mean=0.2878 mb_mean=0.4939 norm_overlap=1.0047 corr_cb=0.6123
[EPOCH 006/089] train: loss=1.2398 acc=65.10% | val: loss=0.6850 acc=62.65% f1=68.69% auc=55.23% val_score=46.4584 val_score_bestthr=61.2270 | dyn(w_pfs=0.240, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.288, mb=0.494, no=1.005, corr=0.612) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.2270
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2810 mb_mean=0.4963 norm_overlap=1.0043 corr_cb=0.5784 topkJ=0.1947
[TRAIN][ep=007] loss=1.0403 acc=64.16%
[TRAIN][ep=007] mask_avg: mc_mean=0.2712 mb_mean=0.4939 norm_overlap=1.0048 corr_cb=0.5701
[EPOCH 007/089] train: loss=1.0403 acc=64.16% | val: loss=0.6886 acc=59.04% f1=71.19% auc=56.10% val_score=52.0294 val_score_bestthr=61.8550 | dyn(w_pfs=0.140, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.271, mb=0.494, no=1.005, corr=0.570) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.8550
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2739 mb_mean=0.4944 norm_overlap=1.0037 corr_cb=0.4567 topkJ=0.1594
[TRAIN][ep=008] loss=0.8415 acc=62.01%
[TRAIN][ep=008] mask_avg: mc_mean=0.2639 mb_mean=0.4939 norm_overlap=1.0047 corr_cb=0.5296
[EPOCH 008/089] train: loss=0.8415 acc=62.01% | val: loss=0.6919 acc=63.86% f1=70.00% auc=55.64% val_score=38.3641 val_score_bestthr=64.4904 | dyn(w_pfs=0.040, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.264, mb=0.494, no=1.005, corr=0.530) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 64.4904
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2682 mb_mean=0.4943 norm_overlap=1.0035 corr_cb=0.4364 topkJ=0.1357
[TRAIN][ep=009] loss=0.7943 acc=63.89%
[TRAIN][ep=009] mask_avg: mc_mean=0.2622 mb_mean=0.4939 norm_overlap=1.0043 corr_cb=0.4535
[EPOCH 009/089] train: loss=0.7943 acc=63.89% | val: loss=0.6898 acc=62.65% f1=69.31% auc=55.47% val_score=53.4797 val_score_bestthr=64.0147 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.262, mb=0.494, no=1.004, corr=0.453) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 64.0147
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.2324 mb_mean=0.4924 norm_overlap=1.0060 corr_cb=0.4697 topkJ=0.0886
[TRAIN][ep=010] loss=0.7812 acc=64.97%
[TRAIN][ep=010] mask_avg: mc_mean=0.2507 mb_mean=0.4939 norm_overlap=1.0041 corr_cb=0.3880
[EPOCH 010/089] train: loss=0.7812 acc=64.97% | val: loss=0.6916 acc=62.65% f1=69.90% auc=55.81% val_score=63.1662 val_score_bestthr=64.5172 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.251, mb=0.494, no=1.004, corr=0.388) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 64.5172
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.2393 mb_mean=0.4897 norm_overlap=1.0083 corr_cb=0.5199 topkJ=0.0927
[TRAIN][ep=011] loss=0.7680 acc=65.37%
[TRAIN][ep=011] mask_avg: mc_mean=0.2467 mb_mean=0.4939 norm_overlap=1.0034 corr_cb=0.3039
[EPOCH 011/089] train: loss=0.7680 acc=65.37% | val: loss=0.6902 acc=62.65% f1=69.90% auc=56.16% val_score=58.1875 val_score_bestthr=64.5172 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.247, mb=0.494, no=1.003, corr=0.304) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 64.5172
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.2219 mb_mean=0.4961 norm_overlap=1.0026 corr_cb=0.2701 topkJ=0.1202
[TRAIN][ep=012] loss=0.7706 acc=66.31%
[TRAIN][ep=012] mask_avg: mc_mean=0.2357 mb_mean=0.4939 norm_overlap=1.0032 corr_cb=0.2561
[EPOCH 012/089] train: loss=0.7706 acc=66.31% | val: loss=0.6884 acc=61.45% f1=68.63% auc=57.33% val_score=59.6943 val_score_bestthr=62.5080 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.236, mb=0.494, no=1.003, corr=0.256) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 62.5080
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.2276 mb_mean=0.4893 norm_overlap=1.0033 corr_cb=0.3154 topkJ=0.0877
[TRAIN][ep=013] loss=0.7648 acc=67.92%
[TRAIN][ep=013] mask_avg: mc_mean=0.2411 mb_mean=0.4939 norm_overlap=1.0021 corr_cb=0.1632
[EPOCH 013/089] train: loss=0.7648 acc=67.92% | val: loss=0.6888 acc=62.65% f1=69.90% auc=57.03% val_score=63.1662 val_score_bestthr=64.5172 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.241, mb=0.494, no=1.002, corr=0.163) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 64.5172
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.2238 mb_mean=0.4938 norm_overlap=1.0014 corr_cb=0.1393 topkJ=0.1470
[TRAIN][ep=014] loss=0.7426 acc=70.60%
[TRAIN][ep=014] mask_avg: mc_mean=0.2340 mb_mean=0.4939 norm_overlap=1.0014 corr_cb=0.1040
[EPOCH 014/089] train: loss=0.7426 acc=70.60% | val: loss=0.7149 acc=60.24% f1=69.16% auc=56.69% val_score=36.4447 val_score_bestthr=63.4083 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.234, mb=0.494, no=1.001, corr=0.104) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 63.4083
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.2212 mb_mean=0.4908 norm_overlap=1.0038 corr_cb=0.2444 topkJ=0.0759
[TRAIN][ep=015] loss=0.7407 acc=69.13%
[TRAIN][ep=015] mask_avg: mc_mean=0.2324 mb_mean=0.4939 norm_overlap=1.0006 corr_cb=0.0350
[EPOCH 015/089] train: loss=0.7407 acc=69.13% | val: loss=0.6949 acc=65.06% f1=70.10% auc=58.55% val_score=65.4198 val_score_bestthr=65.9325 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.232, mb=0.494, no=1.001, corr=0.035) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 65.9325
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1962 mb_mean=0.4876 norm_overlap=1.0008 corr_cb=0.0555 topkJ=0.0630
[TRAIN][ep=016] loss=0.7355 acc=69.80%
[TRAIN][ep=016] mask_avg: mc_mean=0.2222 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0121
[EPOCH 016/089] train: loss=0.7355 acc=69.80% | val: loss=0.6901 acc=65.06% f1=70.10% auc=58.60% val_score=52.3888 val_score_bestthr=65.9325 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.222, mb=0.494, no=1.000, corr=-0.012) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 65.9325
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.2222 mb_mean=0.4928 norm_overlap=1.0007 corr_cb=0.0435 topkJ=0.0600
[TRAIN][ep=017] loss=0.7176 acc=71.95%
[TRAIN][ep=017] mask_avg: mc_mean=0.2305 mb_mean=0.4939 norm_overlap=0.9987 corr_cb=-0.0767
[EPOCH 017/089] train: loss=0.7176 acc=71.95% | val: loss=0.6905 acc=61.45% f1=69.23% auc=58.84% val_score=48.6574 val_score_bestthr=63.0991 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.231, mb=0.494, no=0.999, corr=-0.077) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 63.0991
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.2332 mb_mean=0.4962 norm_overlap=0.9981 corr_cb=-0.1282 topkJ=0.0346
[TRAIN][ep=018] loss=0.7093 acc=71.01%
[TRAIN][ep=018] mask_avg: mc_mean=0.2406 mb_mean=0.4939 norm_overlap=0.9978 corr_cb=-0.1328
[EPOCH 018/089] train: loss=0.7093 acc=71.01% | val: loss=0.7175 acc=59.04% f1=67.92% auc=58.66% val_score=39.6987 val_score_bestthr=62.0758 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.241, mb=0.494, no=0.998, corr=-0.133) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 62.0758
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.2331 mb_mean=0.4994 norm_overlap=0.9954 corr_cb=-0.2802 topkJ=0.0201
[TRAIN][ep=019] loss=0.7010 acc=71.01%
[TRAIN][ep=019] mask_avg: mc_mean=0.2270 mb_mean=0.4939 norm_overlap=0.9976 corr_cb=-0.1305
[EPOCH 019/089] train: loss=0.7010 acc=71.01% | val: loss=0.6940 acc=62.65% f1=70.48% auc=59.59% val_score=48.4271 val_score_bestthr=63.5431 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.227, mb=0.494, no=0.998, corr=-0.130) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 63.5431
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.2902 mb_mean=0.4996 norm_overlap=0.9957 corr_cb=-0.2563 topkJ=0.0238
[TRAIN][ep=020] loss=0.7017 acc=72.75%
[TRAIN][ep=020] mask_avg: mc_mean=0.2647 mb_mean=0.4939 norm_overlap=0.9962 corr_cb=-0.2046
[EPOCH 020/089] train: loss=0.7017 acc=72.75% | val: loss=0.7620 acc=60.24% f1=70.27% auc=61.10% val_score=42.7461 val_score_bestthr=59.1788 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.265, mb=0.494, no=0.996, corr=-0.205) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 59.1788
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2176 mb_mean=0.4905 norm_overlap=0.9981 corr_cb=-0.0800 topkJ=0.0348
[TRAIN][ep=021] loss=0.6844 acc=72.48%
[TRAIN][ep=021] mask_avg: mc_mean=0.2364 mb_mean=0.4939 norm_overlap=0.9965 corr_cb=-0.1719
[EPOCH 021/089] train: loss=0.6844 acc=72.48% | val: loss=0.6987 acc=62.65% f1=71.03% auc=59.77% val_score=48.4271 val_score_bestthr=60.4643 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.236, mb=0.494, no=0.996, corr=-0.172) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 60.4643
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2501 mb_mean=0.4935 norm_overlap=0.9963 corr_cb=-0.1778 topkJ=0.0373
[TRAIN][ep=022] loss=0.6776 acc=73.02%
[TRAIN][ep=022] mask_avg: mc_mean=0.2325 mb_mean=0.4939 norm_overlap=0.9963 corr_cb=-0.1729
[EPOCH 022/089] train: loss=0.6776 acc=73.02% | val: loss=0.7098 acc=63.86% f1=72.22% auc=60.41% val_score=54.6875 val_score_bestthr=59.7218 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.233, mb=0.494, no=0.996, corr=-0.173) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 59.7218
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2766 mb_mean=0.4972 norm_overlap=0.9955 corr_cb=-0.2604 topkJ=0.0291
[TRAIN][ep=023] loss=0.6595 acc=75.97%
[TRAIN][ep=023] mask_avg: mc_mean=0.2600 mb_mean=0.4939 norm_overlap=0.9953 corr_cb=-0.2295
[EPOCH 023/089] train: loss=0.6595 acc=75.97% | val: loss=0.7693 acc=62.65% f1=71.56% auc=59.88% val_score=56.7989 val_score_bestthr=58.6176 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.260, mb=0.494, no=0.995, corr=-0.230) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 58.6176
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2706 mb_mean=0.4985 norm_overlap=0.9950 corr_cb=-0.2549 topkJ=0.0179
[TRAIN][ep=024] loss=0.6765 acc=74.23%
[TRAIN][ep=024] mask_avg: mc_mean=0.2210 mb_mean=0.4939 norm_overlap=0.9963 corr_cb=-0.1600
[EPOCH 024/089] train: loss=0.6765 acc=74.23% | val: loss=0.7085 acc=63.86% f1=72.22% auc=60.29% val_score=46.7790 val_score_bestthr=59.7218 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.221, mb=0.494, no=0.996, corr=-0.160) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 59.7218
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2621 mb_mean=0.4905 norm_overlap=0.9966 corr_cb=-0.1619 topkJ=0.0325
[TRAIN][ep=025] loss=0.6775 acc=73.29%
[TRAIN][ep=025] mask_avg: mc_mean=0.2567 mb_mean=0.4939 norm_overlap=0.9953 corr_cb=-0.2194
[EPOCH 025/089] train: loss=0.6775 acc=73.29% | val: loss=0.7124 acc=62.65% f1=71.03% auc=60.52% val_score=51.1435 val_score_bestthr=60.4643 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.257, mb=0.494, no=0.995, corr=-0.219) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 60.4643
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2374 mb_mean=0.4946 norm_overlap=0.9972 corr_cb=-0.1417 topkJ=0.0362
[TRAIN][ep=026] loss=0.6472 acc=75.70%
[TRAIN][ep=026] mask_avg: mc_mean=0.2521 mb_mean=0.4939 norm_overlap=0.9951 corr_cb=-0.2191
[EPOCH 026/089] train: loss=0.6472 acc=75.70% | val: loss=0.7208 acc=62.65% f1=71.03% auc=60.47% val_score=56.7315 val_score_bestthr=60.4643 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.252, mb=0.494, no=0.995, corr=-0.219) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 60.4643
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2504 mb_mean=0.4930 norm_overlap=0.9924 corr_cb=-0.2658 topkJ=0.0111
[TRAIN][ep=027] loss=0.6408 acc=75.57%
[TRAIN][ep=027] mask_avg: mc_mean=0.2654 mb_mean=0.4939 norm_overlap=0.9949 corr_cb=-0.2372
[EPOCH 027/089] train: loss=0.6408 acc=75.57% | val: loss=0.7348 acc=63.86% f1=71.70% auc=61.28% val_score=52.4750 val_score_bestthr=61.6312 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.265, mb=0.494, no=0.995, corr=-0.237) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.6312
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2840 mb_mean=0.4937 norm_overlap=0.9951 corr_cb=-0.2901 topkJ=0.0222
[TRAIN][ep=028] loss=0.6433 acc=76.38%
[TRAIN][ep=028] mask_avg: mc_mean=0.2741 mb_mean=0.4939 norm_overlap=0.9947 corr_cb=-0.2523
[EPOCH 028/089] train: loss=0.6433 acc=76.38% | val: loss=0.7372 acc=56.63% f1=69.49% auc=61.45% val_score=52.4750 val_score_bestthr=62.5328 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.274, mb=0.494, no=0.995, corr=-0.252) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 62.5328
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2297 mb_mean=0.4901 norm_overlap=0.9944 corr_cb=-0.2410 topkJ=0.0256
[TRAIN][ep=029] loss=0.6324 acc=77.32%
[TRAIN][ep=029] mask_avg: mc_mean=0.2760 mb_mean=0.4939 norm_overlap=0.9948 corr_cb=-0.2446
[EPOCH 029/089] train: loss=0.6324 acc=77.32% | val: loss=0.7284 acc=62.65% f1=70.48% auc=60.99% val_score=53.5121 val_score_bestthr=61.9875 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.276, mb=0.494, no=0.995, corr=-0.245) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.9875
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2810 mb_mean=0.4930 norm_overlap=0.9939 corr_cb=-0.2687 topkJ=0.0193
[TRAIN][ep=030] loss=0.6267 acc=77.45%
[TRAIN][ep=030] mask_avg: mc_mean=0.2542 mb_mean=0.4939 norm_overlap=0.9951 corr_cb=-0.2217
[EPOCH 030/089] train: loss=0.6267 acc=77.45% | val: loss=0.7527 acc=61.45% f1=69.81% auc=60.70% val_score=47.3139 val_score_bestthr=60.8830 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.254, mb=0.494, no=0.995, corr=-0.222) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 60.8830
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2669 mb_mean=0.4940 norm_overlap=0.9962 corr_cb=-0.1471 topkJ=0.0422
[TRAIN][ep=031] loss=0.6105 acc=77.85%
[TRAIN][ep=031] mask_avg: mc_mean=0.2601 mb_mean=0.4939 norm_overlap=0.9949 corr_cb=-0.2293
[EPOCH 031/089] train: loss=0.6105 acc=77.85% | val: loss=0.7430 acc=60.24% f1=70.80% auc=61.10% val_score=45.9562 val_score_bestthr=62.0678 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.260, mb=0.494, no=0.995, corr=-0.229) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 62.0678
[EARLY STOP] no improvement for 30 epochs. best_epoch=1
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
=============== FIT DONE ===============
[BEST] epoch=1 | val_acc=63.86% | val_f1=71.15% | val_auc=53.78% | val_score=50.1238 | val_score_bestthr=66.6380
[TEST@BEST] thr_used=0.470 | acc=55.56% f1=63.78% auc=60.63% | SP_sex=5.56% EO_sex=19.12% SP_age=2.71% EO_age=14.10%
[TIME] 0.69 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold1_rep1_seed1001/summary_fold_1.json
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5240 mb_mean=0.4945 norm_overlap=1.0001 corr_cb=0.1063 topkJ=0.0892
[TRAIN][ep=000] loss=0.6959 acc=50.74%
[TRAIN][ep=000] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0637
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5198 mb_mean=0.4964 norm_overlap=1.0000 corr_cb=0.0020 topkJ=0.1618
[TRAIN][ep=001] loss=0.6934 acc=50.07%
[TRAIN][ep=001] mask_avg: mc_mean=0.5235 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0636
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5264 mb_mean=0.4883 norm_overlap=1.0000 corr_cb=0.0372 topkJ=0.1146
[TRAIN][ep=002] loss=0.6920 acc=52.75%
[TRAIN][ep=002] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0591
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5240 mb_mean=0.4973 norm_overlap=0.9999 corr_cb=-0.1065 topkJ=0.0757
[TRAIN][ep=003] loss=0.6908 acc=52.21%
[TRAIN][ep=003] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0640
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5252 mb_mean=0.4946 norm_overlap=1.0001 corr_cb=0.0693 topkJ=0.1075
[TRAIN][ep=004] loss=0.6888 acc=55.84%
[TRAIN][ep=004] mask_avg: mc_mean=0.5235 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0728
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5254 mb_mean=0.4873 norm_overlap=0.9996 corr_cb=-0.3571 topkJ=0.0700
[TRAIN][ep=005] loss=0.6885 acc=57.05%
[TRAIN][ep=005] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0579
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5240 mb_mean=0.4920 norm_overlap=0.9998 corr_cb=-0.2417 topkJ=0.0358
[TRAIN][ep=006] loss=0.6843 acc=57.05%
[TRAIN][ep=006] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0643
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5236 mb_mean=0.4973 norm_overlap=1.0000 corr_cb=0.0089 topkJ=0.0999
[TRAIN][ep=007] loss=0.6810 acc=59.73%
[TRAIN][ep=007] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0694
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5205 mb_mean=0.4927 norm_overlap=0.9997 corr_cb=-0.2425 topkJ=0.0796
[TRAIN][ep=008] loss=0.6817 acc=56.24%
[TRAIN][ep=008] mask_avg: mc_mean=0.5235 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0663
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5252 mb_mean=0.4985 norm_overlap=1.0001 corr_cb=0.1253 topkJ=0.1968
[TRAIN][ep=009] loss=0.6774 acc=58.12%
[TRAIN][ep=009] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0649
================= FIT START (fold=1) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5254 mb_mean=0.4911 norm_overlap=0.9999 corr_cb=-0.1383 topkJ=0.0522
[TRAIN][ep=000] loss=0.6719 acc=60.81%
[TRAIN][ep=000] mask_avg: mc_mean=0.5235 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0647
[EPOCH 000/089] train: loss=0.6719 acc=60.81% | val: loss=0.6894 acc=57.83% f1=71.07% auc=55.00% val_score=57.9692 val_score_bestthr=63.1205 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.065) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 63.1205
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=001] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5232 mb_mean=0.4969 norm_overlap=0.9998 corr_cb=-0.2445 topkJ=0.0792
[TRAIN][ep=001] loss=0.6712 acc=59.19%
[TRAIN][ep=001] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0653
[EPOCH 001/089] train: loss=0.6712 acc=59.19% | val: loss=0.6878 acc=63.86% f1=71.15% auc=53.78% val_score=50.1238 val_score_bestthr=66.6380 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.065) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 63.1205 -> 66.6380
[CKPT] Saved best -> results/ABIDE_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=002] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5251 mb_mean=0.4886 norm_overlap=1.0000 corr_cb=-0.0238 topkJ=0.0802
[TRAIN][ep=002] loss=0.6667 acc=61.61%
[TRAIN][ep=002] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0672
[EPOCH 002/089] train: loss=0.6667 acc=61.61% | val: loss=0.6871 acc=62.65% f1=68.69% auc=54.13% val_score=60.1191 val_score_bestthr=61.2270 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.067) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.2270
[DBG][ep=003] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5203 mb_mean=0.4927 norm_overlap=1.0000 corr_cb=-0.0206 topkJ=0.0508
[TRAIN][ep=003] loss=0.6613 acc=61.61%
[TRAIN][ep=003] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0645
[EPOCH 003/089] train: loss=0.6613 acc=61.61% | val: loss=0.6909 acc=61.45% f1=71.93% auc=55.00% val_score=54.6289 val_score_bestthr=62.0849 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.064) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 62.0849
[DBG][ep=004] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5239 mb_mean=0.4918 norm_overlap=0.9998 corr_cb=-0.2595 topkJ=0.0761
[TRAIN][ep=004] loss=0.6591 acc=63.49%
[TRAIN][ep=004] mask_avg: mc_mean=0.5234 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0632
[EPOCH 004/089] train: loss=0.6591 acc=63.49% | val: loss=0.6871 acc=61.45% f1=70.91% auc=55.17% val_score=60.1191 val_score_bestthr=63.5375 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.523, mb=0.494, no=1.000, corr=-0.063) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 63.5375
[DBG][ep=005] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5228 mb_mean=0.4934 norm_overlap=0.9999 corr_cb=-0.0737 topkJ=0.0499
[TRAIN][ep=005] loss=1.3704 acc=61.34%
[TRAIN][ep=005] mask_avg: mc_mean=0.3738 mb_mean=0.4939 norm_overlap=1.0030 corr_cb=0.5948
[EPOCH 005/089] train: loss=1.3704 acc=61.34% | val: loss=0.6879 acc=61.45% f1=68.63% auc=55.06% val_score=41.1688 val_score_bestthr=62.5080 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.374, mb=0.494, no=1.003, corr=0.595) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 62.5080
[DBG][ep=006] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.2945 mb_mean=0.4966 norm_overlap=1.0049 corr_cb=0.6712 topkJ=0.2060
[TRAIN][ep=006] loss=1.3520 acc=64.43%
[TRAIN][ep=006] mask_avg: mc_mean=0.2877 mb_mean=0.4939 norm_overlap=1.0047 corr_cb=0.6125
[EPOCH 006/089] train: loss=1.3520 acc=64.43% | val: loss=0.6855 acc=62.65% f1=68.69% auc=55.41% val_score=46.4584 val_score_bestthr=61.2270 | dyn(w_pfs=0.240, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.288, mb=0.494, no=1.005, corr=0.613) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.2270
[DBG][ep=007] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.2809 mb_mean=0.4963 norm_overlap=1.0043 corr_cb=0.5788 topkJ=0.1953
[TRAIN][ep=007] loss=1.1580 acc=64.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.2711 mb_mean=0.4939 norm_overlap=1.0048 corr_cb=0.5703
[EPOCH 007/089] train: loss=1.1580 acc=64.70% | val: loss=0.6887 acc=59.04% f1=71.19% auc=56.16% val_score=52.0294 val_score_bestthr=61.8550 | dyn(w_pfs=0.140, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.271, mb=0.494, no=1.005, corr=0.570) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.8550
[DBG][ep=008] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.2738 mb_mean=0.4944 norm_overlap=1.0037 corr_cb=0.4569 topkJ=0.1589
[TRAIN][ep=008] loss=0.9648 acc=61.88%
[TRAIN][ep=008] mask_avg: mc_mean=0.2637 mb_mean=0.4939 norm_overlap=1.0047 corr_cb=0.5301
[EPOCH 008/089] train: loss=0.9648 acc=61.88% | val: loss=0.6920 acc=63.86% f1=70.00% auc=55.58% val_score=38.3641 val_score_bestthr=64.4904 | dyn(w_pfs=0.040, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.264, mb=0.494, no=1.005, corr=0.530) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 64.4904
[DBG][ep=009] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.2680 mb_mean=0.4943 norm_overlap=1.0035 corr_cb=0.4370 topkJ=0.1362
[TRAIN][ep=009] loss=0.9203 acc=63.89%
[TRAIN][ep=009] mask_avg: mc_mean=0.2624 mb_mean=0.4939 norm_overlap=1.0043 corr_cb=0.4538
[EPOCH 009/089] train: loss=0.9203 acc=63.89% | val: loss=0.6900 acc=62.65% f1=69.31% auc=55.47% val_score=53.4797 val_score_bestthr=64.0147 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.262, mb=0.494, no=1.004, corr=0.454) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 64.0147
[DBG][ep=010] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.2329 mb_mean=0.4924 norm_overlap=1.0060 corr_cb=0.4697 topkJ=0.0886
[TRAIN][ep=010] loss=0.9071 acc=65.10%
[TRAIN][ep=010] mask_avg: mc_mean=0.2510 mb_mean=0.4939 norm_overlap=1.0040 corr_cb=0.3885
[EPOCH 010/089] train: loss=0.9071 acc=65.10% | val: loss=0.6916 acc=61.45% f1=69.23% auc=56.05% val_score=58.1393 val_score_bestthr=63.0116 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.251, mb=0.494, no=1.004, corr=0.388) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 63.0116
[DBG][ep=011] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.2398 mb_mean=0.4897 norm_overlap=1.0083 corr_cb=0.5206 topkJ=0.0913
[TRAIN][ep=011] loss=0.8932 acc=65.37%
[TRAIN][ep=011] mask_avg: mc_mean=0.2472 mb_mean=0.4939 norm_overlap=1.0034 corr_cb=0.3043
[EPOCH 011/089] train: loss=0.8932 acc=65.37% | val: loss=0.6905 acc=62.65% f1=69.90% auc=56.10% val_score=58.1875 val_score_bestthr=64.5172 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.247, mb=0.494, no=1.003, corr=0.304) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 64.5172
[DBG][ep=012] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.2225 mb_mean=0.4961 norm_overlap=1.0025 corr_cb=0.2708 topkJ=0.1192
[TRAIN][ep=012] loss=0.8954 acc=66.31%
[TRAIN][ep=012] mask_avg: mc_mean=0.2363 mb_mean=0.4939 norm_overlap=1.0032 corr_cb=0.2557
[EPOCH 012/089] train: loss=0.8954 acc=66.31% | val: loss=0.6887 acc=60.24% f1=68.57% auc=57.09% val_score=59.6943 val_score_bestthr=62.6392 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.236, mb=0.494, no=1.003, corr=0.256) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 62.6392
[DBG][ep=013] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.2285 mb_mean=0.4893 norm_overlap=1.0032 corr_cb=0.3136 topkJ=0.0877
[TRAIN][ep=013] loss=0.8894 acc=67.92%
[TRAIN][ep=013] mask_avg: mc_mean=0.2409 mb_mean=0.4939 norm_overlap=1.0021 corr_cb=0.1636
[EPOCH 013/089] train: loss=0.8894 acc=67.92% | val: loss=0.6886 acc=62.65% f1=69.90% auc=57.03% val_score=63.1662 val_score_bestthr=64.5172 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.241, mb=0.494, no=1.002, corr=0.164) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 64.5172
[DBG][ep=014] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.2223 mb_mean=0.4938 norm_overlap=1.0014 corr_cb=0.1412 topkJ=0.1465
[TRAIN][ep=014] loss=0.8671 acc=70.87%
[TRAIN][ep=014] mask_avg: mc_mean=0.2340 mb_mean=0.4939 norm_overlap=1.0014 corr_cb=0.1041
[EPOCH 014/089] train: loss=0.8671 acc=70.87% | val: loss=0.7138 acc=59.04% f1=68.52% auc=56.40% val_score=36.4447 val_score_bestthr=63.1844 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.234, mb=0.494, no=1.001, corr=0.104) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 63.1844
[DBG][ep=015] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.2195 mb_mean=0.4908 norm_overlap=1.0039 corr_cb=0.2494 topkJ=0.0759
[TRAIN][ep=015] loss=0.8644 acc=68.99%
[TRAIN][ep=015] mask_avg: mc_mean=0.2326 mb_mean=0.4939 norm_overlap=1.0006 corr_cb=0.0361
[EPOCH 015/089] train: loss=0.8644 acc=68.99% | val: loss=0.6949 acc=65.06% f1=70.10% auc=58.78% val_score=65.4198 val_score_bestthr=65.9325 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.233, mb=0.494, no=1.001, corr=0.036) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 65.9325
[DBG][ep=016] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.1979 mb_mean=0.4876 norm_overlap=1.0008 corr_cb=0.0544 topkJ=0.0626
[TRAIN][ep=016] loss=0.8592 acc=70.07%
[TRAIN][ep=016] mask_avg: mc_mean=0.2237 mb_mean=0.4939 norm_overlap=0.9999 corr_cb=-0.0144
[EPOCH 016/089] train: loss=0.8592 acc=70.07% | val: loss=0.6904 acc=65.06% f1=70.10% auc=58.60% val_score=47.8737 val_score_bestthr=65.9325 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.224, mb=0.494, no=1.000, corr=-0.014) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 65.9325
[DBG][ep=017] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.2219 mb_mean=0.4928 norm_overlap=1.0007 corr_cb=0.0447 topkJ=0.0613
[TRAIN][ep=017] loss=0.8407 acc=71.95%
[TRAIN][ep=017] mask_avg: mc_mean=0.2308 mb_mean=0.4939 norm_overlap=0.9987 corr_cb=-0.0768
[EPOCH 017/089] train: loss=0.8407 acc=71.95% | val: loss=0.6914 acc=61.45% f1=69.23% auc=58.60% val_score=48.6574 val_score_bestthr=63.0991 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.231, mb=0.494, no=0.999, corr=-0.077) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 63.0991
[DBG][ep=018] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.2350 mb_mean=0.4962 norm_overlap=0.9981 corr_cb=-0.1292 topkJ=0.0329
[TRAIN][ep=018] loss=0.8315 acc=71.01%
[TRAIN][ep=018] mask_avg: mc_mean=0.2420 mb_mean=0.4939 norm_overlap=0.9977 corr_cb=-0.1346
[EPOCH 018/089] train: loss=0.8315 acc=71.01% | val: loss=0.7173 acc=62.65% f1=69.90% auc=58.90% val_score=34.9133 val_score_bestthr=64.2557 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.242, mb=0.494, no=0.998, corr=-0.135) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 64.2557
[DBG][ep=019] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.2340 mb_mean=0.4994 norm_overlap=0.9954 corr_cb=-0.2816 topkJ=0.0205
[TRAIN][ep=019] loss=0.8229 acc=71.14%
[TRAIN][ep=019] mask_avg: mc_mean=0.2279 mb_mean=0.4939 norm_overlap=0.9976 corr_cb=-0.1313
[EPOCH 019/089] train: loss=0.8229 acc=71.14% | val: loss=0.6952 acc=61.45% f1=68.00% auc=59.53% val_score=48.4271 val_score_bestthr=62.7735 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.228, mb=0.494, no=0.998, corr=-0.131) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 62.7735
[DBG][ep=020] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.2907 mb_mean=0.4996 norm_overlap=0.9957 corr_cb=-0.2569 topkJ=0.0234
[TRAIN][ep=020] loss=0.8225 acc=72.89%
[TRAIN][ep=020] mask_avg: mc_mean=0.2670 mb_mean=0.4939 norm_overlap=0.9962 corr_cb=-0.2060
[EPOCH 020/089] train: loss=0.8225 acc=72.89% | val: loss=0.7627 acc=60.24% f1=69.72% auc=60.76% val_score=41.5677 val_score_bestthr=61.6224 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.267, mb=0.494, no=0.996, corr=-0.206) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.6224
[DBG][ep=021] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2184 mb_mean=0.4905 norm_overlap=0.9982 corr_cb=-0.0782 topkJ=0.0344
[TRAIN][ep=021] loss=0.8043 acc=72.21%
[TRAIN][ep=021] mask_avg: mc_mean=0.2380 mb_mean=0.4939 norm_overlap=0.9965 corr_cb=-0.1718
[EPOCH 021/089] train: loss=0.8043 acc=72.21% | val: loss=0.7006 acc=61.45% f1=68.63% auc=59.71% val_score=48.4271 val_score_bestthr=61.8464 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.238, mb=0.494, no=0.997, corr=-0.172) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.8464
[DBG][ep=022] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2538 mb_mean=0.4935 norm_overlap=0.9963 corr_cb=-0.1820 topkJ=0.0369
[TRAIN][ep=022] loss=0.7959 acc=72.89%
[TRAIN][ep=022] mask_avg: mc_mean=0.2352 mb_mean=0.4939 norm_overlap=0.9962 corr_cb=-0.1752
[EPOCH 022/089] train: loss=0.7959 acc=72.89% | val: loss=0.7130 acc=57.83% f1=70.59% auc=60.12% val_score=53.1065 val_score_bestthr=61.6332 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.235, mb=0.494, no=0.996, corr=-0.175) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.6332
[DBG][ep=023] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2741 mb_mean=0.4972 norm_overlap=0.9957 corr_cb=-0.2521 topkJ=0.0295
[TRAIN][ep=023] loss=0.7771 acc=76.38%
[TRAIN][ep=023] mask_avg: mc_mean=0.2611 mb_mean=0.4939 norm_overlap=0.9953 corr_cb=-0.2281
[EPOCH 023/089] train: loss=0.7771 acc=76.38% | val: loss=0.7698 acc=61.45% f1=70.91% auc=59.24% val_score=55.2954 val_score_bestthr=58.6352 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.261, mb=0.494, no=0.995, corr=-0.228) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 58.6352
[DBG][ep=024] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2685 mb_mean=0.4985 norm_overlap=0.9951 corr_cb=-0.2490 topkJ=0.0187
[TRAIN][ep=024] loss=0.7929 acc=74.09%
[TRAIN][ep=024] mask_avg: mc_mean=0.2229 mb_mean=0.4939 norm_overlap=0.9963 corr_cb=-0.1610
[EPOCH 024/089] train: loss=0.7929 acc=74.09% | val: loss=0.7098 acc=63.86% f1=71.70% auc=59.83% val_score=44.1225 val_score_bestthr=61.6312 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.223, mb=0.494, no=0.996, corr=-0.161) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.6312
[DBG][ep=025] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2627 mb_mean=0.4905 norm_overlap=0.9967 corr_cb=-0.1605 topkJ=0.0325
[TRAIN][ep=025] loss=0.7922 acc=72.89%
[TRAIN][ep=025] mask_avg: mc_mean=0.2564 mb_mean=0.4939 norm_overlap=0.9954 corr_cb=-0.2164
[EPOCH 025/089] train: loss=0.7922 acc=72.89% | val: loss=0.7137 acc=62.65% f1=71.03% auc=60.06% val_score=51.1435 val_score_bestthr=60.4643 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.256, mb=0.494, no=0.995, corr=-0.216) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 60.4643
[DBG][ep=026] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2378 mb_mean=0.4946 norm_overlap=0.9972 corr_cb=-0.1425 topkJ=0.0370
[TRAIN][ep=026] loss=0.7621 acc=75.70%
[TRAIN][ep=026] mask_avg: mc_mean=0.2529 mb_mean=0.4939 norm_overlap=0.9952 corr_cb=-0.2181
[EPOCH 026/089] train: loss=0.7621 acc=75.70% | val: loss=0.7209 acc=62.65% f1=71.03% auc=60.23% val_score=56.7315 val_score_bestthr=60.4643 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.253, mb=0.494, no=0.995, corr=-0.218) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 60.4643
[DBG][ep=027] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2547 mb_mean=0.4930 norm_overlap=0.9922 corr_cb=-0.2741 topkJ=0.0107
[TRAIN][ep=027] loss=0.7548 acc=75.03%
[TRAIN][ep=027] mask_avg: mc_mean=0.2659 mb_mean=0.4939 norm_overlap=0.9950 corr_cb=-0.2353
[EPOCH 027/089] train: loss=0.7548 acc=75.03% | val: loss=0.7363 acc=63.86% f1=71.70% auc=61.05% val_score=54.5969 val_score_bestthr=61.6312 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.266, mb=0.494, no=0.995, corr=-0.235) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.6312
[DBG][ep=028] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2832 mb_mean=0.4937 norm_overlap=0.9952 corr_cb=-0.2860 topkJ=0.0231
[TRAIN][ep=028] loss=0.7573 acc=76.38%
[TRAIN][ep=028] mask_avg: mc_mean=0.2733 mb_mean=0.4939 norm_overlap=0.9947 corr_cb=-0.2487
[EPOCH 028/089] train: loss=0.7573 acc=76.38% | val: loss=0.7413 acc=57.83% f1=70.09% auc=61.63% val_score=49.9659 val_score_bestthr=63.6833 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.273, mb=0.494, no=0.995, corr=-0.249) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 63.6833
[DBG][ep=029] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2292 mb_mean=0.4901 norm_overlap=0.9945 corr_cb=-0.2357 topkJ=0.0264
[TRAIN][ep=029] loss=0.7456 acc=76.78%
[TRAIN][ep=029] mask_avg: mc_mean=0.2769 mb_mean=0.4939 norm_overlap=0.9948 corr_cb=-0.2433
[EPOCH 029/089] train: loss=0.7456 acc=76.78% | val: loss=0.7294 acc=60.24% f1=67.96% auc=60.81% val_score=50.8467 val_score_bestthr=61.4205 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.277, mb=0.494, no=0.995, corr=-0.243) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.4205
[DBG][ep=030] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2820 mb_mean=0.4930 norm_overlap=0.9941 corr_cb=-0.2625 topkJ=0.0197
[TRAIN][ep=030] loss=0.7382 acc=77.45%
[TRAIN][ep=030] mask_avg: mc_mean=0.2548 mb_mean=0.4939 norm_overlap=0.9951 corr_cb=-0.2195
[EPOCH 030/089] train: loss=0.7382 acc=77.45% | val: loss=0.7539 acc=61.45% f1=69.23% auc=60.41% val_score=48.5423 val_score_bestthr=61.6737 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.255, mb=0.494, no=0.995, corr=-0.220) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 61.6737
[DBG][ep=031] disease_pos_weight=0.9774 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2667 mb_mean=0.4940 norm_overlap=0.9963 corr_cb=-0.1456 topkJ=0.0426
[TRAIN][ep=031] loss=0.7206 acc=78.12%
[TRAIN][ep=031] mask_avg: mc_mean=0.2610 mb_mean=0.4939 norm_overlap=0.9950 corr_cb=-0.2267
[EPOCH 031/089] train: loss=0.7206 acc=78.12% | val: loss=0.7446 acc=60.24% f1=70.80% auc=61.22% val_score=45.9740 val_score_bestthr=62.0678 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.261, mb=0.494, no=0.995, corr=-0.227) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.6380 -> 62.0678
[EARLY STOP] no improvement for 30 epochs. best_epoch=1
[CKPT] Loaded best for testing: results/ABIDE_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
=============== FIT DONE ===============
[BEST] epoch=1 | val_acc=63.86% | val_f1=71.15% | val_auc=53.78% | val_score=50.1238 | val_score_bestthr=66.6380
[TEST@BEST] thr_used=0.470 | acc=55.56% f1=63.78% auc=60.62% | SP_sex=5.56% EO_sex=19.12% SP_age=2.71% EO_age=14.10%
[TIME] 0.80 min
[OK] Saved: results/ABIDE_3x5fold_seed0/fold1_rep1_seed1001/summary_fold_1.json
