[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4784 mb_mean=0.5063 norm_overlap=0.9999 corr_cb=-0.0928 topkJ=0.0294
[TRAIN][ep=000] loss=0.6710 acc=63.77%
[TRAIN][ep=000] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0078
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4808 mb_mean=0.5078 norm_overlap=0.9999 corr_cb=-0.1127 topkJ=0.0310
[TRAIN][ep=001] loss=0.6646 acc=63.77%
[TRAIN][ep=001] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0102
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4792 mb_mean=0.5067 norm_overlap=1.0000 corr_cb=0.0224 topkJ=0.0484
[TRAIN][ep=002] loss=0.6608 acc=63.77%
[TRAIN][ep=002] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0054
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4787 mb_mean=0.5076 norm_overlap=0.9997 corr_cb=-0.3063 topkJ=0.0248
[TRAIN][ep=003] loss=0.6578 acc=63.77%
[TRAIN][ep=003] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0074
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4810 mb_mean=0.5098 norm_overlap=1.0000 corr_cb=0.0354 topkJ=0.0553
[TRAIN][ep=004] loss=0.6568 acc=63.77%
[TRAIN][ep=004] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0056
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4798 mb_mean=0.5070 norm_overlap=1.0000 corr_cb=-0.0288 topkJ=0.0211
[TRAIN][ep=005] loss=0.6552 acc=63.77%
[TRAIN][ep=005] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0076
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4802 mb_mean=0.5083 norm_overlap=1.0001 corr_cb=0.0978 topkJ=0.0511
[TRAIN][ep=006] loss=0.6542 acc=63.77%
[TRAIN][ep=006] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0103
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4799 mb_mean=0.5072 norm_overlap=1.0000 corr_cb=-0.0156 topkJ=0.0413
[TRAIN][ep=007] loss=0.6530 acc=63.77%
[TRAIN][ep=007] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0058
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4788 mb_mean=0.5063 norm_overlap=0.9999 corr_cb=-0.1226 topkJ=0.0341
[TRAIN][ep=008] loss=0.6521 acc=63.77%
[TRAIN][ep=008] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0077
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4796 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=0.0434 topkJ=0.0713
[TRAIN][ep=009] loss=0.6503 acc=63.77%
[TRAIN][ep=009] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0082
================= FIT START (fold=2) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.35 select_by=val_score | eval_thr_mode=best_acc eval_thr_grid=coarse | disease_pos_weight_mode=none freeze_b_after=15 | two_stage=True stage1_ratio=0.35 stage2_lr_mult=0.3 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4807 mb_mean=0.5078 norm_overlap=1.0000 corr_cb=0.0284 topkJ=0.0655
[TRAIN][ep=000] loss=0.6497 acc=63.77%
[TRAIN][ep=000] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0057
[EPOCH 000/089] train: loss=0.6497 acc=63.77% | val: loss=0.6514 acc=69.35% f1=34.48% auc=66.22% val_score=69.0522 val_score_bestthr=85.2797 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.480, mb=0.508, no=1.000, corr=-0.006) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* -1000000000000000000.0000 -> 69.0522
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4809 mb_mean=0.5072 norm_overlap=1.0001 corr_cb=0.1026 topkJ=0.1054
[TRAIN][ep=001] loss=0.6477 acc=63.77%
[TRAIN][ep=001] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0084
[EPOCH 001/089] train: loss=0.6477 acc=63.77% | val: loss=0.6505 acc=70.97% f1=47.06% auc=66.56% val_score=65.7902 val_score_bestthr=93.2489 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.480, mb=0.508, no=1.000, corr=-0.008) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 69.0522 -> 65.7902
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4802 mb_mean=0.5075 norm_overlap=1.0000 corr_cb=0.0222 topkJ=0.0557
[TRAIN][ep=002] loss=0.6468 acc=63.77%
[TRAIN][ep=002] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0048
[EPOCH 002/089] train: loss=0.6468 acc=63.77% | val: loss=0.6494 acc=70.97% f1=50.00% auc=66.00% val_score=69.8259 val_score_bestthr=95.0010 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.480, mb=0.508, no=1.000, corr=-0.005) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 69.0522 -> 69.8259
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4773 mb_mean=0.5082 norm_overlap=1.0001 corr_cb=0.1498 topkJ=0.1079
[TRAIN][ep=003] loss=0.6447 acc=63.77%
[TRAIN][ep=003] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0071
[EPOCH 003/089] train: loss=0.6447 acc=63.77% | val: loss=0.6483 acc=69.35% f1=42.42% auc=67.22% val_score=71.7551 val_score_bestthr=89.5496 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.480, mb=0.508, no=1.000, corr=-0.007) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 69.8259 -> 71.7551
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4801 mb_mean=0.5075 norm_overlap=0.9999 corr_cb=-0.1147 topkJ=0.0525
[TRAIN][ep=004] loss=0.6429 acc=63.77%
[TRAIN][ep=004] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0086
[EPOCH 004/089] train: loss=0.6429 acc=63.77% | val: loss=0.6467 acc=72.58% f1=45.16% auc=67.45% val_score=77.0365 val_score_bestthr=94.1547 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.480, mb=0.508, no=1.000, corr=-0.009) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 71.7551 -> 77.0365
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4786 mb_mean=0.5078 norm_overlap=1.0001 corr_cb=0.1409 topkJ=0.1263
[TRAIN][ep=005] loss=2.1933 acc=63.77%
[TRAIN][ep=005] mask_avg: mc_mean=0.4764 mb_mean=0.5011 norm_overlap=1.0002 corr_cb=0.1712
[EPOCH 005/089] train: loss=2.1933 acc=63.77% | val: loss=0.6490 acc=69.35% f1=42.42% auc=66.89% val_score=92.7790 val_score_bestthr=89.2722 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.476, mb=0.501, no=1.000, corr=0.171) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 77.0365 -> 92.7790
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4708 mb_mean=0.4925 norm_overlap=1.0009 corr_cb=0.5505 topkJ=0.1507
[TRAIN][ep=006] loss=2.1858 acc=63.77%
[TRAIN][ep=006] mask_avg: mc_mean=0.4673 mb_mean=0.4840 norm_overlap=1.0006 corr_cb=0.3520
[EPOCH 006/089] train: loss=2.1858 acc=63.77% | val: loss=0.6477 acc=69.35% f1=51.28% auc=67.00% val_score=80.4100 val_score_bestthr=93.7937 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.467, mb=0.484, no=1.001, corr=0.352) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 80.4100
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4624 mb_mean=0.4746 norm_overlap=1.0006 corr_cb=0.3312 topkJ=0.1247
[TRAIN][ep=007] loss=2.1795 acc=63.77%
[TRAIN][ep=007] mask_avg: mc_mean=0.4565 mb_mean=0.4638 norm_overlap=1.0013 corr_cb=0.4275
[EPOCH 007/089] train: loss=2.1795 acc=63.77% | val: loss=0.6462 acc=70.97% f1=50.00% auc=67.67% val_score=87.1176 val_score_bestthr=94.9540 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.457, mb=0.464, no=1.001, corr=0.427) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 87.1176
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4506 mb_mean=0.4552 norm_overlap=1.0012 corr_cb=0.3828 topkJ=0.1115
[TRAIN][ep=008] loss=1.4653 acc=63.77%
[TRAIN][ep=008] mask_avg: mc_mean=0.4453 mb_mean=0.4407 norm_overlap=1.0023 corr_cb=0.4669
[EPOCH 008/089] train: loss=1.4653 acc=63.77% | val: loss=0.6446 acc=70.97% f1=50.00% auc=67.45% val_score=81.4369 val_score_bestthr=95.0010 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.445, mb=0.441, no=1.002, corr=0.467) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 81.4369
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4380 mb_mean=0.4231 norm_overlap=1.0023 corr_cb=0.4489 topkJ=0.1630
[TRAIN][ep=009] loss=0.7559 acc=63.77%
[TRAIN][ep=009] mask_avg: mc_mean=0.4336 mb_mean=0.4153 norm_overlap=1.0036 corr_cb=0.4745
[EPOCH 009/089] train: loss=0.7559 acc=63.77% | val: loss=0.6433 acc=69.35% f1=45.71% auc=67.67% val_score=85.1307 val_score_bestthr=91.1571 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.434, mb=0.415, no=1.004, corr=0.474) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 85.1307
[DBG][ep=010] disease_pos_weight=1.0000 mode=none
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.4288 mb_mean=0.3982 norm_overlap=1.0051 corr_cb=0.5522 topkJ=0.1903
[TRAIN][ep=010] loss=0.5798 acc=63.77%
[TRAIN][ep=010] mask_avg: mc_mean=0.4214 mb_mean=0.3889 norm_overlap=1.0049 corr_cb=0.4356
[EPOCH 010/089] train: loss=0.5798 acc=63.77% | val: loss=0.6410 acc=70.97% f1=43.75% auc=68.00% val_score=85.5165 val_score_bestthr=91.7940 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.421, mb=0.389, no=1.005, corr=0.436) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 85.5165
[DBG][ep=011] disease_pos_weight=1.0000 mode=none
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.4163 mb_mean=0.3765 norm_overlap=1.0050 corr_cb=0.3789 topkJ=0.1314
[TRAIN][ep=011] loss=0.5610 acc=63.77%
[TRAIN][ep=011] mask_avg: mc_mean=0.4090 mb_mean=0.3632 norm_overlap=1.0056 corr_cb=0.3384
[EPOCH 011/089] train: loss=0.5610 acc=63.77% | val: loss=0.6385 acc=70.97% f1=40.00% auc=68.56% val_score=85.0682 val_score_bestthr=89.9892 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.409, mb=0.363, no=1.006, corr=0.338) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 85.0682
[DBG][ep=012] disease_pos_weight=1.0000 mode=none
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.4066 mb_mean=0.3556 norm_overlap=1.0039 corr_cb=0.2621 topkJ=0.1904
[TRAIN][ep=012] loss=0.5551 acc=63.77%
[TRAIN][ep=012] mask_avg: mc_mean=0.3959 mb_mean=0.3399 norm_overlap=1.0041 corr_cb=0.1720
[EPOCH 012/089] train: loss=0.5551 acc=63.77% | val: loss=0.6358 acc=69.35% f1=55.81% auc=68.56% val_score=91.9623 val_score_bestthr=96.4956 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.396, mb=0.340, no=1.004, corr=0.172) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 91.9623
[DBG][ep=013] disease_pos_weight=1.0000 mode=none
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.3844 mb_mean=0.3232 norm_overlap=1.0062 corr_cb=0.1988 topkJ=0.1061
[TRAIN][ep=013] loss=0.8305 acc=63.95%
[TRAIN][ep=013] mask_avg: mc_mean=0.3830 mb_mean=0.3194 norm_overlap=0.9994 corr_cb=-0.0191
[EPOCH 013/089] train: loss=0.8305 acc=63.95% | val: loss=0.6336 acc=70.97% f1=40.00% auc=68.45% val_score=87.5649 val_score_bestthr=89.9892 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.383, mb=0.319, no=0.999, corr=-0.019) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 87.5649
[DBG][ep=014] disease_pos_weight=1.0000 mode=none
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.3837 mb_mean=0.3225 norm_overlap=0.9966 corr_cb=-0.0985 topkJ=0.0716
[TRAIN][ep=014] loss=1.1064 acc=63.95%
[TRAIN][ep=014] mask_avg: mc_mean=0.3691 mb_mean=0.3025 norm_overlap=0.9897 corr_cb=-0.2009
[EPOCH 014/089] train: loss=1.1064 acc=63.95% | val: loss=0.6320 acc=70.97% f1=40.00% auc=67.89% val_score=86.2487 val_score_bestthr=89.9892 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.369, mb=0.303, no=0.990, corr=-0.201) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 86.2487
[DBG][ep=015] disease_pos_weight=1.0000 mode=none
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.3625 mb_mean=0.3019 norm_overlap=0.9834 corr_cb=-0.2868 topkJ=0.0164
[TRAIN][ep=015] loss=1.3832 acc=64.31%
[TRAIN][ep=015] mask_avg: mc_mean=0.3592 mb_mean=0.2952 norm_overlap=0.9778 corr_cb=-0.3509
[EPOCH 015/089] train: loss=1.3832 acc=64.31% | val: loss=0.6317 acc=70.97% f1=40.00% auc=68.34% val_score=83.7773 val_score_bestthr=89.9892 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.359, mb=0.295, no=0.978, corr=-0.351) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 83.7773
[DBG][ep=016] disease_pos_weight=1.0000 mode=none
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.3469 mb_mean=0.3059 norm_overlap=0.9718 corr_cb=-0.4231 topkJ=0.0110
[TRAIN][ep=016] loss=1.6472 acc=64.13%
[TRAIN][ep=016] mask_avg: mc_mean=0.3490 mb_mean=0.2952 norm_overlap=0.9683 corr_cb=-0.4218
[EPOCH 016/089] train: loss=1.6472 acc=64.13% | val: loss=0.6295 acc=70.97% f1=40.00% auc=67.45% val_score=82.9854 val_score_bestthr=89.9892 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.349, mb=0.295, no=0.968, corr=-0.422) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 82.9854
[DBG][ep=017] disease_pos_weight=1.0000 mode=none
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.3541 mb_mean=0.3033 norm_overlap=0.9613 corr_cb=-0.5211 topkJ=0.0017
[TRAIN][ep=017] loss=1.9216 acc=64.31%
[TRAIN][ep=017] mask_avg: mc_mean=0.3391 mb_mean=0.2952 norm_overlap=0.9584 corr_cb=-0.4686
[EPOCH 017/089] train: loss=1.9216 acc=64.31% | val: loss=0.6287 acc=69.35% f1=38.71% auc=66.67% val_score=91.6801 val_score_bestthr=87.7068 | dyn(w_pfs=0.100, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.339, mb=0.295, no=0.958, corr=-0.469) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 91.6801
[DBG][ep=018] disease_pos_weight=1.0000 mode=none
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.3364 mb_mean=0.3045 norm_overlap=0.9575 corr_cb=-0.4544 topkJ=0.0020
[TRAIN][ep=018] loss=1.2107 acc=65.04%
[TRAIN][ep=018] mask_avg: mc_mean=0.3306 mb_mean=0.2952 norm_overlap=0.9497 corr_cb=-0.5060
[EPOCH 018/089] train: loss=1.2107 acc=65.04% | val: loss=0.6242 acc=70.97% f1=40.00% auc=66.22% val_score=90.1560 val_score_bestthr=89.9892 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.331, mb=0.295, no=0.950, corr=-0.506) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 90.1560
[DBG][ep=019] disease_pos_weight=1.0000 mode=none
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.3211 mb_mean=0.2736 norm_overlap=0.9285 corr_cb=-0.5348 topkJ=0.0016
[TRAIN][ep=019] loss=0.5052 acc=65.58%
[TRAIN][ep=019] mask_avg: mc_mean=0.3215 mb_mean=0.2952 norm_overlap=0.9397 corr_cb=-0.5335
[EPOCH 019/089] train: loss=0.5052 acc=65.58% | val: loss=0.6197 acc=69.35% f1=38.71% auc=67.34% val_score=82.4688 val_score_bestthr=87.7370 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.321, mb=0.295, no=0.940, corr=-0.533) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 82.4688
[DBG][ep=020] disease_pos_weight=1.0000 mode=none
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.3222 mb_mean=0.2995 norm_overlap=0.9196 corr_cb=-0.6426 topkJ=0.0008
[TRAIN][ep=020] loss=0.4935 acc=71.38%
[TRAIN][ep=020] mask_avg: mc_mean=0.3138 mb_mean=0.2952 norm_overlap=0.9294 corr_cb=-0.5653
[EPOCH 020/089] train: loss=0.4935 acc=71.38% | val: loss=0.6177 acc=70.97% f1=40.00% auc=68.34% val_score=89.9094 val_score_bestthr=89.9892 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.314, mb=0.295, no=0.929, corr=-0.565) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 89.9094
[DBG][ep=021] disease_pos_weight=1.0000 mode=none
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.3093 mb_mean=0.2987 norm_overlap=0.9122 corr_cb=-0.6608 topkJ=0.0000
[TRAIN][ep=021] loss=0.4842 acc=68.30%
[TRAIN][ep=021] mask_avg: mc_mean=0.3055 mb_mean=0.2952 norm_overlap=0.9183 corr_cb=-0.5834
[EPOCH 021/089] train: loss=0.4842 acc=68.30% | val: loss=0.6109 acc=69.35% f1=34.48% auc=67.67% val_score=88.7228 val_score_bestthr=85.6635 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.306, mb=0.295, no=0.918, corr=-0.583) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 88.7228
[DBG][ep=022] disease_pos_weight=1.0000 mode=none
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2954 mb_mean=0.3025 norm_overlap=0.9202 corr_cb=-0.6515 topkJ=0.0004
[TRAIN][ep=022] loss=0.4760 acc=70.65%
[TRAIN][ep=022] mask_avg: mc_mean=0.2983 mb_mean=0.2952 norm_overlap=0.9081 corr_cb=-0.5991
[EPOCH 022/089] train: loss=0.4760 acc=70.65% | val: loss=0.6084 acc=69.35% f1=34.48% auc=67.56% val_score=88.7228 val_score_bestthr=85.6635 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.298, mb=0.295, no=0.908, corr=-0.599) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 88.7228
[DBG][ep=023] disease_pos_weight=1.0000 mode=none
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2969 mb_mean=0.2991 norm_overlap=0.9174 corr_cb=-0.5813 topkJ=0.0004
[TRAIN][ep=023] loss=0.4649 acc=71.74%
[TRAIN][ep=023] mask_avg: mc_mean=0.2933 mb_mean=0.2952 norm_overlap=0.8993 corr_cb=-0.6132
[EPOCH 023/089] train: loss=0.4649 acc=71.74% | val: loss=0.6056 acc=69.35% f1=34.48% auc=68.12% val_score=89.2527 val_score_bestthr=85.6635 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.293, mb=0.295, no=0.899, corr=-0.613) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 89.2527
[DBG][ep=024] disease_pos_weight=1.0000 mode=none
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2996 mb_mean=0.3003 norm_overlap=0.9073 corr_cb=-0.5859 topkJ=0.0000
[TRAIN][ep=024] loss=0.4556 acc=74.64%
[TRAIN][ep=024] mask_avg: mc_mean=0.2876 mb_mean=0.2953 norm_overlap=0.8898 corr_cb=-0.6228
[EPOCH 024/089] train: loss=0.4556 acc=74.64% | val: loss=0.6078 acc=69.35% f1=34.48% auc=68.00% val_score=85.5066 val_score_bestthr=85.6635 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.288, mb=0.295, no=0.890, corr=-0.623) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 85.5066
[DBG][ep=025] disease_pos_weight=1.0000 mode=none
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2689 mb_mean=0.2913 norm_overlap=0.9231 corr_cb=-0.4555 topkJ=0.0000
[TRAIN][ep=025] loss=0.4453 acc=73.91%
[TRAIN][ep=025] mask_avg: mc_mean=0.2833 mb_mean=0.2953 norm_overlap=0.8809 corr_cb=-0.6335
[EPOCH 025/089] train: loss=0.4453 acc=73.91% | val: loss=0.6155 acc=67.74% f1=37.50% auc=66.78% val_score=83.7279 val_score_bestthr=85.4359 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.283, mb=0.295, no=0.881, corr=-0.634) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 83.7279
[DBG][ep=026] disease_pos_weight=1.0000 mode=none
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2745 mb_mean=0.3015 norm_overlap=0.8688 corr_cb=-0.7402 topkJ=0.0000
[TRAIN][ep=026] loss=0.4377 acc=75.91%
[TRAIN][ep=026] mask_avg: mc_mean=0.2798 mb_mean=0.2952 norm_overlap=0.8725 corr_cb=-0.6485
[EPOCH 026/089] train: loss=0.4377 acc=75.91% | val: loss=0.6107 acc=69.35% f1=38.71% auc=67.00% val_score=84.2453 val_score_bestthr=87.7370 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.280, mb=0.295, no=0.873, corr=-0.649) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 84.2453
[DBG][ep=027] disease_pos_weight=1.0000 mode=none
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2514 mb_mean=0.2914 norm_overlap=0.9024 corr_cb=-0.5073 topkJ=0.0000
[TRAIN][ep=027] loss=0.4310 acc=76.27%
[TRAIN][ep=027] mask_avg: mc_mean=0.2763 mb_mean=0.2952 norm_overlap=0.8644 corr_cb=-0.6556
[EPOCH 027/089] train: loss=0.4310 acc=76.27% | val: loss=0.6240 acc=67.74% f1=41.18% auc=66.44% val_score=81.6832 val_score_bestthr=87.3634 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.276, mb=0.295, no=0.864, corr=-0.656) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 81.6832
[DBG][ep=028] disease_pos_weight=1.0000 mode=none
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2685 mb_mean=0.3033 norm_overlap=0.8739 corr_cb=-0.6915 topkJ=0.0000
[TRAIN][ep=028] loss=0.4196 acc=77.90%
[TRAIN][ep=028] mask_avg: mc_mean=0.2731 mb_mean=0.2952 norm_overlap=0.8567 corr_cb=-0.6661
[EPOCH 028/089] train: loss=0.4196 acc=77.90% | val: loss=0.6230 acc=69.35% f1=38.71% auc=65.55% val_score=81.2832 val_score_bestthr=87.7370 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.273, mb=0.295, no=0.857, corr=-0.666) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 81.2832
[DBG][ep=029] disease_pos_weight=1.0000 mode=none
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2797 mb_mean=0.2924 norm_overlap=0.8671 corr_cb=-0.6106 topkJ=0.0000
[TRAIN][ep=029] loss=0.4105 acc=80.25%
[TRAIN][ep=029] mask_avg: mc_mean=0.2703 mb_mean=0.2952 norm_overlap=0.8496 corr_cb=-0.6741
[EPOCH 029/089] train: loss=0.4105 acc=80.25% | val: loss=0.6354 acc=70.97% f1=40.00% auc=65.55% val_score=89.9094 val_score_bestthr=89.9892 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.270, mb=0.295, no=0.850, corr=-0.674) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 89.9094
[DBG][ep=030] disease_pos_weight=1.0000 mode=none
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2621 mb_mean=0.3058 norm_overlap=0.8678 corr_cb=-0.6569 topkJ=0.0000
[TRAIN][ep=030] loss=0.4042 acc=77.72%
[TRAIN][ep=030] mask_avg: mc_mean=0.2674 mb_mean=0.2952 norm_overlap=0.8424 corr_cb=-0.6787
[EPOCH 030/089] train: loss=0.4042 acc=77.72% | val: loss=0.6397 acc=69.35% f1=38.71% auc=65.11% val_score=87.8098 val_score_bestthr=87.7370 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.267, mb=0.295, no=0.842, corr=-0.679) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 87.8098
[DBG][ep=031] disease_pos_weight=1.0000 mode=none
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2526 mb_mean=0.2889 norm_overlap=0.8349 corr_cb=-0.6466 topkJ=0.0000
[TRAIN][ep=031] loss=0.3919 acc=78.26%
[TRAIN][ep=031] mask_avg: mc_mean=0.2662 mb_mean=0.2952 norm_overlap=0.8392 corr_cb=-0.6779
[EPOCH 031/089] train: loss=0.3919 acc=78.26% | val: loss=0.6343 acc=69.35% f1=42.42% auc=64.77% val_score=87.0667 val_score_bestthr=89.6835 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.266, mb=0.295, no=0.839, corr=-0.678) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 87.0667
[DBG][ep=032] disease_pos_weight=1.0000 mode=none
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2836 mb_mean=0.2844 norm_overlap=0.7636 corr_cb=-0.7815 topkJ=0.0000
[TRAIN][ep=032] loss=0.3875 acc=79.71%
[TRAIN][ep=032] mask_avg: mc_mean=0.2662 mb_mean=0.2953 norm_overlap=0.8393 corr_cb=-0.6805
[EPOCH 032/089] train: loss=0.3875 acc=79.71% | val: loss=0.6350 acc=69.35% f1=42.42% auc=64.77% val_score=86.4757 val_score_bestthr=89.6835 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.266, mb=0.295, no=0.839, corr=-0.680) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 86.4757
[DBG][ep=033] disease_pos_weight=1.0000 mode=none
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2614 mb_mean=0.3075 norm_overlap=0.8755 corr_cb=-0.6369 topkJ=0.0000
[TRAIN][ep=033] loss=0.3863 acc=80.07%
[TRAIN][ep=033] mask_avg: mc_mean=0.2662 mb_mean=0.2952 norm_overlap=0.8390 corr_cb=-0.6825
[EPOCH 033/089] train: loss=0.3863 acc=80.07% | val: loss=0.6364 acc=70.97% f1=43.75% auc=64.77% val_score=86.4757 val_score_bestthr=91.9375 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.266, mb=0.295, no=0.839, corr=-0.683) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 86.4757
[DBG][ep=034] disease_pos_weight=1.0000 mode=none
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2616 mb_mean=0.3075 norm_overlap=0.8753 corr_cb=-0.6066 topkJ=0.0000
[TRAIN][ep=034] loss=0.3836 acc=80.25%
[TRAIN][ep=034] mask_avg: mc_mean=0.2662 mb_mean=0.2953 norm_overlap=0.8393 corr_cb=-0.6793
[EPOCH 034/089] train: loss=0.3836 acc=80.25% | val: loss=0.6384 acc=70.97% f1=43.75% auc=64.44% val_score=84.2453 val_score_bestthr=91.9375 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.266, mb=0.295, no=0.839, corr=-0.679) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 84.2453
[DBG][ep=035] disease_pos_weight=1.0000 mode=none
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2657 mb_mean=0.2830 norm_overlap=0.8122 corr_cb=-0.6771 topkJ=0.0000
[TRAIN][ep=035] loss=0.3821 acc=79.89%
[TRAIN][ep=035] mask_avg: mc_mean=0.2662 mb_mean=0.2952 norm_overlap=0.8390 corr_cb=-0.6814
[EPOCH 035/089] train: loss=0.3821 acc=79.89% | val: loss=0.6380 acc=70.97% f1=43.75% auc=64.44% val_score=86.4757 val_score_bestthr=91.9375 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.266, mb=0.295, no=0.839, corr=-0.681) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 86.4757
[EARLY STOP] no improvement for 30 epochs. best_epoch=5
[CKPT] Loaded best for testing: results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
=============== FIT DONE ===============
[BEST] epoch=5 | val_acc=69.35% | val_f1=42.42% | val_auc=66.89% | val_score=92.7790 | val_score_bestthr=89.2722
[TEST@BEST] thr_used=0.370 | acc=63.40% f1=12.50% auc=57.73% | SP_sex=0.38% EO_sex=10.73% SP_age=8.77% EO_age=4.12%
[TIME] 0.66 min
[OK] Saved: results/ADHD_3x5fold_seed0/fold2_rep0_seed2/summary_fold_2.json
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4784 mb_mean=0.5063 norm_overlap=0.9999 corr_cb=-0.0928 topkJ=0.0294
[TRAIN][ep=000] loss=0.6710 acc=63.77%
[TRAIN][ep=000] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0078
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4808 mb_mean=0.5078 norm_overlap=0.9999 corr_cb=-0.1127 topkJ=0.0310
[TRAIN][ep=001] loss=0.6646 acc=63.77%
[TRAIN][ep=001] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0102
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4792 mb_mean=0.5067 norm_overlap=1.0000 corr_cb=0.0224 topkJ=0.0484
[TRAIN][ep=002] loss=0.6608 acc=63.77%
[TRAIN][ep=002] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0054
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4787 mb_mean=0.5076 norm_overlap=0.9997 corr_cb=-0.3063 topkJ=0.0248
[TRAIN][ep=003] loss=0.6578 acc=63.77%
[TRAIN][ep=003] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0074
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4810 mb_mean=0.5098 norm_overlap=1.0000 corr_cb=0.0354 topkJ=0.0553
[TRAIN][ep=004] loss=0.6568 acc=63.77%
[TRAIN][ep=004] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0056
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4798 mb_mean=0.5070 norm_overlap=1.0000 corr_cb=-0.0288 topkJ=0.0211
[TRAIN][ep=005] loss=0.6552 acc=63.77%
[TRAIN][ep=005] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0076
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4802 mb_mean=0.5083 norm_overlap=1.0001 corr_cb=0.0978 topkJ=0.0511
[TRAIN][ep=006] loss=0.6542 acc=63.77%
[TRAIN][ep=006] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0103
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4799 mb_mean=0.5072 norm_overlap=1.0000 corr_cb=-0.0156 topkJ=0.0413
[TRAIN][ep=007] loss=0.6530 acc=63.77%
[TRAIN][ep=007] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0058
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4788 mb_mean=0.5063 norm_overlap=0.9999 corr_cb=-0.1226 topkJ=0.0341
[TRAIN][ep=008] loss=0.6521 acc=63.77%
[TRAIN][ep=008] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0077
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4796 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=0.0434 topkJ=0.0713
[TRAIN][ep=009] loss=0.6503 acc=63.77%
[TRAIN][ep=009] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0082
================= FIT START (fold=2) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.35 select_by=val_score | eval_thr_mode=best_acc eval_thr_grid=coarse | disease_pos_weight_mode=none freeze_b_after=15 | two_stage=True stage1_ratio=0.35 stage2_lr_mult=0.3 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4807 mb_mean=0.5078 norm_overlap=1.0000 corr_cb=0.0284 topkJ=0.0655
[TRAIN][ep=000] loss=0.6497 acc=63.77%
[TRAIN][ep=000] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0057
[EPOCH 000/089] train: loss=0.6497 acc=63.77% | val: loss=0.6514 acc=69.35% f1=34.48% auc=66.22% val_score=69.0522 val_score_bestthr=85.2797 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.480, mb=0.508, no=1.000, corr=-0.006) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* -1000000000000000000.0000 -> 69.0522
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4809 mb_mean=0.5072 norm_overlap=1.0001 corr_cb=0.1026 topkJ=0.1054
[TRAIN][ep=001] loss=0.6477 acc=63.77%
[TRAIN][ep=001] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0084
[EPOCH 001/089] train: loss=0.6477 acc=63.77% | val: loss=0.6505 acc=70.97% f1=47.06% auc=66.56% val_score=65.7902 val_score_bestthr=93.2489 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.480, mb=0.508, no=1.000, corr=-0.008) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 69.0522 -> 65.7902
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4802 mb_mean=0.5075 norm_overlap=1.0000 corr_cb=0.0222 topkJ=0.0557
[TRAIN][ep=002] loss=0.6468 acc=63.77%
[TRAIN][ep=002] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0048
[EPOCH 002/089] train: loss=0.6468 acc=63.77% | val: loss=0.6494 acc=70.97% f1=50.00% auc=66.00% val_score=69.8259 val_score_bestthr=95.0010 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.480, mb=0.508, no=1.000, corr=-0.005) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 69.0522 -> 69.8259
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4773 mb_mean=0.5082 norm_overlap=1.0001 corr_cb=0.1498 topkJ=0.1079
[TRAIN][ep=003] loss=0.6447 acc=63.77%
[TRAIN][ep=003] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0071
[EPOCH 003/089] train: loss=0.6447 acc=63.77% | val: loss=0.6483 acc=69.35% f1=42.42% auc=67.22% val_score=71.7551 val_score_bestthr=89.5496 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.480, mb=0.508, no=1.000, corr=-0.007) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 69.8259 -> 71.7551
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4801 mb_mean=0.5075 norm_overlap=0.9999 corr_cb=-0.1147 topkJ=0.0525
[TRAIN][ep=004] loss=0.6429 acc=63.77%
[TRAIN][ep=004] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0086
[EPOCH 004/089] train: loss=0.6429 acc=63.77% | val: loss=0.6467 acc=72.58% f1=45.16% auc=67.45% val_score=77.0365 val_score_bestthr=94.1547 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.480, mb=0.508, no=1.000, corr=-0.009) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 71.7551 -> 77.0365
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4786 mb_mean=0.5078 norm_overlap=1.0001 corr_cb=0.1409 topkJ=0.1263
[TRAIN][ep=005] loss=2.2347 acc=63.77%
[TRAIN][ep=005] mask_avg: mc_mean=0.4764 mb_mean=0.5011 norm_overlap=1.0002 corr_cb=0.1713
[EPOCH 005/089] train: loss=2.2347 acc=63.77% | val: loss=0.6490 acc=69.35% f1=42.42% auc=66.89% val_score=92.7790 val_score_bestthr=89.2722 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.476, mb=0.501, no=1.000, corr=0.171) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 77.0365 -> 92.7790
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4708 mb_mean=0.4925 norm_overlap=1.0009 corr_cb=0.5508 topkJ=0.1507
[TRAIN][ep=006] loss=2.2270 acc=63.77%
[TRAIN][ep=006] mask_avg: mc_mean=0.4673 mb_mean=0.4839 norm_overlap=1.0006 corr_cb=0.3526
[EPOCH 006/089] train: loss=2.2270 acc=63.77% | val: loss=0.6477 acc=69.35% f1=51.28% auc=67.00% val_score=80.4100 val_score_bestthr=93.7937 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.467, mb=0.484, no=1.001, corr=0.353) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 80.4100
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4624 mb_mean=0.4746 norm_overlap=1.0006 corr_cb=0.3322 topkJ=0.1257
[TRAIN][ep=007] loss=2.2206 acc=63.77%
[TRAIN][ep=007] mask_avg: mc_mean=0.4565 mb_mean=0.4638 norm_overlap=1.0013 corr_cb=0.4286
[EPOCH 007/089] train: loss=2.2206 acc=63.77% | val: loss=0.6462 acc=70.97% f1=50.00% auc=67.67% val_score=87.1176 val_score_bestthr=94.9540 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.457, mb=0.464, no=1.001, corr=0.429) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 87.1176
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4506 mb_mean=0.4552 norm_overlap=1.0012 corr_cb=0.3844 topkJ=0.1115
[TRAIN][ep=008] loss=1.5064 acc=63.77%
[TRAIN][ep=008] mask_avg: mc_mean=0.4453 mb_mean=0.4407 norm_overlap=1.0023 corr_cb=0.4682
[EPOCH 008/089] train: loss=1.5064 acc=63.77% | val: loss=0.6447 acc=70.97% f1=50.00% auc=67.45% val_score=81.4369 val_score_bestthr=95.0010 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.445, mb=0.441, no=1.002, corr=0.468) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 81.4369
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4380 mb_mean=0.4231 norm_overlap=1.0023 corr_cb=0.4500 topkJ=0.1636
[TRAIN][ep=009] loss=0.7969 acc=63.77%
[TRAIN][ep=009] mask_avg: mc_mean=0.4336 mb_mean=0.4153 norm_overlap=1.0036 corr_cb=0.4758
[EPOCH 009/089] train: loss=0.7969 acc=63.77% | val: loss=0.6433 acc=69.35% f1=45.71% auc=67.67% val_score=85.1307 val_score_bestthr=91.1571 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.434, mb=0.415, no=1.004, corr=0.476) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 85.1307
[DBG][ep=010] disease_pos_weight=1.0000 mode=none
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.4288 mb_mean=0.3983 norm_overlap=1.0051 corr_cb=0.5539 topkJ=0.1897
[TRAIN][ep=010] loss=0.6208 acc=63.77%
[TRAIN][ep=010] mask_avg: mc_mean=0.4214 mb_mean=0.3889 norm_overlap=1.0049 corr_cb=0.4374
[EPOCH 010/089] train: loss=0.6208 acc=63.77% | val: loss=0.6410 acc=70.97% f1=43.75% auc=68.00% val_score=85.5165 val_score_bestthr=91.7940 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.421, mb=0.389, no=1.005, corr=0.437) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 85.5165
[DBG][ep=011] disease_pos_weight=1.0000 mode=none
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.4163 mb_mean=0.3766 norm_overlap=1.0050 corr_cb=0.3809 topkJ=0.1334
[TRAIN][ep=011] loss=0.6020 acc=63.77%
[TRAIN][ep=011] mask_avg: mc_mean=0.4090 mb_mean=0.3633 norm_overlap=1.0056 corr_cb=0.3408
[EPOCH 011/089] train: loss=0.6020 acc=63.77% | val: loss=0.6385 acc=70.97% f1=40.00% auc=68.56% val_score=85.0682 val_score_bestthr=89.9892 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.409, mb=0.363, no=1.006, corr=0.341) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 85.0682
[DBG][ep=012] disease_pos_weight=1.0000 mode=none
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.4066 mb_mean=0.3556 norm_overlap=1.0039 corr_cb=0.2647 topkJ=0.1939
[TRAIN][ep=012] loss=0.5960 acc=63.77%
[TRAIN][ep=012] mask_avg: mc_mean=0.3959 mb_mean=0.3399 norm_overlap=1.0042 corr_cb=0.1752
[EPOCH 012/089] train: loss=0.5960 acc=63.77% | val: loss=0.6358 acc=69.35% f1=55.81% auc=68.56% val_score=91.9623 val_score_bestthr=96.4956 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.396, mb=0.340, no=1.004, corr=0.175) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 91.9623
[DBG][ep=013] disease_pos_weight=1.0000 mode=none
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.3844 mb_mean=0.3233 norm_overlap=1.0063 corr_cb=0.2036 topkJ=0.1086
[TRAIN][ep=013] loss=0.8714 acc=63.95%
[TRAIN][ep=013] mask_avg: mc_mean=0.3830 mb_mean=0.3195 norm_overlap=0.9995 corr_cb=-0.0155
[EPOCH 013/089] train: loss=0.8714 acc=63.95% | val: loss=0.6336 acc=70.97% f1=40.00% auc=68.34% val_score=87.5649 val_score_bestthr=89.9892 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.383, mb=0.320, no=1.000, corr=-0.015) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 87.5649
[DBG][ep=014] disease_pos_weight=1.0000 mode=none
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.3837 mb_mean=0.3226 norm_overlap=0.9967 corr_cb=-0.0947 topkJ=0.0721
[TRAIN][ep=014] loss=1.1473 acc=63.95%
[TRAIN][ep=014] mask_avg: mc_mean=0.3692 mb_mean=0.3026 norm_overlap=0.9899 corr_cb=-0.1974
[EPOCH 014/089] train: loss=1.1473 acc=63.95% | val: loss=0.6320 acc=70.97% f1=40.00% auc=67.89% val_score=86.2487 val_score_bestthr=89.9892 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.369, mb=0.303, no=0.990, corr=-0.197) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 86.2487
[DBG][ep=015] disease_pos_weight=1.0000 mode=none
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.3626 mb_mean=0.3020 norm_overlap=0.9836 corr_cb=-0.2843 topkJ=0.0176
[TRAIN][ep=015] loss=1.4242 acc=64.31%
[TRAIN][ep=015] mask_avg: mc_mean=0.3593 mb_mean=0.2953 norm_overlap=0.9779 corr_cb=-0.3490
[EPOCH 015/089] train: loss=1.4242 acc=64.31% | val: loss=0.6317 acc=70.97% f1=40.00% auc=68.34% val_score=83.7773 val_score_bestthr=89.9892 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.359, mb=0.295, no=0.978, corr=-0.349) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 83.7773
[DBG][ep=016] disease_pos_weight=1.0000 mode=none
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.3469 mb_mean=0.3060 norm_overlap=0.9719 corr_cb=-0.4221 topkJ=0.0118
[TRAIN][ep=016] loss=1.6881 acc=64.13%
[TRAIN][ep=016] mask_avg: mc_mean=0.3491 mb_mean=0.2953 norm_overlap=0.9684 corr_cb=-0.4201
[EPOCH 016/089] train: loss=1.6881 acc=64.13% | val: loss=0.6295 acc=70.97% f1=40.00% auc=67.45% val_score=82.9854 val_score_bestthr=89.9892 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.349, mb=0.295, no=0.968, corr=-0.420) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 82.9854
[DBG][ep=017] disease_pos_weight=1.0000 mode=none
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.3541 mb_mean=0.3034 norm_overlap=0.9614 corr_cb=-0.5195 topkJ=0.0017
[TRAIN][ep=017] loss=1.9625 acc=64.31%
[TRAIN][ep=017] mask_avg: mc_mean=0.3392 mb_mean=0.2953 norm_overlap=0.9586 corr_cb=-0.4669
[EPOCH 017/089] train: loss=1.9625 acc=64.31% | val: loss=0.6287 acc=69.35% f1=38.71% auc=66.56% val_score=91.6801 val_score_bestthr=87.7068 | dyn(w_pfs=0.100, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.339, mb=0.295, no=0.959, corr=-0.467) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 91.6801
[DBG][ep=018] disease_pos_weight=1.0000 mode=none
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.3364 mb_mean=0.3045 norm_overlap=0.9577 corr_cb=-0.4533 topkJ=0.0020
[TRAIN][ep=018] loss=1.2516 acc=65.04%
[TRAIN][ep=018] mask_avg: mc_mean=0.3307 mb_mean=0.2953 norm_overlap=0.9499 corr_cb=-0.5045
[EPOCH 018/089] train: loss=1.2516 acc=65.04% | val: loss=0.6242 acc=70.97% f1=40.00% auc=66.22% val_score=90.1560 val_score_bestthr=89.9892 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.331, mb=0.295, no=0.950, corr=-0.505) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 90.1560
[DBG][ep=019] disease_pos_weight=1.0000 mode=none
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.3212 mb_mean=0.2736 norm_overlap=0.9289 corr_cb=-0.5326 topkJ=0.0020
[TRAIN][ep=019] loss=0.5462 acc=65.58%
[TRAIN][ep=019] mask_avg: mc_mean=0.3215 mb_mean=0.2953 norm_overlap=0.9400 corr_cb=-0.5320
[EPOCH 019/089] train: loss=0.5462 acc=65.58% | val: loss=0.6197 acc=69.35% f1=38.71% auc=67.34% val_score=82.4688 val_score_bestthr=87.7370 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.322, mb=0.295, no=0.940, corr=-0.532) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 82.4688
[DBG][ep=020] disease_pos_weight=1.0000 mode=none
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.3223 mb_mean=0.2996 norm_overlap=0.9199 corr_cb=-0.6412 topkJ=0.0008
[TRAIN][ep=020] loss=0.5344 acc=71.38%
[TRAIN][ep=020] mask_avg: mc_mean=0.3139 mb_mean=0.2953 norm_overlap=0.9297 corr_cb=-0.5639
[EPOCH 020/089] train: loss=0.5344 acc=71.38% | val: loss=0.6177 acc=70.97% f1=40.00% auc=68.23% val_score=89.9094 val_score_bestthr=89.9892 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.314, mb=0.295, no=0.930, corr=-0.564) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 89.9094
[DBG][ep=021] disease_pos_weight=1.0000 mode=none
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.3093 mb_mean=0.2988 norm_overlap=0.9124 corr_cb=-0.6602 topkJ=0.0000
[TRAIN][ep=021] loss=0.5251 acc=68.30%
[TRAIN][ep=021] mask_avg: mc_mean=0.3056 mb_mean=0.2953 norm_overlap=0.9186 corr_cb=-0.5821
[EPOCH 021/089] train: loss=0.5251 acc=68.30% | val: loss=0.6109 acc=69.35% f1=34.48% auc=67.67% val_score=88.7228 val_score_bestthr=85.6635 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.306, mb=0.295, no=0.919, corr=-0.582) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 88.7228
[DBG][ep=022] disease_pos_weight=1.0000 mode=none
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2954 mb_mean=0.3026 norm_overlap=0.9205 corr_cb=-0.6502 topkJ=0.0004
[TRAIN][ep=022] loss=0.5168 acc=70.65%
[TRAIN][ep=022] mask_avg: mc_mean=0.2983 mb_mean=0.2953 norm_overlap=0.9084 corr_cb=-0.5979
[EPOCH 022/089] train: loss=0.5168 acc=70.65% | val: loss=0.6083 acc=69.35% f1=34.48% auc=67.56% val_score=88.7228 val_score_bestthr=85.6635 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.298, mb=0.295, no=0.908, corr=-0.598) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 88.7228
[DBG][ep=023] disease_pos_weight=1.0000 mode=none
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2969 mb_mean=0.2992 norm_overlap=0.9178 corr_cb=-0.5798 topkJ=0.0004
[TRAIN][ep=023] loss=0.5057 acc=71.74%
[TRAIN][ep=023] mask_avg: mc_mean=0.2933 mb_mean=0.2953 norm_overlap=0.8997 corr_cb=-0.6119
[EPOCH 023/089] train: loss=0.5057 acc=71.74% | val: loss=0.6056 acc=69.35% f1=38.71% auc=68.12% val_score=89.2527 val_score_bestthr=87.7370 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.293, mb=0.295, no=0.900, corr=-0.612) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 89.2527
[DBG][ep=024] disease_pos_weight=1.0000 mode=none
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2996 mb_mean=0.3003 norm_overlap=0.9079 corr_cb=-0.5835 topkJ=0.0000
[TRAIN][ep=024] loss=0.4964 acc=74.64%
[TRAIN][ep=024] mask_avg: mc_mean=0.2877 mb_mean=0.2953 norm_overlap=0.8902 corr_cb=-0.6216
[EPOCH 024/089] train: loss=0.4964 acc=74.64% | val: loss=0.6078 acc=69.35% f1=34.48% auc=68.00% val_score=85.5066 val_score_bestthr=85.6635 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.288, mb=0.295, no=0.890, corr=-0.622) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 85.5066
[DBG][ep=025] disease_pos_weight=1.0000 mode=none
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2689 mb_mean=0.2914 norm_overlap=0.9236 corr_cb=-0.4537 topkJ=0.0000
[TRAIN][ep=025] loss=0.4860 acc=73.91%
[TRAIN][ep=025] mask_avg: mc_mean=0.2833 mb_mean=0.2953 norm_overlap=0.8813 corr_cb=-0.6323
[EPOCH 025/089] train: loss=0.4860 acc=73.91% | val: loss=0.6154 acc=67.74% f1=37.50% auc=66.67% val_score=83.7279 val_score_bestthr=85.4359 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.283, mb=0.295, no=0.881, corr=-0.632) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 83.7279
[DBG][ep=026] disease_pos_weight=1.0000 mode=none
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2746 mb_mean=0.3015 norm_overlap=0.8690 corr_cb=-0.7396 topkJ=0.0000
[TRAIN][ep=026] loss=0.4784 acc=75.91%
[TRAIN][ep=026] mask_avg: mc_mean=0.2798 mb_mean=0.2953 norm_overlap=0.8730 corr_cb=-0.6473
[EPOCH 026/089] train: loss=0.4784 acc=75.91% | val: loss=0.6106 acc=69.35% f1=38.71% auc=67.00% val_score=84.2453 val_score_bestthr=87.7370 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.280, mb=0.295, no=0.873, corr=-0.647) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 84.2453
[DBG][ep=027] disease_pos_weight=1.0000 mode=none
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2514 mb_mean=0.2914 norm_overlap=0.9028 corr_cb=-0.5061 topkJ=0.0000
[TRAIN][ep=027] loss=0.4717 acc=76.27%
[TRAIN][ep=027] mask_avg: mc_mean=0.2763 mb_mean=0.2953 norm_overlap=0.8648 corr_cb=-0.6545
[EPOCH 027/089] train: loss=0.4717 acc=76.27% | val: loss=0.6240 acc=67.74% f1=41.18% auc=66.44% val_score=81.6832 val_score_bestthr=87.3634 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.276, mb=0.295, no=0.865, corr=-0.654) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 81.6832
[DBG][ep=028] disease_pos_weight=1.0000 mode=none
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2686 mb_mean=0.3034 norm_overlap=0.8741 corr_cb=-0.6914 topkJ=0.0000
[TRAIN][ep=028] loss=0.4603 acc=77.90%
[TRAIN][ep=028] mask_avg: mc_mean=0.2731 mb_mean=0.2953 norm_overlap=0.8571 corr_cb=-0.6651
[EPOCH 028/089] train: loss=0.4603 acc=77.90% | val: loss=0.6230 acc=69.35% f1=38.71% auc=65.44% val_score=81.2832 val_score_bestthr=87.7370 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.273, mb=0.295, no=0.857, corr=-0.665) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 81.2832
[DBG][ep=029] disease_pos_weight=1.0000 mode=none
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2797 mb_mean=0.2925 norm_overlap=0.8676 corr_cb=-0.6093 topkJ=0.0000
[TRAIN][ep=029] loss=0.4511 acc=80.25%
[TRAIN][ep=029] mask_avg: mc_mean=0.2704 mb_mean=0.2953 norm_overlap=0.8501 corr_cb=-0.6731
[EPOCH 029/089] train: loss=0.4511 acc=80.25% | val: loss=0.6354 acc=70.97% f1=40.00% auc=65.55% val_score=89.9094 val_score_bestthr=89.9892 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.270, mb=0.295, no=0.850, corr=-0.673) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 89.9094
[DBG][ep=030] disease_pos_weight=1.0000 mode=none
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2622 mb_mean=0.3058 norm_overlap=0.8682 corr_cb=-0.6557 topkJ=0.0000
[TRAIN][ep=030] loss=0.4448 acc=77.72%
[TRAIN][ep=030] mask_avg: mc_mean=0.2675 mb_mean=0.2953 norm_overlap=0.8429 corr_cb=-0.6777
[EPOCH 030/089] train: loss=0.4448 acc=77.72% | val: loss=0.6396 acc=69.35% f1=38.71% auc=65.33% val_score=87.8098 val_score_bestthr=87.7370 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.267, mb=0.295, no=0.843, corr=-0.678) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 87.8098
[DBG][ep=031] disease_pos_weight=1.0000 mode=none
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2527 mb_mean=0.2890 norm_overlap=0.8353 corr_cb=-0.6461 topkJ=0.0000
[TRAIN][ep=031] loss=0.4325 acc=78.26%
[TRAIN][ep=031] mask_avg: mc_mean=0.2663 mb_mean=0.2953 norm_overlap=0.8396 corr_cb=-0.6770
[EPOCH 031/089] train: loss=0.4325 acc=78.26% | val: loss=0.6343 acc=69.35% f1=42.42% auc=64.66% val_score=87.0667 val_score_bestthr=89.6835 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.266, mb=0.295, no=0.840, corr=-0.677) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 87.0667
[DBG][ep=032] disease_pos_weight=1.0000 mode=none
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2837 mb_mean=0.2845 norm_overlap=0.7641 corr_cb=-0.7807 topkJ=0.0000
[TRAIN][ep=032] loss=0.4281 acc=79.71%
[TRAIN][ep=032] mask_avg: mc_mean=0.2663 mb_mean=0.2953 norm_overlap=0.8398 corr_cb=-0.6795
[EPOCH 032/089] train: loss=0.4281 acc=79.71% | val: loss=0.6350 acc=69.35% f1=42.42% auc=64.77% val_score=86.4757 val_score_bestthr=89.6835 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.266, mb=0.295, no=0.840, corr=-0.680) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 86.4757
[DBG][ep=033] disease_pos_weight=1.0000 mode=none
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2615 mb_mean=0.3076 norm_overlap=0.8758 corr_cb=-0.6365 topkJ=0.0000
[TRAIN][ep=033] loss=0.4269 acc=80.07%
[TRAIN][ep=033] mask_avg: mc_mean=0.2663 mb_mean=0.2953 norm_overlap=0.8394 corr_cb=-0.6815
[EPOCH 033/089] train: loss=0.4269 acc=80.07% | val: loss=0.6363 acc=70.97% f1=43.75% auc=64.77% val_score=86.4757 val_score_bestthr=91.9375 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.266, mb=0.295, no=0.839, corr=-0.682) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 86.4757
[DBG][ep=034] disease_pos_weight=1.0000 mode=none
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2617 mb_mean=0.3076 norm_overlap=0.8756 corr_cb=-0.6063 topkJ=0.0000
[TRAIN][ep=034] loss=0.4242 acc=80.43%
[TRAIN][ep=034] mask_avg: mc_mean=0.2663 mb_mean=0.2953 norm_overlap=0.8398 corr_cb=-0.6783
[EPOCH 034/089] train: loss=0.4242 acc=80.43% | val: loss=0.6383 acc=70.97% f1=43.75% auc=64.44% val_score=84.2453 val_score_bestthr=91.9375 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.266, mb=0.295, no=0.840, corr=-0.678) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 84.2453
[DBG][ep=035] disease_pos_weight=1.0000 mode=none
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2657 mb_mean=0.2830 norm_overlap=0.8128 corr_cb=-0.6761 topkJ=0.0000
[TRAIN][ep=035] loss=0.4227 acc=79.89%
[TRAIN][ep=035] mask_avg: mc_mean=0.2663 mb_mean=0.2953 norm_overlap=0.8394 corr_cb=-0.6804
[EPOCH 035/089] train: loss=0.4227 acc=79.89% | val: loss=0.6380 acc=70.97% f1=43.75% auc=64.44% val_score=86.4757 val_score_bestthr=91.9375 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.266, mb=0.295, no=0.839, corr=-0.680) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 86.4757
[EARLY STOP] no improvement for 30 epochs. best_epoch=5
[CKPT] Loaded best for testing: results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
=============== FIT DONE ===============
[BEST] epoch=5 | val_acc=69.35% | val_f1=42.42% | val_auc=66.89% | val_score=92.7790 | val_score_bestthr=89.2722
[TEST@BEST] thr_used=0.370 | acc=63.40% f1=12.50% auc=57.75% | SP_sex=0.38% EO_sex=10.73% SP_age=8.77% EO_age=4.12%
[TIME] 0.65 min
[OK] Saved: results/ADHD_3x5fold_seed0/fold2_rep0_seed2/summary_fold_2.json
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4784 mb_mean=0.5063 norm_overlap=0.9999 corr_cb=-0.0928 topkJ=0.0294
[TRAIN][ep=000] loss=0.6710 acc=63.77%
[TRAIN][ep=000] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0078
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4808 mb_mean=0.5078 norm_overlap=0.9999 corr_cb=-0.1127 topkJ=0.0310
[TRAIN][ep=001] loss=0.6646 acc=63.77%
[TRAIN][ep=001] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0102
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4792 mb_mean=0.5067 norm_overlap=1.0000 corr_cb=0.0224 topkJ=0.0484
[TRAIN][ep=002] loss=0.6608 acc=63.77%
[TRAIN][ep=002] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0054
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4787 mb_mean=0.5076 norm_overlap=0.9997 corr_cb=-0.3063 topkJ=0.0248
[TRAIN][ep=003] loss=0.6578 acc=63.77%
[TRAIN][ep=003] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0074
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4810 mb_mean=0.5098 norm_overlap=1.0000 corr_cb=0.0354 topkJ=0.0553
[TRAIN][ep=004] loss=0.6568 acc=63.77%
[TRAIN][ep=004] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0056
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4798 mb_mean=0.5070 norm_overlap=1.0000 corr_cb=-0.0288 topkJ=0.0211
[TRAIN][ep=005] loss=0.6552 acc=63.77%
[TRAIN][ep=005] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0076
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4802 mb_mean=0.5083 norm_overlap=1.0001 corr_cb=0.0978 topkJ=0.0511
[TRAIN][ep=006] loss=0.6542 acc=63.77%
[TRAIN][ep=006] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0103
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4799 mb_mean=0.5072 norm_overlap=1.0000 corr_cb=-0.0156 topkJ=0.0413
[TRAIN][ep=007] loss=0.6530 acc=63.77%
[TRAIN][ep=007] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0058
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4788 mb_mean=0.5063 norm_overlap=0.9999 corr_cb=-0.1226 topkJ=0.0341
[TRAIN][ep=008] loss=0.6521 acc=63.77%
[TRAIN][ep=008] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0077
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4796 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=0.0434 topkJ=0.0713
[TRAIN][ep=009] loss=0.6503 acc=63.77%
[TRAIN][ep=009] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0082
================= FIT START (fold=2) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.35 select_by=val_score | eval_thr_mode=best_acc eval_thr_grid=coarse | disease_pos_weight_mode=none freeze_b_after=15 | two_stage=True stage1_ratio=0.35 stage2_lr_mult=0.3 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4807 mb_mean=0.5078 norm_overlap=1.0000 corr_cb=0.0284 topkJ=0.0655
[TRAIN][ep=000] loss=0.6497 acc=63.77%
[TRAIN][ep=000] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0057
[EPOCH 000/089] train: loss=0.6497 acc=63.77% | val: loss=0.6514 acc=69.35% f1=34.48% auc=66.22% val_score=69.0522 val_score_bestthr=85.2797 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.480, mb=0.508, no=1.000, corr=-0.006) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* -1000000000000000000.0000 -> 69.0522
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4809 mb_mean=0.5072 norm_overlap=1.0001 corr_cb=0.1026 topkJ=0.1054
[TRAIN][ep=001] loss=0.6477 acc=63.77%
[TRAIN][ep=001] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0084
[EPOCH 001/089] train: loss=0.6477 acc=63.77% | val: loss=0.6505 acc=70.97% f1=47.06% auc=66.56% val_score=65.7902 val_score_bestthr=93.2489 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.480, mb=0.508, no=1.000, corr=-0.008) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 69.0522 -> 65.7902
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4802 mb_mean=0.5075 norm_overlap=1.0000 corr_cb=0.0222 topkJ=0.0557
[TRAIN][ep=002] loss=0.6468 acc=63.77%
[TRAIN][ep=002] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0048
[EPOCH 002/089] train: loss=0.6468 acc=63.77% | val: loss=0.6494 acc=70.97% f1=50.00% auc=66.00% val_score=69.8259 val_score_bestthr=95.0010 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.480, mb=0.508, no=1.000, corr=-0.005) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 69.0522 -> 69.8259
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4773 mb_mean=0.5082 norm_overlap=1.0001 corr_cb=0.1498 topkJ=0.1079
[TRAIN][ep=003] loss=0.6447 acc=63.77%
[TRAIN][ep=003] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0071
[EPOCH 003/089] train: loss=0.6447 acc=63.77% | val: loss=0.6483 acc=69.35% f1=42.42% auc=67.22% val_score=71.7551 val_score_bestthr=89.5496 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.480, mb=0.508, no=1.000, corr=-0.007) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 69.8259 -> 71.7551
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4801 mb_mean=0.5075 norm_overlap=0.9999 corr_cb=-0.1147 topkJ=0.0525
[TRAIN][ep=004] loss=0.6429 acc=63.77%
[TRAIN][ep=004] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0086
[EPOCH 004/089] train: loss=0.6429 acc=63.77% | val: loss=0.6467 acc=72.58% f1=45.16% auc=67.45% val_score=77.0365 val_score_bestthr=94.1547 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.480, mb=0.508, no=1.000, corr=-0.009) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 71.7551 -> 77.0365
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4786 mb_mean=0.5078 norm_overlap=1.0001 corr_cb=0.1409 topkJ=0.1263
[TRAIN][ep=005] loss=2.1313 acc=63.77%
[TRAIN][ep=005] mask_avg: mc_mean=0.4764 mb_mean=0.5011 norm_overlap=1.0002 corr_cb=0.1712
[EPOCH 005/089] train: loss=2.1313 acc=63.77% | val: loss=0.6490 acc=69.35% f1=42.42% auc=66.89% val_score=92.7790 val_score_bestthr=89.2722 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.476, mb=0.501, no=1.000, corr=0.171) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 77.0365 -> 92.7790
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4708 mb_mean=0.4925 norm_overlap=1.0009 corr_cb=0.5503 topkJ=0.1513
[TRAIN][ep=006] loss=2.1240 acc=63.77%
[TRAIN][ep=006] mask_avg: mc_mean=0.4673 mb_mean=0.4840 norm_overlap=1.0006 corr_cb=0.3513
[EPOCH 006/089] train: loss=2.1240 acc=63.77% | val: loss=0.6477 acc=69.35% f1=51.28% auc=66.78% val_score=80.4100 val_score_bestthr=93.7937 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.467, mb=0.484, no=1.001, corr=0.351) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 80.4100
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4624 mb_mean=0.4746 norm_overlap=1.0006 corr_cb=0.3305 topkJ=0.1247
[TRAIN][ep=007] loss=2.1179 acc=63.77%
[TRAIN][ep=007] mask_avg: mc_mean=0.4565 mb_mean=0.4638 norm_overlap=1.0013 corr_cb=0.4264
[EPOCH 007/089] train: loss=2.1179 acc=63.77% | val: loss=0.6462 acc=70.97% f1=50.00% auc=67.67% val_score=87.1176 val_score_bestthr=94.9540 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.457, mb=0.464, no=1.001, corr=0.426) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 87.1176
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4506 mb_mean=0.4552 norm_overlap=1.0012 corr_cb=0.3805 topkJ=0.1105
[TRAIN][ep=008] loss=1.4038 acc=63.77%
[TRAIN][ep=008] mask_avg: mc_mean=0.4453 mb_mean=0.4407 norm_overlap=1.0023 corr_cb=0.4654
[EPOCH 008/089] train: loss=1.4038 acc=63.77% | val: loss=0.6446 acc=70.97% f1=50.00% auc=67.45% val_score=81.4369 val_score_bestthr=95.0010 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.445, mb=0.441, no=1.002, corr=0.465) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 81.4369
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4380 mb_mean=0.4231 norm_overlap=1.0023 corr_cb=0.4478 topkJ=0.1614
[TRAIN][ep=009] loss=0.6944 acc=63.77%
[TRAIN][ep=009] mask_avg: mc_mean=0.4336 mb_mean=0.4153 norm_overlap=1.0036 corr_cb=0.4729
[EPOCH 009/089] train: loss=0.6944 acc=63.77% | val: loss=0.6433 acc=69.35% f1=45.71% auc=67.67% val_score=85.1307 val_score_bestthr=91.1571 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.434, mb=0.415, no=1.004, corr=0.473) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 85.1307
[DBG][ep=010] disease_pos_weight=1.0000 mode=none
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.4288 mb_mean=0.3982 norm_overlap=1.0051 corr_cb=0.5501 topkJ=0.1891
[TRAIN][ep=010] loss=0.5183 acc=63.77%
[TRAIN][ep=010] mask_avg: mc_mean=0.4214 mb_mean=0.3889 norm_overlap=1.0049 corr_cb=0.4332
[EPOCH 010/089] train: loss=0.5183 acc=63.77% | val: loss=0.6410 acc=70.97% f1=43.75% auc=68.00% val_score=85.5165 val_score_bestthr=91.7940 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.421, mb=0.389, no=1.005, corr=0.433) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 85.5165
[DBG][ep=011] disease_pos_weight=1.0000 mode=none
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.4163 mb_mean=0.3765 norm_overlap=1.0049 corr_cb=0.3765 topkJ=0.1288
[TRAIN][ep=011] loss=0.4995 acc=63.77%
[TRAIN][ep=011] mask_avg: mc_mean=0.4090 mb_mean=0.3632 norm_overlap=1.0055 corr_cb=0.3353
[EPOCH 011/089] train: loss=0.4995 acc=63.77% | val: loss=0.6385 acc=70.97% f1=40.00% auc=68.56% val_score=85.0682 val_score_bestthr=89.9892 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.409, mb=0.363, no=1.006, corr=0.335) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 85.0682
[DBG][ep=012] disease_pos_weight=1.0000 mode=none
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.4066 mb_mean=0.3556 norm_overlap=1.0038 corr_cb=0.2588 topkJ=0.1869
[TRAIN][ep=012] loss=0.4937 acc=63.77%
[TRAIN][ep=012] mask_avg: mc_mean=0.3959 mb_mean=0.3398 norm_overlap=1.0040 corr_cb=0.1680
[EPOCH 012/089] train: loss=0.4937 acc=63.77% | val: loss=0.6358 acc=69.35% f1=55.81% auc=68.56% val_score=91.9623 val_score_bestthr=96.4956 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.396, mb=0.340, no=1.004, corr=0.168) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 91.9623
[DBG][ep=013] disease_pos_weight=1.0000 mode=none
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.3844 mb_mean=0.3231 norm_overlap=1.0060 corr_cb=0.1924 topkJ=0.0988
[TRAIN][ep=013] loss=0.7691 acc=63.95%
[TRAIN][ep=013] mask_avg: mc_mean=0.3830 mb_mean=0.3194 norm_overlap=0.9993 corr_cb=-0.0233
[EPOCH 013/089] train: loss=0.7691 acc=63.95% | val: loss=0.6336 acc=70.97% f1=40.00% auc=68.45% val_score=87.5649 val_score_bestthr=89.9892 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.383, mb=0.319, no=0.999, corr=-0.023) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 87.5649
[DBG][ep=014] disease_pos_weight=1.0000 mode=none
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.3836 mb_mean=0.3224 norm_overlap=0.9964 corr_cb=-0.1029 topkJ=0.0674
[TRAIN][ep=014] loss=1.0450 acc=63.95%
[TRAIN][ep=014] mask_avg: mc_mean=0.3691 mb_mean=0.3024 norm_overlap=0.9895 corr_cb=-0.2048
[EPOCH 014/089] train: loss=1.0450 acc=63.95% | val: loss=0.6320 acc=70.97% f1=40.00% auc=67.89% val_score=82.9854 val_score_bestthr=89.9892 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.369, mb=0.302, no=0.989, corr=-0.205) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 82.9854
[DBG][ep=015] disease_pos_weight=1.0000 mode=none
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.3625 mb_mean=0.3018 norm_overlap=0.9831 corr_cb=-0.2903 topkJ=0.0159
[TRAIN][ep=015] loss=1.3219 acc=64.31%
[TRAIN][ep=015] mask_avg: mc_mean=0.3592 mb_mean=0.2952 norm_overlap=0.9776 corr_cb=-0.3532
[EPOCH 015/089] train: loss=1.3219 acc=64.31% | val: loss=0.6317 acc=70.97% f1=40.00% auc=68.34% val_score=83.7773 val_score_bestthr=89.9892 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.359, mb=0.295, no=0.978, corr=-0.353) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 83.7773
[DBG][ep=016] disease_pos_weight=1.0000 mode=none
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.3468 mb_mean=0.3058 norm_overlap=0.9717 corr_cb=-0.4240 topkJ=0.0106
[TRAIN][ep=016] loss=1.5858 acc=64.13%
[TRAIN][ep=016] mask_avg: mc_mean=0.3490 mb_mean=0.2952 norm_overlap=0.9681 corr_cb=-0.4237
[EPOCH 016/089] train: loss=1.5858 acc=64.13% | val: loss=0.6295 acc=70.97% f1=40.00% auc=67.45% val_score=82.9854 val_score_bestthr=89.9892 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.349, mb=0.295, no=0.968, corr=-0.424) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 82.9854
[DBG][ep=017] disease_pos_weight=1.0000 mode=none
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.3540 mb_mean=0.3032 norm_overlap=0.9611 corr_cb=-0.5230 topkJ=0.0017
[TRAIN][ep=017] loss=1.8602 acc=64.31%
[TRAIN][ep=017] mask_avg: mc_mean=0.3391 mb_mean=0.2952 norm_overlap=0.9582 corr_cb=-0.4703
[EPOCH 017/089] train: loss=1.8602 acc=64.31% | val: loss=0.6286 acc=69.35% f1=38.71% auc=66.56% val_score=91.6801 val_score_bestthr=87.7068 | dyn(w_pfs=0.100, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.339, mb=0.295, no=0.958, corr=-0.470) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 91.6801
[DBG][ep=018] disease_pos_weight=1.0000 mode=none
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.3363 mb_mean=0.3044 norm_overlap=0.9574 corr_cb=-0.4553 topkJ=0.0020
[TRAIN][ep=018] loss=1.1493 acc=65.04%
[TRAIN][ep=018] mask_avg: mc_mean=0.3306 mb_mean=0.2952 norm_overlap=0.9495 corr_cb=-0.5074
[EPOCH 018/089] train: loss=1.1493 acc=65.04% | val: loss=0.6242 acc=70.97% f1=40.00% auc=66.22% val_score=90.1560 val_score_bestthr=89.9892 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.331, mb=0.295, no=0.949, corr=-0.507) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 90.1560
[DBG][ep=019] disease_pos_weight=1.0000 mode=none
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.3210 mb_mean=0.2735 norm_overlap=0.9282 corr_cb=-0.5368 topkJ=0.0016
[TRAIN][ep=019] loss=0.4439 acc=65.58%
[TRAIN][ep=019] mask_avg: mc_mean=0.3214 mb_mean=0.2952 norm_overlap=0.9394 corr_cb=-0.5350
[EPOCH 019/089] train: loss=0.4439 acc=65.58% | val: loss=0.6196 acc=69.35% f1=38.71% auc=67.22% val_score=82.4688 val_score_bestthr=87.7370 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.321, mb=0.295, no=0.939, corr=-0.535) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 82.4688
[DBG][ep=020] disease_pos_weight=1.0000 mode=none
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.3221 mb_mean=0.2995 norm_overlap=0.9194 corr_cb=-0.6440 topkJ=0.0004
[TRAIN][ep=020] loss=0.4322 acc=71.38%
[TRAIN][ep=020] mask_avg: mc_mean=0.3138 mb_mean=0.2951 norm_overlap=0.9292 corr_cb=-0.5667
[EPOCH 020/089] train: loss=0.4322 acc=71.38% | val: loss=0.6177 acc=70.97% f1=40.00% auc=68.34% val_score=89.9094 val_score_bestthr=89.9892 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.314, mb=0.295, no=0.929, corr=-0.567) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 89.9094
[DBG][ep=021] disease_pos_weight=1.0000 mode=none
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.3092 mb_mean=0.2986 norm_overlap=0.9120 corr_cb=-0.6616 topkJ=0.0000
[TRAIN][ep=021] loss=0.4230 acc=68.30%
[TRAIN][ep=021] mask_avg: mc_mean=0.3055 mb_mean=0.2952 norm_overlap=0.9180 corr_cb=-0.5849
[EPOCH 021/089] train: loss=0.4230 acc=68.30% | val: loss=0.6109 acc=69.35% f1=34.48% auc=67.67% val_score=88.7228 val_score_bestthr=85.6635 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.305, mb=0.295, no=0.918, corr=-0.585) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 88.7228
[DBG][ep=022] disease_pos_weight=1.0000 mode=none
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2953 mb_mean=0.3025 norm_overlap=0.9199 corr_cb=-0.6529 topkJ=0.0004
[TRAIN][ep=022] loss=0.4147 acc=70.65%
[TRAIN][ep=022] mask_avg: mc_mean=0.2982 mb_mean=0.2952 norm_overlap=0.9077 corr_cb=-0.6006
[EPOCH 022/089] train: loss=0.4147 acc=70.65% | val: loss=0.6084 acc=69.35% f1=34.48% auc=67.56% val_score=88.7228 val_score_bestthr=85.6635 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.298, mb=0.295, no=0.908, corr=-0.601) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 88.7228
[DBG][ep=023] disease_pos_weight=1.0000 mode=none
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2968 mb_mean=0.2991 norm_overlap=0.9171 corr_cb=-0.5830 topkJ=0.0000
[TRAIN][ep=023] loss=0.4037 acc=71.74%
[TRAIN][ep=023] mask_avg: mc_mean=0.2932 mb_mean=0.2952 norm_overlap=0.8989 corr_cb=-0.6147
[EPOCH 023/089] train: loss=0.4037 acc=71.74% | val: loss=0.6056 acc=69.35% f1=34.48% auc=68.12% val_score=89.2527 val_score_bestthr=85.6635 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.293, mb=0.295, no=0.899, corr=-0.615) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 89.2527
[DBG][ep=024] disease_pos_weight=1.0000 mode=none
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2995 mb_mean=0.3002 norm_overlap=0.9067 corr_cb=-0.5887 topkJ=0.0000
[TRAIN][ep=024] loss=0.3945 acc=74.64%
[TRAIN][ep=024] mask_avg: mc_mean=0.2876 mb_mean=0.2952 norm_overlap=0.8894 corr_cb=-0.6243
[EPOCH 024/089] train: loss=0.3945 acc=74.64% | val: loss=0.6078 acc=69.35% f1=34.48% auc=68.12% val_score=85.5066 val_score_bestthr=85.6635 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.288, mb=0.295, no=0.889, corr=-0.624) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 85.5066
[DBG][ep=025] disease_pos_weight=1.0000 mode=none
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2689 mb_mean=0.2912 norm_overlap=0.9225 corr_cb=-0.4578 topkJ=0.0004
[TRAIN][ep=025] loss=0.3842 acc=73.91%
[TRAIN][ep=025] mask_avg: mc_mean=0.2832 mb_mean=0.2952 norm_overlap=0.8805 corr_cb=-0.6350
[EPOCH 025/089] train: loss=0.3842 acc=73.91% | val: loss=0.6155 acc=67.74% f1=37.50% auc=66.78% val_score=83.7279 val_score_bestthr=85.4359 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.283, mb=0.295, no=0.881, corr=-0.635) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 83.7279
[DBG][ep=026] disease_pos_weight=1.0000 mode=none
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2745 mb_mean=0.3014 norm_overlap=0.8687 corr_cb=-0.7405 topkJ=0.0000
[TRAIN][ep=026] loss=0.3767 acc=75.91%
[TRAIN][ep=026] mask_avg: mc_mean=0.2797 mb_mean=0.2952 norm_overlap=0.8721 corr_cb=-0.6499
[EPOCH 026/089] train: loss=0.3767 acc=75.91% | val: loss=0.6107 acc=69.35% f1=38.71% auc=67.11% val_score=84.2453 val_score_bestthr=87.7370 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.280, mb=0.295, no=0.872, corr=-0.650) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 84.2453
[DBG][ep=027] disease_pos_weight=1.0000 mode=none
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2513 mb_mean=0.2913 norm_overlap=0.9021 corr_cb=-0.5084 topkJ=0.0000
[TRAIN][ep=027] loss=0.3699 acc=76.27%
[TRAIN][ep=027] mask_avg: mc_mean=0.2762 mb_mean=0.2952 norm_overlap=0.8639 corr_cb=-0.6569
[EPOCH 027/089] train: loss=0.3699 acc=76.27% | val: loss=0.6241 acc=67.74% f1=41.18% auc=66.44% val_score=81.6832 val_score_bestthr=87.3634 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.276, mb=0.295, no=0.864, corr=-0.657) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 81.6832
[DBG][ep=028] disease_pos_weight=1.0000 mode=none
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2685 mb_mean=0.3033 norm_overlap=0.8740 corr_cb=-0.6914 topkJ=0.0000
[TRAIN][ep=028] loss=0.3586 acc=77.90%
[TRAIN][ep=028] mask_avg: mc_mean=0.2730 mb_mean=0.2952 norm_overlap=0.8563 corr_cb=-0.6672
[EPOCH 028/089] train: loss=0.3586 acc=77.90% | val: loss=0.6231 acc=69.35% f1=38.71% auc=65.55% val_score=81.2832 val_score_bestthr=87.7370 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.273, mb=0.295, no=0.856, corr=-0.667) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 81.2832
[DBG][ep=029] disease_pos_weight=1.0000 mode=none
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2796 mb_mean=0.2923 norm_overlap=0.8666 corr_cb=-0.6121 topkJ=0.0000
[TRAIN][ep=029] loss=0.3495 acc=80.25%
[TRAIN][ep=029] mask_avg: mc_mean=0.2703 mb_mean=0.2952 norm_overlap=0.8492 corr_cb=-0.6752
[EPOCH 029/089] train: loss=0.3495 acc=80.25% | val: loss=0.6355 acc=70.97% f1=40.00% auc=65.55% val_score=89.9094 val_score_bestthr=89.9892 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.270, mb=0.295, no=0.849, corr=-0.675) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 89.9094
[DBG][ep=030] disease_pos_weight=1.0000 mode=none
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2620 mb_mean=0.3057 norm_overlap=0.8674 corr_cb=-0.6583 topkJ=0.0000
[TRAIN][ep=030] loss=0.3432 acc=77.72%
[TRAIN][ep=030] mask_avg: mc_mean=0.2673 mb_mean=0.2951 norm_overlap=0.8420 corr_cb=-0.6797
[EPOCH 030/089] train: loss=0.3432 acc=77.72% | val: loss=0.6397 acc=69.35% f1=38.71% auc=64.99% val_score=87.8098 val_score_bestthr=87.7370 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.267, mb=0.295, no=0.842, corr=-0.680) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 87.8098
[DBG][ep=031] disease_pos_weight=1.0000 mode=none
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2526 mb_mean=0.2888 norm_overlap=0.8347 corr_cb=-0.6469 topkJ=0.0000
[TRAIN][ep=031] loss=0.3310 acc=78.26%
[TRAIN][ep=031] mask_avg: mc_mean=0.2661 mb_mean=0.2952 norm_overlap=0.8387 corr_cb=-0.6789
[EPOCH 031/089] train: loss=0.3310 acc=78.26% | val: loss=0.6344 acc=69.35% f1=42.42% auc=64.77% val_score=87.0667 val_score_bestthr=89.6835 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.266, mb=0.295, no=0.839, corr=-0.679) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 87.0667
[DBG][ep=032] disease_pos_weight=1.0000 mode=none
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2836 mb_mean=0.2844 norm_overlap=0.7631 corr_cb=-0.7825 topkJ=0.0000
[TRAIN][ep=032] loss=0.3266 acc=79.71%
[TRAIN][ep=032] mask_avg: mc_mean=0.2661 mb_mean=0.2952 norm_overlap=0.8389 corr_cb=-0.6815
[EPOCH 032/089] train: loss=0.3266 acc=79.71% | val: loss=0.6350 acc=69.35% f1=42.42% auc=64.77% val_score=86.4757 val_score_bestthr=89.6835 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.266, mb=0.295, no=0.839, corr=-0.681) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 86.4757
[DBG][ep=033] disease_pos_weight=1.0000 mode=none
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2613 mb_mean=0.3074 norm_overlap=0.8753 corr_cb=-0.6371 topkJ=0.0000
[TRAIN][ep=033] loss=0.3254 acc=80.07%
[TRAIN][ep=033] mask_avg: mc_mean=0.2661 mb_mean=0.2951 norm_overlap=0.8386 corr_cb=-0.6835
[EPOCH 033/089] train: loss=0.3254 acc=80.07% | val: loss=0.6364 acc=70.97% f1=43.75% auc=64.77% val_score=86.4757 val_score_bestthr=91.9375 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.266, mb=0.295, no=0.839, corr=-0.684) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 86.4757
[DBG][ep=034] disease_pos_weight=1.0000 mode=none
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2615 mb_mean=0.3074 norm_overlap=0.8751 corr_cb=-0.6064 topkJ=0.0000
[TRAIN][ep=034] loss=0.3228 acc=80.25%
[TRAIN][ep=034] mask_avg: mc_mean=0.2661 mb_mean=0.2952 norm_overlap=0.8389 corr_cb=-0.6802
[EPOCH 034/089] train: loss=0.3228 acc=80.25% | val: loss=0.6384 acc=70.97% f1=43.75% auc=64.21% val_score=84.2453 val_score_bestthr=91.9375 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.266, mb=0.295, no=0.839, corr=-0.680) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 84.2453
[DBG][ep=035] disease_pos_weight=1.0000 mode=none
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2656 mb_mean=0.2829 norm_overlap=0.8118 corr_cb=-0.6780 topkJ=0.0000
[TRAIN][ep=035] loss=0.3213 acc=79.89%
[TRAIN][ep=035] mask_avg: mc_mean=0.2661 mb_mean=0.2952 norm_overlap=0.8386 corr_cb=-0.6824
[EPOCH 035/089] train: loss=0.3213 acc=79.89% | val: loss=0.6380 acc=70.97% f1=43.75% auc=64.44% val_score=86.4757 val_score_bestthr=91.9375 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.266, mb=0.295, no=0.839, corr=-0.682) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 86.4757
[EARLY STOP] no improvement for 30 epochs. best_epoch=5
[CKPT] Loaded best for testing: results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
=============== FIT DONE ===============
[BEST] epoch=5 | val_acc=69.35% | val_f1=42.42% | val_auc=66.89% | val_score=92.7790 | val_score_bestthr=89.2722
[TEST@BEST] thr_used=0.370 | acc=63.40% f1=12.50% auc=57.73% | SP_sex=0.38% EO_sex=10.73% SP_age=8.77% EO_age=4.12%
[TIME] 0.68 min
[OK] Saved: results/ADHD_3x5fold_seed0/fold2_rep0_seed2/summary_fold_2.json
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4784 mb_mean=0.5063 norm_overlap=0.9999 corr_cb=-0.0928 topkJ=0.0294
[TRAIN][ep=000] loss=0.6710 acc=63.77%
[TRAIN][ep=000] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0078
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4808 mb_mean=0.5078 norm_overlap=0.9999 corr_cb=-0.1127 topkJ=0.0310
[TRAIN][ep=001] loss=0.6646 acc=63.77%
[TRAIN][ep=001] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0102
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4792 mb_mean=0.5067 norm_overlap=1.0000 corr_cb=0.0224 topkJ=0.0484
[TRAIN][ep=002] loss=0.6608 acc=63.77%
[TRAIN][ep=002] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0054
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4787 mb_mean=0.5076 norm_overlap=0.9997 corr_cb=-0.3063 topkJ=0.0248
[TRAIN][ep=003] loss=0.6578 acc=63.77%
[TRAIN][ep=003] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0074
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4810 mb_mean=0.5098 norm_overlap=1.0000 corr_cb=0.0354 topkJ=0.0553
[TRAIN][ep=004] loss=0.6568 acc=63.77%
[TRAIN][ep=004] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0056
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4798 mb_mean=0.5070 norm_overlap=1.0000 corr_cb=-0.0288 topkJ=0.0211
[TRAIN][ep=005] loss=0.6552 acc=63.77%
[TRAIN][ep=005] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0076
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4802 mb_mean=0.5083 norm_overlap=1.0001 corr_cb=0.0978 topkJ=0.0511
[TRAIN][ep=006] loss=0.6542 acc=63.77%
[TRAIN][ep=006] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0103
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4799 mb_mean=0.5072 norm_overlap=1.0000 corr_cb=-0.0156 topkJ=0.0413
[TRAIN][ep=007] loss=0.6530 acc=63.77%
[TRAIN][ep=007] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0058
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4788 mb_mean=0.5063 norm_overlap=0.9999 corr_cb=-0.1226 topkJ=0.0341
[TRAIN][ep=008] loss=0.6521 acc=63.77%
[TRAIN][ep=008] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0077
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4796 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=0.0434 topkJ=0.0713
[TRAIN][ep=009] loss=0.6503 acc=63.77%
[TRAIN][ep=009] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0082
================= FIT START (fold=2) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.35 select_by=val_score | eval_thr_mode=best_acc eval_thr_grid=coarse | disease_pos_weight_mode=none freeze_b_after=15 | two_stage=True stage1_ratio=0.35 stage2_lr_mult=0.3 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4807 mb_mean=0.5078 norm_overlap=1.0000 corr_cb=0.0284 topkJ=0.0655
[TRAIN][ep=000] loss=0.6497 acc=63.77%
[TRAIN][ep=000] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0057
[EPOCH 000/089] train: loss=0.6497 acc=63.77% | val: loss=0.6514 acc=69.35% f1=34.48% auc=66.22% val_score=69.0522 val_score_bestthr=85.2797 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.480, mb=0.508, no=1.000, corr=-0.006) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* -1000000000000000000.0000 -> 69.0522
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4809 mb_mean=0.5072 norm_overlap=1.0001 corr_cb=0.1026 topkJ=0.1054
[TRAIN][ep=001] loss=0.6477 acc=63.77%
[TRAIN][ep=001] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0084
[EPOCH 001/089] train: loss=0.6477 acc=63.77% | val: loss=0.6505 acc=70.97% f1=47.06% auc=66.56% val_score=65.7902 val_score_bestthr=93.2489 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.480, mb=0.508, no=1.000, corr=-0.008) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 69.0522 -> 65.7902
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4802 mb_mean=0.5075 norm_overlap=1.0000 corr_cb=0.0222 topkJ=0.0557
[TRAIN][ep=002] loss=0.6468 acc=63.77%
[TRAIN][ep=002] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0048
[EPOCH 002/089] train: loss=0.6468 acc=63.77% | val: loss=0.6494 acc=70.97% f1=50.00% auc=66.00% val_score=69.8259 val_score_bestthr=95.0010 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.480, mb=0.508, no=1.000, corr=-0.005) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 69.0522 -> 69.8259
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4773 mb_mean=0.5082 norm_overlap=1.0001 corr_cb=0.1498 topkJ=0.1079
[TRAIN][ep=003] loss=0.6447 acc=63.77%
[TRAIN][ep=003] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0071
[EPOCH 003/089] train: loss=0.6447 acc=63.77% | val: loss=0.6483 acc=69.35% f1=42.42% auc=67.22% val_score=71.7551 val_score_bestthr=89.5496 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.480, mb=0.508, no=1.000, corr=-0.007) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 69.8259 -> 71.7551
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4801 mb_mean=0.5075 norm_overlap=0.9999 corr_cb=-0.1147 topkJ=0.0525
[TRAIN][ep=004] loss=0.6429 acc=63.77%
[TRAIN][ep=004] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0086
[EPOCH 004/089] train: loss=0.6429 acc=63.77% | val: loss=0.6467 acc=72.58% f1=45.16% auc=67.45% val_score=77.0365 val_score_bestthr=94.1547 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.480, mb=0.508, no=1.000, corr=-0.009) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 71.7551 -> 77.0365
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4786 mb_mean=0.5078 norm_overlap=1.0001 corr_cb=0.1409 topkJ=0.1263
[TRAIN][ep=005] loss=2.6402 acc=63.77%
[TRAIN][ep=005] mask_avg: mc_mean=0.4767 mb_mean=0.5031 norm_overlap=1.0002 corr_cb=0.1606
[EPOCH 005/089] train: loss=2.6402 acc=63.77% | val: loss=0.6491 acc=69.35% f1=42.42% auc=67.11% val_score=92.7790 val_score_bestthr=89.2722 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.477, mb=0.503, no=1.000, corr=0.161) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 77.0365 -> 92.7790
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4713 mb_mean=0.4967 norm_overlap=1.0008 corr_cb=0.5277 topkJ=0.1453
[TRAIN][ep=006] loss=2.6265 acc=63.77%
[TRAIN][ep=006] mask_avg: mc_mean=0.4682 mb_mean=0.4908 norm_overlap=1.0005 corr_cb=0.3316
[EPOCH 006/089] train: loss=2.6265 acc=63.77% | val: loss=0.6479 acc=69.35% f1=51.28% auc=67.00% val_score=84.6113 val_score_bestthr=93.7937 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.468, mb=0.491, no=1.001, corr=0.332) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 84.6113
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4637 mb_mean=0.4845 norm_overlap=1.0004 corr_cb=0.2678 topkJ=0.0969
[TRAIN][ep=007] loss=2.6207 acc=63.77%
[TRAIN][ep=007] mask_avg: mc_mean=0.4581 mb_mean=0.4764 norm_overlap=1.0010 corr_cb=0.4096
[EPOCH 007/089] train: loss=2.6207 acc=63.77% | val: loss=0.6464 acc=70.97% f1=50.00% auc=67.45% val_score=87.1176 val_score_bestthr=94.9540 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.458, mb=0.476, no=1.001, corr=0.410) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 87.1176
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4525 mb_mean=0.4707 norm_overlap=1.0008 corr_cb=0.3376 topkJ=0.0925
[TRAIN][ep=008] loss=1.7304 acc=63.77%
[TRAIN][ep=008] mask_avg: mc_mean=0.4474 mb_mean=0.4598 norm_overlap=1.0016 corr_cb=0.4567
[EPOCH 008/089] train: loss=1.7304 acc=63.77% | val: loss=0.6449 acc=70.97% f1=50.00% auc=67.45% val_score=81.4369 val_score_bestthr=95.0010 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.447, mb=0.460, no=1.002, corr=0.457) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 81.4369
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4405 mb_mean=0.4470 norm_overlap=1.0016 corr_cb=0.4549 topkJ=0.1466
[TRAIN][ep=009] loss=0.8461 acc=63.77%
[TRAIN][ep=009] mask_avg: mc_mean=0.4361 mb_mean=0.4411 norm_overlap=1.0026 corr_cb=0.4933
[EPOCH 009/089] train: loss=0.8461 acc=63.77% | val: loss=0.6436 acc=69.35% f1=45.71% auc=67.67% val_score=85.1307 val_score_bestthr=91.1571 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.436, mb=0.441, no=1.003, corr=0.493) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 85.1307
[DBG][ep=010] disease_pos_weight=1.0000 mode=none
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.4315 mb_mean=0.4290 norm_overlap=1.0035 corr_cb=0.5834 topkJ=0.1968
[TRAIN][ep=010] loss=0.5827 acc=63.77%
[TRAIN][ep=010] mask_avg: mc_mean=0.4242 mb_mean=0.4204 norm_overlap=1.0038 corr_cb=0.4937
[EPOCH 010/089] train: loss=0.5827 acc=63.77% | val: loss=0.6416 acc=70.97% f1=43.75% auc=67.89% val_score=87.5853 val_score_bestthr=91.7940 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.424, mb=0.420, no=1.004, corr=0.494) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 87.5853
[DBG][ep=011] disease_pos_weight=1.0000 mode=none
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.4193 mb_mean=0.4104 norm_overlap=1.0040 corr_cb=0.4602 topkJ=0.1283
[TRAIN][ep=011] loss=0.5642 acc=63.77%
[TRAIN][ep=011] mask_avg: mc_mean=0.4118 mb_mean=0.3982 norm_overlap=1.0051 corr_cb=0.4518
[EPOCH 011/089] train: loss=0.5642 acc=63.77% | val: loss=0.6393 acc=69.35% f1=42.42% auc=68.90% val_score=89.6081 val_score_bestthr=89.5659 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.412, mb=0.398, no=1.005, corr=0.452) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 89.6081
[DBG][ep=012] disease_pos_weight=1.0000 mode=none
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.4097 mb_mean=0.3905 norm_overlap=1.0042 corr_cb=0.4214 topkJ=0.2222
[TRAIN][ep=012] loss=0.5585 acc=63.77%
[TRAIN][ep=012] mask_avg: mc_mean=0.3988 mb_mean=0.3759 norm_overlap=1.0057 corr_cb=0.3525
[EPOCH 012/089] train: loss=0.5585 acc=63.77% | val: loss=0.6368 acc=70.97% f1=40.00% auc=68.23% val_score=89.6813 val_score_bestthr=89.9892 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.399, mb=0.376, no=1.006, corr=0.353) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 89.6813
[DBG][ep=013] disease_pos_weight=1.0000 mode=none
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.3875 mb_mean=0.3607 norm_overlap=1.0078 corr_cb=0.3765 topkJ=0.1456
[TRAIN][ep=013] loss=0.5520 acc=63.77%
[TRAIN][ep=013] mask_avg: mc_mean=0.3856 mb_mean=0.3543 norm_overlap=1.0049 corr_cb=0.2134
[EPOCH 013/089] train: loss=0.5520 acc=63.77% | val: loss=0.6328 acc=70.97% f1=35.71% auc=68.90% val_score=85.4684 val_score_bestthr=87.8600 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.386, mb=0.354, no=1.005, corr=0.213) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 85.4684
[DBG][ep=014] disease_pos_weight=1.0000 mode=none
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.3855 mb_mean=0.3540 norm_overlap=1.0033 corr_cb=0.1335 topkJ=0.1160
[TRAIN][ep=014] loss=0.5443 acc=63.95%
[TRAIN][ep=014] mask_avg: mc_mean=0.3709 mb_mean=0.3345 norm_overlap=1.0011 corr_cb=0.0321
[EPOCH 014/089] train: loss=0.5443 acc=63.95% | val: loss=0.6279 acc=69.35% f1=42.42% auc=68.67% val_score=88.7799 val_score_bestthr=89.5659 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.371, mb=0.335, no=1.001, corr=0.032) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 88.7799
[DBG][ep=015] disease_pos_weight=1.0000 mode=none
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.3635 mb_mean=0.3303 norm_overlap=0.9971 corr_cb=-0.0712 topkJ=0.0503
[TRAIN][ep=015] loss=0.5377 acc=64.86%
[TRAIN][ep=015] mask_avg: mc_mean=0.3573 mb_mean=0.3252 norm_overlap=0.9940 corr_cb=-0.1357
[EPOCH 015/089] train: loss=0.5377 acc=64.86% | val: loss=0.6227 acc=69.35% f1=42.42% auc=69.79% val_score=91.1103 val_score_bestthr=89.5496 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.357, mb=0.325, no=0.994, corr=-0.136) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 91.1103
[DBG][ep=016] disease_pos_weight=1.0000 mode=none
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.3445 mb_mean=0.3333 norm_overlap=0.9902 corr_cb=-0.2051 topkJ=0.0354
[TRAIN][ep=016] loss=0.5286 acc=65.94%
[TRAIN][ep=016] mask_avg: mc_mean=0.3435 mb_mean=0.3252 norm_overlap=0.9873 corr_cb=-0.2298
[EPOCH 016/089] train: loss=0.5286 acc=65.94% | val: loss=0.6169 acc=69.35% f1=38.71% auc=70.23% val_score=89.4313 val_score_bestthr=87.7370 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.344, mb=0.325, no=0.987, corr=-0.230) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 89.4313
[DBG][ep=017] disease_pos_weight=1.0000 mode=none
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.3462 mb_mean=0.3328 norm_overlap=0.9809 corr_cb=-0.3380 topkJ=0.0215
[TRAIN][ep=017] loss=0.5206 acc=66.12%
[TRAIN][ep=017] mask_avg: mc_mean=0.3295 mb_mean=0.3252 norm_overlap=0.9797 corr_cb=-0.2959
[EPOCH 017/089] train: loss=0.5206 acc=66.12% | val: loss=0.6113 acc=70.97% f1=35.71% auc=70.79% val_score=85.5066 val_score_bestthr=87.8600 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.330, mb=0.325, no=0.980, corr=-0.296) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 85.5066
[DBG][ep=018] disease_pos_weight=1.0000 mode=none
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.3262 mb_mean=0.3338 norm_overlap=0.9783 corr_cb=-0.3046 topkJ=0.0103
[TRAIN][ep=018] loss=0.5116 acc=67.57%
[TRAIN][ep=018] mask_avg: mc_mean=0.3184 mb_mean=0.3252 norm_overlap=0.9724 corr_cb=-0.3503
[EPOCH 018/089] train: loss=0.5116 acc=67.57% | val: loss=0.6078 acc=70.97% f1=35.71% auc=69.90% val_score=89.4313 val_score_bestthr=87.8600 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.318, mb=0.325, no=0.972, corr=-0.350) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 89.4313
[DBG][ep=019] disease_pos_weight=1.0000 mode=none
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.3091 mb_mean=0.3069 norm_overlap=0.9578 corr_cb=-0.4230 topkJ=0.0056
[TRAIN][ep=019] loss=0.5024 acc=67.57%
[TRAIN][ep=019] mask_avg: mc_mean=0.3085 mb_mean=0.3252 norm_overlap=0.9659 corr_cb=-0.3776
[EPOCH 019/089] train: loss=0.5024 acc=67.57% | val: loss=0.6057 acc=69.35% f1=34.48% auc=69.90% val_score=91.3073 val_score_bestthr=85.5599 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.308, mb=0.325, no=0.966, corr=-0.378) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 91.3073
[DBG][ep=020] disease_pos_weight=1.0000 mode=none
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.3086 mb_mean=0.3285 norm_overlap=0.9557 corr_cb=-0.4524 topkJ=0.0127
[TRAIN][ep=020] loss=0.4923 acc=70.65%
[TRAIN][ep=020] mask_avg: mc_mean=0.3002 mb_mean=0.3252 norm_overlap=0.9596 corr_cb=-0.4059
[EPOCH 020/089] train: loss=0.4923 acc=70.65% | val: loss=0.6094 acc=70.97% f1=40.00% auc=69.90% val_score=88.8348 val_score_bestthr=89.9892 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.300, mb=0.325, no=0.960, corr=-0.406) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 88.8348
[DBG][ep=021] disease_pos_weight=1.0000 mode=none
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2971 mb_mean=0.3279 norm_overlap=0.9485 corr_cb=-0.5147 topkJ=0.0111
[TRAIN][ep=021] loss=0.4855 acc=69.02%
[TRAIN][ep=021] mask_avg: mc_mean=0.2933 mb_mean=0.3252 norm_overlap=0.9537 corr_cb=-0.4269
[EPOCH 021/089] train: loss=0.4855 acc=69.02% | val: loss=0.6032 acc=69.35% f1=29.63% auc=69.34% val_score=91.3073 val_score_bestthr=83.5385 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.293, mb=0.325, no=0.954, corr=-0.427) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 91.3073
[DBG][ep=022] disease_pos_weight=1.0000 mode=none
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2858 mb_mean=0.3319 norm_overlap=0.9542 corr_cb=-0.5034 topkJ=0.0053
[TRAIN][ep=022] loss=0.4797 acc=70.65%
[TRAIN][ep=022] mask_avg: mc_mean=0.2869 mb_mean=0.3252 norm_overlap=0.9481 corr_cb=-0.4455
[EPOCH 022/089] train: loss=0.4797 acc=70.65% | val: loss=0.6027 acc=69.35% f1=29.63% auc=69.01% val_score=88.6603 val_score_bestthr=83.5385 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.287, mb=0.325, no=0.948, corr=-0.445) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 88.6603
[DBG][ep=023] disease_pos_weight=1.0000 mode=none
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2860 mb_mean=0.3291 norm_overlap=0.9571 corr_cb=-0.4029 topkJ=0.0016
[TRAIN][ep=023] loss=0.4707 acc=72.28%
[TRAIN][ep=023] mask_avg: mc_mean=0.2829 mb_mean=0.3252 norm_overlap=0.9435 corr_cb=-0.4603
[EPOCH 023/089] train: loss=0.4707 acc=72.28% | val: loss=0.6012 acc=69.35% f1=34.48% auc=69.45% val_score=89.4313 val_score_bestthr=85.6635 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.283, mb=0.325, no=0.944, corr=-0.460) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 89.4313
[DBG][ep=024] disease_pos_weight=1.0000 mode=none
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2865 mb_mean=0.3296 norm_overlap=0.9507 corr_cb=-0.3969 topkJ=0.0028
[TRAIN][ep=024] loss=0.4630 acc=74.09%
[TRAIN][ep=024] mask_avg: mc_mean=0.2780 mb_mean=0.3252 norm_overlap=0.9391 corr_cb=-0.4707
[EPOCH 024/089] train: loss=0.4630 acc=74.09% | val: loss=0.6044 acc=69.35% f1=29.63% auc=69.45% val_score=88.5091 val_score_bestthr=83.5385 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.278, mb=0.325, no=0.939, corr=-0.471) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 88.5091
[DBG][ep=025] disease_pos_weight=1.0000 mode=none
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2622 mb_mean=0.3229 norm_overlap=0.9626 corr_cb=-0.3088 topkJ=0.0081
[TRAIN][ep=025] loss=0.4542 acc=73.73%
[TRAIN][ep=025] mask_avg: mc_mean=0.2739 mb_mean=0.3252 norm_overlap=0.9343 corr_cb=-0.4840
[EPOCH 025/089] train: loss=0.4542 acc=73.73% | val: loss=0.6126 acc=69.35% f1=29.63% auc=67.45% val_score=86.5843 val_score_bestthr=83.5385 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.274, mb=0.325, no=0.934, corr=-0.484) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 86.5843
[DBG][ep=026] disease_pos_weight=1.0000 mode=none
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2684 mb_mean=0.3317 norm_overlap=0.9270 corr_cb=-0.6177 topkJ=0.0012
[TRAIN][ep=026] loss=0.4475 acc=76.27%
[TRAIN][ep=026] mask_avg: mc_mean=0.2705 mb_mean=0.3252 norm_overlap=0.9298 corr_cb=-0.5019
[EPOCH 026/089] train: loss=0.4475 acc=76.27% | val: loss=0.6081 acc=69.35% f1=38.71% auc=68.67% val_score=86.3299 val_score_bestthr=87.7370 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.270, mb=0.325, no=0.930, corr=-0.502) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 86.3299
[DBG][ep=027] disease_pos_weight=1.0000 mode=none
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2465 mb_mean=0.3224 norm_overlap=0.9575 corr_cb=-0.3146 topkJ=0.0060
[TRAIN][ep=027] loss=0.4419 acc=74.28%
[TRAIN][ep=027] mask_avg: mc_mean=0.2667 mb_mean=0.3252 norm_overlap=0.9256 corr_cb=-0.5083
[EPOCH 027/089] train: loss=0.4419 acc=74.28% | val: loss=0.6201 acc=69.35% f1=29.63% auc=67.56% val_score=86.5843 val_score_bestthr=83.5385 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.267, mb=0.325, no=0.926, corr=-0.508) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 86.5843
[DBG][ep=028] disease_pos_weight=1.0000 mode=none
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2618 mb_mean=0.3328 norm_overlap=0.9321 corr_cb=-0.5513 topkJ=0.0004
[TRAIN][ep=028] loss=0.4320 acc=77.17%
[TRAIN][ep=028] mask_avg: mc_mean=0.2636 mb_mean=0.3252 norm_overlap=0.9212 corr_cb=-0.5235
[EPOCH 028/089] train: loss=0.4320 acc=77.17% | val: loss=0.6187 acc=67.74% f1=37.50% auc=67.34% val_score=86.3299 val_score_bestthr=85.5091 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.264, mb=0.325, no=0.921, corr=-0.524) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 86.3299
[DBG][ep=029] disease_pos_weight=1.0000 mode=none
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2713 mb_mean=0.3230 norm_overlap=0.9229 corr_cb=-0.5070 topkJ=0.0000
[TRAIN][ep=029] loss=0.4242 acc=78.62%
[TRAIN][ep=029] mask_avg: mc_mean=0.2607 mb_mean=0.3252 norm_overlap=0.9172 corr_cb=-0.5331
[EPOCH 029/089] train: loss=0.4242 acc=78.62% | val: loss=0.6295 acc=70.97% f1=40.00% auc=67.45% val_score=92.9626 val_score_bestthr=89.9892 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.261, mb=0.325, no=0.917, corr=-0.533) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=* 92.7790 -> 92.9626
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=030] disease_pos_weight=1.0000 mode=none
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2548 mb_mean=0.3350 norm_overlap=0.9273 corr_cb=-0.5274 topkJ=0.0012
[TRAIN][ep=030] loss=0.4186 acc=76.81%
[TRAIN][ep=030] mask_avg: mc_mean=0.2573 mb_mean=0.3252 norm_overlap=0.9131 corr_cb=-0.5395
[EPOCH 030/089] train: loss=0.4186 acc=76.81% | val: loss=0.6339 acc=69.35% f1=38.71% auc=66.78% val_score=90.6945 val_score_bestthr=87.7370 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.257, mb=0.325, no=0.913, corr=-0.540) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.9626 -> 90.6945
[DBG][ep=031] disease_pos_weight=1.0000 mode=none
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2461 mb_mean=0.3187 norm_overlap=0.9077 corr_cb=-0.5136 topkJ=0.0048
[TRAIN][ep=031] loss=0.4071 acc=77.36%
[TRAIN][ep=031] mask_avg: mc_mean=0.2561 mb_mean=0.3252 norm_overlap=0.9113 corr_cb=-0.5376
[EPOCH 031/089] train: loss=0.4071 acc=77.36% | val: loss=0.6284 acc=69.35% f1=38.71% auc=66.22% val_score=84.2453 val_score_bestthr=87.7370 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.256, mb=0.325, no=0.911, corr=-0.538) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.9626 -> 84.2453
[DBG][ep=032] disease_pos_weight=1.0000 mode=none
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2698 mb_mean=0.3144 norm_overlap=0.8537 corr_cb=-0.6848 topkJ=0.0000
[TRAIN][ep=032] loss=0.4027 acc=78.08%
[TRAIN][ep=032] mask_avg: mc_mean=0.2561 mb_mean=0.3252 norm_overlap=0.9114 corr_cb=-0.5411
[EPOCH 032/089] train: loss=0.4027 acc=78.08% | val: loss=0.6291 acc=69.35% f1=38.71% auc=66.11% val_score=84.2453 val_score_bestthr=87.7370 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.256, mb=0.325, no=0.911, corr=-0.541) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.9626 -> 84.2453
[DBG][ep=033] disease_pos_weight=1.0000 mode=none
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2518 mb_mean=0.3363 norm_overlap=0.9362 corr_cb=-0.4643 topkJ=0.0004
[TRAIN][ep=033] loss=0.4016 acc=78.44%
[TRAIN][ep=033] mask_avg: mc_mean=0.2561 mb_mean=0.3252 norm_overlap=0.9112 corr_cb=-0.5436
[EPOCH 033/089] train: loss=0.4016 acc=78.44% | val: loss=0.6302 acc=69.35% f1=38.71% auc=66.11% val_score=84.2453 val_score_bestthr=87.7370 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.256, mb=0.325, no=0.911, corr=-0.544) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.9626 -> 84.2453
[DBG][ep=034] disease_pos_weight=1.0000 mode=none
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2511 mb_mean=0.3351 norm_overlap=0.9419 corr_cb=-0.3951 topkJ=0.0020
[TRAIN][ep=034] loss=0.3992 acc=78.26%
[TRAIN][ep=034] mask_avg: mc_mean=0.2561 mb_mean=0.3252 norm_overlap=0.9114 corr_cb=-0.5398
[EPOCH 034/089] train: loss=0.3992 acc=78.26% | val: loss=0.6319 acc=69.35% f1=38.71% auc=65.89% val_score=84.2453 val_score_bestthr=87.7370 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.256, mb=0.325, no=0.911, corr=-0.540) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.9626 -> 84.2453
[DBG][ep=035] disease_pos_weight=1.0000 mode=none
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2548 mb_mean=0.3139 norm_overlap=0.8983 corr_cb=-0.5185 topkJ=0.0000
[TRAIN][ep=035] loss=0.3978 acc=78.80%
[TRAIN][ep=035] mask_avg: mc_mean=0.2561 mb_mean=0.3252 norm_overlap=0.9112 corr_cb=-0.5424
[EPOCH 035/089] train: loss=0.3978 acc=78.80% | val: loss=0.6315 acc=69.35% f1=38.71% auc=66.00% val_score=84.2453 val_score_bestthr=87.7370 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.256, mb=0.325, no=0.911, corr=-0.542) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.9626 -> 84.2453
[DBG][ep=036] disease_pos_weight=1.0000 mode=none
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2452 mb_mean=0.3154 norm_overlap=0.9139 corr_cb=-0.4690 topkJ=0.0016
[TRAIN][ep=036] loss=0.3956 acc=78.80%
[TRAIN][ep=036] mask_avg: mc_mean=0.2561 mb_mean=0.3252 norm_overlap=0.9111 corr_cb=-0.5429
[EPOCH 036/089] train: loss=0.3956 acc=78.80% | val: loss=0.6334 acc=69.35% f1=38.71% auc=65.89% val_score=84.2453 val_score_bestthr=87.7370 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.256, mb=0.325, no=0.911, corr=-0.543) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.9626 -> 84.2453
[DBG][ep=037] disease_pos_weight=1.0000 mode=none
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.2531 mb_mean=0.3100 norm_overlap=0.8890 corr_cb=-0.5989 topkJ=0.0016
[TRAIN][ep=037] loss=0.3947 acc=78.26%
[TRAIN][ep=037] mask_avg: mc_mean=0.2561 mb_mean=0.3252 norm_overlap=0.9110 corr_cb=-0.5427
[EPOCH 037/089] train: loss=0.3947 acc=78.26% | val: loss=0.6341 acc=69.35% f1=38.71% auc=65.89% val_score=84.2453 val_score_bestthr=87.7370 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.256, mb=0.325, no=0.911, corr=-0.543) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.9626 -> 84.2453
[DBG][ep=038] disease_pos_weight=1.0000 mode=none
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2643 mb_mean=0.3395 norm_overlap=0.9326 corr_cb=-0.5150 topkJ=0.0008
[TRAIN][ep=038] loss=0.3931 acc=79.53%
[TRAIN][ep=038] mask_avg: mc_mean=0.2561 mb_mean=0.3252 norm_overlap=0.9111 corr_cb=-0.5414
[EPOCH 038/089] train: loss=0.3931 acc=79.53% | val: loss=0.6364 acc=69.35% f1=38.71% auc=65.77% val_score=84.2453 val_score_bestthr=87.7370 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.256, mb=0.325, no=0.911, corr=-0.541) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.9626 -> 84.2453
[DBG][ep=039] disease_pos_weight=1.0000 mode=none
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2548 mb_mean=0.3183 norm_overlap=0.8877 corr_cb=-0.6151 topkJ=0.0000
[TRAIN][ep=039] loss=0.3907 acc=79.35%
[TRAIN][ep=039] mask_avg: mc_mean=0.2561 mb_mean=0.3252 norm_overlap=0.9114 corr_cb=-0.5404
[EPOCH 039/089] train: loss=0.3907 acc=79.35% | val: loss=0.6369 acc=69.35% f1=38.71% auc=65.55% val_score=84.2453 val_score_bestthr=87.7370 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.256, mb=0.325, no=0.911, corr=-0.540) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.9626 -> 84.2453
[DBG][ep=040] disease_pos_weight=1.0000 mode=none
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.2627 mb_mean=0.3282 norm_overlap=0.8940 corr_cb=-0.6724 topkJ=0.0004
[TRAIN][ep=040] loss=0.3898 acc=78.44%
[TRAIN][ep=040] mask_avg: mc_mean=0.2561 mb_mean=0.3252 norm_overlap=0.9113 corr_cb=-0.5405
[EPOCH 040/089] train: loss=0.3898 acc=78.44% | val: loss=0.6378 acc=69.35% f1=38.71% auc=65.55% val_score=84.2453 val_score_bestthr=87.7370 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.256, mb=0.325, no=0.911, corr=-0.541) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.9626 -> 84.2453
[DBG][ep=041] disease_pos_weight=1.0000 mode=none
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.2584 mb_mean=0.3221 norm_overlap=0.8899 corr_cb=-0.6342 topkJ=0.0000
[TRAIN][ep=041] loss=0.3872 acc=79.17%
[TRAIN][ep=041] mask_avg: mc_mean=0.2561 mb_mean=0.3252 norm_overlap=0.9109 corr_cb=-0.5421
[EPOCH 041/089] train: loss=0.3872 acc=79.17% | val: loss=0.6387 acc=69.35% f1=38.71% auc=65.22% val_score=84.2453 val_score_bestthr=87.7370 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.256, mb=0.325, no=0.911, corr=-0.542) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.9626 -> 84.2453
[DBG][ep=042] disease_pos_weight=1.0000 mode=none
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.2506 mb_mean=0.3319 norm_overlap=0.9368 corr_cb=-0.4873 topkJ=0.0032
[TRAIN][ep=042] loss=0.3865 acc=78.80%
[TRAIN][ep=042] mask_avg: mc_mean=0.2562 mb_mean=0.3252 norm_overlap=0.9112 corr_cb=-0.5426
[EPOCH 042/089] train: loss=0.3865 acc=78.80% | val: loss=0.6404 acc=69.35% f1=38.71% auc=65.22% val_score=84.2453 val_score_bestthr=87.7370 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.256, mb=0.325, no=0.911, corr=-0.543) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.9626 -> 84.2453
[DBG][ep=043] disease_pos_weight=1.0000 mode=none
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.2581 mb_mean=0.3313 norm_overlap=0.9072 corr_cb=-0.5768 topkJ=0.0004
[TRAIN][ep=043] loss=0.3843 acc=78.44%
[TRAIN][ep=043] mask_avg: mc_mean=0.2561 mb_mean=0.3252 norm_overlap=0.9113 corr_cb=-0.5392
[EPOCH 043/089] train: loss=0.3843 acc=78.44% | val: loss=0.6410 acc=69.35% f1=38.71% auc=64.77% val_score=86.4757 val_score_bestthr=87.7370 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.256, mb=0.325, no=0.911, corr=-0.539) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.9626 -> 86.4757
[DBG][ep=044] disease_pos_weight=1.0000 mode=none
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2573 mb_mean=0.3193 norm_overlap=0.9171 corr_cb=-0.4346 topkJ=0.0000
[TRAIN][ep=044] loss=0.3831 acc=79.17%
[TRAIN][ep=044] mask_avg: mc_mean=0.2561 mb_mean=0.3252 norm_overlap=0.9114 corr_cb=-0.5398
[EPOCH 044/089] train: loss=0.3831 acc=79.17% | val: loss=0.6422 acc=69.35% f1=38.71% auc=64.88% val_score=86.4757 val_score_bestthr=87.7370 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.256, mb=0.325, no=0.911, corr=-0.540) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.9626 -> 86.4757
[DBG][ep=045] disease_pos_weight=1.0000 mode=none
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2462 mb_mean=0.3050 norm_overlap=0.8619 corr_cb=-0.6054 topkJ=0.0016
[TRAIN][ep=045] loss=0.3824 acc=78.99%
[TRAIN][ep=045] mask_avg: mc_mean=0.2561 mb_mean=0.3252 norm_overlap=0.9113 corr_cb=-0.5418
[EPOCH 045/089] train: loss=0.3824 acc=78.99% | val: loss=0.6430 acc=69.35% f1=38.71% auc=64.99% val_score=86.4757 val_score_bestthr=87.7370 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.256, mb=0.325, no=0.911, corr=-0.542) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.9626 -> 86.4757
[DBG][ep=046] disease_pos_weight=1.0000 mode=none
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.2383 mb_mean=0.3271 norm_overlap=0.9420 corr_cb=-0.4014 topkJ=0.0070
[TRAIN][ep=046] loss=0.3820 acc=79.53%
[TRAIN][ep=046] mask_avg: mc_mean=0.2561 mb_mean=0.3252 norm_overlap=0.9114 corr_cb=-0.5402
[EPOCH 046/089] train: loss=0.3820 acc=79.53% | val: loss=0.6445 acc=69.35% f1=42.42% auc=65.11% val_score=86.4757 val_score_bestthr=89.6373 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.256, mb=0.325, no=0.911, corr=-0.540) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.9626 -> 86.4757
[DBG][ep=047] disease_pos_weight=1.0000 mode=none
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.2584 mb_mean=0.3206 norm_overlap=0.9020 corr_cb=-0.5618 topkJ=0.0004
[TRAIN][ep=047] loss=0.3781 acc=79.35%
[TRAIN][ep=047] mask_avg: mc_mean=0.2561 mb_mean=0.3252 norm_overlap=0.9113 corr_cb=-0.5396
[EPOCH 047/089] train: loss=0.3781 acc=79.35% | val: loss=0.6457 acc=69.35% f1=38.71% auc=64.99% val_score=86.4757 val_score_bestthr=87.7370 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.256, mb=0.325, no=0.911, corr=-0.540) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.9626 -> 86.4757
[DBG][ep=048] disease_pos_weight=1.0000 mode=none
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.2516 mb_mean=0.3289 norm_overlap=0.9000 corr_cb=-0.5814 topkJ=0.0012
[TRAIN][ep=048] loss=0.3765 acc=78.99%
[TRAIN][ep=048] mask_avg: mc_mean=0.2561 mb_mean=0.3252 norm_overlap=0.9112 corr_cb=-0.5417
[EPOCH 048/089] train: loss=0.3765 acc=78.99% | val: loss=0.6464 acc=69.35% f1=42.42% auc=64.77% val_score=86.4757 val_score_bestthr=89.6373 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.256, mb=0.325, no=0.911, corr=-0.542) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.9626 -> 86.4757
[DBG][ep=049] disease_pos_weight=1.0000 mode=none
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.2552 mb_mean=0.3296 norm_overlap=0.9456 corr_cb=-0.3572 topkJ=0.0012
[TRAIN][ep=049] loss=0.3746 acc=80.62%
[TRAIN][ep=049] mask_avg: mc_mean=0.2561 mb_mean=0.3252 norm_overlap=0.9113 corr_cb=-0.5421
[EPOCH 049/089] train: loss=0.3746 acc=80.62% | val: loss=0.6482 acc=69.35% f1=42.42% auc=64.88% val_score=86.4757 val_score_bestthr=89.6373 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.256, mb=0.325, no=0.911, corr=-0.542) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.9626 -> 86.4757
[DBG][ep=050] disease_pos_weight=1.0000 mode=none
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.2540 mb_mean=0.3271 norm_overlap=0.9100 corr_cb=-0.5853 topkJ=0.0000
[TRAIN][ep=050] loss=0.3737 acc=79.71%
[TRAIN][ep=050] mask_avg: mc_mean=0.2561 mb_mean=0.3252 norm_overlap=0.9113 corr_cb=-0.5417
[EPOCH 050/089] train: loss=0.3737 acc=79.71% | val: loss=0.6490 acc=69.35% f1=42.42% auc=64.88% val_score=86.4757 val_score_bestthr=89.6373 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.256, mb=0.325, no=0.911, corr=-0.542) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.9626 -> 86.4757
[DBG][ep=051] disease_pos_weight=1.0000 mode=none
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.2738 mb_mean=0.3144 norm_overlap=0.8870 corr_cb=-0.6519 topkJ=0.0000
[TRAIN][ep=051] loss=0.3725 acc=79.53%
[TRAIN][ep=051] mask_avg: mc_mean=0.2562 mb_mean=0.3252 norm_overlap=0.9113 corr_cb=-0.5412
[EPOCH 051/089] train: loss=0.3725 acc=79.53% | val: loss=0.6504 acc=70.97% f1=43.75% auc=64.99% val_score=86.4757 val_score_bestthr=91.9375 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.256, mb=0.325, no=0.911, corr=-0.541) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.9626 -> 86.4757
[DBG][ep=052] disease_pos_weight=1.0000 mode=none
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.2616 mb_mean=0.3185 norm_overlap=0.9137 corr_cb=-0.5148 topkJ=0.0008
[TRAIN][ep=052] loss=0.3706 acc=80.43%
[TRAIN][ep=052] mask_avg: mc_mean=0.2561 mb_mean=0.3252 norm_overlap=0.9112 corr_cb=-0.5416
[EPOCH 052/089] train: loss=0.3706 acc=80.43% | val: loss=0.6512 acc=69.35% f1=42.42% auc=64.77% val_score=86.4757 val_score_bestthr=89.6373 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.256, mb=0.325, no=0.911, corr=-0.542) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.9626 -> 86.4757
[DBG][ep=053] disease_pos_weight=1.0000 mode=none
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.2526 mb_mean=0.3313 norm_overlap=0.9254 corr_cb=-0.5056 topkJ=0.0016
[TRAIN][ep=053] loss=0.3697 acc=80.25%
[TRAIN][ep=053] mask_avg: mc_mean=0.2561 mb_mean=0.3252 norm_overlap=0.9112 corr_cb=-0.5424
[EPOCH 053/089] train: loss=0.3697 acc=80.25% | val: loss=0.6527 acc=69.35% f1=42.42% auc=64.66% val_score=86.4757 val_score_bestthr=89.6373 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.256, mb=0.325, no=0.911, corr=-0.542) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.9626 -> 86.4757
[DBG][ep=054] disease_pos_weight=1.0000 mode=none
[DBG][ep=054] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=054] mask(step0): mc_mean=0.2614 mb_mean=0.3186 norm_overlap=0.8763 corr_cb=-0.6926 topkJ=0.0000
[TRAIN][ep=054] loss=0.3680 acc=79.89%
[TRAIN][ep=054] mask_avg: mc_mean=0.2561 mb_mean=0.3252 norm_overlap=0.9115 corr_cb=-0.5417
[EPOCH 054/089] train: loss=0.3680 acc=79.89% | val: loss=0.6540 acc=69.35% f1=42.42% auc=64.77% val_score=86.4757 val_score_bestthr=89.6373 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.256, mb=0.325, no=0.911, corr=-0.542) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.9626 -> 86.4757
[DBG][ep=055] disease_pos_weight=1.0000 mode=none
[DBG][ep=055] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=055] mask(step0): mc_mean=0.2596 mb_mean=0.3346 norm_overlap=0.9236 corr_cb=-0.5506 topkJ=0.0012
[TRAIN][ep=055] loss=0.3669 acc=80.43%
[TRAIN][ep=055] mask_avg: mc_mean=0.2561 mb_mean=0.3252 norm_overlap=0.9114 corr_cb=-0.5401
[EPOCH 055/089] train: loss=0.3669 acc=80.43% | val: loss=0.6563 acc=69.35% f1=42.42% auc=64.99% val_score=86.4757 val_score_bestthr=89.6373 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.256, mb=0.325, no=0.911, corr=-0.540) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.9626 -> 86.4757
[DBG][ep=056] disease_pos_weight=1.0000 mode=none
[DBG][ep=056] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=056] mask(step0): mc_mean=0.2613 mb_mean=0.3226 norm_overlap=0.9098 corr_cb=-0.5469 topkJ=0.0016
[TRAIN][ep=056] loss=0.3654 acc=80.25%
[TRAIN][ep=056] mask_avg: mc_mean=0.2561 mb_mean=0.3252 norm_overlap=0.9113 corr_cb=-0.5424
[EPOCH 056/089] train: loss=0.3654 acc=80.25% | val: loss=0.6569 acc=70.97% f1=43.75% auc=64.77% val_score=86.4757 val_score_bestthr=91.9375 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.256, mb=0.325, no=0.911, corr=-0.542) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.9626 -> 86.4757
[DBG][ep=057] disease_pos_weight=1.0000 mode=none
[DBG][ep=057] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=057] mask(step0): mc_mean=0.2569 mb_mean=0.3371 norm_overlap=0.9357 corr_cb=-0.4970 topkJ=0.0021
[TRAIN][ep=057] loss=0.3635 acc=80.25%
[TRAIN][ep=057] mask_avg: mc_mean=0.2561 mb_mean=0.3252 norm_overlap=0.9113 corr_cb=-0.5418
[EPOCH 057/089] train: loss=0.3635 acc=80.25% | val: loss=0.6574 acc=69.35% f1=42.42% auc=64.88% val_score=86.4757 val_score_bestthr=89.6373 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.256, mb=0.325, no=0.911, corr=-0.542) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.9626 -> 86.4757
[DBG][ep=058] disease_pos_weight=1.0000 mode=none
[DBG][ep=058] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=058] mask(step0): mc_mean=0.2614 mb_mean=0.3397 norm_overlap=0.9474 corr_cb=-0.4036 topkJ=0.0050
[TRAIN][ep=058] loss=0.3622 acc=81.16%
[TRAIN][ep=058] mask_avg: mc_mean=0.2561 mb_mean=0.3252 norm_overlap=0.9110 corr_cb=-0.5417
[EPOCH 058/089] train: loss=0.3622 acc=81.16% | val: loss=0.6583 acc=69.35% f1=42.42% auc=64.77% val_score=86.4757 val_score_bestthr=89.6373 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.256, mb=0.325, no=0.911, corr=-0.542) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.9626 -> 86.4757
[DBG][ep=059] disease_pos_weight=1.0000 mode=none
[DBG][ep=059] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=059] mask(step0): mc_mean=0.2510 mb_mean=0.3210 norm_overlap=0.9022 corr_cb=-0.5568 topkJ=0.0000
[TRAIN][ep=059] loss=0.3605 acc=81.16%
[TRAIN][ep=059] mask_avg: mc_mean=0.2561 mb_mean=0.3252 norm_overlap=0.9112 corr_cb=-0.5406
[EPOCH 059/089] train: loss=0.3605 acc=81.16% | val: loss=0.6594 acc=69.35% f1=42.42% auc=64.99% val_score=86.4757 val_score_bestthr=89.6373 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.256, mb=0.325, no=0.911, corr=-0.541) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.9626 -> 86.4757
[EARLY STOP] no improvement for 30 epochs. best_epoch=29
[CKPT] Loaded best for testing: results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
=============== FIT DONE ===============
[BEST] epoch=29 | val_acc=70.97% | val_f1=40.00% | val_auc=67.45% | val_score=92.9626 | val_score_bestthr=89.9892
[TEST@BEST] thr_used=0.560 | acc=64.71% f1=15.62% auc=58.67% | SP_sex=5.86% EO_sex=1.61% SP_age=5.25% EO_age=11.76%
[TIME] 0.87 min
[OK] Saved: results/ADHD_3x5fold_seed0/fold2_rep0_seed2/summary_fold_2.json
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4784 mb_mean=0.5063 norm_overlap=0.9999 corr_cb=-0.0928 topkJ=0.0294
[TRAIN][ep=000] loss=0.6710 acc=63.77%
[TRAIN][ep=000] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0078
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4808 mb_mean=0.5078 norm_overlap=0.9999 corr_cb=-0.1127 topkJ=0.0310
[TRAIN][ep=001] loss=0.6646 acc=63.77%
[TRAIN][ep=001] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0102
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4792 mb_mean=0.5067 norm_overlap=1.0000 corr_cb=0.0224 topkJ=0.0484
[TRAIN][ep=002] loss=0.6608 acc=63.77%
[TRAIN][ep=002] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0054
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4787 mb_mean=0.5076 norm_overlap=0.9997 corr_cb=-0.3063 topkJ=0.0248
[TRAIN][ep=003] loss=0.6578 acc=63.77%
[TRAIN][ep=003] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0074
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4810 mb_mean=0.5098 norm_overlap=1.0000 corr_cb=0.0354 topkJ=0.0553
[TRAIN][ep=004] loss=0.6568 acc=63.77%
[TRAIN][ep=004] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0056
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4798 mb_mean=0.5070 norm_overlap=1.0000 corr_cb=-0.0288 topkJ=0.0211
[TRAIN][ep=005] loss=0.6552 acc=63.77%
[TRAIN][ep=005] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0076
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4802 mb_mean=0.5083 norm_overlap=1.0001 corr_cb=0.0978 topkJ=0.0511
[TRAIN][ep=006] loss=0.6542 acc=63.77%
[TRAIN][ep=006] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0103
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4799 mb_mean=0.5072 norm_overlap=1.0000 corr_cb=-0.0156 topkJ=0.0413
[TRAIN][ep=007] loss=0.6530 acc=63.77%
[TRAIN][ep=007] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0058
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4788 mb_mean=0.5063 norm_overlap=0.9999 corr_cb=-0.1226 topkJ=0.0341
[TRAIN][ep=008] loss=0.6521 acc=63.77%
[TRAIN][ep=008] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0077
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4796 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=0.0434 topkJ=0.0713
[TRAIN][ep=009] loss=0.6503 acc=63.77%
[TRAIN][ep=009] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0082
================= FIT START (fold=2) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.35 select_by=val_score | eval_thr_mode=best_acc eval_thr_grid=coarse | disease_pos_weight_mode=none freeze_b_after=15 | two_stage=True stage1_ratio=0.35 stage2_lr_mult=0.3 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4807 mb_mean=0.5078 norm_overlap=1.0000 corr_cb=0.0284 topkJ=0.0655
[TRAIN][ep=000] loss=0.6497 acc=63.77%
[TRAIN][ep=000] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0057
[EPOCH 000/089] train: loss=0.6497 acc=63.77% | val: loss=0.6514 acc=69.35% f1=34.48% auc=66.22% val_score=69.0522 val_score_bestthr=85.2797 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.480, mb=0.508, no=1.000, corr=-0.006) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* -1000000000000000000.0000 -> 69.0522
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4809 mb_mean=0.5072 norm_overlap=1.0001 corr_cb=0.1026 topkJ=0.1054
[TRAIN][ep=001] loss=0.6477 acc=63.77%
[TRAIN][ep=001] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0084
[EPOCH 001/089] train: loss=0.6477 acc=63.77% | val: loss=0.6505 acc=70.97% f1=47.06% auc=66.56% val_score=65.7902 val_score_bestthr=93.2489 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.480, mb=0.508, no=1.000, corr=-0.008) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 69.0522 -> 65.7902
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4802 mb_mean=0.5075 norm_overlap=1.0000 corr_cb=0.0222 topkJ=0.0557
[TRAIN][ep=002] loss=0.6468 acc=63.77%
[TRAIN][ep=002] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0048
[EPOCH 002/089] train: loss=0.6468 acc=63.77% | val: loss=0.6494 acc=70.97% f1=50.00% auc=66.00% val_score=69.8259 val_score_bestthr=95.0010 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.480, mb=0.508, no=1.000, corr=-0.005) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 69.0522 -> 69.8259
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4773 mb_mean=0.5082 norm_overlap=1.0001 corr_cb=0.1498 topkJ=0.1079
[TRAIN][ep=003] loss=0.6447 acc=63.77%
[TRAIN][ep=003] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0071
[EPOCH 003/089] train: loss=0.6447 acc=63.77% | val: loss=0.6483 acc=69.35% f1=42.42% auc=67.22% val_score=71.7551 val_score_bestthr=89.5496 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.480, mb=0.508, no=1.000, corr=-0.007) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 69.8259 -> 71.7551
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4801 mb_mean=0.5075 norm_overlap=0.9999 corr_cb=-0.1147 topkJ=0.0525
[TRAIN][ep=004] loss=0.6429 acc=63.77%
[TRAIN][ep=004] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0086
[EPOCH 004/089] train: loss=0.6429 acc=63.77% | val: loss=0.6467 acc=72.58% f1=45.16% auc=67.45% val_score=77.0365 val_score_bestthr=94.1547 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.480, mb=0.508, no=1.000, corr=-0.009) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 71.7551 -> 77.0365
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4786 mb_mean=0.5078 norm_overlap=1.0001 corr_cb=0.1409 topkJ=0.1263
[TRAIN][ep=005] loss=1.8952 acc=63.77%
[TRAIN][ep=005] mask_avg: mc_mean=0.4762 mb_mean=0.4982 norm_overlap=1.0002 corr_cb=0.1834
[EPOCH 005/089] train: loss=1.8952 acc=63.77% | val: loss=0.6489 acc=69.35% f1=42.42% auc=66.89% val_score=92.7790 val_score_bestthr=89.2722 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.476, mb=0.498, no=1.000, corr=0.183) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 77.0365 -> 92.7790
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4704 mb_mean=0.4867 norm_overlap=1.0010 corr_cb=0.5694 topkJ=0.1612
[TRAIN][ep=006] loss=1.8915 acc=63.77%
[TRAIN][ep=006] mask_avg: mc_mean=0.4666 mb_mean=0.4746 norm_overlap=1.0008 corr_cb=0.3627
[EPOCH 006/089] train: loss=1.8915 acc=63.77% | val: loss=0.6476 acc=69.35% f1=51.28% auc=66.89% val_score=80.4100 val_score_bestthr=93.7937 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.467, mb=0.475, no=1.001, corr=0.363) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 80.4100
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4616 mb_mean=0.4612 norm_overlap=1.0009 corr_cb=0.3759 topkJ=0.1496
[TRAIN][ep=007] loss=1.8847 acc=63.77%
[TRAIN][ep=007] mask_avg: mc_mean=0.4554 mb_mean=0.4472 norm_overlap=1.0018 corr_cb=0.4234
[EPOCH 007/089] train: loss=1.8847 acc=63.77% | val: loss=0.6461 acc=70.97% f1=50.00% auc=67.78% val_score=87.1176 val_score_bestthr=94.9540 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.455, mb=0.447, no=1.002, corr=0.423) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 87.1176
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4493 mb_mean=0.4350 norm_overlap=1.0018 corr_cb=0.3932 topkJ=0.1322
[TRAIN][ep=008] loss=1.2878 acc=63.77%
[TRAIN][ep=008] mask_avg: mc_mean=0.4439 mb_mean=0.4169 norm_overlap=1.0031 corr_cb=0.4452
[EPOCH 008/089] train: loss=1.2878 acc=63.77% | val: loss=0.6445 acc=70.97% f1=50.00% auc=67.45% val_score=81.4369 val_score_bestthr=95.0010 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.444, mb=0.417, no=1.003, corr=0.445) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 81.4369
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4365 mb_mean=0.3944 norm_overlap=1.0029 corr_cb=0.4011 topkJ=0.1742
[TRAIN][ep=009] loss=0.6951 acc=63.77%
[TRAIN][ep=009] mask_avg: mc_mean=0.4321 mb_mean=0.3860 norm_overlap=1.0044 corr_cb=0.4154
[EPOCH 009/089] train: loss=0.6951 acc=63.77% | val: loss=0.6431 acc=69.35% f1=45.71% auc=67.78% val_score=85.1307 val_score_bestthr=91.1571 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.432, mb=0.386, no=1.004, corr=0.415) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 85.1307
[DBG][ep=010] disease_pos_weight=1.0000 mode=none
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.4274 mb_mean=0.3646 norm_overlap=1.0064 corr_cb=0.4845 topkJ=0.1676
[TRAIN][ep=010] loss=0.5773 acc=63.77%
[TRAIN][ep=010] mask_avg: mc_mean=0.4200 mb_mean=0.3570 norm_overlap=1.0051 corr_cb=0.3277
[EPOCH 010/089] train: loss=0.5773 acc=63.77% | val: loss=0.6406 acc=69.35% f1=42.42% auc=68.67% val_score=85.5165 val_score_bestthr=89.5659 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.420, mb=0.357, no=1.005, corr=0.328) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 85.5165
[DBG][ep=011] disease_pos_weight=1.0000 mode=none
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.4147 mb_mean=0.3439 norm_overlap=1.0045 corr_cb=0.2475 topkJ=0.1208
[TRAIN][ep=011] loss=0.5585 acc=63.77%
[TRAIN][ep=011] mask_avg: mc_mean=0.4076 mb_mean=0.3316 norm_overlap=1.0039 corr_cb=0.1726
[EPOCH 011/089] train: loss=0.5585 acc=63.77% | val: loss=0.6379 acc=69.35% f1=42.42% auc=68.45% val_score=85.0682 val_score_bestthr=89.5659 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.408, mb=0.332, no=1.004, corr=0.173) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 85.0682
[DBG][ep=012] disease_pos_weight=1.0000 mode=none
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.4050 mb_mean=0.3255 norm_overlap=1.0013 corr_cb=0.0641 topkJ=0.1284
[TRAIN][ep=012] loss=0.5525 acc=63.77%
[TRAIN][ep=012] mask_avg: mc_mean=0.3945 mb_mean=0.3108 norm_overlap=0.9987 corr_cb=-0.0424
[EPOCH 012/089] train: loss=0.5525 acc=63.77% | val: loss=0.6350 acc=69.35% f1=55.81% auc=68.12% val_score=89.8248 val_score_bestthr=96.4956 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.394, mb=0.311, no=0.999, corr=-0.042) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 89.8248
[DBG][ep=013] disease_pos_weight=1.0000 mode=none
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.3829 mb_mean=0.2945 norm_overlap=0.9994 corr_cb=-0.0134 topkJ=0.0524
[TRAIN][ep=013] loss=0.7811 acc=63.95%
[TRAIN][ep=013] mask_avg: mc_mean=0.3812 mb_mean=0.2941 norm_overlap=0.9871 corr_cb=-0.2624
[EPOCH 013/089] train: loss=0.7811 acc=63.95% | val: loss=0.6329 acc=70.97% f1=40.00% auc=68.34% val_score=84.2156 val_score_bestthr=89.9892 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.381, mb=0.294, no=0.987, corr=-0.262) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 84.2156
[DBG][ep=014] disease_pos_weight=1.0000 mode=none
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.3816 mb_mean=0.3005 norm_overlap=0.9822 corr_cb=-0.3542 topkJ=0.0168
[TRAIN][ep=014] loss=1.0095 acc=63.95%
[TRAIN][ep=014] mask_avg: mc_mean=0.3667 mb_mean=0.2816 norm_overlap=0.9660 corr_cb=-0.4447
[EPOCH 014/089] train: loss=1.0095 acc=63.95% | val: loss=0.6312 acc=70.97% f1=40.00% auc=68.12% val_score=82.9854 val_score_bestthr=89.9892 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.367, mb=0.282, no=0.966, corr=-0.445) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 82.9854
[DBG][ep=015] disease_pos_weight=1.0000 mode=none
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.3587 mb_mean=0.2843 norm_overlap=0.9549 corr_cb=-0.5180 topkJ=0.0016
[TRAIN][ep=015] loss=1.2387 acc=64.13%
[TRAIN][ep=015] mask_avg: mc_mean=0.3556 mb_mean=0.2763 norm_overlap=0.9430 corr_cb=-0.5725
[EPOCH 015/089] train: loss=1.2387 acc=64.13% | val: loss=0.6309 acc=69.35% f1=34.48% auc=67.67% val_score=80.9255 val_score_bestthr=85.6635 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.356, mb=0.276, no=0.943, corr=-0.573) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 80.9255
[DBG][ep=016] disease_pos_weight=1.0000 mode=none
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.3411 mb_mean=0.2897 norm_overlap=0.9308 corr_cb=-0.6467 topkJ=0.0000
[TRAIN][ep=016] loss=1.4555 acc=64.13%
[TRAIN][ep=016] mask_avg: mc_mean=0.3444 mb_mean=0.2763 norm_overlap=0.9258 corr_cb=-0.6173
[EPOCH 016/089] train: loss=1.4555 acc=64.13% | val: loss=0.6287 acc=70.97% f1=40.00% auc=67.34% val_score=82.2589 val_score_bestthr=89.9892 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.344, mb=0.276, no=0.926, corr=-0.617) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 82.2589
[DBG][ep=017] disease_pos_weight=1.0000 mode=none
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.3493 mb_mean=0.2842 norm_overlap=0.9180 corr_cb=-0.6849 topkJ=0.0000
[TRAIN][ep=017] loss=1.6827 acc=64.67%
[TRAIN][ep=017] mask_avg: mc_mean=0.3337 mb_mean=0.2763 norm_overlap=0.9083 corr_cb=-0.6467
[EPOCH 017/089] train: loss=1.6827 acc=64.67% | val: loss=0.6280 acc=70.97% f1=40.00% auc=66.33% val_score=88.7110 val_score_bestthr=89.9892 | dyn(w_pfs=0.100, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.334, mb=0.276, no=0.908, corr=-0.647) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 88.7110
[DBG][ep=018] disease_pos_weight=1.0000 mode=none
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.3298 mb_mean=0.2861 norm_overlap=0.9056 corr_cb=-0.6311 topkJ=0.0000
[TRAIN][ep=018] loss=1.0871 acc=65.22%
[TRAIN][ep=018] mask_avg: mc_mean=0.3248 mb_mean=0.2763 norm_overlap=0.8930 corr_cb=-0.6696
[EPOCH 018/089] train: loss=1.0871 acc=65.22% | val: loss=0.6233 acc=70.97% f1=40.00% auc=66.11% val_score=87.1131 val_score_bestthr=89.9892 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.325, mb=0.276, no=0.893, corr=-0.670) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 87.1131
[DBG][ep=019] disease_pos_weight=1.0000 mode=none
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.3171 mb_mean=0.2526 norm_overlap=0.8544 corr_cb=-0.6837 topkJ=0.0000
[TRAIN][ep=019] loss=0.4965 acc=65.94%
[TRAIN][ep=019] mask_avg: mc_mean=0.3155 mb_mean=0.2763 norm_overlap=0.8760 corr_cb=-0.6860
[EPOCH 019/089] train: loss=0.4965 acc=65.94% | val: loss=0.6186 acc=69.35% f1=38.71% auc=67.34% val_score=82.4593 val_score_bestthr=87.7370 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.316, mb=0.276, no=0.876, corr=-0.686) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 82.4593
[DBG][ep=020] disease_pos_weight=1.0000 mode=none
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.3183 mb_mean=0.2811 norm_overlap=0.8471 corr_cb=-0.7738 topkJ=0.0000
[TRAIN][ep=020] loss=0.4840 acc=72.28%
[TRAIN][ep=020] mask_avg: mc_mean=0.3080 mb_mean=0.2763 norm_overlap=0.8592 corr_cb=-0.7061
[EPOCH 020/089] train: loss=0.4840 acc=72.28% | val: loss=0.6174 acc=70.97% f1=40.00% auc=68.45% val_score=89.8380 val_score_bestthr=89.9892 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.308, mb=0.276, no=0.859, corr=-0.706) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 89.8380
[DBG][ep=021] disease_pos_weight=1.0000 mode=none
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.3029 mb_mean=0.2812 norm_overlap=0.8317 corr_cb=-0.7827 topkJ=0.0000
[TRAIN][ep=021] loss=0.4743 acc=68.66%
[TRAIN][ep=021] mask_avg: mc_mean=0.3006 mb_mean=0.2763 norm_overlap=0.8415 corr_cb=-0.7171
[EPOCH 021/089] train: loss=0.4743 acc=68.66% | val: loss=0.6103 acc=69.35% f1=34.48% auc=67.22% val_score=88.7228 val_score_bestthr=85.6635 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.301, mb=0.276, no=0.842, corr=-0.717) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 88.7228
[DBG][ep=022] disease_pos_weight=1.0000 mode=none
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2890 mb_mean=0.2836 norm_overlap=0.8460 corr_cb=-0.7722 topkJ=0.0000
[TRAIN][ep=022] loss=0.4657 acc=71.20%
[TRAIN][ep=022] mask_avg: mc_mean=0.2944 mb_mean=0.2763 norm_overlap=0.8256 corr_cb=-0.7262
[EPOCH 022/089] train: loss=0.4657 acc=71.20% | val: loss=0.6089 acc=69.35% f1=34.48% auc=67.22% val_score=85.8523 val_score_bestthr=85.6635 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.294, mb=0.276, no=0.826, corr=-0.726) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 85.8523
[DBG][ep=023] disease_pos_weight=1.0000 mode=none
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2926 mb_mean=0.2793 norm_overlap=0.8399 corr_cb=-0.7117 topkJ=0.0000
[TRAIN][ep=023] loss=0.4546 acc=72.64%
[TRAIN][ep=023] mask_avg: mc_mean=0.2903 mb_mean=0.2763 norm_overlap=0.8123 corr_cb=-0.7353
[EPOCH 023/089] train: loss=0.4546 acc=72.64% | val: loss=0.6064 acc=69.35% f1=34.48% auc=67.78% val_score=84.0786 val_score_bestthr=85.6635 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.290, mb=0.276, no=0.812, corr=-0.735) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 84.0786
[DBG][ep=024] disease_pos_weight=1.0000 mode=none
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2992 mb_mean=0.2811 norm_overlap=0.8222 corr_cb=-0.7314 topkJ=0.0000
[TRAIN][ep=024] loss=0.4452 acc=73.73%
[TRAIN][ep=024] mask_avg: mc_mean=0.2858 mb_mean=0.2764 norm_overlap=0.7977 corr_cb=-0.7415
[EPOCH 024/089] train: loss=0.4452 acc=73.73% | val: loss=0.6091 acc=67.74% f1=37.50% auc=67.11% val_score=85.5066 val_score_bestthr=85.5091 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.286, mb=0.276, no=0.798, corr=-0.742) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 85.5066
[DBG][ep=025] disease_pos_weight=1.0000 mode=none
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2645 mb_mean=0.2703 norm_overlap=0.8415 corr_cb=-0.6047 topkJ=0.0000
[TRAIN][ep=025] loss=0.4345 acc=74.46%
[TRAIN][ep=025] mask_avg: mc_mean=0.2822 mb_mean=0.2764 norm_overlap=0.7848 corr_cb=-0.7475
[EPOCH 025/089] train: loss=0.4345 acc=74.46% | val: loss=0.6174 acc=67.74% f1=41.18% auc=66.56% val_score=83.7279 val_score_bestthr=87.3634 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.282, mb=0.276, no=0.785, corr=-0.748) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 83.7279
[DBG][ep=026] disease_pos_weight=1.0000 mode=none
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2719 mb_mean=0.2822 norm_overlap=0.7609 corr_cb=-0.8300 topkJ=0.0000
[TRAIN][ep=026] loss=0.4268 acc=76.45%
[TRAIN][ep=026] mask_avg: mc_mean=0.2792 mb_mean=0.2763 norm_overlap=0.7728 corr_cb=-0.7562
[EPOCH 026/089] train: loss=0.4268 acc=76.45% | val: loss=0.6127 acc=69.35% f1=38.71% auc=66.44% val_score=86.4037 val_score_bestthr=87.7370 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.279, mb=0.276, no=0.773, corr=-0.756) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 86.4037
[DBG][ep=027] disease_pos_weight=1.0000 mode=none
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2469 mb_mean=0.2709 norm_overlap=0.8062 corr_cb=-0.6459 topkJ=0.0000
[TRAIN][ep=027] loss=0.4197 acc=75.72%
[TRAIN][ep=027] mask_avg: mc_mean=0.2764 mb_mean=0.2763 norm_overlap=0.7614 corr_cb=-0.7600
[EPOCH 027/089] train: loss=0.4197 acc=75.72% | val: loss=0.6261 acc=67.74% f1=41.18% auc=65.89% val_score=81.6832 val_score_bestthr=87.3634 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.276, mb=0.276, no=0.761, corr=-0.760) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 81.6832
[DBG][ep=028] disease_pos_weight=1.0000 mode=none
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2663 mb_mean=0.2843 norm_overlap=0.7717 corr_cb=-0.7883 topkJ=0.0000
[TRAIN][ep=028] loss=0.4081 acc=77.90%
[TRAIN][ep=028] mask_avg: mc_mean=0.2735 mb_mean=0.2763 norm_overlap=0.7508 corr_cb=-0.7653
[EPOCH 028/089] train: loss=0.4081 acc=77.90% | val: loss=0.6258 acc=69.35% f1=38.71% auc=65.11% val_score=81.2832 val_score_bestthr=87.7370 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.273, mb=0.276, no=0.751, corr=-0.765) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 81.2832
[DBG][ep=029] disease_pos_weight=1.0000 mode=none
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2802 mb_mean=0.2723 norm_overlap=0.7715 corr_cb=-0.7059 topkJ=0.0000
[TRAIN][ep=029] loss=0.3986 acc=80.07%
[TRAIN][ep=029] mask_avg: mc_mean=0.2706 mb_mean=0.2763 norm_overlap=0.7415 corr_cb=-0.7687
[EPOCH 029/089] train: loss=0.3986 acc=80.07% | val: loss=0.6389 acc=70.97% f1=40.00% auc=64.88% val_score=86.6907 val_score_bestthr=89.9892 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.271, mb=0.276, no=0.741, corr=-0.769) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 86.6907
[DBG][ep=030] disease_pos_weight=1.0000 mode=none
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2589 mb_mean=0.2870 norm_overlap=0.7700 corr_cb=-0.7449 topkJ=0.0000
[TRAIN][ep=030] loss=0.3923 acc=78.26%
[TRAIN][ep=030] mask_avg: mc_mean=0.2678 mb_mean=0.2763 norm_overlap=0.7320 corr_cb=-0.7700
[EPOCH 030/089] train: loss=0.3923 acc=78.26% | val: loss=0.6427 acc=69.35% f1=42.42% auc=64.44% val_score=87.8098 val_score_bestthr=89.6835 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.268, mb=0.276, no=0.732, corr=-0.770) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 87.8098
[DBG][ep=031] disease_pos_weight=1.0000 mode=none
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2506 mb_mean=0.2711 norm_overlap=0.7191 corr_cb=-0.7419 topkJ=0.0000
[TRAIN][ep=031] loss=0.3798 acc=78.80%
[TRAIN][ep=031] mask_avg: mc_mean=0.2668 mb_mean=0.2763 norm_overlap=0.7276 corr_cb=-0.7697
[EPOCH 031/089] train: loss=0.3798 acc=78.80% | val: loss=0.6371 acc=70.97% f1=43.75% auc=63.99% val_score=84.2453 val_score_bestthr=91.9375 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.267, mb=0.276, no=0.728, corr=-0.770) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 84.2453
[DBG][ep=032] disease_pos_weight=1.0000 mode=none
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2880 mb_mean=0.2668 norm_overlap=0.6356 corr_cb=-0.8432 topkJ=0.0000
[TRAIN][ep=032] loss=0.3754 acc=80.25%
[TRAIN][ep=032] mask_avg: mc_mean=0.2668 mb_mean=0.2764 norm_overlap=0.7279 corr_cb=-0.7713
[EPOCH 032/089] train: loss=0.3754 acc=80.25% | val: loss=0.6378 acc=70.97% f1=43.75% auc=64.33% val_score=86.4757 val_score_bestthr=91.9375 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.267, mb=0.276, no=0.728, corr=-0.771) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 86.4757
[DBG][ep=033] disease_pos_weight=1.0000 mode=none
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2589 mb_mean=0.2896 norm_overlap=0.7729 corr_cb=-0.7554 topkJ=0.0000
[TRAIN][ep=033] loss=0.3742 acc=80.62%
[TRAIN][ep=033] mask_avg: mc_mean=0.2668 mb_mean=0.2763 norm_overlap=0.7273 corr_cb=-0.7728
[EPOCH 033/089] train: loss=0.3742 acc=80.62% | val: loss=0.6391 acc=70.97% f1=43.75% auc=64.21% val_score=86.4757 val_score_bestthr=91.9375 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.267, mb=0.276, no=0.727, corr=-0.773) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 86.4757
[DBG][ep=034] disease_pos_weight=1.0000 mode=none
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2600 mb_mean=0.2900 norm_overlap=0.7770 corr_cb=-0.7280 topkJ=0.0000
[TRAIN][ep=034] loss=0.3714 acc=80.62%
[TRAIN][ep=034] mask_avg: mc_mean=0.2668 mb_mean=0.2764 norm_overlap=0.7279 corr_cb=-0.7704
[EPOCH 034/089] train: loss=0.3714 acc=80.62% | val: loss=0.6411 acc=70.97% f1=43.75% auc=64.10% val_score=84.2453 val_score_bestthr=91.9375 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.267, mb=0.276, no=0.728, corr=-0.770) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 84.2453
[DBG][ep=035] disease_pos_weight=1.0000 mode=none
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2687 mb_mean=0.2643 norm_overlap=0.6828 corr_cb=-0.7757 topkJ=0.0000
[TRAIN][ep=035] loss=0.3699 acc=81.16%
[TRAIN][ep=035] mask_avg: mc_mean=0.2668 mb_mean=0.2763 norm_overlap=0.7274 corr_cb=-0.7717
[EPOCH 035/089] train: loss=0.3699 acc=81.16% | val: loss=0.6408 acc=70.97% f1=43.75% auc=64.33% val_score=86.4757 val_score_bestthr=91.9375 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.267, mb=0.276, no=0.727, corr=-0.772) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 86.4757
[EARLY STOP] no improvement for 30 epochs. best_epoch=5
[CKPT] Loaded best for testing: results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
=============== FIT DONE ===============
[BEST] epoch=5 | val_acc=69.35% | val_f1=42.42% | val_auc=66.89% | val_score=92.7790 | val_score_bestthr=89.2722
[TEST@BEST] thr_used=0.370 | acc=64.05% f1=15.38% auc=57.79% | SP_sex=1.45% EO_sex=8.41% SP_age=8.77% EO_age=14.12%
[TIME] 0.67 min
[OK] Saved: results/ADHD_3x5fold_seed0/fold2_rep0_seed2/summary_fold_2.json
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4784 mb_mean=0.5063 norm_overlap=0.9999 corr_cb=-0.0928 topkJ=0.0294
[TRAIN][ep=000] loss=0.6710 acc=63.77%
[TRAIN][ep=000] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0078
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4808 mb_mean=0.5078 norm_overlap=0.9999 corr_cb=-0.1127 topkJ=0.0310
[TRAIN][ep=001] loss=0.6646 acc=63.77%
[TRAIN][ep=001] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0102
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4792 mb_mean=0.5067 norm_overlap=1.0000 corr_cb=0.0224 topkJ=0.0484
[TRAIN][ep=002] loss=0.6608 acc=63.77%
[TRAIN][ep=002] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0054
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4787 mb_mean=0.5076 norm_overlap=0.9997 corr_cb=-0.3063 topkJ=0.0248
[TRAIN][ep=003] loss=0.6578 acc=63.77%
[TRAIN][ep=003] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0074
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4810 mb_mean=0.5098 norm_overlap=1.0000 corr_cb=0.0354 topkJ=0.0553
[TRAIN][ep=004] loss=0.6568 acc=63.77%
[TRAIN][ep=004] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0056
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4798 mb_mean=0.5070 norm_overlap=1.0000 corr_cb=-0.0288 topkJ=0.0211
[TRAIN][ep=005] loss=0.6552 acc=63.77%
[TRAIN][ep=005] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0076
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4802 mb_mean=0.5083 norm_overlap=1.0001 corr_cb=0.0978 topkJ=0.0511
[TRAIN][ep=006] loss=0.6542 acc=63.77%
[TRAIN][ep=006] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0103
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4799 mb_mean=0.5072 norm_overlap=1.0000 corr_cb=-0.0156 topkJ=0.0413
[TRAIN][ep=007] loss=0.6530 acc=63.77%
[TRAIN][ep=007] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0058
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4788 mb_mean=0.5063 norm_overlap=0.9999 corr_cb=-0.1226 topkJ=0.0341
[TRAIN][ep=008] loss=0.6521 acc=63.77%
[TRAIN][ep=008] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0077
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4796 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=0.0434 topkJ=0.0713
[TRAIN][ep=009] loss=0.6503 acc=63.77%
[TRAIN][ep=009] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0082
================= FIT START (fold=2) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.35 select_by=val_score | eval_thr_mode=best_acc eval_thr_grid=coarse | disease_pos_weight_mode=none freeze_b_after=15 | two_stage=True stage1_ratio=0.35 stage2_lr_mult=0.3 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4807 mb_mean=0.5078 norm_overlap=1.0000 corr_cb=0.0284 topkJ=0.0655
[TRAIN][ep=000] loss=0.6497 acc=63.77%
[TRAIN][ep=000] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0057
[EPOCH 000/089] train: loss=0.6497 acc=63.77% | val: loss=0.6514 acc=69.35% f1=34.48% auc=66.22% val_score=69.0522 val_score_bestthr=85.2797 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.480, mb=0.508, no=1.000, corr=-0.006) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* -1000000000000000000.0000 -> 69.0522
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4809 mb_mean=0.5072 norm_overlap=1.0001 corr_cb=0.1026 topkJ=0.1054
[TRAIN][ep=001] loss=0.6477 acc=63.77%
[TRAIN][ep=001] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0084
[EPOCH 001/089] train: loss=0.6477 acc=63.77% | val: loss=0.6505 acc=70.97% f1=47.06% auc=66.56% val_score=65.7902 val_score_bestthr=93.2489 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.480, mb=0.508, no=1.000, corr=-0.008) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 69.0522 -> 65.7902
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4802 mb_mean=0.5075 norm_overlap=1.0000 corr_cb=0.0222 topkJ=0.0557
[TRAIN][ep=002] loss=0.6468 acc=63.77%
[TRAIN][ep=002] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0048
[EPOCH 002/089] train: loss=0.6468 acc=63.77% | val: loss=0.6494 acc=70.97% f1=50.00% auc=66.00% val_score=69.8259 val_score_bestthr=95.0010 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.480, mb=0.508, no=1.000, corr=-0.005) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 69.0522 -> 69.8259
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4773 mb_mean=0.5082 norm_overlap=1.0001 corr_cb=0.1498 topkJ=0.1079
[TRAIN][ep=003] loss=0.6447 acc=63.77%
[TRAIN][ep=003] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0071
[EPOCH 003/089] train: loss=0.6447 acc=63.77% | val: loss=0.6483 acc=69.35% f1=42.42% auc=67.22% val_score=71.7551 val_score_bestthr=89.5496 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.480, mb=0.508, no=1.000, corr=-0.007) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 69.8259 -> 71.7551
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4801 mb_mean=0.5075 norm_overlap=0.9999 corr_cb=-0.1147 topkJ=0.0525
[TRAIN][ep=004] loss=0.6429 acc=63.77%
[TRAIN][ep=004] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0086
[EPOCH 004/089] train: loss=0.6429 acc=63.77% | val: loss=0.6467 acc=72.58% f1=45.16% auc=67.45% val_score=77.0365 val_score_bestthr=94.1547 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.480, mb=0.508, no=1.000, corr=-0.009) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 71.7551 -> 77.0365
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4786 mb_mean=0.5078 norm_overlap=1.0001 corr_cb=0.1409 topkJ=0.1263
[TRAIN][ep=005] loss=2.1424 acc=63.77%
[TRAIN][ep=005] mask_avg: mc_mean=0.4764 mb_mean=0.5011 norm_overlap=1.0002 corr_cb=0.1719
[EPOCH 005/089] train: loss=2.1424 acc=63.77% | val: loss=0.6491 acc=69.35% f1=42.42% auc=67.00% val_score=92.7790 val_score_bestthr=89.2722 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.476, mb=0.501, no=1.000, corr=0.172) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 77.0365 -> 92.7790
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4708 mb_mean=0.4925 norm_overlap=1.0009 corr_cb=0.5513 topkJ=0.1507
[TRAIN][ep=006] loss=2.1282 acc=63.77%
[TRAIN][ep=006] mask_avg: mc_mean=0.4672 mb_mean=0.4840 norm_overlap=1.0006 corr_cb=0.3538
[EPOCH 006/089] train: loss=2.1282 acc=63.77% | val: loss=0.6479 acc=69.35% f1=51.28% auc=67.11% val_score=84.6113 val_score_bestthr=93.7937 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.467, mb=0.484, no=1.001, corr=0.354) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 84.6113
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4623 mb_mean=0.4746 norm_overlap=1.0006 corr_cb=0.3345 topkJ=0.1247
[TRAIN][ep=007] loss=2.1205 acc=63.77%
[TRAIN][ep=007] mask_avg: mc_mean=0.4563 mb_mean=0.4638 norm_overlap=1.0013 corr_cb=0.4310
[EPOCH 007/089] train: loss=2.1205 acc=63.77% | val: loss=0.6464 acc=72.58% f1=51.43% auc=67.56% val_score=87.1176 val_score_bestthr=97.2806 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.456, mb=0.464, no=1.001, corr=0.431) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 87.1176
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4504 mb_mean=0.4552 norm_overlap=1.0012 corr_cb=0.3887 topkJ=0.1141
[TRAIN][ep=008] loss=2.1107 acc=63.77%
[TRAIN][ep=008] mask_avg: mc_mean=0.4450 mb_mean=0.4407 norm_overlap=1.0023 corr_cb=0.4704
[EPOCH 008/089] train: loss=2.1107 acc=63.77% | val: loss=0.6449 acc=70.97% f1=50.00% auc=67.56% val_score=81.4369 val_score_bestthr=95.0010 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.445, mb=0.441, no=1.002, corr=0.470) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 81.4369
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4377 mb_mean=0.4232 norm_overlap=1.0024 corr_cb=0.4506 topkJ=0.1703
[TRAIN][ep=009] loss=2.1032 acc=63.77%
[TRAIN][ep=009] mask_avg: mc_mean=0.4336 mb_mean=0.4159 norm_overlap=1.0038 corr_cb=0.4765
[EPOCH 009/089] train: loss=2.1032 acc=63.77% | val: loss=0.6444 acc=69.35% f1=48.65% auc=66.78% val_score=81.4369 val_score_bestthr=92.7479 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.434, mb=0.416, no=1.004, corr=0.476) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 81.4369
[DBG][ep=010] disease_pos_weight=1.0000 mode=none
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.4294 mb_mean=0.3996 norm_overlap=1.0052 corr_cb=0.5563 topkJ=0.1932
[TRAIN][ep=010] loss=2.0952 acc=63.77%
[TRAIN][ep=010] mask_avg: mc_mean=0.4230 mb_mean=0.3910 norm_overlap=1.0048 corr_cb=0.4266
[EPOCH 010/089] train: loss=2.0952 acc=63.77% | val: loss=0.6422 acc=70.97% f1=55.00% auc=68.45% val_score=82.2222 val_score_bestthr=97.6346 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.423, mb=0.391, no=1.005, corr=0.427) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 82.2222
[DBG][ep=011] disease_pos_weight=1.0000 mode=none
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.4190 mb_mean=0.3797 norm_overlap=1.0045 corr_cb=0.3550 topkJ=0.1203
[TRAIN][ep=011] loss=2.0896 acc=63.77%
[TRAIN][ep=011] mask_avg: mc_mean=0.4130 mb_mean=0.3675 norm_overlap=1.0055 corr_cb=0.3408
[EPOCH 011/089] train: loss=2.0896 acc=63.77% | val: loss=0.6419 acc=69.35% f1=51.28% auc=67.78% val_score=79.4298 val_score_bestthr=93.9204 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.413, mb=0.367, no=1.005, corr=0.341) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 79.4298
[DBG][ep=012] disease_pos_weight=1.0000 mode=none
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.4121 mb_mean=0.3608 norm_overlap=1.0043 corr_cb=0.2600 topkJ=0.1720
[TRAIN][ep=012] loss=2.0834 acc=63.77%
[TRAIN][ep=012] mask_avg: mc_mean=0.4039 mb_mean=0.3460 norm_overlap=1.0046 corr_cb=0.2102
[EPOCH 012/089] train: loss=2.0834 acc=63.77% | val: loss=0.6410 acc=67.74% f1=47.37% auc=66.89% val_score=84.2613 val_score_bestthr=90.5076 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.404, mb=0.346, no=1.005, corr=0.210) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 84.2613
[DBG][ep=013] disease_pos_weight=1.0000 mode=none
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.3947 mb_mean=0.3300 norm_overlap=1.0063 corr_cb=0.2120 topkJ=0.0786
[TRAIN][ep=013] loss=2.0671 acc=63.77%
[TRAIN][ep=013] mask_avg: mc_mean=0.3947 mb_mean=0.3265 norm_overlap=1.0023 corr_cb=0.0742
[EPOCH 013/089] train: loss=2.0671 acc=63.77% | val: loss=0.6382 acc=67.74% f1=54.55% auc=66.67% val_score=80.6761 val_score_bestthr=94.2565 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.395, mb=0.326, no=1.002, corr=0.074) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 80.6761
[DBG][ep=014] disease_pos_weight=1.0000 mode=none
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.3974 mb_mean=0.3293 norm_overlap=1.0014 corr_cb=0.0581 topkJ=0.0963
[TRAIN][ep=014] loss=2.0650 acc=63.77%
[TRAIN][ep=014] mask_avg: mc_mean=0.3856 mb_mean=0.3102 norm_overlap=0.9986 corr_cb=-0.0474
[EPOCH 014/089] train: loss=2.0650 acc=63.77% | val: loss=0.6355 acc=69.35% f1=34.48% auc=67.56% val_score=73.9774 val_score_bestthr=85.5296 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.386, mb=0.310, no=0.999, corr=-0.047) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 73.9774
[DBG][ep=015] disease_pos_weight=1.0000 mode=none
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.3813 mb_mean=0.3091 norm_overlap=0.9968 corr_cb=-0.0850 topkJ=0.0419
[TRAIN][ep=015] loss=2.0622 acc=63.77%
[TRAIN][ep=015] mask_avg: mc_mean=0.3789 mb_mean=0.3031 norm_overlap=0.9956 corr_cb=-0.1171
[EPOCH 015/089] train: loss=2.0622 acc=63.77% | val: loss=0.6348 acc=67.74% f1=52.38% auc=67.11% val_score=80.6087 val_score_bestthr=93.2743 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.379, mb=0.303, no=0.996, corr=-0.117) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 80.6087
[DBG][ep=016] disease_pos_weight=1.0000 mode=none
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.3698 mb_mean=0.3112 norm_overlap=0.9927 corr_cb=-0.1692 topkJ=0.0463
[TRAIN][ep=016] loss=1.3691 acc=63.77%
[TRAIN][ep=016] mask_avg: mc_mean=0.3714 mb_mean=0.3031 norm_overlap=0.9919 corr_cb=-0.1870
[EPOCH 016/089] train: loss=1.3691 acc=63.77% | val: loss=0.6327 acc=67.74% f1=56.52% auc=67.34% val_score=77.2512 val_score_bestthr=95.2459 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.371, mb=0.303, no=0.992, corr=-0.187) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 77.2512
[DBG][ep=017] disease_pos_weight=1.0000 mode=none
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.3766 mb_mean=0.3113 norm_overlap=0.9871 corr_cb=-0.3145 topkJ=0.0298
[TRAIN][ep=017] loss=0.6871 acc=63.95%
[TRAIN][ep=017] mask_avg: mc_mean=0.3649 mb_mean=0.3031 norm_overlap=0.9878 corr_cb=-0.2508
[EPOCH 017/089] train: loss=0.6871 acc=63.95% | val: loss=0.6294 acc=69.35% f1=51.28% auc=68.00% val_score=82.3309 val_score_bestthr=94.2955 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.365, mb=0.303, no=0.988, corr=-0.251) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 82.3309
[DBG][ep=018] disease_pos_weight=1.0000 mode=none
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.3642 mb_mean=0.3121 norm_overlap=0.9862 corr_cb=-0.2691 topkJ=0.0166
[TRAIN][ep=018] loss=0.5266 acc=64.31%
[TRAIN][ep=018] mask_avg: mc_mean=0.3579 mb_mean=0.3031 norm_overlap=0.9833 corr_cb=-0.3080
[EPOCH 018/089] train: loss=0.5266 acc=64.31% | val: loss=0.6258 acc=69.35% f1=38.71% auc=68.00% val_score=80.1987 val_score_bestthr=87.7578 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.358, mb=0.303, no=0.983, corr=-0.308) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 80.1987
[DBG][ep=019] disease_pos_weight=1.0000 mode=none
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.3477 mb_mean=0.2836 norm_overlap=0.9720 corr_cb=-0.3759 topkJ=0.0109
[TRAIN][ep=019] loss=0.5143 acc=65.22%
[TRAIN][ep=019] mask_avg: mc_mean=0.3499 mb_mean=0.3031 norm_overlap=0.9780 corr_cb=-0.3538
[EPOCH 019/089] train: loss=0.5143 acc=65.22% | val: loss=0.6219 acc=69.35% f1=34.48% auc=67.34% val_score=82.4688 val_score_bestthr=85.6635 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.350, mb=0.303, no=0.978, corr=-0.354) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 82.4688
[DBG][ep=020] disease_pos_weight=1.0000 mode=none
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.3488 mb_mean=0.3074 norm_overlap=0.9646 corr_cb=-0.4856 topkJ=0.0090
[TRAIN][ep=020] loss=0.5042 acc=69.57%
[TRAIN][ep=020] mask_avg: mc_mean=0.3425 mb_mean=0.3031 norm_overlap=0.9726 corr_cb=-0.3974
[EPOCH 020/089] train: loss=0.5042 acc=69.57% | val: loss=0.6195 acc=69.35% f1=42.42% auc=68.00% val_score=87.6758 val_score_bestthr=89.5871 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.342, mb=0.303, no=0.973, corr=-0.397) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 87.6758
[DBG][ep=021] disease_pos_weight=1.0000 mode=none
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.3385 mb_mean=0.3064 norm_overlap=0.9632 corr_cb=-0.5078 topkJ=0.0115
[TRAIN][ep=021] loss=0.4950 acc=67.03%
[TRAIN][ep=021] mask_avg: mc_mean=0.3333 mb_mean=0.3031 norm_overlap=0.9659 corr_cb=-0.4282
[EPOCH 021/089] train: loss=0.4950 acc=67.03% | val: loss=0.6143 acc=69.35% f1=34.48% auc=68.12% val_score=86.5843 val_score_bestthr=85.6635 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.333, mb=0.303, no=0.966, corr=-0.428) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 86.5843
[DBG][ep=022] disease_pos_weight=1.0000 mode=none
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.3244 mb_mean=0.3103 norm_overlap=0.9630 corr_cb=-0.5216 topkJ=0.0061
[TRAIN][ep=022] loss=0.4868 acc=70.65%
[TRAIN][ep=022] mask_avg: mc_mean=0.3249 mb_mean=0.3031 norm_overlap=0.9598 corr_cb=-0.4521
[EPOCH 022/089] train: loss=0.4868 acc=70.65% | val: loss=0.6107 acc=69.35% f1=34.48% auc=67.89% val_score=88.7228 val_score_bestthr=85.6635 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.325, mb=0.303, no=0.960, corr=-0.452) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 88.7228
[DBG][ep=023] disease_pos_weight=1.0000 mode=none
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.3236 mb_mean=0.3066 norm_overlap=0.9604 corr_cb=-0.4523 topkJ=0.0032
[TRAIN][ep=023] loss=0.4747 acc=72.28%
[TRAIN][ep=023] mask_avg: mc_mean=0.3180 mb_mean=0.3031 norm_overlap=0.9541 corr_cb=-0.4743
[EPOCH 023/089] train: loss=0.4747 acc=72.28% | val: loss=0.6078 acc=69.35% f1=34.48% auc=68.12% val_score=86.1537 val_score_bestthr=85.6635 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.318, mb=0.303, no=0.954, corr=-0.474) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 86.1537
[DBG][ep=024] disease_pos_weight=1.0000 mode=none
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.3214 mb_mean=0.3074 norm_overlap=0.9587 corr_cb=-0.4197 topkJ=0.0061
[TRAIN][ep=024] loss=0.4647 acc=73.55%
[TRAIN][ep=024] mask_avg: mc_mean=0.3100 mb_mean=0.3031 norm_overlap=0.9476 corr_cb=-0.4885
[EPOCH 024/089] train: loss=0.4647 acc=73.55% | val: loss=0.6092 acc=69.35% f1=34.48% auc=67.89% val_score=85.5066 val_score_bestthr=85.6635 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.310, mb=0.303, no=0.948, corr=-0.488) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 85.5066
[DBG][ep=025] disease_pos_weight=1.0000 mode=none
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2937 mb_mean=0.2997 norm_overlap=0.9652 corr_cb=-0.3270 topkJ=0.0081
[TRAIN][ep=025] loss=0.4540 acc=74.28%
[TRAIN][ep=025] mask_avg: mc_mean=0.3036 mb_mean=0.3031 norm_overlap=0.9416 corr_cb=-0.5049
[EPOCH 025/089] train: loss=0.4540 acc=74.28% | val: loss=0.6146 acc=67.74% f1=33.33% auc=67.34% val_score=83.7279 val_score_bestthr=83.4091 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.304, mb=0.303, no=0.942, corr=-0.505) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 83.7279
[DBG][ep=026] disease_pos_weight=1.0000 mode=none
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2966 mb_mean=0.3104 norm_overlap=0.9355 corr_cb=-0.6216 topkJ=0.0004
[TRAIN][ep=026] loss=0.4454 acc=76.09%
[TRAIN][ep=026] mask_avg: mc_mean=0.2986 mb_mean=0.3031 norm_overlap=0.9361 corr_cb=-0.5246
[EPOCH 026/089] train: loss=0.4454 acc=76.09% | val: loss=0.6107 acc=69.35% f1=34.48% auc=67.45% val_score=84.2453 val_score_bestthr=85.6635 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.299, mb=0.303, no=0.936, corr=-0.525) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 84.2453
[DBG][ep=027] disease_pos_weight=1.0000 mode=none
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2753 mb_mean=0.2991 norm_overlap=0.9494 corr_cb=-0.3963 topkJ=0.0036
[TRAIN][ep=027] loss=0.4384 acc=76.45%
[TRAIN][ep=027] mask_avg: mc_mean=0.2932 mb_mean=0.3031 norm_overlap=0.9304 corr_cb=-0.5344
[EPOCH 027/089] train: loss=0.4384 acc=76.45% | val: loss=0.6239 acc=67.74% f1=33.33% auc=67.11% val_score=79.5589 val_score_bestthr=83.4091 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.293, mb=0.303, no=0.930, corr=-0.534) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 79.5589
[DBG][ep=028] disease_pos_weight=1.0000 mode=none
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2886 mb_mean=0.3114 norm_overlap=0.9360 corr_cb=-0.5805 topkJ=0.0008
[TRAIN][ep=028] loss=0.4264 acc=77.90%
[TRAIN][ep=028] mask_avg: mc_mean=0.2887 mb_mean=0.3031 norm_overlap=0.9254 corr_cb=-0.5490
[EPOCH 028/089] train: loss=0.4264 acc=77.90% | val: loss=0.6230 acc=67.74% f1=37.50% auc=65.22% val_score=81.2832 val_score_bestthr=85.5091 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.289, mb=0.303, no=0.925, corr=-0.549) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 81.2832
[DBG][ep=029] disease_pos_weight=1.0000 mode=none
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2929 mb_mean=0.3018 norm_overlap=0.9306 corr_cb=-0.5020 topkJ=0.0008
[TRAIN][ep=029] loss=0.4170 acc=79.35%
[TRAIN][ep=029] mask_avg: mc_mean=0.2851 mb_mean=0.3031 norm_overlap=0.9205 corr_cb=-0.5624
[EPOCH 029/089] train: loss=0.4170 acc=79.35% | val: loss=0.6341 acc=70.97% f1=40.00% auc=65.22% val_score=84.6333 val_score_bestthr=89.9892 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.285, mb=0.303, no=0.921, corr=-0.562) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 84.6333
[DBG][ep=030] disease_pos_weight=1.0000 mode=none
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2813 mb_mean=0.3130 norm_overlap=0.9264 corr_cb=-0.5766 topkJ=0.0004
[TRAIN][ep=030] loss=0.4099 acc=77.90%
[TRAIN][ep=030] mask_avg: mc_mean=0.2811 mb_mean=0.3031 norm_overlap=0.9158 corr_cb=-0.5693
[EPOCH 030/089] train: loss=0.4099 acc=77.90% | val: loss=0.6399 acc=69.35% f1=45.71% auc=64.99% val_score=82.5174 val_score_bestthr=91.6264 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.281, mb=0.303, no=0.916, corr=-0.569) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 82.5174
[DBG][ep=031] disease_pos_weight=1.0000 mode=none
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2688 mb_mean=0.2960 norm_overlap=0.9116 corr_cb=-0.5451 topkJ=0.0004
[TRAIN][ep=031] loss=0.3975 acc=77.90%
[TRAIN][ep=031] mask_avg: mc_mean=0.2793 mb_mean=0.3031 norm_overlap=0.9132 corr_cb=-0.5684
[EPOCH 031/089] train: loss=0.3975 acc=77.90% | val: loss=0.6347 acc=69.35% f1=42.42% auc=64.77% val_score=87.0667 val_score_bestthr=89.6835 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.279, mb=0.303, no=0.913, corr=-0.568) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 87.0667
[DBG][ep=032] disease_pos_weight=1.0000 mode=none
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2893 mb_mean=0.2922 norm_overlap=0.8639 corr_cb=-0.6851 topkJ=0.0000
[TRAIN][ep=032] loss=0.3929 acc=79.53%
[TRAIN][ep=032] mask_avg: mc_mean=0.2793 mb_mean=0.3031 norm_overlap=0.9133 corr_cb=-0.5714
[EPOCH 032/089] train: loss=0.3929 acc=79.53% | val: loss=0.6354 acc=69.35% f1=42.42% auc=64.66% val_score=86.4757 val_score_bestthr=89.6835 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.279, mb=0.303, no=0.913, corr=-0.571) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 86.4757
[DBG][ep=033] disease_pos_weight=1.0000 mode=none
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2800 mb_mean=0.3138 norm_overlap=0.9397 corr_cb=-0.5034 topkJ=0.0013
[TRAIN][ep=033] loss=0.3916 acc=80.43%
[TRAIN][ep=033] mask_avg: mc_mean=0.2792 mb_mean=0.3031 norm_overlap=0.9133 corr_cb=-0.5733
[EPOCH 033/089] train: loss=0.3916 acc=80.43% | val: loss=0.6369 acc=67.74% f1=41.18% auc=64.88% val_score=86.4757 val_score_bestthr=87.4711 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.279, mb=0.303, no=0.913, corr=-0.573) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 86.4757
[DBG][ep=034] disease_pos_weight=1.0000 mode=none
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2779 mb_mean=0.3134 norm_overlap=0.9324 corr_cb=-0.4798 topkJ=0.0012
[TRAIN][ep=034] loss=0.3888 acc=80.07%
[TRAIN][ep=034] mask_avg: mc_mean=0.2792 mb_mean=0.3031 norm_overlap=0.9132 corr_cb=-0.5716
[EPOCH 034/089] train: loss=0.3888 acc=80.07% | val: loss=0.6391 acc=69.35% f1=42.42% auc=65.11% val_score=87.0667 val_score_bestthr=89.6835 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.279, mb=0.303, no=0.913, corr=-0.572) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 87.0667
[DBG][ep=035] disease_pos_weight=1.0000 mode=none
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2756 mb_mean=0.2913 norm_overlap=0.9058 corr_cb=-0.5449 topkJ=0.0000
[TRAIN][ep=035] loss=0.3872 acc=80.62%
[TRAIN][ep=035] mask_avg: mc_mean=0.2793 mb_mean=0.3031 norm_overlap=0.9132 corr_cb=-0.5730
[EPOCH 035/089] train: loss=0.3872 acc=80.62% | val: loss=0.6387 acc=69.35% f1=42.42% auc=64.88% val_score=86.4757 val_score_bestthr=89.6835 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.279, mb=0.303, no=0.913, corr=-0.573) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 86.4757
[EARLY STOP] no improvement for 30 epochs. best_epoch=5
[CKPT] Loaded best for testing: results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
=============== FIT DONE ===============
[BEST] epoch=5 | val_acc=69.35% | val_f1=42.42% | val_auc=67.00% | val_score=92.7790 | val_score_bestthr=89.2722
[TEST@BEST] thr_used=0.370 | acc=63.40% f1=12.50% auc=57.75% | SP_sex=0.38% EO_sex=10.73% SP_age=8.77% EO_age=4.12%
[TIME] 0.68 min
[OK] Saved: results/ADHD_3x5fold_seed0/fold2_rep0_seed2/summary_fold_2.json
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4784 mb_mean=0.5063 norm_overlap=0.9999 corr_cb=-0.0928 topkJ=0.0294
[TRAIN][ep=000] loss=0.6710 acc=63.77%
[TRAIN][ep=000] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0078
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4808 mb_mean=0.5078 norm_overlap=0.9999 corr_cb=-0.1127 topkJ=0.0310
[TRAIN][ep=001] loss=0.6646 acc=63.77%
[TRAIN][ep=001] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0102
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4792 mb_mean=0.5067 norm_overlap=1.0000 corr_cb=0.0224 topkJ=0.0484
[TRAIN][ep=002] loss=0.6608 acc=63.77%
[TRAIN][ep=002] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0054
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4787 mb_mean=0.5076 norm_overlap=0.9997 corr_cb=-0.3063 topkJ=0.0248
[TRAIN][ep=003] loss=0.6578 acc=63.77%
[TRAIN][ep=003] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0074
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4810 mb_mean=0.5098 norm_overlap=1.0000 corr_cb=0.0354 topkJ=0.0553
[TRAIN][ep=004] loss=0.6568 acc=63.77%
[TRAIN][ep=004] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0056
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4798 mb_mean=0.5070 norm_overlap=1.0000 corr_cb=-0.0288 topkJ=0.0211
[TRAIN][ep=005] loss=0.6552 acc=63.77%
[TRAIN][ep=005] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0076
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4802 mb_mean=0.5083 norm_overlap=1.0001 corr_cb=0.0978 topkJ=0.0511
[TRAIN][ep=006] loss=0.6542 acc=63.77%
[TRAIN][ep=006] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0103
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4799 mb_mean=0.5072 norm_overlap=1.0000 corr_cb=-0.0156 topkJ=0.0413
[TRAIN][ep=007] loss=0.6530 acc=63.77%
[TRAIN][ep=007] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0058
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4788 mb_mean=0.5063 norm_overlap=0.9999 corr_cb=-0.1226 topkJ=0.0341
[TRAIN][ep=008] loss=0.6521 acc=63.77%
[TRAIN][ep=008] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0077
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4796 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=0.0434 topkJ=0.0713
[TRAIN][ep=009] loss=0.6503 acc=63.77%
[TRAIN][ep=009] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0082
================= FIT START (fold=2) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.35 select_by=val_score | eval_thr_mode=best_acc eval_thr_grid=coarse | disease_pos_weight_mode=none freeze_b_after=15 | two_stage=True stage1_ratio=0.35 stage2_lr_mult=0.3 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4807 mb_mean=0.5078 norm_overlap=1.0000 corr_cb=0.0284 topkJ=0.0655
[TRAIN][ep=000] loss=0.6497 acc=63.77%
[TRAIN][ep=000] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0057
[EPOCH 000/089] train: loss=0.6497 acc=63.77% | val: loss=0.6514 acc=69.35% f1=34.48% auc=66.22% val_score=69.0522 val_score_bestthr=85.2797 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.480, mb=0.508, no=1.000, corr=-0.006) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* -1000000000000000000.0000 -> 69.0522
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4809 mb_mean=0.5072 norm_overlap=1.0001 corr_cb=0.1026 topkJ=0.1054
[TRAIN][ep=001] loss=0.6477 acc=63.77%
[TRAIN][ep=001] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0084
[EPOCH 001/089] train: loss=0.6477 acc=63.77% | val: loss=0.6505 acc=70.97% f1=47.06% auc=66.56% val_score=65.7902 val_score_bestthr=93.2489 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.480, mb=0.508, no=1.000, corr=-0.008) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 69.0522 -> 65.7902
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4802 mb_mean=0.5075 norm_overlap=1.0000 corr_cb=0.0222 topkJ=0.0557
[TRAIN][ep=002] loss=0.6468 acc=63.77%
[TRAIN][ep=002] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0048
[EPOCH 002/089] train: loss=0.6468 acc=63.77% | val: loss=0.6494 acc=70.97% f1=50.00% auc=66.00% val_score=69.8259 val_score_bestthr=95.0010 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.480, mb=0.508, no=1.000, corr=-0.005) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 69.0522 -> 69.8259
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4773 mb_mean=0.5082 norm_overlap=1.0001 corr_cb=0.1498 topkJ=0.1079
[TRAIN][ep=003] loss=0.6447 acc=63.77%
[TRAIN][ep=003] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0071
[EPOCH 003/089] train: loss=0.6447 acc=63.77% | val: loss=0.6483 acc=69.35% f1=42.42% auc=67.11% val_score=71.7551 val_score_bestthr=89.5496 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.480, mb=0.508, no=1.000, corr=-0.007) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 69.8259 -> 71.7551
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4801 mb_mean=0.5075 norm_overlap=0.9999 corr_cb=-0.1147 topkJ=0.0525
[TRAIN][ep=004] loss=0.6429 acc=63.77%
[TRAIN][ep=004] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0086
[EPOCH 004/089] train: loss=0.6429 acc=63.77% | val: loss=0.6467 acc=72.58% f1=45.16% auc=67.45% val_score=77.0365 val_score_bestthr=94.1547 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.480, mb=0.508, no=1.000, corr=-0.009) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 71.7551 -> 77.0365
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4786 mb_mean=0.5078 norm_overlap=1.0001 corr_cb=0.1409 topkJ=0.1263
[TRAIN][ep=005] loss=2.2443 acc=63.77%
[TRAIN][ep=005] mask_avg: mc_mean=0.4764 mb_mean=0.5011 norm_overlap=1.0002 corr_cb=0.1705
[EPOCH 005/089] train: loss=2.2443 acc=63.77% | val: loss=0.6489 acc=69.35% f1=42.42% auc=67.00% val_score=92.7790 val_score_bestthr=89.2722 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.476, mb=0.501, no=1.000, corr=0.171) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 77.0365 -> 92.7790
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4708 mb_mean=0.4925 norm_overlap=1.0009 corr_cb=0.5497 topkJ=0.1507
[TRAIN][ep=006] loss=2.2433 acc=63.77%
[TRAIN][ep=006] mask_avg: mc_mean=0.4673 mb_mean=0.4840 norm_overlap=1.0006 corr_cb=0.3501
[EPOCH 006/089] train: loss=2.2433 acc=63.77% | val: loss=0.6476 acc=69.35% f1=51.28% auc=66.78% val_score=80.4100 val_score_bestthr=93.7937 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.467, mb=0.484, no=1.001, corr=0.350) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 80.4100
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4626 mb_mean=0.4746 norm_overlap=1.0006 corr_cb=0.3278 topkJ=0.1242
[TRAIN][ep=007] loss=2.2386 acc=63.77%
[TRAIN][ep=007] mask_avg: mc_mean=0.4567 mb_mean=0.4638 norm_overlap=1.0013 corr_cb=0.4239
[EPOCH 007/089] train: loss=2.2386 acc=63.77% | val: loss=0.6461 acc=70.97% f1=50.00% auc=67.78% val_score=85.1307 val_score_bestthr=94.9540 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.457, mb=0.464, no=1.001, corr=0.424) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 85.1307
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4508 mb_mean=0.4552 norm_overlap=1.0012 corr_cb=0.3766 topkJ=0.1100
[TRAIN][ep=008] loss=1.5072 acc=63.77%
[TRAIN][ep=008] mask_avg: mc_mean=0.4456 mb_mean=0.4407 norm_overlap=1.0022 corr_cb=0.4613
[EPOCH 008/089] train: loss=1.5072 acc=63.77% | val: loss=0.6445 acc=70.97% f1=50.00% auc=67.22% val_score=81.4369 val_score_bestthr=95.0010 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.446, mb=0.441, no=1.002, corr=0.461) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 81.4369
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4384 mb_mean=0.4231 norm_overlap=1.0022 corr_cb=0.4420 topkJ=0.1608
[TRAIN][ep=009] loss=0.7808 acc=63.77%
[TRAIN][ep=009] mask_avg: mc_mean=0.4341 mb_mean=0.4153 norm_overlap=1.0035 corr_cb=0.4680
[EPOCH 009/089] train: loss=0.7808 acc=63.77% | val: loss=0.6431 acc=69.35% f1=45.71% auc=67.89% val_score=85.1307 val_score_bestthr=91.1571 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.434, mb=0.415, no=1.004, corr=0.468) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 85.1307
[DBG][ep=010] disease_pos_weight=1.0000 mode=none
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.4294 mb_mean=0.3982 norm_overlap=1.0050 corr_cb=0.5455 topkJ=0.1879
[TRAIN][ep=010] loss=0.5879 acc=63.77%
[TRAIN][ep=010] mask_avg: mc_mean=0.4220 mb_mean=0.3889 norm_overlap=1.0048 corr_cb=0.4295
[EPOCH 010/089] train: loss=0.5879 acc=63.77% | val: loss=0.6408 acc=70.97% f1=43.75% auc=68.23% val_score=85.5165 val_score_bestthr=91.7940 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.422, mb=0.389, no=1.005, corr=0.430) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 85.5165
[DBG][ep=011] disease_pos_weight=1.0000 mode=none
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.4170 mb_mean=0.3765 norm_overlap=1.0049 corr_cb=0.3745 topkJ=0.1298
[TRAIN][ep=011] loss=0.5607 acc=63.77%
[TRAIN][ep=011] mask_avg: mc_mean=0.4098 mb_mean=0.3632 norm_overlap=1.0055 corr_cb=0.3347
[EPOCH 011/089] train: loss=0.5607 acc=63.77% | val: loss=0.6383 acc=69.35% f1=42.42% auc=68.45% val_score=85.0682 val_score_bestthr=89.5659 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.410, mb=0.363, no=1.005, corr=0.335) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 85.0682
[DBG][ep=012] disease_pos_weight=1.0000 mode=none
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.4075 mb_mean=0.3555 norm_overlap=1.0038 corr_cb=0.2604 topkJ=0.1875
[TRAIN][ep=012] loss=0.5548 acc=63.77%
[TRAIN][ep=012] mask_avg: mc_mean=0.3969 mb_mean=0.3398 norm_overlap=1.0041 corr_cb=0.1725
[EPOCH 012/089] train: loss=0.5548 acc=63.77% | val: loss=0.6356 acc=69.35% f1=55.81% auc=68.56% val_score=89.6813 val_score_bestthr=96.4956 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.397, mb=0.340, no=1.004, corr=0.172) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 89.6813
[DBG][ep=013] disease_pos_weight=1.0000 mode=none
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.3855 mb_mean=0.3231 norm_overlap=1.0061 corr_cb=0.1996 topkJ=0.1051
[TRAIN][ep=013] loss=0.8369 acc=63.77%
[TRAIN][ep=013] mask_avg: mc_mean=0.3841 mb_mean=0.3193 norm_overlap=0.9996 corr_cb=-0.0141
[EPOCH 013/089] train: loss=0.8369 acc=63.77% | val: loss=0.6334 acc=70.97% f1=40.00% auc=68.45% val_score=87.5649 val_score_bestthr=89.9892 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.384, mb=0.319, no=1.000, corr=-0.014) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 87.5649
[DBG][ep=014] disease_pos_weight=1.0000 mode=none
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.3847 mb_mean=0.3224 norm_overlap=0.9969 corr_cb=-0.0917 topkJ=0.0726
[TRAIN][ep=014] loss=1.1194 acc=63.95%
[TRAIN][ep=014] mask_avg: mc_mean=0.3703 mb_mean=0.3024 norm_overlap=0.9903 corr_cb=-0.1927
[EPOCH 014/089] train: loss=1.1194 acc=63.95% | val: loss=0.6319 acc=70.97% f1=40.00% auc=68.00% val_score=82.9854 val_score_bestthr=89.9892 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.370, mb=0.302, no=0.990, corr=-0.193) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 82.9854
[DBG][ep=015] disease_pos_weight=1.0000 mode=none
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.3637 mb_mean=0.3018 norm_overlap=0.9841 corr_cb=-0.2781 topkJ=0.0201
[TRAIN][ep=015] loss=1.4028 acc=64.31%
[TRAIN][ep=015] mask_avg: mc_mean=0.3604 mb_mean=0.2951 norm_overlap=0.9788 corr_cb=-0.3408
[EPOCH 015/089] train: loss=1.4028 acc=64.31% | val: loss=0.6315 acc=70.97% f1=40.00% auc=68.45% val_score=83.7773 val_score_bestthr=89.9892 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.360, mb=0.295, no=0.979, corr=-0.341) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 83.7773
[DBG][ep=016] disease_pos_weight=1.0000 mode=none
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.3482 mb_mean=0.3057 norm_overlap=0.9731 corr_cb=-0.4126 topkJ=0.0135
[TRAIN][ep=016] loss=1.6730 acc=64.13%
[TRAIN][ep=016] mask_avg: mc_mean=0.3503 mb_mean=0.2951 norm_overlap=0.9697 corr_cb=-0.4115
[EPOCH 016/089] train: loss=1.6730 acc=64.13% | val: loss=0.6292 acc=70.97% f1=40.00% auc=67.45% val_score=82.9854 val_score_bestthr=89.9892 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.350, mb=0.295, no=0.970, corr=-0.412) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 82.9854
[DBG][ep=017] disease_pos_weight=1.0000 mode=none
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.3552 mb_mean=0.3031 norm_overlap=0.9629 corr_cb=-0.5109 topkJ=0.0021
[TRAIN][ep=017] loss=1.9537 acc=64.49%
[TRAIN][ep=017] mask_avg: mc_mean=0.3403 mb_mean=0.2951 norm_overlap=0.9602 corr_cb=-0.4583
[EPOCH 017/089] train: loss=1.9537 acc=64.49% | val: loss=0.6284 acc=70.97% f1=40.00% auc=66.56% val_score=91.6801 val_score_bestthr=89.9892 | dyn(w_pfs=0.100, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.340, mb=0.295, no=0.960, corr=-0.458) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 91.6801
[DBG][ep=018] disease_pos_weight=1.0000 mode=none
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.3376 mb_mean=0.3043 norm_overlap=0.9594 corr_cb=-0.4441 topkJ=0.0020
[TRAIN][ep=018] loss=1.2263 acc=65.04%
[TRAIN][ep=018] mask_avg: mc_mean=0.3318 mb_mean=0.2951 norm_overlap=0.9518 corr_cb=-0.4958
[EPOCH 018/089] train: loss=1.2263 acc=65.04% | val: loss=0.6239 acc=70.97% f1=40.00% auc=66.00% val_score=90.1560 val_score_bestthr=89.9892 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.332, mb=0.295, no=0.952, corr=-0.496) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 90.1560
[DBG][ep=019] disease_pos_weight=1.0000 mode=none
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.3222 mb_mean=0.2734 norm_overlap=0.9314 corr_cb=-0.5247 topkJ=0.0024
[TRAIN][ep=019] loss=0.5048 acc=65.58%
[TRAIN][ep=019] mask_avg: mc_mean=0.3227 mb_mean=0.2951 norm_overlap=0.9422 corr_cb=-0.5233
[EPOCH 019/089] train: loss=0.5048 acc=65.58% | val: loss=0.6195 acc=69.35% f1=38.71% auc=67.45% val_score=82.4688 val_score_bestthr=87.7370 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.323, mb=0.295, no=0.942, corr=-0.523) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 82.4688
[DBG][ep=020] disease_pos_weight=1.0000 mode=none
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.3232 mb_mean=0.2995 norm_overlap=0.9225 corr_cb=-0.6331 topkJ=0.0012
[TRAIN][ep=020] loss=0.4933 acc=71.74%
[TRAIN][ep=020] mask_avg: mc_mean=0.3151 mb_mean=0.2950 norm_overlap=0.9324 corr_cb=-0.5553
[EPOCH 020/089] train: loss=0.4933 acc=71.74% | val: loss=0.6177 acc=70.97% f1=40.00% auc=68.00% val_score=89.9094 val_score_bestthr=89.9892 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.315, mb=0.295, no=0.932, corr=-0.555) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 89.9094
[DBG][ep=021] disease_pos_weight=1.0000 mode=none
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.3107 mb_mean=0.2985 norm_overlap=0.9158 corr_cb=-0.6518 topkJ=0.0000
[TRAIN][ep=021] loss=0.4841 acc=68.30%
[TRAIN][ep=021] mask_avg: mc_mean=0.3068 mb_mean=0.2951 norm_overlap=0.9216 corr_cb=-0.5736
[EPOCH 021/089] train: loss=0.4841 acc=68.30% | val: loss=0.6110 acc=69.35% f1=38.71% auc=67.67% val_score=86.5843 val_score_bestthr=87.7370 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.307, mb=0.295, no=0.922, corr=-0.574) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 86.5843
[DBG][ep=022] disease_pos_weight=1.0000 mode=none
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2967 mb_mean=0.3024 norm_overlap=0.9233 corr_cb=-0.6426 topkJ=0.0004
[TRAIN][ep=022] loss=0.4760 acc=70.65%
[TRAIN][ep=022] mask_avg: mc_mean=0.2995 mb_mean=0.2951 norm_overlap=0.9117 corr_cb=-0.5896
[EPOCH 022/089] train: loss=0.4760 acc=70.65% | val: loss=0.6085 acc=69.35% f1=34.48% auc=67.56% val_score=88.7228 val_score_bestthr=85.6635 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.300, mb=0.295, no=0.912, corr=-0.590) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 88.7228
[DBG][ep=023] disease_pos_weight=1.0000 mode=none
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2981 mb_mean=0.2990 norm_overlap=0.9207 corr_cb=-0.5718 topkJ=0.0004
[TRAIN][ep=023] loss=0.4650 acc=71.56%
[TRAIN][ep=023] mask_avg: mc_mean=0.2944 mb_mean=0.2951 norm_overlap=0.9032 corr_cb=-0.6039
[EPOCH 023/089] train: loss=0.4650 acc=71.56% | val: loss=0.6058 acc=69.35% f1=34.48% auc=68.12% val_score=89.2527 val_score_bestthr=85.6635 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.294, mb=0.295, no=0.903, corr=-0.604) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 89.2527
[DBG][ep=024] disease_pos_weight=1.0000 mode=none
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.3005 mb_mean=0.3001 norm_overlap=0.9111 corr_cb=-0.5745 topkJ=0.0000
[TRAIN][ep=024] loss=0.4559 acc=74.46%
[TRAIN][ep=024] mask_avg: mc_mean=0.2886 mb_mean=0.2951 norm_overlap=0.8940 corr_cb=-0.6137
[EPOCH 024/089] train: loss=0.4559 acc=74.46% | val: loss=0.6081 acc=69.35% f1=34.48% auc=68.00% val_score=85.5066 val_score_bestthr=85.6635 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.289, mb=0.295, no=0.894, corr=-0.614) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 85.5066
[DBG][ep=025] disease_pos_weight=1.0000 mode=none
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2701 mb_mean=0.2912 norm_overlap=0.9264 corr_cb=-0.4458 topkJ=0.0004
[TRAIN][ep=025] loss=0.4457 acc=74.09%
[TRAIN][ep=025] mask_avg: mc_mean=0.2842 mb_mean=0.2951 norm_overlap=0.8854 corr_cb=-0.6245
[EPOCH 025/089] train: loss=0.4457 acc=74.09% | val: loss=0.6156 acc=67.74% f1=37.50% auc=66.67% val_score=83.7279 val_score_bestthr=85.4359 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.284, mb=0.295, no=0.885, corr=-0.624) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 83.7279
[DBG][ep=026] disease_pos_weight=1.0000 mode=none
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2756 mb_mean=0.3013 norm_overlap=0.8736 corr_cb=-0.7324 topkJ=0.0000
[TRAIN][ep=026] loss=0.4381 acc=75.72%
[TRAIN][ep=026] mask_avg: mc_mean=0.2806 mb_mean=0.2951 norm_overlap=0.8772 corr_cb=-0.6397
[EPOCH 026/089] train: loss=0.4381 acc=75.72% | val: loss=0.6109 acc=69.35% f1=38.71% auc=67.11% val_score=84.2453 val_score_bestthr=87.7370 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.281, mb=0.295, no=0.877, corr=-0.640) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 84.2453
[DBG][ep=027] disease_pos_weight=1.0000 mode=none
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2526 mb_mean=0.2912 norm_overlap=0.9062 corr_cb=-0.4982 topkJ=0.0000
[TRAIN][ep=027] loss=0.4315 acc=76.09%
[TRAIN][ep=027] mask_avg: mc_mean=0.2771 mb_mean=0.2951 norm_overlap=0.8693 corr_cb=-0.6469
[EPOCH 027/089] train: loss=0.4315 acc=76.09% | val: loss=0.6242 acc=67.74% f1=41.18% auc=66.33% val_score=81.6832 val_score_bestthr=87.3634 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.277, mb=0.295, no=0.869, corr=-0.647) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 81.6832
[DBG][ep=028] disease_pos_weight=1.0000 mode=none
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2695 mb_mean=0.3032 norm_overlap=0.8785 corr_cb=-0.6839 topkJ=0.0000
[TRAIN][ep=028] loss=0.4202 acc=78.08%
[TRAIN][ep=028] mask_avg: mc_mean=0.2738 mb_mean=0.2951 norm_overlap=0.8617 corr_cb=-0.6577
[EPOCH 028/089] train: loss=0.4202 acc=78.08% | val: loss=0.6232 acc=69.35% f1=38.71% auc=65.55% val_score=81.2832 val_score_bestthr=87.7370 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.274, mb=0.295, no=0.862, corr=-0.658) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 81.2832
[DBG][ep=029] disease_pos_weight=1.0000 mode=none
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2803 mb_mean=0.2923 norm_overlap=0.8718 corr_cb=-0.6023 topkJ=0.0000
[TRAIN][ep=029] loss=0.4111 acc=80.07%
[TRAIN][ep=029] mask_avg: mc_mean=0.2710 mb_mean=0.2951 norm_overlap=0.8548 corr_cb=-0.6660
[EPOCH 029/089] train: loss=0.4111 acc=80.07% | val: loss=0.6355 acc=70.97% f1=40.00% auc=65.55% val_score=86.6907 val_score_bestthr=89.9892 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.271, mb=0.295, no=0.855, corr=-0.666) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 86.6907
[DBG][ep=030] disease_pos_weight=1.0000 mode=none
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2631 mb_mean=0.3056 norm_overlap=0.8721 corr_cb=-0.6504 topkJ=0.0000
[TRAIN][ep=030] loss=0.4049 acc=77.72%
[TRAIN][ep=030] mask_avg: mc_mean=0.2680 mb_mean=0.2951 norm_overlap=0.8477 corr_cb=-0.6708
[EPOCH 030/089] train: loss=0.4049 acc=77.72% | val: loss=0.6397 acc=69.35% f1=38.71% auc=65.11% val_score=87.8098 val_score_bestthr=87.7370 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.268, mb=0.295, no=0.848, corr=-0.671) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 87.8098
[DBG][ep=031] disease_pos_weight=1.0000 mode=none
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2534 mb_mean=0.2886 norm_overlap=0.8407 corr_cb=-0.6384 topkJ=0.0000
[TRAIN][ep=031] loss=0.3927 acc=78.08%
[TRAIN][ep=031] mask_avg: mc_mean=0.2668 mb_mean=0.2951 norm_overlap=0.8445 corr_cb=-0.6700
[EPOCH 031/089] train: loss=0.3927 acc=78.08% | val: loss=0.6344 acc=69.35% f1=42.42% auc=64.66% val_score=87.0667 val_score_bestthr=89.6835 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.267, mb=0.295, no=0.844, corr=-0.670) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 87.0667
[DBG][ep=032] disease_pos_weight=1.0000 mode=none
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2839 mb_mean=0.2843 norm_overlap=0.7704 corr_cb=-0.7752 topkJ=0.0000
[TRAIN][ep=032] loss=0.3883 acc=79.71%
[TRAIN][ep=032] mask_avg: mc_mean=0.2668 mb_mean=0.2951 norm_overlap=0.8447 corr_cb=-0.6726
[EPOCH 032/089] train: loss=0.3883 acc=79.71% | val: loss=0.6351 acc=69.35% f1=42.42% auc=64.66% val_score=86.4757 val_score_bestthr=89.6835 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.267, mb=0.295, no=0.845, corr=-0.673) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 86.4757
[DBG][ep=033] disease_pos_weight=1.0000 mode=none
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2623 mb_mean=0.3073 norm_overlap=0.8804 corr_cb=-0.6272 topkJ=0.0000
[TRAIN][ep=033] loss=0.3871 acc=80.07%
[TRAIN][ep=033] mask_avg: mc_mean=0.2668 mb_mean=0.2950 norm_overlap=0.8443 corr_cb=-0.6747
[EPOCH 033/089] train: loss=0.3871 acc=80.07% | val: loss=0.6365 acc=70.97% f1=43.75% auc=64.66% val_score=86.4757 val_score_bestthr=91.9375 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.267, mb=0.295, no=0.844, corr=-0.675) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 86.4757
[DBG][ep=034] disease_pos_weight=1.0000 mode=none
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2623 mb_mean=0.3073 norm_overlap=0.8796 corr_cb=-0.5974 topkJ=0.0000
[TRAIN][ep=034] loss=0.3844 acc=80.07%
[TRAIN][ep=034] mask_avg: mc_mean=0.2668 mb_mean=0.2951 norm_overlap=0.8446 corr_cb=-0.6714
[EPOCH 034/089] train: loss=0.3844 acc=80.07% | val: loss=0.6385 acc=70.97% f1=43.75% auc=64.44% val_score=84.2453 val_score_bestthr=91.9375 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.267, mb=0.295, no=0.845, corr=-0.671) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 84.2453
[DBG][ep=035] disease_pos_weight=1.0000 mode=none
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2661 mb_mean=0.2827 norm_overlap=0.8189 corr_cb=-0.6681 topkJ=0.0000
[TRAIN][ep=035] loss=0.3830 acc=79.89%
[TRAIN][ep=035] mask_avg: mc_mean=0.2668 mb_mean=0.2951 norm_overlap=0.8443 corr_cb=-0.6736
[EPOCH 035/089] train: loss=0.3830 acc=79.89% | val: loss=0.6381 acc=70.97% f1=43.75% auc=64.55% val_score=86.4757 val_score_bestthr=91.9375 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.267, mb=0.295, no=0.844, corr=-0.674) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 86.4757
[EARLY STOP] no improvement for 30 epochs. best_epoch=5
[CKPT] Loaded best for testing: results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
=============== FIT DONE ===============
[BEST] epoch=5 | val_acc=69.35% | val_f1=42.42% | val_auc=67.00% | val_score=92.7790 | val_score_bestthr=89.2722
[TEST@BEST] thr_used=0.370 | acc=64.05% f1=15.38% auc=57.84% | SP_sex=1.45% EO_sex=8.41% SP_age=8.77% EO_age=14.12%
[TIME] 0.62 min
[OK] Saved: results/ADHD_3x5fold_seed0/fold2_rep0_seed2/summary_fold_2.json
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4784 mb_mean=0.5063 norm_overlap=0.9999 corr_cb=-0.0928 topkJ=0.0294
[TRAIN][ep=000] loss=0.6710 acc=63.77%
[TRAIN][ep=000] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0078
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4808 mb_mean=0.5078 norm_overlap=0.9999 corr_cb=-0.1127 topkJ=0.0310
[TRAIN][ep=001] loss=0.6646 acc=63.77%
[TRAIN][ep=001] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0102
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4792 mb_mean=0.5067 norm_overlap=1.0000 corr_cb=0.0224 topkJ=0.0484
[TRAIN][ep=002] loss=0.6608 acc=63.77%
[TRAIN][ep=002] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0054
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4787 mb_mean=0.5076 norm_overlap=0.9997 corr_cb=-0.3063 topkJ=0.0248
[TRAIN][ep=003] loss=0.6578 acc=63.77%
[TRAIN][ep=003] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0074
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4810 mb_mean=0.5098 norm_overlap=1.0000 corr_cb=0.0354 topkJ=0.0553
[TRAIN][ep=004] loss=0.6568 acc=63.77%
[TRAIN][ep=004] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0056
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4798 mb_mean=0.5070 norm_overlap=1.0000 corr_cb=-0.0288 topkJ=0.0211
[TRAIN][ep=005] loss=0.6552 acc=63.77%
[TRAIN][ep=005] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0076
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4802 mb_mean=0.5083 norm_overlap=1.0001 corr_cb=0.0978 topkJ=0.0511
[TRAIN][ep=006] loss=0.6542 acc=63.77%
[TRAIN][ep=006] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0103
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4799 mb_mean=0.5072 norm_overlap=1.0000 corr_cb=-0.0156 topkJ=0.0413
[TRAIN][ep=007] loss=0.6530 acc=63.77%
[TRAIN][ep=007] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0058
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4788 mb_mean=0.5063 norm_overlap=0.9999 corr_cb=-0.1226 topkJ=0.0341
[TRAIN][ep=008] loss=0.6521 acc=63.77%
[TRAIN][ep=008] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0077
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4796 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=0.0434 topkJ=0.0713
[TRAIN][ep=009] loss=0.6503 acc=63.77%
[TRAIN][ep=009] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0082
================= FIT START (fold=2) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.35 select_by=val_score | eval_thr_mode=best_acc eval_thr_grid=coarse | disease_pos_weight_mode=none freeze_b_after=15 | two_stage=True stage1_ratio=0.35 stage2_lr_mult=0.3 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4807 mb_mean=0.5078 norm_overlap=1.0000 corr_cb=0.0284 topkJ=0.0655
[TRAIN][ep=000] loss=0.6497 acc=63.77%
[TRAIN][ep=000] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0057
[EPOCH 000/089] train: loss=0.6497 acc=63.77% | val: loss=0.6514 acc=69.35% f1=34.48% auc=66.22% val_score=69.0522 val_score_bestthr=85.2797 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.480, mb=0.508, no=1.000, corr=-0.006) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* -1000000000000000000.0000 -> 69.0522
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4809 mb_mean=0.5072 norm_overlap=1.0001 corr_cb=0.1026 topkJ=0.1054
[TRAIN][ep=001] loss=0.6477 acc=63.77%
[TRAIN][ep=001] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0084
[EPOCH 001/089] train: loss=0.6477 acc=63.77% | val: loss=0.6505 acc=70.97% f1=47.06% auc=66.56% val_score=65.7902 val_score_bestthr=93.2489 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.480, mb=0.508, no=1.000, corr=-0.008) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 69.0522 -> 65.7902
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4802 mb_mean=0.5075 norm_overlap=1.0000 corr_cb=0.0222 topkJ=0.0557
[TRAIN][ep=002] loss=0.6468 acc=63.77%
[TRAIN][ep=002] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0048
[EPOCH 002/089] train: loss=0.6468 acc=63.77% | val: loss=0.6494 acc=70.97% f1=50.00% auc=66.00% val_score=69.8259 val_score_bestthr=95.0010 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.480, mb=0.508, no=1.000, corr=-0.005) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 69.0522 -> 69.8259
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4773 mb_mean=0.5082 norm_overlap=1.0001 corr_cb=0.1498 topkJ=0.1079
[TRAIN][ep=003] loss=0.6447 acc=63.77%
[TRAIN][ep=003] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0071
[EPOCH 003/089] train: loss=0.6447 acc=63.77% | val: loss=0.6483 acc=69.35% f1=42.42% auc=67.22% val_score=71.7551 val_score_bestthr=89.5496 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.480, mb=0.508, no=1.000, corr=-0.007) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 69.8259 -> 71.7551
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4801 mb_mean=0.5075 norm_overlap=0.9999 corr_cb=-0.1147 topkJ=0.0525
[TRAIN][ep=004] loss=0.6429 acc=63.77%
[TRAIN][ep=004] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0086
[EPOCH 004/089] train: loss=0.6429 acc=63.77% | val: loss=0.6467 acc=72.58% f1=45.16% auc=67.45% val_score=77.0365 val_score_bestthr=94.1547 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.480, mb=0.508, no=1.000, corr=-0.009) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 71.7551 -> 77.0365
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4786 mb_mean=0.5078 norm_overlap=1.0001 corr_cb=0.1409 topkJ=0.1263
[TRAIN][ep=005] loss=2.1169 acc=63.77%
[TRAIN][ep=005] mask_avg: mc_mean=0.4764 mb_mean=0.5011 norm_overlap=1.0002 corr_cb=0.1723
[EPOCH 005/089] train: loss=2.1169 acc=63.77% | val: loss=0.6491 acc=69.35% f1=42.42% auc=67.11% val_score=92.7790 val_score_bestthr=89.2722 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.476, mb=0.501, no=1.000, corr=0.172) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 77.0365 -> 92.7790
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4707 mb_mean=0.4925 norm_overlap=1.0009 corr_cb=0.5517 topkJ=0.1507
[TRAIN][ep=006] loss=2.0994 acc=63.77%
[TRAIN][ep=006] mask_avg: mc_mean=0.4672 mb_mean=0.4840 norm_overlap=1.0006 corr_cb=0.3548
[EPOCH 006/089] train: loss=2.0994 acc=63.77% | val: loss=0.6479 acc=70.97% f1=52.63% auc=67.00% val_score=88.8538 val_score_bestthr=96.1051 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.467, mb=0.484, no=1.001, corr=0.355) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 88.8538
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4623 mb_mean=0.4746 norm_overlap=1.0006 corr_cb=0.3361 topkJ=0.1257
[TRAIN][ep=007] loss=2.0910 acc=63.77%
[TRAIN][ep=007] mask_avg: mc_mean=0.4563 mb_mean=0.4638 norm_overlap=1.0013 corr_cb=0.4328
[EPOCH 007/089] train: loss=2.0910 acc=63.77% | val: loss=0.6465 acc=70.97% f1=47.06% auc=67.56% val_score=89.2561 val_score_bestthr=93.2489 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.456, mb=0.464, no=1.001, corr=0.433) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 89.2561
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4502 mb_mean=0.4552 norm_overlap=1.0012 corr_cb=0.3917 topkJ=0.1156
[TRAIN][ep=008] loss=2.0813 acc=63.77%
[TRAIN][ep=008] mask_avg: mc_mean=0.4449 mb_mean=0.4407 norm_overlap=1.0023 corr_cb=0.4731
[EPOCH 008/089] train: loss=2.0813 acc=63.77% | val: loss=0.6450 acc=70.97% f1=50.00% auc=67.56% val_score=81.4369 val_score_bestthr=95.0010 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.445, mb=0.441, no=1.002, corr=0.473) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 81.4369
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4375 mb_mean=0.4232 norm_overlap=1.0024 corr_cb=0.4539 topkJ=0.1714
[TRAIN][ep=009] loss=2.0739 acc=63.77%
[TRAIN][ep=009] mask_avg: mc_mean=0.4333 mb_mean=0.4159 norm_overlap=1.0038 corr_cb=0.4796
[EPOCH 009/089] train: loss=2.0739 acc=63.77% | val: loss=0.6445 acc=69.35% f1=48.65% auc=66.78% val_score=81.4369 val_score_bestthr=92.7479 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.433, mb=0.416, no=1.004, corr=0.480) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 81.4369
[DBG][ep=010] disease_pos_weight=1.0000 mode=none
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.4292 mb_mean=0.3996 norm_overlap=1.0052 corr_cb=0.5598 topkJ=0.1938
[TRAIN][ep=010] loss=2.0660 acc=63.77%
[TRAIN][ep=010] mask_avg: mc_mean=0.4227 mb_mean=0.3911 norm_overlap=1.0048 corr_cb=0.4302
[EPOCH 010/089] train: loss=2.0660 acc=63.77% | val: loss=0.6423 acc=70.97% f1=55.00% auc=68.45% val_score=85.0939 val_score_bestthr=97.6346 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.423, mb=0.391, no=1.005, corr=0.430) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 85.0939
[DBG][ep=011] disease_pos_weight=1.0000 mode=none
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.4187 mb_mean=0.3797 norm_overlap=1.0046 corr_cb=0.3583 topkJ=0.1218
[TRAIN][ep=011] loss=2.0606 acc=63.77%
[TRAIN][ep=011] mask_avg: mc_mean=0.4126 mb_mean=0.3675 norm_overlap=1.0055 corr_cb=0.3442
[EPOCH 011/089] train: loss=2.0606 acc=63.77% | val: loss=0.6421 acc=69.35% f1=51.28% auc=67.56% val_score=79.4298 val_score_bestthr=93.9204 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.413, mb=0.367, no=1.006, corr=0.344) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 79.4298
[DBG][ep=012] disease_pos_weight=1.0000 mode=none
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.4117 mb_mean=0.3609 norm_overlap=1.0043 corr_cb=0.2630 topkJ=0.1737
[TRAIN][ep=012] loss=2.0546 acc=63.77%
[TRAIN][ep=012] mask_avg: mc_mean=0.4034 mb_mean=0.3461 norm_overlap=1.0047 corr_cb=0.2133
[EPOCH 012/089] train: loss=2.0546 acc=63.77% | val: loss=0.6413 acc=67.74% f1=47.37% auc=66.78% val_score=84.2613 val_score_bestthr=90.5076 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.403, mb=0.346, no=1.005, corr=0.213) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 84.2613
[DBG][ep=013] disease_pos_weight=1.0000 mode=none
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.3942 mb_mean=0.3300 norm_overlap=1.0065 corr_cb=0.2169 topkJ=0.0805
[TRAIN][ep=013] loss=2.0385 acc=63.77%
[TRAIN][ep=013] mask_avg: mc_mean=0.3942 mb_mean=0.3265 norm_overlap=1.0023 corr_cb=0.0767
[EPOCH 013/089] train: loss=2.0385 acc=63.77% | val: loss=0.6385 acc=67.74% f1=54.55% auc=66.67% val_score=80.6761 val_score_bestthr=94.2565 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.394, mb=0.327, no=1.002, corr=0.077) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 80.6761
[DBG][ep=014] disease_pos_weight=1.0000 mode=none
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.3970 mb_mean=0.3293 norm_overlap=1.0015 corr_cb=0.0598 topkJ=0.0963
[TRAIN][ep=014] loss=2.0366 acc=63.77%
[TRAIN][ep=014] mask_avg: mc_mean=0.3851 mb_mean=0.3102 norm_overlap=0.9986 corr_cb=-0.0460
[EPOCH 014/089] train: loss=2.0366 acc=63.77% | val: loss=0.6358 acc=69.35% f1=34.48% auc=67.56% val_score=76.5489 val_score_bestthr=85.5296 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.385, mb=0.310, no=0.999, corr=-0.046) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 92.7790 -> 76.5489
[DBG][ep=015] disease_pos_weight=1.0000 mode=none
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.3808 mb_mean=0.3092 norm_overlap=0.9968 corr_cb=-0.0836 topkJ=0.0419
[TRAIN][ep=015] loss=2.0339 acc=63.77%
[TRAIN][ep=015] mask_avg: mc_mean=0.3784 mb_mean=0.3031 norm_overlap=0.9956 corr_cb=-0.1173
[EPOCH 015/089] train: loss=2.0339 acc=63.77% | val: loss=0.6352 acc=67.74% f1=52.38% auc=67.22% val_score=78.4843 val_score_bestthr=93.2743 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.378, mb=0.303, no=0.996, corr=-0.117) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 78.4843
[DBG][ep=016] disease_pos_weight=1.0000 mode=none
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.3692 mb_mean=0.3113 norm_overlap=0.9926 corr_cb=-0.1709 topkJ=0.0463
[TRAIN][ep=016] loss=1.3494 acc=63.77%
[TRAIN][ep=016] mask_avg: mc_mean=0.3708 mb_mean=0.3031 norm_overlap=0.9918 corr_cb=-0.1880
[EPOCH 016/089] train: loss=1.3494 acc=63.77% | val: loss=0.6331 acc=67.74% f1=56.52% auc=67.34% val_score=77.2512 val_score_bestthr=95.2459 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.371, mb=0.303, no=0.992, corr=-0.188) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 77.2512
[DBG][ep=017] disease_pos_weight=1.0000 mode=none
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.3761 mb_mean=0.3113 norm_overlap=0.9870 corr_cb=-0.3167 topkJ=0.0293
[TRAIN][ep=017] loss=0.6757 acc=63.95%
[TRAIN][ep=017] mask_avg: mc_mean=0.3644 mb_mean=0.3031 norm_overlap=0.9876 corr_cb=-0.2524
[EPOCH 017/089] train: loss=0.6757 acc=63.95% | val: loss=0.6299 acc=69.35% f1=38.71% auc=68.00% val_score=82.3309 val_score_bestthr=87.7578 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.364, mb=0.303, no=0.988, corr=-0.252) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 82.3309
[DBG][ep=018] disease_pos_weight=1.0000 mode=none
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.3636 mb_mean=0.3121 norm_overlap=0.9861 corr_cb=-0.2703 topkJ=0.0170
[TRAIN][ep=018] loss=0.5235 acc=64.31%
[TRAIN][ep=018] mask_avg: mc_mean=0.3573 mb_mean=0.3032 norm_overlap=0.9831 corr_cb=-0.3101
[EPOCH 018/089] train: loss=0.5235 acc=64.31% | val: loss=0.6262 acc=69.35% f1=38.71% auc=68.00% val_score=80.1987 val_score_bestthr=87.7578 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.357, mb=0.303, no=0.983, corr=-0.310) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 80.1987
[DBG][ep=019] disease_pos_weight=1.0000 mode=none
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.3472 mb_mean=0.2837 norm_overlap=0.9717 corr_cb=-0.3784 topkJ=0.0101
[TRAIN][ep=019] loss=0.5152 acc=65.22%
[TRAIN][ep=019] mask_avg: mc_mean=0.3493 mb_mean=0.3031 norm_overlap=0.9777 corr_cb=-0.3565
[EPOCH 019/089] train: loss=0.5152 acc=65.22% | val: loss=0.6223 acc=69.35% f1=38.71% auc=67.45% val_score=80.3295 val_score_bestthr=87.7578 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.349, mb=0.303, no=0.978, corr=-0.357) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 80.3295
[DBG][ep=020] disease_pos_weight=1.0000 mode=none
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.3484 mb_mean=0.3074 norm_overlap=0.9641 corr_cb=-0.4899 topkJ=0.0090
[TRAIN][ep=020] loss=0.5050 acc=69.57%
[TRAIN][ep=020] mask_avg: mc_mean=0.3419 mb_mean=0.3031 norm_overlap=0.9722 corr_cb=-0.4005
[EPOCH 020/089] train: loss=0.5050 acc=69.57% | val: loss=0.6198 acc=69.35% f1=42.42% auc=67.89% val_score=87.6758 val_score_bestthr=89.5871 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.342, mb=0.303, no=0.972, corr=-0.401) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 87.6758
[DBG][ep=021] disease_pos_weight=1.0000 mode=none
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.3378 mb_mean=0.3064 norm_overlap=0.9626 corr_cb=-0.5112 topkJ=0.0107
[TRAIN][ep=021] loss=0.4957 acc=67.03%
[TRAIN][ep=021] mask_avg: mc_mean=0.3326 mb_mean=0.3032 norm_overlap=0.9653 corr_cb=-0.4315
[EPOCH 021/089] train: loss=0.4957 acc=67.03% | val: loss=0.6145 acc=69.35% f1=34.48% auc=67.89% val_score=84.5017 val_score_bestthr=85.6635 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.333, mb=0.303, no=0.965, corr=-0.432) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 84.5017
[DBG][ep=022] disease_pos_weight=1.0000 mode=none
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.3238 mb_mean=0.3103 norm_overlap=0.9624 corr_cb=-0.5247 topkJ=0.0057
[TRAIN][ep=022] loss=0.4875 acc=70.47%
[TRAIN][ep=022] mask_avg: mc_mean=0.3242 mb_mean=0.3032 norm_overlap=0.9591 corr_cb=-0.4557
[EPOCH 022/089] train: loss=0.4875 acc=70.47% | val: loss=0.6108 acc=69.35% f1=34.48% auc=67.78% val_score=88.7228 val_score_bestthr=85.6635 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.324, mb=0.303, no=0.959, corr=-0.456) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 88.7228
[DBG][ep=023] disease_pos_weight=1.0000 mode=none
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.3229 mb_mean=0.3067 norm_overlap=0.9599 corr_cb=-0.4555 topkJ=0.0032
[TRAIN][ep=023] loss=0.4753 acc=71.74%
[TRAIN][ep=023] mask_avg: mc_mean=0.3173 mb_mean=0.3032 norm_overlap=0.9533 corr_cb=-0.4781
[EPOCH 023/089] train: loss=0.4753 acc=71.74% | val: loss=0.6077 acc=69.35% f1=34.48% auc=68.23% val_score=86.1537 val_score_bestthr=85.6635 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.317, mb=0.303, no=0.953, corr=-0.478) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 86.1537
[DBG][ep=024] disease_pos_weight=1.0000 mode=none
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.3209 mb_mean=0.3075 norm_overlap=0.9579 corr_cb=-0.4250 topkJ=0.0053
[TRAIN][ep=024] loss=0.4652 acc=73.55%
[TRAIN][ep=024] mask_avg: mc_mean=0.3093 mb_mean=0.3032 norm_overlap=0.9466 corr_cb=-0.4924
[EPOCH 024/089] train: loss=0.4652 acc=73.55% | val: loss=0.6091 acc=69.35% f1=34.48% auc=68.00% val_score=85.5066 val_score_bestthr=85.6635 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.309, mb=0.303, no=0.947, corr=-0.492) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 85.5066
[DBG][ep=025] disease_pos_weight=1.0000 mode=none
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2929 mb_mean=0.2998 norm_overlap=0.9646 corr_cb=-0.3295 topkJ=0.0077
[TRAIN][ep=025] loss=0.4543 acc=74.28%
[TRAIN][ep=025] mask_avg: mc_mean=0.3029 mb_mean=0.3032 norm_overlap=0.9405 corr_cb=-0.5087
[EPOCH 025/089] train: loss=0.4543 acc=74.28% | val: loss=0.6144 acc=67.74% f1=33.33% auc=67.22% val_score=83.7279 val_score_bestthr=83.4091 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.303, mb=0.303, no=0.941, corr=-0.509) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 83.7279
[DBG][ep=026] disease_pos_weight=1.0000 mode=none
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2958 mb_mean=0.3105 norm_overlap=0.9343 corr_cb=-0.6254 topkJ=0.0004
[TRAIN][ep=026] loss=0.4456 acc=76.27%
[TRAIN][ep=026] mask_avg: mc_mean=0.2980 mb_mean=0.3032 norm_overlap=0.9349 corr_cb=-0.5285
[EPOCH 026/089] train: loss=0.4456 acc=76.27% | val: loss=0.6104 acc=69.35% f1=34.48% auc=67.45% val_score=84.2453 val_score_bestthr=85.6635 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.298, mb=0.303, no=0.935, corr=-0.528) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 84.2453
[DBG][ep=027] disease_pos_weight=1.0000 mode=none
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2744 mb_mean=0.2991 norm_overlap=0.9486 corr_cb=-0.3993 topkJ=0.0036
[TRAIN][ep=027] loss=0.4386 acc=76.45%
[TRAIN][ep=027] mask_avg: mc_mean=0.2926 mb_mean=0.3032 norm_overlap=0.9291 corr_cb=-0.5384
[EPOCH 027/089] train: loss=0.4386 acc=76.45% | val: loss=0.6237 acc=67.74% f1=33.33% auc=66.89% val_score=79.5589 val_score_bestthr=83.4091 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.293, mb=0.303, no=0.929, corr=-0.538) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 79.5589
[DBG][ep=028] disease_pos_weight=1.0000 mode=none
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2879 mb_mean=0.3114 norm_overlap=0.9348 corr_cb=-0.5838 topkJ=0.0000
[TRAIN][ep=028] loss=0.4265 acc=77.72%
[TRAIN][ep=028] mask_avg: mc_mean=0.2881 mb_mean=0.3032 norm_overlap=0.9240 corr_cb=-0.5529
[EPOCH 028/089] train: loss=0.4265 acc=77.72% | val: loss=0.6227 acc=67.74% f1=37.50% auc=65.33% val_score=81.2832 val_score_bestthr=85.5091 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.288, mb=0.303, no=0.924, corr=-0.553) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 81.2832
[DBG][ep=029] disease_pos_weight=1.0000 mode=none
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2923 mb_mean=0.3019 norm_overlap=0.9294 corr_cb=-0.5052 topkJ=0.0004
[TRAIN][ep=029] loss=0.4171 acc=79.17%
[TRAIN][ep=029] mask_avg: mc_mean=0.2845 mb_mean=0.3032 norm_overlap=0.9191 corr_cb=-0.5661
[EPOCH 029/089] train: loss=0.4171 acc=79.17% | val: loss=0.6339 acc=70.97% f1=40.00% auc=65.11% val_score=84.6333 val_score_bestthr=89.9892 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.285, mb=0.303, no=0.919, corr=-0.566) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 84.6333
[DBG][ep=030] disease_pos_weight=1.0000 mode=none
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2806 mb_mean=0.3131 norm_overlap=0.9252 corr_cb=-0.5791 topkJ=0.0004
[TRAIN][ep=030] loss=0.4099 acc=77.90%
[TRAIN][ep=030] mask_avg: mc_mean=0.2805 mb_mean=0.3031 norm_overlap=0.9143 corr_cb=-0.5729
[EPOCH 030/089] train: loss=0.4099 acc=77.90% | val: loss=0.6396 acc=69.35% f1=45.71% auc=64.99% val_score=82.5174 val_score_bestthr=91.6264 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.281, mb=0.303, no=0.914, corr=-0.573) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 82.5174
[DBG][ep=031] disease_pos_weight=1.0000 mode=none
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2681 mb_mean=0.2961 norm_overlap=0.9099 corr_cb=-0.5478 topkJ=0.0004
[TRAIN][ep=031] loss=0.3975 acc=77.90%
[TRAIN][ep=031] mask_avg: mc_mean=0.2787 mb_mean=0.3032 norm_overlap=0.9117 corr_cb=-0.5720
[EPOCH 031/089] train: loss=0.3975 acc=77.90% | val: loss=0.6344 acc=69.35% f1=42.42% auc=64.77% val_score=87.0667 val_score_bestthr=89.6835 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.279, mb=0.303, no=0.912, corr=-0.572) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 87.0667
[DBG][ep=032] disease_pos_weight=1.0000 mode=none
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2889 mb_mean=0.2923 norm_overlap=0.8615 corr_cb=-0.6891 topkJ=0.0000
[TRAIN][ep=032] loss=0.3928 acc=79.53%
[TRAIN][ep=032] mask_avg: mc_mean=0.2787 mb_mean=0.3032 norm_overlap=0.9118 corr_cb=-0.5751
[EPOCH 032/089] train: loss=0.3928 acc=79.53% | val: loss=0.6351 acc=69.35% f1=42.42% auc=64.88% val_score=86.4757 val_score_bestthr=89.6835 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.279, mb=0.303, no=0.912, corr=-0.575) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 86.4757
[DBG][ep=033] disease_pos_weight=1.0000 mode=none
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2793 mb_mean=0.3138 norm_overlap=0.9385 corr_cb=-0.5067 topkJ=0.0008
[TRAIN][ep=033] loss=0.3915 acc=80.43%
[TRAIN][ep=033] mask_avg: mc_mean=0.2787 mb_mean=0.3031 norm_overlap=0.9117 corr_cb=-0.5770
[EPOCH 033/089] train: loss=0.3915 acc=80.43% | val: loss=0.6366 acc=69.35% f1=42.42% auc=64.88% val_score=86.4757 val_score_bestthr=89.6835 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.279, mb=0.303, no=0.912, corr=-0.577) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 86.4757
[DBG][ep=034] disease_pos_weight=1.0000 mode=none
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2773 mb_mean=0.3135 norm_overlap=0.9312 corr_cb=-0.4835 topkJ=0.0012
[TRAIN][ep=034] loss=0.3887 acc=80.07%
[TRAIN][ep=034] mask_avg: mc_mean=0.2787 mb_mean=0.3032 norm_overlap=0.9117 corr_cb=-0.5752
[EPOCH 034/089] train: loss=0.3887 acc=80.07% | val: loss=0.6388 acc=69.35% f1=42.42% auc=64.99% val_score=87.0667 val_score_bestthr=89.6835 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.279, mb=0.303, no=0.912, corr=-0.575) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 87.0667
[DBG][ep=035] disease_pos_weight=1.0000 mode=none
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2750 mb_mean=0.2914 norm_overlap=0.9040 corr_cb=-0.5488 topkJ=0.0000
[TRAIN][ep=035] loss=0.3871 acc=80.62%
[TRAIN][ep=035] mask_avg: mc_mean=0.2787 mb_mean=0.3032 norm_overlap=0.9116 corr_cb=-0.5766
[EPOCH 035/089] train: loss=0.3871 acc=80.62% | val: loss=0.6384 acc=69.35% f1=42.42% auc=64.88% val_score=86.4757 val_score_bestthr=89.6835 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.279, mb=0.303, no=0.912, corr=-0.577) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 92.7790 -> 86.4757
[EARLY STOP] no improvement for 30 epochs. best_epoch=5
[CKPT] Loaded best for testing: results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
=============== FIT DONE ===============
[BEST] epoch=5 | val_acc=69.35% | val_f1=42.42% | val_auc=67.11% | val_score=92.7790 | val_score_bestthr=89.2722
[TEST@BEST] thr_used=0.360 | acc=63.40% f1=31.71% auc=57.73% | SP_sex=3.28% EO_sex=10.20% SP_age=16.16% EO_age=15.69%
[TIME] 0.64 min
[OK] Saved: results/ADHD_3x5fold_seed0/fold2_rep0_seed2/summary_fold_2.json
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4784 mb_mean=0.5063 norm_overlap=0.9999 corr_cb=-0.0928 topkJ=0.0294
[TRAIN][ep=000] loss=0.6710 acc=63.77%
[TRAIN][ep=000] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0078
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4808 mb_mean=0.5078 norm_overlap=0.9999 corr_cb=-0.1127 topkJ=0.0310
[TRAIN][ep=001] loss=0.6646 acc=63.77%
[TRAIN][ep=001] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0102
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4792 mb_mean=0.5067 norm_overlap=1.0000 corr_cb=0.0224 topkJ=0.0484
[TRAIN][ep=002] loss=0.6608 acc=63.77%
[TRAIN][ep=002] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0054
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4787 mb_mean=0.5076 norm_overlap=0.9997 corr_cb=-0.3063 topkJ=0.0248
[TRAIN][ep=003] loss=0.6578 acc=63.77%
[TRAIN][ep=003] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0074
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4810 mb_mean=0.5098 norm_overlap=1.0000 corr_cb=0.0354 topkJ=0.0553
[TRAIN][ep=004] loss=0.6568 acc=63.77%
[TRAIN][ep=004] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0056
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4798 mb_mean=0.5070 norm_overlap=1.0000 corr_cb=-0.0288 topkJ=0.0211
[TRAIN][ep=005] loss=0.6552 acc=63.77%
[TRAIN][ep=005] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0076
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4802 mb_mean=0.5083 norm_overlap=1.0001 corr_cb=0.0978 topkJ=0.0511
[TRAIN][ep=006] loss=0.6542 acc=63.77%
[TRAIN][ep=006] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0103
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4799 mb_mean=0.5072 norm_overlap=1.0000 corr_cb=-0.0156 topkJ=0.0413
[TRAIN][ep=007] loss=0.6530 acc=63.77%
[TRAIN][ep=007] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0058
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4788 mb_mean=0.5063 norm_overlap=0.9999 corr_cb=-0.1226 topkJ=0.0341
[TRAIN][ep=008] loss=0.6521 acc=63.77%
[TRAIN][ep=008] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0077
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4796 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=0.0434 topkJ=0.0713
[TRAIN][ep=009] loss=0.6503 acc=63.77%
[TRAIN][ep=009] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0082
================= FIT START (fold=2) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.35 select_by=val_score | eval_thr_mode=best_acc eval_thr_grid=coarse | disease_pos_weight_mode=none freeze_b_after=15 | two_stage=True stage1_ratio=0.35 stage2_lr_mult=0.3 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4807 mb_mean=0.5078 norm_overlap=1.0000 corr_cb=0.0284 topkJ=0.0655
[TRAIN][ep=000] loss=0.6497 acc=63.77%
[TRAIN][ep=000] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0057
[EPOCH 000/089] train: loss=0.6497 acc=63.77% | val: loss=0.6514 acc=69.35% f1=34.48% auc=66.22% val_score=69.0522 val_score_bestthr=85.2797 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.480, mb=0.508, no=1.000, corr=-0.006) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* -1000000000000000000.0000 -> 69.0522
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4809 mb_mean=0.5072 norm_overlap=1.0001 corr_cb=0.1026 topkJ=0.1054
[TRAIN][ep=001] loss=0.6477 acc=63.77%
[TRAIN][ep=001] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0084
[EPOCH 001/089] train: loss=0.6477 acc=63.77% | val: loss=0.6505 acc=70.97% f1=47.06% auc=66.56% val_score=65.7902 val_score_bestthr=93.2489 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.480, mb=0.508, no=1.000, corr=-0.008) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 69.0522 -> 65.7902
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4802 mb_mean=0.5075 norm_overlap=1.0000 corr_cb=0.0222 topkJ=0.0557
[TRAIN][ep=002] loss=0.6468 acc=63.77%
[TRAIN][ep=002] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0048
[EPOCH 002/089] train: loss=0.6468 acc=63.77% | val: loss=0.6494 acc=70.97% f1=50.00% auc=66.00% val_score=69.8259 val_score_bestthr=95.0010 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.480, mb=0.508, no=1.000, corr=-0.005) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 69.0522 -> 69.8259
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4773 mb_mean=0.5082 norm_overlap=1.0001 corr_cb=0.1498 topkJ=0.1079
[TRAIN][ep=003] loss=0.6447 acc=63.77%
[TRAIN][ep=003] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0071
[EPOCH 003/089] train: loss=0.6447 acc=63.77% | val: loss=0.6483 acc=69.35% f1=42.42% auc=67.11% val_score=71.7551 val_score_bestthr=89.5496 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.480, mb=0.508, no=1.000, corr=-0.007) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 69.8259 -> 71.7551
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4801 mb_mean=0.5075 norm_overlap=0.9999 corr_cb=-0.1147 topkJ=0.0525
[TRAIN][ep=004] loss=0.6429 acc=63.77%
[TRAIN][ep=004] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0086
[EPOCH 004/089] train: loss=0.6429 acc=63.77% | val: loss=0.6467 acc=72.58% f1=45.16% auc=67.45% val_score=77.0365 val_score_bestthr=94.1547 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.480, mb=0.508, no=1.000, corr=-0.009) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 71.7551 -> 77.0365
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4786 mb_mean=0.5078 norm_overlap=1.0001 corr_cb=0.1409 topkJ=0.1263
[TRAIN][ep=005] loss=1.4472 acc=63.77%
[TRAIN][ep=005] mask_avg: mc_mean=0.4759 mb_mean=0.4865 norm_overlap=1.0003 corr_cb=0.1861
[EPOCH 005/089] train: loss=1.4472 acc=63.77% | val: loss=0.6487 acc=70.97% f1=47.06% auc=67.11% val_score=90.6047 val_score_bestthr=93.2489 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.476, mb=0.486, no=1.000, corr=0.186) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 77.0365 -> 90.6047
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4697 mb_mean=0.4641 norm_overlap=1.0016 corr_cb=0.5064 topkJ=0.1277
[TRAIN][ep=006] loss=1.4483 acc=63.77%
[TRAIN][ep=006] mask_avg: mc_mean=0.4655 mb_mean=0.4413 norm_overlap=1.0013 corr_cb=0.2969
[EPOCH 006/089] train: loss=1.4483 acc=63.77% | val: loss=0.6474 acc=70.97% f1=35.71% auc=67.00% val_score=80.4100 val_score_bestthr=87.7385 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.466, mb=0.441, no=1.001, corr=0.297) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 90.6047 -> 80.4100
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4602 mb_mean=0.4159 norm_overlap=1.0017 corr_cb=0.3409 topkJ=0.1881
[TRAIN][ep=007] loss=1.4407 acc=63.77%
[TRAIN][ep=007] mask_avg: mc_mean=0.4539 mb_mean=0.3963 norm_overlap=1.0027 corr_cb=0.3034
[EPOCH 007/089] train: loss=1.4407 acc=63.77% | val: loss=0.6459 acc=70.97% f1=50.00% auc=68.00% val_score=89.2561 val_score_bestthr=94.9540 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.454, mb=0.396, no=1.003, corr=0.303) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 90.6047 -> 89.2561
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4477 mb_mean=0.3793 norm_overlap=1.0025 corr_cb=0.2742 topkJ=0.1343
[TRAIN][ep=008] loss=1.0205 acc=63.77%
[TRAIN][ep=008] mask_avg: mc_mean=0.4423 mb_mean=0.3574 norm_overlap=1.0033 corr_cb=0.2609
[EPOCH 008/089] train: loss=1.0205 acc=63.77% | val: loss=0.6442 acc=72.58% f1=51.43% auc=67.45% val_score=83.5261 val_score_bestthr=97.2806 | dyn(w_pfs=0.290, w_sup=0.190, w_csuf=0.140, stage2=False) | mask(mc=0.442, mb=0.357, no=1.003, corr=0.261) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 90.6047 -> 83.5261
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4351 mb_mean=0.3291 norm_overlap=1.0019 corr_cb=0.1501 topkJ=0.1402
[TRAIN][ep=009] loss=1.1800 acc=63.77%
[TRAIN][ep=009] mask_avg: mc_mean=0.4307 mb_mean=0.3267 norm_overlap=1.0027 corr_cb=0.1414
[EPOCH 009/089] train: loss=1.1800 acc=63.77% | val: loss=0.6437 acc=69.35% f1=42.42% auc=67.34% val_score=82.4064 val_score_bestthr=89.5659 | dyn(w_pfs=0.330, w_sup=0.230, w_csuf=0.180, stage2=False) | mask(mc=0.431, mb=0.327, no=1.003, corr=0.141) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 90.6047 -> 82.4064
[DBG][ep=010] disease_pos_weight=1.0000 mode=none
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.4268 mb_mean=0.3007 norm_overlap=1.0041 corr_cb=0.1675 topkJ=0.0668
[TRAIN][ep=010] loss=1.3385 acc=63.77%
[TRAIN][ep=010] mask_avg: mc_mean=0.4194 mb_mean=0.3038 norm_overlap=0.9991 corr_cb=-0.0392
[EPOCH 010/089] train: loss=1.3385 acc=63.77% | val: loss=0.6414 acc=69.35% f1=38.71% auc=67.89% val_score=87.5853 val_score_bestthr=87.7068 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.419, mb=0.304, no=0.999, corr=-0.039) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 90.6047 -> 87.5853
[DBG][ep=011] disease_pos_weight=1.0000 mode=none
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.4143 mb_mean=0.2937 norm_overlap=0.9967 corr_cb=-0.1039 topkJ=0.0373
[TRAIN][ep=011] loss=1.4153 acc=63.77%
[TRAIN][ep=011] mask_avg: mc_mean=0.4085 mb_mean=0.2876 norm_overlap=0.9911 corr_cb=-0.2414
[EPOCH 011/089] train: loss=1.4153 acc=63.77% | val: loss=0.6411 acc=69.35% f1=38.71% auc=67.56% val_score=82.1772 val_score_bestthr=87.7068 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.408, mb=0.288, no=0.991, corr=-0.241) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 90.6047 -> 82.1772
[DBG][ep=012] disease_pos_weight=1.0000 mode=none
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.4066 mb_mean=0.2856 norm_overlap=0.9863 corr_cb=-0.3414 topkJ=0.0100
[TRAIN][ep=012] loss=1.4077 acc=63.77%
[TRAIN][ep=012] mask_avg: mc_mean=0.3980 mb_mean=0.2760 norm_overlap=0.9759 corr_cb=-0.4477
[EPOCH 012/089] train: loss=1.4077 acc=63.77% | val: loss=0.6406 acc=69.35% f1=34.48% auc=66.33% val_score=87.6274 val_score_bestthr=85.5296 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.398, mb=0.276, no=0.976, corr=-0.448) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 90.6047 -> 87.6274
[DBG][ep=013] disease_pos_weight=1.0000 mode=none
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.3882 mb_mean=0.2628 norm_overlap=0.9644 corr_cb=-0.4559 topkJ=0.0000
[TRAIN][ep=013] loss=1.3923 acc=63.77%
[TRAIN][ep=013] mask_avg: mc_mean=0.3870 mb_mean=0.2669 norm_overlap=0.9526 corr_cb=-0.6064
[EPOCH 013/089] train: loss=1.3923 acc=63.77% | val: loss=0.6374 acc=69.35% f1=38.71% auc=66.00% val_score=73.9149 val_score_bestthr=87.7578 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.387, mb=0.267, no=0.953, corr=-0.606) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 90.6047 -> 73.9149
[DBG][ep=014] disease_pos_weight=1.0000 mode=none
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.3886 mb_mean=0.2754 norm_overlap=0.9528 corr_cb=-0.6520 topkJ=0.0000
[TRAIN][ep=014] loss=0.9794 acc=63.77%
[TRAIN][ep=014] mask_avg: mc_mean=0.3756 mb_mean=0.2603 norm_overlap=0.9188 corr_cb=-0.7175
[EPOCH 014/089] train: loss=0.9794 acc=63.77% | val: loss=0.6347 acc=70.97% f1=40.00% auc=66.78% val_score=82.1147 val_score_bestthr=89.9892 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.376, mb=0.260, no=0.919, corr=-0.717) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 90.6047 -> 82.1147
[DBG][ep=015] disease_pos_weight=1.0000 mode=none
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.3677 mb_mean=0.2687 norm_overlap=0.9127 corr_cb=-0.7164 topkJ=0.0000
[TRAIN][ep=015] loss=0.5637 acc=64.13%
[TRAIN][ep=015] mask_avg: mc_mean=0.3654 mb_mean=0.2571 norm_overlap=0.8905 corr_cb=-0.7537
[EPOCH 015/089] train: loss=0.5637 acc=64.13% | val: loss=0.6317 acc=69.35% f1=38.71% auc=66.67% val_score=83.2994 val_score_bestthr=87.7578 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.365, mb=0.257, no=0.890, corr=-0.754) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.6047 -> 83.2994
[DBG][ep=016] disease_pos_weight=1.0000 mode=none
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.3504 mb_mean=0.2777 norm_overlap=0.8616 corr_cb=-0.8312 topkJ=0.0000
[TRAIN][ep=016] loss=0.5283 acc=64.13%
[TRAIN][ep=016] mask_avg: mc_mean=0.3536 mb_mean=0.2571 norm_overlap=0.8640 corr_cb=-0.7705
[EPOCH 016/089] train: loss=0.5283 acc=64.13% | val: loss=0.6290 acc=67.74% f1=37.50% auc=66.56% val_score=84.4096 val_score_bestthr=85.5091 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.354, mb=0.257, no=0.864, corr=-0.771) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.6047 -> 84.4096
[DBG][ep=017] disease_pos_weight=1.0000 mode=none
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.3575 mb_mean=0.2620 norm_overlap=0.8598 corr_cb=-0.8017 topkJ=0.0000
[TRAIN][ep=017] loss=0.5055 acc=65.22%
[TRAIN][ep=017] mask_avg: mc_mean=0.3413 mb_mean=0.2571 norm_overlap=0.8343 corr_cb=-0.7765
[EPOCH 017/089] train: loss=0.5055 acc=65.22% | val: loss=0.6262 acc=67.74% f1=54.55% auc=66.33% val_score=90.8658 val_score_bestthr=94.3280 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.341, mb=0.257, no=0.834, corr=-0.777) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=* 90.6047 -> 90.8658
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=018] disease_pos_weight=1.0000 mode=none
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.3357 mb_mean=0.2675 norm_overlap=0.8278 corr_cb=-0.7768 topkJ=0.0000
[TRAIN][ep=018] loss=0.4934 acc=66.67%
[TRAIN][ep=018] mask_avg: mc_mean=0.3299 mb_mean=0.2571 norm_overlap=0.8050 corr_cb=-0.7813
[EPOCH 018/089] train: loss=0.4934 acc=66.67% | val: loss=0.6236 acc=67.74% f1=47.37% auc=65.22% val_score=84.4119 val_score_bestthr=90.3925 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.330, mb=0.257, no=0.805, corr=-0.781) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.8658 -> 84.4119
[DBG][ep=019] disease_pos_weight=1.0000 mode=none
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.3237 mb_mean=0.2314 norm_overlap=0.7264 corr_cb=-0.8005 topkJ=0.0000
[TRAIN][ep=019] loss=0.4807 acc=67.57%
[TRAIN][ep=019] mask_avg: mc_mean=0.3192 mb_mean=0.2571 norm_overlap=0.7744 corr_cb=-0.7872
[EPOCH 019/089] train: loss=0.4807 acc=67.57% | val: loss=0.6213 acc=67.74% f1=37.50% auc=65.66% val_score=84.5017 val_score_bestthr=85.5091 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.319, mb=0.257, no=0.774, corr=-0.787) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.8658 -> 84.5017
[DBG][ep=020] disease_pos_weight=1.0000 mode=none
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.3222 mb_mean=0.2654 norm_overlap=0.7302 corr_cb=-0.8610 topkJ=0.0000
[TRAIN][ep=020] loss=0.4680 acc=74.64%
[TRAIN][ep=020] mask_avg: mc_mean=0.3112 mb_mean=0.2571 norm_overlap=0.7515 corr_cb=-0.7870
[EPOCH 020/089] train: loss=0.4680 acc=74.64% | val: loss=0.6275 acc=69.35% f1=38.71% auc=64.77% val_score=86.6193 val_score_bestthr=87.7578 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.311, mb=0.257, no=0.752, corr=-0.787) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.8658 -> 86.6193
[DBG][ep=021] disease_pos_weight=1.0000 mode=none
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.3047 mb_mean=0.2658 norm_overlap=0.7283 corr_cb=-0.8395 topkJ=0.0000
[TRAIN][ep=021] loss=0.4575 acc=69.93%
[TRAIN][ep=021] mask_avg: mc_mean=0.3041 mb_mean=0.2571 norm_overlap=0.7258 corr_cb=-0.7903
[EPOCH 021/089] train: loss=0.4575 acc=69.93% | val: loss=0.6197 acc=67.74% f1=37.50% auc=65.44% val_score=86.5843 val_score_bestthr=85.5091 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.304, mb=0.257, no=0.726, corr=-0.790) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.8658 -> 86.5843
[DBG][ep=022] disease_pos_weight=1.0000 mode=none
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2918 mb_mean=0.2634 norm_overlap=0.7146 corr_cb=-0.8141 topkJ=0.0000
[TRAIN][ep=022] loss=0.4491 acc=73.01%
[TRAIN][ep=022] mask_avg: mc_mean=0.2981 mb_mean=0.2571 norm_overlap=0.7063 corr_cb=-0.7871
[EPOCH 022/089] train: loss=0.4491 acc=73.01% | val: loss=0.6218 acc=67.74% f1=37.50% auc=65.55% val_score=86.5843 val_score_bestthr=85.5091 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.298, mb=0.257, no=0.706, corr=-0.787) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.8658 -> 86.5843
[DBG][ep=023] disease_pos_weight=1.0000 mode=none
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2985 mb_mean=0.2564 norm_overlap=0.7118 corr_cb=-0.7799 topkJ=0.0000
[TRAIN][ep=023] loss=0.4377 acc=75.36%
[TRAIN][ep=023] mask_avg: mc_mean=0.2937 mb_mean=0.2572 norm_overlap=0.6891 corr_cb=-0.7899
[EPOCH 023/089] train: loss=0.4377 acc=75.36% | val: loss=0.6224 acc=67.74% f1=37.50% auc=65.22% val_score=87.0667 val_score_bestthr=85.5091 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.294, mb=0.257, no=0.689, corr=-0.790) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.8658 -> 87.0667
[DBG][ep=024] disease_pos_weight=1.0000 mode=none
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.3048 mb_mean=0.2598 norm_overlap=0.6895 corr_cb=-0.8229 topkJ=0.0000
[TRAIN][ep=024] loss=0.4276 acc=74.64%
[TRAIN][ep=024] mask_avg: mc_mean=0.2893 mb_mean=0.2572 norm_overlap=0.6678 corr_cb=-0.7956
[EPOCH 024/089] train: loss=0.4276 acc=74.64% | val: loss=0.6286 acc=67.74% f1=37.50% auc=63.66% val_score=81.2832 val_score_bestthr=85.5091 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.289, mb=0.257, no=0.668, corr=-0.796) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.8658 -> 81.2832
[DBG][ep=025] disease_pos_weight=1.0000 mode=none
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2659 mb_mean=0.2494 norm_overlap=0.7036 corr_cb=-0.6911 topkJ=0.0000
[TRAIN][ep=025] loss=0.4167 acc=75.00%
[TRAIN][ep=025] mask_avg: mc_mean=0.2852 mb_mean=0.2572 norm_overlap=0.6522 corr_cb=-0.7952
[EPOCH 025/089] train: loss=0.4167 acc=75.00% | val: loss=0.6372 acc=67.74% f1=23.08% auc=63.43% val_score=81.5779 val_score_bestthr=78.4626 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.285, mb=0.257, no=0.652, corr=-0.795) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.8658 -> 81.5779
[DBG][ep=026] disease_pos_weight=1.0000 mode=none
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2770 mb_mean=0.2643 norm_overlap=0.5951 corr_cb=-0.8502 topkJ=0.0000
[TRAIN][ep=026] loss=0.4080 acc=77.17%
[TRAIN][ep=026] mask_avg: mc_mean=0.2816 mb_mean=0.2571 norm_overlap=0.6382 corr_cb=-0.7958
[EPOCH 026/089] train: loss=0.4080 acc=77.17% | val: loss=0.6353 acc=69.35% f1=34.48% auc=62.76% val_score=84.2453 val_score_bestthr=85.9749 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.282, mb=0.257, no=0.638, corr=-0.796) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.8658 -> 84.2453
[DBG][ep=027] disease_pos_weight=1.0000 mode=none
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2500 mb_mean=0.2495 norm_overlap=0.6363 corr_cb=-0.7037 topkJ=0.0000
[TRAIN][ep=027] loss=0.4004 acc=75.91%
[TRAIN][ep=027] mask_avg: mc_mean=0.2782 mb_mean=0.2571 norm_overlap=0.6246 corr_cb=-0.7951
[EPOCH 027/089] train: loss=0.4004 acc=75.91% | val: loss=0.6494 acc=67.74% f1=37.50% auc=63.43% val_score=79.6125 val_score_bestthr=85.4359 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.278, mb=0.257, no=0.625, corr=-0.795) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.8658 -> 79.6125
[DBG][ep=028] disease_pos_weight=1.0000 mode=none
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2698 mb_mean=0.2652 norm_overlap=0.6173 corr_cb=-0.8143 topkJ=0.0000
[TRAIN][ep=028] loss=0.3883 acc=78.99%
[TRAIN][ep=028] mask_avg: mc_mean=0.2747 mb_mean=0.2572 norm_overlap=0.6123 corr_cb=-0.7942
[EPOCH 028/089] train: loss=0.3883 acc=78.99% | val: loss=0.6546 acc=67.74% f1=28.57% auc=62.65% val_score=83.4658 val_score_bestthr=81.3680 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.275, mb=0.257, no=0.612, corr=-0.794) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.8658 -> 83.4658
[DBG][ep=029] disease_pos_weight=1.0000 mode=none
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2814 mb_mean=0.2505 norm_overlap=0.6350 corr_cb=-0.7468 topkJ=0.0000
[TRAIN][ep=029] loss=0.3780 acc=80.07%
[TRAIN][ep=029] mask_avg: mc_mean=0.2709 mb_mean=0.2572 norm_overlap=0.6011 corr_cb=-0.7926
[EPOCH 029/089] train: loss=0.3780 acc=80.07% | val: loss=0.6699 acc=69.35% f1=34.48% auc=62.10% val_score=80.3165 val_score_bestthr=85.9749 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.271, mb=0.257, no=0.601, corr=-0.793) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.8658 -> 80.3165
[DBG][ep=030] disease_pos_weight=1.0000 mode=none
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2600 mb_mean=0.2647 norm_overlap=0.6413 corr_cb=-0.7590 topkJ=0.0000
[TRAIN][ep=030] loss=0.3713 acc=78.44%
[TRAIN][ep=030] mask_avg: mc_mean=0.2678 mb_mean=0.2571 norm_overlap=0.5921 corr_cb=-0.7872
[EPOCH 030/089] train: loss=0.3713 acc=78.44% | val: loss=0.6761 acc=69.35% f1=34.48% auc=61.65% val_score=80.3165 val_score_bestthr=85.9749 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.268, mb=0.257, no=0.592, corr=-0.787) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.8658 -> 80.3165
[DBG][ep=031] disease_pos_weight=1.0000 mode=none
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2455 mb_mean=0.2536 norm_overlap=0.5865 corr_cb=-0.7427 topkJ=0.0000
[TRAIN][ep=031] loss=0.3581 acc=79.35%
[TRAIN][ep=031] mask_avg: mc_mean=0.2669 mb_mean=0.2571 norm_overlap=0.5840 corr_cb=-0.7912
[EPOCH 031/089] train: loss=0.3581 acc=79.35% | val: loss=0.6685 acc=67.74% f1=33.33% auc=62.21% val_score=87.1500 val_score_bestthr=83.8111 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.267, mb=0.257, no=0.584, corr=-0.791) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.8658 -> 87.1500
[DBG][ep=032] disease_pos_weight=1.0000 mode=none
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2870 mb_mean=0.2495 norm_overlap=0.5162 corr_cb=-0.8309 topkJ=0.0000
[TRAIN][ep=032] loss=0.3537 acc=80.43%
[TRAIN][ep=032] mask_avg: mc_mean=0.2669 mb_mean=0.2572 norm_overlap=0.5843 corr_cb=-0.7923
[EPOCH 032/089] train: loss=0.3537 acc=80.43% | val: loss=0.6699 acc=69.35% f1=34.48% auc=61.98% val_score=86.4757 val_score_bestthr=85.9749 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.267, mb=0.257, no=0.584, corr=-0.792) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.8658 -> 86.4757
[DBG][ep=033] disease_pos_weight=1.0000 mode=none
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2573 mb_mean=0.2699 norm_overlap=0.6561 corr_cb=-0.7742 topkJ=0.0000
[TRAIN][ep=033] loss=0.3523 acc=80.25%
[TRAIN][ep=033] mask_avg: mc_mean=0.2669 mb_mean=0.2571 norm_overlap=0.5836 corr_cb=-0.7930
[EPOCH 033/089] train: loss=0.3523 acc=80.25% | val: loss=0.6721 acc=69.35% f1=34.48% auc=61.87% val_score=86.4757 val_score_bestthr=85.9749 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.267, mb=0.257, no=0.584, corr=-0.793) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.8658 -> 86.4757
[DBG][ep=034] disease_pos_weight=1.0000 mode=none
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2593 mb_mean=0.2748 norm_overlap=0.6296 corr_cb=-0.7987 topkJ=0.0000
[TRAIN][ep=034] loss=0.3495 acc=80.62%
[TRAIN][ep=034] mask_avg: mc_mean=0.2669 mb_mean=0.2572 norm_overlap=0.5843 corr_cb=-0.7913
[EPOCH 034/089] train: loss=0.3495 acc=80.62% | val: loss=0.6745 acc=67.74% f1=28.57% auc=62.21% val_score=84.2786 val_score_bestthr=81.3680 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.267, mb=0.257, no=0.584, corr=-0.791) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.8658 -> 84.2786
[DBG][ep=035] disease_pos_weight=1.0000 mode=none
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2689 mb_mean=0.2486 norm_overlap=0.5203 corr_cb=-0.8006 topkJ=0.0000
[TRAIN][ep=035] loss=0.3479 acc=80.62%
[TRAIN][ep=035] mask_avg: mc_mean=0.2669 mb_mean=0.2571 norm_overlap=0.5838 corr_cb=-0.7922
[EPOCH 035/089] train: loss=0.3479 acc=80.62% | val: loss=0.6745 acc=67.74% f1=33.33% auc=62.21% val_score=86.4757 val_score_bestthr=83.8111 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.267, mb=0.257, no=0.584, corr=-0.792) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.8658 -> 86.4757
[DBG][ep=036] disease_pos_weight=1.0000 mode=none
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2554 mb_mean=0.2442 norm_overlap=0.5815 corr_cb=-0.7262 topkJ=0.0000
[TRAIN][ep=036] loss=0.3454 acc=80.80%
[TRAIN][ep=036] mask_avg: mc_mean=0.2669 mb_mean=0.2571 norm_overlap=0.5833 corr_cb=-0.7934
[EPOCH 036/089] train: loss=0.3454 acc=80.80% | val: loss=0.6774 acc=67.74% f1=33.33% auc=61.98% val_score=86.4757 val_score_bestthr=83.8111 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.267, mb=0.257, no=0.583, corr=-0.793) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.8658 -> 86.4757
[DBG][ep=037] disease_pos_weight=1.0000 mode=none
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.2682 mb_mean=0.2386 norm_overlap=0.5070 corr_cb=-0.7766 topkJ=0.0000
[TRAIN][ep=037] loss=0.3445 acc=81.16%
[TRAIN][ep=037] mask_avg: mc_mean=0.2669 mb_mean=0.2571 norm_overlap=0.5835 corr_cb=-0.7926
[EPOCH 037/089] train: loss=0.3445 acc=81.16% | val: loss=0.6788 acc=69.35% f1=38.71% auc=62.10% val_score=86.4757 val_score_bestthr=88.1377 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.267, mb=0.257, no=0.583, corr=-0.793) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.8658 -> 86.4757
[DBG][ep=038] disease_pos_weight=1.0000 mode=none
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2696 mb_mean=0.2726 norm_overlap=0.6642 corr_cb=-0.8164 topkJ=0.0000
[TRAIN][ep=038] loss=0.3426 acc=80.98%
[TRAIN][ep=038] mask_avg: mc_mean=0.2669 mb_mean=0.2571 norm_overlap=0.5838 corr_cb=-0.7920
[EPOCH 038/089] train: loss=0.3426 acc=80.98% | val: loss=0.6812 acc=69.35% f1=38.71% auc=62.10% val_score=87.1500 val_score_bestthr=88.1377 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.267, mb=0.257, no=0.584, corr=-0.792) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.8658 -> 87.1500
[DBG][ep=039] disease_pos_weight=1.0000 mode=none
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2639 mb_mean=0.2534 norm_overlap=0.5570 corr_cb=-0.7991 topkJ=0.0000
[TRAIN][ep=039] loss=0.3401 acc=80.80%
[TRAIN][ep=039] mask_avg: mc_mean=0.2669 mb_mean=0.2571 norm_overlap=0.5837 corr_cb=-0.7921
[EPOCH 039/089] train: loss=0.3401 acc=80.80% | val: loss=0.6828 acc=69.35% f1=38.71% auc=61.76% val_score=86.4757 val_score_bestthr=88.1377 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.267, mb=0.257, no=0.584, corr=-0.792) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.8658 -> 86.4757
[DBG][ep=040] disease_pos_weight=1.0000 mode=none
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.2806 mb_mean=0.2603 norm_overlap=0.5339 corr_cb=-0.8487 topkJ=0.0000
[TRAIN][ep=040] loss=0.3390 acc=80.62%
[TRAIN][ep=040] mask_avg: mc_mean=0.2669 mb_mean=0.2571 norm_overlap=0.5840 corr_cb=-0.7911
[EPOCH 040/089] train: loss=0.3390 acc=80.62% | val: loss=0.6845 acc=69.35% f1=38.71% auc=61.87% val_score=84.2786 val_score_bestthr=88.1377 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.267, mb=0.257, no=0.584, corr=-0.791) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.8658 -> 84.2786
[DBG][ep=041] disease_pos_weight=1.0000 mode=none
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.2743 mb_mean=0.2549 norm_overlap=0.5435 corr_cb=-0.8272 topkJ=0.0000
[TRAIN][ep=041] loss=0.3362 acc=81.52%
[TRAIN][ep=041] mask_avg: mc_mean=0.2669 mb_mean=0.2572 norm_overlap=0.5832 corr_cb=-0.7918
[EPOCH 041/089] train: loss=0.3362 acc=81.52% | val: loss=0.6854 acc=69.35% f1=38.71% auc=61.98% val_score=84.2786 val_score_bestthr=88.1377 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.267, mb=0.257, no=0.583, corr=-0.792) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.8658 -> 84.2786
[DBG][ep=042] disease_pos_weight=1.0000 mode=none
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.2664 mb_mean=0.2525 norm_overlap=0.6222 corr_cb=-0.7446 topkJ=0.0000
[TRAIN][ep=042] loss=0.3355 acc=81.34%
[TRAIN][ep=042] mask_avg: mc_mean=0.2669 mb_mean=0.2571 norm_overlap=0.5836 corr_cb=-0.7926
[EPOCH 042/089] train: loss=0.3355 acc=81.34% | val: loss=0.6883 acc=67.74% f1=41.18% auc=61.98% val_score=84.2786 val_score_bestthr=87.3729 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.267, mb=0.257, no=0.584, corr=-0.793) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.8658 -> 84.2786
[DBG][ep=043] disease_pos_weight=1.0000 mode=none
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.2740 mb_mean=0.2697 norm_overlap=0.5605 corr_cb=-0.8715 topkJ=0.0000
[TRAIN][ep=043] loss=0.3328 acc=82.07%
[TRAIN][ep=043] mask_avg: mc_mean=0.2669 mb_mean=0.2571 norm_overlap=0.5839 corr_cb=-0.7909
[EPOCH 043/089] train: loss=0.3328 acc=82.07% | val: loss=0.6894 acc=69.35% f1=38.71% auc=62.10% val_score=86.4757 val_score_bestthr=88.1377 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.267, mb=0.257, no=0.584, corr=-0.791) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.8658 -> 86.4757
[DBG][ep=044] disease_pos_weight=1.0000 mode=none
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2679 mb_mean=0.2534 norm_overlap=0.5932 corr_cb=-0.7652 topkJ=0.0000
[TRAIN][ep=044] loss=0.3317 acc=82.07%
[TRAIN][ep=044] mask_avg: mc_mean=0.2669 mb_mean=0.2571 norm_overlap=0.5837 corr_cb=-0.7918
[EPOCH 044/089] train: loss=0.3317 acc=82.07% | val: loss=0.6908 acc=69.35% f1=42.42% auc=62.10% val_score=84.2786 val_score_bestthr=89.6373 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.267, mb=0.257, no=0.584, corr=-0.792) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.8658 -> 84.2786
[DBG][ep=045] disease_pos_weight=1.0000 mode=none
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2631 mb_mean=0.2481 norm_overlap=0.4679 corr_cb=-0.8062 topkJ=0.0000
[TRAIN][ep=045] loss=0.3307 acc=80.98%
[TRAIN][ep=045] mask_avg: mc_mean=0.2669 mb_mean=0.2572 norm_overlap=0.5840 corr_cb=-0.7916
[EPOCH 045/089] train: loss=0.3307 acc=80.98% | val: loss=0.6929 acc=69.35% f1=42.42% auc=62.21% val_score=83.4658 val_score_bestthr=89.6373 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.267, mb=0.257, no=0.584, corr=-0.792) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.8658 -> 83.4658
[DBG][ep=046] disease_pos_weight=1.0000 mode=none
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.2465 mb_mean=0.2607 norm_overlap=0.5951 corr_cb=-0.7700 topkJ=0.0000
[TRAIN][ep=046] loss=0.3299 acc=81.34%
[TRAIN][ep=046] mask_avg: mc_mean=0.2669 mb_mean=0.2571 norm_overlap=0.5839 corr_cb=-0.7922
[EPOCH 046/089] train: loss=0.3299 acc=81.34% | val: loss=0.6949 acc=69.35% f1=42.42% auc=61.98% val_score=84.2786 val_score_bestthr=89.6373 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.267, mb=0.257, no=0.584, corr=-0.792) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.8658 -> 84.2786
[DBG][ep=047] disease_pos_weight=1.0000 mode=none
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.2695 mb_mean=0.2493 norm_overlap=0.5652 corr_cb=-0.7803 topkJ=0.0000
[TRAIN][ep=047] loss=0.3261 acc=82.43%
[TRAIN][ep=047] mask_avg: mc_mean=0.2669 mb_mean=0.2571 norm_overlap=0.5840 corr_cb=-0.7913
[EPOCH 047/089] train: loss=0.3261 acc=82.43% | val: loss=0.6971 acc=69.35% f1=38.71% auc=62.10% val_score=83.4658 val_score_bestthr=88.1377 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.267, mb=0.257, no=0.584, corr=-0.791) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.8658 -> 83.4658
[EARLY STOP] no improvement for 30 epochs. best_epoch=17
[CKPT] Loaded best for testing: results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
=============== FIT DONE ===============
[BEST] epoch=17 | val_acc=67.74% | val_f1=54.55% | val_auc=66.33% | val_score=90.8658 | val_score_bestthr=94.3280
[TEST@BEST] thr_used=0.440 | acc=65.36% f1=20.90% auc=58.39% | SP_sex=6.34% EO_sex=3.76% SP_age=7.95% EO_age=9.31%
[TIME] 0.77 min
[OK] Saved: results/ADHD_3x5fold_seed0/fold2_rep0_seed2/summary_fold_2.json
[DBG][ep=000] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4784 mb_mean=0.5063 norm_overlap=0.9999 corr_cb=-0.0928 topkJ=0.0294
[TRAIN][ep=000] loss=0.6836 acc=63.77%
[TRAIN][ep=000] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0078
[DBG][ep=001] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4808 mb_mean=0.5078 norm_overlap=0.9999 corr_cb=-0.1127 topkJ=0.0310
[TRAIN][ep=001] loss=0.6811 acc=63.77%
[TRAIN][ep=001] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0102
[DBG][ep=002] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4792 mb_mean=0.5067 norm_overlap=1.0000 corr_cb=0.0224 topkJ=0.0484
[TRAIN][ep=002] loss=0.6800 acc=63.77%
[TRAIN][ep=002] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0054
[DBG][ep=003] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4787 mb_mean=0.5076 norm_overlap=0.9997 corr_cb=-0.3063 topkJ=0.0248
[TRAIN][ep=003] loss=0.6786 acc=63.77%
[TRAIN][ep=003] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0074
[DBG][ep=004] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4810 mb_mean=0.5098 norm_overlap=1.0000 corr_cb=0.0354 topkJ=0.0553
[TRAIN][ep=004] loss=0.6767 acc=63.77%
[TRAIN][ep=004] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0056
[DBG][ep=005] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4798 mb_mean=0.5070 norm_overlap=1.0000 corr_cb=-0.0288 topkJ=0.0211
[TRAIN][ep=005] loss=0.6733 acc=63.77%
[TRAIN][ep=005] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0076
[DBG][ep=006] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4802 mb_mean=0.5083 norm_overlap=1.0001 corr_cb=0.0978 topkJ=0.0511
[TRAIN][ep=006] loss=0.6696 acc=63.41%
[TRAIN][ep=006] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0103
[DBG][ep=007] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4799 mb_mean=0.5072 norm_overlap=1.0000 corr_cb=-0.0156 topkJ=0.0413
[TRAIN][ep=007] loss=0.6621 acc=65.22%
[TRAIN][ep=007] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0058
[DBG][ep=008] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4788 mb_mean=0.5063 norm_overlap=0.9999 corr_cb=-0.1226 topkJ=0.0341
[TRAIN][ep=008] loss=0.6556 acc=64.49%
[TRAIN][ep=008] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0077
[DBG][ep=009] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4796 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=0.0434 topkJ=0.0713
[TRAIN][ep=009] loss=0.6437 acc=68.48%
[TRAIN][ep=009] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0082
================= FIT START (fold=2) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4807 mb_mean=0.5078 norm_overlap=1.0000 corr_cb=0.0284 topkJ=0.0655
[TRAIN][ep=000] loss=0.6348 acc=69.75%
[TRAIN][ep=000] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0057
[EPOCH 000/089] train: loss=0.6348 acc=69.75% | val: loss=0.6260 acc=72.58% f1=45.16% auc=68.12% val_score=57.2955 val_score_bestthr=57.2955 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.480, mb=0.508, no=1.000, corr=-0.006) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 57.2955
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=001] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4809 mb_mean=0.5072 norm_overlap=1.0001 corr_cb=0.1026 topkJ=0.1054
[TRAIN][ep=001] loss=0.6263 acc=69.38%
[TRAIN][ep=001] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0084
[EPOCH 001/089] train: loss=0.6263 acc=69.38% | val: loss=0.6305 acc=61.29% f1=45.45% auc=66.67% val_score=50.3806 val_score_bestthr=55.3947 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.480, mb=0.508, no=1.000, corr=-0.008) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 57.2955 -> 55.3947
[DBG][ep=002] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4802 mb_mean=0.5075 norm_overlap=1.0000 corr_cb=0.0222 topkJ=0.0557
[TRAIN][ep=002] loss=0.6215 acc=70.11%
[TRAIN][ep=002] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0048
[EPOCH 002/089] train: loss=0.6215 acc=70.11% | val: loss=0.6331 acc=62.90% f1=0.00% auc=67.34% val_score=53.9501 val_score_bestthr=62.9032 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.480, mb=0.508, no=1.000, corr=-0.005) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 57.2955 -> 62.9032
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
[DBG][ep=003] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4773 mb_mean=0.5082 norm_overlap=1.0001 corr_cb=0.1498 topkJ=0.1079
[TRAIN][ep=003] loss=0.6116 acc=70.65%
[TRAIN][ep=003] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0071
[EPOCH 003/089] train: loss=0.6116 acc=70.65% | val: loss=0.6277 acc=62.90% f1=46.51% auc=67.67% val_score=53.9501 val_score_bestthr=58.2523 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.480, mb=0.508, no=1.000, corr=-0.007) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 58.2523
[DBG][ep=004] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4801 mb_mean=0.5075 norm_overlap=0.9999 corr_cb=-0.1147 topkJ=0.0525
[TRAIN][ep=004] loss=0.6034 acc=72.83%
[TRAIN][ep=004] mask_avg: mc_mean=0.4797 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0086
[EPOCH 004/089] train: loss=0.6034 acc=72.83% | val: loss=0.6139 acc=64.52% f1=47.62% auc=68.23% val_score=51.0806 val_score_bestthr=59.6899 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.480, mb=0.508, no=1.000, corr=-0.009) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 59.6899
[DBG][ep=005] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4786 mb_mean=0.5078 norm_overlap=1.0001 corr_cb=0.1409 topkJ=0.1263
[TRAIN][ep=005] loss=1.2376 acc=67.93%
[TRAIN][ep=005] mask_avg: mc_mean=0.4773 mb_mean=0.5079 norm_overlap=1.0002 corr_cb=0.2124
[EPOCH 005/089] train: loss=1.2376 acc=67.93% | val: loss=0.6207 acc=64.52% f1=47.62% auc=66.78% val_score=50.0812 val_score_bestthr=59.6899 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.477, mb=0.508, no=1.000, corr=0.212) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 59.6899
[DBG][ep=006] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4731 mb_mean=0.5071 norm_overlap=1.0007 corr_cb=0.4804 topkJ=0.1308
[TRAIN][ep=006] loss=1.1732 acc=74.09%
[TRAIN][ep=006] mask_avg: mc_mean=0.4722 mb_mean=0.5079 norm_overlap=1.0003 corr_cb=0.2322
[EPOCH 006/089] train: loss=1.1732 acc=74.09% | val: loss=0.6284 acc=64.52% f1=47.62% auc=67.34% val_score=50.0614 val_score_bestthr=59.6899 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.472, mb=0.508, no=1.000, corr=0.232) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 59.6899
[DBG][ep=007] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4703 mb_mean=0.5086 norm_overlap=1.0001 corr_cb=0.1190 topkJ=0.0838
[TRAIN][ep=007] loss=1.1615 acc=74.46%
[TRAIN][ep=007] mask_avg: mc_mean=0.4666 mb_mean=0.5079 norm_overlap=1.0004 corr_cb=0.2270
[EPOCH 007/089] train: loss=1.1615 acc=74.46% | val: loss=0.6198 acc=64.52% f1=47.62% auc=68.23% val_score=46.8216 val_score_bestthr=59.6899 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.467, mb=0.508, no=1.000, corr=0.227) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 59.6899
[DBG][ep=008] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4641 mb_mean=0.5094 norm_overlap=1.0001 corr_cb=0.1189 topkJ=0.0685
[TRAIN][ep=008] loss=0.9472 acc=77.90%
[TRAIN][ep=008] mask_avg: mc_mean=0.4616 mb_mean=0.5079 norm_overlap=1.0004 corr_cb=0.1961
[EPOCH 008/089] train: loss=0.9472 acc=77.90% | val: loss=0.6143 acc=64.52% f1=47.62% auc=68.34% val_score=46.8216 val_score_bestthr=59.6899 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.462, mb=0.508, no=1.000, corr=0.196) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 59.6899
[DBG][ep=009] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4587 mb_mean=0.5067 norm_overlap=1.0003 corr_cb=0.1688 topkJ=0.1602
[TRAIN][ep=009] loss=0.7400 acc=77.36%
[TRAIN][ep=009] mask_avg: mc_mean=0.4550 mb_mean=0.5079 norm_overlap=1.0005 corr_cb=0.2066
[EPOCH 009/089] train: loss=0.7400 acc=77.36% | val: loss=0.6129 acc=59.68% f1=63.77% auc=67.89% val_score=57.9141 val_score_bestthr=61.0880 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.455, mb=0.508, no=1.000, corr=0.207) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 61.0880
[DBG][ep=010] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.4538 mb_mean=0.5087 norm_overlap=1.0006 corr_cb=0.2773 topkJ=0.1318
[TRAIN][ep=010] loss=0.6885 acc=76.81%
[TRAIN][ep=010] mask_avg: mc_mean=0.4489 mb_mean=0.5079 norm_overlap=1.0004 corr_cb=0.1731
[EPOCH 010/089] train: loss=0.6885 acc=76.81% | val: loss=0.6116 acc=64.52% f1=45.00% auc=67.67% val_score=57.9141 val_score_bestthr=57.9141 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.449, mb=0.508, no=1.000, corr=0.173) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 57.9141
[DBG][ep=011] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.4455 mb_mean=0.5088 norm_overlap=1.0001 corr_cb=0.0333 topkJ=0.0769
[TRAIN][ep=011] loss=0.6654 acc=77.90%
[TRAIN][ep=011] mask_avg: mc_mean=0.4406 mb_mean=0.5079 norm_overlap=1.0006 corr_cb=0.1818
[EPOCH 011/089] train: loss=0.6654 acc=77.90% | val: loss=0.6231 acc=58.06% f1=62.86% auc=67.56% val_score=54.0417 val_score_bestthr=60.7470 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.441, mb=0.508, no=1.001, corr=0.182) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 60.7470
[DBG][ep=012] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.4397 mb_mean=0.5079 norm_overlap=1.0008 corr_cb=0.2486 topkJ=0.1487
[TRAIN][ep=012] loss=0.6513 acc=77.72%
[TRAIN][ep=012] mask_avg: mc_mean=0.4341 mb_mean=0.5079 norm_overlap=1.0006 corr_cb=0.1804
[EPOCH 012/089] train: loss=0.6513 acc=77.72% | val: loss=0.6316 acc=64.52% f1=42.11% auc=66.56% val_score=56.4780 val_score_bestthr=57.7051 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.434, mb=0.508, no=1.001, corr=0.180) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 57.7051
[DBG][ep=013] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.4260 mb_mean=0.5097 norm_overlap=1.0015 corr_cb=0.3462 topkJ=0.1875
[TRAIN][ep=013] loss=0.6381 acc=78.08%
[TRAIN][ep=013] mask_avg: mc_mean=0.4264 mb_mean=0.5079 norm_overlap=1.0006 corr_cb=0.1651
[EPOCH 013/089] train: loss=0.6381 acc=78.08% | val: loss=0.6621 acc=66.13% f1=16.00% auc=66.33% val_score=51.3151 val_score_bestthr=57.5705 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.426, mb=0.508, no=1.001, corr=0.165) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 57.5705
[DBG][ep=014] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.4259 mb_mean=0.5087 norm_overlap=1.0006 corr_cb=0.1749 topkJ=0.1280
[TRAIN][ep=014] loss=0.6193 acc=80.43%
[TRAIN][ep=014] mask_avg: mc_mean=0.4175 mb_mean=0.5079 norm_overlap=1.0008 corr_cb=0.1698
[EPOCH 014/089] train: loss=0.6193 acc=80.43% | val: loss=0.6855 acc=66.13% f1=16.00% auc=66.22% val_score=49.8974 val_score_bestthr=57.5705 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.418, mb=0.508, no=1.001, corr=0.170) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 57.5705
[DBG][ep=015] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.4126 mb_mean=0.5076 norm_overlap=1.0008 corr_cb=0.1664 topkJ=0.1622
[TRAIN][ep=015] loss=0.6059 acc=78.62%
[TRAIN][ep=015] mask_avg: mc_mean=0.4121 mb_mean=0.5079 norm_overlap=1.0006 corr_cb=0.1404
[EPOCH 015/089] train: loss=0.6059 acc=78.62% | val: loss=0.7337 acc=66.13% f1=16.00% auc=65.55% val_score=44.5533 val_score_bestthr=57.5705 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.412, mb=0.508, no=1.001, corr=0.140) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 57.5705
[DBG][ep=016] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.4085 mb_mean=0.5064 norm_overlap=1.0000 corr_cb=0.0044 topkJ=0.0450
[TRAIN][ep=016] loss=0.6023 acc=79.89%
[TRAIN][ep=016] mask_avg: mc_mean=0.4029 mb_mean=0.5079 norm_overlap=1.0007 corr_cb=0.1422
[EPOCH 016/089] train: loss=0.6023 acc=79.89% | val: loss=0.7004 acc=66.13% f1=16.00% auc=65.33% val_score=49.9126 val_score_bestthr=57.5705 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.403, mb=0.508, no=1.001, corr=0.142) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 57.5705
[DBG][ep=017] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.4036 mb_mean=0.5079 norm_overlap=1.0005 corr_cb=0.0977 topkJ=0.0905
[TRAIN][ep=017] loss=0.5794 acc=80.80%
[TRAIN][ep=017] mask_avg: mc_mean=0.3961 mb_mean=0.5079 norm_overlap=1.0008 corr_cb=0.1440
[EPOCH 017/089] train: loss=0.5794 acc=80.80% | val: loss=0.6943 acc=67.74% f1=44.44% auc=65.55% val_score=47.8112 val_score_bestthr=62.2570 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.396, mb=0.508, no=1.001, corr=0.144) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 62.2570
[DBG][ep=018] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.3940 mb_mean=0.5097 norm_overlap=1.0002 corr_cb=0.0315 topkJ=0.0575
[TRAIN][ep=018] loss=0.5664 acc=82.07%
[TRAIN][ep=018] mask_avg: mc_mean=0.3888 mb_mean=0.5079 norm_overlap=1.0007 corr_cb=0.1236
[EPOCH 018/089] train: loss=0.5664 acc=82.07% | val: loss=0.7086 acc=64.52% f1=42.11% auc=64.88% val_score=47.8112 val_score_bestthr=59.9506 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.389, mb=0.508, no=1.001, corr=0.124) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 59.9506
[DBG][ep=019] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.3751 mb_mean=0.5077 norm_overlap=1.0020 corr_cb=0.2465 topkJ=0.1370
[TRAIN][ep=019] loss=0.5419 acc=83.70%
[TRAIN][ep=019] mask_avg: mc_mean=0.3815 mb_mean=0.5079 norm_overlap=1.0007 corr_cb=0.1076
[EPOCH 019/089] train: loss=0.5419 acc=83.70% | val: loss=0.7613 acc=64.52% f1=42.11% auc=64.88% val_score=49.8974 val_score_bestthr=59.9506 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.382, mb=0.508, no=1.001, corr=0.108) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 59.9506
[DBG][ep=020] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.3791 mb_mean=0.5066 norm_overlap=0.9999 corr_cb=-0.0199 topkJ=0.0570
[TRAIN][ep=020] loss=0.5326 acc=82.79%
[TRAIN][ep=020] mask_avg: mc_mean=0.3744 mb_mean=0.5079 norm_overlap=1.0007 corr_cb=0.1093
[EPOCH 020/089] train: loss=0.5326 acc=82.79% | val: loss=0.7346 acc=64.52% f1=42.11% auc=64.66% val_score=42.5908 val_score_bestthr=55.8592 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.374, mb=0.508, no=1.001, corr=0.109) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 55.8592
[DBG][ep=021] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.3735 mb_mean=0.5077 norm_overlap=1.0002 corr_cb=0.0332 topkJ=0.0718
[TRAIN][ep=021] loss=0.5160 acc=84.42%
[TRAIN][ep=021] mask_avg: mc_mean=0.3681 mb_mean=0.5079 norm_overlap=1.0006 corr_cb=0.0887
[EPOCH 021/089] train: loss=0.5160 acc=84.42% | val: loss=0.7718 acc=66.13% f1=40.00% auc=63.32% val_score=46.7510 val_score_bestthr=55.4529 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.368, mb=0.508, no=1.001, corr=0.089) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 55.4529
[DBG][ep=022] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.3585 mb_mean=0.5075 norm_overlap=1.0011 corr_cb=0.1677 topkJ=0.0744
[TRAIN][ep=022] loss=0.4968 acc=85.14%
[TRAIN][ep=022] mask_avg: mc_mean=0.3602 mb_mean=0.5079 norm_overlap=1.0007 corr_cb=0.0917
[EPOCH 022/089] train: loss=0.4968 acc=85.14% | val: loss=0.8325 acc=66.13% f1=40.00% auc=64.10% val_score=49.9126 val_score_bestthr=55.4529 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.360, mb=0.508, no=1.001, corr=0.092) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 55.4529
[DBG][ep=023] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.3597 mb_mean=0.5071 norm_overlap=1.0011 corr_cb=0.1506 topkJ=0.0573
[TRAIN][ep=023] loss=0.4895 acc=85.14%
[TRAIN][ep=023] mask_avg: mc_mean=0.3541 mb_mean=0.5079 norm_overlap=1.0005 corr_cb=0.0659
[EPOCH 023/089] train: loss=0.4895 acc=85.14% | val: loss=0.8245 acc=66.13% f1=40.00% auc=62.54% val_score=46.7863 val_score_bestthr=55.4529 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.354, mb=0.508, no=1.001, corr=0.066) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 55.4529
[DBG][ep=024] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.3502 mb_mean=0.5075 norm_overlap=1.0011 corr_cb=0.1468 topkJ=0.0625
[TRAIN][ep=024] loss=0.4800 acc=86.59%
[TRAIN][ep=024] mask_avg: mc_mean=0.3460 mb_mean=0.5079 norm_overlap=1.0006 corr_cb=0.0759
[EPOCH 024/089] train: loss=0.4800 acc=86.59% | val: loss=0.9061 acc=66.13% f1=40.00% auc=62.88% val_score=50.6200 val_score_bestthr=55.4529 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.346, mb=0.508, no=1.001, corr=0.076) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 55.4529
[DBG][ep=025] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.3384 mb_mean=0.5081 norm_overlap=1.0006 corr_cb=0.0755 topkJ=0.1161
[TRAIN][ep=025] loss=0.4631 acc=87.32%
[TRAIN][ep=025] mask_avg: mc_mean=0.3403 mb_mean=0.5079 norm_overlap=1.0004 corr_cb=0.0499
[EPOCH 025/089] train: loss=0.4631 acc=87.32% | val: loss=0.8951 acc=66.13% f1=36.36% auc=62.32% val_score=52.7273 val_score_bestthr=55.5378 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.340, mb=0.508, no=1.000, corr=0.050) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 55.5378
[DBG][ep=026] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.3380 mb_mean=0.5084 norm_overlap=1.0005 corr_cb=0.0707 topkJ=0.0501
[TRAIN][ep=026] loss=0.4414 acc=88.59%
[TRAIN][ep=026] mask_avg: mc_mean=0.3337 mb_mean=0.5079 norm_overlap=1.0005 corr_cb=0.0562
[EPOCH 026/089] train: loss=0.4414 acc=88.59% | val: loss=0.9120 acc=66.13% f1=32.26% auc=63.43% val_score=49.9126 val_score_bestthr=53.6467 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.334, mb=0.508, no=1.000, corr=0.056) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 53.6467
[DBG][ep=027] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.3239 mb_mean=0.5083 norm_overlap=1.0003 corr_cb=0.0314 topkJ=0.0309
[TRAIN][ep=027] loss=0.4453 acc=87.50%
[TRAIN][ep=027] mask_avg: mc_mean=0.3278 mb_mean=0.5079 norm_overlap=1.0002 corr_cb=0.0281
[EPOCH 027/089] train: loss=0.4453 acc=87.50% | val: loss=0.9115 acc=67.74% f1=33.33% auc=62.65% val_score=52.2357 val_score_bestthr=56.9457 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.328, mb=0.508, no=1.000, corr=0.028) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 56.9457
[DBG][ep=028] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.3282 mb_mean=0.5077 norm_overlap=0.9988 corr_cb=-0.1412 topkJ=0.0172
[TRAIN][ep=028] loss=0.4165 acc=89.31%
[TRAIN][ep=028] mask_avg: mc_mean=0.3213 mb_mean=0.5079 norm_overlap=1.0005 corr_cb=0.0455
[EPOCH 028/089] train: loss=0.4165 acc=89.31% | val: loss=0.9814 acc=61.29% f1=47.83% auc=61.98% val_score=49.9126 val_score_bestthr=55.7473 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.321, mb=0.508, no=1.000, corr=0.045) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 55.7473
[DBG][ep=029] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.3213 mb_mean=0.5073 norm_overlap=1.0008 corr_cb=0.0826 topkJ=0.0528
[TRAIN][ep=029] loss=0.4015 acc=91.12%
[TRAIN][ep=029] mask_avg: mc_mean=0.3164 mb_mean=0.5079 norm_overlap=1.0000 corr_cb=-0.0024
[EPOCH 029/089] train: loss=0.4015 acc=91.12% | val: loss=1.0054 acc=61.29% f1=40.00% auc=61.65% val_score=51.3151 val_score_bestthr=54.9131 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.316, mb=0.508, no=1.000, corr=-0.002) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 54.9131
[DBG][ep=030] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.3128 mb_mean=0.5091 norm_overlap=1.0008 corr_cb=0.0832 topkJ=0.0315
[TRAIN][ep=030] loss=0.3911 acc=90.76%
[TRAIN][ep=030] mask_avg: mc_mean=0.3110 mb_mean=0.5079 norm_overlap=0.9999 corr_cb=-0.0056
[EPOCH 030/089] train: loss=0.3911 acc=90.76% | val: loss=1.0678 acc=66.13% f1=32.26% auc=60.65% val_score=52.7273 val_score_bestthr=54.8301 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.311, mb=0.508, no=1.000, corr=-0.006) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 54.8301
[DBG][ep=031] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.3062 mb_mean=0.5078 norm_overlap=0.9977 corr_cb=-0.1880 topkJ=0.0085
[TRAIN][ep=031] loss=0.3701 acc=92.57%
[TRAIN][ep=031] mask_avg: mc_mean=0.3054 mb_mean=0.5079 norm_overlap=0.9999 corr_cb=-0.0103
[EPOCH 031/089] train: loss=0.3701 acc=92.57% | val: loss=1.0706 acc=62.90% f1=48.89% auc=60.65% val_score=54.4391 val_score_bestthr=57.2757 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.305, mb=0.508, no=1.000, corr=-0.010) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 57.2757
[DBG][ep=032] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.3022 mb_mean=0.5067 norm_overlap=0.9986 corr_cb=-0.1063 topkJ=0.0446
[TRAIN][ep=032] loss=0.3638 acc=91.67%
[TRAIN][ep=032] mask_avg: mc_mean=0.3006 mb_mean=0.5079 norm_overlap=0.9998 corr_cb=-0.0130
[EPOCH 032/089] train: loss=0.3638 acc=91.67% | val: loss=1.1209 acc=62.90% f1=48.89% auc=60.31% val_score=49.9126 val_score_bestthr=57.2757 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.301, mb=0.508, no=1.000, corr=-0.013) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 57.2757
[EARLY STOP] no improvement for 30 epochs. best_epoch=2
[CKPT] Loaded best for testing: results/ADHD_3x5fold_seed0/fold2_rep0_seed2/ckpt_best_fold_2.pt
=============== FIT DONE ===============
[BEST] epoch=2 | val_acc=62.90% | val_f1=0.00% | val_auc=67.34% | val_score=53.9501 | val_score_bestthr=62.9032
[TEST@BEST] thr_used=0.510 | acc=66.67% f1=38.55% auc=62.56% | SP_sex=15.32% EO_sex=17.17% SP_age=11.82% EO_age=18.14%
[TIME] 0.52 min
[OK] Saved: results/ADHD_3x5fold_seed0/fold2_rep0_seed2/summary_fold_2.json
