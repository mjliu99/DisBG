[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5144 mb_mean=0.5150 norm_overlap=1.0001 corr_cb=0.1309 topkJ=0.0912
[TRAIN][ep=000] loss=0.7030 acc=36.48%
[TRAIN][ep=000] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2625
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5154 mb_mean=0.5148 norm_overlap=1.0002 corr_cb=0.2404 topkJ=0.1127
[TRAIN][ep=001] loss=0.6861 acc=62.25%
[TRAIN][ep=001] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2578
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5149 mb_mean=0.5167 norm_overlap=1.0008 corr_cb=0.5338 topkJ=0.2907
[TRAIN][ep=002] loss=0.6733 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2599
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5157 mb_mean=0.5166 norm_overlap=1.0002 corr_cb=0.1407 topkJ=0.0837
[TRAIN][ep=003] loss=0.6626 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2572
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5155 mb_mean=0.5150 norm_overlap=1.0006 corr_cb=0.3877 topkJ=0.2261
[TRAIN][ep=004] loss=0.6580 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2563
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5144 mb_mean=0.5149 norm_overlap=1.0005 corr_cb=0.3178 topkJ=0.2069
[TRAIN][ep=005] loss=0.6563 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2581
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5162 mb_mean=0.5152 norm_overlap=1.0006 corr_cb=0.3963 topkJ=0.1808
[TRAIN][ep=006] loss=0.6549 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2561
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5160 mb_mean=0.5163 norm_overlap=1.0003 corr_cb=0.2399 topkJ=0.1667
[TRAIN][ep=007] loss=0.6540 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2581
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5151 mb_mean=0.5161 norm_overlap=1.0002 corr_cb=0.1733 topkJ=0.1150
[TRAIN][ep=008] loss=0.6529 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2604
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5152 mb_mean=0.5142 norm_overlap=1.0003 corr_cb=0.2795 topkJ=0.1008
[TRAIN][ep=009] loss=0.6519 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2576
================= FIT START (fold=1) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.35 select_by=val_score | eval_thr_mode=best_acc eval_thr_grid=coarse | disease_pos_weight_mode=none freeze_b_after=15 | two_stage=True stage1_ratio=0.35 stage2_lr_mult=0.3 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5146 mb_mean=0.5164 norm_overlap=1.0004 corr_cb=0.2841 topkJ=0.1112
[TRAIN][ep=000] loss=0.6509 acc=63.70%
[TRAIN][ep=000] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2587
[EPOCH 000/089] train: loss=0.6509 acc=63.70% | val: loss=0.6618 acc=62.90% f1=0.00% auc=51.17% val_score=75.9222 val_score_bestthr=62.9032 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.515, mb=0.515, no=1.000, corr=0.259) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* -1000000000000000000.0000 -> 75.9222
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5151 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=0.0509 topkJ=0.0799
[TRAIN][ep=001] loss=0.6497 acc=63.70%
[TRAIN][ep=001] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2578
[EPOCH 001/089] train: loss=0.6497 acc=63.70% | val: loss=0.6613 acc=62.90% f1=0.00% auc=51.39% val_score=70.6616 val_score_bestthr=62.9032 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.515, mb=0.515, no=1.000, corr=0.258) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 75.9222 -> 70.6616
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5143 mb_mean=0.5158 norm_overlap=1.0002 corr_cb=0.1856 topkJ=0.1505
[TRAIN][ep=002] loss=0.6486 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2621
[EPOCH 002/089] train: loss=0.6486 acc=63.70% | val: loss=0.6610 acc=62.90% f1=0.00% auc=50.84% val_score=68.7100 val_score_bestthr=62.9032 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.515, mb=0.515, no=1.000, corr=0.262) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 75.9222 -> 68.7100
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5142 mb_mean=0.5139 norm_overlap=1.0007 corr_cb=0.4700 topkJ=0.2643
[TRAIN][ep=003] loss=0.6477 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2561
[EPOCH 003/089] train: loss=0.6477 acc=63.70% | val: loss=0.6609 acc=62.90% f1=0.00% auc=50.95% val_score=74.6154 val_score_bestthr=62.9032 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.515, mb=0.515, no=1.000, corr=0.256) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 75.9222 -> 74.6154
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5147 mb_mean=0.5159 norm_overlap=1.0007 corr_cb=0.4334 topkJ=0.1914
[TRAIN][ep=004] loss=0.6459 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2609
[EPOCH 004/089] train: loss=0.6459 acc=63.70% | val: loss=0.6609 acc=62.90% f1=0.00% auc=50.84% val_score=76.5990 val_score_bestthr=62.9032 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.515, mb=0.515, no=1.000, corr=0.261) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 75.9222 -> 76.5990
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5137 mb_mean=0.5154 norm_overlap=1.0001 corr_cb=0.0616 topkJ=0.0627
[TRAIN][ep=005] loss=2.1954 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.5039 mb_mean=0.5070 norm_overlap=1.0002 corr_cb=0.1618
[EPOCH 005/089] train: loss=2.1954 acc=63.70% | val: loss=0.6615 acc=62.90% f1=0.00% auc=51.17% val_score=74.1771 val_score_bestthr=62.9032 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.504, mb=0.507, no=1.000, corr=0.162) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.5990 -> 74.1771
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4921 mb_mean=0.4948 norm_overlap=1.0008 corr_cb=0.3563 topkJ=0.1353
[TRAIN][ep=006] loss=1.4724 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.4827 mb_mean=0.4879 norm_overlap=1.0004 corr_cb=0.1949
[EPOCH 006/089] train: loss=1.4724 acc=63.70% | val: loss=0.6615 acc=62.90% f1=0.00% auc=51.51% val_score=74.1771 val_score_bestthr=62.9032 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.483, mb=0.488, no=1.000, corr=0.195) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.5990 -> 74.1771
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4683 mb_mean=0.4744 norm_overlap=1.0013 corr_cb=0.3933 topkJ=0.1188
[TRAIN][ep=007] loss=0.7583 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.4609 mb_mean=0.4654 norm_overlap=1.0014 corr_cb=0.3419
[EPOCH 007/089] train: loss=0.7583 acc=63.70% | val: loss=0.6623 acc=62.90% f1=0.00% auc=51.28% val_score=73.1129 val_score_bestthr=62.9032 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.461, mb=0.465, no=1.001, corr=0.342) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.5990 -> 73.1129
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4537 mb_mean=0.4557 norm_overlap=1.0015 corr_cb=0.3193 topkJ=0.0518
[TRAIN][ep=008] loss=0.5796 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.4388 mb_mean=0.4393 norm_overlap=1.0032 corr_cb=0.4036
[EPOCH 008/089] train: loss=0.5796 acc=63.70% | val: loss=0.6626 acc=62.90% f1=14.81% auc=51.06% val_score=74.1351 val_score_bestthr=69.8730 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.439, mb=0.439, no=1.003, corr=0.404) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.5990 -> 74.1351
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4200 mb_mean=0.4165 norm_overlap=1.0073 corr_cb=0.5344 topkJ=0.2173
[TRAIN][ep=009] loss=0.8565 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.4178 mb_mean=0.4104 norm_overlap=1.0053 corr_cb=0.3786
[EPOCH 009/089] train: loss=0.8565 acc=63.70% | val: loss=0.6646 acc=64.52% f1=8.33% auc=51.06% val_score=76.8941 val_score_bestthr=68.4365 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.418, mb=0.410, no=1.005, corr=0.379) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 76.5990 -> 76.8941
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=010] disease_pos_weight=1.0000 mode=none
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.4091 mb_mean=0.3955 norm_overlap=1.0055 corr_cb=0.3204 topkJ=0.0838
[TRAIN][ep=010] loss=1.1347 acc=63.70%
[TRAIN][ep=010] mask_avg: mc_mean=0.3992 mb_mean=0.3810 norm_overlap=1.0061 corr_cb=0.2724
[EPOCH 010/089] train: loss=1.1347 acc=63.70% | val: loss=0.6662 acc=66.13% f1=16.00% auc=50.17% val_score=73.9081 val_score_bestthr=73.7211 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.399, mb=0.381, no=1.006, corr=0.272) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.8941 -> 73.9081
[DBG][ep=011] disease_pos_weight=1.0000 mode=none
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.3789 mb_mean=0.3530 norm_overlap=1.0078 corr_cb=0.2562 topkJ=0.1172
[TRAIN][ep=011] loss=1.4110 acc=63.70%
[TRAIN][ep=011] mask_avg: mc_mean=0.3840 mb_mean=0.3538 norm_overlap=1.0054 corr_cb=0.1643
[EPOCH 011/089] train: loss=1.4110 acc=63.70% | val: loss=0.6685 acc=64.52% f1=8.33% auc=49.72% val_score=74.4960 val_score_bestthr=68.4365 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.384, mb=0.354, no=1.005, corr=0.164) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.8941 -> 74.4960
[DBG][ep=012] disease_pos_weight=1.0000 mode=none
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.3827 mb_mean=0.3561 norm_overlap=1.0035 corr_cb=0.1035 topkJ=0.0464
[TRAIN][ep=012] loss=1.6890 acc=63.70%
[TRAIN][ep=012] mask_avg: mc_mean=0.3700 mb_mean=0.3320 norm_overlap=1.0009 corr_cb=0.0224
[EPOCH 012/089] train: loss=1.6890 acc=63.70% | val: loss=0.6700 acc=64.52% f1=15.38% auc=49.61% val_score=74.4960 val_score_bestthr=71.7153 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.370, mb=0.332, no=1.001, corr=0.022) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.8941 -> 74.4960
[DBG][ep=013] disease_pos_weight=1.0000 mode=none
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.3605 mb_mean=0.3233 norm_overlap=0.9921 corr_cb=-0.1539 topkJ=0.0371
[TRAIN][ep=013] loss=1.9625 acc=63.70%
[TRAIN][ep=013] mask_avg: mc_mean=0.3581 mb_mean=0.3151 norm_overlap=0.9885 corr_cb=-0.1829
[EPOCH 013/089] train: loss=1.9625 acc=63.70% | val: loss=0.6721 acc=62.90% f1=20.69% auc=49.61% val_score=70.4502 val_score_bestthr=72.5223 | dyn(w_pfs=0.240, w_sup=0.240, w_csuf=0.200, stage2=False) | mask(mc=0.358, mb=0.315, no=0.988, corr=-0.183) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.8941 -> 70.4502
[DBG][ep=014] disease_pos_weight=1.0000 mode=none
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.3570 mb_mean=0.3174 norm_overlap=0.9774 corr_cb=-0.3025 topkJ=0.0146
[TRAIN][ep=014] loss=2.0863 acc=63.70%
[TRAIN][ep=014] mask_avg: mc_mean=0.3466 mb_mean=0.3028 norm_overlap=0.9649 corr_cb=-0.3874
[EPOCH 014/089] train: loss=2.0863 acc=63.70% | val: loss=0.6730 acc=66.13% f1=16.00% auc=49.39% val_score=68.5007 val_score_bestthr=73.7211 | dyn(w_pfs=0.280, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.347, mb=0.303, no=0.965, corr=-0.387) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.8941 -> 68.5007
[DBG][ep=015] disease_pos_weight=1.0000 mode=none
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.3376 mb_mean=0.3013 norm_overlap=0.9546 corr_cb=-0.4709 topkJ=0.0179
[TRAIN][ep=015] loss=2.1166 acc=63.70%
[TRAIN][ep=015] mask_avg: mc_mean=0.3380 mb_mean=0.2975 norm_overlap=0.9389 corr_cb=-0.5376
[EPOCH 015/089] train: loss=2.1166 acc=63.70% | val: loss=0.6753 acc=66.13% f1=16.00% auc=50.28% val_score=67.3928 val_score_bestthr=73.7211 | dyn(w_pfs=0.180, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.338, mb=0.297, no=0.939, corr=-0.538) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 67.3928
[DBG][ep=016] disease_pos_weight=1.0000 mode=none
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.3277 mb_mean=0.2862 norm_overlap=0.9073 corr_cb=-0.6385 topkJ=0.0061
[TRAIN][ep=016] loss=1.4042 acc=63.70%
[TRAIN][ep=016] mask_avg: mc_mean=0.3300 mb_mean=0.2975 norm_overlap=0.9182 corr_cb=-0.6105
[EPOCH 016/089] train: loss=1.4042 acc=63.70% | val: loss=0.6783 acc=66.13% f1=22.22% auc=50.06% val_score=62.5416 val_score_bestthr=76.5845 | dyn(w_pfs=0.220, w_sup=0.190, w_csuf=0.140, stage2=False) | mask(mc=0.330, mb=0.298, no=0.918, corr=-0.610) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 62.5416
[DBG][ep=017] disease_pos_weight=1.0000 mode=none
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.3334 mb_mean=0.3094 norm_overlap=0.9358 corr_cb=-0.6042 topkJ=0.0028
[TRAIN][ep=017] loss=1.6819 acc=63.70%
[TRAIN][ep=017] mask_avg: mc_mean=0.3238 mb_mean=0.2975 norm_overlap=0.8991 corr_cb=-0.6584
[EPOCH 017/089] train: loss=1.6819 acc=63.70% | val: loss=0.6812 acc=66.13% f1=22.22% auc=50.39% val_score=68.4426 val_score_bestthr=76.5845 | dyn(w_pfs=0.260, w_sup=0.230, w_csuf=0.180, stage2=False) | mask(mc=0.324, mb=0.297, no=0.899, corr=-0.658) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 68.4426
[DBG][ep=018] disease_pos_weight=1.0000 mode=none
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.3231 mb_mean=0.3125 norm_overlap=0.9174 corr_cb=-0.6554 topkJ=0.0004
[TRAIN][ep=018] loss=1.9549 acc=63.70%
[TRAIN][ep=018] mask_avg: mc_mean=0.3197 mb_mean=0.2975 norm_overlap=0.8816 corr_cb=-0.6964
[EPOCH 018/089] train: loss=1.9549 acc=63.70% | val: loss=0.6858 acc=64.52% f1=21.43% auc=50.39% val_score=69.4048 val_score_bestthr=74.4895 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.320, mb=0.297, no=0.882, corr=-0.696) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.4048
[DBG][ep=019] disease_pos_weight=1.0000 mode=none
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.3269 mb_mean=0.3002 norm_overlap=0.8751 corr_cb=-0.7376 topkJ=0.0000
[TRAIN][ep=019] loss=2.0929 acc=63.70%
[TRAIN][ep=019] mask_avg: mc_mean=0.3149 mb_mean=0.2975 norm_overlap=0.8654 corr_cb=-0.7179
[EPOCH 019/089] train: loss=2.0929 acc=63.70% | val: loss=0.6856 acc=64.52% f1=26.67% auc=51.06% val_score=72.9000 val_score_bestthr=77.0136 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.315, mb=0.297, no=0.865, corr=-0.718) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 72.9000
[DBG][ep=020] disease_pos_weight=1.0000 mode=none
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.2934 mb_mean=0.3037 norm_overlap=0.8950 corr_cb=-0.5972 topkJ=0.0000
[TRAIN][ep=020] loss=2.0974 acc=63.70%
[TRAIN][ep=020] mask_avg: mc_mean=0.3109 mb_mean=0.2975 norm_overlap=0.8480 corr_cb=-0.7420
[EPOCH 020/089] train: loss=2.0974 acc=63.70% | val: loss=0.6884 acc=66.13% f1=27.59% auc=50.84% val_score=70.9191 val_score_bestthr=79.0307 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.311, mb=0.297, no=0.848, corr=-0.742) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 70.9191
[DBG][ep=021] disease_pos_weight=1.0000 mode=none
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.3067 mb_mean=0.3066 norm_overlap=0.8610 corr_cb=-0.6853 topkJ=0.0000
[TRAIN][ep=021] loss=2.0924 acc=63.70%
[TRAIN][ep=021] mask_avg: mc_mean=0.3086 mb_mean=0.2975 norm_overlap=0.8375 corr_cb=-0.7497
[EPOCH 021/089] train: loss=2.0924 acc=63.70% | val: loss=0.6919 acc=66.13% f1=27.59% auc=50.17% val_score=70.0813 val_score_bestthr=79.0307 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.309, mb=0.297, no=0.837, corr=-0.750) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 70.0813
[DBG][ep=022] disease_pos_weight=1.0000 mode=none
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2988 mb_mean=0.3157 norm_overlap=0.8546 corr_cb=-0.7676 topkJ=0.0000
[TRAIN][ep=022] loss=2.0825 acc=64.07%
[TRAIN][ep=022] mask_avg: mc_mean=0.3051 mb_mean=0.2975 norm_overlap=0.8229 corr_cb=-0.7670
[EPOCH 022/089] train: loss=2.0825 acc=64.07% | val: loss=0.6929 acc=66.13% f1=36.36% auc=50.72% val_score=70.1987 val_score_bestthr=83.4443 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.305, mb=0.297, no=0.823, corr=-0.767) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 70.1987
[DBG][ep=023] disease_pos_weight=1.0000 mode=none
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2887 mb_mean=0.3002 norm_overlap=0.7946 corr_cb=-0.8066 topkJ=0.0000
[TRAIN][ep=023] loss=2.0723 acc=64.25%
[TRAIN][ep=023] mask_avg: mc_mean=0.3027 mb_mean=0.2975 norm_overlap=0.8133 corr_cb=-0.7700
[EPOCH 023/089] train: loss=2.0723 acc=64.25% | val: loss=0.6983 acc=67.74% f1=44.44% auc=51.06% val_score=75.0064 val_score_bestthr=89.5791 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.303, mb=0.297, no=0.813, corr=-0.770) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 75.0064
[DBG][ep=024] disease_pos_weight=1.0000 mode=none
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.3177 mb_mean=0.2665 norm_overlap=0.7241 corr_cb=-0.8175 topkJ=0.0000
[TRAIN][ep=024] loss=2.0633 acc=65.52%
[TRAIN][ep=024] mask_avg: mc_mean=0.3004 mb_mean=0.2975 norm_overlap=0.8045 corr_cb=-0.7728
[EPOCH 024/089] train: loss=2.0633 acc=65.52% | val: loss=0.6979 acc=64.52% f1=42.11% auc=51.39% val_score=73.7610 val_score_bestthr=85.1541 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.300, mb=0.297, no=0.805, corr=-0.773) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 73.7610
[DBG][ep=025] disease_pos_weight=1.0000 mode=none
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.3089 mb_mean=0.2837 norm_overlap=0.7466 corr_cb=-0.8270 topkJ=0.0000
[TRAIN][ep=025] loss=2.0503 acc=64.97%
[TRAIN][ep=025] mask_avg: mc_mean=0.2990 mb_mean=0.2975 norm_overlap=0.7938 corr_cb=-0.7807
[EPOCH 025/089] train: loss=2.0503 acc=64.97% | val: loss=0.7019 acc=64.52% f1=21.43% auc=51.06% val_score=68.5763 val_score_bestthr=74.3742 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.299, mb=0.297, no=0.794, corr=-0.781) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 68.5763
[DBG][ep=026] disease_pos_weight=1.0000 mode=none
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2998 mb_mean=0.2964 norm_overlap=0.8006 corr_cb=-0.7873 topkJ=0.0000
[TRAIN][ep=026] loss=2.0370 acc=66.61%
[TRAIN][ep=026] mask_avg: mc_mean=0.2949 mb_mean=0.2975 norm_overlap=0.7841 corr_cb=-0.7875
[EPOCH 026/089] train: loss=2.0370 acc=66.61% | val: loss=0.7075 acc=64.52% f1=31.25% auc=51.51% val_score=71.7636 val_score_bestthr=79.2650 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.295, mb=0.297, no=0.784, corr=-0.787) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 71.7636
[DBG][ep=027] disease_pos_weight=1.0000 mode=none
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2996 mb_mean=0.2808 norm_overlap=0.7321 corr_cb=-0.8108 topkJ=0.0000
[TRAIN][ep=027] loss=2.0369 acc=67.88%
[TRAIN][ep=027] mask_avg: mc_mean=0.2935 mb_mean=0.2975 norm_overlap=0.7763 corr_cb=-0.7927
[EPOCH 027/089] train: loss=2.0369 acc=67.88% | val: loss=0.7174 acc=64.52% f1=31.25% auc=51.84% val_score=70.0618 val_score_bestthr=79.2650 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.293, mb=0.298, no=0.776, corr=-0.793) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 70.0618
[DBG][ep=028] disease_pos_weight=1.0000 mode=none
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2950 mb_mean=0.3046 norm_overlap=0.7639 corr_cb=-0.8394 topkJ=0.0000
[TRAIN][ep=028] loss=2.0207 acc=68.06%
[TRAIN][ep=028] mask_avg: mc_mean=0.2917 mb_mean=0.2975 norm_overlap=0.7679 corr_cb=-0.7978
[EPOCH 028/089] train: loss=2.0207 acc=68.06% | val: loss=0.7102 acc=66.13% f1=36.36% auc=51.73% val_score=72.5631 val_score_bestthr=83.5741 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.292, mb=0.297, no=0.768, corr=-0.798) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 72.5631
[DBG][ep=029] disease_pos_weight=1.0000 mode=none
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2743 mb_mean=0.3034 norm_overlap=0.7978 corr_cb=-0.7454 topkJ=0.0000
[TRAIN][ep=029] loss=1.3139 acc=71.87%
[TRAIN][ep=029] mask_avg: mc_mean=0.2885 mb_mean=0.2975 norm_overlap=0.7636 corr_cb=-0.7939
[EPOCH 029/089] train: loss=1.3139 acc=71.87% | val: loss=0.7287 acc=64.52% f1=31.25% auc=51.73% val_score=71.0126 val_score_bestthr=79.2650 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.289, mb=0.297, no=0.764, corr=-0.794) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 71.0126
[DBG][ep=030] disease_pos_weight=1.0000 mode=none
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2797 mb_mean=0.2920 norm_overlap=0.7825 corr_cb=-0.7563 topkJ=0.0000
[TRAIN][ep=030] loss=0.6139 acc=70.78%
[TRAIN][ep=030] mask_avg: mc_mean=0.2860 mb_mean=0.2975 norm_overlap=0.7546 corr_cb=-0.8034
[EPOCH 030/089] train: loss=0.6139 acc=70.78% | val: loss=0.7297 acc=66.13% f1=36.36% auc=52.40% val_score=70.5945 val_score_bestthr=83.5741 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.286, mb=0.297, no=0.755, corr=-0.803) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 70.5945
[DBG][ep=031] disease_pos_weight=1.0000 mode=none
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2867 mb_mean=0.3036 norm_overlap=0.7817 corr_cb=-0.7954 topkJ=0.0000
[TRAIN][ep=031] loss=0.4399 acc=75.32%
[TRAIN][ep=031] mask_avg: mc_mean=0.2853 mb_mean=0.2975 norm_overlap=0.7516 corr_cb=-0.8042
[EPOCH 031/089] train: loss=0.4399 acc=75.32% | val: loss=0.7367 acc=66.13% f1=36.36% auc=52.06% val_score=72.5631 val_score_bestthr=83.5741 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.285, mb=0.297, no=0.752, corr=-0.804) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 72.5631
[DBG][ep=032] disease_pos_weight=1.0000 mode=none
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2671 mb_mean=0.3052 norm_overlap=0.7930 corr_cb=-0.7571 topkJ=0.0000
[TRAIN][ep=032] loss=0.4261 acc=75.32%
[TRAIN][ep=032] mask_avg: mc_mean=0.2853 mb_mean=0.2975 norm_overlap=0.7516 corr_cb=-0.8039
[EPOCH 032/089] train: loss=0.4261 acc=75.32% | val: loss=0.7405 acc=66.13% f1=36.36% auc=51.73% val_score=69.8745 val_score_bestthr=83.5741 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.285, mb=0.297, no=0.752, corr=-0.804) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.8745
[DBG][ep=033] disease_pos_weight=1.0000 mode=none
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2891 mb_mean=0.2998 norm_overlap=0.7573 corr_cb=-0.8291 topkJ=0.0000
[TRAIN][ep=033] loss=0.4237 acc=75.32%
[TRAIN][ep=033] mask_avg: mc_mean=0.2852 mb_mean=0.2975 norm_overlap=0.7519 corr_cb=-0.8025
[EPOCH 033/089] train: loss=0.4237 acc=75.32% | val: loss=0.7437 acc=66.13% f1=40.00% auc=51.84% val_score=69.8745 val_score_bestthr=85.5834 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.285, mb=0.297, no=0.752, corr=-0.802) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.8745
[DBG][ep=034] disease_pos_weight=1.0000 mode=none
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2814 mb_mean=0.2936 norm_overlap=0.7456 corr_cb=-0.8249 topkJ=0.0000
[TRAIN][ep=034] loss=0.4211 acc=75.14%
[TRAIN][ep=034] mask_avg: mc_mean=0.2853 mb_mean=0.2975 norm_overlap=0.7519 corr_cb=-0.8029
[EPOCH 034/089] train: loss=0.4211 acc=75.14% | val: loss=0.7500 acc=66.13% f1=36.36% auc=51.51% val_score=69.8745 val_score_bestthr=83.5074 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.285, mb=0.297, no=0.752, corr=-0.803) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.8745
[DBG][ep=035] disease_pos_weight=1.0000 mode=none
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2901 mb_mean=0.2995 norm_overlap=0.7308 corr_cb=-0.8079 topkJ=0.0000
[TRAIN][ep=035] loss=0.4193 acc=74.59%
[TRAIN][ep=035] mask_avg: mc_mean=0.2853 mb_mean=0.2975 norm_overlap=0.7514 corr_cb=-0.8039
[EPOCH 035/089] train: loss=0.4193 acc=74.59% | val: loss=0.7535 acc=66.13% f1=36.36% auc=51.73% val_score=69.8745 val_score_bestthr=83.5074 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.285, mb=0.297, no=0.751, corr=-0.804) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.8745
[DBG][ep=036] disease_pos_weight=1.0000 mode=none
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.3157 mb_mean=0.2732 norm_overlap=0.6553 corr_cb=-0.8891 topkJ=0.0000
[TRAIN][ep=036] loss=0.4163 acc=74.59%
[TRAIN][ep=036] mask_avg: mc_mean=0.2853 mb_mean=0.2975 norm_overlap=0.7515 corr_cb=-0.8048
[EPOCH 036/089] train: loss=0.4163 acc=74.59% | val: loss=0.7574 acc=66.13% f1=36.36% auc=51.84% val_score=69.8745 val_score_bestthr=83.5074 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.285, mb=0.297, no=0.751, corr=-0.805) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.8745
[DBG][ep=037] disease_pos_weight=1.0000 mode=none
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.2812 mb_mean=0.3101 norm_overlap=0.7822 corr_cb=-0.7900 topkJ=0.0000
[TRAIN][ep=037] loss=0.4139 acc=75.86%
[TRAIN][ep=037] mask_avg: mc_mean=0.2853 mb_mean=0.2975 norm_overlap=0.7517 corr_cb=-0.8038
[EPOCH 037/089] train: loss=0.4139 acc=75.86% | val: loss=0.7579 acc=67.74% f1=41.18% auc=52.06% val_score=69.8745 val_score_bestthr=87.8073 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.285, mb=0.297, no=0.752, corr=-0.804) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.8745
[DBG][ep=038] disease_pos_weight=1.0000 mode=none
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2845 mb_mean=0.2935 norm_overlap=0.7362 corr_cb=-0.8296 topkJ=0.0000
[TRAIN][ep=038] loss=0.4122 acc=75.14%
[TRAIN][ep=038] mask_avg: mc_mean=0.2853 mb_mean=0.2975 norm_overlap=0.7518 corr_cb=-0.8023
[EPOCH 038/089] train: loss=0.4122 acc=75.14% | val: loss=0.7579 acc=66.13% f1=36.36% auc=52.40% val_score=69.8745 val_score_bestthr=83.5741 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.285, mb=0.297, no=0.752, corr=-0.802) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.8745
[DBG][ep=039] disease_pos_weight=1.0000 mode=none
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2927 mb_mean=0.2965 norm_overlap=0.7410 corr_cb=-0.8333 topkJ=0.0000
[TRAIN][ep=039] loss=0.4092 acc=75.68%
[TRAIN][ep=039] mask_avg: mc_mean=0.2853 mb_mean=0.2975 norm_overlap=0.7517 corr_cb=-0.8036
[EPOCH 039/089] train: loss=0.4092 acc=75.68% | val: loss=0.7623 acc=66.13% f1=36.36% auc=52.40% val_score=69.8745 val_score_bestthr=83.5741 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.285, mb=0.297, no=0.752, corr=-0.804) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.8745
[EARLY STOP] no improvement for 30 epochs. best_epoch=9
[CKPT] Loaded best for testing: results/ADHD_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
=============== FIT DONE ===============
[BEST] epoch=9 | val_acc=64.52% | val_f1=8.33% | val_auc=51.06% | val_score=76.8941 | val_score_bestthr=68.4365
[TEST@BEST] thr_used=0.400 | acc=66.23% f1=18.75% auc=59.71% | SP_sex=0.32% EO_sex=3.03% SP_age=4.35% EO_age=11.52%
[TIME] 0.79 min
[OK] Saved: results/ADHD_3x5fold_seed0/fold1_rep1_seed1001/summary_fold_1.json
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5144 mb_mean=0.5150 norm_overlap=1.0001 corr_cb=0.1309 topkJ=0.0912
[TRAIN][ep=000] loss=0.7030 acc=36.48%
[TRAIN][ep=000] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2625
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5154 mb_mean=0.5148 norm_overlap=1.0002 corr_cb=0.2404 topkJ=0.1127
[TRAIN][ep=001] loss=0.6861 acc=62.25%
[TRAIN][ep=001] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2578
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5149 mb_mean=0.5167 norm_overlap=1.0008 corr_cb=0.5338 topkJ=0.2907
[TRAIN][ep=002] loss=0.6733 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2599
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5157 mb_mean=0.5166 norm_overlap=1.0002 corr_cb=0.1407 topkJ=0.0837
[TRAIN][ep=003] loss=0.6626 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2572
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5155 mb_mean=0.5150 norm_overlap=1.0006 corr_cb=0.3877 topkJ=0.2261
[TRAIN][ep=004] loss=0.6580 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2563
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5144 mb_mean=0.5149 norm_overlap=1.0005 corr_cb=0.3178 topkJ=0.2069
[TRAIN][ep=005] loss=0.6563 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2581
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5162 mb_mean=0.5152 norm_overlap=1.0006 corr_cb=0.3963 topkJ=0.1808
[TRAIN][ep=006] loss=0.6549 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2561
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5160 mb_mean=0.5163 norm_overlap=1.0003 corr_cb=0.2399 topkJ=0.1667
[TRAIN][ep=007] loss=0.6540 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2581
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5151 mb_mean=0.5161 norm_overlap=1.0002 corr_cb=0.1733 topkJ=0.1150
[TRAIN][ep=008] loss=0.6529 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2604
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5152 mb_mean=0.5142 norm_overlap=1.0003 corr_cb=0.2795 topkJ=0.1008
[TRAIN][ep=009] loss=0.6519 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2576
================= FIT START (fold=1) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.35 select_by=val_score | eval_thr_mode=best_acc eval_thr_grid=coarse | disease_pos_weight_mode=none freeze_b_after=15 | two_stage=True stage1_ratio=0.35 stage2_lr_mult=0.3 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5146 mb_mean=0.5164 norm_overlap=1.0004 corr_cb=0.2841 topkJ=0.1112
[TRAIN][ep=000] loss=0.6509 acc=63.70%
[TRAIN][ep=000] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2587
[EPOCH 000/089] train: loss=0.6509 acc=63.70% | val: loss=0.6618 acc=62.90% f1=0.00% auc=51.17% val_score=75.9222 val_score_bestthr=62.9032 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.515, mb=0.515, no=1.000, corr=0.259) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* -1000000000000000000.0000 -> 75.9222
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5151 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=0.0509 topkJ=0.0799
[TRAIN][ep=001] loss=0.6497 acc=63.70%
[TRAIN][ep=001] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2578
[EPOCH 001/089] train: loss=0.6497 acc=63.70% | val: loss=0.6613 acc=62.90% f1=0.00% auc=51.39% val_score=70.6616 val_score_bestthr=62.9032 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.515, mb=0.515, no=1.000, corr=0.258) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 75.9222 -> 70.6616
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5143 mb_mean=0.5158 norm_overlap=1.0002 corr_cb=0.1856 topkJ=0.1505
[TRAIN][ep=002] loss=0.6486 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2621
[EPOCH 002/089] train: loss=0.6486 acc=63.70% | val: loss=0.6610 acc=62.90% f1=0.00% auc=50.84% val_score=68.7100 val_score_bestthr=62.9032 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.515, mb=0.515, no=1.000, corr=0.262) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 75.9222 -> 68.7100
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5142 mb_mean=0.5139 norm_overlap=1.0007 corr_cb=0.4700 topkJ=0.2643
[TRAIN][ep=003] loss=0.6477 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2561
[EPOCH 003/089] train: loss=0.6477 acc=63.70% | val: loss=0.6609 acc=62.90% f1=0.00% auc=50.95% val_score=74.6154 val_score_bestthr=62.9032 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.515, mb=0.515, no=1.000, corr=0.256) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 75.9222 -> 74.6154
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5147 mb_mean=0.5159 norm_overlap=1.0007 corr_cb=0.4334 topkJ=0.1914
[TRAIN][ep=004] loss=0.6459 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2609
[EPOCH 004/089] train: loss=0.6459 acc=63.70% | val: loss=0.6609 acc=62.90% f1=0.00% auc=50.84% val_score=76.5990 val_score_bestthr=62.9032 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.515, mb=0.515, no=1.000, corr=0.261) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 75.9222 -> 76.5990
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5137 mb_mean=0.5154 norm_overlap=1.0001 corr_cb=0.0616 topkJ=0.0627
[TRAIN][ep=005] loss=2.2372 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.5039 mb_mean=0.5070 norm_overlap=1.0002 corr_cb=0.1617
[EPOCH 005/089] train: loss=2.2372 acc=63.70% | val: loss=0.6615 acc=62.90% f1=0.00% auc=51.17% val_score=74.1771 val_score_bestthr=62.9032 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.504, mb=0.507, no=1.000, corr=0.162) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.5990 -> 74.1771
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4921 mb_mean=0.4948 norm_overlap=1.0008 corr_cb=0.3561 topkJ=0.1353
[TRAIN][ep=006] loss=1.5139 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.4827 mb_mean=0.4879 norm_overlap=1.0004 corr_cb=0.1947
[EPOCH 006/089] train: loss=1.5139 acc=63.70% | val: loss=0.6615 acc=62.90% f1=0.00% auc=51.62% val_score=74.1771 val_score_bestthr=62.9032 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.483, mb=0.488, no=1.000, corr=0.195) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.5990 -> 74.1771
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4683 mb_mean=0.4744 norm_overlap=1.0013 corr_cb=0.3930 topkJ=0.1188
[TRAIN][ep=007] loss=0.7997 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.4609 mb_mean=0.4654 norm_overlap=1.0014 corr_cb=0.3414
[EPOCH 007/089] train: loss=0.7997 acc=63.70% | val: loss=0.6623 acc=62.90% f1=0.00% auc=51.28% val_score=73.1129 val_score_bestthr=62.9032 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.461, mb=0.465, no=1.001, corr=0.341) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.5990 -> 73.1129
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4537 mb_mean=0.4557 norm_overlap=1.0015 corr_cb=0.3185 topkJ=0.0518
[TRAIN][ep=008] loss=0.6208 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.4388 mb_mean=0.4393 norm_overlap=1.0032 corr_cb=0.4032
[EPOCH 008/089] train: loss=0.6208 acc=63.70% | val: loss=0.6626 acc=62.90% f1=14.81% auc=51.06% val_score=74.1351 val_score_bestthr=69.8730 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.439, mb=0.439, no=1.003, corr=0.403) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.5990 -> 74.1351
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4200 mb_mean=0.4165 norm_overlap=1.0073 corr_cb=0.5345 topkJ=0.2173
[TRAIN][ep=009] loss=0.8977 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.4178 mb_mean=0.4104 norm_overlap=1.0052 corr_cb=0.3784
[EPOCH 009/089] train: loss=0.8977 acc=63.70% | val: loss=0.6646 acc=64.52% f1=8.33% auc=51.06% val_score=76.8941 val_score_bestthr=68.4365 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.418, mb=0.410, no=1.005, corr=0.378) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 76.5990 -> 76.8941
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=010] disease_pos_weight=1.0000 mode=none
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.4091 mb_mean=0.3955 norm_overlap=1.0055 corr_cb=0.3199 topkJ=0.0838
[TRAIN][ep=010] loss=1.1758 acc=63.70%
[TRAIN][ep=010] mask_avg: mc_mean=0.3992 mb_mean=0.3810 norm_overlap=1.0061 corr_cb=0.2721
[EPOCH 010/089] train: loss=1.1758 acc=63.70% | val: loss=0.6662 acc=66.13% f1=16.00% auc=50.17% val_score=73.9081 val_score_bestthr=73.7211 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.399, mb=0.381, no=1.006, corr=0.272) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.8941 -> 73.9081
[DBG][ep=011] disease_pos_weight=1.0000 mode=none
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.3789 mb_mean=0.3531 norm_overlap=1.0078 corr_cb=0.2558 topkJ=0.1167
[TRAIN][ep=011] loss=1.4520 acc=63.70%
[TRAIN][ep=011] mask_avg: mc_mean=0.3840 mb_mean=0.3539 norm_overlap=1.0054 corr_cb=0.1647
[EPOCH 011/089] train: loss=1.4520 acc=63.70% | val: loss=0.6685 acc=64.52% f1=8.33% auc=49.72% val_score=74.4960 val_score_bestthr=68.4365 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.384, mb=0.354, no=1.005, corr=0.165) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.8941 -> 74.4960
[DBG][ep=012] disease_pos_weight=1.0000 mode=none
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.3827 mb_mean=0.3561 norm_overlap=1.0035 corr_cb=0.1038 topkJ=0.0464
[TRAIN][ep=012] loss=1.7300 acc=63.70%
[TRAIN][ep=012] mask_avg: mc_mean=0.3700 mb_mean=0.3320 norm_overlap=1.0009 corr_cb=0.0230
[EPOCH 012/089] train: loss=1.7300 acc=63.70% | val: loss=0.6700 acc=64.52% f1=15.38% auc=49.61% val_score=74.4960 val_score_bestthr=71.7153 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.370, mb=0.332, no=1.001, corr=0.023) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.8941 -> 74.4960
[DBG][ep=013] disease_pos_weight=1.0000 mode=none
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.3605 mb_mean=0.3233 norm_overlap=0.9922 corr_cb=-0.1533 topkJ=0.0371
[TRAIN][ep=013] loss=2.0036 acc=63.70%
[TRAIN][ep=013] mask_avg: mc_mean=0.3581 mb_mean=0.3151 norm_overlap=0.9885 corr_cb=-0.1823
[EPOCH 013/089] train: loss=2.0036 acc=63.70% | val: loss=0.6720 acc=62.90% f1=20.69% auc=49.61% val_score=70.4502 val_score_bestthr=72.5223 | dyn(w_pfs=0.240, w_sup=0.240, w_csuf=0.200, stage2=False) | mask(mc=0.358, mb=0.315, no=0.989, corr=-0.182) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.8941 -> 70.4502
[DBG][ep=014] disease_pos_weight=1.0000 mode=none
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.3570 mb_mean=0.3174 norm_overlap=0.9775 corr_cb=-0.3019 topkJ=0.0146
[TRAIN][ep=014] loss=2.1273 acc=63.70%
[TRAIN][ep=014] mask_avg: mc_mean=0.3466 mb_mean=0.3028 norm_overlap=0.9650 corr_cb=-0.3866
[EPOCH 014/089] train: loss=2.1273 acc=63.70% | val: loss=0.6729 acc=66.13% f1=16.00% auc=49.39% val_score=68.5007 val_score_bestthr=73.7211 | dyn(w_pfs=0.280, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.347, mb=0.303, no=0.965, corr=-0.387) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.8941 -> 68.5007
[DBG][ep=015] disease_pos_weight=1.0000 mode=none
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.3375 mb_mean=0.3013 norm_overlap=0.9548 corr_cb=-0.4701 topkJ=0.0175
[TRAIN][ep=015] loss=2.1576 acc=63.70%
[TRAIN][ep=015] mask_avg: mc_mean=0.3380 mb_mean=0.2975 norm_overlap=0.9390 corr_cb=-0.5370
[EPOCH 015/089] train: loss=2.1576 acc=63.70% | val: loss=0.6753 acc=66.13% f1=16.00% auc=50.28% val_score=67.3928 val_score_bestthr=73.7211 | dyn(w_pfs=0.180, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.338, mb=0.297, no=0.939, corr=-0.537) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 67.3928
[DBG][ep=016] disease_pos_weight=1.0000 mode=none
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.3276 mb_mean=0.2861 norm_overlap=0.9076 corr_cb=-0.6375 topkJ=0.0065
[TRAIN][ep=016] loss=1.4451 acc=63.70%
[TRAIN][ep=016] mask_avg: mc_mean=0.3300 mb_mean=0.2975 norm_overlap=0.9184 corr_cb=-0.6100
[EPOCH 016/089] train: loss=1.4451 acc=63.70% | val: loss=0.6782 acc=66.13% f1=22.22% auc=50.06% val_score=62.5416 val_score_bestthr=76.5845 | dyn(w_pfs=0.220, w_sup=0.190, w_csuf=0.140, stage2=False) | mask(mc=0.330, mb=0.298, no=0.918, corr=-0.610) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 62.5416
[DBG][ep=017] disease_pos_weight=1.0000 mode=none
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.3333 mb_mean=0.3094 norm_overlap=0.9360 corr_cb=-0.6036 topkJ=0.0028
[TRAIN][ep=017] loss=1.7229 acc=63.70%
[TRAIN][ep=017] mask_avg: mc_mean=0.3238 mb_mean=0.2975 norm_overlap=0.8994 corr_cb=-0.6581
[EPOCH 017/089] train: loss=1.7229 acc=63.70% | val: loss=0.6812 acc=66.13% f1=22.22% auc=50.39% val_score=68.4426 val_score_bestthr=76.5845 | dyn(w_pfs=0.260, w_sup=0.230, w_csuf=0.180, stage2=False) | mask(mc=0.324, mb=0.297, no=0.899, corr=-0.658) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 68.4426
[DBG][ep=018] disease_pos_weight=1.0000 mode=none
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.3230 mb_mean=0.3125 norm_overlap=0.9176 corr_cb=-0.6551 topkJ=0.0000
[TRAIN][ep=018] loss=1.9958 acc=63.70%
[TRAIN][ep=018] mask_avg: mc_mean=0.3196 mb_mean=0.2975 norm_overlap=0.8818 corr_cb=-0.6961
[EPOCH 018/089] train: loss=1.9958 acc=63.70% | val: loss=0.6858 acc=64.52% f1=21.43% auc=50.50% val_score=69.4048 val_score_bestthr=74.4895 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.320, mb=0.297, no=0.882, corr=-0.696) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.4048
[DBG][ep=019] disease_pos_weight=1.0000 mode=none
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.3268 mb_mean=0.3003 norm_overlap=0.8753 corr_cb=-0.7374 topkJ=0.0000
[TRAIN][ep=019] loss=2.1337 acc=63.70%
[TRAIN][ep=019] mask_avg: mc_mean=0.3148 mb_mean=0.2975 norm_overlap=0.8656 corr_cb=-0.7177
[EPOCH 019/089] train: loss=2.1337 acc=63.70% | val: loss=0.6856 acc=64.52% f1=26.67% auc=51.06% val_score=70.8317 val_score_bestthr=77.0136 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.315, mb=0.297, no=0.866, corr=-0.718) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 70.8317
[DBG][ep=020] disease_pos_weight=1.0000 mode=none
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.2934 mb_mean=0.3037 norm_overlap=0.8952 corr_cb=-0.5976 topkJ=0.0000
[TRAIN][ep=020] loss=2.1382 acc=63.70%
[TRAIN][ep=020] mask_avg: mc_mean=0.3109 mb_mean=0.2975 norm_overlap=0.8483 corr_cb=-0.7417
[EPOCH 020/089] train: loss=2.1382 acc=63.70% | val: loss=0.6884 acc=66.13% f1=27.59% auc=50.84% val_score=70.9191 val_score_bestthr=79.0307 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.311, mb=0.297, no=0.848, corr=-0.742) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 70.9191
[DBG][ep=021] disease_pos_weight=1.0000 mode=none
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.3066 mb_mean=0.3066 norm_overlap=0.8613 corr_cb=-0.6853 topkJ=0.0000
[TRAIN][ep=021] loss=2.1332 acc=63.70%
[TRAIN][ep=021] mask_avg: mc_mean=0.3086 mb_mean=0.2975 norm_overlap=0.8378 corr_cb=-0.7496
[EPOCH 021/089] train: loss=2.1332 acc=63.70% | val: loss=0.6920 acc=66.13% f1=27.59% auc=50.17% val_score=70.0813 val_score_bestthr=79.0307 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.309, mb=0.297, no=0.838, corr=-0.750) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 70.0813
[DBG][ep=022] disease_pos_weight=1.0000 mode=none
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2988 mb_mean=0.3157 norm_overlap=0.8548 corr_cb=-0.7675 topkJ=0.0000
[TRAIN][ep=022] loss=2.1232 acc=64.07%
[TRAIN][ep=022] mask_avg: mc_mean=0.3050 mb_mean=0.2975 norm_overlap=0.8232 corr_cb=-0.7669
[EPOCH 022/089] train: loss=2.1232 acc=64.07% | val: loss=0.6929 acc=66.13% f1=36.36% auc=50.72% val_score=70.1987 val_score_bestthr=83.4443 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.305, mb=0.297, no=0.823, corr=-0.767) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 70.1987
[DBG][ep=023] disease_pos_weight=1.0000 mode=none
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2887 mb_mean=0.3003 norm_overlap=0.7947 corr_cb=-0.8070 topkJ=0.0000
[TRAIN][ep=023] loss=2.1129 acc=64.25%
[TRAIN][ep=023] mask_avg: mc_mean=0.3027 mb_mean=0.2975 norm_overlap=0.8136 corr_cb=-0.7699
[EPOCH 023/089] train: loss=2.1129 acc=64.25% | val: loss=0.6984 acc=67.74% f1=44.44% auc=51.06% val_score=75.0064 val_score_bestthr=89.5791 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.303, mb=0.297, no=0.814, corr=-0.770) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 75.0064
[DBG][ep=024] disease_pos_weight=1.0000 mode=none
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.3176 mb_mean=0.2665 norm_overlap=0.7247 corr_cb=-0.8170 topkJ=0.0000
[TRAIN][ep=024] loss=2.1039 acc=65.52%
[TRAIN][ep=024] mask_avg: mc_mean=0.3003 mb_mean=0.2975 norm_overlap=0.8048 corr_cb=-0.7727
[EPOCH 024/089] train: loss=2.1039 acc=65.52% | val: loss=0.6980 acc=64.52% f1=42.11% auc=51.39% val_score=73.7610 val_score_bestthr=85.1541 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.300, mb=0.297, no=0.805, corr=-0.773) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 73.7610
[DBG][ep=025] disease_pos_weight=1.0000 mode=none
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.3089 mb_mean=0.2836 norm_overlap=0.7470 corr_cb=-0.8268 topkJ=0.0000
[TRAIN][ep=025] loss=2.0909 acc=64.97%
[TRAIN][ep=025] mask_avg: mc_mean=0.2990 mb_mean=0.2975 norm_overlap=0.7941 corr_cb=-0.7806
[EPOCH 025/089] train: loss=2.0909 acc=64.97% | val: loss=0.7020 acc=64.52% f1=21.43% auc=51.06% val_score=68.5763 val_score_bestthr=74.3742 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.299, mb=0.297, no=0.794, corr=-0.781) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 68.5763
[DBG][ep=026] disease_pos_weight=1.0000 mode=none
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2998 mb_mean=0.2965 norm_overlap=0.8009 corr_cb=-0.7873 topkJ=0.0000
[TRAIN][ep=026] loss=2.0775 acc=66.61%
[TRAIN][ep=026] mask_avg: mc_mean=0.2948 mb_mean=0.2975 norm_overlap=0.7845 corr_cb=-0.7874
[EPOCH 026/089] train: loss=2.0775 acc=66.61% | val: loss=0.7077 acc=64.52% f1=31.25% auc=51.51% val_score=71.7636 val_score_bestthr=79.2650 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.295, mb=0.297, no=0.784, corr=-0.787) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 71.7636
[DBG][ep=027] disease_pos_weight=1.0000 mode=none
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2996 mb_mean=0.2808 norm_overlap=0.7325 corr_cb=-0.8108 topkJ=0.0000
[TRAIN][ep=027] loss=2.0774 acc=67.88%
[TRAIN][ep=027] mask_avg: mc_mean=0.2934 mb_mean=0.2975 norm_overlap=0.7766 corr_cb=-0.7926
[EPOCH 027/089] train: loss=2.0774 acc=67.88% | val: loss=0.7175 acc=64.52% f1=31.25% auc=51.95% val_score=70.0618 val_score_bestthr=79.2650 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.293, mb=0.298, no=0.777, corr=-0.793) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 70.0618
[DBG][ep=028] disease_pos_weight=1.0000 mode=none
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2950 mb_mean=0.3046 norm_overlap=0.7642 corr_cb=-0.8393 topkJ=0.0000
[TRAIN][ep=028] loss=2.0611 acc=68.24%
[TRAIN][ep=028] mask_avg: mc_mean=0.2917 mb_mean=0.2975 norm_overlap=0.7683 corr_cb=-0.7977
[EPOCH 028/089] train: loss=2.0611 acc=68.24% | val: loss=0.7104 acc=66.13% f1=36.36% auc=51.73% val_score=72.5631 val_score_bestthr=83.5741 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.292, mb=0.297, no=0.768, corr=-0.798) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 72.5631
[DBG][ep=029] disease_pos_weight=1.0000 mode=none
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2744 mb_mean=0.3033 norm_overlap=0.7979 corr_cb=-0.7459 topkJ=0.0000
[TRAIN][ep=029] loss=1.3543 acc=71.87%
[TRAIN][ep=029] mask_avg: mc_mean=0.2885 mb_mean=0.2975 norm_overlap=0.7640 corr_cb=-0.7939
[EPOCH 029/089] train: loss=1.3543 acc=71.87% | val: loss=0.7290 acc=64.52% f1=31.25% auc=51.84% val_score=71.0126 val_score_bestthr=79.2650 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.289, mb=0.297, no=0.764, corr=-0.794) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 71.0126
[DBG][ep=030] disease_pos_weight=1.0000 mode=none
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2797 mb_mean=0.2919 norm_overlap=0.7830 corr_cb=-0.7560 topkJ=0.0000
[TRAIN][ep=030] loss=0.6542 acc=70.78%
[TRAIN][ep=030] mask_avg: mc_mean=0.2860 mb_mean=0.2975 norm_overlap=0.7550 corr_cb=-0.8033
[EPOCH 030/089] train: loss=0.6542 acc=70.78% | val: loss=0.7299 acc=67.74% f1=41.18% auc=52.29% val_score=70.5945 val_score_bestthr=87.8073 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.286, mb=0.297, no=0.755, corr=-0.803) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 70.5945
[DBG][ep=031] disease_pos_weight=1.0000 mode=none
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2867 mb_mean=0.3036 norm_overlap=0.7821 corr_cb=-0.7952 topkJ=0.0000
[TRAIN][ep=031] loss=0.4801 acc=75.32%
[TRAIN][ep=031] mask_avg: mc_mean=0.2853 mb_mean=0.2975 norm_overlap=0.7520 corr_cb=-0.8041
[EPOCH 031/089] train: loss=0.4801 acc=75.32% | val: loss=0.7369 acc=67.74% f1=41.18% auc=52.06% val_score=72.5631 val_score_bestthr=87.8073 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.285, mb=0.297, no=0.752, corr=-0.804) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 72.5631
[DBG][ep=032] disease_pos_weight=1.0000 mode=none
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2671 mb_mean=0.3053 norm_overlap=0.7934 corr_cb=-0.7569 topkJ=0.0000
[TRAIN][ep=032] loss=0.4664 acc=75.32%
[TRAIN][ep=032] mask_avg: mc_mean=0.2853 mb_mean=0.2975 norm_overlap=0.7520 corr_cb=-0.8038
[EPOCH 032/089] train: loss=0.4664 acc=75.32% | val: loss=0.7407 acc=66.13% f1=36.36% auc=51.73% val_score=69.8745 val_score_bestthr=83.5741 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.285, mb=0.297, no=0.752, corr=-0.804) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.8745
[DBG][ep=033] disease_pos_weight=1.0000 mode=none
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2892 mb_mean=0.2998 norm_overlap=0.7577 corr_cb=-0.8292 topkJ=0.0000
[TRAIN][ep=033] loss=0.4639 acc=75.32%
[TRAIN][ep=033] mask_avg: mc_mean=0.2853 mb_mean=0.2975 norm_overlap=0.7523 corr_cb=-0.8024
[EPOCH 033/089] train: loss=0.4639 acc=75.32% | val: loss=0.7439 acc=66.13% f1=40.00% auc=51.73% val_score=69.8745 val_score_bestthr=85.5834 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.285, mb=0.297, no=0.752, corr=-0.802) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.8745
[DBG][ep=034] disease_pos_weight=1.0000 mode=none
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2814 mb_mean=0.2936 norm_overlap=0.7460 corr_cb=-0.8250 topkJ=0.0000
[TRAIN][ep=034] loss=0.4613 acc=75.14%
[TRAIN][ep=034] mask_avg: mc_mean=0.2853 mb_mean=0.2975 norm_overlap=0.7524 corr_cb=-0.8028
[EPOCH 034/089] train: loss=0.4613 acc=75.14% | val: loss=0.7503 acc=66.13% f1=36.36% auc=51.62% val_score=69.8745 val_score_bestthr=83.5074 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.285, mb=0.297, no=0.752, corr=-0.803) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.8745
[DBG][ep=035] disease_pos_weight=1.0000 mode=none
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2901 mb_mean=0.2995 norm_overlap=0.7312 corr_cb=-0.8081 topkJ=0.0000
[TRAIN][ep=035] loss=0.4596 acc=74.77%
[TRAIN][ep=035] mask_avg: mc_mean=0.2853 mb_mean=0.2975 norm_overlap=0.7518 corr_cb=-0.8038
[EPOCH 035/089] train: loss=0.4596 acc=74.77% | val: loss=0.7537 acc=66.13% f1=36.36% auc=51.62% val_score=69.8745 val_score_bestthr=83.5074 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.285, mb=0.297, no=0.752, corr=-0.804) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.8745
[DBG][ep=036] disease_pos_weight=1.0000 mode=none
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.3157 mb_mean=0.2732 norm_overlap=0.6558 corr_cb=-0.8890 topkJ=0.0000
[TRAIN][ep=036] loss=0.4565 acc=74.59%
[TRAIN][ep=036] mask_avg: mc_mean=0.2853 mb_mean=0.2975 norm_overlap=0.7519 corr_cb=-0.8047
[EPOCH 036/089] train: loss=0.4565 acc=74.59% | val: loss=0.7576 acc=66.13% f1=36.36% auc=51.73% val_score=69.8745 val_score_bestthr=83.5074 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.285, mb=0.297, no=0.752, corr=-0.805) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.8745
[DBG][ep=037] disease_pos_weight=1.0000 mode=none
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.2812 mb_mean=0.3101 norm_overlap=0.7826 corr_cb=-0.7898 topkJ=0.0000
[TRAIN][ep=037] loss=0.4541 acc=75.86%
[TRAIN][ep=037] mask_avg: mc_mean=0.2853 mb_mean=0.2975 norm_overlap=0.7521 corr_cb=-0.8037
[EPOCH 037/089] train: loss=0.4541 acc=75.86% | val: loss=0.7581 acc=67.74% f1=41.18% auc=52.06% val_score=69.8745 val_score_bestthr=87.8073 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.285, mb=0.297, no=0.752, corr=-0.804) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.8745
[DBG][ep=038] disease_pos_weight=1.0000 mode=none
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2845 mb_mean=0.2936 norm_overlap=0.7365 corr_cb=-0.8297 topkJ=0.0000
[TRAIN][ep=038] loss=0.4523 acc=75.14%
[TRAIN][ep=038] mask_avg: mc_mean=0.2853 mb_mean=0.2975 norm_overlap=0.7522 corr_cb=-0.8023
[EPOCH 038/089] train: loss=0.4523 acc=75.14% | val: loss=0.7581 acc=67.74% f1=41.18% auc=52.40% val_score=69.8745 val_score_bestthr=87.8073 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.285, mb=0.297, no=0.752, corr=-0.802) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.8745
[DBG][ep=039] disease_pos_weight=1.0000 mode=none
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2927 mb_mean=0.2965 norm_overlap=0.7415 corr_cb=-0.8330 topkJ=0.0000
[TRAIN][ep=039] loss=0.4493 acc=75.68%
[TRAIN][ep=039] mask_avg: mc_mean=0.2853 mb_mean=0.2975 norm_overlap=0.7521 corr_cb=-0.8035
[EPOCH 039/089] train: loss=0.4493 acc=75.68% | val: loss=0.7626 acc=66.13% f1=36.36% auc=52.29% val_score=69.8745 val_score_bestthr=83.5741 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.285, mb=0.297, no=0.752, corr=-0.803) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.8745
[EARLY STOP] no improvement for 30 epochs. best_epoch=9
[CKPT] Loaded best for testing: results/ADHD_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
=============== FIT DONE ===============
[BEST] epoch=9 | val_acc=64.52% | val_f1=8.33% | val_auc=51.06% | val_score=76.8941 | val_score_bestthr=68.4365
[TEST@BEST] thr_used=0.400 | acc=66.23% f1=18.75% auc=59.73% | SP_sex=0.32% EO_sex=3.03% SP_age=4.35% EO_age=11.52%
[TIME] 0.75 min
[OK] Saved: results/ADHD_3x5fold_seed0/fold1_rep1_seed1001/summary_fold_1.json
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5144 mb_mean=0.5150 norm_overlap=1.0001 corr_cb=0.1309 topkJ=0.0912
[TRAIN][ep=000] loss=0.7030 acc=36.48%
[TRAIN][ep=000] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2625
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5154 mb_mean=0.5148 norm_overlap=1.0002 corr_cb=0.2404 topkJ=0.1127
[TRAIN][ep=001] loss=0.6861 acc=62.25%
[TRAIN][ep=001] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2578
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5149 mb_mean=0.5167 norm_overlap=1.0008 corr_cb=0.5338 topkJ=0.2907
[TRAIN][ep=002] loss=0.6733 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2599
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5157 mb_mean=0.5166 norm_overlap=1.0002 corr_cb=0.1407 topkJ=0.0837
[TRAIN][ep=003] loss=0.6626 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2572
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5155 mb_mean=0.5150 norm_overlap=1.0006 corr_cb=0.3877 topkJ=0.2261
[TRAIN][ep=004] loss=0.6580 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2563
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5144 mb_mean=0.5149 norm_overlap=1.0005 corr_cb=0.3178 topkJ=0.2069
[TRAIN][ep=005] loss=0.6563 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2581
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5162 mb_mean=0.5152 norm_overlap=1.0006 corr_cb=0.3963 topkJ=0.1808
[TRAIN][ep=006] loss=0.6549 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2561
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5160 mb_mean=0.5163 norm_overlap=1.0003 corr_cb=0.2399 topkJ=0.1667
[TRAIN][ep=007] loss=0.6540 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2581
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5151 mb_mean=0.5161 norm_overlap=1.0002 corr_cb=0.1733 topkJ=0.1150
[TRAIN][ep=008] loss=0.6529 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2604
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5152 mb_mean=0.5142 norm_overlap=1.0003 corr_cb=0.2795 topkJ=0.1008
[TRAIN][ep=009] loss=0.6519 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2576
================= FIT START (fold=1) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.35 select_by=val_score | eval_thr_mode=best_acc eval_thr_grid=coarse | disease_pos_weight_mode=none freeze_b_after=15 | two_stage=True stage1_ratio=0.35 stage2_lr_mult=0.3 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5146 mb_mean=0.5164 norm_overlap=1.0004 corr_cb=0.2841 topkJ=0.1112
[TRAIN][ep=000] loss=0.6509 acc=63.70%
[TRAIN][ep=000] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2587
[EPOCH 000/089] train: loss=0.6509 acc=63.70% | val: loss=0.6618 acc=62.90% f1=0.00% auc=51.17% val_score=75.9222 val_score_bestthr=62.9032 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.515, mb=0.515, no=1.000, corr=0.259) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* -1000000000000000000.0000 -> 75.9222
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5151 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=0.0509 topkJ=0.0799
[TRAIN][ep=001] loss=0.6497 acc=63.70%
[TRAIN][ep=001] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2578
[EPOCH 001/089] train: loss=0.6497 acc=63.70% | val: loss=0.6613 acc=62.90% f1=0.00% auc=51.39% val_score=70.6616 val_score_bestthr=62.9032 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.515, mb=0.515, no=1.000, corr=0.258) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 75.9222 -> 70.6616
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5143 mb_mean=0.5158 norm_overlap=1.0002 corr_cb=0.1856 topkJ=0.1505
[TRAIN][ep=002] loss=0.6486 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2621
[EPOCH 002/089] train: loss=0.6486 acc=63.70% | val: loss=0.6610 acc=62.90% f1=0.00% auc=50.84% val_score=68.7100 val_score_bestthr=62.9032 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.515, mb=0.515, no=1.000, corr=0.262) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 75.9222 -> 68.7100
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5142 mb_mean=0.5139 norm_overlap=1.0007 corr_cb=0.4700 topkJ=0.2643
[TRAIN][ep=003] loss=0.6477 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2561
[EPOCH 003/089] train: loss=0.6477 acc=63.70% | val: loss=0.6609 acc=62.90% f1=0.00% auc=50.95% val_score=74.6154 val_score_bestthr=62.9032 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.515, mb=0.515, no=1.000, corr=0.256) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 75.9222 -> 74.6154
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5147 mb_mean=0.5159 norm_overlap=1.0007 corr_cb=0.4334 topkJ=0.1914
[TRAIN][ep=004] loss=0.6459 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2609
[EPOCH 004/089] train: loss=0.6459 acc=63.70% | val: loss=0.6609 acc=62.90% f1=0.00% auc=50.84% val_score=76.5990 val_score_bestthr=62.9032 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.515, mb=0.515, no=1.000, corr=0.261) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 75.9222 -> 76.5990
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5137 mb_mean=0.5154 norm_overlap=1.0001 corr_cb=0.0616 topkJ=0.0627
[TRAIN][ep=005] loss=2.1327 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.5039 mb_mean=0.5070 norm_overlap=1.0002 corr_cb=0.1622
[EPOCH 005/089] train: loss=2.1327 acc=63.70% | val: loss=0.6615 acc=62.90% f1=0.00% auc=51.17% val_score=74.1771 val_score_bestthr=62.9032 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.504, mb=0.507, no=1.000, corr=0.162) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.5990 -> 74.1771
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4921 mb_mean=0.4948 norm_overlap=1.0008 corr_cb=0.3568 topkJ=0.1353
[TRAIN][ep=006] loss=1.4100 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.4827 mb_mean=0.4879 norm_overlap=1.0004 corr_cb=0.1957
[EPOCH 006/089] train: loss=1.4100 acc=63.70% | val: loss=0.6615 acc=62.90% f1=0.00% auc=51.51% val_score=74.1771 val_score_bestthr=62.9032 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.483, mb=0.488, no=1.000, corr=0.196) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.5990 -> 74.1771
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4683 mb_mean=0.4744 norm_overlap=1.0013 corr_cb=0.3942 topkJ=0.1193
[TRAIN][ep=007] loss=0.6962 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.4609 mb_mean=0.4654 norm_overlap=1.0014 corr_cb=0.3432
[EPOCH 007/089] train: loss=0.6962 acc=63.70% | val: loss=0.6623 acc=62.90% f1=0.00% auc=51.17% val_score=73.1129 val_score_bestthr=62.9032 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.461, mb=0.465, no=1.001, corr=0.343) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.5990 -> 73.1129
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4537 mb_mean=0.4557 norm_overlap=1.0015 corr_cb=0.3209 topkJ=0.0523
[TRAIN][ep=008] loss=0.5177 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.4388 mb_mean=0.4393 norm_overlap=1.0032 corr_cb=0.4049
[EPOCH 008/089] train: loss=0.5177 acc=63.70% | val: loss=0.6626 acc=62.90% f1=14.81% auc=51.06% val_score=74.1351 val_score_bestthr=69.8730 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.439, mb=0.439, no=1.003, corr=0.405) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.5990 -> 74.1351
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4200 mb_mean=0.4165 norm_overlap=1.0073 corr_cb=0.5348 topkJ=0.2173
[TRAIN][ep=009] loss=0.7948 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.4178 mb_mean=0.4103 norm_overlap=1.0053 corr_cb=0.3796
[EPOCH 009/089] train: loss=0.7948 acc=63.70% | val: loss=0.6646 acc=64.52% f1=8.33% auc=51.06% val_score=76.8941 val_score_bestthr=68.4365 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.418, mb=0.410, no=1.005, corr=0.380) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 76.5990 -> 76.8941
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=010] disease_pos_weight=1.0000 mode=none
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.4091 mb_mean=0.3954 norm_overlap=1.0055 corr_cb=0.3219 topkJ=0.0847
[TRAIN][ep=010] loss=1.0730 acc=63.70%
[TRAIN][ep=010] mask_avg: mc_mean=0.3993 mb_mean=0.3809 norm_overlap=1.0062 corr_cb=0.2734
[EPOCH 010/089] train: loss=1.0730 acc=63.70% | val: loss=0.6662 acc=66.13% f1=16.00% auc=50.17% val_score=73.9081 val_score_bestthr=73.7211 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.399, mb=0.381, no=1.006, corr=0.273) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.8941 -> 73.9081
[DBG][ep=011] disease_pos_weight=1.0000 mode=none
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.3789 mb_mean=0.3530 norm_overlap=1.0078 corr_cb=0.2574 topkJ=0.1162
[TRAIN][ep=011] loss=1.3493 acc=63.70%
[TRAIN][ep=011] mask_avg: mc_mean=0.3840 mb_mean=0.3538 norm_overlap=1.0054 corr_cb=0.1647
[EPOCH 011/089] train: loss=1.3493 acc=63.70% | val: loss=0.6685 acc=64.52% f1=8.33% auc=49.72% val_score=74.4960 val_score_bestthr=68.4365 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.384, mb=0.354, no=1.005, corr=0.165) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.8941 -> 74.4960
[DBG][ep=012] disease_pos_weight=1.0000 mode=none
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.3827 mb_mean=0.3561 norm_overlap=1.0035 corr_cb=0.1042 topkJ=0.0464
[TRAIN][ep=012] loss=1.6274 acc=63.70%
[TRAIN][ep=012] mask_avg: mc_mean=0.3700 mb_mean=0.3320 norm_overlap=1.0009 corr_cb=0.0225
[EPOCH 012/089] train: loss=1.6274 acc=63.70% | val: loss=0.6700 acc=64.52% f1=15.38% auc=49.50% val_score=74.4960 val_score_bestthr=71.7153 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.370, mb=0.332, no=1.001, corr=0.023) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.8941 -> 74.4960
[DBG][ep=013] disease_pos_weight=1.0000 mode=none
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.3605 mb_mean=0.3233 norm_overlap=0.9921 corr_cb=-0.1540 topkJ=0.0380
[TRAIN][ep=013] loss=1.9010 acc=63.70%
[TRAIN][ep=013] mask_avg: mc_mean=0.3581 mb_mean=0.3151 norm_overlap=0.9884 corr_cb=-0.1830
[EPOCH 013/089] train: loss=1.9010 acc=63.70% | val: loss=0.6721 acc=62.90% f1=20.69% auc=49.61% val_score=70.4502 val_score_bestthr=72.5223 | dyn(w_pfs=0.240, w_sup=0.240, w_csuf=0.200, stage2=False) | mask(mc=0.358, mb=0.315, no=0.988, corr=-0.183) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.8941 -> 70.4502
[DBG][ep=014] disease_pos_weight=1.0000 mode=none
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.3571 mb_mean=0.3173 norm_overlap=0.9774 corr_cb=-0.3023 topkJ=0.0146
[TRAIN][ep=014] loss=2.0248 acc=63.70%
[TRAIN][ep=014] mask_avg: mc_mean=0.3467 mb_mean=0.3028 norm_overlap=0.9648 corr_cb=-0.3875
[EPOCH 014/089] train: loss=2.0248 acc=63.70% | val: loss=0.6730 acc=66.13% f1=16.00% auc=49.61% val_score=68.5007 val_score_bestthr=73.7211 | dyn(w_pfs=0.280, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.347, mb=0.303, no=0.965, corr=-0.387) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.8941 -> 68.5007
[DBG][ep=015] disease_pos_weight=1.0000 mode=none
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.3376 mb_mean=0.3012 norm_overlap=0.9545 corr_cb=-0.4715 topkJ=0.0183
[TRAIN][ep=015] loss=2.0551 acc=63.70%
[TRAIN][ep=015] mask_avg: mc_mean=0.3381 mb_mean=0.2975 norm_overlap=0.9387 corr_cb=-0.5377
[EPOCH 015/089] train: loss=2.0551 acc=63.70% | val: loss=0.6754 acc=66.13% f1=16.00% auc=50.28% val_score=67.3928 val_score_bestthr=73.7211 | dyn(w_pfs=0.180, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.338, mb=0.297, no=0.939, corr=-0.538) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 67.3928
[DBG][ep=016] disease_pos_weight=1.0000 mode=none
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.3277 mb_mean=0.2862 norm_overlap=0.9071 corr_cb=-0.6392 topkJ=0.0061
[TRAIN][ep=016] loss=1.3427 acc=63.70%
[TRAIN][ep=016] mask_avg: mc_mean=0.3301 mb_mean=0.2975 norm_overlap=0.9181 corr_cb=-0.6107
[EPOCH 016/089] train: loss=1.3427 acc=63.70% | val: loss=0.6783 acc=66.13% f1=22.22% auc=50.06% val_score=62.5416 val_score_bestthr=76.5845 | dyn(w_pfs=0.220, w_sup=0.190, w_csuf=0.140, stage2=False) | mask(mc=0.330, mb=0.297, no=0.918, corr=-0.611) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 62.5416
[DBG][ep=017] disease_pos_weight=1.0000 mode=none
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.3334 mb_mean=0.3093 norm_overlap=0.9356 corr_cb=-0.6046 topkJ=0.0028
[TRAIN][ep=017] loss=1.6205 acc=63.70%
[TRAIN][ep=017] mask_avg: mc_mean=0.3239 mb_mean=0.2975 norm_overlap=0.8990 corr_cb=-0.6585
[EPOCH 017/089] train: loss=1.6205 acc=63.70% | val: loss=0.6813 acc=66.13% f1=22.22% auc=50.50% val_score=68.4426 val_score_bestthr=76.5845 | dyn(w_pfs=0.260, w_sup=0.230, w_csuf=0.180, stage2=False) | mask(mc=0.324, mb=0.297, no=0.899, corr=-0.659) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 68.4426
[DBG][ep=018] disease_pos_weight=1.0000 mode=none
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.3231 mb_mean=0.3124 norm_overlap=0.9173 corr_cb=-0.6556 topkJ=0.0004
[TRAIN][ep=018] loss=1.8935 acc=63.70%
[TRAIN][ep=018] mask_avg: mc_mean=0.3198 mb_mean=0.2975 norm_overlap=0.8814 corr_cb=-0.6964
[EPOCH 018/089] train: loss=1.8935 acc=63.70% | val: loss=0.6858 acc=64.52% f1=21.43% auc=50.50% val_score=69.4048 val_score_bestthr=74.4895 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.320, mb=0.297, no=0.881, corr=-0.696) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.4048
[DBG][ep=019] disease_pos_weight=1.0000 mode=none
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.3269 mb_mean=0.3002 norm_overlap=0.8750 corr_cb=-0.7375 topkJ=0.0000
[TRAIN][ep=019] loss=2.0315 acc=63.70%
[TRAIN][ep=019] mask_avg: mc_mean=0.3149 mb_mean=0.2975 norm_overlap=0.8652 corr_cb=-0.7178
[EPOCH 019/089] train: loss=2.0315 acc=63.70% | val: loss=0.6856 acc=64.52% f1=26.67% auc=51.06% val_score=72.9000 val_score_bestthr=77.0136 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.315, mb=0.297, no=0.865, corr=-0.718) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 72.9000
[DBG][ep=020] disease_pos_weight=1.0000 mode=none
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.2935 mb_mean=0.3036 norm_overlap=0.8950 corr_cb=-0.5964 topkJ=0.0000
[TRAIN][ep=020] loss=2.0361 acc=63.70%
[TRAIN][ep=020] mask_avg: mc_mean=0.3110 mb_mean=0.2975 norm_overlap=0.8478 corr_cb=-0.7419
[EPOCH 020/089] train: loss=2.0361 acc=63.70% | val: loss=0.6884 acc=66.13% f1=27.59% auc=50.84% val_score=70.9191 val_score_bestthr=79.0307 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.311, mb=0.297, no=0.848, corr=-0.742) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 70.9191
[DBG][ep=021] disease_pos_weight=1.0000 mode=none
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.3068 mb_mean=0.3065 norm_overlap=0.8609 corr_cb=-0.6852 topkJ=0.0000
[TRAIN][ep=021] loss=2.0312 acc=63.70%
[TRAIN][ep=021] mask_avg: mc_mean=0.3087 mb_mean=0.2975 norm_overlap=0.8373 corr_cb=-0.7497
[EPOCH 021/089] train: loss=2.0312 acc=63.70% | val: loss=0.6919 acc=66.13% f1=27.59% auc=50.06% val_score=70.0813 val_score_bestthr=79.0307 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.309, mb=0.297, no=0.837, corr=-0.750) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 70.0813
[DBG][ep=022] disease_pos_weight=1.0000 mode=none
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2989 mb_mean=0.3157 norm_overlap=0.8544 corr_cb=-0.7676 topkJ=0.0000
[TRAIN][ep=022] loss=2.0214 acc=64.07%
[TRAIN][ep=022] mask_avg: mc_mean=0.3051 mb_mean=0.2975 norm_overlap=0.8227 corr_cb=-0.7669
[EPOCH 022/089] train: loss=2.0214 acc=64.07% | val: loss=0.6929 acc=66.13% f1=36.36% auc=50.72% val_score=70.1987 val_score_bestthr=83.4443 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.305, mb=0.297, no=0.823, corr=-0.767) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 70.1987
[DBG][ep=023] disease_pos_weight=1.0000 mode=none
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2888 mb_mean=0.3002 norm_overlap=0.7946 corr_cb=-0.8058 topkJ=0.0000
[TRAIN][ep=023] loss=2.0112 acc=64.25%
[TRAIN][ep=023] mask_avg: mc_mean=0.3028 mb_mean=0.2975 norm_overlap=0.8131 corr_cb=-0.7699
[EPOCH 023/089] train: loss=2.0112 acc=64.25% | val: loss=0.6983 acc=67.74% f1=44.44% auc=51.06% val_score=75.0064 val_score_bestthr=89.5791 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.303, mb=0.297, no=0.813, corr=-0.770) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 75.0064
[DBG][ep=024] disease_pos_weight=1.0000 mode=none
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.3178 mb_mean=0.2665 norm_overlap=0.7235 corr_cb=-0.8179 topkJ=0.0000
[TRAIN][ep=024] loss=2.0023 acc=65.52%
[TRAIN][ep=024] mask_avg: mc_mean=0.3005 mb_mean=0.2974 norm_overlap=0.8043 corr_cb=-0.7726
[EPOCH 024/089] train: loss=2.0023 acc=65.52% | val: loss=0.6979 acc=64.52% f1=42.11% auc=51.39% val_score=73.7610 val_score_bestthr=85.1541 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.300, mb=0.297, no=0.804, corr=-0.773) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 73.7610
[DBG][ep=025] disease_pos_weight=1.0000 mode=none
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.3090 mb_mean=0.2837 norm_overlap=0.7462 corr_cb=-0.8271 topkJ=0.0000
[TRAIN][ep=025] loss=1.9894 acc=64.97%
[TRAIN][ep=025] mask_avg: mc_mean=0.2991 mb_mean=0.2975 norm_overlap=0.7936 corr_cb=-0.7806
[EPOCH 025/089] train: loss=1.9894 acc=64.97% | val: loss=0.7019 acc=64.52% f1=21.43% auc=51.06% val_score=68.5763 val_score_bestthr=74.3742 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.299, mb=0.297, no=0.794, corr=-0.781) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 68.5763
[DBG][ep=026] disease_pos_weight=1.0000 mode=none
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2999 mb_mean=0.2964 norm_overlap=0.8002 corr_cb=-0.7872 topkJ=0.0000
[TRAIN][ep=026] loss=1.9761 acc=66.61%
[TRAIN][ep=026] mask_avg: mc_mean=0.2949 mb_mean=0.2974 norm_overlap=0.7838 corr_cb=-0.7875
[EPOCH 026/089] train: loss=1.9761 acc=66.61% | val: loss=0.7074 acc=64.52% f1=31.25% auc=51.62% val_score=71.7636 val_score_bestthr=79.2650 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.295, mb=0.297, no=0.784, corr=-0.787) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 71.7636
[DBG][ep=027] disease_pos_weight=1.0000 mode=none
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2997 mb_mean=0.2808 norm_overlap=0.7319 corr_cb=-0.8106 topkJ=0.0000
[TRAIN][ep=027] loss=1.9761 acc=67.88%
[TRAIN][ep=027] mask_avg: mc_mean=0.2935 mb_mean=0.2975 norm_overlap=0.7760 corr_cb=-0.7926
[EPOCH 027/089] train: loss=1.9761 acc=67.88% | val: loss=0.7173 acc=64.52% f1=31.25% auc=51.95% val_score=70.0618 val_score_bestthr=79.2650 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.294, mb=0.297, no=0.776, corr=-0.793) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 70.0618
[DBG][ep=028] disease_pos_weight=1.0000 mode=none
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2950 mb_mean=0.3046 norm_overlap=0.7635 corr_cb=-0.8395 topkJ=0.0000
[TRAIN][ep=028] loss=1.9599 acc=68.06%
[TRAIN][ep=028] mask_avg: mc_mean=0.2917 mb_mean=0.2975 norm_overlap=0.7676 corr_cb=-0.7978
[EPOCH 028/089] train: loss=1.9599 acc=68.06% | val: loss=0.7101 acc=66.13% f1=36.36% auc=51.73% val_score=72.5631 val_score_bestthr=83.5741 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.292, mb=0.297, no=0.768, corr=-0.798) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 72.5631
[DBG][ep=029] disease_pos_weight=1.0000 mode=none
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2743 mb_mean=0.3034 norm_overlap=0.7976 corr_cb=-0.7450 topkJ=0.0000
[TRAIN][ep=029] loss=1.2531 acc=71.69%
[TRAIN][ep=029] mask_avg: mc_mean=0.2886 mb_mean=0.2975 norm_overlap=0.7633 corr_cb=-0.7939
[EPOCH 029/089] train: loss=1.2531 acc=71.69% | val: loss=0.7285 acc=64.52% f1=31.25% auc=51.62% val_score=71.0126 val_score_bestthr=79.2650 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.289, mb=0.297, no=0.763, corr=-0.794) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 71.0126
[DBG][ep=030] disease_pos_weight=1.0000 mode=none
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2797 mb_mean=0.2920 norm_overlap=0.7821 corr_cb=-0.7568 topkJ=0.0000
[TRAIN][ep=030] loss=0.5533 acc=70.78%
[TRAIN][ep=030] mask_avg: mc_mean=0.2861 mb_mean=0.2975 norm_overlap=0.7542 corr_cb=-0.8034
[EPOCH 030/089] train: loss=0.5533 acc=70.78% | val: loss=0.7295 acc=66.13% f1=36.36% auc=52.40% val_score=70.5945 val_score_bestthr=83.5741 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.286, mb=0.297, no=0.754, corr=-0.803) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 70.5945
[DBG][ep=031] disease_pos_weight=1.0000 mode=none
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2867 mb_mean=0.3036 norm_overlap=0.7813 corr_cb=-0.7956 topkJ=0.0000
[TRAIN][ep=031] loss=0.3792 acc=75.68%
[TRAIN][ep=031] mask_avg: mc_mean=0.2853 mb_mean=0.2975 norm_overlap=0.7513 corr_cb=-0.8042
[EPOCH 031/089] train: loss=0.3792 acc=75.68% | val: loss=0.7365 acc=66.13% f1=36.36% auc=51.95% val_score=72.5631 val_score_bestthr=83.5741 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.285, mb=0.297, no=0.751, corr=-0.804) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 72.5631
[DBG][ep=032] disease_pos_weight=1.0000 mode=none
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2672 mb_mean=0.3051 norm_overlap=0.7925 corr_cb=-0.7572 topkJ=0.0000
[TRAIN][ep=032] loss=0.3655 acc=75.50%
[TRAIN][ep=032] mask_avg: mc_mean=0.2853 mb_mean=0.2975 norm_overlap=0.7512 corr_cb=-0.8039
[EPOCH 032/089] train: loss=0.3655 acc=75.50% | val: loss=0.7402 acc=66.13% f1=36.36% auc=51.73% val_score=69.8745 val_score_bestthr=83.5741 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.285, mb=0.297, no=0.751, corr=-0.804) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.8745
[DBG][ep=033] disease_pos_weight=1.0000 mode=none
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2891 mb_mean=0.2998 norm_overlap=0.7571 corr_cb=-0.8289 topkJ=0.0000
[TRAIN][ep=033] loss=0.3631 acc=75.32%
[TRAIN][ep=033] mask_avg: mc_mean=0.2853 mb_mean=0.2975 norm_overlap=0.7515 corr_cb=-0.8025
[EPOCH 033/089] train: loss=0.3631 acc=75.32% | val: loss=0.7435 acc=66.13% f1=40.00% auc=51.95% val_score=69.8745 val_score_bestthr=85.5834 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.285, mb=0.297, no=0.752, corr=-0.803) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.8745
[DBG][ep=034] disease_pos_weight=1.0000 mode=none
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2814 mb_mean=0.2935 norm_overlap=0.7454 corr_cb=-0.8248 topkJ=0.0000
[TRAIN][ep=034] loss=0.3605 acc=75.14%
[TRAIN][ep=034] mask_avg: mc_mean=0.2853 mb_mean=0.2975 norm_overlap=0.7516 corr_cb=-0.8029
[EPOCH 034/089] train: loss=0.3605 acc=75.14% | val: loss=0.7498 acc=66.13% f1=36.36% auc=51.62% val_score=69.8745 val_score_bestthr=83.5074 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.285, mb=0.297, no=0.752, corr=-0.803) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.8745
[DBG][ep=035] disease_pos_weight=1.0000 mode=none
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2901 mb_mean=0.2995 norm_overlap=0.7304 corr_cb=-0.8076 topkJ=0.0000
[TRAIN][ep=035] loss=0.3588 acc=74.59%
[TRAIN][ep=035] mask_avg: mc_mean=0.2853 mb_mean=0.2975 norm_overlap=0.7510 corr_cb=-0.8039
[EPOCH 035/089] train: loss=0.3588 acc=74.59% | val: loss=0.7532 acc=66.13% f1=36.36% auc=51.73% val_score=69.8745 val_score_bestthr=83.5074 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.285, mb=0.297, no=0.751, corr=-0.804) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.8745
[DBG][ep=036] disease_pos_weight=1.0000 mode=none
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.3157 mb_mean=0.2732 norm_overlap=0.6549 corr_cb=-0.8891 topkJ=0.0000
[TRAIN][ep=036] loss=0.3558 acc=74.59%
[TRAIN][ep=036] mask_avg: mc_mean=0.2853 mb_mean=0.2975 norm_overlap=0.7511 corr_cb=-0.8048
[EPOCH 036/089] train: loss=0.3558 acc=74.59% | val: loss=0.7572 acc=66.13% f1=36.36% auc=51.84% val_score=69.8745 val_score_bestthr=83.5074 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.285, mb=0.297, no=0.751, corr=-0.805) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.8745
[DBG][ep=037] disease_pos_weight=1.0000 mode=none
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.2812 mb_mean=0.3101 norm_overlap=0.7819 corr_cb=-0.7900 topkJ=0.0000
[TRAIN][ep=037] loss=0.3534 acc=75.86%
[TRAIN][ep=037] mask_avg: mc_mean=0.2853 mb_mean=0.2975 norm_overlap=0.7514 corr_cb=-0.8038
[EPOCH 037/089] train: loss=0.3534 acc=75.86% | val: loss=0.7577 acc=67.74% f1=41.18% auc=52.17% val_score=69.8745 val_score_bestthr=87.8073 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.285, mb=0.297, no=0.751, corr=-0.804) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.8745
[DBG][ep=038] disease_pos_weight=1.0000 mode=none
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2846 mb_mean=0.2935 norm_overlap=0.7360 corr_cb=-0.8295 topkJ=0.0000
[TRAIN][ep=038] loss=0.3517 acc=75.14%
[TRAIN][ep=038] mask_avg: mc_mean=0.2853 mb_mean=0.2975 norm_overlap=0.7515 corr_cb=-0.8024
[EPOCH 038/089] train: loss=0.3517 acc=75.14% | val: loss=0.7577 acc=66.13% f1=36.36% auc=52.29% val_score=69.8745 val_score_bestthr=83.5741 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.285, mb=0.297, no=0.751, corr=-0.802) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.8745
[DBG][ep=039] disease_pos_weight=1.0000 mode=none
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2927 mb_mean=0.2965 norm_overlap=0.7407 corr_cb=-0.8334 topkJ=0.0000
[TRAIN][ep=039] loss=0.3487 acc=75.50%
[TRAIN][ep=039] mask_avg: mc_mean=0.2853 mb_mean=0.2974 norm_overlap=0.7514 corr_cb=-0.8036
[EPOCH 039/089] train: loss=0.3487 acc=75.50% | val: loss=0.7622 acc=66.13% f1=36.36% auc=52.40% val_score=69.8745 val_score_bestthr=83.5741 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.285, mb=0.297, no=0.751, corr=-0.804) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.8745
[EARLY STOP] no improvement for 30 epochs. best_epoch=9
[CKPT] Loaded best for testing: results/ADHD_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
=============== FIT DONE ===============
[BEST] epoch=9 | val_acc=64.52% | val_f1=8.33% | val_auc=51.06% | val_score=76.8941 | val_score_bestthr=68.4365
[TEST@BEST] thr_used=0.400 | acc=66.23% f1=18.75% auc=59.71% | SP_sex=0.32% EO_sex=3.03% SP_age=4.35% EO_age=11.52%
[TIME] 0.74 min
[OK] Saved: results/ADHD_3x5fold_seed0/fold1_rep1_seed1001/summary_fold_1.json
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5144 mb_mean=0.5150 norm_overlap=1.0001 corr_cb=0.1309 topkJ=0.0912
[TRAIN][ep=000] loss=0.7030 acc=36.48%
[TRAIN][ep=000] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2625
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5154 mb_mean=0.5148 norm_overlap=1.0002 corr_cb=0.2404 topkJ=0.1127
[TRAIN][ep=001] loss=0.6861 acc=62.25%
[TRAIN][ep=001] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2578
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5149 mb_mean=0.5167 norm_overlap=1.0008 corr_cb=0.5338 topkJ=0.2907
[TRAIN][ep=002] loss=0.6733 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2599
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5157 mb_mean=0.5166 norm_overlap=1.0002 corr_cb=0.1407 topkJ=0.0837
[TRAIN][ep=003] loss=0.6626 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2572
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5155 mb_mean=0.5150 norm_overlap=1.0006 corr_cb=0.3877 topkJ=0.2261
[TRAIN][ep=004] loss=0.6580 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2563
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5144 mb_mean=0.5149 norm_overlap=1.0005 corr_cb=0.3178 topkJ=0.2069
[TRAIN][ep=005] loss=0.6563 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2581
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5162 mb_mean=0.5152 norm_overlap=1.0006 corr_cb=0.3963 topkJ=0.1808
[TRAIN][ep=006] loss=0.6549 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2561
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5160 mb_mean=0.5163 norm_overlap=1.0003 corr_cb=0.2399 topkJ=0.1667
[TRAIN][ep=007] loss=0.6540 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2581
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5151 mb_mean=0.5161 norm_overlap=1.0002 corr_cb=0.1733 topkJ=0.1150
[TRAIN][ep=008] loss=0.6529 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2604
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5152 mb_mean=0.5142 norm_overlap=1.0003 corr_cb=0.2795 topkJ=0.1008
[TRAIN][ep=009] loss=0.6519 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2576
================= FIT START (fold=1) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.35 select_by=val_score | eval_thr_mode=best_acc eval_thr_grid=coarse | disease_pos_weight_mode=none freeze_b_after=15 | two_stage=True stage1_ratio=0.35 stage2_lr_mult=0.3 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5146 mb_mean=0.5164 norm_overlap=1.0004 corr_cb=0.2841 topkJ=0.1112
[TRAIN][ep=000] loss=0.6509 acc=63.70%
[TRAIN][ep=000] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2587
[EPOCH 000/089] train: loss=0.6509 acc=63.70% | val: loss=0.6618 acc=62.90% f1=0.00% auc=51.17% val_score=75.9222 val_score_bestthr=62.9032 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.515, mb=0.515, no=1.000, corr=0.259) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* -1000000000000000000.0000 -> 75.9222
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5151 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=0.0509 topkJ=0.0799
[TRAIN][ep=001] loss=0.6497 acc=63.70%
[TRAIN][ep=001] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2578
[EPOCH 001/089] train: loss=0.6497 acc=63.70% | val: loss=0.6613 acc=62.90% f1=0.00% auc=51.39% val_score=70.6616 val_score_bestthr=62.9032 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.515, mb=0.515, no=1.000, corr=0.258) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 75.9222 -> 70.6616
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5143 mb_mean=0.5158 norm_overlap=1.0002 corr_cb=0.1856 topkJ=0.1505
[TRAIN][ep=002] loss=0.6486 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2621
[EPOCH 002/089] train: loss=0.6486 acc=63.70% | val: loss=0.6610 acc=62.90% f1=0.00% auc=50.84% val_score=68.7100 val_score_bestthr=62.9032 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.515, mb=0.515, no=1.000, corr=0.262) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 75.9222 -> 68.7100
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5142 mb_mean=0.5139 norm_overlap=1.0007 corr_cb=0.4700 topkJ=0.2643
[TRAIN][ep=003] loss=0.6477 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2561
[EPOCH 003/089] train: loss=0.6477 acc=63.70% | val: loss=0.6609 acc=62.90% f1=0.00% auc=50.95% val_score=74.6154 val_score_bestthr=62.9032 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.515, mb=0.515, no=1.000, corr=0.256) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 75.9222 -> 74.6154
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5147 mb_mean=0.5159 norm_overlap=1.0007 corr_cb=0.4334 topkJ=0.1914
[TRAIN][ep=004] loss=0.6459 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2609
[EPOCH 004/089] train: loss=0.6459 acc=63.70% | val: loss=0.6609 acc=62.90% f1=0.00% auc=50.84% val_score=76.5990 val_score_bestthr=62.9032 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.515, mb=0.515, no=1.000, corr=0.261) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 75.9222 -> 76.5990
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5137 mb_mean=0.5154 norm_overlap=1.0001 corr_cb=0.0616 topkJ=0.0627
[TRAIN][ep=005] loss=2.6401 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.5043 mb_mean=0.5093 norm_overlap=1.0002 corr_cb=0.1612
[EPOCH 005/089] train: loss=2.6401 acc=63.70% | val: loss=0.6615 acc=62.90% f1=0.00% auc=51.28% val_score=74.1771 val_score_bestthr=62.9032 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.504, mb=0.509, no=1.000, corr=0.161) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.5990 -> 74.1771
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4929 mb_mean=0.4995 norm_overlap=1.0007 corr_cb=0.3357 topkJ=0.1337
[TRAIN][ep=006] loss=1.7371 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.4837 mb_mean=0.4954 norm_overlap=1.0003 corr_cb=0.1530
[EPOCH 006/089] train: loss=1.7371 acc=63.70% | val: loss=0.6615 acc=62.90% f1=0.00% auc=51.73% val_score=74.1771 val_score_bestthr=62.9032 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.484, mb=0.495, no=1.000, corr=0.153) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.5990 -> 74.1771
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4697 mb_mean=0.4859 norm_overlap=1.0010 corr_cb=0.3532 topkJ=0.1209
[TRAIN][ep=007] loss=0.8480 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.4623 mb_mean=0.4788 norm_overlap=1.0009 corr_cb=0.2858
[EPOCH 007/089] train: loss=0.8480 acc=63.70% | val: loss=0.6622 acc=62.90% f1=0.00% auc=51.84% val_score=73.1129 val_score_bestthr=62.9032 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.462, mb=0.479, no=1.001, corr=0.286) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.5990 -> 73.1129
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4550 mb_mean=0.4714 norm_overlap=1.0009 corr_cb=0.2587 topkJ=0.0421
[TRAIN][ep=008] loss=0.5817 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.4403 mb_mean=0.4595 norm_overlap=1.0022 corr_cb=0.3767
[EPOCH 008/089] train: loss=0.5817 acc=63.70% | val: loss=0.6625 acc=64.52% f1=15.38% auc=51.28% val_score=74.1351 val_score_bestthr=71.8269 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.440, mb=0.459, no=1.002, corr=0.377) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.5990 -> 74.1351
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4214 mb_mean=0.4422 norm_overlap=1.0052 corr_cb=0.5386 topkJ=0.2112
[TRAIN][ep=009] loss=0.9292 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.4189 mb_mean=0.4373 norm_overlap=1.0038 corr_cb=0.3915
[EPOCH 009/089] train: loss=0.9292 acc=63.70% | val: loss=0.6643 acc=64.52% f1=8.33% auc=50.95% val_score=71.8577 val_score_bestthr=68.4365 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.419, mb=0.437, no=1.004, corr=0.392) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.5990 -> 71.8577
[DBG][ep=010] disease_pos_weight=1.0000 mode=none
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.4096 mb_mean=0.4254 norm_overlap=1.0042 corr_cb=0.3575 topkJ=0.0914
[TRAIN][ep=010] loss=1.2774 acc=63.70%
[TRAIN][ep=010] mask_avg: mc_mean=0.3995 mb_mean=0.4129 norm_overlap=1.0051 corr_cb=0.3261
[EPOCH 010/089] train: loss=1.2774 acc=63.70% | val: loss=0.6659 acc=66.13% f1=16.00% auc=50.17% val_score=73.9081 val_score_bestthr=73.7211 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.400, mb=0.413, no=1.005, corr=0.326) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.5990 -> 73.9081
[DBG][ep=011] disease_pos_weight=1.0000 mode=none
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.3786 mb_mean=0.3895 norm_overlap=1.0073 corr_cb=0.3441 topkJ=0.1362
[TRAIN][ep=011] loss=1.6236 acc=63.70%
[TRAIN][ep=011] mask_avg: mc_mean=0.3834 mb_mean=0.3879 norm_overlap=1.0062 corr_cb=0.2668
[EPOCH 011/089] train: loss=1.6236 acc=63.70% | val: loss=0.6680 acc=62.90% f1=20.69% auc=49.94% val_score=74.4960 val_score_bestthr=72.5223 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.383, mb=0.388, no=1.006, corr=0.267) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.5990 -> 74.4960
[DBG][ep=012] disease_pos_weight=1.0000 mode=none
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.3818 mb_mean=0.3874 norm_overlap=1.0055 corr_cb=0.2265 topkJ=0.0601
[TRAIN][ep=012] loss=1.9716 acc=63.70%
[TRAIN][ep=012] mask_avg: mc_mean=0.3686 mb_mean=0.3654 norm_overlap=1.0061 corr_cb=0.1911
[EPOCH 012/089] train: loss=1.9716 acc=63.70% | val: loss=0.6694 acc=64.52% f1=15.38% auc=49.72% val_score=74.4960 val_score_bestthr=71.7153 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.369, mb=0.365, no=1.006, corr=0.191) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.5990 -> 74.4960
[DBG][ep=013] disease_pos_weight=1.0000 mode=none
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.3597 mb_mean=0.3548 norm_overlap=1.0012 corr_cb=0.0328 topkJ=0.0677
[TRAIN][ep=013] loss=2.3156 acc=63.70%
[TRAIN][ep=013] mask_avg: mc_mean=0.3562 mb_mean=0.3459 norm_overlap=1.0023 corr_cb=0.0499
[EPOCH 013/089] train: loss=2.3156 acc=63.70% | val: loss=0.6712 acc=62.90% f1=20.69% auc=49.39% val_score=70.4502 val_score_bestthr=72.5223 | dyn(w_pfs=0.240, w_sup=0.240, w_csuf=0.200, stage2=False) | mask(mc=0.356, mb=0.346, no=1.002, corr=0.050) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.5990 -> 70.4502
[DBG][ep=014] disease_pos_weight=1.0000 mode=none
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.3552 mb_mean=0.3449 norm_overlap=0.9978 corr_cb=-0.0407 topkJ=0.0358
[TRAIN][ep=014] loss=2.5100 acc=63.70%
[TRAIN][ep=014] mask_avg: mc_mean=0.3445 mb_mean=0.3307 norm_overlap=0.9943 corr_cb=-0.0951
[EPOCH 014/089] train: loss=2.5100 acc=63.70% | val: loss=0.6722 acc=66.13% f1=16.00% auc=49.39% val_score=68.5007 val_score_bestthr=73.7211 | dyn(w_pfs=0.280, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.344, mb=0.331, no=0.994, corr=-0.095) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.5990 -> 68.5007
[DBG][ep=015] disease_pos_weight=1.0000 mode=none
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.3352 mb_mean=0.3275 norm_overlap=0.9900 corr_cb=-0.1647 topkJ=0.0481
[TRAIN][ep=015] loss=2.5578 acc=63.70%
[TRAIN][ep=015] mask_avg: mc_mean=0.3355 mb_mean=0.3239 norm_overlap=0.9851 corr_cb=-0.2161
[EPOCH 015/089] train: loss=2.5578 acc=63.70% | val: loss=0.6742 acc=66.13% f1=16.00% auc=50.28% val_score=70.4444 val_score_bestthr=73.7211 | dyn(w_pfs=0.180, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.336, mb=0.324, no=0.985, corr=-0.216) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.5990 -> 70.4444
[DBG][ep=016] disease_pos_weight=1.0000 mode=none
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.3232 mb_mean=0.3131 norm_overlap=0.9736 corr_cb=-0.3096 topkJ=0.0388
[TRAIN][ep=016] loss=1.6717 acc=63.70%
[TRAIN][ep=016] mask_avg: mc_mean=0.3269 mb_mean=0.3239 norm_overlap=0.9768 corr_cb=-0.2971
[EPOCH 016/089] train: loss=1.6717 acc=63.70% | val: loss=0.6768 acc=64.52% f1=21.43% auc=50.28% val_score=62.5416 val_score_bestthr=74.4895 | dyn(w_pfs=0.220, w_sup=0.190, w_csuf=0.140, stage2=False) | mask(mc=0.327, mb=0.324, no=0.977, corr=-0.297) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.5990 -> 62.5416
[DBG][ep=017] disease_pos_weight=1.0000 mode=none
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.3313 mb_mean=0.3369 norm_overlap=0.9807 corr_cb=-0.3093 topkJ=0.0213
[TRAIN][ep=017] loss=2.0202 acc=63.70%
[TRAIN][ep=017] mask_avg: mc_mean=0.3196 mb_mean=0.3239 norm_overlap=0.9691 corr_cb=-0.3535
[EPOCH 017/089] train: loss=2.0202 acc=63.70% | val: loss=0.6794 acc=64.52% f1=21.43% auc=50.17% val_score=66.4420 val_score_bestthr=74.4895 | dyn(w_pfs=0.260, w_sup=0.230, w_csuf=0.180, stage2=False) | mask(mc=0.320, mb=0.324, no=0.969, corr=-0.353) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.5990 -> 66.4420
[DBG][ep=018] disease_pos_weight=1.0000 mode=none
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.3214 mb_mean=0.3380 norm_overlap=0.9723 corr_cb=-0.3854 topkJ=0.0180
[TRAIN][ep=018] loss=2.3638 acc=63.70%
[TRAIN][ep=018] mask_avg: mc_mean=0.3143 mb_mean=0.3239 norm_overlap=0.9616 corr_cb=-0.4027
[EPOCH 018/089] train: loss=2.3638 acc=63.70% | val: loss=0.6830 acc=64.52% f1=21.43% auc=50.61% val_score=70.6074 val_score_bestthr=74.4895 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.314, mb=0.324, no=0.962, corr=-0.403) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.5990 -> 70.6074
[DBG][ep=019] disease_pos_weight=1.0000 mode=none
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.3197 mb_mean=0.3269 norm_overlap=0.9589 corr_cb=-0.4509 topkJ=0.0232
[TRAIN][ep=019] loss=2.5369 acc=63.70%
[TRAIN][ep=019] mask_avg: mc_mean=0.3081 mb_mean=0.3239 norm_overlap=0.9544 corr_cb=-0.4360
[EPOCH 019/089] train: loss=2.5369 acc=63.70% | val: loss=0.6832 acc=64.52% f1=26.67% auc=51.28% val_score=70.8317 val_score_bestthr=77.0136 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.308, mb=0.324, no=0.954, corr=-0.436) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.5990 -> 70.8317
[DBG][ep=020] disease_pos_weight=1.0000 mode=none
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.2920 mb_mean=0.3292 norm_overlap=0.9675 corr_cb=-0.3169 topkJ=0.0122
[TRAIN][ep=020] loss=2.5422 acc=63.70%
[TRAIN][ep=020] mask_avg: mc_mean=0.3029 mb_mean=0.3239 norm_overlap=0.9452 corr_cb=-0.4779
[EPOCH 020/089] train: loss=2.5422 acc=63.70% | val: loss=0.6860 acc=64.52% f1=26.67% auc=51.28% val_score=70.9191 val_score_bestthr=77.0136 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.303, mb=0.324, no=0.945, corr=-0.478) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.5990 -> 70.9191
[DBG][ep=021] disease_pos_weight=1.0000 mode=none
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.3007 mb_mean=0.3309 norm_overlap=0.9549 corr_cb=-0.3888 topkJ=0.0122
[TRAIN][ep=021] loss=2.5374 acc=63.70%
[TRAIN][ep=021] mask_avg: mc_mean=0.2998 mb_mean=0.3239 norm_overlap=0.9405 corr_cb=-0.4930
[EPOCH 021/089] train: loss=2.5374 acc=63.70% | val: loss=0.6886 acc=66.13% f1=32.26% auc=49.94% val_score=66.9126 val_score_bestthr=81.3870 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.300, mb=0.324, no=0.941, corr=-0.493) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.5990 -> 66.9126
[DBG][ep=022] disease_pos_weight=1.0000 mode=none
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2972 mb_mean=0.3398 norm_overlap=0.9442 corr_cb=-0.5408 topkJ=0.0037
[TRAIN][ep=022] loss=2.5273 acc=63.70%
[TRAIN][ep=022] mask_avg: mc_mean=0.2956 mb_mean=0.3239 norm_overlap=0.9319 corr_cb=-0.5258
[EPOCH 022/089] train: loss=2.5273 acc=63.70% | val: loss=0.6896 acc=66.13% f1=36.36% auc=50.72% val_score=70.9779 val_score_bestthr=83.4443 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.296, mb=0.324, no=0.932, corr=-0.526) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.5990 -> 70.9779
[DBG][ep=023] disease_pos_weight=1.0000 mode=none
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2820 mb_mean=0.3236 norm_overlap=0.9219 corr_cb=-0.5636 topkJ=0.0084
[TRAIN][ep=023] loss=2.5175 acc=64.25%
[TRAIN][ep=023] mask_avg: mc_mean=0.2931 mb_mean=0.3239 norm_overlap=0.9266 corr_cb=-0.5390
[EPOCH 023/089] train: loss=2.5175 acc=64.25% | val: loss=0.6939 acc=67.74% f1=44.44% auc=50.95% val_score=66.9126 val_score_bestthr=89.5791 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.293, mb=0.324, no=0.927, corr=-0.539) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.5990 -> 66.9126
[DBG][ep=024] disease_pos_weight=1.0000 mode=none
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2948 mb_mean=0.2944 norm_overlap=0.8749 corr_cb=-0.6269 topkJ=0.0032
[TRAIN][ep=024] loss=2.5087 acc=64.97%
[TRAIN][ep=024] mask_avg: mc_mean=0.2910 mb_mean=0.3239 norm_overlap=0.9218 corr_cb=-0.5491
[EPOCH 024/089] train: loss=2.5087 acc=64.97% | val: loss=0.6933 acc=66.13% f1=32.26% auc=51.95% val_score=71.6969 val_score_bestthr=81.3870 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.291, mb=0.324, no=0.922, corr=-0.549) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.5990 -> 71.6969
[DBG][ep=025] disease_pos_weight=1.0000 mode=none
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2921 mb_mean=0.3110 norm_overlap=0.8913 corr_cb=-0.6324 topkJ=0.0008
[TRAIN][ep=025] loss=2.4957 acc=64.61%
[TRAIN][ep=025] mask_avg: mc_mean=0.2889 mb_mean=0.3239 norm_overlap=0.9145 corr_cb=-0.5690
[EPOCH 025/089] train: loss=2.4957 acc=64.61% | val: loss=0.6972 acc=64.52% f1=31.25% auc=51.06% val_score=68.4942 val_score_bestthr=79.2650 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.289, mb=0.324, no=0.914, corr=-0.569) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.5990 -> 68.4942
[DBG][ep=026] disease_pos_weight=1.0000 mode=none
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2897 mb_mean=0.3245 norm_overlap=0.9157 corr_cb=-0.5866 topkJ=0.0016
[TRAIN][ep=026] loss=2.4831 acc=66.42%
[TRAIN][ep=026] mask_avg: mc_mean=0.2850 mb_mean=0.3239 norm_overlap=0.9079 corr_cb=-0.5863
[EPOCH 026/089] train: loss=2.4831 acc=66.42% | val: loss=0.7014 acc=66.13% f1=27.59% auc=52.17% val_score=73.7610 val_score_bestthr=79.1311 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.285, mb=0.324, no=0.908, corr=-0.586) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.5990 -> 73.7610
[DBG][ep=027] disease_pos_weight=1.0000 mode=none
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2839 mb_mean=0.3074 norm_overlap=0.8822 corr_cb=-0.6152 topkJ=0.0028
[TRAIN][ep=027] loss=2.4820 acc=66.97%
[TRAIN][ep=027] mask_avg: mc_mean=0.2838 mb_mean=0.3239 norm_overlap=0.9026 corr_cb=-0.5996
[EPOCH 027/089] train: loss=2.4820 acc=66.97% | val: loss=0.7104 acc=64.52% f1=26.67% auc=52.29% val_score=72.1205 val_score_bestthr=77.0136 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.284, mb=0.324, no=0.903, corr=-0.600) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.5990 -> 72.1205
[DBG][ep=028] disease_pos_weight=1.0000 mode=none
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2867 mb_mean=0.3297 norm_overlap=0.8950 corr_cb=-0.6564 topkJ=0.0000
[TRAIN][ep=028] loss=2.4667 acc=67.15%
[TRAIN][ep=028] mask_avg: mc_mean=0.2823 mb_mean=0.3239 norm_overlap=0.8965 corr_cb=-0.6125
[EPOCH 028/089] train: loss=2.4667 acc=67.15% | val: loss=0.7027 acc=64.52% f1=38.89% auc=52.29% val_score=72.5631 val_score_bestthr=83.3922 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.282, mb=0.324, no=0.897, corr=-0.612) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.5990 -> 72.5631
[DBG][ep=029] disease_pos_weight=1.0000 mode=none
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2702 mb_mean=0.3294 norm_overlap=0.9123 corr_cb=-0.5708 topkJ=0.0048
[TRAIN][ep=029] loss=1.5869 acc=70.96%
[TRAIN][ep=029] mask_avg: mc_mean=0.2794 mb_mean=0.3239 norm_overlap=0.8938 corr_cb=-0.6127
[EPOCH 029/089] train: loss=1.5869 acc=70.96% | val: loss=0.7189 acc=64.52% f1=31.25% auc=51.84% val_score=73.7610 val_score_bestthr=79.2650 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.279, mb=0.324, no=0.894, corr=-0.613) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.5990 -> 73.7610
[DBG][ep=030] disease_pos_weight=1.0000 mode=none
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2724 mb_mean=0.3204 norm_overlap=0.8991 corr_cb=-0.6013 topkJ=0.0024
[TRAIN][ep=030] loss=0.7153 acc=69.51%
[TRAIN][ep=030] mask_avg: mc_mean=0.2772 mb_mean=0.3239 norm_overlap=0.8866 corr_cb=-0.6327
[EPOCH 030/089] train: loss=0.7153 acc=69.51% | val: loss=0.7199 acc=64.52% f1=38.89% auc=52.06% val_score=72.5631 val_score_bestthr=83.4637 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.277, mb=0.324, no=0.887, corr=-0.633) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.5990 -> 72.5631
[DBG][ep=031] disease_pos_weight=1.0000 mode=none
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2788 mb_mean=0.3303 norm_overlap=0.9056 corr_cb=-0.6001 topkJ=0.0012
[TRAIN][ep=031] loss=0.4556 acc=75.50%
[TRAIN][ep=031] mask_avg: mc_mean=0.2767 mb_mean=0.3239 norm_overlap=0.8843 corr_cb=-0.6370
[EPOCH 031/089] train: loss=0.4556 acc=75.50% | val: loss=0.7256 acc=64.52% f1=31.25% auc=51.73% val_score=72.5631 val_score_bestthr=79.2650 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.277, mb=0.324, no=0.884, corr=-0.637) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.5990 -> 72.5631
[DBG][ep=032] disease_pos_weight=1.0000 mode=none
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2628 mb_mean=0.3298 norm_overlap=0.9123 corr_cb=-0.5541 topkJ=0.0103
[TRAIN][ep=032] loss=0.4419 acc=75.32%
[TRAIN][ep=032] mask_avg: mc_mean=0.2767 mb_mean=0.3239 norm_overlap=0.8843 corr_cb=-0.6357
[EPOCH 032/089] train: loss=0.4419 acc=75.32% | val: loss=0.7292 acc=64.52% f1=38.89% auc=51.73% val_score=72.5631 val_score_bestthr=83.4637 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.277, mb=0.324, no=0.884, corr=-0.636) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.5990 -> 72.5631
[DBG][ep=033] disease_pos_weight=1.0000 mode=none
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2796 mb_mean=0.3284 norm_overlap=0.8842 corr_cb=-0.6847 topkJ=0.0012
[TRAIN][ep=033] loss=0.4395 acc=75.50%
[TRAIN][ep=033] mask_avg: mc_mean=0.2767 mb_mean=0.3239 norm_overlap=0.8845 corr_cb=-0.6344
[EPOCH 033/089] train: loss=0.4395 acc=75.50% | val: loss=0.7320 acc=64.52% f1=35.29% auc=51.73% val_score=72.5631 val_score_bestthr=81.3522 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.277, mb=0.324, no=0.884, corr=-0.634) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.5990 -> 72.5631
[DBG][ep=034] disease_pos_weight=1.0000 mode=none
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2695 mb_mean=0.3216 norm_overlap=0.8843 corr_cb=-0.6540 topkJ=0.0008
[TRAIN][ep=034] loss=0.4369 acc=75.32%
[TRAIN][ep=034] mask_avg: mc_mean=0.2767 mb_mean=0.3239 norm_overlap=0.8845 corr_cb=-0.6358
[EPOCH 034/089] train: loss=0.4369 acc=75.32% | val: loss=0.7377 acc=64.52% f1=31.25% auc=51.51% val_score=72.5631 val_score_bestthr=79.2650 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.277, mb=0.324, no=0.884, corr=-0.636) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.5990 -> 72.5631
[EARLY STOP] no improvement for 30 epochs. best_epoch=4
[CKPT] Loaded best for testing: results/ADHD_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
=============== FIT DONE ===============
[BEST] epoch=4 | val_acc=62.90% | val_f1=0.00% | val_auc=50.84% | val_score=76.5990 | val_score_bestthr=62.9032
[TEST@BEST] thr_used=0.390 | acc=65.58% f1=23.19% auc=56.91% | SP_sex=2.55% EO_sex=3.03% SP_age=4.99% EO_age=15.56%
[TIME] 0.67 min
[OK] Saved: results/ADHD_3x5fold_seed0/fold1_rep1_seed1001/summary_fold_1.json
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5144 mb_mean=0.5150 norm_overlap=1.0001 corr_cb=0.1309 topkJ=0.0912
[TRAIN][ep=000] loss=0.7030 acc=36.48%
[TRAIN][ep=000] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2625
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5154 mb_mean=0.5148 norm_overlap=1.0002 corr_cb=0.2404 topkJ=0.1127
[TRAIN][ep=001] loss=0.6861 acc=62.25%
[TRAIN][ep=001] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2578
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5149 mb_mean=0.5167 norm_overlap=1.0008 corr_cb=0.5338 topkJ=0.2907
[TRAIN][ep=002] loss=0.6733 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2599
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5157 mb_mean=0.5166 norm_overlap=1.0002 corr_cb=0.1407 topkJ=0.0837
[TRAIN][ep=003] loss=0.6626 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2572
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5155 mb_mean=0.5150 norm_overlap=1.0006 corr_cb=0.3877 topkJ=0.2261
[TRAIN][ep=004] loss=0.6580 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2563
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5144 mb_mean=0.5149 norm_overlap=1.0005 corr_cb=0.3178 topkJ=0.2069
[TRAIN][ep=005] loss=0.6563 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2581
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5162 mb_mean=0.5152 norm_overlap=1.0006 corr_cb=0.3963 topkJ=0.1808
[TRAIN][ep=006] loss=0.6549 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2561
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5160 mb_mean=0.5163 norm_overlap=1.0003 corr_cb=0.2399 topkJ=0.1667
[TRAIN][ep=007] loss=0.6540 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2581
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5151 mb_mean=0.5161 norm_overlap=1.0002 corr_cb=0.1733 topkJ=0.1150
[TRAIN][ep=008] loss=0.6529 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2604
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5152 mb_mean=0.5142 norm_overlap=1.0003 corr_cb=0.2795 topkJ=0.1008
[TRAIN][ep=009] loss=0.6519 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2576
================= FIT START (fold=1) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.35 select_by=val_score | eval_thr_mode=best_acc eval_thr_grid=coarse | disease_pos_weight_mode=none freeze_b_after=15 | two_stage=True stage1_ratio=0.35 stage2_lr_mult=0.3 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5146 mb_mean=0.5164 norm_overlap=1.0004 corr_cb=0.2841 topkJ=0.1112
[TRAIN][ep=000] loss=0.6509 acc=63.70%
[TRAIN][ep=000] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2587
[EPOCH 000/089] train: loss=0.6509 acc=63.70% | val: loss=0.6618 acc=62.90% f1=0.00% auc=51.17% val_score=75.9222 val_score_bestthr=62.9032 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.515, mb=0.515, no=1.000, corr=0.259) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* -1000000000000000000.0000 -> 75.9222
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5151 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=0.0509 topkJ=0.0799
[TRAIN][ep=001] loss=0.6497 acc=63.70%
[TRAIN][ep=001] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2578
[EPOCH 001/089] train: loss=0.6497 acc=63.70% | val: loss=0.6613 acc=62.90% f1=0.00% auc=51.39% val_score=70.6616 val_score_bestthr=62.9032 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.515, mb=0.515, no=1.000, corr=0.258) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 75.9222 -> 70.6616
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5143 mb_mean=0.5158 norm_overlap=1.0002 corr_cb=0.1856 topkJ=0.1505
[TRAIN][ep=002] loss=0.6486 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2621
[EPOCH 002/089] train: loss=0.6486 acc=63.70% | val: loss=0.6610 acc=62.90% f1=0.00% auc=50.84% val_score=68.7100 val_score_bestthr=62.9032 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.515, mb=0.515, no=1.000, corr=0.262) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 75.9222 -> 68.7100
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5142 mb_mean=0.5139 norm_overlap=1.0007 corr_cb=0.4700 topkJ=0.2643
[TRAIN][ep=003] loss=0.6477 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2561
[EPOCH 003/089] train: loss=0.6477 acc=63.70% | val: loss=0.6609 acc=62.90% f1=0.00% auc=50.95% val_score=74.6154 val_score_bestthr=62.9032 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.515, mb=0.515, no=1.000, corr=0.256) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 75.9222 -> 74.6154
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5147 mb_mean=0.5159 norm_overlap=1.0007 corr_cb=0.4334 topkJ=0.1914
[TRAIN][ep=004] loss=0.6459 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2609
[EPOCH 004/089] train: loss=0.6459 acc=63.70% | val: loss=0.6609 acc=62.90% f1=0.00% auc=50.84% val_score=76.5990 val_score_bestthr=62.9032 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.515, mb=0.515, no=1.000, corr=0.261) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 75.9222 -> 76.5990
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5137 mb_mean=0.5154 norm_overlap=1.0001 corr_cb=0.0616 topkJ=0.0627
[TRAIN][ep=005] loss=1.8988 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.5037 mb_mean=0.5039 norm_overlap=1.0002 corr_cb=0.1640
[EPOCH 005/089] train: loss=1.8988 acc=63.70% | val: loss=0.6615 acc=62.90% f1=0.00% auc=51.06% val_score=74.1771 val_score_bestthr=62.9032 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.504, mb=0.504, no=1.000, corr=0.164) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.5990 -> 74.1771
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4916 mb_mean=0.4885 norm_overlap=1.0009 corr_cb=0.3783 topkJ=0.1422
[TRAIN][ep=006] loss=1.2954 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.4820 mb_mean=0.4784 norm_overlap=1.0006 corr_cb=0.2372
[EPOCH 006/089] train: loss=1.2954 acc=63.70% | val: loss=0.6616 acc=62.90% f1=0.00% auc=51.62% val_score=72.1339 val_score_bestthr=62.9032 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.482, mb=0.478, no=1.001, corr=0.237) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.5990 -> 72.1339
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4674 mb_mean=0.4598 norm_overlap=1.0018 corr_cb=0.4192 topkJ=0.1193
[TRAIN][ep=007] loss=0.6979 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.4601 mb_mean=0.4489 norm_overlap=1.0020 corr_cb=0.3764
[EPOCH 007/089] train: loss=0.6979 acc=63.70% | val: loss=0.6624 acc=62.90% f1=0.00% auc=51.17% val_score=75.1577 val_score_bestthr=62.9032 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.460, mb=0.449, no=1.002, corr=0.376) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.5990 -> 75.1577
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4529 mb_mean=0.4368 norm_overlap=1.0022 corr_cb=0.3460 topkJ=0.0627
[TRAIN][ep=008] loss=0.5774 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.4382 mb_mean=0.4157 norm_overlap=1.0043 corr_cb=0.3973
[EPOCH 008/089] train: loss=0.5774 acc=63.70% | val: loss=0.6627 acc=64.52% f1=21.43% auc=51.17% val_score=74.1351 val_score_bestthr=74.5444 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.438, mb=0.416, no=1.004, corr=0.397) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.5990 -> 74.1351
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4196 mb_mean=0.3878 norm_overlap=1.0095 corr_cb=0.5088 topkJ=0.2034
[TRAIN][ep=009] loss=0.8076 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.4178 mb_mean=0.3819 norm_overlap=1.0062 corr_cb=0.3271
[EPOCH 009/089] train: loss=0.8076 acc=63.70% | val: loss=0.6648 acc=64.52% f1=8.33% auc=51.28% val_score=76.8941 val_score_bestthr=68.4365 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.418, mb=0.382, no=1.006, corr=0.327) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 76.5990 -> 76.8941
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=010] disease_pos_weight=1.0000 mode=none
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.4096 mb_mean=0.3657 norm_overlap=1.0056 corr_cb=0.2402 topkJ=0.0712
[TRAIN][ep=010] loss=1.0392 acc=63.70%
[TRAIN][ep=010] mask_avg: mc_mean=0.4000 mb_mean=0.3513 norm_overlap=1.0052 corr_cb=0.1704
[EPOCH 010/089] train: loss=1.0392 acc=63.70% | val: loss=0.6665 acc=64.52% f1=15.38% auc=49.94% val_score=72.4940 val_score_bestthr=71.7153 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.400, mb=0.351, no=1.005, corr=0.170) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.8941 -> 72.4940
[DBG][ep=011] disease_pos_weight=1.0000 mode=none
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.3803 mb_mean=0.3218 norm_overlap=1.0047 corr_cb=0.1153 topkJ=0.0892
[TRAIN][ep=011] loss=1.2690 acc=63.70%
[TRAIN][ep=011] mask_avg: mc_mean=0.3854 mb_mean=0.3261 norm_overlap=1.0002 corr_cb=0.0047
[EPOCH 011/089] train: loss=1.2690 acc=63.70% | val: loss=0.6690 acc=64.52% f1=8.33% auc=49.83% val_score=71.4330 val_score_bestthr=68.4365 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.385, mb=0.326, no=1.000, corr=0.005) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.8941 -> 71.4330
[DBG][ep=012] disease_pos_weight=1.0000 mode=none
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.3842 mb_mean=0.3314 norm_overlap=0.9966 corr_cb=-0.0744 topkJ=0.0292
[TRAIN][ep=012] loss=1.5001 acc=63.70%
[TRAIN][ep=012] mask_avg: mc_mean=0.3718 mb_mean=0.3077 norm_overlap=0.9871 corr_cb=-0.2029
[EPOCH 012/089] train: loss=1.5001 acc=63.70% | val: loss=0.6706 acc=64.52% f1=15.38% auc=49.83% val_score=71.4330 val_score_bestthr=71.7153 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.372, mb=0.308, no=0.987, corr=-0.203) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.8941 -> 71.4330
[DBG][ep=013] disease_pos_weight=1.0000 mode=none
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.3612 mb_mean=0.3020 norm_overlap=0.9724 corr_cb=-0.3853 topkJ=0.0144
[TRAIN][ep=013] loss=1.7260 acc=63.70%
[TRAIN][ep=013] mask_avg: mc_mean=0.3598 mb_mean=0.2953 norm_overlap=0.9583 corr_cb=-0.4536
[EPOCH 013/089] train: loss=1.7260 acc=63.70% | val: loss=0.6730 acc=62.90% f1=20.69% auc=49.72% val_score=69.4035 val_score_bestthr=72.5223 | dyn(w_pfs=0.100, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.360, mb=0.295, no=0.958, corr=-0.454) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.8941 -> 69.4035
[DBG][ep=014] disease_pos_weight=1.0000 mode=none
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.3587 mb_mean=0.3013 norm_overlap=0.9364 corr_cb=-0.5873 topkJ=0.0008
[TRAIN][ep=014] loss=1.1318 acc=63.70%
[TRAIN][ep=014] mask_avg: mc_mean=0.3482 mb_mean=0.2874 norm_overlap=0.9031 corr_cb=-0.6714
[EPOCH 014/089] train: loss=1.1318 acc=63.70% | val: loss=0.6740 acc=64.52% f1=15.38% auc=50.06% val_score=66.4546 val_score_bestthr=71.7153 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.348, mb=0.287, no=0.903, corr=-0.671) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.8941 -> 66.4546
[DBG][ep=015] disease_pos_weight=1.0000 mode=none
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.3389 mb_mean=0.2880 norm_overlap=0.8770 corr_cb=-0.7507 topkJ=0.0000
[TRAIN][ep=015] loss=0.5345 acc=63.70%
[TRAIN][ep=015] mask_avg: mc_mean=0.3390 mb_mean=0.2846 norm_overlap=0.8427 corr_cb=-0.7957
[EPOCH 015/089] train: loss=0.5345 acc=63.70% | val: loss=0.6783 acc=66.13% f1=22.22% auc=49.61% val_score=63.5308 val_score_bestthr=76.5845 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.339, mb=0.285, no=0.843, corr=-0.796) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 63.5308
[DBG][ep=016] disease_pos_weight=1.0000 mode=none
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.3309 mb_mean=0.2753 norm_overlap=0.7770 corr_cb=-0.8574 topkJ=0.0000
[TRAIN][ep=016] loss=0.7614 acc=63.70%
[TRAIN][ep=016] mask_avg: mc_mean=0.3312 mb_mean=0.2846 norm_overlap=0.8006 corr_cb=-0.8371
[EPOCH 016/089] train: loss=0.7614 acc=63.70% | val: loss=0.6823 acc=66.13% f1=22.22% auc=49.28% val_score=61.6020 val_score_bestthr=76.5845 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.331, mb=0.285, no=0.801, corr=-0.837) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 61.6020
[DBG][ep=017] disease_pos_weight=1.0000 mode=none
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.3326 mb_mean=0.2913 norm_overlap=0.8417 corr_cb=-0.8111 topkJ=0.0000
[TRAIN][ep=017] loss=0.9919 acc=63.70%
[TRAIN][ep=017] mask_avg: mc_mean=0.3259 mb_mean=0.2846 norm_overlap=0.7665 corr_cb=-0.8575
[EPOCH 017/089] train: loss=0.9919 acc=63.70% | val: loss=0.6851 acc=66.13% f1=22.22% auc=49.83% val_score=67.3733 val_score_bestthr=76.5845 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.326, mb=0.285, no=0.766, corr=-0.858) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 67.3733
[DBG][ep=018] disease_pos_weight=1.0000 mode=none
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.3215 mb_mean=0.2967 norm_overlap=0.8088 corr_cb=-0.8360 topkJ=0.0000
[TRAIN][ep=018] loss=1.2188 acc=63.88%
[TRAIN][ep=018] mask_avg: mc_mean=0.3224 mb_mean=0.2846 norm_overlap=0.7379 corr_cb=-0.8703
[EPOCH 018/089] train: loss=1.2188 acc=63.88% | val: loss=0.6917 acc=64.52% f1=26.67% auc=50.61% val_score=75.4576 val_score_bestthr=77.0136 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.322, mb=0.285, no=0.738, corr=-0.870) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 75.4576
[DBG][ep=019] disease_pos_weight=1.0000 mode=none
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.3310 mb_mean=0.2862 norm_overlap=0.7280 corr_cb=-0.8892 topkJ=0.0000
[TRAIN][ep=019] loss=1.4467 acc=63.70%
[TRAIN][ep=019] mask_avg: mc_mean=0.3186 mb_mean=0.2846 norm_overlap=0.7135 corr_cb=-0.8734
[EPOCH 019/089] train: loss=1.4467 acc=63.70% | val: loss=0.6890 acc=64.52% f1=26.67% auc=50.95% val_score=70.0135 val_score_bestthr=77.0136 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.319, mb=0.285, no=0.714, corr=-0.873) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 70.0135
[DBG][ep=020] disease_pos_weight=1.0000 mode=none
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.2917 mb_mean=0.2893 norm_overlap=0.7605 corr_cb=-0.7783 topkJ=0.0000
[TRAIN][ep=020] loss=1.6754 acc=63.70%
[TRAIN][ep=020] mask_avg: mc_mean=0.3152 mb_mean=0.2846 norm_overlap=0.6901 corr_cb=-0.8797
[EPOCH 020/089] train: loss=1.6754 acc=63.70% | val: loss=0.6913 acc=64.52% f1=26.67% auc=50.95% val_score=72.0028 val_score_bestthr=77.0136 | dyn(w_pfs=0.240, w_sup=0.240, w_csuf=0.200, stage2=False) | mask(mc=0.315, mb=0.285, no=0.690, corr=-0.880) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 72.0028
[DBG][ep=021] disease_pos_weight=1.0000 mode=none
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.3084 mb_mean=0.2954 norm_overlap=0.7073 corr_cb=-0.8526 topkJ=0.0000
[TRAIN][ep=021] loss=1.7474 acc=64.07%
[TRAIN][ep=021] mask_avg: mc_mean=0.3128 mb_mean=0.2846 norm_overlap=0.6758 corr_cb=-0.8762
[EPOCH 021/089] train: loss=1.7474 acc=64.07% | val: loss=0.6955 acc=66.13% f1=32.26% auc=50.17% val_score=75.0064 val_score_bestthr=81.4495 | dyn(w_pfs=0.280, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.313, mb=0.285, no=0.676, corr=-0.876) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 75.0064
[DBG][ep=022] disease_pos_weight=1.0000 mode=none
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2969 mb_mean=0.3040 norm_overlap=0.7009 corr_cb=-0.8915 topkJ=0.0000
[TRAIN][ep=022] loss=1.7646 acc=63.88%
[TRAIN][ep=022] mask_avg: mc_mean=0.3093 mb_mean=0.2846 norm_overlap=0.6578 corr_cb=-0.8807
[EPOCH 022/089] train: loss=1.7646 acc=63.88% | val: loss=0.6961 acc=64.52% f1=26.67% auc=49.94% val_score=73.0557 val_score_bestthr=77.0136 | dyn(w_pfs=0.320, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.309, mb=0.285, no=0.658, corr=-0.881) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 73.0557
[DBG][ep=023] disease_pos_weight=1.0000 mode=none
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2915 mb_mean=0.2948 norm_overlap=0.6026 corr_cb=-0.9144 topkJ=0.0000
[TRAIN][ep=023] loss=1.7636 acc=64.61%
[TRAIN][ep=023] mask_avg: mc_mean=0.3064 mb_mean=0.2846 norm_overlap=0.6463 corr_cb=-0.8746
[EPOCH 023/089] train: loss=1.7636 acc=64.61% | val: loss=0.7026 acc=64.52% f1=38.89% auc=51.62% val_score=77.7912 val_score_bestthr=83.3727 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.306, mb=0.285, no=0.646, corr=-0.875) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=* 76.8941 -> 77.7912
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=024] disease_pos_weight=1.0000 mode=none
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.3310 mb_mean=0.2563 norm_overlap=0.5340 corr_cb=-0.8906 topkJ=0.0000
[TRAIN][ep=024] loss=1.7614 acc=66.06%
[TRAIN][ep=024] mask_avg: mc_mean=0.3035 mb_mean=0.2846 norm_overlap=0.6354 corr_cb=-0.8710
[EPOCH 024/089] train: loss=1.7614 acc=66.06% | val: loss=0.7025 acc=64.52% f1=38.89% auc=51.51% val_score=71.7636 val_score_bestthr=83.3727 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.303, mb=0.285, no=0.635, corr=-0.871) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 77.7912 -> 71.7636
[DBG][ep=025] disease_pos_weight=1.0000 mode=none
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.3170 mb_mean=0.2726 norm_overlap=0.5579 corr_cb=-0.8981 topkJ=0.0000
[TRAIN][ep=025] loss=1.7479 acc=65.34%
[TRAIN][ep=025] mask_avg: mc_mean=0.3023 mb_mean=0.2846 norm_overlap=0.6239 corr_cb=-0.8703
[EPOCH 025/089] train: loss=1.7479 acc=65.34% | val: loss=0.7067 acc=64.52% f1=26.67% auc=51.28% val_score=68.5852 val_score_bestthr=77.0136 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.302, mb=0.285, no=0.624, corr=-0.870) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 77.7912 -> 68.5852
[DBG][ep=026] disease_pos_weight=1.0000 mode=none
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.3028 mb_mean=0.2800 norm_overlap=0.6392 corr_cb=-0.8676 topkJ=0.0000
[TRAIN][ep=026] loss=1.7341 acc=67.33%
[TRAIN][ep=026] mask_avg: mc_mean=0.2981 mb_mean=0.2846 norm_overlap=0.6124 corr_cb=-0.8704
[EPOCH 026/089] train: loss=1.7341 acc=67.33% | val: loss=0.7146 acc=64.52% f1=38.89% auc=51.28% val_score=71.7636 val_score_bestthr=83.3727 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.298, mb=0.285, no=0.612, corr=-0.870) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 77.7912 -> 71.7636
[DBG][ep=027] disease_pos_weight=1.0000 mode=none
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.3067 mb_mean=0.2719 norm_overlap=0.5410 corr_cb=-0.8796 topkJ=0.0000
[TRAIN][ep=027] loss=1.7352 acc=68.60%
[TRAIN][ep=027] mask_avg: mc_mean=0.2966 mb_mean=0.2846 norm_overlap=0.6039 corr_cb=-0.8693
[EPOCH 027/089] train: loss=1.7352 acc=68.60% | val: loss=0.7254 acc=64.52% f1=38.89% auc=51.51% val_score=68.0453 val_score_bestthr=83.3727 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.297, mb=0.285, no=0.604, corr=-0.869) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 77.7912 -> 68.0453
[DBG][ep=028] disease_pos_weight=1.0000 mode=none
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2966 mb_mean=0.2940 norm_overlap=0.5879 corr_cb=-0.9133 topkJ=0.0000
[TRAIN][ep=028] loss=1.7175 acc=69.15%
[TRAIN][ep=028] mask_avg: mc_mean=0.2944 mb_mean=0.2846 norm_overlap=0.5947 corr_cb=-0.8690
[EPOCH 028/089] train: loss=1.7175 acc=69.15% | val: loss=0.7198 acc=66.13% f1=36.36% auc=51.84% val_score=72.5631 val_score_bestthr=83.5741 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.294, mb=0.285, no=0.595, corr=-0.869) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 77.7912 -> 72.5631
[DBG][ep=029] disease_pos_weight=1.0000 mode=none
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2751 mb_mean=0.2900 norm_overlap=0.6307 corr_cb=-0.8152 topkJ=0.0000
[TRAIN][ep=029] loss=1.7002 acc=73.14%
[TRAIN][ep=029] mask_avg: mc_mean=0.2916 mb_mean=0.2846 norm_overlap=0.5905 corr_cb=-0.8610
[EPOCH 029/089] train: loss=1.7002 acc=73.14% | val: loss=0.7388 acc=66.13% f1=36.36% auc=51.39% val_score=67.0118 val_score_bestthr=83.5741 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.292, mb=0.285, no=0.591, corr=-0.861) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 77.7912 -> 67.0118
[DBG][ep=030] disease_pos_weight=1.0000 mode=none
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2838 mb_mean=0.2759 norm_overlap=0.6111 corr_cb=-0.8213 topkJ=0.0000
[TRAIN][ep=030] loss=1.6810 acc=72.23%
[TRAIN][ep=030] mask_avg: mc_mean=0.2884 mb_mean=0.2846 norm_overlap=0.5808 corr_cb=-0.8653
[EPOCH 030/089] train: loss=1.6810 acc=72.23% | val: loss=0.7320 acc=66.13% f1=40.00% auc=52.40% val_score=72.5631 val_score_bestthr=85.5834 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.288, mb=0.285, no=0.581, corr=-0.865) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 77.7912 -> 72.5631
[DBG][ep=031] disease_pos_weight=1.0000 mode=none
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2898 mb_mean=0.2895 norm_overlap=0.6083 corr_cb=-0.8752 topkJ=0.0000
[TRAIN][ep=031] loss=0.4884 acc=75.68%
[TRAIN][ep=031] mask_avg: mc_mean=0.2876 mb_mean=0.2846 norm_overlap=0.5795 corr_cb=-0.8608
[EPOCH 031/089] train: loss=0.4884 acc=75.68% | val: loss=0.7401 acc=64.52% f1=31.25% auc=51.73% val_score=69.8745 val_score_bestthr=79.3942 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.288, mb=0.285, no=0.580, corr=-0.861) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 77.7912 -> 69.8745
[DBG][ep=032] disease_pos_weight=1.0000 mode=none
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2655 mb_mean=0.2933 norm_overlap=0.6271 corr_cb=-0.8389 topkJ=0.0000
[TRAIN][ep=032] loss=0.4089 acc=74.77%
[TRAIN][ep=032] mask_avg: mc_mean=0.2877 mb_mean=0.2846 norm_overlap=0.5793 corr_cb=-0.8610
[EPOCH 032/089] train: loss=0.4089 acc=74.77% | val: loss=0.7439 acc=64.52% f1=35.29% auc=51.84% val_score=69.8745 val_score_bestthr=81.6528 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.288, mb=0.285, no=0.579, corr=-0.861) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 77.7912 -> 69.8745
[DBG][ep=033] disease_pos_weight=1.0000 mode=none
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2936 mb_mean=0.2824 norm_overlap=0.5872 corr_cb=-0.8720 topkJ=0.0000
[TRAIN][ep=033] loss=0.4063 acc=75.32%
[TRAIN][ep=033] mask_avg: mc_mean=0.2876 mb_mean=0.2846 norm_overlap=0.5798 corr_cb=-0.8596
[EPOCH 033/089] train: loss=0.4063 acc=75.32% | val: loss=0.7477 acc=64.52% f1=38.89% auc=51.73% val_score=69.8745 val_score_bestthr=83.3922 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.288, mb=0.285, no=0.580, corr=-0.860) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 77.7912 -> 69.8745
[DBG][ep=034] disease_pos_weight=1.0000 mode=none
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2884 mb_mean=0.2789 norm_overlap=0.5584 corr_cb=-0.8858 topkJ=0.0000
[TRAIN][ep=034] loss=0.4035 acc=75.14%
[TRAIN][ep=034] mask_avg: mc_mean=0.2876 mb_mean=0.2846 norm_overlap=0.5800 corr_cb=-0.8597
[EPOCH 034/089] train: loss=0.4035 acc=75.14% | val: loss=0.7547 acc=64.52% f1=35.29% auc=51.51% val_score=67.0118 val_score_bestthr=81.6528 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.288, mb=0.285, no=0.580, corr=-0.860) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 77.7912 -> 67.0118
[DBG][ep=035] disease_pos_weight=1.0000 mode=none
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2923 mb_mean=0.2895 norm_overlap=0.5639 corr_cb=-0.8663 topkJ=0.0000
[TRAIN][ep=035] loss=0.4016 acc=75.50%
[TRAIN][ep=035] mask_avg: mc_mean=0.2877 mb_mean=0.2846 norm_overlap=0.5793 corr_cb=-0.8601
[EPOCH 035/089] train: loss=0.4016 acc=75.50% | val: loss=0.7587 acc=64.52% f1=35.29% auc=51.51% val_score=67.0118 val_score_bestthr=81.6528 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.288, mb=0.285, no=0.579, corr=-0.860) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 77.7912 -> 67.0118
[DBG][ep=036] disease_pos_weight=1.0000 mode=none
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.3256 mb_mean=0.2647 norm_overlap=0.4550 corr_cb=-0.9254 topkJ=0.0000
[TRAIN][ep=036] loss=0.3984 acc=74.77%
[TRAIN][ep=036] mask_avg: mc_mean=0.2877 mb_mean=0.2846 norm_overlap=0.5792 corr_cb=-0.8612
[EPOCH 036/089] train: loss=0.3984 acc=74.77% | val: loss=0.7632 acc=64.52% f1=31.25% auc=51.73% val_score=67.0118 val_score_bestthr=79.3942 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.288, mb=0.285, no=0.579, corr=-0.861) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 77.7912 -> 67.0118
[DBG][ep=037] disease_pos_weight=1.0000 mode=none
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.2797 mb_mean=0.2972 norm_overlap=0.6217 corr_cb=-0.8684 topkJ=0.0000
[TRAIN][ep=037] loss=0.3959 acc=75.32%
[TRAIN][ep=037] mask_avg: mc_mean=0.2876 mb_mean=0.2846 norm_overlap=0.5797 corr_cb=-0.8604
[EPOCH 037/089] train: loss=0.3959 acc=75.32% | val: loss=0.7643 acc=66.13% f1=40.00% auc=51.95% val_score=69.8745 val_score_bestthr=85.5834 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.288, mb=0.285, no=0.580, corr=-0.860) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 77.7912 -> 69.8745
[DBG][ep=038] disease_pos_weight=1.0000 mode=none
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2887 mb_mean=0.2858 norm_overlap=0.5422 corr_cb=-0.8867 topkJ=0.0000
[TRAIN][ep=038] loss=0.3940 acc=75.86%
[TRAIN][ep=038] mask_avg: mc_mean=0.2877 mb_mean=0.2846 norm_overlap=0.5799 corr_cb=-0.8597
[EPOCH 038/089] train: loss=0.3940 acc=75.86% | val: loss=0.7647 acc=64.52% f1=38.89% auc=52.17% val_score=69.8745 val_score_bestthr=83.3922 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.288, mb=0.285, no=0.580, corr=-0.860) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 77.7912 -> 69.8745
[DBG][ep=039] disease_pos_weight=1.0000 mode=none
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2975 mb_mean=0.2828 norm_overlap=0.5629 corr_cb=-0.8916 topkJ=0.0000
[TRAIN][ep=039] loss=0.3909 acc=76.59%
[TRAIN][ep=039] mask_avg: mc_mean=0.2877 mb_mean=0.2846 norm_overlap=0.5795 corr_cb=-0.8604
[EPOCH 039/089] train: loss=0.3909 acc=76.59% | val: loss=0.7699 acc=66.13% f1=36.36% auc=51.95% val_score=69.8745 val_score_bestthr=83.8080 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.288, mb=0.285, no=0.580, corr=-0.860) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 77.7912 -> 69.8745
[DBG][ep=040] disease_pos_weight=1.0000 mode=none
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.2986 mb_mean=0.2745 norm_overlap=0.5641 corr_cb=-0.8606 topkJ=0.0000
[TRAIN][ep=040] loss=0.3889 acc=76.04%
[TRAIN][ep=040] mask_avg: mc_mean=0.2877 mb_mean=0.2846 norm_overlap=0.5794 corr_cb=-0.8607
[EPOCH 040/089] train: loss=0.3889 acc=76.04% | val: loss=0.7772 acc=64.52% f1=31.25% auc=51.62% val_score=69.8745 val_score_bestthr=79.3942 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.288, mb=0.285, no=0.579, corr=-0.861) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 77.7912 -> 69.8745
[DBG][ep=041] disease_pos_weight=1.0000 mode=none
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.2723 mb_mean=0.2877 norm_overlap=0.6162 corr_cb=-0.8225 topkJ=0.0000
[TRAIN][ep=041] loss=0.3861 acc=76.04%
[TRAIN][ep=041] mask_avg: mc_mean=0.2876 mb_mean=0.2846 norm_overlap=0.5790 corr_cb=-0.8608
[EPOCH 041/089] train: loss=0.3861 acc=76.04% | val: loss=0.7779 acc=66.13% f1=36.36% auc=51.73% val_score=69.8745 val_score_bestthr=83.8080 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.288, mb=0.285, no=0.579, corr=-0.861) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 77.7912 -> 69.8745
[DBG][ep=042] disease_pos_weight=1.0000 mode=none
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.3190 mb_mean=0.2782 norm_overlap=0.5041 corr_cb=-0.9207 topkJ=0.0000
[TRAIN][ep=042] loss=0.3838 acc=76.77%
[TRAIN][ep=042] mask_avg: mc_mean=0.2877 mb_mean=0.2846 norm_overlap=0.5793 corr_cb=-0.8606
[EPOCH 042/089] train: loss=0.3838 acc=76.77% | val: loss=0.7797 acc=64.52% f1=31.25% auc=51.84% val_score=69.8745 val_score_bestthr=79.3942 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.288, mb=0.285, no=0.579, corr=-0.861) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 77.7912 -> 69.8745
[DBG][ep=043] disease_pos_weight=1.0000 mode=none
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.2887 mb_mean=0.2902 norm_overlap=0.6124 corr_cb=-0.8652 topkJ=0.0000
[TRAIN][ep=043] loss=0.3815 acc=76.59%
[TRAIN][ep=043] mask_avg: mc_mean=0.2876 mb_mean=0.2846 norm_overlap=0.5798 corr_cb=-0.8601
[EPOCH 043/089] train: loss=0.3815 acc=76.59% | val: loss=0.7871 acc=66.13% f1=36.36% auc=51.39% val_score=69.8745 val_score_bestthr=83.8080 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.288, mb=0.285, no=0.580, corr=-0.860) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 77.7912 -> 69.8745
[DBG][ep=044] disease_pos_weight=1.0000 mode=none
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2702 mb_mean=0.2921 norm_overlap=0.6252 corr_cb=-0.8387 topkJ=0.0000
[TRAIN][ep=044] loss=0.3791 acc=76.95%
[TRAIN][ep=044] mask_avg: mc_mean=0.2877 mb_mean=0.2846 norm_overlap=0.5792 corr_cb=-0.8609
[EPOCH 044/089] train: loss=0.3791 acc=76.95% | val: loss=0.7903 acc=66.13% f1=36.36% auc=51.73% val_score=69.8745 val_score_bestthr=83.8080 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.288, mb=0.285, no=0.579, corr=-0.861) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 77.7912 -> 69.8745
[DBG][ep=045] disease_pos_weight=1.0000 mode=none
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2807 mb_mean=0.2733 norm_overlap=0.5691 corr_cb=-0.8235 topkJ=0.0000
[TRAIN][ep=045] loss=0.3771 acc=76.23%
[TRAIN][ep=045] mask_avg: mc_mean=0.2877 mb_mean=0.2846 norm_overlap=0.5792 corr_cb=-0.8605
[EPOCH 045/089] train: loss=0.3771 acc=76.23% | val: loss=0.7926 acc=64.52% f1=31.25% auc=51.51% val_score=69.8745 val_score_bestthr=79.3942 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.288, mb=0.285, no=0.579, corr=-0.860) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 77.7912 -> 69.8745
[DBG][ep=046] disease_pos_weight=1.0000 mode=none
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.3018 mb_mean=0.2713 norm_overlap=0.4928 corr_cb=-0.8804 topkJ=0.0000
[TRAIN][ep=046] loss=0.3741 acc=76.59%
[TRAIN][ep=046] mask_avg: mc_mean=0.2877 mb_mean=0.2846 norm_overlap=0.5789 corr_cb=-0.8615
[EPOCH 046/089] train: loss=0.3741 acc=76.59% | val: loss=0.7944 acc=64.52% f1=31.25% auc=51.84% val_score=69.8745 val_score_bestthr=79.3942 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.288, mb=0.285, no=0.579, corr=-0.861) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 77.7912 -> 69.8745
[DBG][ep=047] disease_pos_weight=1.0000 mode=none
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.2998 mb_mean=0.2948 norm_overlap=0.5408 corr_cb=-0.9188 topkJ=0.0000
[TRAIN][ep=047] loss=0.3722 acc=76.23%
[TRAIN][ep=047] mask_avg: mc_mean=0.2876 mb_mean=0.2846 norm_overlap=0.5794 corr_cb=-0.8604
[EPOCH 047/089] train: loss=0.3722 acc=76.23% | val: loss=0.8007 acc=66.13% f1=36.36% auc=51.73% val_score=69.8745 val_score_bestthr=83.8080 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.288, mb=0.285, no=0.579, corr=-0.860) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 77.7912 -> 69.8745
[DBG][ep=048] disease_pos_weight=1.0000 mode=none
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.2768 mb_mean=0.2981 norm_overlap=0.5951 corr_cb=-0.8669 topkJ=0.0000
[TRAIN][ep=048] loss=0.3695 acc=77.50%
[TRAIN][ep=048] mask_avg: mc_mean=0.2877 mb_mean=0.2846 norm_overlap=0.5795 corr_cb=-0.8603
[EPOCH 048/089] train: loss=0.3695 acc=77.50% | val: loss=0.8032 acc=64.52% f1=31.25% auc=51.62% val_score=69.8745 val_score_bestthr=79.3942 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.288, mb=0.285, no=0.580, corr=-0.860) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 77.7912 -> 69.8745
[DBG][ep=049] disease_pos_weight=1.0000 mode=none
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.2944 mb_mean=0.2816 norm_overlap=0.5303 corr_cb=-0.9067 topkJ=0.0000
[TRAIN][ep=049] loss=0.3674 acc=76.59%
[TRAIN][ep=049] mask_avg: mc_mean=0.2877 mb_mean=0.2846 norm_overlap=0.5793 corr_cb=-0.8602
[EPOCH 049/089] train: loss=0.3674 acc=76.59% | val: loss=0.8014 acc=64.52% f1=31.25% auc=51.95% val_score=69.8745 val_score_bestthr=79.3942 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.288, mb=0.285, no=0.579, corr=-0.860) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 77.7912 -> 69.8745
[DBG][ep=050] disease_pos_weight=1.0000 mode=none
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.2798 mb_mean=0.2982 norm_overlap=0.5982 corr_cb=-0.8976 topkJ=0.0000
[TRAIN][ep=050] loss=0.3656 acc=78.22%
[TRAIN][ep=050] mask_avg: mc_mean=0.2876 mb_mean=0.2846 norm_overlap=0.5800 corr_cb=-0.8595
[EPOCH 050/089] train: loss=0.3656 acc=78.22% | val: loss=0.8076 acc=64.52% f1=35.29% auc=51.84% val_score=69.8745 val_score_bestthr=81.7147 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.288, mb=0.285, no=0.580, corr=-0.860) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 77.7912 -> 69.8745
[DBG][ep=051] disease_pos_weight=1.0000 mode=none
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.2582 mb_mean=0.3007 norm_overlap=0.6589 corr_cb=-0.8142 topkJ=0.0000
[TRAIN][ep=051] loss=0.3628 acc=77.86%
[TRAIN][ep=051] mask_avg: mc_mean=0.2877 mb_mean=0.2846 norm_overlap=0.5796 corr_cb=-0.8604
[EPOCH 051/089] train: loss=0.3628 acc=77.86% | val: loss=0.8132 acc=64.52% f1=31.25% auc=51.84% val_score=69.8745 val_score_bestthr=79.3942 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.288, mb=0.285, no=0.580, corr=-0.860) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 77.7912 -> 69.8745
[DBG][ep=052] disease_pos_weight=1.0000 mode=none
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.2689 mb_mean=0.2838 norm_overlap=0.6178 corr_cb=-0.8069 topkJ=0.0000
[TRAIN][ep=052] loss=0.3608 acc=78.22%
[TRAIN][ep=052] mask_avg: mc_mean=0.2877 mb_mean=0.2846 norm_overlap=0.5788 corr_cb=-0.8619
[EPOCH 052/089] train: loss=0.3608 acc=78.22% | val: loss=0.8186 acc=64.52% f1=31.25% auc=51.84% val_score=69.8745 val_score_bestthr=79.3942 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.288, mb=0.285, no=0.579, corr=-0.862) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 77.7912 -> 69.8745
[DBG][ep=053] disease_pos_weight=1.0000 mode=none
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.2705 mb_mean=0.3042 norm_overlap=0.7046 corr_cb=-0.8034 topkJ=0.0000
[TRAIN][ep=053] loss=0.3588 acc=78.40%
[TRAIN][ep=053] mask_avg: mc_mean=0.2877 mb_mean=0.2846 norm_overlap=0.5797 corr_cb=-0.8599
[EPOCH 053/089] train: loss=0.3588 acc=78.40% | val: loss=0.8199 acc=64.52% f1=31.25% auc=51.84% val_score=69.8745 val_score_bestthr=79.3942 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.288, mb=0.285, no=0.580, corr=-0.860) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 77.7912 -> 69.8745
[EARLY STOP] no improvement for 30 epochs. best_epoch=23
[CKPT] Loaded best for testing: results/ADHD_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
=============== FIT DONE ===============
[BEST] epoch=23 | val_acc=64.52% | val_f1=38.89% | val_auc=51.62% | val_score=77.7912 | val_score_bestthr=83.3727
[TEST@BEST] thr_used=0.430 | acc=66.88% f1=35.44% auc=61.10% | SP_sex=5.35% EO_sex=10.61% SP_age=8.16% EO_age=14.29%
[TIME] 0.88 min
[OK] Saved: results/ADHD_3x5fold_seed0/fold1_rep1_seed1001/summary_fold_1.json
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5144 mb_mean=0.5150 norm_overlap=1.0001 corr_cb=0.1309 topkJ=0.0912
[TRAIN][ep=000] loss=0.7030 acc=36.48%
[TRAIN][ep=000] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2625
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5154 mb_mean=0.5148 norm_overlap=1.0002 corr_cb=0.2404 topkJ=0.1127
[TRAIN][ep=001] loss=0.6861 acc=62.25%
[TRAIN][ep=001] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2578
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5149 mb_mean=0.5167 norm_overlap=1.0008 corr_cb=0.5338 topkJ=0.2907
[TRAIN][ep=002] loss=0.6733 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2599
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5157 mb_mean=0.5166 norm_overlap=1.0002 corr_cb=0.1407 topkJ=0.0837
[TRAIN][ep=003] loss=0.6626 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2572
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5155 mb_mean=0.5150 norm_overlap=1.0006 corr_cb=0.3877 topkJ=0.2261
[TRAIN][ep=004] loss=0.6580 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2563
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5144 mb_mean=0.5149 norm_overlap=1.0005 corr_cb=0.3178 topkJ=0.2069
[TRAIN][ep=005] loss=0.6563 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2581
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5162 mb_mean=0.5152 norm_overlap=1.0006 corr_cb=0.3963 topkJ=0.1808
[TRAIN][ep=006] loss=0.6549 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2561
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5160 mb_mean=0.5163 norm_overlap=1.0003 corr_cb=0.2399 topkJ=0.1667
[TRAIN][ep=007] loss=0.6540 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2581
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5151 mb_mean=0.5161 norm_overlap=1.0002 corr_cb=0.1733 topkJ=0.1150
[TRAIN][ep=008] loss=0.6529 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2604
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5152 mb_mean=0.5142 norm_overlap=1.0003 corr_cb=0.2795 topkJ=0.1008
[TRAIN][ep=009] loss=0.6519 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2576
================= FIT START (fold=1) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.35 select_by=val_score | eval_thr_mode=best_acc eval_thr_grid=coarse | disease_pos_weight_mode=none freeze_b_after=15 | two_stage=True stage1_ratio=0.35 stage2_lr_mult=0.3 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5146 mb_mean=0.5164 norm_overlap=1.0004 corr_cb=0.2841 topkJ=0.1112
[TRAIN][ep=000] loss=0.6509 acc=63.70%
[TRAIN][ep=000] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2587
[EPOCH 000/089] train: loss=0.6509 acc=63.70% | val: loss=0.6618 acc=62.90% f1=0.00% auc=51.17% val_score=75.9222 val_score_bestthr=62.9032 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.515, mb=0.515, no=1.000, corr=0.259) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* -1000000000000000000.0000 -> 75.9222
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5151 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=0.0509 topkJ=0.0799
[TRAIN][ep=001] loss=0.6497 acc=63.70%
[TRAIN][ep=001] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2578
[EPOCH 001/089] train: loss=0.6497 acc=63.70% | val: loss=0.6613 acc=62.90% f1=0.00% auc=51.39% val_score=70.6616 val_score_bestthr=62.9032 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.515, mb=0.515, no=1.000, corr=0.258) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 75.9222 -> 70.6616
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5143 mb_mean=0.5158 norm_overlap=1.0002 corr_cb=0.1856 topkJ=0.1505
[TRAIN][ep=002] loss=0.6486 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2621
[EPOCH 002/089] train: loss=0.6486 acc=63.70% | val: loss=0.6610 acc=62.90% f1=0.00% auc=50.84% val_score=68.7100 val_score_bestthr=62.9032 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.515, mb=0.515, no=1.000, corr=0.262) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 75.9222 -> 68.7100
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5142 mb_mean=0.5139 norm_overlap=1.0007 corr_cb=0.4700 topkJ=0.2643
[TRAIN][ep=003] loss=0.6477 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2561
[EPOCH 003/089] train: loss=0.6477 acc=63.70% | val: loss=0.6609 acc=62.90% f1=0.00% auc=50.95% val_score=74.6154 val_score_bestthr=62.9032 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.515, mb=0.515, no=1.000, corr=0.256) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 75.9222 -> 74.6154
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5147 mb_mean=0.5159 norm_overlap=1.0007 corr_cb=0.4334 topkJ=0.1914
[TRAIN][ep=004] loss=0.6459 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2609
[EPOCH 004/089] train: loss=0.6459 acc=63.70% | val: loss=0.6609 acc=62.90% f1=0.00% auc=50.95% val_score=76.5990 val_score_bestthr=62.9032 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.515, mb=0.515, no=1.000, corr=0.261) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 75.9222 -> 76.5990
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5137 mb_mean=0.5154 norm_overlap=1.0001 corr_cb=0.0616 topkJ=0.0627
[TRAIN][ep=005] loss=2.1441 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.5037 mb_mean=0.5070 norm_overlap=1.0002 corr_cb=0.1649
[EPOCH 005/089] train: loss=2.1441 acc=63.70% | val: loss=0.6615 acc=62.90% f1=0.00% auc=51.28% val_score=74.1771 val_score_bestthr=62.9032 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.504, mb=0.507, no=1.000, corr=0.165) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.5990 -> 74.1771
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4917 mb_mean=0.4948 norm_overlap=1.0008 corr_cb=0.3638 topkJ=0.1369
[TRAIN][ep=006] loss=1.4383 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.4820 mb_mean=0.4879 norm_overlap=1.0005 corr_cb=0.2022
[EPOCH 006/089] train: loss=1.4383 acc=63.70% | val: loss=0.6615 acc=62.90% f1=0.00% auc=51.62% val_score=74.1771 val_score_bestthr=62.9032 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.482, mb=0.488, no=1.000, corr=0.202) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.5990 -> 74.1771
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4673 mb_mean=0.4744 norm_overlap=1.0014 corr_cb=0.4021 topkJ=0.1199
[TRAIN][ep=007] loss=0.7413 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.4599 mb_mean=0.4655 norm_overlap=1.0015 corr_cb=0.3519
[EPOCH 007/089] train: loss=0.7413 acc=63.70% | val: loss=0.6623 acc=62.90% f1=0.00% auc=51.28% val_score=73.1129 val_score_bestthr=62.9032 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.460, mb=0.465, no=1.001, corr=0.352) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.5990 -> 73.1129
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4525 mb_mean=0.4557 norm_overlap=1.0016 corr_cb=0.3322 topkJ=0.0545
[TRAIN][ep=008] loss=0.5796 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.4374 mb_mean=0.4393 norm_overlap=1.0033 corr_cb=0.4131
[EPOCH 008/089] train: loss=0.5796 acc=63.70% | val: loss=0.6627 acc=62.90% f1=14.81% auc=51.06% val_score=74.1351 val_score_bestthr=69.8730 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.437, mb=0.439, no=1.003, corr=0.413) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.5990 -> 74.1351
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4183 mb_mean=0.4166 norm_overlap=1.0074 corr_cb=0.5399 topkJ=0.2173
[TRAIN][ep=009] loss=0.8497 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.4163 mb_mean=0.4105 norm_overlap=1.0054 corr_cb=0.3857
[EPOCH 009/089] train: loss=0.8497 acc=63.70% | val: loss=0.6646 acc=64.52% f1=8.33% auc=51.06% val_score=76.8941 val_score_bestthr=68.4365 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.416, mb=0.410, no=1.005, corr=0.386) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 76.5990 -> 76.8941
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=010] disease_pos_weight=1.0000 mode=none
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.4074 mb_mean=0.3956 norm_overlap=1.0057 corr_cb=0.3279 topkJ=0.0857
[TRAIN][ep=010] loss=1.1211 acc=63.70%
[TRAIN][ep=010] mask_avg: mc_mean=0.3976 mb_mean=0.3811 norm_overlap=1.0063 corr_cb=0.2772
[EPOCH 010/089] train: loss=1.1211 acc=63.70% | val: loss=0.6663 acc=66.13% f1=16.00% auc=50.17% val_score=75.9593 val_score_bestthr=73.7211 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.398, mb=0.381, no=1.006, corr=0.277) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.8941 -> 75.9593
[DBG][ep=011] disease_pos_weight=1.0000 mode=none
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.3770 mb_mean=0.3533 norm_overlap=1.0080 corr_cb=0.2594 topkJ=0.1172
[TRAIN][ep=011] loss=1.3908 acc=63.70%
[TRAIN][ep=011] mask_avg: mc_mean=0.3823 mb_mean=0.3541 norm_overlap=1.0055 corr_cb=0.1669
[EPOCH 011/089] train: loss=1.3908 acc=63.70% | val: loss=0.6685 acc=64.52% f1=8.33% auc=49.83% val_score=74.4960 val_score_bestthr=68.4365 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.382, mb=0.354, no=1.006, corr=0.167) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.8941 -> 74.4960
[DBG][ep=012] disease_pos_weight=1.0000 mode=none
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.3812 mb_mean=0.3563 norm_overlap=1.0036 corr_cb=0.1042 topkJ=0.0464
[TRAIN][ep=012] loss=1.6622 acc=63.70%
[TRAIN][ep=012] mask_avg: mc_mean=0.3684 mb_mean=0.3323 norm_overlap=1.0009 corr_cb=0.0217
[EPOCH 012/089] train: loss=1.6622 acc=63.70% | val: loss=0.6700 acc=64.52% f1=15.38% auc=49.50% val_score=74.4960 val_score_bestthr=71.7153 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.368, mb=0.332, no=1.001, corr=0.022) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.8941 -> 74.4960
[DBG][ep=013] disease_pos_weight=1.0000 mode=none
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.3588 mb_mean=0.3236 norm_overlap=0.9919 corr_cb=-0.1559 topkJ=0.0380
[TRAIN][ep=013] loss=1.9291 acc=63.70%
[TRAIN][ep=013] mask_avg: mc_mean=0.3565 mb_mean=0.3154 norm_overlap=0.9880 corr_cb=-0.1877
[EPOCH 013/089] train: loss=1.9291 acc=63.70% | val: loss=0.6720 acc=62.90% f1=20.69% auc=49.61% val_score=70.4502 val_score_bestthr=72.5223 | dyn(w_pfs=0.240, w_sup=0.240, w_csuf=0.200, stage2=False) | mask(mc=0.356, mb=0.315, no=0.988, corr=-0.188) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.8941 -> 70.4502
[DBG][ep=014] disease_pos_weight=1.0000 mode=none
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.3556 mb_mean=0.3176 norm_overlap=0.9766 corr_cb=-0.3095 topkJ=0.0146
[TRAIN][ep=014] loss=2.0463 acc=63.70%
[TRAIN][ep=014] mask_avg: mc_mean=0.3451 mb_mean=0.3031 norm_overlap=0.9636 corr_cb=-0.3955
[EPOCH 014/089] train: loss=2.0463 acc=63.70% | val: loss=0.6730 acc=66.13% f1=16.00% auc=49.39% val_score=68.5007 val_score_bestthr=73.7211 | dyn(w_pfs=0.280, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.345, mb=0.303, no=0.964, corr=-0.396) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.8941 -> 68.5007
[DBG][ep=015] disease_pos_weight=1.0000 mode=none
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.3359 mb_mean=0.3017 norm_overlap=0.9528 corr_cb=-0.4800 topkJ=0.0167
[TRAIN][ep=015] loss=2.0702 acc=63.70%
[TRAIN][ep=015] mask_avg: mc_mean=0.3366 mb_mean=0.2978 norm_overlap=0.9365 corr_cb=-0.5478
[EPOCH 015/089] train: loss=2.0702 acc=63.70% | val: loss=0.6753 acc=66.13% f1=16.00% auc=50.17% val_score=67.3928 val_score_bestthr=73.7211 | dyn(w_pfs=0.180, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.337, mb=0.298, no=0.936, corr=-0.548) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 67.3928
[DBG][ep=016] disease_pos_weight=1.0000 mode=none
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.3263 mb_mean=0.2865 norm_overlap=0.9040 corr_cb=-0.6482 topkJ=0.0057
[TRAIN][ep=016] loss=1.3745 acc=63.70%
[TRAIN][ep=016] mask_avg: mc_mean=0.3287 mb_mean=0.2978 norm_overlap=0.9150 corr_cb=-0.6215
[EPOCH 016/089] train: loss=1.3745 acc=63.70% | val: loss=0.6781 acc=66.13% f1=22.22% auc=49.72% val_score=62.5416 val_score_bestthr=76.5845 | dyn(w_pfs=0.220, w_sup=0.190, w_csuf=0.140, stage2=False) | mask(mc=0.329, mb=0.298, no=0.915, corr=-0.622) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 62.5416
[DBG][ep=017] disease_pos_weight=1.0000 mode=none
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.3320 mb_mean=0.3096 norm_overlap=0.9335 corr_cb=-0.6142 topkJ=0.0024
[TRAIN][ep=017] loss=1.6458 acc=63.70%
[TRAIN][ep=017] mask_avg: mc_mean=0.3226 mb_mean=0.2978 norm_overlap=0.8952 corr_cb=-0.6698
[EPOCH 017/089] train: loss=1.6458 acc=63.70% | val: loss=0.6810 acc=66.13% f1=22.22% auc=50.17% val_score=68.4426 val_score_bestthr=76.5845 | dyn(w_pfs=0.260, w_sup=0.230, w_csuf=0.180, stage2=False) | mask(mc=0.323, mb=0.298, no=0.895, corr=-0.670) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 68.4426
[DBG][ep=018] disease_pos_weight=1.0000 mode=none
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.3217 mb_mean=0.3127 norm_overlap=0.9142 corr_cb=-0.6660 topkJ=0.0000
[TRAIN][ep=018] loss=1.9125 acc=63.70%
[TRAIN][ep=018] mask_avg: mc_mean=0.3186 mb_mean=0.2978 norm_overlap=0.8770 corr_cb=-0.7075
[EPOCH 018/089] train: loss=1.9125 acc=63.70% | val: loss=0.6853 acc=64.52% f1=21.43% auc=50.72% val_score=69.4048 val_score_bestthr=74.4895 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.319, mb=0.298, no=0.877, corr=-0.707) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.4048
[DBG][ep=019] disease_pos_weight=1.0000 mode=none
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.3259 mb_mean=0.3005 norm_overlap=0.8702 corr_cb=-0.7480 topkJ=0.0000
[TRAIN][ep=019] loss=2.0441 acc=63.70%
[TRAIN][ep=019] mask_avg: mc_mean=0.3139 mb_mean=0.2978 norm_overlap=0.8603 corr_cb=-0.7289
[EPOCH 019/089] train: loss=2.0441 acc=63.70% | val: loss=0.6851 acc=64.52% f1=26.67% auc=51.06% val_score=70.8317 val_score_bestthr=77.0136 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.314, mb=0.298, no=0.860, corr=-0.729) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 70.8317
[DBG][ep=020] disease_pos_weight=1.0000 mode=none
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.2921 mb_mean=0.3040 norm_overlap=0.8904 corr_cb=-0.6102 topkJ=0.0000
[TRAIN][ep=020] loss=2.0425 acc=63.70%
[TRAIN][ep=020] mask_avg: mc_mean=0.3101 mb_mean=0.2978 norm_overlap=0.8425 corr_cb=-0.7525
[EPOCH 020/089] train: loss=2.0425 acc=63.70% | val: loss=0.6881 acc=64.52% f1=26.67% auc=50.95% val_score=70.9191 val_score_bestthr=77.0136 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.310, mb=0.298, no=0.843, corr=-0.752) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 70.9191
[DBG][ep=021] disease_pos_weight=1.0000 mode=none
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.3058 mb_mean=0.3070 norm_overlap=0.8556 corr_cb=-0.6979 topkJ=0.0000
[TRAIN][ep=021] loss=2.0364 acc=63.70%
[TRAIN][ep=021] mask_avg: mc_mean=0.3079 mb_mean=0.2978 norm_overlap=0.8317 corr_cb=-0.7602
[EPOCH 021/089] train: loss=2.0364 acc=63.70% | val: loss=0.6912 acc=64.52% f1=26.67% auc=50.06% val_score=70.9191 val_score_bestthr=77.0136 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.308, mb=0.298, no=0.832, corr=-0.760) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 70.9191
[DBG][ep=022] disease_pos_weight=1.0000 mode=none
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2977 mb_mean=0.3160 norm_overlap=0.8496 corr_cb=-0.7769 topkJ=0.0000
[TRAIN][ep=022] loss=2.0271 acc=63.70%
[TRAIN][ep=022] mask_avg: mc_mean=0.3044 mb_mean=0.2978 norm_overlap=0.8170 corr_cb=-0.7768
[EPOCH 022/089] train: loss=2.0271 acc=63.70% | val: loss=0.6923 acc=66.13% f1=36.36% auc=50.39% val_score=70.1987 val_score_bestthr=83.4443 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.304, mb=0.298, no=0.817, corr=-0.777) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 70.1987
[DBG][ep=023] disease_pos_weight=1.0000 mode=none
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2881 mb_mean=0.3008 norm_overlap=0.7871 corr_cb=-0.8169 topkJ=0.0000
[TRAIN][ep=023] loss=2.0175 acc=64.25%
[TRAIN][ep=023] mask_avg: mc_mean=0.3021 mb_mean=0.2978 norm_overlap=0.8072 corr_cb=-0.7794
[EPOCH 023/089] train: loss=2.0175 acc=64.25% | val: loss=0.6972 acc=67.74% f1=44.44% auc=50.72% val_score=75.0064 val_score_bestthr=89.5791 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.302, mb=0.298, no=0.807, corr=-0.779) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 75.0064
[DBG][ep=024] disease_pos_weight=1.0000 mode=none
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.3179 mb_mean=0.2669 norm_overlap=0.7169 corr_cb=-0.8248 topkJ=0.0000
[TRAIN][ep=024] loss=2.0091 acc=64.97%
[TRAIN][ep=024] mask_avg: mc_mean=0.2998 mb_mean=0.2978 norm_overlap=0.7984 corr_cb=-0.7818
[EPOCH 024/089] train: loss=2.0091 acc=64.97% | val: loss=0.6967 acc=64.52% f1=42.11% auc=51.73% val_score=73.7610 val_score_bestthr=85.1541 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.300, mb=0.298, no=0.798, corr=-0.782) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 73.7610
[DBG][ep=025] disease_pos_weight=1.0000 mode=none
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.3088 mb_mean=0.2840 norm_overlap=0.7394 corr_cb=-0.8340 topkJ=0.0000
[TRAIN][ep=025] loss=1.9969 acc=64.97%
[TRAIN][ep=025] mask_avg: mc_mean=0.2984 mb_mean=0.2978 norm_overlap=0.7875 corr_cb=-0.7895
[EPOCH 025/089] train: loss=1.9969 acc=64.97% | val: loss=0.7008 acc=64.52% f1=42.11% auc=51.06% val_score=68.5763 val_score_bestthr=85.2255 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.298, mb=0.298, no=0.788, corr=-0.789) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 68.5763
[DBG][ep=026] disease_pos_weight=1.0000 mode=none
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2991 mb_mean=0.2967 norm_overlap=0.7948 corr_cb=-0.7956 topkJ=0.0000
[TRAIN][ep=026] loss=1.9842 acc=66.61%
[TRAIN][ep=026] mask_avg: mc_mean=0.2943 mb_mean=0.2978 norm_overlap=0.7777 corr_cb=-0.7959
[EPOCH 026/089] train: loss=1.9842 acc=66.61% | val: loss=0.7061 acc=64.52% f1=21.43% auc=51.62% val_score=71.7636 val_score_bestthr=74.3777 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.294, mb=0.298, no=0.778, corr=-0.796) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 71.7636
[DBG][ep=027] disease_pos_weight=1.0000 mode=none
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2995 mb_mean=0.2812 norm_overlap=0.7246 corr_cb=-0.8186 topkJ=0.0000
[TRAIN][ep=027] loss=1.9844 acc=67.51%
[TRAIN][ep=027] mask_avg: mc_mean=0.2928 mb_mean=0.2978 norm_overlap=0.7698 corr_cb=-0.8010
[EPOCH 027/089] train: loss=1.9844 acc=67.51% | val: loss=0.7157 acc=64.52% f1=26.67% auc=51.73% val_score=72.1205 val_score_bestthr=77.0136 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.293, mb=0.298, no=0.770, corr=-0.801) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 72.1205
[DBG][ep=028] disease_pos_weight=1.0000 mode=none
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2944 mb_mean=0.3049 norm_overlap=0.7573 corr_cb=-0.8470 topkJ=0.0000
[TRAIN][ep=028] loss=1.9693 acc=67.70%
[TRAIN][ep=028] mask_avg: mc_mean=0.2910 mb_mean=0.2978 norm_overlap=0.7615 corr_cb=-0.8058
[EPOCH 028/089] train: loss=1.9693 acc=67.70% | val: loss=0.7081 acc=66.13% f1=36.36% auc=51.95% val_score=72.5631 val_score_bestthr=83.5741 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.291, mb=0.298, no=0.761, corr=-0.806) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 72.5631
[DBG][ep=029] disease_pos_weight=1.0000 mode=none
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2735 mb_mean=0.3036 norm_overlap=0.7911 corr_cb=-0.7548 topkJ=0.0000
[TRAIN][ep=029] loss=1.2785 acc=70.78%
[TRAIN][ep=029] mask_avg: mc_mean=0.2878 mb_mean=0.2978 norm_overlap=0.7571 corr_cb=-0.8020
[EPOCH 029/089] train: loss=1.2785 acc=70.78% | val: loss=0.7261 acc=64.52% f1=38.89% auc=51.62% val_score=71.0126 val_score_bestthr=83.3922 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.288, mb=0.298, no=0.757, corr=-0.802) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 71.0126
[DBG][ep=030] disease_pos_weight=1.0000 mode=none
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2787 mb_mean=0.2922 norm_overlap=0.7767 corr_cb=-0.7630 topkJ=0.0000
[TRAIN][ep=030] loss=0.5939 acc=70.42%
[TRAIN][ep=030] mask_avg: mc_mean=0.2853 mb_mean=0.2978 norm_overlap=0.7479 corr_cb=-0.8112
[EPOCH 030/089] train: loss=0.5939 acc=70.42% | val: loss=0.7269 acc=66.13% f1=36.36% auc=52.29% val_score=70.5945 val_score_bestthr=83.5741 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.285, mb=0.298, no=0.748, corr=-0.811) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 70.5945
[DBG][ep=031] disease_pos_weight=1.0000 mode=none
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2859 mb_mean=0.3039 norm_overlap=0.7753 corr_cb=-0.8051 topkJ=0.0000
[TRAIN][ep=031] loss=0.4346 acc=75.14%
[TRAIN][ep=031] mask_avg: mc_mean=0.2845 mb_mean=0.2978 norm_overlap=0.7450 corr_cb=-0.8120
[EPOCH 031/089] train: loss=0.4346 acc=75.14% | val: loss=0.7339 acc=66.13% f1=40.00% auc=51.73% val_score=72.5631 val_score_bestthr=85.5834 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.284, mb=0.298, no=0.745, corr=-0.812) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 72.5631
[DBG][ep=032] disease_pos_weight=1.0000 mode=none
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2660 mb_mean=0.3057 norm_overlap=0.7868 corr_cb=-0.7659 topkJ=0.0000
[TRAIN][ep=032] loss=0.4281 acc=75.32%
[TRAIN][ep=032] mask_avg: mc_mean=0.2845 mb_mean=0.2978 norm_overlap=0.7449 corr_cb=-0.8117
[EPOCH 032/089] train: loss=0.4281 acc=75.32% | val: loss=0.7377 acc=66.13% f1=40.00% auc=51.84% val_score=69.8745 val_score_bestthr=85.5834 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.285, mb=0.298, no=0.745, corr=-0.812) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.8745
[DBG][ep=033] disease_pos_weight=1.0000 mode=none
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2883 mb_mean=0.3000 norm_overlap=0.7509 corr_cb=-0.8358 topkJ=0.0000
[TRAIN][ep=033] loss=0.4256 acc=75.32%
[TRAIN][ep=033] mask_avg: mc_mean=0.2845 mb_mean=0.2978 norm_overlap=0.7452 corr_cb=-0.8103
[EPOCH 033/089] train: loss=0.4256 acc=75.32% | val: loss=0.7410 acc=67.74% f1=41.18% auc=51.84% val_score=69.8745 val_score_bestthr=87.8073 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.284, mb=0.298, no=0.745, corr=-0.810) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.8745
[DBG][ep=034] disease_pos_weight=1.0000 mode=none
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2806 mb_mean=0.2939 norm_overlap=0.7386 corr_cb=-0.8325 topkJ=0.0000
[TRAIN][ep=034] loss=0.4229 acc=75.32%
[TRAIN][ep=034] mask_avg: mc_mean=0.2845 mb_mean=0.2978 norm_overlap=0.7453 corr_cb=-0.8107
[EPOCH 034/089] train: loss=0.4229 acc=75.32% | val: loss=0.7474 acc=64.52% f1=38.89% auc=51.62% val_score=69.8745 val_score_bestthr=83.3727 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.285, mb=0.298, no=0.745, corr=-0.811) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.8745
[DBG][ep=035] disease_pos_weight=1.0000 mode=none
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2893 mb_mean=0.2999 norm_overlap=0.7233 corr_cb=-0.8165 topkJ=0.0000
[TRAIN][ep=035] loss=0.4211 acc=74.59%
[TRAIN][ep=035] mask_avg: mc_mean=0.2845 mb_mean=0.2978 norm_overlap=0.7447 corr_cb=-0.8117
[EPOCH 035/089] train: loss=0.4211 acc=74.59% | val: loss=0.7508 acc=64.52% f1=38.89% auc=51.62% val_score=69.8745 val_score_bestthr=83.3727 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.285, mb=0.298, no=0.745, corr=-0.812) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.8745
[DBG][ep=036] disease_pos_weight=1.0000 mode=none
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.3159 mb_mean=0.2736 norm_overlap=0.6479 corr_cb=-0.8945 topkJ=0.0000
[TRAIN][ep=036] loss=0.4180 acc=75.14%
[TRAIN][ep=036] mask_avg: mc_mean=0.2845 mb_mean=0.2978 norm_overlap=0.7448 corr_cb=-0.8126
[EPOCH 036/089] train: loss=0.4180 acc=75.14% | val: loss=0.7548 acc=66.13% f1=36.36% auc=51.73% val_score=69.8745 val_score_bestthr=83.5074 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.285, mb=0.298, no=0.745, corr=-0.813) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.8745
[DBG][ep=037] disease_pos_weight=1.0000 mode=none
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.2800 mb_mean=0.3104 norm_overlap=0.7764 corr_cb=-0.7977 topkJ=0.0000
[TRAIN][ep=037] loss=0.4155 acc=75.68%
[TRAIN][ep=037] mask_avg: mc_mean=0.2845 mb_mean=0.2978 norm_overlap=0.7451 corr_cb=-0.8116
[EPOCH 037/089] train: loss=0.4155 acc=75.68% | val: loss=0.7553 acc=66.13% f1=36.36% auc=52.06% val_score=69.8745 val_score_bestthr=83.5741 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.285, mb=0.298, no=0.745, corr=-0.812) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.8745
[DBG][ep=038] disease_pos_weight=1.0000 mode=none
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2840 mb_mean=0.2940 norm_overlap=0.7289 corr_cb=-0.8379 topkJ=0.0000
[TRAIN][ep=038] loss=0.4137 acc=75.14%
[TRAIN][ep=038] mask_avg: mc_mean=0.2845 mb_mean=0.2978 norm_overlap=0.7452 corr_cb=-0.8102
[EPOCH 038/089] train: loss=0.4137 acc=75.14% | val: loss=0.7553 acc=66.13% f1=36.36% auc=52.29% val_score=69.8745 val_score_bestthr=83.5741 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.285, mb=0.298, no=0.745, corr=-0.810) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.8745
[DBG][ep=039] disease_pos_weight=1.0000 mode=none
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2921 mb_mean=0.2969 norm_overlap=0.7345 corr_cb=-0.8410 topkJ=0.0000
[TRAIN][ep=039] loss=0.4106 acc=75.32%
[TRAIN][ep=039] mask_avg: mc_mean=0.2845 mb_mean=0.2978 norm_overlap=0.7451 corr_cb=-0.8114
[EPOCH 039/089] train: loss=0.4106 acc=75.32% | val: loss=0.7598 acc=66.13% f1=36.36% auc=52.29% val_score=69.8745 val_score_bestthr=83.5741 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.285, mb=0.298, no=0.745, corr=-0.811) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.8745
[EARLY STOP] no improvement for 30 epochs. best_epoch=9
[CKPT] Loaded best for testing: results/ADHD_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
=============== FIT DONE ===============
[BEST] epoch=9 | val_acc=64.52% | val_f1=8.33% | val_auc=51.06% | val_score=76.8941 | val_score_bestthr=68.4365
[TEST@BEST] thr_used=0.400 | acc=66.23% f1=18.75% auc=59.66% | SP_sex=0.32% EO_sex=3.03% SP_age=4.35% EO_age=11.52%
[TIME] 0.73 min
[OK] Saved: results/ADHD_3x5fold_seed0/fold1_rep1_seed1001/summary_fold_1.json
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5144 mb_mean=0.5150 norm_overlap=1.0001 corr_cb=0.1309 topkJ=0.0912
[TRAIN][ep=000] loss=0.7030 acc=36.48%
[TRAIN][ep=000] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2625
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5154 mb_mean=0.5148 norm_overlap=1.0002 corr_cb=0.2404 topkJ=0.1127
[TRAIN][ep=001] loss=0.6861 acc=62.25%
[TRAIN][ep=001] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2578
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5149 mb_mean=0.5167 norm_overlap=1.0008 corr_cb=0.5338 topkJ=0.2907
[TRAIN][ep=002] loss=0.6733 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2599
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5157 mb_mean=0.5166 norm_overlap=1.0002 corr_cb=0.1407 topkJ=0.0837
[TRAIN][ep=003] loss=0.6626 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2572
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5155 mb_mean=0.5150 norm_overlap=1.0006 corr_cb=0.3877 topkJ=0.2261
[TRAIN][ep=004] loss=0.6580 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2563
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5144 mb_mean=0.5149 norm_overlap=1.0005 corr_cb=0.3178 topkJ=0.2069
[TRAIN][ep=005] loss=0.6563 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2581
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5162 mb_mean=0.5152 norm_overlap=1.0006 corr_cb=0.3963 topkJ=0.1808
[TRAIN][ep=006] loss=0.6549 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2561
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5160 mb_mean=0.5163 norm_overlap=1.0003 corr_cb=0.2399 topkJ=0.1667
[TRAIN][ep=007] loss=0.6540 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2581
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5151 mb_mean=0.5161 norm_overlap=1.0002 corr_cb=0.1733 topkJ=0.1150
[TRAIN][ep=008] loss=0.6529 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2604
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5152 mb_mean=0.5142 norm_overlap=1.0003 corr_cb=0.2795 topkJ=0.1008
[TRAIN][ep=009] loss=0.6519 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2576
================= FIT START (fold=1) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.35 select_by=val_score | eval_thr_mode=best_acc eval_thr_grid=coarse | disease_pos_weight_mode=none freeze_b_after=15 | two_stage=True stage1_ratio=0.35 stage2_lr_mult=0.3 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5146 mb_mean=0.5164 norm_overlap=1.0004 corr_cb=0.2841 topkJ=0.1112
[TRAIN][ep=000] loss=0.6509 acc=63.70%
[TRAIN][ep=000] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2587
[EPOCH 000/089] train: loss=0.6509 acc=63.70% | val: loss=0.6618 acc=62.90% f1=0.00% auc=51.17% val_score=75.9222 val_score_bestthr=62.9032 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.515, mb=0.515, no=1.000, corr=0.259) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* -1000000000000000000.0000 -> 75.9222
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5151 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=0.0509 topkJ=0.0799
[TRAIN][ep=001] loss=0.6497 acc=63.70%
[TRAIN][ep=001] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2578
[EPOCH 001/089] train: loss=0.6497 acc=63.70% | val: loss=0.6613 acc=62.90% f1=0.00% auc=51.39% val_score=70.6616 val_score_bestthr=62.9032 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.515, mb=0.515, no=1.000, corr=0.258) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 75.9222 -> 70.6616
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5143 mb_mean=0.5158 norm_overlap=1.0002 corr_cb=0.1856 topkJ=0.1505
[TRAIN][ep=002] loss=0.6486 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2621
[EPOCH 002/089] train: loss=0.6486 acc=63.70% | val: loss=0.6610 acc=62.90% f1=0.00% auc=50.84% val_score=68.7100 val_score_bestthr=62.9032 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.515, mb=0.515, no=1.000, corr=0.262) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 75.9222 -> 68.7100
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5142 mb_mean=0.5139 norm_overlap=1.0007 corr_cb=0.4700 topkJ=0.2643
[TRAIN][ep=003] loss=0.6477 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2561
[EPOCH 003/089] train: loss=0.6477 acc=63.70% | val: loss=0.6609 acc=62.90% f1=0.00% auc=50.95% val_score=74.6154 val_score_bestthr=62.9032 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.515, mb=0.515, no=1.000, corr=0.256) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 75.9222 -> 74.6154
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5147 mb_mean=0.5159 norm_overlap=1.0007 corr_cb=0.4334 topkJ=0.1914
[TRAIN][ep=004] loss=0.6459 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2609
[EPOCH 004/089] train: loss=0.6459 acc=63.70% | val: loss=0.6609 acc=62.90% f1=0.00% auc=50.95% val_score=76.5990 val_score_bestthr=62.9032 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.515, mb=0.515, no=1.000, corr=0.261) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 75.9222 -> 76.5990
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5137 mb_mean=0.5154 norm_overlap=1.0001 corr_cb=0.0616 topkJ=0.0627
[TRAIN][ep=005] loss=2.2467 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.5041 mb_mean=0.5070 norm_overlap=1.0002 corr_cb=0.1590
[EPOCH 005/089] train: loss=2.2467 acc=63.70% | val: loss=0.6615 acc=62.90% f1=0.00% auc=51.28% val_score=74.1771 val_score_bestthr=62.9032 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.504, mb=0.507, no=1.000, corr=0.159) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.5990 -> 74.1771
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4926 mb_mean=0.4948 norm_overlap=1.0008 corr_cb=0.3491 topkJ=0.1326
[TRAIN][ep=006] loss=1.5064 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.4833 mb_mean=0.4879 norm_overlap=1.0004 corr_cb=0.1882
[EPOCH 006/089] train: loss=1.5064 acc=63.70% | val: loss=0.6615 acc=62.90% f1=0.00% auc=51.62% val_score=74.1771 val_score_bestthr=62.9032 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.483, mb=0.488, no=1.000, corr=0.188) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.5990 -> 74.1771
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4692 mb_mean=0.4744 norm_overlap=1.0013 corr_cb=0.3848 topkJ=0.1193
[TRAIN][ep=007] loss=0.7753 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.4619 mb_mean=0.4654 norm_overlap=1.0014 corr_cb=0.3323
[EPOCH 007/089] train: loss=0.7753 acc=63.70% | val: loss=0.6624 acc=62.90% f1=0.00% auc=51.06% val_score=75.1577 val_score_bestthr=62.9032 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.462, mb=0.465, no=1.001, corr=0.332) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.5990 -> 75.1577
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4548 mb_mean=0.4557 norm_overlap=1.0014 corr_cb=0.3070 topkJ=0.0514
[TRAIN][ep=008] loss=0.5796 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.4401 mb_mean=0.4393 norm_overlap=1.0031 corr_cb=0.3947
[EPOCH 008/089] train: loss=0.5796 acc=63.70% | val: loss=0.6626 acc=62.90% f1=14.81% auc=51.06% val_score=74.1351 val_score_bestthr=69.8730 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.440, mb=0.439, no=1.003, corr=0.395) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.5990 -> 74.1351
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4216 mb_mean=0.4164 norm_overlap=1.0071 corr_cb=0.5296 topkJ=0.2161
[TRAIN][ep=009] loss=0.8633 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.4194 mb_mean=0.4103 norm_overlap=1.0051 corr_cb=0.3722
[EPOCH 009/089] train: loss=0.8633 acc=63.70% | val: loss=0.6646 acc=64.52% f1=8.33% auc=51.06% val_score=76.8941 val_score_bestthr=68.4365 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.419, mb=0.410, no=1.005, corr=0.372) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 76.5990 -> 76.8941
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=010] disease_pos_weight=1.0000 mode=none
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.4107 mb_mean=0.3953 norm_overlap=1.0053 corr_cb=0.3135 topkJ=0.0833
[TRAIN][ep=010] loss=1.1482 acc=63.70%
[TRAIN][ep=010] mask_avg: mc_mean=0.4009 mb_mean=0.3808 norm_overlap=1.0060 corr_cb=0.2683
[EPOCH 010/089] train: loss=1.1482 acc=63.70% | val: loss=0.6662 acc=66.13% f1=16.00% auc=50.17% val_score=73.9081 val_score_bestthr=73.7211 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.401, mb=0.381, no=1.006, corr=0.268) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.8941 -> 73.9081
[DBG][ep=011] disease_pos_weight=1.0000 mode=none
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.3808 mb_mean=0.3528 norm_overlap=1.0076 corr_cb=0.2535 topkJ=0.1157
[TRAIN][ep=011] loss=1.4312 acc=63.70%
[TRAIN][ep=011] mask_avg: mc_mean=0.3856 mb_mean=0.3536 norm_overlap=1.0053 corr_cb=0.1629
[EPOCH 011/089] train: loss=1.4312 acc=63.70% | val: loss=0.6685 acc=64.52% f1=8.33% auc=49.83% val_score=74.4960 val_score_bestthr=68.4365 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.386, mb=0.354, no=1.005, corr=0.163) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.8941 -> 74.4960
[DBG][ep=012] disease_pos_weight=1.0000 mode=none
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.3842 mb_mean=0.3559 norm_overlap=1.0035 corr_cb=0.1038 topkJ=0.0468
[TRAIN][ep=012] loss=1.7158 acc=63.70%
[TRAIN][ep=012] mask_avg: mc_mean=0.3717 mb_mean=0.3317 norm_overlap=1.0010 corr_cb=0.0247
[EPOCH 012/089] train: loss=1.7158 acc=63.70% | val: loss=0.6700 acc=64.52% f1=15.38% auc=49.61% val_score=74.4960 val_score_bestthr=71.7153 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.372, mb=0.332, no=1.001, corr=0.025) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.8941 -> 74.4960
[DBG][ep=013] disease_pos_weight=1.0000 mode=none
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.3621 mb_mean=0.3230 norm_overlap=0.9924 corr_cb=-0.1504 topkJ=0.0380
[TRAIN][ep=013] loss=1.9960 acc=63.70%
[TRAIN][ep=013] mask_avg: mc_mean=0.3597 mb_mean=0.3148 norm_overlap=0.9891 corr_cb=-0.1762
[EPOCH 013/089] train: loss=1.9960 acc=63.70% | val: loss=0.6721 acc=62.90% f1=20.69% auc=49.61% val_score=70.4502 val_score_bestthr=72.5223 | dyn(w_pfs=0.240, w_sup=0.240, w_csuf=0.200, stage2=False) | mask(mc=0.360, mb=0.315, no=0.989, corr=-0.176) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.8941 -> 70.4502
[DBG][ep=014] disease_pos_weight=1.0000 mode=none
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.3585 mb_mean=0.3171 norm_overlap=0.9784 corr_cb=-0.2936 topkJ=0.0155
[TRAIN][ep=014] loss=2.1263 acc=63.70%
[TRAIN][ep=014] mask_avg: mc_mean=0.3482 mb_mean=0.3025 norm_overlap=0.9664 corr_cb=-0.3773
[EPOCH 014/089] train: loss=2.1263 acc=63.70% | val: loss=0.6730 acc=66.13% f1=16.00% auc=49.61% val_score=68.5007 val_score_bestthr=73.7211 | dyn(w_pfs=0.280, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.348, mb=0.302, no=0.966, corr=-0.377) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.8941 -> 68.5007
[DBG][ep=015] disease_pos_weight=1.0000 mode=none
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.3392 mb_mean=0.3008 norm_overlap=0.9566 corr_cb=-0.4600 topkJ=0.0196
[TRAIN][ep=015] loss=2.1631 acc=63.70%
[TRAIN][ep=015] mask_avg: mc_mean=0.3395 mb_mean=0.2972 norm_overlap=0.9415 corr_cb=-0.5256
[EPOCH 015/089] train: loss=2.1631 acc=63.70% | val: loss=0.6754 acc=66.13% f1=16.00% auc=50.17% val_score=67.3928 val_score_bestthr=73.7211 | dyn(w_pfs=0.180, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.339, mb=0.297, no=0.942, corr=-0.526) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 67.3928
[DBG][ep=016] disease_pos_weight=1.0000 mode=none
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.3291 mb_mean=0.2858 norm_overlap=0.9111 corr_cb=-0.6270 topkJ=0.0078
[TRAIN][ep=016] loss=1.4338 acc=63.70%
[TRAIN][ep=016] mask_avg: mc_mean=0.3314 mb_mean=0.2972 norm_overlap=0.9218 corr_cb=-0.5977
[EPOCH 016/089] train: loss=1.4338 acc=63.70% | val: loss=0.6784 acc=66.13% f1=22.22% auc=49.94% val_score=62.5416 val_score_bestthr=76.5845 | dyn(w_pfs=0.220, w_sup=0.190, w_csuf=0.140, stage2=False) | mask(mc=0.331, mb=0.297, no=0.922, corr=-0.598) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 62.5416
[DBG][ep=017] disease_pos_weight=1.0000 mode=none
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.3348 mb_mean=0.3092 norm_overlap=0.9384 corr_cb=-0.5928 topkJ=0.0036
[TRAIN][ep=017] loss=1.7181 acc=63.70%
[TRAIN][ep=017] mask_avg: mc_mean=0.3251 mb_mean=0.2972 norm_overlap=0.9035 corr_cb=-0.6455
[EPOCH 017/089] train: loss=1.7181 acc=63.70% | val: loss=0.6814 acc=66.13% f1=22.22% auc=50.50% val_score=68.4426 val_score_bestthr=76.5845 | dyn(w_pfs=0.260, w_sup=0.230, w_csuf=0.180, stage2=False) | mask(mc=0.325, mb=0.297, no=0.903, corr=-0.646) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 68.4426
[DBG][ep=018] disease_pos_weight=1.0000 mode=none
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.3244 mb_mean=0.3122 norm_overlap=0.9209 corr_cb=-0.6436 topkJ=0.0004
[TRAIN][ep=018] loss=1.9974 acc=63.70%
[TRAIN][ep=018] mask_avg: mc_mean=0.3208 mb_mean=0.2972 norm_overlap=0.8866 corr_cb=-0.6838
[EPOCH 018/089] train: loss=1.9974 acc=63.70% | val: loss=0.6862 acc=64.52% f1=21.43% auc=50.50% val_score=69.4048 val_score_bestthr=74.4895 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.321, mb=0.297, no=0.887, corr=-0.684) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.4048
[DBG][ep=019] disease_pos_weight=1.0000 mode=none
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.3278 mb_mean=0.3000 norm_overlap=0.8804 corr_cb=-0.7257 topkJ=0.0000
[TRAIN][ep=019] loss=2.1416 acc=63.70%
[TRAIN][ep=019] mask_avg: mc_mean=0.3158 mb_mean=0.2972 norm_overlap=0.8709 corr_cb=-0.7053
[EPOCH 019/089] train: loss=2.1416 acc=63.70% | val: loss=0.6859 acc=64.52% f1=26.67% auc=51.17% val_score=72.9000 val_score_bestthr=77.0136 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.316, mb=0.297, no=0.871, corr=-0.705) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 72.9000
[DBG][ep=020] disease_pos_weight=1.0000 mode=none
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.2948 mb_mean=0.3033 norm_overlap=0.9000 corr_cb=-0.5826 topkJ=0.0000
[TRAIN][ep=020] loss=2.1522 acc=63.70%
[TRAIN][ep=020] mask_avg: mc_mean=0.3117 mb_mean=0.2972 norm_overlap=0.8540 corr_cb=-0.7300
[EPOCH 020/089] train: loss=2.1522 acc=63.70% | val: loss=0.6886 acc=66.13% f1=27.59% auc=50.95% val_score=70.9191 val_score_bestthr=79.0307 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.312, mb=0.297, no=0.854, corr=-0.730) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 70.9191
[DBG][ep=021] disease_pos_weight=1.0000 mode=none
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.3076 mb_mean=0.3062 norm_overlap=0.8669 corr_cb=-0.6713 topkJ=0.0000
[TRAIN][ep=021] loss=2.1483 acc=63.70%
[TRAIN][ep=021] mask_avg: mc_mean=0.3093 mb_mean=0.2972 norm_overlap=0.8438 corr_cb=-0.7377
[EPOCH 021/089] train: loss=2.1483 acc=63.70% | val: loss=0.6927 acc=66.13% f1=27.59% auc=49.83% val_score=70.0813 val_score_bestthr=79.0307 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.309, mb=0.297, no=0.844, corr=-0.738) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 70.0813
[DBG][ep=022] disease_pos_weight=1.0000 mode=none
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2999 mb_mean=0.3154 norm_overlap=0.8600 corr_cb=-0.7570 topkJ=0.0000
[TRAIN][ep=022] loss=2.1380 acc=64.07%
[TRAIN][ep=022] mask_avg: mc_mean=0.3057 mb_mean=0.2972 norm_overlap=0.8295 corr_cb=-0.7557
[EPOCH 022/089] train: loss=2.1380 acc=64.07% | val: loss=0.6935 acc=66.13% f1=40.00% auc=50.84% val_score=73.0557 val_score_bestthr=85.2828 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.306, mb=0.297, no=0.829, corr=-0.756) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 73.0557
[DBG][ep=023] disease_pos_weight=1.0000 mode=none
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2894 mb_mean=0.2996 norm_overlap=0.8027 corr_cb=-0.7947 topkJ=0.0000
[TRAIN][ep=023] loss=2.1270 acc=64.43%
[TRAIN][ep=023] mask_avg: mc_mean=0.3034 mb_mean=0.2972 norm_overlap=0.8200 corr_cb=-0.7592
[EPOCH 023/089] train: loss=2.1270 acc=64.43% | val: loss=0.6994 acc=67.74% f1=44.44% auc=51.06% val_score=75.0064 val_score_bestthr=89.5791 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.303, mb=0.297, no=0.820, corr=-0.759) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 75.0064
[DBG][ep=024] disease_pos_weight=1.0000 mode=none
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.3175 mb_mean=0.2661 norm_overlap=0.7321 corr_cb=-0.8090 topkJ=0.0000
[TRAIN][ep=024] loss=2.1175 acc=65.70%
[TRAIN][ep=024] mask_avg: mc_mean=0.3010 mb_mean=0.2971 norm_overlap=0.8114 corr_cb=-0.7622
[EPOCH 024/089] train: loss=2.1175 acc=65.70% | val: loss=0.6991 acc=64.52% f1=26.67% auc=51.39% val_score=73.7610 val_score_bestthr=77.0136 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.301, mb=0.297, no=0.811, corr=-0.762) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 73.7610
[DBG][ep=025] disease_pos_weight=1.0000 mode=none
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.3090 mb_mean=0.2833 norm_overlap=0.7545 corr_cb=-0.8188 topkJ=0.0000
[TRAIN][ep=025] loss=2.1037 acc=65.15%
[TRAIN][ep=025] mask_avg: mc_mean=0.2995 mb_mean=0.2972 norm_overlap=0.8008 corr_cb=-0.7703
[EPOCH 025/089] train: loss=2.1037 acc=65.15% | val: loss=0.7030 acc=64.52% f1=38.89% auc=51.28% val_score=68.5763 val_score_bestthr=83.1346 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.300, mb=0.297, no=0.801, corr=-0.770) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 68.5763
[DBG][ep=026] disease_pos_weight=1.0000 mode=none
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.3004 mb_mean=0.2962 norm_overlap=0.8070 corr_cb=-0.7777 topkJ=0.0000
[TRAIN][ep=026] loss=2.0896 acc=66.61%
[TRAIN][ep=026] mask_avg: mc_mean=0.2954 mb_mean=0.2971 norm_overlap=0.7911 corr_cb=-0.7777
[EPOCH 026/089] train: loss=2.0896 acc=66.61% | val: loss=0.7090 acc=64.52% f1=26.67% auc=51.51% val_score=71.7636 val_score_bestthr=77.0136 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.295, mb=0.297, no=0.791, corr=-0.778) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 71.7636
[DBG][ep=027] disease_pos_weight=1.0000 mode=none
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2997 mb_mean=0.2804 norm_overlap=0.7405 corr_cb=-0.8017 topkJ=0.0000
[TRAIN][ep=027] loss=2.0894 acc=68.24%
[TRAIN][ep=027] mask_avg: mc_mean=0.2941 mb_mean=0.2972 norm_overlap=0.7834 corr_cb=-0.7831
[EPOCH 027/089] train: loss=2.0894 acc=68.24% | val: loss=0.7191 acc=64.52% f1=31.25% auc=51.95% val_score=70.0618 val_score_bestthr=79.2650 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.294, mb=0.297, no=0.783, corr=-0.783) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 70.0618
[DBG][ep=028] disease_pos_weight=1.0000 mode=none
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2955 mb_mean=0.3042 norm_overlap=0.7712 corr_cb=-0.8305 topkJ=0.0000
[TRAIN][ep=028] loss=2.0719 acc=68.78%
[TRAIN][ep=028] mask_avg: mc_mean=0.2923 mb_mean=0.2972 norm_overlap=0.7750 corr_cb=-0.7885
[EPOCH 028/089] train: loss=2.0719 acc=68.78% | val: loss=0.7123 acc=66.13% f1=36.36% auc=51.73% val_score=72.5631 val_score_bestthr=83.5741 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.292, mb=0.297, no=0.775, corr=-0.789) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 72.5631
[DBG][ep=029] disease_pos_weight=1.0000 mode=none
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2752 mb_mean=0.3031 norm_overlap=0.8048 corr_cb=-0.7351 topkJ=0.0000
[TRAIN][ep=029] loss=1.3492 acc=72.41%
[TRAIN][ep=029] mask_avg: mc_mean=0.2893 mb_mean=0.2972 norm_overlap=0.7707 corr_cb=-0.7848
[EPOCH 029/089] train: loss=1.3492 acc=72.41% | val: loss=0.7313 acc=64.52% f1=31.25% auc=51.62% val_score=71.0126 val_score_bestthr=79.2650 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.289, mb=0.297, no=0.771, corr=-0.785) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 71.0126
[DBG][ep=030] disease_pos_weight=1.0000 mode=none
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2807 mb_mean=0.2917 norm_overlap=0.7888 corr_cb=-0.7486 topkJ=0.0000
[TRAIN][ep=030] loss=0.6340 acc=71.14%
[TRAIN][ep=030] mask_avg: mc_mean=0.2868 mb_mean=0.2972 norm_overlap=0.7618 corr_cb=-0.7944
[EPOCH 030/089] train: loss=0.6340 acc=71.14% | val: loss=0.7323 acc=66.13% f1=36.36% auc=52.62% val_score=70.5945 val_score_bestthr=83.5741 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.287, mb=0.297, no=0.762, corr=-0.794) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 70.5945
[DBG][ep=031] disease_pos_weight=1.0000 mode=none
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2876 mb_mean=0.3033 norm_overlap=0.7887 corr_cb=-0.7843 topkJ=0.0000
[TRAIN][ep=031] loss=0.4452 acc=75.14%
[TRAIN][ep=031] mask_avg: mc_mean=0.2861 mb_mean=0.2972 norm_overlap=0.7590 corr_cb=-0.7952
[EPOCH 031/089] train: loss=0.4452 acc=75.14% | val: loss=0.7393 acc=67.74% f1=41.18% auc=52.06% val_score=72.5631 val_score_bestthr=87.8073 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.286, mb=0.297, no=0.759, corr=-0.795) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 72.5631
[DBG][ep=032] disease_pos_weight=1.0000 mode=none
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2682 mb_mean=0.3047 norm_overlap=0.7997 corr_cb=-0.7468 topkJ=0.0004
[TRAIN][ep=032] loss=0.4243 acc=75.50%
[TRAIN][ep=032] mask_avg: mc_mean=0.2861 mb_mean=0.2972 norm_overlap=0.7589 corr_cb=-0.7949
[EPOCH 032/089] train: loss=0.4243 acc=75.50% | val: loss=0.7431 acc=67.74% f1=41.18% auc=51.84% val_score=69.8745 val_score_bestthr=87.8073 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.286, mb=0.297, no=0.759, corr=-0.795) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.8745
[DBG][ep=033] disease_pos_weight=1.0000 mode=none
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2900 mb_mean=0.2996 norm_overlap=0.7644 corr_cb=-0.8213 topkJ=0.0000
[TRAIN][ep=033] loss=0.4219 acc=75.14%
[TRAIN][ep=033] mask_avg: mc_mean=0.2861 mb_mean=0.2972 norm_overlap=0.7592 corr_cb=-0.7935
[EPOCH 033/089] train: loss=0.4219 acc=75.14% | val: loss=0.7463 acc=64.52% f1=38.89% auc=52.06% val_score=69.8745 val_score_bestthr=83.3727 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.286, mb=0.297, no=0.759, corr=-0.794) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.8745
[DBG][ep=034] disease_pos_weight=1.0000 mode=none
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2822 mb_mean=0.2933 norm_overlap=0.7533 corr_cb=-0.8160 topkJ=0.0000
[TRAIN][ep=034] loss=0.4194 acc=74.77%
[TRAIN][ep=034] mask_avg: mc_mean=0.2861 mb_mean=0.2972 norm_overlap=0.7593 corr_cb=-0.7939
[EPOCH 034/089] train: loss=0.4194 acc=74.77% | val: loss=0.7525 acc=66.13% f1=36.36% auc=51.51% val_score=69.8745 val_score_bestthr=83.5074 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.286, mb=0.297, no=0.759, corr=-0.794) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.8745
[DBG][ep=035] disease_pos_weight=1.0000 mode=none
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2909 mb_mean=0.2991 norm_overlap=0.7388 corr_cb=-0.7985 topkJ=0.0000
[TRAIN][ep=035] loss=0.4178 acc=74.95%
[TRAIN][ep=035] mask_avg: mc_mean=0.2861 mb_mean=0.2972 norm_overlap=0.7587 corr_cb=-0.7950
[EPOCH 035/089] train: loss=0.4178 acc=74.95% | val: loss=0.7559 acc=64.52% f1=35.29% auc=51.51% val_score=69.8745 val_score_bestthr=81.3522 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.286, mb=0.297, no=0.759, corr=-0.795) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.8745
[DBG][ep=036] disease_pos_weight=1.0000 mode=none
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.3156 mb_mean=0.2728 norm_overlap=0.6637 corr_cb=-0.8827 topkJ=0.0000
[TRAIN][ep=036] loss=0.4148 acc=74.77%
[TRAIN][ep=036] mask_avg: mc_mean=0.2861 mb_mean=0.2972 norm_overlap=0.7588 corr_cb=-0.7959
[EPOCH 036/089] train: loss=0.4148 acc=74.77% | val: loss=0.7599 acc=64.52% f1=31.25% auc=51.62% val_score=69.8745 val_score_bestthr=79.2650 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.286, mb=0.297, no=0.759, corr=-0.796) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.8745
[DBG][ep=037] disease_pos_weight=1.0000 mode=none
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.2824 mb_mean=0.3098 norm_overlap=0.7885 corr_cb=-0.7811 topkJ=0.0000
[TRAIN][ep=037] loss=0.4125 acc=75.68%
[TRAIN][ep=037] mask_avg: mc_mean=0.2861 mb_mean=0.2972 norm_overlap=0.7590 corr_cb=-0.7949
[EPOCH 037/089] train: loss=0.4125 acc=75.68% | val: loss=0.7603 acc=66.13% f1=40.00% auc=52.17% val_score=69.8745 val_score_bestthr=85.5184 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.286, mb=0.297, no=0.759, corr=-0.795) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.8745
[DBG][ep=038] disease_pos_weight=1.0000 mode=none
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2851 mb_mean=0.2930 norm_overlap=0.7444 corr_cb=-0.8200 topkJ=0.0000
[TRAIN][ep=038] loss=0.4108 acc=75.50%
[TRAIN][ep=038] mask_avg: mc_mean=0.2861 mb_mean=0.2972 norm_overlap=0.7591 corr_cb=-0.7934
[EPOCH 038/089] train: loss=0.4108 acc=75.50% | val: loss=0.7603 acc=66.13% f1=40.00% auc=52.40% val_score=69.8745 val_score_bestthr=85.5184 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.286, mb=0.297, no=0.759, corr=-0.793) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.8745
[DBG][ep=039] disease_pos_weight=1.0000 mode=none
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2933 mb_mean=0.2962 norm_overlap=0.7484 corr_cb=-0.8242 topkJ=0.0000
[TRAIN][ep=039] loss=0.4079 acc=76.04%
[TRAIN][ep=039] mask_avg: mc_mean=0.2861 mb_mean=0.2971 norm_overlap=0.7590 corr_cb=-0.7946
[EPOCH 039/089] train: loss=0.4079 acc=76.04% | val: loss=0.7647 acc=66.13% f1=36.36% auc=52.62% val_score=69.8745 val_score_bestthr=83.5741 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.286, mb=0.297, no=0.759, corr=-0.795) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.8745
[EARLY STOP] no improvement for 30 epochs. best_epoch=9
[CKPT] Loaded best for testing: results/ADHD_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
=============== FIT DONE ===============
[BEST] epoch=9 | val_acc=64.52% | val_f1=8.33% | val_auc=51.06% | val_score=76.8941 | val_score_bestthr=68.4365
[TEST@BEST] thr_used=0.400 | acc=66.23% f1=18.75% auc=59.73% | SP_sex=0.32% EO_sex=3.03% SP_age=4.35% EO_age=11.52%
[TIME] 0.79 min
[OK] Saved: results/ADHD_3x5fold_seed0/fold1_rep1_seed1001/summary_fold_1.json
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5144 mb_mean=0.5150 norm_overlap=1.0001 corr_cb=0.1309 topkJ=0.0912
[TRAIN][ep=000] loss=0.7030 acc=36.48%
[TRAIN][ep=000] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2625
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5154 mb_mean=0.5148 norm_overlap=1.0002 corr_cb=0.2404 topkJ=0.1127
[TRAIN][ep=001] loss=0.6861 acc=62.25%
[TRAIN][ep=001] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2578
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5149 mb_mean=0.5167 norm_overlap=1.0008 corr_cb=0.5338 topkJ=0.2907
[TRAIN][ep=002] loss=0.6733 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2599
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5157 mb_mean=0.5166 norm_overlap=1.0002 corr_cb=0.1407 topkJ=0.0837
[TRAIN][ep=003] loss=0.6626 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2572
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5155 mb_mean=0.5150 norm_overlap=1.0006 corr_cb=0.3877 topkJ=0.2261
[TRAIN][ep=004] loss=0.6580 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2563
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5144 mb_mean=0.5149 norm_overlap=1.0005 corr_cb=0.3178 topkJ=0.2069
[TRAIN][ep=005] loss=0.6563 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2581
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5162 mb_mean=0.5152 norm_overlap=1.0006 corr_cb=0.3963 topkJ=0.1808
[TRAIN][ep=006] loss=0.6549 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2561
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5160 mb_mean=0.5163 norm_overlap=1.0003 corr_cb=0.2399 topkJ=0.1667
[TRAIN][ep=007] loss=0.6540 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2581
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5151 mb_mean=0.5161 norm_overlap=1.0002 corr_cb=0.1733 topkJ=0.1150
[TRAIN][ep=008] loss=0.6529 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2604
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5152 mb_mean=0.5142 norm_overlap=1.0003 corr_cb=0.2795 topkJ=0.1008
[TRAIN][ep=009] loss=0.6519 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2576
================= FIT START (fold=1) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.35 select_by=val_score | eval_thr_mode=best_acc eval_thr_grid=coarse | disease_pos_weight_mode=none freeze_b_after=15 | two_stage=True stage1_ratio=0.35 stage2_lr_mult=0.3 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5146 mb_mean=0.5164 norm_overlap=1.0004 corr_cb=0.2841 topkJ=0.1112
[TRAIN][ep=000] loss=0.6509 acc=63.70%
[TRAIN][ep=000] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2587
[EPOCH 000/089] train: loss=0.6509 acc=63.70% | val: loss=0.6618 acc=62.90% f1=0.00% auc=51.17% val_score=75.9222 val_score_bestthr=62.9032 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.515, mb=0.515, no=1.000, corr=0.259) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* -1000000000000000000.0000 -> 75.9222
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5151 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=0.0509 topkJ=0.0799
[TRAIN][ep=001] loss=0.6497 acc=63.70%
[TRAIN][ep=001] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2578
[EPOCH 001/089] train: loss=0.6497 acc=63.70% | val: loss=0.6613 acc=62.90% f1=0.00% auc=51.39% val_score=70.6616 val_score_bestthr=62.9032 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.515, mb=0.515, no=1.000, corr=0.258) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 75.9222 -> 70.6616
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5143 mb_mean=0.5158 norm_overlap=1.0002 corr_cb=0.1856 topkJ=0.1505
[TRAIN][ep=002] loss=0.6486 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2621
[EPOCH 002/089] train: loss=0.6486 acc=63.70% | val: loss=0.6610 acc=62.90% f1=0.00% auc=50.84% val_score=68.7100 val_score_bestthr=62.9032 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.515, mb=0.515, no=1.000, corr=0.262) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 75.9222 -> 68.7100
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5142 mb_mean=0.5139 norm_overlap=1.0007 corr_cb=0.4700 topkJ=0.2643
[TRAIN][ep=003] loss=0.6477 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2561
[EPOCH 003/089] train: loss=0.6477 acc=63.70% | val: loss=0.6609 acc=62.90% f1=0.00% auc=50.95% val_score=74.6154 val_score_bestthr=62.9032 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.515, mb=0.515, no=1.000, corr=0.256) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 75.9222 -> 74.6154
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5147 mb_mean=0.5159 norm_overlap=1.0007 corr_cb=0.4334 topkJ=0.1914
[TRAIN][ep=004] loss=0.6459 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2609
[EPOCH 004/089] train: loss=0.6459 acc=63.70% | val: loss=0.6609 acc=62.90% f1=0.00% auc=50.95% val_score=76.5990 val_score_bestthr=62.9032 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.515, mb=0.515, no=1.000, corr=0.261) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 75.9222 -> 76.5990
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5137 mb_mean=0.5154 norm_overlap=1.0001 corr_cb=0.0616 topkJ=0.0627
[TRAIN][ep=005] loss=2.1185 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.5036 mb_mean=0.5070 norm_overlap=1.0002 corr_cb=0.1666
[EPOCH 005/089] train: loss=2.1185 acc=63.70% | val: loss=0.6615 acc=62.90% f1=0.00% auc=51.28% val_score=74.1771 val_score_bestthr=62.9032 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.504, mb=0.507, no=1.000, corr=0.167) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.5990 -> 74.1771
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4915 mb_mean=0.4948 norm_overlap=1.0008 corr_cb=0.3678 topkJ=0.1379
[TRAIN][ep=006] loss=1.4212 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.4817 mb_mean=0.4880 norm_overlap=1.0005 corr_cb=0.2059
[EPOCH 006/089] train: loss=1.4212 acc=63.70% | val: loss=0.6615 acc=62.90% f1=0.00% auc=51.62% val_score=74.1771 val_score_bestthr=62.9032 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.482, mb=0.488, no=1.000, corr=0.206) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.5990 -> 74.1771
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4669 mb_mean=0.4744 norm_overlap=1.0014 corr_cb=0.4067 topkJ=0.1209
[TRAIN][ep=007] loss=0.7329 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.4593 mb_mean=0.4655 norm_overlap=1.0015 corr_cb=0.3572
[EPOCH 007/089] train: loss=0.7329 acc=63.70% | val: loss=0.6623 acc=62.90% f1=0.00% auc=51.28% val_score=73.1129 val_score_bestthr=62.9032 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.459, mb=0.465, no=1.001, corr=0.357) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.5990 -> 73.1129
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4519 mb_mean=0.4557 norm_overlap=1.0016 corr_cb=0.3390 topkJ=0.0554
[TRAIN][ep=008] loss=0.5796 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.4367 mb_mean=0.4394 norm_overlap=1.0034 corr_cb=0.4182
[EPOCH 008/089] train: loss=0.5796 acc=63.70% | val: loss=0.6627 acc=62.90% f1=14.81% auc=51.06% val_score=74.1351 val_score_bestthr=69.8730 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.437, mb=0.439, no=1.003, corr=0.418) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.5990 -> 74.1351
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4175 mb_mean=0.4166 norm_overlap=1.0075 corr_cb=0.5431 topkJ=0.2185
[TRAIN][ep=009] loss=0.8463 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.4154 mb_mean=0.4105 norm_overlap=1.0055 corr_cb=0.3897
[EPOCH 009/089] train: loss=0.8463 acc=63.70% | val: loss=0.6646 acc=64.52% f1=8.33% auc=51.06% val_score=76.8941 val_score_bestthr=68.4365 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.415, mb=0.411, no=1.006, corr=0.390) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 76.5990 -> 76.8941
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=010] disease_pos_weight=1.0000 mode=none
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.4066 mb_mean=0.3957 norm_overlap=1.0058 corr_cb=0.3322 topkJ=0.0861
[TRAIN][ep=010] loss=1.1144 acc=63.70%
[TRAIN][ep=010] mask_avg: mc_mean=0.3967 mb_mean=0.3812 norm_overlap=1.0064 corr_cb=0.2799
[EPOCH 010/089] train: loss=1.1144 acc=63.70% | val: loss=0.6663 acc=66.13% f1=16.00% auc=50.17% val_score=75.9593 val_score_bestthr=73.7211 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.397, mb=0.381, no=1.006, corr=0.280) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.8941 -> 75.9593
[DBG][ep=011] disease_pos_weight=1.0000 mode=none
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.3761 mb_mean=0.3534 norm_overlap=1.0081 corr_cb=0.2613 topkJ=0.1182
[TRAIN][ep=011] loss=1.3807 acc=63.70%
[TRAIN][ep=011] mask_avg: mc_mean=0.3814 mb_mean=0.3542 norm_overlap=1.0056 corr_cb=0.1680
[EPOCH 011/089] train: loss=1.3807 acc=63.70% | val: loss=0.6685 acc=64.52% f1=8.33% auc=49.83% val_score=74.4960 val_score_bestthr=68.4365 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.381, mb=0.354, no=1.006, corr=0.168) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.8941 -> 74.4960
[DBG][ep=012] disease_pos_weight=1.0000 mode=none
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.3804 mb_mean=0.3564 norm_overlap=1.0036 corr_cb=0.1044 topkJ=0.0459
[TRAIN][ep=012] loss=1.6488 acc=63.70%
[TRAIN][ep=012] mask_avg: mc_mean=0.3675 mb_mean=0.3325 norm_overlap=1.0008 corr_cb=0.0209
[EPOCH 012/089] train: loss=1.6488 acc=63.70% | val: loss=0.6700 acc=64.52% f1=15.38% auc=49.61% val_score=74.4960 val_score_bestthr=71.7153 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.368, mb=0.332, no=1.001, corr=0.021) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.8941 -> 74.4960
[DBG][ep=013] disease_pos_weight=1.0000 mode=none
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.3579 mb_mean=0.3238 norm_overlap=0.9918 corr_cb=-0.1574 topkJ=0.0375
[TRAIN][ep=013] loss=1.9124 acc=63.70%
[TRAIN][ep=013] mask_avg: mc_mean=0.3556 mb_mean=0.3156 norm_overlap=0.9877 corr_cb=-0.1907
[EPOCH 013/089] train: loss=1.9124 acc=63.70% | val: loss=0.6720 acc=62.90% f1=20.69% auc=49.61% val_score=70.4502 val_score_bestthr=72.5223 | dyn(w_pfs=0.240, w_sup=0.240, w_csuf=0.200, stage2=False) | mask(mc=0.356, mb=0.316, no=0.988, corr=-0.191) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.8941 -> 70.4502
[DBG][ep=014] disease_pos_weight=1.0000 mode=none
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.3548 mb_mean=0.3178 norm_overlap=0.9761 corr_cb=-0.3137 topkJ=0.0138
[TRAIN][ep=014] loss=2.0263 acc=63.70%
[TRAIN][ep=014] mask_avg: mc_mean=0.3443 mb_mean=0.3032 norm_overlap=0.9628 corr_cb=-0.4003
[EPOCH 014/089] train: loss=2.0263 acc=63.70% | val: loss=0.6730 acc=66.13% f1=16.00% auc=49.16% val_score=68.5007 val_score_bestthr=73.7211 | dyn(w_pfs=0.280, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.344, mb=0.303, no=0.963, corr=-0.400) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.8941 -> 68.5007
[DBG][ep=015] disease_pos_weight=1.0000 mode=none
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.3350 mb_mean=0.3019 norm_overlap=0.9517 corr_cb=-0.4857 topkJ=0.0162
[TRAIN][ep=015] loss=2.0469 acc=63.70%
[TRAIN][ep=015] mask_avg: mc_mean=0.3358 mb_mean=0.2979 norm_overlap=0.9351 corr_cb=-0.5537
[EPOCH 015/089] train: loss=2.0469 acc=63.70% | val: loss=0.6752 acc=66.13% f1=16.00% auc=50.28% val_score=67.3928 val_score_bestthr=73.7211 | dyn(w_pfs=0.180, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.336, mb=0.298, no=0.935, corr=-0.554) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 67.3928
[DBG][ep=016] disease_pos_weight=1.0000 mode=none
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.3255 mb_mean=0.2867 norm_overlap=0.9020 corr_cb=-0.6538 topkJ=0.0053
[TRAIN][ep=016] loss=1.3597 acc=63.70%
[TRAIN][ep=016] mask_avg: mc_mean=0.3280 mb_mean=0.2980 norm_overlap=0.9131 corr_cb=-0.6278
[EPOCH 016/089] train: loss=1.3597 acc=63.70% | val: loss=0.6781 acc=66.13% f1=22.22% auc=49.72% val_score=62.5416 val_score_bestthr=76.5845 | dyn(w_pfs=0.220, w_sup=0.190, w_csuf=0.140, stage2=False) | mask(mc=0.328, mb=0.298, no=0.913, corr=-0.628) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 62.5416
[DBG][ep=017] disease_pos_weight=1.0000 mode=none
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.3312 mb_mean=0.3097 norm_overlap=0.9321 corr_cb=-0.6200 topkJ=0.0024
[TRAIN][ep=017] loss=1.6277 acc=63.70%
[TRAIN][ep=017] mask_avg: mc_mean=0.3220 mb_mean=0.2980 norm_overlap=0.8928 corr_cb=-0.6761
[EPOCH 017/089] train: loss=1.6277 acc=63.70% | val: loss=0.6809 acc=66.13% f1=22.22% auc=50.17% val_score=68.4426 val_score_bestthr=76.5845 | dyn(w_pfs=0.260, w_sup=0.230, w_csuf=0.180, stage2=False) | mask(mc=0.322, mb=0.298, no=0.893, corr=-0.676) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 68.4426
[DBG][ep=018] disease_pos_weight=1.0000 mode=none
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.3210 mb_mean=0.3129 norm_overlap=0.9123 corr_cb=-0.6717 topkJ=0.0000
[TRAIN][ep=018] loss=1.8912 acc=63.70%
[TRAIN][ep=018] mask_avg: mc_mean=0.3181 mb_mean=0.2979 norm_overlap=0.8743 corr_cb=-0.7135
[EPOCH 018/089] train: loss=1.8912 acc=63.70% | val: loss=0.6850 acc=64.52% f1=21.43% auc=50.72% val_score=69.4048 val_score_bestthr=74.4895 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.318, mb=0.298, no=0.874, corr=-0.714) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.4048
[DBG][ep=019] disease_pos_weight=1.0000 mode=none
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.3254 mb_mean=0.3006 norm_overlap=0.8673 corr_cb=-0.7537 topkJ=0.0000
[TRAIN][ep=019] loss=2.0197 acc=63.70%
[TRAIN][ep=019] mask_avg: mc_mean=0.3135 mb_mean=0.2980 norm_overlap=0.8573 corr_cb=-0.7349
[EPOCH 019/089] train: loss=2.0197 acc=63.70% | val: loss=0.6850 acc=64.52% f1=26.67% auc=50.95% val_score=70.8317 val_score_bestthr=77.0136 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.313, mb=0.298, no=0.857, corr=-0.735) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 70.8317
[DBG][ep=020] disease_pos_weight=1.0000 mode=none
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.2914 mb_mean=0.3042 norm_overlap=0.8878 corr_cb=-0.6173 topkJ=0.0000
[TRAIN][ep=020] loss=2.0151 acc=63.70%
[TRAIN][ep=020] mask_avg: mc_mean=0.3097 mb_mean=0.2979 norm_overlap=0.8394 corr_cb=-0.7581
[EPOCH 020/089] train: loss=2.0151 acc=63.70% | val: loss=0.6880 acc=64.52% f1=26.67% auc=50.84% val_score=70.9191 val_score_bestthr=77.0136 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.310, mb=0.298, no=0.839, corr=-0.758) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 70.9191
[DBG][ep=021] disease_pos_weight=1.0000 mode=none
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.3053 mb_mean=0.3072 norm_overlap=0.8525 corr_cb=-0.7048 topkJ=0.0000
[TRAIN][ep=021] loss=2.0084 acc=63.70%
[TRAIN][ep=021] mask_avg: mc_mean=0.3075 mb_mean=0.2979 norm_overlap=0.8283 corr_cb=-0.7659
[EPOCH 021/089] train: loss=2.0084 acc=63.70% | val: loss=0.6908 acc=64.52% f1=26.67% auc=50.17% val_score=70.9191 val_score_bestthr=77.0136 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.308, mb=0.298, no=0.828, corr=-0.766) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 70.9191
[DBG][ep=022] disease_pos_weight=1.0000 mode=none
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2972 mb_mean=0.3162 norm_overlap=0.8467 corr_cb=-0.7819 topkJ=0.0000
[TRAIN][ep=022] loss=1.9993 acc=63.70%
[TRAIN][ep=022] mask_avg: mc_mean=0.3041 mb_mean=0.2979 norm_overlap=0.8135 corr_cb=-0.7820
[EPOCH 022/089] train: loss=1.9993 acc=63.70% | val: loss=0.6920 acc=66.13% f1=36.36% auc=50.50% val_score=68.1527 val_score_bestthr=83.4443 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.304, mb=0.298, no=0.814, corr=-0.782) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 68.1527
[DBG][ep=023] disease_pos_weight=1.0000 mode=none
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2877 mb_mean=0.3011 norm_overlap=0.7828 corr_cb=-0.8224 topkJ=0.0000
[TRAIN][ep=023] loss=1.9900 acc=64.25%
[TRAIN][ep=023] mask_avg: mc_mean=0.3018 mb_mean=0.2979 norm_overlap=0.8037 corr_cb=-0.7844
[EPOCH 023/089] train: loss=1.9900 acc=64.25% | val: loss=0.6967 acc=67.74% f1=44.44% auc=50.95% val_score=72.9677 val_score_bestthr=89.5791 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.302, mb=0.298, no=0.804, corr=-0.784) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 72.9677
[DBG][ep=024] disease_pos_weight=1.0000 mode=none
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.3180 mb_mean=0.2671 norm_overlap=0.7129 corr_cb=-0.8286 topkJ=0.0000
[TRAIN][ep=024] loss=1.9819 acc=64.79%
[TRAIN][ep=024] mask_avg: mc_mean=0.2994 mb_mean=0.2979 norm_overlap=0.7948 corr_cb=-0.7867
[EPOCH 024/089] train: loss=1.9819 acc=64.79% | val: loss=0.6961 acc=64.52% f1=42.11% auc=51.39% val_score=73.7610 val_score_bestthr=85.1541 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.299, mb=0.298, no=0.795, corr=-0.787) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 73.7610
[DBG][ep=025] disease_pos_weight=1.0000 mode=none
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.3088 mb_mean=0.2842 norm_overlap=0.7353 corr_cb=-0.8377 topkJ=0.0000
[TRAIN][ep=025] loss=1.9700 acc=64.79%
[TRAIN][ep=025] mask_avg: mc_mean=0.2981 mb_mean=0.2980 norm_overlap=0.7839 corr_cb=-0.7942
[EPOCH 025/089] train: loss=1.9700 acc=64.79% | val: loss=0.7002 acc=64.52% f1=26.67% auc=51.06% val_score=68.5763 val_score_bestthr=77.0136 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.298, mb=0.298, no=0.784, corr=-0.794) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 68.5763
[DBG][ep=026] disease_pos_weight=1.0000 mode=none
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2987 mb_mean=0.2968 norm_overlap=0.7914 corr_cb=-0.7999 topkJ=0.0000
[TRAIN][ep=026] loss=1.9577 acc=66.42%
[TRAIN][ep=026] mask_avg: mc_mean=0.2939 mb_mean=0.2979 norm_overlap=0.7741 corr_cb=-0.8003
[EPOCH 026/089] train: loss=1.9577 acc=66.42% | val: loss=0.7053 acc=64.52% f1=26.67% auc=51.62% val_score=71.7636 val_score_bestthr=77.0136 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.294, mb=0.298, no=0.774, corr=-0.800) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 71.7636
[DBG][ep=027] disease_pos_weight=1.0000 mode=none
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2994 mb_mean=0.2814 norm_overlap=0.7203 corr_cb=-0.8226 topkJ=0.0000
[TRAIN][ep=027] loss=1.9581 acc=67.33%
[TRAIN][ep=027] mask_avg: mc_mean=0.2924 mb_mean=0.2980 norm_overlap=0.7662 corr_cb=-0.8052
[EPOCH 027/089] train: loss=1.9581 acc=67.33% | val: loss=0.7149 acc=64.52% f1=31.25% auc=51.62% val_score=72.1205 val_score_bestthr=79.2650 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.292, mb=0.298, no=0.766, corr=-0.805) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 72.1205
[DBG][ep=028] disease_pos_weight=1.0000 mode=none
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2940 mb_mean=0.3050 norm_overlap=0.7535 corr_cb=-0.8509 topkJ=0.0000
[TRAIN][ep=028] loss=1.9436 acc=67.51%
[TRAIN][ep=028] mask_avg: mc_mean=0.2906 mb_mean=0.2980 norm_overlap=0.7578 corr_cb=-0.8098
[EPOCH 028/089] train: loss=1.9436 acc=67.51% | val: loss=0.7072 acc=66.13% f1=36.36% auc=51.95% val_score=72.5631 val_score_bestthr=83.5741 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.291, mb=0.298, no=0.758, corr=-0.810) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 72.5631
[DBG][ep=029] disease_pos_weight=1.0000 mode=none
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2729 mb_mean=0.3037 norm_overlap=0.7875 corr_cb=-0.7594 topkJ=0.0000
[TRAIN][ep=029] loss=1.2607 acc=70.78%
[TRAIN][ep=029] mask_avg: mc_mean=0.2874 mb_mean=0.2979 norm_overlap=0.7535 corr_cb=-0.8059
[EPOCH 029/089] train: loss=1.2607 acc=70.78% | val: loss=0.7248 acc=64.52% f1=38.89% auc=51.62% val_score=71.0126 val_score_bestthr=83.3922 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.287, mb=0.298, no=0.753, corr=-0.806) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 71.0126
[DBG][ep=030] disease_pos_weight=1.0000 mode=none
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2781 mb_mean=0.2923 norm_overlap=0.7735 corr_cb=-0.7662 topkJ=0.0000
[TRAIN][ep=030] loss=0.5838 acc=69.87%
[TRAIN][ep=030] mask_avg: mc_mean=0.2848 mb_mean=0.2979 norm_overlap=0.7442 corr_cb=-0.8151
[EPOCH 030/089] train: loss=0.5838 acc=69.87% | val: loss=0.7257 acc=66.13% f1=40.00% auc=52.06% val_score=70.5945 val_score_bestthr=85.5834 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.285, mb=0.298, no=0.744, corr=-0.815) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 70.5945
[DBG][ep=031] disease_pos_weight=1.0000 mode=none
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2853 mb_mean=0.3040 norm_overlap=0.7717 corr_cb=-0.8100 topkJ=0.0000
[TRAIN][ep=031] loss=0.4320 acc=75.14%
[TRAIN][ep=031] mask_avg: mc_mean=0.2840 mb_mean=0.2980 norm_overlap=0.7412 corr_cb=-0.8158
[EPOCH 031/089] train: loss=0.4320 acc=75.14% | val: loss=0.7327 acc=66.13% f1=40.00% auc=51.62% val_score=72.5631 val_score_bestthr=85.5834 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.284, mb=0.298, no=0.741, corr=-0.816) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 72.5631
[DBG][ep=032] disease_pos_weight=1.0000 mode=none
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2654 mb_mean=0.3059 norm_overlap=0.7834 corr_cb=-0.7704 topkJ=0.0000
[TRAIN][ep=032] loss=0.4291 acc=74.95%
[TRAIN][ep=032] mask_avg: mc_mean=0.2840 mb_mean=0.2979 norm_overlap=0.7412 corr_cb=-0.8156
[EPOCH 032/089] train: loss=0.4291 acc=74.95% | val: loss=0.7365 acc=66.13% f1=40.00% auc=51.62% val_score=69.8745 val_score_bestthr=85.5834 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.284, mb=0.298, no=0.741, corr=-0.816) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.8745
[DBG][ep=033] disease_pos_weight=1.0000 mode=none
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2878 mb_mean=0.3001 norm_overlap=0.7473 corr_cb=-0.8392 topkJ=0.0000
[TRAIN][ep=033] loss=0.4265 acc=75.50%
[TRAIN][ep=033] mask_avg: mc_mean=0.2840 mb_mean=0.2980 norm_overlap=0.7415 corr_cb=-0.8142
[EPOCH 033/089] train: loss=0.4265 acc=75.50% | val: loss=0.7398 acc=66.13% f1=36.36% auc=51.73% val_score=69.8745 val_score_bestthr=83.5741 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.284, mb=0.298, no=0.742, corr=-0.814) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.8745
[DBG][ep=034] disease_pos_weight=1.0000 mode=none
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2801 mb_mean=0.2941 norm_overlap=0.7347 corr_cb=-0.8364 topkJ=0.0000
[TRAIN][ep=034] loss=0.4238 acc=75.14%
[TRAIN][ep=034] mask_avg: mc_mean=0.2840 mb_mean=0.2979 norm_overlap=0.7416 corr_cb=-0.8146
[EPOCH 034/089] train: loss=0.4238 acc=75.14% | val: loss=0.7462 acc=66.13% f1=40.00% auc=51.39% val_score=69.8745 val_score_bestthr=85.5834 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.284, mb=0.298, no=0.742, corr=-0.815) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.8745
[DBG][ep=035] disease_pos_weight=1.0000 mode=none
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2888 mb_mean=0.3001 norm_overlap=0.7193 corr_cb=-0.8206 topkJ=0.0000
[TRAIN][ep=035] loss=0.4220 acc=74.59%
[TRAIN][ep=035] mask_avg: mc_mean=0.2840 mb_mean=0.2979 norm_overlap=0.7410 corr_cb=-0.8156
[EPOCH 035/089] train: loss=0.4220 acc=74.59% | val: loss=0.7497 acc=66.13% f1=40.00% auc=51.39% val_score=69.8745 val_score_bestthr=85.5834 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.284, mb=0.298, no=0.741, corr=-0.816) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.8745
[DBG][ep=036] disease_pos_weight=1.0000 mode=none
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.3158 mb_mean=0.2738 norm_overlap=0.6436 corr_cb=-0.8972 topkJ=0.0000
[TRAIN][ep=036] loss=0.4188 acc=75.32%
[TRAIN][ep=036] mask_avg: mc_mean=0.2840 mb_mean=0.2979 norm_overlap=0.7411 corr_cb=-0.8165
[EPOCH 036/089] train: loss=0.4188 acc=75.32% | val: loss=0.7537 acc=64.52% f1=38.89% auc=51.73% val_score=69.8745 val_score_bestthr=83.3727 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.284, mb=0.298, no=0.741, corr=-0.816) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.8745
[DBG][ep=037] disease_pos_weight=1.0000 mode=none
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.2793 mb_mean=0.3105 norm_overlap=0.7731 corr_cb=-0.8016 topkJ=0.0000
[TRAIN][ep=037] loss=0.4163 acc=75.50%
[TRAIN][ep=037] mask_avg: mc_mean=0.2840 mb_mean=0.2979 norm_overlap=0.7414 corr_cb=-0.8155
[EPOCH 037/089] train: loss=0.4163 acc=75.50% | val: loss=0.7541 acc=64.52% f1=38.89% auc=51.95% val_score=69.8745 val_score_bestthr=83.3727 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.284, mb=0.298, no=0.741, corr=-0.815) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.8745
[DBG][ep=038] disease_pos_weight=1.0000 mode=none
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2837 mb_mean=0.2943 norm_overlap=0.7248 corr_cb=-0.8420 topkJ=0.0000
[TRAIN][ep=038] loss=0.4145 acc=75.14%
[TRAIN][ep=038] mask_avg: mc_mean=0.2840 mb_mean=0.2979 norm_overlap=0.7415 corr_cb=-0.8141
[EPOCH 038/089] train: loss=0.4145 acc=75.14% | val: loss=0.7541 acc=66.13% f1=36.36% auc=52.29% val_score=69.8745 val_score_bestthr=83.5741 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.284, mb=0.298, no=0.741, corr=-0.814) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.8745
[DBG][ep=039] disease_pos_weight=1.0000 mode=none
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2917 mb_mean=0.2970 norm_overlap=0.7307 corr_cb=-0.8450 topkJ=0.0000
[TRAIN][ep=039] loss=0.4114 acc=75.32%
[TRAIN][ep=039] mask_avg: mc_mean=0.2840 mb_mean=0.2979 norm_overlap=0.7413 corr_cb=-0.8152
[EPOCH 039/089] train: loss=0.4114 acc=75.32% | val: loss=0.7587 acc=66.13% f1=40.00% auc=52.29% val_score=69.8745 val_score_bestthr=85.5834 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.284, mb=0.298, no=0.741, corr=-0.815) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 76.8941 -> 69.8745
[EARLY STOP] no improvement for 30 epochs. best_epoch=9
[CKPT] Loaded best for testing: results/ADHD_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
=============== FIT DONE ===============
[BEST] epoch=9 | val_acc=64.52% | val_f1=8.33% | val_auc=51.06% | val_score=76.8941 | val_score_bestthr=68.4365
[TEST@BEST] thr_used=0.400 | acc=66.23% f1=18.75% auc=59.62% | SP_sex=0.32% EO_sex=3.03% SP_age=4.35% EO_age=11.52%
[TIME] 0.67 min
[OK] Saved: results/ADHD_3x5fold_seed0/fold1_rep1_seed1001/summary_fold_1.json
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5144 mb_mean=0.5150 norm_overlap=1.0001 corr_cb=0.1309 topkJ=0.0912
[TRAIN][ep=000] loss=0.7030 acc=36.48%
[TRAIN][ep=000] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2625
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5154 mb_mean=0.5148 norm_overlap=1.0002 corr_cb=0.2404 topkJ=0.1127
[TRAIN][ep=001] loss=0.6861 acc=62.25%
[TRAIN][ep=001] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2578
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5149 mb_mean=0.5167 norm_overlap=1.0008 corr_cb=0.5338 topkJ=0.2907
[TRAIN][ep=002] loss=0.6733 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2599
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5157 mb_mean=0.5166 norm_overlap=1.0002 corr_cb=0.1407 topkJ=0.0837
[TRAIN][ep=003] loss=0.6626 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2572
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5155 mb_mean=0.5150 norm_overlap=1.0006 corr_cb=0.3877 topkJ=0.2261
[TRAIN][ep=004] loss=0.6580 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2563
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5144 mb_mean=0.5149 norm_overlap=1.0005 corr_cb=0.3178 topkJ=0.2069
[TRAIN][ep=005] loss=0.6563 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2581
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5162 mb_mean=0.5152 norm_overlap=1.0006 corr_cb=0.3963 topkJ=0.1808
[TRAIN][ep=006] loss=0.6549 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2561
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5160 mb_mean=0.5163 norm_overlap=1.0003 corr_cb=0.2399 topkJ=0.1667
[TRAIN][ep=007] loss=0.6540 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2581
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5151 mb_mean=0.5161 norm_overlap=1.0002 corr_cb=0.1733 topkJ=0.1150
[TRAIN][ep=008] loss=0.6529 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2604
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5152 mb_mean=0.5142 norm_overlap=1.0003 corr_cb=0.2795 topkJ=0.1008
[TRAIN][ep=009] loss=0.6519 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2576
================= FIT START (fold=1) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.35 select_by=val_score | eval_thr_mode=best_acc eval_thr_grid=coarse | disease_pos_weight_mode=none freeze_b_after=15 | two_stage=True stage1_ratio=0.35 stage2_lr_mult=0.3 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5146 mb_mean=0.5164 norm_overlap=1.0004 corr_cb=0.2841 topkJ=0.1112
[TRAIN][ep=000] loss=0.6509 acc=63.70%
[TRAIN][ep=000] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2587
[EPOCH 000/089] train: loss=0.6509 acc=63.70% | val: loss=0.6618 acc=62.90% f1=0.00% auc=51.17% val_score=75.9222 val_score_bestthr=62.9032 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.515, mb=0.515, no=1.000, corr=0.259) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* -1000000000000000000.0000 -> 75.9222
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5151 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=0.0509 topkJ=0.0799
[TRAIN][ep=001] loss=0.6497 acc=63.70%
[TRAIN][ep=001] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2578
[EPOCH 001/089] train: loss=0.6497 acc=63.70% | val: loss=0.6613 acc=62.90% f1=0.00% auc=51.39% val_score=70.6616 val_score_bestthr=62.9032 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.515, mb=0.515, no=1.000, corr=0.258) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 75.9222 -> 70.6616
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5143 mb_mean=0.5158 norm_overlap=1.0002 corr_cb=0.1856 topkJ=0.1505
[TRAIN][ep=002] loss=0.6486 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2621
[EPOCH 002/089] train: loss=0.6486 acc=63.70% | val: loss=0.6610 acc=62.90% f1=0.00% auc=50.84% val_score=68.7100 val_score_bestthr=62.9032 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.515, mb=0.515, no=1.000, corr=0.262) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 75.9222 -> 68.7100
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5142 mb_mean=0.5139 norm_overlap=1.0007 corr_cb=0.4700 topkJ=0.2643
[TRAIN][ep=003] loss=0.6477 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2561
[EPOCH 003/089] train: loss=0.6477 acc=63.70% | val: loss=0.6609 acc=62.90% f1=0.00% auc=50.95% val_score=74.6154 val_score_bestthr=62.9032 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.515, mb=0.515, no=1.000, corr=0.256) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 75.9222 -> 74.6154
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5147 mb_mean=0.5159 norm_overlap=1.0007 corr_cb=0.4334 topkJ=0.1914
[TRAIN][ep=004] loss=0.6459 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2609
[EPOCH 004/089] train: loss=0.6459 acc=63.70% | val: loss=0.6609 acc=62.90% f1=0.00% auc=50.95% val_score=76.5990 val_score_bestthr=62.9032 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.515, mb=0.515, no=1.000, corr=0.261) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 75.9222 -> 76.5990
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5137 mb_mean=0.5154 norm_overlap=1.0001 corr_cb=0.0616 topkJ=0.0627
[TRAIN][ep=005] loss=1.4531 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.5033 mb_mean=0.4933 norm_overlap=1.0003 corr_cb=0.1697
[EPOCH 005/089] train: loss=1.4531 acc=63.70% | val: loss=0.6613 acc=62.90% f1=0.00% auc=51.28% val_score=74.1771 val_score_bestthr=62.9032 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.503, mb=0.493, no=1.000, corr=0.170) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.5990 -> 74.1771
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4909 mb_mean=0.4676 norm_overlap=1.0015 corr_cb=0.4108 topkJ=0.1369
[TRAIN][ep=006] loss=1.0283 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.4812 mb_mean=0.4482 norm_overlap=1.0012 corr_cb=0.2626
[EPOCH 006/089] train: loss=1.0283 acc=63.70% | val: loss=0.6615 acc=62.90% f1=0.00% auc=51.39% val_score=72.1339 val_score_bestthr=62.9032 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.481, mb=0.448, no=1.001, corr=0.263) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.5990 -> 72.1339
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4665 mb_mean=0.4143 norm_overlap=1.0030 corr_cb=0.3565 topkJ=0.0746
[TRAIN][ep=007] loss=0.6055 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.4595 mb_mean=0.4025 norm_overlap=1.0031 corr_cb=0.2993
[EPOCH 007/089] train: loss=0.6055 acc=63.70% | val: loss=0.6626 acc=64.52% f1=8.33% auc=51.28% val_score=78.1322 val_score_bestthr=68.4365 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.040, stage2=False) | mask(mc=0.459, mb=0.403, no=1.003, corr=0.299) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 76.5990 -> 78.1322
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4527 mb_mean=0.3891 norm_overlap=1.0026 corr_cb=0.2110 topkJ=0.0496
[TRAIN][ep=008] loss=0.7641 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.4386 mb_mean=0.3617 norm_overlap=1.0039 corr_cb=0.1973
[EPOCH 008/089] train: loss=0.7641 acc=63.70% | val: loss=0.6633 acc=62.90% f1=14.81% auc=51.17% val_score=72.8156 val_score_bestthr=69.8730 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.080, stage2=False) | mask(mc=0.439, mb=0.362, no=1.004, corr=0.197) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 78.1322 -> 72.8156
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4210 mb_mean=0.3296 norm_overlap=1.0099 corr_cb=0.3112 topkJ=0.1132
[TRAIN][ep=009] loss=0.9253 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.4201 mb_mean=0.3298 norm_overlap=1.0007 corr_cb=0.0186
[EPOCH 009/089] train: loss=0.9253 acc=63.70% | val: loss=0.6656 acc=64.52% f1=8.33% auc=50.39% val_score=72.4940 val_score_bestthr=68.4365 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.120, stage2=False) | mask(mc=0.420, mb=0.330, no=1.001, corr=0.019) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 78.1322 -> 72.4940
[DBG][ep=010] disease_pos_weight=1.0000 mode=none
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.4134 mb_mean=0.3168 norm_overlap=0.9941 corr_cb=-0.1470 topkJ=0.0155
[TRAIN][ep=010] loss=1.0862 acc=63.70%
[TRAIN][ep=010] mask_avg: mc_mean=0.4036 mb_mean=0.3072 norm_overlap=0.9877 corr_cb=-0.2354
[EPOCH 010/089] train: loss=1.0862 acc=63.70% | val: loss=0.6672 acc=62.90% f1=14.81% auc=49.16% val_score=72.4940 val_score_bestthr=69.8730 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.160, stage2=False) | mask(mc=0.404, mb=0.307, no=0.988, corr=-0.235) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 78.1322 -> 72.4940
[DBG][ep=011] disease_pos_weight=1.0000 mode=none
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.3849 mb_mean=0.2819 norm_overlap=0.9723 corr_cb=-0.3766 topkJ=0.0118
[TRAIN][ep=011] loss=1.2451 acc=63.70%
[TRAIN][ep=011] mask_avg: mc_mean=0.3891 mb_mean=0.2919 norm_overlap=0.9628 corr_cb=-0.4700
[EPOCH 011/089] train: loss=1.2451 acc=63.70% | val: loss=0.6699 acc=66.13% f1=16.00% auc=49.61% val_score=71.4330 val_score_bestthr=73.7211 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.389, mb=0.292, no=0.963, corr=-0.470) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 78.1322 -> 71.4330
[DBG][ep=012] disease_pos_weight=1.0000 mode=none
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.3880 mb_mean=0.2998 norm_overlap=0.9546 corr_cb=-0.5279 topkJ=0.0016
[TRAIN][ep=012] loss=1.4038 acc=63.70%
[TRAIN][ep=012] mask_avg: mc_mean=0.3749 mb_mean=0.2853 norm_overlap=0.9156 corr_cb=-0.6728
[EPOCH 012/089] train: loss=1.4038 acc=63.70% | val: loss=0.6717 acc=64.52% f1=15.38% auc=49.50% val_score=71.4330 val_score_bestthr=71.7153 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.375, mb=0.285, no=0.916, corr=-0.673) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 78.1322 -> 71.4330
[DBG][ep=013] disease_pos_weight=1.0000 mode=none
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.3606 mb_mean=0.2887 norm_overlap=0.8796 corr_cb=-0.7785 topkJ=0.0000
[TRAIN][ep=013] loss=1.4007 acc=63.70%
[TRAIN][ep=013] mask_avg: mc_mean=0.3613 mb_mean=0.2866 norm_overlap=0.8359 corr_cb=-0.8279
[EPOCH 013/089] train: loss=1.4007 acc=63.70% | val: loss=0.6744 acc=64.52% f1=15.38% auc=49.94% val_score=69.4035 val_score_bestthr=71.7153 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.361, mb=0.287, no=0.836, corr=-0.828) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 78.1322 -> 69.4035
[DBG][ep=014] disease_pos_weight=1.0000 mode=none
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.3598 mb_mean=0.2961 norm_overlap=0.7916 corr_cb=-0.8838 topkJ=0.0000
[TRAIN][ep=014] loss=1.3939 acc=63.70%
[TRAIN][ep=014] mask_avg: mc_mean=0.3483 mb_mean=0.2874 norm_overlap=0.7274 corr_cb=-0.8968
[EPOCH 014/089] train: loss=1.3939 acc=63.70% | val: loss=0.6748 acc=64.52% f1=21.43% auc=50.28% val_score=66.4546 val_score_bestthr=74.5444 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.348, mb=0.287, no=0.727, corr=-0.897) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 78.1322 -> 66.4546
[DBG][ep=015] disease_pos_weight=1.0000 mode=none
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.3422 mb_mean=0.2837 norm_overlap=0.6956 corr_cb=-0.9073 topkJ=0.0000
[TRAIN][ep=015] loss=1.3827 acc=63.70%
[TRAIN][ep=015] mask_avg: mc_mean=0.3389 mb_mean=0.2864 norm_overlap=0.6418 corr_cb=-0.9113
[EPOCH 015/089] train: loss=1.3827 acc=63.70% | val: loss=0.6777 acc=66.13% f1=22.22% auc=49.72% val_score=67.3928 val_score_bestthr=76.5845 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.339, mb=0.286, no=0.642, corr=-0.911) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 78.1322 -> 67.3928
[DBG][ep=016] disease_pos_weight=1.0000 mode=none
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.3331 mb_mean=0.2871 norm_overlap=0.5421 corr_cb=-0.9248 topkJ=0.0000
[TRAIN][ep=016] loss=1.3704 acc=63.70%
[TRAIN][ep=016] mask_avg: mc_mean=0.3314 mb_mean=0.2863 norm_overlap=0.5896 corr_cb=-0.9118
[EPOCH 016/089] train: loss=1.3704 acc=63.70% | val: loss=0.6806 acc=66.13% f1=22.22% auc=50.06% val_score=61.6020 val_score_bestthr=76.5845 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.331, mb=0.286, no=0.590, corr=-0.912) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 78.1322 -> 61.6020
[DBG][ep=017] disease_pos_weight=1.0000 mode=none
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.3307 mb_mean=0.2820 norm_overlap=0.6576 corr_cb=-0.8875 topkJ=0.0000
[TRAIN][ep=017] loss=1.3660 acc=63.70%
[TRAIN][ep=017] mask_avg: mc_mean=0.3259 mb_mean=0.2864 norm_overlap=0.5512 corr_cb=-0.9054
[EPOCH 017/089] train: loss=1.3660 acc=63.70% | val: loss=0.6830 acc=66.13% f1=22.22% auc=50.17% val_score=65.4158 val_score_bestthr=76.5845 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.326, mb=0.286, no=0.551, corr=-0.905) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 78.1322 -> 65.4158
[DBG][ep=018] disease_pos_weight=1.0000 mode=none
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.3169 mb_mean=0.2870 norm_overlap=0.6237 corr_cb=-0.8787 topkJ=0.0000
[TRAIN][ep=018] loss=1.3558 acc=63.70%
[TRAIN][ep=018] mask_avg: mc_mean=0.3218 mb_mean=0.2864 norm_overlap=0.5201 corr_cb=-0.8997
[EPOCH 018/089] train: loss=1.3558 acc=63.70% | val: loss=0.6885 acc=66.13% f1=22.22% auc=50.28% val_score=71.4564 val_score_bestthr=76.5845 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.322, mb=0.286, no=0.520, corr=-0.900) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 78.1322 -> 71.4564
[DBG][ep=019] disease_pos_weight=1.0000 mode=none
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.3302 mb_mean=0.2893 norm_overlap=0.5037 corr_cb=-0.9157 topkJ=0.0000
[TRAIN][ep=019] loss=1.3476 acc=63.70%
[TRAIN][ep=019] mask_avg: mc_mean=0.3176 mb_mean=0.2864 norm_overlap=0.4929 corr_cb=-0.8915
[EPOCH 019/089] train: loss=1.3476 acc=63.70% | val: loss=0.6871 acc=66.13% f1=22.22% auc=50.95% val_score=70.0135 val_score_bestthr=76.5845 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.318, mb=0.286, no=0.493, corr=-0.892) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 78.1322 -> 70.0135
[DBG][ep=020] disease_pos_weight=1.0000 mode=none
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.2903 mb_mean=0.2872 norm_overlap=0.5428 corr_cb=-0.8206 topkJ=0.0000
[TRAIN][ep=020] loss=1.3422 acc=63.70%
[TRAIN][ep=020] mask_avg: mc_mean=0.3138 mb_mean=0.2864 norm_overlap=0.4675 corr_cb=-0.8891
[EPOCH 020/089] train: loss=1.3422 acc=63.70% | val: loss=0.6893 acc=66.13% f1=27.59% auc=50.61% val_score=68.8653 val_score_bestthr=79.0307 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.314, mb=0.286, no=0.468, corr=-0.889) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 78.1322 -> 68.8653
[DBG][ep=021] disease_pos_weight=1.0000 mode=none
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.3045 mb_mean=0.3016 norm_overlap=0.4847 corr_cb=-0.8847 topkJ=0.0000
[TRAIN][ep=021] loss=1.3351 acc=63.88%
[TRAIN][ep=021] mask_avg: mc_mean=0.3110 mb_mean=0.2864 norm_overlap=0.4532 corr_cb=-0.8780
[EPOCH 021/089] train: loss=1.3351 acc=63.88% | val: loss=0.6942 acc=66.13% f1=32.26% auc=50.17% val_score=72.1331 val_score_bestthr=81.4495 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.311, mb=0.286, no=0.453, corr=-0.878) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 78.1322 -> 72.1331
[DBG][ep=022] disease_pos_weight=1.0000 mode=none
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2937 mb_mean=0.3077 norm_overlap=0.4671 corr_cb=-0.9048 topkJ=0.0000
[TRAIN][ep=022] loss=1.3263 acc=64.07%
[TRAIN][ep=022] mask_avg: mc_mean=0.3077 mb_mean=0.2864 norm_overlap=0.4348 corr_cb=-0.8748
[EPOCH 022/089] train: loss=1.3263 acc=64.07% | val: loss=0.6949 acc=64.52% f1=31.25% auc=49.94% val_score=70.9779 val_score_bestthr=79.3942 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.308, mb=0.286, no=0.435, corr=-0.875) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 78.1322 -> 70.9779
[DBG][ep=023] disease_pos_weight=1.0000 mode=none
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2876 mb_mean=0.3177 norm_overlap=0.3615 corr_cb=-0.9002 topkJ=0.0000
[TRAIN][ep=023] loss=1.3161 acc=64.97%
[TRAIN][ep=023] mask_avg: mc_mean=0.3047 mb_mean=0.2864 norm_overlap=0.4245 corr_cb=-0.8636
[EPOCH 023/089] train: loss=1.3161 acc=64.97% | val: loss=0.7003 acc=67.74% f1=37.50% auc=50.95% val_score=68.9527 val_score_bestthr=85.9440 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.305, mb=0.286, no=0.425, corr=-0.864) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 78.1322 -> 68.9527
[DBG][ep=024] disease_pos_weight=1.0000 mode=none
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.3317 mb_mean=0.2611 norm_overlap=0.3229 corr_cb=-0.8468 topkJ=0.0000
[TRAIN][ep=024] loss=1.3077 acc=65.70%
[TRAIN][ep=024] mask_avg: mc_mean=0.3020 mb_mean=0.2864 norm_overlap=0.4139 corr_cb=-0.8557
[EPOCH 024/089] train: loss=1.3077 acc=65.70% | val: loss=0.6994 acc=67.74% f1=37.50% auc=51.28% val_score=69.7061 val_score_bestthr=85.9440 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.302, mb=0.286, no=0.414, corr=-0.856) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 78.1322 -> 69.7061
[DBG][ep=025] disease_pos_weight=1.0000 mode=none
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.3172 mb_mean=0.2787 norm_overlap=0.3378 corr_cb=-0.8558 topkJ=0.0000
[TRAIN][ep=025] loss=1.2953 acc=65.34%
[TRAIN][ep=025] mask_avg: mc_mean=0.3013 mb_mean=0.2864 norm_overlap=0.4036 corr_cb=-0.8506
[EPOCH 025/089] train: loss=1.2953 acc=65.34% | val: loss=0.7038 acc=67.74% f1=37.50% auc=50.72% val_score=68.5280 val_score_bestthr=85.9440 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.301, mb=0.286, no=0.404, corr=-0.851) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 78.1322 -> 68.5280
[DBG][ep=026] disease_pos_weight=1.0000 mode=none
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.3030 mb_mean=0.2744 norm_overlap=0.4191 corr_cb=-0.8473 topkJ=0.0000
[TRAIN][ep=026] loss=1.2810 acc=68.24%
[TRAIN][ep=026] mask_avg: mc_mean=0.2983 mb_mean=0.2864 norm_overlap=0.3917 corr_cb=-0.8467
[EPOCH 026/089] train: loss=1.2810 acc=68.24% | val: loss=0.7114 acc=67.74% f1=37.50% auc=51.28% val_score=67.8019 val_score_bestthr=85.9440 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.298, mb=0.286, no=0.392, corr=-0.847) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 78.1322 -> 67.8019
[DBG][ep=027] disease_pos_weight=1.0000 mode=none
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.3063 mb_mean=0.2834 norm_overlap=0.3195 corr_cb=-0.8287 topkJ=0.0000
[TRAIN][ep=027] loss=1.2831 acc=69.33%
[TRAIN][ep=027] mask_avg: mc_mean=0.2972 mb_mean=0.2864 norm_overlap=0.3846 corr_cb=-0.8405
[EPOCH 027/089] train: loss=1.2831 acc=69.33% | val: loss=0.7209 acc=67.74% f1=37.50% auc=52.62% val_score=68.9821 val_score_bestthr=85.9440 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.297, mb=0.286, no=0.385, corr=-0.841) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 78.1322 -> 68.9821
[DBG][ep=028] disease_pos_weight=1.0000 mode=none
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2957 mb_mean=0.3029 norm_overlap=0.3652 corr_cb=-0.8752 topkJ=0.0000
[TRAIN][ep=028] loss=1.2651 acc=68.78%
[TRAIN][ep=028] mask_avg: mc_mean=0.2952 mb_mean=0.2864 norm_overlap=0.3752 corr_cb=-0.8369
[EPOCH 028/089] train: loss=1.2651 acc=68.78% | val: loss=0.7179 acc=67.74% f1=41.18% auc=52.73% val_score=69.7549 val_score_bestthr=87.8073 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.295, mb=0.286, no=0.375, corr=-0.837) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 78.1322 -> 69.7549
[DBG][ep=029] disease_pos_weight=1.0000 mode=none
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2752 mb_mean=0.2873 norm_overlap=0.4155 corr_cb=-0.7823 topkJ=0.0000
[TRAIN][ep=029] loss=1.2481 acc=72.41%
[TRAIN][ep=029] mask_avg: mc_mean=0.2931 mb_mean=0.2864 norm_overlap=0.3733 corr_cb=-0.8258
[EPOCH 029/089] train: loss=1.2481 acc=72.41% | val: loss=0.7372 acc=67.74% f1=41.18% auc=51.95% val_score=68.9821 val_score_bestthr=87.8073 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.293, mb=0.286, no=0.373, corr=-0.826) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 78.1322 -> 68.9821
[DBG][ep=030] disease_pos_weight=1.0000 mode=none
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2896 mb_mean=0.2722 norm_overlap=0.3717 corr_cb=-0.8170 topkJ=0.0000
[TRAIN][ep=030] loss=1.2312 acc=72.41%
[TRAIN][ep=030] mask_avg: mc_mean=0.2907 mb_mean=0.2864 norm_overlap=0.3618 corr_cb=-0.8277
[EPOCH 030/089] train: loss=1.2312 acc=72.41% | val: loss=0.7301 acc=66.13% f1=40.00% auc=53.07% val_score=68.5852 val_score_bestthr=85.6453 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.291, mb=0.286, no=0.362, corr=-0.828) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 78.1322 -> 68.5852
[DBG][ep=031] disease_pos_weight=1.0000 mode=none
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2913 mb_mean=0.2926 norm_overlap=0.3749 corr_cb=-0.8476 topkJ=0.0000
[TRAIN][ep=031] loss=0.4686 acc=75.50%
[TRAIN][ep=031] mask_avg: mc_mean=0.2901 mb_mean=0.2864 norm_overlap=0.3616 corr_cb=-0.8222
[EPOCH 031/089] train: loss=0.4686 acc=75.50% | val: loss=0.7390 acc=67.74% f1=41.18% auc=52.40% val_score=69.7549 val_score_bestthr=87.8073 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.290, mb=0.286, no=0.362, corr=-0.822) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 78.1322 -> 69.7549
[DBG][ep=032] disease_pos_weight=1.0000 mode=none
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2665 mb_mean=0.2910 norm_overlap=0.4071 corr_cb=-0.8178 topkJ=0.0000
[TRAIN][ep=032] loss=0.3897 acc=74.95%
[TRAIN][ep=032] mask_avg: mc_mean=0.2901 mb_mean=0.2864 norm_overlap=0.3612 corr_cb=-0.8222
[EPOCH 032/089] train: loss=0.3897 acc=74.95% | val: loss=0.7424 acc=67.74% f1=41.18% auc=52.84% val_score=69.7549 val_score_bestthr=87.8073 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.290, mb=0.286, no=0.361, corr=-0.822) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 78.1322 -> 69.7549
[DBG][ep=033] disease_pos_weight=1.0000 mode=none
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2993 mb_mean=0.2748 norm_overlap=0.3651 corr_cb=-0.8324 topkJ=0.0000
[TRAIN][ep=033] loss=0.3873 acc=75.14%
[TRAIN][ep=033] mask_avg: mc_mean=0.2900 mb_mean=0.2863 norm_overlap=0.3620 corr_cb=-0.8214
[EPOCH 033/089] train: loss=0.3873 acc=75.14% | val: loss=0.7455 acc=66.13% f1=40.00% auc=52.95% val_score=69.7549 val_score_bestthr=85.6453 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.290, mb=0.286, no=0.362, corr=-0.821) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 78.1322 -> 69.7549
[DBG][ep=034] disease_pos_weight=1.0000 mode=none
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2965 mb_mean=0.2793 norm_overlap=0.3222 corr_cb=-0.8499 topkJ=0.0000
[TRAIN][ep=034] loss=0.3845 acc=75.50%
[TRAIN][ep=034] mask_avg: mc_mean=0.2901 mb_mean=0.2864 norm_overlap=0.3624 corr_cb=-0.8212
[EPOCH 034/089] train: loss=0.3845 acc=75.50% | val: loss=0.7524 acc=67.74% f1=41.18% auc=52.62% val_score=67.0118 val_score_bestthr=87.8073 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.290, mb=0.286, no=0.362, corr=-0.821) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 78.1322 -> 67.0118
[DBG][ep=035] disease_pos_weight=1.0000 mode=none
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2943 mb_mean=0.2918 norm_overlap=0.3684 corr_cb=-0.8219 topkJ=0.0000
[TRAIN][ep=035] loss=0.3827 acc=75.32%
[TRAIN][ep=035] mask_avg: mc_mean=0.2901 mb_mean=0.2863 norm_overlap=0.3617 corr_cb=-0.8214
[EPOCH 035/089] train: loss=0.3827 acc=75.32% | val: loss=0.7566 acc=67.74% f1=41.18% auc=52.51% val_score=67.0118 val_score_bestthr=87.8073 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.290, mb=0.286, no=0.362, corr=-0.821) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 78.1322 -> 67.0118
[DBG][ep=036] disease_pos_weight=1.0000 mode=none
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.3269 mb_mean=0.2814 norm_overlap=0.2379 corr_cb=-0.8708 topkJ=0.0000
[TRAIN][ep=036] loss=0.3795 acc=74.77%
[TRAIN][ep=036] mask_avg: mc_mean=0.2901 mb_mean=0.2864 norm_overlap=0.3610 corr_cb=-0.8222
[EPOCH 036/089] train: loss=0.3795 acc=74.77% | val: loss=0.7603 acc=67.74% f1=41.18% auc=52.84% val_score=67.0118 val_score_bestthr=87.8073 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.290, mb=0.286, no=0.361, corr=-0.822) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 78.1322 -> 67.0118
[DBG][ep=037] disease_pos_weight=1.0000 mode=none
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.2822 mb_mean=0.2930 norm_overlap=0.4026 corr_cb=-0.8373 topkJ=0.0000
[TRAIN][ep=037] loss=0.3771 acc=76.04%
[TRAIN][ep=037] mask_avg: mc_mean=0.2901 mb_mean=0.2864 norm_overlap=0.3620 corr_cb=-0.8219
[EPOCH 037/089] train: loss=0.3771 acc=76.04% | val: loss=0.7606 acc=67.74% f1=41.18% auc=52.62% val_score=67.0118 val_score_bestthr=87.8073 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.290, mb=0.286, no=0.362, corr=-0.822) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 78.1322 -> 67.0118
[EARLY STOP] no improvement for 30 epochs. best_epoch=7
[CKPT] Loaded best for testing: results/ADHD_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
=============== FIT DONE ===============
[BEST] epoch=7 | val_acc=64.52% | val_f1=8.33% | val_auc=51.28% | val_score=78.1322 | val_score_bestthr=68.4365
[TEST@BEST] thr_used=0.400 | acc=65.58% f1=13.11% auc=58.75% | SP_sex=0.14% EO_sex=1.52% SP_age=5.13% EO_age=18.18%
[TIME] 0.64 min
[OK] Saved: results/ADHD_3x5fold_seed0/fold1_rep1_seed1001/summary_fold_1.json
[DBG][ep=000] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5144 mb_mean=0.5150 norm_overlap=1.0001 corr_cb=0.1309 topkJ=0.0912
[TRAIN][ep=000] loss=0.6971 acc=40.47%
[TRAIN][ep=000] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2625
[DBG][ep=001] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5154 mb_mean=0.5148 norm_overlap=1.0002 corr_cb=0.2404 topkJ=0.1127
[TRAIN][ep=001] loss=0.6865 acc=63.70%
[TRAIN][ep=001] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2578
[DBG][ep=002] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5149 mb_mean=0.5167 norm_overlap=1.0008 corr_cb=0.5338 topkJ=0.2907
[TRAIN][ep=002] loss=0.6837 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2599
[DBG][ep=003] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5157 mb_mean=0.5166 norm_overlap=1.0002 corr_cb=0.1407 topkJ=0.0837
[TRAIN][ep=003] loss=0.6806 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2572
[DBG][ep=004] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5155 mb_mean=0.5150 norm_overlap=1.0006 corr_cb=0.3877 topkJ=0.2261
[TRAIN][ep=004] loss=0.6784 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2563
[DBG][ep=005] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5144 mb_mean=0.5149 norm_overlap=1.0005 corr_cb=0.3178 topkJ=0.2069
[TRAIN][ep=005] loss=0.6770 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2581
[DBG][ep=006] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5162 mb_mean=0.5152 norm_overlap=1.0006 corr_cb=0.3963 topkJ=0.1808
[TRAIN][ep=006] loss=0.6745 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2561
[DBG][ep=007] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5160 mb_mean=0.5163 norm_overlap=1.0003 corr_cb=0.2399 topkJ=0.1667
[TRAIN][ep=007] loss=0.6708 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2581
[DBG][ep=008] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5151 mb_mean=0.5161 norm_overlap=1.0002 corr_cb=0.1733 topkJ=0.1150
[TRAIN][ep=008] loss=0.6667 acc=63.16%
[TRAIN][ep=008] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2604
[DBG][ep=009] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5152 mb_mean=0.5142 norm_overlap=1.0003 corr_cb=0.2795 topkJ=0.1008
[TRAIN][ep=009] loss=0.6629 acc=63.52%
[TRAIN][ep=009] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2576
================= FIT START (fold=1) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5146 mb_mean=0.5164 norm_overlap=1.0004 corr_cb=0.2841 topkJ=0.1112
[TRAIN][ep=000] loss=0.6553 acc=64.79%
[TRAIN][ep=000] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2587
[EPOCH 000/089] train: loss=0.6553 acc=64.79% | val: loss=0.6593 acc=62.90% f1=0.00% auc=52.84% val_score=62.9032 val_score_bestthr=62.9032 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.515, mb=0.515, no=1.000, corr=0.259) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 62.9032
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
[DBG][ep=001] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5151 mb_mean=0.5133 norm_overlap=1.0000 corr_cb=0.0509 topkJ=0.0799
[TRAIN][ep=001] loss=0.6494 acc=66.24%
[TRAIN][ep=001] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2578
[EPOCH 001/089] train: loss=0.6494 acc=66.24% | val: loss=0.6622 acc=62.90% f1=0.00% auc=54.07% val_score=47.6355 val_score_bestthr=62.9032 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.515, mb=0.515, no=1.000, corr=0.258) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 62.9032
[DBG][ep=002] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5143 mb_mean=0.5158 norm_overlap=1.0002 corr_cb=0.1856 topkJ=0.1505
[TRAIN][ep=002] loss=0.6434 acc=68.78%
[TRAIN][ep=002] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2621
[EPOCH 002/089] train: loss=0.6434 acc=68.78% | val: loss=0.6591 acc=62.90% f1=0.00% auc=54.96% val_score=47.7598 val_score_bestthr=62.9032 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.515, mb=0.515, no=1.000, corr=0.262) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 62.9032
[DBG][ep=003] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5142 mb_mean=0.5139 norm_overlap=1.0007 corr_cb=0.4700 topkJ=0.2643
[TRAIN][ep=003] loss=0.6397 acc=68.06%
[TRAIN][ep=003] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2561
[EPOCH 003/089] train: loss=0.6397 acc=68.06% | val: loss=0.6574 acc=62.90% f1=0.00% auc=55.18% val_score=50.5538 val_score_bestthr=62.9032 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.515, mb=0.515, no=1.000, corr=0.256) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 62.9032
[DBG][ep=004] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5147 mb_mean=0.5159 norm_overlap=1.0007 corr_cb=0.4334 topkJ=0.1914
[TRAIN][ep=004] loss=0.6310 acc=68.97%
[TRAIN][ep=004] mask_avg: mc_mean=0.5148 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.2609
[EPOCH 004/089] train: loss=0.6310 acc=68.97% | val: loss=0.6593 acc=62.90% f1=0.00% auc=55.63% val_score=41.9870 val_score_bestthr=62.9032 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.515, mb=0.515, no=1.000, corr=0.261) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 62.9032
[DBG][ep=005] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5137 mb_mean=0.5154 norm_overlap=1.0001 corr_cb=0.0616 topkJ=0.0627
[TRAIN][ep=005] loss=1.2727 acc=66.06%
[TRAIN][ep=005] mask_avg: mc_mean=0.5111 mb_mean=0.5154 norm_overlap=1.0004 corr_cb=0.2101
[EPOCH 005/089] train: loss=1.2727 acc=66.06% | val: loss=0.6505 acc=62.90% f1=0.00% auc=57.75% val_score=55.4606 val_score_bestthr=62.9032 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.511, mb=0.515, no=1.000, corr=0.210) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 62.9032
[DBG][ep=006] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5065 mb_mean=0.5122 norm_overlap=1.0008 corr_cb=0.2688 topkJ=0.1443
[TRAIN][ep=006] loss=1.0143 acc=66.97%
[TRAIN][ep=006] mask_avg: mc_mean=0.5041 mb_mean=0.5154 norm_overlap=1.0003 corr_cb=0.1812
[EPOCH 006/089] train: loss=1.0143 acc=66.97% | val: loss=0.6543 acc=62.90% f1=0.00% auc=57.75% val_score=46.3987 val_score_bestthr=62.9032 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.504, mb=0.515, no=1.000, corr=0.181) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 62.9032
[DBG][ep=007] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5005 mb_mean=0.5162 norm_overlap=1.0005 corr_cb=0.1898 topkJ=0.1188
[TRAIN][ep=007] loss=0.8021 acc=69.51%
[TRAIN][ep=007] mask_avg: mc_mean=0.4961 mb_mean=0.5154 norm_overlap=1.0002 corr_cb=0.1335
[EPOCH 007/089] train: loss=0.8021 acc=69.51% | val: loss=0.6555 acc=62.90% f1=0.00% auc=57.53% val_score=49.5808 val_score_bestthr=62.9032 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.496, mb=0.515, no=1.000, corr=0.133) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 62.9032
[DBG][ep=008] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4936 mb_mean=0.5153 norm_overlap=1.0002 corr_cb=0.1943 topkJ=0.1024
[TRAIN][ep=008] loss=0.7544 acc=70.96%
[TRAIN][ep=008] mask_avg: mc_mean=0.4887 mb_mean=0.5154 norm_overlap=1.0002 corr_cb=0.1438
[EPOCH 008/089] train: loss=0.7544 acc=70.96% | val: loss=0.6522 acc=62.90% f1=0.00% auc=57.75% val_score=46.3987 val_score_bestthr=62.9032 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.489, mb=0.515, no=1.000, corr=0.144) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 62.9032
[DBG][ep=009] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4823 mb_mean=0.5135 norm_overlap=1.0004 corr_cb=0.2127 topkJ=0.1137
[TRAIN][ep=009] loss=0.7459 acc=69.69%
[TRAIN][ep=009] mask_avg: mc_mean=0.4794 mb_mean=0.5154 norm_overlap=1.0000 corr_cb=0.0226
[EPOCH 009/089] train: loss=0.7459 acc=69.69% | val: loss=0.6585 acc=62.90% f1=0.00% auc=56.30% val_score=45.5260 val_score_bestthr=62.9032 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.479, mb=0.515, no=1.000, corr=0.023) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 62.9032
[DBG][ep=010] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.4759 mb_mean=0.5154 norm_overlap=0.9999 corr_cb=-0.0612 topkJ=0.0597
[TRAIN][ep=010] loss=0.7381 acc=70.42%
[TRAIN][ep=010] mask_avg: mc_mean=0.4705 mb_mean=0.5154 norm_overlap=0.9999 corr_cb=-0.0467
[EPOCH 010/089] train: loss=0.7381 acc=70.42% | val: loss=0.6670 acc=62.90% f1=0.00% auc=55.74% val_score=50.1703 val_score_bestthr=62.9032 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.471, mb=0.515, no=1.000, corr=-0.047) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 62.9032
[DBG][ep=011] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.4615 mb_mean=0.5163 norm_overlap=1.0001 corr_cb=0.0407 topkJ=0.1013
[TRAIN][ep=011] loss=0.7262 acc=70.78%
[TRAIN][ep=011] mask_avg: mc_mean=0.4609 mb_mean=0.5154 norm_overlap=0.9998 corr_cb=-0.0985
[EPOCH 011/089] train: loss=0.7262 acc=70.78% | val: loss=0.6697 acc=62.90% f1=0.00% auc=55.63% val_score=41.2516 val_score_bestthr=62.9032 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.461, mb=0.515, no=1.000, corr=-0.098) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 62.9032
[DBG][ep=012] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.4546 mb_mean=0.5151 norm_overlap=1.0001 corr_cb=0.0217 topkJ=0.0318
[TRAIN][ep=012] loss=0.7145 acc=71.69%
[TRAIN][ep=012] mask_avg: mc_mean=0.4490 mb_mean=0.5154 norm_overlap=0.9994 corr_cb=-0.1976
[EPOCH 012/089] train: loss=0.7145 acc=71.69% | val: loss=0.6772 acc=62.90% f1=0.00% auc=55.41% val_score=45.5260 val_score_bestthr=62.9032 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.449, mb=0.515, no=0.999, corr=-0.198) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 62.9032
[DBG][ep=013] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.4437 mb_mean=0.5145 norm_overlap=0.9990 corr_cb=-0.2430 topkJ=0.0169
[TRAIN][ep=013] loss=0.7040 acc=72.23%
[TRAIN][ep=013] mask_avg: mc_mean=0.4369 mb_mean=0.5154 norm_overlap=0.9993 corr_cb=-0.1960
[EPOCH 013/089] train: loss=0.7040 acc=72.23% | val: loss=0.6933 acc=62.90% f1=0.00% auc=54.40% val_score=40.7778 val_score_bestthr=62.9032 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.437, mb=0.515, no=0.999, corr=-0.196) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 62.9032
[DBG][ep=014] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.4328 mb_mean=0.5165 norm_overlap=0.9991 corr_cb=-0.2021 topkJ=0.0493
[TRAIN][ep=014] loss=0.6891 acc=74.23%
[TRAIN][ep=014] mask_avg: mc_mean=0.4231 mb_mean=0.5154 norm_overlap=0.9991 corr_cb=-0.1998
[EPOCH 014/089] train: loss=0.6891 acc=74.23% | val: loss=0.7053 acc=67.74% f1=41.18% auc=54.85% val_score=37.2248 val_score_bestthr=58.7270 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.423, mb=0.515, no=0.999, corr=-0.200) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 58.7270
[DBG][ep=015] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.4135 mb_mean=0.5168 norm_overlap=0.9991 corr_cb=-0.1592 topkJ=0.0252
[TRAIN][ep=015] loss=0.6769 acc=73.87%
[TRAIN][ep=015] mask_avg: mc_mean=0.4113 mb_mean=0.5154 norm_overlap=0.9988 corr_cb=-0.2349
[EPOCH 015/089] train: loss=0.6769 acc=73.87% | val: loss=0.7320 acc=64.52% f1=31.25% auc=53.85% val_score=44.8562 val_score_bestthr=55.1152 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.411, mb=0.515, no=0.999, corr=-0.235) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 55.1152
[DBG][ep=016] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.4004 mb_mean=0.5155 norm_overlap=0.9989 corr_cb=-0.2500 topkJ=0.0173
[TRAIN][ep=016] loss=0.6602 acc=75.86%
[TRAIN][ep=016] mask_avg: mc_mean=0.3983 mb_mean=0.5154 norm_overlap=0.9985 corr_cb=-0.2461
[EPOCH 016/089] train: loss=0.6602 acc=75.86% | val: loss=0.7322 acc=67.74% f1=41.18% auc=54.18% val_score=44.3944 val_score_bestthr=56.9770 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.398, mb=0.515, no=0.999, corr=-0.246) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 56.9770
[DBG][ep=017] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.3949 mb_mean=0.5169 norm_overlap=0.9991 corr_cb=-0.1765 topkJ=0.0339
[TRAIN][ep=017] loss=0.6485 acc=76.23%
[TRAIN][ep=017] mask_avg: mc_mean=0.3856 mb_mean=0.5154 norm_overlap=0.9984 corr_cb=-0.2308
[EPOCH 017/089] train: loss=0.6485 acc=76.23% | val: loss=0.7501 acc=67.74% f1=37.50% auc=54.52% val_score=48.3982 val_score_bestthr=58.0089 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.386, mb=0.515, no=0.998, corr=-0.231) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 58.0089
[DBG][ep=018] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.3834 mb_mean=0.5155 norm_overlap=0.9977 corr_cb=-0.3160 topkJ=0.0129
[TRAIN][ep=018] loss=0.6267 acc=76.59%
[TRAIN][ep=018] mask_avg: mc_mean=0.3761 mb_mean=0.5154 norm_overlap=0.9983 corr_cb=-0.2279
[EPOCH 018/089] train: loss=0.6267 acc=76.59% | val: loss=0.7861 acc=67.74% f1=41.18% auc=55.85% val_score=57.0109 val_score_bestthr=58.0730 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.376, mb=0.515, no=0.998, corr=-0.228) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 58.0730
[DBG][ep=019] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.3746 mb_mean=0.5147 norm_overlap=0.9977 corr_cb=-0.3285 topkJ=0.0159
[TRAIN][ep=019] loss=0.6201 acc=76.77%
[TRAIN][ep=019] mask_avg: mc_mean=0.3634 mb_mean=0.5154 norm_overlap=0.9980 corr_cb=-0.2308
[EPOCH 019/089] train: loss=0.6201 acc=76.77% | val: loss=0.7860 acc=66.13% f1=36.36% auc=54.74% val_score=50.9111 val_score_bestthr=57.0109 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.363, mb=0.515, no=0.998, corr=-0.231) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 57.0109
[DBG][ep=020] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.3521 mb_mean=0.5161 norm_overlap=0.9960 corr_cb=-0.3877 topkJ=0.0264
[TRAIN][ep=020] loss=0.6006 acc=75.86%
[TRAIN][ep=020] mask_avg: mc_mean=0.3542 mb_mean=0.5154 norm_overlap=0.9981 corr_cb=-0.2119
[EPOCH 020/089] train: loss=0.6006 acc=75.86% | val: loss=0.8103 acc=64.52% f1=35.29% auc=53.73% val_score=47.3774 val_score_bestthr=54.5931 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.354, mb=0.515, no=0.998, corr=-0.212) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 54.5931
[DBG][ep=021] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.3482 mb_mean=0.5152 norm_overlap=0.9980 corr_cb=-0.2348 topkJ=0.0338
[TRAIN][ep=021] loss=0.5826 acc=78.95%
[TRAIN][ep=021] mask_avg: mc_mean=0.3441 mb_mean=0.5154 norm_overlap=0.9979 corr_cb=-0.2161
[EPOCH 021/089] train: loss=0.5826 acc=78.95% | val: loss=0.8607 acc=64.52% f1=35.29% auc=53.29% val_score=46.1567 val_score_bestthr=54.5931 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.344, mb=0.515, no=0.998, corr=-0.216) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 54.5931
[DBG][ep=022] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.3442 mb_mean=0.5160 norm_overlap=0.9965 corr_cb=-0.3624 topkJ=0.0141
[TRAIN][ep=022] loss=0.5750 acc=79.31%
[TRAIN][ep=022] mask_avg: mc_mean=0.3346 mb_mean=0.5154 norm_overlap=0.9979 corr_cb=-0.1990
[EPOCH 022/089] train: loss=0.5750 acc=79.31% | val: loss=0.8564 acc=64.52% f1=42.11% auc=54.74% val_score=47.6264 val_score_bestthr=60.0930 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.335, mb=0.515, no=0.998, corr=-0.199) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 60.0930
[DBG][ep=023] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.3263 mb_mean=0.5155 norm_overlap=0.9971 corr_cb=-0.2739 topkJ=0.0286
[TRAIN][ep=023] loss=0.5496 acc=83.30%
[TRAIN][ep=023] mask_avg: mc_mean=0.3268 mb_mean=0.5154 norm_overlap=0.9979 corr_cb=-0.1894
[EPOCH 023/089] train: loss=0.5496 acc=83.30% | val: loss=0.8886 acc=62.90% f1=41.03% auc=53.85% val_score=48.4938 val_score_bestthr=58.0000 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.327, mb=0.515, no=0.998, corr=-0.189) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 58.0000
[DBG][ep=024] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.3130 mb_mean=0.5134 norm_overlap=0.9982 corr_cb=-0.1428 topkJ=0.0236
[TRAIN][ep=024] loss=0.5336 acc=81.85%
[TRAIN][ep=024] mask_avg: mc_mean=0.3184 mb_mean=0.5154 norm_overlap=0.9977 corr_cb=-0.1882
[EPOCH 024/089] train: loss=0.5336 acc=81.85% | val: loss=0.9073 acc=62.90% f1=41.03% auc=54.63% val_score=51.4952 val_score_bestthr=58.0000 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.318, mb=0.515, no=0.998, corr=-0.188) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 58.0000
[DBG][ep=025] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.3094 mb_mean=0.5152 norm_overlap=0.9983 corr_cb=-0.1624 topkJ=0.0214
[TRAIN][ep=025] loss=0.5175 acc=84.57%
[TRAIN][ep=025] mask_avg: mc_mean=0.3132 mb_mean=0.5154 norm_overlap=0.9977 corr_cb=-0.1876
[EPOCH 025/089] train: loss=0.5175 acc=84.57% | val: loss=0.9423 acc=62.90% f1=37.84% auc=53.62% val_score=48.4938 val_score_bestthr=55.3523 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.313, mb=0.515, no=0.998, corr=-0.188) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 55.3523
[DBG][ep=026] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.3091 mb_mean=0.5155 norm_overlap=0.9973 corr_cb=-0.2198 topkJ=0.0275
[TRAIN][ep=026] loss=0.5017 acc=85.84%
[TRAIN][ep=026] mask_avg: mc_mean=0.3063 mb_mean=0.5154 norm_overlap=0.9978 corr_cb=-0.1679
[EPOCH 026/089] train: loss=0.5017 acc=85.84% | val: loss=0.9781 acc=61.29% f1=40.00% auc=54.07% val_score=46.7176 val_score_bestthr=55.9151 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.306, mb=0.515, no=0.998, corr=-0.168) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 55.9151
[DBG][ep=027] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2968 mb_mean=0.5156 norm_overlap=0.9976 corr_cb=-0.1782 topkJ=0.0280
[TRAIN][ep=027] loss=0.4847 acc=85.84%
[TRAIN][ep=027] mask_avg: mc_mean=0.2996 mb_mean=0.5154 norm_overlap=0.9978 corr_cb=-0.1613
[EPOCH 027/089] train: loss=0.4847 acc=85.84% | val: loss=1.0220 acc=62.90% f1=43.90% auc=56.52% val_score=49.3817 val_score_bestthr=54.2952 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.300, mb=0.515, no=0.998, corr=-0.161) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 54.2952
[DBG][ep=028] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.3003 mb_mean=0.5145 norm_overlap=0.9970 corr_cb=-0.2362 topkJ=0.0151
[TRAIN][ep=028] loss=0.4653 acc=87.11%
[TRAIN][ep=028] mask_avg: mc_mean=0.2945 mb_mean=0.5154 norm_overlap=0.9976 corr_cb=-0.1684
[EPOCH 028/089] train: loss=0.4653 acc=87.11% | val: loss=1.0400 acc=64.52% f1=45.00% auc=54.63% val_score=47.7422 val_score_bestthr=56.3909 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.294, mb=0.515, no=0.998, corr=-0.168) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 56.3909
[DBG][ep=029] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2949 mb_mean=0.5162 norm_overlap=0.9944 corr_cb=-0.3055 topkJ=0.0068
[TRAIN][ep=029] loss=0.4478 acc=89.29%
[TRAIN][ep=029] mask_avg: mc_mean=0.2892 mb_mean=0.5154 norm_overlap=0.9976 corr_cb=-0.1626
[EPOCH 029/089] train: loss=0.4478 acc=89.29% | val: loss=1.0921 acc=64.52% f1=45.00% auc=53.29% val_score=48.4938 val_score_bestthr=56.3909 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.289, mb=0.515, no=0.998, corr=-0.163) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 56.3909
[DBG][ep=030] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2821 mb_mean=0.5166 norm_overlap=0.9982 corr_cb=-0.1148 topkJ=0.0305
[TRAIN][ep=030] loss=0.4343 acc=89.66%
[TRAIN][ep=030] mask_avg: mc_mean=0.2854 mb_mean=0.5154 norm_overlap=0.9976 corr_cb=-0.1544
[EPOCH 030/089] train: loss=0.4343 acc=89.66% | val: loss=1.1512 acc=64.52% f1=45.00% auc=54.96% val_score=48.8022 val_score_bestthr=56.3909 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.285, mb=0.515, no=0.998, corr=-0.154) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9032 -> 56.3909
[EARLY STOP] no improvement for 30 epochs. best_epoch=0
[CKPT] Loaded best for testing: results/ADHD_3x5fold_seed0/fold1_rep1_seed1001/ckpt_best_fold_1.pt
=============== FIT DONE ===============
[BEST] epoch=0 | val_acc=62.90% | val_f1=0.00% | val_auc=52.84% | val_score=62.9032 | val_score_bestthr=62.9032
[TEST@BEST] thr_used=0.460 | acc=68.18% f1=30.99% auc=62.76% | SP_sex=2.30% EO_sex=14.39% SP_age=11.15% EO_age=4.04%
[TIME] 0.63 min
[OK] Saved: results/ADHD_3x5fold_seed0/fold1_rep1_seed1001/summary_fold_1.json
