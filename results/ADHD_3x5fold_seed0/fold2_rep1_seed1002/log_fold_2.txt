[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4496 mb_mean=0.4946 norm_overlap=1.0001 corr_cb=0.1679 topkJ=0.0819
[TRAIN][ep=000] loss=0.6686 acc=63.77%
[TRAIN][ep=000] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0415
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4515 mb_mean=0.4949 norm_overlap=1.0000 corr_cb=0.0438 topkJ=0.0912
[TRAIN][ep=001] loss=0.6628 acc=63.77%
[TRAIN][ep=001] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0393
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4501 mb_mean=0.4947 norm_overlap=1.0000 corr_cb=0.0147 topkJ=0.0889
[TRAIN][ep=002] loss=0.6586 acc=63.77%
[TRAIN][ep=002] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0412
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4523 mb_mean=0.4943 norm_overlap=1.0001 corr_cb=0.1587 topkJ=0.0969
[TRAIN][ep=003] loss=0.6564 acc=63.77%
[TRAIN][ep=003] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0415
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4502 mb_mean=0.4945 norm_overlap=0.9999 corr_cb=-0.0905 topkJ=0.0338
[TRAIN][ep=004] loss=0.6548 acc=63.77%
[TRAIN][ep=004] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0389
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4510 mb_mean=0.4956 norm_overlap=1.0001 corr_cb=0.0918 topkJ=0.0948
[TRAIN][ep=005] loss=0.6537 acc=63.77%
[TRAIN][ep=005] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0387
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4523 mb_mean=0.4929 norm_overlap=1.0000 corr_cb=-0.0175 topkJ=0.0527
[TRAIN][ep=006] loss=0.6527 acc=63.77%
[TRAIN][ep=006] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0407
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4503 mb_mean=0.4943 norm_overlap=0.9999 corr_cb=-0.0701 topkJ=0.0588
[TRAIN][ep=007] loss=0.6516 acc=63.77%
[TRAIN][ep=007] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0395
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4515 mb_mean=0.4937 norm_overlap=1.0000 corr_cb=0.0577 topkJ=0.0890
[TRAIN][ep=008] loss=0.6511 acc=63.77%
[TRAIN][ep=008] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0414
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4511 mb_mean=0.4927 norm_overlap=1.0000 corr_cb=0.0201 topkJ=0.0884
[TRAIN][ep=009] loss=0.6495 acc=63.77%
[TRAIN][ep=009] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0422
================= FIT START (fold=2) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.35 select_by=val_score | eval_thr_mode=best_acc eval_thr_grid=coarse | disease_pos_weight_mode=none freeze_b_after=15 | two_stage=True stage1_ratio=0.35 stage2_lr_mult=0.3 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4516 mb_mean=0.4954 norm_overlap=1.0000 corr_cb=0.0570 topkJ=0.0440
[TRAIN][ep=000] loss=0.6485 acc=63.77%
[TRAIN][ep=000] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0407
[EPOCH 000/089] train: loss=0.6485 acc=63.77% | val: loss=0.6475 acc=77.42% f1=68.18% auc=77.70% val_score=71.7916 val_score_bestthr=111.0593 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.450, mb=0.495, no=1.000, corr=0.041) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* -1000000000000000000.0000 -> 71.7916
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4492 mb_mean=0.4950 norm_overlap=0.9998 corr_cb=-0.1808 topkJ=0.0441
[TRAIN][ep=001] loss=0.6468 acc=63.77%
[TRAIN][ep=001] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0400
[EPOCH 001/089] train: loss=0.6468 acc=63.77% | val: loss=0.6459 acc=75.81% f1=61.54% auc=77.37% val_score=81.9038 val_score_bestthr=105.8383 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.450, mb=0.495, no=1.000, corr=0.040) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 71.7916 -> 81.9038
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4508 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=-0.0404 topkJ=0.0832
[TRAIN][ep=002] loss=0.6455 acc=63.77%
[TRAIN][ep=002] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0410
[EPOCH 002/089] train: loss=0.6455 acc=63.77% | val: loss=0.6446 acc=75.81% f1=61.54% auc=76.81% val_score=81.9133 val_score_bestthr=105.8383 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.450, mb=0.495, no=1.000, corr=0.041) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 81.9038 -> 81.9133
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4487 mb_mean=0.4952 norm_overlap=0.9999 corr_cb=-0.0570 topkJ=0.0462
[TRAIN][ep=003] loss=0.6439 acc=63.77%
[TRAIN][ep=003] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0400
[EPOCH 003/089] train: loss=0.6439 acc=63.77% | val: loss=0.6432 acc=74.19% f1=65.22% auc=76.03% val_score=95.8460 val_score_bestthr=106.3227 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.450, mb=0.495, no=1.000, corr=0.040) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 81.9133 -> 95.8460
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4503 mb_mean=0.4944 norm_overlap=1.0001 corr_cb=0.1213 topkJ=0.0789
[TRAIN][ep=004] loss=0.6428 acc=63.77%
[TRAIN][ep=004] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0380
[EPOCH 004/089] train: loss=0.6428 acc=63.77% | val: loss=0.6419 acc=72.58% f1=65.31% auc=75.03% val_score=75.8743 val_score_bestthr=104.5399 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.450, mb=0.495, no=1.000, corr=0.038) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 95.8460 -> 75.8743
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4518 mb_mean=0.4941 norm_overlap=1.0000 corr_cb=-0.0020 topkJ=0.0603
[TRAIN][ep=005] loss=2.2014 acc=63.77%
[TRAIN][ep=005] mask_avg: mc_mean=0.4466 mb_mean=0.4885 norm_overlap=0.9999 corr_cb=-0.0533
[EPOCH 005/089] train: loss=2.2014 acc=63.77% | val: loss=0.6447 acc=74.19% f1=61.90% auc=78.04% val_score=97.9107 val_score_bestthr=104.3640 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.447, mb=0.488, no=1.000, corr=-0.053) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 95.8460 -> 97.9107
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4425 mb_mean=0.4812 norm_overlap=0.9999 corr_cb=-0.1105 topkJ=0.0265
[TRAIN][ep=006] loss=1.4700 acc=63.77%
[TRAIN][ep=006] mask_avg: mc_mean=0.4378 mb_mean=0.4745 norm_overlap=1.0000 corr_cb=0.0135
[EPOCH 006/089] train: loss=1.4700 acc=63.77% | val: loss=0.6426 acc=75.81% f1=66.67% auc=78.26% val_score=104.8367 val_score_bestthr=108.6019 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.438, mb=0.474, no=1.000, corr=0.013) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 97.9107 -> 104.8367
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4338 mb_mean=0.4656 norm_overlap=1.0002 corr_cb=0.1514 topkJ=0.0730
[TRAIN][ep=007] loss=0.7532 acc=63.77%
[TRAIN][ep=007] mask_avg: mc_mean=0.4274 mb_mean=0.4579 norm_overlap=1.0004 corr_cb=0.1898
[EPOCH 007/089] train: loss=0.7532 acc=63.77% | val: loss=0.6407 acc=74.19% f1=60.00% auc=77.70% val_score=102.2972 val_score_bestthr=103.4818 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.427, mb=0.458, no=1.000, corr=0.190) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 104.8367 -> 102.2972
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4205 mb_mean=0.4467 norm_overlap=1.0010 corr_cb=0.4226 topkJ=0.1031
[TRAIN][ep=008] loss=0.5762 acc=63.77%
[TRAIN][ep=008] mask_avg: mc_mean=0.4156 mb_mean=0.4377 norm_overlap=1.0009 corr_cb=0.2697
[EPOCH 008/089] train: loss=0.5762 acc=63.77% | val: loss=0.6393 acc=75.81% f1=61.54% auc=76.59% val_score=100.0574 val_score_bestthr=105.8383 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.416, mb=0.438, no=1.001, corr=0.270) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 104.8367 -> 100.0574
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4125 mb_mean=0.4321 norm_overlap=1.0009 corr_cb=0.2382 topkJ=0.0688
[TRAIN][ep=009] loss=0.5710 acc=63.77%
[TRAIN][ep=009] mask_avg: mc_mean=0.4029 mb_mean=0.4133 norm_overlap=1.0017 corr_cb=0.2833
[EPOCH 009/089] train: loss=0.5710 acc=63.77% | val: loss=0.6374 acc=74.19% f1=63.64% auc=75.47% val_score=97.8049 val_score_bestthr=105.5917 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.403, mb=0.413, no=1.002, corr=0.283) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 104.8367 -> 97.8049
[DBG][ep=010] disease_pos_weight=1.0000 mode=none
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.3975 mb_mean=0.4014 norm_overlap=1.0012 corr_cb=0.1637 topkJ=0.0418
[TRAIN][ep=010] loss=0.5663 acc=63.77%
[TRAIN][ep=010] mask_avg: mc_mean=0.3899 mb_mean=0.3858 norm_overlap=1.0027 corr_cb=0.2600
[EPOCH 010/089] train: loss=0.5663 acc=63.77% | val: loss=0.6355 acc=72.58% f1=51.43% auc=74.02% val_score=97.1845 val_score_bestthr=97.2649 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.390, mb=0.386, no=1.003, corr=0.260) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 104.8367 -> 97.1845
[DBG][ep=011] disease_pos_weight=1.0000 mode=none
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.3793 mb_mean=0.3645 norm_overlap=1.0037 corr_cb=0.2657 topkJ=0.0622
[TRAIN][ep=011] loss=0.5604 acc=63.77%
[TRAIN][ep=011] mask_avg: mc_mean=0.3768 mb_mean=0.3580 norm_overlap=1.0022 corr_cb=0.1262
[EPOCH 011/089] train: loss=0.5604 acc=63.77% | val: loss=0.6328 acc=70.97% f1=60.87% auc=72.80% val_score=97.5367 val_score_bestthr=100.7374 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.377, mb=0.358, no=1.002, corr=0.126) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 104.8367 -> 97.5367
[DBG][ep=012] disease_pos_weight=1.0000 mode=none
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.3716 mb_mean=0.3539 norm_overlap=1.0032 corr_cb=0.1502 topkJ=0.0289
[TRAIN][ep=012] loss=0.5553 acc=63.77%
[TRAIN][ep=012] mask_avg: mc_mean=0.3639 mb_mean=0.3324 norm_overlap=0.9984 corr_cb=-0.0514
[EPOCH 012/089] train: loss=0.5553 acc=63.77% | val: loss=0.6303 acc=72.58% f1=48.48% auc=71.79% val_score=92.3401 val_score_bestthr=95.8932 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.364, mb=0.332, no=0.998, corr=-0.051) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 104.8367 -> 92.3401
[DBG][ep=013] disease_pos_weight=1.0000 mode=none
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.3608 mb_mean=0.3235 norm_overlap=0.9904 corr_cb=-0.2801 topkJ=0.0062
[TRAIN][ep=013] loss=0.5471 acc=63.95%
[TRAIN][ep=013] mask_avg: mc_mean=0.3522 mb_mean=0.3100 norm_overlap=0.9888 corr_cb=-0.2388
[EPOCH 013/089] train: loss=0.5471 acc=63.95% | val: loss=0.6274 acc=72.58% f1=48.48% auc=70.35% val_score=101.3341 val_score_bestthr=95.8932 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.352, mb=0.310, no=0.989, corr=-0.239) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 104.8367 -> 101.3341
[DBG][ep=014] disease_pos_weight=1.0000 mode=none
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.3519 mb_mean=0.3149 norm_overlap=0.9725 corr_cb=-0.5305 topkJ=0.0012
[TRAIN][ep=014] loss=0.5401 acc=63.77%
[TRAIN][ep=014] mask_avg: mc_mean=0.3402 mb_mean=0.2903 norm_overlap=0.9679 corr_cb=-0.4351
[EPOCH 014/089] train: loss=0.5401 acc=63.77% | val: loss=0.6248 acc=70.97% f1=47.06% auc=69.12% val_score=96.7981 val_score_bestthr=93.5917 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.340, mb=0.290, no=0.968, corr=-0.435) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 104.8367 -> 96.7981
[DBG][ep=015] disease_pos_weight=1.0000 mode=none
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.3341 mb_mean=0.2860 norm_overlap=0.9644 corr_cb=-0.4912 topkJ=0.0021
[TRAIN][ep=015] loss=0.5324 acc=64.49%
[TRAIN][ep=015] mask_avg: mc_mean=0.3306 mb_mean=0.2811 norm_overlap=0.9476 corr_cb=-0.5488
[EPOCH 015/089] train: loss=0.5324 acc=64.49% | val: loss=0.6206 acc=70.97% f1=47.06% auc=69.12% val_score=94.5726 val_score_bestthr=93.5917 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.331, mb=0.281, no=0.948, corr=-0.549) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 94.5726
[DBG][ep=016] disease_pos_weight=1.0000 mode=none
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.3089 mb_mean=0.2569 norm_overlap=0.9480 corr_cb=-0.3064 topkJ=0.0032
[TRAIN][ep=016] loss=0.5252 acc=65.94%
[TRAIN][ep=016] mask_avg: mc_mean=0.3216 mb_mean=0.2811 norm_overlap=0.9336 corr_cb=-0.5860
[EPOCH 016/089] train: loss=0.5252 acc=65.94% | val: loss=0.6174 acc=69.35% f1=42.42% auc=68.12% val_score=95.2841 val_score_bestthr=89.5371 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.322, mb=0.281, no=0.934, corr=-0.586) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 95.2841
[DBG][ep=017] disease_pos_weight=1.0000 mode=none
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.3080 mb_mean=0.2756 norm_overlap=0.9350 corr_cb=-0.4747 topkJ=0.0000
[TRAIN][ep=017] loss=0.5190 acc=66.49%
[TRAIN][ep=017] mask_avg: mc_mean=0.3148 mb_mean=0.2811 norm_overlap=0.9202 corr_cb=-0.6145
[EPOCH 017/089] train: loss=0.5190 acc=66.49% | val: loss=0.6146 acc=70.97% f1=47.06% auc=69.01% val_score=95.7411 val_score_bestthr=93.5917 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.315, mb=0.281, no=0.920, corr=-0.614) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 95.7411
[DBG][ep=018] disease_pos_weight=1.0000 mode=none
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.3119 mb_mean=0.2893 norm_overlap=0.9150 corr_cb=-0.6419 topkJ=0.0000
[TRAIN][ep=018] loss=0.5121 acc=67.21%
[TRAIN][ep=018] mask_avg: mc_mean=0.3093 mb_mean=0.2811 norm_overlap=0.9108 corr_cb=-0.6199
[EPOCH 018/089] train: loss=0.5121 acc=67.21% | val: loss=0.6106 acc=69.35% f1=59.57% auc=68.45% val_score=92.2030 val_score_bestthr=98.0869 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.309, mb=0.281, no=0.911, corr=-0.620) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 92.2030
[DBG][ep=019] disease_pos_weight=1.0000 mode=none
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.3074 mb_mean=0.2879 norm_overlap=0.9113 corr_cb=-0.6032 topkJ=0.0000
[TRAIN][ep=019] loss=0.5062 acc=66.67%
[TRAIN][ep=019] mask_avg: mc_mean=0.3041 mb_mean=0.2811 norm_overlap=0.8989 corr_cb=-0.6302
[EPOCH 019/089] train: loss=0.5062 acc=66.67% | val: loss=0.6097 acc=69.35% f1=59.57% auc=68.67% val_score=92.2030 val_score_bestthr=98.0869 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.304, mb=0.281, no=0.899, corr=-0.630) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 92.2030
[DBG][ep=020] disease_pos_weight=1.0000 mode=none
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.3049 mb_mean=0.2820 norm_overlap=0.8754 corr_cb=-0.7252 topkJ=0.0000
[TRAIN][ep=020] loss=0.4983 acc=67.39%
[TRAIN][ep=020] mask_avg: mc_mean=0.3009 mb_mean=0.2811 norm_overlap=0.8904 corr_cb=-0.6362
[EPOCH 020/089] train: loss=0.4983 acc=67.39% | val: loss=0.6072 acc=69.35% f1=53.66% auc=68.78% val_score=92.2030 val_score_bestthr=95.0988 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.301, mb=0.281, no=0.890, corr=-0.636) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 92.2030
[DBG][ep=021] disease_pos_weight=1.0000 mode=none
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2844 mb_mean=0.2763 norm_overlap=0.8963 corr_cb=-0.5401 topkJ=0.0000
[TRAIN][ep=021] loss=0.4913 acc=68.30%
[TRAIN][ep=021] mask_avg: mc_mean=0.2968 mb_mean=0.2811 norm_overlap=0.8817 corr_cb=-0.6371
[EPOCH 021/089] train: loss=0.4913 acc=68.30% | val: loss=0.6069 acc=69.35% f1=57.78% auc=68.90% val_score=91.4390 val_score_bestthr=97.1779 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.297, mb=0.281, no=0.882, corr=-0.637) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 91.4390
[DBG][ep=022] disease_pos_weight=1.0000 mode=none
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2945 mb_mean=0.2849 norm_overlap=0.8726 corr_cb=-0.6558 topkJ=0.0000
[TRAIN][ep=022] loss=0.4834 acc=70.29%
[TRAIN][ep=022] mask_avg: mc_mean=0.2941 mb_mean=0.2811 norm_overlap=0.8734 corr_cb=-0.6430
[EPOCH 022/089] train: loss=0.4834 acc=70.29% | val: loss=0.6057 acc=69.35% f1=55.81% auc=68.23% val_score=91.4390 val_score_bestthr=96.5670 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.294, mb=0.281, no=0.873, corr=-0.643) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 91.4390
[DBG][ep=023] disease_pos_weight=1.0000 mode=none
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2970 mb_mean=0.2692 norm_overlap=0.8379 corr_cb=-0.6852 topkJ=0.0000
[TRAIN][ep=023] loss=0.4759 acc=70.65%
[TRAIN][ep=023] mask_avg: mc_mean=0.2910 mb_mean=0.2812 norm_overlap=0.8673 corr_cb=-0.6380
[EPOCH 023/089] train: loss=0.4759 acc=70.65% | val: loss=0.6075 acc=69.35% f1=55.81% auc=68.12% val_score=91.4390 val_score_bestthr=96.5670 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.291, mb=0.281, no=0.867, corr=-0.638) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 91.4390
[DBG][ep=024] disease_pos_weight=1.0000 mode=none
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2926 mb_mean=0.2860 norm_overlap=0.8504 corr_cb=-0.7201 topkJ=0.0000
[TRAIN][ep=024] loss=0.4709 acc=71.74%
[TRAIN][ep=024] mask_avg: mc_mean=0.2882 mb_mean=0.2811 norm_overlap=0.8603 corr_cb=-0.6411
[EPOCH 024/089] train: loss=0.4709 acc=71.74% | val: loss=0.6148 acc=69.35% f1=55.81% auc=67.78% val_score=94.9544 val_score_bestthr=96.5670 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.288, mb=0.281, no=0.860, corr=-0.641) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 94.9544
[DBG][ep=025] disease_pos_weight=1.0000 mode=none
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2984 mb_mean=0.2791 norm_overlap=0.8186 corr_cb=-0.7733 topkJ=0.0000
[TRAIN][ep=025] loss=0.4640 acc=72.83%
[TRAIN][ep=025] mask_avg: mc_mean=0.2856 mb_mean=0.2811 norm_overlap=0.8536 corr_cb=-0.6436
[EPOCH 025/089] train: loss=0.4640 acc=72.83% | val: loss=0.6188 acc=70.97% f1=47.06% auc=67.34% val_score=94.9544 val_score_bestthr=93.5917 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.286, mb=0.281, no=0.854, corr=-0.644) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 94.9544
[DBG][ep=026] disease_pos_weight=1.0000 mode=none
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2823 mb_mean=0.2772 norm_overlap=0.8301 corr_cb=-0.6856 topkJ=0.0000
[TRAIN][ep=026] loss=0.4587 acc=72.83%
[TRAIN][ep=026] mask_avg: mc_mean=0.2830 mb_mean=0.2811 norm_overlap=0.8498 corr_cb=-0.6346
[EPOCH 026/089] train: loss=0.4587 acc=72.83% | val: loss=0.6152 acc=69.35% f1=59.57% auc=67.22% val_score=92.1977 val_score_bestthr=98.1494 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.283, mb=0.281, no=0.850, corr=-0.635) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 92.1977
[DBG][ep=027] disease_pos_weight=1.0000 mode=none
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2709 mb_mean=0.2875 norm_overlap=0.8864 corr_cb=-0.4741 topkJ=0.0000
[TRAIN][ep=027] loss=0.4498 acc=73.91%
[TRAIN][ep=027] mask_avg: mc_mean=0.2806 mb_mean=0.2811 norm_overlap=0.8422 corr_cb=-0.6420
[EPOCH 027/089] train: loss=0.4498 acc=73.91% | val: loss=0.6252 acc=69.35% f1=29.63% auc=66.56% val_score=84.3797 val_score_bestthr=83.5385 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.281, mb=0.281, no=0.842, corr=-0.642) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 84.3797
[DBG][ep=028] disease_pos_weight=1.0000 mode=none
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2751 mb_mean=0.2914 norm_overlap=0.8494 corr_cb=-0.6686 topkJ=0.0000
[TRAIN][ep=028] loss=0.4451 acc=73.73%
[TRAIN][ep=028] mask_avg: mc_mean=0.2787 mb_mean=0.2811 norm_overlap=0.8368 corr_cb=-0.6443
[EPOCH 028/089] train: loss=0.4451 acc=73.73% | val: loss=0.6227 acc=70.97% f1=50.00% auc=66.56% val_score=87.9226 val_score_bestthr=95.1280 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.279, mb=0.281, no=0.837, corr=-0.644) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 87.9226
[DBG][ep=029] disease_pos_weight=1.0000 mode=none
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2851 mb_mean=0.2852 norm_overlap=0.8323 corr_cb=-0.6844 topkJ=0.0000
[TRAIN][ep=029] loss=0.4348 acc=74.28%
[TRAIN][ep=029] mask_avg: mc_mean=0.2765 mb_mean=0.2811 norm_overlap=0.8319 corr_cb=-0.6456
[EPOCH 029/089] train: loss=0.4348 acc=74.28% | val: loss=0.6274 acc=69.35% f1=29.63% auc=65.55% val_score=87.9226 val_score_bestthr=83.5385 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.276, mb=0.281, no=0.832, corr=-0.646) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 87.9226
[DBG][ep=030] disease_pos_weight=1.0000 mode=none
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2750 mb_mean=0.2772 norm_overlap=0.8705 corr_cb=-0.5601 topkJ=0.0000
[TRAIN][ep=030] loss=0.4295 acc=75.18%
[TRAIN][ep=030] mask_avg: mc_mean=0.2738 mb_mean=0.2811 norm_overlap=0.8285 corr_cb=-0.6417
[EPOCH 030/089] train: loss=0.4295 acc=75.18% | val: loss=0.6339 acc=69.35% f1=45.71% auc=65.55% val_score=87.1500 val_score_bestthr=91.6603 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.274, mb=0.281, no=0.828, corr=-0.642) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 87.1500
[DBG][ep=031] disease_pos_weight=1.0000 mode=none
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2722 mb_mean=0.2918 norm_overlap=0.8559 corr_cb=-0.5670 topkJ=0.0000
[TRAIN][ep=031] loss=0.4194 acc=75.54%
[TRAIN][ep=031] mask_avg: mc_mean=0.2725 mb_mean=0.2812 norm_overlap=0.8246 corr_cb=-0.6478
[EPOCH 031/089] train: loss=0.4194 acc=75.54% | val: loss=0.6356 acc=69.35% f1=45.71% auc=65.55% val_score=89.3152 val_score_bestthr=91.6603 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.272, mb=0.281, no=0.825, corr=-0.648) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 89.3152
[DBG][ep=032] disease_pos_weight=1.0000 mode=none
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2808 mb_mean=0.2866 norm_overlap=0.8343 corr_cb=-0.6900 topkJ=0.0000
[TRAIN][ep=032] loss=0.4188 acc=76.09%
[TRAIN][ep=032] mask_avg: mc_mean=0.2725 mb_mean=0.2811 norm_overlap=0.8247 corr_cb=-0.6457
[EPOCH 032/089] train: loss=0.4188 acc=76.09% | val: loss=0.6368 acc=69.35% f1=45.71% auc=65.33% val_score=89.3152 val_score_bestthr=91.6603 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.272, mb=0.281, no=0.825, corr=-0.646) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 89.3152
[DBG][ep=033] disease_pos_weight=1.0000 mode=none
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2814 mb_mean=0.2815 norm_overlap=0.7916 corr_cb=-0.7186 topkJ=0.0000
[TRAIN][ep=033] loss=0.4167 acc=76.09%
[TRAIN][ep=033] mask_avg: mc_mean=0.2725 mb_mean=0.2812 norm_overlap=0.8247 corr_cb=-0.6471
[EPOCH 033/089] train: loss=0.4167 acc=76.09% | val: loss=0.6378 acc=69.35% f1=48.65% auc=65.33% val_score=89.3152 val_score_bestthr=92.8150 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.272, mb=0.281, no=0.825, corr=-0.647) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 89.3152
[DBG][ep=034] disease_pos_weight=1.0000 mode=none
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2757 mb_mean=0.2836 norm_overlap=0.7934 corr_cb=-0.7361 topkJ=0.0000
[TRAIN][ep=034] loss=0.4151 acc=76.45%
[TRAIN][ep=034] mask_avg: mc_mean=0.2725 mb_mean=0.2811 norm_overlap=0.8245 corr_cb=-0.6482
[EPOCH 034/089] train: loss=0.4151 acc=76.45% | val: loss=0.6396 acc=69.35% f1=48.65% auc=65.55% val_score=89.3152 val_score_bestthr=92.8150 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.272, mb=0.281, no=0.824, corr=-0.648) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 89.3152
[DBG][ep=035] disease_pos_weight=1.0000 mode=none
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2812 mb_mean=0.2763 norm_overlap=0.7972 corr_cb=-0.6850 topkJ=0.0000
[TRAIN][ep=035] loss=0.4133 acc=75.54%
[TRAIN][ep=035] mask_avg: mc_mean=0.2725 mb_mean=0.2811 norm_overlap=0.8246 corr_cb=-0.6465
[EPOCH 035/089] train: loss=0.4133 acc=75.54% | val: loss=0.6410 acc=69.35% f1=48.65% auc=64.99% val_score=90.1507 val_score_bestthr=92.8150 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.273, mb=0.281, no=0.825, corr=-0.647) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 90.1507
[DBG][ep=036] disease_pos_weight=1.0000 mode=none
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2850 mb_mean=0.2605 norm_overlap=0.7721 corr_cb=-0.6981 topkJ=0.0000
[TRAIN][ep=036] loss=0.4119 acc=76.99%
[TRAIN][ep=036] mask_avg: mc_mean=0.2725 mb_mean=0.2811 norm_overlap=0.8245 corr_cb=-0.6475
[EPOCH 036/089] train: loss=0.4119 acc=76.99% | val: loss=0.6420 acc=69.35% f1=29.63% auc=65.33% val_score=92.3489 val_score_bestthr=83.5385 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.272, mb=0.281, no=0.824, corr=-0.648) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 92.3489
[EARLY STOP] no improvement for 30 epochs. best_epoch=6
[CKPT] Loaded best for testing: results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
=============== FIT DONE ===============
[BEST] epoch=6 | val_acc=75.81% | val_f1=66.67% | val_auc=78.26% | val_score=104.8367 | val_score_bestthr=108.6019
[TEST@BEST] thr_used=0.370 | acc=64.05% f1=12.70% auc=58.65% | SP_sex=4.78% EO_sex=0.72% SP_age=4.21% EO_age=16.67%
[TIME] 0.57 min
[OK] Saved: results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/summary_fold_2.json
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4496 mb_mean=0.4946 norm_overlap=1.0001 corr_cb=0.1679 topkJ=0.0819
[TRAIN][ep=000] loss=0.6686 acc=63.77%
[TRAIN][ep=000] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0415
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4515 mb_mean=0.4949 norm_overlap=1.0000 corr_cb=0.0438 topkJ=0.0912
[TRAIN][ep=001] loss=0.6628 acc=63.77%
[TRAIN][ep=001] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0393
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4501 mb_mean=0.4947 norm_overlap=1.0000 corr_cb=0.0147 topkJ=0.0889
[TRAIN][ep=002] loss=0.6586 acc=63.77%
[TRAIN][ep=002] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0412
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4523 mb_mean=0.4943 norm_overlap=1.0001 corr_cb=0.1587 topkJ=0.0969
[TRAIN][ep=003] loss=0.6564 acc=63.77%
[TRAIN][ep=003] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0415
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4502 mb_mean=0.4945 norm_overlap=0.9999 corr_cb=-0.0905 topkJ=0.0338
[TRAIN][ep=004] loss=0.6548 acc=63.77%
[TRAIN][ep=004] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0389
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4510 mb_mean=0.4956 norm_overlap=1.0001 corr_cb=0.0918 topkJ=0.0948
[TRAIN][ep=005] loss=0.6537 acc=63.77%
[TRAIN][ep=005] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0387
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4523 mb_mean=0.4929 norm_overlap=1.0000 corr_cb=-0.0175 topkJ=0.0527
[TRAIN][ep=006] loss=0.6527 acc=63.77%
[TRAIN][ep=006] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0407
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4503 mb_mean=0.4943 norm_overlap=0.9999 corr_cb=-0.0701 topkJ=0.0588
[TRAIN][ep=007] loss=0.6516 acc=63.77%
[TRAIN][ep=007] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0395
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4515 mb_mean=0.4937 norm_overlap=1.0000 corr_cb=0.0577 topkJ=0.0890
[TRAIN][ep=008] loss=0.6511 acc=63.77%
[TRAIN][ep=008] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0414
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4511 mb_mean=0.4927 norm_overlap=1.0000 corr_cb=0.0201 topkJ=0.0884
[TRAIN][ep=009] loss=0.6495 acc=63.77%
[TRAIN][ep=009] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0422
================= FIT START (fold=2) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.35 select_by=val_score | eval_thr_mode=best_acc eval_thr_grid=coarse | disease_pos_weight_mode=none freeze_b_after=15 | two_stage=True stage1_ratio=0.35 stage2_lr_mult=0.3 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4516 mb_mean=0.4954 norm_overlap=1.0000 corr_cb=0.0570 topkJ=0.0440
[TRAIN][ep=000] loss=0.6485 acc=63.77%
[TRAIN][ep=000] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0407
[EPOCH 000/089] train: loss=0.6485 acc=63.77% | val: loss=0.6475 acc=77.42% f1=68.18% auc=77.70% val_score=71.7916 val_score_bestthr=111.0593 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.450, mb=0.495, no=1.000, corr=0.041) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* -1000000000000000000.0000 -> 71.7916
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4492 mb_mean=0.4950 norm_overlap=0.9998 corr_cb=-0.1808 topkJ=0.0441
[TRAIN][ep=001] loss=0.6468 acc=63.77%
[TRAIN][ep=001] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0400
[EPOCH 001/089] train: loss=0.6468 acc=63.77% | val: loss=0.6459 acc=75.81% f1=61.54% auc=77.37% val_score=81.9038 val_score_bestthr=105.8383 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.450, mb=0.495, no=1.000, corr=0.040) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 71.7916 -> 81.9038
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4508 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=-0.0404 topkJ=0.0832
[TRAIN][ep=002] loss=0.6455 acc=63.77%
[TRAIN][ep=002] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0410
[EPOCH 002/089] train: loss=0.6455 acc=63.77% | val: loss=0.6446 acc=75.81% f1=61.54% auc=76.70% val_score=81.9133 val_score_bestthr=105.8383 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.450, mb=0.495, no=1.000, corr=0.041) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 81.9038 -> 81.9133
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4487 mb_mean=0.4952 norm_overlap=0.9999 corr_cb=-0.0570 topkJ=0.0462
[TRAIN][ep=003] loss=0.6439 acc=63.77%
[TRAIN][ep=003] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0400
[EPOCH 003/089] train: loss=0.6439 acc=63.77% | val: loss=0.6432 acc=74.19% f1=65.22% auc=76.03% val_score=95.8460 val_score_bestthr=106.3227 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.450, mb=0.495, no=1.000, corr=0.040) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 81.9133 -> 95.8460
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4503 mb_mean=0.4944 norm_overlap=1.0001 corr_cb=0.1213 topkJ=0.0789
[TRAIN][ep=004] loss=0.6428 acc=63.77%
[TRAIN][ep=004] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0380
[EPOCH 004/089] train: loss=0.6428 acc=63.77% | val: loss=0.6419 acc=72.58% f1=65.31% auc=75.03% val_score=75.8743 val_score_bestthr=104.5399 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.450, mb=0.495, no=1.000, corr=0.038) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 95.8460 -> 75.8743
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4518 mb_mean=0.4941 norm_overlap=1.0000 corr_cb=-0.0020 topkJ=0.0603
[TRAIN][ep=005] loss=2.2431 acc=63.77%
[TRAIN][ep=005] mask_avg: mc_mean=0.4466 mb_mean=0.4885 norm_overlap=0.9999 corr_cb=-0.0530
[EPOCH 005/089] train: loss=2.2431 acc=63.77% | val: loss=0.6447 acc=74.19% f1=61.90% auc=78.04% val_score=97.9107 val_score_bestthr=104.3640 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.447, mb=0.488, no=1.000, corr=-0.053) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 95.8460 -> 97.9107
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4425 mb_mean=0.4812 norm_overlap=0.9999 corr_cb=-0.1099 topkJ=0.0269
[TRAIN][ep=006] loss=1.5115 acc=63.77%
[TRAIN][ep=006] mask_avg: mc_mean=0.4378 mb_mean=0.4745 norm_overlap=1.0000 corr_cb=0.0144
[EPOCH 006/089] train: loss=1.5115 acc=63.77% | val: loss=0.6426 acc=75.81% f1=66.67% auc=78.26% val_score=104.8367 val_score_bestthr=108.6019 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.438, mb=0.474, no=1.000, corr=0.014) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 97.9107 -> 104.8367
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4338 mb_mean=0.4656 norm_overlap=1.0002 corr_cb=0.1530 topkJ=0.0744
[TRAIN][ep=007] loss=0.7945 acc=63.77%
[TRAIN][ep=007] mask_avg: mc_mean=0.4274 mb_mean=0.4579 norm_overlap=1.0004 corr_cb=0.1915
[EPOCH 007/089] train: loss=0.7945 acc=63.77% | val: loss=0.6407 acc=74.19% f1=60.00% auc=77.70% val_score=102.2972 val_score_bestthr=103.4818 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.427, mb=0.458, no=1.000, corr=0.192) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 104.8367 -> 102.2972
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4205 mb_mean=0.4467 norm_overlap=1.0010 corr_cb=0.4250 topkJ=0.1046
[TRAIN][ep=008] loss=0.6174 acc=63.77%
[TRAIN][ep=008] mask_avg: mc_mean=0.4156 mb_mean=0.4377 norm_overlap=1.0009 corr_cb=0.2724
[EPOCH 008/089] train: loss=0.6174 acc=63.77% | val: loss=0.6393 acc=75.81% f1=61.54% auc=76.59% val_score=100.0574 val_score_bestthr=105.8383 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.416, mb=0.438, no=1.001, corr=0.272) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 104.8367 -> 100.0574
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4125 mb_mean=0.4321 norm_overlap=1.0009 corr_cb=0.2412 topkJ=0.0697
[TRAIN][ep=009] loss=0.6121 acc=63.77%
[TRAIN][ep=009] mask_avg: mc_mean=0.4029 mb_mean=0.4133 norm_overlap=1.0017 corr_cb=0.2866
[EPOCH 009/089] train: loss=0.6121 acc=63.77% | val: loss=0.6374 acc=74.19% f1=63.64% auc=75.47% val_score=97.8049 val_score_bestthr=105.5917 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.403, mb=0.413, no=1.002, corr=0.287) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 104.8367 -> 97.8049
[DBG][ep=010] disease_pos_weight=1.0000 mode=none
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.3975 mb_mean=0.4015 norm_overlap=1.0013 corr_cb=0.1690 topkJ=0.0458
[TRAIN][ep=010] loss=0.6074 acc=63.77%
[TRAIN][ep=010] mask_avg: mc_mean=0.3899 mb_mean=0.3859 norm_overlap=1.0028 corr_cb=0.2639
[EPOCH 010/089] train: loss=0.6074 acc=63.77% | val: loss=0.6355 acc=72.58% f1=48.48% auc=74.02% val_score=97.1845 val_score_bestthr=95.8932 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.390, mb=0.386, no=1.003, corr=0.264) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 104.8367 -> 97.1845
[DBG][ep=011] disease_pos_weight=1.0000 mode=none
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.3793 mb_mean=0.3646 norm_overlap=1.0037 corr_cb=0.2708 topkJ=0.0645
[TRAIN][ep=011] loss=0.6014 acc=63.77%
[TRAIN][ep=011] mask_avg: mc_mean=0.3768 mb_mean=0.3581 norm_overlap=1.0023 corr_cb=0.1309
[EPOCH 011/089] train: loss=0.6014 acc=63.77% | val: loss=0.6328 acc=70.97% f1=60.87% auc=72.80% val_score=97.5367 val_score_bestthr=100.7374 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.377, mb=0.358, no=1.002, corr=0.131) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 104.8367 -> 97.5367
[DBG][ep=012] disease_pos_weight=1.0000 mode=none
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.3716 mb_mean=0.3540 norm_overlap=1.0033 corr_cb=0.1544 topkJ=0.0298
[TRAIN][ep=012] loss=0.5963 acc=63.77%
[TRAIN][ep=012] mask_avg: mc_mean=0.3639 mb_mean=0.3325 norm_overlap=0.9986 corr_cb=-0.0461
[EPOCH 012/089] train: loss=0.5963 acc=63.77% | val: loss=0.6303 acc=72.58% f1=48.48% auc=71.79% val_score=92.3401 val_score_bestthr=95.8932 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.364, mb=0.333, no=0.999, corr=-0.046) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 104.8367 -> 92.3401
[DBG][ep=013] disease_pos_weight=1.0000 mode=none
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.3608 mb_mean=0.3236 norm_overlap=0.9907 corr_cb=-0.2735 topkJ=0.0062
[TRAIN][ep=013] loss=0.5881 acc=63.95%
[TRAIN][ep=013] mask_avg: mc_mean=0.3522 mb_mean=0.3102 norm_overlap=0.9892 corr_cb=-0.2330
[EPOCH 013/089] train: loss=0.5881 acc=63.95% | val: loss=0.6274 acc=72.58% f1=48.48% auc=70.35% val_score=101.3341 val_score_bestthr=95.8932 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.352, mb=0.310, no=0.989, corr=-0.233) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 104.8367 -> 101.3341
[DBG][ep=014] disease_pos_weight=1.0000 mode=none
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.3519 mb_mean=0.3152 norm_overlap=0.9730 corr_cb=-0.5255 topkJ=0.0012
[TRAIN][ep=014] loss=0.5811 acc=63.77%
[TRAIN][ep=014] mask_avg: mc_mean=0.3402 mb_mean=0.2907 norm_overlap=0.9685 corr_cb=-0.4304
[EPOCH 014/089] train: loss=0.5811 acc=63.77% | val: loss=0.6247 acc=70.97% f1=47.06% auc=69.12% val_score=96.7981 val_score_bestthr=93.5917 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.340, mb=0.291, no=0.969, corr=-0.430) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 104.8367 -> 96.7981
[DBG][ep=015] disease_pos_weight=1.0000 mode=none
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.3341 mb_mean=0.2863 norm_overlap=0.9649 corr_cb=-0.4885 topkJ=0.0025
[TRAIN][ep=015] loss=0.5734 acc=64.49%
[TRAIN][ep=015] mask_avg: mc_mean=0.3306 mb_mean=0.2815 norm_overlap=0.9485 corr_cb=-0.5450
[EPOCH 015/089] train: loss=0.5734 acc=64.49% | val: loss=0.6205 acc=70.97% f1=47.06% auc=69.23% val_score=94.5726 val_score_bestthr=93.5917 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.331, mb=0.282, no=0.948, corr=-0.545) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 94.5726
[DBG][ep=016] disease_pos_weight=1.0000 mode=none
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.3089 mb_mean=0.2574 norm_overlap=0.9489 corr_cb=-0.3032 topkJ=0.0032
[TRAIN][ep=016] loss=0.5661 acc=65.94%
[TRAIN][ep=016] mask_avg: mc_mean=0.3216 mb_mean=0.2815 norm_overlap=0.9347 corr_cb=-0.5822
[EPOCH 016/089] train: loss=0.5661 acc=65.94% | val: loss=0.6173 acc=70.97% f1=47.06% auc=68.23% val_score=95.2841 val_score_bestthr=93.5917 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.322, mb=0.282, no=0.935, corr=-0.582) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 95.2841
[DBG][ep=017] disease_pos_weight=1.0000 mode=none
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.3079 mb_mean=0.2759 norm_overlap=0.9362 corr_cb=-0.4710 topkJ=0.0000
[TRAIN][ep=017] loss=0.5598 acc=66.49%
[TRAIN][ep=017] mask_avg: mc_mean=0.3148 mb_mean=0.2815 norm_overlap=0.9215 corr_cb=-0.6110
[EPOCH 017/089] train: loss=0.5598 acc=66.49% | val: loss=0.6144 acc=70.97% f1=47.06% auc=69.12% val_score=95.7411 val_score_bestthr=93.5917 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.315, mb=0.281, no=0.921, corr=-0.611) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 95.7411
[DBG][ep=018] disease_pos_weight=1.0000 mode=none
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.3119 mb_mean=0.2897 norm_overlap=0.9161 corr_cb=-0.6394 topkJ=0.0000
[TRAIN][ep=018] loss=0.5529 acc=67.21%
[TRAIN][ep=018] mask_avg: mc_mean=0.3093 mb_mean=0.2815 norm_overlap=0.9122 corr_cb=-0.6164
[EPOCH 018/089] train: loss=0.5529 acc=67.21% | val: loss=0.6104 acc=69.35% f1=59.57% auc=68.67% val_score=92.2030 val_score_bestthr=98.0869 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.309, mb=0.281, no=0.912, corr=-0.616) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 92.2030
[DBG][ep=019] disease_pos_weight=1.0000 mode=none
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.3073 mb_mean=0.2883 norm_overlap=0.9127 corr_cb=-0.5999 topkJ=0.0000
[TRAIN][ep=019] loss=0.5470 acc=66.67%
[TRAIN][ep=019] mask_avg: mc_mean=0.3041 mb_mean=0.2815 norm_overlap=0.9005 corr_cb=-0.6268
[EPOCH 019/089] train: loss=0.5470 acc=66.67% | val: loss=0.6095 acc=69.35% f1=59.57% auc=68.67% val_score=92.2030 val_score_bestthr=98.0869 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.304, mb=0.282, no=0.901, corr=-0.627) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 92.2030
[DBG][ep=020] disease_pos_weight=1.0000 mode=none
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.3048 mb_mean=0.2823 norm_overlap=0.8767 corr_cb=-0.7233 topkJ=0.0000
[TRAIN][ep=020] loss=0.5391 acc=67.39%
[TRAIN][ep=020] mask_avg: mc_mean=0.3008 mb_mean=0.2815 norm_overlap=0.8921 corr_cb=-0.6329
[EPOCH 020/089] train: loss=0.5391 acc=67.39% | val: loss=0.6070 acc=69.35% f1=53.66% auc=68.67% val_score=92.2030 val_score_bestthr=95.0988 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.301, mb=0.281, no=0.892, corr=-0.633) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 92.2030
[DBG][ep=021] disease_pos_weight=1.0000 mode=none
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2844 mb_mean=0.2767 norm_overlap=0.8986 corr_cb=-0.5357 topkJ=0.0000
[TRAIN][ep=021] loss=0.5321 acc=68.30%
[TRAIN][ep=021] mask_avg: mc_mean=0.2968 mb_mean=0.2815 norm_overlap=0.8836 corr_cb=-0.6338
[EPOCH 021/089] train: loss=0.5321 acc=68.30% | val: loss=0.6067 acc=69.35% f1=55.81% auc=68.90% val_score=91.4390 val_score_bestthr=96.5670 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.297, mb=0.282, no=0.884, corr=-0.634) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 91.4390
[DBG][ep=022] disease_pos_weight=1.0000 mode=none
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2945 mb_mean=0.2852 norm_overlap=0.8745 corr_cb=-0.6523 topkJ=0.0000
[TRAIN][ep=022] loss=0.5242 acc=70.47%
[TRAIN][ep=022] mask_avg: mc_mean=0.2940 mb_mean=0.2815 norm_overlap=0.8754 corr_cb=-0.6400
[EPOCH 022/089] train: loss=0.5242 acc=70.47% | val: loss=0.6055 acc=69.35% f1=55.81% auc=68.34% val_score=91.4390 val_score_bestthr=96.5670 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.294, mb=0.282, no=0.875, corr=-0.640) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 91.4390
[DBG][ep=023] disease_pos_weight=1.0000 mode=none
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2969 mb_mean=0.2696 norm_overlap=0.8399 corr_cb=-0.6838 topkJ=0.0000
[TRAIN][ep=023] loss=0.5167 acc=70.65%
[TRAIN][ep=023] mask_avg: mc_mean=0.2910 mb_mean=0.2815 norm_overlap=0.8693 corr_cb=-0.6349
[EPOCH 023/089] train: loss=0.5167 acc=70.65% | val: loss=0.6073 acc=69.35% f1=55.81% auc=68.12% val_score=91.4390 val_score_bestthr=96.5670 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.291, mb=0.282, no=0.869, corr=-0.635) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 91.4390
[DBG][ep=024] disease_pos_weight=1.0000 mode=none
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2926 mb_mean=0.2864 norm_overlap=0.8525 corr_cb=-0.7177 topkJ=0.0000
[TRAIN][ep=024] loss=0.5117 acc=71.74%
[TRAIN][ep=024] mask_avg: mc_mean=0.2882 mb_mean=0.2815 norm_overlap=0.8624 corr_cb=-0.6383
[EPOCH 024/089] train: loss=0.5117 acc=71.74% | val: loss=0.6145 acc=69.35% f1=55.81% auc=67.78% val_score=94.9544 val_score_bestthr=96.5670 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.288, mb=0.282, no=0.862, corr=-0.638) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 94.9544
[DBG][ep=025] disease_pos_weight=1.0000 mode=none
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2984 mb_mean=0.2795 norm_overlap=0.8206 corr_cb=-0.7713 topkJ=0.0000
[TRAIN][ep=025] loss=0.5047 acc=73.01%
[TRAIN][ep=025] mask_avg: mc_mean=0.2856 mb_mean=0.2815 norm_overlap=0.8558 corr_cb=-0.6406
[EPOCH 025/089] train: loss=0.5047 acc=73.01% | val: loss=0.6186 acc=70.97% f1=47.06% auc=67.34% val_score=94.9544 val_score_bestthr=93.5917 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.286, mb=0.281, no=0.856, corr=-0.641) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 94.9544
[DBG][ep=026] disease_pos_weight=1.0000 mode=none
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2824 mb_mean=0.2775 norm_overlap=0.8329 corr_cb=-0.6816 topkJ=0.0000
[TRAIN][ep=026] loss=0.4995 acc=72.83%
[TRAIN][ep=026] mask_avg: mc_mean=0.2830 mb_mean=0.2815 norm_overlap=0.8520 corr_cb=-0.6319
[EPOCH 026/089] train: loss=0.4995 acc=72.83% | val: loss=0.6150 acc=69.35% f1=59.57% auc=67.22% val_score=92.1977 val_score_bestthr=98.1494 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.283, mb=0.282, no=0.852, corr=-0.632) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 92.1977
[DBG][ep=027] disease_pos_weight=1.0000 mode=none
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2709 mb_mean=0.2879 norm_overlap=0.8882 corr_cb=-0.4709 topkJ=0.0000
[TRAIN][ep=027] loss=0.4906 acc=74.09%
[TRAIN][ep=027] mask_avg: mc_mean=0.2806 mb_mean=0.2815 norm_overlap=0.8445 corr_cb=-0.6391
[EPOCH 027/089] train: loss=0.4906 acc=74.09% | val: loss=0.6249 acc=69.35% f1=29.63% auc=66.56% val_score=84.3797 val_score_bestthr=83.5385 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.281, mb=0.281, no=0.844, corr=-0.639) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 84.3797
[DBG][ep=028] disease_pos_weight=1.0000 mode=none
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2751 mb_mean=0.2918 norm_overlap=0.8520 corr_cb=-0.6659 topkJ=0.0000
[TRAIN][ep=028] loss=0.4858 acc=73.73%
[TRAIN][ep=028] mask_avg: mc_mean=0.2787 mb_mean=0.2815 norm_overlap=0.8391 corr_cb=-0.6416
[EPOCH 028/089] train: loss=0.4858 acc=73.73% | val: loss=0.6224 acc=70.97% f1=50.00% auc=66.78% val_score=87.9226 val_score_bestthr=95.1280 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.279, mb=0.282, no=0.839, corr=-0.642) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 87.9226
[DBG][ep=029] disease_pos_weight=1.0000 mode=none
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2851 mb_mean=0.2856 norm_overlap=0.8343 corr_cb=-0.6822 topkJ=0.0000
[TRAIN][ep=029] loss=0.4755 acc=74.28%
[TRAIN][ep=029] mask_avg: mc_mean=0.2765 mb_mean=0.2815 norm_overlap=0.8343 corr_cb=-0.6429
[EPOCH 029/089] train: loss=0.4755 acc=74.28% | val: loss=0.6271 acc=69.35% f1=29.63% auc=65.89% val_score=87.9226 val_score_bestthr=83.5385 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.277, mb=0.281, no=0.834, corr=-0.643) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 87.9226
[DBG][ep=030] disease_pos_weight=1.0000 mode=none
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2750 mb_mean=0.2776 norm_overlap=0.8731 corr_cb=-0.5547 topkJ=0.0000
[TRAIN][ep=030] loss=0.4702 acc=75.00%
[TRAIN][ep=030] mask_avg: mc_mean=0.2738 mb_mean=0.2815 norm_overlap=0.8310 corr_cb=-0.6389
[EPOCH 030/089] train: loss=0.4702 acc=75.00% | val: loss=0.6336 acc=69.35% f1=45.71% auc=65.55% val_score=87.1500 val_score_bestthr=91.6603 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.274, mb=0.281, no=0.831, corr=-0.639) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 87.1500
[DBG][ep=031] disease_pos_weight=1.0000 mode=none
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2722 mb_mean=0.2922 norm_overlap=0.8582 corr_cb=-0.5645 topkJ=0.0000
[TRAIN][ep=031] loss=0.4600 acc=75.54%
[TRAIN][ep=031] mask_avg: mc_mean=0.2725 mb_mean=0.2816 norm_overlap=0.8271 corr_cb=-0.6452
[EPOCH 031/089] train: loss=0.4600 acc=75.54% | val: loss=0.6353 acc=69.35% f1=45.71% auc=65.77% val_score=89.3152 val_score_bestthr=91.6603 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.272, mb=0.282, no=0.827, corr=-0.645) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 89.3152
[DBG][ep=032] disease_pos_weight=1.0000 mode=none
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2808 mb_mean=0.2869 norm_overlap=0.8371 corr_cb=-0.6859 topkJ=0.0000
[TRAIN][ep=032] loss=0.4595 acc=76.27%
[TRAIN][ep=032] mask_avg: mc_mean=0.2725 mb_mean=0.2815 norm_overlap=0.8272 corr_cb=-0.6430
[EPOCH 032/089] train: loss=0.4595 acc=76.27% | val: loss=0.6365 acc=69.35% f1=45.71% auc=65.22% val_score=89.3152 val_score_bestthr=91.6603 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.273, mb=0.281, no=0.827, corr=-0.643) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 89.3152
[DBG][ep=033] disease_pos_weight=1.0000 mode=none
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2814 mb_mean=0.2818 norm_overlap=0.7938 corr_cb=-0.7179 topkJ=0.0000
[TRAIN][ep=033] loss=0.4574 acc=75.91%
[TRAIN][ep=033] mask_avg: mc_mean=0.2725 mb_mean=0.2815 norm_overlap=0.8272 corr_cb=-0.6444
[EPOCH 033/089] train: loss=0.4574 acc=75.91% | val: loss=0.6375 acc=69.35% f1=48.65% auc=65.33% val_score=89.3152 val_score_bestthr=92.8150 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.273, mb=0.282, no=0.827, corr=-0.644) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 89.3152
[DBG][ep=034] disease_pos_weight=1.0000 mode=none
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2757 mb_mean=0.2839 norm_overlap=0.7958 corr_cb=-0.7344 topkJ=0.0000
[TRAIN][ep=034] loss=0.4558 acc=76.27%
[TRAIN][ep=034] mask_avg: mc_mean=0.2725 mb_mean=0.2815 norm_overlap=0.8270 corr_cb=-0.6456
[EPOCH 034/089] train: loss=0.4558 acc=76.27% | val: loss=0.6392 acc=69.35% f1=48.65% auc=65.66% val_score=89.3152 val_score_bestthr=92.8150 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.273, mb=0.281, no=0.827, corr=-0.646) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 89.3152
[DBG][ep=035] disease_pos_weight=1.0000 mode=none
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2813 mb_mean=0.2767 norm_overlap=0.7994 corr_cb=-0.6842 topkJ=0.0000
[TRAIN][ep=035] loss=0.4539 acc=75.54%
[TRAIN][ep=035] mask_avg: mc_mean=0.2725 mb_mean=0.2815 norm_overlap=0.8270 corr_cb=-0.6439
[EPOCH 035/089] train: loss=0.4539 acc=75.54% | val: loss=0.6406 acc=69.35% f1=48.65% auc=65.11% val_score=87.1500 val_score_bestthr=92.8150 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.273, mb=0.282, no=0.827, corr=-0.644) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 87.1500
[DBG][ep=036] disease_pos_weight=1.0000 mode=none
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2850 mb_mean=0.2608 norm_overlap=0.7751 corr_cb=-0.6953 topkJ=0.0000
[TRAIN][ep=036] loss=0.4525 acc=76.81%
[TRAIN][ep=036] mask_avg: mc_mean=0.2725 mb_mean=0.2815 norm_overlap=0.8270 corr_cb=-0.6449
[EPOCH 036/089] train: loss=0.4525 acc=76.81% | val: loss=0.6417 acc=69.35% f1=29.63% auc=65.33% val_score=89.3152 val_score_bestthr=83.5385 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.273, mb=0.281, no=0.827, corr=-0.645) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 89.3152
[EARLY STOP] no improvement for 30 epochs. best_epoch=6
[CKPT] Loaded best for testing: results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
=============== FIT DONE ===============
[BEST] epoch=6 | val_acc=75.81% | val_f1=66.67% | val_auc=78.26% | val_score=104.8367 | val_score_bestthr=108.6019
[TEST@BEST] thr_used=0.370 | acc=64.05% f1=12.70% auc=58.65% | SP_sex=4.78% EO_sex=0.72% SP_age=4.21% EO_age=16.67%
[TIME] 0.67 min
[OK] Saved: results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/summary_fold_2.json
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4496 mb_mean=0.4946 norm_overlap=1.0001 corr_cb=0.1679 topkJ=0.0819
[TRAIN][ep=000] loss=0.6686 acc=63.77%
[TRAIN][ep=000] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0415
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4515 mb_mean=0.4949 norm_overlap=1.0000 corr_cb=0.0438 topkJ=0.0912
[TRAIN][ep=001] loss=0.6628 acc=63.77%
[TRAIN][ep=001] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0393
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4501 mb_mean=0.4947 norm_overlap=1.0000 corr_cb=0.0147 topkJ=0.0889
[TRAIN][ep=002] loss=0.6586 acc=63.77%
[TRAIN][ep=002] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0412
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4523 mb_mean=0.4943 norm_overlap=1.0001 corr_cb=0.1587 topkJ=0.0969
[TRAIN][ep=003] loss=0.6564 acc=63.77%
[TRAIN][ep=003] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0415
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4502 mb_mean=0.4945 norm_overlap=0.9999 corr_cb=-0.0905 topkJ=0.0338
[TRAIN][ep=004] loss=0.6548 acc=63.77%
[TRAIN][ep=004] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0389
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4510 mb_mean=0.4956 norm_overlap=1.0001 corr_cb=0.0918 topkJ=0.0948
[TRAIN][ep=005] loss=0.6537 acc=63.77%
[TRAIN][ep=005] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0387
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4523 mb_mean=0.4929 norm_overlap=1.0000 corr_cb=-0.0175 topkJ=0.0527
[TRAIN][ep=006] loss=0.6527 acc=63.77%
[TRAIN][ep=006] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0407
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4503 mb_mean=0.4943 norm_overlap=0.9999 corr_cb=-0.0701 topkJ=0.0588
[TRAIN][ep=007] loss=0.6516 acc=63.77%
[TRAIN][ep=007] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0395
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4515 mb_mean=0.4937 norm_overlap=1.0000 corr_cb=0.0577 topkJ=0.0890
[TRAIN][ep=008] loss=0.6511 acc=63.77%
[TRAIN][ep=008] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0414
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4511 mb_mean=0.4927 norm_overlap=1.0000 corr_cb=0.0201 topkJ=0.0884
[TRAIN][ep=009] loss=0.6495 acc=63.77%
[TRAIN][ep=009] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0422
================= FIT START (fold=2) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.35 select_by=val_score | eval_thr_mode=best_acc eval_thr_grid=coarse | disease_pos_weight_mode=none freeze_b_after=15 | two_stage=True stage1_ratio=0.35 stage2_lr_mult=0.3 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4516 mb_mean=0.4954 norm_overlap=1.0000 corr_cb=0.0570 topkJ=0.0440
[TRAIN][ep=000] loss=0.6485 acc=63.77%
[TRAIN][ep=000] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0407
[EPOCH 000/089] train: loss=0.6485 acc=63.77% | val: loss=0.6475 acc=77.42% f1=68.18% auc=77.70% val_score=71.7916 val_score_bestthr=111.0593 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.450, mb=0.495, no=1.000, corr=0.041) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* -1000000000000000000.0000 -> 71.7916
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4492 mb_mean=0.4950 norm_overlap=0.9998 corr_cb=-0.1808 topkJ=0.0441
[TRAIN][ep=001] loss=0.6468 acc=63.77%
[TRAIN][ep=001] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0400
[EPOCH 001/089] train: loss=0.6468 acc=63.77% | val: loss=0.6459 acc=75.81% f1=61.54% auc=77.37% val_score=81.9038 val_score_bestthr=105.8383 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.450, mb=0.495, no=1.000, corr=0.040) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 71.7916 -> 81.9038
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4508 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=-0.0404 topkJ=0.0832
[TRAIN][ep=002] loss=0.6455 acc=63.77%
[TRAIN][ep=002] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0410
[EPOCH 002/089] train: loss=0.6455 acc=63.77% | val: loss=0.6446 acc=75.81% f1=61.54% auc=76.81% val_score=81.9133 val_score_bestthr=105.8383 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.450, mb=0.495, no=1.000, corr=0.041) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 81.9038 -> 81.9133
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4487 mb_mean=0.4952 norm_overlap=0.9999 corr_cb=-0.0570 topkJ=0.0462
[TRAIN][ep=003] loss=0.6439 acc=63.77%
[TRAIN][ep=003] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0400
[EPOCH 003/089] train: loss=0.6439 acc=63.77% | val: loss=0.6432 acc=74.19% f1=65.22% auc=76.03% val_score=95.8460 val_score_bestthr=106.3227 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.450, mb=0.495, no=1.000, corr=0.040) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 81.9133 -> 95.8460
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4503 mb_mean=0.4944 norm_overlap=1.0001 corr_cb=0.1213 topkJ=0.0789
[TRAIN][ep=004] loss=0.6428 acc=63.77%
[TRAIN][ep=004] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0380
[EPOCH 004/089] train: loss=0.6428 acc=63.77% | val: loss=0.6419 acc=72.58% f1=65.31% auc=75.03% val_score=75.8743 val_score_bestthr=104.5399 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.450, mb=0.495, no=1.000, corr=0.038) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 95.8460 -> 75.8743
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4518 mb_mean=0.4941 norm_overlap=1.0000 corr_cb=-0.0020 topkJ=0.0603
[TRAIN][ep=005] loss=2.1389 acc=63.77%
[TRAIN][ep=005] mask_avg: mc_mean=0.4466 mb_mean=0.4885 norm_overlap=0.9999 corr_cb=-0.0536
[EPOCH 005/089] train: loss=2.1389 acc=63.77% | val: loss=0.6447 acc=74.19% f1=55.56% auc=78.04% val_score=97.9107 val_score_bestthr=101.2463 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.447, mb=0.488, no=1.000, corr=-0.054) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 95.8460 -> 97.9107
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4425 mb_mean=0.4812 norm_overlap=0.9999 corr_cb=-0.1115 topkJ=0.0265
[TRAIN][ep=006] loss=1.4079 acc=63.77%
[TRAIN][ep=006] mask_avg: mc_mean=0.4378 mb_mean=0.4745 norm_overlap=1.0000 corr_cb=0.0123
[EPOCH 006/089] train: loss=1.4079 acc=63.77% | val: loss=0.6426 acc=75.81% f1=66.67% auc=78.26% val_score=104.8367 val_score_bestthr=108.6019 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.438, mb=0.474, no=1.000, corr=0.012) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 97.9107 -> 104.8367
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4338 mb_mean=0.4656 norm_overlap=1.0002 corr_cb=0.1491 topkJ=0.0730
[TRAIN][ep=007] loss=0.6913 acc=63.77%
[TRAIN][ep=007] mask_avg: mc_mean=0.4274 mb_mean=0.4579 norm_overlap=1.0004 corr_cb=0.1876
[EPOCH 007/089] train: loss=0.6913 acc=63.77% | val: loss=0.6407 acc=74.19% f1=60.00% auc=77.70% val_score=102.2972 val_score_bestthr=103.4818 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.427, mb=0.458, no=1.000, corr=0.188) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 104.8367 -> 102.2972
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4205 mb_mean=0.4467 norm_overlap=1.0009 corr_cb=0.4195 topkJ=0.1001
[TRAIN][ep=008] loss=0.5144 acc=63.77%
[TRAIN][ep=008] mask_avg: mc_mean=0.4156 mb_mean=0.4377 norm_overlap=1.0009 corr_cb=0.2659
[EPOCH 008/089] train: loss=0.5144 acc=63.77% | val: loss=0.6392 acc=75.81% f1=61.54% auc=76.59% val_score=100.0574 val_score_bestthr=105.8383 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.416, mb=0.438, no=1.001, corr=0.266) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 104.8367 -> 100.0574
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4125 mb_mean=0.4321 norm_overlap=1.0008 corr_cb=0.2339 topkJ=0.0678
[TRAIN][ep=009] loss=0.5093 acc=63.77%
[TRAIN][ep=009] mask_avg: mc_mean=0.4029 mb_mean=0.4132 norm_overlap=1.0017 corr_cb=0.2785
[EPOCH 009/089] train: loss=0.5093 acc=63.77% | val: loss=0.6374 acc=74.19% f1=63.64% auc=75.47% val_score=97.8049 val_score_bestthr=105.5917 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.403, mb=0.413, no=1.002, corr=0.279) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 104.8367 -> 97.8049
[DBG][ep=010] disease_pos_weight=1.0000 mode=none
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.3975 mb_mean=0.4014 norm_overlap=1.0012 corr_cb=0.1562 topkJ=0.0418
[TRAIN][ep=010] loss=0.5047 acc=63.77%
[TRAIN][ep=010] mask_avg: mc_mean=0.3899 mb_mean=0.3858 norm_overlap=1.0027 corr_cb=0.2544
[EPOCH 010/089] train: loss=0.5047 acc=63.77% | val: loss=0.6355 acc=72.58% f1=51.43% auc=74.02% val_score=97.1845 val_score_bestthr=97.2649 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.390, mb=0.386, no=1.003, corr=0.254) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 104.8367 -> 97.1845
[DBG][ep=011] disease_pos_weight=1.0000 mode=none
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.3793 mb_mean=0.3645 norm_overlap=1.0036 corr_cb=0.2581 topkJ=0.0608
[TRAIN][ep=011] loss=0.4989 acc=63.77%
[TRAIN][ep=011] mask_avg: mc_mean=0.3768 mb_mean=0.3579 norm_overlap=1.0021 corr_cb=0.1196
[EPOCH 011/089] train: loss=0.4989 acc=63.77% | val: loss=0.6328 acc=70.97% f1=60.87% auc=72.69% val_score=97.5367 val_score_bestthr=100.7374 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.377, mb=0.358, no=1.002, corr=0.120) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 104.8367 -> 97.5367
[DBG][ep=012] disease_pos_weight=1.0000 mode=none
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.3716 mb_mean=0.3537 norm_overlap=1.0031 corr_cb=0.1443 topkJ=0.0294
[TRAIN][ep=012] loss=0.4938 acc=63.77%
[TRAIN][ep=012] mask_avg: mc_mean=0.3639 mb_mean=0.3322 norm_overlap=0.9982 corr_cb=-0.0584
[EPOCH 012/089] train: loss=0.4938 acc=63.77% | val: loss=0.6303 acc=72.58% f1=48.48% auc=71.79% val_score=92.3401 val_score_bestthr=95.8932 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.364, mb=0.332, no=0.998, corr=-0.058) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 104.8367 -> 92.3401
[DBG][ep=013] disease_pos_weight=1.0000 mode=none
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.3608 mb_mean=0.3232 norm_overlap=0.9900 corr_cb=-0.2888 topkJ=0.0045
[TRAIN][ep=013] loss=0.4856 acc=63.95%
[TRAIN][ep=013] mask_avg: mc_mean=0.3522 mb_mean=0.3097 norm_overlap=0.9884 corr_cb=-0.2462
[EPOCH 013/089] train: loss=0.4856 acc=63.95% | val: loss=0.6275 acc=72.58% f1=48.48% auc=70.35% val_score=101.3341 val_score_bestthr=95.8932 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.352, mb=0.310, no=0.988, corr=-0.246) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 104.8367 -> 101.3341
[DBG][ep=014] disease_pos_weight=1.0000 mode=none
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.3519 mb_mean=0.3145 norm_overlap=0.9718 corr_cb=-0.5366 topkJ=0.0008
[TRAIN][ep=014] loss=0.4787 acc=63.77%
[TRAIN][ep=014] mask_avg: mc_mean=0.3402 mb_mean=0.2899 norm_overlap=0.9671 corr_cb=-0.4407
[EPOCH 014/089] train: loss=0.4787 acc=63.77% | val: loss=0.6249 acc=70.97% f1=47.06% auc=69.12% val_score=96.7981 val_score_bestthr=93.5917 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.340, mb=0.290, no=0.967, corr=-0.441) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 104.8367 -> 96.7981
[DBG][ep=015] disease_pos_weight=1.0000 mode=none
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.3341 mb_mean=0.2856 norm_overlap=0.9638 corr_cb=-0.4938 topkJ=0.0025
[TRAIN][ep=015] loss=0.4710 acc=64.49%
[TRAIN][ep=015] mask_avg: mc_mean=0.3306 mb_mean=0.2807 norm_overlap=0.9465 corr_cb=-0.5531
[EPOCH 015/089] train: loss=0.4710 acc=64.49% | val: loss=0.6207 acc=70.97% f1=47.06% auc=69.12% val_score=94.5726 val_score_bestthr=93.5917 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.331, mb=0.281, no=0.947, corr=-0.553) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 94.5726
[DBG][ep=016] disease_pos_weight=1.0000 mode=none
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.3089 mb_mean=0.2564 norm_overlap=0.9468 corr_cb=-0.3097 topkJ=0.0024
[TRAIN][ep=016] loss=0.4638 acc=65.94%
[TRAIN][ep=016] mask_avg: mc_mean=0.3217 mb_mean=0.2807 norm_overlap=0.9323 corr_cb=-0.5903
[EPOCH 016/089] train: loss=0.4638 acc=65.94% | val: loss=0.6176 acc=69.35% f1=42.42% auc=68.00% val_score=95.2841 val_score_bestthr=89.5371 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.322, mb=0.281, no=0.932, corr=-0.590) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 95.2841
[DBG][ep=017] disease_pos_weight=1.0000 mode=none
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.3080 mb_mean=0.2751 norm_overlap=0.9335 corr_cb=-0.4788 topkJ=0.0000
[TRAIN][ep=017] loss=0.4576 acc=66.49%
[TRAIN][ep=017] mask_avg: mc_mean=0.3148 mb_mean=0.2807 norm_overlap=0.9187 corr_cb=-0.6183
[EPOCH 017/089] train: loss=0.4576 acc=66.49% | val: loss=0.6148 acc=70.97% f1=47.06% auc=69.01% val_score=93.5574 val_score_bestthr=93.5917 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.315, mb=0.281, no=0.919, corr=-0.618) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 93.5574
[DBG][ep=018] disease_pos_weight=1.0000 mode=none
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.3119 mb_mean=0.2889 norm_overlap=0.9138 corr_cb=-0.6446 topkJ=0.0000
[TRAIN][ep=018] loss=0.4508 acc=67.03%
[TRAIN][ep=018] mask_avg: mc_mean=0.3093 mb_mean=0.2806 norm_overlap=0.9090 corr_cb=-0.6240
[EPOCH 018/089] train: loss=0.4508 acc=67.03% | val: loss=0.6108 acc=69.35% f1=59.57% auc=68.34% val_score=92.2030 val_score_bestthr=98.0869 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.309, mb=0.281, no=0.909, corr=-0.624) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 92.2030
[DBG][ep=019] disease_pos_weight=1.0000 mode=none
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.3074 mb_mean=0.2874 norm_overlap=0.9096 corr_cb=-0.6070 topkJ=0.0000
[TRAIN][ep=019] loss=0.4449 acc=67.03%
[TRAIN][ep=019] mask_avg: mc_mean=0.3042 mb_mean=0.2807 norm_overlap=0.8969 corr_cb=-0.6342
[EPOCH 019/089] train: loss=0.4449 acc=67.03% | val: loss=0.6099 acc=67.74% f1=56.52% auc=68.56% val_score=92.2030 val_score_bestthr=94.8919 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.304, mb=0.281, no=0.897, corr=-0.634) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 92.2030
[DBG][ep=020] disease_pos_weight=1.0000 mode=none
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.3049 mb_mean=0.2817 norm_overlap=0.8739 corr_cb=-0.7271 topkJ=0.0000
[TRAIN][ep=020] loss=0.4370 acc=67.39%
[TRAIN][ep=020] mask_avg: mc_mean=0.3009 mb_mean=0.2806 norm_overlap=0.8882 corr_cb=-0.6400
[EPOCH 020/089] train: loss=0.4370 acc=67.39% | val: loss=0.6075 acc=69.35% f1=53.66% auc=68.67% val_score=92.2030 val_score_bestthr=95.0988 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.301, mb=0.281, no=0.888, corr=-0.640) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 92.2030
[DBG][ep=021] disease_pos_weight=1.0000 mode=none
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2844 mb_mean=0.2758 norm_overlap=0.8935 corr_cb=-0.5455 topkJ=0.0000
[TRAIN][ep=021] loss=0.4301 acc=68.48%
[TRAIN][ep=021] mask_avg: mc_mean=0.2969 mb_mean=0.2807 norm_overlap=0.8794 corr_cb=-0.6410
[EPOCH 021/089] train: loss=0.4301 acc=68.48% | val: loss=0.6072 acc=69.35% f1=55.81% auc=68.78% val_score=91.4390 val_score_bestthr=96.5670 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.297, mb=0.281, no=0.879, corr=-0.641) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 91.4390
[DBG][ep=022] disease_pos_weight=1.0000 mode=none
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2946 mb_mean=0.2845 norm_overlap=0.8702 corr_cb=-0.6600 topkJ=0.0000
[TRAIN][ep=022] loss=0.4222 acc=70.29%
[TRAIN][ep=022] mask_avg: mc_mean=0.2941 mb_mean=0.2807 norm_overlap=0.8710 corr_cb=-0.6464
[EPOCH 022/089] train: loss=0.4222 acc=70.29% | val: loss=0.6060 acc=69.35% f1=55.81% auc=68.12% val_score=91.4390 val_score_bestthr=96.5670 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.294, mb=0.281, no=0.871, corr=-0.646) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 91.4390
[DBG][ep=023] disease_pos_weight=1.0000 mode=none
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2970 mb_mean=0.2688 norm_overlap=0.8354 corr_cb=-0.6867 topkJ=0.0000
[TRAIN][ep=023] loss=0.4147 acc=70.83%
[TRAIN][ep=023] mask_avg: mc_mean=0.2910 mb_mean=0.2807 norm_overlap=0.8647 corr_cb=-0.6417
[EPOCH 023/089] train: loss=0.4147 acc=70.83% | val: loss=0.6078 acc=69.35% f1=55.81% auc=68.23% val_score=91.4390 val_score_bestthr=96.5670 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.291, mb=0.281, no=0.865, corr=-0.642) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 91.4390
[DBG][ep=024] disease_pos_weight=1.0000 mode=none
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2925 mb_mean=0.2856 norm_overlap=0.8478 corr_cb=-0.7228 topkJ=0.0000
[TRAIN][ep=024] loss=0.4098 acc=71.74%
[TRAIN][ep=024] mask_avg: mc_mean=0.2882 mb_mean=0.2807 norm_overlap=0.8577 corr_cb=-0.6444
[EPOCH 024/089] train: loss=0.4098 acc=71.74% | val: loss=0.6153 acc=69.35% f1=55.81% auc=67.45% val_score=94.9544 val_score_bestthr=96.5670 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.288, mb=0.281, no=0.858, corr=-0.644) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 94.9544
[DBG][ep=025] disease_pos_weight=1.0000 mode=none
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2984 mb_mean=0.2787 norm_overlap=0.8162 corr_cb=-0.7758 topkJ=0.0000
[TRAIN][ep=025] loss=0.4029 acc=72.64%
[TRAIN][ep=025] mask_avg: mc_mean=0.2855 mb_mean=0.2807 norm_overlap=0.8508 corr_cb=-0.6471
[EPOCH 025/089] train: loss=0.4029 acc=72.64% | val: loss=0.6192 acc=69.35% f1=55.81% auc=67.22% val_score=94.9544 val_score_bestthr=96.5670 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.286, mb=0.281, no=0.851, corr=-0.647) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 94.9544
[DBG][ep=026] disease_pos_weight=1.0000 mode=none
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2823 mb_mean=0.2768 norm_overlap=0.8266 corr_cb=-0.6908 topkJ=0.0000
[TRAIN][ep=026] loss=0.3976 acc=72.83%
[TRAIN][ep=026] mask_avg: mc_mean=0.2829 mb_mean=0.2807 norm_overlap=0.8471 corr_cb=-0.6379
[EPOCH 026/089] train: loss=0.3976 acc=72.83% | val: loss=0.6156 acc=69.35% f1=59.57% auc=67.11% val_score=90.0215 val_score_bestthr=98.1494 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.283, mb=0.281, no=0.847, corr=-0.638) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 90.0215
[DBG][ep=027] disease_pos_weight=1.0000 mode=none
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2708 mb_mean=0.2871 norm_overlap=0.8841 corr_cb=-0.4779 topkJ=0.0000
[TRAIN][ep=027] loss=0.3888 acc=73.91%
[TRAIN][ep=027] mask_avg: mc_mean=0.2806 mb_mean=0.2806 norm_overlap=0.8393 corr_cb=-0.6453
[EPOCH 027/089] train: loss=0.3888 acc=73.91% | val: loss=0.6257 acc=69.35% f1=29.63% auc=66.44% val_score=84.3797 val_score_bestthr=83.5385 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.281, mb=0.281, no=0.839, corr=-0.645) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 84.3797
[DBG][ep=028] disease_pos_weight=1.0000 mode=none
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2751 mb_mean=0.2908 norm_overlap=0.8461 corr_cb=-0.6718 topkJ=0.0000
[TRAIN][ep=028] loss=0.3840 acc=73.73%
[TRAIN][ep=028] mask_avg: mc_mean=0.2786 mb_mean=0.2807 norm_overlap=0.8339 corr_cb=-0.6473
[EPOCH 028/089] train: loss=0.3840 acc=73.73% | val: loss=0.6231 acc=70.97% f1=50.00% auc=66.44% val_score=87.9226 val_score_bestthr=95.1280 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.279, mb=0.281, no=0.834, corr=-0.647) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 87.9226
[DBG][ep=029] disease_pos_weight=1.0000 mode=none
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2850 mb_mean=0.2847 norm_overlap=0.8298 corr_cb=-0.6867 topkJ=0.0000
[TRAIN][ep=029] loss=0.3737 acc=74.46%
[TRAIN][ep=029] mask_avg: mc_mean=0.2764 mb_mean=0.2806 norm_overlap=0.8289 corr_cb=-0.6487
[EPOCH 029/089] train: loss=0.3737 acc=74.46% | val: loss=0.6278 acc=69.35% f1=29.63% auc=65.44% val_score=87.9226 val_score_bestthr=83.5385 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.276, mb=0.281, no=0.829, corr=-0.649) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 87.9226
[DBG][ep=030] disease_pos_weight=1.0000 mode=none
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2749 mb_mean=0.2768 norm_overlap=0.8671 corr_cb=-0.5671 topkJ=0.0000
[TRAIN][ep=030] loss=0.3684 acc=75.18%
[TRAIN][ep=030] mask_avg: mc_mean=0.2737 mb_mean=0.2806 norm_overlap=0.8254 corr_cb=-0.6450
[EPOCH 030/089] train: loss=0.3684 acc=75.18% | val: loss=0.6344 acc=69.35% f1=45.71% auc=65.33% val_score=87.1500 val_score_bestthr=91.6603 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.274, mb=0.281, no=0.825, corr=-0.645) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 87.1500
[DBG][ep=031] disease_pos_weight=1.0000 mode=none
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2721 mb_mean=0.2913 norm_overlap=0.8531 corr_cb=-0.5697 topkJ=0.0000
[TRAIN][ep=031] loss=0.3584 acc=75.91%
[TRAIN][ep=031] mask_avg: mc_mean=0.2724 mb_mean=0.2807 norm_overlap=0.8215 corr_cb=-0.6509
[EPOCH 031/089] train: loss=0.3584 acc=75.91% | val: loss=0.6361 acc=69.35% f1=45.71% auc=65.22% val_score=89.3152 val_score_bestthr=91.6603 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.272, mb=0.281, no=0.822, corr=-0.651) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 89.3152
[DBG][ep=032] disease_pos_weight=1.0000 mode=none
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2808 mb_mean=0.2861 norm_overlap=0.8306 corr_cb=-0.6951 topkJ=0.0000
[TRAIN][ep=032] loss=0.3578 acc=75.91%
[TRAIN][ep=032] mask_avg: mc_mean=0.2724 mb_mean=0.2806 norm_overlap=0.8216 corr_cb=-0.6489
[EPOCH 032/089] train: loss=0.3578 acc=75.91% | val: loss=0.6373 acc=69.35% f1=45.71% auc=65.22% val_score=89.3152 val_score_bestthr=91.6603 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.272, mb=0.281, no=0.822, corr=-0.649) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 89.3152
[DBG][ep=033] disease_pos_weight=1.0000 mode=none
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2813 mb_mean=0.2811 norm_overlap=0.7888 corr_cb=-0.7193 topkJ=0.0000
[TRAIN][ep=033] loss=0.3557 acc=76.27%
[TRAIN][ep=033] mask_avg: mc_mean=0.2724 mb_mean=0.2807 norm_overlap=0.8216 corr_cb=-0.6503
[EPOCH 033/089] train: loss=0.3557 acc=76.27% | val: loss=0.6383 acc=69.35% f1=29.63% auc=65.33% val_score=89.3152 val_score_bestthr=83.5385 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.272, mb=0.281, no=0.822, corr=-0.650) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 89.3152
[DBG][ep=034] disease_pos_weight=1.0000 mode=none
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2756 mb_mean=0.2832 norm_overlap=0.7905 corr_cb=-0.7381 topkJ=0.0000
[TRAIN][ep=034] loss=0.3541 acc=76.45%
[TRAIN][ep=034] mask_avg: mc_mean=0.2724 mb_mean=0.2807 norm_overlap=0.8214 corr_cb=-0.6514
[EPOCH 034/089] train: loss=0.3541 acc=76.45% | val: loss=0.6401 acc=69.35% f1=48.65% auc=65.44% val_score=89.3152 val_score_bestthr=92.8150 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.272, mb=0.281, no=0.821, corr=-0.651) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 89.3152
[DBG][ep=035] disease_pos_weight=1.0000 mode=none
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2811 mb_mean=0.2758 norm_overlap=0.7947 corr_cb=-0.6857 topkJ=0.0000
[TRAIN][ep=035] loss=0.3523 acc=75.54%
[TRAIN][ep=035] mask_avg: mc_mean=0.2724 mb_mean=0.2807 norm_overlap=0.8214 corr_cb=-0.6497
[EPOCH 035/089] train: loss=0.3523 acc=75.54% | val: loss=0.6415 acc=69.35% f1=29.63% auc=64.99% val_score=90.1507 val_score_bestthr=83.5385 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.272, mb=0.281, no=0.821, corr=-0.650) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 90.1507
[DBG][ep=036] disease_pos_weight=1.0000 mode=none
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2850 mb_mean=0.2601 norm_overlap=0.7683 corr_cb=-0.7017 topkJ=0.0000
[TRAIN][ep=036] loss=0.3509 acc=76.99%
[TRAIN][ep=036] mask_avg: mc_mean=0.2724 mb_mean=0.2807 norm_overlap=0.8214 corr_cb=-0.6507
[EPOCH 036/089] train: loss=0.3509 acc=76.99% | val: loss=0.6425 acc=69.35% f1=29.63% auc=65.22% val_score=92.3489 val_score_bestthr=83.5385 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.272, mb=0.281, no=0.821, corr=-0.651) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 92.3489
[EARLY STOP] no improvement for 30 epochs. best_epoch=6
[CKPT] Loaded best for testing: results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
=============== FIT DONE ===============
[BEST] epoch=6 | val_acc=75.81% | val_f1=66.67% | val_auc=78.26% | val_score=104.8367 | val_score_bestthr=108.6019
[TEST@BEST] thr_used=0.370 | acc=64.05% f1=12.70% auc=58.65% | SP_sex=4.78% EO_sex=0.72% SP_age=4.21% EO_age=16.67%
[TIME] 0.59 min
[OK] Saved: results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/summary_fold_2.json
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4496 mb_mean=0.4946 norm_overlap=1.0001 corr_cb=0.1679 topkJ=0.0819
[TRAIN][ep=000] loss=0.6686 acc=63.77%
[TRAIN][ep=000] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0415
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4515 mb_mean=0.4949 norm_overlap=1.0000 corr_cb=0.0438 topkJ=0.0912
[TRAIN][ep=001] loss=0.6628 acc=63.77%
[TRAIN][ep=001] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0393
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4501 mb_mean=0.4947 norm_overlap=1.0000 corr_cb=0.0147 topkJ=0.0889
[TRAIN][ep=002] loss=0.6586 acc=63.77%
[TRAIN][ep=002] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0412
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4523 mb_mean=0.4943 norm_overlap=1.0001 corr_cb=0.1587 topkJ=0.0969
[TRAIN][ep=003] loss=0.6564 acc=63.77%
[TRAIN][ep=003] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0415
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4502 mb_mean=0.4945 norm_overlap=0.9999 corr_cb=-0.0905 topkJ=0.0338
[TRAIN][ep=004] loss=0.6548 acc=63.77%
[TRAIN][ep=004] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0389
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4510 mb_mean=0.4956 norm_overlap=1.0001 corr_cb=0.0918 topkJ=0.0948
[TRAIN][ep=005] loss=0.6537 acc=63.77%
[TRAIN][ep=005] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0387
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4523 mb_mean=0.4929 norm_overlap=1.0000 corr_cb=-0.0175 topkJ=0.0527
[TRAIN][ep=006] loss=0.6527 acc=63.77%
[TRAIN][ep=006] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0407
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4503 mb_mean=0.4943 norm_overlap=0.9999 corr_cb=-0.0701 topkJ=0.0588
[TRAIN][ep=007] loss=0.6516 acc=63.77%
[TRAIN][ep=007] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0395
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4515 mb_mean=0.4937 norm_overlap=1.0000 corr_cb=0.0577 topkJ=0.0890
[TRAIN][ep=008] loss=0.6511 acc=63.77%
[TRAIN][ep=008] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0414
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4511 mb_mean=0.4927 norm_overlap=1.0000 corr_cb=0.0201 topkJ=0.0884
[TRAIN][ep=009] loss=0.6495 acc=63.77%
[TRAIN][ep=009] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0422
================= FIT START (fold=2) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.35 select_by=val_score | eval_thr_mode=best_acc eval_thr_grid=coarse | disease_pos_weight_mode=none freeze_b_after=15 | two_stage=True stage1_ratio=0.35 stage2_lr_mult=0.3 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4516 mb_mean=0.4954 norm_overlap=1.0000 corr_cb=0.0570 topkJ=0.0440
[TRAIN][ep=000] loss=0.6485 acc=63.77%
[TRAIN][ep=000] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0407
[EPOCH 000/089] train: loss=0.6485 acc=63.77% | val: loss=0.6475 acc=77.42% f1=68.18% auc=77.70% val_score=71.7916 val_score_bestthr=111.0593 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.450, mb=0.495, no=1.000, corr=0.041) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* -1000000000000000000.0000 -> 71.7916
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4492 mb_mean=0.4950 norm_overlap=0.9998 corr_cb=-0.1808 topkJ=0.0441
[TRAIN][ep=001] loss=0.6468 acc=63.77%
[TRAIN][ep=001] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0400
[EPOCH 001/089] train: loss=0.6468 acc=63.77% | val: loss=0.6459 acc=75.81% f1=61.54% auc=77.37% val_score=81.9038 val_score_bestthr=105.8383 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.450, mb=0.495, no=1.000, corr=0.040) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 71.7916 -> 81.9038
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4508 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=-0.0404 topkJ=0.0832
[TRAIN][ep=002] loss=0.6455 acc=63.77%
[TRAIN][ep=002] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0410
[EPOCH 002/089] train: loss=0.6455 acc=63.77% | val: loss=0.6446 acc=75.81% f1=61.54% auc=76.70% val_score=81.9133 val_score_bestthr=105.8383 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.450, mb=0.495, no=1.000, corr=0.041) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 81.9038 -> 81.9133
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4487 mb_mean=0.4952 norm_overlap=0.9999 corr_cb=-0.0570 topkJ=0.0462
[TRAIN][ep=003] loss=0.6439 acc=63.77%
[TRAIN][ep=003] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0400
[EPOCH 003/089] train: loss=0.6439 acc=63.77% | val: loss=0.6432 acc=74.19% f1=65.22% auc=76.03% val_score=95.8460 val_score_bestthr=106.3227 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.450, mb=0.495, no=1.000, corr=0.040) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 81.9133 -> 95.8460
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4503 mb_mean=0.4944 norm_overlap=1.0001 corr_cb=0.1213 topkJ=0.0789
[TRAIN][ep=004] loss=0.6428 acc=63.77%
[TRAIN][ep=004] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0380
[EPOCH 004/089] train: loss=0.6428 acc=63.77% | val: loss=0.6419 acc=72.58% f1=65.31% auc=74.92% val_score=75.8743 val_score_bestthr=104.5399 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.450, mb=0.495, no=1.000, corr=0.038) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 95.8460 -> 75.8743
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4518 mb_mean=0.4941 norm_overlap=1.0000 corr_cb=-0.0020 topkJ=0.0603
[TRAIN][ep=005] loss=2.6488 acc=63.77%
[TRAIN][ep=005] mask_avg: mc_mean=0.4469 mb_mean=0.4900 norm_overlap=0.9999 corr_cb=-0.0589
[EPOCH 005/089] train: loss=2.6488 acc=63.77% | val: loss=0.6450 acc=77.42% f1=65.00% auc=78.15% val_score=89.5431 val_score_bestthr=109.0642 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.447, mb=0.490, no=1.000, corr=-0.059) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 95.8460 -> 89.5431
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4430 mb_mean=0.4844 norm_overlap=0.9999 corr_cb=-0.1271 topkJ=0.0227
[TRAIN][ep=006] loss=1.7355 acc=63.77%
[TRAIN][ep=006] mask_avg: mc_mean=0.4387 mb_mean=0.4797 norm_overlap=1.0000 corr_cb=-0.0230
[EPOCH 006/089] train: loss=1.7355 acc=63.77% | val: loss=0.6428 acc=75.81% f1=59.46% auc=78.26% val_score=104.8367 val_score_bestthr=104.8367 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.439, mb=0.480, no=1.000, corr=-0.023) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 95.8460 -> 104.8367
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4349 mb_mean=0.4726 norm_overlap=1.0001 corr_cb=0.1191 topkJ=0.0683
[TRAIN][ep=007] loss=0.8424 acc=63.77%
[TRAIN][ep=007] mask_avg: mc_mean=0.4289 mb_mean=0.4678 norm_overlap=1.0002 corr_cb=0.1205
[EPOCH 007/089] train: loss=0.8424 acc=63.77% | val: loss=0.6410 acc=75.81% f1=61.54% auc=77.48% val_score=102.2972 val_score_bestthr=105.8383 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.429, mb=0.468, no=1.000, corr=0.120) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 104.8367 -> 102.2972
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4224 mb_mean=0.4602 norm_overlap=1.0005 corr_cb=0.3230 topkJ=0.0933
[TRAIN][ep=008] loss=0.5781 acc=63.77%
[TRAIN][ep=008] mask_avg: mc_mean=0.4177 mb_mean=0.4535 norm_overlap=1.0004 corr_cb=0.1897
[EPOCH 008/089] train: loss=0.5781 acc=63.77% | val: loss=0.6396 acc=75.81% f1=61.54% auc=77.03% val_score=100.0574 val_score_bestthr=105.8383 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.418, mb=0.453, no=1.000, corr=0.190) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 104.8367 -> 100.0574
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4147 mb_mean=0.4491 norm_overlap=1.0004 corr_cb=0.1489 topkJ=0.0617
[TRAIN][ep=009] loss=0.5735 acc=63.77%
[TRAIN][ep=009] mask_avg: mc_mean=0.4055 mb_mean=0.4361 norm_overlap=1.0009 corr_cb=0.2261
[EPOCH 009/089] train: loss=0.5735 acc=63.77% | val: loss=0.6379 acc=74.19% f1=63.64% auc=75.92% val_score=100.0574 val_score_bestthr=105.5917 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.405, mb=0.436, no=1.001, corr=0.226) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 104.8367 -> 100.0574
[DBG][ep=010] disease_pos_weight=1.0000 mode=none
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.4003 mb_mean=0.4274 norm_overlap=1.0006 corr_cb=0.1218 topkJ=0.0314
[TRAIN][ep=010] loss=0.5692 acc=63.77%
[TRAIN][ep=010] mask_avg: mc_mean=0.3927 mb_mean=0.4153 norm_overlap=1.0017 corr_cb=0.2525
[EPOCH 010/089] train: loss=0.5692 acc=63.77% | val: loss=0.6361 acc=70.97% f1=60.87% auc=74.58% val_score=97.1845 val_score_bestthr=100.9541 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.393, mb=0.415, no=1.002, corr=0.252) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 104.8367 -> 97.1845
[DBG][ep=011] disease_pos_weight=1.0000 mode=none
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.3822 mb_mean=0.3988 norm_overlap=1.0025 corr_cb=0.2976 topkJ=0.0581
[TRAIN][ep=011] loss=0.5636 acc=63.77%
[TRAIN][ep=011] mask_avg: mc_mean=0.3794 mb_mean=0.3916 norm_overlap=1.0021 corr_cb=0.1804
[EPOCH 011/089] train: loss=0.5636 acc=63.77% | val: loss=0.6336 acc=72.58% f1=48.48% auc=73.36% val_score=97.5367 val_score_bestthr=95.8932 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.379, mb=0.392, no=1.002, corr=0.180) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 104.8367 -> 97.5367
[DBG][ep=012] disease_pos_weight=1.0000 mode=none
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.3744 mb_mean=0.3862 norm_overlap=1.0031 corr_cb=0.2211 topkJ=0.0337
[TRAIN][ep=012] loss=0.5587 acc=63.77%
[TRAIN][ep=012] mask_avg: mc_mean=0.3662 mb_mean=0.3667 norm_overlap=1.0013 corr_cb=0.0654
[EPOCH 012/089] train: loss=0.5587 acc=63.77% | val: loss=0.6313 acc=72.58% f1=48.48% auc=72.24% val_score=92.3401 val_score_bestthr=95.8932 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.366, mb=0.367, no=1.001, corr=0.065) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 104.8367 -> 92.3401
[DBG][ep=013] disease_pos_weight=1.0000 mode=none
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.3629 mb_mean=0.3566 norm_overlap=0.9968 corr_cb=-0.1453 topkJ=0.0158
[TRAIN][ep=013] loss=0.5510 acc=63.95%
[TRAIN][ep=013] mask_avg: mc_mean=0.3540 mb_mean=0.3428 norm_overlap=0.9976 corr_cb=-0.0752
[EPOCH 013/089] train: loss=0.5510 acc=63.95% | val: loss=0.6285 acc=72.58% f1=48.48% auc=70.79% val_score=101.3341 val_score_bestthr=95.8932 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.354, mb=0.343, no=0.998, corr=-0.075) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 104.8367 -> 101.3341
[DBG][ep=014] disease_pos_weight=1.0000 mode=none
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.3543 mb_mean=0.3440 norm_overlap=0.9868 corr_cb=-0.3886 topkJ=0.0054
[TRAIN][ep=014] loss=0.5445 acc=63.95%
[TRAIN][ep=014] mask_avg: mc_mean=0.3417 mb_mean=0.3206 norm_overlap=0.9871 corr_cb=-0.2593
[EPOCH 014/089] train: loss=0.5445 acc=63.95% | val: loss=0.6258 acc=70.97% f1=47.06% auc=69.57% val_score=96.7981 val_score_bestthr=93.5917 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.342, mb=0.321, no=0.987, corr=-0.259) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 104.8367 -> 96.7981
[DBG][ep=015] disease_pos_weight=1.0000 mode=none
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.3360 mb_mean=0.3140 norm_overlap=0.9851 corr_cb=-0.3065 topkJ=0.0074
[TRAIN][ep=015] loss=0.5377 acc=64.13%
[TRAIN][ep=015] mask_avg: mc_mean=0.3315 mb_mean=0.3099 norm_overlap=0.9763 corr_cb=-0.3756
[EPOCH 015/089] train: loss=0.5377 acc=64.13% | val: loss=0.6218 acc=70.97% f1=47.06% auc=69.57% val_score=94.5726 val_score_bestthr=93.5917 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.332, mb=0.310, no=0.976, corr=-0.376) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 94.5726
[DBG][ep=016] disease_pos_weight=1.0000 mode=none
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.3076 mb_mean=0.2857 norm_overlap=0.9887 corr_cb=-0.0916 topkJ=0.0206
[TRAIN][ep=016] loss=0.5310 acc=65.22%
[TRAIN][ep=016] mask_avg: mc_mean=0.3218 mb_mean=0.3099 norm_overlap=0.9688 corr_cb=-0.4209
[EPOCH 016/089] train: loss=0.5310 acc=65.22% | val: loss=0.6185 acc=69.35% f1=57.78% auc=68.78% val_score=95.2841 val_score_bestthr=96.8792 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.322, mb=0.310, no=0.969, corr=-0.421) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 95.2841
[DBG][ep=017] disease_pos_weight=1.0000 mode=none
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.3088 mb_mean=0.3051 norm_overlap=0.9724 corr_cb=-0.3007 topkJ=0.0029
[TRAIN][ep=017] loss=0.5253 acc=66.12%
[TRAIN][ep=017] mask_avg: mc_mean=0.3141 mb_mean=0.3099 norm_overlap=0.9616 corr_cb=-0.4569
[EPOCH 017/089] train: loss=0.5253 acc=66.12% | val: loss=0.6155 acc=69.35% f1=59.57% auc=69.45% val_score=95.7411 val_score_bestthr=98.0036 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.314, mb=0.310, no=0.962, corr=-0.457) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 95.7411
[DBG][ep=018] disease_pos_weight=1.0000 mode=none
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.3120 mb_mean=0.3163 norm_overlap=0.9583 corr_cb=-0.4983 topkJ=0.0000
[TRAIN][ep=018] loss=0.5187 acc=66.30%
[TRAIN][ep=018] mask_avg: mc_mean=0.3075 mb_mean=0.3099 norm_overlap=0.9567 corr_cb=-0.4673
[EPOCH 018/089] train: loss=0.5187 acc=66.30% | val: loss=0.6115 acc=69.35% f1=59.57% auc=69.12% val_score=92.2030 val_score_bestthr=98.0869 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.307, mb=0.310, no=0.957, corr=-0.467) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 92.2030
[DBG][ep=019] disease_pos_weight=1.0000 mode=none
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.3061 mb_mean=0.3157 norm_overlap=0.9578 corr_cb=-0.4452 topkJ=0.0008
[TRAIN][ep=019] loss=0.5131 acc=66.67%
[TRAIN][ep=019] mask_avg: mc_mean=0.3013 mb_mean=0.3099 norm_overlap=0.9501 corr_cb=-0.4828
[EPOCH 019/089] train: loss=0.5131 acc=66.67% | val: loss=0.6103 acc=69.35% f1=57.78% auc=68.78% val_score=92.2030 val_score_bestthr=97.1084 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.301, mb=0.310, no=0.950, corr=-0.483) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 92.2030
[DBG][ep=020] disease_pos_weight=1.0000 mode=none
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.3010 mb_mean=0.3103 norm_overlap=0.9365 corr_cb=-0.5935 topkJ=0.0008
[TRAIN][ep=020] loss=0.5057 acc=67.21%
[TRAIN][ep=020] mask_avg: mc_mean=0.2971 mb_mean=0.3099 norm_overlap=0.9454 corr_cb=-0.4939
[EPOCH 020/089] train: loss=0.5057 acc=67.21% | val: loss=0.6076 acc=67.74% f1=58.33% auc=68.78% val_score=92.2030 val_score_bestthr=95.8916 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.297, mb=0.310, no=0.945, corr=-0.494) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 92.2030
[DBG][ep=021] disease_pos_weight=1.0000 mode=none
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2827 mb_mean=0.3059 norm_overlap=0.9485 corr_cb=-0.3989 topkJ=0.0024
[TRAIN][ep=021] loss=0.4990 acc=68.30%
[TRAIN][ep=021] mask_avg: mc_mean=0.2924 mb_mean=0.3099 norm_overlap=0.9405 corr_cb=-0.4987
[EPOCH 021/089] train: loss=0.4990 acc=68.30% | val: loss=0.6070 acc=67.74% f1=56.52% auc=69.23% val_score=91.4390 val_score_bestthr=94.9544 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.292, mb=0.310, no=0.941, corr=-0.499) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 91.4390
[DBG][ep=022] disease_pos_weight=1.0000 mode=none
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2904 mb_mean=0.3131 norm_overlap=0.9353 corr_cb=-0.5292 topkJ=0.0008
[TRAIN][ep=022] loss=0.4913 acc=70.47%
[TRAIN][ep=022] mask_avg: mc_mean=0.2890 mb_mean=0.3099 norm_overlap=0.9358 corr_cb=-0.5092
[EPOCH 022/089] train: loss=0.4913 acc=70.47% | val: loss=0.6056 acc=69.35% f1=55.81% auc=68.78% val_score=91.4390 val_score_bestthr=96.5670 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.289, mb=0.310, no=0.936, corr=-0.509) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 91.4390
[DBG][ep=023] disease_pos_weight=1.0000 mode=none
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2896 mb_mean=0.2996 norm_overlap=0.9134 corr_cb=-0.5730 topkJ=0.0000
[TRAIN][ep=023] loss=0.4841 acc=70.47%
[TRAIN][ep=023] mask_avg: mc_mean=0.2855 mb_mean=0.3099 norm_overlap=0.9325 corr_cb=-0.5058
[EPOCH 023/089] train: loss=0.4841 acc=70.47% | val: loss=0.6072 acc=69.35% f1=55.81% auc=68.78% val_score=94.4893 val_score_bestthr=96.5670 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.285, mb=0.310, no=0.933, corr=-0.506) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 94.4893
[DBG][ep=024] disease_pos_weight=1.0000 mode=none
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2876 mb_mean=0.3147 norm_overlap=0.9176 corr_cb=-0.6213 topkJ=0.0000
[TRAIN][ep=024] loss=0.4792 acc=72.10%
[TRAIN][ep=024] mask_avg: mc_mean=0.2822 mb_mean=0.3099 norm_overlap=0.9285 corr_cb=-0.5110
[EPOCH 024/089] train: loss=0.4792 acc=72.10% | val: loss=0.6142 acc=69.35% f1=57.78% auc=68.12% val_score=97.1709 val_score_bestthr=97.1709 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.282, mb=0.310, no=0.928, corr=-0.511) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 97.1709
[DBG][ep=025] disease_pos_weight=1.0000 mode=none
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2902 mb_mean=0.3086 norm_overlap=0.8996 corr_cb=-0.6781 topkJ=0.0000
[TRAIN][ep=025] loss=0.4726 acc=72.28%
[TRAIN][ep=025] mask_avg: mc_mean=0.2793 mb_mean=0.3099 norm_overlap=0.9245 corr_cb=-0.5158
[EPOCH 025/089] train: loss=0.4726 acc=72.28% | val: loss=0.6181 acc=70.97% f1=50.00% auc=67.89% val_score=94.9544 val_score_bestthr=95.0010 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.279, mb=0.310, no=0.925, corr=-0.516) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 94.9544
[DBG][ep=026] disease_pos_weight=1.0000 mode=none
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2764 mb_mean=0.3061 norm_overlap=0.9090 corr_cb=-0.5843 topkJ=0.0000
[TRAIN][ep=026] loss=0.4674 acc=72.28%
[TRAIN][ep=026] mask_avg: mc_mean=0.2764 mb_mean=0.3099 norm_overlap=0.9230 corr_cb=-0.5061
[EPOCH 026/089] train: loss=0.4674 acc=72.28% | val: loss=0.6143 acc=69.35% f1=59.57% auc=68.12% val_score=90.0882 val_score_bestthr=98.1494 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.276, mb=0.310, no=0.923, corr=-0.506) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 90.0882
[DBG][ep=027] disease_pos_weight=1.0000 mode=none
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2671 mb_mean=0.3155 norm_overlap=0.9510 corr_cb=-0.3171 topkJ=0.0012
[TRAIN][ep=027] loss=0.4589 acc=73.73%
[TRAIN][ep=027] mask_avg: mc_mean=0.2737 mb_mean=0.3099 norm_overlap=0.9183 corr_cb=-0.5153
[EPOCH 027/089] train: loss=0.4589 acc=73.73% | val: loss=0.6243 acc=69.35% f1=29.63% auc=67.11% val_score=84.3797 val_score_bestthr=83.5385 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.274, mb=0.310, no=0.918, corr=-0.515) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 84.3797
[DBG][ep=028] disease_pos_weight=1.0000 mode=none
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2704 mb_mean=0.3200 norm_overlap=0.9204 corr_cb=-0.5480 topkJ=0.0000
[TRAIN][ep=028] loss=0.4542 acc=73.55%
[TRAIN][ep=028] mask_avg: mc_mean=0.2718 mb_mean=0.3099 norm_overlap=0.9152 corr_cb=-0.5200
[EPOCH 028/089] train: loss=0.4542 acc=73.55% | val: loss=0.6218 acc=67.74% f1=60.00% auc=67.11% val_score=87.9226 val_score_bestthr=96.7148 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.272, mb=0.310, no=0.915, corr=-0.520) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 87.9226
[DBG][ep=029] disease_pos_weight=1.0000 mode=none
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2764 mb_mean=0.3132 norm_overlap=0.9099 corr_cb=-0.5573 topkJ=0.0008
[TRAIN][ep=029] loss=0.4441 acc=74.09%
[TRAIN][ep=029] mask_avg: mc_mean=0.2695 mb_mean=0.3099 norm_overlap=0.9124 corr_cb=-0.5237
[EPOCH 029/089] train: loss=0.4441 acc=74.09% | val: loss=0.6264 acc=69.35% f1=29.63% auc=66.33% val_score=87.9226 val_score_bestthr=83.5385 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.270, mb=0.310, no=0.912, corr=-0.524) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 87.9226
[DBG][ep=030] disease_pos_weight=1.0000 mode=none
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2687 mb_mean=0.3071 norm_overlap=0.9407 corr_cb=-0.4055 topkJ=0.0013
[TRAIN][ep=030] loss=0.4391 acc=75.18%
[TRAIN][ep=030] mask_avg: mc_mean=0.2668 mb_mean=0.3099 norm_overlap=0.9109 corr_cb=-0.5176
[EPOCH 030/089] train: loss=0.4391 acc=75.18% | val: loss=0.6330 acc=67.74% f1=54.55% auc=66.33% val_score=90.1507 val_score_bestthr=94.3280 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.267, mb=0.310, no=0.911, corr=-0.518) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 90.1507
[DBG][ep=031] disease_pos_weight=1.0000 mode=none
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2659 mb_mean=0.3193 norm_overlap=0.9305 corr_cb=-0.4158 topkJ=0.0004
[TRAIN][ep=031] loss=0.4291 acc=75.54%
[TRAIN][ep=031] mask_avg: mc_mean=0.2654 mb_mean=0.3100 norm_overlap=0.9086 corr_cb=-0.5249
[EPOCH 031/089] train: loss=0.4291 acc=75.54% | val: loss=0.6347 acc=69.35% f1=48.65% auc=65.66% val_score=92.3489 val_score_bestthr=92.8775 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.265, mb=0.310, no=0.909, corr=-0.525) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 92.3489
[DBG][ep=032] disease_pos_weight=1.0000 mode=none
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2725 mb_mean=0.3151 norm_overlap=0.9109 corr_cb=-0.5611 topkJ=0.0000
[TRAIN][ep=032] loss=0.4286 acc=76.27%
[TRAIN][ep=032] mask_avg: mc_mean=0.2654 mb_mean=0.3099 norm_overlap=0.9086 corr_cb=-0.5224
[EPOCH 032/089] train: loss=0.4286 acc=76.27% | val: loss=0.6359 acc=67.74% f1=54.55% auc=65.33% val_score=92.3489 val_score_bestthr=94.3280 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.265, mb=0.310, no=0.909, corr=-0.522) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 92.3489
[DBG][ep=033] disease_pos_weight=1.0000 mode=none
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2733 mb_mean=0.3098 norm_overlap=0.8818 corr_cb=-0.6385 topkJ=0.0004
[TRAIN][ep=033] loss=0.4266 acc=75.36%
[TRAIN][ep=033] mask_avg: mc_mean=0.2655 mb_mean=0.3099 norm_overlap=0.9086 corr_cb=-0.5242
[EPOCH 033/089] train: loss=0.4266 acc=75.36% | val: loss=0.6368 acc=67.74% f1=54.55% auc=65.33% val_score=92.3489 val_score_bestthr=94.3280 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.265, mb=0.310, no=0.909, corr=-0.524) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 92.3489
[DBG][ep=034] disease_pos_weight=1.0000 mode=none
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2688 mb_mean=0.3119 norm_overlap=0.8861 corr_cb=-0.6394 topkJ=0.0000
[TRAIN][ep=034] loss=0.4250 acc=76.27%
[TRAIN][ep=034] mask_avg: mc_mean=0.2655 mb_mean=0.3099 norm_overlap=0.9085 corr_cb=-0.5252
[EPOCH 034/089] train: loss=0.4250 acc=76.27% | val: loss=0.6386 acc=67.74% f1=54.55% auc=65.33% val_score=92.3489 val_score_bestthr=94.3280 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.265, mb=0.310, no=0.908, corr=-0.525) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 92.3489
[DBG][ep=035] disease_pos_weight=1.0000 mode=none
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2714 mb_mean=0.3059 norm_overlap=0.8933 corr_cb=-0.5714 topkJ=0.0008
[TRAIN][ep=035] loss=0.4232 acc=75.54%
[TRAIN][ep=035] mask_avg: mc_mean=0.2655 mb_mean=0.3099 norm_overlap=0.9085 corr_cb=-0.5235
[EPOCH 035/089] train: loss=0.4232 acc=75.54% | val: loss=0.6399 acc=67.74% f1=54.55% auc=64.77% val_score=90.1507 val_score_bestthr=94.3280 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.265, mb=0.310, no=0.909, corr=-0.524) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 90.1507
[DBG][ep=036] disease_pos_weight=1.0000 mode=none
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2722 mb_mean=0.2908 norm_overlap=0.8743 corr_cb=-0.5942 topkJ=0.0004
[TRAIN][ep=036] loss=0.4218 acc=76.27%
[TRAIN][ep=036] mask_avg: mc_mean=0.2655 mb_mean=0.3099 norm_overlap=0.9084 corr_cb=-0.5249
[EPOCH 036/089] train: loss=0.4218 acc=76.27% | val: loss=0.6409 acc=67.74% f1=54.55% auc=64.66% val_score=92.3489 val_score_bestthr=94.3280 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.265, mb=0.310, no=0.908, corr=-0.525) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 92.3489
[EARLY STOP] no improvement for 30 epochs. best_epoch=6
[CKPT] Loaded best for testing: results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
=============== FIT DONE ===============
[BEST] epoch=6 | val_acc=75.81% | val_f1=59.46% | val_auc=78.26% | val_score=104.8367 | val_score_bestthr=104.8367
[TEST@BEST] thr_used=0.370 | acc=63.40% f1=9.68% auc=58.52% | SP_sex=3.71% EO_sex=3.04% SP_age=3.67% EO_age=16.67%
[TIME] 0.63 min
[OK] Saved: results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/summary_fold_2.json
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4496 mb_mean=0.4946 norm_overlap=1.0001 corr_cb=0.1679 topkJ=0.0819
[TRAIN][ep=000] loss=0.6686 acc=63.77%
[TRAIN][ep=000] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0415
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4515 mb_mean=0.4949 norm_overlap=1.0000 corr_cb=0.0438 topkJ=0.0912
[TRAIN][ep=001] loss=0.6628 acc=63.77%
[TRAIN][ep=001] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0393
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4501 mb_mean=0.4947 norm_overlap=1.0000 corr_cb=0.0147 topkJ=0.0889
[TRAIN][ep=002] loss=0.6586 acc=63.77%
[TRAIN][ep=002] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0412
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4523 mb_mean=0.4943 norm_overlap=1.0001 corr_cb=0.1587 topkJ=0.0969
[TRAIN][ep=003] loss=0.6564 acc=63.77%
[TRAIN][ep=003] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0415
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4502 mb_mean=0.4945 norm_overlap=0.9999 corr_cb=-0.0905 topkJ=0.0338
[TRAIN][ep=004] loss=0.6548 acc=63.77%
[TRAIN][ep=004] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0389
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4510 mb_mean=0.4956 norm_overlap=1.0001 corr_cb=0.0918 topkJ=0.0948
[TRAIN][ep=005] loss=0.6537 acc=63.77%
[TRAIN][ep=005] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0387
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4523 mb_mean=0.4929 norm_overlap=1.0000 corr_cb=-0.0175 topkJ=0.0527
[TRAIN][ep=006] loss=0.6527 acc=63.77%
[TRAIN][ep=006] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0407
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4503 mb_mean=0.4943 norm_overlap=0.9999 corr_cb=-0.0701 topkJ=0.0588
[TRAIN][ep=007] loss=0.6516 acc=63.77%
[TRAIN][ep=007] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0395
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4515 mb_mean=0.4937 norm_overlap=1.0000 corr_cb=0.0577 topkJ=0.0890
[TRAIN][ep=008] loss=0.6511 acc=63.77%
[TRAIN][ep=008] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0414
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4511 mb_mean=0.4927 norm_overlap=1.0000 corr_cb=0.0201 topkJ=0.0884
[TRAIN][ep=009] loss=0.6495 acc=63.77%
[TRAIN][ep=009] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0422
================= FIT START (fold=2) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.35 select_by=val_score | eval_thr_mode=best_acc eval_thr_grid=coarse | disease_pos_weight_mode=none freeze_b_after=15 | two_stage=True stage1_ratio=0.35 stage2_lr_mult=0.3 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4516 mb_mean=0.4954 norm_overlap=1.0000 corr_cb=0.0570 topkJ=0.0440
[TRAIN][ep=000] loss=0.6485 acc=63.77%
[TRAIN][ep=000] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0407
[EPOCH 000/089] train: loss=0.6485 acc=63.77% | val: loss=0.6475 acc=77.42% f1=68.18% auc=77.70% val_score=71.7916 val_score_bestthr=111.0593 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.450, mb=0.495, no=1.000, corr=0.041) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* -1000000000000000000.0000 -> 71.7916
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4492 mb_mean=0.4950 norm_overlap=0.9998 corr_cb=-0.1808 topkJ=0.0441
[TRAIN][ep=001] loss=0.6468 acc=63.77%
[TRAIN][ep=001] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0400
[EPOCH 001/089] train: loss=0.6468 acc=63.77% | val: loss=0.6459 acc=75.81% f1=61.54% auc=77.37% val_score=81.9038 val_score_bestthr=105.8383 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.450, mb=0.495, no=1.000, corr=0.040) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 71.7916 -> 81.9038
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4508 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=-0.0404 topkJ=0.0832
[TRAIN][ep=002] loss=0.6455 acc=63.77%
[TRAIN][ep=002] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0410
[EPOCH 002/089] train: loss=0.6455 acc=63.77% | val: loss=0.6446 acc=75.81% f1=61.54% auc=76.70% val_score=81.9133 val_score_bestthr=105.8383 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.450, mb=0.495, no=1.000, corr=0.041) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 81.9038 -> 81.9133
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4487 mb_mean=0.4952 norm_overlap=0.9999 corr_cb=-0.0570 topkJ=0.0462
[TRAIN][ep=003] loss=0.6439 acc=63.77%
[TRAIN][ep=003] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0400
[EPOCH 003/089] train: loss=0.6439 acc=63.77% | val: loss=0.6432 acc=74.19% f1=65.22% auc=76.03% val_score=95.8460 val_score_bestthr=106.3227 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.450, mb=0.495, no=1.000, corr=0.040) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 81.9133 -> 95.8460
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4503 mb_mean=0.4944 norm_overlap=1.0001 corr_cb=0.1213 topkJ=0.0789
[TRAIN][ep=004] loss=0.6428 acc=63.77%
[TRAIN][ep=004] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0380
[EPOCH 004/089] train: loss=0.6428 acc=63.77% | val: loss=0.6419 acc=72.58% f1=65.31% auc=74.92% val_score=75.8743 val_score_bestthr=104.5399 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.450, mb=0.495, no=1.000, corr=0.038) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 95.8460 -> 75.8743
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4518 mb_mean=0.4941 norm_overlap=1.0000 corr_cb=-0.0020 topkJ=0.0603
[TRAIN][ep=005] loss=1.9030 acc=63.77%
[TRAIN][ep=005] mask_avg: mc_mean=0.4464 mb_mean=0.4863 norm_overlap=1.0000 corr_cb=-0.0438
[EPOCH 005/089] train: loss=1.9030 acc=63.77% | val: loss=0.6445 acc=77.42% f1=63.16% auc=78.04% val_score=97.9107 val_score_bestthr=108.2133 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.446, mb=0.486, no=1.000, corr=-0.044) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 95.8460 -> 97.9107
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4420 mb_mean=0.4768 norm_overlap=0.9999 corr_cb=-0.0847 topkJ=0.0347
[TRAIN][ep=006] loss=1.2927 acc=63.77%
[TRAIN][ep=006] mask_avg: mc_mean=0.4372 mb_mean=0.4673 norm_overlap=1.0001 corr_cb=0.0609
[EPOCH 006/089] train: loss=1.2927 acc=63.77% | val: loss=0.6425 acc=77.42% f1=63.16% auc=78.37% val_score=108.2133 val_score_bestthr=108.2133 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.437, mb=0.467, no=1.000, corr=0.061) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 97.9107 -> 108.2133
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4329 mb_mean=0.4560 norm_overlap=1.0003 corr_cb=0.1832 topkJ=0.0829
[TRAIN][ep=007] loss=0.6932 acc=63.77%
[TRAIN][ep=007] mask_avg: mc_mean=0.4263 mb_mean=0.4448 norm_overlap=1.0007 corr_cb=0.2564
[EPOCH 007/089] train: loss=0.6932 acc=63.77% | val: loss=0.6405 acc=74.19% f1=60.00% auc=77.37% val_score=102.2972 val_score_bestthr=103.4818 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.426, mb=0.445, no=1.001, corr=0.256) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 108.2133 -> 102.2972
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4191 mb_mean=0.4286 norm_overlap=1.0016 corr_cb=0.4936 topkJ=0.1327
[TRAIN][ep=008] loss=0.5742 acc=63.77%
[TRAIN][ep=008] mask_avg: mc_mean=0.4142 mb_mean=0.4175 norm_overlap=1.0015 corr_cb=0.3251
[EPOCH 008/089] train: loss=0.5742 acc=63.77% | val: loss=0.6390 acc=75.81% f1=63.41% auc=76.25% val_score=100.0574 val_score_bestthr=106.9943 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.414, mb=0.418, no=1.001, corr=0.325) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 108.2133 -> 100.0574
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4111 mb_mean=0.4111 norm_overlap=1.0015 corr_cb=0.2952 topkJ=0.0769
[TRAIN][ep=009] loss=0.5686 acc=63.77%
[TRAIN][ep=009] mask_avg: mc_mean=0.4014 mb_mean=0.3867 norm_overlap=1.0026 corr_cb=0.2980
[EPOCH 009/089] train: loss=0.5686 acc=63.77% | val: loss=0.6370 acc=72.58% f1=51.43% auc=74.92% val_score=95.5037 val_score_bestthr=97.2649 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.401, mb=0.387, no=1.003, corr=0.298) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 108.2133 -> 95.5037
[DBG][ep=010] disease_pos_weight=1.0000 mode=none
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.3959 mb_mean=0.3730 norm_overlap=1.0018 corr_cb=0.1590 topkJ=0.0543
[TRAIN][ep=010] loss=0.5639 acc=63.77%
[TRAIN][ep=010] mask_avg: mc_mean=0.3886 mb_mean=0.3560 norm_overlap=1.0033 corr_cb=0.2172
[EPOCH 010/089] train: loss=0.5639 acc=63.77% | val: loss=0.6350 acc=72.58% f1=48.48% auc=73.69% val_score=101.6466 val_score_bestthr=95.8932 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.389, mb=0.356, no=1.003, corr=0.217) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 108.2133 -> 101.6466
[DBG][ep=011] disease_pos_weight=1.0000 mode=none
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.3781 mb_mean=0.3326 norm_overlap=1.0036 corr_cb=0.1815 topkJ=0.0523
[TRAIN][ep=011] loss=0.5579 acc=63.77%
[TRAIN][ep=011] mask_avg: mc_mean=0.3758 mb_mean=0.3287 norm_overlap=1.0005 corr_cb=0.0282
[EPOCH 011/089] train: loss=0.5579 acc=63.77% | val: loss=0.6322 acc=70.97% f1=60.87% auc=72.02% val_score=97.5367 val_score_bestthr=100.7374 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.376, mb=0.329, no=1.001, corr=0.028) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 108.2133 -> 97.5367
[DBG][ep=012] disease_pos_weight=1.0000 mode=none
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.3703 mb_mean=0.3273 norm_overlap=1.0012 corr_cb=0.0402 topkJ=0.0225
[TRAIN][ep=012] loss=0.5528 acc=63.95%
[TRAIN][ep=012] mask_avg: mc_mean=0.3632 mb_mean=0.3056 norm_overlap=0.9920 corr_cb=-0.1916
[EPOCH 012/089] train: loss=0.5528 acc=63.95% | val: loss=0.6296 acc=70.97% f1=60.87% auc=71.35% val_score=92.3401 val_score_bestthr=100.7374 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.363, mb=0.306, no=0.992, corr=-0.192) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 108.2133 -> 92.3401
[DBG][ep=013] disease_pos_weight=1.0000 mode=none
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.3602 mb_mean=0.2986 norm_overlap=0.9801 corr_cb=-0.4194 topkJ=0.0021
[TRAIN][ep=013] loss=0.5440 acc=63.95%
[TRAIN][ep=013] mask_avg: mc_mean=0.3519 mb_mean=0.2863 norm_overlap=0.9749 corr_cb=-0.3957
[EPOCH 013/089] train: loss=0.5440 acc=63.95% | val: loss=0.6268 acc=70.97% f1=47.06% auc=70.01% val_score=98.9757 val_score_bestthr=93.5917 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.352, mb=0.286, no=0.975, corr=-0.396) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 108.2133 -> 98.9757
[DBG][ep=014] disease_pos_weight=1.0000 mode=none
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.3510 mb_mean=0.2940 norm_overlap=0.9533 corr_cb=-0.6442 topkJ=0.0000
[TRAIN][ep=014] loss=0.5363 acc=64.13%
[TRAIN][ep=014] mask_avg: mc_mean=0.3402 mb_mean=0.2695 norm_overlap=0.9423 corr_cb=-0.5751
[EPOCH 014/089] train: loss=0.5363 acc=64.13% | val: loss=0.6241 acc=70.97% f1=47.06% auc=69.01% val_score=96.7981 val_score_bestthr=93.5917 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.340, mb=0.270, no=0.942, corr=-0.575) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 108.2133 -> 96.7981
[DBG][ep=015] disease_pos_weight=1.0000 mode=none
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.3336 mb_mean=0.2671 norm_overlap=0.9375 corr_cb=-0.6273 topkJ=0.0000
[TRAIN][ep=015] loss=0.5279 acc=65.04%
[TRAIN][ep=015] mask_avg: mc_mean=0.3309 mb_mean=0.2618 norm_overlap=0.9115 corr_cb=-0.6698
[EPOCH 015/089] train: loss=0.5279 acc=65.04% | val: loss=0.6199 acc=70.97% f1=47.06% auc=69.01% val_score=94.5726 val_score_bestthr=93.5917 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.331, mb=0.262, no=0.912, corr=-0.670) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 94.5726
[DBG][ep=016] disease_pos_weight=1.0000 mode=none
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.3119 mb_mean=0.2379 norm_overlap=0.8997 corr_cb=-0.4581 topkJ=0.0000
[TRAIN][ep=016] loss=0.5200 acc=66.30%
[TRAIN][ep=016] mask_avg: mc_mean=0.3227 mb_mean=0.2618 norm_overlap=0.8904 corr_cb=-0.6952
[EPOCH 016/089] train: loss=0.5200 acc=66.30% | val: loss=0.6169 acc=70.97% f1=47.06% auc=68.23% val_score=95.2841 val_score_bestthr=93.5917 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.323, mb=0.262, no=0.890, corr=-0.695) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 95.2841
[DBG][ep=017] disease_pos_weight=1.0000 mode=none
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.3087 mb_mean=0.2556 norm_overlap=0.8879 corr_cb=-0.5961 topkJ=0.0000
[TRAIN][ep=017] loss=0.5134 acc=66.30%
[TRAIN][ep=017] mask_avg: mc_mean=0.3166 mb_mean=0.2618 norm_overlap=0.8703 corr_cb=-0.7130
[EPOCH 017/089] train: loss=0.5134 acc=66.30% | val: loss=0.6141 acc=70.97% f1=60.87% auc=68.34% val_score=93.5574 val_score_bestthr=100.3416 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.317, mb=0.262, no=0.870, corr=-0.713) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 93.5574
[DBG][ep=018] disease_pos_weight=1.0000 mode=none
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.3127 mb_mean=0.2717 norm_overlap=0.8627 corr_cb=-0.7294 topkJ=0.0000
[TRAIN][ep=018] loss=0.5061 acc=67.21%
[TRAIN][ep=018] mask_avg: mc_mean=0.3119 mb_mean=0.2618 norm_overlap=0.8563 corr_cb=-0.7112
[EPOCH 018/089] train: loss=0.5061 acc=67.21% | val: loss=0.6102 acc=69.35% f1=59.57% auc=68.45% val_score=92.2030 val_score_bestthr=98.0869 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.312, mb=0.262, no=0.856, corr=-0.711) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 92.2030
[DBG][ep=019] disease_pos_weight=1.0000 mode=none
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.3092 mb_mean=0.2693 norm_overlap=0.8559 corr_cb=-0.6963 topkJ=0.0000
[TRAIN][ep=019] loss=0.5000 acc=67.03%
[TRAIN][ep=019] mask_avg: mc_mean=0.3075 mb_mean=0.2618 norm_overlap=0.8394 corr_cb=-0.7149
[EPOCH 019/089] train: loss=0.5000 acc=67.03% | val: loss=0.6095 acc=67.74% f1=58.33% auc=68.67% val_score=92.2030 val_score_bestthr=95.8244 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.307, mb=0.262, no=0.839, corr=-0.715) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 92.2030
[DBG][ep=020] disease_pos_weight=1.0000 mode=none
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.3086 mb_mean=0.2637 norm_overlap=0.8062 corr_cb=-0.7913 topkJ=0.0000
[TRAIN][ep=020] loss=0.4917 acc=67.39%
[TRAIN][ep=020] mask_avg: mc_mean=0.3046 mb_mean=0.2618 norm_overlap=0.8272 corr_cb=-0.7150
[EPOCH 020/089] train: loss=0.4917 acc=67.39% | val: loss=0.6071 acc=69.35% f1=53.66% auc=68.90% val_score=92.2030 val_score_bestthr=95.0988 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.305, mb=0.262, no=0.827, corr=-0.715) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 92.2030
[DBG][ep=021] disease_pos_weight=1.0000 mode=none
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2863 mb_mean=0.2563 norm_overlap=0.8374 corr_cb=-0.6217 topkJ=0.0000
[TRAIN][ep=021] loss=0.4845 acc=68.66%
[TRAIN][ep=021] mask_avg: mc_mean=0.3009 mb_mean=0.2618 norm_overlap=0.8152 corr_cb=-0.7117
[EPOCH 021/089] train: loss=0.4845 acc=68.66% | val: loss=0.6070 acc=69.35% f1=55.81% auc=68.45% val_score=91.4390 val_score_bestthr=96.5670 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.301, mb=0.262, no=0.815, corr=-0.712) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 91.4390
[DBG][ep=022] disease_pos_weight=1.0000 mode=none
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2979 mb_mean=0.2666 norm_overlap=0.8007 corr_cb=-0.7258 topkJ=0.0000
[TRAIN][ep=022] loss=0.4764 acc=70.47%
[TRAIN][ep=022] mask_avg: mc_mean=0.2983 mb_mean=0.2618 norm_overlap=0.8037 corr_cb=-0.7130
[EPOCH 022/089] train: loss=0.4764 acc=70.47% | val: loss=0.6059 acc=69.35% f1=55.81% auc=68.45% val_score=91.4390 val_score_bestthr=96.5670 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.298, mb=0.262, no=0.804, corr=-0.713) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 91.4390
[DBG][ep=023] disease_pos_weight=1.0000 mode=none
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.3027 mb_mean=0.2497 norm_overlap=0.7569 corr_cb=-0.7399 topkJ=0.0000
[TRAIN][ep=023] loss=0.4687 acc=70.65%
[TRAIN][ep=023] mask_avg: mc_mean=0.2954 mb_mean=0.2618 norm_overlap=0.7951 corr_cb=-0.7062
[EPOCH 023/089] train: loss=0.4687 acc=70.65% | val: loss=0.6078 acc=69.35% f1=55.81% auc=68.23% val_score=91.4390 val_score_bestthr=96.5670 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.295, mb=0.262, no=0.795, corr=-0.706) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 91.4390
[DBG][ep=024] disease_pos_weight=1.0000 mode=none
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2960 mb_mean=0.2671 norm_overlap=0.7788 corr_cb=-0.7676 topkJ=0.0000
[TRAIN][ep=024] loss=0.4635 acc=71.92%
[TRAIN][ep=024] mask_avg: mc_mean=0.2927 mb_mean=0.2618 norm_overlap=0.7857 corr_cb=-0.7065
[EPOCH 024/089] train: loss=0.4635 acc=71.92% | val: loss=0.6152 acc=69.35% f1=55.81% auc=67.45% val_score=94.9544 val_score_bestthr=96.5670 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.293, mb=0.262, no=0.786, corr=-0.707) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 94.9544
[DBG][ep=025] disease_pos_weight=1.0000 mode=none
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.3040 mb_mean=0.2600 norm_overlap=0.7347 corr_cb=-0.8123 topkJ=0.0000
[TRAIN][ep=025] loss=0.4562 acc=72.64%
[TRAIN][ep=025] mask_avg: mc_mean=0.2900 mb_mean=0.2618 norm_overlap=0.7764 corr_cb=-0.7070
[EPOCH 025/089] train: loss=0.4562 acc=72.64% | val: loss=0.6193 acc=69.35% f1=55.81% auc=67.00% val_score=94.9544 val_score_bestthr=96.5670 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.290, mb=0.262, no=0.776, corr=-0.707) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 94.9544
[DBG][ep=026] disease_pos_weight=1.0000 mode=none
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2860 mb_mean=0.2587 norm_overlap=0.7446 corr_cb=-0.7352 topkJ=0.0000
[TRAIN][ep=026] loss=0.4509 acc=73.01%
[TRAIN][ep=026] mask_avg: mc_mean=0.2875 mb_mean=0.2618 norm_overlap=0.7708 corr_cb=-0.6977
[EPOCH 026/089] train: loss=0.4509 acc=73.01% | val: loss=0.6158 acc=69.35% f1=59.57% auc=67.00% val_score=89.1807 val_score_bestthr=98.1494 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.288, mb=0.262, no=0.771, corr=-0.698) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 89.1807
[DBG][ep=027] disease_pos_weight=1.0000 mode=none
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2731 mb_mean=0.2684 norm_overlap=0.8125 corr_cb=-0.5620 topkJ=0.0000
[TRAIN][ep=027] loss=0.4416 acc=74.64%
[TRAIN][ep=027] mask_avg: mc_mean=0.2852 mb_mean=0.2618 norm_overlap=0.7608 corr_cb=-0.7026
[EPOCH 027/089] train: loss=0.4416 acc=74.64% | val: loss=0.6258 acc=69.35% f1=29.63% auc=66.00% val_score=84.3797 val_score_bestthr=83.5385 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.285, mb=0.262, no=0.761, corr=-0.703) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 84.3797
[DBG][ep=028] disease_pos_weight=1.0000 mode=none
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2782 mb_mean=0.2716 norm_overlap=0.7722 corr_cb=-0.7280 topkJ=0.0000
[TRAIN][ep=028] loss=0.4367 acc=74.09%
[TRAIN][ep=028] mask_avg: mc_mean=0.2830 mb_mean=0.2618 norm_overlap=0.7537 corr_cb=-0.7024
[EPOCH 028/089] train: loss=0.4367 acc=74.09% | val: loss=0.6232 acc=70.97% f1=50.00% auc=66.56% val_score=84.9214 val_score_bestthr=95.1280 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.283, mb=0.262, no=0.754, corr=-0.702) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 84.9214
[DBG][ep=029] disease_pos_weight=1.0000 mode=none
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2907 mb_mean=0.2659 norm_overlap=0.7513 corr_cb=-0.7416 topkJ=0.0000
[TRAIN][ep=029] loss=0.4262 acc=74.46%
[TRAIN][ep=029] mask_avg: mc_mean=0.2808 mb_mean=0.2618 norm_overlap=0.7473 corr_cb=-0.7017
[EPOCH 029/089] train: loss=0.4262 acc=74.46% | val: loss=0.6279 acc=69.35% f1=48.65% auc=65.44% val_score=90.8076 val_score_bestthr=92.8150 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.281, mb=0.262, no=0.747, corr=-0.702) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 90.8076
[DBG][ep=030] disease_pos_weight=1.0000 mode=none
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2785 mb_mean=0.2567 norm_overlap=0.7933 corr_cb=-0.6314 topkJ=0.0000
[TRAIN][ep=030] loss=0.4207 acc=75.91%
[TRAIN][ep=030] mask_avg: mc_mean=0.2779 mb_mean=0.2618 norm_overlap=0.7423 corr_cb=-0.6981
[EPOCH 030/089] train: loss=0.4207 acc=75.91% | val: loss=0.6344 acc=69.35% f1=42.42% auc=65.66% val_score=87.1500 val_score_bestthr=90.0831 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.278, mb=0.262, no=0.742, corr=-0.698) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 87.1500
[DBG][ep=031] disease_pos_weight=1.0000 mode=none
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2764 mb_mean=0.2726 norm_overlap=0.7756 corr_cb=-0.6445 topkJ=0.0000
[TRAIN][ep=031] loss=0.4104 acc=76.27%
[TRAIN][ep=031] mask_avg: mc_mean=0.2766 mb_mean=0.2618 norm_overlap=0.7373 corr_cb=-0.7030
[EPOCH 031/089] train: loss=0.4104 acc=76.27% | val: loss=0.6361 acc=69.35% f1=48.65% auc=65.89% val_score=86.4757 val_score_bestthr=92.8150 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.277, mb=0.262, no=0.737, corr=-0.703) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 86.4757
[DBG][ep=032] disease_pos_weight=1.0000 mode=none
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2857 mb_mean=0.2669 norm_overlap=0.7541 corr_cb=-0.7472 topkJ=0.0000
[TRAIN][ep=032] loss=0.4098 acc=75.91%
[TRAIN][ep=032] mask_avg: mc_mean=0.2766 mb_mean=0.2618 norm_overlap=0.7374 corr_cb=-0.7013
[EPOCH 032/089] train: loss=0.4098 acc=75.91% | val: loss=0.6373 acc=69.35% f1=55.81% auc=65.33% val_score=86.4757 val_score_bestthr=96.5394 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.277, mb=0.262, no=0.737, corr=-0.701) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 86.4757
[DBG][ep=033] disease_pos_weight=1.0000 mode=none
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2858 mb_mean=0.2632 norm_overlap=0.7014 corr_cb=-0.7523 topkJ=0.0000
[TRAIN][ep=033] loss=0.4077 acc=76.63%
[TRAIN][ep=033] mask_avg: mc_mean=0.2766 mb_mean=0.2618 norm_overlap=0.7374 corr_cb=-0.7024
[EPOCH 033/089] train: loss=0.4077 acc=76.63% | val: loss=0.6384 acc=69.35% f1=55.81% auc=65.33% val_score=86.4757 val_score_bestthr=96.5394 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.277, mb=0.262, no=0.737, corr=-0.702) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 86.4757
[DBG][ep=034] disease_pos_weight=1.0000 mode=none
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2799 mb_mean=0.2652 norm_overlap=0.6960 corr_cb=-0.7804 topkJ=0.0000
[TRAIN][ep=034] loss=0.4060 acc=76.45%
[TRAIN][ep=034] mask_avg: mc_mean=0.2766 mb_mean=0.2618 norm_overlap=0.7371 corr_cb=-0.7035
[EPOCH 034/089] train: loss=0.4060 acc=76.45% | val: loss=0.6401 acc=69.35% f1=55.81% auc=65.44% val_score=86.4757 val_score_bestthr=96.5394 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.277, mb=0.262, no=0.737, corr=-0.703) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 86.4757
[DBG][ep=035] disease_pos_weight=1.0000 mode=none
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2876 mb_mean=0.2567 norm_overlap=0.7007 corr_cb=-0.7326 topkJ=0.0000
[TRAIN][ep=035] loss=0.4041 acc=75.36%
[TRAIN][ep=035] mask_avg: mc_mean=0.2766 mb_mean=0.2618 norm_overlap=0.7372 corr_cb=-0.7019
[EPOCH 035/089] train: loss=0.4041 acc=75.36% | val: loss=0.6415 acc=69.35% f1=55.81% auc=65.11% val_score=89.3152 val_score_bestthr=96.5394 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.277, mb=0.262, no=0.737, corr=-0.702) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 89.3152
[DBG][ep=036] disease_pos_weight=1.0000 mode=none
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2928 mb_mean=0.2412 norm_overlap=0.6724 corr_cb=-0.7366 topkJ=0.0000
[TRAIN][ep=036] loss=0.4027 acc=76.81%
[TRAIN][ep=036] mask_avg: mc_mean=0.2766 mb_mean=0.2618 norm_overlap=0.7372 corr_cb=-0.7028
[EPOCH 036/089] train: loss=0.4027 acc=76.81% | val: loss=0.6426 acc=69.35% f1=55.81% auc=65.11% val_score=86.4757 val_score_bestthr=96.5394 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.277, mb=0.262, no=0.737, corr=-0.703) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 86.4757
[EARLY STOP] no improvement for 30 epochs. best_epoch=6
[CKPT] Loaded best for testing: results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
=============== FIT DONE ===============
[BEST] epoch=6 | val_acc=77.42% | val_f1=63.16% | val_auc=78.37% | val_score=108.2133 | val_score_bestthr=108.2133
[TEST@BEST] thr_used=0.370 | acc=64.05% f1=12.70% auc=58.69% | SP_sex=4.78% EO_sex=0.72% SP_age=4.21% EO_age=16.67%
[TIME] 0.58 min
[OK] Saved: results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/summary_fold_2.json
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4496 mb_mean=0.4946 norm_overlap=1.0001 corr_cb=0.1679 topkJ=0.0819
[TRAIN][ep=000] loss=0.6686 acc=63.77%
[TRAIN][ep=000] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0415
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4515 mb_mean=0.4949 norm_overlap=1.0000 corr_cb=0.0438 topkJ=0.0912
[TRAIN][ep=001] loss=0.6628 acc=63.77%
[TRAIN][ep=001] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0393
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4501 mb_mean=0.4947 norm_overlap=1.0000 corr_cb=0.0147 topkJ=0.0889
[TRAIN][ep=002] loss=0.6586 acc=63.77%
[TRAIN][ep=002] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0412
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4523 mb_mean=0.4943 norm_overlap=1.0001 corr_cb=0.1587 topkJ=0.0969
[TRAIN][ep=003] loss=0.6564 acc=63.77%
[TRAIN][ep=003] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0415
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4502 mb_mean=0.4945 norm_overlap=0.9999 corr_cb=-0.0905 topkJ=0.0338
[TRAIN][ep=004] loss=0.6548 acc=63.77%
[TRAIN][ep=004] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0389
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4510 mb_mean=0.4956 norm_overlap=1.0001 corr_cb=0.0918 topkJ=0.0948
[TRAIN][ep=005] loss=0.6537 acc=63.77%
[TRAIN][ep=005] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0387
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4523 mb_mean=0.4929 norm_overlap=1.0000 corr_cb=-0.0175 topkJ=0.0527
[TRAIN][ep=006] loss=0.6527 acc=63.77%
[TRAIN][ep=006] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0407
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4503 mb_mean=0.4943 norm_overlap=0.9999 corr_cb=-0.0701 topkJ=0.0588
[TRAIN][ep=007] loss=0.6516 acc=63.77%
[TRAIN][ep=007] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0395
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4515 mb_mean=0.4937 norm_overlap=1.0000 corr_cb=0.0577 topkJ=0.0890
[TRAIN][ep=008] loss=0.6511 acc=63.77%
[TRAIN][ep=008] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0414
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4511 mb_mean=0.4927 norm_overlap=1.0000 corr_cb=0.0201 topkJ=0.0884
[TRAIN][ep=009] loss=0.6495 acc=63.77%
[TRAIN][ep=009] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0422
================= FIT START (fold=2) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.35 select_by=val_score | eval_thr_mode=best_acc eval_thr_grid=coarse | disease_pos_weight_mode=none freeze_b_after=15 | two_stage=True stage1_ratio=0.35 stage2_lr_mult=0.3 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4516 mb_mean=0.4954 norm_overlap=1.0000 corr_cb=0.0570 topkJ=0.0440
[TRAIN][ep=000] loss=0.6485 acc=63.77%
[TRAIN][ep=000] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0407
[EPOCH 000/089] train: loss=0.6485 acc=63.77% | val: loss=0.6475 acc=77.42% f1=68.18% auc=77.70% val_score=71.7916 val_score_bestthr=111.0593 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.450, mb=0.495, no=1.000, corr=0.041) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* -1000000000000000000.0000 -> 71.7916
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4492 mb_mean=0.4950 norm_overlap=0.9998 corr_cb=-0.1808 topkJ=0.0441
[TRAIN][ep=001] loss=0.6468 acc=63.77%
[TRAIN][ep=001] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0400
[EPOCH 001/089] train: loss=0.6468 acc=63.77% | val: loss=0.6459 acc=75.81% f1=61.54% auc=77.37% val_score=81.9038 val_score_bestthr=105.8383 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.450, mb=0.495, no=1.000, corr=0.040) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 71.7916 -> 81.9038
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4508 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=-0.0404 topkJ=0.0832
[TRAIN][ep=002] loss=0.6455 acc=63.77%
[TRAIN][ep=002] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0410
[EPOCH 002/089] train: loss=0.6455 acc=63.77% | val: loss=0.6446 acc=75.81% f1=61.54% auc=76.81% val_score=81.9133 val_score_bestthr=105.8383 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.450, mb=0.495, no=1.000, corr=0.041) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 81.9038 -> 81.9133
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4487 mb_mean=0.4952 norm_overlap=0.9999 corr_cb=-0.0570 topkJ=0.0462
[TRAIN][ep=003] loss=0.6439 acc=63.77%
[TRAIN][ep=003] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0400
[EPOCH 003/089] train: loss=0.6439 acc=63.77% | val: loss=0.6432 acc=74.19% f1=65.22% auc=76.03% val_score=95.8460 val_score_bestthr=106.3227 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.450, mb=0.495, no=1.000, corr=0.040) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 81.9133 -> 95.8460
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4503 mb_mean=0.4944 norm_overlap=1.0001 corr_cb=0.1213 topkJ=0.0789
[TRAIN][ep=004] loss=0.6428 acc=63.77%
[TRAIN][ep=004] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0380
[EPOCH 004/089] train: loss=0.6428 acc=63.77% | val: loss=0.6419 acc=72.58% f1=65.31% auc=75.03% val_score=75.8743 val_score_bestthr=104.5399 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.450, mb=0.495, no=1.000, corr=0.038) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 95.8460 -> 75.8743
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4518 mb_mean=0.4941 norm_overlap=1.0000 corr_cb=-0.0020 topkJ=0.0603
[TRAIN][ep=005] loss=2.1502 acc=63.77%
[TRAIN][ep=005] mask_avg: mc_mean=0.4466 mb_mean=0.4885 norm_overlap=0.9999 corr_cb=-0.0530
[EPOCH 005/089] train: loss=2.1502 acc=63.77% | val: loss=0.6449 acc=75.81% f1=63.41% auc=78.15% val_score=89.5431 val_score_bestthr=106.7062 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.447, mb=0.488, no=1.000, corr=-0.053) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 95.8460 -> 89.5431
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4424 mb_mean=0.4812 norm_overlap=0.9999 corr_cb=-0.1093 topkJ=0.0265
[TRAIN][ep=006] loss=1.4360 acc=63.77%
[TRAIN][ep=006] mask_avg: mc_mean=0.4378 mb_mean=0.4745 norm_overlap=1.0000 corr_cb=0.0159
[EPOCH 006/089] train: loss=1.4360 acc=63.77% | val: loss=0.6428 acc=75.81% f1=59.46% auc=78.26% val_score=104.8367 val_score_bestthr=104.8367 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.438, mb=0.474, no=1.000, corr=0.016) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 95.8460 -> 104.8367
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4337 mb_mean=0.4656 norm_overlap=1.0002 corr_cb=0.1549 topkJ=0.0739
[TRAIN][ep=007] loss=0.7364 acc=63.77%
[TRAIN][ep=007] mask_avg: mc_mean=0.4272 mb_mean=0.4579 norm_overlap=1.0004 corr_cb=0.1952
[EPOCH 007/089] train: loss=0.7364 acc=63.77% | val: loss=0.6408 acc=74.19% f1=60.00% auc=77.70% val_score=102.2972 val_score_bestthr=103.4818 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.427, mb=0.458, no=1.000, corr=0.195) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 104.8367 -> 102.2972
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4202 mb_mean=0.4467 norm_overlap=1.0010 corr_cb=0.4297 topkJ=0.1046
[TRAIN][ep=008] loss=0.5763 acc=63.77%
[TRAIN][ep=008] mask_avg: mc_mean=0.4153 mb_mean=0.4377 norm_overlap=1.0009 corr_cb=0.2765
[EPOCH 008/089] train: loss=0.5763 acc=63.77% | val: loss=0.6394 acc=75.81% f1=61.54% auc=76.59% val_score=100.0574 val_score_bestthr=105.8383 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.415, mb=0.438, no=1.001, corr=0.276) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 104.8367 -> 100.0574
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4122 mb_mean=0.4321 norm_overlap=1.0009 corr_cb=0.2442 topkJ=0.0688
[TRAIN][ep=009] loss=0.5711 acc=63.77%
[TRAIN][ep=009] mask_avg: mc_mean=0.4025 mb_mean=0.4133 norm_overlap=1.0017 corr_cb=0.2890
[EPOCH 009/089] train: loss=0.5711 acc=63.77% | val: loss=0.6375 acc=74.19% f1=63.64% auc=75.36% val_score=97.8049 val_score_bestthr=105.5917 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.402, mb=0.413, no=1.002, corr=0.289) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 104.8367 -> 97.8049
[DBG][ep=010] disease_pos_weight=1.0000 mode=none
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.3971 mb_mean=0.4015 norm_overlap=1.0013 corr_cb=0.1694 topkJ=0.0427
[TRAIN][ep=010] loss=0.5664 acc=63.77%
[TRAIN][ep=010] mask_avg: mc_mean=0.3894 mb_mean=0.3859 norm_overlap=1.0028 corr_cb=0.2646
[EPOCH 010/089] train: loss=0.5664 acc=63.77% | val: loss=0.6355 acc=72.58% f1=48.48% auc=74.02% val_score=97.1845 val_score_bestthr=95.8932 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.389, mb=0.386, no=1.003, corr=0.265) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 104.8367 -> 97.1845
[DBG][ep=011] disease_pos_weight=1.0000 mode=none
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.3787 mb_mean=0.3646 norm_overlap=1.0037 corr_cb=0.2699 topkJ=0.0627
[TRAIN][ep=011] loss=0.5604 acc=63.77%
[TRAIN][ep=011] mask_avg: mc_mean=0.3762 mb_mean=0.3581 norm_overlap=1.0023 corr_cb=0.1291
[EPOCH 011/089] train: loss=0.5604 acc=63.77% | val: loss=0.6328 acc=70.97% f1=60.87% auc=72.69% val_score=97.5367 val_score_bestthr=100.7374 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.376, mb=0.358, no=1.002, corr=0.129) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 104.8367 -> 97.5367
[DBG][ep=012] disease_pos_weight=1.0000 mode=none
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.3710 mb_mean=0.3539 norm_overlap=1.0033 corr_cb=0.1519 topkJ=0.0294
[TRAIN][ep=012] loss=0.5553 acc=63.77%
[TRAIN][ep=012] mask_avg: mc_mean=0.3633 mb_mean=0.3325 norm_overlap=0.9984 corr_cb=-0.0501
[EPOCH 012/089] train: loss=0.5553 acc=63.77% | val: loss=0.6303 acc=72.58% f1=48.48% auc=71.79% val_score=92.3401 val_score_bestthr=95.8932 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.363, mb=0.332, no=0.998, corr=-0.050) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 104.8367 -> 92.3401
[DBG][ep=013] disease_pos_weight=1.0000 mode=none
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.3602 mb_mean=0.3235 norm_overlap=0.9904 corr_cb=-0.2795 topkJ=0.0062
[TRAIN][ep=013] loss=0.5471 acc=63.95%
[TRAIN][ep=013] mask_avg: mc_mean=0.3516 mb_mean=0.3101 norm_overlap=0.9888 corr_cb=-0.2384
[EPOCH 013/089] train: loss=0.5471 acc=63.95% | val: loss=0.6275 acc=72.58% f1=48.48% auc=70.46% val_score=101.3341 val_score_bestthr=95.8932 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.352, mb=0.310, no=0.989, corr=-0.238) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 104.8367 -> 101.3341
[DBG][ep=014] disease_pos_weight=1.0000 mode=none
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.3513 mb_mean=0.3150 norm_overlap=0.9723 corr_cb=-0.5310 topkJ=0.0012
[TRAIN][ep=014] loss=0.5401 acc=63.77%
[TRAIN][ep=014] mask_avg: mc_mean=0.3396 mb_mean=0.2904 norm_overlap=0.9677 corr_cb=-0.4355
[EPOCH 014/089] train: loss=0.5401 acc=63.77% | val: loss=0.6248 acc=70.97% f1=47.06% auc=69.12% val_score=96.7981 val_score_bestthr=93.5917 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.340, mb=0.290, no=0.968, corr=-0.435) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 104.8367 -> 96.7981
[DBG][ep=015] disease_pos_weight=1.0000 mode=none
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.3335 mb_mean=0.2861 norm_overlap=0.9642 corr_cb=-0.4917 topkJ=0.0025
[TRAIN][ep=015] loss=0.5324 acc=64.49%
[TRAIN][ep=015] mask_avg: mc_mean=0.3300 mb_mean=0.2812 norm_overlap=0.9473 corr_cb=-0.5494
[EPOCH 015/089] train: loss=0.5324 acc=64.49% | val: loss=0.6206 acc=70.97% f1=47.06% auc=69.12% val_score=94.5726 val_score_bestthr=93.5917 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.330, mb=0.281, no=0.947, corr=-0.549) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 94.5726
[DBG][ep=016] disease_pos_weight=1.0000 mode=none
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.3083 mb_mean=0.2571 norm_overlap=0.9475 corr_cb=-0.3079 topkJ=0.0028
[TRAIN][ep=016] loss=0.5251 acc=65.94%
[TRAIN][ep=016] mask_avg: mc_mean=0.3211 mb_mean=0.2812 norm_overlap=0.9332 corr_cb=-0.5868
[EPOCH 016/089] train: loss=0.5251 acc=65.94% | val: loss=0.6174 acc=69.35% f1=42.42% auc=68.12% val_score=95.2841 val_score_bestthr=89.5371 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.321, mb=0.281, no=0.933, corr=-0.587) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 95.2841
[DBG][ep=017] disease_pos_weight=1.0000 mode=none
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.3074 mb_mean=0.2756 norm_overlap=0.9345 corr_cb=-0.4757 topkJ=0.0000
[TRAIN][ep=017] loss=0.5189 acc=66.49%
[TRAIN][ep=017] mask_avg: mc_mean=0.3143 mb_mean=0.2812 norm_overlap=0.9197 corr_cb=-0.6153
[EPOCH 017/089] train: loss=0.5189 acc=66.49% | val: loss=0.6146 acc=70.97% f1=47.06% auc=69.01% val_score=95.7411 val_score_bestthr=93.5917 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.314, mb=0.281, no=0.920, corr=-0.615) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 95.7411
[DBG][ep=018] disease_pos_weight=1.0000 mode=none
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.3114 mb_mean=0.2893 norm_overlap=0.9146 corr_cb=-0.6428 topkJ=0.0000
[TRAIN][ep=018] loss=0.5119 acc=67.21%
[TRAIN][ep=018] mask_avg: mc_mean=0.3089 mb_mean=0.2812 norm_overlap=0.9102 corr_cb=-0.6209
[EPOCH 018/089] train: loss=0.5119 acc=67.21% | val: loss=0.6106 acc=69.35% f1=59.57% auc=68.56% val_score=92.2030 val_score_bestthr=98.0869 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.309, mb=0.281, no=0.910, corr=-0.621) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 92.2030
[DBG][ep=019] disease_pos_weight=1.0000 mode=none
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.3069 mb_mean=0.2879 norm_overlap=0.9108 corr_cb=-0.6044 topkJ=0.0000
[TRAIN][ep=019] loss=0.5060 acc=66.67%
[TRAIN][ep=019] mask_avg: mc_mean=0.3037 mb_mean=0.2812 norm_overlap=0.8983 corr_cb=-0.6312
[EPOCH 019/089] train: loss=0.5060 acc=66.67% | val: loss=0.6097 acc=69.35% f1=59.57% auc=68.56% val_score=92.2030 val_score_bestthr=98.0869 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.304, mb=0.281, no=0.898, corr=-0.631) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 92.2030
[DBG][ep=020] disease_pos_weight=1.0000 mode=none
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.3045 mb_mean=0.2821 norm_overlap=0.8747 corr_cb=-0.7261 topkJ=0.0000
[TRAIN][ep=020] loss=0.4981 acc=67.39%
[TRAIN][ep=020] mask_avg: mc_mean=0.3005 mb_mean=0.2812 norm_overlap=0.8898 corr_cb=-0.6372
[EPOCH 020/089] train: loss=0.4981 acc=67.39% | val: loss=0.6072 acc=69.35% f1=53.66% auc=68.67% val_score=92.2030 val_score_bestthr=95.0988 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.300, mb=0.281, no=0.890, corr=-0.637) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 92.2030
[DBG][ep=021] disease_pos_weight=1.0000 mode=none
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2840 mb_mean=0.2764 norm_overlap=0.8956 corr_cb=-0.5418 topkJ=0.0000
[TRAIN][ep=021] loss=0.4911 acc=68.30%
[TRAIN][ep=021] mask_avg: mc_mean=0.2965 mb_mean=0.2812 norm_overlap=0.8811 corr_cb=-0.6380
[EPOCH 021/089] train: loss=0.4911 acc=68.30% | val: loss=0.6070 acc=69.35% f1=57.78% auc=68.90% val_score=91.4390 val_score_bestthr=97.1779 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.297, mb=0.281, no=0.881, corr=-0.638) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 91.4390
[DBG][ep=022] disease_pos_weight=1.0000 mode=none
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2943 mb_mean=0.2849 norm_overlap=0.8719 corr_cb=-0.6567 topkJ=0.0000
[TRAIN][ep=022] loss=0.4833 acc=70.29%
[TRAIN][ep=022] mask_avg: mc_mean=0.2938 mb_mean=0.2812 norm_overlap=0.8728 corr_cb=-0.6439
[EPOCH 022/089] train: loss=0.4833 acc=70.29% | val: loss=0.6058 acc=69.35% f1=55.81% auc=68.23% val_score=91.4390 val_score_bestthr=96.5670 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.294, mb=0.281, no=0.873, corr=-0.644) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 91.4390
[DBG][ep=023] disease_pos_weight=1.0000 mode=none
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2967 mb_mean=0.2693 norm_overlap=0.8371 corr_cb=-0.6861 topkJ=0.0000
[TRAIN][ep=023] loss=0.4758 acc=70.65%
[TRAIN][ep=023] mask_avg: mc_mean=0.2907 mb_mean=0.2812 norm_overlap=0.8666 corr_cb=-0.6389
[EPOCH 023/089] train: loss=0.4758 acc=70.65% | val: loss=0.6076 acc=69.35% f1=55.81% auc=68.12% val_score=91.4390 val_score_bestthr=96.5670 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.291, mb=0.281, no=0.867, corr=-0.639) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 91.4390
[DBG][ep=024] disease_pos_weight=1.0000 mode=none
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2923 mb_mean=0.2861 norm_overlap=0.8496 corr_cb=-0.7209 topkJ=0.0000
[TRAIN][ep=024] loss=0.4708 acc=71.74%
[TRAIN][ep=024] mask_avg: mc_mean=0.2879 mb_mean=0.2812 norm_overlap=0.8597 corr_cb=-0.6420
[EPOCH 024/089] train: loss=0.4708 acc=71.74% | val: loss=0.6150 acc=69.35% f1=55.81% auc=67.78% val_score=94.9544 val_score_bestthr=96.5670 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.288, mb=0.281, no=0.860, corr=-0.642) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 94.9544
[DBG][ep=025] disease_pos_weight=1.0000 mode=none
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2982 mb_mean=0.2791 norm_overlap=0.8179 corr_cb=-0.7739 topkJ=0.0000
[TRAIN][ep=025] loss=0.4638 acc=72.83%
[TRAIN][ep=025] mask_avg: mc_mean=0.2853 mb_mean=0.2812 norm_overlap=0.8529 corr_cb=-0.6443
[EPOCH 025/089] train: loss=0.4638 acc=72.83% | val: loss=0.6190 acc=70.97% f1=47.06% auc=67.34% val_score=94.9544 val_score_bestthr=93.5917 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.285, mb=0.281, no=0.853, corr=-0.644) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 94.9544
[DBG][ep=026] disease_pos_weight=1.0000 mode=none
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2821 mb_mean=0.2773 norm_overlap=0.8294 corr_cb=-0.6862 topkJ=0.0000
[TRAIN][ep=026] loss=0.4586 acc=72.83%
[TRAIN][ep=026] mask_avg: mc_mean=0.2827 mb_mean=0.2812 norm_overlap=0.8492 corr_cb=-0.6354
[EPOCH 026/089] train: loss=0.4586 acc=72.83% | val: loss=0.6154 acc=69.35% f1=59.57% auc=67.22% val_score=92.1977 val_score_bestthr=98.1494 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.283, mb=0.281, no=0.849, corr=-0.635) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 92.1977
[DBG][ep=027] disease_pos_weight=1.0000 mode=none
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2706 mb_mean=0.2875 norm_overlap=0.8857 corr_cb=-0.4756 topkJ=0.0000
[TRAIN][ep=027] loss=0.4497 acc=74.09%
[TRAIN][ep=027] mask_avg: mc_mean=0.2804 mb_mean=0.2812 norm_overlap=0.8415 corr_cb=-0.6427
[EPOCH 027/089] train: loss=0.4497 acc=74.09% | val: loss=0.6255 acc=69.35% f1=29.63% auc=66.44% val_score=84.3797 val_score_bestthr=83.5385 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.280, mb=0.281, no=0.842, corr=-0.643) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 84.3797
[DBG][ep=028] disease_pos_weight=1.0000 mode=none
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2749 mb_mean=0.2914 norm_overlap=0.8487 corr_cb=-0.6696 topkJ=0.0000
[TRAIN][ep=028] loss=0.4449 acc=73.73%
[TRAIN][ep=028] mask_avg: mc_mean=0.2784 mb_mean=0.2812 norm_overlap=0.8361 corr_cb=-0.6449
[EPOCH 028/089] train: loss=0.4449 acc=73.73% | val: loss=0.6230 acc=70.97% f1=50.00% auc=66.56% val_score=87.9226 val_score_bestthr=95.1280 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.278, mb=0.281, no=0.836, corr=-0.645) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 87.9226
[DBG][ep=029] disease_pos_weight=1.0000 mode=none
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2849 mb_mean=0.2853 norm_overlap=0.8316 corr_cb=-0.6852 topkJ=0.0000
[TRAIN][ep=029] loss=0.4346 acc=74.28%
[TRAIN][ep=029] mask_avg: mc_mean=0.2763 mb_mean=0.2812 norm_overlap=0.8313 corr_cb=-0.6463
[EPOCH 029/089] train: loss=0.4346 acc=74.28% | val: loss=0.6277 acc=69.35% f1=29.63% auc=65.44% val_score=87.9226 val_score_bestthr=83.5385 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.276, mb=0.281, no=0.831, corr=-0.646) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 87.9226
[DBG][ep=030] disease_pos_weight=1.0000 mode=none
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2747 mb_mean=0.2772 norm_overlap=0.8702 corr_cb=-0.5603 topkJ=0.0000
[TRAIN][ep=030] loss=0.4293 acc=75.18%
[TRAIN][ep=030] mask_avg: mc_mean=0.2736 mb_mean=0.2812 norm_overlap=0.8279 corr_cb=-0.6423
[EPOCH 030/089] train: loss=0.4293 acc=75.18% | val: loss=0.6343 acc=69.35% f1=45.71% auc=65.44% val_score=87.1500 val_score_bestthr=91.6603 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.274, mb=0.281, no=0.828, corr=-0.642) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 87.1500
[DBG][ep=031] disease_pos_weight=1.0000 mode=none
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2720 mb_mean=0.2918 norm_overlap=0.8553 corr_cb=-0.5681 topkJ=0.0000
[TRAIN][ep=031] loss=0.4192 acc=75.54%
[TRAIN][ep=031] mask_avg: mc_mean=0.2722 mb_mean=0.2812 norm_overlap=0.8240 corr_cb=-0.6484
[EPOCH 031/089] train: loss=0.4192 acc=75.54% | val: loss=0.6360 acc=69.35% f1=45.71% auc=65.55% val_score=89.3152 val_score_bestthr=91.6603 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.272, mb=0.281, no=0.824, corr=-0.648) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 89.3152
[DBG][ep=032] disease_pos_weight=1.0000 mode=none
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2806 mb_mean=0.2866 norm_overlap=0.8338 corr_cb=-0.6904 topkJ=0.0000
[TRAIN][ep=032] loss=0.4186 acc=75.91%
[TRAIN][ep=032] mask_avg: mc_mean=0.2723 mb_mean=0.2812 norm_overlap=0.8241 corr_cb=-0.6463
[EPOCH 032/089] train: loss=0.4186 acc=75.91% | val: loss=0.6372 acc=69.35% f1=45.71% auc=65.33% val_score=89.3152 val_score_bestthr=91.6603 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.272, mb=0.281, no=0.824, corr=-0.646) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 89.3152
[DBG][ep=033] disease_pos_weight=1.0000 mode=none
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2813 mb_mean=0.2815 norm_overlap=0.7907 corr_cb=-0.7192 topkJ=0.0000
[TRAIN][ep=033] loss=0.4165 acc=76.09%
[TRAIN][ep=033] mask_avg: mc_mean=0.2723 mb_mean=0.2812 norm_overlap=0.8241 corr_cb=-0.6477
[EPOCH 033/089] train: loss=0.4165 acc=76.09% | val: loss=0.6382 acc=69.35% f1=48.65% auc=65.33% val_score=89.3152 val_score_bestthr=92.8150 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.272, mb=0.281, no=0.824, corr=-0.648) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 89.3152
[DBG][ep=034] disease_pos_weight=1.0000 mode=none
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2755 mb_mean=0.2836 norm_overlap=0.7926 corr_cb=-0.7367 topkJ=0.0000
[TRAIN][ep=034] loss=0.4149 acc=76.27%
[TRAIN][ep=034] mask_avg: mc_mean=0.2723 mb_mean=0.2812 norm_overlap=0.8239 corr_cb=-0.6488
[EPOCH 034/089] train: loss=0.4149 acc=76.27% | val: loss=0.6399 acc=69.35% f1=48.65% auc=65.44% val_score=89.3152 val_score_bestthr=92.8150 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.272, mb=0.281, no=0.824, corr=-0.649) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 89.3152
[DBG][ep=035] disease_pos_weight=1.0000 mode=none
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2810 mb_mean=0.2763 norm_overlap=0.7964 corr_cb=-0.6857 topkJ=0.0000
[TRAIN][ep=035] loss=0.4131 acc=75.54%
[TRAIN][ep=035] mask_avg: mc_mean=0.2723 mb_mean=0.2812 norm_overlap=0.8239 corr_cb=-0.6472
[EPOCH 035/089] train: loss=0.4131 acc=75.54% | val: loss=0.6413 acc=69.35% f1=48.65% auc=64.88% val_score=90.1507 val_score_bestthr=92.8150 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.272, mb=0.281, no=0.824, corr=-0.647) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 90.1507
[DBG][ep=036] disease_pos_weight=1.0000 mode=none
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2848 mb_mean=0.2605 norm_overlap=0.7715 corr_cb=-0.6983 topkJ=0.0000
[TRAIN][ep=036] loss=0.4117 acc=76.81%
[TRAIN][ep=036] mask_avg: mc_mean=0.2723 mb_mean=0.2812 norm_overlap=0.8239 corr_cb=-0.6482
[EPOCH 036/089] train: loss=0.4117 acc=76.81% | val: loss=0.6424 acc=69.35% f1=29.63% auc=65.11% val_score=92.3489 val_score_bestthr=83.5385 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.272, mb=0.281, no=0.824, corr=-0.648) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 92.3489
[EARLY STOP] no improvement for 30 epochs. best_epoch=6
[CKPT] Loaded best for testing: results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
=============== FIT DONE ===============
[BEST] epoch=6 | val_acc=75.81% | val_f1=59.46% | val_auc=78.26% | val_score=104.8367 | val_score_bestthr=104.8367
[TEST@BEST] thr_used=0.370 | acc=63.40% f1=9.68% auc=58.63% | SP_sex=3.71% EO_sex=3.04% SP_age=3.67% EO_age=16.67%
[TIME] 0.65 min
[OK] Saved: results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/summary_fold_2.json
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4496 mb_mean=0.4946 norm_overlap=1.0001 corr_cb=0.1679 topkJ=0.0819
[TRAIN][ep=000] loss=0.6686 acc=63.77%
[TRAIN][ep=000] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0415
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4515 mb_mean=0.4949 norm_overlap=1.0000 corr_cb=0.0438 topkJ=0.0912
[TRAIN][ep=001] loss=0.6628 acc=63.77%
[TRAIN][ep=001] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0393
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4501 mb_mean=0.4947 norm_overlap=1.0000 corr_cb=0.0147 topkJ=0.0889
[TRAIN][ep=002] loss=0.6586 acc=63.77%
[TRAIN][ep=002] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0412
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4523 mb_mean=0.4943 norm_overlap=1.0001 corr_cb=0.1587 topkJ=0.0969
[TRAIN][ep=003] loss=0.6564 acc=63.77%
[TRAIN][ep=003] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0415
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4502 mb_mean=0.4945 norm_overlap=0.9999 corr_cb=-0.0905 topkJ=0.0338
[TRAIN][ep=004] loss=0.6548 acc=63.77%
[TRAIN][ep=004] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0389
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4510 mb_mean=0.4956 norm_overlap=1.0001 corr_cb=0.0918 topkJ=0.0948
[TRAIN][ep=005] loss=0.6537 acc=63.77%
[TRAIN][ep=005] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0387
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4523 mb_mean=0.4929 norm_overlap=1.0000 corr_cb=-0.0175 topkJ=0.0527
[TRAIN][ep=006] loss=0.6527 acc=63.77%
[TRAIN][ep=006] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0407
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4503 mb_mean=0.4943 norm_overlap=0.9999 corr_cb=-0.0701 topkJ=0.0588
[TRAIN][ep=007] loss=0.6516 acc=63.77%
[TRAIN][ep=007] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0395
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4515 mb_mean=0.4937 norm_overlap=1.0000 corr_cb=0.0577 topkJ=0.0890
[TRAIN][ep=008] loss=0.6511 acc=63.77%
[TRAIN][ep=008] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0414
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4511 mb_mean=0.4927 norm_overlap=1.0000 corr_cb=0.0201 topkJ=0.0884
[TRAIN][ep=009] loss=0.6495 acc=63.77%
[TRAIN][ep=009] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0422
================= FIT START (fold=2) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.35 select_by=val_score | eval_thr_mode=best_acc eval_thr_grid=coarse | disease_pos_weight_mode=none freeze_b_after=15 | two_stage=True stage1_ratio=0.35 stage2_lr_mult=0.3 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4516 mb_mean=0.4954 norm_overlap=1.0000 corr_cb=0.0570 topkJ=0.0440
[TRAIN][ep=000] loss=0.6485 acc=63.77%
[TRAIN][ep=000] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0407
[EPOCH 000/089] train: loss=0.6485 acc=63.77% | val: loss=0.6475 acc=77.42% f1=68.18% auc=77.70% val_score=71.7916 val_score_bestthr=111.0593 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.450, mb=0.495, no=1.000, corr=0.041) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* -1000000000000000000.0000 -> 71.7916
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4492 mb_mean=0.4950 norm_overlap=0.9998 corr_cb=-0.1808 topkJ=0.0441
[TRAIN][ep=001] loss=0.6468 acc=63.77%
[TRAIN][ep=001] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0400
[EPOCH 001/089] train: loss=0.6468 acc=63.77% | val: loss=0.6459 acc=75.81% f1=61.54% auc=77.37% val_score=81.9038 val_score_bestthr=105.8383 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.450, mb=0.495, no=1.000, corr=0.040) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 71.7916 -> 81.9038
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4508 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=-0.0404 topkJ=0.0832
[TRAIN][ep=002] loss=0.6455 acc=63.77%
[TRAIN][ep=002] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0410
[EPOCH 002/089] train: loss=0.6455 acc=63.77% | val: loss=0.6446 acc=75.81% f1=61.54% auc=76.70% val_score=81.9133 val_score_bestthr=105.8383 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.450, mb=0.495, no=1.000, corr=0.041) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 81.9038 -> 81.9133
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4487 mb_mean=0.4952 norm_overlap=0.9999 corr_cb=-0.0570 topkJ=0.0462
[TRAIN][ep=003] loss=0.6439 acc=63.77%
[TRAIN][ep=003] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0400
[EPOCH 003/089] train: loss=0.6439 acc=63.77% | val: loss=0.6432 acc=74.19% f1=65.22% auc=76.03% val_score=95.8460 val_score_bestthr=106.3227 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.450, mb=0.495, no=1.000, corr=0.040) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 81.9133 -> 95.8460
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4503 mb_mean=0.4944 norm_overlap=1.0001 corr_cb=0.1213 topkJ=0.0789
[TRAIN][ep=004] loss=0.6428 acc=63.77%
[TRAIN][ep=004] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0380
[EPOCH 004/089] train: loss=0.6428 acc=63.77% | val: loss=0.6419 acc=72.58% f1=65.31% auc=74.92% val_score=75.8743 val_score_bestthr=104.5399 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.450, mb=0.495, no=1.000, corr=0.038) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 95.8460 -> 75.8743
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4518 mb_mean=0.4941 norm_overlap=1.0000 corr_cb=-0.0020 topkJ=0.0603
[TRAIN][ep=005] loss=2.2527 acc=63.77%
[TRAIN][ep=005] mask_avg: mc_mean=0.4466 mb_mean=0.4885 norm_overlap=0.9999 corr_cb=-0.0536
[EPOCH 005/089] train: loss=2.2527 acc=63.77% | val: loss=0.6446 acc=77.42% f1=63.16% auc=78.04% val_score=97.9107 val_score_bestthr=108.2133 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.447, mb=0.488, no=1.000, corr=-0.054) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 95.8460 -> 97.9107
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4425 mb_mean=0.4812 norm_overlap=0.9999 corr_cb=-0.1119 topkJ=0.0269
[TRAIN][ep=006] loss=1.5040 acc=63.77%
[TRAIN][ep=006] mask_avg: mc_mean=0.4379 mb_mean=0.4745 norm_overlap=1.0000 corr_cb=0.0110
[EPOCH 006/089] train: loss=1.5040 acc=63.77% | val: loss=0.6425 acc=77.42% f1=63.16% auc=78.26% val_score=108.2133 val_score_bestthr=108.2133 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.438, mb=0.474, no=1.000, corr=0.011) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 97.9107 -> 108.2133
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4339 mb_mean=0.4656 norm_overlap=1.0002 corr_cb=0.1477 topkJ=0.0725
[TRAIN][ep=007] loss=0.7701 acc=63.77%
[TRAIN][ep=007] mask_avg: mc_mean=0.4276 mb_mean=0.4579 norm_overlap=1.0004 corr_cb=0.1842
[EPOCH 007/089] train: loss=0.7701 acc=63.77% | val: loss=0.6406 acc=74.19% f1=60.00% auc=77.70% val_score=102.2972 val_score_bestthr=103.4818 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.428, mb=0.458, no=1.000, corr=0.184) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 108.2133 -> 102.2972
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4207 mb_mean=0.4467 norm_overlap=1.0009 corr_cb=0.4155 topkJ=0.1006
[TRAIN][ep=008] loss=0.5761 acc=63.77%
[TRAIN][ep=008] mask_avg: mc_mean=0.4159 mb_mean=0.4377 norm_overlap=1.0008 corr_cb=0.2627
[EPOCH 008/089] train: loss=0.5761 acc=63.77% | val: loss=0.6392 acc=75.81% f1=61.54% auc=76.59% val_score=100.0574 val_score_bestthr=105.8383 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.416, mb=0.438, no=1.001, corr=0.263) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 108.2133 -> 100.0574
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4128 mb_mean=0.4321 norm_overlap=1.0008 corr_cb=0.2319 topkJ=0.0669
[TRAIN][ep=009] loss=0.5709 acc=63.77%
[TRAIN][ep=009] mask_avg: mc_mean=0.4033 mb_mean=0.4132 norm_overlap=1.0017 corr_cb=0.2772
[EPOCH 009/089] train: loss=0.5709 acc=63.77% | val: loss=0.6373 acc=74.19% f1=63.64% auc=75.47% val_score=97.8049 val_score_bestthr=105.5917 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.403, mb=0.413, no=1.002, corr=0.277) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 108.2133 -> 97.8049
[DBG][ep=010] disease_pos_weight=1.0000 mode=none
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.3980 mb_mean=0.4014 norm_overlap=1.0012 corr_cb=0.1578 topkJ=0.0414
[TRAIN][ep=010] loss=0.5663 acc=63.77%
[TRAIN][ep=010] mask_avg: mc_mean=0.3905 mb_mean=0.3858 norm_overlap=1.0027 corr_cb=0.2551
[EPOCH 010/089] train: loss=0.5663 acc=63.77% | val: loss=0.6354 acc=72.58% f1=51.43% auc=74.02% val_score=97.1845 val_score_bestthr=97.2649 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.390, mb=0.386, no=1.003, corr=0.255) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 108.2133 -> 97.1845
[DBG][ep=011] disease_pos_weight=1.0000 mode=none
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.3799 mb_mean=0.3645 norm_overlap=1.0036 corr_cb=0.2613 topkJ=0.0613
[TRAIN][ep=011] loss=0.5604 acc=63.77%
[TRAIN][ep=011] mask_avg: mc_mean=0.3774 mb_mean=0.3580 norm_overlap=1.0021 corr_cb=0.1232
[EPOCH 011/089] train: loss=0.5604 acc=63.77% | val: loss=0.6327 acc=70.97% f1=60.87% auc=72.58% val_score=97.5367 val_score_bestthr=100.7374 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.377, mb=0.358, no=1.002, corr=0.123) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 108.2133 -> 97.5367
[DBG][ep=012] disease_pos_weight=1.0000 mode=none
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.3722 mb_mean=0.3538 norm_overlap=1.0032 corr_cb=0.1482 topkJ=0.0294
[TRAIN][ep=012] loss=0.5553 acc=63.77%
[TRAIN][ep=012] mask_avg: mc_mean=0.3645 mb_mean=0.3323 norm_overlap=0.9984 corr_cb=-0.0526
[EPOCH 012/089] train: loss=0.5553 acc=63.77% | val: loss=0.6302 acc=72.58% f1=48.48% auc=71.68% val_score=92.3401 val_score_bestthr=95.8932 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.365, mb=0.332, no=0.998, corr=-0.053) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 108.2133 -> 92.3401
[DBG][ep=013] disease_pos_weight=1.0000 mode=none
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.3614 mb_mean=0.3234 norm_overlap=0.9905 corr_cb=-0.2806 topkJ=0.0062
[TRAIN][ep=013] loss=0.5471 acc=63.95%
[TRAIN][ep=013] mask_avg: mc_mean=0.3529 mb_mean=0.3099 norm_overlap=0.9889 corr_cb=-0.2389
[EPOCH 013/089] train: loss=0.5471 acc=63.95% | val: loss=0.6274 acc=72.58% f1=48.48% auc=70.35% val_score=101.3341 val_score_bestthr=95.8932 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.353, mb=0.310, no=0.989, corr=-0.239) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 108.2133 -> 101.3341
[DBG][ep=014] disease_pos_weight=1.0000 mode=none
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.3526 mb_mean=0.3149 norm_overlap=0.9727 corr_cb=-0.5296 topkJ=0.0012
[TRAIN][ep=014] loss=0.5402 acc=63.77%
[TRAIN][ep=014] mask_avg: mc_mean=0.3409 mb_mean=0.2903 norm_overlap=0.9682 corr_cb=-0.4344
[EPOCH 014/089] train: loss=0.5402 acc=63.77% | val: loss=0.6248 acc=70.97% f1=47.06% auc=69.12% val_score=96.7981 val_score_bestthr=93.5917 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.341, mb=0.290, no=0.968, corr=-0.434) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 108.2133 -> 96.7981
[DBG][ep=015] disease_pos_weight=1.0000 mode=none
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.3348 mb_mean=0.2860 norm_overlap=0.9647 corr_cb=-0.4904 topkJ=0.0025
[TRAIN][ep=015] loss=0.5325 acc=64.49%
[TRAIN][ep=015] mask_avg: mc_mean=0.3312 mb_mean=0.2811 norm_overlap=0.9480 corr_cb=-0.5478
[EPOCH 015/089] train: loss=0.5325 acc=64.49% | val: loss=0.6206 acc=70.97% f1=47.06% auc=69.12% val_score=94.5726 val_score_bestthr=93.5917 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.331, mb=0.281, no=0.948, corr=-0.548) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 94.5726
[DBG][ep=016] disease_pos_weight=1.0000 mode=none
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.3096 mb_mean=0.2568 norm_overlap=0.9485 corr_cb=-0.3043 topkJ=0.0032
[TRAIN][ep=016] loss=0.5253 acc=65.94%
[TRAIN][ep=016] mask_avg: mc_mean=0.3222 mb_mean=0.2811 norm_overlap=0.9341 corr_cb=-0.5849
[EPOCH 016/089] train: loss=0.5253 acc=65.94% | val: loss=0.6174 acc=69.35% f1=42.42% auc=68.12% val_score=95.2841 val_score_bestthr=89.5371 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.322, mb=0.281, no=0.934, corr=-0.585) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 95.2841
[DBG][ep=017] disease_pos_weight=1.0000 mode=none
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.3086 mb_mean=0.2755 norm_overlap=0.9355 corr_cb=-0.4734 topkJ=0.0000
[TRAIN][ep=017] loss=0.5191 acc=66.49%
[TRAIN][ep=017] mask_avg: mc_mean=0.3153 mb_mean=0.2811 norm_overlap=0.9208 corr_cb=-0.6133
[EPOCH 017/089] train: loss=0.5191 acc=66.49% | val: loss=0.6146 acc=70.97% f1=47.06% auc=69.01% val_score=93.5574 val_score_bestthr=93.5917 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.315, mb=0.281, no=0.921, corr=-0.613) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 93.5574
[DBG][ep=018] disease_pos_weight=1.0000 mode=none
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.3124 mb_mean=0.2893 norm_overlap=0.9156 corr_cb=-0.6408 topkJ=0.0000
[TRAIN][ep=018] loss=0.5122 acc=67.03%
[TRAIN][ep=018] mask_avg: mc_mean=0.3097 mb_mean=0.2811 norm_overlap=0.9114 corr_cb=-0.6187
[EPOCH 018/089] train: loss=0.5122 acc=67.03% | val: loss=0.6106 acc=69.35% f1=59.57% auc=68.45% val_score=92.2030 val_score_bestthr=98.0869 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.310, mb=0.281, no=0.911, corr=-0.619) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 92.2030
[DBG][ep=019] disease_pos_weight=1.0000 mode=none
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.3078 mb_mean=0.2878 norm_overlap=0.9119 corr_cb=-0.6019 topkJ=0.0000
[TRAIN][ep=019] loss=0.5063 acc=66.67%
[TRAIN][ep=019] mask_avg: mc_mean=0.3045 mb_mean=0.2811 norm_overlap=0.8996 corr_cb=-0.6290
[EPOCH 019/089] train: loss=0.5063 acc=66.67% | val: loss=0.6097 acc=69.35% f1=59.57% auc=68.67% val_score=92.2030 val_score_bestthr=98.0869 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.305, mb=0.281, no=0.900, corr=-0.629) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 92.2030
[DBG][ep=020] disease_pos_weight=1.0000 mode=none
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.3052 mb_mean=0.2820 norm_overlap=0.8762 corr_cb=-0.7241 topkJ=0.0000
[TRAIN][ep=020] loss=0.4984 acc=67.39%
[TRAIN][ep=020] mask_avg: mc_mean=0.3012 mb_mean=0.2811 norm_overlap=0.8911 corr_cb=-0.6350
[EPOCH 020/089] train: loss=0.4984 acc=67.39% | val: loss=0.6072 acc=69.35% f1=53.66% auc=68.67% val_score=92.2030 val_score_bestthr=95.0988 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.301, mb=0.281, no=0.891, corr=-0.635) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 92.2030
[DBG][ep=021] disease_pos_weight=1.0000 mode=none
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2848 mb_mean=0.2762 norm_overlap=0.8971 corr_cb=-0.5380 topkJ=0.0000
[TRAIN][ep=021] loss=0.4915 acc=68.30%
[TRAIN][ep=021] mask_avg: mc_mean=0.2972 mb_mean=0.2811 norm_overlap=0.8824 corr_cb=-0.6359
[EPOCH 021/089] train: loss=0.4915 acc=68.30% | val: loss=0.6069 acc=69.35% f1=57.78% auc=68.90% val_score=91.4390 val_score_bestthr=97.1779 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.297, mb=0.281, no=0.882, corr=-0.636) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 91.4390
[DBG][ep=022] disease_pos_weight=1.0000 mode=none
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2948 mb_mean=0.2849 norm_overlap=0.8733 corr_cb=-0.6546 topkJ=0.0000
[TRAIN][ep=022] loss=0.4836 acc=70.47%
[TRAIN][ep=022] mask_avg: mc_mean=0.2944 mb_mean=0.2811 norm_overlap=0.8741 corr_cb=-0.6419
[EPOCH 022/089] train: loss=0.4836 acc=70.47% | val: loss=0.6056 acc=69.35% f1=55.81% auc=68.23% val_score=91.4390 val_score_bestthr=96.5670 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.294, mb=0.281, no=0.874, corr=-0.642) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 91.4390
[DBG][ep=023] disease_pos_weight=1.0000 mode=none
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2972 mb_mean=0.2692 norm_overlap=0.8388 corr_cb=-0.6843 topkJ=0.0000
[TRAIN][ep=023] loss=0.4761 acc=70.65%
[TRAIN][ep=023] mask_avg: mc_mean=0.2913 mb_mean=0.2811 norm_overlap=0.8680 corr_cb=-0.6370
[EPOCH 023/089] train: loss=0.4761 acc=70.65% | val: loss=0.6074 acc=69.35% f1=55.81% auc=68.12% val_score=91.4390 val_score_bestthr=96.5670 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.291, mb=0.281, no=0.868, corr=-0.637) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 91.4390
[DBG][ep=024] disease_pos_weight=1.0000 mode=none
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2928 mb_mean=0.2860 norm_overlap=0.8512 corr_cb=-0.7192 topkJ=0.0000
[TRAIN][ep=024] loss=0.4711 acc=71.74%
[TRAIN][ep=024] mask_avg: mc_mean=0.2885 mb_mean=0.2811 norm_overlap=0.8610 corr_cb=-0.6401
[EPOCH 024/089] train: loss=0.4711 acc=71.74% | val: loss=0.6147 acc=69.35% f1=55.81% auc=67.78% val_score=94.9544 val_score_bestthr=96.5670 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.288, mb=0.281, no=0.861, corr=-0.640) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 94.9544
[DBG][ep=025] disease_pos_weight=1.0000 mode=none
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2986 mb_mean=0.2791 norm_overlap=0.8195 corr_cb=-0.7727 topkJ=0.0000
[TRAIN][ep=025] loss=0.4642 acc=73.01%
[TRAIN][ep=025] mask_avg: mc_mean=0.2858 mb_mean=0.2811 norm_overlap=0.8543 corr_cb=-0.6426
[EPOCH 025/089] train: loss=0.4642 acc=73.01% | val: loss=0.6187 acc=70.97% f1=47.06% auc=67.34% val_score=94.9544 val_score_bestthr=93.5917 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.286, mb=0.281, no=0.854, corr=-0.643) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 94.9544
[DBG][ep=026] disease_pos_weight=1.0000 mode=none
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2826 mb_mean=0.2772 norm_overlap=0.8309 corr_cb=-0.6850 topkJ=0.0000
[TRAIN][ep=026] loss=0.4590 acc=72.83%
[TRAIN][ep=026] mask_avg: mc_mean=0.2832 mb_mean=0.2811 norm_overlap=0.8505 corr_cb=-0.6337
[EPOCH 026/089] train: loss=0.4590 acc=72.83% | val: loss=0.6151 acc=69.35% f1=59.57% auc=67.22% val_score=92.1977 val_score_bestthr=98.1494 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.283, mb=0.281, no=0.851, corr=-0.634) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 92.1977
[DBG][ep=027] disease_pos_weight=1.0000 mode=none
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2711 mb_mean=0.2875 norm_overlap=0.8872 corr_cb=-0.4723 topkJ=0.0000
[TRAIN][ep=027] loss=0.4501 acc=74.09%
[TRAIN][ep=027] mask_avg: mc_mean=0.2809 mb_mean=0.2811 norm_overlap=0.8429 corr_cb=-0.6411
[EPOCH 027/089] train: loss=0.4501 acc=74.09% | val: loss=0.6250 acc=69.35% f1=29.63% auc=66.56% val_score=84.3797 val_score_bestthr=83.5385 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.281, mb=0.281, no=0.843, corr=-0.641) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 84.3797
[DBG][ep=028] disease_pos_weight=1.0000 mode=none
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2754 mb_mean=0.2913 norm_overlap=0.8502 corr_cb=-0.6675 topkJ=0.0000
[TRAIN][ep=028] loss=0.4453 acc=73.73%
[TRAIN][ep=028] mask_avg: mc_mean=0.2789 mb_mean=0.2811 norm_overlap=0.8375 corr_cb=-0.6434
[EPOCH 028/089] train: loss=0.4453 acc=73.73% | val: loss=0.6225 acc=70.97% f1=50.00% auc=66.67% val_score=87.9226 val_score_bestthr=95.1280 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.279, mb=0.281, no=0.837, corr=-0.643) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 87.9226
[DBG][ep=029] disease_pos_weight=1.0000 mode=none
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2853 mb_mean=0.2851 norm_overlap=0.8330 corr_cb=-0.6835 topkJ=0.0000
[TRAIN][ep=029] loss=0.4350 acc=74.28%
[TRAIN][ep=029] mask_avg: mc_mean=0.2767 mb_mean=0.2811 norm_overlap=0.8326 corr_cb=-0.6448
[EPOCH 029/089] train: loss=0.4350 acc=74.28% | val: loss=0.6271 acc=69.35% f1=29.63% auc=65.44% val_score=87.9226 val_score_bestthr=83.5385 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.277, mb=0.281, no=0.833, corr=-0.645) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 87.9226
[DBG][ep=030] disease_pos_weight=1.0000 mode=none
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2753 mb_mean=0.2772 norm_overlap=0.8708 corr_cb=-0.5599 topkJ=0.0000
[TRAIN][ep=030] loss=0.4297 acc=75.18%
[TRAIN][ep=030] mask_avg: mc_mean=0.2740 mb_mean=0.2811 norm_overlap=0.8292 corr_cb=-0.6409
[EPOCH 030/089] train: loss=0.4297 acc=75.18% | val: loss=0.6337 acc=69.35% f1=45.71% auc=65.44% val_score=87.1500 val_score_bestthr=91.6603 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.274, mb=0.281, no=0.829, corr=-0.641) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 87.1500
[DBG][ep=031] disease_pos_weight=1.0000 mode=none
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2724 mb_mean=0.2917 norm_overlap=0.8567 corr_cb=-0.5657 topkJ=0.0000
[TRAIN][ep=031] loss=0.4196 acc=75.54%
[TRAIN][ep=031] mask_avg: mc_mean=0.2727 mb_mean=0.2811 norm_overlap=0.8254 corr_cb=-0.6470
[EPOCH 031/089] train: loss=0.4196 acc=75.54% | val: loss=0.6353 acc=69.35% f1=45.71% auc=65.55% val_score=89.3152 val_score_bestthr=91.6603 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.273, mb=0.281, no=0.825, corr=-0.647) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 89.3152
[DBG][ep=032] disease_pos_weight=1.0000 mode=none
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2811 mb_mean=0.2865 norm_overlap=0.8348 corr_cb=-0.6895 topkJ=0.0000
[TRAIN][ep=032] loss=0.4190 acc=76.09%
[TRAIN][ep=032] mask_avg: mc_mean=0.2727 mb_mean=0.2811 norm_overlap=0.8254 corr_cb=-0.6449
[EPOCH 032/089] train: loss=0.4190 acc=76.09% | val: loss=0.6365 acc=69.35% f1=45.71% auc=65.22% val_score=89.3152 val_score_bestthr=91.6603 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.273, mb=0.281, no=0.825, corr=-0.645) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 89.3152
[DBG][ep=033] disease_pos_weight=1.0000 mode=none
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2815 mb_mean=0.2815 norm_overlap=0.7925 corr_cb=-0.7179 topkJ=0.0000
[TRAIN][ep=033] loss=0.4170 acc=76.09%
[TRAIN][ep=033] mask_avg: mc_mean=0.2727 mb_mean=0.2811 norm_overlap=0.8254 corr_cb=-0.6463
[EPOCH 033/089] train: loss=0.4170 acc=76.09% | val: loss=0.6375 acc=69.35% f1=48.65% auc=65.44% val_score=89.3152 val_score_bestthr=92.8150 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.273, mb=0.281, no=0.825, corr=-0.646) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 89.3152
[DBG][ep=034] disease_pos_weight=1.0000 mode=none
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2758 mb_mean=0.2836 norm_overlap=0.7942 corr_cb=-0.7355 topkJ=0.0000
[TRAIN][ep=034] loss=0.4154 acc=76.45%
[TRAIN][ep=034] mask_avg: mc_mean=0.2727 mb_mean=0.2811 norm_overlap=0.8252 corr_cb=-0.6474
[EPOCH 034/089] train: loss=0.4154 acc=76.45% | val: loss=0.6393 acc=69.35% f1=48.65% auc=65.55% val_score=89.3152 val_score_bestthr=92.8150 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.273, mb=0.281, no=0.825, corr=-0.647) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 89.3152
[DBG][ep=035] disease_pos_weight=1.0000 mode=none
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2814 mb_mean=0.2763 norm_overlap=0.7981 corr_cb=-0.6841 topkJ=0.0000
[TRAIN][ep=035] loss=0.4135 acc=75.54%
[TRAIN][ep=035] mask_avg: mc_mean=0.2727 mb_mean=0.2811 norm_overlap=0.8253 corr_cb=-0.6457
[EPOCH 035/089] train: loss=0.4135 acc=75.54% | val: loss=0.6406 acc=69.35% f1=48.65% auc=64.99% val_score=90.1507 val_score_bestthr=92.8150 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.273, mb=0.281, no=0.825, corr=-0.646) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 90.1507
[DBG][ep=036] disease_pos_weight=1.0000 mode=none
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2852 mb_mean=0.2605 norm_overlap=0.7728 corr_cb=-0.6978 topkJ=0.0000
[TRAIN][ep=036] loss=0.4121 acc=76.99%
[TRAIN][ep=036] mask_avg: mc_mean=0.2727 mb_mean=0.2811 norm_overlap=0.8252 corr_cb=-0.6468
[EPOCH 036/089] train: loss=0.4121 acc=76.99% | val: loss=0.6417 acc=69.35% f1=29.63% auc=65.33% val_score=92.3489 val_score_bestthr=83.5385 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.273, mb=0.281, no=0.825, corr=-0.647) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 92.3489
[EARLY STOP] no improvement for 30 epochs. best_epoch=6
[CKPT] Loaded best for testing: results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
=============== FIT DONE ===============
[BEST] epoch=6 | val_acc=77.42% | val_f1=63.16% | val_auc=78.26% | val_score=108.2133 | val_score_bestthr=108.2133
[TEST@BEST] thr_used=0.370 | acc=64.05% f1=12.70% auc=58.62% | SP_sex=4.78% EO_sex=0.72% SP_age=4.21% EO_age=16.67%
[TIME] 0.63 min
[OK] Saved: results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/summary_fold_2.json
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4496 mb_mean=0.4946 norm_overlap=1.0001 corr_cb=0.1679 topkJ=0.0819
[TRAIN][ep=000] loss=0.6686 acc=63.77%
[TRAIN][ep=000] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0415
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4515 mb_mean=0.4949 norm_overlap=1.0000 corr_cb=0.0438 topkJ=0.0912
[TRAIN][ep=001] loss=0.6628 acc=63.77%
[TRAIN][ep=001] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0393
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4501 mb_mean=0.4947 norm_overlap=1.0000 corr_cb=0.0147 topkJ=0.0889
[TRAIN][ep=002] loss=0.6586 acc=63.77%
[TRAIN][ep=002] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0412
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4523 mb_mean=0.4943 norm_overlap=1.0001 corr_cb=0.1587 topkJ=0.0969
[TRAIN][ep=003] loss=0.6564 acc=63.77%
[TRAIN][ep=003] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0415
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4502 mb_mean=0.4945 norm_overlap=0.9999 corr_cb=-0.0905 topkJ=0.0338
[TRAIN][ep=004] loss=0.6548 acc=63.77%
[TRAIN][ep=004] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0389
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4510 mb_mean=0.4956 norm_overlap=1.0001 corr_cb=0.0918 topkJ=0.0948
[TRAIN][ep=005] loss=0.6537 acc=63.77%
[TRAIN][ep=005] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0387
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4523 mb_mean=0.4929 norm_overlap=1.0000 corr_cb=-0.0175 topkJ=0.0527
[TRAIN][ep=006] loss=0.6527 acc=63.77%
[TRAIN][ep=006] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0407
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4503 mb_mean=0.4943 norm_overlap=0.9999 corr_cb=-0.0701 topkJ=0.0588
[TRAIN][ep=007] loss=0.6516 acc=63.77%
[TRAIN][ep=007] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0395
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4515 mb_mean=0.4937 norm_overlap=1.0000 corr_cb=0.0577 topkJ=0.0890
[TRAIN][ep=008] loss=0.6511 acc=63.77%
[TRAIN][ep=008] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0414
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4511 mb_mean=0.4927 norm_overlap=1.0000 corr_cb=0.0201 topkJ=0.0884
[TRAIN][ep=009] loss=0.6495 acc=63.77%
[TRAIN][ep=009] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0422
================= FIT START (fold=2) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.35 select_by=val_score | eval_thr_mode=best_acc eval_thr_grid=coarse | disease_pos_weight_mode=none freeze_b_after=15 | two_stage=True stage1_ratio=0.35 stage2_lr_mult=0.3 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4516 mb_mean=0.4954 norm_overlap=1.0000 corr_cb=0.0570 topkJ=0.0440
[TRAIN][ep=000] loss=0.6485 acc=63.77%
[TRAIN][ep=000] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0407
[EPOCH 000/089] train: loss=0.6485 acc=63.77% | val: loss=0.6475 acc=77.42% f1=68.18% auc=77.70% val_score=71.7916 val_score_bestthr=111.0593 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.450, mb=0.495, no=1.000, corr=0.041) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* -1000000000000000000.0000 -> 71.7916
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4492 mb_mean=0.4950 norm_overlap=0.9998 corr_cb=-0.1808 topkJ=0.0441
[TRAIN][ep=001] loss=0.6468 acc=63.77%
[TRAIN][ep=001] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0400
[EPOCH 001/089] train: loss=0.6468 acc=63.77% | val: loss=0.6459 acc=75.81% f1=61.54% auc=77.37% val_score=81.9038 val_score_bestthr=105.8383 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.450, mb=0.495, no=1.000, corr=0.040) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 71.7916 -> 81.9038
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4508 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=-0.0404 topkJ=0.0832
[TRAIN][ep=002] loss=0.6455 acc=63.77%
[TRAIN][ep=002] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0410
[EPOCH 002/089] train: loss=0.6455 acc=63.77% | val: loss=0.6446 acc=75.81% f1=61.54% auc=76.70% val_score=81.9133 val_score_bestthr=105.8383 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.450, mb=0.495, no=1.000, corr=0.041) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 81.9038 -> 81.9133
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4487 mb_mean=0.4952 norm_overlap=0.9999 corr_cb=-0.0570 topkJ=0.0462
[TRAIN][ep=003] loss=0.6439 acc=63.77%
[TRAIN][ep=003] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0400
[EPOCH 003/089] train: loss=0.6439 acc=63.77% | val: loss=0.6432 acc=74.19% f1=65.22% auc=76.03% val_score=95.8460 val_score_bestthr=106.3227 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.450, mb=0.495, no=1.000, corr=0.040) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 81.9133 -> 95.8460
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4503 mb_mean=0.4944 norm_overlap=1.0001 corr_cb=0.1213 topkJ=0.0789
[TRAIN][ep=004] loss=0.6428 acc=63.77%
[TRAIN][ep=004] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0380
[EPOCH 004/089] train: loss=0.6428 acc=63.77% | val: loss=0.6419 acc=72.58% f1=65.31% auc=74.92% val_score=75.8743 val_score_bestthr=104.5399 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.450, mb=0.495, no=1.000, corr=0.038) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 95.8460 -> 75.8743
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4518 mb_mean=0.4941 norm_overlap=1.0000 corr_cb=-0.0020 topkJ=0.0603
[TRAIN][ep=005] loss=2.1246 acc=63.77%
[TRAIN][ep=005] mask_avg: mc_mean=0.4466 mb_mean=0.4885 norm_overlap=0.9999 corr_cb=-0.0528
[EPOCH 005/089] train: loss=2.1246 acc=63.77% | val: loss=0.6449 acc=75.81% f1=63.41% auc=78.15% val_score=89.5431 val_score_bestthr=106.7062 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.447, mb=0.488, no=1.000, corr=-0.053) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 95.8460 -> 89.5431
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4424 mb_mean=0.4812 norm_overlap=0.9999 corr_cb=-0.1086 topkJ=0.0269
[TRAIN][ep=006] loss=1.4190 acc=63.77%
[TRAIN][ep=006] mask_avg: mc_mean=0.4377 mb_mean=0.4745 norm_overlap=1.0000 corr_cb=0.0170
[EPOCH 006/089] train: loss=1.4190 acc=63.77% | val: loss=0.6428 acc=75.81% f1=59.46% auc=78.26% val_score=104.8367 val_score_bestthr=104.8367 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.438, mb=0.474, no=1.000, corr=0.017) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 95.8460 -> 104.8367
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4336 mb_mean=0.4656 norm_overlap=1.0002 corr_cb=0.1565 topkJ=0.0748
[TRAIN][ep=007] loss=0.7279 acc=63.77%
[TRAIN][ep=007] mask_avg: mc_mean=0.4271 mb_mean=0.4579 norm_overlap=1.0004 corr_cb=0.1977
[EPOCH 007/089] train: loss=0.7279 acc=63.77% | val: loss=0.6409 acc=74.19% f1=60.00% auc=77.59% val_score=102.2972 val_score_bestthr=103.4818 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.427, mb=0.458, no=1.000, corr=0.198) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 104.8367 -> 102.2972
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4201 mb_mean=0.4467 norm_overlap=1.0010 corr_cb=0.4331 topkJ=0.1046
[TRAIN][ep=008] loss=0.5763 acc=63.77%
[TRAIN][ep=008] mask_avg: mc_mean=0.4152 mb_mean=0.4377 norm_overlap=1.0009 corr_cb=0.2798
[EPOCH 008/089] train: loss=0.5763 acc=63.77% | val: loss=0.6394 acc=75.81% f1=61.54% auc=76.59% val_score=100.0574 val_score_bestthr=105.8383 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.415, mb=0.438, no=1.001, corr=0.280) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 104.8367 -> 100.0574
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4120 mb_mean=0.4322 norm_overlap=1.0009 corr_cb=0.2473 topkJ=0.0702
[TRAIN][ep=009] loss=0.5711 acc=63.77%
[TRAIN][ep=009] mask_avg: mc_mean=0.4023 mb_mean=0.4133 norm_overlap=1.0018 corr_cb=0.2920
[EPOCH 009/089] train: loss=0.5711 acc=63.77% | val: loss=0.6375 acc=74.19% f1=63.64% auc=75.36% val_score=97.8049 val_score_bestthr=105.5917 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.402, mb=0.413, no=1.002, corr=0.292) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 104.8367 -> 97.8049
[DBG][ep=010] disease_pos_weight=1.0000 mode=none
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.3969 mb_mean=0.4015 norm_overlap=1.0013 corr_cb=0.1723 topkJ=0.0427
[TRAIN][ep=010] loss=0.5664 acc=63.77%
[TRAIN][ep=010] mask_avg: mc_mean=0.3892 mb_mean=0.3859 norm_overlap=1.0028 corr_cb=0.2670
[EPOCH 010/089] train: loss=0.5664 acc=63.77% | val: loss=0.6356 acc=72.58% f1=48.48% auc=74.02% val_score=97.1845 val_score_bestthr=95.8932 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.389, mb=0.386, no=1.003, corr=0.267) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 104.8367 -> 97.1845
[DBG][ep=011] disease_pos_weight=1.0000 mode=none
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.3785 mb_mean=0.3646 norm_overlap=1.0038 corr_cb=0.2720 topkJ=0.0627
[TRAIN][ep=011] loss=0.5604 acc=63.77%
[TRAIN][ep=011] mask_avg: mc_mean=0.3759 mb_mean=0.3581 norm_overlap=1.0023 corr_cb=0.1306
[EPOCH 011/089] train: loss=0.5604 acc=63.77% | val: loss=0.6329 acc=70.97% f1=60.87% auc=72.58% val_score=97.5367 val_score_bestthr=100.7374 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.376, mb=0.358, no=1.002, corr=0.131) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 104.8367 -> 97.5367
[DBG][ep=012] disease_pos_weight=1.0000 mode=none
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.3708 mb_mean=0.3539 norm_overlap=1.0033 corr_cb=0.1530 topkJ=0.0294
[TRAIN][ep=012] loss=0.5553 acc=63.77%
[TRAIN][ep=012] mask_avg: mc_mean=0.3630 mb_mean=0.3325 norm_overlap=0.9985 corr_cb=-0.0493
[EPOCH 012/089] train: loss=0.5553 acc=63.77% | val: loss=0.6304 acc=72.58% f1=48.48% auc=71.68% val_score=92.3401 val_score_bestthr=95.8932 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.363, mb=0.332, no=0.998, corr=-0.049) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 104.8367 -> 92.3401
[DBG][ep=013] disease_pos_weight=1.0000 mode=none
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.3599 mb_mean=0.3236 norm_overlap=0.9904 corr_cb=-0.2793 topkJ=0.0062
[TRAIN][ep=013] loss=0.5471 acc=63.95%
[TRAIN][ep=013] mask_avg: mc_mean=0.3513 mb_mean=0.3101 norm_overlap=0.9888 corr_cb=-0.2383
[EPOCH 013/089] train: loss=0.5471 acc=63.95% | val: loss=0.6275 acc=72.58% f1=48.48% auc=70.35% val_score=101.3341 val_score_bestthr=95.8932 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.351, mb=0.310, no=0.989, corr=-0.238) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 104.8367 -> 101.3341
[DBG][ep=014] disease_pos_weight=1.0000 mode=none
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.3510 mb_mean=0.3150 norm_overlap=0.9722 corr_cb=-0.5314 topkJ=0.0012
[TRAIN][ep=014] loss=0.5400 acc=63.77%
[TRAIN][ep=014] mask_avg: mc_mean=0.3393 mb_mean=0.2904 norm_overlap=0.9676 corr_cb=-0.4357
[EPOCH 014/089] train: loss=0.5400 acc=63.77% | val: loss=0.6248 acc=70.97% f1=47.06% auc=69.12% val_score=96.7981 val_score_bestthr=93.5917 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.339, mb=0.290, no=0.968, corr=-0.436) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 104.8367 -> 96.7981
[DBG][ep=015] disease_pos_weight=1.0000 mode=none
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.3332 mb_mean=0.2861 norm_overlap=0.9641 corr_cb=-0.4921 topkJ=0.0025
[TRAIN][ep=015] loss=0.5323 acc=64.49%
[TRAIN][ep=015] mask_avg: mc_mean=0.3297 mb_mean=0.2812 norm_overlap=0.9471 corr_cb=-0.5499
[EPOCH 015/089] train: loss=0.5323 acc=64.49% | val: loss=0.6206 acc=70.97% f1=47.06% auc=69.12% val_score=94.5726 val_score_bestthr=93.5917 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.330, mb=0.281, no=0.947, corr=-0.550) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 94.5726
[DBG][ep=016] disease_pos_weight=1.0000 mode=none
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.3080 mb_mean=0.2571 norm_overlap=0.9472 corr_cb=-0.3089 topkJ=0.0028
[TRAIN][ep=016] loss=0.5250 acc=65.94%
[TRAIN][ep=016] mask_avg: mc_mean=0.3208 mb_mean=0.2812 norm_overlap=0.9330 corr_cb=-0.5873
[EPOCH 016/089] train: loss=0.5250 acc=65.94% | val: loss=0.6174 acc=69.35% f1=42.42% auc=68.12% val_score=95.2841 val_score_bestthr=89.5371 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.321, mb=0.281, no=0.933, corr=-0.587) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 95.2841
[DBG][ep=017] disease_pos_weight=1.0000 mode=none
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.3071 mb_mean=0.2757 norm_overlap=0.9343 corr_cb=-0.4763 topkJ=0.0000
[TRAIN][ep=017] loss=0.5188 acc=66.49%
[TRAIN][ep=017] mask_avg: mc_mean=0.3141 mb_mean=0.2812 norm_overlap=0.9195 corr_cb=-0.6158
[EPOCH 017/089] train: loss=0.5188 acc=66.49% | val: loss=0.6146 acc=70.97% f1=47.06% auc=69.01% val_score=95.7411 val_score_bestthr=93.5917 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.314, mb=0.281, no=0.919, corr=-0.616) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 95.7411
[DBG][ep=018] disease_pos_weight=1.0000 mode=none
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.3112 mb_mean=0.2894 norm_overlap=0.9143 corr_cb=-0.6433 topkJ=0.0000
[TRAIN][ep=018] loss=0.5119 acc=67.21%
[TRAIN][ep=018] mask_avg: mc_mean=0.3087 mb_mean=0.2812 norm_overlap=0.9100 corr_cb=-0.6214
[EPOCH 018/089] train: loss=0.5119 acc=67.21% | val: loss=0.6106 acc=69.35% f1=59.57% auc=68.56% val_score=92.2030 val_score_bestthr=98.0869 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.309, mb=0.281, no=0.910, corr=-0.621) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 92.2030
[DBG][ep=019] disease_pos_weight=1.0000 mode=none
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.3068 mb_mean=0.2879 norm_overlap=0.9105 corr_cb=-0.6050 topkJ=0.0000
[TRAIN][ep=019] loss=0.5060 acc=66.67%
[TRAIN][ep=019] mask_avg: mc_mean=0.3036 mb_mean=0.2812 norm_overlap=0.8980 corr_cb=-0.6317
[EPOCH 019/089] train: loss=0.5060 acc=66.67% | val: loss=0.6097 acc=69.35% f1=59.57% auc=68.56% val_score=92.2030 val_score_bestthr=98.0869 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.304, mb=0.281, no=0.898, corr=-0.632) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 92.2030
[DBG][ep=020] disease_pos_weight=1.0000 mode=none
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.3044 mb_mean=0.2821 norm_overlap=0.8744 corr_cb=-0.7265 topkJ=0.0000
[TRAIN][ep=020] loss=0.4980 acc=67.39%
[TRAIN][ep=020] mask_avg: mc_mean=0.3003 mb_mean=0.2812 norm_overlap=0.8895 corr_cb=-0.6377
[EPOCH 020/089] train: loss=0.4980 acc=67.39% | val: loss=0.6072 acc=69.35% f1=53.66% auc=68.67% val_score=92.2030 val_score_bestthr=95.0988 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.300, mb=0.281, no=0.889, corr=-0.638) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 92.2030
[DBG][ep=021] disease_pos_weight=1.0000 mode=none
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2839 mb_mean=0.2764 norm_overlap=0.8953 corr_cb=-0.5426 topkJ=0.0000
[TRAIN][ep=021] loss=0.4911 acc=68.48%
[TRAIN][ep=021] mask_avg: mc_mean=0.2964 mb_mean=0.2812 norm_overlap=0.8808 corr_cb=-0.6385
[EPOCH 021/089] train: loss=0.4911 acc=68.48% | val: loss=0.6070 acc=69.35% f1=57.78% auc=68.90% val_score=91.4390 val_score_bestthr=97.1779 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.296, mb=0.281, no=0.881, corr=-0.638) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 91.4390
[DBG][ep=022] disease_pos_weight=1.0000 mode=none
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2941 mb_mean=0.2849 norm_overlap=0.8715 corr_cb=-0.6572 topkJ=0.0000
[TRAIN][ep=022] loss=0.4832 acc=70.29%
[TRAIN][ep=022] mask_avg: mc_mean=0.2936 mb_mean=0.2812 norm_overlap=0.8725 corr_cb=-0.6444
[EPOCH 022/089] train: loss=0.4832 acc=70.29% | val: loss=0.6058 acc=69.35% f1=55.81% auc=68.12% val_score=91.4390 val_score_bestthr=96.5670 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.294, mb=0.281, no=0.872, corr=-0.644) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 91.4390
[DBG][ep=023] disease_pos_weight=1.0000 mode=none
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2966 mb_mean=0.2693 norm_overlap=0.8367 corr_cb=-0.6865 topkJ=0.0000
[TRAIN][ep=023] loss=0.4757 acc=70.65%
[TRAIN][ep=023] mask_avg: mc_mean=0.2906 mb_mean=0.2812 norm_overlap=0.8663 corr_cb=-0.6394
[EPOCH 023/089] train: loss=0.4757 acc=70.65% | val: loss=0.6076 acc=69.35% f1=55.81% auc=68.12% val_score=91.4390 val_score_bestthr=96.5670 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.291, mb=0.281, no=0.866, corr=-0.639) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 91.4390
[DBG][ep=024] disease_pos_weight=1.0000 mode=none
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2922 mb_mean=0.2861 norm_overlap=0.8493 corr_cb=-0.7212 topkJ=0.0000
[TRAIN][ep=024] loss=0.4707 acc=71.74%
[TRAIN][ep=024] mask_avg: mc_mean=0.2878 mb_mean=0.2812 norm_overlap=0.8594 corr_cb=-0.6424
[EPOCH 024/089] train: loss=0.4707 acc=71.74% | val: loss=0.6151 acc=69.35% f1=55.81% auc=67.78% val_score=94.9544 val_score_bestthr=96.5670 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.288, mb=0.281, no=0.859, corr=-0.642) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 94.9544
[DBG][ep=025] disease_pos_weight=1.0000 mode=none
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2981 mb_mean=0.2792 norm_overlap=0.8175 corr_cb=-0.7742 topkJ=0.0000
[TRAIN][ep=025] loss=0.4637 acc=72.64%
[TRAIN][ep=025] mask_avg: mc_mean=0.2852 mb_mean=0.2812 norm_overlap=0.8526 corr_cb=-0.6448
[EPOCH 025/089] train: loss=0.4637 acc=72.64% | val: loss=0.6191 acc=70.97% f1=47.06% auc=67.34% val_score=94.9544 val_score_bestthr=93.5917 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.285, mb=0.281, no=0.853, corr=-0.645) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 94.9544
[DBG][ep=026] disease_pos_weight=1.0000 mode=none
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2820 mb_mean=0.2773 norm_overlap=0.8291 corr_cb=-0.6865 topkJ=0.0000
[TRAIN][ep=026] loss=0.4585 acc=72.83%
[TRAIN][ep=026] mask_avg: mc_mean=0.2826 mb_mean=0.2812 norm_overlap=0.8489 corr_cb=-0.6359
[EPOCH 026/089] train: loss=0.4585 acc=72.83% | val: loss=0.6155 acc=69.35% f1=59.57% auc=67.22% val_score=92.1977 val_score_bestthr=98.1494 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.283, mb=0.281, no=0.849, corr=-0.636) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 92.1977
[DBG][ep=027] disease_pos_weight=1.0000 mode=none
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2705 mb_mean=0.2876 norm_overlap=0.8853 corr_cb=-0.4764 topkJ=0.0000
[TRAIN][ep=027] loss=0.4496 acc=73.91%
[TRAIN][ep=027] mask_avg: mc_mean=0.2803 mb_mean=0.2812 norm_overlap=0.8412 corr_cb=-0.6431
[EPOCH 027/089] train: loss=0.4496 acc=73.91% | val: loss=0.6256 acc=69.35% f1=29.63% auc=66.44% val_score=84.3797 val_score_bestthr=83.5385 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.280, mb=0.281, no=0.841, corr=-0.643) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 84.3797
[DBG][ep=028] disease_pos_weight=1.0000 mode=none
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2748 mb_mean=0.2914 norm_overlap=0.8483 corr_cb=-0.6701 topkJ=0.0000
[TRAIN][ep=028] loss=0.4448 acc=73.73%
[TRAIN][ep=028] mask_avg: mc_mean=0.2783 mb_mean=0.2812 norm_overlap=0.8358 corr_cb=-0.6453
[EPOCH 028/089] train: loss=0.4448 acc=73.73% | val: loss=0.6231 acc=70.97% f1=50.00% auc=66.44% val_score=87.9226 val_score_bestthr=95.1280 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.278, mb=0.281, no=0.836, corr=-0.645) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 87.9226
[DBG][ep=029] disease_pos_weight=1.0000 mode=none
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2848 mb_mean=0.2853 norm_overlap=0.8313 corr_cb=-0.6856 topkJ=0.0000
[TRAIN][ep=029] loss=0.4345 acc=74.28%
[TRAIN][ep=029] mask_avg: mc_mean=0.2761 mb_mean=0.2812 norm_overlap=0.8310 corr_cb=-0.6466
[EPOCH 029/089] train: loss=0.4345 acc=74.28% | val: loss=0.6278 acc=69.35% f1=29.63% auc=65.55% val_score=87.9226 val_score_bestthr=83.5385 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.276, mb=0.281, no=0.831, corr=-0.647) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 87.9226
[DBG][ep=030] disease_pos_weight=1.0000 mode=none
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2746 mb_mean=0.2773 norm_overlap=0.8700 corr_cb=-0.5605 topkJ=0.0000
[TRAIN][ep=030] loss=0.4292 acc=75.18%
[TRAIN][ep=030] mask_avg: mc_mean=0.2735 mb_mean=0.2812 norm_overlap=0.8276 corr_cb=-0.6427
[EPOCH 030/089] train: loss=0.4292 acc=75.18% | val: loss=0.6344 acc=69.35% f1=45.71% auc=65.44% val_score=87.1500 val_score_bestthr=91.6603 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.273, mb=0.281, no=0.828, corr=-0.643) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 87.1500
[DBG][ep=031] disease_pos_weight=1.0000 mode=none
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2719 mb_mean=0.2918 norm_overlap=0.8549 corr_cb=-0.5686 topkJ=0.0000
[TRAIN][ep=031] loss=0.4190 acc=75.54%
[TRAIN][ep=031] mask_avg: mc_mean=0.2722 mb_mean=0.2813 norm_overlap=0.8237 corr_cb=-0.6487
[EPOCH 031/089] train: loss=0.4190 acc=75.54% | val: loss=0.6361 acc=69.35% f1=45.71% auc=65.44% val_score=89.3152 val_score_bestthr=91.6603 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.272, mb=0.281, no=0.824, corr=-0.649) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 89.3152
[DBG][ep=032] disease_pos_weight=1.0000 mode=none
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2805 mb_mean=0.2866 norm_overlap=0.8336 corr_cb=-0.6906 topkJ=0.0000
[TRAIN][ep=032] loss=0.4185 acc=75.91%
[TRAIN][ep=032] mask_avg: mc_mean=0.2722 mb_mean=0.2812 norm_overlap=0.8237 corr_cb=-0.6466
[EPOCH 032/089] train: loss=0.4185 acc=75.91% | val: loss=0.6373 acc=69.35% f1=45.71% auc=65.33% val_score=89.3152 val_score_bestthr=91.6603 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.272, mb=0.281, no=0.824, corr=-0.647) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 89.3152
[DBG][ep=033] disease_pos_weight=1.0000 mode=none
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2812 mb_mean=0.2815 norm_overlap=0.7903 corr_cb=-0.7195 topkJ=0.0000
[TRAIN][ep=033] loss=0.4164 acc=76.09%
[TRAIN][ep=033] mask_avg: mc_mean=0.2722 mb_mean=0.2812 norm_overlap=0.8238 corr_cb=-0.6480
[EPOCH 033/089] train: loss=0.4164 acc=76.09% | val: loss=0.6383 acc=69.35% f1=48.65% auc=65.33% val_score=89.3152 val_score_bestthr=92.8150 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.272, mb=0.281, no=0.824, corr=-0.648) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 89.3152
[DBG][ep=034] disease_pos_weight=1.0000 mode=none
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2754 mb_mean=0.2836 norm_overlap=0.7923 corr_cb=-0.7370 topkJ=0.0000
[TRAIN][ep=034] loss=0.4148 acc=76.27%
[TRAIN][ep=034] mask_avg: mc_mean=0.2722 mb_mean=0.2812 norm_overlap=0.8235 corr_cb=-0.6492
[EPOCH 034/089] train: loss=0.4148 acc=76.27% | val: loss=0.6401 acc=69.35% f1=48.65% auc=65.44% val_score=89.3152 val_score_bestthr=92.8150 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.272, mb=0.281, no=0.824, corr=-0.649) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 89.3152
[DBG][ep=035] disease_pos_weight=1.0000 mode=none
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2810 mb_mean=0.2764 norm_overlap=0.7961 corr_cb=-0.6860 topkJ=0.0000
[TRAIN][ep=035] loss=0.4130 acc=75.54%
[TRAIN][ep=035] mask_avg: mc_mean=0.2722 mb_mean=0.2812 norm_overlap=0.8236 corr_cb=-0.6475
[EPOCH 035/089] train: loss=0.4130 acc=75.54% | val: loss=0.6415 acc=69.35% f1=48.65% auc=64.88% val_score=90.1507 val_score_bestthr=92.8150 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.272, mb=0.281, no=0.824, corr=-0.647) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 90.1507
[DBG][ep=036] disease_pos_weight=1.0000 mode=none
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2847 mb_mean=0.2606 norm_overlap=0.7712 corr_cb=-0.6984 topkJ=0.0000
[TRAIN][ep=036] loss=0.4116 acc=76.81%
[TRAIN][ep=036] mask_avg: mc_mean=0.2722 mb_mean=0.2812 norm_overlap=0.8236 corr_cb=-0.6485
[EPOCH 036/089] train: loss=0.4116 acc=76.81% | val: loss=0.6425 acc=69.35% f1=29.63% auc=65.11% val_score=92.3489 val_score_bestthr=83.5385 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.272, mb=0.281, no=0.824, corr=-0.648) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 104.8367 -> 92.3489
[EARLY STOP] no improvement for 30 epochs. best_epoch=6
[CKPT] Loaded best for testing: results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
=============== FIT DONE ===============
[BEST] epoch=6 | val_acc=75.81% | val_f1=59.46% | val_auc=78.26% | val_score=104.8367 | val_score_bestthr=104.8367
[TEST@BEST] thr_used=0.370 | acc=63.40% f1=9.68% auc=58.60% | SP_sex=3.71% EO_sex=3.04% SP_age=3.67% EO_age=16.67%
[TIME] 0.61 min
[OK] Saved: results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/summary_fold_2.json
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4496 mb_mean=0.4946 norm_overlap=1.0001 corr_cb=0.1679 topkJ=0.0819
[TRAIN][ep=000] loss=0.6686 acc=63.77%
[TRAIN][ep=000] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0415
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4515 mb_mean=0.4949 norm_overlap=1.0000 corr_cb=0.0438 topkJ=0.0912
[TRAIN][ep=001] loss=0.6628 acc=63.77%
[TRAIN][ep=001] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0393
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4501 mb_mean=0.4947 norm_overlap=1.0000 corr_cb=0.0147 topkJ=0.0889
[TRAIN][ep=002] loss=0.6586 acc=63.77%
[TRAIN][ep=002] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0412
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4523 mb_mean=0.4943 norm_overlap=1.0001 corr_cb=0.1587 topkJ=0.0969
[TRAIN][ep=003] loss=0.6564 acc=63.77%
[TRAIN][ep=003] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0415
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4502 mb_mean=0.4945 norm_overlap=0.9999 corr_cb=-0.0905 topkJ=0.0338
[TRAIN][ep=004] loss=0.6548 acc=63.77%
[TRAIN][ep=004] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0389
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4510 mb_mean=0.4956 norm_overlap=1.0001 corr_cb=0.0918 topkJ=0.0948
[TRAIN][ep=005] loss=0.6537 acc=63.77%
[TRAIN][ep=005] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0387
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4523 mb_mean=0.4929 norm_overlap=1.0000 corr_cb=-0.0175 topkJ=0.0527
[TRAIN][ep=006] loss=0.6527 acc=63.77%
[TRAIN][ep=006] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0407
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4503 mb_mean=0.4943 norm_overlap=0.9999 corr_cb=-0.0701 topkJ=0.0588
[TRAIN][ep=007] loss=0.6516 acc=63.77%
[TRAIN][ep=007] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0395
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4515 mb_mean=0.4937 norm_overlap=1.0000 corr_cb=0.0577 topkJ=0.0890
[TRAIN][ep=008] loss=0.6511 acc=63.77%
[TRAIN][ep=008] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0414
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4511 mb_mean=0.4927 norm_overlap=1.0000 corr_cb=0.0201 topkJ=0.0884
[TRAIN][ep=009] loss=0.6495 acc=63.77%
[TRAIN][ep=009] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0422
================= FIT START (fold=2) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.35 select_by=val_score | eval_thr_mode=best_acc eval_thr_grid=coarse | disease_pos_weight_mode=none freeze_b_after=15 | two_stage=True stage1_ratio=0.35 stage2_lr_mult=0.3 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4516 mb_mean=0.4954 norm_overlap=1.0000 corr_cb=0.0570 topkJ=0.0440
[TRAIN][ep=000] loss=0.6485 acc=63.77%
[TRAIN][ep=000] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0407
[EPOCH 000/089] train: loss=0.6485 acc=63.77% | val: loss=0.6475 acc=77.42% f1=68.18% auc=77.70% val_score=71.7916 val_score_bestthr=111.0593 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.450, mb=0.495, no=1.000, corr=0.041) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* -1000000000000000000.0000 -> 71.7916
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4492 mb_mean=0.4950 norm_overlap=0.9998 corr_cb=-0.1808 topkJ=0.0441
[TRAIN][ep=001] loss=0.6468 acc=63.77%
[TRAIN][ep=001] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0400
[EPOCH 001/089] train: loss=0.6468 acc=63.77% | val: loss=0.6459 acc=75.81% f1=61.54% auc=77.37% val_score=81.9038 val_score_bestthr=105.8383 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.450, mb=0.495, no=1.000, corr=0.040) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 71.7916 -> 81.9038
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4508 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=-0.0404 topkJ=0.0832
[TRAIN][ep=002] loss=0.6455 acc=63.77%
[TRAIN][ep=002] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0410
[EPOCH 002/089] train: loss=0.6455 acc=63.77% | val: loss=0.6446 acc=75.81% f1=61.54% auc=76.70% val_score=81.9133 val_score_bestthr=105.8383 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.450, mb=0.495, no=1.000, corr=0.041) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 81.9038 -> 81.9133
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4487 mb_mean=0.4952 norm_overlap=0.9999 corr_cb=-0.0570 topkJ=0.0462
[TRAIN][ep=003] loss=0.6439 acc=63.77%
[TRAIN][ep=003] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0400
[EPOCH 003/089] train: loss=0.6439 acc=63.77% | val: loss=0.6432 acc=74.19% f1=65.22% auc=76.03% val_score=95.8460 val_score_bestthr=106.3227 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.450, mb=0.495, no=1.000, corr=0.040) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 81.9133 -> 95.8460
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4503 mb_mean=0.4944 norm_overlap=1.0001 corr_cb=0.1213 topkJ=0.0789
[TRAIN][ep=004] loss=0.6428 acc=63.77%
[TRAIN][ep=004] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0380
[EPOCH 004/089] train: loss=0.6428 acc=63.77% | val: loss=0.6419 acc=72.58% f1=65.31% auc=74.92% val_score=75.8743 val_score_bestthr=104.5399 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.450, mb=0.495, no=1.000, corr=0.038) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 95.8460 -> 75.8743
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4518 mb_mean=0.4941 norm_overlap=1.0000 corr_cb=-0.0020 topkJ=0.0603
[TRAIN][ep=005] loss=1.4547 acc=63.77%
[TRAIN][ep=005] mask_avg: mc_mean=0.4460 mb_mean=0.4761 norm_overlap=1.0000 corr_cb=0.0086
[EPOCH 005/089] train: loss=1.4547 acc=63.77% | val: loss=0.6443 acc=77.42% f1=63.16% auc=77.70% val_score=97.9107 val_score_bestthr=108.2133 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.446, mb=0.476, no=1.000, corr=0.009) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 95.8460 -> 97.9107
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4413 mb_mean=0.4588 norm_overlap=1.0001 corr_cb=0.0422 topkJ=0.0644
[TRAIN][ep=006] loss=1.0250 acc=63.77%
[TRAIN][ep=006] mask_avg: mc_mean=0.4360 mb_mean=0.4387 norm_overlap=1.0005 corr_cb=0.2030
[EPOCH 006/089] train: loss=1.0250 acc=63.77% | val: loss=0.6424 acc=77.42% f1=63.16% auc=78.37% val_score=108.2133 val_score_bestthr=108.2133 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.436, mb=0.439, no=1.001, corr=0.203) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 97.9107 -> 108.2133
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4316 mb_mean=0.4208 norm_overlap=1.0008 corr_cb=0.2503 topkJ=0.1056
[TRAIN][ep=007] loss=0.6013 acc=63.77%
[TRAIN][ep=007] mask_avg: mc_mean=0.4247 mb_mean=0.3995 norm_overlap=1.0018 corr_cb=0.3524
[EPOCH 007/089] train: loss=0.6013 acc=63.77% | val: loss=0.6404 acc=74.19% f1=60.00% auc=77.26% val_score=100.0574 val_score_bestthr=103.4818 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.425, mb=0.399, no=1.002, corr=0.352) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 108.2133 -> 100.0574
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4176 mb_mean=0.3715 norm_overlap=1.0037 corr_cb=0.5293 topkJ=0.1796
[TRAIN][ep=008] loss=0.5699 acc=63.77%
[TRAIN][ep=008] mask_avg: mc_mean=0.4127 mb_mean=0.3621 norm_overlap=1.0030 corr_cb=0.3390
[EPOCH 008/089] train: loss=0.5699 acc=63.77% | val: loss=0.6388 acc=74.19% f1=60.00% auc=76.70% val_score=100.0574 val_score_bestthr=103.4318 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.413, mb=0.362, no=1.003, corr=0.339) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 108.2133 -> 100.0574
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4098 mb_mean=0.3597 norm_overlap=1.0031 corr_cb=0.3055 topkJ=0.0827
[TRAIN][ep=009] loss=0.5647 acc=63.77%
[TRAIN][ep=009] mask_avg: mc_mean=0.4002 mb_mean=0.3299 norm_overlap=1.0031 corr_cb=0.2047
[EPOCH 009/089] train: loss=0.5647 acc=63.77% | val: loss=0.6366 acc=72.58% f1=63.83% auc=74.80% val_score=95.5037 val_score_bestthr=103.9487 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.400, mb=0.330, no=1.003, corr=0.205) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 108.2133 -> 95.5037
[DBG][ep=010] disease_pos_weight=1.0000 mode=none
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.3947 mb_mean=0.3178 norm_overlap=1.0006 corr_cb=0.0320 topkJ=0.0353
[TRAIN][ep=010] loss=0.5605 acc=63.77%
[TRAIN][ep=010] mask_avg: mc_mean=0.3881 mb_mean=0.3052 norm_overlap=1.0003 corr_cb=0.0159
[EPOCH 010/089] train: loss=0.5605 acc=63.77% | val: loss=0.6344 acc=72.58% f1=48.48% auc=73.80% val_score=96.9553 val_score_bestthr=95.8932 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.388, mb=0.305, no=1.000, corr=0.016) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 108.2133 -> 96.9553
[DBG][ep=011] disease_pos_weight=1.0000 mode=none
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.3777 mb_mean=0.2833 norm_overlap=0.9982 corr_cb=-0.0551 topkJ=0.0244
[TRAIN][ep=011] loss=0.5544 acc=63.95%
[TRAIN][ep=011] mask_avg: mc_mean=0.3757 mb_mean=0.2859 norm_overlap=0.9901 corr_cb=-0.2376
[EPOCH 011/089] train: loss=0.5544 acc=63.95% | val: loss=0.6314 acc=70.97% f1=60.87% auc=71.46% val_score=95.3188 val_score_bestthr=100.7374 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.376, mb=0.286, no=0.990, corr=-0.238) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 108.2133 -> 95.3188
[DBG][ep=012] disease_pos_weight=1.0000 mode=none
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.3693 mb_mean=0.2907 norm_overlap=0.9892 corr_cb=-0.2365 topkJ=0.0037
[TRAIN][ep=012] loss=0.5487 acc=63.77%
[TRAIN][ep=012] mask_avg: mc_mean=0.3634 mb_mean=0.2697 norm_overlap=0.9691 corr_cb=-0.4687
[EPOCH 012/089] train: loss=0.5487 acc=63.77% | val: loss=0.6287 acc=70.97% f1=47.06% auc=70.57% val_score=94.4409 val_score_bestthr=93.5917 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.363, mb=0.270, no=0.969, corr=-0.469) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 108.2133 -> 94.4409
[DBG][ep=013] disease_pos_weight=1.0000 mode=none
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.3600 mb_mean=0.2660 norm_overlap=0.9493 corr_cb=-0.6394 topkJ=0.0000
[TRAIN][ep=013] loss=0.5386 acc=63.77%
[TRAIN][ep=013] mask_avg: mc_mean=0.3522 mb_mean=0.2566 norm_overlap=0.9339 corr_cb=-0.6399
[EPOCH 013/089] train: loss=0.5386 acc=63.77% | val: loss=0.6258 acc=70.97% f1=60.87% auc=69.45% val_score=96.7261 val_score_bestthr=100.7374 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.352, mb=0.257, no=0.934, corr=-0.640) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 108.2133 -> 96.7261
[DBG][ep=014] disease_pos_weight=1.0000 mode=none
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.3512 mb_mean=0.2655 norm_overlap=0.9043 corr_cb=-0.7847 topkJ=0.0000
[TRAIN][ep=014] loss=0.5294 acc=64.86%
[TRAIN][ep=014] mask_avg: mc_mean=0.3410 mb_mean=0.2475 norm_overlap=0.8746 corr_cb=-0.7602
[EPOCH 014/089] train: loss=0.5294 acc=64.86% | val: loss=0.6232 acc=69.35% f1=59.57% auc=68.67% val_score=92.2864 val_score_bestthr=98.0036 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.341, mb=0.247, no=0.875, corr=-0.760) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 108.2133 -> 92.2864
[DBG][ep=015] disease_pos_weight=1.0000 mode=none
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.3334 mb_mean=0.2492 norm_overlap=0.8631 corr_cb=-0.7941 topkJ=0.0000
[TRAIN][ep=015] loss=0.5195 acc=65.40%
[TRAIN][ep=015] mask_avg: mc_mean=0.3325 mb_mean=0.2447 norm_overlap=0.8215 corr_cb=-0.8066
[EPOCH 015/089] train: loss=0.5195 acc=65.40% | val: loss=0.6189 acc=69.35% f1=45.71% auc=68.23% val_score=94.5726 val_score_bestthr=91.3466 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.332, mb=0.245, no=0.821, corr=-0.807) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 94.5726
[DBG][ep=016] disease_pos_weight=1.0000 mode=none
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.3214 mb_mean=0.2235 norm_overlap=0.7786 corr_cb=-0.6700 topkJ=0.0000
[TRAIN][ep=016] loss=0.5108 acc=66.30%
[TRAIN][ep=016] mask_avg: mc_mean=0.3252 mb_mean=0.2447 norm_overlap=0.7864 corr_cb=-0.8043
[EPOCH 016/089] train: loss=0.5108 acc=66.30% | val: loss=0.6160 acc=69.35% f1=45.71% auc=67.11% val_score=93.0044 val_score_bestthr=91.3466 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.325, mb=0.245, no=0.786, corr=-0.804) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 93.0044
[DBG][ep=017] disease_pos_weight=1.0000 mode=none
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.3136 mb_mean=0.2373 norm_overlap=0.7644 corr_cb=-0.7445 topkJ=0.0000
[TRAIN][ep=017] loss=0.5036 acc=66.30%
[TRAIN][ep=017] mask_avg: mc_mean=0.3201 mb_mean=0.2447 norm_overlap=0.7541 corr_cb=-0.8009
[EPOCH 017/089] train: loss=0.5036 acc=66.30% | val: loss=0.6133 acc=69.35% f1=57.78% auc=67.78% val_score=91.2932 val_score_bestthr=96.8792 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.320, mb=0.245, no=0.754, corr=-0.801) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 91.2932
[DBG][ep=018] disease_pos_weight=1.0000 mode=none
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.3131 mb_mean=0.2582 norm_overlap=0.7418 corr_cb=-0.8024 topkJ=0.0000
[TRAIN][ep=018] loss=0.4959 acc=67.03%
[TRAIN][ep=018] mask_avg: mc_mean=0.3161 mb_mean=0.2447 norm_overlap=0.7333 corr_cb=-0.7843
[EPOCH 018/089] train: loss=0.4959 acc=67.03% | val: loss=0.6096 acc=69.35% f1=45.71% auc=67.89% val_score=94.3435 val_score_bestthr=91.3466 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.316, mb=0.245, no=0.733, corr=-0.784) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 94.3435
[DBG][ep=019] disease_pos_weight=1.0000 mode=none
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.3103 mb_mean=0.2544 norm_overlap=0.7330 corr_cb=-0.7703 topkJ=0.0000
[TRAIN][ep=019] loss=0.4895 acc=67.39%
[TRAIN][ep=019] mask_avg: mc_mean=0.3121 mb_mean=0.2447 norm_overlap=0.7085 corr_cb=-0.7779
[EPOCH 019/089] train: loss=0.4895 acc=67.39% | val: loss=0.6089 acc=69.35% f1=45.71% auc=68.12% val_score=92.2030 val_score_bestthr=91.3466 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.312, mb=0.245, no=0.708, corr=-0.778) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 92.2030
[DBG][ep=020] disease_pos_weight=1.0000 mode=none
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.3108 mb_mean=0.2499 norm_overlap=0.6718 corr_cb=-0.8139 topkJ=0.0000
[TRAIN][ep=020] loss=0.4806 acc=67.75%
[TRAIN][ep=020] mask_avg: mc_mean=0.3094 mb_mean=0.2447 norm_overlap=0.6904 corr_cb=-0.7686
[EPOCH 020/089] train: loss=0.4806 acc=67.75% | val: loss=0.6064 acc=69.35% f1=53.66% auc=68.23% val_score=92.2030 val_score_bestthr=95.0988 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.309, mb=0.245, no=0.690, corr=-0.769) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 92.2030
[DBG][ep=021] disease_pos_weight=1.0000 mode=none
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2900 mb_mean=0.2385 norm_overlap=0.6906 corr_cb=-0.7048 topkJ=0.0000
[TRAIN][ep=021] loss=0.4733 acc=68.84%
[TRAIN][ep=021] mask_avg: mc_mean=0.3060 mb_mean=0.2447 norm_overlap=0.6738 corr_cb=-0.7592
[EPOCH 021/089] train: loss=0.4733 acc=68.84% | val: loss=0.6062 acc=69.35% f1=55.81% auc=68.12% val_score=94.4893 val_score_bestthr=96.5045 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.306, mb=0.245, no=0.674, corr=-0.759) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 94.4893
[DBG][ep=022] disease_pos_weight=1.0000 mode=none
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2990 mb_mean=0.2547 norm_overlap=0.6568 corr_cb=-0.7787 topkJ=0.0000
[TRAIN][ep=022] loss=0.4647 acc=70.83%
[TRAIN][ep=022] mask_avg: mc_mean=0.3031 mb_mean=0.2447 norm_overlap=0.6572 corr_cb=-0.7538
[EPOCH 022/089] train: loss=0.4647 acc=70.83% | val: loss=0.6047 acc=69.35% f1=57.78% auc=68.23% val_score=94.4893 val_score_bestthr=97.3465 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.303, mb=0.245, no=0.657, corr=-0.754) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 94.4893
[DBG][ep=023] disease_pos_weight=1.0000 mode=none
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.3063 mb_mean=0.2378 norm_overlap=0.5979 corr_cb=-0.7565 topkJ=0.0000
[TRAIN][ep=023] loss=0.4566 acc=71.74%
[TRAIN][ep=023] mask_avg: mc_mean=0.3000 mb_mean=0.2447 norm_overlap=0.6446 corr_cb=-0.7454
[EPOCH 023/089] train: loss=0.4566 acc=71.74% | val: loss=0.6062 acc=70.97% f1=57.14% auc=67.78% val_score=91.4390 val_score_bestthr=98.7574 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.300, mb=0.245, no=0.645, corr=-0.745) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 91.4390
[DBG][ep=024] disease_pos_weight=1.0000 mode=none
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2948 mb_mean=0.2514 norm_overlap=0.6520 corr_cb=-0.7646 topkJ=0.0000
[TRAIN][ep=024] loss=0.4512 acc=72.10%
[TRAIN][ep=024] mask_avg: mc_mean=0.2970 mb_mean=0.2447 norm_overlap=0.6320 corr_cb=-0.7400
[EPOCH 024/089] train: loss=0.4512 acc=72.10% | val: loss=0.6122 acc=70.97% f1=57.14% auc=67.34% val_score=92.6626 val_score_bestthr=98.7574 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.297, mb=0.245, no=0.632, corr=-0.740) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 92.6626
[DBG][ep=025] disease_pos_weight=1.0000 mode=none
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.3052 mb_mean=0.2466 norm_overlap=0.5789 corr_cb=-0.8088 topkJ=0.0000
[TRAIN][ep=025] loss=0.4435 acc=72.28%
[TRAIN][ep=025] mask_avg: mc_mean=0.2941 mb_mean=0.2447 norm_overlap=0.6184 corr_cb=-0.7382
[EPOCH 025/089] train: loss=0.4435 acc=72.28% | val: loss=0.6160 acc=70.97% f1=57.14% auc=67.22% val_score=92.0776 val_score_bestthr=98.7574 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.294, mb=0.245, no=0.618, corr=-0.738) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 92.0776
[DBG][ep=026] disease_pos_weight=1.0000 mode=none
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2852 mb_mean=0.2450 norm_overlap=0.5817 corr_cb=-0.7445 topkJ=0.0000
[TRAIN][ep=026] loss=0.4381 acc=73.55%
[TRAIN][ep=026] mask_avg: mc_mean=0.2917 mb_mean=0.2447 norm_overlap=0.6112 corr_cb=-0.7273
[EPOCH 026/089] train: loss=0.4381 acc=73.55% | val: loss=0.6120 acc=69.35% f1=51.28% auc=67.34% val_score=91.3670 val_score_bestthr=93.8957 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.292, mb=0.245, no=0.611, corr=-0.727) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 91.3670
[DBG][ep=027] disease_pos_weight=1.0000 mode=none
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2730 mb_mean=0.2518 norm_overlap=0.6593 corr_cb=-0.6254 topkJ=0.0000
[TRAIN][ep=027] loss=0.4281 acc=73.37%
[TRAIN][ep=027] mask_avg: mc_mean=0.2891 mb_mean=0.2447 norm_overlap=0.5983 corr_cb=-0.7284
[EPOCH 027/089] train: loss=0.4281 acc=73.37% | val: loss=0.6202 acc=69.35% f1=45.71% auc=66.33% val_score=81.5374 val_score_bestthr=91.3466 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.289, mb=0.245, no=0.598, corr=-0.728) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 81.5374
[DBG][ep=028] disease_pos_weight=1.0000 mode=none
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2805 mb_mean=0.2497 norm_overlap=0.6313 corr_cb=-0.7260 topkJ=0.0000
[TRAIN][ep=028] loss=0.4225 acc=73.73%
[TRAIN][ep=028] mask_avg: mc_mean=0.2867 mb_mean=0.2447 norm_overlap=0.5886 corr_cb=-0.7256
[EPOCH 028/089] train: loss=0.4225 acc=73.73% | val: loss=0.6177 acc=69.35% f1=45.71% auc=65.66% val_score=87.9226 val_score_bestthr=91.3466 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.287, mb=0.245, no=0.589, corr=-0.726) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 87.9226
[DBG][ep=029] disease_pos_weight=1.0000 mode=none
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2956 mb_mean=0.2465 norm_overlap=0.5829 corr_cb=-0.7720 topkJ=0.0000
[TRAIN][ep=029] loss=0.4121 acc=73.37%
[TRAIN][ep=029] mask_avg: mc_mean=0.2843 mb_mean=0.2447 norm_overlap=0.5804 corr_cb=-0.7225
[EPOCH 029/089] train: loss=0.4121 acc=73.37% | val: loss=0.6218 acc=69.35% f1=45.71% auc=65.44% val_score=87.9226 val_score_bestthr=91.3466 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.284, mb=0.245, no=0.580, corr=-0.723) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 87.9226
[DBG][ep=030] disease_pos_weight=1.0000 mode=none
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2804 mb_mean=0.2377 norm_overlap=0.6224 corr_cb=-0.6728 topkJ=0.0000
[TRAIN][ep=030] loss=0.4061 acc=73.91%
[TRAIN][ep=030] mask_avg: mc_mean=0.2813 mb_mean=0.2447 norm_overlap=0.5730 corr_cb=-0.7189
[EPOCH 030/089] train: loss=0.4061 acc=73.91% | val: loss=0.6273 acc=69.35% f1=45.71% auc=65.44% val_score=84.2453 val_score_bestthr=91.6603 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.281, mb=0.245, no=0.573, corr=-0.719) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 84.2453
[DBG][ep=031] disease_pos_weight=1.0000 mode=none
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2790 mb_mean=0.2523 norm_overlap=0.6183 corr_cb=-0.6799 topkJ=0.0000
[TRAIN][ep=031] loss=0.3954 acc=74.82%
[TRAIN][ep=031] mask_avg: mc_mean=0.2797 mb_mean=0.2447 norm_overlap=0.5660 corr_cb=-0.7219
[EPOCH 031/089] train: loss=0.3954 acc=74.82% | val: loss=0.6288 acc=70.97% f1=50.00% auc=65.22% val_score=86.4757 val_score_bestthr=95.1280 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.280, mb=0.245, no=0.566, corr=-0.722) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 86.4757
[DBG][ep=032] disease_pos_weight=1.0000 mode=none
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2886 mb_mean=0.2489 norm_overlap=0.5862 corr_cb=-0.7742 topkJ=0.0000
[TRAIN][ep=032] loss=0.3947 acc=75.00%
[TRAIN][ep=032] mask_avg: mc_mean=0.2797 mb_mean=0.2447 norm_overlap=0.5660 corr_cb=-0.7211
[EPOCH 032/089] train: loss=0.3947 acc=75.00% | val: loss=0.6300 acc=70.97% f1=50.00% auc=65.44% val_score=86.4757 val_score_bestthr=95.1280 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.280, mb=0.245, no=0.566, corr=-0.721) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 86.4757
[DBG][ep=033] disease_pos_weight=1.0000 mode=none
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2772 mb_mean=0.2499 norm_overlap=0.5746 corr_cb=-0.7092 topkJ=0.0000
[TRAIN][ep=033] loss=0.3924 acc=75.36%
[TRAIN][ep=033] mask_avg: mc_mean=0.2797 mb_mean=0.2447 norm_overlap=0.5660 corr_cb=-0.7215
[EPOCH 033/089] train: loss=0.3924 acc=75.36% | val: loss=0.6309 acc=69.35% f1=48.65% auc=65.55% val_score=86.4757 val_score_bestthr=92.8150 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.280, mb=0.245, no=0.566, corr=-0.722) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 86.4757
[DBG][ep=034] disease_pos_weight=1.0000 mode=none
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2803 mb_mean=0.2534 norm_overlap=0.5207 corr_cb=-0.7860 topkJ=0.0000
[TRAIN][ep=034] loss=0.3907 acc=75.54%
[TRAIN][ep=034] mask_avg: mc_mean=0.2797 mb_mean=0.2447 norm_overlap=0.5656 corr_cb=-0.7223
[EPOCH 034/089] train: loss=0.3907 acc=75.54% | val: loss=0.6324 acc=69.35% f1=48.65% auc=65.77% val_score=86.4757 val_score_bestthr=92.8150 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.280, mb=0.245, no=0.566, corr=-0.722) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 86.4757
[DBG][ep=035] disease_pos_weight=1.0000 mode=none
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2937 mb_mean=0.2409 norm_overlap=0.5232 corr_cb=-0.7414 topkJ=0.0000
[TRAIN][ep=035] loss=0.3887 acc=75.00%
[TRAIN][ep=035] mask_avg: mc_mean=0.2797 mb_mean=0.2447 norm_overlap=0.5660 corr_cb=-0.7212
[EPOCH 035/089] train: loss=0.3887 acc=75.00% | val: loss=0.6337 acc=69.35% f1=48.65% auc=65.44% val_score=87.3167 val_score_bestthr=92.8150 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.280, mb=0.245, no=0.566, corr=-0.721) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 87.3167
[DBG][ep=036] disease_pos_weight=1.0000 mode=none
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2970 mb_mean=0.2286 norm_overlap=0.4867 corr_cb=-0.7349 topkJ=0.0000
[TRAIN][ep=036] loss=0.3872 acc=75.36%
[TRAIN][ep=036] mask_avg: mc_mean=0.2797 mb_mean=0.2447 norm_overlap=0.5660 corr_cb=-0.7216
[EPOCH 036/089] train: loss=0.3872 acc=75.36% | val: loss=0.6346 acc=69.35% f1=48.65% auc=65.44% val_score=86.4757 val_score_bestthr=92.8150 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.280, mb=0.245, no=0.566, corr=-0.722) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 108.2133 -> 86.4757
[EARLY STOP] no improvement for 30 epochs. best_epoch=6
[CKPT] Loaded best for testing: results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
=============== FIT DONE ===============
[BEST] epoch=6 | val_acc=77.42% | val_f1=63.16% | val_auc=78.37% | val_score=108.2133 | val_score_bestthr=108.2133
[TEST@BEST] thr_used=0.370 | acc=64.71% f1=15.62% auc=58.87% | SP_sex=5.86% EO_sex=1.61% SP_age=6.53% EO_age=25.00%
[TIME] 0.62 min
[OK] Saved: results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/summary_fold_2.json
[DBG][ep=000] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4496 mb_mean=0.4946 norm_overlap=1.0001 corr_cb=0.1679 topkJ=0.0819
[TRAIN][ep=000] loss=0.6827 acc=63.77%
[TRAIN][ep=000] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0415
[DBG][ep=001] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4515 mb_mean=0.4949 norm_overlap=1.0000 corr_cb=0.0438 topkJ=0.0912
[TRAIN][ep=001] loss=0.6815 acc=63.77%
[TRAIN][ep=001] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0393
[DBG][ep=002] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4501 mb_mean=0.4947 norm_overlap=1.0000 corr_cb=0.0147 topkJ=0.0889
[TRAIN][ep=002] loss=0.6796 acc=63.77%
[TRAIN][ep=002] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0412
[DBG][ep=003] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4523 mb_mean=0.4943 norm_overlap=1.0001 corr_cb=0.1587 topkJ=0.0969
[TRAIN][ep=003] loss=0.6774 acc=63.77%
[TRAIN][ep=003] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0415
[DBG][ep=004] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4502 mb_mean=0.4945 norm_overlap=0.9999 corr_cb=-0.0905 topkJ=0.0338
[TRAIN][ep=004] loss=0.6762 acc=63.77%
[TRAIN][ep=004] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0389
[DBG][ep=005] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4510 mb_mean=0.4956 norm_overlap=1.0001 corr_cb=0.0918 topkJ=0.0948
[TRAIN][ep=005] loss=0.6739 acc=63.77%
[TRAIN][ep=005] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0387
[DBG][ep=006] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4523 mb_mean=0.4929 norm_overlap=1.0000 corr_cb=-0.0175 topkJ=0.0527
[TRAIN][ep=006] loss=0.6702 acc=63.77%
[TRAIN][ep=006] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0407
[DBG][ep=007] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4503 mb_mean=0.4943 norm_overlap=0.9999 corr_cb=-0.0701 topkJ=0.0588
[TRAIN][ep=007] loss=0.6649 acc=64.31%
[TRAIN][ep=007] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0395
[DBG][ep=008] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4515 mb_mean=0.4937 norm_overlap=1.0000 corr_cb=0.0577 topkJ=0.0890
[TRAIN][ep=008] loss=0.6587 acc=66.12%
[TRAIN][ep=008] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0414
[DBG][ep=009] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4511 mb_mean=0.4927 norm_overlap=1.0000 corr_cb=0.0201 topkJ=0.0884
[TRAIN][ep=009] loss=0.6509 acc=66.12%
[TRAIN][ep=009] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0422
================= FIT START (fold=2) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.4516 mb_mean=0.4954 norm_overlap=1.0000 corr_cb=0.0570 topkJ=0.0440
[TRAIN][ep=000] loss=0.6388 acc=69.75%
[TRAIN][ep=000] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0407
[EPOCH 000/089] train: loss=0.6388 acc=69.75% | val: loss=0.6245 acc=72.58% f1=45.16% auc=70.01% val_score=59.6455 val_score_bestthr=59.6455 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.450, mb=0.495, no=1.000, corr=0.041) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 59.6455
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=001] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.4492 mb_mean=0.4950 norm_overlap=0.9998 corr_cb=-0.1808 topkJ=0.0441
[TRAIN][ep=001] loss=0.6330 acc=68.30%
[TRAIN][ep=001] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0400
[EPOCH 001/089] train: loss=0.6330 acc=68.30% | val: loss=0.6271 acc=72.58% f1=45.16% auc=69.57% val_score=51.3887 val_score_bestthr=59.6455 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.450, mb=0.495, no=1.000, corr=0.040) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 59.6455 -> 59.6455
[DBG][ep=002] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.4508 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=-0.0404 topkJ=0.0832
[TRAIN][ep=002] loss=0.6252 acc=70.83%
[TRAIN][ep=002] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0410
[EPOCH 002/089] train: loss=0.6252 acc=70.83% | val: loss=0.6188 acc=72.58% f1=45.16% auc=70.01% val_score=50.3806 val_score_bestthr=59.6455 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.450, mb=0.495, no=1.000, corr=0.041) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 59.6455 -> 59.6455
[DBG][ep=003] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.4487 mb_mean=0.4952 norm_overlap=0.9999 corr_cb=-0.0570 topkJ=0.0462
[TRAIN][ep=003] loss=0.6174 acc=70.29%
[TRAIN][ep=003] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0400
[EPOCH 003/089] train: loss=0.6174 acc=70.29% | val: loss=0.6241 acc=72.58% f1=45.16% auc=69.57% val_score=43.0716 val_score_bestthr=59.6455 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.450, mb=0.495, no=1.000, corr=0.040) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 59.6455 -> 59.6455
[DBG][ep=004] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.4503 mb_mean=0.4944 norm_overlap=1.0001 corr_cb=0.1213 topkJ=0.0789
[TRAIN][ep=004] loss=0.6099 acc=71.38%
[TRAIN][ep=004] mask_avg: mc_mean=0.4500 mb_mean=0.4946 norm_overlap=1.0000 corr_cb=0.0380
[EPOCH 004/089] train: loss=0.6099 acc=71.38% | val: loss=0.6109 acc=72.58% f1=45.16% auc=70.46% val_score=48.9384 val_score_bestthr=59.6455 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.450, mb=0.495, no=1.000, corr=0.038) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 59.6455 -> 59.6455
[DBG][ep=005] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.4518 mb_mean=0.4941 norm_overlap=1.0000 corr_cb=-0.0020 topkJ=0.0603
[TRAIN][ep=005] loss=1.2795 acc=65.94%
[TRAIN][ep=005] mask_avg: mc_mean=0.4481 mb_mean=0.4946 norm_overlap=0.9998 corr_cb=-0.1488
[EPOCH 005/089] train: loss=1.2795 acc=65.94% | val: loss=0.6132 acc=56.45% f1=63.01% auc=70.23% val_score=56.0853 val_score_bestthr=60.9524 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.448, mb=0.495, no=1.000, corr=-0.149) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 59.6455 -> 60.9524
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=006] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4455 mb_mean=0.4940 norm_overlap=0.9999 corr_cb=-0.0616 topkJ=0.0487
[TRAIN][ep=006] loss=1.1984 acc=70.65%
[TRAIN][ep=006] mask_avg: mc_mean=0.4432 mb_mean=0.4946 norm_overlap=0.9996 corr_cb=-0.2784
[EPOCH 006/089] train: loss=1.1984 acc=70.65% | val: loss=0.6169 acc=59.68% f1=64.79% auc=70.35% val_score=50.0812 val_score_bestthr=63.7274 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.443, mb=0.495, no=1.000, corr=-0.278) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 60.9524 -> 63.7274
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=007] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4421 mb_mean=0.4928 norm_overlap=0.9994 corr_cb=-0.3230 topkJ=0.0127
[TRAIN][ep=007] loss=1.1813 acc=73.37%
[TRAIN][ep=007] mask_avg: mc_mean=0.4394 mb_mean=0.4946 norm_overlap=0.9995 corr_cb=-0.3241
[EPOCH 007/089] train: loss=1.1813 acc=73.37% | val: loss=0.6144 acc=61.29% f1=64.71% auc=70.46% val_score=46.9650 val_score_bestthr=60.0997 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.439, mb=0.495, no=0.999, corr=-0.324) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.7274 -> 60.0997
[DBG][ep=008] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4370 mb_mean=0.4952 norm_overlap=0.9993 corr_cb=-0.4206 topkJ=0.0057
[TRAIN][ep=008] loss=1.1688 acc=74.28%
[TRAIN][ep=008] mask_avg: mc_mean=0.4337 mb_mean=0.4946 norm_overlap=0.9993 corr_cb=-0.3675
[EPOCH 008/089] train: loss=1.1688 acc=74.28% | val: loss=0.6154 acc=70.97% f1=43.75% auc=69.68% val_score=40.9849 val_score_bestthr=58.0648 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.434, mb=0.495, no=0.999, corr=-0.368) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.7274 -> 58.0648
[DBG][ep=009] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4327 mb_mean=0.4941 norm_overlap=0.9996 corr_cb=-0.2582 topkJ=0.0208
[TRAIN][ep=009] loss=1.1515 acc=76.63%
[TRAIN][ep=009] mask_avg: mc_mean=0.4291 mb_mean=0.4946 norm_overlap=0.9992 corr_cb=-0.3738
[EPOCH 009/089] train: loss=1.1515 acc=76.63% | val: loss=0.6326 acc=62.90% f1=0.00% auc=69.23% val_score=40.2041 val_score_bestthr=62.9032 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.429, mb=0.495, no=0.999, corr=-0.374) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.7274 -> 62.9032
[DBG][ep=010] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.4266 mb_mean=0.4946 norm_overlap=0.9990 corr_cb=-0.3594 topkJ=0.0136
[TRAIN][ep=010] loss=1.1426 acc=75.91%
[TRAIN][ep=010] mask_avg: mc_mean=0.4229 mb_mean=0.4946 norm_overlap=0.9991 corr_cb=-0.3923
[EPOCH 010/089] train: loss=1.1426 acc=75.91% | val: loss=0.6512 acc=62.90% f1=0.00% auc=67.78% val_score=38.8731 val_score_bestthr=62.9032 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.423, mb=0.495, no=0.999, corr=-0.392) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.7274 -> 62.9032
[DBG][ep=011] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.4178 mb_mean=0.4949 norm_overlap=0.9993 corr_cb=-0.3129 topkJ=0.0210
[TRAIN][ep=011] loss=1.1236 acc=75.54%
[TRAIN][ep=011] mask_avg: mc_mean=0.4156 mb_mean=0.4946 norm_overlap=0.9987 corr_cb=-0.4233
[EPOCH 011/089] train: loss=1.1236 acc=75.54% | val: loss=0.6134 acc=70.97% f1=43.75% auc=67.89% val_score=45.4038 val_score_bestthr=57.0567 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.416, mb=0.495, no=0.999, corr=-0.423) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.7274 -> 57.0567
[DBG][ep=012] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.4107 mb_mean=0.4959 norm_overlap=0.9982 corr_cb=-0.4212 topkJ=0.0074
[TRAIN][ep=012] loss=0.9159 acc=78.08%
[TRAIN][ep=012] mask_avg: mc_mean=0.4093 mb_mean=0.4946 norm_overlap=0.9985 corr_cb=-0.4342
[EPOCH 012/089] train: loss=0.9159 acc=78.08% | val: loss=0.6057 acc=72.58% f1=45.16% auc=68.23% val_score=48.2469 val_score_bestthr=59.2227 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.409, mb=0.495, no=0.999, corr=-0.434) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.7274 -> 59.2227
[DBG][ep=013] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.4057 mb_mean=0.4940 norm_overlap=0.9980 corr_cb=-0.5705 topkJ=0.0041
[TRAIN][ep=013] loss=0.7065 acc=78.44%
[TRAIN][ep=013] mask_avg: mc_mean=0.4022 mb_mean=0.4946 norm_overlap=0.9983 corr_cb=-0.4412
[EPOCH 013/089] train: loss=0.7065 acc=78.44% | val: loss=0.6311 acc=61.29% f1=62.50% auc=66.67% val_score=50.9892 val_score_bestthr=55.1907 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.402, mb=0.495, no=0.998, corr=-0.441) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.7274 -> 55.1907
[DBG][ep=014] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.4011 mb_mean=0.4938 norm_overlap=0.9986 corr_cb=-0.4669 topkJ=0.0083
[TRAIN][ep=014] loss=0.6560 acc=77.72%
[TRAIN][ep=014] mask_avg: mc_mean=0.3941 mb_mean=0.4946 norm_overlap=0.9981 corr_cb=-0.4416
[EPOCH 014/089] train: loss=0.6560 acc=77.72% | val: loss=0.6447 acc=61.29% f1=62.50% auc=66.89% val_score=50.9892 val_score_bestthr=55.1907 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.394, mb=0.495, no=0.998, corr=-0.442) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.7274 -> 55.1907
[DBG][ep=015] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.3884 mb_mean=0.4944 norm_overlap=0.9983 corr_cb=-0.3672 topkJ=0.0145
[TRAIN][ep=015] loss=0.6326 acc=78.62%
[TRAIN][ep=015] mask_avg: mc_mean=0.3876 mb_mean=0.4946 norm_overlap=0.9979 corr_cb=-0.4496
[EPOCH 015/089] train: loss=0.6326 acc=78.62% | val: loss=0.6806 acc=64.52% f1=8.33% auc=66.44% val_score=49.9126 val_score_bestthr=58.3080 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.388, mb=0.495, no=0.998, corr=-0.450) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.7274 -> 58.3080
[DBG][ep=016] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.3776 mb_mean=0.4952 norm_overlap=0.9985 corr_cb=-0.2566 topkJ=0.0218
[TRAIN][ep=016] loss=0.6162 acc=78.44%
[TRAIN][ep=016] mask_avg: mc_mean=0.3803 mb_mean=0.4946 norm_overlap=0.9977 corr_cb=-0.4475
[EPOCH 016/089] train: loss=0.6162 acc=78.44% | val: loss=0.6588 acc=62.90% f1=54.90% auc=66.22% val_score=50.9892 val_score_bestthr=61.5507 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.380, mb=0.495, no=0.998, corr=-0.448) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.7274 -> 61.5507
[DBG][ep=017] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.3734 mb_mean=0.4947 norm_overlap=0.9970 corr_cb=-0.4762 topkJ=0.0238
[TRAIN][ep=017] loss=0.6015 acc=79.53%
[TRAIN][ep=017] mask_avg: mc_mean=0.3730 mb_mean=0.4946 norm_overlap=0.9975 corr_cb=-0.4487
[EPOCH 017/089] train: loss=0.6015 acc=79.53% | val: loss=0.6917 acc=62.90% f1=56.60% auc=65.55% val_score=49.8974 val_score_bestthr=58.9064 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.373, mb=0.495, no=0.997, corr=-0.449) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.7274 -> 58.9064
[DBG][ep=018] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.3754 mb_mean=0.4932 norm_overlap=0.9983 corr_cb=-0.3536 topkJ=0.0198
[TRAIN][ep=018] loss=0.5908 acc=79.53%
[TRAIN][ep=018] mask_avg: mc_mean=0.3668 mb_mean=0.4946 norm_overlap=0.9973 corr_cb=-0.4472
[EPOCH 018/089] train: loss=0.5908 acc=79.53% | val: loss=0.7077 acc=61.29% f1=53.85% auc=64.44% val_score=49.8974 val_score_bestthr=61.1880 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.367, mb=0.495, no=0.997, corr=-0.447) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.7274 -> 61.1880
[DBG][ep=019] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.3670 mb_mean=0.4949 norm_overlap=0.9978 corr_cb=-0.4101 topkJ=0.0334
[TRAIN][ep=019] loss=0.5774 acc=80.62%
[TRAIN][ep=019] mask_avg: mc_mean=0.3589 mb_mean=0.4946 norm_overlap=0.9971 corr_cb=-0.4464
[EPOCH 019/089] train: loss=0.5774 acc=80.62% | val: loss=0.7227 acc=61.29% f1=53.85% auc=64.99% val_score=49.9126 val_score_bestthr=61.1880 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.359, mb=0.495, no=0.997, corr=-0.446) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.7274 -> 61.1880
[DBG][ep=020] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.3580 mb_mean=0.4938 norm_overlap=0.9966 corr_cb=-0.5418 topkJ=0.0021
[TRAIN][ep=020] loss=0.5647 acc=81.88%
[TRAIN][ep=020] mask_avg: mc_mean=0.3525 mb_mean=0.4946 norm_overlap=0.9969 corr_cb=-0.4466
[EPOCH 020/089] train: loss=0.5647 acc=81.88% | val: loss=0.7405 acc=61.29% f1=53.85% auc=63.99% val_score=51.3371 val_score_bestthr=61.1880 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.352, mb=0.495, no=0.997, corr=-0.447) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.7274 -> 61.1880
[DBG][ep=021] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.3461 mb_mean=0.4960 norm_overlap=0.9973 corr_cb=-0.3688 topkJ=0.0556
[TRAIN][ep=021] loss=0.5487 acc=81.52%
[TRAIN][ep=021] mask_avg: mc_mean=0.3464 mb_mean=0.4946 norm_overlap=0.9967 corr_cb=-0.4496
[EPOCH 021/089] train: loss=0.5487 acc=81.52% | val: loss=0.7585 acc=70.97% f1=43.75% auc=64.66% val_score=49.9126 val_score_bestthr=58.0648 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.346, mb=0.495, no=0.997, corr=-0.450) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.7274 -> 58.0648
[DBG][ep=022] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.3428 mb_mean=0.4948 norm_overlap=0.9974 corr_cb=-0.3817 topkJ=0.0156
[TRAIN][ep=022] loss=0.5311 acc=82.79%
[TRAIN][ep=022] mask_avg: mc_mean=0.3389 mb_mean=0.4946 norm_overlap=0.9965 corr_cb=-0.4431
[EPOCH 022/089] train: loss=0.5311 acc=82.79% | val: loss=0.7815 acc=61.29% f1=53.85% auc=63.55% val_score=51.3151 val_score_bestthr=61.1880 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.339, mb=0.495, no=0.997, corr=-0.443) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.7274 -> 61.1880
[DBG][ep=023] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.3344 mb_mean=0.4950 norm_overlap=0.9952 corr_cb=-0.4829 topkJ=0.0330
[TRAIN][ep=023] loss=0.5182 acc=82.43%
[TRAIN][ep=023] mask_avg: mc_mean=0.3332 mb_mean=0.4946 norm_overlap=0.9964 corr_cb=-0.4372
[EPOCH 023/089] train: loss=0.5182 acc=82.43% | val: loss=0.8145 acc=66.13% f1=43.24% auc=62.76% val_score=50.2356 val_score_bestthr=60.6676 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.333, mb=0.495, no=0.996, corr=-0.437) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.7274 -> 60.6676
[DBG][ep=024] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.3280 mb_mean=0.4961 norm_overlap=0.9952 corr_cb=-0.5694 topkJ=0.0086
[TRAIN][ep=024] loss=0.5060 acc=83.15%
[TRAIN][ep=024] mask_avg: mc_mean=0.3253 mb_mean=0.4946 norm_overlap=0.9961 corr_cb=-0.4411
[EPOCH 024/089] train: loss=0.5060 acc=83.15% | val: loss=0.8395 acc=66.13% f1=43.24% auc=61.43% val_score=51.3151 val_score_bestthr=60.6676 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.325, mb=0.495, no=0.996, corr=-0.441) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.7274 -> 60.6676
[DBG][ep=025] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.3252 mb_mean=0.4954 norm_overlap=0.9953 corr_cb=-0.4945 topkJ=0.0160
[TRAIN][ep=025] loss=0.4952 acc=85.33%
[TRAIN][ep=025] mask_avg: mc_mean=0.3203 mb_mean=0.4946 norm_overlap=0.9960 corr_cb=-0.4341
[EPOCH 025/089] train: loss=0.4952 acc=85.33% | val: loss=0.8543 acc=67.74% f1=44.44% auc=61.87% val_score=51.3151 val_score_bestthr=61.4021 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.320, mb=0.495, no=0.996, corr=-0.434) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.7274 -> 61.4021
[DBG][ep=026] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.3190 mb_mean=0.4949 norm_overlap=0.9946 corr_cb=-0.5721 topkJ=0.0024
[TRAIN][ep=026] loss=0.4785 acc=84.96%
[TRAIN][ep=026] mask_avg: mc_mean=0.3141 mb_mean=0.4946 norm_overlap=0.9958 corr_cb=-0.4352
[EPOCH 026/089] train: loss=0.4785 acc=84.96% | val: loss=0.8841 acc=66.13% f1=46.15% auc=62.54% val_score=51.3151 val_score_bestthr=62.5293 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.314, mb=0.495, no=0.996, corr=-0.435) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.7274 -> 62.5293
[DBG][ep=027] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.3125 mb_mean=0.4945 norm_overlap=0.9970 corr_cb=-0.3048 topkJ=0.0517
[TRAIN][ep=027] loss=0.4558 acc=85.87%
[TRAIN][ep=027] mask_avg: mc_mean=0.3080 mb_mean=0.4946 norm_overlap=0.9955 corr_cb=-0.4374
[EPOCH 027/089] train: loss=0.4558 acc=85.87% | val: loss=0.9543 acc=67.74% f1=44.44% auc=61.98% val_score=52.3700 val_score_bestthr=61.4021 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.308, mb=0.495, no=0.996, corr=-0.437) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.7274 -> 61.4021
[DBG][ep=028] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.3001 mb_mean=0.4959 norm_overlap=0.9950 corr_cb=-0.4066 topkJ=0.0284
[TRAIN][ep=028] loss=0.4379 acc=87.32%
[TRAIN][ep=028] mask_avg: mc_mean=0.3031 mb_mean=0.4946 norm_overlap=0.9954 corr_cb=-0.4337
[EPOCH 028/089] train: loss=0.4379 acc=87.32% | val: loss=1.0476 acc=64.52% f1=47.62% auc=61.87% val_score=52.3700 val_score_bestthr=59.8200 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.303, mb=0.495, no=0.995, corr=-0.434) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.7274 -> 59.8200
[DBG][ep=029] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.3037 mb_mean=0.4939 norm_overlap=0.9965 corr_cb=-0.3915 topkJ=0.0154
[TRAIN][ep=029] loss=0.4300 acc=87.50%
[TRAIN][ep=029] mask_avg: mc_mean=0.2977 mb_mean=0.4946 norm_overlap=0.9953 corr_cb=-0.4320
[EPOCH 029/089] train: loss=0.4300 acc=87.50% | val: loss=0.9954 acc=67.74% f1=47.37% auc=61.20% val_score=55.7473 val_score_bestthr=62.2578 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.298, mb=0.495, no=0.995, corr=-0.432) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.7274 -> 62.2578
[DBG][ep=030] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2981 mb_mean=0.4950 norm_overlap=0.9931 corr_cb=-0.5876 topkJ=0.0042
[TRAIN][ep=030] loss=0.4204 acc=88.04%
[TRAIN][ep=030] mask_avg: mc_mean=0.2936 mb_mean=0.4946 norm_overlap=0.9952 corr_cb=-0.4224
[EPOCH 030/089] train: loss=0.4204 acc=88.04% | val: loss=1.0201 acc=67.74% f1=44.44% auc=61.20% val_score=55.7473 val_score_bestthr=61.4021 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.294, mb=0.495, no=0.995, corr=-0.422) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.7274 -> 61.4021
[DBG][ep=031] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2925 mb_mean=0.4943 norm_overlap=0.9961 corr_cb=-0.3672 topkJ=0.0333
[TRAIN][ep=031] loss=0.3971 acc=89.49%
[TRAIN][ep=031] mask_avg: mc_mean=0.2889 mb_mean=0.4946 norm_overlap=0.9949 corr_cb=-0.4270
[EPOCH 031/089] train: loss=0.3971 acc=89.49% | val: loss=1.0774 acc=67.74% f1=44.44% auc=62.21% val_score=52.3700 val_score_bestthr=61.4021 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.289, mb=0.495, no=0.995, corr=-0.427) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 63.7274 -> 61.4021
[DBG][ep=032] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2807 mb_mean=0.4952 norm_overlap=0.9953 corr_cb=-0.4194 topkJ=0.0178
[TRAIN][ep=032] loss=0.3903 acc=89.13%
[TRAIN][ep=032] mask_avg: mc_mean=0.2838 mb_mean=0.4946 norm_overlap=0.9948 corr_cb=-0.4267
[EPOCH 032/089] train: loss=0.3903 acc=89.13% | val: loss=1.0870 acc=70.97% f1=47.06% auc=62.21% val_score=56.6288 val_score_bestthr=65.6949 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.284, mb=0.495, no=0.995, corr=-0.427) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 63.7274 -> 65.6949
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=033] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2852 mb_mean=0.4939 norm_overlap=0.9941 corr_cb=-0.4933 topkJ=0.0016
[TRAIN][ep=033] loss=0.4370 acc=90.94%
[TRAIN][ep=033] mask_avg: mc_mean=0.2794 mb_mean=0.4946 norm_overlap=0.9947 corr_cb=-0.4192
[EPOCH 033/089] train: loss=0.4370 acc=90.94% | val: loss=1.1910 acc=69.35% f1=38.71% auc=59.98% val_score=55.0498 val_score_bestthr=62.0792 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.279, mb=0.495, no=0.995, corr=-0.419) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6949 -> 62.0792
[DBG][ep=034] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2792 mb_mean=0.4944 norm_overlap=0.9940 corr_cb=-0.4722 topkJ=0.0121
[TRAIN][ep=034] loss=0.5157 acc=89.67%
[TRAIN][ep=034] mask_avg: mc_mean=0.2758 mb_mean=0.4946 norm_overlap=0.9946 corr_cb=-0.4229
[EPOCH 034/089] train: loss=0.5157 acc=89.67% | val: loss=1.1598 acc=67.74% f1=44.44% auc=60.76% val_score=55.1521 val_score_bestthr=61.4021 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.276, mb=0.495, no=0.995, corr=-0.423) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6949 -> 61.4021
[DBG][ep=035] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2760 mb_mean=0.4948 norm_overlap=0.9959 corr_cb=-0.4051 topkJ=0.0323
[TRAIN][ep=035] loss=0.5373 acc=93.48%
[TRAIN][ep=035] mask_avg: mc_mean=0.2722 mb_mean=0.4946 norm_overlap=0.9946 corr_cb=-0.4161
[EPOCH 035/089] train: loss=0.5373 acc=93.48% | val: loss=1.2098 acc=69.35% f1=45.71% auc=61.20% val_score=55.1521 val_score_bestthr=62.5388 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.272, mb=0.495, no=0.995, corr=-0.416) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 65.6949 -> 62.5388
[DBG][ep=036] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2673 mb_mean=0.4938 norm_overlap=0.9937 corr_cb=-0.4841 topkJ=0.0044
[TRAIN][ep=036] loss=0.6069 acc=91.85%
[TRAIN][ep=036] mask_avg: mc_mean=0.2680 mb_mean=0.4946 norm_overlap=0.9944 corr_cb=-0.4143
[EPOCH 036/089] train: loss=0.6069 acc=91.85% | val: loss=1.2148 acc=70.97% f1=47.06% auc=61.43% val_score=49.8106 val_score_bestthr=66.1501 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.268, mb=0.495, no=0.994, corr=-0.414) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 65.6949 -> 66.1501
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
[DBG][ep=037] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.2763 mb_mean=0.4938 norm_overlap=0.9950 corr_cb=-0.4411 topkJ=0.0075
[TRAIN][ep=037] loss=0.6417 acc=94.93%
[TRAIN][ep=037] mask_avg: mc_mean=0.2645 mb_mean=0.4946 norm_overlap=0.9945 corr_cb=-0.4056
[EPOCH 037/089] train: loss=0.6417 acc=94.93% | val: loss=1.2068 acc=69.35% f1=42.42% auc=61.32% val_score=55.1521 val_score_bestthr=64.8257 | dyn(w_pfs=0.240, w_sup=0.240, w_csuf=0.200, stage2=False) | mask(mc=0.265, mb=0.495, no=0.994, corr=-0.406) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.1501 -> 64.8257
[DBG][ep=038] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2665 mb_mean=0.4953 norm_overlap=0.9945 corr_cb=-0.4235 topkJ=0.0229
[TRAIN][ep=038] loss=0.6289 acc=95.29%
[TRAIN][ep=038] mask_avg: mc_mean=0.2611 mb_mean=0.4946 norm_overlap=0.9943 corr_cb=-0.4063
[EPOCH 038/089] train: loss=0.6289 acc=95.29% | val: loss=1.2391 acc=67.74% f1=44.44% auc=60.54% val_score=56.6288 val_score_bestthr=61.2070 | dyn(w_pfs=0.280, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.261, mb=0.495, no=0.994, corr=-0.406) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.1501 -> 61.2070
[DBG][ep=039] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2649 mb_mean=0.4953 norm_overlap=0.9940 corr_cb=-0.4063 topkJ=0.0418
[TRAIN][ep=039] loss=0.6402 acc=95.65%
[TRAIN][ep=039] mask_avg: mc_mean=0.2577 mb_mean=0.4946 norm_overlap=0.9942 corr_cb=-0.4021
[EPOCH 039/089] train: loss=0.6402 acc=95.65% | val: loss=1.3196 acc=69.35% f1=45.71% auc=60.09% val_score=56.6288 val_score_bestthr=63.5469 | dyn(w_pfs=0.320, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.258, mb=0.495, no=0.994, corr=-0.402) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.1501 -> 63.5469
[DBG][ep=040] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.2668 mb_mean=0.4936 norm_overlap=0.9946 corr_cb=-0.4335 topkJ=0.0115
[TRAIN][ep=040] loss=0.6145 acc=96.56%
[TRAIN][ep=040] mask_avg: mc_mean=0.2555 mb_mean=0.4946 norm_overlap=0.9940 corr_cb=-0.4050
[EPOCH 040/089] train: loss=0.6145 acc=96.56% | val: loss=1.3357 acc=67.74% f1=47.37% auc=62.88% val_score=56.6288 val_score_bestthr=61.5826 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.255, mb=0.495, no=0.994, corr=-0.405) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.1501 -> 61.5826
[DBG][ep=041] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.2554 mb_mean=0.4947 norm_overlap=0.9957 corr_cb=-0.3455 topkJ=0.0595
[TRAIN][ep=041] loss=0.6108 acc=97.10%
[TRAIN][ep=041] mask_avg: mc_mean=0.2530 mb_mean=0.4946 norm_overlap=0.9940 corr_cb=-0.4010
[EPOCH 041/089] train: loss=0.6108 acc=97.10% | val: loss=1.3891 acc=67.74% f1=41.18% auc=60.54% val_score=56.6288 val_score_bestthr=61.9423 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.253, mb=0.495, no=0.994, corr=-0.401) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.1501 -> 61.9423
[DBG][ep=042] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.2502 mb_mean=0.4952 norm_overlap=0.9938 corr_cb=-0.4248 topkJ=0.0052
[TRAIN][ep=042] loss=0.4376 acc=97.46%
[TRAIN][ep=042] mask_avg: mc_mean=0.2507 mb_mean=0.4946 norm_overlap=0.9939 corr_cb=-0.3959
[EPOCH 042/089] train: loss=0.4376 acc=97.46% | val: loss=1.4330 acc=67.74% f1=41.18% auc=60.09% val_score=52.6863 val_score_bestthr=61.9423 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.251, mb=0.495, no=0.994, corr=-0.396) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.1501 -> 61.9423
[DBG][ep=043] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.2470 mb_mean=0.4936 norm_overlap=0.9950 corr_cb=-0.2941 topkJ=0.0438
[TRAIN][ep=043] loss=0.2765 acc=98.19%
[TRAIN][ep=043] mask_avg: mc_mean=0.2487 mb_mean=0.4946 norm_overlap=0.9937 corr_cb=-0.3988
[EPOCH 043/089] train: loss=0.2765 acc=98.19% | val: loss=1.5320 acc=66.13% f1=40.00% auc=58.64% val_score=48.8025 val_score_bestthr=59.8114 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.249, mb=0.495, no=0.994, corr=-0.399) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.1501 -> 59.8114
[DBG][ep=044] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2523 mb_mean=0.4944 norm_overlap=0.9926 corr_cb=-0.4874 topkJ=0.0012
[TRAIN][ep=044] loss=0.2502 acc=97.64%
[TRAIN][ep=044] mask_avg: mc_mean=0.2468 mb_mean=0.4946 norm_overlap=0.9936 corr_cb=-0.3957
[EPOCH 044/089] train: loss=0.2502 acc=97.64% | val: loss=1.5216 acc=69.35% f1=45.71% auc=60.87% val_score=56.6288 val_score_bestthr=64.1277 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.247, mb=0.495, no=0.994, corr=-0.396) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.1501 -> 64.1277
[DBG][ep=045] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2416 mb_mean=0.4971 norm_overlap=0.9952 corr_cb=-0.2567 topkJ=0.0999
[TRAIN][ep=045] loss=0.2356 acc=97.64%
[TRAIN][ep=045] mask_avg: mc_mean=0.2451 mb_mean=0.4946 norm_overlap=0.9935 corr_cb=-0.3989
[EPOCH 045/089] train: loss=0.2356 acc=97.64% | val: loss=1.6170 acc=66.13% f1=46.15% auc=60.31% val_score=52.3161 val_score_bestthr=62.3667 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.245, mb=0.495, no=0.994, corr=-0.399) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.1501 -> 62.3667
[DBG][ep=046] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.2413 mb_mean=0.4943 norm_overlap=0.9948 corr_cb=-0.3621 topkJ=0.0253
[TRAIN][ep=046] loss=0.2313 acc=98.19%
[TRAIN][ep=046] mask_avg: mc_mean=0.2442 mb_mean=0.4946 norm_overlap=0.9934 corr_cb=-0.3978
[EPOCH 046/089] train: loss=0.2313 acc=98.19% | val: loss=1.6107 acc=69.35% f1=45.71% auc=59.42% val_score=55.1521 val_score_bestthr=64.1277 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.244, mb=0.495, no=0.993, corr=-0.398) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.1501 -> 64.1277
[DBG][ep=047] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.2473 mb_mean=0.4961 norm_overlap=0.9926 corr_cb=-0.3614 topkJ=0.0631
[TRAIN][ep=047] loss=0.2148 acc=99.28%
[TRAIN][ep=047] mask_avg: mc_mean=0.2429 mb_mean=0.4946 norm_overlap=0.9933 corr_cb=-0.4014
[EPOCH 047/089] train: loss=0.2148 acc=99.28% | val: loss=1.6974 acc=67.74% f1=44.44% auc=59.87% val_score=52.6863 val_score_bestthr=61.9829 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.243, mb=0.495, no=0.993, corr=-0.401) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.1501 -> 61.9829
[DBG][ep=048] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.2450 mb_mean=0.4949 norm_overlap=0.9919 corr_cb=-0.4386 topkJ=0.0008
[TRAIN][ep=048] loss=0.2097 acc=98.55%
[TRAIN][ep=048] mask_avg: mc_mean=0.2429 mb_mean=0.4946 norm_overlap=0.9932 corr_cb=-0.4007
[EPOCH 048/089] train: loss=0.2097 acc=98.55% | val: loss=1.7482 acc=66.13% f1=46.15% auc=59.64% val_score=52.3161 val_score_bestthr=60.3793 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.243, mb=0.495, no=0.993, corr=-0.401) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.1501 -> 60.3793
[DBG][ep=049] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.2419 mb_mean=0.4929 norm_overlap=0.9958 corr_cb=-0.3136 topkJ=0.0326
[TRAIN][ep=049] loss=0.2057 acc=99.46%
[TRAIN][ep=049] mask_avg: mc_mean=0.2428 mb_mean=0.4946 norm_overlap=0.9930 corr_cb=-0.4043
[EPOCH 049/089] train: loss=0.2057 acc=99.46% | val: loss=1.8226 acc=62.90% f1=43.90% auc=59.31% val_score=52.6863 val_score_bestthr=57.1447 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.243, mb=0.495, no=0.993, corr=-0.404) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 66.1501 -> 57.1447
[DBG][ep=050] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.2506 mb_mean=0.4947 norm_overlap=0.9925 corr_cb=-0.4461 topkJ=0.0066
[TRAIN][ep=050] loss=0.1976 acc=98.55%
[TRAIN][ep=050] mask_avg: mc_mean=0.2423 mb_mean=0.4946 norm_overlap=0.9930 corr_cb=-0.4023
[EPOCH 050/089] train: loss=0.1976 acc=98.55% | val: loss=1.8127 acc=67.74% f1=47.37% auc=59.64% val_score=52.6863 val_score_bestthr=64.6659 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.242, mb=0.495, no=0.993, corr=-0.402) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.1501 -> 64.6659
[DBG][ep=051] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.2491 mb_mean=0.4947 norm_overlap=0.9921 corr_cb=-0.4393 topkJ=0.0361
[TRAIN][ep=051] loss=0.1909 acc=99.82%
[TRAIN][ep=051] mask_avg: mc_mean=0.2423 mb_mean=0.4946 norm_overlap=0.9930 corr_cb=-0.4064
[EPOCH 051/089] train: loss=0.1909 acc=99.82% | val: loss=1.8262 acc=66.13% f1=43.24% auc=59.31% val_score=52.6863 val_score_bestthr=60.8564 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.242, mb=0.495, no=0.993, corr=-0.406) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.1501 -> 60.8564
[DBG][ep=052] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.2368 mb_mean=0.4947 norm_overlap=0.9924 corr_cb=-0.4469 topkJ=0.0232
[TRAIN][ep=052] loss=0.1898 acc=99.46%
[TRAIN][ep=052] mask_avg: mc_mean=0.2423 mb_mean=0.4946 norm_overlap=0.9930 corr_cb=-0.4028
[EPOCH 052/089] train: loss=0.1898 acc=99.46% | val: loss=1.8259 acc=64.52% f1=45.00% auc=59.42% val_score=52.6863 val_score_bestthr=58.0686 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.242, mb=0.495, no=0.993, corr=-0.403) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.1501 -> 58.0686
[DBG][ep=053] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.2473 mb_mean=0.4941 norm_overlap=0.9895 corr_cb=-0.5365 topkJ=0.0012
[TRAIN][ep=053] loss=0.1879 acc=99.46%
[TRAIN][ep=053] mask_avg: mc_mean=0.2423 mb_mean=0.4946 norm_overlap=0.9930 corr_cb=-0.4035
[EPOCH 053/089] train: loss=0.1879 acc=99.46% | val: loss=1.8379 acc=64.52% f1=45.00% auc=59.87% val_score=52.6863 val_score_bestthr=58.0686 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.242, mb=0.495, no=0.993, corr=-0.404) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.1501 -> 58.0686
[DBG][ep=054] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=054] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=054] mask(step0): mc_mean=0.2409 mb_mean=0.4938 norm_overlap=0.9928 corr_cb=-0.4155 topkJ=0.0212
[TRAIN][ep=054] loss=0.1891 acc=99.46%
[TRAIN][ep=054] mask_avg: mc_mean=0.2423 mb_mean=0.4946 norm_overlap=0.9930 corr_cb=-0.4022
[EPOCH 054/089] train: loss=0.1891 acc=99.46% | val: loss=1.8428 acc=64.52% f1=45.00% auc=59.53% val_score=52.6863 val_score_bestthr=58.0686 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.242, mb=0.495, no=0.993, corr=-0.402) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.1501 -> 58.0686
[DBG][ep=055] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=055] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=055] mask(step0): mc_mean=0.2389 mb_mean=0.4951 norm_overlap=0.9932 corr_cb=-0.4137 topkJ=0.0116
[TRAIN][ep=055] loss=0.1880 acc=99.64%
[TRAIN][ep=055] mask_avg: mc_mean=0.2423 mb_mean=0.4946 norm_overlap=0.9930 corr_cb=-0.4033
[EPOCH 055/089] train: loss=0.1880 acc=99.64% | val: loss=1.8423 acc=67.74% f1=44.44% auc=59.53% val_score=52.6863 val_score_bestthr=61.9829 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.242, mb=0.495, no=0.993, corr=-0.403) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.1501 -> 61.9829
[DBG][ep=056] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=056] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=056] mask(step0): mc_mean=0.2473 mb_mean=0.4948 norm_overlap=0.9922 corr_cb=-0.4789 topkJ=0.0049
[TRAIN][ep=056] loss=0.1879 acc=99.82%
[TRAIN][ep=056] mask_avg: mc_mean=0.2423 mb_mean=0.4946 norm_overlap=0.9930 corr_cb=-0.4043
[EPOCH 056/089] train: loss=0.1879 acc=99.82% | val: loss=1.8498 acc=67.74% f1=44.44% auc=59.42% val_score=52.6863 val_score_bestthr=61.9829 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.242, mb=0.495, no=0.993, corr=-0.404) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.1501 -> 61.9829
[DBG][ep=057] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=057] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=057] mask(step0): mc_mean=0.2322 mb_mean=0.4962 norm_overlap=0.9903 corr_cb=-0.4616 topkJ=0.0343
[TRAIN][ep=057] loss=0.1872 acc=99.46%
[TRAIN][ep=057] mask_avg: mc_mean=0.2423 mb_mean=0.4946 norm_overlap=0.9930 corr_cb=-0.4021
[EPOCH 057/089] train: loss=0.1872 acc=99.46% | val: loss=1.8588 acc=66.13% f1=43.24% auc=59.42% val_score=52.6863 val_score_bestthr=60.8564 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.242, mb=0.495, no=0.993, corr=-0.402) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.1501 -> 60.8564
[DBG][ep=058] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=058] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=058] mask(step0): mc_mean=0.2374 mb_mean=0.4926 norm_overlap=0.9966 corr_cb=-0.2121 topkJ=0.0344
[TRAIN][ep=058] loss=0.1834 acc=99.46%
[TRAIN][ep=058] mask_avg: mc_mean=0.2423 mb_mean=0.4946 norm_overlap=0.9930 corr_cb=-0.4044
[EPOCH 058/089] train: loss=0.1834 acc=99.46% | val: loss=1.8753 acc=64.52% f1=45.00% auc=59.53% val_score=52.6863 val_score_bestthr=58.0686 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.242, mb=0.495, no=0.993, corr=-0.404) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.1501 -> 58.0686
[DBG][ep=059] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=059] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=059] mask(step0): mc_mean=0.2381 mb_mean=0.4936 norm_overlap=0.9943 corr_cb=-0.3593 topkJ=0.0546
[TRAIN][ep=059] loss=0.1834 acc=99.82%
[TRAIN][ep=059] mask_avg: mc_mean=0.2423 mb_mean=0.4946 norm_overlap=0.9930 corr_cb=-0.4032
[EPOCH 059/089] train: loss=0.1834 acc=99.82% | val: loss=1.8677 acc=67.74% f1=44.44% auc=59.53% val_score=55.5161 val_score_bestthr=61.9829 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.242, mb=0.495, no=0.993, corr=-0.403) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.1501 -> 61.9829
[DBG][ep=060] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=060] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=060] mask(step0): mc_mean=0.2393 mb_mean=0.4948 norm_overlap=0.9943 corr_cb=-0.3699 topkJ=0.0192
[TRAIN][ep=060] loss=0.1826 acc=99.64%
[TRAIN][ep=060] mask_avg: mc_mean=0.2423 mb_mean=0.4946 norm_overlap=0.9930 corr_cb=-0.4040
[EPOCH 060/089] train: loss=0.1826 acc=99.64% | val: loss=1.9003 acc=64.52% f1=45.00% auc=59.64% val_score=52.6863 val_score_bestthr=58.0686 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.242, mb=0.495, no=0.993, corr=-0.404) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.1501 -> 58.0686
[DBG][ep=061] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=061] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=061] mask(step0): mc_mean=0.2341 mb_mean=0.4953 norm_overlap=0.9942 corr_cb=-0.3890 topkJ=0.0185
[TRAIN][ep=061] loss=0.1845 acc=99.82%
[TRAIN][ep=061] mask_avg: mc_mean=0.2423 mb_mean=0.4946 norm_overlap=0.9930 corr_cb=-0.4029
[EPOCH 061/089] train: loss=0.1845 acc=99.82% | val: loss=1.9067 acc=64.52% f1=45.00% auc=59.42% val_score=52.6863 val_score_bestthr=58.0686 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.242, mb=0.495, no=0.993, corr=-0.403) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.1501 -> 58.0686
[DBG][ep=062] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=062] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=062] mask(step0): mc_mean=0.2392 mb_mean=0.4944 norm_overlap=0.9932 corr_cb=-0.4347 topkJ=0.0100
[TRAIN][ep=062] loss=0.1806 acc=99.64%
[TRAIN][ep=062] mask_avg: mc_mean=0.2423 mb_mean=0.4946 norm_overlap=0.9930 corr_cb=-0.4025
[EPOCH 062/089] train: loss=0.1806 acc=99.64% | val: loss=1.8973 acc=67.74% f1=44.44% auc=59.53% val_score=55.5161 val_score_bestthr=61.9829 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.242, mb=0.495, no=0.993, corr=-0.403) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.1501 -> 61.9829
[DBG][ep=063] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=063] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=063] mask(step0): mc_mean=0.2457 mb_mean=0.4950 norm_overlap=0.9948 corr_cb=-0.3733 topkJ=0.0340
[TRAIN][ep=063] loss=0.1871 acc=99.64%
[TRAIN][ep=063] mask_avg: mc_mean=0.2423 mb_mean=0.4946 norm_overlap=0.9930 corr_cb=-0.4012
[EPOCH 063/089] train: loss=0.1871 acc=99.64% | val: loss=1.9092 acc=64.52% f1=45.00% auc=59.53% val_score=55.5161 val_score_bestthr=58.0686 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.242, mb=0.495, no=0.993, corr=-0.401) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.1501 -> 58.0686
[DBG][ep=064] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=064] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=064] mask(step0): mc_mean=0.2345 mb_mean=0.4949 norm_overlap=0.9951 corr_cb=-0.2779 topkJ=0.0509
[TRAIN][ep=064] loss=0.1810 acc=99.64%
[TRAIN][ep=064] mask_avg: mc_mean=0.2423 mb_mean=0.4946 norm_overlap=0.9930 corr_cb=-0.4017
[EPOCH 064/089] train: loss=0.1810 acc=99.64% | val: loss=1.9190 acc=66.13% f1=43.24% auc=59.20% val_score=55.5161 val_score_bestthr=57.5150 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.242, mb=0.495, no=0.993, corr=-0.402) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.1501 -> 57.5150
[DBG][ep=065] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=065] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=065] mask(step0): mc_mean=0.2464 mb_mean=0.4949 norm_overlap=0.9898 corr_cb=-0.5534 topkJ=0.0012
[TRAIN][ep=065] loss=0.1807 acc=99.82%
[TRAIN][ep=065] mask_avg: mc_mean=0.2423 mb_mean=0.4946 norm_overlap=0.9930 corr_cb=-0.4041
[EPOCH 065/089] train: loss=0.1807 acc=99.82% | val: loss=1.9324 acc=64.52% f1=52.17% auc=59.42% val_score=52.6863 val_score_bestthr=56.6288 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.242, mb=0.495, no=0.993, corr=-0.404) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.1501 -> 56.6288
[DBG][ep=066] disease_pos_weight=1.3266 mode=sqrt
[DBG][ep=066] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=066] mask(step0): mc_mean=0.2357 mb_mean=0.4938 norm_overlap=0.9935 corr_cb=-0.4220 topkJ=0.0362
[TRAIN][ep=066] loss=0.1788 acc=99.82%
[TRAIN][ep=066] mask_avg: mc_mean=0.2423 mb_mean=0.4946 norm_overlap=0.9930 corr_cb=-0.4031
[EPOCH 066/089] train: loss=0.1788 acc=99.82% | val: loss=1.9348 acc=64.52% f1=52.17% auc=59.20% val_score=52.6863 val_score_bestthr=56.6288 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.242, mb=0.495, no=0.993, corr=-0.403) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 66.1501 -> 56.6288
[EARLY STOP] no improvement for 30 epochs. best_epoch=36
[CKPT] Loaded best for testing: results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/ckpt_best_fold_2.pt
=============== FIT DONE ===============
[BEST] epoch=36 | val_acc=70.97% | val_f1=47.06% | val_auc=61.43% | val_score=49.8106 | val_score_bestthr=66.1501
[TEST@BEST] thr_used=0.950 | acc=63.40% f1=9.68% auc=57.51% | SP_sex=3.71% EO_sex=3.04% SP_age=8.11% EO_age=11.76%
[TIME] 1.27 min
[OK] Saved: results/ADHD_3x5fold_seed0/fold2_rep1_seed1002/summary_fold_2.json
