[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5033 mb_mean=0.5074 norm_overlap=1.0000 corr_cb=-0.0236 topkJ=0.0769
[TRAIN][ep=000] loss=0.6876 acc=61.34%
[TRAIN][ep=000] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1035
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5043 mb_mean=0.5082 norm_overlap=1.0001 corr_cb=0.1648 topkJ=0.0737
[TRAIN][ep=001] loss=0.6755 acc=63.70%
[TRAIN][ep=001] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1054
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5022 mb_mean=0.5087 norm_overlap=1.0002 corr_cb=0.2275 topkJ=0.1455
[TRAIN][ep=002] loss=0.6656 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1043
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5035 mb_mean=0.5094 norm_overlap=1.0000 corr_cb=0.0241 topkJ=0.0509
[TRAIN][ep=003] loss=0.6594 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1050
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5028 mb_mean=0.5106 norm_overlap=1.0000 corr_cb=-0.0149 topkJ=0.0979
[TRAIN][ep=004] loss=0.6565 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1064
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5019 mb_mean=0.5085 norm_overlap=1.0001 corr_cb=0.1280 topkJ=0.1508
[TRAIN][ep=005] loss=0.6563 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1026
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5034 mb_mean=0.5096 norm_overlap=1.0001 corr_cb=0.0714 topkJ=0.1095
[TRAIN][ep=006] loss=0.6540 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1069
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5027 mb_mean=0.5084 norm_overlap=1.0001 corr_cb=0.0800 topkJ=0.0599
[TRAIN][ep=007] loss=0.6536 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1041
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5013 mb_mean=0.5071 norm_overlap=1.0002 corr_cb=0.2685 topkJ=0.0945
[TRAIN][ep=008] loss=0.6521 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1038
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5020 mb_mean=0.5111 norm_overlap=1.0000 corr_cb=0.0016 topkJ=0.0557
[TRAIN][ep=009] loss=0.6513 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1023
================= FIT START (fold=1) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.35 select_by=val_score | eval_thr_mode=best_acc eval_thr_grid=coarse | disease_pos_weight_mode=none freeze_b_after=15 | two_stage=True stage1_ratio=0.35 stage2_lr_mult=0.3 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5045 mb_mean=0.5109 norm_overlap=1.0000 corr_cb=0.0362 topkJ=0.0638
[TRAIN][ep=000] loss=0.6500 acc=63.70%
[TRAIN][ep=000] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1077
[EPOCH 000/089] train: loss=0.6500 acc=63.70% | val: loss=0.6577 acc=62.90% f1=0.00% auc=54.96% val_score=72.0763 val_score_bestthr=62.9032 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.503, mb=0.509, no=1.000, corr=0.108) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* -1000000000000000000.0000 -> 72.0763
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5043 mb_mean=0.5100 norm_overlap=1.0000 corr_cb=-0.0050 topkJ=0.0422
[TRAIN][ep=001] loss=0.6489 acc=63.70%
[TRAIN][ep=001] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1086
[EPOCH 001/089] train: loss=0.6489 acc=63.70% | val: loss=0.6572 acc=64.52% f1=38.89% auc=56.08% val_score=70.1231 val_score_bestthr=83.2578 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.503, mb=0.509, no=1.000, corr=0.109) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 72.0763 -> 70.1231
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5004 mb_mean=0.5099 norm_overlap=1.0001 corr_cb=0.2004 topkJ=0.1277
[TRAIN][ep=002] loss=0.6480 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1068
[EPOCH 002/089] train: loss=0.6480 acc=63.70% | val: loss=0.6569 acc=62.90% f1=30.30% auc=56.19% val_score=74.6247 val_score_bestthr=77.4480 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.503, mb=0.509, no=1.000, corr=0.107) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 72.0763 -> 74.6247
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5013 mb_mean=0.5096 norm_overlap=1.0001 corr_cb=0.1039 topkJ=0.0703
[TRAIN][ep=003] loss=0.6465 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1068
[EPOCH 003/089] train: loss=0.6465 acc=63.70% | val: loss=0.6568 acc=64.52% f1=38.89% auc=57.19% val_score=75.4593 val_score_bestthr=83.2578 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.503, mb=0.509, no=1.000, corr=0.107) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 74.6247 -> 75.4593
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.0595 topkJ=0.0573
[TRAIN][ep=004] loss=0.6452 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1040
[EPOCH 004/089] train: loss=0.6452 acc=63.70% | val: loss=0.6559 acc=66.13% f1=43.24% auc=57.75% val_score=65.9529 val_score_bestthr=87.0247 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.503, mb=0.509, no=1.000, corr=0.104) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 75.4593 -> 65.9529
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5024 mb_mean=0.5096 norm_overlap=1.0000 corr_cb=0.0125 topkJ=0.1126
[TRAIN][ep=005] loss=2.1881 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.4943 mb_mean=0.4996 norm_overlap=1.0001 corr_cb=0.1044
[EPOCH 005/089] train: loss=2.1881 acc=63.70% | val: loss=0.6565 acc=66.13% f1=43.24% auc=57.41% val_score=76.7733 val_score_bestthr=87.0247 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.494, mb=0.500, no=1.000, corr=0.104) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 75.4593 -> 76.7733
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4851 mb_mean=0.4888 norm_overlap=1.0002 corr_cb=0.1781 topkJ=0.0638
[TRAIN][ep=006] loss=2.1844 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.4776 mb_mean=0.4779 norm_overlap=1.0004 corr_cb=0.1905
[EPOCH 006/089] train: loss=2.1844 acc=63.70% | val: loss=0.6567 acc=67.74% f1=50.00% auc=58.08% val_score=72.8728 val_score_bestthr=91.6142 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.478, mb=0.478, no=1.000, corr=0.191) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.7733 -> 72.8728
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4687 mb_mean=0.4658 norm_overlap=1.0007 corr_cb=0.2240 topkJ=0.1015
[TRAIN][ep=007] loss=2.1789 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.4606 mb_mean=0.4532 norm_overlap=1.0015 corr_cb=0.3799
[EPOCH 007/089] train: loss=2.1789 acc=63.70% | val: loss=0.6563 acc=64.52% f1=50.00% auc=58.19% val_score=72.8728 val_score_bestthr=88.4099 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.461, mb=0.453, no=1.001, corr=0.380) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.7733 -> 72.8728
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4519 mb_mean=0.4450 norm_overlap=1.0026 corr_cb=0.4388 topkJ=0.1688
[TRAIN][ep=008] loss=2.1748 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.4439 mb_mean=0.4268 norm_overlap=1.0031 corr_cb=0.4606
[EPOCH 008/089] train: loss=2.1748 acc=63.70% | val: loss=0.6560 acc=66.13% f1=43.24% auc=57.75% val_score=71.9285 val_score_bestthr=87.0247 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.444, mb=0.427, no=1.003, corr=0.461) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.7733 -> 71.9285
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4364 mb_mean=0.4153 norm_overlap=1.0032 corr_cb=0.4959 topkJ=0.2365
[TRAIN][ep=009] loss=2.1687 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.4273 mb_mean=0.4002 norm_overlap=1.0049 corr_cb=0.4381
[EPOCH 009/089] train: loss=2.1687 acc=63.70% | val: loss=0.6560 acc=64.52% f1=50.00% auc=57.86% val_score=73.9607 val_score_bestthr=88.5630 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.427, mb=0.400, no=1.005, corr=0.438) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.7733 -> 73.9607
[DBG][ep=010] disease_pos_weight=1.0000 mode=none
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.4246 mb_mean=0.3997 norm_overlap=1.0057 corr_cb=0.4463 topkJ=0.1762
[TRAIN][ep=010] loss=2.1598 acc=63.70%
[TRAIN][ep=010] mask_avg: mc_mean=0.4117 mb_mean=0.3748 norm_overlap=1.0059 corr_cb=0.3464
[EPOCH 010/089] train: loss=2.1598 acc=63.70% | val: loss=0.6553 acc=66.13% f1=36.36% auc=58.75% val_score=62.8082 val_score_bestthr=83.7543 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.412, mb=0.375, no=1.006, corr=0.346) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.7733 -> 62.8082
[DBG][ep=011] disease_pos_weight=1.0000 mode=none
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.3956 mb_mean=0.3447 norm_overlap=1.0147 corr_cb=0.4044 topkJ=0.1120
[TRAIN][ep=011] loss=2.1552 acc=63.70%
[TRAIN][ep=011] mask_avg: mc_mean=0.3963 mb_mean=0.3523 norm_overlap=1.0046 corr_cb=0.1730
[EPOCH 011/089] train: loss=2.1552 acc=63.70% | val: loss=0.6554 acc=66.13% f1=55.32% auc=58.86% val_score=69.7838 val_score_bestthr=92.8120 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.396, mb=0.352, no=1.005, corr=0.173) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.7733 -> 69.7838
[DBG][ep=012] disease_pos_weight=1.0000 mode=none
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.3922 mb_mean=0.3470 norm_overlap=1.0004 corr_cb=0.0144 topkJ=0.1234
[TRAIN][ep=012] loss=2.1552 acc=63.70%
[TRAIN][ep=012] mask_avg: mc_mean=0.3818 mb_mean=0.3345 norm_overlap=1.0015 corr_cb=0.0427
[EPOCH 012/089] train: loss=2.1552 acc=63.70% | val: loss=0.6555 acc=66.13% f1=32.26% auc=58.42% val_score=75.9104 val_score_bestthr=81.6375 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.382, mb=0.334, no=1.001, corr=0.043) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.7733 -> 75.9104
[DBG][ep=013] disease_pos_weight=1.0000 mode=none
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.3812 mb_mean=0.3301 norm_overlap=0.9995 corr_cb=-0.0132 topkJ=0.0877
[TRAIN][ep=013] loss=2.1417 acc=63.70%
[TRAIN][ep=013] mask_avg: mc_mean=0.3689 mb_mean=0.3192 norm_overlap=0.9929 corr_cb=-0.1367
[EPOCH 013/089] train: loss=2.1417 acc=63.70% | val: loss=0.6561 acc=66.13% f1=43.24% auc=56.63% val_score=69.8759 val_score_bestthr=86.9968 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.369, mb=0.319, no=0.993, corr=-0.137) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.7733 -> 69.8759
[DBG][ep=014] disease_pos_weight=1.0000 mode=none
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.3607 mb_mean=0.3189 norm_overlap=0.9837 corr_cb=-0.2826 topkJ=0.0158
[TRAIN][ep=014] loss=2.1317 acc=63.70%
[TRAIN][ep=014] mask_avg: mc_mean=0.3560 mb_mean=0.3070 norm_overlap=0.9732 corr_cb=-0.3589
[EPOCH 014/089] train: loss=2.1317 acc=63.70% | val: loss=0.6561 acc=66.13% f1=51.16% auc=56.41% val_score=67.9137 val_score_bestthr=91.0869 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.356, mb=0.307, no=0.973, corr=-0.359) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.7733 -> 67.9137
[DBG][ep=015] disease_pos_weight=1.0000 mode=none
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.3490 mb_mean=0.3008 norm_overlap=0.9610 corr_cb=-0.4740 topkJ=0.0219
[TRAIN][ep=015] loss=2.1296 acc=63.70%
[TRAIN][ep=015] mask_avg: mc_mean=0.3435 mb_mean=0.3022 norm_overlap=0.9493 corr_cb=-0.5149
[EPOCH 015/089] train: loss=2.1296 acc=63.70% | val: loss=0.6554 acc=64.52% f1=50.00% auc=57.19% val_score=80.0104 val_score_bestthr=88.8371 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.344, mb=0.302, no=0.949, corr=-0.515) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=* 76.7733 -> 80.0104
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=016] disease_pos_weight=1.0000 mode=none
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.3348 mb_mean=0.2995 norm_overlap=0.9375 corr_cb=-0.5791 topkJ=0.0025
[TRAIN][ep=016] loss=2.1195 acc=63.70%
[TRAIN][ep=016] mask_avg: mc_mean=0.3333 mb_mean=0.3022 norm_overlap=0.9365 corr_cb=-0.5589
[EPOCH 016/089] train: loss=2.1195 acc=63.70% | val: loss=0.6550 acc=64.52% f1=50.00% auc=56.86% val_score=71.9126 val_score_bestthr=88.8371 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.333, mb=0.302, no=0.937, corr=-0.559) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 80.0104 -> 71.9126
[DBG][ep=017] disease_pos_weight=1.0000 mode=none
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.3278 mb_mean=0.3077 norm_overlap=0.9269 corr_cb=-0.5755 topkJ=0.0028
[TRAIN][ep=017] loss=1.4163 acc=63.70%
[TRAIN][ep=017] mask_avg: mc_mean=0.3236 mb_mean=0.3022 norm_overlap=0.9205 corr_cb=-0.6026
[EPOCH 017/089] train: loss=1.4163 acc=63.70% | val: loss=0.6560 acc=64.52% f1=47.62% auc=56.86% val_score=85.2286 val_score_bestthr=87.5961 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.324, mb=0.302, no=0.920, corr=-0.603) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=* 80.0104 -> 85.2286
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=018] disease_pos_weight=1.0000 mode=none
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.3167 mb_mean=0.3120 norm_overlap=0.9415 corr_cb=-0.5158 topkJ=0.0016
[TRAIN][ep=018] loss=0.7116 acc=63.70%
[TRAIN][ep=018] mask_avg: mc_mean=0.3148 mb_mean=0.3022 norm_overlap=0.9041 corr_cb=-0.6430
[EPOCH 018/089] train: loss=0.7116 acc=63.70% | val: loss=0.6566 acc=64.52% f1=47.62% auc=56.41% val_score=78.2224 val_score_bestthr=87.8294 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.315, mb=0.302, no=0.904, corr=-0.643) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 78.2224
[DBG][ep=019] disease_pos_weight=1.0000 mode=none
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.3188 mb_mean=0.3111 norm_overlap=0.9190 corr_cb=-0.6537 topkJ=0.0000
[TRAIN][ep=019] loss=0.5326 acc=63.70%
[TRAIN][ep=019] mask_avg: mc_mean=0.3072 mb_mean=0.3022 norm_overlap=0.8867 corr_cb=-0.6782
[EPOCH 019/089] train: loss=0.5326 acc=63.70% | val: loss=0.6560 acc=66.13% f1=43.24% auc=55.07% val_score=76.0144 val_score_bestthr=87.2428 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.307, mb=0.302, no=0.887, corr=-0.678) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 76.0144
[DBG][ep=020] disease_pos_weight=1.0000 mode=none
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.3080 mb_mean=0.2992 norm_overlap=0.8633 corr_cb=-0.6907 topkJ=0.0000
[TRAIN][ep=020] loss=0.5132 acc=64.61%
[TRAIN][ep=020] mask_avg: mc_mean=0.3009 mb_mean=0.3022 norm_overlap=0.8677 corr_cb=-0.7072
[EPOCH 020/089] train: loss=0.5132 acc=64.61% | val: loss=0.6574 acc=66.13% f1=43.24% auc=54.63% val_score=71.0740 val_score_bestthr=87.2428 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.301, mb=0.302, no=0.868, corr=-0.707) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 71.0740
[DBG][ep=021] disease_pos_weight=1.0000 mode=none
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2941 mb_mean=0.2996 norm_overlap=0.8419 corr_cb=-0.7577 topkJ=0.0000
[TRAIN][ep=021] loss=0.5030 acc=66.42%
[TRAIN][ep=021] mask_avg: mc_mean=0.2958 mb_mean=0.3022 norm_overlap=0.8450 corr_cb=-0.7408
[EPOCH 021/089] train: loss=0.5030 acc=66.42% | val: loss=0.6603 acc=64.52% f1=42.11% auc=55.85% val_score=73.1226 val_score_bestthr=84.9757 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.296, mb=0.302, no=0.845, corr=-0.741) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 73.1226
[DBG][ep=022] disease_pos_weight=1.0000 mode=none
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2992 mb_mean=0.3005 norm_overlap=0.8288 corr_cb=-0.7799 topkJ=0.0000
[TRAIN][ep=022] loss=0.4928 acc=68.42%
[TRAIN][ep=022] mask_avg: mc_mean=0.2925 mb_mean=0.3022 norm_overlap=0.8258 corr_cb=-0.7612
[EPOCH 022/089] train: loss=0.4928 acc=68.42% | val: loss=0.6630 acc=64.52% f1=15.38% auc=55.07% val_score=71.0740 val_score_bestthr=71.6233 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.292, mb=0.302, no=0.826, corr=-0.761) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 71.0740
[DBG][ep=023] disease_pos_weight=1.0000 mode=none
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2877 mb_mean=0.3053 norm_overlap=0.8192 corr_cb=-0.7704 topkJ=0.0000
[TRAIN][ep=023] loss=0.4835 acc=71.14%
[TRAIN][ep=023] mask_avg: mc_mean=0.2903 mb_mean=0.3022 norm_overlap=0.8047 corr_cb=-0.7801
[EPOCH 023/089] train: loss=0.4835 acc=71.14% | val: loss=0.6700 acc=64.52% f1=42.11% auc=54.63% val_score=76.1594 val_score_bestthr=84.9757 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.290, mb=0.302, no=0.805, corr=-0.780) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 76.1594
[DBG][ep=024] disease_pos_weight=1.0000 mode=none
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2982 mb_mean=0.2939 norm_overlap=0.7917 corr_cb=-0.7744 topkJ=0.0000
[TRAIN][ep=024] loss=0.4725 acc=70.24%
[TRAIN][ep=024] mask_avg: mc_mean=0.2880 mb_mean=0.3022 norm_overlap=0.7897 corr_cb=-0.7894
[EPOCH 024/089] train: loss=0.4725 acc=70.24% | val: loss=0.6733 acc=64.52% f1=21.43% auc=53.18% val_score=67.0301 val_score_bestthr=74.6880 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.288, mb=0.302, no=0.790, corr=-0.789) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 67.0301
[DBG][ep=025] disease_pos_weight=1.0000 mode=none
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2741 mb_mean=0.3165 norm_overlap=0.8639 corr_cb=-0.6682 topkJ=0.0000
[TRAIN][ep=025] loss=0.4699 acc=72.41%
[TRAIN][ep=025] mask_avg: mc_mean=0.2877 mb_mean=0.3022 norm_overlap=0.7752 corr_cb=-0.7969
[EPOCH 025/089] train: loss=0.4699 acc=72.41% | val: loss=0.6778 acc=64.52% f1=21.43% auc=52.51% val_score=69.1281 val_score_bestthr=74.6880 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.288, mb=0.302, no=0.775, corr=-0.797) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 69.1281
[DBG][ep=026] disease_pos_weight=1.0000 mode=none
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2781 mb_mean=0.2915 norm_overlap=0.7319 corr_cb=-0.8064 topkJ=0.0000
[TRAIN][ep=026] loss=0.4595 acc=70.96%
[TRAIN][ep=026] mask_avg: mc_mean=0.2855 mb_mean=0.3022 norm_overlap=0.7646 corr_cb=-0.8022
[EPOCH 026/089] train: loss=0.4595 acc=70.96% | val: loss=0.6829 acc=64.52% f1=21.43% auc=53.51% val_score=68.3936 val_score_bestthr=74.6880 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.285, mb=0.302, no=0.765, corr=-0.802) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 68.3936
[DBG][ep=027] disease_pos_weight=1.0000 mode=none
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2855 mb_mean=0.3163 norm_overlap=0.7973 corr_cb=-0.8064 topkJ=0.0000
[TRAIN][ep=027] loss=0.4503 acc=73.50%
[TRAIN][ep=027] mask_avg: mc_mean=0.2841 mb_mean=0.3022 norm_overlap=0.7554 corr_cb=-0.8058
[EPOCH 027/089] train: loss=0.4503 acc=73.50% | val: loss=0.6844 acc=64.52% f1=21.43% auc=52.29% val_score=68.0860 val_score_bestthr=74.6880 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.284, mb=0.302, no=0.755, corr=-0.806) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 68.0860
[DBG][ep=028] disease_pos_weight=1.0000 mode=none
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2771 mb_mean=0.3089 norm_overlap=0.7583 corr_cb=-0.8192 topkJ=0.0000
[TRAIN][ep=028] loss=0.4434 acc=72.96%
[TRAIN][ep=028] mask_avg: mc_mean=0.2823 mb_mean=0.3022 norm_overlap=0.7450 corr_cb=-0.8122
[EPOCH 028/089] train: loss=0.4434 acc=72.96% | val: loss=0.6857 acc=64.52% f1=26.67% auc=51.84% val_score=70.0121 val_score_bestthr=77.3127 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.282, mb=0.302, no=0.745, corr=-0.812) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 70.0121
[DBG][ep=029] disease_pos_weight=1.0000 mode=none
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2669 mb_mean=0.2927 norm_overlap=0.7407 corr_cb=-0.7518 topkJ=0.0000
[TRAIN][ep=029] loss=0.4320 acc=74.23%
[TRAIN][ep=029] mask_avg: mc_mean=0.2786 mb_mean=0.3022 norm_overlap=0.7388 corr_cb=-0.8088
[EPOCH 029/089] train: loss=0.4320 acc=74.23% | val: loss=0.6900 acc=66.13% f1=16.00% auc=52.51% val_score=68.0860 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.279, mb=0.302, no=0.739, corr=-0.809) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 68.0860
[DBG][ep=030] disease_pos_weight=1.0000 mode=none
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2646 mb_mean=0.3132 norm_overlap=0.7392 corr_cb=-0.7805 topkJ=0.0000
[TRAIN][ep=030] loss=0.4238 acc=74.95%
[TRAIN][ep=030] mask_avg: mc_mean=0.2773 mb_mean=0.3022 norm_overlap=0.7317 corr_cb=-0.8102
[EPOCH 030/089] train: loss=0.4238 acc=74.95% | val: loss=0.6932 acc=66.13% f1=16.00% auc=52.51% val_score=67.0905 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.277, mb=0.302, no=0.732, corr=-0.810) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 67.0905
[DBG][ep=031] disease_pos_weight=1.0000 mode=none
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2857 mb_mean=0.2882 norm_overlap=0.6516 corr_cb=-0.8562 topkJ=0.0000
[TRAIN][ep=031] loss=0.4129 acc=75.86%
[TRAIN][ep=031] mask_avg: mc_mean=0.2764 mb_mean=0.3023 norm_overlap=0.7283 corr_cb=-0.8101
[EPOCH 031/089] train: loss=0.4129 acc=75.86% | val: loss=0.6943 acc=66.13% f1=16.00% auc=52.73% val_score=66.0424 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.302, no=0.728, corr=-0.810) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 66.0424
[DBG][ep=032] disease_pos_weight=1.0000 mode=none
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2600 mb_mean=0.3123 norm_overlap=0.8079 corr_cb=-0.7534 topkJ=0.0000
[TRAIN][ep=032] loss=0.4126 acc=75.68%
[TRAIN][ep=032] mask_avg: mc_mean=0.2764 mb_mean=0.3022 norm_overlap=0.7285 corr_cb=-0.8088
[EPOCH 032/089] train: loss=0.4126 acc=75.68% | val: loss=0.6943 acc=66.13% f1=16.00% auc=52.40% val_score=67.0905 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.302, no=0.729, corr=-0.809) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 67.0905
[DBG][ep=033] disease_pos_weight=1.0000 mode=none
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2891 mb_mean=0.2923 norm_overlap=0.6927 corr_cb=-0.7734 topkJ=0.0000
[TRAIN][ep=033] loss=0.4097 acc=75.50%
[TRAIN][ep=033] mask_avg: mc_mean=0.2764 mb_mean=0.3022 norm_overlap=0.7284 corr_cb=-0.8100
[EPOCH 033/089] train: loss=0.4097 acc=75.50% | val: loss=0.6953 acc=66.13% f1=16.00% auc=52.06% val_score=67.0905 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.302, no=0.728, corr=-0.810) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 67.0905
[DBG][ep=034] disease_pos_weight=1.0000 mode=none
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2692 mb_mean=0.3080 norm_overlap=0.7707 corr_cb=-0.7983 topkJ=0.0000
[TRAIN][ep=034] loss=0.4072 acc=76.04%
[TRAIN][ep=034] mask_avg: mc_mean=0.2764 mb_mean=0.3022 norm_overlap=0.7284 corr_cb=-0.8101
[EPOCH 034/089] train: loss=0.4072 acc=76.04% | val: loss=0.6970 acc=66.13% f1=16.00% auc=52.62% val_score=66.0133 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.302, no=0.728, corr=-0.810) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 66.0133
[DBG][ep=035] disease_pos_weight=1.0000 mode=none
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2605 mb_mean=0.3206 norm_overlap=0.7931 corr_cb=-0.7566 topkJ=0.0000
[TRAIN][ep=035] loss=0.4069 acc=76.23%
[TRAIN][ep=035] mask_avg: mc_mean=0.2764 mb_mean=0.3022 norm_overlap=0.7283 corr_cb=-0.8096
[EPOCH 035/089] train: loss=0.4069 acc=76.23% | val: loss=0.6964 acc=66.13% f1=16.00% auc=52.51% val_score=67.0905 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.302, no=0.728, corr=-0.810) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 67.0905
[DBG][ep=036] disease_pos_weight=1.0000 mode=none
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2800 mb_mean=0.3143 norm_overlap=0.7462 corr_cb=-0.8469 topkJ=0.0000
[TRAIN][ep=036] loss=0.4045 acc=75.86%
[TRAIN][ep=036] mask_avg: mc_mean=0.2764 mb_mean=0.3022 norm_overlap=0.7284 corr_cb=-0.8103
[EPOCH 036/089] train: loss=0.4045 acc=75.86% | val: loss=0.6966 acc=66.13% f1=16.00% auc=52.40% val_score=67.0905 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.302, no=0.728, corr=-0.810) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 67.0905
[DBG][ep=037] disease_pos_weight=1.0000 mode=none
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.2939 mb_mean=0.2892 norm_overlap=0.6430 corr_cb=-0.8542 topkJ=0.0000
[TRAIN][ep=037] loss=0.4020 acc=76.04%
[TRAIN][ep=037] mask_avg: mc_mean=0.2764 mb_mean=0.3022 norm_overlap=0.7285 corr_cb=-0.8091
[EPOCH 037/089] train: loss=0.4020 acc=76.04% | val: loss=0.6979 acc=66.13% f1=16.00% auc=52.95% val_score=69.0566 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.302, no=0.728, corr=-0.809) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 69.0566
[DBG][ep=038] disease_pos_weight=1.0000 mode=none
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2396 mb_mean=0.3128 norm_overlap=0.8177 corr_cb=-0.6842 topkJ=0.0000
[TRAIN][ep=038] loss=0.3998 acc=76.23%
[TRAIN][ep=038] mask_avg: mc_mean=0.2764 mb_mean=0.3022 norm_overlap=0.7286 corr_cb=-0.8088
[EPOCH 038/089] train: loss=0.3998 acc=76.23% | val: loss=0.6995 acc=66.13% f1=16.00% auc=52.84% val_score=66.0133 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.302, no=0.729, corr=-0.809) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 66.0133
[DBG][ep=039] disease_pos_weight=1.0000 mode=none
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2824 mb_mean=0.3022 norm_overlap=0.7311 corr_cb=-0.8441 topkJ=0.0000
[TRAIN][ep=039] loss=0.3983 acc=75.86%
[TRAIN][ep=039] mask_avg: mc_mean=0.2764 mb_mean=0.3022 norm_overlap=0.7286 corr_cb=-0.8093
[EPOCH 039/089] train: loss=0.3983 acc=75.86% | val: loss=0.6996 acc=66.13% f1=16.00% auc=52.73% val_score=66.0133 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.302, no=0.729, corr=-0.809) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 66.0133
[DBG][ep=040] disease_pos_weight=1.0000 mode=none
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.2930 mb_mean=0.2796 norm_overlap=0.6249 corr_cb=-0.8600 topkJ=0.0000
[TRAIN][ep=040] loss=0.3973 acc=76.04%
[TRAIN][ep=040] mask_avg: mc_mean=0.2764 mb_mean=0.3022 norm_overlap=0.7285 corr_cb=-0.8092
[EPOCH 040/089] train: loss=0.3973 acc=76.04% | val: loss=0.7015 acc=66.13% f1=16.00% auc=52.51% val_score=66.0133 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.302, no=0.728, corr=-0.809) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 66.0133
[DBG][ep=041] disease_pos_weight=1.0000 mode=none
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.2844 mb_mean=0.2935 norm_overlap=0.6737 corr_cb=-0.8441 topkJ=0.0000
[TRAIN][ep=041] loss=0.3948 acc=76.41%
[TRAIN][ep=041] mask_avg: mc_mean=0.2764 mb_mean=0.3022 norm_overlap=0.7283 corr_cb=-0.8117
[EPOCH 041/089] train: loss=0.3948 acc=76.41% | val: loss=0.7018 acc=66.13% f1=16.00% auc=53.07% val_score=66.0133 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.302, no=0.728, corr=-0.812) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 66.0133
[DBG][ep=042] disease_pos_weight=1.0000 mode=none
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.2638 mb_mean=0.3164 norm_overlap=0.7625 corr_cb=-0.8062 topkJ=0.0000
[TRAIN][ep=042] loss=0.3931 acc=76.59%
[TRAIN][ep=042] mask_avg: mc_mean=0.2764 mb_mean=0.3022 norm_overlap=0.7283 corr_cb=-0.8095
[EPOCH 042/089] train: loss=0.3931 acc=76.59% | val: loss=0.7009 acc=66.13% f1=16.00% auc=52.95% val_score=66.0133 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.302, no=0.728, corr=-0.810) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 66.0133
[DBG][ep=043] disease_pos_weight=1.0000 mode=none
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.2719 mb_mean=0.3048 norm_overlap=0.7214 corr_cb=-0.8414 topkJ=0.0000
[TRAIN][ep=043] loss=0.3911 acc=76.59%
[TRAIN][ep=043] mask_avg: mc_mean=0.2764 mb_mean=0.3022 norm_overlap=0.7283 corr_cb=-0.8096
[EPOCH 043/089] train: loss=0.3911 acc=76.59% | val: loss=0.7020 acc=66.13% f1=16.00% auc=52.95% val_score=66.0133 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.302, no=0.728, corr=-0.810) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 66.0133
[DBG][ep=044] disease_pos_weight=1.0000 mode=none
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2740 mb_mean=0.2933 norm_overlap=0.7633 corr_cb=-0.7506 topkJ=0.0000
[TRAIN][ep=044] loss=0.3896 acc=76.41%
[TRAIN][ep=044] mask_avg: mc_mean=0.2764 mb_mean=0.3022 norm_overlap=0.7283 corr_cb=-0.8099
[EPOCH 044/089] train: loss=0.3896 acc=76.41% | val: loss=0.7030 acc=66.13% f1=16.00% auc=53.07% val_score=66.0133 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.302, no=0.728, corr=-0.810) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 66.0133
[DBG][ep=045] disease_pos_weight=1.0000 mode=none
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2675 mb_mean=0.3061 norm_overlap=0.7565 corr_cb=-0.7738 topkJ=0.0000
[TRAIN][ep=045] loss=0.3872 acc=76.23%
[TRAIN][ep=045] mask_avg: mc_mean=0.2764 mb_mean=0.3022 norm_overlap=0.7281 corr_cb=-0.8112
[EPOCH 045/089] train: loss=0.3872 acc=76.23% | val: loss=0.7028 acc=66.13% f1=16.00% auc=52.73% val_score=69.0566 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.302, no=0.728, corr=-0.811) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 69.0566
[DBG][ep=046] disease_pos_weight=1.0000 mode=none
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.2636 mb_mean=0.2986 norm_overlap=0.7193 corr_cb=-0.8252 topkJ=0.0000
[TRAIN][ep=046] loss=0.3869 acc=76.23%
[TRAIN][ep=046] mask_avg: mc_mean=0.2764 mb_mean=0.3022 norm_overlap=0.7278 corr_cb=-0.8116
[EPOCH 046/089] train: loss=0.3869 acc=76.23% | val: loss=0.7046 acc=66.13% f1=32.26% auc=53.18% val_score=66.0133 val_score_bestthr=81.6712 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.302, no=0.728, corr=-0.812) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 66.0133
[DBG][ep=047] disease_pos_weight=1.0000 mode=none
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.2742 mb_mean=0.3114 norm_overlap=0.7365 corr_cb=-0.8306 topkJ=0.0000
[TRAIN][ep=047] loss=0.3848 acc=77.50%
[TRAIN][ep=047] mask_avg: mc_mean=0.2764 mb_mean=0.3022 norm_overlap=0.7283 corr_cb=-0.8099
[EPOCH 047/089] train: loss=0.3848 acc=77.50% | val: loss=0.7042 acc=66.13% f1=32.26% auc=53.18% val_score=69.0566 val_score_bestthr=81.6712 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.302, no=0.728, corr=-0.810) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 69.0566
[EARLY STOP] no improvement for 30 epochs. best_epoch=17
[CKPT] Loaded best for testing: results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
=============== FIT DONE ===============
[BEST] epoch=17 | val_acc=64.52% | val_f1=47.62% | val_auc=56.86% | val_score=85.2286 | val_score_bestthr=87.5961
[TEST@BEST] thr_used=0.400 | acc=65.58% f1=25.35% auc=63.61% | SP_sex=5.89% EO_sex=0.76% SP_age=8.07% EO_age=12.70%
[TIME] 0.80 min
[OK] Saved: results/ADHD_3x5fold_seed0/fold1_rep0_seed1/summary_fold_1.json
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5033 mb_mean=0.5074 norm_overlap=1.0000 corr_cb=-0.0236 topkJ=0.0769
[TRAIN][ep=000] loss=0.6876 acc=61.34%
[TRAIN][ep=000] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1035
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5043 mb_mean=0.5082 norm_overlap=1.0001 corr_cb=0.1648 topkJ=0.0737
[TRAIN][ep=001] loss=0.6755 acc=63.70%
[TRAIN][ep=001] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1054
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5022 mb_mean=0.5087 norm_overlap=1.0002 corr_cb=0.2275 topkJ=0.1455
[TRAIN][ep=002] loss=0.6656 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1043
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5035 mb_mean=0.5094 norm_overlap=1.0000 corr_cb=0.0241 topkJ=0.0509
[TRAIN][ep=003] loss=0.6594 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1050
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5028 mb_mean=0.5106 norm_overlap=1.0000 corr_cb=-0.0149 topkJ=0.0979
[TRAIN][ep=004] loss=0.6565 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1064
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5019 mb_mean=0.5085 norm_overlap=1.0001 corr_cb=0.1280 topkJ=0.1508
[TRAIN][ep=005] loss=0.6563 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1026
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5034 mb_mean=0.5096 norm_overlap=1.0001 corr_cb=0.0714 topkJ=0.1095
[TRAIN][ep=006] loss=0.6540 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1069
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5027 mb_mean=0.5084 norm_overlap=1.0001 corr_cb=0.0800 topkJ=0.0599
[TRAIN][ep=007] loss=0.6536 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1041
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5013 mb_mean=0.5071 norm_overlap=1.0002 corr_cb=0.2685 topkJ=0.0945
[TRAIN][ep=008] loss=0.6521 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1038
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5020 mb_mean=0.5111 norm_overlap=1.0000 corr_cb=0.0016 topkJ=0.0557
[TRAIN][ep=009] loss=0.6513 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1023
================= FIT START (fold=1) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.35 select_by=val_score | eval_thr_mode=best_acc eval_thr_grid=coarse | disease_pos_weight_mode=none freeze_b_after=15 | two_stage=True stage1_ratio=0.35 stage2_lr_mult=0.3 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5045 mb_mean=0.5109 norm_overlap=1.0000 corr_cb=0.0362 topkJ=0.0638
[TRAIN][ep=000] loss=0.6500 acc=63.70%
[TRAIN][ep=000] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1077
[EPOCH 000/089] train: loss=0.6500 acc=63.70% | val: loss=0.6577 acc=62.90% f1=0.00% auc=54.96% val_score=72.0763 val_score_bestthr=62.9032 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.503, mb=0.509, no=1.000, corr=0.108) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* -1000000000000000000.0000 -> 72.0763
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5043 mb_mean=0.5100 norm_overlap=1.0000 corr_cb=-0.0050 topkJ=0.0422
[TRAIN][ep=001] loss=0.6489 acc=63.70%
[TRAIN][ep=001] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1086
[EPOCH 001/089] train: loss=0.6489 acc=63.70% | val: loss=0.6572 acc=64.52% f1=38.89% auc=56.08% val_score=70.1231 val_score_bestthr=83.2578 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.503, mb=0.509, no=1.000, corr=0.109) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 72.0763 -> 70.1231
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5004 mb_mean=0.5099 norm_overlap=1.0001 corr_cb=0.2004 topkJ=0.1277
[TRAIN][ep=002] loss=0.6480 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1068
[EPOCH 002/089] train: loss=0.6480 acc=63.70% | val: loss=0.6569 acc=62.90% f1=30.30% auc=56.19% val_score=74.6247 val_score_bestthr=77.4480 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.503, mb=0.509, no=1.000, corr=0.107) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 72.0763 -> 74.6247
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5013 mb_mean=0.5096 norm_overlap=1.0001 corr_cb=0.1039 topkJ=0.0703
[TRAIN][ep=003] loss=0.6465 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1068
[EPOCH 003/089] train: loss=0.6465 acc=63.70% | val: loss=0.6568 acc=64.52% f1=38.89% auc=57.08% val_score=75.4593 val_score_bestthr=83.2578 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.503, mb=0.509, no=1.000, corr=0.107) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 74.6247 -> 75.4593
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.0595 topkJ=0.0573
[TRAIN][ep=004] loss=0.6452 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1040
[EPOCH 004/089] train: loss=0.6452 acc=63.70% | val: loss=0.6559 acc=66.13% f1=43.24% auc=57.75% val_score=65.9529 val_score_bestthr=87.0247 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.503, mb=0.509, no=1.000, corr=0.104) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 75.4593 -> 65.9529
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5024 mb_mean=0.5096 norm_overlap=1.0000 corr_cb=0.0125 topkJ=0.1126
[TRAIN][ep=005] loss=2.2293 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.4943 mb_mean=0.4996 norm_overlap=1.0001 corr_cb=0.1048
[EPOCH 005/089] train: loss=2.2293 acc=63.70% | val: loss=0.6565 acc=66.13% f1=43.24% auc=57.41% val_score=76.7733 val_score_bestthr=87.0247 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.494, mb=0.500, no=1.000, corr=0.105) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 75.4593 -> 76.7733
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4851 mb_mean=0.4888 norm_overlap=1.0002 corr_cb=0.1782 topkJ=0.0638
[TRAIN][ep=006] loss=2.2256 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.4776 mb_mean=0.4779 norm_overlap=1.0004 corr_cb=0.1906
[EPOCH 006/089] train: loss=2.2256 acc=63.70% | val: loss=0.6567 acc=67.74% f1=50.00% auc=58.08% val_score=72.8728 val_score_bestthr=91.6142 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.478, mb=0.478, no=1.000, corr=0.191) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.7733 -> 72.8728
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4687 mb_mean=0.4658 norm_overlap=1.0007 corr_cb=0.2239 topkJ=0.1015
[TRAIN][ep=007] loss=2.2200 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.4607 mb_mean=0.4532 norm_overlap=1.0015 corr_cb=0.3801
[EPOCH 007/089] train: loss=2.2200 acc=63.70% | val: loss=0.6563 acc=64.52% f1=50.00% auc=58.19% val_score=72.8728 val_score_bestthr=88.4099 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.461, mb=0.453, no=1.001, corr=0.380) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.7733 -> 72.8728
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4519 mb_mean=0.4451 norm_overlap=1.0026 corr_cb=0.4392 topkJ=0.1694
[TRAIN][ep=008] loss=2.2159 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.4439 mb_mean=0.4268 norm_overlap=1.0031 corr_cb=0.4613
[EPOCH 008/089] train: loss=2.2159 acc=63.70% | val: loss=0.6560 acc=66.13% f1=43.24% auc=57.75% val_score=71.9285 val_score_bestthr=87.0247 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.444, mb=0.427, no=1.003, corr=0.461) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.7733 -> 71.9285
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4364 mb_mean=0.4153 norm_overlap=1.0032 corr_cb=0.4970 topkJ=0.2358
[TRAIN][ep=009] loss=2.2097 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.4273 mb_mean=0.4002 norm_overlap=1.0049 corr_cb=0.4394
[EPOCH 009/089] train: loss=2.2097 acc=63.70% | val: loss=0.6560 acc=64.52% f1=50.00% auc=57.86% val_score=73.9607 val_score_bestthr=88.5630 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.427, mb=0.400, no=1.005, corr=0.439) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.7733 -> 73.9607
[DBG][ep=010] disease_pos_weight=1.0000 mode=none
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.4246 mb_mean=0.3998 norm_overlap=1.0057 corr_cb=0.4480 topkJ=0.1762
[TRAIN][ep=010] loss=2.2008 acc=63.70%
[TRAIN][ep=010] mask_avg: mc_mean=0.4117 mb_mean=0.3748 norm_overlap=1.0060 corr_cb=0.3484
[EPOCH 010/089] train: loss=2.2008 acc=63.70% | val: loss=0.6554 acc=66.13% f1=36.36% auc=58.75% val_score=62.8082 val_score_bestthr=83.7543 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.412, mb=0.375, no=1.006, corr=0.348) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.7733 -> 62.8082
[DBG][ep=011] disease_pos_weight=1.0000 mode=none
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.3956 mb_mean=0.3448 norm_overlap=1.0148 corr_cb=0.4060 topkJ=0.1130
[TRAIN][ep=011] loss=2.1962 acc=63.70%
[TRAIN][ep=011] mask_avg: mc_mean=0.3963 mb_mean=0.3523 norm_overlap=1.0046 corr_cb=0.1751
[EPOCH 011/089] train: loss=2.1962 acc=63.70% | val: loss=0.6554 acc=66.13% f1=55.32% auc=58.86% val_score=67.7762 val_score_bestthr=92.8120 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.396, mb=0.352, no=1.005, corr=0.175) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.7733 -> 67.7762
[DBG][ep=012] disease_pos_weight=1.0000 mode=none
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.3922 mb_mean=0.3470 norm_overlap=1.0004 corr_cb=0.0160 topkJ=0.1234
[TRAIN][ep=012] loss=2.1962 acc=63.70%
[TRAIN][ep=012] mask_avg: mc_mean=0.3818 mb_mean=0.3345 norm_overlap=1.0015 corr_cb=0.0440
[EPOCH 012/089] train: loss=2.1962 acc=63.70% | val: loss=0.6555 acc=66.13% f1=32.26% auc=58.42% val_score=75.9104 val_score_bestthr=81.6375 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.382, mb=0.334, no=1.002, corr=0.044) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.7733 -> 75.9104
[DBG][ep=013] disease_pos_weight=1.0000 mode=none
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.3812 mb_mean=0.3301 norm_overlap=0.9995 corr_cb=-0.0128 topkJ=0.0881
[TRAIN][ep=013] loss=2.1827 acc=63.70%
[TRAIN][ep=013] mask_avg: mc_mean=0.3689 mb_mean=0.3192 norm_overlap=0.9930 corr_cb=-0.1360
[EPOCH 013/089] train: loss=2.1827 acc=63.70% | val: loss=0.6561 acc=66.13% f1=43.24% auc=56.63% val_score=71.8501 val_score_bestthr=86.9968 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.369, mb=0.319, no=0.993, corr=-0.136) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.7733 -> 71.8501
[DBG][ep=014] disease_pos_weight=1.0000 mode=none
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.3607 mb_mean=0.3188 norm_overlap=0.9837 corr_cb=-0.2823 topkJ=0.0154
[TRAIN][ep=014] loss=2.1727 acc=63.70%
[TRAIN][ep=014] mask_avg: mc_mean=0.3560 mb_mean=0.3070 norm_overlap=0.9732 corr_cb=-0.3587
[EPOCH 014/089] train: loss=2.1727 acc=63.70% | val: loss=0.6561 acc=66.13% f1=51.16% auc=56.41% val_score=67.9137 val_score_bestthr=91.0869 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.356, mb=0.307, no=0.973, corr=-0.359) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.7733 -> 67.9137
[DBG][ep=015] disease_pos_weight=1.0000 mode=none
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.3490 mb_mean=0.3007 norm_overlap=0.9612 corr_cb=-0.4736 topkJ=0.0219
[TRAIN][ep=015] loss=2.1706 acc=63.70%
[TRAIN][ep=015] mask_avg: mc_mean=0.3436 mb_mean=0.3022 norm_overlap=0.9494 corr_cb=-0.5151
[EPOCH 015/089] train: loss=2.1706 acc=63.70% | val: loss=0.6554 acc=64.52% f1=50.00% auc=57.19% val_score=80.0104 val_score_bestthr=88.8371 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.344, mb=0.302, no=0.949, corr=-0.515) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=* 76.7733 -> 80.0104
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=016] disease_pos_weight=1.0000 mode=none
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.3348 mb_mean=0.2995 norm_overlap=0.9376 corr_cb=-0.5792 topkJ=0.0025
[TRAIN][ep=016] loss=2.1604 acc=63.70%
[TRAIN][ep=016] mask_avg: mc_mean=0.3333 mb_mean=0.3022 norm_overlap=0.9365 corr_cb=-0.5591
[EPOCH 016/089] train: loss=2.1604 acc=63.70% | val: loss=0.6550 acc=64.52% f1=50.00% auc=56.97% val_score=71.9126 val_score_bestthr=88.8371 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.333, mb=0.302, no=0.937, corr=-0.559) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 80.0104 -> 71.9126
[DBG][ep=017] disease_pos_weight=1.0000 mode=none
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.3278 mb_mean=0.3076 norm_overlap=0.9270 corr_cb=-0.5756 topkJ=0.0028
[TRAIN][ep=017] loss=1.4572 acc=63.70%
[TRAIN][ep=017] mask_avg: mc_mean=0.3236 mb_mean=0.3022 norm_overlap=0.9205 corr_cb=-0.6027
[EPOCH 017/089] train: loss=1.4572 acc=63.70% | val: loss=0.6560 acc=64.52% f1=47.62% auc=56.74% val_score=83.1324 val_score_bestthr=87.5961 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.324, mb=0.302, no=0.921, corr=-0.603) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=* 80.0104 -> 83.1324
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=018] disease_pos_weight=1.0000 mode=none
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.3167 mb_mean=0.3119 norm_overlap=0.9416 corr_cb=-0.5159 topkJ=0.0016
[TRAIN][ep=018] loss=0.7526 acc=63.70%
[TRAIN][ep=018] mask_avg: mc_mean=0.3148 mb_mean=0.3022 norm_overlap=0.9041 corr_cb=-0.6432
[EPOCH 018/089] train: loss=0.7526 acc=63.70% | val: loss=0.6566 acc=64.52% f1=47.62% auc=56.41% val_score=78.2224 val_score_bestthr=87.8294 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.315, mb=0.302, no=0.904, corr=-0.643) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 78.2224
[DBG][ep=019] disease_pos_weight=1.0000 mode=none
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.3188 mb_mean=0.3110 norm_overlap=0.9191 corr_cb=-0.6535 topkJ=0.0000
[TRAIN][ep=019] loss=0.5735 acc=63.70%
[TRAIN][ep=019] mask_avg: mc_mean=0.3073 mb_mean=0.3022 norm_overlap=0.8868 corr_cb=-0.6783
[EPOCH 019/089] train: loss=0.5735 acc=63.70% | val: loss=0.6560 acc=66.13% f1=43.24% auc=55.07% val_score=76.0144 val_score_bestthr=87.2428 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.307, mb=0.302, no=0.887, corr=-0.678) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 76.0144
[DBG][ep=020] disease_pos_weight=1.0000 mode=none
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.3080 mb_mean=0.2991 norm_overlap=0.8633 corr_cb=-0.6908 topkJ=0.0000
[TRAIN][ep=020] loss=0.5541 acc=64.61%
[TRAIN][ep=020] mask_avg: mc_mean=0.3010 mb_mean=0.3022 norm_overlap=0.8678 corr_cb=-0.7072
[EPOCH 020/089] train: loss=0.5541 acc=64.61% | val: loss=0.6574 acc=66.13% f1=43.24% auc=54.74% val_score=71.0740 val_score_bestthr=87.2428 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.301, mb=0.302, no=0.868, corr=-0.707) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 71.0740
[DBG][ep=021] disease_pos_weight=1.0000 mode=none
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2942 mb_mean=0.2995 norm_overlap=0.8419 corr_cb=-0.7578 topkJ=0.0000
[TRAIN][ep=021] loss=0.5439 acc=66.42%
[TRAIN][ep=021] mask_avg: mc_mean=0.2958 mb_mean=0.3022 norm_overlap=0.8451 corr_cb=-0.7408
[EPOCH 021/089] train: loss=0.5439 acc=66.42% | val: loss=0.6602 acc=64.52% f1=42.11% auc=55.85% val_score=73.1226 val_score_bestthr=84.9757 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.296, mb=0.302, no=0.845, corr=-0.741) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 73.1226
[DBG][ep=022] disease_pos_weight=1.0000 mode=none
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2992 mb_mean=0.3005 norm_overlap=0.8289 corr_cb=-0.7798 topkJ=0.0000
[TRAIN][ep=022] loss=0.5337 acc=68.42%
[TRAIN][ep=022] mask_avg: mc_mean=0.2925 mb_mean=0.3022 norm_overlap=0.8258 corr_cb=-0.7612
[EPOCH 022/089] train: loss=0.5337 acc=68.42% | val: loss=0.6629 acc=64.52% f1=15.38% auc=55.07% val_score=71.0740 val_score_bestthr=71.6233 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.292, mb=0.302, no=0.826, corr=-0.761) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 71.0740
[DBG][ep=023] disease_pos_weight=1.0000 mode=none
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2877 mb_mean=0.3052 norm_overlap=0.8193 corr_cb=-0.7703 topkJ=0.0000
[TRAIN][ep=023] loss=0.5243 acc=70.96%
[TRAIN][ep=023] mask_avg: mc_mean=0.2903 mb_mean=0.3022 norm_overlap=0.8047 corr_cb=-0.7801
[EPOCH 023/089] train: loss=0.5243 acc=70.96% | val: loss=0.6700 acc=64.52% f1=42.11% auc=54.63% val_score=76.1594 val_score_bestthr=84.9757 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.290, mb=0.302, no=0.805, corr=-0.780) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 76.1594
[DBG][ep=024] disease_pos_weight=1.0000 mode=none
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2982 mb_mean=0.2938 norm_overlap=0.7917 corr_cb=-0.7745 topkJ=0.0000
[TRAIN][ep=024] loss=0.5133 acc=70.24%
[TRAIN][ep=024] mask_avg: mc_mean=0.2880 mb_mean=0.3022 norm_overlap=0.7897 corr_cb=-0.7895
[EPOCH 024/089] train: loss=0.5133 acc=70.24% | val: loss=0.6733 acc=64.52% f1=21.43% auc=53.18% val_score=67.0301 val_score_bestthr=74.6880 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.288, mb=0.302, no=0.790, corr=-0.789) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 67.0301
[DBG][ep=025] disease_pos_weight=1.0000 mode=none
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2741 mb_mean=0.3165 norm_overlap=0.8641 corr_cb=-0.6680 topkJ=0.0000
[TRAIN][ep=025] loss=0.5106 acc=72.41%
[TRAIN][ep=025] mask_avg: mc_mean=0.2877 mb_mean=0.3022 norm_overlap=0.7752 corr_cb=-0.7969
[EPOCH 025/089] train: loss=0.5106 acc=72.41% | val: loss=0.6778 acc=64.52% f1=21.43% auc=52.51% val_score=69.1281 val_score_bestthr=74.6880 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.288, mb=0.302, no=0.775, corr=-0.797) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 69.1281
[DBG][ep=026] disease_pos_weight=1.0000 mode=none
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2781 mb_mean=0.2914 norm_overlap=0.7320 corr_cb=-0.8064 topkJ=0.0000
[TRAIN][ep=026] loss=0.5002 acc=70.96%
[TRAIN][ep=026] mask_avg: mc_mean=0.2855 mb_mean=0.3022 norm_overlap=0.7646 corr_cb=-0.8023
[EPOCH 026/089] train: loss=0.5002 acc=70.96% | val: loss=0.6829 acc=64.52% f1=21.43% auc=53.40% val_score=68.3936 val_score_bestthr=74.6880 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.285, mb=0.302, no=0.765, corr=-0.802) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 68.3936
[DBG][ep=027] disease_pos_weight=1.0000 mode=none
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2855 mb_mean=0.3163 norm_overlap=0.7973 corr_cb=-0.8065 topkJ=0.0000
[TRAIN][ep=027] loss=0.4910 acc=73.50%
[TRAIN][ep=027] mask_avg: mc_mean=0.2841 mb_mean=0.3022 norm_overlap=0.7553 corr_cb=-0.8058
[EPOCH 027/089] train: loss=0.4910 acc=73.50% | val: loss=0.6844 acc=64.52% f1=21.43% auc=52.29% val_score=68.0860 val_score_bestthr=74.6880 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.284, mb=0.302, no=0.755, corr=-0.806) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 68.0860
[DBG][ep=028] disease_pos_weight=1.0000 mode=none
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2771 mb_mean=0.3088 norm_overlap=0.7583 corr_cb=-0.8190 topkJ=0.0000
[TRAIN][ep=028] loss=0.4841 acc=72.96%
[TRAIN][ep=028] mask_avg: mc_mean=0.2823 mb_mean=0.3022 norm_overlap=0.7449 corr_cb=-0.8123
[EPOCH 028/089] train: loss=0.4841 acc=72.96% | val: loss=0.6857 acc=64.52% f1=26.67% auc=51.95% val_score=70.0121 val_score_bestthr=77.3127 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.282, mb=0.302, no=0.745, corr=-0.812) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 70.0121
[DBG][ep=029] disease_pos_weight=1.0000 mode=none
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2670 mb_mean=0.2927 norm_overlap=0.7405 corr_cb=-0.7521 topkJ=0.0000
[TRAIN][ep=029] loss=0.4726 acc=74.23%
[TRAIN][ep=029] mask_avg: mc_mean=0.2786 mb_mean=0.3022 norm_overlap=0.7387 corr_cb=-0.8090
[EPOCH 029/089] train: loss=0.4726 acc=74.23% | val: loss=0.6901 acc=66.13% f1=16.00% auc=52.51% val_score=68.0860 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.279, mb=0.302, no=0.739, corr=-0.809) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 68.0860
[DBG][ep=030] disease_pos_weight=1.0000 mode=none
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2646 mb_mean=0.3132 norm_overlap=0.7392 corr_cb=-0.7807 topkJ=0.0000
[TRAIN][ep=030] loss=0.4644 acc=74.95%
[TRAIN][ep=030] mask_avg: mc_mean=0.2773 mb_mean=0.3022 norm_overlap=0.7316 corr_cb=-0.8104
[EPOCH 030/089] train: loss=0.4644 acc=74.95% | val: loss=0.6932 acc=66.13% f1=16.00% auc=52.51% val_score=67.0905 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.277, mb=0.302, no=0.732, corr=-0.810) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 67.0905
[DBG][ep=031] disease_pos_weight=1.0000 mode=none
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2858 mb_mean=0.2881 norm_overlap=0.6513 corr_cb=-0.8566 topkJ=0.0000
[TRAIN][ep=031] loss=0.4534 acc=75.86%
[TRAIN][ep=031] mask_avg: mc_mean=0.2765 mb_mean=0.3022 norm_overlap=0.7282 corr_cb=-0.8103
[EPOCH 031/089] train: loss=0.4534 acc=75.86% | val: loss=0.6943 acc=66.13% f1=16.00% auc=52.62% val_score=66.0424 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.302, no=0.728, corr=-0.810) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 66.0424
[DBG][ep=032] disease_pos_weight=1.0000 mode=none
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2600 mb_mean=0.3122 norm_overlap=0.8080 corr_cb=-0.7536 topkJ=0.0000
[TRAIN][ep=032] loss=0.4531 acc=75.68%
[TRAIN][ep=032] mask_avg: mc_mean=0.2765 mb_mean=0.3022 norm_overlap=0.7284 corr_cb=-0.8090
[EPOCH 032/089] train: loss=0.4531 acc=75.68% | val: loss=0.6944 acc=66.13% f1=16.00% auc=52.40% val_score=67.0905 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.302, no=0.728, corr=-0.809) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 67.0905
[DBG][ep=033] disease_pos_weight=1.0000 mode=none
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2892 mb_mean=0.2923 norm_overlap=0.6924 corr_cb=-0.7738 topkJ=0.0000
[TRAIN][ep=033] loss=0.4502 acc=75.50%
[TRAIN][ep=033] mask_avg: mc_mean=0.2764 mb_mean=0.3022 norm_overlap=0.7282 corr_cb=-0.8102
[EPOCH 033/089] train: loss=0.4502 acc=75.50% | val: loss=0.6953 acc=66.13% f1=16.00% auc=52.17% val_score=67.0905 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.302, no=0.728, corr=-0.810) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 67.0905
[DBG][ep=034] disease_pos_weight=1.0000 mode=none
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2692 mb_mean=0.3079 norm_overlap=0.7707 corr_cb=-0.7983 topkJ=0.0000
[TRAIN][ep=034] loss=0.4478 acc=76.04%
[TRAIN][ep=034] mask_avg: mc_mean=0.2765 mb_mean=0.3022 norm_overlap=0.7283 corr_cb=-0.8103
[EPOCH 034/089] train: loss=0.4478 acc=76.04% | val: loss=0.6971 acc=66.13% f1=16.00% auc=52.62% val_score=66.0133 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.302, no=0.728, corr=-0.810) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 66.0133
[DBG][ep=035] disease_pos_weight=1.0000 mode=none
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2605 mb_mean=0.3205 norm_overlap=0.7930 corr_cb=-0.7570 topkJ=0.0000
[TRAIN][ep=035] loss=0.4474 acc=76.23%
[TRAIN][ep=035] mask_avg: mc_mean=0.2765 mb_mean=0.3022 norm_overlap=0.7282 corr_cb=-0.8098
[EPOCH 035/089] train: loss=0.4474 acc=76.23% | val: loss=0.6965 acc=66.13% f1=16.00% auc=52.51% val_score=67.0905 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.302, no=0.728, corr=-0.810) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 67.0905
[DBG][ep=036] disease_pos_weight=1.0000 mode=none
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2801 mb_mean=0.3142 norm_overlap=0.7461 corr_cb=-0.8470 topkJ=0.0000
[TRAIN][ep=036] loss=0.4450 acc=75.86%
[TRAIN][ep=036] mask_avg: mc_mean=0.2764 mb_mean=0.3022 norm_overlap=0.7282 corr_cb=-0.8105
[EPOCH 036/089] train: loss=0.4450 acc=75.86% | val: loss=0.6967 acc=66.13% f1=16.00% auc=52.29% val_score=67.0905 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.302, no=0.728, corr=-0.811) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 67.0905
[DBG][ep=037] disease_pos_weight=1.0000 mode=none
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.2939 mb_mean=0.2892 norm_overlap=0.6428 corr_cb=-0.8544 topkJ=0.0000
[TRAIN][ep=037] loss=0.4425 acc=76.04%
[TRAIN][ep=037] mask_avg: mc_mean=0.2764 mb_mean=0.3022 norm_overlap=0.7284 corr_cb=-0.8093
[EPOCH 037/089] train: loss=0.4425 acc=76.04% | val: loss=0.6980 acc=66.13% f1=16.00% auc=52.95% val_score=69.0566 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.302, no=0.728, corr=-0.809) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 69.0566
[DBG][ep=038] disease_pos_weight=1.0000 mode=none
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2395 mb_mean=0.3128 norm_overlap=0.8180 corr_cb=-0.6838 topkJ=0.0000
[TRAIN][ep=038] loss=0.4403 acc=76.23%
[TRAIN][ep=038] mask_avg: mc_mean=0.2765 mb_mean=0.3022 norm_overlap=0.7285 corr_cb=-0.8089
[EPOCH 038/089] train: loss=0.4403 acc=76.23% | val: loss=0.6996 acc=66.13% f1=16.00% auc=52.84% val_score=66.0133 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.302, no=0.729, corr=-0.809) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 66.0133
[DBG][ep=039] disease_pos_weight=1.0000 mode=none
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2825 mb_mean=0.3021 norm_overlap=0.7310 corr_cb=-0.8443 topkJ=0.0000
[TRAIN][ep=039] loss=0.4388 acc=75.86%
[TRAIN][ep=039] mask_avg: mc_mean=0.2764 mb_mean=0.3022 norm_overlap=0.7284 corr_cb=-0.8095
[EPOCH 039/089] train: loss=0.4388 acc=75.86% | val: loss=0.6997 acc=66.13% f1=16.00% auc=52.73% val_score=66.0133 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.302, no=0.728, corr=-0.810) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 66.0133
[DBG][ep=040] disease_pos_weight=1.0000 mode=none
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.2931 mb_mean=0.2795 norm_overlap=0.6247 corr_cb=-0.8600 topkJ=0.0000
[TRAIN][ep=040] loss=0.4378 acc=76.04%
[TRAIN][ep=040] mask_avg: mc_mean=0.2765 mb_mean=0.3022 norm_overlap=0.7283 corr_cb=-0.8094
[EPOCH 040/089] train: loss=0.4378 acc=76.04% | val: loss=0.7016 acc=66.13% f1=16.00% auc=52.51% val_score=66.0133 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.302, no=0.728, corr=-0.809) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 66.0133
[DBG][ep=041] disease_pos_weight=1.0000 mode=none
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.2843 mb_mean=0.2935 norm_overlap=0.6738 corr_cb=-0.8442 topkJ=0.0000
[TRAIN][ep=041] loss=0.4353 acc=76.41%
[TRAIN][ep=041] mask_avg: mc_mean=0.2765 mb_mean=0.3022 norm_overlap=0.7282 corr_cb=-0.8119
[EPOCH 041/089] train: loss=0.4353 acc=76.41% | val: loss=0.7019 acc=66.13% f1=16.00% auc=53.07% val_score=66.0133 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.302, no=0.728, corr=-0.812) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 66.0133
[DBG][ep=042] disease_pos_weight=1.0000 mode=none
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.2638 mb_mean=0.3164 norm_overlap=0.7625 corr_cb=-0.8065 topkJ=0.0000
[TRAIN][ep=042] loss=0.4336 acc=76.59%
[TRAIN][ep=042] mask_avg: mc_mean=0.2765 mb_mean=0.3022 norm_overlap=0.7282 corr_cb=-0.8097
[EPOCH 042/089] train: loss=0.4336 acc=76.59% | val: loss=0.7010 acc=66.13% f1=16.00% auc=53.18% val_score=66.0133 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.302, no=0.728, corr=-0.810) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 66.0133
[DBG][ep=043] disease_pos_weight=1.0000 mode=none
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.2720 mb_mean=0.3048 norm_overlap=0.7210 corr_cb=-0.8419 topkJ=0.0000
[TRAIN][ep=043] loss=0.4316 acc=76.59%
[TRAIN][ep=043] mask_avg: mc_mean=0.2765 mb_mean=0.3022 norm_overlap=0.7281 corr_cb=-0.8098
[EPOCH 043/089] train: loss=0.4316 acc=76.59% | val: loss=0.7021 acc=66.13% f1=16.00% auc=53.18% val_score=66.0133 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.302, no=0.728, corr=-0.810) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 66.0133
[DBG][ep=044] disease_pos_weight=1.0000 mode=none
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2741 mb_mean=0.2932 norm_overlap=0.7633 corr_cb=-0.7509 topkJ=0.0000
[TRAIN][ep=044] loss=0.4301 acc=76.41%
[TRAIN][ep=044] mask_avg: mc_mean=0.2765 mb_mean=0.3022 norm_overlap=0.7281 corr_cb=-0.8101
[EPOCH 044/089] train: loss=0.4301 acc=76.41% | val: loss=0.7031 acc=66.13% f1=16.00% auc=53.07% val_score=66.0133 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.302, no=0.728, corr=-0.810) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 66.0133
[DBG][ep=045] disease_pos_weight=1.0000 mode=none
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2675 mb_mean=0.3060 norm_overlap=0.7564 corr_cb=-0.7738 topkJ=0.0000
[TRAIN][ep=045] loss=0.4277 acc=76.23%
[TRAIN][ep=045] mask_avg: mc_mean=0.2765 mb_mean=0.3022 norm_overlap=0.7280 corr_cb=-0.8114
[EPOCH 045/089] train: loss=0.4277 acc=76.23% | val: loss=0.7030 acc=66.13% f1=16.00% auc=52.84% val_score=69.0566 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.302, no=0.728, corr=-0.811) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 69.0566
[DBG][ep=046] disease_pos_weight=1.0000 mode=none
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.2637 mb_mean=0.2986 norm_overlap=0.7192 corr_cb=-0.8255 topkJ=0.0000
[TRAIN][ep=046] loss=0.4273 acc=76.23%
[TRAIN][ep=046] mask_avg: mc_mean=0.2765 mb_mean=0.3022 norm_overlap=0.7277 corr_cb=-0.8118
[EPOCH 046/089] train: loss=0.4273 acc=76.23% | val: loss=0.7048 acc=66.13% f1=32.26% auc=53.18% val_score=66.0133 val_score_bestthr=81.6712 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.302, no=0.728, corr=-0.812) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 66.0133
[DBG][ep=047] disease_pos_weight=1.0000 mode=none
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.2743 mb_mean=0.3114 norm_overlap=0.7365 corr_cb=-0.8305 topkJ=0.0000
[TRAIN][ep=047] loss=0.4253 acc=77.50%
[TRAIN][ep=047] mask_avg: mc_mean=0.2765 mb_mean=0.3022 norm_overlap=0.7281 corr_cb=-0.8100
[EPOCH 047/089] train: loss=0.4253 acc=77.50% | val: loss=0.7043 acc=66.13% f1=32.26% auc=53.07% val_score=69.0566 val_score_bestthr=81.6712 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.302, no=0.728, corr=-0.810) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 69.0566
[EARLY STOP] no improvement for 30 epochs. best_epoch=17
[CKPT] Loaded best for testing: results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
=============== FIT DONE ===============
[BEST] epoch=17 | val_acc=64.52% | val_f1=47.62% | val_auc=56.74% | val_score=83.1324 | val_score_bestthr=87.5961
[TEST@BEST] thr_used=0.400 | acc=65.58% f1=25.35% auc=63.63% | SP_sex=5.89% EO_sex=0.76% SP_age=8.07% EO_age=12.70%
[TIME] 0.85 min
[OK] Saved: results/ADHD_3x5fold_seed0/fold1_rep0_seed1/summary_fold_1.json
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5033 mb_mean=0.5074 norm_overlap=1.0000 corr_cb=-0.0236 topkJ=0.0769
[TRAIN][ep=000] loss=0.6876 acc=61.34%
[TRAIN][ep=000] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1035
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5043 mb_mean=0.5082 norm_overlap=1.0001 corr_cb=0.1648 topkJ=0.0737
[TRAIN][ep=001] loss=0.6755 acc=63.70%
[TRAIN][ep=001] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1054
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5022 mb_mean=0.5087 norm_overlap=1.0002 corr_cb=0.2275 topkJ=0.1455
[TRAIN][ep=002] loss=0.6656 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1043
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5035 mb_mean=0.5094 norm_overlap=1.0000 corr_cb=0.0241 topkJ=0.0509
[TRAIN][ep=003] loss=0.6594 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1050
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5028 mb_mean=0.5106 norm_overlap=1.0000 corr_cb=-0.0149 topkJ=0.0979
[TRAIN][ep=004] loss=0.6565 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1064
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5019 mb_mean=0.5085 norm_overlap=1.0001 corr_cb=0.1280 topkJ=0.1508
[TRAIN][ep=005] loss=0.6563 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1026
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5034 mb_mean=0.5096 norm_overlap=1.0001 corr_cb=0.0714 topkJ=0.1095
[TRAIN][ep=006] loss=0.6540 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1069
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5027 mb_mean=0.5084 norm_overlap=1.0001 corr_cb=0.0800 topkJ=0.0599
[TRAIN][ep=007] loss=0.6536 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1041
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5013 mb_mean=0.5071 norm_overlap=1.0002 corr_cb=0.2685 topkJ=0.0945
[TRAIN][ep=008] loss=0.6521 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1038
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5020 mb_mean=0.5111 norm_overlap=1.0000 corr_cb=0.0016 topkJ=0.0557
[TRAIN][ep=009] loss=0.6513 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1023
================= FIT START (fold=1) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.35 select_by=val_score | eval_thr_mode=best_acc eval_thr_grid=coarse | disease_pos_weight_mode=none freeze_b_after=15 | two_stage=True stage1_ratio=0.35 stage2_lr_mult=0.3 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5045 mb_mean=0.5109 norm_overlap=1.0000 corr_cb=0.0362 topkJ=0.0638
[TRAIN][ep=000] loss=0.6500 acc=63.70%
[TRAIN][ep=000] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1077
[EPOCH 000/089] train: loss=0.6500 acc=63.70% | val: loss=0.6577 acc=62.90% f1=0.00% auc=54.96% val_score=72.0763 val_score_bestthr=62.9032 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.503, mb=0.509, no=1.000, corr=0.108) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* -1000000000000000000.0000 -> 72.0763
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5043 mb_mean=0.5100 norm_overlap=1.0000 corr_cb=-0.0050 topkJ=0.0422
[TRAIN][ep=001] loss=0.6489 acc=63.70%
[TRAIN][ep=001] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1086
[EPOCH 001/089] train: loss=0.6489 acc=63.70% | val: loss=0.6572 acc=64.52% f1=38.89% auc=56.08% val_score=70.1231 val_score_bestthr=83.2578 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.503, mb=0.509, no=1.000, corr=0.109) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 72.0763 -> 70.1231
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5004 mb_mean=0.5099 norm_overlap=1.0001 corr_cb=0.2004 topkJ=0.1277
[TRAIN][ep=002] loss=0.6480 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1068
[EPOCH 002/089] train: loss=0.6480 acc=63.70% | val: loss=0.6569 acc=62.90% f1=30.30% auc=56.19% val_score=74.6247 val_score_bestthr=77.4480 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.503, mb=0.509, no=1.000, corr=0.107) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 72.0763 -> 74.6247
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5013 mb_mean=0.5096 norm_overlap=1.0001 corr_cb=0.1039 topkJ=0.0703
[TRAIN][ep=003] loss=0.6465 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1068
[EPOCH 003/089] train: loss=0.6465 acc=63.70% | val: loss=0.6568 acc=64.52% f1=38.89% auc=57.08% val_score=75.4593 val_score_bestthr=83.2578 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.503, mb=0.509, no=1.000, corr=0.107) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 74.6247 -> 75.4593
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.0595 topkJ=0.0573
[TRAIN][ep=004] loss=0.6452 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1040
[EPOCH 004/089] train: loss=0.6452 acc=63.70% | val: loss=0.6559 acc=66.13% f1=43.24% auc=57.75% val_score=65.9529 val_score_bestthr=87.0247 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.503, mb=0.509, no=1.000, corr=0.104) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 75.4593 -> 65.9529
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5024 mb_mean=0.5096 norm_overlap=1.0000 corr_cb=0.0125 topkJ=0.1126
[TRAIN][ep=005] loss=2.1262 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.4943 mb_mean=0.4996 norm_overlap=1.0001 corr_cb=0.1037
[EPOCH 005/089] train: loss=2.1262 acc=63.70% | val: loss=0.6565 acc=66.13% f1=43.24% auc=57.41% val_score=76.7733 val_score_bestthr=87.0247 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.494, mb=0.500, no=1.000, corr=0.104) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 75.4593 -> 76.7733
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4851 mb_mean=0.4888 norm_overlap=1.0002 corr_cb=0.1775 topkJ=0.0629
[TRAIN][ep=006] loss=2.1227 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.4776 mb_mean=0.4779 norm_overlap=1.0004 corr_cb=0.1900
[EPOCH 006/089] train: loss=2.1227 acc=63.70% | val: loss=0.6567 acc=67.74% f1=50.00% auc=58.08% val_score=72.8728 val_score_bestthr=91.6142 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.478, mb=0.478, no=1.000, corr=0.190) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.7733 -> 72.8728
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4687 mb_mean=0.4657 norm_overlap=1.0007 corr_cb=0.2238 topkJ=0.1015
[TRAIN][ep=007] loss=2.1172 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.4607 mb_mean=0.4532 norm_overlap=1.0015 corr_cb=0.3793
[EPOCH 007/089] train: loss=2.1172 acc=63.70% | val: loss=0.6563 acc=64.52% f1=50.00% auc=58.19% val_score=72.8728 val_score_bestthr=88.4099 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.461, mb=0.453, no=1.001, corr=0.379) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.7733 -> 72.8728
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4519 mb_mean=0.4450 norm_overlap=1.0026 corr_cb=0.4380 topkJ=0.1671
[TRAIN][ep=008] loss=2.1132 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.4439 mb_mean=0.4267 norm_overlap=1.0031 corr_cb=0.4599
[EPOCH 008/089] train: loss=2.1132 acc=63.70% | val: loss=0.6560 acc=66.13% f1=43.24% auc=57.75% val_score=71.9285 val_score_bestthr=87.0247 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.444, mb=0.427, no=1.003, corr=0.460) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.7733 -> 71.9285
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4364 mb_mean=0.4153 norm_overlap=1.0032 corr_cb=0.4950 topkJ=0.2358
[TRAIN][ep=009] loss=2.1071 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.4273 mb_mean=0.4001 norm_overlap=1.0049 corr_cb=0.4373
[EPOCH 009/089] train: loss=2.1071 acc=63.70% | val: loss=0.6560 acc=64.52% f1=50.00% auc=57.86% val_score=73.9607 val_score_bestthr=88.5630 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.427, mb=0.400, no=1.005, corr=0.437) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.7733 -> 73.9607
[DBG][ep=010] disease_pos_weight=1.0000 mode=none
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.4246 mb_mean=0.3997 norm_overlap=1.0057 corr_cb=0.4447 topkJ=0.1745
[TRAIN][ep=010] loss=2.0982 acc=63.70%
[TRAIN][ep=010] mask_avg: mc_mean=0.4117 mb_mean=0.3747 norm_overlap=1.0059 corr_cb=0.3452
[EPOCH 010/089] train: loss=2.0982 acc=63.70% | val: loss=0.6553 acc=66.13% f1=36.36% auc=58.75% val_score=62.8082 val_score_bestthr=83.7543 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.412, mb=0.375, no=1.006, corr=0.345) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.7733 -> 62.8082
[DBG][ep=011] disease_pos_weight=1.0000 mode=none
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.3956 mb_mean=0.3447 norm_overlap=1.0147 corr_cb=0.4039 topkJ=0.1120
[TRAIN][ep=011] loss=2.0937 acc=63.70%
[TRAIN][ep=011] mask_avg: mc_mean=0.3962 mb_mean=0.3522 norm_overlap=1.0046 corr_cb=0.1720
[EPOCH 011/089] train: loss=2.0937 acc=63.70% | val: loss=0.6554 acc=66.13% f1=55.32% auc=58.86% val_score=69.7838 val_score_bestthr=92.8120 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.396, mb=0.352, no=1.005, corr=0.172) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.7733 -> 69.7838
[DBG][ep=012] disease_pos_weight=1.0000 mode=none
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.3922 mb_mean=0.3470 norm_overlap=1.0004 corr_cb=0.0146 topkJ=0.1229
[TRAIN][ep=012] loss=2.0937 acc=63.70%
[TRAIN][ep=012] mask_avg: mc_mean=0.3818 mb_mean=0.3345 norm_overlap=1.0015 corr_cb=0.0429
[EPOCH 012/089] train: loss=2.0937 acc=63.70% | val: loss=0.6555 acc=66.13% f1=32.26% auc=58.42% val_score=75.9104 val_score_bestthr=81.6375 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.382, mb=0.334, no=1.001, corr=0.043) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.7733 -> 75.9104
[DBG][ep=013] disease_pos_weight=1.0000 mode=none
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.3812 mb_mean=0.3301 norm_overlap=0.9996 corr_cb=-0.0115 topkJ=0.0862
[TRAIN][ep=013] loss=2.0803 acc=63.70%
[TRAIN][ep=013] mask_avg: mc_mean=0.3689 mb_mean=0.3193 norm_overlap=0.9930 corr_cb=-0.1354
[EPOCH 013/089] train: loss=2.0803 acc=63.70% | val: loss=0.6561 acc=66.13% f1=43.24% auc=56.63% val_score=71.8501 val_score_bestthr=86.9968 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.369, mb=0.319, no=0.993, corr=-0.135) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.7733 -> 71.8501
[DBG][ep=014] disease_pos_weight=1.0000 mode=none
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.3607 mb_mean=0.3189 norm_overlap=0.9838 corr_cb=-0.2804 topkJ=0.0163
[TRAIN][ep=014] loss=2.0703 acc=63.70%
[TRAIN][ep=014] mask_avg: mc_mean=0.3560 mb_mean=0.3071 norm_overlap=0.9734 corr_cb=-0.3569
[EPOCH 014/089] train: loss=2.0703 acc=63.70% | val: loss=0.6561 acc=66.13% f1=51.16% auc=56.41% val_score=67.9137 val_score_bestthr=91.0869 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.356, mb=0.307, no=0.973, corr=-0.357) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.7733 -> 67.9137
[DBG][ep=015] disease_pos_weight=1.0000 mode=none
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.3490 mb_mean=0.3008 norm_overlap=0.9611 corr_cb=-0.4725 topkJ=0.0215
[TRAIN][ep=015] loss=2.0681 acc=63.70%
[TRAIN][ep=015] mask_avg: mc_mean=0.3435 mb_mean=0.3023 norm_overlap=0.9496 corr_cb=-0.5129
[EPOCH 015/089] train: loss=2.0681 acc=63.70% | val: loss=0.6554 acc=64.52% f1=50.00% auc=57.19% val_score=76.9149 val_score_bestthr=88.8371 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.344, mb=0.302, no=0.950, corr=-0.513) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=* 76.7733 -> 76.9149
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=016] disease_pos_weight=1.0000 mode=none
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.3348 mb_mean=0.2996 norm_overlap=0.9378 corr_cb=-0.5773 topkJ=0.0025
[TRAIN][ep=016] loss=2.0581 acc=63.70%
[TRAIN][ep=016] mask_avg: mc_mean=0.3333 mb_mean=0.3023 norm_overlap=0.9369 corr_cb=-0.5569
[EPOCH 016/089] train: loss=2.0581 acc=63.70% | val: loss=0.6550 acc=64.52% f1=50.00% auc=56.86% val_score=71.9126 val_score_bestthr=88.8371 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.333, mb=0.302, no=0.937, corr=-0.557) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 76.9149 -> 71.9126
[DBG][ep=017] disease_pos_weight=1.0000 mode=none
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.3278 mb_mean=0.3077 norm_overlap=0.9273 corr_cb=-0.5735 topkJ=0.0024
[TRAIN][ep=017] loss=1.3549 acc=63.70%
[TRAIN][ep=017] mask_avg: mc_mean=0.3236 mb_mean=0.3023 norm_overlap=0.9209 corr_cb=-0.6008
[EPOCH 017/089] train: loss=1.3549 acc=63.70% | val: loss=0.6560 acc=64.52% f1=47.62% auc=56.74% val_score=85.2286 val_score_bestthr=87.5961 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.324, mb=0.302, no=0.921, corr=-0.601) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=* 76.9149 -> 85.2286
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=018] disease_pos_weight=1.0000 mode=none
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.3167 mb_mean=0.3120 norm_overlap=0.9418 corr_cb=-0.5135 topkJ=0.0016
[TRAIN][ep=018] loss=0.6502 acc=63.70%
[TRAIN][ep=018] mask_avg: mc_mean=0.3148 mb_mean=0.3023 norm_overlap=0.9046 corr_cb=-0.6414
[EPOCH 018/089] train: loss=0.6502 acc=63.70% | val: loss=0.6566 acc=64.52% f1=47.62% auc=56.30% val_score=78.2224 val_score_bestthr=87.8294 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.315, mb=0.302, no=0.905, corr=-0.641) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 78.2224
[DBG][ep=019] disease_pos_weight=1.0000 mode=none
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.3188 mb_mean=0.3112 norm_overlap=0.9194 corr_cb=-0.6528 topkJ=0.0000
[TRAIN][ep=019] loss=0.4712 acc=63.70%
[TRAIN][ep=019] mask_avg: mc_mean=0.3072 mb_mean=0.3023 norm_overlap=0.8872 corr_cb=-0.6767
[EPOCH 019/089] train: loss=0.4712 acc=63.70% | val: loss=0.6560 acc=66.13% f1=43.24% auc=55.07% val_score=76.0144 val_score_bestthr=87.2428 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.307, mb=0.302, no=0.887, corr=-0.677) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 76.0144
[DBG][ep=020] disease_pos_weight=1.0000 mode=none
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.3080 mb_mean=0.2993 norm_overlap=0.8639 corr_cb=-0.6893 topkJ=0.0000
[TRAIN][ep=020] loss=0.4518 acc=64.61%
[TRAIN][ep=020] mask_avg: mc_mean=0.3009 mb_mean=0.3023 norm_overlap=0.8683 corr_cb=-0.7058
[EPOCH 020/089] train: loss=0.4518 acc=64.61% | val: loss=0.6574 acc=66.13% f1=43.24% auc=54.63% val_score=71.0740 val_score_bestthr=87.2428 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.301, mb=0.302, no=0.868, corr=-0.706) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 71.0740
[DBG][ep=021] disease_pos_weight=1.0000 mode=none
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2941 mb_mean=0.2997 norm_overlap=0.8427 corr_cb=-0.7563 topkJ=0.0000
[TRAIN][ep=021] loss=0.4417 acc=66.42%
[TRAIN][ep=021] mask_avg: mc_mean=0.2958 mb_mean=0.3023 norm_overlap=0.8457 corr_cb=-0.7395
[EPOCH 021/089] train: loss=0.4417 acc=66.42% | val: loss=0.6603 acc=64.52% f1=42.11% auc=55.96% val_score=73.1226 val_score_bestthr=84.9757 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.296, mb=0.302, no=0.846, corr=-0.740) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 73.1226
[DBG][ep=022] disease_pos_weight=1.0000 mode=none
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2992 mb_mean=0.3006 norm_overlap=0.8294 corr_cb=-0.7791 topkJ=0.0000
[TRAIN][ep=022] loss=0.4316 acc=68.42%
[TRAIN][ep=022] mask_avg: mc_mean=0.2925 mb_mean=0.3023 norm_overlap=0.8265 corr_cb=-0.7600
[EPOCH 022/089] train: loss=0.4316 acc=68.42% | val: loss=0.6630 acc=64.52% f1=15.38% auc=55.07% val_score=71.0740 val_score_bestthr=71.6233 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.292, mb=0.302, no=0.827, corr=-0.760) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 71.0740
[DBG][ep=023] disease_pos_weight=1.0000 mode=none
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2876 mb_mean=0.3053 norm_overlap=0.8199 corr_cb=-0.7693 topkJ=0.0000
[TRAIN][ep=023] loss=0.4223 acc=70.96%
[TRAIN][ep=023] mask_avg: mc_mean=0.2903 mb_mean=0.3023 norm_overlap=0.8054 corr_cb=-0.7790
[EPOCH 023/089] train: loss=0.4223 acc=70.96% | val: loss=0.6700 acc=64.52% f1=42.11% auc=54.63% val_score=76.1594 val_score_bestthr=84.9757 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.290, mb=0.302, no=0.805, corr=-0.779) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 76.1594
[DBG][ep=024] disease_pos_weight=1.0000 mode=none
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2981 mb_mean=0.2939 norm_overlap=0.7925 corr_cb=-0.7731 topkJ=0.0000
[TRAIN][ep=024] loss=0.4114 acc=70.24%
[TRAIN][ep=024] mask_avg: mc_mean=0.2879 mb_mean=0.3023 norm_overlap=0.7905 corr_cb=-0.7884
[EPOCH 024/089] train: loss=0.4114 acc=70.24% | val: loss=0.6733 acc=64.52% f1=21.43% auc=53.29% val_score=67.0301 val_score_bestthr=74.6880 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.288, mb=0.302, no=0.791, corr=-0.788) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 67.0301
[DBG][ep=025] disease_pos_weight=1.0000 mode=none
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2741 mb_mean=0.3165 norm_overlap=0.8642 corr_cb=-0.6673 topkJ=0.0000
[TRAIN][ep=025] loss=0.4088 acc=72.41%
[TRAIN][ep=025] mask_avg: mc_mean=0.2876 mb_mean=0.3023 norm_overlap=0.7760 corr_cb=-0.7958
[EPOCH 025/089] train: loss=0.4088 acc=72.41% | val: loss=0.6778 acc=64.52% f1=21.43% auc=52.73% val_score=69.1281 val_score_bestthr=74.6880 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.288, mb=0.302, no=0.776, corr=-0.796) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 69.1281
[DBG][ep=026] disease_pos_weight=1.0000 mode=none
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2780 mb_mean=0.2916 norm_overlap=0.7328 corr_cb=-0.8053 topkJ=0.0000
[TRAIN][ep=026] loss=0.3985 acc=70.96%
[TRAIN][ep=026] mask_avg: mc_mean=0.2854 mb_mean=0.3023 norm_overlap=0.7654 corr_cb=-0.8013
[EPOCH 026/089] train: loss=0.3985 acc=70.96% | val: loss=0.6829 acc=64.52% f1=21.43% auc=53.62% val_score=68.3936 val_score_bestthr=74.6880 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.285, mb=0.302, no=0.765, corr=-0.801) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 68.3936
[DBG][ep=027] disease_pos_weight=1.0000 mode=none
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2855 mb_mean=0.3163 norm_overlap=0.7981 corr_cb=-0.8054 topkJ=0.0000
[TRAIN][ep=027] loss=0.3893 acc=73.50%
[TRAIN][ep=027] mask_avg: mc_mean=0.2841 mb_mean=0.3023 norm_overlap=0.7562 corr_cb=-0.8048
[EPOCH 027/089] train: loss=0.3893 acc=73.50% | val: loss=0.6843 acc=64.52% f1=21.43% auc=52.40% val_score=68.0860 val_score_bestthr=74.6880 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.284, mb=0.302, no=0.756, corr=-0.805) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 68.0860
[DBG][ep=028] disease_pos_weight=1.0000 mode=none
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2770 mb_mean=0.3090 norm_overlap=0.7590 corr_cb=-0.8185 topkJ=0.0000
[TRAIN][ep=028] loss=0.3824 acc=72.78%
[TRAIN][ep=028] mask_avg: mc_mean=0.2822 mb_mean=0.3023 norm_overlap=0.7459 corr_cb=-0.8112
[EPOCH 028/089] train: loss=0.3824 acc=72.78% | val: loss=0.6856 acc=64.52% f1=26.67% auc=51.73% val_score=70.0121 val_score_bestthr=77.3127 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.282, mb=0.302, no=0.746, corr=-0.811) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 70.0121
[DBG][ep=029] disease_pos_weight=1.0000 mode=none
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2668 mb_mean=0.2928 norm_overlap=0.7417 corr_cb=-0.7506 topkJ=0.0000
[TRAIN][ep=029] loss=0.3711 acc=74.23%
[TRAIN][ep=029] mask_avg: mc_mean=0.2785 mb_mean=0.3023 norm_overlap=0.7398 corr_cb=-0.8078
[EPOCH 029/089] train: loss=0.3711 acc=74.23% | val: loss=0.6899 acc=66.13% f1=16.00% auc=52.51% val_score=68.0860 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.278, mb=0.302, no=0.740, corr=-0.808) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 68.0860
[DBG][ep=030] disease_pos_weight=1.0000 mode=none
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2645 mb_mean=0.3132 norm_overlap=0.7402 corr_cb=-0.7789 topkJ=0.0000
[TRAIN][ep=030] loss=0.3630 acc=74.95%
[TRAIN][ep=030] mask_avg: mc_mean=0.2772 mb_mean=0.3023 norm_overlap=0.7326 corr_cb=-0.8093
[EPOCH 030/089] train: loss=0.3630 acc=74.95% | val: loss=0.6931 acc=66.13% f1=16.00% auc=52.51% val_score=67.0905 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.277, mb=0.302, no=0.733, corr=-0.809) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 67.0905
[DBG][ep=031] disease_pos_weight=1.0000 mode=none
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2855 mb_mean=0.2882 norm_overlap=0.6529 corr_cb=-0.8552 topkJ=0.0000
[TRAIN][ep=031] loss=0.3520 acc=75.86%
[TRAIN][ep=031] mask_avg: mc_mean=0.2763 mb_mean=0.3023 norm_overlap=0.7292 corr_cb=-0.8092
[EPOCH 031/089] train: loss=0.3520 acc=75.86% | val: loss=0.6942 acc=66.13% f1=16.00% auc=52.95% val_score=66.0424 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.302, no=0.729, corr=-0.809) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 66.0424
[DBG][ep=032] disease_pos_weight=1.0000 mode=none
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2599 mb_mean=0.3123 norm_overlap=0.8085 corr_cb=-0.7521 topkJ=0.0000
[TRAIN][ep=032] loss=0.3518 acc=75.68%
[TRAIN][ep=032] mask_avg: mc_mean=0.2763 mb_mean=0.3023 norm_overlap=0.7294 corr_cb=-0.8079
[EPOCH 032/089] train: loss=0.3518 acc=75.68% | val: loss=0.6942 acc=66.13% f1=16.00% auc=52.40% val_score=67.0905 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.302, no=0.729, corr=-0.808) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 67.0905
[DBG][ep=033] disease_pos_weight=1.0000 mode=none
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2889 mb_mean=0.2923 norm_overlap=0.6938 corr_cb=-0.7722 topkJ=0.0000
[TRAIN][ep=033] loss=0.3489 acc=75.50%
[TRAIN][ep=033] mask_avg: mc_mean=0.2763 mb_mean=0.3023 norm_overlap=0.7293 corr_cb=-0.8091
[EPOCH 033/089] train: loss=0.3489 acc=75.50% | val: loss=0.6951 acc=66.13% f1=16.00% auc=52.06% val_score=67.0905 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.302, no=0.729, corr=-0.809) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 67.0905
[DBG][ep=034] disease_pos_weight=1.0000 mode=none
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2692 mb_mean=0.3080 norm_overlap=0.7714 corr_cb=-0.7974 topkJ=0.0000
[TRAIN][ep=034] loss=0.3464 acc=75.86%
[TRAIN][ep=034] mask_avg: mc_mean=0.2763 mb_mean=0.3023 norm_overlap=0.7293 corr_cb=-0.8092
[EPOCH 034/089] train: loss=0.3464 acc=75.86% | val: loss=0.6968 acc=66.13% f1=16.00% auc=52.62% val_score=66.0133 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.302, no=0.729, corr=-0.809) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 66.0133
[DBG][ep=035] disease_pos_weight=1.0000 mode=none
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2605 mb_mean=0.3206 norm_overlap=0.7939 corr_cb=-0.7555 topkJ=0.0000
[TRAIN][ep=035] loss=0.3461 acc=76.23%
[TRAIN][ep=035] mask_avg: mc_mean=0.2763 mb_mean=0.3023 norm_overlap=0.7292 corr_cb=-0.8087
[EPOCH 035/089] train: loss=0.3461 acc=76.23% | val: loss=0.6963 acc=66.13% f1=16.00% auc=52.51% val_score=67.0905 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.302, no=0.729, corr=-0.809) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 67.0905
[DBG][ep=036] disease_pos_weight=1.0000 mode=none
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2800 mb_mean=0.3143 norm_overlap=0.7471 corr_cb=-0.8461 topkJ=0.0000
[TRAIN][ep=036] loss=0.3438 acc=75.86%
[TRAIN][ep=036] mask_avg: mc_mean=0.2763 mb_mean=0.3023 norm_overlap=0.7293 corr_cb=-0.8094
[EPOCH 036/089] train: loss=0.3438 acc=75.86% | val: loss=0.6965 acc=66.13% f1=16.00% auc=52.40% val_score=67.0905 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.302, no=0.729, corr=-0.809) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 67.0905
[DBG][ep=037] disease_pos_weight=1.0000 mode=none
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.2937 mb_mean=0.2892 norm_overlap=0.6440 corr_cb=-0.8533 topkJ=0.0000
[TRAIN][ep=037] loss=0.3413 acc=76.04%
[TRAIN][ep=037] mask_avg: mc_mean=0.2763 mb_mean=0.3023 norm_overlap=0.7294 corr_cb=-0.8082
[EPOCH 037/089] train: loss=0.3413 acc=76.04% | val: loss=0.6978 acc=66.13% f1=16.00% auc=52.73% val_score=69.0566 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.302, no=0.729, corr=-0.808) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 69.0566
[DBG][ep=038] disease_pos_weight=1.0000 mode=none
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2397 mb_mean=0.3129 norm_overlap=0.8179 corr_cb=-0.6839 topkJ=0.0000
[TRAIN][ep=038] loss=0.3391 acc=76.23%
[TRAIN][ep=038] mask_avg: mc_mean=0.2764 mb_mean=0.3023 norm_overlap=0.7295 corr_cb=-0.8079
[EPOCH 038/089] train: loss=0.3391 acc=76.23% | val: loss=0.6993 acc=66.13% f1=16.00% auc=52.73% val_score=66.0133 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.302, no=0.730, corr=-0.808) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 66.0133
[DBG][ep=039] disease_pos_weight=1.0000 mode=none
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2823 mb_mean=0.3022 norm_overlap=0.7321 corr_cb=-0.8430 topkJ=0.0000
[TRAIN][ep=039] loss=0.3375 acc=75.86%
[TRAIN][ep=039] mask_avg: mc_mean=0.2763 mb_mean=0.3023 norm_overlap=0.7295 corr_cb=-0.8084
[EPOCH 039/089] train: loss=0.3375 acc=75.86% | val: loss=0.6994 acc=66.13% f1=16.00% auc=52.62% val_score=66.0133 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.302, no=0.729, corr=-0.808) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 66.0133
[DBG][ep=040] disease_pos_weight=1.0000 mode=none
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.2929 mb_mean=0.2797 norm_overlap=0.6260 corr_cb=-0.8594 topkJ=0.0000
[TRAIN][ep=040] loss=0.3365 acc=76.04%
[TRAIN][ep=040] mask_avg: mc_mean=0.2763 mb_mean=0.3023 norm_overlap=0.7294 corr_cb=-0.8083
[EPOCH 040/089] train: loss=0.3365 acc=76.04% | val: loss=0.7013 acc=66.13% f1=16.00% auc=52.51% val_score=66.0133 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.302, no=0.729, corr=-0.808) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 66.0133
[DBG][ep=041] disease_pos_weight=1.0000 mode=none
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.2844 mb_mean=0.2936 norm_overlap=0.6745 corr_cb=-0.8434 topkJ=0.0000
[TRAIN][ep=041] loss=0.3341 acc=76.41%
[TRAIN][ep=041] mask_avg: mc_mean=0.2763 mb_mean=0.3023 norm_overlap=0.7292 corr_cb=-0.8108
[EPOCH 041/089] train: loss=0.3341 acc=76.41% | val: loss=0.7016 acc=66.13% f1=16.00% auc=53.07% val_score=66.0133 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.302, no=0.729, corr=-0.811) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 66.0133
[DBG][ep=042] disease_pos_weight=1.0000 mode=none
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.2639 mb_mean=0.3164 norm_overlap=0.7631 corr_cb=-0.8051 topkJ=0.0000
[TRAIN][ep=042] loss=0.3324 acc=76.59%
[TRAIN][ep=042] mask_avg: mc_mean=0.2763 mb_mean=0.3023 norm_overlap=0.7292 corr_cb=-0.8086
[EPOCH 042/089] train: loss=0.3324 acc=76.59% | val: loss=0.7007 acc=66.13% f1=16.00% auc=52.84% val_score=66.0133 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.302, no=0.729, corr=-0.809) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 66.0133
[DBG][ep=043] disease_pos_weight=1.0000 mode=none
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.2718 mb_mean=0.3048 norm_overlap=0.7227 corr_cb=-0.8399 topkJ=0.0000
[TRAIN][ep=043] loss=0.3303 acc=76.95%
[TRAIN][ep=043] mask_avg: mc_mean=0.2764 mb_mean=0.3023 norm_overlap=0.7292 corr_cb=-0.8087
[EPOCH 043/089] train: loss=0.3303 acc=76.95% | val: loss=0.7018 acc=66.13% f1=16.00% auc=52.95% val_score=66.0133 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.302, no=0.729, corr=-0.809) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 66.0133
[DBG][ep=044] disease_pos_weight=1.0000 mode=none
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2740 mb_mean=0.2934 norm_overlap=0.7640 corr_cb=-0.7496 topkJ=0.0000
[TRAIN][ep=044] loss=0.3288 acc=76.41%
[TRAIN][ep=044] mask_avg: mc_mean=0.2763 mb_mean=0.3023 norm_overlap=0.7292 corr_cb=-0.8090
[EPOCH 044/089] train: loss=0.3288 acc=76.41% | val: loss=0.7028 acc=66.13% f1=16.00% auc=53.18% val_score=66.0133 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.302, no=0.729, corr=-0.809) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 66.0133
[DBG][ep=045] disease_pos_weight=1.0000 mode=none
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2675 mb_mean=0.3062 norm_overlap=0.7572 corr_cb=-0.7734 topkJ=0.0000
[TRAIN][ep=045] loss=0.3265 acc=76.23%
[TRAIN][ep=045] mask_avg: mc_mean=0.2764 mb_mean=0.3023 norm_overlap=0.7290 corr_cb=-0.8103
[EPOCH 045/089] train: loss=0.3265 acc=76.23% | val: loss=0.7027 acc=66.13% f1=16.00% auc=52.62% val_score=69.0566 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.302, no=0.729, corr=-0.810) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 69.0566
[DBG][ep=046] disease_pos_weight=1.0000 mode=none
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.2636 mb_mean=0.2986 norm_overlap=0.7203 corr_cb=-0.8241 topkJ=0.0000
[TRAIN][ep=046] loss=0.3261 acc=76.23%
[TRAIN][ep=046] mask_avg: mc_mean=0.2763 mb_mean=0.3023 norm_overlap=0.7287 corr_cb=-0.8107
[EPOCH 046/089] train: loss=0.3261 acc=76.23% | val: loss=0.7044 acc=66.13% f1=32.26% auc=53.07% val_score=66.0133 val_score_bestthr=81.6712 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.302, no=0.729, corr=-0.811) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 66.0133
[DBG][ep=047] disease_pos_weight=1.0000 mode=none
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.2741 mb_mean=0.3115 norm_overlap=0.7371 corr_cb=-0.8300 topkJ=0.0000
[TRAIN][ep=047] loss=0.3241 acc=77.50%
[TRAIN][ep=047] mask_avg: mc_mean=0.2763 mb_mean=0.3023 norm_overlap=0.7292 corr_cb=-0.8090
[EPOCH 047/089] train: loss=0.3241 acc=77.50% | val: loss=0.7040 acc=66.13% f1=32.26% auc=52.84% val_score=69.0566 val_score_bestthr=81.6712 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.302, no=0.729, corr=-0.809) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 85.2286 -> 69.0566
[EARLY STOP] no improvement for 30 epochs. best_epoch=17
[CKPT] Loaded best for testing: results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
=============== FIT DONE ===============
[BEST] epoch=17 | val_acc=64.52% | val_f1=47.62% | val_auc=56.74% | val_score=85.2286 | val_score_bestthr=87.5961
[TEST@BEST] thr_used=0.400 | acc=65.58% f1=25.35% auc=63.63% | SP_sex=5.89% EO_sex=0.76% SP_age=8.07% EO_age=12.70%
[TIME] 0.83 min
[OK] Saved: results/ADHD_3x5fold_seed0/fold1_rep0_seed1/summary_fold_1.json
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5033 mb_mean=0.5074 norm_overlap=1.0000 corr_cb=-0.0236 topkJ=0.0769
[TRAIN][ep=000] loss=0.6876 acc=61.34%
[TRAIN][ep=000] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1035
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5043 mb_mean=0.5082 norm_overlap=1.0001 corr_cb=0.1648 topkJ=0.0737
[TRAIN][ep=001] loss=0.6755 acc=63.70%
[TRAIN][ep=001] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1054
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5022 mb_mean=0.5087 norm_overlap=1.0002 corr_cb=0.2275 topkJ=0.1455
[TRAIN][ep=002] loss=0.6656 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1043
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5035 mb_mean=0.5094 norm_overlap=1.0000 corr_cb=0.0241 topkJ=0.0509
[TRAIN][ep=003] loss=0.6594 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1050
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5028 mb_mean=0.5106 norm_overlap=1.0000 corr_cb=-0.0149 topkJ=0.0979
[TRAIN][ep=004] loss=0.6565 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1064
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5019 mb_mean=0.5085 norm_overlap=1.0001 corr_cb=0.1280 topkJ=0.1508
[TRAIN][ep=005] loss=0.6563 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1026
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5034 mb_mean=0.5096 norm_overlap=1.0001 corr_cb=0.0714 topkJ=0.1095
[TRAIN][ep=006] loss=0.6540 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1069
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5027 mb_mean=0.5084 norm_overlap=1.0001 corr_cb=0.0800 topkJ=0.0599
[TRAIN][ep=007] loss=0.6536 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1041
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5013 mb_mean=0.5071 norm_overlap=1.0002 corr_cb=0.2685 topkJ=0.0945
[TRAIN][ep=008] loss=0.6521 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1038
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5020 mb_mean=0.5111 norm_overlap=1.0000 corr_cb=0.0016 topkJ=0.0557
[TRAIN][ep=009] loss=0.6513 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1023
================= FIT START (fold=1) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.35 select_by=val_score | eval_thr_mode=best_acc eval_thr_grid=coarse | disease_pos_weight_mode=none freeze_b_after=15 | two_stage=True stage1_ratio=0.35 stage2_lr_mult=0.3 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5045 mb_mean=0.5109 norm_overlap=1.0000 corr_cb=0.0362 topkJ=0.0638
[TRAIN][ep=000] loss=0.6500 acc=63.70%
[TRAIN][ep=000] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1077
[EPOCH 000/089] train: loss=0.6500 acc=63.70% | val: loss=0.6577 acc=62.90% f1=0.00% auc=54.96% val_score=72.0763 val_score_bestthr=62.9032 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.503, mb=0.509, no=1.000, corr=0.108) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* -1000000000000000000.0000 -> 72.0763
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5043 mb_mean=0.5100 norm_overlap=1.0000 corr_cb=-0.0050 topkJ=0.0422
[TRAIN][ep=001] loss=0.6489 acc=63.70%
[TRAIN][ep=001] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1086
[EPOCH 001/089] train: loss=0.6489 acc=63.70% | val: loss=0.6572 acc=64.52% f1=38.89% auc=56.08% val_score=70.1231 val_score_bestthr=83.2578 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.503, mb=0.509, no=1.000, corr=0.109) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 72.0763 -> 70.1231
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5004 mb_mean=0.5099 norm_overlap=1.0001 corr_cb=0.2004 topkJ=0.1277
[TRAIN][ep=002] loss=0.6480 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1068
[EPOCH 002/089] train: loss=0.6480 acc=63.70% | val: loss=0.6569 acc=62.90% f1=30.30% auc=56.19% val_score=74.6247 val_score_bestthr=77.4480 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.503, mb=0.509, no=1.000, corr=0.107) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 72.0763 -> 74.6247
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5013 mb_mean=0.5096 norm_overlap=1.0001 corr_cb=0.1039 topkJ=0.0703
[TRAIN][ep=003] loss=0.6465 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1068
[EPOCH 003/089] train: loss=0.6465 acc=63.70% | val: loss=0.6568 acc=64.52% f1=38.89% auc=57.08% val_score=75.4593 val_score_bestthr=83.2578 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.503, mb=0.509, no=1.000, corr=0.107) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 74.6247 -> 75.4593
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.0595 topkJ=0.0573
[TRAIN][ep=004] loss=0.6452 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1040
[EPOCH 004/089] train: loss=0.6452 acc=63.70% | val: loss=0.6559 acc=66.13% f1=43.24% auc=57.75% val_score=65.9529 val_score_bestthr=87.0247 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.503, mb=0.509, no=1.000, corr=0.104) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 75.4593 -> 65.9529
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5024 mb_mean=0.5096 norm_overlap=1.0000 corr_cb=0.0125 topkJ=0.1126
[TRAIN][ep=005] loss=2.6310 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.4948 mb_mean=0.5021 norm_overlap=1.0001 corr_cb=0.0727
[EPOCH 005/089] train: loss=2.6310 acc=63.70% | val: loss=0.6566 acc=66.13% f1=43.24% auc=57.41% val_score=73.7835 val_score_bestthr=87.0247 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.495, mb=0.502, no=1.000, corr=0.073) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 75.4593 -> 73.7835
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4860 mb_mean=0.4941 norm_overlap=1.0001 corr_cb=0.1184 topkJ=0.0512
[TRAIN][ep=006] loss=2.6238 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.4789 mb_mean=0.4860 norm_overlap=1.0002 corr_cb=0.1098
[EPOCH 006/089] train: loss=2.6238 acc=63.70% | val: loss=0.6568 acc=67.74% f1=50.00% auc=57.97% val_score=74.8509 val_score_bestthr=91.6142 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.479, mb=0.486, no=1.000, corr=0.110) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 75.4593 -> 74.8509
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4704 mb_mean=0.4767 norm_overlap=1.0004 corr_cb=0.1458 topkJ=0.0805
[TRAIN][ep=007] loss=2.6179 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.4626 mb_mean=0.4676 norm_overlap=1.0009 corr_cb=0.3088
[EPOCH 007/089] train: loss=2.6179 acc=63.70% | val: loss=0.6564 acc=64.52% f1=50.00% auc=58.08% val_score=72.8728 val_score_bestthr=88.4099 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.463, mb=0.468, no=1.001, corr=0.309) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 75.4593 -> 72.8728
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4540 mb_mean=0.4614 norm_overlap=1.0017 corr_cb=0.3713 topkJ=0.1320
[TRAIN][ep=008] loss=2.6147 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.4464 mb_mean=0.4478 norm_overlap=1.0020 corr_cb=0.4149
[EPOCH 008/089] train: loss=2.6147 acc=63.70% | val: loss=0.6560 acc=66.13% f1=43.24% auc=57.97% val_score=69.9246 val_score_bestthr=87.0247 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.446, mb=0.448, no=1.002, corr=0.415) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 75.4593 -> 69.9246
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4391 mb_mean=0.4387 norm_overlap=1.0021 corr_cb=0.4619 topkJ=0.2190
[TRAIN][ep=009] loss=2.6083 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.4301 mb_mean=0.4268 norm_overlap=1.0033 corr_cb=0.4260
[EPOCH 009/089] train: loss=2.6083 acc=63.70% | val: loss=0.6560 acc=64.52% f1=50.00% auc=57.86% val_score=73.9607 val_score_bestthr=88.5630 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.430, mb=0.427, no=1.003, corr=0.426) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 75.4593 -> 73.9607
[DBG][ep=010] disease_pos_weight=1.0000 mode=none
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.4272 mb_mean=0.4249 norm_overlap=1.0043 corr_cb=0.4565 topkJ=0.1685
[TRAIN][ep=010] loss=2.5990 acc=63.70%
[TRAIN][ep=010] mask_avg: mc_mean=0.4146 mb_mean=0.4053 norm_overlap=1.0044 corr_cb=0.3695
[EPOCH 010/089] train: loss=2.5990 acc=63.70% | val: loss=0.6553 acc=66.13% f1=36.36% auc=58.42% val_score=58.9912 val_score_bestthr=83.7543 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.415, mb=0.405, no=1.004, corr=0.369) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 75.4593 -> 58.9912
[DBG][ep=011] disease_pos_weight=1.0000 mode=none
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.3982 mb_mean=0.3800 norm_overlap=1.0116 corr_cb=0.4510 topkJ=0.1190
[TRAIN][ep=011] loss=2.5943 acc=63.70%
[TRAIN][ep=011] mask_avg: mc_mean=0.3991 mb_mean=0.3845 norm_overlap=1.0045 corr_cb=0.2409
[EPOCH 011/089] train: loss=2.5943 acc=63.70% | val: loss=0.6553 acc=66.13% f1=40.00% auc=58.64% val_score=67.7762 val_score_bestthr=85.4482 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.399, mb=0.384, no=1.005, corr=0.241) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 75.4593 -> 67.7762
[DBG][ep=012] disease_pos_weight=1.0000 mode=none
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.3951 mb_mean=0.3788 norm_overlap=1.0020 corr_cb=0.1093 topkJ=0.1393
[TRAIN][ep=012] loss=1.7146 acc=63.70%
[TRAIN][ep=012] mask_avg: mc_mean=0.3845 mb_mean=0.3663 norm_overlap=1.0044 corr_cb=0.1737
[EPOCH 012/089] train: loss=1.7146 acc=63.70% | val: loss=0.6552 acc=66.13% f1=40.00% auc=58.53% val_score=71.8035 val_score_bestthr=85.4482 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.385, mb=0.366, no=1.004, corr=0.174) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 75.4593 -> 71.8035
[DBG][ep=013] disease_pos_weight=1.0000 mode=none
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.3832 mb_mean=0.3613 norm_overlap=1.0041 corr_cb=0.1670 topkJ=0.1070
[TRAIN][ep=013] loss=0.8286 acc=63.70%
[TRAIN][ep=013] mask_avg: mc_mean=0.3709 mb_mean=0.3491 norm_overlap=1.0012 corr_cb=0.0346
[EPOCH 013/089] train: loss=0.8286 acc=63.70% | val: loss=0.6552 acc=64.52% f1=52.17% auc=57.30% val_score=77.8739 val_score_bestthr=89.7162 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.371, mb=0.349, no=1.001, corr=0.035) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 75.4593 -> 77.8739
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=014] disease_pos_weight=1.0000 mode=none
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.3635 mb_mean=0.3461 norm_overlap=0.9962 corr_cb=-0.0968 topkJ=0.0491
[TRAIN][ep=014] loss=0.5652 acc=63.70%
[TRAIN][ep=014] mask_avg: mc_mean=0.3571 mb_mean=0.3335 norm_overlap=0.9913 corr_cb=-0.1695
[EPOCH 014/089] train: loss=0.5652 acc=63.70% | val: loss=0.6548 acc=66.13% f1=36.36% auc=56.86% val_score=75.9805 val_score_bestthr=83.7543 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.357, mb=0.333, no=0.991, corr=-0.170) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 77.8739 -> 75.9805
[DBG][ep=015] disease_pos_weight=1.0000 mode=none
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.3489 mb_mean=0.3260 norm_overlap=0.9794 corr_cb=-0.3476 topkJ=0.0423
[TRAIN][ep=015] loss=0.5470 acc=63.70%
[TRAIN][ep=015] mask_avg: mc_mean=0.3424 mb_mean=0.3262 norm_overlap=0.9754 corr_cb=-0.3481
[EPOCH 015/089] train: loss=0.5470 acc=63.70% | val: loss=0.6548 acc=66.13% f1=43.24% auc=56.30% val_score=78.0253 val_score_bestthr=87.2428 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.342, mb=0.326, no=0.975, corr=-0.348) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=* 77.8739 -> 78.0253
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=016] disease_pos_weight=1.0000 mode=none
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.3316 mb_mean=0.3237 norm_overlap=0.9653 corr_cb=-0.4311 topkJ=0.0204
[TRAIN][ep=016] loss=0.5409 acc=63.70%
[TRAIN][ep=016] mask_avg: mc_mean=0.3281 mb_mean=0.3262 norm_overlap=0.9631 corr_cb=-0.4265
[EPOCH 016/089] train: loss=0.5409 acc=63.70% | val: loss=0.6551 acc=64.52% f1=50.00% auc=56.41% val_score=78.0253 val_score_bestthr=88.8197 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.328, mb=0.326, no=0.963, corr=-0.426) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 78.0253 -> 78.0253
[DBG][ep=017] disease_pos_weight=1.0000 mode=none
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.3206 mb_mean=0.3300 norm_overlap=0.9577 corr_cb=-0.4228 topkJ=0.0123
[TRAIN][ep=017] loss=0.5332 acc=64.61%
[TRAIN][ep=017] mask_avg: mc_mean=0.3151 mb_mean=0.3261 norm_overlap=0.9493 corr_cb=-0.4878
[EPOCH 017/089] train: loss=0.5332 acc=64.61% | val: loss=0.6562 acc=67.74% f1=50.00% auc=56.63% val_score=77.0649 val_score_bestthr=91.9631 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.315, mb=0.326, no=0.949, corr=-0.488) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 78.0253 -> 77.0649
[DBG][ep=018] disease_pos_weight=1.0000 mode=none
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.3067 mb_mean=0.3353 norm_overlap=0.9629 corr_cb=-0.3905 topkJ=0.0041
[TRAIN][ep=018] loss=0.8871 acc=63.88%
[TRAIN][ep=018] mask_avg: mc_mean=0.3045 mb_mean=0.3262 norm_overlap=0.9362 corr_cb=-0.5355
[EPOCH 018/089] train: loss=0.8871 acc=63.88% | val: loss=0.6588 acc=66.13% f1=16.00% auc=55.85% val_score=86.6951 val_score_bestthr=73.5795 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.305, mb=0.326, no=0.936, corr=-0.535) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=* 78.0253 -> 86.6951
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=019] disease_pos_weight=1.0000 mode=none
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.3098 mb_mean=0.3356 norm_overlap=0.9462 corr_cb=-0.5619 topkJ=0.0004
[TRAIN][ep=019] loss=1.2296 acc=63.70%
[TRAIN][ep=019] mask_avg: mc_mean=0.2983 mb_mean=0.3262 norm_overlap=0.9281 corr_cb=-0.5627
[EPOCH 019/089] train: loss=1.2296 acc=63.70% | val: loss=0.6560 acc=64.52% f1=38.89% auc=56.52% val_score=81.2393 val_score_bestthr=83.5971 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.298, mb=0.326, no=0.928, corr=-0.563) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 86.6951 -> 81.2393
[DBG][ep=020] disease_pos_weight=1.0000 mode=none
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.3000 mb_mean=0.3224 norm_overlap=0.9181 corr_cb=-0.5577 topkJ=0.0004
[TRAIN][ep=020] loss=1.5761 acc=63.88%
[TRAIN][ep=020] mask_avg: mc_mean=0.2933 mb_mean=0.3261 norm_overlap=0.9219 corr_cb=-0.5763
[EPOCH 020/089] train: loss=1.5761 acc=63.88% | val: loss=0.6553 acc=66.13% f1=40.00% auc=55.85% val_score=79.2584 val_score_bestthr=85.7453 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.293, mb=0.326, no=0.922, corr=-0.576) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 86.6951 -> 79.2584
[DBG][ep=021] disease_pos_weight=1.0000 mode=none
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2868 mb_mean=0.3238 norm_overlap=0.9087 corr_cb=-0.6240 topkJ=0.0000
[TRAIN][ep=021] loss=1.9179 acc=64.43%
[TRAIN][ep=021] mask_avg: mc_mean=0.2888 mb_mean=0.3262 norm_overlap=0.9120 corr_cb=-0.6076
[EPOCH 021/089] train: loss=1.9179 acc=64.43% | val: loss=0.6567 acc=64.52% f1=38.89% auc=56.52% val_score=80.3139 val_score_bestthr=83.5971 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.289, mb=0.326, no=0.912, corr=-0.608) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 86.6951 -> 80.3139
[DBG][ep=022] disease_pos_weight=1.0000 mode=none
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2917 mb_mean=0.3256 norm_overlap=0.9020 corr_cb=-0.6616 topkJ=0.0000
[TRAIN][ep=022] loss=2.2541 acc=64.07%
[TRAIN][ep=022] mask_avg: mc_mean=0.2847 mb_mean=0.3262 norm_overlap=0.9033 corr_cb=-0.6292
[EPOCH 022/089] train: loss=2.2541 acc=64.07% | val: loss=0.6558 acc=66.13% f1=36.36% auc=56.74% val_score=74.1380 val_score_bestthr=83.7443 | dyn(w_pfs=0.100, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.285, mb=0.326, no=0.903, corr=-0.629) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 86.6951 -> 74.1380
[DBG][ep=023] disease_pos_weight=1.0000 mode=none
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2791 mb_mean=0.3286 norm_overlap=0.9039 corr_cb=-0.6305 topkJ=0.0000
[TRAIN][ep=023] loss=1.3733 acc=65.88%
[TRAIN][ep=023] mask_avg: mc_mean=0.2806 mb_mean=0.3261 norm_overlap=0.8932 corr_cb=-0.6520
[EPOCH 023/089] train: loss=1.3733 acc=65.88% | val: loss=0.6573 acc=67.74% f1=41.18% auc=57.08% val_score=82.4750 val_score_bestthr=87.8752 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.281, mb=0.326, no=0.893, corr=-0.652) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 86.6951 -> 82.4750
[DBG][ep=024] disease_pos_weight=1.0000 mode=none
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2853 mb_mean=0.3196 norm_overlap=0.8853 corr_cb=-0.6471 topkJ=0.0000
[TRAIN][ep=024] loss=0.4936 acc=66.06%
[TRAIN][ep=024] mask_avg: mc_mean=0.2768 mb_mean=0.3262 norm_overlap=0.8835 corr_cb=-0.6695
[EPOCH 024/089] train: loss=0.4936 acc=66.06% | val: loss=0.6552 acc=64.52% f1=42.11% auc=56.63% val_score=70.0927 val_score_bestthr=85.2160 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.277, mb=0.326, no=0.883, corr=-0.669) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 86.6951 -> 70.0927
[DBG][ep=025] disease_pos_weight=1.0000 mode=none
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2681 mb_mean=0.3396 norm_overlap=0.9279 corr_cb=-0.5438 topkJ=0.0004
[TRAIN][ep=025] loss=0.4870 acc=69.69%
[TRAIN][ep=025] mask_avg: mc_mean=0.2748 mb_mean=0.3262 norm_overlap=0.8718 corr_cb=-0.6884
[EPOCH 025/089] train: loss=0.4870 acc=69.69% | val: loss=0.6586 acc=64.52% f1=42.11% auc=56.41% val_score=68.9183 val_score_bestthr=85.2160 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.275, mb=0.326, no=0.872, corr=-0.688) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 86.6951 -> 68.9183
[DBG][ep=026] disease_pos_weight=1.0000 mode=none
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2619 mb_mean=0.3152 norm_overlap=0.8424 corr_cb=-0.6957 topkJ=0.0000
[TRAIN][ep=026] loss=0.4768 acc=70.05%
[TRAIN][ep=026] mask_avg: mc_mean=0.2731 mb_mean=0.3262 norm_overlap=0.8612 corr_cb=-0.7048
[EPOCH 026/089] train: loss=0.4768 acc=70.05% | val: loss=0.6639 acc=64.52% f1=31.25% auc=55.74% val_score=71.0133 val_score_bestthr=79.6196 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.273, mb=0.326, no=0.861, corr=-0.705) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 86.6951 -> 71.0133
[DBG][ep=027] disease_pos_weight=1.0000 mode=none
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2767 mb_mean=0.3392 norm_overlap=0.8817 corr_cb=-0.7153 topkJ=0.0000
[TRAIN][ep=027] loss=0.4673 acc=72.78%
[TRAIN][ep=027] mask_avg: mc_mean=0.2726 mb_mean=0.3262 norm_overlap=0.8520 corr_cb=-0.7168
[EPOCH 027/089] train: loss=0.4673 acc=72.78% | val: loss=0.6662 acc=66.13% f1=16.00% auc=55.18% val_score=69.1281 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.273, mb=0.326, no=0.852, corr=-0.717) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 86.6951 -> 69.1281
[DBG][ep=028] disease_pos_weight=1.0000 mode=none
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2668 mb_mean=0.3324 norm_overlap=0.8527 corr_cb=-0.7340 topkJ=0.0000
[TRAIN][ep=028] loss=0.4591 acc=72.23%
[TRAIN][ep=028] mask_avg: mc_mean=0.2719 mb_mean=0.3261 norm_overlap=0.8426 corr_cb=-0.7291
[EPOCH 028/089] train: loss=0.4591 acc=72.23% | val: loss=0.6696 acc=66.13% f1=16.00% auc=54.29% val_score=68.0632 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.272, mb=0.326, no=0.843, corr=-0.729) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 86.6951 -> 68.0632
[DBG][ep=029] disease_pos_weight=1.0000 mode=none
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2575 mb_mean=0.3178 norm_overlap=0.8412 corr_cb=-0.6669 topkJ=0.0000
[TRAIN][ep=029] loss=0.4477 acc=74.23%
[TRAIN][ep=029] mask_avg: mc_mean=0.2698 mb_mean=0.3261 norm_overlap=0.8371 corr_cb=-0.7281
[EPOCH 029/089] train: loss=0.4477 acc=74.23% | val: loss=0.6748 acc=66.13% f1=16.00% auc=54.63% val_score=71.0740 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.270, mb=0.326, no=0.837, corr=-0.728) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 86.6951 -> 71.0740
[DBG][ep=030] disease_pos_weight=1.0000 mode=none
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2580 mb_mean=0.3340 norm_overlap=0.8372 corr_cb=-0.6814 topkJ=0.0000
[TRAIN][ep=030] loss=0.4388 acc=74.05%
[TRAIN][ep=030] mask_avg: mc_mean=0.2693 mb_mean=0.3261 norm_overlap=0.8313 corr_cb=-0.7301
[EPOCH 030/089] train: loss=0.4388 acc=74.05% | val: loss=0.6786 acc=66.13% f1=16.00% auc=53.85% val_score=64.0660 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.269, mb=0.326, no=0.831, corr=-0.730) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 86.6951 -> 64.0660
[DBG][ep=031] disease_pos_weight=1.0000 mode=none
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2740 mb_mean=0.3115 norm_overlap=0.7762 corr_cb=-0.7782 topkJ=0.0000
[TRAIN][ep=031] loss=0.4280 acc=75.68%
[TRAIN][ep=031] mask_avg: mc_mean=0.2690 mb_mean=0.3262 norm_overlap=0.8285 corr_cb=-0.7307
[EPOCH 031/089] train: loss=0.4280 acc=75.68% | val: loss=0.6799 acc=66.13% f1=16.00% auc=54.40% val_score=70.0606 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.269, mb=0.326, no=0.829, corr=-0.731) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 86.6951 -> 70.0606
[DBG][ep=032] disease_pos_weight=1.0000 mode=none
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2575 mb_mean=0.3357 norm_overlap=0.8830 corr_cb=-0.6508 topkJ=0.0000
[TRAIN][ep=032] loss=0.4277 acc=75.68%
[TRAIN][ep=032] mask_avg: mc_mean=0.2690 mb_mean=0.3261 norm_overlap=0.8288 corr_cb=-0.7289
[EPOCH 032/089] train: loss=0.4277 acc=75.68% | val: loss=0.6801 acc=66.13% f1=16.00% auc=54.18% val_score=64.0660 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.269, mb=0.326, no=0.829, corr=-0.729) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 86.6951 -> 64.0660
[DBG][ep=033] disease_pos_weight=1.0000 mode=none
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2782 mb_mean=0.3154 norm_overlap=0.8045 corr_cb=-0.6777 topkJ=0.0000
[TRAIN][ep=033] loss=0.4248 acc=75.32%
[TRAIN][ep=033] mask_avg: mc_mean=0.2690 mb_mean=0.3262 norm_overlap=0.8286 corr_cb=-0.7304
[EPOCH 033/089] train: loss=0.4248 acc=75.32% | val: loss=0.6809 acc=66.13% f1=16.00% auc=54.18% val_score=64.0660 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.269, mb=0.326, no=0.829, corr=-0.730) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 86.6951 -> 64.0660
[DBG][ep=034] disease_pos_weight=1.0000 mode=none
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2643 mb_mean=0.3319 norm_overlap=0.8568 corr_cb=-0.7167 topkJ=0.0000
[TRAIN][ep=034] loss=0.4223 acc=75.86%
[TRAIN][ep=034] mask_avg: mc_mean=0.2690 mb_mean=0.3262 norm_overlap=0.8287 corr_cb=-0.7303
[EPOCH 034/089] train: loss=0.4223 acc=75.86% | val: loss=0.6828 acc=66.13% f1=16.00% auc=53.96% val_score=70.0606 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.269, mb=0.326, no=0.829, corr=-0.730) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 86.6951 -> 70.0606
[DBG][ep=035] disease_pos_weight=1.0000 mode=none
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2582 mb_mean=0.3427 norm_overlap=0.8793 corr_cb=-0.6500 topkJ=0.0000
[TRAIN][ep=035] loss=0.4219 acc=75.86%
[TRAIN][ep=035] mask_avg: mc_mean=0.2690 mb_mean=0.3261 norm_overlap=0.8286 corr_cb=-0.7296
[EPOCH 035/089] train: loss=0.4219 acc=75.86% | val: loss=0.6823 acc=66.13% f1=16.00% auc=54.29% val_score=66.0133 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.269, mb=0.326, no=0.829, corr=-0.730) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 86.6951 -> 66.0133
[DBG][ep=036] disease_pos_weight=1.0000 mode=none
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2748 mb_mean=0.3373 norm_overlap=0.8395 corr_cb=-0.7706 topkJ=0.0000
[TRAIN][ep=036] loss=0.4196 acc=76.41%
[TRAIN][ep=036] mask_avg: mc_mean=0.2690 mb_mean=0.3262 norm_overlap=0.8287 corr_cb=-0.7306
[EPOCH 036/089] train: loss=0.4196 acc=76.41% | val: loss=0.6823 acc=66.13% f1=16.00% auc=54.52% val_score=67.0905 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.269, mb=0.326, no=0.829, corr=-0.731) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 86.6951 -> 67.0905
[DBG][ep=037] disease_pos_weight=1.0000 mode=none
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.2845 mb_mean=0.3117 norm_overlap=0.7556 corr_cb=-0.7933 topkJ=0.0000
[TRAIN][ep=037] loss=0.4171 acc=75.86%
[TRAIN][ep=037] mask_avg: mc_mean=0.2690 mb_mean=0.3262 norm_overlap=0.8287 corr_cb=-0.7291
[EPOCH 037/089] train: loss=0.4171 acc=75.86% | val: loss=0.6839 acc=66.13% f1=16.00% auc=54.07% val_score=66.0133 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.269, mb=0.326, no=0.829, corr=-0.729) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 86.6951 -> 66.0133
[DBG][ep=038] disease_pos_weight=1.0000 mode=none
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2393 mb_mean=0.3360 norm_overlap=0.8885 corr_cb=-0.5858 topkJ=0.0000
[TRAIN][ep=038] loss=0.4149 acc=76.23%
[TRAIN][ep=038] mask_avg: mc_mean=0.2690 mb_mean=0.3262 norm_overlap=0.8288 corr_cb=-0.7289
[EPOCH 038/089] train: loss=0.4149 acc=76.23% | val: loss=0.6854 acc=66.13% f1=27.59% auc=54.07% val_score=66.0133 val_score_bestthr=79.3298 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.269, mb=0.326, no=0.829, corr=-0.729) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 86.6951 -> 66.0133
[DBG][ep=039] disease_pos_weight=1.0000 mode=none
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2736 mb_mean=0.3263 norm_overlap=0.8352 corr_cb=-0.7559 topkJ=0.0000
[TRAIN][ep=039] loss=0.4134 acc=76.41%
[TRAIN][ep=039] mask_avg: mc_mean=0.2690 mb_mean=0.3262 norm_overlap=0.8288 corr_cb=-0.7295
[EPOCH 039/089] train: loss=0.4134 acc=76.41% | val: loss=0.6855 acc=66.13% f1=27.59% auc=53.85% val_score=66.0133 val_score_bestthr=79.3298 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.269, mb=0.326, no=0.829, corr=-0.730) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 86.6951 -> 66.0133
[DBG][ep=040] disease_pos_weight=1.0000 mode=none
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.2817 mb_mean=0.3037 norm_overlap=0.7502 corr_cb=-0.8005 topkJ=0.0000
[TRAIN][ep=040] loss=0.4124 acc=76.23%
[TRAIN][ep=040] mask_avg: mc_mean=0.2690 mb_mean=0.3261 norm_overlap=0.8287 corr_cb=-0.7293
[EPOCH 040/089] train: loss=0.4124 acc=76.23% | val: loss=0.6876 acc=66.13% f1=27.59% auc=53.73% val_score=66.0133 val_score_bestthr=79.3298 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.269, mb=0.326, no=0.829, corr=-0.729) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 86.6951 -> 66.0133
[DBG][ep=041] disease_pos_weight=1.0000 mode=none
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.2768 mb_mean=0.3162 norm_overlap=0.7828 corr_cb=-0.7774 topkJ=0.0000
[TRAIN][ep=041] loss=0.4099 acc=76.95%
[TRAIN][ep=041] mask_avg: mc_mean=0.2690 mb_mean=0.3262 norm_overlap=0.8287 corr_cb=-0.7321
[EPOCH 041/089] train: loss=0.4099 acc=76.95% | val: loss=0.6876 acc=66.13% f1=27.59% auc=54.29% val_score=66.0133 val_score_bestthr=79.3298 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.269, mb=0.326, no=0.829, corr=-0.732) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 86.6951 -> 66.0133
[DBG][ep=042] disease_pos_weight=1.0000 mode=none
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.2600 mb_mean=0.3381 norm_overlap=0.8520 corr_cb=-0.7164 topkJ=0.0000
[TRAIN][ep=042] loss=0.4083 acc=76.59%
[TRAIN][ep=042] mask_avg: mc_mean=0.2690 mb_mean=0.3261 norm_overlap=0.8286 corr_cb=-0.7298
[EPOCH 042/089] train: loss=0.4083 acc=76.59% | val: loss=0.6869 acc=66.13% f1=27.59% auc=54.29% val_score=66.0133 val_score_bestthr=79.3298 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.269, mb=0.326, no=0.829, corr=-0.730) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 86.6951 -> 66.0133
[DBG][ep=043] disease_pos_weight=1.0000 mode=none
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.2652 mb_mean=0.3270 norm_overlap=0.8302 corr_cb=-0.7430 topkJ=0.0000
[TRAIN][ep=043] loss=0.4063 acc=76.41%
[TRAIN][ep=043] mask_avg: mc_mean=0.2690 mb_mean=0.3261 norm_overlap=0.8285 corr_cb=-0.7302
[EPOCH 043/089] train: loss=0.4063 acc=76.41% | val: loss=0.6880 acc=66.13% f1=27.59% auc=54.29% val_score=66.0133 val_score_bestthr=79.3298 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.269, mb=0.326, no=0.829, corr=-0.730) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 86.6951 -> 66.0133
[DBG][ep=044] disease_pos_weight=1.0000 mode=none
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2657 mb_mean=0.3197 norm_overlap=0.8557 corr_cb=-0.6501 topkJ=0.0000
[TRAIN][ep=044] loss=0.4047 acc=76.77%
[TRAIN][ep=044] mask_avg: mc_mean=0.2690 mb_mean=0.3262 norm_overlap=0.8285 corr_cb=-0.7302
[EPOCH 044/089] train: loss=0.4047 acc=76.77% | val: loss=0.6889 acc=66.13% f1=27.59% auc=54.29% val_score=66.0133 val_score_bestthr=79.3298 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.269, mb=0.326, no=0.828, corr=-0.730) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 86.6951 -> 66.0133
[DBG][ep=045] disease_pos_weight=1.0000 mode=none
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2641 mb_mean=0.3304 norm_overlap=0.8436 corr_cb=-0.7075 topkJ=0.0000
[TRAIN][ep=045] loss=0.4024 acc=77.13%
[TRAIN][ep=045] mask_avg: mc_mean=0.2690 mb_mean=0.3262 norm_overlap=0.8285 corr_cb=-0.7316
[EPOCH 045/089] train: loss=0.4024 acc=77.13% | val: loss=0.6886 acc=66.13% f1=27.59% auc=53.96% val_score=66.0133 val_score_bestthr=79.3298 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.269, mb=0.326, no=0.829, corr=-0.732) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 86.6951 -> 66.0133
[DBG][ep=046] disease_pos_weight=1.0000 mode=none
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.2572 mb_mean=0.3224 norm_overlap=0.8223 corr_cb=-0.7533 topkJ=0.0000
[TRAIN][ep=046] loss=0.4021 acc=76.23%
[TRAIN][ep=046] mask_avg: mc_mean=0.2690 mb_mean=0.3262 norm_overlap=0.8283 corr_cb=-0.7322
[EPOCH 046/089] train: loss=0.4021 acc=76.23% | val: loss=0.6905 acc=66.13% f1=27.59% auc=54.07% val_score=66.0133 val_score_bestthr=79.3298 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.269, mb=0.326, no=0.828, corr=-0.732) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 86.6951 -> 66.0133
[DBG][ep=047] disease_pos_weight=1.0000 mode=none
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.2658 mb_mean=0.3349 norm_overlap=0.8331 corr_cb=-0.7574 topkJ=0.0000
[TRAIN][ep=047] loss=0.4002 acc=77.68%
[TRAIN][ep=047] mask_avg: mc_mean=0.2690 mb_mean=0.3261 norm_overlap=0.8286 corr_cb=-0.7301
[EPOCH 047/089] train: loss=0.4002 acc=77.68% | val: loss=0.6899 acc=66.13% f1=32.26% auc=54.18% val_score=66.0133 val_score_bestthr=81.7416 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.269, mb=0.326, no=0.829, corr=-0.730) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 86.6951 -> 66.0133
[DBG][ep=048] disease_pos_weight=1.0000 mode=none
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.2835 mb_mean=0.3294 norm_overlap=0.8162 corr_cb=-0.7716 topkJ=0.0000
[TRAIN][ep=048] loss=0.3986 acc=76.59%
[TRAIN][ep=048] mask_avg: mc_mean=0.2690 mb_mean=0.3262 norm_overlap=0.8287 corr_cb=-0.7302
[EPOCH 048/089] train: loss=0.3986 acc=76.59% | val: loss=0.6907 acc=66.13% f1=27.59% auc=54.18% val_score=66.0133 val_score_bestthr=79.3298 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.269, mb=0.326, no=0.829, corr=-0.730) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 86.6951 -> 66.0133
[EARLY STOP] no improvement for 30 epochs. best_epoch=18
[CKPT] Loaded best for testing: results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
=============== FIT DONE ===============
[BEST] epoch=18 | val_acc=66.13% | val_f1=16.00% | val_auc=55.85% | val_score=86.6951 | val_score_bestthr=73.5795
[TEST@BEST] thr_used=0.380 | acc=66.23% f1=36.59% auc=63.21% | SP_sex=2.38% EO_sex=12.88% SP_age=20.21% EO_age=15.15%
[TIME] 0.75 min
[OK] Saved: results/ADHD_3x5fold_seed0/fold1_rep0_seed1/summary_fold_1.json
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5033 mb_mean=0.5074 norm_overlap=1.0000 corr_cb=-0.0236 topkJ=0.0769
[TRAIN][ep=000] loss=0.6876 acc=61.34%
[TRAIN][ep=000] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1035
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5043 mb_mean=0.5082 norm_overlap=1.0001 corr_cb=0.1648 topkJ=0.0737
[TRAIN][ep=001] loss=0.6755 acc=63.70%
[TRAIN][ep=001] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1054
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5022 mb_mean=0.5087 norm_overlap=1.0002 corr_cb=0.2275 topkJ=0.1455
[TRAIN][ep=002] loss=0.6656 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1043
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5035 mb_mean=0.5094 norm_overlap=1.0000 corr_cb=0.0241 topkJ=0.0509
[TRAIN][ep=003] loss=0.6594 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1050
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5028 mb_mean=0.5106 norm_overlap=1.0000 corr_cb=-0.0149 topkJ=0.0979
[TRAIN][ep=004] loss=0.6565 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1064
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5019 mb_mean=0.5085 norm_overlap=1.0001 corr_cb=0.1280 topkJ=0.1508
[TRAIN][ep=005] loss=0.6563 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1026
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5034 mb_mean=0.5096 norm_overlap=1.0001 corr_cb=0.0714 topkJ=0.1095
[TRAIN][ep=006] loss=0.6540 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1069
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5027 mb_mean=0.5084 norm_overlap=1.0001 corr_cb=0.0800 topkJ=0.0599
[TRAIN][ep=007] loss=0.6536 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1041
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5013 mb_mean=0.5071 norm_overlap=1.0002 corr_cb=0.2685 topkJ=0.0945
[TRAIN][ep=008] loss=0.6521 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1038
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5020 mb_mean=0.5111 norm_overlap=1.0000 corr_cb=0.0016 topkJ=0.0557
[TRAIN][ep=009] loss=0.6513 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1023
================= FIT START (fold=1) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.35 select_by=val_score | eval_thr_mode=best_acc eval_thr_grid=coarse | disease_pos_weight_mode=none freeze_b_after=15 | two_stage=True stage1_ratio=0.35 stage2_lr_mult=0.3 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5045 mb_mean=0.5109 norm_overlap=1.0000 corr_cb=0.0362 topkJ=0.0638
[TRAIN][ep=000] loss=0.6500 acc=63.70%
[TRAIN][ep=000] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1077
[EPOCH 000/089] train: loss=0.6500 acc=63.70% | val: loss=0.6577 acc=62.90% f1=0.00% auc=54.96% val_score=72.0763 val_score_bestthr=62.9032 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.503, mb=0.509, no=1.000, corr=0.108) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* -1000000000000000000.0000 -> 72.0763
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5043 mb_mean=0.5100 norm_overlap=1.0000 corr_cb=-0.0050 topkJ=0.0422
[TRAIN][ep=001] loss=0.6489 acc=63.70%
[TRAIN][ep=001] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1086
[EPOCH 001/089] train: loss=0.6489 acc=63.70% | val: loss=0.6572 acc=64.52% f1=38.89% auc=56.08% val_score=70.1231 val_score_bestthr=83.2578 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.503, mb=0.509, no=1.000, corr=0.109) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 72.0763 -> 70.1231
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5004 mb_mean=0.5099 norm_overlap=1.0001 corr_cb=0.2004 topkJ=0.1277
[TRAIN][ep=002] loss=0.6480 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1068
[EPOCH 002/089] train: loss=0.6480 acc=63.70% | val: loss=0.6569 acc=62.90% f1=30.30% auc=56.19% val_score=74.6247 val_score_bestthr=77.4480 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.503, mb=0.509, no=1.000, corr=0.107) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 72.0763 -> 74.6247
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5013 mb_mean=0.5096 norm_overlap=1.0001 corr_cb=0.1039 topkJ=0.0703
[TRAIN][ep=003] loss=0.6465 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1068
[EPOCH 003/089] train: loss=0.6465 acc=63.70% | val: loss=0.6568 acc=64.52% f1=38.89% auc=57.08% val_score=75.4593 val_score_bestthr=83.2578 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.503, mb=0.509, no=1.000, corr=0.107) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 74.6247 -> 75.4593
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.0595 topkJ=0.0573
[TRAIN][ep=004] loss=0.6452 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1040
[EPOCH 004/089] train: loss=0.6452 acc=63.70% | val: loss=0.6559 acc=66.13% f1=43.24% auc=57.75% val_score=65.9529 val_score_bestthr=87.0247 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.503, mb=0.509, no=1.000, corr=0.104) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 75.4593 -> 65.9529
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5024 mb_mean=0.5096 norm_overlap=1.0000 corr_cb=0.0125 topkJ=0.1126
[TRAIN][ep=005] loss=1.8927 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.4939 mb_mean=0.4964 norm_overlap=1.0002 corr_cb=0.1390
[EPOCH 005/089] train: loss=1.8927 acc=63.70% | val: loss=0.6564 acc=66.13% f1=43.24% auc=57.30% val_score=74.7947 val_score_bestthr=87.0247 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.494, mb=0.496, no=1.000, corr=0.139) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 75.4593 -> 74.7947
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4844 mb_mean=0.4822 norm_overlap=1.0004 corr_cb=0.2410 topkJ=0.0786
[TRAIN][ep=006] loss=1.8911 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.4767 mb_mean=0.4681 norm_overlap=1.0007 corr_cb=0.2656
[EPOCH 006/089] train: loss=1.8911 acc=63.70% | val: loss=0.6567 acc=69.35% f1=53.66% auc=58.08% val_score=72.8728 val_score_bestthr=95.0291 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.477, mb=0.468, no=1.001, corr=0.266) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 75.4593 -> 72.8728
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4676 mb_mean=0.4527 norm_overlap=1.0011 corr_cb=0.2891 topkJ=0.1153
[TRAIN][ep=007] loss=1.8856 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.4594 mb_mean=0.4362 norm_overlap=1.0022 corr_cb=0.4240
[EPOCH 007/089] train: loss=1.8856 acc=63.70% | val: loss=0.6563 acc=64.52% f1=50.00% auc=57.97% val_score=72.8728 val_score_bestthr=88.4099 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.459, mb=0.436, no=1.002, corr=0.424) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 75.4593 -> 72.8728
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4505 mb_mean=0.4263 norm_overlap=1.0038 corr_cb=0.4748 topkJ=0.1969
[TRAIN][ep=008] loss=1.8810 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.4424 mb_mean=0.4035 norm_overlap=1.0043 corr_cb=0.4689
[EPOCH 008/089] train: loss=1.8810 acc=63.70% | val: loss=0.6559 acc=66.13% f1=43.24% auc=58.08% val_score=71.9285 val_score_bestthr=87.0247 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.442, mb=0.403, no=1.004, corr=0.469) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 75.4593 -> 71.9285
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4349 mb_mean=0.3900 norm_overlap=1.0044 corr_cb=0.4882 topkJ=0.2274
[TRAIN][ep=009] loss=1.8751 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.4259 mb_mean=0.3730 norm_overlap=1.0061 corr_cb=0.4063
[EPOCH 009/089] train: loss=1.8751 acc=63.70% | val: loss=0.6560 acc=64.52% f1=50.00% auc=58.08% val_score=75.9395 val_score_bestthr=88.5630 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.426, mb=0.373, no=1.006, corr=0.406) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 75.4593 -> 75.9395
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=010] disease_pos_weight=1.0000 mode=none
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.4233 mb_mean=0.3753 norm_overlap=1.0064 corr_cb=0.3894 topkJ=0.1674
[TRAIN][ep=010] loss=1.8667 acc=63.70%
[TRAIN][ep=010] mask_avg: mc_mean=0.4105 mb_mean=0.3465 norm_overlap=1.0062 corr_cb=0.2682
[EPOCH 010/089] train: loss=1.8667 acc=63.70% | val: loss=0.6554 acc=66.13% f1=36.36% auc=58.97% val_score=62.8082 val_score_bestthr=83.7543 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.410, mb=0.347, no=1.006, corr=0.268) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 75.9395 -> 62.8082
[DBG][ep=011] disease_pos_weight=1.0000 mode=none
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.3950 mb_mean=0.3141 norm_overlap=1.0145 corr_cb=0.3058 topkJ=0.0997
[TRAIN][ep=011] loss=1.8622 acc=63.70%
[TRAIN][ep=011] mask_avg: mc_mean=0.3950 mb_mean=0.3251 norm_overlap=1.0014 corr_cb=0.0425
[EPOCH 011/089] train: loss=1.8622 acc=63.70% | val: loss=0.6555 acc=64.52% f1=52.17% auc=58.64% val_score=71.8035 val_score_bestthr=89.7162 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.395, mb=0.325, no=1.001, corr=0.043) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 75.9395 -> 71.8035
[DBG][ep=012] disease_pos_weight=1.0000 mode=none
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.3905 mb_mean=0.3213 norm_overlap=0.9947 corr_cb=-0.1408 topkJ=0.0759
[TRAIN][ep=012] loss=1.2722 acc=63.70%
[TRAIN][ep=012] mask_avg: mc_mean=0.3800 mb_mean=0.3098 norm_overlap=0.9909 corr_cb=-0.1668
[EPOCH 012/089] train: loss=1.2722 acc=63.70% | val: loss=0.6554 acc=64.52% f1=52.17% auc=57.97% val_score=77.8739 val_score_bestthr=89.7162 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.380, mb=0.310, no=0.991, corr=-0.167) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 75.9395 -> 77.8739
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=013] disease_pos_weight=1.0000 mode=none
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.3794 mb_mean=0.3059 norm_overlap=0.9848 corr_cb=-0.2876 topkJ=0.0358
[TRAIN][ep=013] loss=0.6767 acc=63.70%
[TRAIN][ep=013] mask_avg: mc_mean=0.3651 mb_mean=0.2985 norm_overlap=0.9648 corr_cb=-0.4295
[EPOCH 013/089] train: loss=0.6767 acc=63.70% | val: loss=0.6554 acc=64.52% f1=52.17% auc=57.08% val_score=77.9824 val_score_bestthr=89.7320 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.365, mb=0.298, no=0.965, corr=-0.429) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 77.8739 -> 77.9824
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=014] disease_pos_weight=1.0000 mode=none
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.3537 mb_mean=0.3023 norm_overlap=0.9421 corr_cb=-0.5939 topkJ=0.0004
[TRAIN][ep=014] loss=0.5552 acc=63.70%
[TRAIN][ep=014] mask_avg: mc_mean=0.3483 mb_mean=0.2916 norm_overlap=0.9090 corr_cb=-0.6700
[EPOCH 014/089] train: loss=0.5552 acc=63.70% | val: loss=0.6548 acc=64.52% f1=50.00% auc=56.97% val_score=75.9805 val_score_bestthr=88.8197 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.348, mb=0.292, no=0.909, corr=-0.670) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 77.9824 -> 75.9805
[DBG][ep=015] disease_pos_weight=1.0000 mode=none
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.3389 mb_mean=0.2851 norm_overlap=0.8656 corr_cb=-0.7869 topkJ=0.0000
[TRAIN][ep=015] loss=0.5325 acc=63.70%
[TRAIN][ep=015] mask_avg: mc_mean=0.3297 mb_mean=0.2898 norm_overlap=0.8372 corr_cb=-0.7982
[EPOCH 015/089] train: loss=0.5325 acc=63.70% | val: loss=0.6545 acc=66.13% f1=16.00% auc=55.63% val_score=78.0253 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.330, mb=0.290, no=0.837, corr=-0.798) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=* 77.9824 -> 78.0253
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=016] disease_pos_weight=1.0000 mode=none
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.3179 mb_mean=0.2873 norm_overlap=0.8015 corr_cb=-0.8434 topkJ=0.0000
[TRAIN][ep=016] loss=0.5223 acc=64.07%
[TRAIN][ep=016] mask_avg: mc_mean=0.3146 mb_mean=0.2898 norm_overlap=0.7879 corr_cb=-0.8346
[EPOCH 016/089] train: loss=0.5223 acc=64.07% | val: loss=0.6551 acc=66.13% f1=48.78% auc=56.08% val_score=71.9761 val_score_bestthr=89.7178 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.315, mb=0.290, no=0.788, corr=-0.835) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 78.0253 -> 71.9761
[DBG][ep=017] disease_pos_weight=1.0000 mode=none
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.3092 mb_mean=0.2978 norm_overlap=0.7612 corr_cb=-0.8558 topkJ=0.0000
[TRAIN][ep=017] loss=0.5103 acc=65.70%
[TRAIN][ep=017] mask_avg: mc_mean=0.3049 mb_mean=0.2898 norm_overlap=0.7425 corr_cb=-0.8581
[EPOCH 017/089] train: loss=0.5103 acc=65.70% | val: loss=0.6578 acc=66.13% f1=48.78% auc=56.97% val_score=81.2197 val_score_bestthr=89.6553 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.305, mb=0.290, no=0.742, corr=-0.858) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=* 78.0253 -> 81.2197
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=018] disease_pos_weight=1.0000 mode=none
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.2951 mb_mean=0.2981 norm_overlap=0.7819 corr_cb=-0.8329 topkJ=0.0000
[TRAIN][ep=018] loss=0.5039 acc=66.42%
[TRAIN][ep=018] mask_avg: mc_mean=0.2995 mb_mean=0.2898 norm_overlap=0.7031 corr_cb=-0.8753
[EPOCH 018/089] train: loss=0.5039 acc=66.42% | val: loss=0.6608 acc=66.13% f1=46.15% auc=55.30% val_score=77.0920 val_score_bestthr=88.6735 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.300, mb=0.290, no=0.703, corr=-0.875) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 81.2197 -> 77.0920
[DBG][ep=019] disease_pos_weight=1.0000 mode=none
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.3010 mb_mean=0.2943 norm_overlap=0.7382 corr_cb=-0.8764 topkJ=0.0000
[TRAIN][ep=019] loss=0.4897 acc=67.51%
[TRAIN][ep=019] mask_avg: mc_mean=0.2984 mb_mean=0.2899 norm_overlap=0.6703 corr_cb=-0.8874
[EPOCH 019/089] train: loss=0.4897 acc=67.51% | val: loss=0.6651 acc=66.13% f1=46.15% auc=55.07% val_score=67.1084 val_score_bestthr=88.6735 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.298, mb=0.290, no=0.670, corr=-0.887) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 81.2197 -> 67.1084
[DBG][ep=020] disease_pos_weight=1.0000 mode=none
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.3079 mb_mean=0.2896 norm_overlap=0.6263 corr_cb=-0.9069 topkJ=0.0000
[TRAIN][ep=020] loss=0.4822 acc=68.06%
[TRAIN][ep=020] mask_avg: mc_mean=0.2978 mb_mean=0.2898 norm_overlap=0.6443 corr_cb=-0.8909
[EPOCH 020/089] train: loss=0.4822 acc=68.06% | val: loss=0.6697 acc=66.13% f1=46.15% auc=54.74% val_score=67.1084 val_score_bestthr=88.6735 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.298, mb=0.290, no=0.644, corr=-0.891) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 81.2197 -> 67.1084
[DBG][ep=021] disease_pos_weight=1.0000 mode=none
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2948 mb_mean=0.2882 norm_overlap=0.6082 corr_cb=-0.9088 topkJ=0.0000
[TRAIN][ep=021] loss=0.4725 acc=70.24%
[TRAIN][ep=021] mask_avg: mc_mean=0.2990 mb_mean=0.2898 norm_overlap=0.6222 corr_cb=-0.8958
[EPOCH 021/089] train: loss=0.4725 acc=70.24% | val: loss=0.6737 acc=66.13% f1=46.15% auc=54.18% val_score=73.0327 val_score_bestthr=88.6735 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.299, mb=0.290, no=0.622, corr=-0.896) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 81.2197 -> 73.0327
[DBG][ep=022] disease_pos_weight=1.0000 mode=none
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.3033 mb_mean=0.2853 norm_overlap=0.6162 corr_cb=-0.8968 topkJ=0.0000
[TRAIN][ep=022] loss=0.4642 acc=69.51%
[TRAIN][ep=022] mask_avg: mc_mean=0.2974 mb_mean=0.2898 norm_overlap=0.6084 corr_cb=-0.8943
[EPOCH 022/089] train: loss=0.4642 acc=69.51% | val: loss=0.6748 acc=64.52% f1=45.00% auc=54.07% val_score=75.0210 val_score_bestthr=86.4610 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.297, mb=0.290, no=0.608, corr=-0.894) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 81.2197 -> 75.0210
[DBG][ep=023] disease_pos_weight=1.0000 mode=none
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2941 mb_mean=0.2946 norm_overlap=0.6031 corr_cb=-0.8913 topkJ=0.0000
[TRAIN][ep=023] loss=0.4564 acc=70.96%
[TRAIN][ep=023] mask_avg: mc_mean=0.2978 mb_mean=0.2898 norm_overlap=0.5942 corr_cb=-0.8940
[EPOCH 023/089] train: loss=0.4564 acc=70.96% | val: loss=0.6822 acc=64.52% f1=42.11% auc=54.40% val_score=78.1910 val_score_bestthr=85.2160 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.298, mb=0.290, no=0.594, corr=-0.894) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 81.2197 -> 78.1910
[DBG][ep=024] disease_pos_weight=1.0000 mode=none
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.3103 mb_mean=0.2786 norm_overlap=0.5836 corr_cb=-0.8808 topkJ=0.0000
[TRAIN][ep=024] loss=0.4473 acc=70.42%
[TRAIN][ep=024] mask_avg: mc_mean=0.2944 mb_mean=0.2898 norm_overlap=0.5834 corr_cb=-0.8905
[EPOCH 024/089] train: loss=0.4473 acc=70.42% | val: loss=0.6848 acc=64.52% f1=45.00% auc=53.29% val_score=67.9965 val_score_bestthr=86.5291 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.294, mb=0.290, no=0.583, corr=-0.891) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 81.2197 -> 67.9965
[DBG][ep=025] disease_pos_weight=1.0000 mode=none
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2727 mb_mean=0.3004 norm_overlap=0.6981 corr_cb=-0.7918 topkJ=0.0000
[TRAIN][ep=025] loss=0.4465 acc=71.14%
[TRAIN][ep=025] mask_avg: mc_mean=0.2945 mb_mean=0.2898 norm_overlap=0.5744 corr_cb=-0.8885
[EPOCH 025/089] train: loss=0.4465 acc=71.14% | val: loss=0.6839 acc=64.52% f1=42.11% auc=53.73% val_score=67.9965 val_score_bestthr=85.2160 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.294, mb=0.290, no=0.574, corr=-0.889) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 81.2197 -> 67.9965
[DBG][ep=026] disease_pos_weight=1.0000 mode=none
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2883 mb_mean=0.2842 norm_overlap=0.5137 corr_cb=-0.8917 topkJ=0.0000
[TRAIN][ep=026] loss=0.4365 acc=72.23%
[TRAIN][ep=026] mask_avg: mc_mean=0.2909 mb_mean=0.2898 norm_overlap=0.5668 corr_cb=-0.8878
[EPOCH 026/089] train: loss=0.4365 acc=72.23% | val: loss=0.6875 acc=64.52% f1=45.00% auc=54.63% val_score=69.1138 val_score_bestthr=86.4610 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.291, mb=0.290, no=0.567, corr=-0.888) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 81.2197 -> 69.1138
[DBG][ep=027] disease_pos_weight=1.0000 mode=none
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2877 mb_mean=0.3027 norm_overlap=0.6095 corr_cb=-0.9001 topkJ=0.0000
[TRAIN][ep=027] loss=0.4283 acc=72.60%
[TRAIN][ep=027] mask_avg: mc_mean=0.2898 mb_mean=0.2898 norm_overlap=0.5605 corr_cb=-0.8854
[EPOCH 027/089] train: loss=0.4283 acc=72.60% | val: loss=0.6877 acc=66.13% f1=16.00% auc=53.18% val_score=71.0401 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.290, mb=0.290, no=0.560, corr=-0.885) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 81.2197 -> 71.0401
[DBG][ep=028] disease_pos_weight=1.0000 mode=none
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2816 mb_mean=0.2970 norm_overlap=0.5640 corr_cb=-0.8947 topkJ=0.0000
[TRAIN][ep=028] loss=0.4223 acc=72.78%
[TRAIN][ep=028] mask_avg: mc_mean=0.2884 mb_mean=0.2898 norm_overlap=0.5518 corr_cb=-0.8850
[EPOCH 028/089] train: loss=0.4223 acc=72.78% | val: loss=0.6893 acc=66.13% f1=16.00% auc=53.96% val_score=69.0149 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.288, mb=0.290, no=0.552, corr=-0.885) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 81.2197 -> 69.0149
[DBG][ep=029] disease_pos_weight=1.0000 mode=none
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2697 mb_mean=0.2793 norm_overlap=0.5536 corr_cb=-0.8166 topkJ=0.0000
[TRAIN][ep=029] loss=0.4110 acc=75.32%
[TRAIN][ep=029] mask_avg: mc_mean=0.2839 mb_mean=0.2898 norm_overlap=0.5466 corr_cb=-0.8803
[EPOCH 029/089] train: loss=0.4110 acc=75.32% | val: loss=0.6895 acc=66.13% f1=16.00% auc=54.29% val_score=69.0149 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.284, mb=0.290, no=0.547, corr=-0.880) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 81.2197 -> 69.0149
[DBG][ep=030] disease_pos_weight=1.0000 mode=none
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2722 mb_mean=0.3072 norm_overlap=0.5435 corr_cb=-0.8814 topkJ=0.0000
[TRAIN][ep=030] loss=0.4036 acc=74.59%
[TRAIN][ep=030] mask_avg: mc_mean=0.2829 mb_mean=0.2898 norm_overlap=0.5417 corr_cb=-0.8765
[EPOCH 030/089] train: loss=0.4036 acc=74.59% | val: loss=0.6922 acc=66.13% f1=32.26% auc=53.85% val_score=71.0401 val_score_bestthr=81.7416 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.283, mb=0.290, no=0.542, corr=-0.876) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 81.2197 -> 71.0401
[DBG][ep=031] disease_pos_weight=1.0000 mode=none
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2935 mb_mean=0.2818 norm_overlap=0.4489 corr_cb=-0.9100 topkJ=0.0000
[TRAIN][ep=031] loss=0.3930 acc=75.50%
[TRAIN][ep=031] mask_avg: mc_mean=0.2826 mb_mean=0.2899 norm_overlap=0.5395 corr_cb=-0.8741
[EPOCH 031/089] train: loss=0.3930 acc=75.50% | val: loss=0.6929 acc=66.13% f1=32.26% auc=53.96% val_score=71.0401 val_score_bestthr=81.7416 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.283, mb=0.290, no=0.539, corr=-0.874) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 81.2197 -> 71.0401
[DBG][ep=032] disease_pos_weight=1.0000 mode=none
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2658 mb_mean=0.2979 norm_overlap=0.6287 corr_cb=-0.8627 topkJ=0.0000
[TRAIN][ep=032] loss=0.3930 acc=75.32%
[TRAIN][ep=032] mask_avg: mc_mean=0.2826 mb_mean=0.2898 norm_overlap=0.5395 corr_cb=-0.8736
[EPOCH 032/089] train: loss=0.3930 acc=75.32% | val: loss=0.6923 acc=66.13% f1=32.26% auc=53.73% val_score=71.0401 val_score_bestthr=81.7416 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.283, mb=0.290, no=0.540, corr=-0.874) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 81.2197 -> 71.0401
[DBG][ep=033] disease_pos_weight=1.0000 mode=none
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2975 mb_mean=0.2834 norm_overlap=0.5047 corr_cb=-0.8481 topkJ=0.0000
[TRAIN][ep=033] loss=0.3901 acc=76.23%
[TRAIN][ep=033] mask_avg: mc_mean=0.2826 mb_mean=0.2898 norm_overlap=0.5393 corr_cb=-0.8741
[EPOCH 033/089] train: loss=0.3901 acc=76.23% | val: loss=0.6933 acc=66.13% f1=16.00% auc=53.73% val_score=71.0401 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.283, mb=0.290, no=0.539, corr=-0.874) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 81.2197 -> 71.0401
[DBG][ep=034] disease_pos_weight=1.0000 mode=none
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2731 mb_mean=0.2936 norm_overlap=0.5875 corr_cb=-0.8648 topkJ=0.0000
[TRAIN][ep=034] loss=0.3879 acc=76.41%
[TRAIN][ep=034] mask_avg: mc_mean=0.2826 mb_mean=0.2898 norm_overlap=0.5392 corr_cb=-0.8745
[EPOCH 034/089] train: loss=0.3879 acc=76.41% | val: loss=0.6945 acc=66.13% f1=32.26% auc=54.29% val_score=71.0401 val_score_bestthr=81.7416 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.283, mb=0.290, no=0.539, corr=-0.875) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 81.2197 -> 71.0401
[DBG][ep=035] disease_pos_weight=1.0000 mode=none
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2605 mb_mean=0.3078 norm_overlap=0.6157 corr_cb=-0.8531 topkJ=0.0000
[TRAIN][ep=035] loss=0.3874 acc=76.59%
[TRAIN][ep=035] mask_avg: mc_mean=0.2826 mb_mean=0.2898 norm_overlap=0.5391 corr_cb=-0.8744
[EPOCH 035/089] train: loss=0.3874 acc=76.59% | val: loss=0.6935 acc=66.13% f1=32.26% auc=53.62% val_score=71.0401 val_score_bestthr=81.7416 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.283, mb=0.290, no=0.539, corr=-0.874) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 81.2197 -> 71.0401
[DBG][ep=036] disease_pos_weight=1.0000 mode=none
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2859 mb_mean=0.3008 norm_overlap=0.5672 corr_cb=-0.9007 topkJ=0.0000
[TRAIN][ep=036] loss=0.3855 acc=76.23%
[TRAIN][ep=036] mask_avg: mc_mean=0.2826 mb_mean=0.2898 norm_overlap=0.5393 corr_cb=-0.8745
[EPOCH 036/089] train: loss=0.3855 acc=76.23% | val: loss=0.6936 acc=66.13% f1=16.00% auc=54.07% val_score=69.0275 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.283, mb=0.290, no=0.539, corr=-0.875) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 81.2197 -> 69.0275
[DBG][ep=037] disease_pos_weight=1.0000 mode=none
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.3043 mb_mean=0.2832 norm_overlap=0.4529 corr_cb=-0.9082 topkJ=0.0000
[TRAIN][ep=037] loss=0.3827 acc=76.77%
[TRAIN][ep=037] mask_avg: mc_mean=0.2826 mb_mean=0.2898 norm_overlap=0.5396 corr_cb=-0.8738
[EPOCH 037/089] train: loss=0.3827 acc=76.77% | val: loss=0.6943 acc=67.74% f1=33.33% auc=54.74% val_score=71.0401 val_score_bestthr=83.8366 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.283, mb=0.290, no=0.540, corr=-0.874) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 81.2197 -> 71.0401
[DBG][ep=038] disease_pos_weight=1.0000 mode=none
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2434 mb_mean=0.2989 norm_overlap=0.6411 corr_cb=-0.7992 topkJ=0.0000
[TRAIN][ep=038] loss=0.3807 acc=76.41%
[TRAIN][ep=038] mask_avg: mc_mean=0.2826 mb_mean=0.2898 norm_overlap=0.5398 corr_cb=-0.8735
[EPOCH 038/089] train: loss=0.3807 acc=76.41% | val: loss=0.6961 acc=66.13% f1=27.59% auc=55.07% val_score=71.0401 val_score_bestthr=79.0974 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.283, mb=0.290, no=0.540, corr=-0.873) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 81.2197 -> 71.0401
[DBG][ep=039] disease_pos_weight=1.0000 mode=none
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2920 mb_mean=0.2904 norm_overlap=0.5316 corr_cb=-0.9125 topkJ=0.0000
[TRAIN][ep=039] loss=0.3794 acc=76.77%
[TRAIN][ep=039] mask_avg: mc_mean=0.2826 mb_mean=0.2898 norm_overlap=0.5398 corr_cb=-0.8739
[EPOCH 039/089] train: loss=0.3794 acc=76.77% | val: loss=0.6951 acc=66.13% f1=27.59% auc=54.63% val_score=71.0401 val_score_bestthr=79.0974 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.283, mb=0.290, no=0.540, corr=-0.874) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 81.2197 -> 71.0401
[DBG][ep=040] disease_pos_weight=1.0000 mode=none
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.3047 mb_mean=0.2727 norm_overlap=0.4204 corr_cb=-0.8966 topkJ=0.0000
[TRAIN][ep=040] loss=0.3786 acc=76.23%
[TRAIN][ep=040] mask_avg: mc_mean=0.2826 mb_mean=0.2898 norm_overlap=0.5395 corr_cb=-0.8740
[EPOCH 040/089] train: loss=0.3786 acc=76.23% | val: loss=0.6971 acc=67.74% f1=28.57% auc=55.96% val_score=73.0423 val_score_bestthr=81.2881 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.283, mb=0.290, no=0.539, corr=-0.874) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 81.2197 -> 73.0423
[DBG][ep=041] disease_pos_weight=1.0000 mode=none
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.2981 mb_mean=0.2867 norm_overlap=0.4728 corr_cb=-0.9008 topkJ=0.0000
[TRAIN][ep=041] loss=0.3758 acc=77.31%
[TRAIN][ep=041] mask_avg: mc_mean=0.2826 mb_mean=0.2898 norm_overlap=0.5391 corr_cb=-0.8755
[EPOCH 041/089] train: loss=0.3758 acc=77.31% | val: loss=0.6978 acc=67.74% f1=28.57% auc=55.30% val_score=71.0401 val_score_bestthr=81.2881 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.283, mb=0.290, no=0.539, corr=-0.876) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 81.2197 -> 71.0401
[DBG][ep=042] disease_pos_weight=1.0000 mode=none
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.2716 mb_mean=0.3060 norm_overlap=0.5767 corr_cb=-0.8830 topkJ=0.0000
[TRAIN][ep=042] loss=0.3744 acc=77.13%
[TRAIN][ep=042] mask_avg: mc_mean=0.2826 mb_mean=0.2898 norm_overlap=0.5392 corr_cb=-0.8739
[EPOCH 042/089] train: loss=0.3744 acc=77.13% | val: loss=0.6968 acc=67.74% f1=28.57% auc=55.18% val_score=71.0401 val_score_bestthr=81.2881 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.283, mb=0.290, no=0.539, corr=-0.874) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 81.2197 -> 71.0401
[DBG][ep=043] disease_pos_weight=1.0000 mode=none
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.2779 mb_mean=0.2970 norm_overlap=0.5209 corr_cb=-0.9054 topkJ=0.0000
[TRAIN][ep=043] loss=0.3722 acc=77.13%
[TRAIN][ep=043] mask_avg: mc_mean=0.2826 mb_mean=0.2898 norm_overlap=0.5393 corr_cb=-0.8738
[EPOCH 043/089] train: loss=0.3722 acc=77.13% | val: loss=0.6972 acc=67.74% f1=28.57% auc=55.52% val_score=71.0401 val_score_bestthr=81.2881 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.283, mb=0.290, no=0.539, corr=-0.874) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 81.2197 -> 71.0401
[DBG][ep=044] disease_pos_weight=1.0000 mode=none
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2805 mb_mean=0.2754 norm_overlap=0.5872 corr_cb=-0.8204 topkJ=0.0000
[TRAIN][ep=044] loss=0.3707 acc=77.13%
[TRAIN][ep=044] mask_avg: mc_mean=0.2826 mb_mean=0.2898 norm_overlap=0.5395 corr_cb=-0.8739
[EPOCH 044/089] train: loss=0.3707 acc=77.13% | val: loss=0.6979 acc=67.74% f1=28.57% auc=55.52% val_score=71.0401 val_score_bestthr=81.2881 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.283, mb=0.290, no=0.540, corr=-0.874) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 81.2197 -> 71.0401
[DBG][ep=045] disease_pos_weight=1.0000 mode=none
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2709 mb_mean=0.2897 norm_overlap=0.5821 corr_cb=-0.8282 topkJ=0.0000
[TRAIN][ep=045] loss=0.3684 acc=77.68%
[TRAIN][ep=045] mask_avg: mc_mean=0.2826 mb_mean=0.2898 norm_overlap=0.5387 corr_cb=-0.8753
[EPOCH 045/089] train: loss=0.3684 acc=77.68% | val: loss=0.6978 acc=67.74% f1=28.57% auc=55.63% val_score=67.0614 val_score_bestthr=81.2881 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.283, mb=0.290, no=0.539, corr=-0.875) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 81.2197 -> 67.0614
[DBG][ep=046] disease_pos_weight=1.0000 mode=none
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.2710 mb_mean=0.2879 norm_overlap=0.5226 corr_cb=-0.8724 topkJ=0.0000
[TRAIN][ep=046] loss=0.3684 acc=77.86%
[TRAIN][ep=046] mask_avg: mc_mean=0.2826 mb_mean=0.2898 norm_overlap=0.5388 corr_cb=-0.8750
[EPOCH 046/089] train: loss=0.3684 acc=77.86% | val: loss=0.6991 acc=66.13% f1=36.36% auc=55.96% val_score=71.0401 val_score_bestthr=83.8128 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.283, mb=0.290, no=0.539, corr=-0.875) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 81.2197 -> 71.0401
[DBG][ep=047] disease_pos_weight=1.0000 mode=none
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.2800 mb_mean=0.2993 norm_overlap=0.5498 corr_cb=-0.8847 topkJ=0.0000
[TRAIN][ep=047] loss=0.3662 acc=77.31%
[TRAIN][ep=047] mask_avg: mc_mean=0.2826 mb_mean=0.2898 norm_overlap=0.5392 corr_cb=-0.8742
[EPOCH 047/089] train: loss=0.3662 acc=77.31% | val: loss=0.6983 acc=67.74% f1=28.57% auc=55.63% val_score=67.0614 val_score_bestthr=81.2881 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.283, mb=0.290, no=0.539, corr=-0.874) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 81.2197 -> 67.0614
[EARLY STOP] no improvement for 30 epochs. best_epoch=17
[CKPT] Loaded best for testing: results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
=============== FIT DONE ===============
[BEST] epoch=17 | val_acc=66.13% | val_f1=48.78% | val_auc=56.97% | val_score=81.2197 | val_score_bestthr=89.6553
[TEST@BEST] thr_used=0.430 | acc=66.88% f1=26.09% auc=63.19% | SP_sex=2.91% EO_sex=9.85% SP_age=10.59% EO_age=28.57%
[TIME] 0.82 min
[OK] Saved: results/ADHD_3x5fold_seed0/fold1_rep0_seed1/summary_fold_1.json
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5033 mb_mean=0.5074 norm_overlap=1.0000 corr_cb=-0.0236 topkJ=0.0769
[TRAIN][ep=000] loss=0.6876 acc=61.34%
[TRAIN][ep=000] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1035
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5043 mb_mean=0.5082 norm_overlap=1.0001 corr_cb=0.1648 topkJ=0.0737
[TRAIN][ep=001] loss=0.6755 acc=63.70%
[TRAIN][ep=001] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1054
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5022 mb_mean=0.5087 norm_overlap=1.0002 corr_cb=0.2275 topkJ=0.1455
[TRAIN][ep=002] loss=0.6656 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1043
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5035 mb_mean=0.5094 norm_overlap=1.0000 corr_cb=0.0241 topkJ=0.0509
[TRAIN][ep=003] loss=0.6594 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1050
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5028 mb_mean=0.5106 norm_overlap=1.0000 corr_cb=-0.0149 topkJ=0.0979
[TRAIN][ep=004] loss=0.6565 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1064
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5019 mb_mean=0.5085 norm_overlap=1.0001 corr_cb=0.1280 topkJ=0.1508
[TRAIN][ep=005] loss=0.6563 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1026
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5034 mb_mean=0.5096 norm_overlap=1.0001 corr_cb=0.0714 topkJ=0.1095
[TRAIN][ep=006] loss=0.6540 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1069
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5027 mb_mean=0.5084 norm_overlap=1.0001 corr_cb=0.0800 topkJ=0.0599
[TRAIN][ep=007] loss=0.6536 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1041
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5013 mb_mean=0.5071 norm_overlap=1.0002 corr_cb=0.2685 topkJ=0.0945
[TRAIN][ep=008] loss=0.6521 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1038
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5020 mb_mean=0.5111 norm_overlap=1.0000 corr_cb=0.0016 topkJ=0.0557
[TRAIN][ep=009] loss=0.6513 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1023
================= FIT START (fold=1) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.35 select_by=val_score | eval_thr_mode=best_acc eval_thr_grid=coarse | disease_pos_weight_mode=none freeze_b_after=15 | two_stage=True stage1_ratio=0.35 stage2_lr_mult=0.3 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5045 mb_mean=0.5109 norm_overlap=1.0000 corr_cb=0.0362 topkJ=0.0638
[TRAIN][ep=000] loss=0.6500 acc=63.70%
[TRAIN][ep=000] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1077
[EPOCH 000/089] train: loss=0.6500 acc=63.70% | val: loss=0.6577 acc=62.90% f1=0.00% auc=54.96% val_score=72.0763 val_score_bestthr=62.9032 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.503, mb=0.509, no=1.000, corr=0.108) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* -1000000000000000000.0000 -> 72.0763
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5043 mb_mean=0.5100 norm_overlap=1.0000 corr_cb=-0.0050 topkJ=0.0422
[TRAIN][ep=001] loss=0.6489 acc=63.70%
[TRAIN][ep=001] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1086
[EPOCH 001/089] train: loss=0.6489 acc=63.70% | val: loss=0.6572 acc=64.52% f1=38.89% auc=56.08% val_score=70.1231 val_score_bestthr=83.2578 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.503, mb=0.509, no=1.000, corr=0.109) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 72.0763 -> 70.1231
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5004 mb_mean=0.5099 norm_overlap=1.0001 corr_cb=0.2004 topkJ=0.1277
[TRAIN][ep=002] loss=0.6480 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1068
[EPOCH 002/089] train: loss=0.6480 acc=63.70% | val: loss=0.6569 acc=62.90% f1=30.30% auc=56.19% val_score=74.6247 val_score_bestthr=77.4480 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.503, mb=0.509, no=1.000, corr=0.107) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 72.0763 -> 74.6247
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5013 mb_mean=0.5096 norm_overlap=1.0001 corr_cb=0.1039 topkJ=0.0703
[TRAIN][ep=003] loss=0.6465 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1068
[EPOCH 003/089] train: loss=0.6465 acc=63.70% | val: loss=0.6568 acc=64.52% f1=38.89% auc=57.08% val_score=75.4593 val_score_bestthr=83.2578 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.503, mb=0.509, no=1.000, corr=0.107) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 74.6247 -> 75.4593
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.0595 topkJ=0.0573
[TRAIN][ep=004] loss=0.6452 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1040
[EPOCH 004/089] train: loss=0.6452 acc=63.70% | val: loss=0.6559 acc=66.13% f1=43.24% auc=57.75% val_score=65.9529 val_score_bestthr=87.0247 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.503, mb=0.509, no=1.000, corr=0.104) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 75.4593 -> 65.9529
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5024 mb_mean=0.5096 norm_overlap=1.0000 corr_cb=0.0125 topkJ=0.1126
[TRAIN][ep=005] loss=2.1370 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.4942 mb_mean=0.4996 norm_overlap=1.0001 corr_cb=0.1035
[EPOCH 005/089] train: loss=2.1370 acc=63.70% | val: loss=0.6565 acc=66.13% f1=43.24% auc=57.41% val_score=76.7733 val_score_bestthr=87.0247 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.494, mb=0.500, no=1.000, corr=0.103) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 75.4593 -> 76.7733
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4849 mb_mean=0.4888 norm_overlap=1.0002 corr_cb=0.1761 topkJ=0.0634
[TRAIN][ep=006] loss=2.1267 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.4773 mb_mean=0.4779 norm_overlap=1.0004 corr_cb=0.1906
[EPOCH 006/089] train: loss=2.1267 acc=63.70% | val: loss=0.6568 acc=67.74% f1=50.00% auc=57.97% val_score=74.8509 val_score_bestthr=91.6142 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.477, mb=0.478, no=1.000, corr=0.191) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.7733 -> 74.8509
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4683 mb_mean=0.4658 norm_overlap=1.0007 corr_cb=0.2275 topkJ=0.1020
[TRAIN][ep=007] loss=2.1197 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.4600 mb_mean=0.4532 norm_overlap=1.0015 corr_cb=0.3820
[EPOCH 007/089] train: loss=2.1197 acc=63.70% | val: loss=0.6564 acc=64.52% f1=50.00% auc=58.08% val_score=72.8728 val_score_bestthr=88.4099 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.460, mb=0.453, no=1.002, corr=0.382) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.7733 -> 72.8728
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4511 mb_mean=0.4451 norm_overlap=1.0027 corr_cb=0.4436 topkJ=0.1694
[TRAIN][ep=008] loss=2.1157 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.4429 mb_mean=0.4268 norm_overlap=1.0031 corr_cb=0.4634
[EPOCH 008/089] train: loss=2.1157 acc=63.70% | val: loss=0.6560 acc=66.13% f1=43.24% auc=57.86% val_score=71.9285 val_score_bestthr=87.0247 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.443, mb=0.427, no=1.003, corr=0.463) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.7733 -> 71.9285
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4352 mb_mean=0.4154 norm_overlap=1.0033 corr_cb=0.4976 topkJ=0.2389
[TRAIN][ep=009] loss=2.1097 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.4260 mb_mean=0.4003 norm_overlap=1.0050 corr_cb=0.4394
[EPOCH 009/089] train: loss=2.1097 acc=63.70% | val: loss=0.6560 acc=64.52% f1=50.00% auc=57.86% val_score=75.9395 val_score_bestthr=88.5630 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.426, mb=0.400, no=1.005, corr=0.439) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.7733 -> 75.9395
[DBG][ep=010] disease_pos_weight=1.0000 mode=none
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.4232 mb_mean=0.3998 norm_overlap=1.0058 corr_cb=0.4459 topkJ=0.1773
[TRAIN][ep=010] loss=2.1010 acc=63.70%
[TRAIN][ep=010] mask_avg: mc_mean=0.4100 mb_mean=0.3749 norm_overlap=1.0060 corr_cb=0.3434
[EPOCH 010/089] train: loss=2.1010 acc=63.70% | val: loss=0.6554 acc=66.13% f1=36.36% auc=58.53% val_score=60.9033 val_score_bestthr=83.7543 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.410, mb=0.375, no=1.006, corr=0.343) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.7733 -> 60.9033
[DBG][ep=011] disease_pos_weight=1.0000 mode=none
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.3936 mb_mean=0.3449 norm_overlap=1.0150 corr_cb=0.4028 topkJ=0.1115
[TRAIN][ep=011] loss=2.0967 acc=63.70%
[TRAIN][ep=011] mask_avg: mc_mean=0.3943 mb_mean=0.3525 norm_overlap=1.0045 corr_cb=0.1642
[EPOCH 011/089] train: loss=2.0967 acc=63.70% | val: loss=0.6554 acc=66.13% f1=57.14% auc=58.75% val_score=67.7762 val_score_bestthr=93.8526 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.394, mb=0.353, no=1.004, corr=0.164) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.7733 -> 67.7762
[DBG][ep=012] disease_pos_weight=1.0000 mode=none
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.3901 mb_mean=0.3473 norm_overlap=1.0000 corr_cb=0.0015 topkJ=0.1229
[TRAIN][ep=012] loss=2.0968 acc=63.70%
[TRAIN][ep=012] mask_avg: mc_mean=0.3796 mb_mean=0.3348 norm_overlap=1.0008 corr_cb=0.0238
[EPOCH 012/089] train: loss=2.0968 acc=63.70% | val: loss=0.6554 acc=66.13% f1=32.26% auc=58.42% val_score=75.9104 val_score_bestthr=81.6375 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.380, mb=0.335, no=1.001, corr=0.024) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.7733 -> 75.9104
[DBG][ep=013] disease_pos_weight=1.0000 mode=none
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.3790 mb_mean=0.3304 norm_overlap=0.9986 corr_cb=-0.0369 topkJ=0.0833
[TRAIN][ep=013] loss=2.0837 acc=63.70%
[TRAIN][ep=013] mask_avg: mc_mean=0.3665 mb_mean=0.3196 norm_overlap=0.9911 corr_cb=-0.1647
[EPOCH 013/089] train: loss=2.0837 acc=63.70% | val: loss=0.6560 acc=64.52% f1=47.62% auc=56.86% val_score=65.9914 val_score_bestthr=87.5961 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.366, mb=0.320, no=0.991, corr=-0.165) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.7733 -> 65.9914
[DBG][ep=014] disease_pos_weight=1.0000 mode=none
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.3581 mb_mean=0.3194 norm_overlap=0.9808 corr_cb=-0.3149 topkJ=0.0130
[TRAIN][ep=014] loss=2.0738 acc=63.70%
[TRAIN][ep=014] mask_avg: mc_mean=0.3534 mb_mean=0.3075 norm_overlap=0.9691 corr_cb=-0.3908
[EPOCH 014/089] train: loss=2.0738 acc=63.70% | val: loss=0.6560 acc=64.52% f1=50.00% auc=56.41% val_score=67.9137 val_score_bestthr=88.8371 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.353, mb=0.308, no=0.969, corr=-0.391) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.7733 -> 67.9137
[DBG][ep=015] disease_pos_weight=1.0000 mode=none
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.3465 mb_mean=0.3011 norm_overlap=0.9560 corr_cb=-0.5042 topkJ=0.0182
[TRAIN][ep=015] loss=2.0717 acc=63.70%
[TRAIN][ep=015] mask_avg: mc_mean=0.3408 mb_mean=0.3028 norm_overlap=0.9428 corr_cb=-0.5459
[EPOCH 015/089] train: loss=2.0717 acc=63.70% | val: loss=0.6553 acc=64.52% f1=52.17% auc=57.19% val_score=77.9697 val_score_bestthr=89.9993 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.341, mb=0.303, no=0.943, corr=-0.546) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=* 76.7733 -> 77.9697
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=016] disease_pos_weight=1.0000 mode=none
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.3320 mb_mean=0.3001 norm_overlap=0.9298 corr_cb=-0.6100 topkJ=0.0016
[TRAIN][ep=016] loss=2.0620 acc=63.70%
[TRAIN][ep=016] mask_avg: mc_mean=0.3306 mb_mean=0.3028 norm_overlap=0.9287 corr_cb=-0.5893
[EPOCH 016/089] train: loss=2.0620 acc=63.70% | val: loss=0.6548 acc=64.52% f1=50.00% auc=56.86% val_score=69.9384 val_score_bestthr=88.8371 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.331, mb=0.303, no=0.929, corr=-0.589) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 77.9697 -> 69.9384
[DBG][ep=017] disease_pos_weight=1.0000 mode=none
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.3253 mb_mean=0.3084 norm_overlap=0.9178 corr_cb=-0.6090 topkJ=0.0012
[TRAIN][ep=017] loss=1.3756 acc=63.70%
[TRAIN][ep=017] mask_avg: mc_mean=0.3211 mb_mean=0.3028 norm_overlap=0.9114 corr_cb=-0.6316
[EPOCH 017/089] train: loss=1.3756 acc=63.70% | val: loss=0.6557 acc=64.52% f1=47.62% auc=56.52% val_score=83.1324 val_score_bestthr=87.5961 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.321, mb=0.303, no=0.911, corr=-0.632) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=* 77.9697 -> 83.1324
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=018] disease_pos_weight=1.0000 mode=none
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.3141 mb_mean=0.3126 norm_overlap=0.9341 corr_cb=-0.5507 topkJ=0.0008
[TRAIN][ep=018] loss=0.6875 acc=63.70%
[TRAIN][ep=018] mask_avg: mc_mean=0.3125 mb_mean=0.3028 norm_overlap=0.8937 corr_cb=-0.6709
[EPOCH 018/089] train: loss=0.6875 acc=63.70% | val: loss=0.6562 acc=64.52% f1=47.62% auc=56.30% val_score=78.2224 val_score_bestthr=87.8294 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.312, mb=0.303, no=0.894, corr=-0.671) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 78.2224
[DBG][ep=019] disease_pos_weight=1.0000 mode=none
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.3164 mb_mean=0.3114 norm_overlap=0.9103 corr_cb=-0.6794 topkJ=0.0000
[TRAIN][ep=019] loss=0.5250 acc=63.70%
[TRAIN][ep=019] mask_avg: mc_mean=0.3052 mb_mean=0.3028 norm_overlap=0.8749 corr_cb=-0.7057
[EPOCH 019/089] train: loss=0.5250 acc=63.70% | val: loss=0.6555 acc=66.13% f1=43.24% auc=55.30% val_score=76.0144 val_score_bestthr=87.2428 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.305, mb=0.303, no=0.875, corr=-0.706) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 76.0144
[DBG][ep=020] disease_pos_weight=1.0000 mode=none
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.3066 mb_mean=0.2998 norm_overlap=0.8488 corr_cb=-0.7206 topkJ=0.0000
[TRAIN][ep=020] loss=0.5136 acc=64.61%
[TRAIN][ep=020] mask_avg: mc_mean=0.2994 mb_mean=0.3028 norm_overlap=0.8546 corr_cb=-0.7336
[EPOCH 020/089] train: loss=0.5136 acc=64.61% | val: loss=0.6568 acc=66.13% f1=43.24% auc=54.85% val_score=71.0740 val_score_bestthr=87.2428 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.299, mb=0.303, no=0.855, corr=-0.734) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 71.0740
[DBG][ep=021] disease_pos_weight=1.0000 mode=none
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2929 mb_mean=0.3003 norm_overlap=0.8273 corr_cb=-0.7812 topkJ=0.0000
[TRAIN][ep=021] loss=0.5032 acc=66.42%
[TRAIN][ep=021] mask_avg: mc_mean=0.2948 mb_mean=0.3028 norm_overlap=0.8307 corr_cb=-0.7657
[EPOCH 021/089] train: loss=0.5032 acc=66.42% | val: loss=0.6594 acc=64.52% f1=42.11% auc=56.52% val_score=73.1226 val_score_bestthr=84.9757 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.295, mb=0.303, no=0.831, corr=-0.766) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 73.1226
[DBG][ep=022] disease_pos_weight=1.0000 mode=none
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2986 mb_mean=0.3009 norm_overlap=0.8141 corr_cb=-0.8014 topkJ=0.0000
[TRAIN][ep=022] loss=0.4929 acc=68.60%
[TRAIN][ep=022] mask_avg: mc_mean=0.2920 mb_mean=0.3028 norm_overlap=0.8107 corr_cb=-0.7845
[EPOCH 022/089] train: loss=0.4929 acc=68.60% | val: loss=0.6621 acc=64.52% f1=26.67% auc=55.41% val_score=71.0740 val_score_bestthr=77.2502 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.292, mb=0.303, no=0.811, corr=-0.785) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 71.0740
[DBG][ep=023] disease_pos_weight=1.0000 mode=none
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2874 mb_mean=0.3060 norm_overlap=0.8036 corr_cb=-0.7942 topkJ=0.0000
[TRAIN][ep=023] loss=0.4834 acc=71.14%
[TRAIN][ep=023] mask_avg: mc_mean=0.2903 mb_mean=0.3028 norm_overlap=0.7891 corr_cb=-0.8017
[EPOCH 023/089] train: loss=0.4834 acc=71.14% | val: loss=0.6690 acc=64.52% f1=45.00% auc=54.63% val_score=76.1594 val_score_bestthr=86.3985 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.290, mb=0.303, no=0.789, corr=-0.802) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 76.1594
[DBG][ep=024] disease_pos_weight=1.0000 mode=none
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2987 mb_mean=0.2942 norm_overlap=0.7761 corr_cb=-0.7951 topkJ=0.0000
[TRAIN][ep=024] loss=0.4723 acc=70.24%
[TRAIN][ep=024] mask_avg: mc_mean=0.2881 mb_mean=0.3028 norm_overlap=0.7740 corr_cb=-0.8095
[EPOCH 024/089] train: loss=0.4723 acc=70.24% | val: loss=0.6726 acc=64.52% f1=21.43% auc=53.29% val_score=67.1084 val_score_bestthr=74.6880 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.288, mb=0.303, no=0.774, corr=-0.809) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 67.1084
[DBG][ep=025] disease_pos_weight=1.0000 mode=none
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2732 mb_mean=0.3168 norm_overlap=0.8526 corr_cb=-0.6906 topkJ=0.0000
[TRAIN][ep=025] loss=0.4697 acc=72.41%
[TRAIN][ep=025] mask_avg: mc_mean=0.2879 mb_mean=0.3028 norm_overlap=0.7595 corr_cb=-0.8157
[EPOCH 025/089] train: loss=0.4697 acc=72.41% | val: loss=0.6770 acc=64.52% f1=21.43% auc=52.95% val_score=67.2247 val_score_bestthr=74.6880 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.288, mb=0.303, no=0.760, corr=-0.816) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 67.2247
[DBG][ep=026] disease_pos_weight=1.0000 mode=none
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2788 mb_mean=0.2926 norm_overlap=0.7146 corr_cb=-0.8250 topkJ=0.0000
[TRAIN][ep=026] loss=0.4591 acc=70.96%
[TRAIN][ep=026] mask_avg: mc_mean=0.2856 mb_mean=0.3028 norm_overlap=0.7490 corr_cb=-0.8200
[EPOCH 026/089] train: loss=0.4591 acc=70.96% | val: loss=0.6822 acc=64.52% f1=21.43% auc=53.40% val_score=68.3936 val_score_bestthr=74.6880 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.286, mb=0.303, no=0.749, corr=-0.820) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 68.3936
[DBG][ep=027] disease_pos_weight=1.0000 mode=none
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2852 mb_mean=0.3167 norm_overlap=0.7831 corr_cb=-0.8247 topkJ=0.0000
[TRAIN][ep=027] loss=0.4499 acc=73.32%
[TRAIN][ep=027] mask_avg: mc_mean=0.2843 mb_mean=0.3028 norm_overlap=0.7399 corr_cb=-0.8228
[EPOCH 027/089] train: loss=0.4499 acc=73.32% | val: loss=0.6836 acc=66.13% f1=16.00% auc=52.51% val_score=68.0860 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.284, mb=0.303, no=0.740, corr=-0.823) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 68.0860
[DBG][ep=028] disease_pos_weight=1.0000 mode=none
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2770 mb_mean=0.3095 norm_overlap=0.7430 corr_cb=-0.8356 topkJ=0.0000
[TRAIN][ep=028] loss=0.4429 acc=73.14%
[TRAIN][ep=028] mask_avg: mc_mean=0.2824 mb_mean=0.3028 norm_overlap=0.7295 corr_cb=-0.8285
[EPOCH 028/089] train: loss=0.4429 acc=73.14% | val: loss=0.6851 acc=66.13% f1=16.00% auc=52.17% val_score=70.0121 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.282, mb=0.303, no=0.729, corr=-0.829) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 70.0121
[DBG][ep=029] disease_pos_weight=1.0000 mode=none
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2666 mb_mean=0.2934 norm_overlap=0.7250 corr_cb=-0.7680 topkJ=0.0000
[TRAIN][ep=029] loss=0.4314 acc=74.41%
[TRAIN][ep=029] mask_avg: mc_mean=0.2786 mb_mean=0.3028 norm_overlap=0.7233 corr_cb=-0.8248
[EPOCH 029/089] train: loss=0.4314 acc=74.41% | val: loss=0.6892 acc=66.13% f1=16.00% auc=52.95% val_score=68.0860 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.279, mb=0.303, no=0.723, corr=-0.825) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 68.0860
[DBG][ep=030] disease_pos_weight=1.0000 mode=none
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2648 mb_mean=0.3142 norm_overlap=0.7229 corr_cb=-0.8009 topkJ=0.0000
[TRAIN][ep=030] loss=0.4232 acc=74.95%
[TRAIN][ep=030] mask_avg: mc_mean=0.2773 mb_mean=0.3028 norm_overlap=0.7163 corr_cb=-0.8258
[EPOCH 030/089] train: loss=0.4232 acc=74.95% | val: loss=0.6926 acc=66.13% f1=16.00% auc=52.73% val_score=67.0905 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.277, mb=0.303, no=0.716, corr=-0.826) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 67.0905
[DBG][ep=031] disease_pos_weight=1.0000 mode=none
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2865 mb_mean=0.2891 norm_overlap=0.6336 corr_cb=-0.8706 topkJ=0.0000
[TRAIN][ep=031] loss=0.4121 acc=75.86%
[TRAIN][ep=031] mask_avg: mc_mean=0.2765 mb_mean=0.3028 norm_overlap=0.7130 corr_cb=-0.8255
[EPOCH 031/089] train: loss=0.4121 acc=75.86% | val: loss=0.6937 acc=66.13% f1=16.00% auc=52.40% val_score=68.0146 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.303, no=0.713, corr=-0.826) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 68.0146
[DBG][ep=032] disease_pos_weight=1.0000 mode=none
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2593 mb_mean=0.3128 norm_overlap=0.7954 corr_cb=-0.7747 topkJ=0.0000
[TRAIN][ep=032] loss=0.4119 acc=75.50%
[TRAIN][ep=032] mask_avg: mc_mean=0.2765 mb_mean=0.3028 norm_overlap=0.7131 corr_cb=-0.8243
[EPOCH 032/089] train: loss=0.4119 acc=75.50% | val: loss=0.6937 acc=66.13% f1=16.00% auc=52.40% val_score=67.0905 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.277, mb=0.303, no=0.713, corr=-0.824) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 67.0905
[DBG][ep=033] disease_pos_weight=1.0000 mode=none
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2897 mb_mean=0.2930 norm_overlap=0.6756 corr_cb=-0.7915 topkJ=0.0000
[TRAIN][ep=033] loss=0.4089 acc=75.50%
[TRAIN][ep=033] mask_avg: mc_mean=0.2765 mb_mean=0.3028 norm_overlap=0.7130 corr_cb=-0.8254
[EPOCH 033/089] train: loss=0.4089 acc=75.50% | val: loss=0.6947 acc=66.13% f1=16.00% auc=52.06% val_score=67.0905 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.303, no=0.713, corr=-0.825) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 67.0905
[DBG][ep=034] disease_pos_weight=1.0000 mode=none
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2689 mb_mean=0.3085 norm_overlap=0.7572 corr_cb=-0.8141 topkJ=0.0000
[TRAIN][ep=034] loss=0.4065 acc=76.23%
[TRAIN][ep=034] mask_avg: mc_mean=0.2765 mb_mean=0.3028 norm_overlap=0.7130 corr_cb=-0.8256
[EPOCH 034/089] train: loss=0.4065 acc=76.23% | val: loss=0.6964 acc=66.13% f1=16.00% auc=52.51% val_score=66.0133 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.277, mb=0.303, no=0.713, corr=-0.826) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 66.0133
[DBG][ep=035] disease_pos_weight=1.0000 mode=none
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2596 mb_mean=0.3211 norm_overlap=0.7793 corr_cb=-0.7754 topkJ=0.0000
[TRAIN][ep=035] loss=0.4061 acc=76.59%
[TRAIN][ep=035] mask_avg: mc_mean=0.2765 mb_mean=0.3028 norm_overlap=0.7129 corr_cb=-0.8251
[EPOCH 035/089] train: loss=0.4061 acc=76.59% | val: loss=0.6958 acc=66.13% f1=16.00% auc=52.51% val_score=69.0566 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.277, mb=0.303, no=0.713, corr=-0.825) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 69.0566
[DBG][ep=036] disease_pos_weight=1.0000 mode=none
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2800 mb_mean=0.3147 norm_overlap=0.7319 corr_cb=-0.8611 topkJ=0.0000
[TRAIN][ep=036] loss=0.4038 acc=75.86%
[TRAIN][ep=036] mask_avg: mc_mean=0.2765 mb_mean=0.3028 norm_overlap=0.7130 corr_cb=-0.8258
[EPOCH 036/089] train: loss=0.4038 acc=75.86% | val: loss=0.6960 acc=66.13% f1=16.00% auc=52.51% val_score=67.0905 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.303, no=0.713, corr=-0.826) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 67.0905
[DBG][ep=037] disease_pos_weight=1.0000 mode=none
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.2945 mb_mean=0.2902 norm_overlap=0.6265 corr_cb=-0.8683 topkJ=0.0000
[TRAIN][ep=037] loss=0.4012 acc=76.23%
[TRAIN][ep=037] mask_avg: mc_mean=0.2765 mb_mean=0.3028 norm_overlap=0.7131 corr_cb=-0.8247
[EPOCH 037/089] train: loss=0.4012 acc=76.23% | val: loss=0.6974 acc=66.13% f1=16.00% auc=52.95% val_score=69.0566 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.303, no=0.713, corr=-0.825) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 69.0566
[DBG][ep=038] disease_pos_weight=1.0000 mode=none
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2387 mb_mean=0.3134 norm_overlap=0.8049 corr_cb=-0.7061 topkJ=0.0000
[TRAIN][ep=038] loss=0.3990 acc=75.86%
[TRAIN][ep=038] mask_avg: mc_mean=0.2765 mb_mean=0.3028 norm_overlap=0.7133 corr_cb=-0.8243
[EPOCH 038/089] train: loss=0.3990 acc=75.86% | val: loss=0.6989 acc=66.13% f1=16.00% auc=52.95% val_score=66.0133 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.277, mb=0.303, no=0.713, corr=-0.824) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 66.0133
[DBG][ep=039] disease_pos_weight=1.0000 mode=none
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2828 mb_mean=0.3028 norm_overlap=0.7154 corr_cb=-0.8601 topkJ=0.0000
[TRAIN][ep=039] loss=0.3975 acc=75.50%
[TRAIN][ep=039] mask_avg: mc_mean=0.2765 mb_mean=0.3028 norm_overlap=0.7132 corr_cb=-0.8248
[EPOCH 039/089] train: loss=0.3975 acc=75.50% | val: loss=0.6990 acc=66.13% f1=16.00% auc=52.73% val_score=66.0133 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.303, no=0.713, corr=-0.825) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 66.0133
[DBG][ep=040] disease_pos_weight=1.0000 mode=none
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.2940 mb_mean=0.2806 norm_overlap=0.6073 corr_cb=-0.8715 topkJ=0.0000
[TRAIN][ep=040] loss=0.3965 acc=76.23%
[TRAIN][ep=040] mask_avg: mc_mean=0.2765 mb_mean=0.3028 norm_overlap=0.7131 corr_cb=-0.8248
[EPOCH 040/089] train: loss=0.3965 acc=76.23% | val: loss=0.7009 acc=66.13% f1=16.00% auc=52.95% val_score=67.9113 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.277, mb=0.303, no=0.713, corr=-0.825) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 67.9113
[DBG][ep=041] disease_pos_weight=1.0000 mode=none
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.2851 mb_mean=0.2945 norm_overlap=0.6571 corr_cb=-0.8582 topkJ=0.0000
[TRAIN][ep=041] loss=0.3940 acc=76.23%
[TRAIN][ep=041] mask_avg: mc_mean=0.2765 mb_mean=0.3028 norm_overlap=0.7129 corr_cb=-0.8272
[EPOCH 041/089] train: loss=0.3940 acc=76.23% | val: loss=0.7013 acc=66.13% f1=16.00% auc=52.95% val_score=66.0133 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.277, mb=0.303, no=0.713, corr=-0.827) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 66.0133
[DBG][ep=042] disease_pos_weight=1.0000 mode=none
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.2639 mb_mean=0.3171 norm_overlap=0.7478 corr_cb=-0.8233 topkJ=0.0000
[TRAIN][ep=042] loss=0.3923 acc=76.77%
[TRAIN][ep=042] mask_avg: mc_mean=0.2765 mb_mean=0.3028 norm_overlap=0.7129 corr_cb=-0.8250
[EPOCH 042/089] train: loss=0.3923 acc=76.77% | val: loss=0.7004 acc=66.13% f1=16.00% auc=52.95% val_score=66.0133 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.277, mb=0.303, no=0.713, corr=-0.825) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 66.0133
[DBG][ep=043] disease_pos_weight=1.0000 mode=none
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.2720 mb_mean=0.3057 norm_overlap=0.7052 corr_cb=-0.8570 topkJ=0.0000
[TRAIN][ep=043] loss=0.3902 acc=77.13%
[TRAIN][ep=043] mask_avg: mc_mean=0.2765 mb_mean=0.3028 norm_overlap=0.7129 corr_cb=-0.8250
[EPOCH 043/089] train: loss=0.3902 acc=77.13% | val: loss=0.7014 acc=66.13% f1=16.00% auc=53.07% val_score=66.0133 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.277, mb=0.303, no=0.713, corr=-0.825) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 66.0133
[DBG][ep=044] disease_pos_weight=1.0000 mode=none
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2741 mb_mean=0.2935 norm_overlap=0.7499 corr_cb=-0.7667 topkJ=0.0000
[TRAIN][ep=044] loss=0.3887 acc=76.41%
[TRAIN][ep=044] mask_avg: mc_mean=0.2765 mb_mean=0.3028 norm_overlap=0.7129 corr_cb=-0.8254
[EPOCH 044/089] train: loss=0.3887 acc=76.41% | val: loss=0.7024 acc=66.13% f1=16.00% auc=53.18% val_score=66.0133 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.277, mb=0.303, no=0.713, corr=-0.825) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 66.0133
[DBG][ep=045] disease_pos_weight=1.0000 mode=none
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2669 mb_mean=0.3064 norm_overlap=0.7425 corr_cb=-0.7870 topkJ=0.0000
[TRAIN][ep=045] loss=0.3863 acc=76.59%
[TRAIN][ep=045] mask_avg: mc_mean=0.2765 mb_mean=0.3028 norm_overlap=0.7127 corr_cb=-0.8266
[EPOCH 045/089] train: loss=0.3863 acc=76.59% | val: loss=0.7023 acc=66.13% f1=16.00% auc=52.84% val_score=69.0566 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.277, mb=0.303, no=0.713, corr=-0.827) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 69.0566
[DBG][ep=046] disease_pos_weight=1.0000 mode=none
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.2638 mb_mean=0.2994 norm_overlap=0.7035 corr_cb=-0.8392 topkJ=0.0000
[TRAIN][ep=046] loss=0.3860 acc=76.41%
[TRAIN][ep=046] mask_avg: mc_mean=0.2765 mb_mean=0.3028 norm_overlap=0.7124 corr_cb=-0.8271
[EPOCH 046/089] train: loss=0.3860 acc=76.41% | val: loss=0.7040 acc=66.13% f1=32.26% auc=53.51% val_score=66.0133 val_score_bestthr=81.6712 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.277, mb=0.303, no=0.712, corr=-0.827) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 66.0133
[DBG][ep=047] disease_pos_weight=1.0000 mode=none
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.2743 mb_mean=0.3120 norm_overlap=0.7216 corr_cb=-0.8444 topkJ=0.0000
[TRAIN][ep=047] loss=0.3840 acc=77.13%
[TRAIN][ep=047] mask_avg: mc_mean=0.2765 mb_mean=0.3028 norm_overlap=0.7129 corr_cb=-0.8254
[EPOCH 047/089] train: loss=0.3840 acc=77.13% | val: loss=0.7036 acc=66.13% f1=32.26% auc=53.29% val_score=69.0566 val_score_bestthr=81.6712 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.277, mb=0.303, no=0.713, corr=-0.825) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 69.0566
[EARLY STOP] no improvement for 30 epochs. best_epoch=17
[CKPT] Loaded best for testing: results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
=============== FIT DONE ===============
[BEST] epoch=17 | val_acc=64.52% | val_f1=47.62% | val_auc=56.52% | val_score=83.1324 | val_score_bestthr=87.5961
[TEST@BEST] thr_used=0.400 | acc=66.23% f1=27.78% auc=63.68% | SP_sex=4.82% EO_sex=1.52% SP_age=10.40% EO_age=7.94%
[TIME] 0.75 min
[OK] Saved: results/ADHD_3x5fold_seed0/fold1_rep0_seed1/summary_fold_1.json
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5033 mb_mean=0.5074 norm_overlap=1.0000 corr_cb=-0.0236 topkJ=0.0769
[TRAIN][ep=000] loss=0.6876 acc=61.34%
[TRAIN][ep=000] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1035
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5043 mb_mean=0.5082 norm_overlap=1.0001 corr_cb=0.1648 topkJ=0.0737
[TRAIN][ep=001] loss=0.6755 acc=63.70%
[TRAIN][ep=001] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1054
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5022 mb_mean=0.5087 norm_overlap=1.0002 corr_cb=0.2275 topkJ=0.1455
[TRAIN][ep=002] loss=0.6656 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1043
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5035 mb_mean=0.5094 norm_overlap=1.0000 corr_cb=0.0241 topkJ=0.0509
[TRAIN][ep=003] loss=0.6594 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1050
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5028 mb_mean=0.5106 norm_overlap=1.0000 corr_cb=-0.0149 topkJ=0.0979
[TRAIN][ep=004] loss=0.6565 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1064
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5019 mb_mean=0.5085 norm_overlap=1.0001 corr_cb=0.1280 topkJ=0.1508
[TRAIN][ep=005] loss=0.6563 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1026
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5034 mb_mean=0.5096 norm_overlap=1.0001 corr_cb=0.0714 topkJ=0.1095
[TRAIN][ep=006] loss=0.6540 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1069
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5027 mb_mean=0.5084 norm_overlap=1.0001 corr_cb=0.0800 topkJ=0.0599
[TRAIN][ep=007] loss=0.6536 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1041
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5013 mb_mean=0.5071 norm_overlap=1.0002 corr_cb=0.2685 topkJ=0.0945
[TRAIN][ep=008] loss=0.6521 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1038
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5020 mb_mean=0.5111 norm_overlap=1.0000 corr_cb=0.0016 topkJ=0.0557
[TRAIN][ep=009] loss=0.6513 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1023
================= FIT START (fold=1) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.35 select_by=val_score | eval_thr_mode=best_acc eval_thr_grid=coarse | disease_pos_weight_mode=none freeze_b_after=15 | two_stage=True stage1_ratio=0.35 stage2_lr_mult=0.3 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5045 mb_mean=0.5109 norm_overlap=1.0000 corr_cb=0.0362 topkJ=0.0638
[TRAIN][ep=000] loss=0.6500 acc=63.70%
[TRAIN][ep=000] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1077
[EPOCH 000/089] train: loss=0.6500 acc=63.70% | val: loss=0.6577 acc=62.90% f1=0.00% auc=54.96% val_score=72.0763 val_score_bestthr=62.9032 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.503, mb=0.509, no=1.000, corr=0.108) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* -1000000000000000000.0000 -> 72.0763
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5043 mb_mean=0.5100 norm_overlap=1.0000 corr_cb=-0.0050 topkJ=0.0422
[TRAIN][ep=001] loss=0.6489 acc=63.70%
[TRAIN][ep=001] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1086
[EPOCH 001/089] train: loss=0.6489 acc=63.70% | val: loss=0.6572 acc=64.52% f1=38.89% auc=56.08% val_score=70.1231 val_score_bestthr=83.2578 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.503, mb=0.509, no=1.000, corr=0.109) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 72.0763 -> 70.1231
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5004 mb_mean=0.5099 norm_overlap=1.0001 corr_cb=0.2004 topkJ=0.1277
[TRAIN][ep=002] loss=0.6480 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1068
[EPOCH 002/089] train: loss=0.6480 acc=63.70% | val: loss=0.6569 acc=62.90% f1=30.30% auc=56.19% val_score=74.6247 val_score_bestthr=77.4480 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.503, mb=0.509, no=1.000, corr=0.107) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 72.0763 -> 74.6247
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5013 mb_mean=0.5096 norm_overlap=1.0001 corr_cb=0.1039 topkJ=0.0703
[TRAIN][ep=003] loss=0.6465 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1068
[EPOCH 003/089] train: loss=0.6465 acc=63.70% | val: loss=0.6568 acc=64.52% f1=38.89% auc=57.19% val_score=75.4593 val_score_bestthr=83.2578 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.503, mb=0.509, no=1.000, corr=0.107) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 74.6247 -> 75.4593
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.0595 topkJ=0.0573
[TRAIN][ep=004] loss=0.6452 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1040
[EPOCH 004/089] train: loss=0.6452 acc=63.70% | val: loss=0.6559 acc=66.13% f1=43.24% auc=57.75% val_score=65.9529 val_score_bestthr=87.0247 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.503, mb=0.509, no=1.000, corr=0.104) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 75.4593 -> 65.9529
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5024 mb_mean=0.5096 norm_overlap=1.0000 corr_cb=0.0125 topkJ=0.1126
[TRAIN][ep=005] loss=2.2392 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.4944 mb_mean=0.4996 norm_overlap=1.0001 corr_cb=0.1053
[EPOCH 005/089] train: loss=2.2392 acc=63.70% | val: loss=0.6564 acc=66.13% f1=43.24% auc=57.41% val_score=76.7733 val_score_bestthr=87.0247 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.494, mb=0.500, no=1.000, corr=0.105) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 75.4593 -> 76.7733
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4853 mb_mean=0.4888 norm_overlap=1.0002 corr_cb=0.1807 topkJ=0.0643
[TRAIN][ep=006] loss=2.2422 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.4779 mb_mean=0.4779 norm_overlap=1.0004 corr_cb=0.1911
[EPOCH 006/089] train: loss=2.2422 acc=63.70% | val: loss=0.6567 acc=69.35% f1=53.66% auc=58.08% val_score=72.8728 val_score_bestthr=95.0291 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.478, mb=0.478, no=1.000, corr=0.191) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.7733 -> 72.8728
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4692 mb_mean=0.4657 norm_overlap=1.0007 corr_cb=0.2208 topkJ=0.1005
[TRAIN][ep=007] loss=2.2381 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.4613 mb_mean=0.4532 norm_overlap=1.0015 corr_cb=0.3787
[EPOCH 007/089] train: loss=2.2381 acc=63.70% | val: loss=0.6563 acc=64.52% f1=50.00% auc=58.08% val_score=72.8728 val_score_bestthr=88.4099 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.461, mb=0.453, no=1.001, corr=0.379) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.7733 -> 72.8728
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4526 mb_mean=0.4450 norm_overlap=1.0025 corr_cb=0.4346 topkJ=0.1705
[TRAIN][ep=008] loss=2.2339 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.4449 mb_mean=0.4267 norm_overlap=1.0030 corr_cb=0.4589
[EPOCH 008/089] train: loss=2.2339 acc=63.70% | val: loss=0.6559 acc=66.13% f1=43.24% auc=58.08% val_score=71.9285 val_score_bestthr=87.0247 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.445, mb=0.427, no=1.003, corr=0.459) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.7733 -> 71.9285
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4375 mb_mean=0.4153 norm_overlap=1.0032 corr_cb=0.4953 topkJ=0.2334
[TRAIN][ep=009] loss=2.2276 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.4286 mb_mean=0.4001 norm_overlap=1.0048 corr_cb=0.4379
[EPOCH 009/089] train: loss=2.2276 acc=63.70% | val: loss=0.6559 acc=64.52% f1=50.00% auc=58.19% val_score=73.9607 val_score_bestthr=88.5630 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.429, mb=0.400, no=1.005, corr=0.438) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.7733 -> 73.9607
[DBG][ep=010] disease_pos_weight=1.0000 mode=none
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.4259 mb_mean=0.3997 norm_overlap=1.0056 corr_cb=0.4473 topkJ=0.1767
[TRAIN][ep=010] loss=2.2184 acc=63.70%
[TRAIN][ep=010] mask_avg: mc_mean=0.4134 mb_mean=0.3747 norm_overlap=1.0059 corr_cb=0.3503
[EPOCH 010/089] train: loss=2.2184 acc=63.70% | val: loss=0.6553 acc=66.13% f1=36.36% auc=58.86% val_score=62.8082 val_score_bestthr=83.7543 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.413, mb=0.375, no=1.006, corr=0.350) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.7733 -> 62.8082
[DBG][ep=011] disease_pos_weight=1.0000 mode=none
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.3975 mb_mean=0.3446 norm_overlap=1.0145 corr_cb=0.4066 topkJ=0.1135
[TRAIN][ep=011] loss=2.2137 acc=63.70%
[TRAIN][ep=011] mask_avg: mc_mean=0.3982 mb_mean=0.3521 norm_overlap=1.0047 corr_cb=0.1831
[EPOCH 011/089] train: loss=2.2137 acc=63.70% | val: loss=0.6554 acc=64.52% f1=52.17% auc=58.64% val_score=71.8035 val_score_bestthr=89.7162 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.398, mb=0.352, no=1.005, corr=0.183) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.7733 -> 71.8035
[DBG][ep=012] disease_pos_weight=1.0000 mode=none
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.3942 mb_mean=0.3467 norm_overlap=1.0007 corr_cb=0.0287 topkJ=0.1265
[TRAIN][ep=012] loss=1.4911 acc=63.70%
[TRAIN][ep=012] mask_avg: mc_mean=0.3838 mb_mean=0.3341 norm_overlap=1.0019 corr_cb=0.0559
[EPOCH 012/089] train: loss=1.4911 acc=63.70% | val: loss=0.6554 acc=64.52% f1=52.17% auc=58.08% val_score=75.8145 val_score_bestthr=89.7162 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.384, mb=0.334, no=1.002, corr=0.056) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.7733 -> 75.8145
[DBG][ep=013] disease_pos_weight=1.0000 mode=none
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.3829 mb_mean=0.3297 norm_overlap=0.9998 corr_cb=-0.0064 topkJ=0.0872
[TRAIN][ep=013] loss=0.7629 acc=63.70%
[TRAIN][ep=013] mask_avg: mc_mean=0.3701 mb_mean=0.3186 norm_overlap=0.9922 corr_cb=-0.1494
[EPOCH 013/089] train: loss=0.7629 acc=63.70% | val: loss=0.6554 acc=64.52% f1=45.00% auc=56.63% val_score=75.9805 val_score_bestthr=86.4694 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.370, mb=0.319, no=0.992, corr=-0.149) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.7733 -> 75.9805
[DBG][ep=014] disease_pos_weight=1.0000 mode=none
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.3615 mb_mean=0.3180 norm_overlap=0.9820 corr_cb=-0.3070 topkJ=0.0130
[TRAIN][ep=014] loss=0.5689 acc=63.70%
[TRAIN][ep=014] mask_avg: mc_mean=0.3556 mb_mean=0.3059 norm_overlap=0.9687 corr_cb=-0.3965
[EPOCH 014/089] train: loss=0.5689 acc=63.70% | val: loss=0.6549 acc=66.13% f1=43.24% auc=57.08% val_score=75.9805 val_score_bestthr=87.2428 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.356, mb=0.306, no=0.969, corr=-0.397) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.7733 -> 75.9805
[DBG][ep=015] disease_pos_weight=1.0000 mode=none
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.3468 mb_mean=0.2991 norm_overlap=0.9479 corr_cb=-0.5572 topkJ=0.0108
[TRAIN][ep=015] loss=0.5409 acc=63.70%
[TRAIN][ep=015] mask_avg: mc_mean=0.3394 mb_mean=0.3005 norm_overlap=0.9350 corr_cb=-0.5716
[EPOCH 015/089] train: loss=0.5409 acc=63.70% | val: loss=0.6550 acc=64.52% f1=50.00% auc=55.30% val_score=78.0253 val_score_bestthr=88.8197 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.339, mb=0.301, no=0.935, corr=-0.572) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=* 76.7733 -> 78.0253
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=016] disease_pos_weight=1.0000 mode=none
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.3280 mb_mean=0.2979 norm_overlap=0.9160 corr_cb=-0.6397 topkJ=0.0008
[TRAIN][ep=016] loss=0.5333 acc=63.88%
[TRAIN][ep=016] mask_avg: mc_mean=0.3242 mb_mean=0.3005 norm_overlap=0.9095 corr_cb=-0.6346
[EPOCH 016/089] train: loss=0.5333 acc=63.88% | val: loss=0.6554 acc=67.74% f1=50.00% auc=56.08% val_score=73.9069 val_score_bestthr=91.9631 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.324, mb=0.301, no=0.909, corr=-0.635) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 78.0253 -> 73.9069
[DBG][ep=017] disease_pos_weight=1.0000 mode=none
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.3170 mb_mean=0.3061 norm_overlap=0.8955 corr_cb=-0.6505 topkJ=0.0000
[TRAIN][ep=017] loss=0.5237 acc=64.07%
[TRAIN][ep=017] mask_avg: mc_mean=0.3113 mb_mean=0.3005 norm_overlap=0.8826 corr_cb=-0.6796
[EPOCH 017/089] train: loss=0.5237 acc=64.07% | val: loss=0.6570 acc=66.13% f1=48.78% auc=56.52% val_score=79.1801 val_score_bestthr=89.6553 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.311, mb=0.301, no=0.883, corr=-0.680) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=* 78.0253 -> 79.1801
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=018] disease_pos_weight=1.0000 mode=none
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.3018 mb_mean=0.3103 norm_overlap=0.9069 corr_cb=-0.6119 topkJ=0.0000
[TRAIN][ep=018] loss=0.5175 acc=65.70%
[TRAIN][ep=018] mask_avg: mc_mean=0.3011 mb_mean=0.3005 norm_overlap=0.8561 corr_cb=-0.7171
[EPOCH 018/089] train: loss=0.5175 acc=65.70% | val: loss=0.6593 acc=67.74% f1=50.00% auc=55.52% val_score=75.0368 val_score_bestthr=91.9631 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.301, mb=0.301, no=0.856, corr=-0.717) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 79.1801 -> 75.0368
[DBG][ep=019] disease_pos_weight=1.0000 mode=none
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.3032 mb_mean=0.3092 norm_overlap=0.8743 corr_cb=-0.7304 topkJ=0.0000
[TRAIN][ep=019] loss=0.5044 acc=67.15%
[TRAIN][ep=019] mask_avg: mc_mean=0.2947 mb_mean=0.3005 norm_overlap=0.8314 corr_cb=-0.7474
[EPOCH 019/089] train: loss=0.5044 acc=67.15% | val: loss=0.6629 acc=66.13% f1=27.59% auc=56.19% val_score=69.0619 val_score_bestthr=79.3677 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.295, mb=0.301, no=0.831, corr=-0.747) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 79.1801 -> 69.0619
[DBG][ep=020] disease_pos_weight=1.0000 mode=none
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.2994 mb_mean=0.2976 norm_overlap=0.8020 corr_cb=-0.7664 topkJ=0.0000
[TRAIN][ep=020] loss=0.4968 acc=67.70%
[TRAIN][ep=020] mask_avg: mc_mean=0.2910 mb_mean=0.3005 norm_overlap=0.8096 corr_cb=-0.7670
[EPOCH 020/089] train: loss=0.4968 acc=67.70% | val: loss=0.6674 acc=66.13% f1=43.24% auc=54.96% val_score=67.1084 val_score_bestthr=86.9803 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.291, mb=0.301, no=0.810, corr=-0.767) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 79.1801 -> 67.1084
[DBG][ep=021] disease_pos_weight=1.0000 mode=none
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2867 mb_mean=0.2978 norm_overlap=0.7819 corr_cb=-0.8078 topkJ=0.0000
[TRAIN][ep=021] loss=0.4871 acc=70.05%
[TRAIN][ep=021] mask_avg: mc_mean=0.2903 mb_mean=0.3005 norm_overlap=0.7883 corr_cb=-0.7875
[EPOCH 021/089] train: loss=0.4871 acc=70.05% | val: loss=0.6720 acc=66.13% f1=43.24% auc=55.30% val_score=75.0210 val_score_bestthr=86.9803 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.290, mb=0.301, no=0.788, corr=-0.788) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 79.1801 -> 75.0210
[DBG][ep=022] disease_pos_weight=1.0000 mode=none
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2951 mb_mean=0.2987 norm_overlap=0.7788 corr_cb=-0.8068 topkJ=0.0000
[TRAIN][ep=022] loss=0.4785 acc=69.51%
[TRAIN][ep=022] mask_avg: mc_mean=0.2894 mb_mean=0.3005 norm_overlap=0.7745 corr_cb=-0.7959
[EPOCH 022/089] train: loss=0.4785 acc=69.51% | val: loss=0.6732 acc=66.13% f1=43.24% auc=55.18% val_score=75.0210 val_score_bestthr=86.9803 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.289, mb=0.301, no=0.775, corr=-0.796) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 79.1801 -> 75.0210
[DBG][ep=023] disease_pos_weight=1.0000 mode=none
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2859 mb_mean=0.3036 norm_overlap=0.7747 corr_cb=-0.7943 topkJ=0.0000
[TRAIN][ep=023] loss=0.4709 acc=71.14%
[TRAIN][ep=023] mask_avg: mc_mean=0.2898 mb_mean=0.3005 norm_overlap=0.7598 corr_cb=-0.8045
[EPOCH 023/089] train: loss=0.4709 acc=71.14% | val: loss=0.6798 acc=64.52% f1=42.11% auc=54.07% val_score=78.2396 val_score_bestthr=85.2160 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.290, mb=0.300, no=0.760, corr=-0.804) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 79.1801 -> 78.2396
[DBG][ep=024] disease_pos_weight=1.0000 mode=none
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2994 mb_mean=0.2919 norm_overlap=0.7540 corr_cb=-0.7864 topkJ=0.0000
[TRAIN][ep=024] loss=0.4616 acc=70.05%
[TRAIN][ep=024] mask_avg: mc_mean=0.2875 mb_mean=0.3005 norm_overlap=0.7493 corr_cb=-0.8075
[EPOCH 024/089] train: loss=0.4616 acc=70.05% | val: loss=0.6816 acc=66.13% f1=46.15% auc=53.62% val_score=67.9965 val_score_bestthr=88.6735 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.288, mb=0.301, no=0.749, corr=-0.807) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 79.1801 -> 67.9965
[DBG][ep=025] disease_pos_weight=1.0000 mode=none
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2697 mb_mean=0.3148 norm_overlap=0.8355 corr_cb=-0.6770 topkJ=0.0000
[TRAIN][ep=025] loss=0.4606 acc=72.23%
[TRAIN][ep=025] mask_avg: mc_mean=0.2882 mb_mean=0.3005 norm_overlap=0.7400 corr_cb=-0.8097
[EPOCH 025/089] train: loss=0.4606 acc=72.23% | val: loss=0.6821 acc=66.13% f1=46.15% auc=53.96% val_score=67.9965 val_score_bestthr=88.6735 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.288, mb=0.301, no=0.740, corr=-0.810) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 79.1801 -> 67.9965
[DBG][ep=026] disease_pos_weight=1.0000 mode=none
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2793 mb_mean=0.2900 norm_overlap=0.6951 corr_cb=-0.8160 topkJ=0.0000
[TRAIN][ep=026] loss=0.4506 acc=71.14%
[TRAIN][ep=026] mask_avg: mc_mean=0.2856 mb_mean=0.3005 norm_overlap=0.7330 corr_cb=-0.8119
[EPOCH 026/089] train: loss=0.4506 acc=71.14% | val: loss=0.6852 acc=66.13% f1=46.15% auc=53.62% val_score=72.2633 val_score_bestthr=88.6735 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.286, mb=0.301, no=0.733, corr=-0.812) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 79.1801 -> 72.2633
[DBG][ep=027] disease_pos_weight=1.0000 mode=none
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2848 mb_mean=0.3147 norm_overlap=0.7670 corr_cb=-0.8204 topkJ=0.0000
[TRAIN][ep=027] loss=0.4425 acc=72.41%
[TRAIN][ep=027] mask_avg: mc_mean=0.2851 mb_mean=0.3005 norm_overlap=0.7269 corr_cb=-0.8127
[EPOCH 027/089] train: loss=0.4425 acc=72.41% | val: loss=0.6845 acc=66.13% f1=16.00% auc=53.07% val_score=67.0325 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.285, mb=0.301, no=0.727, corr=-0.813) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 79.1801 -> 67.0325
[DBG][ep=028] disease_pos_weight=1.0000 mode=none
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2778 mb_mean=0.3073 norm_overlap=0.7291 corr_cb=-0.8274 topkJ=0.0000
[TRAIN][ep=028] loss=0.4365 acc=72.23%
[TRAIN][ep=028] mask_avg: mc_mean=0.2836 mb_mean=0.3005 norm_overlap=0.7190 corr_cb=-0.8163
[EPOCH 028/089] train: loss=0.4365 acc=72.23% | val: loss=0.6850 acc=66.13% f1=16.00% auc=53.73% val_score=66.0982 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.284, mb=0.300, no=0.719, corr=-0.816) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 79.1801 -> 66.0982
[DBG][ep=029] disease_pos_weight=1.0000 mode=none
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2658 mb_mean=0.2911 norm_overlap=0.7201 corr_cb=-0.7420 topkJ=0.0000
[TRAIN][ep=029] loss=0.4252 acc=74.05%
[TRAIN][ep=029] mask_avg: mc_mean=0.2796 mb_mean=0.3005 norm_overlap=0.7150 corr_cb=-0.8115
[EPOCH 029/089] train: loss=0.4252 acc=74.05% | val: loss=0.6860 acc=66.13% f1=16.00% auc=53.96% val_score=67.0325 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.280, mb=0.300, no=0.715, corr=-0.812) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 79.1801 -> 67.0325
[DBG][ep=030] disease_pos_weight=1.0000 mode=none
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2680 mb_mean=0.3117 norm_overlap=0.7147 corr_cb=-0.7859 topkJ=0.0000
[TRAIN][ep=030] loss=0.4177 acc=74.59%
[TRAIN][ep=030] mask_avg: mc_mean=0.2787 mb_mean=0.3005 norm_overlap=0.7106 corr_cb=-0.8090
[EPOCH 030/089] train: loss=0.4177 acc=74.59% | val: loss=0.6875 acc=66.13% f1=36.36% auc=54.63% val_score=69.0275 val_score_bestthr=83.8323 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.279, mb=0.301, no=0.711, corr=-0.809) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 79.1801 -> 69.0275
[DBG][ep=031] disease_pos_weight=1.0000 mode=none
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2865 mb_mean=0.2865 norm_overlap=0.6343 corr_cb=-0.8525 topkJ=0.0000
[TRAIN][ep=031] loss=0.4071 acc=75.68%
[TRAIN][ep=031] mask_avg: mc_mean=0.2782 mb_mean=0.3005 norm_overlap=0.7085 corr_cb=-0.8074
[EPOCH 031/089] train: loss=0.4071 acc=75.68% | val: loss=0.6881 acc=66.13% f1=16.00% auc=54.63% val_score=71.0401 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.278, mb=0.301, no=0.709, corr=-0.807) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 79.1801 -> 71.0401
[DBG][ep=032] disease_pos_weight=1.0000 mode=none
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2647 mb_mean=0.3106 norm_overlap=0.7829 corr_cb=-0.7647 topkJ=0.0000
[TRAIN][ep=032] loss=0.4070 acc=75.68%
[TRAIN][ep=032] mask_avg: mc_mean=0.2783 mb_mean=0.3005 norm_overlap=0.7087 corr_cb=-0.8063
[EPOCH 032/089] train: loss=0.4070 acc=75.68% | val: loss=0.6877 acc=66.13% f1=36.36% auc=54.40% val_score=69.0275 val_score_bestthr=83.8323 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.278, mb=0.300, no=0.709, corr=-0.806) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 79.1801 -> 69.0275
[DBG][ep=033] disease_pos_weight=1.0000 mode=none
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2908 mb_mean=0.2907 norm_overlap=0.6769 corr_cb=-0.7639 topkJ=0.0000
[TRAIN][ep=033] loss=0.4041 acc=76.41%
[TRAIN][ep=033] mask_avg: mc_mean=0.2782 mb_mean=0.3005 norm_overlap=0.7085 corr_cb=-0.8072
[EPOCH 033/089] train: loss=0.4041 acc=76.41% | val: loss=0.6884 acc=66.13% f1=36.36% auc=54.29% val_score=69.0275 val_score_bestthr=83.8323 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.278, mb=0.301, no=0.709, corr=-0.807) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 79.1801 -> 69.0275
[DBG][ep=034] disease_pos_weight=1.0000 mode=none
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2710 mb_mean=0.3062 norm_overlap=0.7484 corr_cb=-0.7962 topkJ=0.0000
[TRAIN][ep=034] loss=0.4018 acc=75.86%
[TRAIN][ep=034] mask_avg: mc_mean=0.2782 mb_mean=0.3005 norm_overlap=0.7085 corr_cb=-0.8076
[EPOCH 034/089] train: loss=0.4018 acc=75.86% | val: loss=0.6894 acc=66.13% f1=27.59% auc=54.96% val_score=71.0401 val_score_bestthr=79.2085 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.278, mb=0.301, no=0.708, corr=-0.808) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 79.1801 -> 71.0401
[DBG][ep=035] disease_pos_weight=1.0000 mode=none
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2611 mb_mean=0.3191 norm_overlap=0.7761 corr_cb=-0.7585 topkJ=0.0000
[TRAIN][ep=035] loss=0.4014 acc=76.95%
[TRAIN][ep=035] mask_avg: mc_mean=0.2783 mb_mean=0.3005 norm_overlap=0.7084 corr_cb=-0.8072
[EPOCH 035/089] train: loss=0.4014 acc=76.95% | val: loss=0.6886 acc=66.13% f1=16.00% auc=55.07% val_score=69.0275 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.278, mb=0.300, no=0.708, corr=-0.807) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 79.1801 -> 69.0275
[DBG][ep=036] disease_pos_weight=1.0000 mode=none
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2829 mb_mean=0.3125 norm_overlap=0.7262 corr_cb=-0.8362 topkJ=0.0000
[TRAIN][ep=036] loss=0.3993 acc=75.50%
[TRAIN][ep=036] mask_avg: mc_mean=0.2782 mb_mean=0.3005 norm_overlap=0.7085 corr_cb=-0.8077
[EPOCH 036/089] train: loss=0.3993 acc=75.50% | val: loss=0.6884 acc=66.13% f1=16.00% auc=54.40% val_score=65.1455 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.278, mb=0.301, no=0.709, corr=-0.808) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 79.1801 -> 65.1455
[DBG][ep=037] disease_pos_weight=1.0000 mode=none
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.2982 mb_mean=0.2875 norm_overlap=0.6217 corr_cb=-0.8521 topkJ=0.0000
[TRAIN][ep=037] loss=0.3968 acc=75.50%
[TRAIN][ep=037] mask_avg: mc_mean=0.2782 mb_mean=0.3005 norm_overlap=0.7087 corr_cb=-0.8065
[EPOCH 037/089] train: loss=0.3968 acc=75.50% | val: loss=0.6890 acc=66.13% f1=16.00% auc=54.85% val_score=69.0275 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.278, mb=0.301, no=0.709, corr=-0.806) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 79.1801 -> 69.0275
[DBG][ep=038] disease_pos_weight=1.0000 mode=none
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2435 mb_mean=0.3114 norm_overlap=0.7954 corr_cb=-0.6901 topkJ=0.0000
[TRAIN][ep=038] loss=0.3947 acc=75.86%
[TRAIN][ep=038] mask_avg: mc_mean=0.2783 mb_mean=0.3005 norm_overlap=0.7088 corr_cb=-0.8061
[EPOCH 038/089] train: loss=0.3947 acc=75.86% | val: loss=0.6905 acc=66.13% f1=36.36% auc=54.96% val_score=69.0275 val_score_bestthr=83.8128 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.278, mb=0.301, no=0.709, corr=-0.806) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 79.1801 -> 69.0275
[DBG][ep=039] disease_pos_weight=1.0000 mode=none
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2853 mb_mean=0.3004 norm_overlap=0.7106 corr_cb=-0.8458 topkJ=0.0000
[TRAIN][ep=039] loss=0.3932 acc=75.86%
[TRAIN][ep=039] mask_avg: mc_mean=0.2782 mb_mean=0.3005 norm_overlap=0.7088 corr_cb=-0.8067
[EPOCH 039/089] train: loss=0.3932 acc=75.86% | val: loss=0.6898 acc=66.13% f1=32.26% auc=54.85% val_score=69.0275 val_score_bestthr=81.6634 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.278, mb=0.301, no=0.709, corr=-0.807) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 79.1801 -> 69.0275
[DBG][ep=040] disease_pos_weight=1.0000 mode=none
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.2966 mb_mean=0.2778 norm_overlap=0.6040 corr_cb=-0.8584 topkJ=0.0000
[TRAIN][ep=040] loss=0.3924 acc=75.32%
[TRAIN][ep=040] mask_avg: mc_mean=0.2783 mb_mean=0.3005 norm_overlap=0.7086 corr_cb=-0.8067
[EPOCH 040/089] train: loss=0.3924 acc=75.32% | val: loss=0.6914 acc=66.13% f1=16.00% auc=55.18% val_score=71.0401 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.278, mb=0.300, no=0.709, corr=-0.807) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 79.1801 -> 71.0401
[DBG][ep=041] disease_pos_weight=1.0000 mode=none
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.2917 mb_mean=0.2920 norm_overlap=0.6512 corr_cb=-0.8507 topkJ=0.0000
[TRAIN][ep=041] loss=0.3897 acc=76.95%
[TRAIN][ep=041] mask_avg: mc_mean=0.2782 mb_mean=0.3005 norm_overlap=0.7085 corr_cb=-0.8090
[EPOCH 041/089] train: loss=0.3897 acc=76.95% | val: loss=0.6915 acc=66.13% f1=36.36% auc=55.07% val_score=69.0275 val_score_bestthr=83.8128 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.278, mb=0.301, no=0.708, corr=-0.809) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 79.1801 -> 69.0275
[DBG][ep=042] disease_pos_weight=1.0000 mode=none
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.2683 mb_mean=0.3149 norm_overlap=0.7391 corr_cb=-0.8092 topkJ=0.0000
[TRAIN][ep=042] loss=0.3883 acc=76.77%
[TRAIN][ep=042] mask_avg: mc_mean=0.2783 mb_mean=0.3005 norm_overlap=0.7085 corr_cb=-0.8069
[EPOCH 042/089] train: loss=0.3883 acc=76.77% | val: loss=0.6906 acc=66.13% f1=36.36% auc=55.41% val_score=69.0275 val_score_bestthr=83.8128 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.278, mb=0.300, no=0.708, corr=-0.807) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 79.1801 -> 69.0275
[DBG][ep=043] disease_pos_weight=1.0000 mode=none
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.2737 mb_mean=0.3032 norm_overlap=0.7013 corr_cb=-0.8461 topkJ=0.0000
[TRAIN][ep=043] loss=0.3862 acc=76.59%
[TRAIN][ep=043] mask_avg: mc_mean=0.2783 mb_mean=0.3005 norm_overlap=0.7084 corr_cb=-0.8071
[EPOCH 043/089] train: loss=0.3862 acc=76.59% | val: loss=0.6911 acc=66.13% f1=36.36% auc=55.52% val_score=69.0275 val_score_bestthr=83.8128 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.278, mb=0.300, no=0.708, corr=-0.807) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 79.1801 -> 69.0275
[DBG][ep=044] disease_pos_weight=1.0000 mode=none
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2742 mb_mean=0.2914 norm_overlap=0.7485 corr_cb=-0.7329 topkJ=0.0000
[TRAIN][ep=044] loss=0.3847 acc=76.04%
[TRAIN][ep=044] mask_avg: mc_mean=0.2782 mb_mean=0.3005 norm_overlap=0.7085 corr_cb=-0.8072
[EPOCH 044/089] train: loss=0.3847 acc=76.04% | val: loss=0.6918 acc=66.13% f1=36.36% auc=55.30% val_score=69.0275 val_score_bestthr=83.8128 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.278, mb=0.301, no=0.708, corr=-0.807) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 79.1801 -> 69.0275
[DBG][ep=045] disease_pos_weight=1.0000 mode=none
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2695 mb_mean=0.3044 norm_overlap=0.7345 corr_cb=-0.7798 topkJ=0.0000
[TRAIN][ep=045] loss=0.3823 acc=76.59%
[TRAIN][ep=045] mask_avg: mc_mean=0.2783 mb_mean=0.3005 norm_overlap=0.7082 corr_cb=-0.8088
[EPOCH 045/089] train: loss=0.3823 acc=76.59% | val: loss=0.6914 acc=66.13% f1=36.36% auc=55.52% val_score=69.0275 val_score_bestthr=83.8128 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.278, mb=0.301, no=0.708, corr=-0.809) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 79.1801 -> 69.0275
[DBG][ep=046] disease_pos_weight=1.0000 mode=none
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.2666 mb_mean=0.2970 norm_overlap=0.6978 corr_cb=-0.8233 topkJ=0.0000
[TRAIN][ep=046] loss=0.3823 acc=76.59%
[TRAIN][ep=046] mask_avg: mc_mean=0.2783 mb_mean=0.3005 norm_overlap=0.7080 corr_cb=-0.8086
[EPOCH 046/089] train: loss=0.3823 acc=76.59% | val: loss=0.6927 acc=66.13% f1=36.36% auc=55.52% val_score=69.0275 val_score_bestthr=83.8128 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.278, mb=0.301, no=0.708, corr=-0.809) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 79.1801 -> 69.0275
[DBG][ep=047] disease_pos_weight=1.0000 mode=none
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.2758 mb_mean=0.3098 norm_overlap=0.7153 corr_cb=-0.8290 topkJ=0.0000
[TRAIN][ep=047] loss=0.3801 acc=76.41%
[TRAIN][ep=047] mask_avg: mc_mean=0.2782 mb_mean=0.3005 norm_overlap=0.7084 corr_cb=-0.8072
[EPOCH 047/089] train: loss=0.3801 acc=76.41% | val: loss=0.6918 acc=66.13% f1=16.00% auc=55.52% val_score=69.0275 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.278, mb=0.300, no=0.708, corr=-0.807) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 79.1801 -> 69.0275
[EARLY STOP] no improvement for 30 epochs. best_epoch=17
[CKPT] Loaded best for testing: results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
=============== FIT DONE ===============
[BEST] epoch=17 | val_acc=66.13% | val_f1=48.78% | val_auc=56.52% | val_score=79.1801 | val_score_bestthr=89.6553
[TEST@BEST] thr_used=0.420 | acc=67.53% f1=30.56% auc=64.03% | SP_sex=3.37% EO_sex=14.39% SP_age=11.39% EO_age=35.35%
[TIME] 0.71 min
[OK] Saved: results/ADHD_3x5fold_seed0/fold1_rep0_seed1/summary_fold_1.json
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5033 mb_mean=0.5074 norm_overlap=1.0000 corr_cb=-0.0236 topkJ=0.0769
[TRAIN][ep=000] loss=0.6876 acc=61.34%
[TRAIN][ep=000] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1035
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5043 mb_mean=0.5082 norm_overlap=1.0001 corr_cb=0.1648 topkJ=0.0737
[TRAIN][ep=001] loss=0.6755 acc=63.70%
[TRAIN][ep=001] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1054
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5022 mb_mean=0.5087 norm_overlap=1.0002 corr_cb=0.2275 topkJ=0.1455
[TRAIN][ep=002] loss=0.6656 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1043
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5035 mb_mean=0.5094 norm_overlap=1.0000 corr_cb=0.0241 topkJ=0.0509
[TRAIN][ep=003] loss=0.6594 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1050
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5028 mb_mean=0.5106 norm_overlap=1.0000 corr_cb=-0.0149 topkJ=0.0979
[TRAIN][ep=004] loss=0.6565 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1064
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5019 mb_mean=0.5085 norm_overlap=1.0001 corr_cb=0.1280 topkJ=0.1508
[TRAIN][ep=005] loss=0.6563 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1026
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5034 mb_mean=0.5096 norm_overlap=1.0001 corr_cb=0.0714 topkJ=0.1095
[TRAIN][ep=006] loss=0.6540 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1069
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5027 mb_mean=0.5084 norm_overlap=1.0001 corr_cb=0.0800 topkJ=0.0599
[TRAIN][ep=007] loss=0.6536 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1041
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5013 mb_mean=0.5071 norm_overlap=1.0002 corr_cb=0.2685 topkJ=0.0945
[TRAIN][ep=008] loss=0.6521 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1038
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5020 mb_mean=0.5111 norm_overlap=1.0000 corr_cb=0.0016 topkJ=0.0557
[TRAIN][ep=009] loss=0.6513 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1023
================= FIT START (fold=1) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.35 select_by=val_score | eval_thr_mode=best_acc eval_thr_grid=coarse | disease_pos_weight_mode=none freeze_b_after=15 | two_stage=True stage1_ratio=0.35 stage2_lr_mult=0.3 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5045 mb_mean=0.5109 norm_overlap=1.0000 corr_cb=0.0362 topkJ=0.0638
[TRAIN][ep=000] loss=0.6500 acc=63.70%
[TRAIN][ep=000] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1077
[EPOCH 000/089] train: loss=0.6500 acc=63.70% | val: loss=0.6577 acc=62.90% f1=0.00% auc=54.96% val_score=72.0763 val_score_bestthr=62.9032 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.503, mb=0.509, no=1.000, corr=0.108) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* -1000000000000000000.0000 -> 72.0763
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5043 mb_mean=0.5100 norm_overlap=1.0000 corr_cb=-0.0050 topkJ=0.0422
[TRAIN][ep=001] loss=0.6489 acc=63.70%
[TRAIN][ep=001] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1086
[EPOCH 001/089] train: loss=0.6489 acc=63.70% | val: loss=0.6572 acc=64.52% f1=38.89% auc=56.08% val_score=70.1231 val_score_bestthr=83.2578 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.503, mb=0.509, no=1.000, corr=0.109) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 72.0763 -> 70.1231
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5004 mb_mean=0.5099 norm_overlap=1.0001 corr_cb=0.2004 topkJ=0.1277
[TRAIN][ep=002] loss=0.6480 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1068
[EPOCH 002/089] train: loss=0.6480 acc=63.70% | val: loss=0.6569 acc=62.90% f1=30.30% auc=56.19% val_score=74.6247 val_score_bestthr=77.4480 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.503, mb=0.509, no=1.000, corr=0.107) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 72.0763 -> 74.6247
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5013 mb_mean=0.5096 norm_overlap=1.0001 corr_cb=0.1039 topkJ=0.0703
[TRAIN][ep=003] loss=0.6465 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1068
[EPOCH 003/089] train: loss=0.6465 acc=63.70% | val: loss=0.6568 acc=64.52% f1=38.89% auc=57.08% val_score=75.4593 val_score_bestthr=83.2578 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.503, mb=0.509, no=1.000, corr=0.107) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 74.6247 -> 75.4593
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.0595 topkJ=0.0573
[TRAIN][ep=004] loss=0.6452 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1040
[EPOCH 004/089] train: loss=0.6452 acc=63.70% | val: loss=0.6559 acc=66.13% f1=43.24% auc=57.75% val_score=65.9529 val_score_bestthr=87.0247 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.503, mb=0.509, no=1.000, corr=0.104) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 75.4593 -> 65.9529
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5024 mb_mean=0.5096 norm_overlap=1.0000 corr_cb=0.0125 topkJ=0.1126
[TRAIN][ep=005] loss=2.1115 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.4942 mb_mean=0.4996 norm_overlap=1.0001 corr_cb=0.1030
[EPOCH 005/089] train: loss=2.1115 acc=63.70% | val: loss=0.6566 acc=66.13% f1=43.24% auc=57.41% val_score=73.7835 val_score_bestthr=87.0247 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.494, mb=0.500, no=1.000, corr=0.103) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 75.4593 -> 73.7835
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4848 mb_mean=0.4888 norm_overlap=1.0002 corr_cb=0.1748 topkJ=0.0624
[TRAIN][ep=006] loss=2.0979 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.4771 mb_mean=0.4779 norm_overlap=1.0004 corr_cb=0.1905
[EPOCH 006/089] train: loss=2.0979 acc=63.70% | val: loss=0.6568 acc=66.13% f1=46.15% auc=57.97% val_score=74.8509 val_score_bestthr=88.2166 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.477, mb=0.478, no=1.000, corr=0.190) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 75.4593 -> 74.8509
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4680 mb_mean=0.4658 norm_overlap=1.0007 corr_cb=0.2291 topkJ=0.1025
[TRAIN][ep=007] loss=2.0900 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.4597 mb_mean=0.4532 norm_overlap=1.0015 corr_cb=0.3825
[EPOCH 007/089] train: loss=2.0900 acc=63.70% | val: loss=0.6564 acc=64.52% f1=50.00% auc=58.19% val_score=72.8728 val_score_bestthr=88.4099 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.460, mb=0.453, no=1.002, corr=0.383) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 75.4593 -> 72.8728
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4507 mb_mean=0.4451 norm_overlap=1.0027 corr_cb=0.4456 topkJ=0.1683
[TRAIN][ep=008] loss=2.0861 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.4424 mb_mean=0.4268 norm_overlap=1.0032 corr_cb=0.4642
[EPOCH 008/089] train: loss=2.0861 acc=63.70% | val: loss=0.6561 acc=66.13% f1=43.24% auc=57.86% val_score=69.9246 val_score_bestthr=87.0247 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.442, mb=0.427, no=1.003, corr=0.464) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 75.4593 -> 69.9246
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4347 mb_mean=0.4154 norm_overlap=1.0033 corr_cb=0.4976 topkJ=0.2389
[TRAIN][ep=009] loss=2.0802 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.4253 mb_mean=0.4003 norm_overlap=1.0050 corr_cb=0.4394
[EPOCH 009/089] train: loss=2.0802 acc=63.70% | val: loss=0.6560 acc=64.52% f1=50.00% auc=57.86% val_score=75.9395 val_score_bestthr=88.5630 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.425, mb=0.400, no=1.005, corr=0.439) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 75.4593 -> 75.9395
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=010] disease_pos_weight=1.0000 mode=none
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.4225 mb_mean=0.3998 norm_overlap=1.0058 corr_cb=0.4449 topkJ=0.1779
[TRAIN][ep=010] loss=2.0717 acc=63.70%
[TRAIN][ep=010] mask_avg: mc_mean=0.4092 mb_mean=0.3750 norm_overlap=1.0061 corr_cb=0.3410
[EPOCH 010/089] train: loss=2.0717 acc=63.70% | val: loss=0.6554 acc=66.13% f1=36.36% auc=58.42% val_score=60.9033 val_score_bestthr=83.7543 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.409, mb=0.375, no=1.006, corr=0.341) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 75.9395 -> 60.9033
[DBG][ep=011] disease_pos_weight=1.0000 mode=none
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.3926 mb_mean=0.3450 norm_overlap=1.0151 corr_cb=0.4015 topkJ=0.1115
[TRAIN][ep=011] loss=2.0675 acc=63.70%
[TRAIN][ep=011] mask_avg: mc_mean=0.3933 mb_mean=0.3526 norm_overlap=1.0044 corr_cb=0.1587
[EPOCH 011/089] train: loss=2.0675 acc=63.70% | val: loss=0.6553 acc=64.52% f1=56.00% auc=58.75% val_score=67.7762 val_score_bestthr=91.6910 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.393, mb=0.353, no=1.004, corr=0.159) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 75.9395 -> 67.7762
[DBG][ep=012] disease_pos_weight=1.0000 mode=none
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.3890 mb_mean=0.3474 norm_overlap=0.9998 corr_cb=-0.0056 topkJ=0.1209
[TRAIN][ep=012] loss=2.0675 acc=63.70%
[TRAIN][ep=012] mask_avg: mc_mean=0.3785 mb_mean=0.3349 norm_overlap=1.0004 corr_cb=0.0132
[EPOCH 012/089] train: loss=2.0675 acc=63.70% | val: loss=0.6554 acc=66.13% f1=32.26% auc=58.42% val_score=75.9104 val_score_bestthr=81.6375 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.378, mb=0.335, no=1.000, corr=0.013) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 75.9395 -> 75.9104
[DBG][ep=013] disease_pos_weight=1.0000 mode=none
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.3779 mb_mean=0.3305 norm_overlap=0.9981 corr_cb=-0.0501 topkJ=0.0819
[TRAIN][ep=013] loss=2.0547 acc=63.70%
[TRAIN][ep=013] mask_avg: mc_mean=0.3653 mb_mean=0.3198 norm_overlap=0.9900 corr_cb=-0.1800
[EPOCH 013/089] train: loss=2.0547 acc=63.70% | val: loss=0.6560 acc=64.52% f1=42.11% auc=56.97% val_score=65.9914 val_score_bestthr=84.8031 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.365, mb=0.320, no=0.990, corr=-0.180) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 75.9395 -> 65.9914
[DBG][ep=014] disease_pos_weight=1.0000 mode=none
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.3568 mb_mean=0.3197 norm_overlap=0.9791 corr_cb=-0.3324 topkJ=0.0126
[TRAIN][ep=014] loss=2.0447 acc=63.70%
[TRAIN][ep=014] mask_avg: mc_mean=0.3521 mb_mean=0.3078 norm_overlap=0.9667 corr_cb=-0.4079
[EPOCH 014/089] train: loss=2.0447 acc=63.70% | val: loss=0.6560 acc=64.52% f1=50.00% auc=56.86% val_score=65.9914 val_score_bestthr=88.8371 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.352, mb=0.308, no=0.967, corr=-0.408) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 75.9395 -> 65.9914
[DBG][ep=015] disease_pos_weight=1.0000 mode=none
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.3452 mb_mean=0.3013 norm_overlap=0.9530 corr_cb=-0.5211 topkJ=0.0157
[TRAIN][ep=015] loss=2.0428 acc=63.70%
[TRAIN][ep=015] mask_avg: mc_mean=0.3394 mb_mean=0.3031 norm_overlap=0.9390 corr_cb=-0.5621
[EPOCH 015/089] train: loss=2.0428 acc=63.70% | val: loss=0.6552 acc=64.52% f1=52.17% auc=57.30% val_score=77.9697 val_score_bestthr=89.9993 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.339, mb=0.303, no=0.939, corr=-0.562) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=* 75.9395 -> 77.9697
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=016] disease_pos_weight=1.0000 mode=none
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.3306 mb_mean=0.3004 norm_overlap=0.9254 corr_cb=-0.6258 topkJ=0.0008
[TRAIN][ep=016] loss=2.0332 acc=63.70%
[TRAIN][ep=016] mask_avg: mc_mean=0.3292 mb_mean=0.3031 norm_overlap=0.9242 corr_cb=-0.6048
[EPOCH 016/089] train: loss=2.0332 acc=63.70% | val: loss=0.6547 acc=64.52% f1=50.00% auc=56.97% val_score=69.9384 val_score_bestthr=88.8371 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.329, mb=0.303, no=0.924, corr=-0.605) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 77.9697 -> 69.9384
[DBG][ep=017] disease_pos_weight=1.0000 mode=none
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.3240 mb_mean=0.3088 norm_overlap=0.9127 corr_cb=-0.6262 topkJ=0.0008
[TRAIN][ep=017] loss=1.3552 acc=63.70%
[TRAIN][ep=017] mask_avg: mc_mean=0.3198 mb_mean=0.3031 norm_overlap=0.9062 corr_cb=-0.6465
[EPOCH 017/089] train: loss=1.3552 acc=63.70% | val: loss=0.6555 acc=64.52% f1=26.67% auc=56.52% val_score=83.1324 val_score_bestthr=77.2016 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.320, mb=0.303, no=0.906, corr=-0.647) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=* 77.9697 -> 83.1324
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=018] disease_pos_weight=1.0000 mode=none
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.3128 mb_mean=0.3128 norm_overlap=0.9299 corr_cb=-0.5688 topkJ=0.0008
[TRAIN][ep=018] loss=0.6753 acc=63.70%
[TRAIN][ep=018] mask_avg: mc_mean=0.3113 mb_mean=0.3031 norm_overlap=0.8878 corr_cb=-0.6852
[EPOCH 018/089] train: loss=0.6753 acc=63.70% | val: loss=0.6560 acc=64.52% f1=47.62% auc=56.74% val_score=78.2224 val_score_bestthr=87.8294 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.311, mb=0.303, no=0.888, corr=-0.685) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 78.2224
[DBG][ep=019] disease_pos_weight=1.0000 mode=none
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.3152 mb_mean=0.3115 norm_overlap=0.9053 corr_cb=-0.6924 topkJ=0.0000
[TRAIN][ep=019] loss=0.5212 acc=63.70%
[TRAIN][ep=019] mask_avg: mc_mean=0.3042 mb_mean=0.3031 norm_overlap=0.8683 corr_cb=-0.7195
[EPOCH 019/089] train: loss=0.5212 acc=63.70% | val: loss=0.6552 acc=66.13% f1=40.00% auc=55.41% val_score=76.0144 val_score_bestthr=85.7453 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.304, mb=0.303, no=0.868, corr=-0.720) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 76.0144
[DBG][ep=020] disease_pos_weight=1.0000 mode=none
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.3060 mb_mean=0.3002 norm_overlap=0.8408 corr_cb=-0.7357 topkJ=0.0000
[TRAIN][ep=020] loss=0.5138 acc=64.43%
[TRAIN][ep=020] mask_avg: mc_mean=0.2987 mb_mean=0.3031 norm_overlap=0.8473 corr_cb=-0.7468
[EPOCH 020/089] train: loss=0.5138 acc=64.43% | val: loss=0.6564 acc=66.13% f1=43.24% auc=55.07% val_score=73.9567 val_score_bestthr=87.2428 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.299, mb=0.303, no=0.847, corr=-0.747) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 73.9567
[DBG][ep=021] disease_pos_weight=1.0000 mode=none
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2923 mb_mean=0.3006 norm_overlap=0.8192 corr_cb=-0.7929 topkJ=0.0000
[TRAIN][ep=021] loss=0.5033 acc=66.42%
[TRAIN][ep=021] mask_avg: mc_mean=0.2943 mb_mean=0.3031 norm_overlap=0.8227 corr_cb=-0.7780
[EPOCH 021/089] train: loss=0.5033 acc=66.42% | val: loss=0.6590 acc=64.52% f1=42.11% auc=56.63% val_score=73.1226 val_score_bestthr=84.9757 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.294, mb=0.303, no=0.823, corr=-0.778) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 73.1226
[DBG][ep=022] disease_pos_weight=1.0000 mode=none
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.2983 mb_mean=0.3011 norm_overlap=0.8059 corr_cb=-0.8120 topkJ=0.0000
[TRAIN][ep=022] loss=0.4929 acc=68.60%
[TRAIN][ep=022] mask_avg: mc_mean=0.2918 mb_mean=0.3031 norm_overlap=0.8024 corr_cb=-0.7960
[EPOCH 022/089] train: loss=0.4929 acc=68.60% | val: loss=0.6616 acc=64.52% f1=26.67% auc=55.52% val_score=71.0740 val_score_bestthr=77.2502 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.292, mb=0.303, no=0.802, corr=-0.796) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 71.0740
[DBG][ep=023] disease_pos_weight=1.0000 mode=none
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2873 mb_mean=0.3064 norm_overlap=0.7950 corr_cb=-0.8059 topkJ=0.0000
[TRAIN][ep=023] loss=0.4833 acc=70.96%
[TRAIN][ep=023] mask_avg: mc_mean=0.2904 mb_mean=0.3031 norm_overlap=0.7806 corr_cb=-0.8123
[EPOCH 023/089] train: loss=0.4833 acc=70.96% | val: loss=0.6685 acc=64.52% f1=45.00% auc=54.63% val_score=76.1594 val_score_bestthr=86.3985 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.290, mb=0.303, no=0.781, corr=-0.812) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 76.1594
[DBG][ep=024] disease_pos_weight=1.0000 mode=none
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.2991 mb_mean=0.2944 norm_overlap=0.7675 corr_cb=-0.8055 topkJ=0.0000
[TRAIN][ep=024] loss=0.4722 acc=70.24%
[TRAIN][ep=024] mask_avg: mc_mean=0.2882 mb_mean=0.3031 norm_overlap=0.7654 corr_cb=-0.8193
[EPOCH 024/089] train: loss=0.4722 acc=70.24% | val: loss=0.6723 acc=64.52% f1=21.43% auc=53.62% val_score=67.1084 val_score_bestthr=74.6880 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.288, mb=0.303, no=0.765, corr=-0.819) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 67.1084
[DBG][ep=025] disease_pos_weight=1.0000 mode=none
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2728 mb_mean=0.3169 norm_overlap=0.8465 corr_cb=-0.7019 topkJ=0.0000
[TRAIN][ep=025] loss=0.4696 acc=72.23%
[TRAIN][ep=025] mask_avg: mc_mean=0.2881 mb_mean=0.3031 norm_overlap=0.7511 corr_cb=-0.8247
[EPOCH 025/089] train: loss=0.4696 acc=72.23% | val: loss=0.6765 acc=64.52% f1=21.43% auc=52.84% val_score=67.2247 val_score_bestthr=74.6880 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.288, mb=0.303, no=0.751, corr=-0.825) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 67.2247
[DBG][ep=026] disease_pos_weight=1.0000 mode=none
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2792 mb_mean=0.2931 norm_overlap=0.7053 corr_cb=-0.8339 topkJ=0.0000
[TRAIN][ep=026] loss=0.4589 acc=70.96%
[TRAIN][ep=026] mask_avg: mc_mean=0.2857 mb_mean=0.3031 norm_overlap=0.7407 corr_cb=-0.8286
[EPOCH 026/089] train: loss=0.4589 acc=70.96% | val: loss=0.6818 acc=64.52% f1=21.43% auc=53.40% val_score=68.3936 val_score_bestthr=74.6880 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.286, mb=0.303, no=0.741, corr=-0.829) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 68.3936
[DBG][ep=027] disease_pos_weight=1.0000 mode=none
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2851 mb_mean=0.3169 norm_overlap=0.7753 corr_cb=-0.8337 topkJ=0.0000
[TRAIN][ep=027] loss=0.4496 acc=73.50%
[TRAIN][ep=027] mask_avg: mc_mean=0.2844 mb_mean=0.3031 norm_overlap=0.7316 corr_cb=-0.8311
[EPOCH 027/089] train: loss=0.4496 acc=73.50% | val: loss=0.6833 acc=66.13% f1=16.00% auc=52.73% val_score=68.0860 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.284, mb=0.303, no=0.732, corr=-0.831) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 68.0860
[DBG][ep=028] disease_pos_weight=1.0000 mode=none
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2769 mb_mean=0.3098 norm_overlap=0.7349 corr_cb=-0.8432 topkJ=0.0000
[TRAIN][ep=028] loss=0.4426 acc=72.96%
[TRAIN][ep=028] mask_avg: mc_mean=0.2825 mb_mean=0.3031 norm_overlap=0.7213 corr_cb=-0.8363
[EPOCH 028/089] train: loss=0.4426 acc=72.96% | val: loss=0.6850 acc=66.13% f1=16.00% auc=52.17% val_score=70.0121 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.282, mb=0.303, no=0.721, corr=-0.836) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 70.0121
[DBG][ep=029] disease_pos_weight=1.0000 mode=none
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2664 mb_mean=0.2937 norm_overlap=0.7167 corr_cb=-0.7758 topkJ=0.0000
[TRAIN][ep=029] loss=0.4311 acc=74.23%
[TRAIN][ep=029] mask_avg: mc_mean=0.2785 mb_mean=0.3031 norm_overlap=0.7151 corr_cb=-0.8325
[EPOCH 029/089] train: loss=0.4311 acc=74.23% | val: loss=0.6889 acc=66.13% f1=16.00% auc=52.84% val_score=68.0860 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.279, mb=0.303, no=0.715, corr=-0.833) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 68.0860
[DBG][ep=030] disease_pos_weight=1.0000 mode=none
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2649 mb_mean=0.3148 norm_overlap=0.7143 corr_cb=-0.8107 topkJ=0.0000
[TRAIN][ep=030] loss=0.4228 acc=74.95%
[TRAIN][ep=030] mask_avg: mc_mean=0.2773 mb_mean=0.3031 norm_overlap=0.7081 corr_cb=-0.8332
[EPOCH 030/089] train: loss=0.4228 acc=74.95% | val: loss=0.6924 acc=66.13% f1=16.00% auc=52.73% val_score=67.0905 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.277, mb=0.303, no=0.708, corr=-0.833) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 67.0905
[DBG][ep=031] disease_pos_weight=1.0000 mode=none
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2867 mb_mean=0.2896 norm_overlap=0.6242 corr_cb=-0.8772 topkJ=0.0000
[TRAIN][ep=031] loss=0.4117 acc=75.86%
[TRAIN][ep=031] mask_avg: mc_mean=0.2765 mb_mean=0.3031 norm_overlap=0.7048 corr_cb=-0.8328
[EPOCH 031/089] train: loss=0.4117 acc=75.86% | val: loss=0.6935 acc=66.13% f1=16.00% auc=52.84% val_score=71.0026 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.303, no=0.705, corr=-0.833) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 71.0026
[DBG][ep=032] disease_pos_weight=1.0000 mode=none
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2589 mb_mean=0.3130 norm_overlap=0.7888 corr_cb=-0.7848 topkJ=0.0000
[TRAIN][ep=032] loss=0.4115 acc=75.86%
[TRAIN][ep=032] mask_avg: mc_mean=0.2765 mb_mean=0.3031 norm_overlap=0.7050 corr_cb=-0.8317
[EPOCH 032/089] train: loss=0.4115 acc=75.86% | val: loss=0.6935 acc=66.13% f1=16.00% auc=52.29% val_score=67.0905 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.303, no=0.705, corr=-0.832) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 67.0905
[DBG][ep=033] disease_pos_weight=1.0000 mode=none
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2899 mb_mean=0.2934 norm_overlap=0.6666 corr_cb=-0.8003 topkJ=0.0000
[TRAIN][ep=033] loss=0.4085 acc=75.68%
[TRAIN][ep=033] mask_avg: mc_mean=0.2764 mb_mean=0.3031 norm_overlap=0.7048 corr_cb=-0.8327
[EPOCH 033/089] train: loss=0.4085 acc=75.68% | val: loss=0.6945 acc=66.13% f1=16.00% auc=52.29% val_score=67.0905 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.303, no=0.705, corr=-0.833) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 67.0905
[DBG][ep=034] disease_pos_weight=1.0000 mode=none
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2687 mb_mean=0.3087 norm_overlap=0.7500 corr_cb=-0.8216 topkJ=0.0000
[TRAIN][ep=034] loss=0.4061 acc=76.41%
[TRAIN][ep=034] mask_avg: mc_mean=0.2765 mb_mean=0.3031 norm_overlap=0.7049 corr_cb=-0.8330
[EPOCH 034/089] train: loss=0.4061 acc=76.41% | val: loss=0.6962 acc=66.13% f1=16.00% auc=52.95% val_score=68.0146 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.303, no=0.705, corr=-0.833) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 68.0146
[DBG][ep=035] disease_pos_weight=1.0000 mode=none
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2592 mb_mean=0.3213 norm_overlap=0.7719 corr_cb=-0.7845 topkJ=0.0000
[TRAIN][ep=035] loss=0.4057 acc=76.59%
[TRAIN][ep=035] mask_avg: mc_mean=0.2765 mb_mean=0.3031 norm_overlap=0.7048 corr_cb=-0.8325
[EPOCH 035/089] train: loss=0.4057 acc=76.59% | val: loss=0.6956 acc=66.13% f1=16.00% auc=52.84% val_score=69.0566 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.303, no=0.705, corr=-0.832) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 69.0566
[DBG][ep=036] disease_pos_weight=1.0000 mode=none
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2799 mb_mean=0.3150 norm_overlap=0.7245 corr_cb=-0.8675 topkJ=0.0000
[TRAIN][ep=036] loss=0.4034 acc=76.23%
[TRAIN][ep=036] mask_avg: mc_mean=0.2765 mb_mean=0.3031 norm_overlap=0.7048 corr_cb=-0.8332
[EPOCH 036/089] train: loss=0.4034 acc=76.23% | val: loss=0.6958 acc=66.13% f1=16.00% auc=52.62% val_score=67.0905 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.303, no=0.705, corr=-0.833) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 67.0905
[DBG][ep=037] disease_pos_weight=1.0000 mode=none
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.2947 mb_mean=0.2908 norm_overlap=0.6179 corr_cb=-0.8749 topkJ=0.0000
[TRAIN][ep=037] loss=0.4008 acc=76.59%
[TRAIN][ep=037] mask_avg: mc_mean=0.2765 mb_mean=0.3031 norm_overlap=0.7050 corr_cb=-0.8320
[EPOCH 037/089] train: loss=0.4008 acc=76.59% | val: loss=0.6971 acc=66.13% f1=16.00% auc=52.95% val_score=69.0566 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.303, no=0.705, corr=-0.832) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 69.0566
[DBG][ep=038] disease_pos_weight=1.0000 mode=none
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2382 mb_mean=0.3137 norm_overlap=0.7979 corr_cb=-0.7172 topkJ=0.0000
[TRAIN][ep=038] loss=0.3986 acc=76.04%
[TRAIN][ep=038] mask_avg: mc_mean=0.2765 mb_mean=0.3031 norm_overlap=0.7052 corr_cb=-0.8316
[EPOCH 038/089] train: loss=0.3986 acc=76.04% | val: loss=0.6986 acc=66.13% f1=16.00% auc=53.07% val_score=67.9113 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.303, no=0.705, corr=-0.832) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 67.9113
[DBG][ep=039] disease_pos_weight=1.0000 mode=none
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2829 mb_mean=0.3031 norm_overlap=0.7071 corr_cb=-0.8676 topkJ=0.0000
[TRAIN][ep=039] loss=0.3971 acc=75.50%
[TRAIN][ep=039] mask_avg: mc_mean=0.2765 mb_mean=0.3031 norm_overlap=0.7051 corr_cb=-0.8322
[EPOCH 039/089] train: loss=0.3971 acc=75.50% | val: loss=0.6987 acc=66.13% f1=16.00% auc=52.84% val_score=66.0133 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.303, no=0.705, corr=-0.832) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 66.0133
[DBG][ep=040] disease_pos_weight=1.0000 mode=none
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.2945 mb_mean=0.2811 norm_overlap=0.5980 corr_cb=-0.8770 topkJ=0.0000
[TRAIN][ep=040] loss=0.3961 acc=76.23%
[TRAIN][ep=040] mask_avg: mc_mean=0.2765 mb_mean=0.3031 norm_overlap=0.7050 corr_cb=-0.8321
[EPOCH 040/089] train: loss=0.3961 acc=76.23% | val: loss=0.7006 acc=66.13% f1=16.00% auc=53.29% val_score=67.9113 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.303, no=0.705, corr=-0.832) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 67.9113
[DBG][ep=041] disease_pos_weight=1.0000 mode=none
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.2854 mb_mean=0.2950 norm_overlap=0.6482 corr_cb=-0.8650 topkJ=0.0000
[TRAIN][ep=041] loss=0.3936 acc=76.41%
[TRAIN][ep=041] mask_avg: mc_mean=0.2765 mb_mean=0.3031 norm_overlap=0.7047 corr_cb=-0.8345
[EPOCH 041/089] train: loss=0.3936 acc=76.41% | val: loss=0.7010 acc=66.13% f1=16.00% auc=53.18% val_score=67.9113 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.303, no=0.705, corr=-0.834) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 67.9113
[DBG][ep=042] disease_pos_weight=1.0000 mode=none
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.2638 mb_mean=0.3174 norm_overlap=0.7401 corr_cb=-0.8314 topkJ=0.0000
[TRAIN][ep=042] loss=0.3919 acc=76.59%
[TRAIN][ep=042] mask_avg: mc_mean=0.2765 mb_mean=0.3031 norm_overlap=0.7048 corr_cb=-0.8323
[EPOCH 042/089] train: loss=0.3919 acc=76.59% | val: loss=0.7002 acc=66.13% f1=16.00% auc=52.95% val_score=66.0133 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.303, no=0.705, corr=-0.832) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 66.0133
[DBG][ep=043] disease_pos_weight=1.0000 mode=none
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.2719 mb_mean=0.3062 norm_overlap=0.6966 corr_cb=-0.8642 topkJ=0.0000
[TRAIN][ep=043] loss=0.3898 acc=77.68%
[TRAIN][ep=043] mask_avg: mc_mean=0.2765 mb_mean=0.3031 norm_overlap=0.7048 corr_cb=-0.8323
[EPOCH 043/089] train: loss=0.3898 acc=77.68% | val: loss=0.7012 acc=66.13% f1=16.00% auc=53.18% val_score=66.0133 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.277, mb=0.303, no=0.705, corr=-0.832) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 66.0133
[DBG][ep=044] disease_pos_weight=1.0000 mode=none
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2740 mb_mean=0.2936 norm_overlap=0.7426 corr_cb=-0.7746 topkJ=0.0000
[TRAIN][ep=044] loss=0.3883 acc=76.41%
[TRAIN][ep=044] mask_avg: mc_mean=0.2765 mb_mean=0.3031 norm_overlap=0.7048 corr_cb=-0.8327
[EPOCH 044/089] train: loss=0.3883 acc=76.41% | val: loss=0.7022 acc=66.13% f1=16.00% auc=52.95% val_score=66.0133 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.303, no=0.705, corr=-0.833) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 66.0133
[DBG][ep=045] disease_pos_weight=1.0000 mode=none
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2666 mb_mean=0.3066 norm_overlap=0.7351 corr_cb=-0.7934 topkJ=0.0000
[TRAIN][ep=045] loss=0.3859 acc=76.77%
[TRAIN][ep=045] mask_avg: mc_mean=0.2765 mb_mean=0.3031 norm_overlap=0.7045 corr_cb=-0.8340
[EPOCH 045/089] train: loss=0.3859 acc=76.77% | val: loss=0.7021 acc=66.13% f1=16.00% auc=53.07% val_score=67.1239 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.277, mb=0.303, no=0.705, corr=-0.834) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 67.1239
[DBG][ep=046] disease_pos_weight=1.0000 mode=none
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.2639 mb_mean=0.2998 norm_overlap=0.6950 corr_cb=-0.8459 topkJ=0.0000
[TRAIN][ep=046] loss=0.3856 acc=76.41%
[TRAIN][ep=046] mask_avg: mc_mean=0.2765 mb_mean=0.3031 norm_overlap=0.7043 corr_cb=-0.8343
[EPOCH 046/089] train: loss=0.3856 acc=76.41% | val: loss=0.7038 acc=66.13% f1=32.26% auc=53.51% val_score=67.9113 val_score_bestthr=81.6712 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.303, no=0.704, corr=-0.834) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 67.9113
[DBG][ep=047] disease_pos_weight=1.0000 mode=none
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.2743 mb_mean=0.3123 norm_overlap=0.7138 corr_cb=-0.8507 topkJ=0.0000
[TRAIN][ep=047] loss=0.3835 acc=77.13%
[TRAIN][ep=047] mask_avg: mc_mean=0.2765 mb_mean=0.3031 norm_overlap=0.7047 corr_cb=-0.8327
[EPOCH 047/089] train: loss=0.3835 acc=77.13% | val: loss=0.7034 acc=66.13% f1=16.00% auc=53.29% val_score=67.1239 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.276, mb=0.303, no=0.705, corr=-0.833) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 83.1324 -> 67.1239
[EARLY STOP] no improvement for 30 epochs. best_epoch=17
[CKPT] Loaded best for testing: results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
=============== FIT DONE ===============
[BEST] epoch=17 | val_acc=64.52% | val_f1=26.67% | val_auc=56.52% | val_score=83.1324 | val_score_bestthr=77.2016
[TEST@BEST] thr_used=0.400 | acc=66.23% f1=27.78% auc=63.58% | SP_sex=4.82% EO_sex=1.52% SP_age=10.40% EO_age=7.94%
[TIME] 0.80 min
[OK] Saved: results/ADHD_3x5fold_seed0/fold1_rep0_seed1/summary_fold_1.json
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5033 mb_mean=0.5074 norm_overlap=1.0000 corr_cb=-0.0236 topkJ=0.0769
[TRAIN][ep=000] loss=0.6876 acc=61.34%
[TRAIN][ep=000] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1035
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5043 mb_mean=0.5082 norm_overlap=1.0001 corr_cb=0.1648 topkJ=0.0737
[TRAIN][ep=001] loss=0.6755 acc=63.70%
[TRAIN][ep=001] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1054
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5022 mb_mean=0.5087 norm_overlap=1.0002 corr_cb=0.2275 topkJ=0.1455
[TRAIN][ep=002] loss=0.6656 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1043
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5035 mb_mean=0.5094 norm_overlap=1.0000 corr_cb=0.0241 topkJ=0.0509
[TRAIN][ep=003] loss=0.6594 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1050
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5028 mb_mean=0.5106 norm_overlap=1.0000 corr_cb=-0.0149 topkJ=0.0979
[TRAIN][ep=004] loss=0.6565 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1064
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5019 mb_mean=0.5085 norm_overlap=1.0001 corr_cb=0.1280 topkJ=0.1508
[TRAIN][ep=005] loss=0.6563 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1026
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5034 mb_mean=0.5096 norm_overlap=1.0001 corr_cb=0.0714 topkJ=0.1095
[TRAIN][ep=006] loss=0.6540 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1069
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5027 mb_mean=0.5084 norm_overlap=1.0001 corr_cb=0.0800 topkJ=0.0599
[TRAIN][ep=007] loss=0.6536 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1041
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5013 mb_mean=0.5071 norm_overlap=1.0002 corr_cb=0.2685 topkJ=0.0945
[TRAIN][ep=008] loss=0.6521 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1038
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5020 mb_mean=0.5111 norm_overlap=1.0000 corr_cb=0.0016 topkJ=0.0557
[TRAIN][ep=009] loss=0.6513 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1023
================= FIT START (fold=1) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.35 select_by=val_score | eval_thr_mode=best_acc eval_thr_grid=coarse | disease_pos_weight_mode=none freeze_b_after=15 | two_stage=True stage1_ratio=0.35 stage2_lr_mult=0.3 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5045 mb_mean=0.5109 norm_overlap=1.0000 corr_cb=0.0362 topkJ=0.0638
[TRAIN][ep=000] loss=0.6500 acc=63.70%
[TRAIN][ep=000] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1077
[EPOCH 000/089] train: loss=0.6500 acc=63.70% | val: loss=0.6577 acc=62.90% f1=0.00% auc=54.96% val_score=72.0763 val_score_bestthr=62.9032 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.503, mb=0.509, no=1.000, corr=0.108) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* -1000000000000000000.0000 -> 72.0763
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5043 mb_mean=0.5100 norm_overlap=1.0000 corr_cb=-0.0050 topkJ=0.0422
[TRAIN][ep=001] loss=0.6489 acc=63.70%
[TRAIN][ep=001] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1086
[EPOCH 001/089] train: loss=0.6489 acc=63.70% | val: loss=0.6572 acc=64.52% f1=38.89% auc=56.08% val_score=70.1231 val_score_bestthr=83.2578 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.503, mb=0.509, no=1.000, corr=0.109) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 72.0763 -> 70.1231
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5004 mb_mean=0.5099 norm_overlap=1.0001 corr_cb=0.2004 topkJ=0.1277
[TRAIN][ep=002] loss=0.6480 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1068
[EPOCH 002/089] train: loss=0.6480 acc=63.70% | val: loss=0.6569 acc=62.90% f1=30.30% auc=56.19% val_score=74.6247 val_score_bestthr=77.4480 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.503, mb=0.509, no=1.000, corr=0.107) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 72.0763 -> 74.6247
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5013 mb_mean=0.5096 norm_overlap=1.0001 corr_cb=0.1039 topkJ=0.0703
[TRAIN][ep=003] loss=0.6465 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1068
[EPOCH 003/089] train: loss=0.6465 acc=63.70% | val: loss=0.6568 acc=64.52% f1=38.89% auc=57.19% val_score=75.4593 val_score_bestthr=83.2578 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.503, mb=0.509, no=1.000, corr=0.107) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 74.6247 -> 75.4593
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.0595 topkJ=0.0573
[TRAIN][ep=004] loss=0.6452 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1040
[EPOCH 004/089] train: loss=0.6452 acc=63.70% | val: loss=0.6559 acc=66.13% f1=43.24% auc=57.75% val_score=65.9529 val_score_bestthr=87.0247 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.503, mb=0.509, no=1.000, corr=0.104) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 75.4593 -> 65.9529
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5024 mb_mean=0.5096 norm_overlap=1.0000 corr_cb=0.0125 topkJ=0.1126
[TRAIN][ep=005] loss=1.4489 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.4934 mb_mean=0.4871 norm_overlap=1.0003 corr_cb=0.2095
[EPOCH 005/089] train: loss=1.4489 acc=63.70% | val: loss=0.6562 acc=66.13% f1=43.24% auc=57.53% val_score=70.8006 val_score_bestthr=87.0247 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.493, mb=0.487, no=1.000, corr=0.209) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 75.4593 -> 70.8006
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4834 mb_mean=0.4636 norm_overlap=1.0008 corr_cb=0.3547 topkJ=0.1199
[TRAIN][ep=006] loss=1.4500 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.4754 mb_mean=0.4412 norm_overlap=1.0015 corr_cb=0.3674
[EPOCH 006/089] train: loss=1.4500 acc=63.70% | val: loss=0.6564 acc=66.13% f1=51.16% auc=58.31% val_score=72.8728 val_score_bestthr=90.6597 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.475, mb=0.441, no=1.002, corr=0.367) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 75.4593 -> 72.8728
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4660 mb_mean=0.4191 norm_overlap=1.0024 corr_cb=0.3657 topkJ=0.1371
[TRAIN][ep=007] loss=1.4447 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.4577 mb_mean=0.3951 norm_overlap=1.0035 corr_cb=0.3866
[EPOCH 007/089] train: loss=1.4447 acc=63.70% | val: loss=0.6561 acc=66.13% f1=53.33% auc=58.31% val_score=75.9800 val_score_bestthr=91.8936 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.458, mb=0.395, no=1.003, corr=0.387) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 75.4593 -> 75.9800
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4487 mb_mean=0.3855 norm_overlap=1.0056 corr_cb=0.4144 topkJ=0.1807
[TRAIN][ep=008] loss=1.4397 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.4407 mb_mean=0.3552 norm_overlap=1.0049 corr_cb=0.3111
[EPOCH 008/089] train: loss=1.4397 acc=63.70% | val: loss=0.6558 acc=66.13% f1=43.24% auc=58.31% val_score=71.9285 val_score_bestthr=87.0247 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.441, mb=0.355, no=1.005, corr=0.311) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 75.9800 -> 71.9285
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4332 mb_mean=0.3391 norm_overlap=1.0046 corr_cb=0.2790 topkJ=0.1466
[TRAIN][ep=009] loss=1.4347 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.4243 mb_mean=0.3254 norm_overlap=1.0032 corr_cb=0.1277
[EPOCH 009/089] train: loss=1.4347 acc=63.70% | val: loss=0.6560 acc=66.13% f1=51.16% auc=58.08% val_score=80.0062 val_score_bestthr=90.8128 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.424, mb=0.325, no=1.003, corr=0.128) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 75.9800 -> 80.0062
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=010] disease_pos_weight=1.0000 mode=none
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.4217 mb_mean=0.3351 norm_overlap=1.0001 corr_cb=0.0038 topkJ=0.0636
[TRAIN][ep=010] loss=1.4267 acc=63.70%
[TRAIN][ep=010] mask_avg: mc_mean=0.4082 mb_mean=0.3051 norm_overlap=0.9933 corr_cb=-0.1490
[EPOCH 010/089] train: loss=1.4267 acc=63.70% | val: loss=0.6555 acc=64.52% f1=50.00% auc=58.42% val_score=62.8082 val_score_bestthr=88.5788 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.408, mb=0.305, no=0.993, corr=-0.149) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 80.0062 -> 62.8082
[DBG][ep=011] disease_pos_weight=1.0000 mode=none
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.3943 mb_mean=0.2745 norm_overlap=0.9873 corr_cb=-0.1597 topkJ=0.0189
[TRAIN][ep=011] loss=1.4210 acc=63.70%
[TRAIN][ep=011] mask_avg: mc_mean=0.3905 mb_mean=0.2939 norm_overlap=0.9648 corr_cb=-0.4706
[EPOCH 011/089] train: loss=1.4210 acc=63.70% | val: loss=0.6557 acc=64.52% f1=52.17% auc=58.19% val_score=73.7691 val_score_bestthr=89.7162 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.390, mb=0.294, no=0.965, corr=-0.471) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 80.0062 -> 73.7691
[DBG][ep=012] disease_pos_weight=1.0000 mode=none
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.3828 mb_mean=0.2963 norm_overlap=0.9410 corr_cb=-0.6643 topkJ=0.0008
[TRAIN][ep=012] loss=1.4160 acc=63.70%
[TRAIN][ep=012] mask_avg: mc_mean=0.3711 mb_mean=0.2926 norm_overlap=0.9010 corr_cb=-0.7373
[EPOCH 012/089] train: loss=1.4160 acc=63.70% | val: loss=0.6561 acc=64.52% f1=50.00% auc=58.19% val_score=82.0214 val_score_bestthr=88.5788 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.371, mb=0.293, no=0.901, corr=-0.737) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 80.0062 -> 82.0214
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=013] disease_pos_weight=1.0000 mode=none
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.3696 mb_mean=0.2873 norm_overlap=0.8732 corr_cb=-0.8219 topkJ=0.0000
[TRAIN][ep=013] loss=0.9874 acc=63.70%
[TRAIN][ep=013] mask_avg: mc_mean=0.3511 mb_mean=0.2950 norm_overlap=0.7996 corr_cb=-0.8707
[EPOCH 013/089] train: loss=0.9874 acc=63.70% | val: loss=0.6564 acc=64.52% f1=15.38% auc=57.30% val_score=80.9461 val_score_bestthr=71.6233 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.351, mb=0.295, no=0.800, corr=-0.871) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 82.0214 -> 80.9461
[DBG][ep=014] disease_pos_weight=1.0000 mode=none
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.3333 mb_mean=0.3077 norm_overlap=0.7398 corr_cb=-0.9166 topkJ=0.0000
[TRAIN][ep=014] loss=0.5619 acc=63.70%
[TRAIN][ep=014] mask_avg: mc_mean=0.3321 mb_mean=0.2933 norm_overlap=0.6709 corr_cb=-0.9138
[EPOCH 014/089] train: loss=0.5619 acc=63.70% | val: loss=0.6559 acc=64.52% f1=21.43% auc=56.74% val_score=79.9940 val_score_bestthr=74.4780 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.332, mb=0.293, no=0.671, corr=-0.914) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 82.0214 -> 79.9940
[DBG][ep=015] disease_pos_weight=1.0000 mode=none
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.3262 mb_mean=0.2771 norm_overlap=0.5899 corr_cb=-0.9272 topkJ=0.0000
[TRAIN][ep=015] loss=0.5238 acc=63.70%
[TRAIN][ep=015] mask_avg: mc_mean=0.3166 mb_mean=0.2908 norm_overlap=0.5611 corr_cb=-0.9180
[EPOCH 015/089] train: loss=0.5238 acc=63.70% | val: loss=0.6555 acc=66.13% f1=16.00% auc=55.41% val_score=80.0697 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.317, mb=0.291, no=0.561, corr=-0.918) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 82.0214 -> 80.0697
[DBG][ep=016] disease_pos_weight=1.0000 mode=none
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.3074 mb_mean=0.2906 norm_overlap=0.5057 corr_cb=-0.9343 topkJ=0.0000
[TRAIN][ep=016] loss=0.4997 acc=64.25%
[TRAIN][ep=016] mask_avg: mc_mean=0.3069 mb_mean=0.2908 norm_overlap=0.4993 corr_cb=-0.9121
[EPOCH 016/089] train: loss=0.4997 acc=64.25% | val: loss=0.6567 acc=64.52% f1=8.33% auc=54.74% val_score=75.9519 val_score_bestthr=68.3767 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.307, mb=0.291, no=0.499, corr=-0.912) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 82.0214 -> 75.9519
[DBG][ep=017] disease_pos_weight=1.0000 mode=none
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.3046 mb_mean=0.3034 norm_overlap=0.4697 corr_cb=-0.9048 topkJ=0.0000
[TRAIN][ep=017] loss=0.4874 acc=66.42%
[TRAIN][ep=017] mask_avg: mc_mean=0.3025 mb_mean=0.2908 norm_overlap=0.4526 corr_cb=-0.9026
[EPOCH 017/089] train: loss=0.4874 acc=66.42% | val: loss=0.6601 acc=64.52% f1=21.43% auc=55.07% val_score=81.2727 val_score_bestthr=74.5444 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.302, mb=0.291, no=0.453, corr=-0.903) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 82.0214 -> 81.2727
[DBG][ep=018] disease_pos_weight=1.0000 mode=none
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.2929 mb_mean=0.2910 norm_overlap=0.4873 corr_cb=-0.8957 topkJ=0.0000
[TRAIN][ep=018] loss=0.4813 acc=66.42%
[TRAIN][ep=018] mask_avg: mc_mean=0.3001 mb_mean=0.2908 norm_overlap=0.4167 corr_cb=-0.8924
[EPOCH 018/089] train: loss=0.4813 acc=66.42% | val: loss=0.6635 acc=64.52% f1=42.11% auc=54.29% val_score=75.0993 val_score_bestthr=85.2160 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.300, mb=0.291, no=0.417, corr=-0.892) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 82.0214 -> 75.0993
[DBG][ep=019] disease_pos_weight=1.0000 mode=none
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.3000 mb_mean=0.2781 norm_overlap=0.4669 corr_cb=-0.8882 topkJ=0.0000
[TRAIN][ep=019] loss=0.4674 acc=67.88%
[TRAIN][ep=019] mask_avg: mc_mean=0.3002 mb_mean=0.2908 norm_overlap=0.3886 corr_cb=-0.8824
[EPOCH 019/089] train: loss=0.4674 acc=67.88% | val: loss=0.6673 acc=64.52% f1=38.89% auc=53.96% val_score=69.0619 val_score_bestthr=83.5189 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.300, mb=0.291, no=0.389, corr=-0.882) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 82.0214 -> 69.0619
[DBG][ep=020] disease_pos_weight=1.0000 mode=none
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.3112 mb_mean=0.2983 norm_overlap=0.3586 corr_cb=-0.8864 topkJ=0.0000
[TRAIN][ep=020] loss=0.4604 acc=69.15%
[TRAIN][ep=020] mask_avg: mc_mean=0.2995 mb_mean=0.2908 norm_overlap=0.3686 corr_cb=-0.8735
[EPOCH 020/089] train: loss=0.4604 acc=69.15% | val: loss=0.6722 acc=64.52% f1=45.00% auc=53.85% val_score=69.0619 val_score_bestthr=86.5291 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.299, mb=0.291, no=0.369, corr=-0.873) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 82.0214 -> 69.0619
[DBG][ep=021] disease_pos_weight=1.0000 mode=none
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.2957 mb_mean=0.2942 norm_overlap=0.3285 corr_cb=-0.8668 topkJ=0.0000
[TRAIN][ep=021] loss=0.4509 acc=71.32%
[TRAIN][ep=021] mask_avg: mc_mean=0.3005 mb_mean=0.2908 norm_overlap=0.3516 corr_cb=-0.8658
[EPOCH 021/089] train: loss=0.4509 acc=71.32% | val: loss=0.6762 acc=66.13% f1=46.15% auc=53.96% val_score=70.0277 val_score_bestthr=88.6735 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.300, mb=0.291, no=0.352, corr=-0.866) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 82.0214 -> 70.0277
[DBG][ep=022] disease_pos_weight=1.0000 mode=none
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.3052 mb_mean=0.2807 norm_overlap=0.3521 corr_cb=-0.8669 topkJ=0.0000
[TRAIN][ep=022] loss=0.4428 acc=69.33%
[TRAIN][ep=022] mask_avg: mc_mean=0.2983 mb_mean=0.2908 norm_overlap=0.3410 corr_cb=-0.8594
[EPOCH 022/089] train: loss=0.4428 acc=69.33% | val: loss=0.6774 acc=64.52% f1=45.00% auc=53.85% val_score=70.0277 val_score_bestthr=86.4610 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.298, mb=0.291, no=0.341, corr=-0.859) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 82.0214 -> 70.0277
[DBG][ep=023] disease_pos_weight=1.0000 mode=none
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.2949 mb_mean=0.3017 norm_overlap=0.3313 corr_cb=-0.8489 topkJ=0.0000
[TRAIN][ep=023] loss=0.4351 acc=71.14%
[TRAIN][ep=023] mask_avg: mc_mean=0.2988 mb_mean=0.2908 norm_overlap=0.3296 corr_cb=-0.8530
[EPOCH 023/089] train: loss=0.4351 acc=71.14% | val: loss=0.6858 acc=64.52% f1=42.11% auc=53.40% val_score=82.3458 val_score_bestthr=85.2160 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.299, mb=0.291, no=0.330, corr=-0.853) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=* 82.0214 -> 82.3458
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=024] disease_pos_weight=1.0000 mode=none
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.3145 mb_mean=0.2770 norm_overlap=0.3078 corr_cb=-0.8557 topkJ=0.0000
[TRAIN][ep=024] loss=0.4261 acc=70.05%
[TRAIN][ep=024] mask_avg: mc_mean=0.2954 mb_mean=0.2908 norm_overlap=0.3200 corr_cb=-0.8463
[EPOCH 024/089] train: loss=0.4261 acc=70.05% | val: loss=0.6876 acc=64.52% f1=45.00% auc=53.29% val_score=69.9338 val_score_bestthr=86.5291 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.295, mb=0.291, no=0.320, corr=-0.846) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 82.3458 -> 69.9338
[DBG][ep=025] disease_pos_weight=1.0000 mode=none
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.2759 mb_mean=0.2851 norm_overlap=0.4187 corr_cb=-0.8118 topkJ=0.0000
[TRAIN][ep=025] loss=0.4254 acc=71.51%
[TRAIN][ep=025] mask_avg: mc_mean=0.2958 mb_mean=0.2908 norm_overlap=0.3131 corr_cb=-0.8411
[EPOCH 025/089] train: loss=0.4254 acc=71.51% | val: loss=0.6866 acc=64.52% f1=15.38% auc=53.18% val_score=67.9965 val_score_bestthr=71.5986 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.296, mb=0.291, no=0.313, corr=-0.841) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 82.3458 -> 67.9965
[DBG][ep=026] disease_pos_weight=1.0000 mode=none
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.2907 mb_mean=0.3025 norm_overlap=0.2477 corr_cb=-0.8334 topkJ=0.0000
[TRAIN][ep=026] loss=0.4156 acc=72.05%
[TRAIN][ep=026] mask_avg: mc_mean=0.2924 mb_mean=0.2909 norm_overlap=0.3067 corr_cb=-0.8375
[EPOCH 026/089] train: loss=0.4156 acc=72.05% | val: loss=0.6900 acc=64.52% f1=42.11% auc=52.84% val_score=69.1138 val_score_bestthr=85.2160 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.292, mb=0.291, no=0.307, corr=-0.838) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 82.3458 -> 69.1138
[DBG][ep=027] disease_pos_weight=1.0000 mode=none
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.2873 mb_mean=0.2978 norm_overlap=0.3496 corr_cb=-0.8599 topkJ=0.0000
[TRAIN][ep=027] loss=0.4071 acc=72.78%
[TRAIN][ep=027] mask_avg: mc_mean=0.2916 mb_mean=0.2908 norm_overlap=0.3011 corr_cb=-0.8332
[EPOCH 027/089] train: loss=0.4071 acc=72.78% | val: loss=0.6914 acc=66.13% f1=16.00% auc=52.62% val_score=73.0015 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.292, mb=0.291, no=0.301, corr=-0.833) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 82.3458 -> 73.0015
[DBG][ep=028] disease_pos_weight=1.0000 mode=none
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.2818 mb_mean=0.2997 norm_overlap=0.3042 corr_cb=-0.8413 topkJ=0.0000
[TRAIN][ep=028] loss=0.4011 acc=72.96%
[TRAIN][ep=028] mask_avg: mc_mean=0.2908 mb_mean=0.2908 norm_overlap=0.2940 corr_cb=-0.8283
[EPOCH 028/089] train: loss=0.4011 acc=72.96% | val: loss=0.6930 acc=66.13% f1=16.00% auc=52.29% val_score=73.0015 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.291, mb=0.291, no=0.294, corr=-0.828) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 82.3458 -> 73.0015
[DBG][ep=029] disease_pos_weight=1.0000 mode=none
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2723 mb_mean=0.2774 norm_overlap=0.2985 corr_cb=-0.7730 topkJ=0.0000
[TRAIN][ep=029] loss=0.3900 acc=75.32%
[TRAIN][ep=029] mask_avg: mc_mean=0.2867 mb_mean=0.2908 norm_overlap=0.2885 corr_cb=-0.8230
[EPOCH 029/089] train: loss=0.3900 acc=75.32% | val: loss=0.6935 acc=66.13% f1=16.00% auc=52.62% val_score=73.0015 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.287, mb=0.291, no=0.288, corr=-0.823) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 82.3458 -> 73.0015
[DBG][ep=030] disease_pos_weight=1.0000 mode=none
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2717 mb_mean=0.3246 norm_overlap=0.2886 corr_cb=-0.8307 topkJ=0.0000
[TRAIN][ep=030] loss=0.3826 acc=75.32%
[TRAIN][ep=030] mask_avg: mc_mean=0.2862 mb_mean=0.2909 norm_overlap=0.2849 corr_cb=-0.8183
[EPOCH 030/089] train: loss=0.3826 acc=75.32% | val: loss=0.6967 acc=66.13% f1=32.26% auc=52.06% val_score=71.0401 val_score_bestthr=81.7416 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.286, mb=0.291, no=0.285, corr=-0.818) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 82.3458 -> 71.0401
[DBG][ep=031] disease_pos_weight=1.0000 mode=none
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2926 mb_mean=0.3037 norm_overlap=0.2206 corr_cb=-0.8232 topkJ=0.0000
[TRAIN][ep=031] loss=0.3721 acc=76.41%
[TRAIN][ep=031] mask_avg: mc_mean=0.2861 mb_mean=0.2908 norm_overlap=0.2833 corr_cb=-0.8155
[EPOCH 031/089] train: loss=0.3721 acc=76.41% | val: loss=0.6979 acc=66.13% f1=32.26% auc=52.40% val_score=73.0015 val_score_bestthr=81.7416 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.286, mb=0.291, no=0.283, corr=-0.816) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 82.3458 -> 73.0015
[DBG][ep=032] disease_pos_weight=1.0000 mode=none
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2702 mb_mean=0.2885 norm_overlap=0.3417 corr_cb=-0.8246 topkJ=0.0000
[TRAIN][ep=032] loss=0.3719 acc=75.32%
[TRAIN][ep=032] mask_avg: mc_mean=0.2861 mb_mean=0.2908 norm_overlap=0.2831 corr_cb=-0.8147
[EPOCH 032/089] train: loss=0.3719 acc=75.32% | val: loss=0.6972 acc=66.13% f1=32.26% auc=52.40% val_score=71.0401 val_score_bestthr=81.7416 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.286, mb=0.291, no=0.283, corr=-0.815) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 82.3458 -> 71.0401
[DBG][ep=033] disease_pos_weight=1.0000 mode=none
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.3010 mb_mean=0.2896 norm_overlap=0.2714 corr_cb=-0.7867 topkJ=0.0000
[TRAIN][ep=033] loss=0.3691 acc=76.59%
[TRAIN][ep=033] mask_avg: mc_mean=0.2861 mb_mean=0.2908 norm_overlap=0.2829 corr_cb=-0.8152
[EPOCH 033/089] train: loss=0.3691 acc=76.59% | val: loss=0.6982 acc=66.13% f1=32.26% auc=52.06% val_score=71.0401 val_score_bestthr=81.7416 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.286, mb=0.291, no=0.283, corr=-0.815) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 82.3458 -> 71.0401
[DBG][ep=034] disease_pos_weight=1.0000 mode=none
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2795 mb_mean=0.2878 norm_overlap=0.3107 corr_cb=-0.8201 topkJ=0.0000
[TRAIN][ep=034] loss=0.3668 acc=76.77%
[TRAIN][ep=034] mask_avg: mc_mean=0.2861 mb_mean=0.2908 norm_overlap=0.2826 corr_cb=-0.8154
[EPOCH 034/089] train: loss=0.3668 acc=76.77% | val: loss=0.7000 acc=66.13% f1=22.22% auc=53.29% val_score=75.0189 val_score_bestthr=76.5359 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.286, mb=0.291, no=0.283, corr=-0.815) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 82.3458 -> 75.0189
[DBG][ep=035] disease_pos_weight=1.0000 mode=none
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2632 mb_mean=0.3050 norm_overlap=0.3424 corr_cb=-0.8240 topkJ=0.0000
[TRAIN][ep=035] loss=0.3663 acc=76.23%
[TRAIN][ep=035] mask_avg: mc_mean=0.2861 mb_mean=0.2908 norm_overlap=0.2825 corr_cb=-0.8151
[EPOCH 035/089] train: loss=0.3663 acc=76.23% | val: loss=0.6988 acc=66.13% f1=16.00% auc=52.73% val_score=71.0401 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.286, mb=0.291, no=0.282, corr=-0.815) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 82.3458 -> 71.0401
[DBG][ep=036] disease_pos_weight=1.0000 mode=none
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2862 mb_mean=0.2944 norm_overlap=0.3198 corr_cb=-0.8408 topkJ=0.0000
[TRAIN][ep=036] loss=0.3644 acc=76.95%
[TRAIN][ep=036] mask_avg: mc_mean=0.2861 mb_mean=0.2908 norm_overlap=0.2829 corr_cb=-0.8155
[EPOCH 036/089] train: loss=0.3644 acc=76.95% | val: loss=0.6990 acc=66.13% f1=16.00% auc=53.40% val_score=69.0275 val_score_bestthr=73.5795 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.286, mb=0.291, no=0.283, corr=-0.815) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 82.3458 -> 69.0275
[DBG][ep=037] disease_pos_weight=1.0000 mode=none
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.3070 mb_mean=0.3010 norm_overlap=0.2228 corr_cb=-0.8210 topkJ=0.0000
[TRAIN][ep=037] loss=0.3615 acc=76.41%
[TRAIN][ep=037] mask_avg: mc_mean=0.2861 mb_mean=0.2908 norm_overlap=0.2832 corr_cb=-0.8153
[EPOCH 037/089] train: loss=0.3615 acc=76.41% | val: loss=0.7002 acc=66.13% f1=22.22% auc=53.29% val_score=71.0401 val_score_bestthr=76.5359 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.286, mb=0.291, no=0.283, corr=-0.815) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 82.3458 -> 71.0401
[DBG][ep=038] disease_pos_weight=1.0000 mode=none
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2525 mb_mean=0.2918 norm_overlap=0.3367 corr_cb=-0.7961 topkJ=0.0000
[TRAIN][ep=038] loss=0.3595 acc=76.77%
[TRAIN][ep=038] mask_avg: mc_mean=0.2861 mb_mean=0.2908 norm_overlap=0.2835 corr_cb=-0.8156
[EPOCH 038/089] train: loss=0.3595 acc=76.77% | val: loss=0.7023 acc=66.13% f1=22.22% auc=53.73% val_score=73.0798 val_score_bestthr=76.5359 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.286, mb=0.291, no=0.284, corr=-0.816) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 82.3458 -> 73.0798
[DBG][ep=039] disease_pos_weight=1.0000 mode=none
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2960 mb_mean=0.2962 norm_overlap=0.2619 corr_cb=-0.8456 topkJ=0.0000
[TRAIN][ep=039] loss=0.3581 acc=76.95%
[TRAIN][ep=039] mask_avg: mc_mean=0.2861 mb_mean=0.2908 norm_overlap=0.2835 corr_cb=-0.8154
[EPOCH 039/089] train: loss=0.3581 acc=76.95% | val: loss=0.7012 acc=66.13% f1=22.22% auc=53.85% val_score=71.0401 val_score_bestthr=76.5359 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.286, mb=0.291, no=0.283, corr=-0.815) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 82.3458 -> 71.0401
[DBG][ep=040] disease_pos_weight=1.0000 mode=none
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.3090 mb_mean=0.2922 norm_overlap=0.1871 corr_cb=-0.8052 topkJ=0.0000
[TRAIN][ep=040] loss=0.3573 acc=76.59%
[TRAIN][ep=040] mask_avg: mc_mean=0.2861 mb_mean=0.2908 norm_overlap=0.2831 corr_cb=-0.8154
[EPOCH 040/089] train: loss=0.3573 acc=76.59% | val: loss=0.7039 acc=66.13% f1=27.59% auc=54.40% val_score=73.0798 val_score_bestthr=79.2187 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.286, mb=0.291, no=0.283, corr=-0.815) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 82.3458 -> 73.0798
[DBG][ep=041] disease_pos_weight=1.0000 mode=none
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.3026 mb_mean=0.3016 norm_overlap=0.2197 corr_cb=-0.8214 topkJ=0.0000
[TRAIN][ep=041] loss=0.3546 acc=76.95%
[TRAIN][ep=041] mask_avg: mc_mean=0.2861 mb_mean=0.2908 norm_overlap=0.2825 corr_cb=-0.8157
[EPOCH 041/089] train: loss=0.3546 acc=76.95% | val: loss=0.7048 acc=66.13% f1=27.59% auc=53.96% val_score=73.0798 val_score_bestthr=79.2187 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.286, mb=0.291, no=0.282, corr=-0.816) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 82.3458 -> 73.0798
[DBG][ep=042] disease_pos_weight=1.0000 mode=none
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.2748 mb_mean=0.3098 norm_overlap=0.3075 corr_cb=-0.8339 topkJ=0.0000
[TRAIN][ep=042] loss=0.3530 acc=76.95%
[TRAIN][ep=042] mask_avg: mc_mean=0.2861 mb_mean=0.2908 norm_overlap=0.2828 corr_cb=-0.8152
[EPOCH 042/089] train: loss=0.3530 acc=76.95% | val: loss=0.7037 acc=66.13% f1=27.59% auc=53.96% val_score=69.0275 val_score_bestthr=79.2187 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.286, mb=0.291, no=0.283, corr=-0.815) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 82.3458 -> 69.0275
[DBG][ep=043] disease_pos_weight=1.0000 mode=none
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.2804 mb_mean=0.3086 norm_overlap=0.2567 corr_cb=-0.8244 topkJ=0.0000
[TRAIN][ep=043] loss=0.3509 acc=77.31%
[TRAIN][ep=043] mask_avg: mc_mean=0.2861 mb_mean=0.2908 norm_overlap=0.2829 corr_cb=-0.8151
[EPOCH 043/089] train: loss=0.3509 acc=77.31% | val: loss=0.7044 acc=66.13% f1=27.59% auc=53.96% val_score=71.0073 val_score_bestthr=79.2187 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.286, mb=0.291, no=0.283, corr=-0.815) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 82.3458 -> 71.0073
[DBG][ep=044] disease_pos_weight=1.0000 mode=none
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2884 mb_mean=0.2624 norm_overlap=0.3128 corr_cb=-0.8000 topkJ=0.0000
[TRAIN][ep=044] loss=0.3494 acc=78.04%
[TRAIN][ep=044] mask_avg: mc_mean=0.2861 mb_mean=0.2908 norm_overlap=0.2835 corr_cb=-0.8156
[EPOCH 044/089] train: loss=0.3494 acc=78.04% | val: loss=0.7053 acc=66.13% f1=27.59% auc=54.07% val_score=69.0275 val_score_bestthr=79.2187 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.286, mb=0.291, no=0.283, corr=-0.816) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 82.3458 -> 69.0275
[DBG][ep=045] disease_pos_weight=1.0000 mode=none
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2793 mb_mean=0.2725 norm_overlap=0.3215 corr_cb=-0.7814 topkJ=0.0000
[TRAIN][ep=045] loss=0.3471 acc=77.68%
[TRAIN][ep=045] mask_avg: mc_mean=0.2861 mb_mean=0.2908 norm_overlap=0.2822 corr_cb=-0.8154
[EPOCH 045/089] train: loss=0.3471 acc=77.68% | val: loss=0.7051 acc=66.13% f1=22.22% auc=53.96% val_score=69.0275 val_score_bestthr=76.5359 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.286, mb=0.291, no=0.282, corr=-0.815) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 82.3458 -> 69.0275
[DBG][ep=046] disease_pos_weight=1.0000 mode=none
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.2786 mb_mean=0.2923 norm_overlap=0.2549 corr_cb=-0.7978 topkJ=0.0000
[TRAIN][ep=046] loss=0.3472 acc=78.04%
[TRAIN][ep=046] mask_avg: mc_mean=0.2861 mb_mean=0.2908 norm_overlap=0.2828 corr_cb=-0.8155
[EPOCH 046/089] train: loss=0.3472 acc=78.04% | val: loss=0.7068 acc=66.13% f1=27.59% auc=54.18% val_score=71.0073 val_score_bestthr=79.2187 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.286, mb=0.291, no=0.283, corr=-0.815) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 82.3458 -> 71.0073
[DBG][ep=047] disease_pos_weight=1.0000 mode=none
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.2821 mb_mean=0.3032 norm_overlap=0.3001 corr_cb=-0.8168 topkJ=0.0000
[TRAIN][ep=047] loss=0.3449 acc=78.77%
[TRAIN][ep=047] mask_avg: mc_mean=0.2861 mb_mean=0.2908 norm_overlap=0.2827 corr_cb=-0.8150
[EPOCH 047/089] train: loss=0.3449 acc=78.77% | val: loss=0.7060 acc=66.13% f1=27.59% auc=53.73% val_score=67.0614 val_score_bestthr=79.2187 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.286, mb=0.291, no=0.283, corr=-0.815) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 82.3458 -> 67.0614
[DBG][ep=048] disease_pos_weight=1.0000 mode=none
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.2987 mb_mean=0.2953 norm_overlap=0.3031 corr_cb=-0.8349 topkJ=0.0000
[TRAIN][ep=048] loss=0.3433 acc=77.50%
[TRAIN][ep=048] mask_avg: mc_mean=0.2861 mb_mean=0.2908 norm_overlap=0.2830 corr_cb=-0.8154
[EPOCH 048/089] train: loss=0.3433 acc=77.50% | val: loss=0.7063 acc=66.13% f1=27.59% auc=54.07% val_score=69.0275 val_score_bestthr=79.2187 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.286, mb=0.291, no=0.283, corr=-0.815) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 82.3458 -> 69.0275
[DBG][ep=049] disease_pos_weight=1.0000 mode=none
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.2801 mb_mean=0.2839 norm_overlap=0.2457 corr_cb=-0.7891 topkJ=0.0000
[TRAIN][ep=049] loss=0.3405 acc=78.22%
[TRAIN][ep=049] mask_avg: mc_mean=0.2861 mb_mean=0.2908 norm_overlap=0.2831 corr_cb=-0.8154
[EPOCH 049/089] train: loss=0.3405 acc=78.22% | val: loss=0.7090 acc=66.13% f1=27.59% auc=54.74% val_score=71.0073 val_score_bestthr=79.2187 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.286, mb=0.291, no=0.283, corr=-0.815) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 82.3458 -> 71.0073
[DBG][ep=050] disease_pos_weight=1.0000 mode=none
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.2791 mb_mean=0.3007 norm_overlap=0.3428 corr_cb=-0.8478 topkJ=0.0000
[TRAIN][ep=050] loss=0.3394 acc=78.40%
[TRAIN][ep=050] mask_avg: mc_mean=0.2861 mb_mean=0.2908 norm_overlap=0.2830 corr_cb=-0.8157
[EPOCH 050/089] train: loss=0.3394 acc=78.40% | val: loss=0.7077 acc=66.13% f1=27.59% auc=54.74% val_score=67.0614 val_score_bestthr=79.2187 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.286, mb=0.291, no=0.283, corr=-0.816) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 82.3458 -> 67.0614
[DBG][ep=051] disease_pos_weight=1.0000 mode=none
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.2794 mb_mean=0.3081 norm_overlap=0.2871 corr_cb=-0.8333 topkJ=0.0000
[TRAIN][ep=051] loss=0.3375 acc=78.22%
[TRAIN][ep=051] mask_avg: mc_mean=0.2861 mb_mean=0.2908 norm_overlap=0.2832 corr_cb=-0.8153
[EPOCH 051/089] train: loss=0.3375 acc=78.22% | val: loss=0.7101 acc=66.13% f1=27.59% auc=54.85% val_score=71.0073 val_score_bestthr=79.2187 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.286, mb=0.291, no=0.283, corr=-0.815) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 82.3458 -> 71.0073
[DBG][ep=052] disease_pos_weight=1.0000 mode=none
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.2864 mb_mean=0.2760 norm_overlap=0.3021 corr_cb=-0.8074 topkJ=0.0000
[TRAIN][ep=052] loss=0.3366 acc=77.86%
[TRAIN][ep=052] mask_avg: mc_mean=0.2861 mb_mean=0.2908 norm_overlap=0.2834 corr_cb=-0.8157
[EPOCH 052/089] train: loss=0.3366 acc=77.86% | val: loss=0.7108 acc=66.13% f1=27.59% auc=55.18% val_score=71.0073 val_score_bestthr=79.2187 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.286, mb=0.291, no=0.283, corr=-0.816) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 82.3458 -> 71.0073
[DBG][ep=053] disease_pos_weight=1.0000 mode=none
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.2859 mb_mean=0.2788 norm_overlap=0.3343 corr_cb=-0.8278 topkJ=0.0000
[TRAIN][ep=053] loss=0.3342 acc=78.22%
[TRAIN][ep=053] mask_avg: mc_mean=0.2862 mb_mean=0.2908 norm_overlap=0.2827 corr_cb=-0.8154
[EPOCH 053/089] train: loss=0.3342 acc=78.22% | val: loss=0.7108 acc=66.13% f1=27.59% auc=55.52% val_score=71.0073 val_score_bestthr=79.2187 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.286, mb=0.291, no=0.283, corr=-0.815) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 82.3458 -> 71.0073
[EARLY STOP] no improvement for 30 epochs. best_epoch=23
[CKPT] Loaded best for testing: results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
=============== FIT DONE ===============
[BEST] epoch=23 | val_acc=64.52% | val_f1=42.11% | val_auc=53.40% | val_score=82.3458 | val_score_bestthr=85.2160
[TEST@BEST] thr_used=0.440 | acc=66.23% f1=39.53% auc=63.36% | SP_sex=1.88% EO_sex=6.82% SP_age=22.30% EO_age=17.78%
[TIME] 0.83 min
[OK] Saved: results/ADHD_3x5fold_seed0/fold1_rep0_seed1/summary_fold_1.json
[DBG][ep=000] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5033 mb_mean=0.5074 norm_overlap=1.0000 corr_cb=-0.0236 topkJ=0.0769
[TRAIN][ep=000] loss=0.6897 acc=61.34%
[TRAIN][ep=000] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1035
[DBG][ep=001] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5043 mb_mean=0.5082 norm_overlap=1.0001 corr_cb=0.1648 topkJ=0.0737
[TRAIN][ep=001] loss=0.6843 acc=63.70%
[TRAIN][ep=001] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1054
[DBG][ep=002] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5022 mb_mean=0.5087 norm_overlap=1.0002 corr_cb=0.2275 topkJ=0.1455
[TRAIN][ep=002] loss=0.6813 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1043
[DBG][ep=003] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5035 mb_mean=0.5094 norm_overlap=1.0000 corr_cb=0.0241 topkJ=0.0509
[TRAIN][ep=003] loss=0.6792 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1050
[DBG][ep=004] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5028 mb_mean=0.5106 norm_overlap=1.0000 corr_cb=-0.0149 topkJ=0.0979
[TRAIN][ep=004] loss=0.6781 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1064
[DBG][ep=005] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5019 mb_mean=0.5085 norm_overlap=1.0001 corr_cb=0.1280 topkJ=0.1508
[TRAIN][ep=005] loss=0.6766 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1026
[DBG][ep=006] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5034 mb_mean=0.5096 norm_overlap=1.0001 corr_cb=0.0714 topkJ=0.1095
[TRAIN][ep=006] loss=0.6732 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1069
[DBG][ep=007] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5027 mb_mean=0.5084 norm_overlap=1.0001 corr_cb=0.0800 topkJ=0.0599
[TRAIN][ep=007] loss=0.6705 acc=63.88%
[TRAIN][ep=007] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1041
[DBG][ep=008] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5013 mb_mean=0.5071 norm_overlap=1.0002 corr_cb=0.2685 topkJ=0.0945
[TRAIN][ep=008] loss=0.6653 acc=63.88%
[TRAIN][ep=008] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1038
[DBG][ep=009] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5020 mb_mean=0.5111 norm_overlap=1.0000 corr_cb=0.0016 topkJ=0.0557
[TRAIN][ep=009] loss=0.6588 acc=63.88%
[TRAIN][ep=009] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1023
================= FIT START (fold=1) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5045 mb_mean=0.5109 norm_overlap=1.0000 corr_cb=0.0362 topkJ=0.0638
[TRAIN][ep=000] loss=0.6504 acc=67.51%
[TRAIN][ep=000] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1077
[EPOCH 000/089] train: loss=0.6504 acc=67.51% | val: loss=0.6534 acc=64.52% f1=8.33% auc=59.53% val_score=51.2435 val_score_bestthr=59.8868 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.503, mb=0.509, no=1.000, corr=0.108) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 59.8868
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=001] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5043 mb_mean=0.5100 norm_overlap=1.0000 corr_cb=-0.0050 topkJ=0.0422
[TRAIN][ep=001] loss=0.6431 acc=68.06%
[TRAIN][ep=001] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1086
[EPOCH 001/089] train: loss=0.6431 acc=68.06% | val: loss=0.6527 acc=64.52% f1=8.33% auc=59.42% val_score=47.7598 val_score_bestthr=59.8868 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.503, mb=0.509, no=1.000, corr=0.109) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 59.8868 -> 59.8868
[DBG][ep=002] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5004 mb_mean=0.5099 norm_overlap=1.0001 corr_cb=0.2004 topkJ=0.1277
[TRAIN][ep=002] loss=0.6356 acc=69.69%
[TRAIN][ep=002] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1068
[EPOCH 002/089] train: loss=0.6356 acc=69.69% | val: loss=0.6486 acc=64.52% f1=8.33% auc=59.87% val_score=51.2435 val_score_bestthr=59.8868 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.503, mb=0.509, no=1.000, corr=0.107) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 59.8868 -> 59.8868
[DBG][ep=003] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5013 mb_mean=0.5096 norm_overlap=1.0001 corr_cb=0.1039 topkJ=0.0703
[TRAIN][ep=003] loss=0.6271 acc=69.87%
[TRAIN][ep=003] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1068
[EPOCH 003/089] train: loss=0.6271 acc=69.87% | val: loss=0.6505 acc=64.52% f1=8.33% auc=59.09% val_score=45.3818 val_score_bestthr=59.8868 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.503, mb=0.509, no=1.000, corr=0.107) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 59.8868 -> 59.8868
[DBG][ep=004] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.0595 topkJ=0.0573
[TRAIN][ep=004] loss=0.6163 acc=71.32%
[TRAIN][ep=004] mask_avg: mc_mean=0.5026 mb_mean=0.5092 norm_overlap=1.0001 corr_cb=0.1040
[EPOCH 004/089] train: loss=0.6163 acc=71.32% | val: loss=0.6485 acc=66.13% f1=16.00% auc=59.31% val_score=42.2161 val_score_bestthr=54.3805 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.503, mb=0.509, no=1.000, corr=0.104) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 59.8868 -> 54.3805
[DBG][ep=005] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5024 mb_mean=0.5096 norm_overlap=1.0000 corr_cb=0.0125 topkJ=0.1126
[TRAIN][ep=005] loss=1.2684 acc=66.61%
[TRAIN][ep=005] mask_avg: mc_mean=0.5009 mb_mean=0.5092 norm_overlap=0.9999 corr_cb=-0.1018
[EPOCH 005/089] train: loss=1.2684 acc=66.61% | val: loss=0.6540 acc=67.74% f1=50.00% auc=58.19% val_score=41.4287 val_score_bestthr=59.6667 | dyn(w_pfs=0.200, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.501, mb=0.509, no=1.000, corr=-0.102) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 59.8868 -> 59.6667
[DBG][ep=006] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.4982 mb_mean=0.5091 norm_overlap=0.9999 corr_cb=-0.0873 topkJ=0.0139
[TRAIN][ep=006] loss=0.9906 acc=69.15%
[TRAIN][ep=006] mask_avg: mc_mean=0.4958 mb_mean=0.5092 norm_overlap=0.9999 corr_cb=-0.1029
[EPOCH 006/089] train: loss=0.9906 acc=69.15% | val: loss=0.6562 acc=64.52% f1=38.89% auc=58.19% val_score=45.3818 val_score_bestthr=59.1353 | dyn(w_pfs=0.100, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.496, mb=0.509, no=1.000, corr=-0.103) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 59.8868 -> 59.1353
[DBG][ep=007] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4925 mb_mean=0.5083 norm_overlap=0.9999 corr_cb=-0.0769 topkJ=0.0323
[TRAIN][ep=007] loss=0.7799 acc=73.14%
[TRAIN][ep=007] mask_avg: mc_mean=0.4907 mb_mean=0.5092 norm_overlap=0.9998 corr_cb=-0.1349
[EPOCH 007/089] train: loss=0.7799 acc=73.14% | val: loss=0.6582 acc=66.13% f1=40.00% auc=58.42% val_score=50.2452 val_score_bestthr=60.1928 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.040, stage2=False) | mask(mc=0.491, mb=0.509, no=1.000, corr=-0.135) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 59.8868 -> 60.1928
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=008] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4857 mb_mean=0.5098 norm_overlap=0.9997 corr_cb=-0.1757 topkJ=0.0299
[TRAIN][ep=008] loss=0.8515 acc=72.78%
[TRAIN][ep=008] mask_avg: mc_mean=0.4850 mb_mean=0.5092 norm_overlap=0.9998 corr_cb=-0.1798
[EPOCH 008/089] train: loss=0.8515 acc=72.78% | val: loss=0.6776 acc=67.74% f1=47.37% auc=57.19% val_score=44.5297 val_score_bestthr=59.0512 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.080, stage2=False) | mask(mc=0.485, mb=0.509, no=1.000, corr=-0.180) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 60.1928 -> 59.0512
[DBG][ep=009] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4820 mb_mean=0.5089 norm_overlap=1.0000 corr_cb=-0.0156 topkJ=0.0424
[TRAIN][ep=009] loss=0.9260 acc=74.05%
[TRAIN][ep=009] mask_avg: mc_mean=0.4777 mb_mean=0.5092 norm_overlap=0.9996 corr_cb=-0.2418
[EPOCH 009/089] train: loss=0.9260 acc=74.05% | val: loss=0.6679 acc=67.74% f1=47.37% auc=58.42% val_score=48.7739 val_score_bestthr=60.8012 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.120, stage2=False) | mask(mc=0.478, mb=0.509, no=1.000, corr=-0.242) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 60.1928 -> 60.8012
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=010] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.4738 mb_mean=0.5097 norm_overlap=0.9998 corr_cb=-0.0934 topkJ=0.0355
[TRAIN][ep=010] loss=0.9887 acc=74.23%
[TRAIN][ep=010] mask_avg: mc_mean=0.4697 mb_mean=0.5092 norm_overlap=0.9995 corr_cb=-0.2452
[EPOCH 010/089] train: loss=0.9887 acc=74.23% | val: loss=0.6726 acc=67.74% f1=47.37% auc=58.53% val_score=47.7938 val_score_bestthr=60.8012 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.160, stage2=False) | mask(mc=0.470, mb=0.509, no=1.000, corr=-0.245) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 60.8012 -> 60.8012
[DBG][ep=011] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.4639 mb_mean=0.5072 norm_overlap=0.9997 corr_cb=-0.0946 topkJ=0.0197
[TRAIN][ep=011] loss=1.0548 acc=73.87%
[TRAIN][ep=011] mask_avg: mc_mean=0.4595 mb_mean=0.5092 norm_overlap=0.9993 corr_cb=-0.2738
[EPOCH 011/089] train: loss=1.0548 acc=73.87% | val: loss=0.6656 acc=64.52% f1=38.89% auc=57.75% val_score=53.9731 val_score_bestthr=58.5343 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.459, mb=0.509, no=0.999, corr=-0.274) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 60.8012 -> 58.5343
[DBG][ep=012] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.4566 mb_mean=0.5096 norm_overlap=0.9991 corr_cb=-0.3555 topkJ=0.0130
[TRAIN][ep=012] loss=1.1211 acc=73.68%
[TRAIN][ep=012] mask_avg: mc_mean=0.4500 mb_mean=0.5092 norm_overlap=0.9992 corr_cb=-0.2768
[EPOCH 012/089] train: loss=1.1211 acc=73.68% | val: loss=0.6840 acc=64.52% f1=35.29% auc=57.19% val_score=38.4064 val_score_bestthr=60.3355 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.450, mb=0.509, no=0.999, corr=-0.277) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 60.8012 -> 60.3355
[DBG][ep=013] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.4476 mb_mean=0.5090 norm_overlap=0.9994 corr_cb=-0.1654 topkJ=0.0556
[TRAIN][ep=013] loss=1.1096 acc=76.23%
[TRAIN][ep=013] mask_avg: mc_mean=0.4405 mb_mean=0.5092 norm_overlap=0.9991 corr_cb=-0.2716
[EPOCH 013/089] train: loss=1.1096 acc=76.23% | val: loss=0.6697 acc=66.13% f1=40.00% auc=57.19% val_score=57.4777 val_score_bestthr=61.2861 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.440, mb=0.509, no=0.999, corr=-0.272) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 60.8012 -> 61.2861
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=014] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.4338 mb_mean=0.5114 norm_overlap=0.9988 corr_cb=-0.3392 topkJ=0.0130
[TRAIN][ep=014] loss=1.0890 acc=77.86%
[TRAIN][ep=014] mask_avg: mc_mean=0.4292 mb_mean=0.5092 norm_overlap=0.9990 corr_cb=-0.2684
[EPOCH 014/089] train: loss=1.0890 acc=77.86% | val: loss=0.6742 acc=64.52% f1=38.89% auc=56.63% val_score=51.0233 val_score_bestthr=60.2843 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.429, mb=0.509, no=0.999, corr=-0.268) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.2861 -> 60.2843
[DBG][ep=015] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.4226 mb_mean=0.5082 norm_overlap=0.9995 corr_cb=-0.1304 topkJ=0.0554
[TRAIN][ep=015] loss=1.0871 acc=76.23%
[TRAIN][ep=015] mask_avg: mc_mean=0.4164 mb_mean=0.5092 norm_overlap=0.9987 corr_cb=-0.2891
[EPOCH 015/089] train: loss=1.0871 acc=76.23% | val: loss=0.6676 acc=62.90% f1=34.29% auc=58.31% val_score=57.0597 val_score_bestthr=59.3491 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.416, mb=0.509, no=0.999, corr=-0.289) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.2861 -> 59.3491
[DBG][ep=016] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.4133 mb_mean=0.5080 norm_overlap=0.9986 corr_cb=-0.3054 topkJ=0.0161
[TRAIN][ep=016] loss=1.0680 acc=79.31%
[TRAIN][ep=016] mask_avg: mc_mean=0.4082 mb_mean=0.5092 norm_overlap=0.9987 corr_cb=-0.2725
[EPOCH 016/089] train: loss=1.0680 acc=79.31% | val: loss=0.6881 acc=61.29% f1=33.33% auc=56.63% val_score=46.9885 val_score_bestthr=58.1428 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.408, mb=0.509, no=0.999, corr=-0.272) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.2861 -> 58.1428
[DBG][ep=017] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.4033 mb_mean=0.5096 norm_overlap=0.9982 corr_cb=-0.3277 topkJ=0.0152
[TRAIN][ep=017] loss=1.0339 acc=80.04%
[TRAIN][ep=017] mask_avg: mc_mean=0.3973 mb_mean=0.5092 norm_overlap=0.9986 corr_cb=-0.2635
[EPOCH 017/089] train: loss=1.0339 acc=80.04% | val: loss=0.7020 acc=62.90% f1=34.29% auc=56.63% val_score=54.6260 val_score_bestthr=59.3491 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.397, mb=0.509, no=0.999, corr=-0.264) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.2861 -> 59.3491
[DBG][ep=018] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.3930 mb_mean=0.5088 norm_overlap=0.9994 corr_cb=-0.1312 topkJ=0.0434
[TRAIN][ep=018] loss=1.0418 acc=79.31%
[TRAIN][ep=018] mask_avg: mc_mean=0.3873 mb_mean=0.5092 norm_overlap=0.9986 corr_cb=-0.2497
[EPOCH 018/089] train: loss=1.0418 acc=79.31% | val: loss=0.7023 acc=61.29% f1=33.33% auc=55.96% val_score=53.0771 val_score_bestthr=58.1428 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.387, mb=0.509, no=0.999, corr=-0.250) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.2861 -> 58.1428
[DBG][ep=019] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.3853 mb_mean=0.5106 norm_overlap=0.9989 corr_cb=-0.2376 topkJ=0.0554
[TRAIN][ep=019] loss=0.8184 acc=80.40%
[TRAIN][ep=019] mask_avg: mc_mean=0.3767 mb_mean=0.5092 norm_overlap=0.9983 corr_cb=-0.2628
[EPOCH 019/089] train: loss=0.8184 acc=80.40% | val: loss=0.7158 acc=61.29% f1=33.33% auc=56.63% val_score=47.8925 val_score_bestthr=58.1428 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.377, mb=0.509, no=0.998, corr=-0.263) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.2861 -> 58.1428
[DBG][ep=020] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.3687 mb_mean=0.5086 norm_overlap=0.9980 corr_cb=-0.2947 topkJ=0.0166
[TRAIN][ep=020] loss=0.6182 acc=80.40%
[TRAIN][ep=020] mask_avg: mc_mean=0.3675 mb_mean=0.5092 norm_overlap=0.9984 corr_cb=-0.2383
[EPOCH 020/089] train: loss=0.6182 acc=80.40% | val: loss=0.7434 acc=61.29% f1=33.33% auc=56.08% val_score=47.8088 val_score_bestthr=58.1428 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.368, mb=0.509, no=0.998, corr=-0.238) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.2861 -> 58.1428
[DBG][ep=021] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.3590 mb_mean=0.5103 norm_overlap=0.9981 corr_cb=-0.2616 topkJ=0.0211
[TRAIN][ep=021] loss=0.5674 acc=81.49%
[TRAIN][ep=021] mask_avg: mc_mean=0.3565 mb_mean=0.5092 norm_overlap=0.9981 corr_cb=-0.2549
[EPOCH 021/089] train: loss=0.5674 acc=81.49% | val: loss=0.7633 acc=61.29% f1=33.33% auc=55.85% val_score=52.8396 val_score_bestthr=58.1428 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.356, mb=0.509, no=0.998, corr=-0.255) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.2861 -> 58.1428
[DBG][ep=022] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.3571 mb_mean=0.5100 norm_overlap=0.9970 corr_cb=-0.3890 topkJ=0.0040
[TRAIN][ep=022] loss=0.5480 acc=84.21%
[TRAIN][ep=022] mask_avg: mc_mean=0.3477 mb_mean=0.5092 norm_overlap=0.9982 corr_cb=-0.2261
[EPOCH 022/089] train: loss=0.5480 acc=84.21% | val: loss=0.7625 acc=61.29% f1=33.33% auc=56.08% val_score=48.5393 val_score_bestthr=58.1428 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.348, mb=0.509, no=0.998, corr=-0.226) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.2861 -> 58.1428
[DBG][ep=023] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.3428 mb_mean=0.5100 norm_overlap=0.9982 corr_cb=-0.2177 topkJ=0.0331
[TRAIN][ep=023] loss=0.5256 acc=83.85%
[TRAIN][ep=023] mask_avg: mc_mean=0.3380 mb_mean=0.5092 norm_overlap=0.9980 corr_cb=-0.2292
[EPOCH 023/089] train: loss=0.5256 acc=83.85% | val: loss=0.7744 acc=62.90% f1=34.29% auc=56.63% val_score=43.0572 val_score_bestthr=57.6158 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.338, mb=0.509, no=0.998, corr=-0.229) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.2861 -> 57.6158
[DBG][ep=024] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.3361 mb_mean=0.5082 norm_overlap=0.9970 corr_cb=-0.3098 topkJ=0.0294
[TRAIN][ep=024] loss=0.5124 acc=84.03%
[TRAIN][ep=024] mask_avg: mc_mean=0.3294 mb_mean=0.5092 norm_overlap=0.9982 corr_cb=-0.2039
[EPOCH 024/089] train: loss=0.5124 acc=84.03% | val: loss=0.8508 acc=62.90% f1=30.30% auc=55.96% val_score=37.9545 val_score_bestthr=55.8093 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.329, mb=0.509, no=0.998, corr=-0.204) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 61.2861 -> 55.8093
[DBG][ep=025] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.3302 mb_mean=0.5087 norm_overlap=0.9991 corr_cb=-0.1075 topkJ=0.0611
[TRAIN][ep=025] loss=0.5189 acc=82.03%
[TRAIN][ep=025] mask_avg: mc_mean=0.3205 mb_mean=0.5092 norm_overlap=0.9979 corr_cb=-0.2165
[EPOCH 025/089] train: loss=0.5189 acc=82.03% | val: loss=0.8163 acc=66.13% f1=36.36% auc=57.41% val_score=56.3451 val_score_bestthr=62.9775 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.320, mb=0.509, no=0.998, corr=-0.217) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 61.2861 -> 62.9775
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=026] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.3061 mb_mean=0.5101 norm_overlap=0.9983 corr_cb=-0.1625 topkJ=0.0214
[TRAIN][ep=026] loss=0.5765 acc=83.30%
[TRAIN][ep=026] mask_avg: mc_mean=0.3147 mb_mean=0.5092 norm_overlap=0.9980 corr_cb=-0.2063
[EPOCH 026/089] train: loss=0.5765 acc=83.30% | val: loss=0.7944 acc=64.52% f1=31.25% auc=57.53% val_score=51.5615 val_score_bestthr=58.9961 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.315, mb=0.509, no=0.998, corr=-0.206) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 62.9775 -> 58.9961
[DBG][ep=027] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.3163 mb_mean=0.5090 norm_overlap=0.9981 corr_cb=-0.2106 topkJ=0.0220
[TRAIN][ep=027] loss=0.6149 acc=86.57%
[TRAIN][ep=027] mask_avg: mc_mean=0.3077 mb_mean=0.5092 norm_overlap=0.9980 corr_cb=-0.1929
[EPOCH 027/089] train: loss=0.6149 acc=86.57% | val: loss=0.8167 acc=67.74% f1=41.18% auc=58.64% val_score=53.2529 val_score_bestthr=64.5063 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.308, mb=0.509, no=0.998, corr=-0.193) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 62.9775 -> 64.5063
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=028] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.3021 mb_mean=0.5101 norm_overlap=0.9977 corr_cb=-0.2518 topkJ=0.0276
[TRAIN][ep=028] loss=0.6741 acc=87.30%
[TRAIN][ep=028] mask_avg: mc_mean=0.3001 mb_mean=0.5092 norm_overlap=0.9978 corr_cb=-0.2018
[EPOCH 028/089] train: loss=0.6741 acc=87.30% | val: loss=0.8367 acc=66.13% f1=40.00% auc=57.64% val_score=50.5393 val_score_bestthr=61.9321 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.300, mb=0.509, no=0.998, corr=-0.202) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.5063 -> 61.9321
[DBG][ep=029] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.2916 mb_mean=0.5089 norm_overlap=0.9978 corr_cb=-0.2097 topkJ=0.0256
[TRAIN][ep=029] loss=0.7193 acc=88.20%
[TRAIN][ep=029] mask_avg: mc_mean=0.2918 mb_mean=0.5092 norm_overlap=0.9981 corr_cb=-0.1748
[EPOCH 029/089] train: loss=0.7193 acc=88.20% | val: loss=0.8608 acc=66.13% f1=40.00% auc=58.53% val_score=46.3825 val_score_bestthr=62.3634 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.292, mb=0.509, no=0.998, corr=-0.175) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.5063 -> 62.3634
[DBG][ep=030] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.2820 mb_mean=0.5105 norm_overlap=0.9977 corr_cb=-0.1845 topkJ=0.0414
[TRAIN][ep=030] loss=0.7790 acc=89.11%
[TRAIN][ep=030] mask_avg: mc_mean=0.2857 mb_mean=0.5092 norm_overlap=0.9979 corr_cb=-0.1778
[EPOCH 030/089] train: loss=0.7790 acc=89.11% | val: loss=0.8909 acc=67.74% f1=41.18% auc=57.86% val_score=49.3149 val_score_bestthr=64.5063 | dyn(w_pfs=0.240, w_sup=0.240, w_csuf=0.200, stage2=False) | mask(mc=0.286, mb=0.509, no=0.998, corr=-0.178) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.5063 -> 64.5063
[DBG][ep=031] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.2805 mb_mean=0.5082 norm_overlap=0.9950 corr_cb=-0.3313 topkJ=0.0121
[TRAIN][ep=031] loss=0.7625 acc=91.47%
[TRAIN][ep=031] mask_avg: mc_mean=0.2792 mb_mean=0.5092 norm_overlap=0.9980 corr_cb=-0.1638
[EPOCH 031/089] train: loss=0.7625 acc=91.47% | val: loss=0.9078 acc=69.35% f1=42.42% auc=58.19% val_score=56.5288 val_score_bestthr=67.8124 | dyn(w_pfs=0.280, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.279, mb=0.509, no=0.998, corr=-0.164) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=* 64.5063 -> 67.8124
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
[DBG][ep=032] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.2717 mb_mean=0.5078 norm_overlap=0.9988 corr_cb=-0.0919 topkJ=0.0412
[TRAIN][ep=032] loss=0.7762 acc=89.11%
[TRAIN][ep=032] mask_avg: mc_mean=0.2725 mb_mean=0.5092 norm_overlap=0.9980 corr_cb=-0.1570
[EPOCH 032/089] train: loss=0.7762 acc=89.11% | val: loss=0.9282 acc=64.52% f1=38.89% auc=58.08% val_score=49.7293 val_score_bestthr=60.4353 | dyn(w_pfs=0.320, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.273, mb=0.509, no=0.998, corr=-0.157) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.8124 -> 60.4353
[DBG][ep=033] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.2688 mb_mean=0.5070 norm_overlap=0.9968 corr_cb=-0.2206 topkJ=0.0265
[TRAIN][ep=033] loss=0.7367 acc=91.11%
[TRAIN][ep=033] mask_avg: mc_mean=0.2670 mb_mean=0.5092 norm_overlap=0.9980 corr_cb=-0.1521
[EPOCH 033/089] train: loss=0.7367 acc=91.11% | val: loss=0.9937 acc=64.52% f1=38.89% auc=58.64% val_score=55.3239 val_score_bestthr=60.4353 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.267, mb=0.509, no=0.998, corr=-0.152) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.8124 -> 60.4353
[DBG][ep=034] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.2602 mb_mean=0.5089 norm_overlap=0.9991 corr_cb=-0.0800 topkJ=0.0576
[TRAIN][ep=034] loss=0.7254 acc=92.74%
[TRAIN][ep=034] mask_avg: mc_mean=0.2613 mb_mean=0.5092 norm_overlap=0.9978 corr_cb=-0.1575
[EPOCH 034/089] train: loss=0.7254 acc=92.74% | val: loss=0.9967 acc=69.35% f1=42.42% auc=59.20% val_score=50.4655 val_score_bestthr=67.8124 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.261, mb=0.509, no=0.998, corr=-0.157) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.8124 -> 67.8124
[DBG][ep=035] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2611 mb_mean=0.5092 norm_overlap=0.9978 corr_cb=-0.1454 topkJ=0.0447
[TRAIN][ep=035] loss=0.6962 acc=94.19%
[TRAIN][ep=035] mask_avg: mc_mean=0.2561 mb_mean=0.5092 norm_overlap=0.9978 corr_cb=-0.1561
[EPOCH 035/089] train: loss=0.6962 acc=94.19% | val: loss=1.0961 acc=66.13% f1=36.36% auc=59.53% val_score=43.1999 val_score_bestthr=60.6442 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.256, mb=0.509, no=0.998, corr=-0.156) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.8124 -> 60.6442
[DBG][ep=036] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.2562 mb_mean=0.5099 norm_overlap=0.9981 corr_cb=-0.1392 topkJ=0.0378
[TRAIN][ep=036] loss=0.6921 acc=93.65%
[TRAIN][ep=036] mask_avg: mc_mean=0.2507 mb_mean=0.5092 norm_overlap=0.9980 corr_cb=-0.1400
[EPOCH 036/089] train: loss=0.6921 acc=93.65% | val: loss=1.0462 acc=67.74% f1=41.18% auc=59.87% val_score=53.3199 val_score_bestthr=64.2463 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.251, mb=0.509, no=0.998, corr=-0.140) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.8124 -> 64.2463
[DBG][ep=037] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.2447 mb_mean=0.5091 norm_overlap=0.9970 corr_cb=-0.1906 topkJ=0.0298
[TRAIN][ep=037] loss=0.5262 acc=93.28%
[TRAIN][ep=037] mask_avg: mc_mean=0.2479 mb_mean=0.5092 norm_overlap=0.9979 corr_cb=-0.1431
[EPOCH 037/089] train: loss=0.5262 acc=93.28% | val: loss=1.0503 acc=69.35% f1=42.42% auc=60.65% val_score=55.3239 val_score_bestthr=67.8124 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.248, mb=0.509, no=0.998, corr=-0.143) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.8124 -> 67.8124
[DBG][ep=038] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.2377 mb_mean=0.5094 norm_overlap=1.0008 corr_cb=0.0547 topkJ=0.0832
[TRAIN][ep=038] loss=0.3349 acc=95.46%
[TRAIN][ep=038] mask_avg: mc_mean=0.2434 mb_mean=0.5092 norm_overlap=0.9979 corr_cb=-0.1356
[EPOCH 038/089] train: loss=0.3349 acc=95.46% | val: loss=1.1173 acc=69.35% f1=42.42% auc=60.54% val_score=55.3239 val_score_bestthr=67.8124 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.243, mb=0.509, no=0.998, corr=-0.136) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.8124 -> 67.8124
[DBG][ep=039] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.2432 mb_mean=0.5091 norm_overlap=0.9975 corr_cb=-0.1731 topkJ=0.0309
[TRAIN][ep=039] loss=0.2983 acc=95.46%
[TRAIN][ep=039] mask_avg: mc_mean=0.2403 mb_mean=0.5092 norm_overlap=0.9978 corr_cb=-0.1374
[EPOCH 039/089] train: loss=0.2983 acc=95.46% | val: loss=1.1597 acc=69.35% f1=42.42% auc=59.75% val_score=55.3239 val_score_bestthr=67.8124 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.240, mb=0.509, no=0.998, corr=-0.137) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.8124 -> 67.8124
[DBG][ep=040] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.2389 mb_mean=0.5087 norm_overlap=0.9949 corr_cb=-0.2771 topkJ=0.0305
[TRAIN][ep=040] loss=0.2823 acc=95.10%
[TRAIN][ep=040] mask_avg: mc_mean=0.2368 mb_mean=0.5092 norm_overlap=0.9978 corr_cb=-0.1361
[EPOCH 040/089] train: loss=0.2823 acc=95.10% | val: loss=1.1912 acc=69.35% f1=42.42% auc=60.31% val_score=53.3199 val_score_bestthr=67.8124 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.237, mb=0.509, no=0.998, corr=-0.136) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.8124 -> 67.8124
[DBG][ep=041] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.2347 mb_mean=0.5082 norm_overlap=0.9956 corr_cb=-0.2002 topkJ=0.0283
[TRAIN][ep=041] loss=0.2749 acc=95.83%
[TRAIN][ep=041] mask_avg: mc_mean=0.2333 mb_mean=0.5092 norm_overlap=0.9977 corr_cb=-0.1399
[EPOCH 041/089] train: loss=0.2749 acc=95.83% | val: loss=1.2565 acc=67.74% f1=37.50% auc=60.42% val_score=53.6562 val_score_bestthr=63.8594 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.233, mb=0.509, no=0.998, corr=-0.140) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.8124 -> 63.8594
[DBG][ep=042] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.2283 mb_mean=0.5095 norm_overlap=0.9967 corr_cb=-0.1935 topkJ=0.0281
[TRAIN][ep=042] loss=0.2725 acc=95.46%
[TRAIN][ep=042] mask_avg: mc_mean=0.2307 mb_mean=0.5092 norm_overlap=0.9978 corr_cb=-0.1326
[EPOCH 042/089] train: loss=0.2725 acc=95.46% | val: loss=1.2699 acc=69.35% f1=42.42% auc=61.43% val_score=53.3199 val_score_bestthr=67.8124 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.231, mb=0.509, no=0.998, corr=-0.133) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.8124 -> 67.8124
[DBG][ep=043] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.2309 mb_mean=0.5080 norm_overlap=0.9993 corr_cb=-0.0395 topkJ=0.0456
[TRAIN][ep=043] loss=0.2523 acc=96.73%
[TRAIN][ep=043] mask_avg: mc_mean=0.2288 mb_mean=0.5092 norm_overlap=0.9975 corr_cb=-0.1471
[EPOCH 043/089] train: loss=0.2523 acc=96.73% | val: loss=1.3634 acc=69.35% f1=42.42% auc=60.76% val_score=56.5288 val_score_bestthr=67.8124 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.229, mb=0.509, no=0.997, corr=-0.147) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.8124 -> 67.8124
[DBG][ep=044] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.2285 mb_mean=0.5081 norm_overlap=0.9958 corr_cb=-0.2142 topkJ=0.0101
[TRAIN][ep=044] loss=0.2488 acc=96.91%
[TRAIN][ep=044] mask_avg: mc_mean=0.2261 mb_mean=0.5092 norm_overlap=0.9975 corr_cb=-0.1437
[EPOCH 044/089] train: loss=0.2488 acc=96.91% | val: loss=1.3412 acc=67.74% f1=41.18% auc=60.87% val_score=55.4065 val_score_bestthr=64.5063 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.226, mb=0.509, no=0.997, corr=-0.144) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.8124 -> 64.5063
[DBG][ep=045] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.2307 mb_mean=0.5091 norm_overlap=0.9983 corr_cb=-0.1081 topkJ=0.0409
[TRAIN][ep=045] loss=0.2420 acc=98.00%
[TRAIN][ep=045] mask_avg: mc_mean=0.2241 mb_mean=0.5092 norm_overlap=0.9975 corr_cb=-0.1409
[EPOCH 045/089] train: loss=0.2420 acc=98.00% | val: loss=1.3757 acc=67.74% f1=37.50% auc=60.76% val_score=49.8925 val_score_bestthr=63.8594 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.224, mb=0.509, no=0.997, corr=-0.141) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.8124 -> 63.8594
[DBG][ep=046] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.2132 mb_mean=0.5099 norm_overlap=0.9959 corr_cb=-0.2427 topkJ=0.0252
[TRAIN][ep=046] loss=0.2303 acc=98.00%
[TRAIN][ep=046] mask_avg: mc_mean=0.2222 mb_mean=0.5092 norm_overlap=0.9975 corr_cb=-0.1399
[EPOCH 046/089] train: loss=0.2303 acc=98.00% | val: loss=1.4882 acc=66.13% f1=40.00% auc=60.54% val_score=53.3378 val_score_bestthr=61.9321 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.222, mb=0.509, no=0.997, corr=-0.140) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.8124 -> 61.9321
[DBG][ep=047] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.2226 mb_mean=0.5102 norm_overlap=0.9964 corr_cb=-0.2182 topkJ=0.0345
[TRAIN][ep=047] loss=0.2322 acc=98.00%
[TRAIN][ep=047] mask_avg: mc_mean=0.2206 mb_mean=0.5092 norm_overlap=0.9971 corr_cb=-0.1536
[EPOCH 047/089] train: loss=0.2322 acc=98.00% | val: loss=1.4904 acc=69.35% f1=42.42% auc=59.98% val_score=50.5393 val_score_bestthr=67.8124 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.221, mb=0.509, no=0.997, corr=-0.154) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.8124 -> 67.8124
[DBG][ep=048] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.2280 mb_mean=0.5090 norm_overlap=0.9971 corr_cb=-0.1804 topkJ=0.0270
[TRAIN][ep=048] loss=0.2215 acc=98.37%
[TRAIN][ep=048] mask_avg: mc_mean=0.2189 mb_mean=0.5092 norm_overlap=0.9972 corr_cb=-0.1526
[EPOCH 048/089] train: loss=0.2215 acc=98.37% | val: loss=1.4924 acc=69.35% f1=42.42% auc=61.32% val_score=50.5393 val_score_bestthr=67.8124 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.219, mb=0.509, no=0.997, corr=-0.153) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.8124 -> 67.8124
[DBG][ep=049] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.2114 mb_mean=0.5090 norm_overlap=0.9984 corr_cb=-0.0956 topkJ=0.0592
[TRAIN][ep=049] loss=0.2084 acc=98.73%
[TRAIN][ep=049] mask_avg: mc_mean=0.2167 mb_mean=0.5092 norm_overlap=0.9972 corr_cb=-0.1502
[EPOCH 049/089] train: loss=0.2084 acc=98.73% | val: loss=1.5733 acc=67.74% f1=41.18% auc=60.98% val_score=45.1398 val_score_bestthr=64.5063 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.217, mb=0.509, no=0.997, corr=-0.150) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 67.8124 -> 64.5063
[DBG][ep=050] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.2186 mb_mean=0.5085 norm_overlap=0.9987 corr_cb=-0.0713 topkJ=0.0533
[TRAIN][ep=050] loss=0.1950 acc=99.64%
[TRAIN][ep=050] mask_avg: mc_mean=0.2159 mb_mean=0.5092 norm_overlap=0.9971 corr_cb=-0.1498
[EPOCH 050/089] train: loss=0.1950 acc=99.64% | val: loss=1.5720 acc=64.52% f1=38.89% auc=60.87% val_score=49.8925 val_score_bestthr=61.8343 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.216, mb=0.509, no=0.997, corr=-0.150) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.8124 -> 61.8343
[DBG][ep=051] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.2101 mb_mean=0.5095 norm_overlap=0.9984 corr_cb=-0.0783 topkJ=0.0646
[TRAIN][ep=051] loss=0.1954 acc=99.64%
[TRAIN][ep=051] mask_avg: mc_mean=0.2159 mb_mean=0.5092 norm_overlap=0.9971 corr_cb=-0.1500
[EPOCH 051/089] train: loss=0.1954 acc=99.64% | val: loss=1.5733 acc=67.74% f1=41.18% auc=61.09% val_score=45.1398 val_score_bestthr=64.5063 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.216, mb=0.509, no=0.997, corr=-0.150) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.8124 -> 64.5063
[DBG][ep=052] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=052] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=052] mask(step0): mc_mean=0.2173 mb_mean=0.5101 norm_overlap=0.9964 corr_cb=-0.1928 topkJ=0.0320
[TRAIN][ep=052] loss=0.1939 acc=99.27%
[TRAIN][ep=052] mask_avg: mc_mean=0.2159 mb_mean=0.5092 norm_overlap=0.9971 corr_cb=-0.1490
[EPOCH 052/089] train: loss=0.1939 acc=99.27% | val: loss=1.5814 acc=67.74% f1=41.18% auc=61.20% val_score=45.1398 val_score_bestthr=64.5063 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.216, mb=0.509, no=0.997, corr=-0.149) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.8124 -> 64.5063
[DBG][ep=053] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=053] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=053] mask(step0): mc_mean=0.2112 mb_mean=0.5089 norm_overlap=0.9990 corr_cb=-0.0592 topkJ=0.0536
[TRAIN][ep=053] loss=0.1919 acc=99.64%
[TRAIN][ep=053] mask_avg: mc_mean=0.2159 mb_mean=0.5092 norm_overlap=0.9971 corr_cb=-0.1491
[EPOCH 053/089] train: loss=0.1919 acc=99.64% | val: loss=1.5853 acc=67.74% f1=41.18% auc=61.09% val_score=45.1398 val_score_bestthr=64.5063 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.216, mb=0.509, no=0.997, corr=-0.149) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.8124 -> 64.5063
[DBG][ep=054] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=054] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=054] mask(step0): mc_mean=0.2245 mb_mean=0.5088 norm_overlap=0.9958 corr_cb=-0.1879 topkJ=0.0139
[TRAIN][ep=054] loss=0.1909 acc=99.82%
[TRAIN][ep=054] mask_avg: mc_mean=0.2159 mb_mean=0.5092 norm_overlap=0.9971 corr_cb=-0.1506
[EPOCH 054/089] train: loss=0.1909 acc=99.82% | val: loss=1.6003 acc=67.74% f1=41.18% auc=61.20% val_score=45.1398 val_score_bestthr=64.5063 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.216, mb=0.509, no=0.997, corr=-0.151) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.8124 -> 64.5063
[DBG][ep=055] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=055] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=055] mask(step0): mc_mean=0.2188 mb_mean=0.5086 norm_overlap=0.9972 corr_cb=-0.1637 topkJ=0.0439
[TRAIN][ep=055] loss=0.1902 acc=99.82%
[TRAIN][ep=055] mask_avg: mc_mean=0.2159 mb_mean=0.5092 norm_overlap=0.9971 corr_cb=-0.1492
[EPOCH 055/089] train: loss=0.1902 acc=99.82% | val: loss=1.5995 acc=67.74% f1=41.18% auc=61.32% val_score=45.1398 val_score_bestthr=64.5063 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.216, mb=0.509, no=0.997, corr=-0.149) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.8124 -> 64.5063
[DBG][ep=056] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=056] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=056] mask(step0): mc_mean=0.2086 mb_mean=0.5102 norm_overlap=0.9968 corr_cb=-0.1437 topkJ=0.0311
[TRAIN][ep=056] loss=0.1877 acc=99.46%
[TRAIN][ep=056] mask_avg: mc_mean=0.2159 mb_mean=0.5092 norm_overlap=0.9971 corr_cb=-0.1504
[EPOCH 056/089] train: loss=0.1877 acc=99.46% | val: loss=1.6086 acc=67.74% f1=41.18% auc=61.20% val_score=45.1398 val_score_bestthr=64.5063 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.216, mb=0.509, no=0.997, corr=-0.150) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.8124 -> 64.5063
[DBG][ep=057] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=057] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=057] mask(step0): mc_mean=0.2168 mb_mean=0.5105 norm_overlap=0.9959 corr_cb=-0.2309 topkJ=0.0184
[TRAIN][ep=057] loss=0.1882 acc=100.00%
[TRAIN][ep=057] mask_avg: mc_mean=0.2159 mb_mean=0.5092 norm_overlap=0.9972 corr_cb=-0.1492
[EPOCH 057/089] train: loss=0.1882 acc=100.00% | val: loss=1.6230 acc=67.74% f1=41.18% auc=61.20% val_score=45.1398 val_score_bestthr=64.5063 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.216, mb=0.509, no=0.997, corr=-0.149) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.8124 -> 64.5063
[DBG][ep=058] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=058] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=058] mask(step0): mc_mean=0.2198 mb_mean=0.5089 norm_overlap=0.9957 corr_cb=-0.2349 topkJ=0.0362
[TRAIN][ep=058] loss=0.1873 acc=99.82%
[TRAIN][ep=058] mask_avg: mc_mean=0.2159 mb_mean=0.5092 norm_overlap=0.9971 corr_cb=-0.1511
[EPOCH 058/089] train: loss=0.1873 acc=99.82% | val: loss=1.6298 acc=67.74% f1=41.18% auc=60.98% val_score=49.8925 val_score_bestthr=64.5063 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.216, mb=0.509, no=0.997, corr=-0.151) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.8124 -> 64.5063
[DBG][ep=059] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=059] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=059] mask(step0): mc_mean=0.2269 mb_mean=0.5083 norm_overlap=0.9986 corr_cb=-0.0644 topkJ=0.1209
[TRAIN][ep=059] loss=0.1860 acc=99.46%
[TRAIN][ep=059] mask_avg: mc_mean=0.2159 mb_mean=0.5092 norm_overlap=0.9971 corr_cb=-0.1476
[EPOCH 059/089] train: loss=0.1860 acc=99.46% | val: loss=1.6452 acc=67.74% f1=41.18% auc=61.32% val_score=45.1398 val_score_bestthr=64.5063 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.216, mb=0.509, no=0.997, corr=-0.148) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.8124 -> 64.5063
[DBG][ep=060] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=060] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=060] mask(step0): mc_mean=0.2176 mb_mean=0.5088 norm_overlap=0.9966 corr_cb=-0.2044 topkJ=0.0354
[TRAIN][ep=060] loss=0.1857 acc=99.82%
[TRAIN][ep=060] mask_avg: mc_mean=0.2159 mb_mean=0.5092 norm_overlap=0.9971 corr_cb=-0.1519
[EPOCH 060/089] train: loss=0.1857 acc=99.82% | val: loss=1.6442 acc=67.74% f1=41.18% auc=60.98% val_score=45.0572 val_score_bestthr=64.5063 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.216, mb=0.509, no=0.997, corr=-0.152) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.8124 -> 64.5063
[DBG][ep=061] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=061] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=061] mask(step0): mc_mean=0.2113 mb_mean=0.5078 norm_overlap=0.9971 corr_cb=-0.1694 topkJ=0.0406
[TRAIN][ep=061] loss=0.1846 acc=99.82%
[TRAIN][ep=061] mask_avg: mc_mean=0.2159 mb_mean=0.5092 norm_overlap=0.9972 corr_cb=-0.1488
[EPOCH 061/089] train: loss=0.1846 acc=99.82% | val: loss=1.6541 acc=67.74% f1=41.18% auc=61.09% val_score=45.1398 val_score_bestthr=64.5063 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.216, mb=0.509, no=0.997, corr=-0.149) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 67.8124 -> 64.5063
[EARLY STOP] no improvement for 30 epochs. best_epoch=31
[CKPT] Loaded best for testing: results/ADHD_3x5fold_seed0/fold1_rep0_seed1/ckpt_best_fold_1.pt
=============== FIT DONE ===============
[BEST] epoch=31 | val_acc=69.35% | val_f1=42.42% | val_auc=58.19% | val_score=56.5288 | val_score_bestthr=67.8124
[TEST@BEST] thr_used=0.695 | acc=64.29% f1=22.54% auc=61.90% | SP_sex=0.43% EO_sex=7.58% SP_age=5.75% EO_age=12.70%
[TIME] 1.20 min
[OK] Saved: results/ADHD_3x5fold_seed0/fold1_rep0_seed1/summary_fold_1.json
