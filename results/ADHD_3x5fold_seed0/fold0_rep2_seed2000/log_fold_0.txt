[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5236 mb_mean=0.5061 norm_overlap=0.9998 corr_cb=-0.1913 topkJ=0.0225
[TRAIN][ep=000] loss=0.6926 acc=51.91%
[TRAIN][ep=000] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2677
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5223 mb_mean=0.5043 norm_overlap=0.9995 corr_cb=-0.3398 topkJ=0.0124
[TRAIN][ep=001] loss=0.6752 acc=63.70%
[TRAIN][ep=001] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2716
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5214 mb_mean=0.5039 norm_overlap=0.9998 corr_cb=-0.1603 topkJ=0.0315
[TRAIN][ep=002] loss=0.6633 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2709
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5198 mb_mean=0.5045 norm_overlap=0.9997 corr_cb=-0.2413 topkJ=0.0174
[TRAIN][ep=003] loss=0.6578 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2654
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5237 mb_mean=0.5050 norm_overlap=0.9997 corr_cb=-0.2572 topkJ=0.0114
[TRAIN][ep=004] loss=0.6554 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2685
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5214 mb_mean=0.5050 norm_overlap=0.9997 corr_cb=-0.2780 topkJ=0.0280
[TRAIN][ep=005] loss=0.6542 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2701
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5217 mb_mean=0.5043 norm_overlap=0.9997 corr_cb=-0.2886 topkJ=0.0135
[TRAIN][ep=006] loss=0.6538 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2669
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5184 mb_mean=0.5067 norm_overlap=0.9997 corr_cb=-0.3329 topkJ=0.0218
[TRAIN][ep=007] loss=0.6520 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2713
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5223 mb_mean=0.5062 norm_overlap=0.9996 corr_cb=-0.3736 topkJ=0.0062
[TRAIN][ep=008] loss=0.6517 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2684
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5215 mb_mean=0.5068 norm_overlap=0.9997 corr_cb=-0.2734 topkJ=0.0259
[TRAIN][ep=009] loss=0.6500 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2687
================= FIT START (fold=0) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.35 select_by=val_score | eval_thr_mode=best_acc eval_thr_grid=coarse | disease_pos_weight_mode=none freeze_b_after=15 | two_stage=True stage1_ratio=0.35 stage2_lr_mult=0.3 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5235 mb_mean=0.5056 norm_overlap=0.9996 corr_cb=-0.2652 topkJ=0.0979
[TRAIN][ep=000] loss=0.6488 acc=63.70%
[TRAIN][ep=000] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2687
[EPOCH 000/089] train: loss=0.6488 acc=63.70% | val: loss=0.6590 acc=62.90% f1=0.00% auc=49.28% val_score=64.2297 val_score_bestthr=62.9032 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.521, mb=0.506, no=1.000, corr=-0.269) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* -1000000000000000000.0000 -> 64.2297
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5221 mb_mean=0.5070 norm_overlap=0.9998 corr_cb=-0.2391 topkJ=0.0404
[TRAIN][ep=001] loss=0.6469 acc=63.70%
[TRAIN][ep=001] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2684
[EPOCH 001/089] train: loss=0.6469 acc=63.70% | val: loss=0.6577 acc=62.90% f1=0.00% auc=51.28% val_score=67.4541 val_score_bestthr=62.9032 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.521, mb=0.506, no=1.000, corr=-0.268) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 64.2297 -> 67.4541
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5187 mb_mean=0.5040 norm_overlap=0.9998 corr_cb=-0.2618 topkJ=0.0162
[TRAIN][ep=002] loss=0.6457 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2713
[EPOCH 002/089] train: loss=0.6457 acc=63.70% | val: loss=0.6570 acc=62.90% f1=14.81% auc=51.84% val_score=64.2297 val_score_bestthr=69.7231 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.521, mb=0.506, no=1.000, corr=-0.271) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 67.4541 -> 64.2297
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5199 mb_mean=0.5065 norm_overlap=0.9998 corr_cb=-0.2547 topkJ=0.0454
[TRAIN][ep=003] loss=0.6442 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2668
[EPOCH 003/089] train: loss=0.6442 acc=63.70% | val: loss=0.6557 acc=62.90% f1=14.81% auc=52.73% val_score=66.7750 val_score_bestthr=69.7231 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.521, mb=0.506, no=1.000, corr=-0.267) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 67.4541 -> 66.7750
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5227 mb_mean=0.5044 norm_overlap=0.9996 corr_cb=-0.3527 topkJ=0.0157
[TRAIN][ep=004] loss=0.6434 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2700
[EPOCH 004/089] train: loss=0.6434 acc=63.70% | val: loss=0.6545 acc=64.52% f1=8.33% auc=54.07% val_score=66.7750 val_score_bestthr=68.1795 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.521, mb=0.506, no=1.000, corr=-0.270) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 67.4541 -> 66.7750
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5208 mb_mean=0.5063 norm_overlap=0.9997 corr_cb=-0.2071 topkJ=0.0176
[TRAIN][ep=005] loss=2.1875 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.5146 mb_mean=0.4947 norm_overlap=0.9998 corr_cb=-0.1596
[EPOCH 005/089] train: loss=2.1875 acc=63.70% | val: loss=0.6549 acc=62.90% f1=20.69% auc=54.63% val_score=75.5211 val_score_bestthr=72.4762 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.515, mb=0.495, no=1.000, corr=-0.160) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 67.4541 -> 75.5211
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5082 mb_mean=0.4851 norm_overlap=0.9997 corr_cb=-0.1687 topkJ=0.0371
[TRAIN][ep=006] loss=2.1859 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.5007 mb_mean=0.4723 norm_overlap=1.0000 corr_cb=-0.0312
[EPOCH 006/089] train: loss=2.1859 acc=63.70% | val: loss=0.6538 acc=64.52% f1=21.43% auc=55.85% val_score=74.3065 val_score_bestthr=74.3752 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.501, mb=0.472, no=1.000, corr=-0.031) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 75.5211 -> 74.3065
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4928 mb_mean=0.4606 norm_overlap=1.0000 corr_cb=0.0001 topkJ=0.0286
[TRAIN][ep=007] loss=2.1831 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.4867 mb_mean=0.4485 norm_overlap=1.0004 corr_cb=0.0621
[EPOCH 007/089] train: loss=2.1831 acc=63.70% | val: loss=0.6524 acc=66.13% f1=27.59% auc=56.74% val_score=67.1224 val_score_bestthr=78.8618 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.487, mb=0.449, no=1.000, corr=0.062) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 75.5211 -> 67.1224
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4809 mb_mean=0.4372 norm_overlap=0.9993 corr_cb=-0.1191 topkJ=0.0245
[TRAIN][ep=008] loss=2.1734 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.4731 mb_mean=0.4241 norm_overlap=1.0013 corr_cb=0.1482
[EPOCH 008/089] train: loss=2.1734 acc=63.70% | val: loss=0.6518 acc=66.13% f1=27.59% auc=57.64% val_score=80.5179 val_score_bestthr=78.8618 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.473, mb=0.424, no=1.001, corr=0.148) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 75.5211 -> 80.5179
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4655 mb_mean=0.4207 norm_overlap=1.0013 corr_cb=0.1536 topkJ=0.1007
[TRAIN][ep=009] loss=2.1711 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.4598 mb_mean=0.3995 norm_overlap=1.0019 corr_cb=0.1299
[EPOCH 009/089] train: loss=2.1711 acc=63.70% | val: loss=0.6511 acc=64.52% f1=31.25% auc=58.42% val_score=76.3813 val_score_bestthr=79.3442 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.460, mb=0.399, no=1.002, corr=0.130) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 80.5179 -> 76.3813
[DBG][ep=010] disease_pos_weight=1.0000 mode=none
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.4552 mb_mean=0.3855 norm_overlap=1.0011 corr_cb=0.0777 topkJ=0.0529
[TRAIN][ep=010] loss=2.1621 acc=63.70%
[TRAIN][ep=010] mask_avg: mc_mean=0.4470 mb_mean=0.3762 norm_overlap=1.0014 corr_cb=0.0625
[EPOCH 010/089] train: loss=2.1621 acc=63.70% | val: loss=0.6491 acc=66.13% f1=16.00% auc=59.09% val_score=70.3872 val_score_bestthr=73.5938 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.447, mb=0.376, no=1.001, corr=0.062) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 80.5179 -> 70.3872
[DBG][ep=011] disease_pos_weight=1.0000 mode=none
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.4452 mb_mean=0.3639 norm_overlap=1.0000 corr_cb=-0.0009 topkJ=0.0264
[TRAIN][ep=011] loss=2.1562 acc=63.70%
[TRAIN][ep=011] mask_avg: mc_mean=0.4347 mb_mean=0.3550 norm_overlap=0.9997 corr_cb=-0.0129
[EPOCH 011/089] train: loss=2.1562 acc=63.70% | val: loss=0.6477 acc=67.74% f1=23.08% auc=59.98% val_score=74.5015 val_score_bestthr=78.5401 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.435, mb=0.355, no=1.000, corr=-0.013) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 80.5179 -> 74.5015
[DBG][ep=012] disease_pos_weight=1.0000 mode=none
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.4208 mb_mean=0.3282 norm_overlap=1.0022 corr_cb=0.0485 topkJ=0.0643
[TRAIN][ep=012] loss=2.1523 acc=63.70%
[TRAIN][ep=012] mask_avg: mc_mean=0.4223 mb_mean=0.3364 norm_overlap=0.9953 corr_cb=-0.1189
[EPOCH 012/089] train: loss=2.1523 acc=63.70% | val: loss=0.6469 acc=67.74% f1=41.18% auc=60.98% val_score=79.5102 val_score_bestthr=87.1786 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.422, mb=0.336, no=0.995, corr=-0.119) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 80.5179 -> 79.5102
[DBG][ep=013] disease_pos_weight=1.0000 mode=none
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.4212 mb_mean=0.3329 norm_overlap=0.9890 corr_cb=-0.2665 topkJ=0.0240
[TRAIN][ep=013] loss=2.1417 acc=63.70%
[TRAIN][ep=013] mask_avg: mc_mean=0.4120 mb_mean=0.3200 norm_overlap=0.9868 corr_cb=-0.2567
[EPOCH 013/089] train: loss=2.1417 acc=63.70% | val: loss=0.6450 acc=67.74% f1=23.08% auc=62.21% val_score=77.8847 val_score_bestthr=78.5401 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.412, mb=0.320, no=0.987, corr=-0.257) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 80.5179 -> 77.8847
[DBG][ep=014] disease_pos_weight=1.0000 mode=none
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.4011 mb_mean=0.3048 norm_overlap=0.9678 corr_cb=-0.4910 topkJ=0.0069
[TRAIN][ep=014] loss=2.1399 acc=63.52%
[TRAIN][ep=014] mask_avg: mc_mean=0.4012 mb_mean=0.3063 norm_overlap=0.9734 corr_cb=-0.3814
[EPOCH 014/089] train: loss=2.1399 acc=63.52% | val: loss=0.6444 acc=67.74% f1=23.08% auc=61.43% val_score=80.9022 val_score_bestthr=78.5401 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.401, mb=0.306, no=0.973, corr=-0.381) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 80.5179 -> 80.9022
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=015] disease_pos_weight=1.0000 mode=none
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.3971 mb_mean=0.2982 norm_overlap=0.9785 corr_cb=-0.2515 topkJ=0.0217
[TRAIN][ep=015] loss=2.1319 acc=63.70%
[TRAIN][ep=015] mask_avg: mc_mean=0.3901 mb_mean=0.3011 norm_overlap=0.9610 corr_cb=-0.4535
[EPOCH 015/089] train: loss=2.1319 acc=63.70% | val: loss=0.6411 acc=67.74% f1=23.08% auc=62.54% val_score=82.9035 val_score_bestthr=78.5401 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.390, mb=0.301, no=0.961, corr=-0.454) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=* 80.9022 -> 82.9035
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=016] disease_pos_weight=1.0000 mode=none
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.3844 mb_mean=0.2952 norm_overlap=0.9586 corr_cb=-0.4217 topkJ=0.0135
[TRAIN][ep=016] loss=2.1246 acc=63.52%
[TRAIN][ep=016] mask_avg: mc_mean=0.3815 mb_mean=0.3011 norm_overlap=0.9527 corr_cb=-0.4891
[EPOCH 016/089] train: loss=2.1246 acc=63.52% | val: loss=0.6414 acc=67.74% f1=23.08% auc=63.10% val_score=87.2586 val_score_bestthr=78.5401 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.381, mb=0.301, no=0.953, corr=-0.489) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=* 82.9035 -> 87.2586
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=017] disease_pos_weight=1.0000 mode=none
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.3837 mb_mean=0.3134 norm_overlap=0.9514 corr_cb=-0.5466 topkJ=0.0012
[TRAIN][ep=017] loss=2.1183 acc=63.52%
[TRAIN][ep=017] mask_avg: mc_mean=0.3725 mb_mean=0.3011 norm_overlap=0.9431 corr_cb=-0.5250
[EPOCH 017/089] train: loss=2.1183 acc=63.52% | val: loss=0.6383 acc=67.74% f1=23.08% auc=63.66% val_score=88.6660 val_score_bestthr=78.5401 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.372, mb=0.301, no=0.943, corr=-0.525) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=* 87.2586 -> 88.6660
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=018] disease_pos_weight=1.0000 mode=none
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.3751 mb_mean=0.2956 norm_overlap=0.9434 corr_cb=-0.5223 topkJ=0.0017
[TRAIN][ep=018] loss=1.4116 acc=64.43%
[TRAIN][ep=018] mask_avg: mc_mean=0.3658 mb_mean=0.3011 norm_overlap=0.9356 corr_cb=-0.5509
[EPOCH 018/089] train: loss=1.4116 acc=64.43% | val: loss=0.6370 acc=67.74% f1=23.08% auc=63.32% val_score=86.5455 val_score_bestthr=78.5401 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.366, mb=0.301, no=0.936, corr=-0.551) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 88.6660 -> 86.5455
[DBG][ep=019] disease_pos_weight=1.0000 mode=none
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.3693 mb_mean=0.2956 norm_overlap=0.9307 corr_cb=-0.5722 topkJ=0.0004
[TRAIN][ep=019] loss=0.7026 acc=65.52%
[TRAIN][ep=019] mask_avg: mc_mean=0.3593 mb_mean=0.3011 norm_overlap=0.9271 corr_cb=-0.5740
[EPOCH 019/089] train: loss=0.7026 acc=65.52% | val: loss=0.6332 acc=66.13% f1=40.00% auc=64.33% val_score=85.8087 val_score_bestthr=85.4793 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.359, mb=0.301, no=0.927, corr=-0.574) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 88.6660 -> 85.8087
[DBG][ep=020] disease_pos_weight=1.0000 mode=none
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.3634 mb_mean=0.2989 norm_overlap=0.9455 corr_cb=-0.4575 topkJ=0.0004
[TRAIN][ep=020] loss=0.5252 acc=66.06%
[TRAIN][ep=020] mask_avg: mc_mean=0.3521 mb_mean=0.3011 norm_overlap=0.9167 corr_cb=-0.5948
[EPOCH 020/089] train: loss=0.5252 acc=66.06% | val: loss=0.6297 acc=67.74% f1=50.00% auc=65.11% val_score=90.0707 val_score_bestthr=92.0414 | dyn(w_pfs=0.090, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.352, mb=0.301, no=0.917, corr=-0.595) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=* 88.6660 -> 90.0707
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=021] disease_pos_weight=1.0000 mode=none
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.3513 mb_mean=0.2971 norm_overlap=0.9198 corr_cb=-0.5289 topkJ=0.0000
[TRAIN][ep=021] loss=0.8047 acc=67.15%
[TRAIN][ep=021] mask_avg: mc_mean=0.3463 mb_mean=0.3011 norm_overlap=0.9072 corr_cb=-0.6137
[EPOCH 021/089] train: loss=0.8047 acc=67.15% | val: loss=0.6297 acc=67.74% f1=37.50% auc=64.44% val_score=90.0707 val_score_bestthr=85.9437 | dyn(w_pfs=0.130, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.346, mb=0.301, no=0.907, corr=-0.614) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 90.0707
[DBG][ep=022] disease_pos_weight=1.0000 mode=none
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.3312 mb_mean=0.2986 norm_overlap=0.8870 corr_cb=-0.6648 topkJ=0.0000
[TRAIN][ep=022] loss=1.0729 acc=66.24%
[TRAIN][ep=022] mask_avg: mc_mean=0.3404 mb_mean=0.3011 norm_overlap=0.8959 corr_cb=-0.6332
[EPOCH 022/089] train: loss=1.0729 acc=66.24% | val: loss=0.6268 acc=67.74% f1=47.37% auc=66.11% val_score=80.0795 val_score_bestthr=90.8742 | dyn(w_pfs=0.170, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.340, mb=0.301, no=0.896, corr=-0.633) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 80.0795
[DBG][ep=023] disease_pos_weight=1.0000 mode=none
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.3473 mb_mean=0.3085 norm_overlap=0.9011 corr_cb=-0.6417 topkJ=0.0000
[TRAIN][ep=023] loss=1.3504 acc=66.79%
[TRAIN][ep=023] mask_avg: mc_mean=0.3381 mb_mean=0.3011 norm_overlap=0.8904 corr_cb=-0.6471
[EPOCH 023/089] train: loss=1.3504 acc=66.79% | val: loss=0.6275 acc=66.13% f1=51.16% auc=64.44% val_score=87.9096 val_score_bestthr=90.9891 | dyn(w_pfs=0.210, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.338, mb=0.301, no=0.890, corr=-0.647) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 87.9096
[DBG][ep=024] disease_pos_weight=1.0000 mode=none
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.3283 mb_mean=0.2990 norm_overlap=0.8758 corr_cb=-0.6706 topkJ=0.0000
[TRAIN][ep=024] loss=1.6173 acc=67.51%
[TRAIN][ep=024] mask_avg: mc_mean=0.3340 mb_mean=0.3011 norm_overlap=0.8802 corr_cb=-0.6618
[EPOCH 024/089] train: loss=1.6173 acc=67.51% | val: loss=0.6257 acc=66.13% f1=40.00% auc=65.55% val_score=81.1574 val_score_bestthr=85.7603 | dyn(w_pfs=0.250, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.334, mb=0.301, no=0.880, corr=-0.662) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 81.1574
[DBG][ep=025] disease_pos_weight=1.0000 mode=none
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.3291 mb_mean=0.2969 norm_overlap=0.8455 corr_cb=-0.7091 topkJ=0.0000
[TRAIN][ep=025] loss=1.8885 acc=70.78%
[TRAIN][ep=025] mask_avg: mc_mean=0.3315 mb_mean=0.3011 norm_overlap=0.8745 corr_cb=-0.6700
[EPOCH 025/089] train: loss=1.8885 acc=70.78% | val: loss=0.6266 acc=66.13% f1=32.26% auc=64.33% val_score=84.5666 val_score_bestthr=81.7791 | dyn(w_pfs=0.150, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.331, mb=0.301, no=0.874, corr=-0.670) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 84.5666
[DBG][ep=026] disease_pos_weight=1.0000 mode=none
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.3307 mb_mean=0.3011 norm_overlap=0.8473 corr_cb=-0.7332 topkJ=0.0000
[TRAIN][ep=026] loss=1.1822 acc=72.05%
[TRAIN][ep=026] mask_avg: mc_mean=0.3278 mb_mean=0.3011 norm_overlap=0.8656 corr_cb=-0.6806
[EPOCH 026/089] train: loss=1.1822 acc=72.05% | val: loss=0.6286 acc=67.74% f1=33.33% auc=63.88% val_score=84.8269 val_score_bestthr=83.9489 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.328, mb=0.301, no=0.866, corr=-0.681) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 84.8269
[DBG][ep=027] disease_pos_weight=1.0000 mode=none
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.3225 mb_mean=0.2902 norm_overlap=0.8312 corr_cb=-0.7443 topkJ=0.0000
[TRAIN][ep=027] loss=0.4760 acc=74.95%
[TRAIN][ep=027] mask_avg: mc_mean=0.3248 mb_mean=0.3011 norm_overlap=0.8566 corr_cb=-0.6901
[EPOCH 027/089] train: loss=0.4760 acc=74.95% | val: loss=0.6250 acc=67.74% f1=33.33% auc=64.55% val_score=85.6294 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.325, mb=0.301, no=0.857, corr=-0.690) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 85.6294
[DBG][ep=028] disease_pos_weight=1.0000 mode=none
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.3259 mb_mean=0.3063 norm_overlap=0.8766 corr_cb=-0.6832 topkJ=0.0000
[TRAIN][ep=028] loss=0.4561 acc=75.86%
[TRAIN][ep=028] mask_avg: mc_mean=0.3222 mb_mean=0.3011 norm_overlap=0.8484 corr_cb=-0.7001
[EPOCH 028/089] train: loss=0.4561 acc=75.86% | val: loss=0.6247 acc=67.74% f1=58.33% auc=64.66% val_score=89.0116 val_score_bestthr=95.5901 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.322, mb=0.301, no=0.848, corr=-0.700) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0116
[DBG][ep=029] disease_pos_weight=1.0000 mode=none
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.3276 mb_mean=0.3026 norm_overlap=0.8539 corr_cb=-0.7153 topkJ=0.0000
[TRAIN][ep=029] loss=0.7276 acc=74.77%
[TRAIN][ep=029] mask_avg: mc_mean=0.3192 mb_mean=0.3011 norm_overlap=0.8411 corr_cb=-0.7020
[EPOCH 029/089] train: loss=0.7276 acc=74.77% | val: loss=0.6279 acc=67.74% f1=33.33% auc=64.66% val_score=80.2804 val_score_bestthr=83.9489 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.319, mb=0.301, no=0.841, corr=-0.702) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 80.2804
[DBG][ep=030] disease_pos_weight=1.0000 mode=none
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.3166 mb_mean=0.3001 norm_overlap=0.8181 corr_cb=-0.7505 topkJ=0.0000
[TRAIN][ep=030] loss=1.0073 acc=76.04%
[TRAIN][ep=030] mask_avg: mc_mean=0.3177 mb_mean=0.3011 norm_overlap=0.8358 corr_cb=-0.7071
[EPOCH 030/089] train: loss=1.0073 acc=76.04% | val: loss=0.6269 acc=67.74% f1=33.33% auc=63.66% val_score=79.5360 val_score_bestthr=83.9489 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.318, mb=0.301, no=0.836, corr=-0.707) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 79.5360
[DBG][ep=031] disease_pos_weight=1.0000 mode=none
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.3197 mb_mean=0.2972 norm_overlap=0.8015 corr_cb=-0.7462 topkJ=0.0000
[TRAIN][ep=031] loss=0.4607 acc=77.13%
[TRAIN][ep=031] mask_avg: mc_mean=0.3167 mb_mean=0.3011 norm_overlap=0.8327 corr_cb=-0.7105
[EPOCH 031/089] train: loss=0.4607 acc=77.13% | val: loss=0.6274 acc=67.74% f1=33.33% auc=63.10% val_score=79.5360 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.711) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 79.5360
[DBG][ep=032] disease_pos_weight=1.0000 mode=none
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.3258 mb_mean=0.2887 norm_overlap=0.8189 corr_cb=-0.7439 topkJ=0.0000
[TRAIN][ep=032] loss=0.4312 acc=77.31%
[TRAIN][ep=032] mask_avg: mc_mean=0.3166 mb_mean=0.3011 norm_overlap=0.8328 corr_cb=-0.7099
[EPOCH 032/089] train: loss=0.4312 acc=77.31% | val: loss=0.6298 acc=67.74% f1=58.33% auc=63.55% val_score=89.0779 val_score_bestthr=95.5901 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.710) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=033] disease_pos_weight=1.0000 mode=none
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.3049 mb_mean=0.2929 norm_overlap=0.8495 corr_cb=-0.6459 topkJ=0.0000
[TRAIN][ep=033] loss=0.4290 acc=76.59%
[TRAIN][ep=033] mask_avg: mc_mean=0.3166 mb_mean=0.3011 norm_overlap=0.8328 corr_cb=-0.7103
[EPOCH 033/089] train: loss=0.4290 acc=76.59% | val: loss=0.6308 acc=67.74% f1=33.33% auc=63.43% val_score=89.0779 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.710) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=034] disease_pos_weight=1.0000 mode=none
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.3152 mb_mean=0.2992 norm_overlap=0.8260 corr_cb=-0.6798 topkJ=0.0000
[TRAIN][ep=034] loss=0.4270 acc=77.86%
[TRAIN][ep=034] mask_avg: mc_mean=0.3166 mb_mean=0.3011 norm_overlap=0.8326 corr_cb=-0.7097
[EPOCH 034/089] train: loss=0.4270 acc=77.86% | val: loss=0.6293 acc=67.74% f1=33.33% auc=63.55% val_score=86.9755 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.710) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 86.9755
[DBG][ep=035] disease_pos_weight=1.0000 mode=none
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.3051 mb_mean=0.3152 norm_overlap=0.8339 corr_cb=-0.7537 topkJ=0.0000
[TRAIN][ep=035] loss=0.4250 acc=77.50%
[TRAIN][ep=035] mask_avg: mc_mean=0.3167 mb_mean=0.3011 norm_overlap=0.8326 corr_cb=-0.7100
[EPOCH 035/089] train: loss=0.4250 acc=77.50% | val: loss=0.6308 acc=67.74% f1=58.33% auc=63.55% val_score=89.0779 val_score_bestthr=95.5901 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.710) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=036] disease_pos_weight=1.0000 mode=none
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.3178 mb_mean=0.3092 norm_overlap=0.8034 corr_cb=-0.7789 topkJ=0.0000
[TRAIN][ep=036] loss=0.4231 acc=77.31%
[TRAIN][ep=036] mask_avg: mc_mean=0.3166 mb_mean=0.3011 norm_overlap=0.8327 corr_cb=-0.7115
[EPOCH 036/089] train: loss=0.4231 acc=77.31% | val: loss=0.6305 acc=67.74% f1=33.33% auc=63.32% val_score=86.9755 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.712) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 86.9755
[DBG][ep=037] disease_pos_weight=1.0000 mode=none
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.3112 mb_mean=0.3064 norm_overlap=0.8652 corr_cb=-0.5908 topkJ=0.0000
[TRAIN][ep=037] loss=0.4211 acc=77.68%
[TRAIN][ep=037] mask_avg: mc_mean=0.3166 mb_mean=0.3011 norm_overlap=0.8326 corr_cb=-0.7093
[EPOCH 037/089] train: loss=0.4211 acc=77.68% | val: loss=0.6319 acc=67.74% f1=33.33% auc=63.10% val_score=89.0779 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.709) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=038] disease_pos_weight=1.0000 mode=none
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.3102 mb_mean=0.3016 norm_overlap=0.8360 corr_cb=-0.6464 topkJ=0.0000
[TRAIN][ep=038] loss=0.4191 acc=77.68%
[TRAIN][ep=038] mask_avg: mc_mean=0.3167 mb_mean=0.3011 norm_overlap=0.8326 corr_cb=-0.7106
[EPOCH 038/089] train: loss=0.4191 acc=77.68% | val: loss=0.6319 acc=67.74% f1=33.33% auc=63.32% val_score=82.9406 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.711) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 82.9406
[DBG][ep=039] disease_pos_weight=1.0000 mode=none
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.3192 mb_mean=0.3033 norm_overlap=0.8284 corr_cb=-0.7284 topkJ=0.0000
[TRAIN][ep=039] loss=0.4171 acc=77.86%
[TRAIN][ep=039] mask_avg: mc_mean=0.3166 mb_mean=0.3011 norm_overlap=0.8327 corr_cb=-0.7102
[EPOCH 039/089] train: loss=0.4171 acc=77.86% | val: loss=0.6323 acc=67.74% f1=33.33% auc=63.10% val_score=89.0779 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.710) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=040] disease_pos_weight=1.0000 mode=none
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.3126 mb_mean=0.3065 norm_overlap=0.7913 corr_cb=-0.7956 topkJ=0.0000
[TRAIN][ep=040] loss=0.4161 acc=78.04%
[TRAIN][ep=040] mask_avg: mc_mean=0.3166 mb_mean=0.3011 norm_overlap=0.8330 corr_cb=-0.7072
[EPOCH 040/089] train: loss=0.4161 acc=78.04% | val: loss=0.6326 acc=67.74% f1=33.33% auc=63.32% val_score=84.9487 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.707) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 84.9487
[DBG][ep=041] disease_pos_weight=1.0000 mode=none
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.3091 mb_mean=0.2964 norm_overlap=0.8418 corr_cb=-0.6487 topkJ=0.0000
[TRAIN][ep=041] loss=0.4140 acc=78.22%
[TRAIN][ep=041] mask_avg: mc_mean=0.3166 mb_mean=0.3011 norm_overlap=0.8328 corr_cb=-0.7094
[EPOCH 041/089] train: loss=0.4140 acc=78.22% | val: loss=0.6337 acc=67.74% f1=33.33% auc=62.99% val_score=89.0779 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.709) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=042] disease_pos_weight=1.0000 mode=none
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.3168 mb_mean=0.3025 norm_overlap=0.8330 corr_cb=-0.7347 topkJ=0.0000
[TRAIN][ep=042] loss=0.4127 acc=77.68%
[TRAIN][ep=042] mask_avg: mc_mean=0.3166 mb_mean=0.3011 norm_overlap=0.8326 corr_cb=-0.7100
[EPOCH 042/089] train: loss=0.4127 acc=77.68% | val: loss=0.6340 acc=67.74% f1=33.33% auc=63.43% val_score=89.0779 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.710) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=043] disease_pos_weight=1.0000 mode=none
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.3274 mb_mean=0.2901 norm_overlap=0.7846 corr_cb=-0.7807 topkJ=0.0000
[TRAIN][ep=043] loss=0.4104 acc=78.04%
[TRAIN][ep=043] mask_avg: mc_mean=0.3166 mb_mean=0.3011 norm_overlap=0.8327 corr_cb=-0.7103
[EPOCH 043/089] train: loss=0.4104 acc=78.04% | val: loss=0.6347 acc=67.74% f1=33.33% auc=63.43% val_score=89.0779 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.710) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=044] disease_pos_weight=1.0000 mode=none
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.3240 mb_mean=0.2943 norm_overlap=0.8064 corr_cb=-0.7722 topkJ=0.0000
[TRAIN][ep=044] loss=0.4085 acc=78.22%
[TRAIN][ep=044] mask_avg: mc_mean=0.3166 mb_mean=0.3011 norm_overlap=0.8329 corr_cb=-0.7092
[EPOCH 044/089] train: loss=0.4085 acc=78.22% | val: loss=0.6346 acc=67.74% f1=33.33% auc=63.55% val_score=89.0779 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.709) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=045] disease_pos_weight=1.0000 mode=none
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.3225 mb_mean=0.2792 norm_overlap=0.7703 corr_cb=-0.7612 topkJ=0.0000
[TRAIN][ep=045] loss=0.4075 acc=78.40%
[TRAIN][ep=045] mask_avg: mc_mean=0.3166 mb_mean=0.3011 norm_overlap=0.8327 corr_cb=-0.7096
[EPOCH 045/089] train: loss=0.4075 acc=78.40% | val: loss=0.6363 acc=67.74% f1=33.33% auc=63.32% val_score=89.0779 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.710) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=046] disease_pos_weight=1.0000 mode=none
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.3060 mb_mean=0.3170 norm_overlap=0.8331 corr_cb=-0.7778 topkJ=0.0000
[TRAIN][ep=046] loss=0.4059 acc=79.13%
[TRAIN][ep=046] mask_avg: mc_mean=0.3166 mb_mean=0.3011 norm_overlap=0.8327 corr_cb=-0.7104
[EPOCH 046/089] train: loss=0.4059 acc=79.13% | val: loss=0.6369 acc=67.74% f1=33.33% auc=63.66% val_score=89.0779 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.710) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=047] disease_pos_weight=1.0000 mode=none
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.3224 mb_mean=0.3096 norm_overlap=0.8697 corr_cb=-0.6871 topkJ=0.0000
[TRAIN][ep=047] loss=0.4038 acc=78.40%
[TRAIN][ep=047] mask_avg: mc_mean=0.3166 mb_mean=0.3011 norm_overlap=0.8328 corr_cb=-0.7106
[EPOCH 047/089] train: loss=0.4038 acc=78.40% | val: loss=0.6368 acc=67.74% f1=33.33% auc=63.21% val_score=80.7554 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.711) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 80.7554
[DBG][ep=048] disease_pos_weight=1.0000 mode=none
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.3211 mb_mean=0.2993 norm_overlap=0.8311 corr_cb=-0.7150 topkJ=0.0000
[TRAIN][ep=048] loss=0.4025 acc=78.40%
[TRAIN][ep=048] mask_avg: mc_mean=0.3166 mb_mean=0.3011 norm_overlap=0.8328 corr_cb=-0.7097
[EPOCH 048/089] train: loss=0.4025 acc=78.40% | val: loss=0.6372 acc=67.74% f1=33.33% auc=63.32% val_score=80.7554 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.710) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 80.7554
[DBG][ep=049] disease_pos_weight=1.0000 mode=none
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.3091 mb_mean=0.3018 norm_overlap=0.8433 corr_cb=-0.6754 topkJ=0.0000
[TRAIN][ep=049] loss=0.4003 acc=79.31%
[TRAIN][ep=049] mask_avg: mc_mean=0.3166 mb_mean=0.3011 norm_overlap=0.8326 corr_cb=-0.7110
[EPOCH 049/089] train: loss=0.4003 acc=79.31% | val: loss=0.6393 acc=67.74% f1=33.33% auc=63.21% val_score=89.0779 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.711) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=050] disease_pos_weight=1.0000 mode=none
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.3133 mb_mean=0.3179 norm_overlap=0.8485 corr_cb=-0.7307 topkJ=0.0000
[TRAIN][ep=050] loss=0.3995 acc=79.49%
[TRAIN][ep=050] mask_avg: mc_mean=0.3166 mb_mean=0.3011 norm_overlap=0.8324 corr_cb=-0.7101
[EPOCH 050/089] train: loss=0.3995 acc=79.49% | val: loss=0.6407 acc=67.74% f1=33.33% auc=63.21% val_score=89.0779 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.832, corr=-0.710) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[EARLY STOP] no improvement for 30 epochs. best_epoch=20
[CKPT] Loaded best for testing: results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
=============== FIT DONE ===============
[BEST] epoch=20 | val_acc=67.74% | val_f1=50.00% | val_auc=65.11% | val_score=90.0707 | val_score_bestthr=92.0414
[TEST@BEST] thr_used=0.650 | acc=63.64% f1=0.00% auc=59.66% | SP_sex=0.00% EO_sex=0.00% SP_age=0.00% EO_age=0.00%
[TIME] 0.84 min
[OK] Saved: results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/summary_fold_0.json
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5236 mb_mean=0.5061 norm_overlap=0.9998 corr_cb=-0.1913 topkJ=0.0225
[TRAIN][ep=000] loss=0.6926 acc=51.91%
[TRAIN][ep=000] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2677
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5223 mb_mean=0.5043 norm_overlap=0.9995 corr_cb=-0.3398 topkJ=0.0124
[TRAIN][ep=001] loss=0.6752 acc=63.70%
[TRAIN][ep=001] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2716
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5214 mb_mean=0.5039 norm_overlap=0.9998 corr_cb=-0.1603 topkJ=0.0315
[TRAIN][ep=002] loss=0.6633 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2709
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5198 mb_mean=0.5045 norm_overlap=0.9997 corr_cb=-0.2413 topkJ=0.0174
[TRAIN][ep=003] loss=0.6578 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2654
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5237 mb_mean=0.5050 norm_overlap=0.9997 corr_cb=-0.2572 topkJ=0.0114
[TRAIN][ep=004] loss=0.6554 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2685
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5214 mb_mean=0.5050 norm_overlap=0.9997 corr_cb=-0.2780 topkJ=0.0280
[TRAIN][ep=005] loss=0.6542 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2701
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5217 mb_mean=0.5043 norm_overlap=0.9997 corr_cb=-0.2886 topkJ=0.0135
[TRAIN][ep=006] loss=0.6538 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2669
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5184 mb_mean=0.5067 norm_overlap=0.9997 corr_cb=-0.3329 topkJ=0.0218
[TRAIN][ep=007] loss=0.6520 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2713
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5223 mb_mean=0.5062 norm_overlap=0.9996 corr_cb=-0.3736 topkJ=0.0062
[TRAIN][ep=008] loss=0.6517 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2684
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5215 mb_mean=0.5068 norm_overlap=0.9997 corr_cb=-0.2734 topkJ=0.0259
[TRAIN][ep=009] loss=0.6500 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2687
================= FIT START (fold=0) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.35 select_by=val_score | eval_thr_mode=best_acc eval_thr_grid=coarse | disease_pos_weight_mode=none freeze_b_after=15 | two_stage=True stage1_ratio=0.35 stage2_lr_mult=0.3 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5235 mb_mean=0.5056 norm_overlap=0.9996 corr_cb=-0.2652 topkJ=0.0979
[TRAIN][ep=000] loss=0.6488 acc=63.70%
[TRAIN][ep=000] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2687
[EPOCH 000/089] train: loss=0.6488 acc=63.70% | val: loss=0.6590 acc=62.90% f1=0.00% auc=49.28% val_score=64.2297 val_score_bestthr=62.9032 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.521, mb=0.506, no=1.000, corr=-0.269) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* -1000000000000000000.0000 -> 64.2297
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5221 mb_mean=0.5070 norm_overlap=0.9998 corr_cb=-0.2391 topkJ=0.0404
[TRAIN][ep=001] loss=0.6469 acc=63.70%
[TRAIN][ep=001] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2684
[EPOCH 001/089] train: loss=0.6469 acc=63.70% | val: loss=0.6577 acc=62.90% f1=0.00% auc=51.28% val_score=67.4541 val_score_bestthr=62.9032 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.521, mb=0.506, no=1.000, corr=-0.268) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 64.2297 -> 67.4541
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5187 mb_mean=0.5040 norm_overlap=0.9998 corr_cb=-0.2618 topkJ=0.0162
[TRAIN][ep=002] loss=0.6457 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2713
[EPOCH 002/089] train: loss=0.6457 acc=63.70% | val: loss=0.6570 acc=62.90% f1=14.81% auc=51.84% val_score=64.2297 val_score_bestthr=69.7231 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.521, mb=0.506, no=1.000, corr=-0.271) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 67.4541 -> 64.2297
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5199 mb_mean=0.5065 norm_overlap=0.9998 corr_cb=-0.2547 topkJ=0.0454
[TRAIN][ep=003] loss=0.6442 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2668
[EPOCH 003/089] train: loss=0.6442 acc=63.70% | val: loss=0.6557 acc=62.90% f1=14.81% auc=52.73% val_score=66.7750 val_score_bestthr=69.7231 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.521, mb=0.506, no=1.000, corr=-0.267) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 67.4541 -> 66.7750
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5227 mb_mean=0.5044 norm_overlap=0.9996 corr_cb=-0.3527 topkJ=0.0157
[TRAIN][ep=004] loss=0.6434 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2700
[EPOCH 004/089] train: loss=0.6434 acc=63.70% | val: loss=0.6545 acc=64.52% f1=8.33% auc=54.07% val_score=66.7750 val_score_bestthr=68.1795 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.521, mb=0.506, no=1.000, corr=-0.270) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 67.4541 -> 66.7750
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5208 mb_mean=0.5063 norm_overlap=0.9997 corr_cb=-0.2071 topkJ=0.0176
[TRAIN][ep=005] loss=2.2287 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.5146 mb_mean=0.4947 norm_overlap=0.9998 corr_cb=-0.1593
[EPOCH 005/089] train: loss=2.2287 acc=63.70% | val: loss=0.6549 acc=62.90% f1=20.69% auc=54.63% val_score=75.5211 val_score_bestthr=72.4762 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.515, mb=0.495, no=1.000, corr=-0.159) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 67.4541 -> 75.5211
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5082 mb_mean=0.4851 norm_overlap=0.9997 corr_cb=-0.1682 topkJ=0.0376
[TRAIN][ep=006] loss=2.2270 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.5007 mb_mean=0.4723 norm_overlap=1.0000 corr_cb=-0.0308
[EPOCH 006/089] train: loss=2.2270 acc=63.70% | val: loss=0.6538 acc=64.52% f1=21.43% auc=55.85% val_score=76.2980 val_score_bestthr=74.3752 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.501, mb=0.472, no=1.000, corr=-0.031) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 75.5211 -> 76.2980
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4928 mb_mean=0.4606 norm_overlap=1.0000 corr_cb=0.0006 topkJ=0.0286
[TRAIN][ep=007] loss=2.2241 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.4867 mb_mean=0.4485 norm_overlap=1.0004 corr_cb=0.0626
[EPOCH 007/089] train: loss=2.2241 acc=63.70% | val: loss=0.6524 acc=66.13% f1=27.59% auc=56.74% val_score=67.1224 val_score_bestthr=78.8618 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.487, mb=0.449, no=1.000, corr=0.063) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.2980 -> 67.1224
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4809 mb_mean=0.4372 norm_overlap=0.9993 corr_cb=-0.1184 topkJ=0.0245
[TRAIN][ep=008] loss=2.2144 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.4731 mb_mean=0.4241 norm_overlap=1.0014 corr_cb=0.1487
[EPOCH 008/089] train: loss=2.2144 acc=63.70% | val: loss=0.6518 acc=66.13% f1=27.59% auc=57.53% val_score=80.5179 val_score_bestthr=78.8618 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.473, mb=0.424, no=1.001, corr=0.149) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 76.2980 -> 80.5179
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4655 mb_mean=0.4207 norm_overlap=1.0013 corr_cb=0.1541 topkJ=0.1007
[TRAIN][ep=009] loss=2.2121 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.4598 mb_mean=0.3995 norm_overlap=1.0019 corr_cb=0.1306
[EPOCH 009/089] train: loss=2.2121 acc=63.70% | val: loss=0.6511 acc=64.52% f1=31.25% auc=58.42% val_score=76.3813 val_score_bestthr=79.3442 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.460, mb=0.399, no=1.002, corr=0.131) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 80.5179 -> 76.3813
[DBG][ep=010] disease_pos_weight=1.0000 mode=none
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.4552 mb_mean=0.3854 norm_overlap=1.0012 corr_cb=0.0784 topkJ=0.0529
[TRAIN][ep=010] loss=2.2031 acc=63.70%
[TRAIN][ep=010] mask_avg: mc_mean=0.4470 mb_mean=0.3762 norm_overlap=1.0014 corr_cb=0.0629
[EPOCH 010/089] train: loss=2.2031 acc=63.70% | val: loss=0.6491 acc=66.13% f1=16.00% auc=59.09% val_score=70.3872 val_score_bestthr=73.5938 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.447, mb=0.376, no=1.001, corr=0.063) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 80.5179 -> 70.3872
[DBG][ep=011] disease_pos_weight=1.0000 mode=none
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.4452 mb_mean=0.3639 norm_overlap=1.0000 corr_cb=-0.0001 topkJ=0.0264
[TRAIN][ep=011] loss=2.1971 acc=63.70%
[TRAIN][ep=011] mask_avg: mc_mean=0.4347 mb_mean=0.3550 norm_overlap=0.9998 corr_cb=-0.0127
[EPOCH 011/089] train: loss=2.1971 acc=63.70% | val: loss=0.6477 acc=67.74% f1=23.08% auc=60.09% val_score=74.5015 val_score_bestthr=78.5401 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.435, mb=0.355, no=1.000, corr=-0.013) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 80.5179 -> 74.5015
[DBG][ep=012] disease_pos_weight=1.0000 mode=none
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.4208 mb_mean=0.3282 norm_overlap=1.0022 corr_cb=0.0483 topkJ=0.0648
[TRAIN][ep=012] loss=2.1932 acc=63.70%
[TRAIN][ep=012] mask_avg: mc_mean=0.4223 mb_mean=0.3364 norm_overlap=0.9953 corr_cb=-0.1187
[EPOCH 012/089] train: loss=2.1932 acc=63.70% | val: loss=0.6469 acc=67.74% f1=41.18% auc=60.98% val_score=79.5102 val_score_bestthr=87.1786 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.422, mb=0.336, no=0.995, corr=-0.119) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 80.5179 -> 79.5102
[DBG][ep=013] disease_pos_weight=1.0000 mode=none
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.4212 mb_mean=0.3329 norm_overlap=0.9890 corr_cb=-0.2663 topkJ=0.0240
[TRAIN][ep=013] loss=2.1827 acc=63.70%
[TRAIN][ep=013] mask_avg: mc_mean=0.4120 mb_mean=0.3200 norm_overlap=0.9868 corr_cb=-0.2567
[EPOCH 013/089] train: loss=2.1827 acc=63.70% | val: loss=0.6450 acc=67.74% f1=23.08% auc=62.21% val_score=77.8847 val_score_bestthr=78.5401 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.412, mb=0.320, no=0.987, corr=-0.257) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 80.5179 -> 77.8847
[DBG][ep=014] disease_pos_weight=1.0000 mode=none
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.4011 mb_mean=0.3048 norm_overlap=0.9678 corr_cb=-0.4910 topkJ=0.0069
[TRAIN][ep=014] loss=2.1809 acc=63.52%
[TRAIN][ep=014] mask_avg: mc_mean=0.4012 mb_mean=0.3063 norm_overlap=0.9734 corr_cb=-0.3816
[EPOCH 014/089] train: loss=2.1809 acc=63.52% | val: loss=0.6444 acc=67.74% f1=23.08% auc=61.43% val_score=80.9022 val_score_bestthr=78.5401 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.401, mb=0.306, no=0.973, corr=-0.382) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 80.5179 -> 80.9022
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=015] disease_pos_weight=1.0000 mode=none
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.3971 mb_mean=0.2982 norm_overlap=0.9785 corr_cb=-0.2516 topkJ=0.0217
[TRAIN][ep=015] loss=2.1729 acc=63.70%
[TRAIN][ep=015] mask_avg: mc_mean=0.3901 mb_mean=0.3011 norm_overlap=0.9610 corr_cb=-0.4536
[EPOCH 015/089] train: loss=2.1729 acc=63.70% | val: loss=0.6411 acc=67.74% f1=23.08% auc=62.54% val_score=82.9035 val_score_bestthr=78.5401 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.390, mb=0.301, no=0.961, corr=-0.454) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=* 80.9022 -> 82.9035
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=016] disease_pos_weight=1.0000 mode=none
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.3844 mb_mean=0.2952 norm_overlap=0.9586 corr_cb=-0.4216 topkJ=0.0135
[TRAIN][ep=016] loss=2.1656 acc=63.52%
[TRAIN][ep=016] mask_avg: mc_mean=0.3815 mb_mean=0.3011 norm_overlap=0.9527 corr_cb=-0.4892
[EPOCH 016/089] train: loss=2.1656 acc=63.52% | val: loss=0.6414 acc=67.74% f1=23.08% auc=63.10% val_score=87.2586 val_score_bestthr=78.5401 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.381, mb=0.301, no=0.953, corr=-0.489) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=* 82.9035 -> 87.2586
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=017] disease_pos_weight=1.0000 mode=none
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.3837 mb_mean=0.3134 norm_overlap=0.9514 corr_cb=-0.5466 topkJ=0.0012
[TRAIN][ep=017] loss=2.1593 acc=63.52%
[TRAIN][ep=017] mask_avg: mc_mean=0.3725 mb_mean=0.3011 norm_overlap=0.9430 corr_cb=-0.5251
[EPOCH 017/089] train: loss=2.1593 acc=63.52% | val: loss=0.6383 acc=67.74% f1=23.08% auc=63.66% val_score=88.6660 val_score_bestthr=78.5401 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.372, mb=0.301, no=0.943, corr=-0.525) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=* 87.2586 -> 88.6660
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=018] disease_pos_weight=1.0000 mode=none
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.3751 mb_mean=0.2956 norm_overlap=0.9434 corr_cb=-0.5223 topkJ=0.0017
[TRAIN][ep=018] loss=1.4525 acc=64.43%
[TRAIN][ep=018] mask_avg: mc_mean=0.3658 mb_mean=0.3011 norm_overlap=0.9356 corr_cb=-0.5510
[EPOCH 018/089] train: loss=1.4525 acc=64.43% | val: loss=0.6371 acc=67.74% f1=23.08% auc=63.32% val_score=86.5455 val_score_bestthr=78.5401 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.366, mb=0.301, no=0.936, corr=-0.551) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 88.6660 -> 86.5455
[DBG][ep=019] disease_pos_weight=1.0000 mode=none
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.3693 mb_mean=0.2956 norm_overlap=0.9308 corr_cb=-0.5722 topkJ=0.0004
[TRAIN][ep=019] loss=0.7434 acc=65.52%
[TRAIN][ep=019] mask_avg: mc_mean=0.3593 mb_mean=0.3011 norm_overlap=0.9271 corr_cb=-0.5741
[EPOCH 019/089] train: loss=0.7434 acc=65.52% | val: loss=0.6332 acc=66.13% f1=40.00% auc=64.33% val_score=85.8087 val_score_bestthr=85.4793 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.359, mb=0.301, no=0.927, corr=-0.574) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 88.6660 -> 85.8087
[DBG][ep=020] disease_pos_weight=1.0000 mode=none
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.3634 mb_mean=0.2989 norm_overlap=0.9456 corr_cb=-0.4574 topkJ=0.0004
[TRAIN][ep=020] loss=0.5660 acc=66.06%
[TRAIN][ep=020] mask_avg: mc_mean=0.3521 mb_mean=0.3011 norm_overlap=0.9167 corr_cb=-0.5949
[EPOCH 020/089] train: loss=0.5660 acc=66.06% | val: loss=0.6297 acc=67.74% f1=50.00% auc=65.11% val_score=90.0707 val_score_bestthr=92.0414 | dyn(w_pfs=0.090, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.352, mb=0.301, no=0.917, corr=-0.595) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=* 88.6660 -> 90.0707
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=021] disease_pos_weight=1.0000 mode=none
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.3513 mb_mean=0.2971 norm_overlap=0.9198 corr_cb=-0.5292 topkJ=0.0000
[TRAIN][ep=021] loss=0.8455 acc=67.15%
[TRAIN][ep=021] mask_avg: mc_mean=0.3463 mb_mean=0.3011 norm_overlap=0.9072 corr_cb=-0.6139
[EPOCH 021/089] train: loss=0.8455 acc=67.15% | val: loss=0.6297 acc=67.74% f1=37.50% auc=64.44% val_score=90.0707 val_score_bestthr=85.9437 | dyn(w_pfs=0.130, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.346, mb=0.301, no=0.907, corr=-0.614) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 90.0707
[DBG][ep=022] disease_pos_weight=1.0000 mode=none
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.3312 mb_mean=0.2987 norm_overlap=0.8870 corr_cb=-0.6649 topkJ=0.0000
[TRAIN][ep=022] loss=1.1137 acc=66.24%
[TRAIN][ep=022] mask_avg: mc_mean=0.3404 mb_mean=0.3011 norm_overlap=0.8959 corr_cb=-0.6333
[EPOCH 022/089] train: loss=1.1137 acc=66.24% | val: loss=0.6268 acc=67.74% f1=47.37% auc=66.00% val_score=80.0795 val_score_bestthr=90.8742 | dyn(w_pfs=0.170, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.340, mb=0.301, no=0.896, corr=-0.633) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 80.0795
[DBG][ep=023] disease_pos_weight=1.0000 mode=none
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.3473 mb_mean=0.3085 norm_overlap=0.9011 corr_cb=-0.6417 topkJ=0.0000
[TRAIN][ep=023] loss=1.3911 acc=66.79%
[TRAIN][ep=023] mask_avg: mc_mean=0.3381 mb_mean=0.3011 norm_overlap=0.8904 corr_cb=-0.6473
[EPOCH 023/089] train: loss=1.3911 acc=66.79% | val: loss=0.6276 acc=66.13% f1=51.16% auc=64.33% val_score=87.9096 val_score_bestthr=90.9891 | dyn(w_pfs=0.210, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.338, mb=0.301, no=0.890, corr=-0.647) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 87.9096
[DBG][ep=024] disease_pos_weight=1.0000 mode=none
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.3283 mb_mean=0.2990 norm_overlap=0.8758 corr_cb=-0.6708 topkJ=0.0000
[TRAIN][ep=024] loss=1.6580 acc=67.51%
[TRAIN][ep=024] mask_avg: mc_mean=0.3340 mb_mean=0.3011 norm_overlap=0.8801 corr_cb=-0.6620
[EPOCH 024/089] train: loss=1.6580 acc=67.51% | val: loss=0.6257 acc=66.13% f1=40.00% auc=65.55% val_score=81.1574 val_score_bestthr=85.7603 | dyn(w_pfs=0.250, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.334, mb=0.301, no=0.880, corr=-0.662) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 81.1574
[DBG][ep=025] disease_pos_weight=1.0000 mode=none
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.3291 mb_mean=0.2969 norm_overlap=0.8454 corr_cb=-0.7093 topkJ=0.0000
[TRAIN][ep=025] loss=1.9292 acc=70.96%
[TRAIN][ep=025] mask_avg: mc_mean=0.3315 mb_mean=0.3011 norm_overlap=0.8744 corr_cb=-0.6702
[EPOCH 025/089] train: loss=1.9292 acc=70.96% | val: loss=0.6266 acc=66.13% f1=32.26% auc=64.33% val_score=84.5666 val_score_bestthr=81.7791 | dyn(w_pfs=0.150, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.331, mb=0.301, no=0.874, corr=-0.670) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 84.5666
[DBG][ep=026] disease_pos_weight=1.0000 mode=none
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.3307 mb_mean=0.3012 norm_overlap=0.8473 corr_cb=-0.7334 topkJ=0.0000
[TRAIN][ep=026] loss=1.2228 acc=72.05%
[TRAIN][ep=026] mask_avg: mc_mean=0.3278 mb_mean=0.3011 norm_overlap=0.8656 corr_cb=-0.6808
[EPOCH 026/089] train: loss=1.2228 acc=72.05% | val: loss=0.6286 acc=67.74% f1=33.33% auc=63.88% val_score=84.8269 val_score_bestthr=83.9489 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.328, mb=0.301, no=0.866, corr=-0.681) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 84.8269
[DBG][ep=027] disease_pos_weight=1.0000 mode=none
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.3225 mb_mean=0.2902 norm_overlap=0.8312 corr_cb=-0.7444 topkJ=0.0000
[TRAIN][ep=027] loss=0.5165 acc=74.95%
[TRAIN][ep=027] mask_avg: mc_mean=0.3248 mb_mean=0.3011 norm_overlap=0.8566 corr_cb=-0.6903
[EPOCH 027/089] train: loss=0.5165 acc=74.95% | val: loss=0.6250 acc=67.74% f1=33.33% auc=64.55% val_score=83.6235 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.325, mb=0.301, no=0.857, corr=-0.690) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 83.6235
[DBG][ep=028] disease_pos_weight=1.0000 mode=none
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.3259 mb_mean=0.3063 norm_overlap=0.8766 corr_cb=-0.6833 topkJ=0.0000
[TRAIN][ep=028] loss=0.4966 acc=75.86%
[TRAIN][ep=028] mask_avg: mc_mean=0.3222 mb_mean=0.3011 norm_overlap=0.8484 corr_cb=-0.7003
[EPOCH 028/089] train: loss=0.4966 acc=75.86% | val: loss=0.6247 acc=67.74% f1=58.33% auc=64.66% val_score=89.0116 val_score_bestthr=95.5901 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.322, mb=0.301, no=0.848, corr=-0.700) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0116
[DBG][ep=029] disease_pos_weight=1.0000 mode=none
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.3276 mb_mean=0.3027 norm_overlap=0.8538 corr_cb=-0.7155 topkJ=0.0000
[TRAIN][ep=029] loss=0.7680 acc=74.77%
[TRAIN][ep=029] mask_avg: mc_mean=0.3193 mb_mean=0.3011 norm_overlap=0.8411 corr_cb=-0.7022
[EPOCH 029/089] train: loss=0.7680 acc=74.77% | val: loss=0.6279 acc=67.74% f1=33.33% auc=64.66% val_score=80.2804 val_score_bestthr=83.9489 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.319, mb=0.301, no=0.841, corr=-0.702) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 80.2804
[DBG][ep=030] disease_pos_weight=1.0000 mode=none
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.3166 mb_mean=0.3001 norm_overlap=0.8180 corr_cb=-0.7508 topkJ=0.0000
[TRAIN][ep=030] loss=1.0477 acc=76.04%
[TRAIN][ep=030] mask_avg: mc_mean=0.3177 mb_mean=0.3011 norm_overlap=0.8357 corr_cb=-0.7073
[EPOCH 030/089] train: loss=1.0477 acc=76.04% | val: loss=0.6269 acc=67.74% f1=33.33% auc=63.66% val_score=79.5360 val_score_bestthr=83.9489 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.318, mb=0.301, no=0.836, corr=-0.707) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 79.5360
[DBG][ep=031] disease_pos_weight=1.0000 mode=none
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.3197 mb_mean=0.2972 norm_overlap=0.8014 corr_cb=-0.7465 topkJ=0.0000
[TRAIN][ep=031] loss=0.5011 acc=77.13%
[TRAIN][ep=031] mask_avg: mc_mean=0.3167 mb_mean=0.3011 norm_overlap=0.8326 corr_cb=-0.7107
[EPOCH 031/089] train: loss=0.5011 acc=77.13% | val: loss=0.6274 acc=67.74% f1=33.33% auc=63.10% val_score=79.5360 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.711) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 79.5360
[DBG][ep=032] disease_pos_weight=1.0000 mode=none
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.3259 mb_mean=0.2887 norm_overlap=0.8188 corr_cb=-0.7441 topkJ=0.0000
[TRAIN][ep=032] loss=0.4715 acc=77.31%
[TRAIN][ep=032] mask_avg: mc_mean=0.3166 mb_mean=0.3011 norm_overlap=0.8328 corr_cb=-0.7101
[EPOCH 032/089] train: loss=0.4715 acc=77.31% | val: loss=0.6297 acc=67.74% f1=58.33% auc=63.55% val_score=89.0779 val_score_bestthr=95.5901 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.710) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=033] disease_pos_weight=1.0000 mode=none
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.3049 mb_mean=0.2930 norm_overlap=0.8495 corr_cb=-0.6461 topkJ=0.0000
[TRAIN][ep=033] loss=0.4693 acc=76.59%
[TRAIN][ep=033] mask_avg: mc_mean=0.3167 mb_mean=0.3011 norm_overlap=0.8327 corr_cb=-0.7105
[EPOCH 033/089] train: loss=0.4693 acc=76.59% | val: loss=0.6308 acc=67.74% f1=33.33% auc=63.43% val_score=89.0779 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.711) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=034] disease_pos_weight=1.0000 mode=none
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.3152 mb_mean=0.2992 norm_overlap=0.8260 corr_cb=-0.6801 topkJ=0.0000
[TRAIN][ep=034] loss=0.4674 acc=77.86%
[TRAIN][ep=034] mask_avg: mc_mean=0.3166 mb_mean=0.3011 norm_overlap=0.8325 corr_cb=-0.7100
[EPOCH 034/089] train: loss=0.4674 acc=77.86% | val: loss=0.6293 acc=67.74% f1=33.33% auc=63.55% val_score=86.9755 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.832, corr=-0.710) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 86.9755
[DBG][ep=035] disease_pos_weight=1.0000 mode=none
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.3051 mb_mean=0.3152 norm_overlap=0.8339 corr_cb=-0.7540 topkJ=0.0000
[TRAIN][ep=035] loss=0.4653 acc=77.50%
[TRAIN][ep=035] mask_avg: mc_mean=0.3167 mb_mean=0.3011 norm_overlap=0.8325 corr_cb=-0.7103
[EPOCH 035/089] train: loss=0.4653 acc=77.50% | val: loss=0.6307 acc=67.74% f1=33.33% auc=63.55% val_score=89.0779 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.710) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=036] disease_pos_weight=1.0000 mode=none
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.3178 mb_mean=0.3092 norm_overlap=0.8033 corr_cb=-0.7791 topkJ=0.0000
[TRAIN][ep=036] loss=0.4634 acc=77.31%
[TRAIN][ep=036] mask_avg: mc_mean=0.3166 mb_mean=0.3011 norm_overlap=0.8326 corr_cb=-0.7118
[EPOCH 036/089] train: loss=0.4634 acc=77.31% | val: loss=0.6305 acc=67.74% f1=33.33% auc=63.32% val_score=86.9755 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.712) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 86.9755
[DBG][ep=037] disease_pos_weight=1.0000 mode=none
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.3112 mb_mean=0.3065 norm_overlap=0.8652 corr_cb=-0.5911 topkJ=0.0000
[TRAIN][ep=037] loss=0.4614 acc=77.68%
[TRAIN][ep=037] mask_avg: mc_mean=0.3166 mb_mean=0.3011 norm_overlap=0.8326 corr_cb=-0.7095
[EPOCH 037/089] train: loss=0.4614 acc=77.68% | val: loss=0.6318 acc=67.74% f1=33.33% auc=63.10% val_score=89.0779 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.710) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=038] disease_pos_weight=1.0000 mode=none
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.3102 mb_mean=0.3016 norm_overlap=0.8360 corr_cb=-0.6468 topkJ=0.0000
[TRAIN][ep=038] loss=0.4594 acc=77.68%
[TRAIN][ep=038] mask_avg: mc_mean=0.3167 mb_mean=0.3011 norm_overlap=0.8326 corr_cb=-0.7109
[EPOCH 038/089] train: loss=0.4594 acc=77.68% | val: loss=0.6319 acc=67.74% f1=33.33% auc=63.32% val_score=82.9406 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.711) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 82.9406
[DBG][ep=039] disease_pos_weight=1.0000 mode=none
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.3192 mb_mean=0.3033 norm_overlap=0.8283 corr_cb=-0.7285 topkJ=0.0000
[TRAIN][ep=039] loss=0.4574 acc=77.86%
[TRAIN][ep=039] mask_avg: mc_mean=0.3166 mb_mean=0.3011 norm_overlap=0.8327 corr_cb=-0.7104
[EPOCH 039/089] train: loss=0.4574 acc=77.86% | val: loss=0.6323 acc=67.74% f1=33.33% auc=63.10% val_score=89.0779 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.710) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=040] disease_pos_weight=1.0000 mode=none
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.3127 mb_mean=0.3065 norm_overlap=0.7912 corr_cb=-0.7958 topkJ=0.0000
[TRAIN][ep=040] loss=0.4563 acc=78.04%
[TRAIN][ep=040] mask_avg: mc_mean=0.3166 mb_mean=0.3011 norm_overlap=0.8329 corr_cb=-0.7075
[EPOCH 040/089] train: loss=0.4563 acc=78.04% | val: loss=0.6325 acc=67.74% f1=33.33% auc=63.32% val_score=84.9487 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.707) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 84.9487
[DBG][ep=041] disease_pos_weight=1.0000 mode=none
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.3091 mb_mean=0.2964 norm_overlap=0.8418 corr_cb=-0.6490 topkJ=0.0000
[TRAIN][ep=041] loss=0.4542 acc=78.22%
[TRAIN][ep=041] mask_avg: mc_mean=0.3166 mb_mean=0.3011 norm_overlap=0.8327 corr_cb=-0.7097
[EPOCH 041/089] train: loss=0.4542 acc=78.22% | val: loss=0.6337 acc=67.74% f1=33.33% auc=62.99% val_score=89.0779 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.710) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=042] disease_pos_weight=1.0000 mode=none
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.3168 mb_mean=0.3026 norm_overlap=0.8329 corr_cb=-0.7349 topkJ=0.0000
[TRAIN][ep=042] loss=0.4529 acc=77.68%
[TRAIN][ep=042] mask_avg: mc_mean=0.3166 mb_mean=0.3011 norm_overlap=0.8325 corr_cb=-0.7103
[EPOCH 042/089] train: loss=0.4529 acc=77.68% | val: loss=0.6339 acc=67.74% f1=33.33% auc=63.43% val_score=89.0779 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.710) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=043] disease_pos_weight=1.0000 mode=none
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.3274 mb_mean=0.2901 norm_overlap=0.7845 corr_cb=-0.7809 topkJ=0.0000
[TRAIN][ep=043] loss=0.4506 acc=78.22%
[TRAIN][ep=043] mask_avg: mc_mean=0.3166 mb_mean=0.3011 norm_overlap=0.8326 corr_cb=-0.7106
[EPOCH 043/089] train: loss=0.4506 acc=78.22% | val: loss=0.6347 acc=67.74% f1=33.33% auc=63.43% val_score=89.0779 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.711) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=044] disease_pos_weight=1.0000 mode=none
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.3240 mb_mean=0.2943 norm_overlap=0.8063 corr_cb=-0.7724 topkJ=0.0000
[TRAIN][ep=044] loss=0.4486 acc=78.22%
[TRAIN][ep=044] mask_avg: mc_mean=0.3166 mb_mean=0.3011 norm_overlap=0.8329 corr_cb=-0.7095
[EPOCH 044/089] train: loss=0.4486 acc=78.22% | val: loss=0.6345 acc=67.74% f1=33.33% auc=63.66% val_score=89.0779 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.709) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=045] disease_pos_weight=1.0000 mode=none
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.3225 mb_mean=0.2792 norm_overlap=0.7703 corr_cb=-0.7614 topkJ=0.0000
[TRAIN][ep=045] loss=0.4477 acc=78.40%
[TRAIN][ep=045] mask_avg: mc_mean=0.3166 mb_mean=0.3011 norm_overlap=0.8327 corr_cb=-0.7099
[EPOCH 045/089] train: loss=0.4477 acc=78.40% | val: loss=0.6363 acc=67.74% f1=33.33% auc=63.32% val_score=89.0779 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.710) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=046] disease_pos_weight=1.0000 mode=none
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.3060 mb_mean=0.3171 norm_overlap=0.8331 corr_cb=-0.7779 topkJ=0.0000
[TRAIN][ep=046] loss=0.4461 acc=79.13%
[TRAIN][ep=046] mask_avg: mc_mean=0.3166 mb_mean=0.3011 norm_overlap=0.8327 corr_cb=-0.7106
[EPOCH 046/089] train: loss=0.4461 acc=79.13% | val: loss=0.6369 acc=67.74% f1=33.33% auc=63.66% val_score=89.0779 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.711) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=047] disease_pos_weight=1.0000 mode=none
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.3224 mb_mean=0.3097 norm_overlap=0.8697 corr_cb=-0.6873 topkJ=0.0000
[TRAIN][ep=047] loss=0.4440 acc=78.40%
[TRAIN][ep=047] mask_avg: mc_mean=0.3166 mb_mean=0.3011 norm_overlap=0.8328 corr_cb=-0.7108
[EPOCH 047/089] train: loss=0.4440 acc=78.40% | val: loss=0.6368 acc=67.74% f1=33.33% auc=63.32% val_score=80.7554 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.711) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 80.7554
[DBG][ep=048] disease_pos_weight=1.0000 mode=none
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.3211 mb_mean=0.2994 norm_overlap=0.8310 corr_cb=-0.7152 topkJ=0.0000
[TRAIN][ep=048] loss=0.4426 acc=78.40%
[TRAIN][ep=048] mask_avg: mc_mean=0.3166 mb_mean=0.3011 norm_overlap=0.8327 corr_cb=-0.7100
[EPOCH 048/089] train: loss=0.4426 acc=78.40% | val: loss=0.6372 acc=67.74% f1=33.33% auc=63.32% val_score=80.7554 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.710) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 80.7554
[DBG][ep=049] disease_pos_weight=1.0000 mode=none
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.3091 mb_mean=0.3019 norm_overlap=0.8432 corr_cb=-0.6757 topkJ=0.0000
[TRAIN][ep=049] loss=0.4405 acc=79.31%
[TRAIN][ep=049] mask_avg: mc_mean=0.3166 mb_mean=0.3011 norm_overlap=0.8325 corr_cb=-0.7113
[EPOCH 049/089] train: loss=0.4405 acc=79.31% | val: loss=0.6393 acc=67.74% f1=33.33% auc=63.21% val_score=89.0779 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.711) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=050] disease_pos_weight=1.0000 mode=none
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.3133 mb_mean=0.3180 norm_overlap=0.8485 corr_cb=-0.7309 topkJ=0.0000
[TRAIN][ep=050] loss=0.4397 acc=79.49%
[TRAIN][ep=050] mask_avg: mc_mean=0.3166 mb_mean=0.3011 norm_overlap=0.8324 corr_cb=-0.7104
[EPOCH 050/089] train: loss=0.4397 acc=79.49% | val: loss=0.6406 acc=67.74% f1=33.33% auc=63.21% val_score=89.0779 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.832, corr=-0.710) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[EARLY STOP] no improvement for 30 epochs. best_epoch=20
[CKPT] Loaded best for testing: results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
=============== FIT DONE ===============
[BEST] epoch=20 | val_acc=67.74% | val_f1=50.00% | val_auc=65.11% | val_score=90.0707 | val_score_bestthr=92.0414
[TEST@BEST] thr_used=0.650 | acc=63.64% f1=0.00% auc=59.64% | SP_sex=0.00% EO_sex=0.00% SP_age=0.00% EO_age=0.00%
[TIME] 0.89 min
[OK] Saved: results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/summary_fold_0.json
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5236 mb_mean=0.5061 norm_overlap=0.9998 corr_cb=-0.1913 topkJ=0.0225
[TRAIN][ep=000] loss=0.6926 acc=51.91%
[TRAIN][ep=000] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2677
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5223 mb_mean=0.5043 norm_overlap=0.9995 corr_cb=-0.3398 topkJ=0.0124
[TRAIN][ep=001] loss=0.6752 acc=63.70%
[TRAIN][ep=001] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2716
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5214 mb_mean=0.5039 norm_overlap=0.9998 corr_cb=-0.1603 topkJ=0.0315
[TRAIN][ep=002] loss=0.6633 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2709
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5198 mb_mean=0.5045 norm_overlap=0.9997 corr_cb=-0.2413 topkJ=0.0174
[TRAIN][ep=003] loss=0.6578 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2654
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5237 mb_mean=0.5050 norm_overlap=0.9997 corr_cb=-0.2572 topkJ=0.0114
[TRAIN][ep=004] loss=0.6554 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2685
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5214 mb_mean=0.5050 norm_overlap=0.9997 corr_cb=-0.2780 topkJ=0.0280
[TRAIN][ep=005] loss=0.6542 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2701
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5217 mb_mean=0.5043 norm_overlap=0.9997 corr_cb=-0.2886 topkJ=0.0135
[TRAIN][ep=006] loss=0.6538 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2669
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5184 mb_mean=0.5067 norm_overlap=0.9997 corr_cb=-0.3329 topkJ=0.0218
[TRAIN][ep=007] loss=0.6520 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2713
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5223 mb_mean=0.5062 norm_overlap=0.9996 corr_cb=-0.3736 topkJ=0.0062
[TRAIN][ep=008] loss=0.6517 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2684
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5215 mb_mean=0.5068 norm_overlap=0.9997 corr_cb=-0.2734 topkJ=0.0259
[TRAIN][ep=009] loss=0.6500 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2687
================= FIT START (fold=0) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.35 select_by=val_score | eval_thr_mode=best_acc eval_thr_grid=coarse | disease_pos_weight_mode=none freeze_b_after=15 | two_stage=True stage1_ratio=0.35 stage2_lr_mult=0.3 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5235 mb_mean=0.5056 norm_overlap=0.9996 corr_cb=-0.2652 topkJ=0.0979
[TRAIN][ep=000] loss=0.6488 acc=63.70%
[TRAIN][ep=000] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2687
[EPOCH 000/089] train: loss=0.6488 acc=63.70% | val: loss=0.6590 acc=62.90% f1=0.00% auc=49.28% val_score=64.2297 val_score_bestthr=62.9032 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.521, mb=0.506, no=1.000, corr=-0.269) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* -1000000000000000000.0000 -> 64.2297
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5221 mb_mean=0.5070 norm_overlap=0.9998 corr_cb=-0.2391 topkJ=0.0404
[TRAIN][ep=001] loss=0.6469 acc=63.70%
[TRAIN][ep=001] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2684
[EPOCH 001/089] train: loss=0.6469 acc=63.70% | val: loss=0.6577 acc=62.90% f1=0.00% auc=51.28% val_score=67.4541 val_score_bestthr=62.9032 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.521, mb=0.506, no=1.000, corr=-0.268) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 64.2297 -> 67.4541
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5187 mb_mean=0.5040 norm_overlap=0.9998 corr_cb=-0.2618 topkJ=0.0162
[TRAIN][ep=002] loss=0.6457 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2713
[EPOCH 002/089] train: loss=0.6457 acc=63.70% | val: loss=0.6570 acc=62.90% f1=14.81% auc=51.84% val_score=64.2297 val_score_bestthr=69.7231 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.521, mb=0.506, no=1.000, corr=-0.271) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 67.4541 -> 64.2297
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5199 mb_mean=0.5065 norm_overlap=0.9998 corr_cb=-0.2547 topkJ=0.0454
[TRAIN][ep=003] loss=0.6442 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2668
[EPOCH 003/089] train: loss=0.6442 acc=63.70% | val: loss=0.6557 acc=62.90% f1=14.81% auc=52.73% val_score=66.7750 val_score_bestthr=69.7231 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.521, mb=0.506, no=1.000, corr=-0.267) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 67.4541 -> 66.7750
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5227 mb_mean=0.5044 norm_overlap=0.9996 corr_cb=-0.3527 topkJ=0.0157
[TRAIN][ep=004] loss=0.6434 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2700
[EPOCH 004/089] train: loss=0.6434 acc=63.70% | val: loss=0.6545 acc=64.52% f1=8.33% auc=54.07% val_score=66.7750 val_score_bestthr=68.1795 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.521, mb=0.506, no=1.000, corr=-0.270) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 67.4541 -> 66.7750
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5208 mb_mean=0.5063 norm_overlap=0.9997 corr_cb=-0.2071 topkJ=0.0176
[TRAIN][ep=005] loss=2.1258 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.5146 mb_mean=0.4947 norm_overlap=0.9998 corr_cb=-0.1599
[EPOCH 005/089] train: loss=2.1258 acc=63.70% | val: loss=0.6549 acc=62.90% f1=20.69% auc=54.63% val_score=75.5211 val_score_bestthr=72.4762 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.515, mb=0.495, no=1.000, corr=-0.160) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 67.4541 -> 75.5211
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5082 mb_mean=0.4851 norm_overlap=0.9997 corr_cb=-0.1692 topkJ=0.0371
[TRAIN][ep=006] loss=2.1243 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.5007 mb_mean=0.4723 norm_overlap=1.0000 corr_cb=-0.0315
[EPOCH 006/089] train: loss=2.1243 acc=63.70% | val: loss=0.6538 acc=64.52% f1=21.43% auc=55.85% val_score=74.3065 val_score_bestthr=74.3752 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.501, mb=0.472, no=1.000, corr=-0.032) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 75.5211 -> 74.3065
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4928 mb_mean=0.4606 norm_overlap=1.0000 corr_cb=-0.0005 topkJ=0.0286
[TRAIN][ep=007] loss=2.1216 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.4867 mb_mean=0.4486 norm_overlap=1.0004 corr_cb=0.0613
[EPOCH 007/089] train: loss=2.1216 acc=63.70% | val: loss=0.6524 acc=66.13% f1=27.59% auc=56.74% val_score=67.1224 val_score_bestthr=78.8618 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.487, mb=0.449, no=1.000, corr=0.061) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 75.5211 -> 67.1224
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4809 mb_mean=0.4372 norm_overlap=0.9993 corr_cb=-0.1205 topkJ=0.0245
[TRAIN][ep=008] loss=2.1119 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.4731 mb_mean=0.4241 norm_overlap=1.0013 corr_cb=0.1475
[EPOCH 008/089] train: loss=2.1119 acc=63.70% | val: loss=0.6518 acc=66.13% f1=27.59% auc=57.53% val_score=80.5179 val_score_bestthr=78.8618 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.473, mb=0.424, no=1.001, corr=0.147) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 75.5211 -> 80.5179
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4655 mb_mean=0.4207 norm_overlap=1.0013 corr_cb=0.1528 topkJ=0.1007
[TRAIN][ep=009] loss=2.1096 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.4598 mb_mean=0.3995 norm_overlap=1.0019 corr_cb=0.1289
[EPOCH 009/089] train: loss=2.1096 acc=63.70% | val: loss=0.6511 acc=64.52% f1=31.25% auc=58.64% val_score=76.3813 val_score_bestthr=79.3442 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.460, mb=0.399, no=1.002, corr=0.129) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 80.5179 -> 76.3813
[DBG][ep=010] disease_pos_weight=1.0000 mode=none
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.4552 mb_mean=0.3855 norm_overlap=1.0011 corr_cb=0.0767 topkJ=0.0520
[TRAIN][ep=010] loss=2.1006 acc=63.70%
[TRAIN][ep=010] mask_avg: mc_mean=0.4470 mb_mean=0.3762 norm_overlap=1.0014 corr_cb=0.0617
[EPOCH 010/089] train: loss=2.1006 acc=63.70% | val: loss=0.6491 acc=66.13% f1=16.00% auc=59.09% val_score=70.3872 val_score_bestthr=73.5938 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.447, mb=0.376, no=1.001, corr=0.062) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 80.5179 -> 70.3872
[DBG][ep=011] disease_pos_weight=1.0000 mode=none
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.4452 mb_mean=0.3639 norm_overlap=0.9999 corr_cb=-0.0021 topkJ=0.0264
[TRAIN][ep=011] loss=2.0947 acc=63.70%
[TRAIN][ep=011] mask_avg: mc_mean=0.4347 mb_mean=0.3550 norm_overlap=0.9997 corr_cb=-0.0130
[EPOCH 011/089] train: loss=2.0947 acc=63.70% | val: loss=0.6477 acc=67.74% f1=23.08% auc=60.20% val_score=74.5015 val_score_bestthr=78.5401 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.435, mb=0.355, no=1.000, corr=-0.013) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 80.5179 -> 74.5015
[DBG][ep=012] disease_pos_weight=1.0000 mode=none
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.4208 mb_mean=0.3282 norm_overlap=1.0022 corr_cb=0.0489 topkJ=0.0648
[TRAIN][ep=012] loss=2.0908 acc=63.70%
[TRAIN][ep=012] mask_avg: mc_mean=0.4223 mb_mean=0.3364 norm_overlap=0.9953 corr_cb=-0.1190
[EPOCH 012/089] train: loss=2.0908 acc=63.70% | val: loss=0.6469 acc=67.74% f1=41.18% auc=60.98% val_score=79.5102 val_score_bestthr=87.1786 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.422, mb=0.336, no=0.995, corr=-0.119) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 80.5179 -> 79.5102
[DBG][ep=013] disease_pos_weight=1.0000 mode=none
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.4212 mb_mean=0.3329 norm_overlap=0.9890 corr_cb=-0.2669 topkJ=0.0240
[TRAIN][ep=013] loss=2.0803 acc=63.70%
[TRAIN][ep=013] mask_avg: mc_mean=0.4120 mb_mean=0.3199 norm_overlap=0.9868 corr_cb=-0.2567
[EPOCH 013/089] train: loss=2.0803 acc=63.70% | val: loss=0.6450 acc=67.74% f1=23.08% auc=62.21% val_score=77.8847 val_score_bestthr=78.5401 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.412, mb=0.320, no=0.987, corr=-0.257) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 80.5179 -> 77.8847
[DBG][ep=014] disease_pos_weight=1.0000 mode=none
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.4011 mb_mean=0.3048 norm_overlap=0.9678 corr_cb=-0.4914 topkJ=0.0065
[TRAIN][ep=014] loss=2.0785 acc=63.52%
[TRAIN][ep=014] mask_avg: mc_mean=0.4012 mb_mean=0.3063 norm_overlap=0.9734 corr_cb=-0.3814
[EPOCH 014/089] train: loss=2.0785 acc=63.52% | val: loss=0.6444 acc=67.74% f1=23.08% auc=61.43% val_score=80.9022 val_score_bestthr=78.5401 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.401, mb=0.306, no=0.973, corr=-0.381) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 80.5179 -> 80.9022
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=015] disease_pos_weight=1.0000 mode=none
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.3971 mb_mean=0.2981 norm_overlap=0.9785 corr_cb=-0.2514 topkJ=0.0213
[TRAIN][ep=015] loss=2.0705 acc=63.70%
[TRAIN][ep=015] mask_avg: mc_mean=0.3902 mb_mean=0.3010 norm_overlap=0.9610 corr_cb=-0.4535
[EPOCH 015/089] train: loss=2.0705 acc=63.70% | val: loss=0.6411 acc=67.74% f1=23.08% auc=62.54% val_score=82.9035 val_score_bestthr=78.5401 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.390, mb=0.301, no=0.961, corr=-0.454) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=* 80.9022 -> 82.9035
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=016] disease_pos_weight=1.0000 mode=none
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.3844 mb_mean=0.2952 norm_overlap=0.9586 corr_cb=-0.4219 topkJ=0.0135
[TRAIN][ep=016] loss=2.0632 acc=63.52%
[TRAIN][ep=016] mask_avg: mc_mean=0.3815 mb_mean=0.3010 norm_overlap=0.9527 corr_cb=-0.4890
[EPOCH 016/089] train: loss=2.0632 acc=63.52% | val: loss=0.6414 acc=67.74% f1=23.08% auc=63.10% val_score=87.2586 val_score_bestthr=78.5401 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.381, mb=0.301, no=0.953, corr=-0.489) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=* 82.9035 -> 87.2586
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=017] disease_pos_weight=1.0000 mode=none
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.3837 mb_mean=0.3134 norm_overlap=0.9514 corr_cb=-0.5468 topkJ=0.0012
[TRAIN][ep=017] loss=2.0569 acc=63.52%
[TRAIN][ep=017] mask_avg: mc_mean=0.3725 mb_mean=0.3010 norm_overlap=0.9431 corr_cb=-0.5249
[EPOCH 017/089] train: loss=2.0569 acc=63.52% | val: loss=0.6383 acc=67.74% f1=23.08% auc=63.66% val_score=88.6660 val_score_bestthr=78.5401 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.372, mb=0.301, no=0.943, corr=-0.525) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=* 87.2586 -> 88.6660
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=018] disease_pos_weight=1.0000 mode=none
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.3751 mb_mean=0.2956 norm_overlap=0.9434 corr_cb=-0.5222 topkJ=0.0017
[TRAIN][ep=018] loss=1.3502 acc=64.43%
[TRAIN][ep=018] mask_avg: mc_mean=0.3658 mb_mean=0.3010 norm_overlap=0.9356 corr_cb=-0.5508
[EPOCH 018/089] train: loss=1.3502 acc=64.43% | val: loss=0.6370 acc=67.74% f1=23.08% auc=63.32% val_score=86.5455 val_score_bestthr=78.5401 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.366, mb=0.301, no=0.936, corr=-0.551) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 88.6660 -> 86.5455
[DBG][ep=019] disease_pos_weight=1.0000 mode=none
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.3693 mb_mean=0.2955 norm_overlap=0.9307 corr_cb=-0.5723 topkJ=0.0004
[TRAIN][ep=019] loss=0.6412 acc=65.52%
[TRAIN][ep=019] mask_avg: mc_mean=0.3594 mb_mean=0.3010 norm_overlap=0.9271 corr_cb=-0.5738
[EPOCH 019/089] train: loss=0.6412 acc=65.52% | val: loss=0.6332 acc=66.13% f1=40.00% auc=64.33% val_score=85.8087 val_score_bestthr=85.4793 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.359, mb=0.301, no=0.927, corr=-0.574) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 88.6660 -> 85.8087
[DBG][ep=020] disease_pos_weight=1.0000 mode=none
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.3634 mb_mean=0.2989 norm_overlap=0.9455 corr_cb=-0.4576 topkJ=0.0004
[TRAIN][ep=020] loss=0.4639 acc=66.06%
[TRAIN][ep=020] mask_avg: mc_mean=0.3521 mb_mean=0.3010 norm_overlap=0.9167 corr_cb=-0.5946
[EPOCH 020/089] train: loss=0.4639 acc=66.06% | val: loss=0.6297 acc=67.74% f1=50.00% auc=65.22% val_score=90.0707 val_score_bestthr=92.0414 | dyn(w_pfs=0.090, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.352, mb=0.301, no=0.917, corr=-0.595) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=* 88.6660 -> 90.0707
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=021] disease_pos_weight=1.0000 mode=none
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.3513 mb_mean=0.2971 norm_overlap=0.9199 corr_cb=-0.5283 topkJ=0.0000
[TRAIN][ep=021] loss=0.7435 acc=67.15%
[TRAIN][ep=021] mask_avg: mc_mean=0.3463 mb_mean=0.3010 norm_overlap=0.9073 corr_cb=-0.6135
[EPOCH 021/089] train: loss=0.7435 acc=67.15% | val: loss=0.6297 acc=67.74% f1=37.50% auc=64.44% val_score=90.0707 val_score_bestthr=85.9437 | dyn(w_pfs=0.130, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.346, mb=0.301, no=0.907, corr=-0.614) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 90.0707
[DBG][ep=022] disease_pos_weight=1.0000 mode=none
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.3312 mb_mean=0.2986 norm_overlap=0.8870 corr_cb=-0.6649 topkJ=0.0000
[TRAIN][ep=022] loss=1.0118 acc=66.24%
[TRAIN][ep=022] mask_avg: mc_mean=0.3404 mb_mean=0.3011 norm_overlap=0.8960 corr_cb=-0.6330
[EPOCH 022/089] train: loss=1.0118 acc=66.24% | val: loss=0.6268 acc=67.74% f1=47.37% auc=66.11% val_score=80.0795 val_score_bestthr=90.8742 | dyn(w_pfs=0.170, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.340, mb=0.301, no=0.896, corr=-0.633) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 80.0795
[DBG][ep=023] disease_pos_weight=1.0000 mode=none
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.3474 mb_mean=0.3084 norm_overlap=0.9010 corr_cb=-0.6419 topkJ=0.0000
[TRAIN][ep=023] loss=1.2893 acc=66.79%
[TRAIN][ep=023] mask_avg: mc_mean=0.3381 mb_mean=0.3010 norm_overlap=0.8905 corr_cb=-0.6469
[EPOCH 023/089] train: loss=1.2893 acc=66.79% | val: loss=0.6275 acc=66.13% f1=51.16% auc=64.44% val_score=87.9096 val_score_bestthr=90.9891 | dyn(w_pfs=0.210, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.338, mb=0.301, no=0.890, corr=-0.647) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 87.9096
[DBG][ep=024] disease_pos_weight=1.0000 mode=none
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.3284 mb_mean=0.2989 norm_overlap=0.8759 corr_cb=-0.6704 topkJ=0.0000
[TRAIN][ep=024] loss=1.5563 acc=67.51%
[TRAIN][ep=024] mask_avg: mc_mean=0.3340 mb_mean=0.3010 norm_overlap=0.8802 corr_cb=-0.6616
[EPOCH 024/089] train: loss=1.5563 acc=67.51% | val: loss=0.6257 acc=66.13% f1=40.00% auc=65.55% val_score=81.1574 val_score_bestthr=85.7603 | dyn(w_pfs=0.250, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.334, mb=0.301, no=0.880, corr=-0.662) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 81.1574
[DBG][ep=025] disease_pos_weight=1.0000 mode=none
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.3291 mb_mean=0.2968 norm_overlap=0.8456 corr_cb=-0.7089 topkJ=0.0000
[TRAIN][ep=025] loss=1.8275 acc=70.78%
[TRAIN][ep=025] mask_avg: mc_mean=0.3315 mb_mean=0.3010 norm_overlap=0.8745 corr_cb=-0.6698
[EPOCH 025/089] train: loss=1.8275 acc=70.78% | val: loss=0.6266 acc=66.13% f1=32.26% auc=64.33% val_score=84.5666 val_score_bestthr=81.7791 | dyn(w_pfs=0.150, w_sup=0.100, w_csuf=0.100, stage2=False) | mask(mc=0.331, mb=0.301, no=0.875, corr=-0.670) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 84.5666
[DBG][ep=026] disease_pos_weight=1.0000 mode=none
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.3307 mb_mean=0.3011 norm_overlap=0.8473 corr_cb=-0.7331 topkJ=0.0000
[TRAIN][ep=026] loss=1.1212 acc=72.05%
[TRAIN][ep=026] mask_avg: mc_mean=0.3278 mb_mean=0.3010 norm_overlap=0.8657 corr_cb=-0.6804
[EPOCH 026/089] train: loss=1.1212 acc=72.05% | val: loss=0.6286 acc=67.74% f1=33.33% auc=63.88% val_score=84.8269 val_score_bestthr=83.9489 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.328, mb=0.301, no=0.866, corr=-0.680) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 84.8269
[DBG][ep=027] disease_pos_weight=1.0000 mode=none
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.3225 mb_mean=0.2901 norm_overlap=0.8312 corr_cb=-0.7442 topkJ=0.0000
[TRAIN][ep=027] loss=0.4150 acc=74.95%
[TRAIN][ep=027] mask_avg: mc_mean=0.3248 mb_mean=0.3010 norm_overlap=0.8567 corr_cb=-0.6898
[EPOCH 027/089] train: loss=0.4150 acc=74.95% | val: loss=0.6251 acc=67.74% f1=33.33% auc=64.55% val_score=85.6294 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.325, mb=0.301, no=0.857, corr=-0.690) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 85.6294
[DBG][ep=028] disease_pos_weight=1.0000 mode=none
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.3260 mb_mean=0.3062 norm_overlap=0.8765 corr_cb=-0.6833 topkJ=0.0000
[TRAIN][ep=028] loss=0.3953 acc=75.86%
[TRAIN][ep=028] mask_avg: mc_mean=0.3222 mb_mean=0.3011 norm_overlap=0.8485 corr_cb=-0.6998
[EPOCH 028/089] train: loss=0.3953 acc=75.86% | val: loss=0.6247 acc=67.74% f1=58.33% auc=64.66% val_score=89.0116 val_score_bestthr=95.5901 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.322, mb=0.301, no=0.848, corr=-0.700) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0116
[DBG][ep=029] disease_pos_weight=1.0000 mode=none
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.3276 mb_mean=0.3026 norm_overlap=0.8539 corr_cb=-0.7151 topkJ=0.0000
[TRAIN][ep=029] loss=0.6668 acc=74.77%
[TRAIN][ep=029] mask_avg: mc_mean=0.3193 mb_mean=0.3010 norm_overlap=0.8412 corr_cb=-0.7018
[EPOCH 029/089] train: loss=0.6668 acc=74.77% | val: loss=0.6279 acc=67.74% f1=33.33% auc=64.66% val_score=80.2804 val_score_bestthr=83.9489 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.319, mb=0.301, no=0.841, corr=-0.702) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 80.2804
[DBG][ep=030] disease_pos_weight=1.0000 mode=none
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.3166 mb_mean=0.3000 norm_overlap=0.8183 corr_cb=-0.7501 topkJ=0.0000
[TRAIN][ep=030] loss=0.9465 acc=76.04%
[TRAIN][ep=030] mask_avg: mc_mean=0.3177 mb_mean=0.3010 norm_overlap=0.8358 corr_cb=-0.7069
[EPOCH 030/089] train: loss=0.9465 acc=76.04% | val: loss=0.6270 acc=67.74% f1=33.33% auc=63.66% val_score=79.5360 val_score_bestthr=83.9489 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.318, mb=0.301, no=0.836, corr=-0.707) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 79.5360
[DBG][ep=031] disease_pos_weight=1.0000 mode=none
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.3197 mb_mean=0.2971 norm_overlap=0.8016 corr_cb=-0.7459 topkJ=0.0000
[TRAIN][ep=031] loss=0.4000 acc=77.13%
[TRAIN][ep=031] mask_avg: mc_mean=0.3167 mb_mean=0.3010 norm_overlap=0.8327 corr_cb=-0.7103
[EPOCH 031/089] train: loss=0.4000 acc=77.13% | val: loss=0.6274 acc=67.74% f1=33.33% auc=63.21% val_score=79.5360 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.710) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 79.5360
[DBG][ep=032] disease_pos_weight=1.0000 mode=none
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.3258 mb_mean=0.2886 norm_overlap=0.8188 corr_cb=-0.7440 topkJ=0.0000
[TRAIN][ep=032] loss=0.3705 acc=77.31%
[TRAIN][ep=032] mask_avg: mc_mean=0.3166 mb_mean=0.3010 norm_overlap=0.8329 corr_cb=-0.7096
[EPOCH 032/089] train: loss=0.3705 acc=77.31% | val: loss=0.6298 acc=67.74% f1=58.33% auc=63.55% val_score=89.0779 val_score_bestthr=95.5901 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.710) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=033] disease_pos_weight=1.0000 mode=none
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.3050 mb_mean=0.2929 norm_overlap=0.8494 corr_cb=-0.6458 topkJ=0.0000
[TRAIN][ep=033] loss=0.3683 acc=76.59%
[TRAIN][ep=033] mask_avg: mc_mean=0.3166 mb_mean=0.3011 norm_overlap=0.8328 corr_cb=-0.7100
[EPOCH 033/089] train: loss=0.3683 acc=76.59% | val: loss=0.6308 acc=67.74% f1=33.33% auc=63.43% val_score=89.0779 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.710) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=034] disease_pos_weight=1.0000 mode=none
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.3152 mb_mean=0.2991 norm_overlap=0.8261 corr_cb=-0.6795 topkJ=0.0000
[TRAIN][ep=034] loss=0.3664 acc=77.86%
[TRAIN][ep=034] mask_avg: mc_mean=0.3166 mb_mean=0.3010 norm_overlap=0.8326 corr_cb=-0.7095
[EPOCH 034/089] train: loss=0.3664 acc=77.86% | val: loss=0.6293 acc=67.74% f1=33.33% auc=63.55% val_score=86.9755 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.709) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 86.9755
[DBG][ep=035] disease_pos_weight=1.0000 mode=none
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.3051 mb_mean=0.3151 norm_overlap=0.8340 corr_cb=-0.7534 topkJ=0.0000
[TRAIN][ep=035] loss=0.3644 acc=77.50%
[TRAIN][ep=035] mask_avg: mc_mean=0.3167 mb_mean=0.3010 norm_overlap=0.8326 corr_cb=-0.7098
[EPOCH 035/089] train: loss=0.3644 acc=77.50% | val: loss=0.6308 acc=67.74% f1=58.33% auc=63.55% val_score=89.0779 val_score_bestthr=95.5901 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.710) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=036] disease_pos_weight=1.0000 mode=none
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.3178 mb_mean=0.3091 norm_overlap=0.8035 corr_cb=-0.7785 topkJ=0.0000
[TRAIN][ep=036] loss=0.3625 acc=77.50%
[TRAIN][ep=036] mask_avg: mc_mean=0.3166 mb_mean=0.3010 norm_overlap=0.8328 corr_cb=-0.7113
[EPOCH 036/089] train: loss=0.3625 acc=77.50% | val: loss=0.6305 acc=67.74% f1=33.33% auc=63.32% val_score=86.9755 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.711) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 86.9755
[DBG][ep=037] disease_pos_weight=1.0000 mode=none
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.3112 mb_mean=0.3064 norm_overlap=0.8652 corr_cb=-0.5905 topkJ=0.0000
[TRAIN][ep=037] loss=0.3605 acc=77.68%
[TRAIN][ep=037] mask_avg: mc_mean=0.3166 mb_mean=0.3010 norm_overlap=0.8327 corr_cb=-0.7090
[EPOCH 037/089] train: loss=0.3605 acc=77.68% | val: loss=0.6319 acc=67.74% f1=33.33% auc=63.10% val_score=89.0779 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.709) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=038] disease_pos_weight=1.0000 mode=none
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.3102 mb_mean=0.3015 norm_overlap=0.8361 corr_cb=-0.6458 topkJ=0.0000
[TRAIN][ep=038] loss=0.3585 acc=77.68%
[TRAIN][ep=038] mask_avg: mc_mean=0.3167 mb_mean=0.3010 norm_overlap=0.8327 corr_cb=-0.7104
[EPOCH 038/089] train: loss=0.3585 acc=77.68% | val: loss=0.6319 acc=67.74% f1=33.33% auc=63.32% val_score=82.9406 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.710) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 82.9406
[DBG][ep=039] disease_pos_weight=1.0000 mode=none
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.3192 mb_mean=0.3033 norm_overlap=0.8284 corr_cb=-0.7282 topkJ=0.0000
[TRAIN][ep=039] loss=0.3566 acc=77.86%
[TRAIN][ep=039] mask_avg: mc_mean=0.3166 mb_mean=0.3010 norm_overlap=0.8328 corr_cb=-0.7099
[EPOCH 039/089] train: loss=0.3566 acc=77.86% | val: loss=0.6324 acc=67.74% f1=33.33% auc=63.10% val_score=89.0779 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.710) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=040] disease_pos_weight=1.0000 mode=none
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.3126 mb_mean=0.3065 norm_overlap=0.7913 corr_cb=-0.7954 topkJ=0.0000
[TRAIN][ep=040] loss=0.3556 acc=78.04%
[TRAIN][ep=040] mask_avg: mc_mean=0.3166 mb_mean=0.3010 norm_overlap=0.8330 corr_cb=-0.7070
[EPOCH 040/089] train: loss=0.3556 acc=78.04% | val: loss=0.6326 acc=67.74% f1=33.33% auc=63.32% val_score=84.9487 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.707) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 84.9487
[DBG][ep=041] disease_pos_weight=1.0000 mode=none
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.3091 mb_mean=0.2963 norm_overlap=0.8419 corr_cb=-0.6483 topkJ=0.0000
[TRAIN][ep=041] loss=0.3535 acc=78.22%
[TRAIN][ep=041] mask_avg: mc_mean=0.3166 mb_mean=0.3010 norm_overlap=0.8328 corr_cb=-0.7092
[EPOCH 041/089] train: loss=0.3535 acc=78.22% | val: loss=0.6337 acc=67.74% f1=33.33% auc=62.99% val_score=89.0779 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.709) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=042] disease_pos_weight=1.0000 mode=none
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.3168 mb_mean=0.3025 norm_overlap=0.8332 corr_cb=-0.7344 topkJ=0.0000
[TRAIN][ep=042] loss=0.3522 acc=77.68%
[TRAIN][ep=042] mask_avg: mc_mean=0.3166 mb_mean=0.3011 norm_overlap=0.8326 corr_cb=-0.7098
[EPOCH 042/089] train: loss=0.3522 acc=77.68% | val: loss=0.6340 acc=67.74% f1=33.33% auc=63.43% val_score=89.0779 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.710) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=043] disease_pos_weight=1.0000 mode=none
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.3274 mb_mean=0.2901 norm_overlap=0.7847 corr_cb=-0.7804 topkJ=0.0000
[TRAIN][ep=043] loss=0.3499 acc=78.04%
[TRAIN][ep=043] mask_avg: mc_mean=0.3166 mb_mean=0.3010 norm_overlap=0.8327 corr_cb=-0.7101
[EPOCH 043/089] train: loss=0.3499 acc=78.04% | val: loss=0.6347 acc=67.74% f1=33.33% auc=63.32% val_score=89.0779 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.710) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=044] disease_pos_weight=1.0000 mode=none
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.3240 mb_mean=0.2943 norm_overlap=0.8065 corr_cb=-0.7722 topkJ=0.0000
[TRAIN][ep=044] loss=0.3480 acc=78.22%
[TRAIN][ep=044] mask_avg: mc_mean=0.3166 mb_mean=0.3010 norm_overlap=0.8330 corr_cb=-0.7090
[EPOCH 044/089] train: loss=0.3480 acc=78.22% | val: loss=0.6346 acc=67.74% f1=33.33% auc=63.55% val_score=89.0779 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.709) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=045] disease_pos_weight=1.0000 mode=none
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.3225 mb_mean=0.2791 norm_overlap=0.7703 corr_cb=-0.7612 topkJ=0.0000
[TRAIN][ep=045] loss=0.3470 acc=78.40%
[TRAIN][ep=045] mask_avg: mc_mean=0.3166 mb_mean=0.3010 norm_overlap=0.8328 corr_cb=-0.7094
[EPOCH 045/089] train: loss=0.3470 acc=78.40% | val: loss=0.6363 acc=67.74% f1=33.33% auc=63.32% val_score=89.0779 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.709) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=046] disease_pos_weight=1.0000 mode=none
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.3060 mb_mean=0.3170 norm_overlap=0.8331 corr_cb=-0.7778 topkJ=0.0000
[TRAIN][ep=046] loss=0.3455 acc=79.13%
[TRAIN][ep=046] mask_avg: mc_mean=0.3166 mb_mean=0.3011 norm_overlap=0.8328 corr_cb=-0.7101
[EPOCH 046/089] train: loss=0.3455 acc=79.13% | val: loss=0.6370 acc=67.74% f1=33.33% auc=63.66% val_score=89.0779 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.710) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=047] disease_pos_weight=1.0000 mode=none
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.3224 mb_mean=0.3096 norm_overlap=0.8698 corr_cb=-0.6867 topkJ=0.0000
[TRAIN][ep=047] loss=0.3434 acc=78.40%
[TRAIN][ep=047] mask_avg: mc_mean=0.3166 mb_mean=0.3010 norm_overlap=0.8329 corr_cb=-0.7103
[EPOCH 047/089] train: loss=0.3434 acc=78.40% | val: loss=0.6368 acc=67.74% f1=33.33% auc=63.21% val_score=80.7554 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.710) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 80.7554
[DBG][ep=048] disease_pos_weight=1.0000 mode=none
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.3211 mb_mean=0.2993 norm_overlap=0.8311 corr_cb=-0.7148 topkJ=0.0000
[TRAIN][ep=048] loss=0.3420 acc=78.58%
[TRAIN][ep=048] mask_avg: mc_mean=0.3166 mb_mean=0.3011 norm_overlap=0.8328 corr_cb=-0.7095
[EPOCH 048/089] train: loss=0.3420 acc=78.58% | val: loss=0.6372 acc=67.74% f1=33.33% auc=63.32% val_score=80.7554 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.709) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 80.7554
[DBG][ep=049] disease_pos_weight=1.0000 mode=none
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.3091 mb_mean=0.3018 norm_overlap=0.8433 corr_cb=-0.6752 topkJ=0.0000
[TRAIN][ep=049] loss=0.3399 acc=79.13%
[TRAIN][ep=049] mask_avg: mc_mean=0.3166 mb_mean=0.3010 norm_overlap=0.8326 corr_cb=-0.7108
[EPOCH 049/089] train: loss=0.3399 acc=79.13% | val: loss=0.6394 acc=67.74% f1=33.33% auc=63.10% val_score=89.0779 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.833, corr=-0.711) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=050] disease_pos_weight=1.0000 mode=none
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.3133 mb_mean=0.3179 norm_overlap=0.8486 corr_cb=-0.7305 topkJ=0.0000
[TRAIN][ep=050] loss=0.3392 acc=79.49%
[TRAIN][ep=050] mask_avg: mc_mean=0.3166 mb_mean=0.3011 norm_overlap=0.8325 corr_cb=-0.7099
[EPOCH 050/089] train: loss=0.3392 acc=79.49% | val: loss=0.6407 acc=67.74% f1=33.33% auc=63.21% val_score=89.0779 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.317, mb=0.301, no=0.832, corr=-0.710) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[EARLY STOP] no improvement for 30 epochs. best_epoch=20
[CKPT] Loaded best for testing: results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
=============== FIT DONE ===============
[BEST] epoch=20 | val_acc=67.74% | val_f1=50.00% | val_auc=65.22% | val_score=90.0707 | val_score_bestthr=92.0414
[TEST@BEST] thr_used=0.650 | acc=63.64% f1=0.00% auc=59.64% | SP_sex=0.00% EO_sex=0.00% SP_age=0.00% EO_age=0.00%
[TIME] 0.86 min
[OK] Saved: results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/summary_fold_0.json
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5236 mb_mean=0.5061 norm_overlap=0.9998 corr_cb=-0.1913 topkJ=0.0225
[TRAIN][ep=000] loss=0.6926 acc=51.91%
[TRAIN][ep=000] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2677
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5223 mb_mean=0.5043 norm_overlap=0.9995 corr_cb=-0.3398 topkJ=0.0124
[TRAIN][ep=001] loss=0.6752 acc=63.70%
[TRAIN][ep=001] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2716
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5214 mb_mean=0.5039 norm_overlap=0.9998 corr_cb=-0.1603 topkJ=0.0315
[TRAIN][ep=002] loss=0.6633 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2709
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5198 mb_mean=0.5045 norm_overlap=0.9997 corr_cb=-0.2413 topkJ=0.0174
[TRAIN][ep=003] loss=0.6578 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2654
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5237 mb_mean=0.5050 norm_overlap=0.9997 corr_cb=-0.2572 topkJ=0.0114
[TRAIN][ep=004] loss=0.6554 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2685
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5214 mb_mean=0.5050 norm_overlap=0.9997 corr_cb=-0.2780 topkJ=0.0280
[TRAIN][ep=005] loss=0.6542 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2701
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5217 mb_mean=0.5043 norm_overlap=0.9997 corr_cb=-0.2886 topkJ=0.0135
[TRAIN][ep=006] loss=0.6538 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2669
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5184 mb_mean=0.5067 norm_overlap=0.9997 corr_cb=-0.3329 topkJ=0.0218
[TRAIN][ep=007] loss=0.6520 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2713
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5223 mb_mean=0.5062 norm_overlap=0.9996 corr_cb=-0.3736 topkJ=0.0062
[TRAIN][ep=008] loss=0.6517 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2684
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5215 mb_mean=0.5068 norm_overlap=0.9997 corr_cb=-0.2734 topkJ=0.0259
[TRAIN][ep=009] loss=0.6500 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2687
================= FIT START (fold=0) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.35 select_by=val_score | eval_thr_mode=best_acc eval_thr_grid=coarse | disease_pos_weight_mode=none freeze_b_after=15 | two_stage=True stage1_ratio=0.35 stage2_lr_mult=0.3 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5235 mb_mean=0.5056 norm_overlap=0.9996 corr_cb=-0.2652 topkJ=0.0979
[TRAIN][ep=000] loss=0.6488 acc=63.70%
[TRAIN][ep=000] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2687
[EPOCH 000/089] train: loss=0.6488 acc=63.70% | val: loss=0.6590 acc=62.90% f1=0.00% auc=49.28% val_score=64.2297 val_score_bestthr=62.9032 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.521, mb=0.506, no=1.000, corr=-0.269) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* -1000000000000000000.0000 -> 64.2297
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5221 mb_mean=0.5070 norm_overlap=0.9998 corr_cb=-0.2391 topkJ=0.0404
[TRAIN][ep=001] loss=0.6469 acc=63.70%
[TRAIN][ep=001] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2684
[EPOCH 001/089] train: loss=0.6469 acc=63.70% | val: loss=0.6577 acc=62.90% f1=0.00% auc=51.28% val_score=67.4541 val_score_bestthr=62.9032 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.521, mb=0.506, no=1.000, corr=-0.268) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 64.2297 -> 67.4541
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5187 mb_mean=0.5040 norm_overlap=0.9998 corr_cb=-0.2618 topkJ=0.0162
[TRAIN][ep=002] loss=0.6457 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2713
[EPOCH 002/089] train: loss=0.6457 acc=63.70% | val: loss=0.6570 acc=62.90% f1=14.81% auc=51.84% val_score=64.2297 val_score_bestthr=69.7231 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.521, mb=0.506, no=1.000, corr=-0.271) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 67.4541 -> 64.2297
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5199 mb_mean=0.5065 norm_overlap=0.9998 corr_cb=-0.2547 topkJ=0.0454
[TRAIN][ep=003] loss=0.6442 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2668
[EPOCH 003/089] train: loss=0.6442 acc=63.70% | val: loss=0.6557 acc=62.90% f1=14.81% auc=52.73% val_score=66.7750 val_score_bestthr=69.7231 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.521, mb=0.506, no=1.000, corr=-0.267) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 67.4541 -> 66.7750
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5227 mb_mean=0.5044 norm_overlap=0.9996 corr_cb=-0.3527 topkJ=0.0157
[TRAIN][ep=004] loss=0.6434 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2700
[EPOCH 004/089] train: loss=0.6434 acc=63.70% | val: loss=0.6545 acc=64.52% f1=8.33% auc=54.07% val_score=66.7750 val_score_bestthr=68.1795 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.521, mb=0.506, no=1.000, corr=-0.270) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 67.4541 -> 66.7750
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5208 mb_mean=0.5063 norm_overlap=0.9997 corr_cb=-0.2071 topkJ=0.0176
[TRAIN][ep=005] loss=2.6310 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.5149 mb_mean=0.4975 norm_overlap=0.9997 corr_cb=-0.1832
[EPOCH 005/089] train: loss=2.6310 acc=63.70% | val: loss=0.6551 acc=64.52% f1=21.43% auc=54.40% val_score=75.5211 val_score_bestthr=74.3752 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.515, mb=0.498, no=1.000, corr=-0.183) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 67.4541 -> 75.5211
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5087 mb_mean=0.4903 norm_overlap=0.9996 corr_cb=-0.2239 topkJ=0.0318
[TRAIN][ep=006] loss=2.6267 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.5015 mb_mean=0.4806 norm_overlap=0.9998 corr_cb=-0.0937
[EPOCH 006/089] train: loss=2.6267 acc=63.70% | val: loss=0.6539 acc=64.52% f1=21.43% auc=55.96% val_score=74.3065 val_score_bestthr=74.3752 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.501, mb=0.481, no=1.000, corr=-0.094) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 75.5211 -> 74.3065
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4939 mb_mean=0.4713 norm_overlap=0.9997 corr_cb=-0.0831 topkJ=0.0235
[TRAIN][ep=007] loss=2.6235 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.4880 mb_mean=0.4623 norm_overlap=1.0001 corr_cb=-0.0008
[EPOCH 007/089] train: loss=2.6235 acc=63.70% | val: loss=0.6526 acc=66.13% f1=27.59% auc=56.41% val_score=67.1224 val_score_bestthr=78.8618 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.488, mb=0.462, no=1.000, corr=-0.001) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 75.5211 -> 67.1224
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4822 mb_mean=0.4534 norm_overlap=0.9993 corr_cb=-0.1672 topkJ=0.0250
[TRAIN][ep=008] loss=2.6131 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.4746 mb_mean=0.4433 norm_overlap=1.0008 corr_cb=0.1136
[EPOCH 008/089] train: loss=2.6131 acc=63.70% | val: loss=0.6520 acc=66.13% f1=27.59% auc=56.97% val_score=76.3813 val_score_bestthr=78.8618 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.475, mb=0.443, no=1.001, corr=0.114) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 75.5211 -> 76.3813
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4671 mb_mean=0.4402 norm_overlap=1.0010 corr_cb=0.1595 topkJ=0.0967
[TRAIN][ep=009] loss=2.6116 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.4614 mb_mean=0.4234 norm_overlap=1.0013 corr_cb=0.1235
[EPOCH 009/089] train: loss=2.6116 acc=63.70% | val: loss=0.6513 acc=64.52% f1=26.67% auc=58.08% val_score=76.3813 val_score_bestthr=76.6882 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.461, mb=0.423, no=1.001, corr=0.124) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.3813 -> 76.3813
[DBG][ep=010] disease_pos_weight=1.0000 mode=none
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.4565 mb_mean=0.4122 norm_overlap=1.0011 corr_cb=0.1008 topkJ=0.0502
[TRAIN][ep=010] loss=2.6018 acc=63.70%
[TRAIN][ep=010] mask_avg: mc_mean=0.4486 mb_mean=0.4038 norm_overlap=1.0014 corr_cb=0.0855
[EPOCH 010/089] train: loss=2.6018 acc=63.70% | val: loss=0.6494 acc=66.13% f1=16.00% auc=59.31% val_score=70.3872 val_score_bestthr=73.5938 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.449, mb=0.404, no=1.001, corr=0.086) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.3813 -> 70.3872
[DBG][ep=011] disease_pos_weight=1.0000 mode=none
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.4465 mb_mean=0.3942 norm_overlap=1.0006 corr_cb=0.0358 topkJ=0.0255
[TRAIN][ep=011] loss=2.5954 acc=63.70%
[TRAIN][ep=011] mask_avg: mc_mean=0.4363 mb_mean=0.3847 norm_overlap=1.0011 corr_cb=0.0469
[EPOCH 011/089] train: loss=2.5954 acc=63.70% | val: loss=0.6480 acc=67.74% f1=23.08% auc=59.53% val_score=74.5015 val_score_bestthr=78.5401 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.436, mb=0.385, no=1.001, corr=0.047) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.3813 -> 74.5015
[DBG][ep=012] disease_pos_weight=1.0000 mode=none
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.4222 mb_mean=0.3613 norm_overlap=1.0046 corr_cb=0.1399 topkJ=0.0825
[TRAIN][ep=012] loss=2.5921 acc=63.70%
[TRAIN][ep=012] mask_avg: mc_mean=0.4240 mb_mean=0.3668 norm_overlap=0.9995 corr_cb=-0.0206
[EPOCH 012/089] train: loss=2.5921 acc=63.70% | val: loss=0.6472 acc=67.74% f1=23.08% auc=60.54% val_score=77.4868 val_score_bestthr=78.5401 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.424, mb=0.367, no=0.999, corr=-0.021) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 76.3813 -> 77.4868
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=013] disease_pos_weight=1.0000 mode=none
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.4226 mb_mean=0.3629 norm_overlap=0.9956 corr_cb=-0.1519 topkJ=0.0304
[TRAIN][ep=013] loss=1.7036 acc=63.70%
[TRAIN][ep=013] mask_avg: mc_mean=0.4135 mb_mean=0.3498 norm_overlap=0.9951 corr_cb=-0.1357
[EPOCH 013/089] train: loss=1.7036 acc=63.70% | val: loss=0.6451 acc=67.74% f1=23.08% auc=62.10% val_score=77.8847 val_score_bestthr=78.5401 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.414, mb=0.350, no=0.995, corr=-0.136) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 77.4868 -> 77.8847
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=014] disease_pos_weight=1.0000 mode=none
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.4027 mb_mean=0.3355 norm_overlap=0.9826 corr_cb=-0.3814 topkJ=0.0147
[TRAIN][ep=014] loss=0.8205 acc=63.52%
[TRAIN][ep=014] mask_avg: mc_mean=0.4025 mb_mean=0.3339 norm_overlap=0.9869 corr_cb=-0.2576
[EPOCH 014/089] train: loss=0.8205 acc=63.52% | val: loss=0.6421 acc=66.13% f1=36.36% auc=62.54% val_score=82.3788 val_score_bestthr=83.6339 | dyn(w_pfs=0.190, w_sup=0.090, w_csuf=0.040, stage2=False) | mask(mc=0.402, mb=0.334, no=0.987, corr=-0.258) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 77.8847 -> 82.3788
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=015] disease_pos_weight=1.0000 mode=none
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.3969 mb_mean=0.3230 norm_overlap=0.9905 corr_cb=-0.1410 topkJ=0.0373
[TRAIN][ep=015] loss=1.1666 acc=63.52%
[TRAIN][ep=015] mask_avg: mc_mean=0.3903 mb_mean=0.3266 norm_overlap=0.9775 corr_cb=-0.3481
[EPOCH 015/089] train: loss=1.1666 acc=63.52% | val: loss=0.6399 acc=67.74% f1=44.44% auc=63.43% val_score=82.3788 val_score_bestthr=89.5159 | dyn(w_pfs=0.230, w_sup=0.130, w_csuf=0.080, stage2=False) | mask(mc=0.390, mb=0.327, no=0.978, corr=-0.348) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 82.3788 -> 82.3788
[DBG][ep=016] disease_pos_weight=1.0000 mode=none
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.3834 mb_mean=0.3219 norm_overlap=0.9785 corr_cb=-0.2905 topkJ=0.0257
[TRAIN][ep=016] loss=1.5132 acc=63.70%
[TRAIN][ep=016] mask_avg: mc_mean=0.3813 mb_mean=0.3266 norm_overlap=0.9725 corr_cb=-0.3818
[EPOCH 016/089] train: loss=1.5132 acc=63.70% | val: loss=0.6406 acc=66.13% f1=36.36% auc=63.10% val_score=89.3823 val_score_bestthr=83.7023 | dyn(w_pfs=0.270, w_sup=0.170, w_csuf=0.120, stage2=False) | mask(mc=0.381, mb=0.327, no=0.972, corr=-0.382) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=* 82.3788 -> 89.3823
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=017] disease_pos_weight=1.0000 mode=none
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.3835 mb_mean=0.3377 norm_overlap=0.9703 corr_cb=-0.4491 topkJ=0.0020
[TRAIN][ep=017] loss=1.8601 acc=63.70%
[TRAIN][ep=017] mask_avg: mc_mean=0.3720 mb_mean=0.3266 norm_overlap=0.9664 corr_cb=-0.4179
[EPOCH 017/089] train: loss=1.8601 acc=63.70% | val: loss=0.6376 acc=67.74% f1=23.08% auc=63.43% val_score=88.0277 val_score_bestthr=78.5401 | dyn(w_pfs=0.310, w_sup=0.210, w_csuf=0.160, stage2=False) | mask(mc=0.372, mb=0.327, no=0.966, corr=-0.418) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 89.3823 -> 88.0277
[DBG][ep=018] disease_pos_weight=1.0000 mode=none
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.3734 mb_mean=0.3225 norm_overlap=0.9669 corr_cb=-0.4124 topkJ=0.0067
[TRAIN][ep=018] loss=2.2080 acc=64.07%
[TRAIN][ep=018] mask_avg: mc_mean=0.3652 mb_mean=0.3266 norm_overlap=0.9621 corr_cb=-0.4430
[EPOCH 018/089] train: loss=2.2080 acc=64.07% | val: loss=0.6375 acc=67.74% f1=23.08% auc=62.88% val_score=81.6153 val_score_bestthr=78.5401 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.365, mb=0.327, no=0.962, corr=-0.443) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 89.3823 -> 81.6153
[DBG][ep=019] disease_pos_weight=1.0000 mode=none
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.3675 mb_mean=0.3226 norm_overlap=0.9589 corr_cb=-0.4663 topkJ=0.0012
[TRAIN][ep=019] loss=2.5508 acc=64.61%
[TRAIN][ep=019] mask_avg: mc_mean=0.3593 mb_mean=0.3266 norm_overlap=0.9577 corr_cb=-0.4640
[EPOCH 019/089] train: loss=2.5508 acc=64.61% | val: loss=0.6354 acc=67.74% f1=23.08% auc=63.43% val_score=85.8087 val_score_bestthr=78.5401 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.359, mb=0.327, no=0.958, corr=-0.464) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 89.3823 -> 85.8087
[DBG][ep=020] disease_pos_weight=1.0000 mode=none
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.3626 mb_mean=0.3249 norm_overlap=0.9716 corr_cb=-0.3298 topkJ=0.0055
[TRAIN][ep=020] loss=2.5406 acc=64.79%
[TRAIN][ep=020] mask_avg: mc_mean=0.3523 mb_mean=0.3266 norm_overlap=0.9521 corr_cb=-0.4831
[EPOCH 020/089] train: loss=2.5406 acc=64.79% | val: loss=0.6335 acc=66.13% f1=40.00% auc=64.44% val_score=90.0707 val_score_bestthr=85.4793 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.352, mb=0.327, no=0.952, corr=-0.483) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=* 89.3823 -> 90.0707
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=021] disease_pos_weight=1.0000 mode=none
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.3503 mb_mean=0.3222 norm_overlap=0.9592 corr_cb=-0.3813 topkJ=0.0037
[TRAIN][ep=021] loss=1.6633 acc=65.70%
[TRAIN][ep=021] mask_avg: mc_mean=0.3464 mb_mean=0.3266 norm_overlap=0.9472 corr_cb=-0.4996
[EPOCH 021/089] train: loss=1.6633 acc=65.70% | val: loss=0.6327 acc=66.13% f1=27.59% auc=64.44% val_score=87.9096 val_score_bestthr=79.3411 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.346, mb=0.327, no=0.947, corr=-0.500) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 87.9096
[DBG][ep=022] disease_pos_weight=1.0000 mode=none
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.3322 mb_mean=0.3243 norm_overlap=0.9312 corr_cb=-0.5663 topkJ=0.0000
[TRAIN][ep=022] loss=0.7763 acc=64.79%
[TRAIN][ep=022] mask_avg: mc_mean=0.3392 mb_mean=0.3266 norm_overlap=0.9396 corr_cb=-0.5225
[EPOCH 022/089] train: loss=0.7763 acc=64.79% | val: loss=0.6295 acc=67.74% f1=52.38% auc=65.66% val_score=76.7019 val_score_bestthr=93.2389 | dyn(w_pfs=0.190, w_sup=0.090, w_csuf=0.040, stage2=False) | mask(mc=0.339, mb=0.327, no=0.940, corr=-0.522) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 76.7019
[DBG][ep=023] disease_pos_weight=1.0000 mode=none
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.3461 mb_mean=0.3336 norm_overlap=0.9377 corr_cb=-0.5563 topkJ=0.0000
[TRAIN][ep=023] loss=1.1213 acc=68.06%
[TRAIN][ep=023] mask_avg: mc_mean=0.3355 mb_mean=0.3266 norm_overlap=0.9357 corr_cb=-0.5361
[EPOCH 023/089] train: loss=1.1213 acc=68.06% | val: loss=0.6273 acc=66.13% f1=51.16% auc=64.66% val_score=87.9096 val_score_bestthr=90.9891 | dyn(w_pfs=0.230, w_sup=0.130, w_csuf=0.080, stage2=False) | mask(mc=0.335, mb=0.327, no=0.936, corr=-0.536) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 87.9096
[DBG][ep=024] disease_pos_weight=1.0000 mode=none
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.3252 mb_mean=0.3247 norm_overlap=0.9276 corr_cb=-0.5581 topkJ=0.0004
[TRAIN][ep=024] loss=1.4596 acc=68.06%
[TRAIN][ep=024] mask_avg: mc_mean=0.3300 mb_mean=0.3266 norm_overlap=0.9287 corr_cb=-0.5520
[EPOCH 024/089] train: loss=1.4596 acc=68.06% | val: loss=0.6245 acc=69.35% f1=45.71% auc=66.56% val_score=83.1813 val_score_bestthr=91.7322 | dyn(w_pfs=0.270, w_sup=0.170, w_csuf=0.120, stage2=False) | mask(mc=0.330, mb=0.327, no=0.929, corr=-0.552) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 83.1813
[DBG][ep=025] disease_pos_weight=1.0000 mode=none
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.3239 mb_mean=0.3223 norm_overlap=0.9043 corr_cb=-0.6175 topkJ=0.0000
[TRAIN][ep=025] loss=1.8012 acc=70.96%
[TRAIN][ep=025] mask_avg: mc_mean=0.3269 mb_mean=0.3266 norm_overlap=0.9249 corr_cb=-0.5626
[EPOCH 025/089] train: loss=1.8012 acc=70.96% | val: loss=0.6251 acc=66.13% f1=48.78% auc=65.22% val_score=86.6635 val_score_bestthr=89.8572 | dyn(w_pfs=0.310, w_sup=0.210, w_csuf=0.160, stage2=False) | mask(mc=0.327, mb=0.327, no=0.925, corr=-0.563) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 86.6635
[DBG][ep=026] disease_pos_weight=1.0000 mode=none
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.3254 mb_mean=0.3265 norm_overlap=0.9039 corr_cb=-0.6428 topkJ=0.0000
[TRAIN][ep=026] loss=2.1410 acc=71.51%
[TRAIN][ep=026] mask_avg: mc_mean=0.3227 mb_mean=0.3266 norm_overlap=0.9192 corr_cb=-0.5746
[EPOCH 026/089] train: loss=2.1410 acc=71.51% | val: loss=0.6286 acc=67.74% f1=28.57% auc=64.44% val_score=86.9755 val_score_bestthr=81.4605 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.323, mb=0.327, no=0.919, corr=-0.575) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 86.9755
[DBG][ep=027] disease_pos_weight=1.0000 mode=none
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.3158 mb_mean=0.3174 norm_overlap=0.8946 corr_cb=-0.6576 topkJ=0.0000
[TRAIN][ep=027] loss=2.4750 acc=72.96%
[TRAIN][ep=027] mask_avg: mc_mean=0.3195 mb_mean=0.3266 norm_overlap=0.9137 corr_cb=-0.5854
[EPOCH 027/089] train: loss=2.4750 acc=72.96% | val: loss=0.6281 acc=67.74% f1=33.33% auc=64.10% val_score=84.5666 val_score_bestthr=83.9489 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.319, mb=0.327, no=0.914, corr=-0.585) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 84.5666
[DBG][ep=028] disease_pos_weight=1.0000 mode=none
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.3219 mb_mean=0.3320 norm_overlap=0.9261 corr_cb=-0.5762 topkJ=0.0000
[TRAIN][ep=028] loss=1.5954 acc=74.77%
[TRAIN][ep=028] mask_avg: mc_mean=0.3164 mb_mean=0.3266 norm_overlap=0.9086 corr_cb=-0.5967
[EPOCH 028/089] train: loss=1.5954 acc=74.77% | val: loss=0.6304 acc=67.74% f1=33.33% auc=63.43% val_score=84.8824 val_score_bestthr=83.9489 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.316, mb=0.327, no=0.909, corr=-0.597) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 84.8824
[DBG][ep=029] disease_pos_weight=1.0000 mode=none
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.3209 mb_mean=0.3279 norm_overlap=0.9146 corr_cb=-0.6020 topkJ=0.0000
[TRAIN][ep=029] loss=0.7190 acc=74.77%
[TRAIN][ep=029] mask_avg: mc_mean=0.3130 mb_mean=0.3266 norm_overlap=0.9036 corr_cb=-0.6005
[EPOCH 029/089] train: loss=0.7190 acc=74.77% | val: loss=0.6309 acc=67.74% f1=33.33% auc=64.10% val_score=80.2804 val_score_bestthr=83.9489 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.313, mb=0.327, no=0.904, corr=-0.601) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 80.2804
[DBG][ep=030] disease_pos_weight=1.0000 mode=none
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.3100 mb_mean=0.3252 norm_overlap=0.8878 corr_cb=-0.6567 topkJ=0.0000
[TRAIN][ep=030] loss=0.4610 acc=77.13%
[TRAIN][ep=030] mask_avg: mc_mean=0.3108 mb_mean=0.3266 norm_overlap=0.8996 corr_cb=-0.6069
[EPOCH 030/089] train: loss=0.4610 acc=77.13% | val: loss=0.6259 acc=67.74% f1=33.33% auc=63.99% val_score=82.4712 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.311, mb=0.327, no=0.900, corr=-0.607) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 82.4712
[DBG][ep=031] disease_pos_weight=1.0000 mode=none
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.3107 mb_mean=0.3234 norm_overlap=0.8744 corr_cb=-0.6577 topkJ=0.0000
[TRAIN][ep=031] loss=0.4389 acc=76.95%
[TRAIN][ep=031] mask_avg: mc_mean=0.3095 mb_mean=0.3266 norm_overlap=0.8973 corr_cb=-0.6114
[EPOCH 031/089] train: loss=0.4389 acc=76.95% | val: loss=0.6262 acc=67.74% f1=58.33% auc=63.88% val_score=79.5360 val_score_bestthr=95.5901 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.310, mb=0.327, no=0.897, corr=-0.611) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 79.5360
[DBG][ep=032] disease_pos_weight=1.0000 mode=none
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.3166 mb_mean=0.3172 norm_overlap=0.8858 corr_cb=-0.6663 topkJ=0.0000
[TRAIN][ep=032] loss=0.4358 acc=76.77%
[TRAIN][ep=032] mask_avg: mc_mean=0.3095 mb_mean=0.3266 norm_overlap=0.8974 corr_cb=-0.6103
[EPOCH 032/089] train: loss=0.4358 acc=76.77% | val: loss=0.6283 acc=67.74% f1=33.33% auc=63.88% val_score=89.0779 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.310, mb=0.327, no=0.897, corr=-0.610) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=033] disease_pos_weight=1.0000 mode=none
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.3005 mb_mean=0.3203 norm_overlap=0.9021 corr_cb=-0.5775 topkJ=0.0000
[TRAIN][ep=033] loss=0.4338 acc=76.59%
[TRAIN][ep=033] mask_avg: mc_mean=0.3095 mb_mean=0.3266 norm_overlap=0.8973 corr_cb=-0.6109
[EPOCH 033/089] train: loss=0.4338 acc=76.59% | val: loss=0.6294 acc=67.74% f1=58.33% auc=63.77% val_score=89.0779 val_score_bestthr=95.5901 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.310, mb=0.327, no=0.897, corr=-0.611) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=034] disease_pos_weight=1.0000 mode=none
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.3069 mb_mean=0.3246 norm_overlap=0.8952 corr_cb=-0.5745 topkJ=0.0000
[TRAIN][ep=034] loss=0.4320 acc=77.31%
[TRAIN][ep=034] mask_avg: mc_mean=0.3095 mb_mean=0.3266 norm_overlap=0.8971 corr_cb=-0.6107
[EPOCH 034/089] train: loss=0.4320 acc=77.31% | val: loss=0.6279 acc=67.74% f1=58.33% auc=63.88% val_score=89.0779 val_score_bestthr=95.5901 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.310, mb=0.327, no=0.897, corr=-0.611) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=035] disease_pos_weight=1.0000 mode=none
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.3016 mb_mean=0.3391 norm_overlap=0.8965 corr_cb=-0.6714 topkJ=0.0000
[TRAIN][ep=035] loss=0.4300 acc=77.50%
[TRAIN][ep=035] mask_avg: mc_mean=0.3095 mb_mean=0.3266 norm_overlap=0.8972 corr_cb=-0.6109
[EPOCH 035/089] train: loss=0.4300 acc=77.50% | val: loss=0.6292 acc=67.74% f1=58.33% auc=63.99% val_score=89.0779 val_score_bestthr=95.5901 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.310, mb=0.327, no=0.897, corr=-0.611) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=036] disease_pos_weight=1.0000 mode=none
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.3104 mb_mean=0.3329 norm_overlap=0.8740 corr_cb=-0.6915 topkJ=0.0000
[TRAIN][ep=036] loss=0.4283 acc=77.68%
[TRAIN][ep=036] mask_avg: mc_mean=0.3095 mb_mean=0.3266 norm_overlap=0.8973 corr_cb=-0.6124
[EPOCH 036/089] train: loss=0.4283 acc=77.68% | val: loss=0.6289 acc=67.74% f1=33.33% auc=63.77% val_score=89.0779 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.310, mb=0.327, no=0.897, corr=-0.612) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=037] disease_pos_weight=1.0000 mode=none
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.3060 mb_mean=0.3312 norm_overlap=0.9211 corr_cb=-0.4776 topkJ=0.0000
[TRAIN][ep=037] loss=0.4264 acc=77.86%
[TRAIN][ep=037] mask_avg: mc_mean=0.3095 mb_mean=0.3266 norm_overlap=0.8972 corr_cb=-0.6100
[EPOCH 037/089] train: loss=0.4264 acc=77.86% | val: loss=0.6301 acc=67.74% f1=33.33% auc=63.99% val_score=89.0779 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.310, mb=0.327, no=0.897, corr=-0.610) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=038] disease_pos_weight=1.0000 mode=none
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.3030 mb_mean=0.3262 norm_overlap=0.8989 corr_cb=-0.5359 topkJ=0.0000
[TRAIN][ep=038] loss=0.4244 acc=77.68%
[TRAIN][ep=038] mask_avg: mc_mean=0.3095 mb_mean=0.3266 norm_overlap=0.8972 corr_cb=-0.6111
[EPOCH 038/089] train: loss=0.4244 acc=77.68% | val: loss=0.6301 acc=67.74% f1=33.33% auc=63.77% val_score=85.0042 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.310, mb=0.327, no=0.897, corr=-0.611) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 85.0042
[DBG][ep=039] disease_pos_weight=1.0000 mode=none
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.3122 mb_mean=0.3288 norm_overlap=0.8915 corr_cb=-0.6410 topkJ=0.0000
[TRAIN][ep=039] loss=0.4225 acc=78.22%
[TRAIN][ep=039] mask_avg: mc_mean=0.3095 mb_mean=0.3266 norm_overlap=0.8973 corr_cb=-0.6109
[EPOCH 039/089] train: loss=0.4225 acc=78.22% | val: loss=0.6304 acc=67.74% f1=33.33% auc=63.55% val_score=89.0779 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.310, mb=0.327, no=0.897, corr=-0.611) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=040] disease_pos_weight=1.0000 mode=none
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.3058 mb_mean=0.3308 norm_overlap=0.8648 corr_cb=-0.7181 topkJ=0.0000
[TRAIN][ep=040] loss=0.4215 acc=78.22%
[TRAIN][ep=040] mask_avg: mc_mean=0.3095 mb_mean=0.3266 norm_overlap=0.8974 corr_cb=-0.6082
[EPOCH 040/089] train: loss=0.4215 acc=78.22% | val: loss=0.6307 acc=67.74% f1=33.33% auc=63.66% val_score=89.0779 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.309, mb=0.327, no=0.897, corr=-0.608) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=041] disease_pos_weight=1.0000 mode=none
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.3026 mb_mean=0.3221 norm_overlap=0.9051 corr_cb=-0.5372 topkJ=0.0000
[TRAIN][ep=041] loss=0.4194 acc=78.04%
[TRAIN][ep=041] mask_avg: mc_mean=0.3095 mb_mean=0.3266 norm_overlap=0.8973 corr_cb=-0.6103
[EPOCH 041/089] train: loss=0.4194 acc=78.04% | val: loss=0.6317 acc=67.74% f1=33.33% auc=63.66% val_score=89.0779 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.310, mb=0.327, no=0.897, corr=-0.610) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=042] disease_pos_weight=1.0000 mode=none
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.3095 mb_mean=0.3285 norm_overlap=0.9000 corr_cb=-0.6271 topkJ=0.0000
[TRAIN][ep=042] loss=0.4181 acc=78.58%
[TRAIN][ep=042] mask_avg: mc_mean=0.3095 mb_mean=0.3266 norm_overlap=0.8971 corr_cb=-0.6110
[EPOCH 042/089] train: loss=0.4181 acc=78.58% | val: loss=0.6319 acc=67.74% f1=33.33% auc=63.77% val_score=89.0779 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.310, mb=0.327, no=0.897, corr=-0.611) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=043] disease_pos_weight=1.0000 mode=none
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.3164 mb_mean=0.3166 norm_overlap=0.8646 corr_cb=-0.6951 topkJ=0.0000
[TRAIN][ep=043] loss=0.4159 acc=78.22%
[TRAIN][ep=043] mask_avg: mc_mean=0.3095 mb_mean=0.3266 norm_overlap=0.8972 corr_cb=-0.6111
[EPOCH 043/089] train: loss=0.4159 acc=78.22% | val: loss=0.6326 acc=67.74% f1=33.33% auc=63.77% val_score=89.0779 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.310, mb=0.327, no=0.897, corr=-0.611) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=044] disease_pos_weight=1.0000 mode=none
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.3148 mb_mean=0.3206 norm_overlap=0.8809 corr_cb=-0.6803 topkJ=0.0000
[TRAIN][ep=044] loss=0.4139 acc=78.40%
[TRAIN][ep=044] mask_avg: mc_mean=0.3095 mb_mean=0.3266 norm_overlap=0.8974 corr_cb=-0.6098
[EPOCH 044/089] train: loss=0.4139 acc=78.40% | val: loss=0.6324 acc=67.74% f1=33.33% auc=63.77% val_score=87.0311 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.310, mb=0.327, no=0.897, corr=-0.610) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 87.0311
[DBG][ep=045] disease_pos_weight=1.0000 mode=none
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.3102 mb_mean=0.3073 norm_overlap=0.8534 corr_cb=-0.6775 topkJ=0.0000
[TRAIN][ep=045] loss=0.4130 acc=78.77%
[TRAIN][ep=045] mask_avg: mc_mean=0.3095 mb_mean=0.3266 norm_overlap=0.8973 corr_cb=-0.6098
[EPOCH 045/089] train: loss=0.4130 acc=78.77% | val: loss=0.6341 acc=67.74% f1=33.33% auc=63.43% val_score=89.0779 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.310, mb=0.327, no=0.897, corr=-0.610) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=046] disease_pos_weight=1.0000 mode=none
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.3021 mb_mean=0.3412 norm_overlap=0.8901 corr_cb=-0.7067 topkJ=0.0000
[TRAIN][ep=046] loss=0.4114 acc=78.77%
[TRAIN][ep=046] mask_avg: mc_mean=0.3095 mb_mean=0.3266 norm_overlap=0.8972 corr_cb=-0.6113
[EPOCH 046/089] train: loss=0.4114 acc=78.77% | val: loss=0.6347 acc=67.74% f1=33.33% auc=63.43% val_score=89.0779 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.310, mb=0.327, no=0.897, corr=-0.611) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=047] disease_pos_weight=1.0000 mode=none
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.3165 mb_mean=0.3350 norm_overlap=0.9256 corr_cb=-0.5644 topkJ=0.0000
[TRAIN][ep=047] loss=0.4093 acc=78.22%
[TRAIN][ep=047] mask_avg: mc_mean=0.3095 mb_mean=0.3266 norm_overlap=0.8973 corr_cb=-0.6113
[EPOCH 047/089] train: loss=0.4093 acc=78.22% | val: loss=0.6345 acc=67.74% f1=33.33% auc=63.32% val_score=82.8781 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.310, mb=0.327, no=0.897, corr=-0.611) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 82.8781
[DBG][ep=048] disease_pos_weight=1.0000 mode=none
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.3134 mb_mean=0.3250 norm_overlap=0.8971 corr_cb=-0.6101 topkJ=0.0000
[TRAIN][ep=048] loss=0.4079 acc=78.95%
[TRAIN][ep=048] mask_avg: mc_mean=0.3095 mb_mean=0.3266 norm_overlap=0.8973 corr_cb=-0.6104
[EPOCH 048/089] train: loss=0.4079 acc=78.95% | val: loss=0.6349 acc=67.74% f1=33.33% auc=63.43% val_score=80.7554 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.309, mb=0.327, no=0.897, corr=-0.610) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 80.7554
[DBG][ep=049] disease_pos_weight=1.0000 mode=none
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.3036 mb_mean=0.3273 norm_overlap=0.9058 corr_cb=-0.5694 topkJ=0.0000
[TRAIN][ep=049] loss=0.4058 acc=78.95%
[TRAIN][ep=049] mask_avg: mc_mean=0.3095 mb_mean=0.3266 norm_overlap=0.8972 corr_cb=-0.6118
[EPOCH 049/089] train: loss=0.4058 acc=78.95% | val: loss=0.6368 acc=67.74% f1=33.33% auc=63.21% val_score=89.0779 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.310, mb=0.327, no=0.897, corr=-0.612) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=050] disease_pos_weight=1.0000 mode=none
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.3091 mb_mean=0.3417 norm_overlap=0.9057 corr_cb=-0.6433 topkJ=0.0000
[TRAIN][ep=050] loss=0.4050 acc=79.13%
[TRAIN][ep=050] mask_avg: mc_mean=0.3095 mb_mean=0.3266 norm_overlap=0.8970 corr_cb=-0.6109
[EPOCH 050/089] train: loss=0.4050 acc=79.13% | val: loss=0.6381 acc=67.74% f1=33.33% auc=62.99% val_score=89.0779 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.310, mb=0.327, no=0.897, corr=-0.611) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[EARLY STOP] no improvement for 30 epochs. best_epoch=20
[CKPT] Loaded best for testing: results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
=============== FIT DONE ===============
[BEST] epoch=20 | val_acc=66.13% | val_f1=40.00% | val_auc=64.44% | val_score=90.0707 | val_score_bestthr=85.4793
[TEST@BEST] thr_used=0.590 | acc=63.64% f1=0.00% auc=60.02% | SP_sex=0.00% EO_sex=0.00% SP_age=0.00% EO_age=0.00%
[TIME] 0.79 min
[OK] Saved: results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/summary_fold_0.json
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5236 mb_mean=0.5061 norm_overlap=0.9998 corr_cb=-0.1913 topkJ=0.0225
[TRAIN][ep=000] loss=0.6926 acc=51.91%
[TRAIN][ep=000] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2677
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5223 mb_mean=0.5043 norm_overlap=0.9995 corr_cb=-0.3398 topkJ=0.0124
[TRAIN][ep=001] loss=0.6752 acc=63.70%
[TRAIN][ep=001] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2716
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5214 mb_mean=0.5039 norm_overlap=0.9998 corr_cb=-0.1603 topkJ=0.0315
[TRAIN][ep=002] loss=0.6633 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2709
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5198 mb_mean=0.5045 norm_overlap=0.9997 corr_cb=-0.2413 topkJ=0.0174
[TRAIN][ep=003] loss=0.6578 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2654
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5237 mb_mean=0.5050 norm_overlap=0.9997 corr_cb=-0.2572 topkJ=0.0114
[TRAIN][ep=004] loss=0.6554 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2685
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5214 mb_mean=0.5050 norm_overlap=0.9997 corr_cb=-0.2780 topkJ=0.0280
[TRAIN][ep=005] loss=0.6542 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2701
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5217 mb_mean=0.5043 norm_overlap=0.9997 corr_cb=-0.2886 topkJ=0.0135
[TRAIN][ep=006] loss=0.6538 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2669
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5184 mb_mean=0.5067 norm_overlap=0.9997 corr_cb=-0.3329 topkJ=0.0218
[TRAIN][ep=007] loss=0.6520 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2713
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5223 mb_mean=0.5062 norm_overlap=0.9996 corr_cb=-0.3736 topkJ=0.0062
[TRAIN][ep=008] loss=0.6517 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2684
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5215 mb_mean=0.5068 norm_overlap=0.9997 corr_cb=-0.2734 topkJ=0.0259
[TRAIN][ep=009] loss=0.6500 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2687
================= FIT START (fold=0) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.35 select_by=val_score | eval_thr_mode=best_acc eval_thr_grid=coarse | disease_pos_weight_mode=none freeze_b_after=15 | two_stage=True stage1_ratio=0.35 stage2_lr_mult=0.3 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5235 mb_mean=0.5056 norm_overlap=0.9996 corr_cb=-0.2652 topkJ=0.0979
[TRAIN][ep=000] loss=0.6488 acc=63.70%
[TRAIN][ep=000] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2687
[EPOCH 000/089] train: loss=0.6488 acc=63.70% | val: loss=0.6590 acc=62.90% f1=0.00% auc=49.28% val_score=64.2297 val_score_bestthr=62.9032 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.521, mb=0.506, no=1.000, corr=-0.269) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* -1000000000000000000.0000 -> 64.2297
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5221 mb_mean=0.5070 norm_overlap=0.9998 corr_cb=-0.2391 topkJ=0.0404
[TRAIN][ep=001] loss=0.6469 acc=63.70%
[TRAIN][ep=001] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2684
[EPOCH 001/089] train: loss=0.6469 acc=63.70% | val: loss=0.6577 acc=62.90% f1=0.00% auc=51.28% val_score=67.4541 val_score_bestthr=62.9032 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.521, mb=0.506, no=1.000, corr=-0.268) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 64.2297 -> 67.4541
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5187 mb_mean=0.5040 norm_overlap=0.9998 corr_cb=-0.2618 topkJ=0.0162
[TRAIN][ep=002] loss=0.6457 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2713
[EPOCH 002/089] train: loss=0.6457 acc=63.70% | val: loss=0.6570 acc=62.90% f1=14.81% auc=51.84% val_score=64.2297 val_score_bestthr=69.7231 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.521, mb=0.506, no=1.000, corr=-0.271) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 67.4541 -> 64.2297
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5199 mb_mean=0.5065 norm_overlap=0.9998 corr_cb=-0.2547 topkJ=0.0454
[TRAIN][ep=003] loss=0.6442 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2668
[EPOCH 003/089] train: loss=0.6442 acc=63.70% | val: loss=0.6557 acc=62.90% f1=14.81% auc=52.73% val_score=66.7750 val_score_bestthr=69.7231 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.521, mb=0.506, no=1.000, corr=-0.267) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 67.4541 -> 66.7750
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5227 mb_mean=0.5044 norm_overlap=0.9996 corr_cb=-0.3527 topkJ=0.0157
[TRAIN][ep=004] loss=0.6434 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2700
[EPOCH 004/089] train: loss=0.6434 acc=63.70% | val: loss=0.6545 acc=64.52% f1=8.33% auc=54.07% val_score=66.7750 val_score_bestthr=68.1795 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.521, mb=0.506, no=1.000, corr=-0.270) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 67.4541 -> 66.7750
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5208 mb_mean=0.5063 norm_overlap=0.9997 corr_cb=-0.2071 topkJ=0.0176
[TRAIN][ep=005] loss=1.8917 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.5144 mb_mean=0.4913 norm_overlap=0.9998 corr_cb=-0.1255
[EPOCH 005/089] train: loss=1.8917 acc=63.70% | val: loss=0.6548 acc=62.90% f1=20.69% auc=54.63% val_score=73.4476 val_score_bestthr=72.4762 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.514, mb=0.491, no=1.000, corr=-0.125) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 67.4541 -> 73.4476
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5078 mb_mean=0.4788 norm_overlap=0.9998 corr_cb=-0.0941 topkJ=0.0465
[TRAIN][ep=006] loss=1.8916 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.5001 mb_mean=0.4622 norm_overlap=1.0002 corr_cb=0.0372
[EPOCH 006/089] train: loss=1.8916 acc=63.70% | val: loss=0.6537 acc=64.52% f1=21.43% auc=55.85% val_score=76.2980 val_score_bestthr=74.3752 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.500, mb=0.462, no=1.000, corr=0.037) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 73.4476 -> 76.2980
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4921 mb_mean=0.4478 norm_overlap=1.0004 corr_cb=0.0813 topkJ=0.0411
[TRAIN][ep=007] loss=1.8890 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.4860 mb_mean=0.4323 norm_overlap=1.0009 corr_cb=0.1141
[EPOCH 007/089] train: loss=1.8890 acc=63.70% | val: loss=0.6523 acc=64.52% f1=26.67% auc=56.52% val_score=67.1224 val_score_bestthr=76.6882 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.486, mb=0.432, no=1.001, corr=0.114) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.2980 -> 67.1224
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4800 mb_mean=0.4184 norm_overlap=0.9994 corr_cb=-0.0821 topkJ=0.0279
[TRAIN][ep=008] loss=1.8797 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.4723 mb_mean=0.4025 norm_overlap=1.0019 corr_cb=0.1607
[EPOCH 008/089] train: loss=1.8797 acc=63.70% | val: loss=0.6517 acc=66.13% f1=27.59% auc=57.64% val_score=82.6406 val_score_bestthr=78.8618 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.472, mb=0.402, no=1.002, corr=0.161) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 76.2980 -> 82.6406
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4645 mb_mean=0.3993 norm_overlap=1.0015 corr_cb=0.1297 topkJ=0.0933
[TRAIN][ep=009] loss=1.8769 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.4590 mb_mean=0.3742 norm_overlap=1.0021 corr_cb=0.1119
[EPOCH 009/089] train: loss=1.8769 acc=63.70% | val: loss=0.6510 acc=64.52% f1=31.25% auc=58.53% val_score=78.5338 val_score_bestthr=79.3442 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.459, mb=0.374, no=1.002, corr=0.112) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 82.6406 -> 78.5338
[DBG][ep=010] disease_pos_weight=1.0000 mode=none
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.4546 mb_mean=0.3582 norm_overlap=1.0006 corr_cb=0.0322 topkJ=0.0579
[TRAIN][ep=010] loss=1.8686 acc=63.70%
[TRAIN][ep=010] mask_avg: mc_mean=0.4462 mb_mean=0.3493 norm_overlap=1.0005 corr_cb=0.0137
[EPOCH 010/089] train: loss=1.8686 acc=63.70% | val: loss=0.6490 acc=66.13% f1=16.00% auc=59.42% val_score=72.3785 val_score_bestthr=73.5938 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.446, mb=0.349, no=1.000, corr=0.014) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 82.6406 -> 72.3785
[DBG][ep=011] disease_pos_weight=1.0000 mode=none
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.4447 mb_mean=0.3351 norm_overlap=0.9980 corr_cb=-0.0708 topkJ=0.0222
[TRAIN][ep=011] loss=1.8630 acc=63.70%
[TRAIN][ep=011] mask_avg: mc_mean=0.4341 mb_mean=0.3281 norm_overlap=0.9965 corr_cb=-0.0975
[EPOCH 011/089] train: loss=1.8630 acc=63.70% | val: loss=0.6476 acc=67.74% f1=23.08% auc=59.98% val_score=76.5763 val_score_bestthr=78.5401 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.434, mb=0.328, no=0.996, corr=-0.097) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 82.6406 -> 76.5763
[DBG][ep=012] disease_pos_weight=1.0000 mode=none
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.4203 mb_mean=0.3000 norm_overlap=0.9963 corr_cb=-0.0634 topkJ=0.0454
[TRAIN][ep=012] loss=1.8587 acc=63.70%
[TRAIN][ep=012] mask_avg: mc_mean=0.4216 mb_mean=0.3109 norm_overlap=0.9877 corr_cb=-0.2367
[EPOCH 012/089] train: loss=1.8587 acc=63.70% | val: loss=0.6467 acc=67.74% f1=41.18% auc=61.76% val_score=81.6778 val_score_bestthr=87.1786 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.422, mb=0.311, no=0.988, corr=-0.237) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 82.6406 -> 81.6778
[DBG][ep=013] disease_pos_weight=1.0000 mode=none
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.4206 mb_mean=0.3086 norm_overlap=0.9784 corr_cb=-0.3930 topkJ=0.0131
[TRAIN][ep=013] loss=1.8482 acc=63.70%
[TRAIN][ep=013] mask_avg: mc_mean=0.4110 mb_mean=0.2969 norm_overlap=0.9731 corr_cb=-0.3931
[EPOCH 013/089] train: loss=1.8482 acc=63.70% | val: loss=0.6450 acc=67.74% f1=23.08% auc=62.10% val_score=77.8847 val_score_bestthr=78.5401 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.411, mb=0.297, no=0.973, corr=-0.393) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 82.6406 -> 77.8847
[DBG][ep=014] disease_pos_weight=1.0000 mode=none
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.3996 mb_mean=0.2824 norm_overlap=0.9459 corr_cb=-0.6056 topkJ=0.0012
[TRAIN][ep=014] loss=1.8460 acc=63.52%
[TRAIN][ep=014] mask_avg: mc_mean=0.3998 mb_mean=0.2863 norm_overlap=0.9503 corr_cb=-0.5329
[EPOCH 014/089] train: loss=1.8460 acc=63.52% | val: loss=0.6442 acc=67.74% f1=41.18% auc=61.43% val_score=80.9022 val_score_bestthr=87.6773 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.400, mb=0.286, no=0.950, corr=-0.533) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 82.6406 -> 80.9022
[DBG][ep=015] disease_pos_weight=1.0000 mode=none
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.3965 mb_mean=0.2805 norm_overlap=0.9523 corr_cb=-0.4346 topkJ=0.0062
[TRAIN][ep=015] loss=1.8372 acc=63.70%
[TRAIN][ep=015] mask_avg: mc_mean=0.3883 mb_mean=0.2827 norm_overlap=0.9282 corr_cb=-0.6118
[EPOCH 015/089] train: loss=1.8372 acc=63.70% | val: loss=0.6408 acc=67.74% f1=23.08% auc=63.10% val_score=80.8064 val_score_bestthr=78.5401 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.388, mb=0.283, no=0.928, corr=-0.612) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 82.6406 -> 80.8064
[DBG][ep=016] disease_pos_weight=1.0000 mode=none
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.3834 mb_mean=0.2760 norm_overlap=0.9208 corr_cb=-0.5975 topkJ=0.0012
[TRAIN][ep=016] loss=1.8294 acc=63.52%
[TRAIN][ep=016] mask_avg: mc_mean=0.3794 mb_mean=0.2827 norm_overlap=0.9143 corr_cb=-0.6429
[EPOCH 016/089] train: loss=1.8294 acc=63.52% | val: loss=0.6414 acc=67.74% f1=23.08% auc=62.99% val_score=87.2586 val_score_bestthr=78.5401 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.379, mb=0.283, no=0.914, corr=-0.643) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=* 82.6406 -> 87.2586
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=017] disease_pos_weight=1.0000 mode=none
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.3816 mb_mean=0.2948 norm_overlap=0.9163 corr_cb=-0.6844 topkJ=0.0000
[TRAIN][ep=017] loss=1.8229 acc=63.70%
[TRAIN][ep=017] mask_avg: mc_mean=0.3703 mb_mean=0.2827 norm_overlap=0.8985 corr_cb=-0.6724
[EPOCH 017/089] train: loss=1.8229 acc=63.70% | val: loss=0.6381 acc=67.74% f1=23.08% auc=63.66% val_score=85.8087 val_score_bestthr=78.5401 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.370, mb=0.283, no=0.899, corr=-0.672) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 87.2586 -> 85.8087
[DBG][ep=018] disease_pos_weight=1.0000 mode=none
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.3740 mb_mean=0.2755 norm_overlap=0.8987 corr_cb=-0.6697 topkJ=0.0000
[TRAIN][ep=018] loss=1.8187 acc=64.07%
[TRAIN][ep=018] mask_avg: mc_mean=0.3639 mb_mean=0.2827 norm_overlap=0.8865 corr_cb=-0.6929
[EPOCH 018/089] train: loss=1.8187 acc=64.07% | val: loss=0.6377 acc=66.13% f1=40.00% auc=62.99% val_score=87.2946 val_score_bestthr=85.4793 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.364, mb=0.283, no=0.886, corr=-0.693) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=* 87.2586 -> 87.2946
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=019] disease_pos_weight=1.0000 mode=none
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.3695 mb_mean=0.2755 norm_overlap=0.8796 corr_cb=-0.7133 topkJ=0.0000
[TRAIN][ep=019] loss=1.8103 acc=64.79%
[TRAIN][ep=019] mask_avg: mc_mean=0.3584 mb_mean=0.2827 norm_overlap=0.8741 corr_cb=-0.7108
[EPOCH 019/089] train: loss=1.8103 acc=64.79% | val: loss=0.6355 acc=67.74% f1=23.08% auc=64.21% val_score=85.8087 val_score_bestthr=78.5401 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.358, mb=0.283, no=0.874, corr=-0.711) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 87.2946 -> 85.8087
[DBG][ep=020] disease_pos_weight=1.0000 mode=none
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.3638 mb_mean=0.2795 norm_overlap=0.8991 corr_cb=-0.6188 topkJ=0.0000
[TRAIN][ep=020] loss=1.2169 acc=65.52%
[TRAIN][ep=020] mask_avg: mc_mean=0.3520 mb_mean=0.2827 norm_overlap=0.8593 corr_cb=-0.7263
[EPOCH 020/089] train: loss=1.2169 acc=65.52% | val: loss=0.6331 acc=67.74% f1=23.08% auc=64.21% val_score=87.9096 val_score_bestthr=78.5401 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.352, mb=0.283, no=0.859, corr=-0.726) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=* 87.2946 -> 87.9096
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=021] disease_pos_weight=1.0000 mode=none
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.3531 mb_mean=0.2793 norm_overlap=0.8602 corr_cb=-0.6841 topkJ=0.0000
[TRAIN][ep=021] loss=0.6268 acc=67.33%
[TRAIN][ep=021] mask_avg: mc_mean=0.3468 mb_mean=0.2827 norm_overlap=0.8457 corr_cb=-0.7394
[EPOCH 021/089] train: loss=0.6268 acc=67.33% | val: loss=0.6310 acc=66.13% f1=51.16% auc=64.44% val_score=90.0707 val_score_bestthr=90.9891 | dyn(w_pfs=0.190, w_sup=0.090, w_csuf=0.040, stage2=False) | mask(mc=0.347, mb=0.283, no=0.846, corr=-0.739) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=* 87.9096 -> 90.0707
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=022] disease_pos_weight=1.0000 mode=none
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.3308 mb_mean=0.2801 norm_overlap=0.8173 corr_cb=-0.7782 topkJ=0.0000
[TRAIN][ep=022] loss=0.8489 acc=66.79%
[TRAIN][ep=022] mask_avg: mc_mean=0.3411 mb_mean=0.2827 norm_overlap=0.8280 corr_cb=-0.7540
[EPOCH 022/089] train: loss=0.8489 acc=66.79% | val: loss=0.6284 acc=69.35% f1=48.65% auc=66.00% val_score=78.7557 val_score_bestthr=93.0332 | dyn(w_pfs=0.230, w_sup=0.130, w_csuf=0.080, stage2=False) | mask(mc=0.341, mb=0.283, no=0.828, corr=-0.754) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 78.7557
[DBG][ep=023] disease_pos_weight=1.0000 mode=none
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.3475 mb_mean=0.2893 norm_overlap=0.8406 corr_cb=-0.7500 topkJ=0.0000
[TRAIN][ep=023] loss=1.0796 acc=69.15%
[TRAIN][ep=023] mask_avg: mc_mean=0.3386 mb_mean=0.2827 norm_overlap=0.8192 corr_cb=-0.7634
[EPOCH 023/089] train: loss=1.0796 acc=69.15% | val: loss=0.6279 acc=66.13% f1=48.78% auc=64.99% val_score=87.9096 val_score_bestthr=89.8572 | dyn(w_pfs=0.270, w_sup=0.170, w_csuf=0.120, stage2=False) | mask(mc=0.339, mb=0.283, no=0.819, corr=-0.763) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 87.9096
[DBG][ep=024] disease_pos_weight=1.0000 mode=none
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.3289 mb_mean=0.2813 norm_overlap=0.7949 corr_cb=-0.7834 topkJ=0.0000
[TRAIN][ep=024] loss=1.2998 acc=68.97%
[TRAIN][ep=024] mask_avg: mc_mean=0.3350 mb_mean=0.2827 norm_overlap=0.8049 corr_cb=-0.7728
[EPOCH 024/089] train: loss=1.2998 acc=68.97% | val: loss=0.6262 acc=67.74% f1=41.18% auc=65.55% val_score=79.1178 val_score_bestthr=87.8675 | dyn(w_pfs=0.310, w_sup=0.210, w_csuf=0.160, stage2=False) | mask(mc=0.335, mb=0.283, no=0.805, corr=-0.773) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 79.1178
[DBG][ep=025] disease_pos_weight=1.0000 mode=none
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.3314 mb_mean=0.2791 norm_overlap=0.7579 corr_cb=-0.8009 topkJ=0.0000
[TRAIN][ep=025] loss=1.5240 acc=72.23%
[TRAIN][ep=025] mask_avg: mc_mean=0.3326 mb_mean=0.2827 norm_overlap=0.7969 corr_cb=-0.7769
[EPOCH 025/089] train: loss=1.5240 acc=72.23% | val: loss=0.6274 acc=67.74% f1=33.33% auc=63.88% val_score=86.6635 val_score_bestthr=83.9489 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.333, mb=0.283, no=0.797, corr=-0.777) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 86.6635
[DBG][ep=026] disease_pos_weight=1.0000 mode=none
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.3327 mb_mean=0.2829 norm_overlap=0.7637 corr_cb=-0.8201 topkJ=0.0000
[TRAIN][ep=026] loss=1.7472 acc=72.41%
[TRAIN][ep=026] mask_avg: mc_mean=0.3297 mb_mean=0.2827 norm_overlap=0.7853 corr_cb=-0.7833
[EPOCH 026/089] train: loss=1.7472 acc=72.41% | val: loss=0.6317 acc=67.74% f1=33.33% auc=62.99% val_score=86.9093 val_score_bestthr=83.9489 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.330, mb=0.283, no=0.785, corr=-0.783) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 86.9093
[DBG][ep=027] disease_pos_weight=1.0000 mode=none
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.3265 mb_mean=0.2708 norm_overlap=0.7387 corr_cb=-0.8264 topkJ=0.0000
[TRAIN][ep=027] loss=1.7329 acc=74.41%
[TRAIN][ep=027] mask_avg: mc_mean=0.3275 mb_mean=0.2827 norm_overlap=0.7749 corr_cb=-0.7887
[EPOCH 027/089] train: loss=1.7329 acc=74.41% | val: loss=0.6312 acc=67.74% f1=33.33% auc=62.99% val_score=81.5407 val_score_bestthr=83.9489 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.327, mb=0.283, no=0.775, corr=-0.789) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 81.5407
[DBG][ep=028] disease_pos_weight=1.0000 mode=none
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.3275 mb_mean=0.2868 norm_overlap=0.8023 corr_cb=-0.7855 topkJ=0.0000
[TRAIN][ep=028] loss=1.1441 acc=75.68%
[TRAIN][ep=028] mask_avg: mc_mean=0.3252 mb_mean=0.2827 norm_overlap=0.7656 corr_cb=-0.7939
[EPOCH 028/089] train: loss=1.1441 acc=75.68% | val: loss=0.6342 acc=67.74% f1=33.33% auc=62.43% val_score=82.8188 val_score_bestthr=83.9489 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.325, mb=0.283, no=0.766, corr=-0.794) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 82.8188
[DBG][ep=029] disease_pos_weight=1.0000 mode=none
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.3305 mb_mean=0.2844 norm_overlap=0.7761 corr_cb=-0.8067 topkJ=0.0000
[TRAIN][ep=029] loss=0.5559 acc=75.14%
[TRAIN][ep=029] mask_avg: mc_mean=0.3225 mb_mean=0.2827 norm_overlap=0.7565 corr_cb=-0.7941
[EPOCH 029/089] train: loss=0.5559 acc=75.14% | val: loss=0.6357 acc=67.74% f1=33.33% auc=63.10% val_score=80.2804 val_score_bestthr=83.9489 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.323, mb=0.283, no=0.757, corr=-0.794) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 80.2804
[DBG][ep=030] disease_pos_weight=1.0000 mode=none
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.3196 mb_mean=0.2827 norm_overlap=0.7275 corr_cb=-0.8306 topkJ=0.0000
[TRAIN][ep=030] loss=0.4429 acc=77.13%
[TRAIN][ep=030] mask_avg: mc_mean=0.3208 mb_mean=0.2827 norm_overlap=0.7493 corr_cb=-0.7960
[EPOCH 030/089] train: loss=0.4429 acc=77.13% | val: loss=0.6315 acc=67.74% f1=33.33% auc=62.99% val_score=79.5360 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.321, mb=0.283, no=0.749, corr=-0.796) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 79.5360
[DBG][ep=031] disease_pos_weight=1.0000 mode=none
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.3247 mb_mean=0.2784 norm_overlap=0.7022 corr_cb=-0.8245 topkJ=0.0000
[TRAIN][ep=031] loss=0.4206 acc=77.13%
[TRAIN][ep=031] mask_avg: mc_mean=0.3198 mb_mean=0.2827 norm_overlap=0.7454 corr_cb=-0.7972
[EPOCH 031/089] train: loss=0.4206 acc=77.13% | val: loss=0.6321 acc=67.74% f1=33.33% auc=62.99% val_score=81.6069 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.320, mb=0.283, no=0.745, corr=-0.797) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 81.6069
[DBG][ep=032] disease_pos_weight=1.0000 mode=none
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.3305 mb_mean=0.2676 norm_overlap=0.7285 corr_cb=-0.8133 topkJ=0.0000
[TRAIN][ep=032] loss=0.4174 acc=77.68%
[TRAIN][ep=032] mask_avg: mc_mean=0.3197 mb_mean=0.2827 norm_overlap=0.7456 corr_cb=-0.7970
[EPOCH 032/089] train: loss=0.4174 acc=77.68% | val: loss=0.6350 acc=67.74% f1=33.33% auc=62.43% val_score=89.0779 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.320, mb=0.283, no=0.746, corr=-0.797) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=033] disease_pos_weight=1.0000 mode=none
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.3069 mb_mean=0.2722 norm_overlap=0.7661 corr_cb=-0.7252 topkJ=0.0000
[TRAIN][ep=033] loss=0.4154 acc=77.31%
[TRAIN][ep=033] mask_avg: mc_mean=0.3198 mb_mean=0.2827 norm_overlap=0.7455 corr_cb=-0.7972
[EPOCH 033/089] train: loss=0.4154 acc=77.31% | val: loss=0.6363 acc=67.74% f1=33.33% auc=62.32% val_score=89.0779 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.320, mb=0.283, no=0.746, corr=-0.797) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=034] disease_pos_weight=1.0000 mode=none
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.3186 mb_mean=0.2817 norm_overlap=0.7397 corr_cb=-0.7702 topkJ=0.0000
[TRAIN][ep=034] loss=0.4136 acc=78.04%
[TRAIN][ep=034] mask_avg: mc_mean=0.3198 mb_mean=0.2827 norm_overlap=0.7453 corr_cb=-0.7968
[EPOCH 034/089] train: loss=0.4136 acc=78.04% | val: loss=0.6348 acc=67.74% f1=33.33% auc=62.43% val_score=87.0311 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.320, mb=0.283, no=0.745, corr=-0.797) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 87.0311
[DBG][ep=035] disease_pos_weight=1.0000 mode=none
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.3066 mb_mean=0.2980 norm_overlap=0.7439 corr_cb=-0.8338 topkJ=0.0000
[TRAIN][ep=035] loss=0.4116 acc=77.86%
[TRAIN][ep=035] mask_avg: mc_mean=0.3198 mb_mean=0.2827 norm_overlap=0.7453 corr_cb=-0.7970
[EPOCH 035/089] train: loss=0.4116 acc=77.86% | val: loss=0.6365 acc=67.74% f1=33.33% auc=62.65% val_score=89.0779 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.320, mb=0.283, no=0.745, corr=-0.797) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=036] disease_pos_weight=1.0000 mode=none
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.3213 mb_mean=0.2926 norm_overlap=0.7110 corr_cb=-0.8503 topkJ=0.0000
[TRAIN][ep=036] loss=0.4098 acc=77.86%
[TRAIN][ep=036] mask_avg: mc_mean=0.3198 mb_mean=0.2827 norm_overlap=0.7454 corr_cb=-0.7982
[EPOCH 036/089] train: loss=0.4098 acc=77.86% | val: loss=0.6363 acc=67.74% f1=33.33% auc=62.54% val_score=87.0311 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.320, mb=0.283, no=0.745, corr=-0.798) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 87.0311
[DBG][ep=037] disease_pos_weight=1.0000 mode=none
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.3137 mb_mean=0.2882 norm_overlap=0.7813 corr_cb=-0.7025 topkJ=0.0000
[TRAIN][ep=037] loss=0.4079 acc=78.22%
[TRAIN][ep=037] mask_avg: mc_mean=0.3198 mb_mean=0.2827 norm_overlap=0.7454 corr_cb=-0.7965
[EPOCH 037/089] train: loss=0.4079 acc=78.22% | val: loss=0.6380 acc=67.74% f1=33.33% auc=62.65% val_score=87.0311 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.320, mb=0.283, no=0.745, corr=-0.796) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 87.0311
[DBG][ep=038] disease_pos_weight=1.0000 mode=none
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.3138 mb_mean=0.2837 norm_overlap=0.7470 corr_cb=-0.7532 topkJ=0.0000
[TRAIN][ep=038] loss=0.4059 acc=78.22%
[TRAIN][ep=038] mask_avg: mc_mean=0.3198 mb_mean=0.2827 norm_overlap=0.7453 corr_cb=-0.7976
[EPOCH 038/089] train: loss=0.4059 acc=78.22% | val: loss=0.6382 acc=67.74% f1=33.33% auc=62.32% val_score=85.0042 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.320, mb=0.283, no=0.745, corr=-0.798) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 85.0042
[DBG][ep=039] disease_pos_weight=1.0000 mode=none
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.3226 mb_mean=0.2846 norm_overlap=0.7406 corr_cb=-0.8090 topkJ=0.0000
[TRAIN][ep=039] loss=0.4040 acc=78.22%
[TRAIN][ep=039] mask_avg: mc_mean=0.3197 mb_mean=0.2827 norm_overlap=0.7454 corr_cb=-0.7972
[EPOCH 039/089] train: loss=0.4040 acc=78.22% | val: loss=0.6388 acc=67.74% f1=33.33% auc=62.54% val_score=87.0311 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.320, mb=0.283, no=0.745, corr=-0.797) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 87.0311
[DBG][ep=040] disease_pos_weight=1.0000 mode=none
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.3162 mb_mean=0.2894 norm_overlap=0.6945 corr_cb=-0.8603 topkJ=0.0000
[TRAIN][ep=040] loss=0.4031 acc=77.86%
[TRAIN][ep=040] mask_avg: mc_mean=0.3197 mb_mean=0.2827 norm_overlap=0.7458 corr_cb=-0.7947
[EPOCH 040/089] train: loss=0.4031 acc=77.86% | val: loss=0.6391 acc=67.74% f1=33.33% auc=62.65% val_score=85.0042 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.320, mb=0.283, no=0.746, corr=-0.795) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 85.0042
[DBG][ep=041] disease_pos_weight=1.0000 mode=none
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.3118 mb_mean=0.2783 norm_overlap=0.7531 corr_cb=-0.7568 topkJ=0.0000
[TRAIN][ep=041] loss=0.4010 acc=78.58%
[TRAIN][ep=041] mask_avg: mc_mean=0.3198 mb_mean=0.2827 norm_overlap=0.7456 corr_cb=-0.7966
[EPOCH 041/089] train: loss=0.4010 acc=78.58% | val: loss=0.6405 acc=67.74% f1=33.33% auc=62.43% val_score=87.0311 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.320, mb=0.283, no=0.746, corr=-0.797) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 87.0311
[DBG][ep=042] disease_pos_weight=1.0000 mode=none
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.3202 mb_mean=0.2838 norm_overlap=0.7422 corr_cb=-0.8263 topkJ=0.0000
[TRAIN][ep=042] loss=0.3997 acc=78.22%
[TRAIN][ep=042] mask_avg: mc_mean=0.3197 mb_mean=0.2827 norm_overlap=0.7453 corr_cb=-0.7970
[EPOCH 042/089] train: loss=0.3997 acc=78.22% | val: loss=0.6409 acc=67.74% f1=33.33% auc=62.65% val_score=87.0311 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.320, mb=0.283, no=0.745, corr=-0.797) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 87.0311
[DBG][ep=043] disease_pos_weight=1.0000 mode=none
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.3329 mb_mean=0.2717 norm_overlap=0.6857 corr_cb=-0.8444 topkJ=0.0000
[TRAIN][ep=043] loss=0.3975 acc=78.40%
[TRAIN][ep=043] mask_avg: mc_mean=0.3197 mb_mean=0.2827 norm_overlap=0.7455 corr_cb=-0.7973
[EPOCH 043/089] train: loss=0.3975 acc=78.40% | val: loss=0.6418 acc=67.74% f1=33.33% auc=62.43% val_score=87.0311 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.320, mb=0.283, no=0.745, corr=-0.797) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 87.0311
[DBG][ep=044] disease_pos_weight=1.0000 mode=none
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.3282 mb_mean=0.2760 norm_overlap=0.7124 corr_cb=-0.8459 topkJ=0.0000
[TRAIN][ep=044] loss=0.3956 acc=78.04%
[TRAIN][ep=044] mask_avg: mc_mean=0.3198 mb_mean=0.2827 norm_overlap=0.7457 corr_cb=-0.7965
[EPOCH 044/089] train: loss=0.3956 acc=78.04% | val: loss=0.6418 acc=67.74% f1=33.33% auc=62.88% val_score=85.0042 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.320, mb=0.283, no=0.746, corr=-0.797) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 85.0042
[DBG][ep=045] disease_pos_weight=1.0000 mode=none
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.3297 mb_mean=0.2597 norm_overlap=0.6639 corr_cb=-0.8277 topkJ=0.0000
[TRAIN][ep=045] loss=0.3946 acc=78.77%
[TRAIN][ep=045] mask_avg: mc_mean=0.3197 mb_mean=0.2827 norm_overlap=0.7455 corr_cb=-0.7969
[EPOCH 045/089] train: loss=0.3946 acc=78.77% | val: loss=0.6438 acc=67.74% f1=33.33% auc=62.21% val_score=87.0311 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.320, mb=0.283, no=0.746, corr=-0.797) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 87.0311
[DBG][ep=046] disease_pos_weight=1.0000 mode=none
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.3070 mb_mean=0.2985 norm_overlap=0.7522 corr_cb=-0.8418 topkJ=0.0000
[TRAIN][ep=046] loss=0.3931 acc=78.95%
[TRAIN][ep=046] mask_avg: mc_mean=0.3197 mb_mean=0.2827 norm_overlap=0.7455 corr_cb=-0.7974
[EPOCH 046/089] train: loss=0.3931 acc=78.95% | val: loss=0.6446 acc=67.74% f1=33.33% auc=62.32% val_score=87.0311 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.320, mb=0.283, no=0.745, corr=-0.797) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 87.0311
[DBG][ep=047] disease_pos_weight=1.0000 mode=none
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.3243 mb_mean=0.2906 norm_overlap=0.7915 corr_cb=-0.7936 topkJ=0.0000
[TRAIN][ep=047] loss=0.3910 acc=78.58%
[TRAIN][ep=047] mask_avg: mc_mean=0.3197 mb_mean=0.2827 norm_overlap=0.7456 corr_cb=-0.7976
[EPOCH 047/089] train: loss=0.3910 acc=78.58% | val: loss=0.6444 acc=67.74% f1=33.33% auc=63.21% val_score=82.8781 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.320, mb=0.283, no=0.746, corr=-0.798) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 82.8781
[DBG][ep=048] disease_pos_weight=1.0000 mode=none
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.3239 mb_mean=0.2808 norm_overlap=0.7493 corr_cb=-0.7959 topkJ=0.0000
[TRAIN][ep=048] loss=0.3897 acc=78.95%
[TRAIN][ep=048] mask_avg: mc_mean=0.3197 mb_mean=0.2827 norm_overlap=0.7456 corr_cb=-0.7968
[EPOCH 048/089] train: loss=0.3897 acc=78.95% | val: loss=0.6449 acc=67.74% f1=33.33% auc=62.99% val_score=80.7554 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.320, mb=0.283, no=0.746, corr=-0.797) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 80.7554
[DBG][ep=049] disease_pos_weight=1.0000 mode=none
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.3110 mb_mean=0.2836 norm_overlap=0.7591 corr_cb=-0.7671 topkJ=0.0000
[TRAIN][ep=049] loss=0.3876 acc=79.31%
[TRAIN][ep=049] mask_avg: mc_mean=0.3197 mb_mean=0.2827 norm_overlap=0.7453 corr_cb=-0.7980
[EPOCH 049/089] train: loss=0.3876 acc=79.31% | val: loss=0.6473 acc=67.74% f1=33.33% auc=62.76% val_score=87.0311 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.320, mb=0.283, no=0.745, corr=-0.798) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 87.0311
[DBG][ep=050] disease_pos_weight=1.0000 mode=none
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.3142 mb_mean=0.3003 norm_overlap=0.7690 corr_cb=-0.8119 topkJ=0.0000
[TRAIN][ep=050] loss=0.3868 acc=79.49%
[TRAIN][ep=050] mask_avg: mc_mean=0.3198 mb_mean=0.2827 norm_overlap=0.7451 corr_cb=-0.7973
[EPOCH 050/089] train: loss=0.3868 acc=79.49% | val: loss=0.6488 acc=67.74% f1=33.33% auc=62.65% val_score=87.0311 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.320, mb=0.283, no=0.745, corr=-0.797) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 87.0311
[DBG][ep=051] disease_pos_weight=1.0000 mode=none
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.3126 mb_mean=0.2805 norm_overlap=0.7684 corr_cb=-0.7361 topkJ=0.0000
[TRAIN][ep=051] loss=0.3849 acc=78.95%
[TRAIN][ep=051] mask_avg: mc_mean=0.3197 mb_mean=0.2827 norm_overlap=0.7456 corr_cb=-0.7963
[EPOCH 051/089] train: loss=0.3849 acc=78.95% | val: loss=0.6497 acc=67.74% f1=33.33% auc=62.76% val_score=87.0311 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.320, mb=0.283, no=0.746, corr=-0.796) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 87.0311
[EARLY STOP] no improvement for 30 epochs. best_epoch=21
[CKPT] Loaded best for testing: results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
=============== FIT DONE ===============
[BEST] epoch=21 | val_acc=66.13% | val_f1=51.16% | val_auc=64.44% | val_score=90.0707 | val_score_bestthr=90.9891
[TEST@BEST] thr_used=0.380 | acc=64.29% f1=50.45% auc=60.04% | SP_sex=6.52% EO_sex=0.00% SP_age=19.76% EO_age=52.41%
[TIME] 0.91 min
[OK] Saved: results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/summary_fold_0.json
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5236 mb_mean=0.5061 norm_overlap=0.9998 corr_cb=-0.1913 topkJ=0.0225
[TRAIN][ep=000] loss=0.6926 acc=51.91%
[TRAIN][ep=000] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2677
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5223 mb_mean=0.5043 norm_overlap=0.9995 corr_cb=-0.3398 topkJ=0.0124
[TRAIN][ep=001] loss=0.6752 acc=63.70%
[TRAIN][ep=001] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2716
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5214 mb_mean=0.5039 norm_overlap=0.9998 corr_cb=-0.1603 topkJ=0.0315
[TRAIN][ep=002] loss=0.6633 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2709
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5198 mb_mean=0.5045 norm_overlap=0.9997 corr_cb=-0.2413 topkJ=0.0174
[TRAIN][ep=003] loss=0.6578 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2654
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5237 mb_mean=0.5050 norm_overlap=0.9997 corr_cb=-0.2572 topkJ=0.0114
[TRAIN][ep=004] loss=0.6554 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2685
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5214 mb_mean=0.5050 norm_overlap=0.9997 corr_cb=-0.2780 topkJ=0.0280
[TRAIN][ep=005] loss=0.6542 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2701
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5217 mb_mean=0.5043 norm_overlap=0.9997 corr_cb=-0.2886 topkJ=0.0135
[TRAIN][ep=006] loss=0.6538 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2669
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5184 mb_mean=0.5067 norm_overlap=0.9997 corr_cb=-0.3329 topkJ=0.0218
[TRAIN][ep=007] loss=0.6520 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2713
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5223 mb_mean=0.5062 norm_overlap=0.9996 corr_cb=-0.3736 topkJ=0.0062
[TRAIN][ep=008] loss=0.6517 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2684
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5215 mb_mean=0.5068 norm_overlap=0.9997 corr_cb=-0.2734 topkJ=0.0259
[TRAIN][ep=009] loss=0.6500 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2687
================= FIT START (fold=0) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.35 select_by=val_score | eval_thr_mode=best_acc eval_thr_grid=coarse | disease_pos_weight_mode=none freeze_b_after=15 | two_stage=True stage1_ratio=0.35 stage2_lr_mult=0.3 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5235 mb_mean=0.5056 norm_overlap=0.9996 corr_cb=-0.2652 topkJ=0.0979
[TRAIN][ep=000] loss=0.6488 acc=63.70%
[TRAIN][ep=000] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2687
[EPOCH 000/089] train: loss=0.6488 acc=63.70% | val: loss=0.6590 acc=62.90% f1=0.00% auc=49.28% val_score=64.2297 val_score_bestthr=62.9032 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.521, mb=0.506, no=1.000, corr=-0.269) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* -1000000000000000000.0000 -> 64.2297
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5221 mb_mean=0.5070 norm_overlap=0.9998 corr_cb=-0.2391 topkJ=0.0404
[TRAIN][ep=001] loss=0.6469 acc=63.70%
[TRAIN][ep=001] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2684
[EPOCH 001/089] train: loss=0.6469 acc=63.70% | val: loss=0.6577 acc=62.90% f1=0.00% auc=51.28% val_score=67.4541 val_score_bestthr=62.9032 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.521, mb=0.506, no=1.000, corr=-0.268) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 64.2297 -> 67.4541
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5187 mb_mean=0.5040 norm_overlap=0.9998 corr_cb=-0.2618 topkJ=0.0162
[TRAIN][ep=002] loss=0.6457 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2713
[EPOCH 002/089] train: loss=0.6457 acc=63.70% | val: loss=0.6570 acc=62.90% f1=14.81% auc=51.84% val_score=64.2297 val_score_bestthr=69.7231 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.521, mb=0.506, no=1.000, corr=-0.271) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 67.4541 -> 64.2297
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5199 mb_mean=0.5065 norm_overlap=0.9998 corr_cb=-0.2547 topkJ=0.0454
[TRAIN][ep=003] loss=0.6442 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2668
[EPOCH 003/089] train: loss=0.6442 acc=63.70% | val: loss=0.6557 acc=62.90% f1=14.81% auc=52.73% val_score=66.7750 val_score_bestthr=69.7231 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.521, mb=0.506, no=1.000, corr=-0.267) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 67.4541 -> 66.7750
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5227 mb_mean=0.5044 norm_overlap=0.9996 corr_cb=-0.3527 topkJ=0.0157
[TRAIN][ep=004] loss=0.6434 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2700
[EPOCH 004/089] train: loss=0.6434 acc=63.70% | val: loss=0.6545 acc=64.52% f1=8.33% auc=54.07% val_score=66.7750 val_score_bestthr=68.1795 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.521, mb=0.506, no=1.000, corr=-0.270) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 67.4541 -> 66.7750
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5208 mb_mean=0.5063 norm_overlap=0.9997 corr_cb=-0.2071 topkJ=0.0176
[TRAIN][ep=005] loss=2.1367 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.5145 mb_mean=0.4947 norm_overlap=0.9998 corr_cb=-0.1573
[EPOCH 005/089] train: loss=2.1367 acc=63.70% | val: loss=0.6550 acc=62.90% f1=20.69% auc=54.63% val_score=75.5211 val_score_bestthr=72.4762 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.514, mb=0.495, no=1.000, corr=-0.157) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 67.4541 -> 75.5211
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5079 mb_mean=0.4851 norm_overlap=0.9997 corr_cb=-0.1652 topkJ=0.0376
[TRAIN][ep=006] loss=2.1283 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.5002 mb_mean=0.4723 norm_overlap=1.0000 corr_cb=-0.0248
[EPOCH 006/089] train: loss=2.1283 acc=63.70% | val: loss=0.6539 acc=64.52% f1=21.43% auc=55.74% val_score=74.3065 val_score_bestthr=74.3752 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.500, mb=0.472, no=1.000, corr=-0.025) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 75.5211 -> 74.3065
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4923 mb_mean=0.4606 norm_overlap=1.0000 corr_cb=0.0088 topkJ=0.0311
[TRAIN][ep=007] loss=2.1239 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.4860 mb_mean=0.4486 norm_overlap=1.0005 corr_cb=0.0727
[EPOCH 007/089] train: loss=2.1239 acc=63.70% | val: loss=0.6526 acc=66.13% f1=27.59% auc=56.63% val_score=67.1224 val_score_bestthr=78.8618 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.486, mb=0.449, no=1.000, corr=0.073) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 75.5211 -> 67.1224
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4799 mb_mean=0.4372 norm_overlap=0.9994 corr_cb=-0.1095 topkJ=0.0262
[TRAIN][ep=008] loss=2.1145 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.4720 mb_mean=0.4242 norm_overlap=1.0015 corr_cb=0.1589
[EPOCH 008/089] train: loss=2.1145 acc=63.70% | val: loss=0.6520 acc=66.13% f1=27.59% auc=57.08% val_score=76.3813 val_score_bestthr=78.8618 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.472, mb=0.424, no=1.001, corr=0.159) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 75.5211 -> 76.3813
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4642 mb_mean=0.4207 norm_overlap=1.0014 corr_cb=0.1633 topkJ=0.1041
[TRAIN][ep=009] loss=2.1123 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.4583 mb_mean=0.3995 norm_overlap=1.0021 corr_cb=0.1407
[EPOCH 009/089] train: loss=2.1123 acc=63.70% | val: loss=0.6514 acc=64.52% f1=31.25% auc=58.08% val_score=76.3813 val_score_bestthr=79.3442 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.458, mb=0.400, no=1.002, corr=0.141) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.3813 -> 76.3813
[DBG][ep=010] disease_pos_weight=1.0000 mode=none
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.4535 mb_mean=0.3855 norm_overlap=1.0013 corr_cb=0.0884 topkJ=0.0569
[TRAIN][ep=010] loss=2.1036 acc=63.70%
[TRAIN][ep=010] mask_avg: mc_mean=0.4450 mb_mean=0.3763 norm_overlap=1.0016 corr_cb=0.0712
[EPOCH 010/089] train: loss=2.1036 acc=63.70% | val: loss=0.6495 acc=66.13% f1=16.00% auc=59.20% val_score=70.3872 val_score_bestthr=73.5938 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.445, mb=0.376, no=1.002, corr=0.071) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.3813 -> 70.3872
[DBG][ep=011] disease_pos_weight=1.0000 mode=none
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.4431 mb_mean=0.3640 norm_overlap=1.0001 corr_cb=0.0056 topkJ=0.0277
[TRAIN][ep=011] loss=2.0978 acc=63.70%
[TRAIN][ep=011] mask_avg: mc_mean=0.4324 mb_mean=0.3551 norm_overlap=0.9999 corr_cb=-0.0077
[EPOCH 011/089] train: loss=2.0978 acc=63.70% | val: loss=0.6481 acc=67.74% f1=23.08% auc=59.75% val_score=74.5015 val_score_bestthr=78.5401 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.432, mb=0.355, no=1.000, corr=-0.008) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.3813 -> 74.5015
[DBG][ep=012] disease_pos_weight=1.0000 mode=none
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.4180 mb_mean=0.3284 norm_overlap=1.0023 corr_cb=0.0506 topkJ=0.0675
[TRAIN][ep=012] loss=2.0941 acc=63.70%
[TRAIN][ep=012] mask_avg: mc_mean=0.4197 mb_mean=0.3366 norm_overlap=0.9953 corr_cb=-0.1184
[EPOCH 012/089] train: loss=2.0941 acc=63.70% | val: loss=0.6474 acc=67.74% f1=41.18% auc=60.65% val_score=77.4868 val_score_bestthr=87.1786 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.420, mb=0.337, no=0.995, corr=-0.118) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 76.3813 -> 77.4868
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=013] disease_pos_weight=1.0000 mode=none
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.4186 mb_mean=0.3331 norm_overlap=0.9887 corr_cb=-0.2692 topkJ=0.0245
[TRAIN][ep=013] loss=2.0839 acc=63.70%
[TRAIN][ep=013] mask_avg: mc_mean=0.4090 mb_mean=0.3202 norm_overlap=0.9862 corr_cb=-0.2612
[EPOCH 013/089] train: loss=2.0839 acc=63.70% | val: loss=0.6454 acc=67.74% f1=23.08% auc=62.32% val_score=80.9022 val_score_bestthr=78.5401 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.409, mb=0.320, no=0.986, corr=-0.261) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 77.4868 -> 80.9022
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=014] disease_pos_weight=1.0000 mode=none
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.3978 mb_mean=0.3051 norm_overlap=0.9665 corr_cb=-0.4970 topkJ=0.0069
[TRAIN][ep=014] loss=2.0822 acc=63.70%
[TRAIN][ep=014] mask_avg: mc_mean=0.3980 mb_mean=0.3067 norm_overlap=0.9720 corr_cb=-0.3906
[EPOCH 014/089] train: loss=2.0822 acc=63.70% | val: loss=0.6449 acc=67.74% f1=23.08% auc=61.32% val_score=80.9022 val_score_bestthr=78.5401 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.398, mb=0.307, no=0.972, corr=-0.391) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 80.9022 -> 80.9022
[DBG][ep=015] disease_pos_weight=1.0000 mode=none
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.3939 mb_mean=0.2985 norm_overlap=0.9769 corr_cb=-0.2624 topkJ=0.0221
[TRAIN][ep=015] loss=2.0744 acc=63.70%
[TRAIN][ep=015] mask_avg: mc_mean=0.3867 mb_mean=0.3015 norm_overlap=0.9585 corr_cb=-0.4662
[EPOCH 015/089] train: loss=2.0744 acc=63.70% | val: loss=0.6417 acc=67.74% f1=23.08% auc=61.98% val_score=82.9035 val_score_bestthr=78.5401 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.387, mb=0.301, no=0.959, corr=-0.466) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=* 80.9022 -> 82.9035
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=016] disease_pos_weight=1.0000 mode=none
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.3808 mb_mean=0.2956 norm_overlap=0.9557 corr_cb=-0.4362 topkJ=0.0127
[TRAIN][ep=016] loss=2.0674 acc=63.52%
[TRAIN][ep=016] mask_avg: mc_mean=0.3778 mb_mean=0.3015 norm_overlap=0.9495 corr_cb=-0.5034
[EPOCH 016/089] train: loss=2.0674 acc=63.52% | val: loss=0.6420 acc=67.74% f1=23.08% auc=62.76% val_score=87.2586 val_score_bestthr=78.5401 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.378, mb=0.301, no=0.950, corr=-0.503) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=* 82.9035 -> 87.2586
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=017] disease_pos_weight=1.0000 mode=none
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.3803 mb_mean=0.3136 norm_overlap=0.9486 corr_cb=-0.5592 topkJ=0.0008
[TRAIN][ep=017] loss=2.0614 acc=63.52%
[TRAIN][ep=017] mask_avg: mc_mean=0.3687 mb_mean=0.3015 norm_overlap=0.9391 corr_cb=-0.5401
[EPOCH 017/089] train: loss=2.0614 acc=63.52% | val: loss=0.6391 acc=67.74% f1=23.08% auc=63.43% val_score=88.6660 val_score_bestthr=78.5401 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.369, mb=0.301, no=0.939, corr=-0.540) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=* 87.2586 -> 88.6660
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=018] disease_pos_weight=1.0000 mode=none
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.3715 mb_mean=0.2958 norm_overlap=0.9393 corr_cb=-0.5388 topkJ=0.0004
[TRAIN][ep=018] loss=1.3712 acc=64.25%
[TRAIN][ep=018] mask_avg: mc_mean=0.3620 mb_mean=0.3015 norm_overlap=0.9310 corr_cb=-0.5668
[EPOCH 018/089] train: loss=1.3712 acc=64.25% | val: loss=0.6379 acc=67.74% f1=23.08% auc=63.21% val_score=87.2946 val_score_bestthr=78.5401 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.362, mb=0.301, no=0.931, corr=-0.567) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 88.6660 -> 87.2946
[DBG][ep=019] disease_pos_weight=1.0000 mode=none
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.3658 mb_mean=0.2958 norm_overlap=0.9261 corr_cb=-0.5883 topkJ=0.0004
[TRAIN][ep=019] loss=0.6787 acc=65.34%
[TRAIN][ep=019] mask_avg: mc_mean=0.3555 mb_mean=0.3015 norm_overlap=0.9217 corr_cb=-0.5909
[EPOCH 019/089] train: loss=0.6787 acc=65.34% | val: loss=0.6340 acc=66.13% f1=40.00% auc=64.21% val_score=85.8087 val_score_bestthr=85.4793 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.355, mb=0.301, no=0.922, corr=-0.591) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 88.6660 -> 85.8087
[DBG][ep=020] disease_pos_weight=1.0000 mode=none
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.3598 mb_mean=0.2992 norm_overlap=0.9409 corr_cb=-0.4778 topkJ=0.0004
[TRAIN][ep=020] loss=0.5174 acc=66.06%
[TRAIN][ep=020] mask_avg: mc_mean=0.3483 mb_mean=0.3015 norm_overlap=0.9105 corr_cb=-0.6124
[EPOCH 020/089] train: loss=0.5174 acc=66.06% | val: loss=0.6305 acc=67.74% f1=33.33% auc=64.77% val_score=90.0707 val_score_bestthr=83.4349 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.348, mb=0.301, no=0.910, corr=-0.612) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=* 88.6660 -> 90.0707
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=021] disease_pos_weight=1.0000 mode=none
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.3477 mb_mean=0.2976 norm_overlap=0.9125 corr_cb=-0.5515 topkJ=0.0000
[TRAIN][ep=021] loss=0.5074 acc=67.88%
[TRAIN][ep=021] mask_avg: mc_mean=0.3424 mb_mean=0.3015 norm_overlap=0.8998 corr_cb=-0.6320
[EPOCH 021/089] train: loss=0.5074 acc=67.88% | val: loss=0.6277 acc=67.74% f1=44.44% auc=65.77% val_score=90.0707 val_score_bestthr=89.3941 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.342, mb=0.301, no=0.900, corr=-0.632) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 90.0707
[DBG][ep=022] disease_pos_weight=1.0000 mode=none
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.3267 mb_mean=0.2991 norm_overlap=0.8785 corr_cb=-0.6801 topkJ=0.0000
[TRAIN][ep=022] loss=0.7756 acc=67.51%
[TRAIN][ep=022] mask_avg: mc_mean=0.3363 mb_mean=0.3015 norm_overlap=0.8868 corr_cb=-0.6522
[EPOCH 022/089] train: loss=0.7756 acc=67.51% | val: loss=0.6258 acc=67.74% f1=44.44% auc=66.67% val_score=79.7197 val_score_bestthr=89.3941 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.336, mb=0.302, no=0.887, corr=-0.652) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 79.7197
[DBG][ep=023] disease_pos_weight=1.0000 mode=none
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.3436 mb_mean=0.3087 norm_overlap=0.8941 corr_cb=-0.6583 topkJ=0.0000
[TRAIN][ep=023] loss=1.0467 acc=67.15%
[TRAIN][ep=023] mask_avg: mc_mean=0.3344 mb_mean=0.3015 norm_overlap=0.8815 corr_cb=-0.6658
[EPOCH 023/089] train: loss=1.0467 acc=67.15% | val: loss=0.6272 acc=67.74% f1=52.38% auc=64.33% val_score=87.9096 val_score_bestthr=93.2389 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.334, mb=0.301, no=0.882, corr=-0.666) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 87.9096
[DBG][ep=024] disease_pos_weight=1.0000 mode=none
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.3247 mb_mean=0.2995 norm_overlap=0.8660 corr_cb=-0.6883 topkJ=0.0000
[TRAIN][ep=024] loss=1.3087 acc=67.70%
[TRAIN][ep=024] mask_avg: mc_mean=0.3308 mb_mean=0.3015 norm_overlap=0.8708 corr_cb=-0.6805
[EPOCH 024/089] train: loss=1.3087 acc=67.70% | val: loss=0.6251 acc=66.13% f1=51.16% auc=65.89% val_score=83.1813 val_score_bestthr=91.0554 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.331, mb=0.301, no=0.871, corr=-0.681) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 83.1813
[DBG][ep=025] disease_pos_weight=1.0000 mode=none
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.3264 mb_mean=0.2973 norm_overlap=0.8346 corr_cb=-0.7259 topkJ=0.0000
[TRAIN][ep=025] loss=1.5744 acc=70.78%
[TRAIN][ep=025] mask_avg: mc_mean=0.3286 mb_mean=0.3015 norm_overlap=0.8646 corr_cb=-0.6894
[EPOCH 025/089] train: loss=1.5744 acc=70.78% | val: loss=0.6263 acc=67.74% f1=28.57% auc=64.44% val_score=84.5666 val_score_bestthr=81.4605 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.329, mb=0.301, no=0.865, corr=-0.689) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 84.5666
[DBG][ep=026] disease_pos_weight=1.0000 mode=none
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.3283 mb_mean=0.3015 norm_overlap=0.8371 corr_cb=-0.7494 topkJ=0.0000
[TRAIN][ep=026] loss=1.8383 acc=71.51%
[TRAIN][ep=026] mask_avg: mc_mean=0.3254 mb_mean=0.3015 norm_overlap=0.8556 corr_cb=-0.6996
[EPOCH 026/089] train: loss=1.8383 acc=71.51% | val: loss=0.6303 acc=67.74% f1=28.57% auc=63.66% val_score=81.8855 val_score_bestthr=81.4605 | dyn(w_pfs=0.240, w_sup=0.240, w_csuf=0.200, stage2=False) | mask(mc=0.325, mb=0.301, no=0.856, corr=-0.700) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 81.8855
[DBG][ep=027] disease_pos_weight=1.0000 mode=none
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.3206 mb_mean=0.2906 norm_overlap=0.8204 corr_cb=-0.7610 topkJ=0.0000
[TRAIN][ep=027] loss=1.9447 acc=73.14%
[TRAIN][ep=027] mask_avg: mc_mean=0.3230 mb_mean=0.3015 norm_overlap=0.8474 corr_cb=-0.7084
[EPOCH 027/089] train: loss=1.9447 acc=73.14% | val: loss=0.6297 acc=67.74% f1=33.33% auc=63.99% val_score=81.5407 val_score_bestthr=83.9489 | dyn(w_pfs=0.280, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.323, mb=0.301, no=0.847, corr=-0.708) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 81.5407
[DBG][ep=028] disease_pos_weight=1.0000 mode=none
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.3241 mb_mean=0.3066 norm_overlap=0.8688 corr_cb=-0.7008 topkJ=0.0000
[TRAIN][ep=028] loss=1.9658 acc=74.59%
[TRAIN][ep=028] mask_avg: mc_mean=0.3206 mb_mean=0.3015 norm_overlap=0.8402 corr_cb=-0.7169
[EPOCH 028/089] train: loss=1.9658 acc=74.59% | val: loss=0.6342 acc=67.74% f1=33.33% auc=62.43% val_score=82.8188 val_score_bestthr=83.9489 | dyn(w_pfs=0.180, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.321, mb=0.301, no=0.840, corr=-0.717) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 82.8188
[DBG][ep=029] disease_pos_weight=1.0000 mode=none
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.3262 mb_mean=0.3030 norm_overlap=0.8469 corr_cb=-0.7303 topkJ=0.0000
[TRAIN][ep=029] loss=1.2786 acc=73.87%
[TRAIN][ep=029] mask_avg: mc_mean=0.3178 mb_mean=0.3015 norm_overlap=0.8335 corr_cb=-0.7179
[EPOCH 029/089] train: loss=1.2786 acc=73.87% | val: loss=0.6349 acc=67.74% f1=33.33% auc=62.88% val_score=80.2804 val_score_bestthr=83.9489 | dyn(w_pfs=0.080, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.318, mb=0.301, no=0.833, corr=-0.718) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 80.2804
[DBG][ep=030] disease_pos_weight=1.0000 mode=none
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.3150 mb_mean=0.3005 norm_overlap=0.8099 corr_cb=-0.7634 topkJ=0.0000
[TRAIN][ep=030] loss=0.5950 acc=76.59%
[TRAIN][ep=030] mask_avg: mc_mean=0.3158 mb_mean=0.3015 norm_overlap=0.8279 corr_cb=-0.7221
[EPOCH 030/089] train: loss=0.5950 acc=76.59% | val: loss=0.6310 acc=67.74% f1=33.33% auc=63.10% val_score=80.2065 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.316, mb=0.301, no=0.828, corr=-0.722) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 80.2065
[DBG][ep=031] disease_pos_weight=1.0000 mode=none
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.3180 mb_mean=0.2975 norm_overlap=0.7926 corr_cb=-0.7600 topkJ=0.0000
[TRAIN][ep=031] loss=0.4331 acc=76.95%
[TRAIN][ep=031] mask_avg: mc_mean=0.3147 mb_mean=0.3015 norm_overlap=0.8245 corr_cb=-0.7252
[EPOCH 031/089] train: loss=0.4331 acc=76.95% | val: loss=0.6313 acc=67.74% f1=58.33% auc=63.10% val_score=79.5360 val_score_bestthr=95.5901 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.315, mb=0.301, no=0.825, corr=-0.725) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 79.5360
[DBG][ep=032] disease_pos_weight=1.0000 mode=none
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.3237 mb_mean=0.2890 norm_overlap=0.8104 corr_cb=-0.7559 topkJ=0.0000
[TRAIN][ep=032] loss=0.4299 acc=77.31%
[TRAIN][ep=032] mask_avg: mc_mean=0.3146 mb_mean=0.3015 norm_overlap=0.8247 corr_cb=-0.7247
[EPOCH 032/089] train: loss=0.4299 acc=77.31% | val: loss=0.6336 acc=67.74% f1=33.33% auc=62.54% val_score=87.0311 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.315, mb=0.301, no=0.825, corr=-0.725) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 87.0311
[DBG][ep=033] disease_pos_weight=1.0000 mode=none
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.3027 mb_mean=0.2933 norm_overlap=0.8430 corr_cb=-0.6577 topkJ=0.0000
[TRAIN][ep=033] loss=0.4277 acc=76.95%
[TRAIN][ep=033] mask_avg: mc_mean=0.3147 mb_mean=0.3015 norm_overlap=0.8246 corr_cb=-0.7250
[EPOCH 033/089] train: loss=0.4277 acc=76.95% | val: loss=0.6347 acc=67.74% f1=33.33% auc=62.76% val_score=89.0779 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.315, mb=0.301, no=0.825, corr=-0.725) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=034] disease_pos_weight=1.0000 mode=none
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.3134 mb_mean=0.2997 norm_overlap=0.8166 corr_cb=-0.6981 topkJ=0.0000
[TRAIN][ep=034] loss=0.4258 acc=77.68%
[TRAIN][ep=034] mask_avg: mc_mean=0.3146 mb_mean=0.3015 norm_overlap=0.8244 corr_cb=-0.7244
[EPOCH 034/089] train: loss=0.4258 acc=77.68% | val: loss=0.6331 acc=67.74% f1=33.33% auc=62.88% val_score=82.9406 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.315, mb=0.301, no=0.824, corr=-0.724) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 82.9406
[DBG][ep=035] disease_pos_weight=1.0000 mode=none
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.3030 mb_mean=0.3156 norm_overlap=0.8263 corr_cb=-0.7660 topkJ=0.0000
[TRAIN][ep=035] loss=0.4238 acc=77.86%
[TRAIN][ep=035] mask_avg: mc_mean=0.3147 mb_mean=0.3015 norm_overlap=0.8245 corr_cb=-0.7247
[EPOCH 035/089] train: loss=0.4238 acc=77.86% | val: loss=0.6345 acc=67.74% f1=33.33% auc=63.10% val_score=89.0779 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.315, mb=0.301, no=0.824, corr=-0.725) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=036] disease_pos_weight=1.0000 mode=none
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.3159 mb_mean=0.3095 norm_overlap=0.7950 corr_cb=-0.7914 topkJ=0.0000
[TRAIN][ep=036] loss=0.4219 acc=77.50%
[TRAIN][ep=036] mask_avg: mc_mean=0.3147 mb_mean=0.3015 norm_overlap=0.8246 corr_cb=-0.7263
[EPOCH 036/089] train: loss=0.4219 acc=77.50% | val: loss=0.6342 acc=67.74% f1=33.33% auc=62.76% val_score=82.9406 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.315, mb=0.301, no=0.825, corr=-0.726) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 82.9406
[DBG][ep=037] disease_pos_weight=1.0000 mode=none
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.3091 mb_mean=0.3067 norm_overlap=0.8584 corr_cb=-0.6057 topkJ=0.0000
[TRAIN][ep=037] loss=0.4199 acc=77.86%
[TRAIN][ep=037] mask_avg: mc_mean=0.3147 mb_mean=0.3015 norm_overlap=0.8245 corr_cb=-0.7240
[EPOCH 037/089] train: loss=0.4199 acc=77.86% | val: loss=0.6356 acc=67.74% f1=33.33% auc=62.54% val_score=87.0311 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.315, mb=0.301, no=0.825, corr=-0.724) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 87.0311
[DBG][ep=038] disease_pos_weight=1.0000 mode=none
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.3083 mb_mean=0.3020 norm_overlap=0.8281 corr_cb=-0.6634 topkJ=0.0000
[TRAIN][ep=038] loss=0.4179 acc=77.50%
[TRAIN][ep=038] mask_avg: mc_mean=0.3147 mb_mean=0.3015 norm_overlap=0.8245 corr_cb=-0.7254
[EPOCH 038/089] train: loss=0.4179 acc=77.50% | val: loss=0.6356 acc=67.74% f1=33.33% auc=62.54% val_score=83.6684 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.315, mb=0.301, no=0.824, corr=-0.725) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 83.6684
[DBG][ep=039] disease_pos_weight=1.0000 mode=none
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.3172 mb_mean=0.3036 norm_overlap=0.8208 corr_cb=-0.7414 topkJ=0.0000
[TRAIN][ep=039] loss=0.4159 acc=78.04%
[TRAIN][ep=039] mask_avg: mc_mean=0.3146 mb_mean=0.3015 norm_overlap=0.8246 corr_cb=-0.7249
[EPOCH 039/089] train: loss=0.4159 acc=78.04% | val: loss=0.6359 acc=67.74% f1=33.33% auc=62.65% val_score=82.9406 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.315, mb=0.301, no=0.825, corr=-0.725) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 82.9406
[DBG][ep=040] disease_pos_weight=1.0000 mode=none
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.3108 mb_mean=0.3069 norm_overlap=0.7828 corr_cb=-0.8063 topkJ=0.0000
[TRAIN][ep=040] loss=0.4148 acc=77.86%
[TRAIN][ep=040] mask_avg: mc_mean=0.3146 mb_mean=0.3015 norm_overlap=0.8248 corr_cb=-0.7219
[EPOCH 040/089] train: loss=0.4148 acc=77.86% | val: loss=0.6362 acc=67.74% f1=33.33% auc=62.76% val_score=82.9406 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.315, mb=0.301, no=0.825, corr=-0.722) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 82.9406
[DBG][ep=041] disease_pos_weight=1.0000 mode=none
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.3069 mb_mean=0.2969 norm_overlap=0.8337 corr_cb=-0.6659 topkJ=0.0000
[TRAIN][ep=041] loss=0.4127 acc=78.04%
[TRAIN][ep=041] mask_avg: mc_mean=0.3147 mb_mean=0.3015 norm_overlap=0.8247 corr_cb=-0.7241
[EPOCH 041/089] train: loss=0.4127 acc=78.04% | val: loss=0.6373 acc=67.74% f1=33.33% auc=62.43% val_score=87.0311 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.315, mb=0.301, no=0.825, corr=-0.724) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 87.0311
[DBG][ep=042] disease_pos_weight=1.0000 mode=none
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.3149 mb_mean=0.3030 norm_overlap=0.8244 corr_cb=-0.7504 topkJ=0.0000
[TRAIN][ep=042] loss=0.4114 acc=78.22%
[TRAIN][ep=042] mask_avg: mc_mean=0.3146 mb_mean=0.3015 norm_overlap=0.8244 corr_cb=-0.7248
[EPOCH 042/089] train: loss=0.4114 acc=78.22% | val: loss=0.6376 acc=67.74% f1=33.33% auc=62.54% val_score=85.0042 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.315, mb=0.301, no=0.824, corr=-0.725) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 85.0042
[DBG][ep=043] disease_pos_weight=1.0000 mode=none
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.3260 mb_mean=0.2905 norm_overlap=0.7746 corr_cb=-0.7937 topkJ=0.0000
[TRAIN][ep=043] loss=0.4091 acc=78.40%
[TRAIN][ep=043] mask_avg: mc_mean=0.3146 mb_mean=0.3015 norm_overlap=0.8246 corr_cb=-0.7251
[EPOCH 043/089] train: loss=0.4091 acc=78.40% | val: loss=0.6383 acc=67.74% f1=33.33% auc=62.54% val_score=87.0311 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.315, mb=0.301, no=0.825, corr=-0.725) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 87.0311
[DBG][ep=044] disease_pos_weight=1.0000 mode=none
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.3220 mb_mean=0.2948 norm_overlap=0.7973 corr_cb=-0.7855 topkJ=0.0000
[TRAIN][ep=044] loss=0.4071 acc=78.40%
[TRAIN][ep=044] mask_avg: mc_mean=0.3146 mb_mean=0.3015 norm_overlap=0.8248 corr_cb=-0.7241
[EPOCH 044/089] train: loss=0.4071 acc=78.40% | val: loss=0.6382 acc=67.74% f1=33.33% auc=62.54% val_score=80.7554 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.315, mb=0.301, no=0.825, corr=-0.724) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 80.7554
[DBG][ep=045] disease_pos_weight=1.0000 mode=none
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.3210 mb_mean=0.2796 norm_overlap=0.7604 corr_cb=-0.7741 topkJ=0.0000
[TRAIN][ep=045] loss=0.4060 acc=78.58%
[TRAIN][ep=045] mask_avg: mc_mean=0.3146 mb_mean=0.3015 norm_overlap=0.8246 corr_cb=-0.7244
[EPOCH 045/089] train: loss=0.4060 acc=78.58% | val: loss=0.6400 acc=67.74% f1=33.33% auc=62.54% val_score=87.0311 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.315, mb=0.301, no=0.825, corr=-0.724) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 87.0311
[DBG][ep=046] disease_pos_weight=1.0000 mode=none
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.3036 mb_mean=0.3173 norm_overlap=0.8263 corr_cb=-0.7880 topkJ=0.0000
[TRAIN][ep=046] loss=0.4045 acc=78.77%
[TRAIN][ep=046] mask_avg: mc_mean=0.3146 mb_mean=0.3015 norm_overlap=0.8246 corr_cb=-0.7251
[EPOCH 046/089] train: loss=0.4045 acc=78.77% | val: loss=0.6406 acc=67.74% f1=33.33% auc=62.32% val_score=87.0311 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.315, mb=0.301, no=0.825, corr=-0.725) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 87.0311
[DBG][ep=047] disease_pos_weight=1.0000 mode=none
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.3203 mb_mean=0.3100 norm_overlap=0.8624 corr_cb=-0.7046 topkJ=0.0000
[TRAIN][ep=047] loss=0.4023 acc=78.22%
[TRAIN][ep=047] mask_avg: mc_mean=0.3146 mb_mean=0.3015 norm_overlap=0.8247 corr_cb=-0.7253
[EPOCH 047/089] train: loss=0.4023 acc=78.22% | val: loss=0.6404 acc=67.74% f1=33.33% auc=62.32% val_score=80.7554 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.315, mb=0.301, no=0.825, corr=-0.725) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 80.7554
[DBG][ep=048] disease_pos_weight=1.0000 mode=none
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.3189 mb_mean=0.2998 norm_overlap=0.8230 corr_cb=-0.7291 topkJ=0.0000
[TRAIN][ep=048] loss=0.4009 acc=78.58%
[TRAIN][ep=048] mask_avg: mc_mean=0.3146 mb_mean=0.3015 norm_overlap=0.8246 corr_cb=-0.7245
[EPOCH 048/089] train: loss=0.4009 acc=78.58% | val: loss=0.6408 acc=67.74% f1=33.33% auc=62.21% val_score=80.7554 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.315, mb=0.302, no=0.825, corr=-0.724) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 80.7554
[DBG][ep=049] disease_pos_weight=1.0000 mode=none
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.3068 mb_mean=0.3023 norm_overlap=0.8353 corr_cb=-0.6912 topkJ=0.0000
[TRAIN][ep=049] loss=0.3987 acc=79.13%
[TRAIN][ep=049] mask_avg: mc_mean=0.3146 mb_mean=0.3015 norm_overlap=0.8244 corr_cb=-0.7258
[EPOCH 049/089] train: loss=0.3987 acc=79.13% | val: loss=0.6430 acc=67.74% f1=33.33% auc=62.54% val_score=87.0311 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.315, mb=0.301, no=0.824, corr=-0.726) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 87.0311
[DBG][ep=050] disease_pos_weight=1.0000 mode=none
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.3110 mb_mean=0.3183 norm_overlap=0.8416 corr_cb=-0.7432 topkJ=0.0000
[TRAIN][ep=050] loss=0.3979 acc=79.49%
[TRAIN][ep=050] mask_avg: mc_mean=0.3147 mb_mean=0.3015 norm_overlap=0.8243 corr_cb=-0.7249
[EPOCH 050/089] train: loss=0.3979 acc=79.49% | val: loss=0.6443 acc=67.74% f1=33.33% auc=62.43% val_score=87.0311 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.315, mb=0.301, no=0.824, corr=-0.725) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 87.0311
[EARLY STOP] no improvement for 30 epochs. best_epoch=20
[CKPT] Loaded best for testing: results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
=============== FIT DONE ===============
[BEST] epoch=20 | val_acc=67.74% | val_f1=33.33% | val_auc=64.77% | val_score=90.0707 | val_score_bestthr=83.4349
[TEST@BEST] thr_used=0.400 | acc=63.64% f1=42.86% auc=59.58% | SP_sex=4.93% EO_sex=0.00% SP_age=26.25% EO_age=58.82%
[TIME] 0.90 min
[OK] Saved: results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/summary_fold_0.json
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5236 mb_mean=0.5061 norm_overlap=0.9998 corr_cb=-0.1913 topkJ=0.0225
[TRAIN][ep=000] loss=0.6926 acc=51.91%
[TRAIN][ep=000] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2677
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5223 mb_mean=0.5043 norm_overlap=0.9995 corr_cb=-0.3398 topkJ=0.0124
[TRAIN][ep=001] loss=0.6752 acc=63.70%
[TRAIN][ep=001] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2716
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5214 mb_mean=0.5039 norm_overlap=0.9998 corr_cb=-0.1603 topkJ=0.0315
[TRAIN][ep=002] loss=0.6633 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2709
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5198 mb_mean=0.5045 norm_overlap=0.9997 corr_cb=-0.2413 topkJ=0.0174
[TRAIN][ep=003] loss=0.6578 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2654
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5237 mb_mean=0.5050 norm_overlap=0.9997 corr_cb=-0.2572 topkJ=0.0114
[TRAIN][ep=004] loss=0.6554 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2685
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5214 mb_mean=0.5050 norm_overlap=0.9997 corr_cb=-0.2780 topkJ=0.0280
[TRAIN][ep=005] loss=0.6542 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2701
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5217 mb_mean=0.5043 norm_overlap=0.9997 corr_cb=-0.2886 topkJ=0.0135
[TRAIN][ep=006] loss=0.6538 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2669
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5184 mb_mean=0.5067 norm_overlap=0.9997 corr_cb=-0.3329 topkJ=0.0218
[TRAIN][ep=007] loss=0.6520 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2713
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5223 mb_mean=0.5062 norm_overlap=0.9996 corr_cb=-0.3736 topkJ=0.0062
[TRAIN][ep=008] loss=0.6517 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2684
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5215 mb_mean=0.5068 norm_overlap=0.9997 corr_cb=-0.2734 topkJ=0.0259
[TRAIN][ep=009] loss=0.6500 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2687
================= FIT START (fold=0) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.35 select_by=val_score | eval_thr_mode=best_acc eval_thr_grid=coarse | disease_pos_weight_mode=none freeze_b_after=15 | two_stage=True stage1_ratio=0.35 stage2_lr_mult=0.3 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5235 mb_mean=0.5056 norm_overlap=0.9996 corr_cb=-0.2652 topkJ=0.0979
[TRAIN][ep=000] loss=0.6488 acc=63.70%
[TRAIN][ep=000] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2687
[EPOCH 000/089] train: loss=0.6488 acc=63.70% | val: loss=0.6590 acc=62.90% f1=0.00% auc=49.28% val_score=64.2297 val_score_bestthr=62.9032 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.521, mb=0.506, no=1.000, corr=-0.269) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* -1000000000000000000.0000 -> 64.2297
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5221 mb_mean=0.5070 norm_overlap=0.9998 corr_cb=-0.2391 topkJ=0.0404
[TRAIN][ep=001] loss=0.6469 acc=63.70%
[TRAIN][ep=001] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2684
[EPOCH 001/089] train: loss=0.6469 acc=63.70% | val: loss=0.6577 acc=62.90% f1=0.00% auc=51.28% val_score=67.4541 val_score_bestthr=62.9032 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.521, mb=0.506, no=1.000, corr=-0.268) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 64.2297 -> 67.4541
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5187 mb_mean=0.5040 norm_overlap=0.9998 corr_cb=-0.2618 topkJ=0.0162
[TRAIN][ep=002] loss=0.6457 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2713
[EPOCH 002/089] train: loss=0.6457 acc=63.70% | val: loss=0.6570 acc=62.90% f1=14.81% auc=51.84% val_score=64.2297 val_score_bestthr=69.7231 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.521, mb=0.506, no=1.000, corr=-0.271) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 67.4541 -> 64.2297
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5199 mb_mean=0.5065 norm_overlap=0.9998 corr_cb=-0.2547 topkJ=0.0454
[TRAIN][ep=003] loss=0.6442 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2668
[EPOCH 003/089] train: loss=0.6442 acc=63.70% | val: loss=0.6557 acc=62.90% f1=14.81% auc=52.73% val_score=66.7750 val_score_bestthr=69.7231 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.521, mb=0.506, no=1.000, corr=-0.267) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 67.4541 -> 66.7750
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5227 mb_mean=0.5044 norm_overlap=0.9996 corr_cb=-0.3527 topkJ=0.0157
[TRAIN][ep=004] loss=0.6434 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2700
[EPOCH 004/089] train: loss=0.6434 acc=63.70% | val: loss=0.6545 acc=64.52% f1=8.33% auc=54.07% val_score=66.7750 val_score_bestthr=68.1795 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.521, mb=0.506, no=1.000, corr=-0.270) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 67.4541 -> 66.7750
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5208 mb_mean=0.5063 norm_overlap=0.9997 corr_cb=-0.2071 topkJ=0.0176
[TRAIN][ep=005] loss=2.2384 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.5147 mb_mean=0.4947 norm_overlap=0.9998 corr_cb=-0.1618
[EPOCH 005/089] train: loss=2.2384 acc=63.70% | val: loss=0.6549 acc=62.90% f1=20.69% auc=54.63% val_score=75.5211 val_score_bestthr=72.4762 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.515, mb=0.495, no=1.000, corr=-0.162) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 67.4541 -> 75.5211
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5084 mb_mean=0.4851 norm_overlap=0.9997 corr_cb=-0.1720 topkJ=0.0362
[TRAIN][ep=006] loss=2.2435 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.5010 mb_mean=0.4723 norm_overlap=1.0000 corr_cb=-0.0370
[EPOCH 006/089] train: loss=2.2435 acc=63.70% | val: loss=0.6537 acc=64.52% f1=21.43% auc=55.85% val_score=76.2980 val_score_bestthr=74.3752 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.501, mb=0.472, no=1.000, corr=-0.037) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 75.5211 -> 76.2980
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4934 mb_mean=0.4606 norm_overlap=1.0000 corr_cb=-0.0079 topkJ=0.0277
[TRAIN][ep=007] loss=2.2423 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.4875 mb_mean=0.4485 norm_overlap=1.0003 corr_cb=0.0525
[EPOCH 007/089] train: loss=2.2423 acc=63.70% | val: loss=0.6522 acc=64.52% f1=26.67% auc=56.52% val_score=67.1224 val_score_bestthr=76.6882 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.487, mb=0.449, no=1.000, corr=0.052) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.2980 -> 67.1224
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4818 mb_mean=0.4372 norm_overlap=0.9993 corr_cb=-0.1276 topkJ=0.0237
[TRAIN][ep=008] loss=2.2323 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.4742 mb_mean=0.4241 norm_overlap=1.0013 corr_cb=0.1386
[EPOCH 008/089] train: loss=2.2323 acc=63.70% | val: loss=0.6516 acc=66.13% f1=27.59% auc=57.64% val_score=82.6406 val_score_bestthr=78.8618 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.474, mb=0.424, no=1.001, corr=0.139) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 76.2980 -> 82.6406
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4667 mb_mean=0.4206 norm_overlap=1.0013 corr_cb=0.1449 topkJ=0.0967
[TRAIN][ep=009] loss=2.2299 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.4613 mb_mean=0.3994 norm_overlap=1.0017 corr_cb=0.1202
[EPOCH 009/089] train: loss=2.2299 acc=63.70% | val: loss=0.6508 acc=64.52% f1=31.25% auc=58.64% val_score=78.5338 val_score_bestthr=79.3442 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.461, mb=0.399, no=1.002, corr=0.120) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 82.6406 -> 78.5338
[DBG][ep=010] disease_pos_weight=1.0000 mode=none
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.4567 mb_mean=0.3854 norm_overlap=1.0010 corr_cb=0.0682 topkJ=0.0511
[TRAIN][ep=010] loss=2.2206 acc=63.70%
[TRAIN][ep=010] mask_avg: mc_mean=0.4488 mb_mean=0.3761 norm_overlap=1.0012 corr_cb=0.0547
[EPOCH 010/089] train: loss=2.2206 acc=63.70% | val: loss=0.6488 acc=67.74% f1=23.08% auc=59.20% val_score=70.3872 val_score_bestthr=78.5401 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.449, mb=0.376, no=1.001, corr=0.055) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 82.6406 -> 70.3872
[DBG][ep=011] disease_pos_weight=1.0000 mode=none
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.4472 mb_mean=0.3638 norm_overlap=0.9999 corr_cb=-0.0062 topkJ=0.0251
[TRAIN][ep=011] loss=2.2145 acc=63.70%
[TRAIN][ep=011] mask_avg: mc_mean=0.4370 mb_mean=0.3548 norm_overlap=0.9996 corr_cb=-0.0173
[EPOCH 011/089] train: loss=2.2145 acc=63.70% | val: loss=0.6474 acc=67.74% f1=23.08% auc=60.09% val_score=74.5015 val_score_bestthr=78.5401 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.437, mb=0.355, no=1.000, corr=-0.017) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 82.6406 -> 74.5015
[DBG][ep=012] disease_pos_weight=1.0000 mode=none
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.4234 mb_mean=0.3280 norm_overlap=1.0021 corr_cb=0.0469 topkJ=0.0606
[TRAIN][ep=012] loss=2.2104 acc=63.70%
[TRAIN][ep=012] mask_avg: mc_mean=0.4249 mb_mean=0.3362 norm_overlap=0.9954 corr_cb=-0.1193
[EPOCH 012/089] train: loss=2.2104 acc=63.70% | val: loss=0.6465 acc=67.74% f1=23.08% auc=61.20% val_score=81.6778 val_score_bestthr=78.5401 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.425, mb=0.336, no=0.995, corr=-0.119) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 82.6406 -> 81.6778
[DBG][ep=013] disease_pos_weight=1.0000 mode=none
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.4238 mb_mean=0.3327 norm_overlap=0.9893 corr_cb=-0.2639 topkJ=0.0236
[TRAIN][ep=013] loss=2.1995 acc=63.70%
[TRAIN][ep=013] mask_avg: mc_mean=0.4148 mb_mean=0.3197 norm_overlap=0.9873 corr_cb=-0.2525
[EPOCH 013/089] train: loss=2.1995 acc=63.70% | val: loss=0.6446 acc=67.74% f1=23.08% auc=62.32% val_score=77.8847 val_score_bestthr=78.5401 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.415, mb=0.320, no=0.987, corr=-0.253) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 82.6406 -> 77.8847
[DBG][ep=014] disease_pos_weight=1.0000 mode=none
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.4041 mb_mean=0.3044 norm_overlap=0.9689 corr_cb=-0.4858 topkJ=0.0065
[TRAIN][ep=014] loss=2.1976 acc=63.52%
[TRAIN][ep=014] mask_avg: mc_mean=0.4043 mb_mean=0.3060 norm_overlap=0.9747 corr_cb=-0.3731
[EPOCH 014/089] train: loss=2.1976 acc=63.52% | val: loss=0.6439 acc=67.74% f1=41.18% auc=61.32% val_score=80.9022 val_score_bestthr=87.6773 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.404, mb=0.306, no=0.975, corr=-0.373) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 82.6406 -> 80.9022
[DBG][ep=015] disease_pos_weight=1.0000 mode=none
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.4001 mb_mean=0.2978 norm_overlap=0.9798 corr_cb=-0.2417 topkJ=0.0221
[TRAIN][ep=015] loss=2.1894 acc=63.70%
[TRAIN][ep=015] mask_avg: mc_mean=0.3934 mb_mean=0.3007 norm_overlap=0.9631 corr_cb=-0.4420
[EPOCH 015/089] train: loss=2.1894 acc=63.70% | val: loss=0.6405 acc=67.74% f1=23.08% auc=62.88% val_score=82.9035 val_score_bestthr=78.5401 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.393, mb=0.301, no=0.963, corr=-0.442) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=* 82.6406 -> 82.9035
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=016] disease_pos_weight=1.0000 mode=none
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.3877 mb_mean=0.2949 norm_overlap=0.9611 corr_cb=-0.4086 topkJ=0.0139
[TRAIN][ep=016] loss=2.1818 acc=63.52%
[TRAIN][ep=016] mask_avg: mc_mean=0.3849 mb_mean=0.3007 norm_overlap=0.9555 corr_cb=-0.4759
[EPOCH 016/089] train: loss=2.1818 acc=63.52% | val: loss=0.6408 acc=67.74% f1=23.08% auc=62.99% val_score=87.2586 val_score_bestthr=78.5401 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.385, mb=0.301, no=0.956, corr=-0.476) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=* 82.9035 -> 87.2586
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=017] disease_pos_weight=1.0000 mode=none
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.3870 mb_mean=0.3132 norm_overlap=0.9538 corr_cb=-0.5352 topkJ=0.0012
[TRAIN][ep=017] loss=2.1752 acc=63.70%
[TRAIN][ep=017] mask_avg: mc_mean=0.3761 mb_mean=0.3007 norm_overlap=0.9465 corr_cb=-0.5110
[EPOCH 017/089] train: loss=2.1752 acc=63.70% | val: loss=0.6376 acc=67.74% f1=23.08% auc=63.55% val_score=88.6660 val_score_bestthr=78.5401 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.376, mb=0.301, no=0.946, corr=-0.511) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=* 87.2586 -> 88.6660
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=018] disease_pos_weight=1.0000 mode=none
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.3784 mb_mean=0.2953 norm_overlap=0.9470 corr_cb=-0.5069 topkJ=0.0017
[TRAIN][ep=018] loss=2.1714 acc=64.07%
[TRAIN][ep=018] mask_avg: mc_mean=0.3697 mb_mean=0.3007 norm_overlap=0.9399 corr_cb=-0.5352
[EPOCH 018/089] train: loss=2.1714 acc=64.07% | val: loss=0.6372 acc=67.74% f1=23.08% auc=63.10% val_score=80.3438 val_score_bestthr=78.5401 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.370, mb=0.301, no=0.940, corr=-0.535) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 88.6660 -> 80.3438
[DBG][ep=019] disease_pos_weight=1.0000 mode=none
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.3730 mb_mean=0.2953 norm_overlap=0.9354 corr_cb=-0.5561 topkJ=0.0004
[TRAIN][ep=019] loss=2.1630 acc=64.79%
[TRAIN][ep=019] mask_avg: mc_mean=0.3639 mb_mean=0.3007 norm_overlap=0.9330 corr_cb=-0.5560
[EPOCH 019/089] train: loss=2.1630 acc=64.79% | val: loss=0.6349 acc=67.74% f1=23.08% auc=64.21% val_score=85.8087 val_score_bestthr=78.5401 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.364, mb=0.301, no=0.933, corr=-0.556) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 88.6660 -> 85.8087
[DBG][ep=020] disease_pos_weight=1.0000 mode=none
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.3680 mb_mean=0.2986 norm_overlap=0.9512 corr_cb=-0.4338 topkJ=0.0008
[TRAIN][ep=020] loss=1.4370 acc=64.97%
[TRAIN][ep=020] mask_avg: mc_mean=0.3571 mb_mean=0.3007 norm_overlap=0.9244 corr_cb=-0.5744
[EPOCH 020/089] train: loss=1.4370 acc=64.97% | val: loss=0.6325 acc=67.74% f1=23.08% auc=64.77% val_score=87.9096 val_score_bestthr=78.5401 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.357, mb=0.301, no=0.924, corr=-0.574) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 88.6660 -> 87.9096
[DBG][ep=021] disease_pos_weight=1.0000 mode=none
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.3564 mb_mean=0.2967 norm_overlap=0.9295 corr_cb=-0.5019 topkJ=0.0000
[TRAIN][ep=021] loss=0.7153 acc=67.15%
[TRAIN][ep=021] mask_avg: mc_mean=0.3513 mb_mean=0.3007 norm_overlap=0.9162 corr_cb=-0.5919
[EPOCH 021/089] train: loss=0.7153 acc=67.15% | val: loss=0.6302 acc=67.74% f1=41.18% auc=64.55% val_score=90.0707 val_score_bestthr=87.7082 | dyn(w_pfs=0.190, w_sup=0.090, w_csuf=0.040, stage2=False) | mask(mc=0.351, mb=0.301, no=0.916, corr=-0.592) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=* 88.6660 -> 90.0707
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=022] disease_pos_weight=1.0000 mode=none
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.3363 mb_mean=0.2982 norm_overlap=0.8957 corr_cb=-0.6478 topkJ=0.0000
[TRAIN][ep=022] loss=0.9906 acc=66.42%
[TRAIN][ep=022] mask_avg: mc_mean=0.3445 mb_mean=0.3007 norm_overlap=0.9048 corr_cb=-0.6124
[EPOCH 022/089] train: loss=0.9906 acc=66.42% | val: loss=0.6275 acc=67.74% f1=41.18% auc=66.11% val_score=78.0773 val_score_bestthr=87.7082 | dyn(w_pfs=0.230, w_sup=0.130, w_csuf=0.080, stage2=False) | mask(mc=0.345, mb=0.301, no=0.905, corr=-0.612) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 78.0773
[DBG][ep=023] disease_pos_weight=1.0000 mode=none
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.3510 mb_mean=0.3082 norm_overlap=0.9083 corr_cb=-0.6234 topkJ=0.0000
[TRAIN][ep=023] loss=1.2740 acc=68.42%
[TRAIN][ep=023] mask_avg: mc_mean=0.3416 mb_mean=0.3007 norm_overlap=0.8995 corr_cb=-0.6252
[EPOCH 023/089] train: loss=1.2740 acc=68.42% | val: loss=0.6270 acc=66.13% f1=51.16% auc=64.44% val_score=87.9096 val_score_bestthr=90.9891 | dyn(w_pfs=0.270, w_sup=0.170, w_csuf=0.120, stage2=False) | mask(mc=0.342, mb=0.301, no=0.900, corr=-0.625) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 87.9096
[DBG][ep=024] disease_pos_weight=1.0000 mode=none
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.3318 mb_mean=0.2985 norm_overlap=0.8858 corr_cb=-0.6493 topkJ=0.0000
[TRAIN][ep=024] loss=1.5466 acc=68.78%
[TRAIN][ep=024] mask_avg: mc_mean=0.3370 mb_mean=0.3007 norm_overlap=0.8899 corr_cb=-0.6393
[EPOCH 024/089] train: loss=1.5466 acc=68.78% | val: loss=0.6250 acc=66.13% f1=51.16% auc=65.77% val_score=81.1574 val_score_bestthr=91.0554 | dyn(w_pfs=0.310, w_sup=0.210, w_csuf=0.160, stage2=False) | mask(mc=0.337, mb=0.301, no=0.890, corr=-0.639) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 81.1574
[DBG][ep=025] disease_pos_weight=1.0000 mode=none
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.3317 mb_mean=0.2964 norm_overlap=0.8569 corr_cb=-0.6898 topkJ=0.0000
[TRAIN][ep=025] loss=1.8234 acc=72.05%
[TRAIN][ep=025] mask_avg: mc_mean=0.3343 mb_mean=0.3007 norm_overlap=0.8844 corr_cb=-0.6477
[EPOCH 025/089] train: loss=1.8234 acc=72.05% | val: loss=0.6259 acc=66.13% f1=36.36% auc=64.55% val_score=86.6635 val_score_bestthr=83.7060 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.334, mb=0.301, no=0.884, corr=-0.648) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 86.6635
[DBG][ep=026] disease_pos_weight=1.0000 mode=none
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.3331 mb_mean=0.3008 norm_overlap=0.8576 corr_cb=-0.7139 topkJ=0.0000
[TRAIN][ep=026] loss=2.0986 acc=72.41%
[TRAIN][ep=026] mask_avg: mc_mean=0.3305 mb_mean=0.3007 norm_overlap=0.8762 corr_cb=-0.6581
[EPOCH 026/089] train: loss=2.0986 acc=72.41% | val: loss=0.6298 acc=67.74% f1=33.33% auc=63.32% val_score=81.8855 val_score_bestthr=83.9489 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.331, mb=0.301, no=0.876, corr=-0.658) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 81.8855
[DBG][ep=027] disease_pos_weight=1.0000 mode=none
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.3252 mb_mean=0.2898 norm_overlap=0.8433 corr_cb=-0.7259 topkJ=0.0000
[TRAIN][ep=027] loss=2.0834 acc=74.41%
[TRAIN][ep=027] mask_avg: mc_mean=0.3276 mb_mean=0.3007 norm_overlap=0.8685 corr_cb=-0.6671
[EPOCH 027/089] train: loss=2.0834 acc=74.41% | val: loss=0.6291 acc=67.74% f1=33.33% auc=63.77% val_score=79.5125 val_score_bestthr=83.9489 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.328, mb=0.301, no=0.869, corr=-0.667) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 79.5125
[DBG][ep=028] disease_pos_weight=1.0000 mode=none
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.3291 mb_mean=0.3060 norm_overlap=0.8873 corr_cb=-0.6581 topkJ=0.0000
[TRAIN][ep=028] loss=2.0714 acc=75.50%
[TRAIN][ep=028] mask_avg: mc_mean=0.3250 mb_mean=0.3007 norm_overlap=0.8618 corr_cb=-0.6761
[EPOCH 028/089] train: loss=2.0714 acc=75.50% | val: loss=0.6339 acc=67.74% f1=33.33% auc=62.43% val_score=89.0779 val_score_bestthr=83.9489 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.325, mb=0.301, no=0.862, corr=-0.676) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=029] disease_pos_weight=1.0000 mode=none
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.3303 mb_mean=0.3023 norm_overlap=0.8683 corr_cb=-0.6891 topkJ=0.0000
[TRAIN][ep=029] loss=2.0626 acc=74.59%
[TRAIN][ep=029] mask_avg: mc_mean=0.3218 mb_mean=0.3007 norm_overlap=0.8555 corr_cb=-0.6765
[EPOCH 029/089] train: loss=2.0626 acc=74.59% | val: loss=0.6361 acc=67.74% f1=33.33% auc=62.65% val_score=80.2804 val_score_bestthr=83.9489 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.322, mb=0.301, no=0.855, corr=-0.676) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 80.2804
[DBG][ep=030] disease_pos_weight=1.0000 mode=none
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.3187 mb_mean=0.2996 norm_overlap=0.8345 corr_cb=-0.7252 topkJ=0.0000
[TRAIN][ep=030] loss=1.3517 acc=77.86%
[TRAIN][ep=030] mask_avg: mc_mean=0.3199 mb_mean=0.3007 norm_overlap=0.8510 corr_cb=-0.6801
[EPOCH 030/089] train: loss=1.3517 acc=77.86% | val: loss=0.6340 acc=67.74% f1=33.33% auc=62.88% val_score=80.2065 val_score_bestthr=83.9489 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.320, mb=0.301, no=0.851, corr=-0.680) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 80.2065
[DBG][ep=031] disease_pos_weight=1.0000 mode=none
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.3208 mb_mean=0.2968 norm_overlap=0.8181 corr_cb=-0.7217 topkJ=0.0000
[TRAIN][ep=031] loss=0.4850 acc=78.04%
[TRAIN][ep=031] mask_avg: mc_mean=0.3187 mb_mean=0.3007 norm_overlap=0.8481 corr_cb=-0.6835
[EPOCH 031/089] train: loss=0.4850 acc=78.04% | val: loss=0.6343 acc=67.74% f1=33.33% auc=62.65% val_score=82.2991 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.319, mb=0.301, no=0.848, corr=-0.684) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 82.2991
[DBG][ep=032] disease_pos_weight=1.0000 mode=none
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.3275 mb_mean=0.2884 norm_overlap=0.8345 corr_cb=-0.7190 topkJ=0.0000
[TRAIN][ep=032] loss=0.4273 acc=77.68%
[TRAIN][ep=032] mask_avg: mc_mean=0.3187 mb_mean=0.3007 norm_overlap=0.8482 corr_cb=-0.6828
[EPOCH 032/089] train: loss=0.4273 acc=77.68% | val: loss=0.6363 acc=67.74% f1=33.33% auc=62.54% val_score=84.9487 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.319, mb=0.301, no=0.848, corr=-0.683) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 84.9487
[DBG][ep=033] disease_pos_weight=1.0000 mode=none
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.3084 mb_mean=0.2926 norm_overlap=0.8613 corr_cb=-0.6229 topkJ=0.0000
[TRAIN][ep=033] loss=0.4252 acc=77.86%
[TRAIN][ep=033] mask_avg: mc_mean=0.3187 mb_mean=0.3007 norm_overlap=0.8481 corr_cb=-0.6832
[EPOCH 033/089] train: loss=0.4252 acc=77.86% | val: loss=0.6375 acc=67.74% f1=33.33% auc=62.43% val_score=87.0311 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.319, mb=0.301, no=0.848, corr=-0.683) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 87.0311
[DBG][ep=034] disease_pos_weight=1.0000 mode=none
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.3172 mb_mean=0.2987 norm_overlap=0.8439 corr_cb=-0.6502 topkJ=0.0000
[TRAIN][ep=034] loss=0.4234 acc=77.86%
[TRAIN][ep=034] mask_avg: mc_mean=0.3187 mb_mean=0.3007 norm_overlap=0.8479 corr_cb=-0.6828
[EPOCH 034/089] train: loss=0.4234 acc=77.86% | val: loss=0.6358 acc=67.74% f1=33.33% auc=62.32% val_score=83.6684 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.319, mb=0.301, no=0.848, corr=-0.683) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 83.6684
[DBG][ep=035] disease_pos_weight=1.0000 mode=none
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.3085 mb_mean=0.3147 norm_overlap=0.8478 corr_cb=-0.7313 topkJ=0.0000
[TRAIN][ep=035] loss=0.4214 acc=78.04%
[TRAIN][ep=035] mask_avg: mc_mean=0.3187 mb_mean=0.3007 norm_overlap=0.8479 corr_cb=-0.6831
[EPOCH 035/089] train: loss=0.4214 acc=78.04% | val: loss=0.6372 acc=67.74% f1=33.33% auc=62.65% val_score=87.0311 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.319, mb=0.301, no=0.848, corr=-0.683) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 87.0311
[DBG][ep=036] disease_pos_weight=1.0000 mode=none
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.3193 mb_mean=0.3088 norm_overlap=0.8195 corr_cb=-0.7578 topkJ=0.0000
[TRAIN][ep=036] loss=0.4196 acc=78.04%
[TRAIN][ep=036] mask_avg: mc_mean=0.3187 mb_mean=0.3007 norm_overlap=0.8481 corr_cb=-0.6846
[EPOCH 036/089] train: loss=0.4196 acc=78.04% | val: loss=0.6369 acc=67.74% f1=33.33% auc=62.21% val_score=83.6684 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.319, mb=0.301, no=0.848, corr=-0.685) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 83.6684
[DBG][ep=037] disease_pos_weight=1.0000 mode=none
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.3134 mb_mean=0.3061 norm_overlap=0.8788 corr_cb=-0.5593 topkJ=0.0000
[TRAIN][ep=037] loss=0.4176 acc=78.58%
[TRAIN][ep=037] mask_avg: mc_mean=0.3187 mb_mean=0.3007 norm_overlap=0.8480 corr_cb=-0.6823
[EPOCH 037/089] train: loss=0.4176 acc=78.58% | val: loss=0.6381 acc=67.74% f1=33.33% auc=62.21% val_score=84.9487 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.319, mb=0.301, no=0.848, corr=-0.682) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 84.9487
[DBG][ep=038] disease_pos_weight=1.0000 mode=none
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.3115 mb_mean=0.3012 norm_overlap=0.8514 corr_cb=-0.6162 topkJ=0.0000
[TRAIN][ep=038] loss=0.4156 acc=78.40%
[TRAIN][ep=038] mask_avg: mc_mean=0.3187 mb_mean=0.3007 norm_overlap=0.8480 corr_cb=-0.6836
[EPOCH 038/089] train: loss=0.4156 acc=78.40% | val: loss=0.6381 acc=67.74% f1=33.33% auc=61.98% val_score=83.6684 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.319, mb=0.301, no=0.848, corr=-0.684) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 83.6684
[DBG][ep=039] disease_pos_weight=1.0000 mode=none
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.3210 mb_mean=0.3030 norm_overlap=0.8424 corr_cb=-0.7056 topkJ=0.0000
[TRAIN][ep=039] loss=0.4137 acc=78.40%
[TRAIN][ep=039] mask_avg: mc_mean=0.3187 mb_mean=0.3007 norm_overlap=0.8481 corr_cb=-0.6831
[EPOCH 039/089] train: loss=0.4137 acc=78.40% | val: loss=0.6384 acc=67.74% f1=33.33% auc=62.10% val_score=80.7554 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.319, mb=0.301, no=0.848, corr=-0.683) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 80.7554
[DBG][ep=040] disease_pos_weight=1.0000 mode=none
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.3144 mb_mean=0.3061 norm_overlap=0.8070 corr_cb=-0.7755 topkJ=0.0000
[TRAIN][ep=040] loss=0.4126 acc=78.58%
[TRAIN][ep=040] mask_avg: mc_mean=0.3187 mb_mean=0.3007 norm_overlap=0.8483 corr_cb=-0.6802
[EPOCH 040/089] train: loss=0.4126 acc=78.58% | val: loss=0.6387 acc=67.74% f1=33.33% auc=61.98% val_score=83.6684 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.319, mb=0.301, no=0.848, corr=-0.680) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 83.6684
[DBG][ep=041] disease_pos_weight=1.0000 mode=none
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.3113 mb_mean=0.2959 norm_overlap=0.8570 corr_cb=-0.6188 topkJ=0.0000
[TRAIN][ep=041] loss=0.4104 acc=78.58%
[TRAIN][ep=041] mask_avg: mc_mean=0.3187 mb_mean=0.3007 norm_overlap=0.8482 corr_cb=-0.6824
[EPOCH 041/089] train: loss=0.4104 acc=78.58% | val: loss=0.6399 acc=67.74% f1=33.33% auc=62.10% val_score=80.7554 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.319, mb=0.301, no=0.848, corr=-0.682) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 80.7554
[DBG][ep=042] disease_pos_weight=1.0000 mode=none
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.3187 mb_mean=0.3021 norm_overlap=0.8491 corr_cb=-0.7043 topkJ=0.0000
[TRAIN][ep=042] loss=0.4091 acc=78.40%
[TRAIN][ep=042] mask_avg: mc_mean=0.3187 mb_mean=0.3007 norm_overlap=0.8479 corr_cb=-0.6831
[EPOCH 042/089] train: loss=0.4091 acc=78.40% | val: loss=0.6401 acc=67.74% f1=33.33% auc=61.87% val_score=80.7554 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.319, mb=0.301, no=0.848, corr=-0.683) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 80.7554
[DBG][ep=043] disease_pos_weight=1.0000 mode=none
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.3282 mb_mean=0.2897 norm_overlap=0.8029 corr_cb=-0.7589 topkJ=0.0000
[TRAIN][ep=043] loss=0.4068 acc=78.95%
[TRAIN][ep=043] mask_avg: mc_mean=0.3187 mb_mean=0.3007 norm_overlap=0.8481 corr_cb=-0.6833
[EPOCH 043/089] train: loss=0.4068 acc=78.95% | val: loss=0.6409 acc=67.74% f1=33.33% auc=61.98% val_score=80.7554 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.319, mb=0.301, no=0.848, corr=-0.683) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 80.7554
[DBG][ep=044] disease_pos_weight=1.0000 mode=none
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.3256 mb_mean=0.2939 norm_overlap=0.8242 corr_cb=-0.7472 topkJ=0.0000
[TRAIN][ep=044] loss=0.4048 acc=79.13%
[TRAIN][ep=044] mask_avg: mc_mean=0.3187 mb_mean=0.3007 norm_overlap=0.8483 corr_cb=-0.6822
[EPOCH 044/089] train: loss=0.4048 acc=79.13% | val: loss=0.6408 acc=67.74% f1=33.33% auc=61.98% val_score=83.6684 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.319, mb=0.301, no=0.848, corr=-0.682) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 83.6684
[DBG][ep=045] disease_pos_weight=1.0000 mode=none
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.3229 mb_mean=0.2788 norm_overlap=0.7900 corr_cb=-0.7347 topkJ=0.0000
[TRAIN][ep=045] loss=0.4037 acc=79.31%
[TRAIN][ep=045] mask_avg: mc_mean=0.3187 mb_mean=0.3007 norm_overlap=0.8481 corr_cb=-0.6825
[EPOCH 045/089] train: loss=0.4037 acc=79.31% | val: loss=0.6425 acc=67.74% f1=33.33% auc=62.54% val_score=82.8781 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.319, mb=0.301, no=0.848, corr=-0.682) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 82.8781
[DBG][ep=046] disease_pos_weight=1.0000 mode=none
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.3090 mb_mean=0.3167 norm_overlap=0.8463 corr_cb=-0.7562 topkJ=0.0000
[TRAIN][ep=046] loss=0.4021 acc=79.85%
[TRAIN][ep=046] mask_avg: mc_mean=0.3187 mb_mean=0.3007 norm_overlap=0.8481 corr_cb=-0.6835
[EPOCH 046/089] train: loss=0.4021 acc=79.85% | val: loss=0.6432 acc=67.74% f1=33.33% auc=62.32% val_score=85.0042 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.319, mb=0.301, no=0.848, corr=-0.683) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 85.0042
[DBG][ep=047] disease_pos_weight=1.0000 mode=none
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.3251 mb_mean=0.3093 norm_overlap=0.8835 corr_cb=-0.6569 topkJ=0.0000
[TRAIN][ep=047] loss=0.3999 acc=78.77%
[TRAIN][ep=047] mask_avg: mc_mean=0.3187 mb_mean=0.3007 norm_overlap=0.8482 corr_cb=-0.6836
[EPOCH 047/089] train: loss=0.3999 acc=78.77% | val: loss=0.6431 acc=67.74% f1=33.33% auc=61.87% val_score=83.6684 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.319, mb=0.301, no=0.848, corr=-0.684) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 83.6684
[DBG][ep=048] disease_pos_weight=1.0000 mode=none
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.3233 mb_mean=0.2989 norm_overlap=0.8481 corr_cb=-0.6848 topkJ=0.0000
[TRAIN][ep=048] loss=0.3985 acc=79.67%
[TRAIN][ep=048] mask_avg: mc_mean=0.3187 mb_mean=0.3007 norm_overlap=0.8481 corr_cb=-0.6827
[EPOCH 048/089] train: loss=0.3985 acc=79.67% | val: loss=0.6434 acc=67.74% f1=33.33% auc=61.98% val_score=83.6684 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.319, mb=0.301, no=0.848, corr=-0.683) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 83.6684
[DBG][ep=049] disease_pos_weight=1.0000 mode=none
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.3118 mb_mean=0.3014 norm_overlap=0.8580 corr_cb=-0.6479 topkJ=0.0000
[TRAIN][ep=049] loss=0.3962 acc=79.67%
[TRAIN][ep=049] mask_avg: mc_mean=0.3187 mb_mean=0.3007 norm_overlap=0.8480 corr_cb=-0.6841
[EPOCH 049/089] train: loss=0.3962 acc=79.67% | val: loss=0.6457 acc=67.74% f1=33.33% auc=62.32% val_score=85.0042 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.319, mb=0.301, no=0.848, corr=-0.684) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 85.0042
[DBG][ep=050] disease_pos_weight=1.0000 mode=none
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.3162 mb_mean=0.3176 norm_overlap=0.8622 corr_cb=-0.7062 topkJ=0.0000
[TRAIN][ep=050] loss=0.3954 acc=79.67%
[TRAIN][ep=050] mask_avg: mc_mean=0.3187 mb_mean=0.3007 norm_overlap=0.8478 corr_cb=-0.6831
[EPOCH 050/089] train: loss=0.3954 acc=79.67% | val: loss=0.6471 acc=67.74% f1=33.33% auc=62.21% val_score=82.8781 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.319, mb=0.301, no=0.848, corr=-0.683) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 82.8781
[DBG][ep=051] disease_pos_weight=1.0000 mode=none
[DBG][ep=051] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=051] mask(step0): mc_mean=0.3112 mb_mean=0.2988 norm_overlap=0.8705 corr_cb=-0.5912 topkJ=0.0000
[TRAIN][ep=051] loss=0.3933 acc=78.95%
[TRAIN][ep=051] mask_avg: mc_mean=0.3187 mb_mean=0.3007 norm_overlap=0.8482 corr_cb=-0.6819
[EPOCH 051/089] train: loss=0.3933 acc=78.95% | val: loss=0.6479 acc=67.74% f1=33.33% auc=62.21% val_score=87.0311 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.319, mb=0.301, no=0.848, corr=-0.682) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 87.0311
[EARLY STOP] no improvement for 30 epochs. best_epoch=21
[CKPT] Loaded best for testing: results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
=============== FIT DONE ===============
[BEST] epoch=21 | val_acc=67.74% | val_f1=41.18% | val_auc=64.55% | val_score=90.0707 | val_score_bestthr=87.7082
[TEST@BEST] thr_used=0.380 | acc=64.94% f1=51.79% auc=60.19% | SP_sex=4.67% EO_sex=12.50% SP_age=22.46% EO_age=52.41%
[TIME] 0.86 min
[OK] Saved: results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/summary_fold_0.json
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5236 mb_mean=0.5061 norm_overlap=0.9998 corr_cb=-0.1913 topkJ=0.0225
[TRAIN][ep=000] loss=0.6926 acc=51.91%
[TRAIN][ep=000] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2677
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5223 mb_mean=0.5043 norm_overlap=0.9995 corr_cb=-0.3398 topkJ=0.0124
[TRAIN][ep=001] loss=0.6752 acc=63.70%
[TRAIN][ep=001] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2716
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5214 mb_mean=0.5039 norm_overlap=0.9998 corr_cb=-0.1603 topkJ=0.0315
[TRAIN][ep=002] loss=0.6633 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2709
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5198 mb_mean=0.5045 norm_overlap=0.9997 corr_cb=-0.2413 topkJ=0.0174
[TRAIN][ep=003] loss=0.6578 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2654
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5237 mb_mean=0.5050 norm_overlap=0.9997 corr_cb=-0.2572 topkJ=0.0114
[TRAIN][ep=004] loss=0.6554 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2685
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5214 mb_mean=0.5050 norm_overlap=0.9997 corr_cb=-0.2780 topkJ=0.0280
[TRAIN][ep=005] loss=0.6542 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2701
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5217 mb_mean=0.5043 norm_overlap=0.9997 corr_cb=-0.2886 topkJ=0.0135
[TRAIN][ep=006] loss=0.6538 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2669
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5184 mb_mean=0.5067 norm_overlap=0.9997 corr_cb=-0.3329 topkJ=0.0218
[TRAIN][ep=007] loss=0.6520 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2713
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5223 mb_mean=0.5062 norm_overlap=0.9996 corr_cb=-0.3736 topkJ=0.0062
[TRAIN][ep=008] loss=0.6517 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2684
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5215 mb_mean=0.5068 norm_overlap=0.9997 corr_cb=-0.2734 topkJ=0.0259
[TRAIN][ep=009] loss=0.6500 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2687
================= FIT START (fold=0) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.35 select_by=val_score | eval_thr_mode=best_acc eval_thr_grid=coarse | disease_pos_weight_mode=none freeze_b_after=15 | two_stage=True stage1_ratio=0.35 stage2_lr_mult=0.3 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5235 mb_mean=0.5056 norm_overlap=0.9996 corr_cb=-0.2652 topkJ=0.0979
[TRAIN][ep=000] loss=0.6488 acc=63.70%
[TRAIN][ep=000] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2687
[EPOCH 000/089] train: loss=0.6488 acc=63.70% | val: loss=0.6590 acc=62.90% f1=0.00% auc=49.28% val_score=64.2297 val_score_bestthr=62.9032 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.521, mb=0.506, no=1.000, corr=-0.269) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* -1000000000000000000.0000 -> 64.2297
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5221 mb_mean=0.5070 norm_overlap=0.9998 corr_cb=-0.2391 topkJ=0.0404
[TRAIN][ep=001] loss=0.6469 acc=63.70%
[TRAIN][ep=001] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2684
[EPOCH 001/089] train: loss=0.6469 acc=63.70% | val: loss=0.6577 acc=62.90% f1=0.00% auc=51.28% val_score=67.4541 val_score_bestthr=62.9032 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.521, mb=0.506, no=1.000, corr=-0.268) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 64.2297 -> 67.4541
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5187 mb_mean=0.5040 norm_overlap=0.9998 corr_cb=-0.2618 topkJ=0.0162
[TRAIN][ep=002] loss=0.6457 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2713
[EPOCH 002/089] train: loss=0.6457 acc=63.70% | val: loss=0.6570 acc=62.90% f1=14.81% auc=51.84% val_score=64.2297 val_score_bestthr=69.7231 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.521, mb=0.506, no=1.000, corr=-0.271) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 67.4541 -> 64.2297
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5199 mb_mean=0.5065 norm_overlap=0.9998 corr_cb=-0.2547 topkJ=0.0454
[TRAIN][ep=003] loss=0.6442 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2668
[EPOCH 003/089] train: loss=0.6442 acc=63.70% | val: loss=0.6557 acc=62.90% f1=14.81% auc=52.73% val_score=66.7750 val_score_bestthr=69.7231 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.521, mb=0.506, no=1.000, corr=-0.267) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 67.4541 -> 66.7750
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5227 mb_mean=0.5044 norm_overlap=0.9996 corr_cb=-0.3527 topkJ=0.0157
[TRAIN][ep=004] loss=0.6434 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2700
[EPOCH 004/089] train: loss=0.6434 acc=63.70% | val: loss=0.6545 acc=64.52% f1=8.33% auc=54.07% val_score=66.7750 val_score_bestthr=68.1795 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.521, mb=0.506, no=1.000, corr=-0.270) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 67.4541 -> 66.7750
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5208 mb_mean=0.5063 norm_overlap=0.9997 corr_cb=-0.2071 topkJ=0.0176
[TRAIN][ep=005] loss=2.1112 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.5144 mb_mean=0.4947 norm_overlap=0.9998 corr_cb=-0.1560
[EPOCH 005/089] train: loss=2.1112 acc=63.70% | val: loss=0.6550 acc=62.90% f1=20.69% auc=54.40% val_score=75.5211 val_score_bestthr=72.4762 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.514, mb=0.495, no=1.000, corr=-0.156) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 67.4541 -> 75.5211
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5078 mb_mean=0.4851 norm_overlap=0.9997 corr_cb=-0.1634 topkJ=0.0376
[TRAIN][ep=006] loss=2.0995 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.5000 mb_mean=0.4723 norm_overlap=1.0000 corr_cb=-0.0215
[EPOCH 006/089] train: loss=2.0995 acc=63.70% | val: loss=0.6540 acc=64.52% f1=21.43% auc=55.85% val_score=74.3065 val_score_bestthr=74.3752 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.500, mb=0.472, no=1.000, corr=-0.022) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 75.5211 -> 74.3065
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4920 mb_mean=0.4606 norm_overlap=1.0000 corr_cb=0.0132 topkJ=0.0311
[TRAIN][ep=007] loss=2.0944 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.4856 mb_mean=0.4486 norm_overlap=1.0005 corr_cb=0.0781
[EPOCH 007/089] train: loss=2.0944 acc=63.70% | val: loss=0.6527 acc=64.52% f1=21.43% auc=56.52% val_score=67.1224 val_score_bestthr=74.3752 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.486, mb=0.449, no=1.000, corr=0.078) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 75.5211 -> 67.1224
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4794 mb_mean=0.4372 norm_overlap=0.9994 corr_cb=-0.1045 topkJ=0.0267
[TRAIN][ep=008] loss=2.0850 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.4714 mb_mean=0.4242 norm_overlap=1.0015 corr_cb=0.1643
[EPOCH 008/089] train: loss=2.0850 acc=63.70% | val: loss=0.6521 acc=66.13% f1=27.59% auc=56.97% val_score=76.3813 val_score_bestthr=78.8618 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.471, mb=0.424, no=1.002, corr=0.164) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 75.5211 -> 76.3813
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4636 mb_mean=0.4207 norm_overlap=1.0015 corr_cb=0.1682 topkJ=0.1046
[TRAIN][ep=009] loss=2.0829 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.4575 mb_mean=0.3996 norm_overlap=1.0021 corr_cb=0.1460
[EPOCH 009/089] train: loss=2.0829 acc=63.70% | val: loss=0.6515 acc=64.52% f1=26.67% auc=58.19% val_score=76.3813 val_score_bestthr=76.6882 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.457, mb=0.400, no=1.002, corr=0.146) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.3813 -> 76.3813
[DBG][ep=010] disease_pos_weight=1.0000 mode=none
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.4526 mb_mean=0.3856 norm_overlap=1.0014 corr_cb=0.0937 topkJ=0.0592
[TRAIN][ep=010] loss=2.0743 acc=63.70%
[TRAIN][ep=010] mask_avg: mc_mean=0.4440 mb_mean=0.3764 norm_overlap=1.0017 corr_cb=0.0756
[EPOCH 010/089] train: loss=2.0743 acc=63.70% | val: loss=0.6496 acc=66.13% f1=16.00% auc=58.97% val_score=70.3872 val_score_bestthr=73.5938 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.444, mb=0.376, no=1.002, corr=0.076) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.3813 -> 70.3872
[DBG][ep=011] disease_pos_weight=1.0000 mode=none
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.4420 mb_mean=0.3641 norm_overlap=1.0002 corr_cb=0.0088 topkJ=0.0285
[TRAIN][ep=011] loss=2.0686 acc=63.70%
[TRAIN][ep=011] mask_avg: mc_mean=0.4312 mb_mean=0.3552 norm_overlap=1.0000 corr_cb=-0.0050
[EPOCH 011/089] train: loss=2.0686 acc=63.70% | val: loss=0.6483 acc=67.74% f1=23.08% auc=59.53% val_score=74.5015 val_score_bestthr=78.5401 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.431, mb=0.355, no=1.000, corr=-0.005) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.3813 -> 74.5015
[DBG][ep=012] disease_pos_weight=1.0000 mode=none
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.4165 mb_mean=0.3285 norm_overlap=1.0024 corr_cb=0.0516 topkJ=0.0703
[TRAIN][ep=012] loss=2.0650 acc=63.70%
[TRAIN][ep=012] mask_avg: mc_mean=0.4183 mb_mean=0.3367 norm_overlap=0.9952 corr_cb=-0.1180
[EPOCH 012/089] train: loss=2.0650 acc=63.70% | val: loss=0.6476 acc=67.74% f1=41.18% auc=60.76% val_score=80.1930 val_score_bestthr=87.1786 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.418, mb=0.337, no=0.995, corr=-0.118) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 76.3813 -> 80.1930
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=013] disease_pos_weight=1.0000 mode=none
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.4172 mb_mean=0.3332 norm_overlap=0.9885 corr_cb=-0.2705 topkJ=0.0236
[TRAIN][ep=013] loss=2.0550 acc=63.70%
[TRAIN][ep=013] mask_avg: mc_mean=0.4075 mb_mean=0.3204 norm_overlap=0.9859 corr_cb=-0.2636
[EPOCH 013/089] train: loss=2.0550 acc=63.70% | val: loss=0.6457 acc=67.74% f1=23.08% auc=62.32% val_score=80.9022 val_score_bestthr=78.5401 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.408, mb=0.320, no=0.986, corr=-0.264) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 80.1930 -> 80.9022
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=014] disease_pos_weight=1.0000 mode=none
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.3961 mb_mean=0.3053 norm_overlap=0.9659 corr_cb=-0.4999 topkJ=0.0069
[TRAIN][ep=014] loss=2.0533 acc=63.70%
[TRAIN][ep=014] mask_avg: mc_mean=0.3964 mb_mean=0.3069 norm_overlap=0.9712 corr_cb=-0.3953
[EPOCH 014/089] train: loss=2.0533 acc=63.70% | val: loss=0.6452 acc=67.74% f1=23.08% auc=61.32% val_score=80.9022 val_score_bestthr=78.5401 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.396, mb=0.307, no=0.971, corr=-0.395) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 80.9022 -> 80.9022
[DBG][ep=015] disease_pos_weight=1.0000 mode=none
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.3922 mb_mean=0.2987 norm_overlap=0.9761 corr_cb=-0.2683 topkJ=0.0221
[TRAIN][ep=015] loss=2.0456 acc=63.70%
[TRAIN][ep=015] mask_avg: mc_mean=0.3849 mb_mean=0.3017 norm_overlap=0.9572 corr_cb=-0.4728
[EPOCH 015/089] train: loss=2.0456 acc=63.70% | val: loss=0.6421 acc=67.74% f1=23.08% auc=61.87% val_score=82.9035 val_score_bestthr=78.5401 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.385, mb=0.302, no=0.957, corr=-0.473) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=* 80.9022 -> 82.9035
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=016] disease_pos_weight=1.0000 mode=none
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.3790 mb_mean=0.2958 norm_overlap=0.9541 corr_cb=-0.4440 topkJ=0.0127
[TRAIN][ep=016] loss=2.0387 acc=63.52%
[TRAIN][ep=016] mask_avg: mc_mean=0.3759 mb_mean=0.3017 norm_overlap=0.9478 corr_cb=-0.5110
[EPOCH 016/089] train: loss=2.0387 acc=63.52% | val: loss=0.6424 acc=67.74% f1=23.08% auc=62.88% val_score=87.2586 val_score_bestthr=78.5401 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.376, mb=0.302, no=0.948, corr=-0.511) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=* 82.9035 -> 87.2586
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=017] disease_pos_weight=1.0000 mode=none
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.3784 mb_mean=0.3138 norm_overlap=0.9471 corr_cb=-0.5658 topkJ=0.0008
[TRAIN][ep=017] loss=2.0329 acc=63.70%
[TRAIN][ep=017] mask_avg: mc_mean=0.3667 mb_mean=0.3017 norm_overlap=0.9369 corr_cb=-0.5481
[EPOCH 017/089] train: loss=2.0329 acc=63.70% | val: loss=0.6395 acc=67.74% f1=23.08% auc=63.55% val_score=88.6660 val_score_bestthr=78.5401 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.367, mb=0.302, no=0.937, corr=-0.548) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=* 87.2586 -> 88.6660
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=018] disease_pos_weight=1.0000 mode=none
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.3696 mb_mean=0.2960 norm_overlap=0.9371 corr_cb=-0.5475 topkJ=0.0004
[TRAIN][ep=018] loss=1.3510 acc=64.07%
[TRAIN][ep=018] mask_avg: mc_mean=0.3600 mb_mean=0.3017 norm_overlap=0.9284 corr_cb=-0.5752
[EPOCH 018/089] train: loss=1.3510 acc=64.07% | val: loss=0.6383 acc=67.74% f1=23.08% auc=63.10% val_score=87.2946 val_score_bestthr=78.5401 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.360, mb=0.302, no=0.928, corr=-0.575) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 88.6660 -> 87.2946
[DBG][ep=019] disease_pos_weight=1.0000 mode=none
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.3640 mb_mean=0.2959 norm_overlap=0.9236 corr_cb=-0.5967 topkJ=0.0000
[TRAIN][ep=019] loss=0.6667 acc=65.15%
[TRAIN][ep=019] mask_avg: mc_mean=0.3535 mb_mean=0.3017 norm_overlap=0.9187 corr_cb=-0.5997
[EPOCH 019/089] train: loss=0.6667 acc=65.15% | val: loss=0.6345 acc=66.13% f1=40.00% auc=64.21% val_score=85.8087 val_score_bestthr=85.4793 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.353, mb=0.302, no=0.919, corr=-0.600) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 88.6660 -> 85.8087
[DBG][ep=020] disease_pos_weight=1.0000 mode=none
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.3579 mb_mean=0.2994 norm_overlap=0.9383 corr_cb=-0.4885 topkJ=0.0004
[TRAIN][ep=020] loss=0.5135 acc=66.06%
[TRAIN][ep=020] mask_avg: mc_mean=0.3463 mb_mean=0.3017 norm_overlap=0.9070 corr_cb=-0.6215
[EPOCH 020/089] train: loss=0.5135 acc=66.06% | val: loss=0.6308 acc=67.74% f1=33.33% auc=64.66% val_score=90.0707 val_score_bestthr=83.4349 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.346, mb=0.302, no=0.907, corr=-0.622) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=* 88.6660 -> 90.0707
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=021] disease_pos_weight=1.0000 mode=none
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.3459 mb_mean=0.2978 norm_overlap=0.9086 corr_cb=-0.5633 topkJ=0.0000
[TRAIN][ep=021] loss=0.5074 acc=67.70%
[TRAIN][ep=021] mask_avg: mc_mean=0.3405 mb_mean=0.3017 norm_overlap=0.8959 corr_cb=-0.6413
[EPOCH 021/089] train: loss=0.5074 acc=67.70% | val: loss=0.6280 acc=67.74% f1=44.44% auc=65.44% val_score=90.0707 val_score_bestthr=89.3941 | dyn(w_pfs=0.040, w_sup=0.040, w_csuf=0.040, stage2=False) | mask(mc=0.340, mb=0.302, no=0.896, corr=-0.641) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 90.0707
[DBG][ep=022] disease_pos_weight=1.0000 mode=none
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.3247 mb_mean=0.2993 norm_overlap=0.8744 corr_cb=-0.6880 topkJ=0.0000
[TRAIN][ep=022] loss=0.7723 acc=67.33%
[TRAIN][ep=022] mask_avg: mc_mean=0.3345 mb_mean=0.3017 norm_overlap=0.8826 corr_cb=-0.6614
[EPOCH 022/089] train: loss=0.7723 acc=67.33% | val: loss=0.6262 acc=67.74% f1=44.44% auc=66.56% val_score=82.1605 val_score_bestthr=89.3941 | dyn(w_pfs=0.080, w_sup=0.080, w_csuf=0.080, stage2=False) | mask(mc=0.335, mb=0.302, no=0.883, corr=-0.661) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 82.1605
[DBG][ep=023] disease_pos_weight=1.0000 mode=none
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.3420 mb_mean=0.3088 norm_overlap=0.8906 corr_cb=-0.6666 topkJ=0.0000
[TRAIN][ep=023] loss=1.0402 acc=67.15%
[TRAIN][ep=023] mask_avg: mc_mean=0.3328 mb_mean=0.3017 norm_overlap=0.8771 corr_cb=-0.6750
[EPOCH 023/089] train: loss=1.0402 acc=67.15% | val: loss=0.6276 acc=67.74% f1=52.38% auc=64.10% val_score=87.9096 val_score_bestthr=93.2389 | dyn(w_pfs=0.120, w_sup=0.120, w_csuf=0.120, stage2=False) | mask(mc=0.333, mb=0.302, no=0.877, corr=-0.675) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 87.9096
[DBG][ep=024] disease_pos_weight=1.0000 mode=none
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.3230 mb_mean=0.2997 norm_overlap=0.8611 corr_cb=-0.6972 topkJ=0.0000
[TRAIN][ep=024] loss=1.2991 acc=67.70%
[TRAIN][ep=024] mask_avg: mc_mean=0.3293 mb_mean=0.3017 norm_overlap=0.8662 corr_cb=-0.6896
[EPOCH 024/089] train: loss=1.2991 acc=67.70% | val: loss=0.6255 acc=67.74% f1=41.18% auc=65.77% val_score=83.1813 val_score_bestthr=87.8675 | dyn(w_pfs=0.160, w_sup=0.160, w_csuf=0.160, stage2=False) | mask(mc=0.329, mb=0.302, no=0.866, corr=-0.690) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 83.1813
[DBG][ep=025] disease_pos_weight=1.0000 mode=none
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.3251 mb_mean=0.2975 norm_overlap=0.8292 corr_cb=-0.7340 topkJ=0.0000
[TRAIN][ep=025] loss=1.5617 acc=70.78%
[TRAIN][ep=025] mask_avg: mc_mean=0.3272 mb_mean=0.3017 norm_overlap=0.8598 corr_cb=-0.6983
[EPOCH 025/089] train: loss=1.5617 acc=70.78% | val: loss=0.6267 acc=67.74% f1=28.57% auc=64.44% val_score=84.5666 val_score_bestthr=81.4605 | dyn(w_pfs=0.200, w_sup=0.200, w_csuf=0.200, stage2=False) | mask(mc=0.327, mb=0.302, no=0.860, corr=-0.698) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 84.5666
[DBG][ep=026] disease_pos_weight=1.0000 mode=none
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.3271 mb_mean=0.3017 norm_overlap=0.8322 corr_cb=-0.7568 topkJ=0.0000
[TRAIN][ep=026] loss=1.8226 acc=71.51%
[TRAIN][ep=026] mask_avg: mc_mean=0.3241 mb_mean=0.3017 norm_overlap=0.8507 corr_cb=-0.7083
[EPOCH 026/089] train: loss=1.8226 acc=71.51% | val: loss=0.6308 acc=67.74% f1=33.33% auc=63.55% val_score=81.8855 val_score_bestthr=83.9489 | dyn(w_pfs=0.240, w_sup=0.240, w_csuf=0.200, stage2=False) | mask(mc=0.324, mb=0.302, no=0.851, corr=-0.708) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 81.8855
[DBG][ep=027] disease_pos_weight=1.0000 mode=none
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.3194 mb_mean=0.2908 norm_overlap=0.8150 corr_cb=-0.7682 topkJ=0.0000
[TRAIN][ep=027] loss=1.9262 acc=73.14%
[TRAIN][ep=027] mask_avg: mc_mean=0.3218 mb_mean=0.3017 norm_overlap=0.8424 corr_cb=-0.7170
[EPOCH 027/089] train: loss=1.9262 acc=73.14% | val: loss=0.6302 acc=67.74% f1=33.33% auc=63.77% val_score=79.5125 val_score_bestthr=83.9489 | dyn(w_pfs=0.280, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.322, mb=0.302, no=0.842, corr=-0.717) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 79.5125
[DBG][ep=028] disease_pos_weight=1.0000 mode=none
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.3228 mb_mean=0.3068 norm_overlap=0.8645 corr_cb=-0.7095 topkJ=0.0000
[TRAIN][ep=028] loss=1.9445 acc=74.41%
[TRAIN][ep=028] mask_avg: mc_mean=0.3195 mb_mean=0.3017 norm_overlap=0.8351 corr_cb=-0.7253
[EPOCH 028/089] train: loss=1.9445 acc=74.41% | val: loss=0.6348 acc=67.74% f1=33.33% auc=62.10% val_score=82.8188 val_score_bestthr=83.9489 | dyn(w_pfs=0.180, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.320, mb=0.302, no=0.835, corr=-0.725) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 82.8188
[DBG][ep=029] disease_pos_weight=1.0000 mode=none
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.3251 mb_mean=0.3032 norm_overlap=0.8419 corr_cb=-0.7387 topkJ=0.0000
[TRAIN][ep=029] loss=1.2651 acc=73.50%
[TRAIN][ep=029] mask_avg: mc_mean=0.3168 mb_mean=0.3017 norm_overlap=0.8284 corr_cb=-0.7263
[EPOCH 029/089] train: loss=1.2651 acc=73.50% | val: loss=0.6353 acc=67.74% f1=33.33% auc=62.99% val_score=80.2804 val_score_bestthr=83.9489 | dyn(w_pfs=0.080, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.317, mb=0.302, no=0.828, corr=-0.726) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 80.2804
[DBG][ep=030] disease_pos_weight=1.0000 mode=none
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.3141 mb_mean=0.3008 norm_overlap=0.8043 corr_cb=-0.7711 topkJ=0.0000
[TRAIN][ep=030] loss=0.5890 acc=76.59%
[TRAIN][ep=030] mask_avg: mc_mean=0.3148 mb_mean=0.3017 norm_overlap=0.8227 corr_cb=-0.7304
[EPOCH 030/089] train: loss=0.5890 acc=76.59% | val: loss=0.6315 acc=67.74% f1=33.33% auc=62.88% val_score=80.2065 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.315, mb=0.302, no=0.823, corr=-0.730) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 80.2065
[DBG][ep=031] disease_pos_weight=1.0000 mode=none
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.3173 mb_mean=0.2977 norm_overlap=0.7869 corr_cb=-0.7676 topkJ=0.0000
[TRAIN][ep=031] loss=0.4331 acc=76.95%
[TRAIN][ep=031] mask_avg: mc_mean=0.3137 mb_mean=0.3017 norm_overlap=0.8193 corr_cb=-0.7334
[EPOCH 031/089] train: loss=0.4331 acc=76.95% | val: loss=0.6318 acc=67.74% f1=58.33% auc=62.88% val_score=79.5360 val_score_bestthr=95.5901 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.314, mb=0.302, no=0.819, corr=-0.733) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 79.5360
[DBG][ep=032] disease_pos_weight=1.0000 mode=none
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.3229 mb_mean=0.2891 norm_overlap=0.8050 corr_cb=-0.7628 topkJ=0.0000
[TRAIN][ep=032] loss=0.4297 acc=77.31%
[TRAIN][ep=032] mask_avg: mc_mean=0.3137 mb_mean=0.3017 norm_overlap=0.8194 corr_cb=-0.7329
[EPOCH 032/089] train: loss=0.4297 acc=77.31% | val: loss=0.6341 acc=67.74% f1=33.33% auc=62.43% val_score=87.0311 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.314, mb=0.302, no=0.819, corr=-0.733) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 87.0311
[DBG][ep=033] disease_pos_weight=1.0000 mode=none
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.3015 mb_mean=0.2935 norm_overlap=0.8388 corr_cb=-0.6644 topkJ=0.0000
[TRAIN][ep=033] loss=0.4275 acc=76.95%
[TRAIN][ep=033] mask_avg: mc_mean=0.3137 mb_mean=0.3017 norm_overlap=0.8194 corr_cb=-0.7333
[EPOCH 033/089] train: loss=0.4275 acc=76.95% | val: loss=0.6352 acc=67.74% f1=33.33% auc=62.54% val_score=87.0311 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.314, mb=0.302, no=0.819, corr=-0.733) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 87.0311
[DBG][ep=034] disease_pos_weight=1.0000 mode=none
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.3125 mb_mean=0.2999 norm_overlap=0.8106 corr_cb=-0.7078 topkJ=0.0000
[TRAIN][ep=034] loss=0.4256 acc=77.68%
[TRAIN][ep=034] mask_avg: mc_mean=0.3137 mb_mean=0.3017 norm_overlap=0.8192 corr_cb=-0.7326
[EPOCH 034/089] train: loss=0.4256 acc=77.68% | val: loss=0.6336 acc=67.74% f1=33.33% auc=62.76% val_score=82.9406 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.314, mb=0.302, no=0.819, corr=-0.733) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 82.9406
[DBG][ep=035] disease_pos_weight=1.0000 mode=none
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.3019 mb_mean=0.3158 norm_overlap=0.8214 corr_cb=-0.7731 topkJ=0.0000
[TRAIN][ep=035] loss=0.4236 acc=77.86%
[TRAIN][ep=035] mask_avg: mc_mean=0.3137 mb_mean=0.3017 norm_overlap=0.8192 corr_cb=-0.7329
[EPOCH 035/089] train: loss=0.4236 acc=77.86% | val: loss=0.6351 acc=67.74% f1=33.33% auc=62.99% val_score=89.0779 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.314, mb=0.302, no=0.819, corr=-0.733) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 89.0779
[DBG][ep=036] disease_pos_weight=1.0000 mode=none
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.3151 mb_mean=0.3097 norm_overlap=0.7896 corr_cb=-0.7982 topkJ=0.0000
[TRAIN][ep=036] loss=0.4217 acc=77.50%
[TRAIN][ep=036] mask_avg: mc_mean=0.3137 mb_mean=0.3017 norm_overlap=0.8193 corr_cb=-0.7345
[EPOCH 036/089] train: loss=0.4217 acc=77.50% | val: loss=0.6348 acc=67.74% f1=33.33% auc=62.54% val_score=82.9406 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.314, mb=0.302, no=0.819, corr=-0.734) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 82.9406
[DBG][ep=037] disease_pos_weight=1.0000 mode=none
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.3081 mb_mean=0.3069 norm_overlap=0.8539 corr_cb=-0.6149 topkJ=0.0000
[TRAIN][ep=037] loss=0.4197 acc=77.86%
[TRAIN][ep=037] mask_avg: mc_mean=0.3137 mb_mean=0.3017 norm_overlap=0.8193 corr_cb=-0.7322
[EPOCH 037/089] train: loss=0.4197 acc=77.86% | val: loss=0.6361 acc=67.74% f1=33.33% auc=62.54% val_score=87.0311 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.314, mb=0.302, no=0.819, corr=-0.732) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 87.0311
[DBG][ep=038] disease_pos_weight=1.0000 mode=none
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.3075 mb_mean=0.3022 norm_overlap=0.8229 corr_cb=-0.6730 topkJ=0.0000
[TRAIN][ep=038] loss=0.4176 acc=77.50%
[TRAIN][ep=038] mask_avg: mc_mean=0.3137 mb_mean=0.3017 norm_overlap=0.8192 corr_cb=-0.7336
[EPOCH 038/089] train: loss=0.4176 acc=77.50% | val: loss=0.6361 acc=67.74% f1=33.33% auc=62.54% val_score=83.6684 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.314, mb=0.302, no=0.819, corr=-0.734) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 83.6684
[DBG][ep=039] disease_pos_weight=1.0000 mode=none
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.3163 mb_mean=0.3038 norm_overlap=0.8159 corr_cb=-0.7486 topkJ=0.0000
[TRAIN][ep=039] loss=0.4157 acc=78.22%
[TRAIN][ep=039] mask_avg: mc_mean=0.3137 mb_mean=0.3017 norm_overlap=0.8193 corr_cb=-0.7331
[EPOCH 039/089] train: loss=0.4157 acc=78.22% | val: loss=0.6365 acc=67.74% f1=33.33% auc=62.65% val_score=82.9406 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.314, mb=0.302, no=0.819, corr=-0.733) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 82.9406
[DBG][ep=040] disease_pos_weight=1.0000 mode=none
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.3100 mb_mean=0.3071 norm_overlap=0.7775 corr_cb=-0.8123 topkJ=0.0000
[TRAIN][ep=040] loss=0.4146 acc=77.86%
[TRAIN][ep=040] mask_avg: mc_mean=0.3137 mb_mean=0.3017 norm_overlap=0.8196 corr_cb=-0.7301
[EPOCH 040/089] train: loss=0.4146 acc=77.86% | val: loss=0.6367 acc=67.74% f1=33.33% auc=62.65% val_score=80.7554 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.314, mb=0.302, no=0.820, corr=-0.730) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 80.7554
[DBG][ep=041] disease_pos_weight=1.0000 mode=none
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.3059 mb_mean=0.2972 norm_overlap=0.8286 corr_cb=-0.6755 topkJ=0.0000
[TRAIN][ep=041] loss=0.4125 acc=78.04%
[TRAIN][ep=041] mask_avg: mc_mean=0.3137 mb_mean=0.3017 norm_overlap=0.8194 corr_cb=-0.7324
[EPOCH 041/089] train: loss=0.4125 acc=78.04% | val: loss=0.6379 acc=67.74% f1=33.33% auc=62.32% val_score=87.0311 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.314, mb=0.302, no=0.819, corr=-0.732) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 87.0311
[DBG][ep=042] disease_pos_weight=1.0000 mode=none
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.3140 mb_mean=0.3033 norm_overlap=0.8189 corr_cb=-0.7596 topkJ=0.0000
[TRAIN][ep=042] loss=0.4111 acc=78.22%
[TRAIN][ep=042] mask_avg: mc_mean=0.3137 mb_mean=0.3017 norm_overlap=0.8192 corr_cb=-0.7330
[EPOCH 042/089] train: loss=0.4111 acc=78.22% | val: loss=0.6381 acc=67.74% f1=33.33% auc=62.43% val_score=85.0042 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.314, mb=0.302, no=0.819, corr=-0.733) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 85.0042
[DBG][ep=043] disease_pos_weight=1.0000 mode=none
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.3255 mb_mean=0.2907 norm_overlap=0.7684 corr_cb=-0.8005 topkJ=0.0000
[TRAIN][ep=043] loss=0.4088 acc=78.40%
[TRAIN][ep=043] mask_avg: mc_mean=0.3137 mb_mean=0.3017 norm_overlap=0.8193 corr_cb=-0.7333
[EPOCH 043/089] train: loss=0.4088 acc=78.40% | val: loss=0.6389 acc=67.74% f1=33.33% auc=62.43% val_score=87.0311 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.314, mb=0.302, no=0.819, corr=-0.733) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 87.0311
[DBG][ep=044] disease_pos_weight=1.0000 mode=none
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.3212 mb_mean=0.2950 norm_overlap=0.7914 corr_cb=-0.7927 topkJ=0.0000
[TRAIN][ep=044] loss=0.4068 acc=78.40%
[TRAIN][ep=044] mask_avg: mc_mean=0.3137 mb_mean=0.3017 norm_overlap=0.8196 corr_cb=-0.7323
[EPOCH 044/089] train: loss=0.4068 acc=78.40% | val: loss=0.6387 acc=67.74% f1=33.33% auc=62.76% val_score=80.7554 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.314, mb=0.302, no=0.820, corr=-0.732) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 80.7554
[DBG][ep=045] disease_pos_weight=1.0000 mode=none
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.3205 mb_mean=0.2798 norm_overlap=0.7541 corr_cb=-0.7813 topkJ=0.0000
[TRAIN][ep=045] loss=0.4057 acc=78.58%
[TRAIN][ep=045] mask_avg: mc_mean=0.3137 mb_mean=0.3017 norm_overlap=0.8194 corr_cb=-0.7327
[EPOCH 045/089] train: loss=0.4057 acc=78.58% | val: loss=0.6405 acc=67.74% f1=33.33% auc=62.54% val_score=87.0311 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.314, mb=0.302, no=0.819, corr=-0.733) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 87.0311
[DBG][ep=046] disease_pos_weight=1.0000 mode=none
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.3024 mb_mean=0.3175 norm_overlap=0.8219 corr_cb=-0.7939 topkJ=0.0000
[TRAIN][ep=046] loss=0.4042 acc=78.77%
[TRAIN][ep=046] mask_avg: mc_mean=0.3137 mb_mean=0.3017 norm_overlap=0.8193 corr_cb=-0.7333
[EPOCH 046/089] train: loss=0.4042 acc=78.77% | val: loss=0.6411 acc=67.74% f1=33.33% auc=62.32% val_score=87.0311 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.314, mb=0.302, no=0.819, corr=-0.733) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 87.0311
[DBG][ep=047] disease_pos_weight=1.0000 mode=none
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.3193 mb_mean=0.3102 norm_overlap=0.8576 corr_cb=-0.7143 topkJ=0.0000
[TRAIN][ep=047] loss=0.4020 acc=78.22%
[TRAIN][ep=047] mask_avg: mc_mean=0.3137 mb_mean=0.3017 norm_overlap=0.8194 corr_cb=-0.7335
[EPOCH 047/089] train: loss=0.4020 acc=78.22% | val: loss=0.6410 acc=67.74% f1=33.33% auc=62.21% val_score=80.7554 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.314, mb=0.302, no=0.819, corr=-0.734) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 80.7554
[DBG][ep=048] disease_pos_weight=1.0000 mode=none
[DBG][ep=048] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=048] mask(step0): mc_mean=0.3178 mb_mean=0.3000 norm_overlap=0.8176 corr_cb=-0.7374 topkJ=0.0000
[TRAIN][ep=048] loss=0.4006 acc=78.58%
[TRAIN][ep=048] mask_avg: mc_mean=0.3137 mb_mean=0.3017 norm_overlap=0.8194 corr_cb=-0.7327
[EPOCH 048/089] train: loss=0.4006 acc=78.58% | val: loss=0.6413 acc=67.74% f1=33.33% auc=61.98% val_score=80.7554 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.314, mb=0.302, no=0.819, corr=-0.733) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 80.7554
[DBG][ep=049] disease_pos_weight=1.0000 mode=none
[DBG][ep=049] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=049] mask(step0): mc_mean=0.3057 mb_mean=0.3026 norm_overlap=0.8302 corr_cb=-0.6999 topkJ=0.0000
[TRAIN][ep=049] loss=0.3984 acc=79.13%
[TRAIN][ep=049] mask_avg: mc_mean=0.3137 mb_mean=0.3017 norm_overlap=0.8192 corr_cb=-0.7341
[EPOCH 049/089] train: loss=0.3984 acc=79.13% | val: loss=0.6436 acc=67.74% f1=33.33% auc=62.32% val_score=87.0311 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.314, mb=0.302, no=0.819, corr=-0.734) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 87.0311
[DBG][ep=050] disease_pos_weight=1.0000 mode=none
[DBG][ep=050] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=050] mask(step0): mc_mean=0.3098 mb_mean=0.3185 norm_overlap=0.8371 corr_cb=-0.7502 topkJ=0.0000
[TRAIN][ep=050] loss=0.3975 acc=79.49%
[TRAIN][ep=050] mask_avg: mc_mean=0.3137 mb_mean=0.3017 norm_overlap=0.8190 corr_cb=-0.7331
[EPOCH 050/089] train: loss=0.3975 acc=79.49% | val: loss=0.6448 acc=67.74% f1=33.33% auc=62.21% val_score=85.0042 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.314, mb=0.302, no=0.819, corr=-0.733) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.0707 -> 85.0042
[EARLY STOP] no improvement for 30 epochs. best_epoch=20
[CKPT] Loaded best for testing: results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
=============== FIT DONE ===============
[BEST] epoch=20 | val_acc=67.74% | val_f1=33.33% | val_auc=64.66% | val_score=90.0707 | val_score_bestthr=83.4349
[TEST@BEST] thr_used=0.400 | acc=63.64% f1=42.86% auc=59.58% | SP_sex=4.93% EO_sex=0.00% SP_age=26.25% EO_age=58.82%
[TIME] 0.89 min
[OK] Saved: results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/summary_fold_0.json
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5236 mb_mean=0.5061 norm_overlap=0.9998 corr_cb=-0.1913 topkJ=0.0225
[TRAIN][ep=000] loss=0.6926 acc=51.91%
[TRAIN][ep=000] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2677
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5223 mb_mean=0.5043 norm_overlap=0.9995 corr_cb=-0.3398 topkJ=0.0124
[TRAIN][ep=001] loss=0.6752 acc=63.70%
[TRAIN][ep=001] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2716
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5214 mb_mean=0.5039 norm_overlap=0.9998 corr_cb=-0.1603 topkJ=0.0315
[TRAIN][ep=002] loss=0.6633 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2709
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5198 mb_mean=0.5045 norm_overlap=0.9997 corr_cb=-0.2413 topkJ=0.0174
[TRAIN][ep=003] loss=0.6578 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2654
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5237 mb_mean=0.5050 norm_overlap=0.9997 corr_cb=-0.2572 topkJ=0.0114
[TRAIN][ep=004] loss=0.6554 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2685
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5214 mb_mean=0.5050 norm_overlap=0.9997 corr_cb=-0.2780 topkJ=0.0280
[TRAIN][ep=005] loss=0.6542 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2701
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5217 mb_mean=0.5043 norm_overlap=0.9997 corr_cb=-0.2886 topkJ=0.0135
[TRAIN][ep=006] loss=0.6538 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2669
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5184 mb_mean=0.5067 norm_overlap=0.9997 corr_cb=-0.3329 topkJ=0.0218
[TRAIN][ep=007] loss=0.6520 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2713
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5223 mb_mean=0.5062 norm_overlap=0.9996 corr_cb=-0.3736 topkJ=0.0062
[TRAIN][ep=008] loss=0.6517 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2684
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5215 mb_mean=0.5068 norm_overlap=0.9997 corr_cb=-0.2734 topkJ=0.0259
[TRAIN][ep=009] loss=0.6500 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2687
================= FIT START (fold=0) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.35 select_by=val_score | eval_thr_mode=best_acc eval_thr_grid=coarse | disease_pos_weight_mode=none freeze_b_after=15 | two_stage=True stage1_ratio=0.35 stage2_lr_mult=0.3 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=1.0000 mode=none
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5235 mb_mean=0.5056 norm_overlap=0.9996 corr_cb=-0.2652 topkJ=0.0979
[TRAIN][ep=000] loss=0.6488 acc=63.70%
[TRAIN][ep=000] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2687
[EPOCH 000/089] train: loss=0.6488 acc=63.70% | val: loss=0.6590 acc=62.90% f1=0.00% auc=49.28% val_score=64.2297 val_score_bestthr=62.9032 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.521, mb=0.506, no=1.000, corr=-0.269) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* -1000000000000000000.0000 -> 64.2297
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=001] disease_pos_weight=1.0000 mode=none
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5221 mb_mean=0.5070 norm_overlap=0.9998 corr_cb=-0.2391 topkJ=0.0404
[TRAIN][ep=001] loss=0.6469 acc=63.70%
[TRAIN][ep=001] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2684
[EPOCH 001/089] train: loss=0.6469 acc=63.70% | val: loss=0.6577 acc=62.90% f1=0.00% auc=51.28% val_score=67.4541 val_score_bestthr=62.9032 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.521, mb=0.506, no=1.000, corr=-0.268) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=* 64.2297 -> 67.4541
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=002] disease_pos_weight=1.0000 mode=none
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5187 mb_mean=0.5040 norm_overlap=0.9998 corr_cb=-0.2618 topkJ=0.0162
[TRAIN][ep=002] loss=0.6457 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2713
[EPOCH 002/089] train: loss=0.6457 acc=63.70% | val: loss=0.6570 acc=62.90% f1=14.81% auc=51.84% val_score=64.2297 val_score_bestthr=69.7231 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.521, mb=0.506, no=1.000, corr=-0.271) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 67.4541 -> 64.2297
[DBG][ep=003] disease_pos_weight=1.0000 mode=none
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5199 mb_mean=0.5065 norm_overlap=0.9998 corr_cb=-0.2547 topkJ=0.0454
[TRAIN][ep=003] loss=0.6442 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2668
[EPOCH 003/089] train: loss=0.6442 acc=63.70% | val: loss=0.6557 acc=62.90% f1=14.81% auc=52.73% val_score=66.7750 val_score_bestthr=69.7231 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.521, mb=0.506, no=1.000, corr=-0.267) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 67.4541 -> 66.7750
[DBG][ep=004] disease_pos_weight=1.0000 mode=none
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5227 mb_mean=0.5044 norm_overlap=0.9996 corr_cb=-0.3527 topkJ=0.0157
[TRAIN][ep=004] loss=0.6434 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2700
[EPOCH 004/089] train: loss=0.6434 acc=63.70% | val: loss=0.6545 acc=64.52% f1=8.33% auc=54.07% val_score=66.7750 val_score_bestthr=68.1795 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.521, mb=0.506, no=1.000, corr=-0.270) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 67.4541 -> 66.7750
[DBG][ep=005] disease_pos_weight=1.0000 mode=none
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5208 mb_mean=0.5063 norm_overlap=0.9997 corr_cb=-0.2071 topkJ=0.0176
[TRAIN][ep=005] loss=1.4475 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.5141 mb_mean=0.4817 norm_overlap=1.0000 corr_cb=-0.0579
[EPOCH 005/089] train: loss=1.4475 acc=63.70% | val: loss=0.6547 acc=62.90% f1=14.81% auc=54.74% val_score=71.4552 val_score_bestthr=69.7231 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.514, mb=0.482, no=1.000, corr=-0.058) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 67.4541 -> 71.4552
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=006] disease_pos_weight=1.0000 mode=none
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5072 mb_mean=0.4618 norm_overlap=1.0002 corr_cb=0.0665 topkJ=0.0616
[TRAIN][ep=006] loss=1.4492 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.4992 mb_mean=0.4352 norm_overlap=1.0008 corr_cb=0.1345
[EPOCH 006/089] train: loss=1.4492 acc=63.70% | val: loss=0.6538 acc=64.52% f1=21.43% auc=55.85% val_score=76.2980 val_score_bestthr=74.3752 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.499, mb=0.435, no=1.001, corr=0.135) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 71.4552 -> 76.2980
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=007] disease_pos_weight=1.0000 mode=none
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.4912 mb_mean=0.4145 norm_overlap=1.0015 corr_cb=0.1906 topkJ=0.0725
[TRAIN][ep=007] loss=1.4468 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.4850 mb_mean=0.3924 norm_overlap=1.0016 corr_cb=0.1371
[EPOCH 007/089] train: loss=1.4468 acc=63.70% | val: loss=0.6524 acc=64.52% f1=26.67% auc=56.52% val_score=69.1458 val_score_bestthr=76.6882 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.485, mb=0.392, no=1.002, corr=0.137) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 76.2980 -> 69.1458
[DBG][ep=008] disease_pos_weight=1.0000 mode=none
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.4788 mb_mean=0.3743 norm_overlap=0.9983 corr_cb=-0.1317 topkJ=0.0309
[TRAIN][ep=008] loss=1.4385 acc=63.70%
[TRAIN][ep=008] mask_avg: mc_mean=0.4715 mb_mean=0.3553 norm_overlap=1.0011 corr_cb=0.0607
[EPOCH 008/089] train: loss=1.4385 acc=63.70% | val: loss=0.6518 acc=64.52% f1=31.25% auc=57.53% val_score=84.7534 val_score_bestthr=79.3442 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.471, mb=0.355, no=1.001, corr=0.061) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 76.2980 -> 84.7534
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=009] disease_pos_weight=1.0000 mode=none
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4633 mb_mean=0.3555 norm_overlap=0.9990 corr_cb=-0.0564 topkJ=0.0499
[TRAIN][ep=009] loss=1.4355 acc=63.70%
[TRAIN][ep=009] mask_avg: mc_mean=0.4583 mb_mean=0.3258 norm_overlap=0.9972 corr_cb=-0.0975
[EPOCH 009/089] train: loss=1.4355 acc=63.70% | val: loss=0.6512 acc=64.52% f1=31.25% auc=58.31% val_score=80.6397 val_score_bestthr=79.3442 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.458, mb=0.326, no=0.997, corr=-0.098) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 84.7534 -> 80.6397
[DBG][ep=010] disease_pos_weight=1.0000 mode=none
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.4544 mb_mean=0.3083 norm_overlap=0.9932 corr_cb=-0.2196 topkJ=0.0247
[TRAIN][ep=010] loss=1.4279 acc=63.70%
[TRAIN][ep=010] mask_avg: mc_mean=0.4454 mb_mean=0.3040 norm_overlap=0.9874 corr_cb=-0.2940
[EPOCH 010/089] train: loss=1.4279 acc=63.70% | val: loss=0.6492 acc=66.13% f1=16.00% auc=59.20% val_score=78.6000 val_score_bestthr=73.5938 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.445, mb=0.304, no=0.987, corr=-0.294) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 84.7534 -> 78.6000
[DBG][ep=011] disease_pos_weight=1.0000 mode=none
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.4439 mb_mean=0.2896 norm_overlap=0.9767 corr_cb=-0.4644 topkJ=0.0016
[TRAIN][ep=011] loss=1.4221 acc=63.70%
[TRAIN][ep=011] mask_avg: mc_mean=0.4326 mb_mean=0.2884 norm_overlap=0.9697 corr_cb=-0.4816
[EPOCH 011/089] train: loss=1.4221 acc=63.70% | val: loss=0.6480 acc=67.74% f1=23.08% auc=60.65% val_score=80.7022 val_score_bestthr=78.5401 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.433, mb=0.288, no=0.970, corr=-0.482) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 84.7534 -> 80.7022
[DBG][ep=012] disease_pos_weight=1.0000 mode=none
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.4189 mb_mean=0.2653 norm_overlap=0.9515 corr_cb=-0.5065 topkJ=0.0012
[TRAIN][ep=012] loss=1.4161 acc=63.70%
[TRAIN][ep=012] mask_avg: mc_mean=0.4188 mb_mean=0.2797 norm_overlap=0.9370 corr_cb=-0.6531
[EPOCH 012/089] train: loss=1.4161 acc=63.70% | val: loss=0.6473 acc=67.74% f1=23.08% auc=61.32% val_score=83.7329 val_score_bestthr=78.5401 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.419, mb=0.280, no=0.937, corr=-0.653) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 84.7534 -> 83.7329
[DBG][ep=013] disease_pos_weight=1.0000 mode=none
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.4177 mb_mean=0.2792 norm_overlap=0.9183 corr_cb=-0.7578 topkJ=0.0000
[TRAIN][ep=013] loss=1.4042 acc=63.70%
[TRAIN][ep=013] mask_avg: mc_mean=0.4060 mb_mean=0.2773 norm_overlap=0.8903 corr_cb=-0.7831
[EPOCH 013/089] train: loss=1.4042 acc=63.70% | val: loss=0.6460 acc=67.74% f1=23.08% auc=60.98% val_score=79.9241 val_score_bestthr=78.5401 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.406, mb=0.277, no=0.890, corr=-0.783) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=- 84.7534 -> 79.9241
[DBG][ep=014] disease_pos_weight=1.0000 mode=none
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.3924 mb_mean=0.2741 norm_overlap=0.8223 corr_cb=-0.8923 topkJ=0.0000
[TRAIN][ep=014] loss=0.9849 acc=63.52%
[TRAIN][ep=014] mask_avg: mc_mean=0.3921 mb_mean=0.2788 norm_overlap=0.8247 corr_cb=-0.8591
[EPOCH 014/089] train: loss=0.9849 acc=63.52% | val: loss=0.6443 acc=66.13% f1=40.00% auc=61.65% val_score=85.0992 val_score_bestthr=85.4997 | dyn(w_pfs=0.290, w_sup=0.190, w_csuf=0.140, stage2=False) | mask(mc=0.392, mb=0.279, no=0.825, corr=-0.859) | masker_state=mask_gen_c=ON,mask_gen_b=ON | best(val_score)=* 84.7534 -> 85.0992
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=015] disease_pos_weight=1.0000 mode=none
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.3884 mb_mean=0.2805 norm_overlap=0.8135 corr_cb=-0.8333 topkJ=0.0000
[TRAIN][ep=015] loss=1.1394 acc=63.70%
[TRAIN][ep=015] mask_avg: mc_mean=0.3776 mb_mean=0.2791 norm_overlap=0.7595 corr_cb=-0.8909
[EPOCH 015/089] train: loss=1.1394 acc=63.70% | val: loss=0.6415 acc=66.13% f1=22.22% auc=62.32% val_score=82.2301 val_score_bestthr=76.4197 | dyn(w_pfs=0.330, w_sup=0.230, w_csuf=0.180, stage2=False) | mask(mc=0.378, mb=0.279, no=0.760, corr=-0.891) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 85.0992 -> 82.2301
[DBG][ep=016] disease_pos_weight=1.0000 mode=none
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.3739 mb_mean=0.2774 norm_overlap=0.7130 corr_cb=-0.9164 topkJ=0.0000
[TRAIN][ep=016] loss=1.2949 acc=63.70%
[TRAIN][ep=016] mask_avg: mc_mean=0.3670 mb_mean=0.2791 norm_overlap=0.7193 corr_cb=-0.9010
[EPOCH 016/089] train: loss=1.2949 acc=63.70% | val: loss=0.6432 acc=66.13% f1=22.22% auc=62.43% val_score=86.4224 val_score_bestthr=76.4197 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.367, mb=0.279, no=0.719, corr=-0.901) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=* 85.0992 -> 86.4224
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=017] disease_pos_weight=1.0000 mode=none
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.3689 mb_mean=0.2766 norm_overlap=0.7412 corr_cb=-0.9025 topkJ=0.0000
[TRAIN][ep=017] loss=1.3692 acc=63.70%
[TRAIN][ep=017] mask_avg: mc_mean=0.3571 mb_mean=0.2791 norm_overlap=0.6806 corr_cb=-0.9045
[EPOCH 017/089] train: loss=1.3692 acc=63.70% | val: loss=0.6395 acc=66.13% f1=40.00% auc=62.65% val_score=90.1369 val_score_bestthr=85.4793 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.357, mb=0.279, no=0.681, corr=-0.904) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=* 86.4224 -> 90.1369
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=018] disease_pos_weight=1.0000 mode=none
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.3641 mb_mean=0.2624 norm_overlap=0.6756 corr_cb=-0.9075 topkJ=0.0000
[TRAIN][ep=018] loss=1.3633 acc=64.61%
[TRAIN][ep=018] mask_avg: mc_mean=0.3504 mb_mean=0.2791 norm_overlap=0.6513 corr_cb=-0.9078
[EPOCH 018/089] train: loss=1.3633 acc=64.61% | val: loss=0.6389 acc=66.13% f1=40.00% auc=62.32% val_score=81.7029 val_score_bestthr=85.4793 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.350, mb=0.279, no=0.651, corr=-0.908) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.1369 -> 81.7029
[DBG][ep=019] disease_pos_weight=1.0000 mode=none
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.3595 mb_mean=0.2664 norm_overlap=0.6390 corr_cb=-0.9273 topkJ=0.0000
[TRAIN][ep=019] loss=1.3536 acc=64.61%
[TRAIN][ep=019] mask_avg: mc_mean=0.3448 mb_mean=0.2791 norm_overlap=0.6258 corr_cb=-0.9076
[EPOCH 019/089] train: loss=1.3536 acc=64.61% | val: loss=0.6367 acc=66.13% f1=46.15% auc=63.77% val_score=88.0277 val_score_bestthr=88.6299 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.345, mb=0.279, no=0.626, corr=-0.908) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.1369 -> 88.0277
[DBG][ep=020] disease_pos_weight=1.0000 mode=none
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.3525 mb_mean=0.2722 norm_overlap=0.6528 corr_cb=-0.8907 topkJ=0.0000
[TRAIN][ep=020] loss=1.3440 acc=64.97%
[TRAIN][ep=020] mask_avg: mc_mean=0.3392 mb_mean=0.2791 norm_overlap=0.5990 corr_cb=-0.9065
[EPOCH 020/089] train: loss=1.3440 acc=64.97% | val: loss=0.6348 acc=67.74% f1=44.44% auc=63.88% val_score=90.1369 val_score_bestthr=89.3941 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.339, mb=0.279, no=0.599, corr=-0.906) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.1369 -> 90.1369
[DBG][ep=021] disease_pos_weight=1.0000 mode=none
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.3429 mb_mean=0.2755 norm_overlap=0.5897 corr_cb=-0.8895 topkJ=0.0000
[TRAIN][ep=021] loss=1.3416 acc=66.24%
[TRAIN][ep=021] mask_avg: mc_mean=0.3349 mb_mean=0.2791 norm_overlap=0.5778 corr_cb=-0.9047
[EPOCH 021/089] train: loss=1.3416 acc=66.24% | val: loss=0.6362 acc=66.13% f1=51.16% auc=62.32% val_score=89.1441 val_score_bestthr=90.9891 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.335, mb=0.279, no=0.578, corr=-0.905) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.1369 -> 89.1441
[DBG][ep=022] disease_pos_weight=1.0000 mode=none
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.3198 mb_mean=0.2755 norm_overlap=0.5259 corr_cb=-0.8939 topkJ=0.0000
[TRAIN][ep=022] loss=1.3184 acc=66.24%
[TRAIN][ep=022] mask_avg: mc_mean=0.3305 mb_mean=0.2791 norm_overlap=0.5550 corr_cb=-0.8991
[EPOCH 022/089] train: loss=1.3184 acc=66.24% | val: loss=0.6325 acc=69.35% f1=45.71% auc=65.22% val_score=78.0736 val_score_bestthr=91.7322 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.330, mb=0.279, no=0.555, corr=-0.899) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.1369 -> 78.0736
[DBG][ep=023] disease_pos_weight=1.0000 mode=none
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.3367 mb_mean=0.2741 norm_overlap=0.6041 corr_cb=-0.8661 topkJ=0.0000
[TRAIN][ep=023] loss=1.3171 acc=68.06%
[TRAIN][ep=023] mask_avg: mc_mean=0.3277 mb_mean=0.2791 norm_overlap=0.5403 corr_cb=-0.8986
[EPOCH 023/089] train: loss=1.3171 acc=68.06% | val: loss=0.6324 acc=67.74% f1=33.33% auc=64.10% val_score=84.5901 val_score_bestthr=83.9489 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.328, mb=0.279, no=0.540, corr=-0.899) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.1369 -> 84.5901
[DBG][ep=024] disease_pos_weight=1.0000 mode=none
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.3201 mb_mean=0.2822 norm_overlap=0.5014 corr_cb=-0.9087 topkJ=0.0000
[TRAIN][ep=024] loss=1.2996 acc=69.51%
[TRAIN][ep=024] mask_avg: mc_mean=0.3245 mb_mean=0.2791 norm_overlap=0.5213 corr_cb=-0.8951
[EPOCH 024/089] train: loss=1.2996 acc=69.51% | val: loss=0.6316 acc=67.74% f1=33.33% auc=63.21% val_score=78.9682 val_score_bestthr=83.9489 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.324, mb=0.279, no=0.521, corr=-0.895) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.1369 -> 78.9682
[DBG][ep=025] disease_pos_weight=1.0000 mode=none
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.3233 mb_mean=0.2775 norm_overlap=0.4666 corr_cb=-0.8767 topkJ=0.0000
[TRAIN][ep=025] loss=1.2896 acc=73.14%
[TRAIN][ep=025] mask_avg: mc_mean=0.3216 mb_mean=0.2791 norm_overlap=0.5106 corr_cb=-0.8920
[EPOCH 025/089] train: loss=1.2896 acc=73.14% | val: loss=0.6323 acc=67.74% f1=33.33% auc=62.54% val_score=81.5407 val_score_bestthr=83.9489 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.322, mb=0.279, no=0.511, corr=-0.892) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.1369 -> 81.5407
[DBG][ep=026] disease_pos_weight=1.0000 mode=none
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.3201 mb_mean=0.2739 norm_overlap=0.4918 corr_cb=-0.8725 topkJ=0.0000
[TRAIN][ep=026] loss=1.2803 acc=73.68%
[TRAIN][ep=026] mask_avg: mc_mean=0.3189 mb_mean=0.2791 norm_overlap=0.4961 corr_cb=-0.8872
[EPOCH 026/089] train: loss=1.2803 acc=73.68% | val: loss=0.6366 acc=67.74% f1=33.33% auc=61.65% val_score=82.8744 val_score_bestthr=83.9489 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.319, mb=0.279, no=0.496, corr=-0.887) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.1369 -> 82.8744
[DBG][ep=027] disease_pos_weight=1.0000 mode=none
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.3219 mb_mean=0.2693 norm_overlap=0.4284 corr_cb=-0.8898 topkJ=0.0000
[TRAIN][ep=027] loss=1.2655 acc=75.68%
[TRAIN][ep=027] mask_avg: mc_mean=0.3167 mb_mean=0.2791 norm_overlap=0.4842 corr_cb=-0.8830
[EPOCH 027/089] train: loss=1.2655 acc=75.68% | val: loss=0.6364 acc=67.74% f1=33.33% auc=62.21% val_score=76.7481 val_score_bestthr=83.9489 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.317, mb=0.279, no=0.484, corr=-0.883) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.1369 -> 76.7481
[DBG][ep=028] disease_pos_weight=1.0000 mode=none
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.3141 mb_mean=0.2803 norm_overlap=0.5051 corr_cb=-0.8907 topkJ=0.0000
[TRAIN][ep=028] loss=0.8518 acc=76.77%
[TRAIN][ep=028] mask_avg: mc_mean=0.3145 mb_mean=0.2791 norm_overlap=0.4744 corr_cb=-0.8791
[EPOCH 028/089] train: loss=0.8518 acc=76.77% | val: loss=0.6397 acc=67.74% f1=33.33% auc=61.87% val_score=80.8563 val_score_bestthr=83.9489 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.314, mb=0.279, no=0.474, corr=-0.879) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.1369 -> 80.8563
[DBG][ep=029] disease_pos_weight=1.0000 mode=none
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.3177 mb_mean=0.2787 norm_overlap=0.4948 corr_cb=-0.8936 topkJ=0.0000
[TRAIN][ep=029] loss=0.4369 acc=76.23%
[TRAIN][ep=029] mask_avg: mc_mean=0.3119 mb_mean=0.2791 norm_overlap=0.4640 corr_cb=-0.8739
[EPOCH 029/089] train: loss=0.4369 acc=76.23% | val: loss=0.6419 acc=67.74% f1=33.33% auc=62.54% val_score=80.3466 val_score_bestthr=83.9489 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.312, mb=0.279, no=0.464, corr=-0.874) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.1369 -> 80.3466
[DBG][ep=030] disease_pos_weight=1.0000 mode=none
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.3066 mb_mean=0.2830 norm_overlap=0.4469 corr_cb=-0.8872 topkJ=0.0000
[TRAIN][ep=030] loss=0.4109 acc=77.50%
[TRAIN][ep=030] mask_avg: mc_mean=0.3100 mb_mean=0.2791 norm_overlap=0.4571 corr_cb=-0.8684
[EPOCH 030/089] train: loss=0.4109 acc=77.50% | val: loss=0.6397 acc=67.74% f1=33.33% auc=61.43% val_score=77.4463 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.310, mb=0.279, no=0.457, corr=-0.868) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score)=- 90.1369 -> 77.4463
[DBG][ep=031] disease_pos_weight=1.0000 mode=none
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.3174 mb_mean=0.2766 norm_overlap=0.4056 corr_cb=-0.8765 topkJ=0.0000
[TRAIN][ep=031] loss=0.3882 acc=77.68%
[TRAIN][ep=031] mask_avg: mc_mean=0.3090 mb_mean=0.2791 norm_overlap=0.4530 corr_cb=-0.8667
[EPOCH 031/089] train: loss=0.3882 acc=77.68% | val: loss=0.6406 acc=67.74% f1=33.33% auc=61.65% val_score=81.6069 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.309, mb=0.279, no=0.453, corr=-0.867) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.1369 -> 81.6069
[DBG][ep=032] disease_pos_weight=1.0000 mode=none
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.3263 mb_mean=0.2669 norm_overlap=0.4061 corr_cb=-0.8855 topkJ=0.0000
[TRAIN][ep=032] loss=0.3847 acc=77.86%
[TRAIN][ep=032] mask_avg: mc_mean=0.3089 mb_mean=0.2791 norm_overlap=0.4532 corr_cb=-0.8665
[EPOCH 032/089] train: loss=0.3847 acc=77.86% | val: loss=0.6442 acc=67.74% f1=33.33% auc=60.98% val_score=87.0311 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.309, mb=0.279, no=0.453, corr=-0.867) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.1369 -> 87.0311
[DBG][ep=033] disease_pos_weight=1.0000 mode=none
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.3014 mb_mean=0.2650 norm_overlap=0.4348 corr_cb=-0.8126 topkJ=0.0000
[TRAIN][ep=033] loss=0.3826 acc=77.31%
[TRAIN][ep=033] mask_avg: mc_mean=0.3090 mb_mean=0.2791 norm_overlap=0.4531 corr_cb=-0.8668
[EPOCH 033/089] train: loss=0.3826 acc=77.31% | val: loss=0.6459 acc=67.74% f1=33.33% auc=61.09% val_score=87.0311 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.309, mb=0.279, no=0.453, corr=-0.867) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.1369 -> 87.0311
[DBG][ep=034] disease_pos_weight=1.0000 mode=none
[DBG][ep=034] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=034] mask(step0): mc_mean=0.3081 mb_mean=0.2817 norm_overlap=0.4559 corr_cb=-0.8471 topkJ=0.0000
[TRAIN][ep=034] loss=0.3806 acc=78.58%
[TRAIN][ep=034] mask_avg: mc_mean=0.3090 mb_mean=0.2791 norm_overlap=0.4528 corr_cb=-0.8668
[EPOCH 034/089] train: loss=0.3806 acc=78.58% | val: loss=0.6443 acc=67.74% f1=33.33% auc=61.43% val_score=85.0042 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.309, mb=0.279, no=0.453, corr=-0.867) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.1369 -> 85.0042
[DBG][ep=035] disease_pos_weight=1.0000 mode=none
[DBG][ep=035] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=035] mask(step0): mc_mean=0.2968 mb_mean=0.2921 norm_overlap=0.4532 corr_cb=-0.8646 topkJ=0.0000
[TRAIN][ep=035] loss=0.3785 acc=78.40%
[TRAIN][ep=035] mask_avg: mc_mean=0.3090 mb_mean=0.2791 norm_overlap=0.4531 corr_cb=-0.8669
[EPOCH 035/089] train: loss=0.3785 acc=78.40% | val: loss=0.6463 acc=67.74% f1=33.33% auc=61.54% val_score=87.0311 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.309, mb=0.279, no=0.453, corr=-0.867) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.1369 -> 87.0311
[DBG][ep=036] disease_pos_weight=1.0000 mode=none
[DBG][ep=036] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=036] mask(step0): mc_mean=0.3081 mb_mean=0.2874 norm_overlap=0.4472 corr_cb=-0.8763 topkJ=0.0000
[TRAIN][ep=036] loss=0.3767 acc=77.86%
[TRAIN][ep=036] mask_avg: mc_mean=0.3090 mb_mean=0.2791 norm_overlap=0.4527 corr_cb=-0.8671
[EPOCH 036/089] train: loss=0.3767 acc=77.86% | val: loss=0.6464 acc=67.74% f1=33.33% auc=61.54% val_score=85.0042 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.309, mb=0.279, no=0.453, corr=-0.867) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.1369 -> 85.0042
[DBG][ep=037] disease_pos_weight=1.0000 mode=none
[DBG][ep=037] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=037] mask(step0): mc_mean=0.3061 mb_mean=0.2855 norm_overlap=0.4823 corr_cb=-0.8519 topkJ=0.0000
[TRAIN][ep=037] loss=0.3747 acc=78.77%
[TRAIN][ep=037] mask_avg: mc_mean=0.3090 mb_mean=0.2791 norm_overlap=0.4528 corr_cb=-0.8670
[EPOCH 037/089] train: loss=0.3747 acc=78.77% | val: loss=0.6485 acc=67.74% f1=33.33% auc=61.20% val_score=85.0042 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.309, mb=0.279, no=0.453, corr=-0.867) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.1369 -> 85.0042
[DBG][ep=038] disease_pos_weight=1.0000 mode=none
[DBG][ep=038] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=038] mask(step0): mc_mean=0.3054 mb_mean=0.2789 norm_overlap=0.4512 corr_cb=-0.8582 topkJ=0.0000
[TRAIN][ep=038] loss=0.3727 acc=79.31%
[TRAIN][ep=038] mask_avg: mc_mean=0.3090 mb_mean=0.2791 norm_overlap=0.4528 corr_cb=-0.8671
[EPOCH 038/089] train: loss=0.3727 acc=79.31% | val: loss=0.6490 acc=67.74% f1=33.33% auc=60.98% val_score=82.8781 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.309, mb=0.279, no=0.453, corr=-0.867) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.1369 -> 82.8781
[DBG][ep=039] disease_pos_weight=1.0000 mode=none
[DBG][ep=039] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=039] mask(step0): mc_mean=0.3138 mb_mean=0.2799 norm_overlap=0.4418 corr_cb=-0.8718 topkJ=0.0000
[TRAIN][ep=039] loss=0.3706 acc=79.49%
[TRAIN][ep=039] mask_avg: mc_mean=0.3090 mb_mean=0.2791 norm_overlap=0.4529 corr_cb=-0.8668
[EPOCH 039/089] train: loss=0.3706 acc=79.49% | val: loss=0.6494 acc=67.74% f1=33.33% auc=60.98% val_score=85.0042 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.309, mb=0.279, no=0.453, corr=-0.867) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.1369 -> 85.0042
[DBG][ep=040] disease_pos_weight=1.0000 mode=none
[DBG][ep=040] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=040] mask(step0): mc_mean=0.3028 mb_mean=0.2783 norm_overlap=0.4323 corr_cb=-0.8559 topkJ=0.0000
[TRAIN][ep=040] loss=0.3697 acc=78.77%
[TRAIN][ep=040] mask_avg: mc_mean=0.3089 mb_mean=0.2791 norm_overlap=0.4534 corr_cb=-0.8662
[EPOCH 040/089] train: loss=0.3697 acc=78.77% | val: loss=0.6500 acc=67.74% f1=33.33% auc=61.20% val_score=82.8781 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.309, mb=0.279, no=0.453, corr=-0.866) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.1369 -> 82.8781
[DBG][ep=041] disease_pos_weight=1.0000 mode=none
[DBG][ep=041] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=041] mask(step0): mc_mean=0.2999 mb_mean=0.2826 norm_overlap=0.4350 corr_cb=-0.8664 topkJ=0.0000
[TRAIN][ep=041] loss=0.3677 acc=79.31%
[TRAIN][ep=041] mask_avg: mc_mean=0.3090 mb_mean=0.2791 norm_overlap=0.4529 corr_cb=-0.8671
[EPOCH 041/089] train: loss=0.3677 acc=79.31% | val: loss=0.6517 acc=67.74% f1=33.33% auc=60.87% val_score=85.0042 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.309, mb=0.279, no=0.453, corr=-0.867) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.1369 -> 85.0042
[DBG][ep=042] disease_pos_weight=1.0000 mode=none
[DBG][ep=042] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=042] mask(step0): mc_mean=0.3133 mb_mean=0.2831 norm_overlap=0.4261 corr_cb=-0.8906 topkJ=0.0000
[TRAIN][ep=042] loss=0.3663 acc=78.95%
[TRAIN][ep=042] mask_avg: mc_mean=0.3090 mb_mean=0.2791 norm_overlap=0.4529 corr_cb=-0.8668
[EPOCH 042/089] train: loss=0.3663 acc=78.95% | val: loss=0.6523 acc=67.74% f1=33.33% auc=60.98% val_score=85.0042 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.309, mb=0.279, no=0.453, corr=-0.867) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.1369 -> 85.0042
[DBG][ep=043] disease_pos_weight=1.0000 mode=none
[DBG][ep=043] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=043] mask(step0): mc_mean=0.3191 mb_mean=0.2659 norm_overlap=0.4164 corr_cb=-0.8595 topkJ=0.0000
[TRAIN][ep=043] loss=0.3640 acc=79.31%
[TRAIN][ep=043] mask_avg: mc_mean=0.3089 mb_mean=0.2791 norm_overlap=0.4530 corr_cb=-0.8671
[EPOCH 043/089] train: loss=0.3640 acc=79.31% | val: loss=0.6532 acc=67.74% f1=33.33% auc=61.32% val_score=85.0042 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.309, mb=0.279, no=0.453, corr=-0.867) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.1369 -> 85.0042
[DBG][ep=044] disease_pos_weight=1.0000 mode=none
[DBG][ep=044] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=044] mask(step0): mc_mean=0.3163 mb_mean=0.2860 norm_overlap=0.4032 corr_cb=-0.9070 topkJ=0.0000
[TRAIN][ep=044] loss=0.3620 acc=79.67%
[TRAIN][ep=044] mask_avg: mc_mean=0.3090 mb_mean=0.2791 norm_overlap=0.4530 corr_cb=-0.8668
[EPOCH 044/089] train: loss=0.3620 acc=79.67% | val: loss=0.6534 acc=66.13% f1=32.26% auc=61.54% val_score=82.8781 val_score_bestthr=81.7668 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.309, mb=0.279, no=0.453, corr=-0.867) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.1369 -> 82.8781
[DBG][ep=045] disease_pos_weight=1.0000 mode=none
[DBG][ep=045] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=045] mask(step0): mc_mean=0.3270 mb_mean=0.2577 norm_overlap=0.3520 corr_cb=-0.8425 topkJ=0.0000
[TRAIN][ep=045] loss=0.3611 acc=79.67%
[TRAIN][ep=045] mask_avg: mc_mean=0.3090 mb_mean=0.2791 norm_overlap=0.4531 corr_cb=-0.8668
[EPOCH 045/089] train: loss=0.3611 acc=79.67% | val: loss=0.6558 acc=67.74% f1=33.33% auc=61.32% val_score=85.0042 val_score_bestthr=83.9489 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.309, mb=0.279, no=0.453, corr=-0.867) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.1369 -> 85.0042
[DBG][ep=046] disease_pos_weight=1.0000 mode=none
[DBG][ep=046] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=046] mask(step0): mc_mean=0.3003 mb_mean=0.2797 norm_overlap=0.4685 corr_cb=-0.8511 topkJ=0.0000
[TRAIN][ep=046] loss=0.3596 acc=79.67%
[TRAIN][ep=046] mask_avg: mc_mean=0.3089 mb_mean=0.2791 norm_overlap=0.4531 corr_cb=-0.8669
[EPOCH 046/089] train: loss=0.3596 acc=79.67% | val: loss=0.6567 acc=66.13% f1=32.26% auc=61.20% val_score=85.0042 val_score_bestthr=81.7668 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.309, mb=0.279, no=0.453, corr=-0.867) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.1369 -> 85.0042
[DBG][ep=047] disease_pos_weight=1.0000 mode=none
[DBG][ep=047] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=047] mask(step0): mc_mean=0.3119 mb_mean=0.2887 norm_overlap=0.4887 corr_cb=-0.9058 topkJ=0.0000
[TRAIN][ep=047] loss=0.3573 acc=79.67%
[TRAIN][ep=047] mask_avg: mc_mean=0.3089 mb_mean=0.2791 norm_overlap=0.4531 corr_cb=-0.8668
[EPOCH 047/089] train: loss=0.3573 acc=79.67% | val: loss=0.6566 acc=66.13% f1=32.26% auc=61.65% val_score=82.8781 val_score_bestthr=81.7668 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=True) | mask(mc=0.309, mb=0.279, no=0.453, corr=-0.867) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score)=- 90.1369 -> 82.8781
[EARLY STOP] no improvement for 30 epochs. best_epoch=17
[CKPT] Loaded best for testing: results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
=============== FIT DONE ===============
[BEST] epoch=17 | val_acc=66.13% | val_f1=40.00% | val_auc=62.65% | val_score=90.1369 | val_score_bestthr=85.4793
[TEST@BEST] thr_used=0.570 | acc=63.64% f1=0.00% auc=59.64% | SP_sex=0.00% EO_sex=0.00% SP_age=0.00% EO_age=0.00%
[TIME] 0.79 min
[OK] Saved: results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/summary_fold_0.json
[DBG][ep=000] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5236 mb_mean=0.5061 norm_overlap=0.9998 corr_cb=-0.1913 topkJ=0.0225
[TRAIN][ep=000] loss=0.6928 acc=54.63%
[TRAIN][ep=000] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2677
[DBG][ep=001] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5223 mb_mean=0.5043 norm_overlap=0.9995 corr_cb=-0.3398 topkJ=0.0124
[TRAIN][ep=001] loss=0.6847 acc=63.70%
[TRAIN][ep=001] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2716
[DBG][ep=002] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5214 mb_mean=0.5039 norm_overlap=0.9998 corr_cb=-0.1603 topkJ=0.0315
[TRAIN][ep=002] loss=0.6814 acc=63.70%
[TRAIN][ep=002] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2709
[DBG][ep=003] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5198 mb_mean=0.5045 norm_overlap=0.9997 corr_cb=-0.2413 topkJ=0.0174
[TRAIN][ep=003] loss=0.6790 acc=63.70%
[TRAIN][ep=003] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2654
[DBG][ep=004] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5237 mb_mean=0.5050 norm_overlap=0.9997 corr_cb=-0.2572 topkJ=0.0114
[TRAIN][ep=004] loss=0.6774 acc=63.70%
[TRAIN][ep=004] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2685
[DBG][ep=005] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5214 mb_mean=0.5050 norm_overlap=0.9997 corr_cb=-0.2780 topkJ=0.0280
[TRAIN][ep=005] loss=0.6746 acc=63.70%
[TRAIN][ep=005] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2701
[DBG][ep=006] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5217 mb_mean=0.5043 norm_overlap=0.9997 corr_cb=-0.2886 topkJ=0.0135
[TRAIN][ep=006] loss=0.6717 acc=63.70%
[TRAIN][ep=006] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2669
[DBG][ep=007] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5184 mb_mean=0.5067 norm_overlap=0.9997 corr_cb=-0.3329 topkJ=0.0218
[TRAIN][ep=007] loss=0.6667 acc=63.70%
[TRAIN][ep=007] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2713
[DBG][ep=008] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5223 mb_mean=0.5062 norm_overlap=0.9996 corr_cb=-0.3736 topkJ=0.0062
[TRAIN][ep=008] loss=0.6640 acc=64.25%
[TRAIN][ep=008] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2684
[DBG][ep=009] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.5215 mb_mean=0.5068 norm_overlap=0.9997 corr_cb=-0.2734 topkJ=0.0259
[TRAIN][ep=009] loss=0.6571 acc=65.34%
[TRAIN][ep=009] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2687
================= FIT START (fold=0) =================
[CFG] epochs=90 warmup=5 patience=30 fixed_thr=0.5 select_by=val_score_bestthr | eval_thr_mode=best_score eval_thr_grid=fine | disease_pos_weight_mode=sqrt freeze_b_after=2 | two_stage=True stage1_ratio=0.55 stage2_lr_mult=0.2 | adaptive_schedule=True
[DBG][ep=000] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=000] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=000] mask(step0): mc_mean=0.5235 mb_mean=0.5056 norm_overlap=0.9996 corr_cb=-0.2652 topkJ=0.0979
[TRAIN][ep=000] loss=0.6514 acc=65.70%
[TRAIN][ep=000] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2687
[EPOCH 000/089] train: loss=0.6514 acc=65.70% | val: loss=0.6393 acc=70.97% f1=40.00% auc=63.10% val_score=55.2030 val_score_bestthr=61.2234 | dyn(w_pfs=0.140, w_sup=0.090, w_csuf=0.090, stage2=False) | mask(mc=0.521, mb=0.506, no=1.000, corr=-0.269) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* -1000000000000000000.0000 -> 61.2234
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=001] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=001] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=001] mask(step0): mc_mean=0.5221 mb_mean=0.5070 norm_overlap=0.9998 corr_cb=-0.2391 topkJ=0.0404
[TRAIN][ep=001] loss=0.6442 acc=65.70%
[TRAIN][ep=001] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2684
[EPOCH 001/089] train: loss=0.6442 acc=65.70% | val: loss=0.6361 acc=70.97% f1=50.00% auc=62.99% val_score=60.0038 val_score_bestthr=64.0833 | dyn(w_pfs=0.180, w_sup=0.130, w_csuf=0.130, stage2=False) | mask(mc=0.521, mb=0.506, no=1.000, corr=-0.268) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 61.2234 -> 64.0833
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=002] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=002] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=002] mask(step0): mc_mean=0.5187 mb_mean=0.5040 norm_overlap=0.9998 corr_cb=-0.2618 topkJ=0.0162
[TRAIN][ep=002] loss=0.6373 acc=66.61%
[TRAIN][ep=002] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2713
[EPOCH 002/089] train: loss=0.6373 acc=66.61% | val: loss=0.6291 acc=70.97% f1=50.00% auc=63.43% val_score=60.0038 val_score_bestthr=64.0833 | dyn(w_pfs=0.220, w_sup=0.170, w_csuf=0.170, stage2=False) | mask(mc=0.521, mb=0.506, no=1.000, corr=-0.271) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.0833 -> 64.0833
[DBG][ep=003] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=003] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=003] mask(step0): mc_mean=0.5199 mb_mean=0.5065 norm_overlap=0.9998 corr_cb=-0.2547 topkJ=0.0454
[TRAIN][ep=003] loss=0.6315 acc=68.24%
[TRAIN][ep=003] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2668
[EPOCH 003/089] train: loss=0.6315 acc=68.24% | val: loss=0.6253 acc=69.35% f1=48.65% auc=64.33% val_score=54.7189 val_score_bestthr=64.1223 | dyn(w_pfs=0.260, w_sup=0.210, w_csuf=0.200, stage2=False) | mask(mc=0.521, mb=0.506, no=1.000, corr=-0.267) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=* 64.0833 -> 64.1223
[CKPT] Saved best -> results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
[DBG][ep=004] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=004] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=004] mask(step0): mc_mean=0.5227 mb_mean=0.5044 norm_overlap=0.9996 corr_cb=-0.3527 topkJ=0.0157
[TRAIN][ep=004] loss=0.6264 acc=68.24%
[TRAIN][ep=004] mask_avg: mc_mean=0.5214 mb_mean=0.5056 norm_overlap=0.9997 corr_cb=-0.2700
[EPOCH 004/089] train: loss=0.6264 acc=68.24% | val: loss=0.6268 acc=69.35% f1=48.65% auc=65.55% val_score=64.1223 val_score_bestthr=64.1223 | dyn(w_pfs=0.300, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.521, mb=0.506, no=1.000, corr=-0.270) | masker_state=mask_gen_c=OFF,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1223 -> 64.1223
[DBG][ep=005] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=005] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=005] mask(step0): mc_mean=0.5208 mb_mean=0.5063 norm_overlap=0.9997 corr_cb=-0.2071 topkJ=0.0176
[TRAIN][ep=005] loss=1.2545 acc=68.24%
[TRAIN][ep=005] mask_avg: mc_mean=0.5183 mb_mean=0.5056 norm_overlap=0.9996 corr_cb=-0.2411
[EPOCH 005/089] train: loss=1.2545 acc=68.24% | val: loss=0.6268 acc=69.35% f1=29.63% auc=64.66% val_score=56.6593 val_score_bestthr=63.4805 | dyn(w_pfs=0.340, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.518, mb=0.506, no=1.000, corr=-0.241) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1223 -> 63.4805
[DBG][ep=006] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=006] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=006] mask(step0): mc_mean=0.5154 mb_mean=0.5059 norm_overlap=0.9995 corr_cb=-0.2478 topkJ=0.0180
[TRAIN][ep=006] loss=1.2100 acc=69.87%
[TRAIN][ep=006] mask_avg: mc_mean=0.5124 mb_mean=0.5056 norm_overlap=0.9994 corr_cb=-0.2341
[EPOCH 006/089] train: loss=1.2100 acc=69.87% | val: loss=0.6259 acc=69.35% f1=29.63% auc=64.55% val_score=56.5704 val_score_bestthr=63.4805 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.512, mb=0.506, no=0.999, corr=-0.234) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1223 -> 63.4805
[DBG][ep=007] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=007] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=007] mask(step0): mc_mean=0.5091 mb_mean=0.5046 norm_overlap=0.9994 corr_cb=-0.2698 topkJ=0.0093
[TRAIN][ep=007] loss=1.2062 acc=69.87%
[TRAIN][ep=007] mask_avg: mc_mean=0.5078 mb_mean=0.5056 norm_overlap=0.9993 corr_cb=-0.2734
[EPOCH 007/089] train: loss=1.2062 acc=69.87% | val: loss=0.6249 acc=69.35% f1=29.63% auc=65.33% val_score=54.4996 val_score_bestthr=63.4805 | dyn(w_pfs=0.350, w_sup=0.250, w_csuf=0.200, stage2=False) | mask(mc=0.508, mb=0.506, no=0.999, corr=-0.273) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1223 -> 63.4805
[DBG][ep=008] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=008] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=008] mask(step0): mc_mean=0.5057 mb_mean=0.5050 norm_overlap=0.9989 corr_cb=-0.3837 topkJ=0.0040
[TRAIN][ep=008] loss=1.1919 acc=69.87%
[TRAIN][ep=008] mask_avg: mc_mean=0.5023 mb_mean=0.5056 norm_overlap=0.9992 corr_cb=-0.2817
[EPOCH 008/089] train: loss=1.1919 acc=69.87% | val: loss=0.6194 acc=69.35% f1=29.63% auc=66.56% val_score=54.4996 val_score_bestthr=63.4805 | dyn(w_pfs=0.250, w_sup=0.150, w_csuf=0.100, stage2=False) | mask(mc=0.502, mb=0.506, no=0.999, corr=-0.282) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1223 -> 63.4805
[DBG][ep=009] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=009] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=009] mask(step0): mc_mean=0.4976 mb_mean=0.5072 norm_overlap=0.9994 corr_cb=-0.2331 topkJ=0.0140
[TRAIN][ep=009] loss=0.9836 acc=74.41%
[TRAIN][ep=009] mask_avg: mc_mean=0.4968 mb_mean=0.5056 norm_overlap=0.9991 corr_cb=-0.2934
[EPOCH 009/089] train: loss=0.9836 acc=74.41% | val: loss=0.6140 acc=69.35% f1=29.63% auc=66.22% val_score=59.2860 val_score_bestthr=63.4805 | dyn(w_pfs=0.150, w_sup=0.050, w_csuf=0.000, stage2=False) | mask(mc=0.497, mb=0.506, no=0.999, corr=-0.293) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1223 -> 63.4805
[DBG][ep=010] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=010] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=010] mask(step0): mc_mean=0.4946 mb_mean=0.5050 norm_overlap=0.9997 corr_cb=-0.1172 topkJ=0.0158
[TRAIN][ep=010] loss=0.7710 acc=73.14%
[TRAIN][ep=010] mask_avg: mc_mean=0.4917 mb_mean=0.5056 norm_overlap=0.9990 corr_cb=-0.3017
[EPOCH 010/089] train: loss=0.7710 acc=73.14% | val: loss=0.6243 acc=69.35% f1=29.63% auc=67.78% val_score=56.5796 val_score_bestthr=63.4805 | dyn(w_pfs=0.050, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.492, mb=0.506, no=0.999, corr=-0.302) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1223 -> 63.4805
[DBG][ep=011] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=011] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=011] mask(step0): mc_mean=0.4892 mb_mean=0.5057 norm_overlap=0.9990 corr_cb=-0.2718 topkJ=0.0057
[TRAIN][ep=011] loss=0.7244 acc=72.78%
[TRAIN][ep=011] mask_avg: mc_mean=0.4856 mb_mean=0.5056 norm_overlap=0.9989 corr_cb=-0.2958
[EPOCH 011/089] train: loss=0.7244 acc=72.78% | val: loss=0.6173 acc=69.35% f1=38.71% auc=68.90% val_score=56.5796 val_score_bestthr=59.8058 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.486, mb=0.506, no=0.999, corr=-0.296) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1223 -> 59.8058
[DBG][ep=012] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=012] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=012] mask(step0): mc_mean=0.4817 mb_mean=0.5043 norm_overlap=0.9985 corr_cb=-0.3297 topkJ=0.0082
[TRAIN][ep=012] loss=0.7000 acc=74.95%
[TRAIN][ep=012] mask_avg: mc_mean=0.4780 mb_mean=0.5056 norm_overlap=0.9987 corr_cb=-0.2816
[EPOCH 012/089] train: loss=0.7000 acc=74.95% | val: loss=0.6249 acc=64.52% f1=42.11% auc=69.12% val_score=54.2518 val_score_bestthr=61.7303 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.478, mb=0.506, no=0.999, corr=-0.282) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1223 -> 61.7303
[DBG][ep=013] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=013] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=013] mask(step0): mc_mean=0.4753 mb_mean=0.5067 norm_overlap=0.9993 corr_cb=-0.1963 topkJ=0.0156
[TRAIN][ep=013] loss=0.6897 acc=75.50%
[TRAIN][ep=013] mask_avg: mc_mean=0.4715 mb_mean=0.5056 norm_overlap=0.9987 corr_cb=-0.2796
[EPOCH 013/089] train: loss=0.6897 acc=75.50% | val: loss=0.6054 acc=66.13% f1=46.15% auc=67.56% val_score=49.0801 val_score_bestthr=60.3727 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.472, mb=0.506, no=0.999, corr=-0.280) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1223 -> 60.3727
[DBG][ep=014] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=014] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=014] mask(step0): mc_mean=0.4660 mb_mean=0.5055 norm_overlap=0.9981 corr_cb=-0.3370 topkJ=0.0036
[TRAIN][ep=014] loss=0.6747 acc=76.77%
[TRAIN][ep=014] mask_avg: mc_mean=0.4643 mb_mean=0.5056 norm_overlap=0.9986 corr_cb=-0.2707
[EPOCH 014/089] train: loss=0.6747 acc=76.77% | val: loss=0.6105 acc=64.52% f1=45.00% auc=67.34% val_score=48.0094 val_score_bestthr=60.1432 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.464, mb=0.506, no=0.999, corr=-0.271) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1223 -> 60.1432
[DBG][ep=015] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=015] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=015] mask(step0): mc_mean=0.4588 mb_mean=0.5044 norm_overlap=0.9984 corr_cb=-0.2181 topkJ=0.0141
[TRAIN][ep=015] loss=0.6679 acc=76.04%
[TRAIN][ep=015] mask_avg: mc_mean=0.4550 mb_mean=0.5056 norm_overlap=0.9984 corr_cb=-0.2599
[EPOCH 015/089] train: loss=0.6679 acc=76.04% | val: loss=0.6340 acc=67.74% f1=33.33% auc=67.67% val_score=58.5806 val_score_bestthr=59.2860 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.455, mb=0.506, no=0.998, corr=-0.260) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1223 -> 59.2860
[DBG][ep=016] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=016] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=016] mask(step0): mc_mean=0.4501 mb_mean=0.5049 norm_overlap=0.9990 corr_cb=-0.1294 topkJ=0.0282
[TRAIN][ep=016] loss=0.6546 acc=76.23%
[TRAIN][ep=016] mask_avg: mc_mean=0.4473 mb_mean=0.5056 norm_overlap=0.9983 corr_cb=-0.2497
[EPOCH 016/089] train: loss=0.6546 acc=76.23% | val: loss=0.6209 acc=64.52% f1=45.00% auc=67.34% val_score=54.2637 val_score_bestthr=60.1432 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.447, mb=0.506, no=0.998, corr=-0.250) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1223 -> 60.1432
[DBG][ep=017] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=017] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=017] mask(step0): mc_mean=0.4442 mb_mean=0.5061 norm_overlap=0.9986 corr_cb=-0.2532 topkJ=0.0061
[TRAIN][ep=017] loss=0.6415 acc=78.22%
[TRAIN][ep=017] mask_avg: mc_mean=0.4402 mb_mean=0.5056 norm_overlap=0.9983 corr_cb=-0.2427
[EPOCH 017/089] train: loss=0.6415 acc=78.22% | val: loss=0.6293 acc=67.74% f1=33.33% auc=67.22% val_score=54.1141 val_score_bestthr=59.2860 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.440, mb=0.506, no=0.998, corr=-0.243) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1223 -> 59.2860
[DBG][ep=018] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=018] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=018] mask(step0): mc_mean=0.4386 mb_mean=0.5055 norm_overlap=0.9989 corr_cb=-0.1713 topkJ=0.0046
[TRAIN][ep=018] loss=0.6251 acc=78.58%
[TRAIN][ep=018] mask_avg: mc_mean=0.4341 mb_mean=0.5056 norm_overlap=0.9983 corr_cb=-0.2325
[EPOCH 018/089] train: loss=0.6251 acc=78.58% | val: loss=0.6402 acc=67.74% f1=37.50% auc=66.89% val_score=54.1141 val_score_bestthr=61.0487 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.434, mb=0.506, no=0.998, corr=-0.232) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1223 -> 61.0487
[DBG][ep=019] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=019] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=019] mask(step0): mc_mean=0.4280 mb_mean=0.5055 norm_overlap=0.9977 corr_cb=-0.3218 topkJ=0.0012
[TRAIN][ep=019] loss=0.6108 acc=78.22%
[TRAIN][ep=019] mask_avg: mc_mean=0.4259 mb_mean=0.5056 norm_overlap=0.9982 corr_cb=-0.2209
[EPOCH 019/089] train: loss=0.6108 acc=78.22% | val: loss=0.6537 acc=69.35% f1=38.71% auc=66.33% val_score=46.1605 val_score_bestthr=63.2319 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.426, mb=0.506, no=0.998, corr=-0.221) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1223 -> 63.2319
[DBG][ep=020] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=020] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=020] mask(step0): mc_mean=0.4206 mb_mean=0.5037 norm_overlap=0.9986 corr_cb=-0.1763 topkJ=0.0183
[TRAIN][ep=020] loss=0.6007 acc=81.85%
[TRAIN][ep=020] mask_avg: mc_mean=0.4185 mb_mean=0.5056 norm_overlap=0.9982 corr_cb=-0.2073
[EPOCH 020/089] train: loss=0.6007 acc=81.85% | val: loss=0.6641 acc=64.52% f1=35.29% auc=66.89% val_score=47.3739 val_score_bestthr=55.8915 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.418, mb=0.506, no=0.998, corr=-0.207) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1223 -> 55.8915
[DBG][ep=021] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=021] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=021] mask(step0): mc_mean=0.4163 mb_mean=0.5038 norm_overlap=0.9990 corr_cb=-0.1155 topkJ=0.0155
[TRAIN][ep=021] loss=0.5854 acc=81.85%
[TRAIN][ep=021] mask_avg: mc_mean=0.4119 mb_mean=0.5056 norm_overlap=0.9982 corr_cb=-0.2010
[EPOCH 021/089] train: loss=0.5854 acc=81.85% | val: loss=0.6879 acc=67.74% f1=37.50% auc=65.11% val_score=49.1216 val_score_bestthr=61.0487 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.412, mb=0.506, no=0.998, corr=-0.201) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1223 -> 61.0487
[DBG][ep=022] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=022] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=022] mask(step0): mc_mean=0.4014 mb_mean=0.5066 norm_overlap=0.9977 corr_cb=-0.1803 topkJ=0.0202
[TRAIN][ep=022] loss=0.5733 acc=80.22%
[TRAIN][ep=022] mask_avg: mc_mean=0.4041 mb_mean=0.5056 norm_overlap=0.9982 corr_cb=-0.1880
[EPOCH 022/089] train: loss=0.5733 acc=80.22% | val: loss=0.7143 acc=67.74% f1=37.50% auc=64.21% val_score=43.7248 val_score_bestthr=61.0487 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.404, mb=0.506, no=0.998, corr=-0.188) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1223 -> 61.0487
[DBG][ep=023] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=023] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=023] mask(step0): mc_mean=0.4040 mb_mean=0.5063 norm_overlap=0.9985 corr_cb=-0.1413 topkJ=0.0670
[TRAIN][ep=023] loss=0.5620 acc=82.58%
[TRAIN][ep=023] mask_avg: mc_mean=0.3993 mb_mean=0.5056 norm_overlap=0.9982 corr_cb=-0.1783
[EPOCH 023/089] train: loss=0.5620 acc=82.58% | val: loss=0.7142 acc=64.52% f1=50.00% auc=63.77% val_score=44.2883 val_score_bestthr=57.9304 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.399, mb=0.506, no=0.998, corr=-0.178) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1223 -> 57.9304
[DBG][ep=024] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=024] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=024] mask(step0): mc_mean=0.3957 mb_mean=0.5064 norm_overlap=0.9976 corr_cb=-0.2217 topkJ=0.0118
[TRAIN][ep=024] loss=0.5476 acc=84.21%
[TRAIN][ep=024] mask_avg: mc_mean=0.3936 mb_mean=0.5056 norm_overlap=0.9981 corr_cb=-0.1836
[EPOCH 024/089] train: loss=0.5476 acc=84.21% | val: loss=0.7517 acc=64.52% f1=8.33% auc=62.65% val_score=36.4224 val_score_bestthr=57.2037 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.394, mb=0.506, no=0.998, corr=-0.184) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1223 -> 57.2037
[DBG][ep=025] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=025] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=025] mask(step0): mc_mean=0.3941 mb_mean=0.5049 norm_overlap=0.9969 corr_cb=-0.2794 topkJ=0.0158
[TRAIN][ep=025] loss=0.5347 acc=82.58%
[TRAIN][ep=025] mask_avg: mc_mean=0.3893 mb_mean=0.5056 norm_overlap=0.9983 corr_cb=-0.1635
[EPOCH 025/089] train: loss=0.5347 acc=82.58% | val: loss=0.7710 acc=64.52% f1=15.38% auc=62.10% val_score=42.2828 val_score_bestthr=55.8374 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.389, mb=0.506, no=0.998, corr=-0.163) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1223 -> 55.8374
[DBG][ep=026] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=026] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=026] mask(step0): mc_mean=0.3840 mb_mean=0.5056 norm_overlap=0.9974 corr_cb=-0.2403 topkJ=0.0144
[TRAIN][ep=026] loss=0.5213 acc=82.21%
[TRAIN][ep=026] mask_avg: mc_mean=0.3832 mb_mean=0.5056 norm_overlap=0.9983 corr_cb=-0.1500
[EPOCH 026/089] train: loss=0.5213 acc=82.21% | val: loss=0.7924 acc=66.13% f1=36.36% auc=62.88% val_score=50.8023 val_score_bestthr=58.0538 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.383, mb=0.506, no=0.998, corr=-0.150) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1223 -> 58.0538
[DBG][ep=027] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=027] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=027] mask(step0): mc_mean=0.3764 mb_mean=0.5054 norm_overlap=0.9969 corr_cb=-0.2622 topkJ=0.0208
[TRAIN][ep=027] loss=0.5124 acc=83.30%
[TRAIN][ep=027] mask_avg: mc_mean=0.3783 mb_mean=0.5056 norm_overlap=0.9983 corr_cb=-0.1448
[EPOCH 027/089] train: loss=0.5124 acc=83.30% | val: loss=0.8419 acc=64.52% f1=15.38% auc=60.09% val_score=51.7295 val_score_bestthr=55.8374 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.378, mb=0.506, no=0.998, corr=-0.145) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1223 -> 55.8374
[DBG][ep=028] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=028] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=028] mask(step0): mc_mean=0.3756 mb_mean=0.5063 norm_overlap=0.9988 corr_cb=-0.1066 topkJ=0.0121
[TRAIN][ep=028] loss=0.5015 acc=84.94%
[TRAIN][ep=028] mask_avg: mc_mean=0.3759 mb_mean=0.5056 norm_overlap=0.9985 corr_cb=-0.1279
[EPOCH 028/089] train: loss=0.5015 acc=84.94% | val: loss=0.8391 acc=64.52% f1=35.29% auc=60.87% val_score=54.0625 val_score_bestthr=54.5524 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.376, mb=0.506, no=0.999, corr=-0.128) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1223 -> 54.5524
[DBG][ep=029] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=029] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=029] mask(step0): mc_mean=0.3768 mb_mean=0.5046 norm_overlap=0.9989 corr_cb=-0.1232 topkJ=0.0281
[TRAIN][ep=029] loss=0.4834 acc=85.48%
[TRAIN][ep=029] mask_avg: mc_mean=0.3710 mb_mean=0.5056 norm_overlap=0.9985 corr_cb=-0.1260
[EPOCH 029/089] train: loss=0.4834 acc=85.48% | val: loss=0.8371 acc=64.52% f1=15.38% auc=60.09% val_score=50.8023 val_score_bestthr=55.8374 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.371, mb=0.506, no=0.998, corr=-0.126) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1223 -> 55.8374
[DBG][ep=030] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=030] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=030] mask(step0): mc_mean=0.3710 mb_mean=0.5063 norm_overlap=0.9971 corr_cb=-0.2512 topkJ=0.0118
[TRAIN][ep=030] loss=0.4771 acc=86.03%
[TRAIN][ep=030] mask_avg: mc_mean=0.3680 mb_mean=0.5056 norm_overlap=0.9987 corr_cb=-0.1083
[EPOCH 030/089] train: loss=0.4771 acc=86.03% | val: loss=0.8839 acc=62.90% f1=43.90% auc=60.65% val_score=34.9681 val_score_bestthr=60.7887 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.368, mb=0.506, no=0.999, corr=-0.108) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1223 -> 60.7887
[DBG][ep=031] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=031] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=031] mask(step0): mc_mean=0.3667 mb_mean=0.5075 norm_overlap=0.9969 corr_cb=-0.2024 topkJ=0.0341
[TRAIN][ep=031] loss=0.4661 acc=86.75%
[TRAIN][ep=031] mask_avg: mc_mean=0.3653 mb_mean=0.5056 norm_overlap=0.9988 corr_cb=-0.0977
[EPOCH 031/089] train: loss=0.4661 acc=86.75% | val: loss=0.9038 acc=64.52% f1=8.33% auc=59.31% val_score=42.5487 val_score_bestthr=57.2037 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.365, mb=0.506, no=0.999, corr=-0.098) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1223 -> 57.2037
[DBG][ep=032] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=032] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=032] mask(step0): mc_mean=0.3690 mb_mean=0.5073 norm_overlap=0.9967 corr_cb=-0.2305 topkJ=0.0216
[TRAIN][ep=032] loss=0.4532 acc=86.21%
[TRAIN][ep=032] mask_avg: mc_mean=0.3622 mb_mean=0.5056 norm_overlap=0.9988 corr_cb=-0.0900
[EPOCH 032/089] train: loss=0.4532 acc=86.21% | val: loss=0.9678 acc=61.29% f1=42.86% auc=58.97% val_score=40.6987 val_score_bestthr=57.3139 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.362, mb=0.506, no=0.999, corr=-0.090) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1223 -> 57.3139
[DBG][ep=033] disease_pos_weight=1.3248 mode=sqrt
[DBG][ep=033] cf_detach_zc=False cf_detach_zb_for_disease=True ent_yb_head_only=True
[DBG][ep=033] mask(step0): mc_mean=0.3552 mb_mean=0.5044 norm_overlap=0.9987 corr_cb=-0.0859 topkJ=0.0182
[TRAIN][ep=033] loss=0.4372 acc=86.57%
[TRAIN][ep=033] mask_avg: mc_mean=0.3586 mb_mean=0.5056 norm_overlap=0.9990 corr_cb=-0.0756
[EPOCH 033/089] train: loss=0.4372 acc=86.57% | val: loss=0.9993 acc=66.13% f1=22.22% auc=56.63% val_score=39.9788 val_score_bestthr=51.6636 | dyn(w_pfs=0.000, w_sup=0.000, w_csuf=0.000, stage2=False) | mask(mc=0.359, mb=0.506, no=0.999, corr=-0.076) | masker_state=mask_gen_c=ON,mask_gen_b=OFF | best(val_score_bestthr)=- 64.1223 -> 51.6636
[EARLY STOP] no improvement for 30 epochs. best_epoch=3
[CKPT] Loaded best for testing: results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/ckpt_best_fold_0.pt
=============== FIT DONE ===============
[BEST] epoch=3 | val_acc=69.35% | val_f1=48.65% | val_auc=64.33% | val_score=54.7189 | val_score_bestthr=64.1223
[TEST@BEST] thr_used=0.610 | acc=63.64% f1=12.50% auc=59.46% | SP_sex=3.41% EO_sex=6.25% SP_age=11.13% EO_age=11.76%
[TIME] 0.72 min
[OK] Saved: results/ADHD_3x5fold_seed0/fold0_rep2_seed2000/summary_fold_0.json
