2026-01-02 15:12:33,293 INFO    MainThread:80468 [wandb_setup.py:_flush():80] Current SDK version is 0.23.1
2026-01-02 15:12:33,293 INFO    MainThread:80468 [wandb_setup.py:_flush():80] Configure stats pid to 80468
2026-01-02 15:12:33,293 INFO    MainThread:80468 [wandb_setup.py:_flush():80] Loading settings from /root/.config/wandb/settings
2026-01-02 15:12:33,293 INFO    MainThread:80468 [wandb_setup.py:_flush():80] Loading settings from /root/autodl-tmp/DisBG-Jade/wandb/settings
2026-01-02 15:12:33,293 INFO    MainThread:80468 [wandb_setup.py:_flush():80] Loading settings from environment variables
2026-01-02 15:12:33,293 INFO    MainThread:80468 [wandb_init.py:setup_run_log_directory():714] Logging user logs to /root/autodl-tmp/DisBG-Jade/wandb/run-20260102_151233-r23xnsro/logs/debug.log
2026-01-02 15:12:33,293 INFO    MainThread:80468 [wandb_init.py:setup_run_log_directory():715] Logging internal logs to /root/autodl-tmp/DisBG-Jade/wandb/run-20260102_151233-r23xnsro/logs/debug-internal.log
2026-01-02 15:12:33,293 INFO    MainThread:80468 [wandb_init.py:init():841] calling init triggers
2026-01-02 15:12:33,293 INFO    MainThread:80468 [wandb_init.py:init():846] wandb.init called with sweep_config: {'adaptive_schedule': True, 'base_seed': 0, 'batch_size': 8, 'cf_detach_zb_for_disease': True, 'dataset': 'ADHD', 'disease_pos_weight_mode': 'sqrt', 'dropout': 0, 'ent_yb_head_only': True, 'eval_thr_grid': 'fine', 'eval_thr_mode': 'best_f1', 'eval_use_best_thr': True, 'folds': 1, 'freeze_b_after': 15, 'gnn_hidden_dim': 64, 'gnn_out_dim': 64, 'grad_clip': 0, 'lam_ent_yb': 0.04, 'lambda_causal_suf': 1, 'lambda_mask_dis': 0.12, 'lambda_mask_l1': 0, 'lambda_maskmean': 0.3, 'lambda_maskstd': 0, 'lambda_ortho': 0.05, 'lambda_pfs': 0.12, 'lambda_pfs_attr': 0.1, 'lambda_sensitive': 0.01, 'lambda_supcon': 0.02, 'lambda_task': 1, 'lr': 0.0003, 'mask_dis_mode': 'norm_overlap', 'mask_reg_weight': 0.6, 'mask_target_mean': 0.5, 'mask_target_std': 0.05, 'mask_temperature': 1, 'mask_topk_ratio': 0.2, 'masker_lr_mult': 1, 'num_epochs': 100, 'num_feats': 116, 'num_gnn_layers': 2, 'patience': 30, 'results_dir': 'results', 'run_cap': 24, 'score_f1_beta': 0.5, 'score_fair_alpha': 0.01, 'select_by': 'val_score_bestthr', 'stage1_ratio': 0.35, 'stage2_lr_mult': 0.3, 'supcon_temperature': 0.07, 'two_stage': True, 'wandb_name_prefix': 'ADHD_stageA_1fold', 'warmup_epoch': 10, 'weight_decay': 0.0005}
config: {'dataset': 'ADHD', 'folds': 1, 'base_seed': 0, 'num_epochs': 100, 'warmup_epoch': 10, 'patience': 30, 'batch_size': 8, 'lr': 0.0003, 'weight_decay': 0.0005, 'masker_lr_mult': 1.0, 'grad_clip': 0.0, 'gnn_hidden_dim': 64, 'gnn_out_dim': 64, 'num_gnn_layers': 2, 'dropout': 0.0, 'num_feats': 116, 'num_classes': 2, 'num_sex_classes': 2, 'num_age_classes': 4, 'fixed_thr': 0.5, 'select_by': 'val_score_bestthr', 'eval_thr_mode': 'best_f1', 'eval_thr_grid': 'fine', 'eval_use_best_thr': True, 'score_f1_beta': 0.5, 'score_fair_alpha': 0.01, 'lambda_task': 1.0, 'lambda_sensitive': 0.01, 'lambda_pfs': 0.12, 'lambda_pfs_attr': 0.1, 'lambda_supcon': 0.02, 'lambda_ortho': 0.05, 'supcon_temperature': 0.07, 'lambda_causal_suf': 1.0, 'lam_ent_yb': 0.04, 'cf_detach_zc': False, 'cf_detach_zb_for_disease': True, 'ent_yb_head_only': True, 'disease_pos_weight_mode': 'sqrt', 'disease_pos_weight': None, 'freeze_b_after': 15, 'freeze_c_after': -1, 'mask_reg_weight': 0.6, 'mask_temperature': 1.0, 'mask_hidden_dim': 64, 'mask_target_mean': 0.5, 'lambda_maskmean': 0.3, 'mask_target_std': 0.05, 'lambda_maskstd': 0.0, 'lambda_mask_dis': 0.12, 'mask_dis_mode': 'norm_overlap', 'mask_topk_ratio': 0.2, 'lambda_mask_l1': 0.0, 'two_stage': True, 'stage1_ratio': 0.35, 'stage2_lr_mult': 0.3, 'adaptive_schedule': True, 'w_pfs_init': 0.1, 'w_sup_init': 0.05, 'w_csuf_init': 0.05, 'w_pfs_max': 0.35, 'w_sup_max': 0.25, 'w_csuf_max': 0.2, 'sched_grow': 0.04, 'sched_decay': 0.1, 'sched_patience': 5, 'mask_min_mean': 0.08, 'mask_max_norm_overlap': 1.4, 'results_dir': 'results', 'python': 'python', 'main': 'main.py', 'cwd': None, 'use_wandb': True, 'wandb_project': 'DisBG-B', 'wandb_entity': None, 'wandb_group': None, 'wandb_tags': '', 'wandb_notes': None, 'wandb_mode': None, 'wandb_per_fold': False, 'wandb_log_agg': True, 'wandb_name_prefix': 'ADHD_stageA_1fold', '_wandb': {}}
2026-01-02 15:12:33,293 INFO    MainThread:80468 [wandb_init.py:init():889] starting backend
2026-01-02 15:12:33,509 INFO    MainThread:80468 [wandb_init.py:init():892] sending inform_init request
2026-01-02 15:12:33,527 INFO    MainThread:80468 [wandb_init.py:init():900] backend started and connected
2026-01-02 15:12:33,528 INFO    MainThread:80468 [wandb_run.py:_config_callback():1396] config_cb None None {'adaptive_schedule': True, 'base_seed': 0, 'batch_size': 8, 'cf_detach_zb_for_disease': True, 'dataset': 'ADHD', 'disease_pos_weight_mode': 'sqrt', 'dropout': 0, 'ent_yb_head_only': True, 'eval_thr_grid': 'fine', 'eval_thr_mode': 'best_f1', 'eval_use_best_thr': True, 'folds': 1, 'freeze_b_after': 15, 'gnn_hidden_dim': 64, 'gnn_out_dim': 64, 'grad_clip': 0, 'lam_ent_yb': 0.04, 'lambda_causal_suf': 1, 'lambda_mask_dis': 0.12, 'lambda_mask_l1': 0, 'lambda_maskmean': 0.3, 'lambda_maskstd': 0, 'lambda_ortho': 0.05, 'lambda_pfs': 0.12, 'lambda_pfs_attr': 0.1, 'lambda_sensitive': 0.01, 'lambda_supcon': 0.02, 'lambda_task': 1, 'lr': 0.0003, 'mask_dis_mode': 'norm_overlap', 'mask_reg_weight': 0.6, 'mask_target_mean': 0.5, 'mask_target_std': 0.05, 'mask_temperature': 1, 'mask_topk_ratio': 0.2, 'masker_lr_mult': 1, 'num_epochs': 100, 'num_feats': 116, 'num_gnn_layers': 2, 'patience': 30, 'results_dir': 'results', 'run_cap': 24, 'score_f1_beta': 0.5, 'score_fair_alpha': 0.01, 'select_by': 'val_score_bestthr', 'stage1_ratio': 0.35, 'stage2_lr_mult': 0.3, 'supcon_temperature': 0.07, 'two_stage': True, 'wandb_name_prefix': 'ADHD_stageA_1fold', 'warmup_epoch': 10, 'weight_decay': 0.0005}
2026-01-02 15:12:33,528 INFO    MainThread:80468 [wandb_init.py:init():970] updated telemetry
2026-01-02 15:12:33,528 INFO    MainThread:80468 [wandb_init.py:init():994] communicating run to backend with 90.0 second timeout
2026-01-02 15:12:34,756 INFO    MainThread:80468 [wandb_init.py:init():1041] starting run threads in backend
2026-01-02 15:12:34,822 INFO    MainThread:80468 [wandb_run.py:_console_start():2521] atexit reg
2026-01-02 15:12:34,822 INFO    MainThread:80468 [wandb_run.py:_redirect():2369] redirect: wrap_raw
2026-01-02 15:12:34,822 INFO    MainThread:80468 [wandb_run.py:_redirect():2438] Wrapping output streams.
2026-01-02 15:12:34,822 INFO    MainThread:80468 [wandb_run.py:_redirect():2461] Redirects installed.
2026-01-02 15:12:34,826 INFO    MainThread:80468 [wandb_init.py:init():1081] run started, returning control to user process
2026-01-02 15:13:56,312 INFO    wandb-AsyncioManager-main:80468 [service_client.py:_forward_responses():80] Reached EOF.
2026-01-02 15:13:56,313 INFO    wandb-AsyncioManager-main:80468 [mailbox.py:close():137] Closing mailbox, abandoning 1 handles.
